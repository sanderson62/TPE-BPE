* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47******************************************************************
    48 ENVIRONMENT DIVISION.
    49
    50 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page   3
* EL050.cbl
    52 WORKING-STORAGE SECTION.
    53 01  DFH-START PIC X(04).
    54
    55 77  FILLER   PIC X(32) VALUE '********************************'.
    56 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    57 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    58
    59 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    60 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    61                                   USAGE POINTER.
    62 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    63 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    64 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    65                                   USAGE IS POINTER.
    66 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    67 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    68                                   USAGE IS POINTER.
    69 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    70 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    71                                   USAGE IS POINTER.
    72
    73 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    74 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    75                                   USAGE IS POINTER.
    76
    77*    COPY ELC50WS.
    78*****************************************************************
    79*                                                               *
    80*                            ELC50WS.                           *
    81*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    82*                            VMOD=2.061.                        *
    83*                                                               *
    84*   THIS IS THE WORKING STORAGE FOR EL050                       *
    85*                                   EL517                       *
    86*****************************************************************
    87******************************************************************
    88*                   C H A N G E   L O G
    89*
    90* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    91*-----------------------------------------------------------------
    92*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    93* EFFECTIVE    NUMBER
    94*-----------------------------------------------------------------
    95* 123102                   PEMA  ADD DCC PROCESSING
    96* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
    97* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
    98* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
    99* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   100* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   101* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   102* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   103* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   104* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   105* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   106* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   107* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   108* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   109* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page   4
* EL050.cbl
   110* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   111* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   112* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   113* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   114* 030309  CR2009021700001  PEMA  ADD ER-2883
   115* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   116* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   117* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   118* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   119* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   120* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   121* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   122* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   123* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   124* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   125* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   126* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   127* 061412  CR2011022800001  AJRA  NAPERSOFT
   128* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   129* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   130* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   131* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   132* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   133* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   134*-----------------------------------------------------------------
   135
   136 01  WORK-AREAS.
   137
   138*****************************************************************
   139*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   140*****************************************************************
   141
   142     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   143     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   144     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   145     12  WS-NAME-EDIT-WORK-AREA.
   146         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   147         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   148             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   149         16  WS-WORK-NAME.
   150             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   151             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   152             20  FILLER           PIC X(10)     VALUE SPACES.
   153         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   154             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   155
   156*****************************************************************
   157*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   158*****************************************************************
   159
   160     12  WS-ERRESC-KEY.
   161         16 WS-ERRESC-SEARCH-KEY.
   162             20  WS-ERRESC-COMPANY-CD PIC  X.
   163             20  WS-ERRESC-CARRIER    PIC  X.
   164             20  WS-ERRESC-GROUP      PIC X(6).
   165             20  WS-ERRESC-STATE      PIC XX.
   166             20  WS-ERRESC-ACCOUNT    PIC X(10).
   167         16 WS-ERRESC-RESIDUAL-KEY.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page   5
* EL050.cbl
   168             20  WS-ERRESC-AGENT      PIC X(10).
   169             20  WS-ERRESC-RES-STATE  PIC XX.
   170             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   171*                                          YYYYMMDD
   172     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   173     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   174
   175*RESIDENT STATE TAX MASTER(ERRESS)
   176*
   177     12  WS-ERRESS-KEY.
   178         16  WS-ERRESS-COMPANY-CD      PIC  X.
   179         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   180         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   181         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   182*                                          YYYYMMDD
   183
   184     12  WS-CONTRACT-DATE              PIC 9(8).
   185*                                          YYYYMMDD
   186     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   187     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   188         16 WS-YEAR-YY                 PIC   9999.
   189         16 FILLER                     PIC 9(4).
   190*                                          YYYYMMDD
   191     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   192     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   193     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   194     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   195
   196     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   197         88  DPRB-1ST-TIME                      VALUE ' '.
   198
   199*****************************************************************
   200*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   201*****************************************************************
   202
   203     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   204     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   205     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   206     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   207     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   208     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   209     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   210     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   211     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   212     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   213         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   214         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   215     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   216         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   217         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   218     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   219
   220     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   221     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   222
   223     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   224     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   225     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page   6
* EL050.cbl
   226     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   227     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   228     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   229     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   230     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   231     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   232     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   233     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   234     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   235     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   236     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   237     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   238     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   239     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   240     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   241     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   242     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   243     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   244     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   245     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   246     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   247     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   248     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   249     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   250     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   251     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   252     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   253     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   254     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   255     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   256     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   257     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   258     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   259     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   260     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   261     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   262     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   263     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   264     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   265     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   266     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   267     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   268     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   269     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   270     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   271     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   272     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   273     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   274     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   275     12  WS-2671-SW               PIC X         VALUE SPACE.
   276     12  WS-2672-SW               PIC X         VALUE SPACE.
   277     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   278         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   279     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   280         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   281     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   282
   283     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page   7
* EL050.cbl
   284         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   285         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   286         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   287         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   288
   289     12  WS-CREDIT-EDIT-CONTROLS.
   290         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   291         16  WS-MIN-AGE           PIC 99                VALUE  0.
   292         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   293         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   294         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   295         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   296
   297     12  WS-AGE-FIELDS.
   298         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   299         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   300         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   301         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   302
   303     12  WS-SAVE-ALLOWABLE-BENEFIT.
   304         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   305         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   306         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   307         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   308         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   309         16  FILLER                      PIC XX.
   310
   311     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   312     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   313     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   314     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   315     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   316     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   317     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   318     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   319     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   320     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   321
   322     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   323     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   324     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   325     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   326     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   327     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   328     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   329     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   330         88  WS-REDUCING              VALUE 'R'.
   331         88  WS-LEVEL                 VALUE 'L' 'P'.
   332     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   333
   334     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   335     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   336     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   337     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   338     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   339     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   340     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   341     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page   8
* EL050.cbl
   342     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   343
   344     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   345     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   346     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   347     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   348     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   349     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   350     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   351     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   352     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   353     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   354     12  WS-ACCT-SIG-SW.
   355         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   356         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   357     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   358     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   359     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   360     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   361     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   362     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   363     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   364     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   365     12  WS-INITIALS.
   366         16  WS-INIT-1            PIC X         VALUE SPACES.
   367         16  WS-INIT-2            PIC X         VALUE SPACES.
   368
   369     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   370     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   371     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   372     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   373     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   374*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   375     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   376     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   377     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   378     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   379     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   380     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   381     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   382     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   383     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   384     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   385     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   386     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   387     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   388     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   389     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   390     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   391     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   392     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   393     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   394     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   395     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   396     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   397******** FLA
   398     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   399     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page   9
* EL050.cbl
   400     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   401     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   402     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   403********
   404     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   405     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   406     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   407     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   408     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   409     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   410     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   411     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   412     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   413     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   414
   415     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   416         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   417                                         '0' THRU '9'.
   418
   419     12  NUMBER-OF-MONTHS.
   420         16  SK-MO OCCURS 12 TIMES PIC X.
   421
   422     12  WS-WORK-DATE.
   423         16  WS-YEAR            PIC 99    VALUE 00.
   424         16  WS-MONTH           PIC 99    VALUE 00.
   425         16  WS-DAY             PIC 99    VALUE 00.
   426
   427     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   428     12  WS-WORK-CRIT-DEV       REDEFINES
   429         WS-WORK-LF-CRIT-PER    PIC X(03).
   430
   431     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   432     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   433
   434     12  WS-WORK-DATE-FROM.
   435         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   436         16  FILLER             PIC X  VALUE SPACE.
   437         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   438         16  FILLER             PIC X         VALUE SPACE.
   439         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   440
   441     12  WS-WORK-DATE-THRU.
   442         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   443         16  FILLER             PIC X         VALUE SPACE.
   444         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   445         16  FILLER             PIC X         VALUE SPACE.
   446         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   447
   448     12  WS-LF-INPUT-CD.
   449         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   450         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   451
   452     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   453     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   454         16  WS-AH-INPUT-CD-1   PIC X.
   455         16  WS-AH-INPUT-CD-2-3 PIC XX.
   456
   457     12  WS-SWITCHES.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  10
* EL050.cbl
   458         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   459         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   460             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   461         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   462             88  BANK-ACCT-FOUND          VALUE 'Y'.
   463         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   464             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   465         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   466             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   467         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   468             88  COMP-MASTER-FOUND        VALUE 'Y'.
   469         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   470             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   471         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   472             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   473         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   474             88  STAT-MASTER-FOUND        VALUE 'Y'.
   475         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   476             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   477         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   478             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   479         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   480             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   481         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   482             88  FORM-MASTER-FOUND        VALUE 'Y'.
   483         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   484             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   485         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   486             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   487         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   488             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   489         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   490             88  NO-BENEFIT-FOUND         VALUE 'N'.
   491         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   492             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   493         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   494             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   495         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   496             88  AH-BENEFIT-FOUND         VALUE ' '.
   497             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   498         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   499             88  LF-BENEFIT-FOUND         VALUE ' '.
   500             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   501         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   502             88  NO-STATE-RECORD          VALUE '1'.
   503         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   504             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   505         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   506             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   507         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   508             88  CERT-WAS-FOUND           VALUE ' '.
   509             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   510         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   511             88  BROWSE-STARTED           VALUE 'Y'.
   512         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   513             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   514         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   515             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  11
* EL050.cbl
   516         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   517             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   518         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   519             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   520         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   521             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   522         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   523             88  APP-CERT-USED            VALUE 'Y' 'A'.
   524         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   525             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   526             88  FIRST-TIME-THROUGH       VALUE '1'.
   527             88  CTBL-NOT-FOUND           VALUE '2'.
   528
   529         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   530             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   531
   532         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   533             88  DLO-ERROR-FOUND          VALUE 'Y'.
   534
   535********FLA
   536     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   537     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   538********
   539     12  RC-SW-1                  PIC X           VALUE '0'.
   540     12  RC-SW-2                  PIC X           VALUE '0'.
   541     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   542     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   543     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   544     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   545     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   546     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   547     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   548     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   549     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   550     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   551     12  LIT-SPACES               PIC X           VALUE SPACES.
   552     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   553     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   554     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   555     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   556     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   557     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   558     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   559         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   560         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   561     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   562         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   563
   564 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   565     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   566     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   567 01  WS-CRI-SSN-WORK-AREA.
   568     05  WS-CRI-SOC-SEC-NO.
   569         10  WS-SS-REPT-CD       PIC X(5).
   570         10  WS-SS-LAST-NAME     PIC X(5).
   571         10  WS-SS-INITIAL       PIC X.
   572
   573     05  WS-CRI-REPORT-CODE.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  12
* EL050.cbl
   574         10  FILLER              PIC X(5).
   575         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   576
   577     05  WS-CRI-LAST-NAME.
   578         10  WS-CRI-NAME-MOVE    PIC X(5).
   579         10  FILLER              PIC X(10).
   580
   581 01  WS-NUM-TABLE                PIC X(26)  VALUE
   582     '12345678012345070923456789'.
   583 01  FILLER REDEFINES WS-NUM-TABLE.
   584     05  WS-NUM OCCURS 26        PIC 9.
   585 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   586 01  V1                          PIC S999 COMP-3.
   587 01  V2                          PIC S999 COMP-3.
   588 01  V3                          PIC S999 COMP-3.
   589 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   590 01  FILLER REDEFINES WS-WORK-VIN.
   591     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   592 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   593 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   594 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   595 01  WS-HEX-WORK.
   596     05  FILLER                  PIC X  VALUE LOW-VALUES.
   597     05  WS-HEX-BYTE             PIC X.
   598 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   599 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   600 01  WS-WORK-HIN-ROW-B.
   601     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   602
   603 01  ws-benefit-cd-chg-sw      pic x value spaces.
   604     88  benefit-code-chg           value 'Y'.
   605 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   606 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   607     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   608 01  WS-ROW-D-TABLE.
   609     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   610
   611 01  WS-HIN-TABLE-B.
   612     05  F                       PIC XX VALUE 'A2'.
   613     05  F                       PIC XX VALUE 'B3'.
   614     05  F                       PIC XX VALUE 'C4'.
   615     05  F                       PIC XX VALUE 'D5'.
   616     05  F                       PIC XX VALUE 'E6'.
   617     05  F                       PIC XX VALUE 'F7'.
   618     05  F                       PIC XX VALUE 'G8'.
   619     05  F                       PIC XX VALUE 'H9'.
   620     05  F                       PIC XX VALUE 'I1'.
   621     05  F                       PIC XX VALUE 'J2'.
   622     05  F                       PIC XX VALUE 'K3'.
   623     05  F                       PIC XX VALUE 'L4'.
   624     05  F                       PIC XX VALUE 'M5'.
   625     05  F                       PIC XX VALUE 'N6'.
   626     05  F                       PIC XX VALUE 'O0'.
   627     05  F                       PIC XX VALUE 'P7'.
   628     05  F                       PIC XX VALUE 'Q0'.
   629     05  F                       PIC XX VALUE 'R8'.
   630     05  F                       PIC XX VALUE 'S9'.
   631     05  F                       PIC XX VALUE 'T2'.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  13
* EL050.cbl
   632     05  F                       PIC XX VALUE 'U3'.
   633     05  F                       PIC XX VALUE 'V4'.
   634     05  F                       PIC XX VALUE 'W5'.
   635     05  F                       PIC XX VALUE 'X6'.
   636     05  F                       PIC XX VALUE 'Y7'.
   637     05  F                       PIC XX VALUE 'Z8'.
   638 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   639     05  WS-VAL-IN               PIC X.
   640     05  WS-VAL-OUT              PIC 9.
   641 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   642 01  WS-COMPARE-BINARY-DATES.
   643     05  WS-971231                PIC XX VALUE X'92FF'.
   644     05  WS-931231                PIC XX VALUE X'8CFF'.
   645     05  WS-791231                PIC XX VALUE X'77FF'.
   646     05  WS-771001                PIC XX VALUE X'74A1'.
   647     05  WS-820301                PIC XX VALUE X'7B41'.
   648     05  WS-831031                PIC XX VALUE X'7DBF'.
   649     05  WS-831231                PIC XX VALUE X'7DFF'.
   650     05  WS-810831                PIC XX VALUE X'7A7F'.
   651     05  WS-830901                PIC XX VALUE X'7D81'.
   652
   653 01  FILE-ACCESS-IDS.
   654     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   655     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   656     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   657     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   658     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   659     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   660     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   661     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   662     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   663     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   664     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   665     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   666     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   667     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   668     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   669     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   670     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   671 01  DD-IU-SW                    PIC X   VALUE ' '.
   672     88  DD-IU-PRESENT                 VALUE 'Y'.
   673
   674 01  ACCESS-KEYS.
   675     12  ELMSTR-KEY.
   676         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   677         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   678     12  W-CLAIM-KEY.
   679         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   680         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   681
   682     12  ELCNTL-KEY.
   683         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   684         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   685         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   686         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   687
   688     12  ELCERT-KEY.
   689         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  14
* EL050.cbl
   690         16  CERT-CARRIER         PIC X       VALUE SPACE.
   691         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   692         16  CERT-STATE           PIC XX      VALUE SPACES.
   693         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   694         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   695         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   696
   697     12  ELCERT2-KEY.
   698         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   699         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   700
   701     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   702
   703     12  ELCERT-SAVE.
   704         16  FILLER                      PIC XX    VALUE SPACES.
   705
   706         16  WCS-CONTROL-PRIMARY.
   707             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   708             20  WCS-CARRIER             PIC X     VALUE SPACE.
   709             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   710             20  WCS-STATE               PIC XX    VALUE SPACES.
   711             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   712             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   713             20  WCS-CERT-NO.
   714                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   715                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   716
   717         16  CS-CONTROL-BY-NAME.
   718             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   719             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   720             20  CS-INSURED-INITIALS.
   721                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   722                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   723
   724         16  CS-CONTROL-BY-SSN.
   725             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   726             20  CS-SOC-SEC-NO.
   727                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   728                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   729                 24  CS-SSN-LN3.
   730                     28 CS-INSURED-INITIALS-A2   PIC XX
   731                                     VALUE SPACES.
   732                     28 CS-PART-LAST-NAME-A2     PIC X
   733                                     VALUE SPACE.
   734
   735         16  CS-CONTROL-BY-CERT-NO.
   736             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   737             20  CS-CERT-NO-A4           PIC X(11)
   738                                     VALUE SPACES.
   739
   740         16  CS-CONTROL-BY-MEMB.
   741             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   742             20  CS-MEMBER-NO.
   743                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   744                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   745                 24  CS-MEMB-LN4.
   746                     28 CS-INSURED-INITIALS-A5   PIC XX
   747                                      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  15
* EL050.cbl
   748                     28 CS-PART-LAST-NAME-A5     PIC XX
   749                                      VALUE SPACES.
   750
   751         16  FILLER              PIC X(360) VALUE SPACES.
   752
   753     12  ERACCT-KEY.
   754         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   755         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   756         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   757         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   758         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   759         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   760
   761     12  ERCOMP-KEY.
   762         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   763         16  COMP-CARRIER         PIC X     VALUE SPACES.
   764         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   765         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   766         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   767         16  COMP-TYPE            PIC X     VALUE SPACES.
   768
   769     12  ERLOFC-KEY.
   770         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   771         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   772         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   773         16  LOFC-STATE           PIC XX    VALUE SPACES.
   774         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   775         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   776
   777     12  WS-ELCRTT-KEY.
   778         16  WS-ELCRTT-PRIMARY       PIC X(33).
   779         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   780
   781     12  ERBXRF-KEY.
   782         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   783         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   784         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   785         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   786
   787     12  ERAGTC-KEY.
   788         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   789         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   790         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   791         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   792         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   793         16  AGTC-TYPE            PIC X     VALUE SPACES.
   794
   795     12  ERPLAN-KEY.
   796         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   797         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   798         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   799         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   800         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   801         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   802         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   803         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   804
   805     12  ERFORM-KEY.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  16
* EL050.cbl
   806         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   807         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   808         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   809         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   810
   811     12  ERREIN-KEY.
   812         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   813         16  REIN-TYPE            PIC X     VALUE SPACES.
   814         16  REIN-TABLE-CO.
   815             20  REIN-CODE-1      PIC X     VALUE SPACE.
   816             20  REIN-CODE-2      PIC X     VALUE SPACE.
   817             20  REIN-CODE-3      PIC X     VALUE SPACE.
   818         16  FILLER               PIC X(3)  VALUE SPACES.
   819
   820     12  ERCTBL-KEY.
   821         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   822         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   823         16  CTBL-CNTRL-2.
   824             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   825             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   826
   827     12  ELCRTO-KEY.
   828         16  ELCRTO-COMPANY-CD       PIC X.
   829         16  ELCRTO-CARRIER          PIC X.
   830         16  ELCRTO-GROUPING         PIC X(6).
   831         16  ELCRTO-STATE            PIC XX.
   832         16  ELCRTO-ACCOUNT          PIC X(10).
   833         16  ELCRTO-CERT-EFF-DT      PIC XX.
   834         16  ELCRTO-CERT-NO.
   835             20  ELCRTO-CERT-PRIME   PIC X(10).
   836             20  ELCRTO-CERT-SFX     PIC X.
   837         16  ELCRTO-RECORD-TYPE      PIC X.
   838         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   839
   840
   841     12  WS-ACCESS.
   842         16  FILLER               PIC XX    VALUE SPACES.
   843         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   844
   845     12  WS-CARR-ACCESS.
   846         16  FILLER               PIC X(3)  VALUE SPACES.
   847         16  WS-CARR              PIC X     VALUE SPACE.
   848*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   849*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   850     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   851         88  WS-DMD-LF-RATING   VALUE 'Y'.
   852         88  WS-DMD-AH-RATING   VALUE 'Y'.
   853         88  WS-DMD-NO-RATING   VALUE 'N'.
   854
   855     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   856         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   857                                         'NJ' 'NL'
   858                                         'PJ' 'PL'
   859                                         'SJ' 'SL'.
   860     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   861         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   862                                         'NI' 'NJ' 'NL' 'NU'
   863                                         'PJ' 'PL' 'PI' 'PU'
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  17
* EL050.cbl
   864                                         'SI' 'SJ' 'SL' 'SU'
   865                                         'MX' 'MY' 'MZ'.
   866 01  ERPDEF-KEY-SAVE             PIC X(18).
   867 01  ERPDEF-KEY.
   868     12  ERPDEF-COMPANY-CD       PIC X.
   869     12  ERPDEF-STATE            PIC XX.
   870     12  ERPDEF-PROD-CD          PIC XXX.
   871     12  F                       PIC X(7).
   872     12  ERPDEF-BEN-TYPE         PIC X.
   873     12  ERPDEF-BEN-CODE         PIC XX.
   874     12  ERPDEF-EXP-DT           PIC XX.
   875
   876 01  ELSTAT-KEY-SAVE             PIC X(20).
   877 01  ELSTAT-KEY.
   878     12  ELSTAT-COMPANY-ID       PIC XXX.
   879     12  ELSTAT-CARRIER          PIC X.
   880     12  ELSTAT-GROUP            PIC X(6).
   881     12  ELSTAT-STATE            PIC XX.
   882     12  ELSTAT-EXP-DT           PIC 9(8).
   883 01  WS-ERROR-VALUES.
   884     12  ER-1570                     PIC S9(4)   VALUE +1570.
   885     12  ER-1571                     PIC S9(4)   VALUE +1571.
   886     12  er-1572                     pic s9(4)   value +1572.
   887     12  er-1573                     pic s9(4)   value +1573.
   888     12  er-1574                     pic s9(4)   value +1574.
   889     12  ER-1575                     PIC S9(4)   VALUE +1575.
   890     12  ER-1891                     PIC S9(4)   VALUE +1891.
   891     12  ER-1892                     PIC S9(4)   VALUE +1892.
   892     12  ER-1893                     PIC S9(4)   VALUE +1893.
   893     12  ER-1894                     PIC S9(4)   VALUE +1894.
   894     12  ER-1895                     PIC S9(4)   VALUE +1895.
   895     12  ER-1896                     PIC S9(4)   VALUE +1896.
   896     12  ER-1897                     PIC S9(4)   VALUE +1897.
   897     12  ER-1898                     PIC S9(4)   VALUE +1898.
   898     12  ER-1899                     PIC S9(4)   VALUE +1899.
   899     12  ER-1900                     PIC S9(4)   VALUE +1900.
   900     12  ER-1901                     PIC S9(4)   VALUE +1901.
   901     12  ER-1902                     PIC S9(4)   VALUE +1902.
   902     12  ER-1903                     PIC S9(4)   VALUE +1903.
   903     12  ER-1904                     PIC S9(4)   VALUE +1904.
   904     12  ER-1905                     PIC S9(4)   VALUE +1905.
   905     12  ER-1906                     PIC S9(4)   VALUE +1906.
   906     12  ER-1907                     PIC S9(4)   VALUE +1907.
   907     12  ER-1909                     PIC S9(4)   VALUE +1909.
   908     12  ER-1910                     PIC S9(4)   VALUE +1910.
   909     12  ER-1911                     PIC S9(4)   VALUE +1911.
   910     12  ER-1912                     PIC S9(4)   VALUE +1912.
   911     12  ER-1913                     PIC S9(4)   VALUE +1913.
   912     12  ER-1914                     PIC S9(4)   VALUE +1914.
   913     12  ER-1915                     PIC S9(4)   VALUE +1915.
   914     12  ER-1916                     PIC S9(4)   VALUE +1916.
   915     12  ER-1917                     PIC S9(4)   VALUE +1917.
   916     12  ER-1918                     PIC S9(4)   VALUE +1918.
   917     12  ER-1919                     PIC S9(4)   VALUE +1919.
   918     12  ER-1920                     PIC S9(4)   VALUE +1920.
   919     12  ER-1921                     PIC S9(4)   VALUE +1921.
   920     12  ER-1922                     PIC S9(4)   VALUE +1922.
   921     12  ER-1923                     PIC S9(4)   VALUE +1923.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  18
* EL050.cbl
   922     12  ER-1924                     PIC S9(4)   VALUE +1924.
   923     12  ER-1925                     PIC S9(4)   VALUE +1925.
   924     12  ER-1926                     PIC S9(4)   VALUE +1926.
   925     12  ER-1927                     PIC S9(4)   VALUE +1927.
   926     12  ER-2393                     PIC S9(4)   VALUE +2393.
   927     12  ER-2600                     PIC S9(4)   VALUE +2600.
   928     12  ER-2601                     PIC S9(4)   VALUE +2601.
   929     12  ER-2602                     PIC S9(4)   VALUE +2602.
   930     12  ER-2603                     PIC S9(4)   VALUE +2603.
   931     12  ER-2604                     PIC S9(4)   VALUE +2604.
   932     12  ER-2605                     PIC S9(4)   VALUE +2605.
   933     12  ER-2606                     PIC S9(4)   VALUE +2606.
   934     12  ER-2607                     PIC S9(4)   VALUE +2607.
   935     12  ER-2608                     PIC S9(4)   VALUE +2608.
   936     12  ER-2609                     PIC S9(4)   VALUE +2609.
   937     12  ER-2610                     PIC S9(4)   VALUE +2610.
   938     12  ER-2611                     PIC S9(4)   VALUE +2611.
   939     12  ER-2612                     PIC S9(4)   VALUE +2612.
   940     12  ER-2613                     PIC S9(4)   VALUE +2613.
   941     12  ER-2614                     PIC S9(4)   VALUE +2614.
   942     12  ER-2615                     PIC S9(4)   VALUE +2615.
   943     12  ER-2616                     PIC S9(4)   VALUE +2616.
   944     12  ER-2617                     PIC S9(4)   VALUE +2617.
   945     12  ER-2618                     PIC S9(4)   VALUE +2618.
   946     12  ER-2619                     PIC S9(4)   VALUE +2619.
   947     12  ER-2620                     PIC S9(4)   VALUE +2620.
   948     12  ER-2621                     PIC S9(4)   VALUE +2621.
   949     12  ER-2622                     PIC S9(4)   VALUE +2622.
   950     12  ER-2623                     PIC S9(4)   VALUE +2623.
   951     12  ER-2624                     PIC S9(4)   VALUE +2624.
   952     12  ER-2625                     PIC S9(4)   VALUE +2625.
   953     12  ER-2626                     PIC S9(4)   VALUE +2626.
   954     12  ER-2627                     PIC S9(4)   VALUE +2627.
   955     12  ER-2628                     PIC S9(4)   VALUE +2628.
   956     12  ER-2629                     PIC S9(4)   VALUE +2629.
   957     12  ER-2630                     PIC S9(4)   VALUE +2630.
   958     12  ER-2631                     PIC S9(4)   VALUE +2631.
   959     12  ER-2632                     PIC S9(4)   VALUE +2632.
   960     12  ER-2633                     PIC S9(4)   VALUE +2633.
   961     12  ER-2634                     PIC S9(4)   VALUE +2634.
   962     12  ER-2635                     PIC S9(4)   VALUE +2635.
   963     12  ER-2636                     PIC S9(4)   VALUE +2636.
   964     12  ER-2637                     PIC S9(4)   VALUE +2637.
   965     12  ER-2638                     PIC S9(4)   VALUE +2638.
   966     12  ER-2639                     PIC S9(4)   VALUE +2639.
   967     12  ER-2640                     PIC S9(4)   VALUE +2640.
   968     12  ER-2641                     PIC S9(4)   VALUE +2641.
   969     12  ER-2642                     PIC S9(4)   VALUE +2642.
   970     12  ER-2643                     PIC S9(4)   VALUE +2643.
   971     12  ER-2644                     PIC S9(4)   VALUE +2644.
   972     12  ER-2645                     PIC S9(4)   VALUE +2645.
   973     12  ER-2646                     PIC S9(4)   VALUE +2646.
   974     12  ER-2647                     PIC S9(4)   VALUE +2647.
   975     12  ER-2648                     PIC S9(4)   VALUE +2648.
   976     12  ER-2649                     PIC S9(4)   VALUE +2649.
   977     12  ER-2650                     PIC S9(4)   VALUE +2650.
   978     12  ER-2651                     PIC S9(4)   VALUE +2651.
   979     12  ER-2652                     PIC S9(4)   VALUE +2652.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  19
* EL050.cbl
   980     12  ER-2653                     PIC S9(4)   VALUE +2653.
   981     12  ER-2654                     PIC S9(4)   VALUE +2654.
   982     12  ER-2655                     PIC S9(4)   VALUE +2655.
   983     12  ER-2656                     PIC S9(4)   VALUE +2656.
   984     12  ER-2657                     PIC S9(4)   VALUE +2657.
   985     12  ER-2658                     PIC S9(4)   VALUE +2658.
   986     12  ER-2659                     PIC S9(4)   VALUE +2659.
   987     12  ER-2660                     PIC S9(4)   VALUE +2660.
   988     12  ER-2661                     PIC S9(4)   VALUE +2661.
   989     12  ER-2662                     PIC S9(4)   VALUE +2662.
   990     12  ER-2663                     PIC S9(4)   VALUE +2663.
   991     12  ER-2664                     PIC S9(4)   VALUE +2664.
   992     12  ER-2665                     PIC S9(4)   VALUE +2665.
   993     12  ER-2666                     PIC S9(4)   VALUE +2666.
   994     12  ER-2667                     PIC S9(4)   VALUE +2667.
   995     12  ER-2668                     PIC S9(4)   VALUE +2668.
   996     12  ER-2669                     PIC S9(4)   VALUE +2669.
   997     12  ER-2670                     PIC S9(4)   VALUE +2670.
   998     12  ER-2671                     PIC S9(4)   VALUE +2671.
   999     12  ER-2672                     PIC S9(4)   VALUE +2672.
  1000     12  ER-2673                     PIC S9(4)   VALUE +2673.
  1001     12  ER-2674                     PIC S9(4)   VALUE +2674.
  1002     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1003     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1004     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1005     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1006     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1007     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1008     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1009     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1010     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1011     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1012     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1013     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1014     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1015     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1016     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1017     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1018     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1019     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1020     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1021     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1022     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1023     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1024     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1025     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1026     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1027     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1028     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1029     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1030     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1031     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1032     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1033     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1034     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1035     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1036     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1037     12  ER-2719                     PIC S9(4)   VALUE +2719.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  20
* EL050.cbl
  1038     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1039     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1040     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1041     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1042     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1043     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1044     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1045     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1046     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1047     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1048     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1049     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1050     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1051     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1052     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1053     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1054     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1055     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1056     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1057     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1058     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1059     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1060     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1061     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1062     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1063     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1064     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1065     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1066     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1067     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1068     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1069     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1070     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1071     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1072     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1073     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1074     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1075     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1076     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1077     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1078     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1079     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1080     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1081     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1082     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1083     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1084     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1085     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1086     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1087     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1088     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1089     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1090     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1091     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1092     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1093     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1094     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1095     12  ER-2778                     PIC S9(4)   VALUE +2778.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  21
* EL050.cbl
  1096     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1097     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1098     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1099     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1100     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1101     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1102     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1103     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1104     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1105     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1106     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1107     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1108     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1109     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1110     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1111     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1112     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1113     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1114     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1115     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1116     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1117     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1118     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1119     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1120     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1121     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1122     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1123     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1124     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1125     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1126     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1127     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1128     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1129     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1130     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1131     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1132     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1133     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1134     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1135     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1136     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1137     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1138     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1139     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1140     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1141     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1142     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1143     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1144     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1145     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1146     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1147     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1148     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1149     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1150     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1151     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1152     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1153     12  ER-7820                     PIC S9(4)   VALUE +7820.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  22
* EL050.cbl
  1154     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1155     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1156     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1157     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1158     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1159     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1160     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1161     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1162     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1163     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1164     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1165     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1166     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1167     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1168     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1169     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1170     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1171     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1172     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1173     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1174     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1175     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1176     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1177     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1178     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1179     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1180     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1181     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1182     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1183     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1184     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1185     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1186     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1187     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1188     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1189     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1190     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1191     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1192     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1193     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1194     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1195     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1196     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1197     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1198     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1199     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1200     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1201     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1202     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1203     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1204     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1205     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1206     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1207     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1208     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1209     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1210     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1211     12  ER-8300                     PIC S9(4)   VALUE +8300.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  23
* EL050.cbl
  1212     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1213     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1214     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1215     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1216     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1217     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1218     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1219     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1220     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1221     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1222     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1223     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1224     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1225     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1226     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1227     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1228     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1229******************************************************************
  1230***************   END OF ELC50WS     ****************************
  1231******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  24
* EL050.cbl
  1234 01  WORKING-STORAGE-WORK-AREAS.
  1235     12  WS-RESPONSE             PIC S9(8)  COMP.
  1236         88  WS-RESP-NORMAL           VALUE +00.
  1237         88  WS-RESP-ERROR            VALUE +01.
  1238         88  WS-RESP-NOTFND           VALUE +13.
  1239         88  WS-RESP-DUPREC           VALUE +14.
  1240         88  WS-RESP-ENDFILE          VALUE +20.
  1241     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1242     12  WORK-AREAS.
  1243         16  WK-CONV-GREG.
  1244             24  WCG-CENT             PIC XX.
  1245             24  WCG-REST             PIC X(4).
  1246         16  WORK-GREGORIAN-DATE.
  1247             24  WK-GREG-CENT         PIC XX.
  1248             24  WK-GREG-DATE-YYMMDD.
  1249                 28  WK-GREG-YYMM     PIC X(4).
  1250                 28  WK-GREG-DD       PIC XX.
  1251
  1252         16  WORK-SELECT-DATE.
  1253             24  WK-SELECT-CENT            PIC XX.
  1254             24  WK-SELECT-DATE-YYMMDD.
  1255                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1256                 28  FILLER                PIC XX.
  1257
  1258         16  WK-FORM-NO.
  1259             24  WK-FORM-BANK-ID       PIC X(5).
  1260             24  WK-FORM-UNDRWRTR      PIC X(1).
  1261             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1262
  1263         16  WK-MEMBER-NO.
  1264             24  WK-MEMBER-1-6        PIC X(6).
  1265             24  WK-MEMBER-7-12       PIC X(6).
  1266
  1267         16  WK-FULL-CERT-NO.
  1268             24  WK-CERT-POS-1-2      PIC X(2).
  1269             24  WK-CERT-POS-3        PIC X(1).
  1270             24  WK-CERT-POS-4        PIC X(1).
  1271             24  WK-CERT-POS-5-6      PIC X(2).
  1272             24  WK-CERT-POS-7        PIC X(1).
  1273             24  WK-CERT-POS-8-11     PIC X(4).
  1274
  1275         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1276             88  VALID-RATE-CODE        VALUE 'Y'.
  1277             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1278
  1279         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1280         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1281         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1282         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1283         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1284         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1285         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1286         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1287         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1288         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1289
  1290* DLO001
  1291 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  25
* EL050.cbl
  1292     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1293     12  DMPF-RETURN-CODE          PIC XX.
  1294         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1295         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1296         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1297         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1298         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1299         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1300
  1301* DLO002
  1302 01  WS-DLO-INTERNAL-POLICY-FORM.
  1303     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1304     12  DIPF-RETURN-CODE          PIC XX.
  1305         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1306         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1307         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1308         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1309         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1310         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1311
  1312* DLO003
  1313 01  WS-DLO-VALID-BANK-ID.
  1314     12  DVBI-BANK-ID              PIC X(5).
  1315     12  DVBI-BANK-ID-TYPE         PIC X.
  1316         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1317         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1318         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1319         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1320         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1321     12  DVBI-RETURN-CODE          PIC XX.
  1322         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1323         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1324         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1325         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1326         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1327         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1328         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1329         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1330         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1331
  1332* DLO007
  1333 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1334     12  DCUA-RES-STATE            PIC XX.
  1335     12  DCUA-BEN-TYPE             PIC XX.
  1336     12  DCUA-SYS-IDENT            PIC X.
  1337         88  DCUA-CLAIM                        VALUE 'C'.
  1338         88  DCUA-PREMIUM                      VALUE 'P'.
  1339     12  DCUA-COVERAGE-RULE        PIC X.
  1340     12  DCUA-CLIENT-ID            PIC X(10).
  1341     12  DCUA-EFF-DATE             PIC X(8).
  1342     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1343     12  DCUA-RETURN-CODE          PIC XX.
  1344         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1345     12  DCUA-CERT-NUMBER          PIC X(11).
  1346     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1347     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1348
  1349* DLO011
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  26
* EL050.cbl
  1350 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1351     12  DPRB-RATE-CODE            PIC X(4).
  1352     12  DPRB-COVERAGE-CATEG       PIC X.
  1353     12  DPRB-RETURN-CODE          PIC XX.
  1354         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1355         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1356         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1357         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1358         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1359         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1360         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1361         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1362         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1363     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1364     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1365     12  DPRB-BEN-TYPE             PIC XX.
  1366
  1367* DLO017
  1368 01  WS-DLO-VALID-RATE-CODE.
  1369     12  DVRC-RATE-CODE            PIC X(4).
  1370     12  DVRC-RETURN-CODE          PIC XX.
  1371         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1372         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1373         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1374         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1375         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1376         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1377
  1378* DLO019
  1379 01  WS-DLO-ORIG-COV-CAT.
  1380     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1381     12  DOCC-RETURN-CODE          PIC XX.
  1382     12  DOCC-ORIG-COV-CAT         PIC X.
  1383     12  DOCC-UNDERWITER           PIC XX.
  1384     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1385     12  DOCC-FILLER               PIC X(6).
  1386
  1387* DLO021
  1388 01  WS-DLO-VALID-LOAN-OFFICER.
  1389     12  DVLO-LOAN-OFFICER.
  1390         16  DVLO-BILL-TYPE        PIC X.
  1391         16  DVLO-BILL-SOURCE      PIC X.
  1392         16  DVLO-BATCH-TYPE       PIC X.
  1393     12  DVLO-RETURN-CODE          PIC XX.
  1394         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1395         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1396         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1397         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1398         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1399         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1400
  1401* DLO022
  1402 01  WS-DLO-VALID-STATE-CODE.
  1403     12  DVSC-STATE-CODE           PIC XX.
  1404     12  DVSC-RETURN-CODE          PIC XX.
  1405         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1406
  1407* DLO023
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  27
* EL050.cbl
  1408 01  WS-DLO-VALID-CODE-VALUES.
  1409     12  DVCV-SYSTEM-ID            PIC XX.
  1410         88  DVCV-CLAIMS                       VALUE 'CL'.
  1411         88  DVCV-CREDIT                       VALUE 'CR'.
  1412     12  DVCV-RECORD-TYPE          PIC XX.
  1413         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1414         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1415         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1416         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1417         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1418         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1419         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1420         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1421     12  DVCV-RECORD-KEY           PIC X(6).
  1422     12  DVCV-RETURN-CODE          PIC XX.
  1423         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1424         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1425         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1426         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1427         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1428         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1429         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1430     12  DVCV-CODE-DESC            PIC X(60).
  1431     12  DVCV-GEN-DESC-1           PIC X(20).
  1432     12  DVCV-GEN-DESC-2           PIC X(20).
  1433     12  DVCV-GEN-DESC-3           PIC X(20).
  1434
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  28
* EL050.cbl
  1436*    COPY ERCBXRF.
  1437******************************************************************
  1438*                                                                *
  1439*                                                                *
  1440*                            ERCBXRF                             *
  1441*                                                                *
  1442*   ONLINE CREDIT SYSTEM                                         *
  1443*                                                                *
  1444*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1445*                                                                *
  1446*   FILE TYPE = VSAM,KSDS                                        *
  1447*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1448*                                                                *
  1449*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1450*       ALTERNATE PATH = NONE                                    *
  1451*                                                                *
  1452*   LOG = NO                                                     *
  1453*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1454*                                                                *
  1455******************************************************************
  1456
  1457 01  BANK-CROSS-REFERENCE.
  1458     12  BK-RECORD-ID                PIC XX.
  1459         88  VALID-BK-ID             VALUE 'BK'.
  1460
  1461     12  BK-CONTROL-PRIMARY.
  1462         16  BK-COMPANY-CD           PIC X.
  1463         16  BK-CARRIER              PIC X.
  1464         16  BK-GROUPING             PIC X(6).
  1465         16  BK-BANK-NO              PIC X(10).
  1466
  1467     12  BK-MAINT-INFORMATION.
  1468         16  BK-LAST-MAINT-DT        PIC XX.
  1469         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1470         16  BK-LAST-MAINT-USER      PIC X(4).
  1471         16  FILLER                  PIC X(9).
  1472
  1473     12  FILLER                      PIC X(37).
  1474
  1475     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1476
  1477     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1478                            DEPENDING ON BK-BANK-POINTER-CNT.
  1479         16  BK-AM-ACCOUNT           PIC X(10).
  1480         16  BK-AM-EXP-DT            PIC XX.
  1481         16  BK-AM-EFF-DT            PIC XX.
  1482         16  BK-AM-STATE             PIC XX.
  1483         16  FILLER                  PIC X(20).
  1484
  1485******************************************************************
  1486
  1487*    COPY ERCCOMP.
  1488******************************************************************
  1489*                                                                *
  1490*                                                                *
  1491*                            ERCCOMP                             *
  1492*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1493*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  29
* EL050.cbl
  1494*                                                                *
  1495*   ONLINE CREDIT SYSTEM                                         *
  1496*                                                                *
  1497*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1498*                                                                *
  1499*   FILE TYPE = VSAM,KSDS                                        *
  1500*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1501*                                                                *
  1502*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1503*       ALTERNATE PATH = NONE                                    *
  1504*                                                                *
  1505*   LOG = NO                                                     *
  1506*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1507*                                                                *
  1508******************************************************************
  1509*                   C H A N G E   L O G
  1510*
  1511* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1512*-----------------------------------------------------------------
  1513*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1514* EFFECTIVE    NUMBER
  1515*-----------------------------------------------------------------
  1516* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1517* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1518* 092205    2005050300006  PEMA  ADD LEASE FEE
  1519* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1520* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1521* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1522* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1523* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1524* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1525******************************************************************
  1526
  1527 01  COMPENSATION-MASTER.
  1528     12  CO-RECORD-ID                          PIC XX.
  1529         88  VALID-CO-ID                          VALUE 'CO'.
  1530
  1531     12  CO-CONTROL-PRIMARY.
  1532         16  CO-COMPANY-CD                     PIC X.
  1533         16  CO-CONTROL.
  1534             20  CO-CTL-1.
  1535                 24  CO-CARR-GROUP.
  1536                     28  CO-CARRIER            PIC X.
  1537                     28  CO-GROUPING.
  1538                         32  CO-GROUP-PREFIX   PIC XXX.
  1539                         32  CO-GROUP-PRIME    PIC XXX.
  1540                 24  CO-RESP-NO.
  1541                     28  CO-RESP-PREFIX        PIC X(4).
  1542                     28  CO-RESP-PRIME         PIC X(6).
  1543             20  CO-CTL-2.
  1544                 24  CO-ACCOUNT.
  1545                     28  CO-ACCT-PREFIX        PIC X(4).
  1546                     28  CO-ACCT-PRIME         PIC X(6).
  1547         16  CO-TYPE                           PIC X.
  1548             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1549             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1550             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1551
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  30
* EL050.cbl
  1552     12  CO-MAINT-INFORMATION.
  1553         16  CO-LAST-MAINT-DT                  PIC XX.
  1554         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1555         16  CO-LAST-MAINT-USER                PIC X(4).
  1556     12  FILLER                                PIC XX.
  1557     12  CO-STMT-TYPE                          PIC XXX.
  1558     12  CO-COMP-TYPE                          PIC X.
  1559         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1560     12  CO-STMT-OWNER                         PIC X(4).
  1561     12  CO-BALANCE-CONTROL                    PIC X.
  1562         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1563         88  CO-NO-BALANCE                        VALUE 'N'.
  1564
  1565     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1566         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1567         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1568         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1569
  1570     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1571         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1572         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1573
  1574     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1575     12  CO-GA-DIRECT-DEP                      PIC X.
  1576     12  CO-FUTURE-SPACE                       PIC X.
  1577         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1578
  1579     12  CO-ACCT-NAME                          PIC X(30).
  1580     12  CO-MAIL-NAME                          PIC X(30).
  1581     12  CO-ADDR-1                             PIC X(30).
  1582     12  CO-ADDR-2                             PIC X(30).
  1583     12  CO-ADDR-3.
  1584         16  CO-ADDR-CITY                      PIC X(27).
  1585         16  CO-ADDR-STATE                     PIC XX.
  1586     12  CO-CSO-1099                           PIC X.
  1587     12  CO-ZIP.
  1588         16  CO-ZIP-PRIME.
  1589             20  CO-ZIP-PRI-1ST                PIC X.
  1590                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1591             20  FILLER                        PIC X(4).
  1592         16  CO-ZIP-PLUS4                      PIC X(4).
  1593     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1594         16  CO-CAN-POSTAL-1                   PIC XXX.
  1595         16  CO-CAN-POSTAL-2                   PIC XXX.
  1596         16  FILLER                            PIC XXX.
  1597     12  CO-SOC-SEC                            PIC X(13).
  1598     12  CO-TELEPHONE.
  1599         16  CO-AREA-CODE                      PIC XXX.
  1600         16  CO-PREFIX                         PIC XXX.
  1601         16  CO-PHONE                          PIC X(4).
  1602
  1603     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1604
  1605     12  CO-AR-BAL-LEVEL                       PIC X.
  1606         88  CO-AR-REF-LVL                        VALUE '1'.
  1607         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1608         88  CO-AR-BILL-LVL                       VALUE '2'.
  1609         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  31
* EL050.cbl
  1610         88  CO-AR-FR-LVL                         VALUE '4'.
  1611
  1612     12  CO-AR-NORMAL-PRINT                    PIC X.
  1613         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1614         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1615
  1616     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1617
  1618     12  CO-AR-REPORTING                       PIC X.
  1619         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1620         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1621
  1622     12  CO-AR-PULL-CHECK                      PIC X.
  1623         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1624         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1625
  1626     12  CO-AR-BALANCE-PRINT                   PIC X.
  1627         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1628
  1629     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1630         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1631         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1632         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1633
  1634     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1635
  1636     12  CO-USER-CODE                          PIC X.
  1637     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1638
  1639******************************************************************
  1640*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1641*    THE LAST MONTH END RUN.
  1642******************************************************************
  1643
  1644     12  CO-LAST-ACTIVITY-DATE.
  1645         16  CO-ACT-YEAR                       PIC 99.
  1646         16  CO-ACT-MONTH                      PIC 99.
  1647         16  CO-ACT-DAY                        PIC 99.
  1648
  1649     12  CO-LAST-STMT-DT.
  1650         16  CO-LAST-STMT-YEAR                 PIC 99.
  1651         16  CO-LAST-STMT-MONTH                PIC 99.
  1652         16  CO-LAST-STMT-DAY                  PIC 99.
  1653
  1654     12  CO-MO-END-TOTALS.
  1655         16  CO-MONTHLY-TOTALS.
  1656             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1657             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1658             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1659             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1660             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1661
  1662         16  CO-AGING-TOTALS.
  1663             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1664             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1665             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1666             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1667
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  32
* EL050.cbl
  1668         16  CO-YTD-TOTALS.
  1669             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1670             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1671
  1672         16  CO-OVER-UNDER-TOTALS.
  1673             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1674             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1675
  1676     12  CO-MISCELLANEOUS-TOTALS.
  1677         16  CO-FICA-TOTALS.
  1678             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1679             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1680
  1681         16  CO-CLAIM-TOTALS.
  1682             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1683             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1684
  1685******************************************************************
  1686*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1687*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1688******************************************************************
  1689
  1690     12  CO-CURRENT-TOTALS.
  1691         16  CO-CURRENT-LAST-STMT-DT.
  1692             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1693             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1694             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1695
  1696         16  CO-CURRENT-MONTHLY-TOTALS.
  1697             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1698             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1699             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1700             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1701             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1702
  1703         16  CO-CURRENT-AGING-TOTALS.
  1704             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1705             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1706             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1707             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1708
  1709         16  CO-CURRENT-YTD-TOTALS.
  1710             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1711             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1712
  1713     12  CO-PAID-COMM-TOTALS.
  1714         16  CO-YTD-PAID-COMMS.
  1715             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1716             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1717
  1718     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1719         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1720         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1721
  1722     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1723         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1724         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1725         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  33
* EL050.cbl
  1726         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1727         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1728         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1729         88  CO-FINAL-LETTER                  VALUE 'F'.
  1730         88  CO-RECONCILING                   VALUE 'R'.
  1731         88  CO-PHONE-CALL                    VALUE 'P'.
  1732         88  CO-LEGAL                         VALUE 'L'.
  1733         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1734         88  CO-WRITE-OFF                     VALUE 'W'.
  1735         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1736
  1737     12  CO-CSR-CODE                       PIC X(4).
  1738
  1739     12  CO-GA-STATUS-INFO.
  1740         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1741         16  CO-GA-TERMINATION-DT          PIC XX.
  1742         16  CO-GA-STATUS-CODE             PIC X.
  1743             88  CO-GA-ACTIVE                 VALUE 'A'.
  1744             88  CO-GA-INACTIVE               VALUE 'I'.
  1745             88  CO-GA-PENDING                VALUE 'P'.
  1746         16  CO-GA-COMMENTS.
  1747             20  CO-GA-COMMENT-1           PIC X(40).
  1748             20  CO-GA-COMMENT-2           PIC X(40).
  1749             20  CO-GA-COMMENT-3           PIC X(40).
  1750             20  CO-GA-COMMENT-4           PIC X(40).
  1751
  1752     12  CO-RPTCD2                         PIC X(10).
  1753     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1754         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1755         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1756
  1757     12  CO-TYPE-AGENT                     PIC X(01).
  1758         88  CO-CORPORATION                   VALUE 'C'.
  1759         88  CO-PARTNERSHIP                   VALUE 'P'.
  1760         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1761         88  CO-TRUST                         VALUE 'T'.
  1762         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1763
  1764     12  CO-FAXNO.
  1765         16  CO-FAX-AREA-CODE                  PIC XXX.
  1766         16  CO-FAX-PREFIX                     PIC XXX.
  1767         16  CO-FAX-PHONE                      PIC X(4).
  1768
  1769     12  CO-BANK-INFORMATION.
  1770         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1771         16  CO-BANK-TRANSIT-NON REDEFINES
  1772             CO-BANK-TRANSIT-NO                PIC 9(8).
  1773
  1774         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1775     12  CO-MISC-DEDUCT-INFO REDEFINES
  1776                  CO-BANK-INFORMATION.
  1777         16  CO-MD-GL-ACCT                     PIC X(10).
  1778         16  CO-MD-DIV                         PIC XX.
  1779         16  CO-MD-CENTER                      PIC X(4).
  1780         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1781         16  CO-CREATE-AP-CHECK                PIC X.
  1782         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1783         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  34
* EL050.cbl
  1784     12  CO-ACH-STATUS                         PIC X.
  1785         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1786         88  CO-ACH-PENDING                        VALUE 'P'.
  1787
  1788     12  CO-BILL-SW                            PIC X.
  1789     12  CO-CONTROL-NAME                       PIC X(30).
  1790     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1791     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1792     12  CO-CLP-STATE                          PIC XX.
  1793     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1794     12  CO-SPP-REFUND-EDIT                    PIC X.
  1795
  1796******************************************************************
  1797
  1798*    COPY ERCAGTC.
  1799******************************************************************
  1800*                                                                *
  1801*                                                                *
  1802*                            ERCAGTC                             *
  1803*                            VMOD=2.001                          *
  1804*                                                                *
  1805*   ONLINE CREDIT SYSTEM                                         *
  1806*                                                                *
  1807*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1808*                                                                *
  1809*   FILE TYPE = VSAM,KSDS                                        *
  1810*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1811*                                                                *
  1812*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1813*       ALTERNATE PATH = NONE                                    *
  1814*                                                                *
  1815*   LOG = NO                                                     *
  1816*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1817*                                                                *
  1818******************************************************************
  1819*                   C H A N G E   L O G
  1820*
  1821* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1822*-----------------------------------------------------------------
  1823*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1824* EFFECTIVE    NUMBER
  1825*-----------------------------------------------------------------
  1826* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1827* 111004                         NEW FILE AND COPYBOOK
  1828* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1829******************************************************************
  1830 01  AGENT-COMMISSIONS.
  1831     12  AG-RECORD-ID                          PIC XX.
  1832         88  VALID-CO-ID                          VALUE 'AG'.
  1833     12  AG-CONTROL-PRIMARY.
  1834         16  AG-COMPANY-CD                     PIC X.
  1835         16  AG-CONTROL.
  1836             20  AG-CTL-1.
  1837                 24  AG-CARR-GROUP.
  1838                     28  AG-CARRIER            PIC X.
  1839                     28  AG-GROUPING           PIC X(6).
  1840                 24  AG-BANK                   PIC X(10).
  1841             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  35
* EL050.cbl
  1842                 24  AG-EXP-DT                 PIC XX.
  1843         16  AG-TYPE                           PIC X.
  1844             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1845             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1846     12  AG-MAINT-INFORMATION.
  1847         16  AG-LAST-MAINT-DT                  PIC XX.
  1848         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1849         16  AG-LAST-MAINT-USER                PIC X(4).
  1850         16  FILLER                            PIC X(10).
  1851     12  AG-EFF-DT                             PIC XX.
  1852     12  AG-COMM-STRUCTURE.
  1853         16  AG-AGT-COMMS OCCURS 10.
  1854             20  AG-AGT                PIC X(10).
  1855             20  AG-COM-TYP            PIC X.
  1856             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1857             20  AG-RECALC-LV-INDIC    PIC X.
  1858             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1859             20  AG-LRCALC-LV-INDIC    PIC X.
  1860             20  FILLER                PIC X(05).
  1861     12  FILLER                  PIC X(145).
  1862******************************************************************
  1863*    COPY ERCRESS.
  1864******************************************************************
  1865*                                                                *
  1866*                            ERCRESS                             *
  1867*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1868*                            VMOD=2.002                          *
  1869*                                                                *
  1870*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1871*                                                                *
  1872*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1873*   VSAM RESIDENT STATE TAX MASTER                              *
  1874*                                                                *
  1875*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1876*                                                                *
  1877*   FILE TYPE = VSAM,KSDS                                        *
  1878*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1879*                                                                *
  1880*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1881*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1882*                                                                *
  1883*   LOG = NO                                                     *
  1884*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1885*                                                                *
  1886*                                                                *
  1887******************************************************************
  1888
  1889 01  RESIDENT-STATE-TAX-MASTER.
  1890
  1891     10  ERRESS-PRIMARY-KEY.
  1892         15  RES-COMPANY-CD        PIC X.
  1893         15  RES-RESIDENT-STATE    PIC XX.
  1894         15  RES-COVERAGE-CATEGORY PIC X.
  1895         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1896*                                      YYYYMMDD
  1897*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1898
  1899     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  36
* EL050.cbl
  1900
  1901         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1902         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1903         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  1904         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1905
  1906     10 RES-RECALC-SW              PIC   X.
  1907         88 RECALC                VALUE 'Y'.
  1908         88 NO-RECALC             VALUE 'N'.
  1909     10  RES-MAINT-BY              PIC X(4).
  1910     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1911     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1912*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  37
* EL050.cbl
  1914*    COPY ERCRESC.
  1915******************************************************************
  1916*                                                                *
  1917*                            ERCRESC                             *
  1918*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1919*                            VMOD=2.003                          *
  1920*                                                                *
  1921*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1922*                                                                *
  1923*   FILE TYPE = VSAM,KSDS                                        *
  1924*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1925*                                                                *
  1926*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1927*       ALTERNATE PATH1 = NONE                                   *
  1928*                                                                *
  1929*   LOG = NO                                                     *
  1930*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1931*                                                                *
  1932******************************************************************
  1933
  1934 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1935
  1936     10  ERRESC-RECORD-KEY.
  1937         15  RESC-COMPANY-CD           PIC   X.
  1938         15  RESC-CARRIER              PIC   X.
  1939         15  RESC-GROUP                PIC   X(6).
  1940         15  RESC-STATE                PIC   XX.
  1941         15  RESC-ACCOUNT              PIC   X(10).
  1942         15  RESC-AGENT                PIC   X(10).
  1943         15  RESC-RESIDENT-STATE       PIC   XX.
  1944         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1945*                                           YYYYMMDD
  1946     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1947
  1948     10  RESC-COMM-RECORD-DATA.
  1949         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1950             20 RESC-COVERAGE-CAT      PIC    X.
  1951             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1952             20 RESC-COMMISSION-TAB REDEFINES
  1953                RESC-COMMISSION-PER    PIC  XXX.
  1954
  1955     10  RESC-MAINT-BY                 PIC X(4).
  1956     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  1957     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  1958*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  38
* EL050.cbl
  1960*    COPY ERCPLAN.
  1961******************************************************************
  1962*                                                                *
  1963*                                                                *
  1964*                            ERCPLAN                             *
  1965*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1966*                            VMOD=2.003                          *
  1967*                                                                *
  1968*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  1969*                                                                *
  1970*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  1971*   PLAN MASTER                                                  *
  1972*                                                                *
  1973*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  1974*                                                                *
  1975*   FILE TYPE = VSAM,KSDS                                        *
  1976*   RECORD SIZE = 420   RECFORM = FIX                            *
  1977*                                                                *
  1978*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  1979*       ALTERNATE PATH1 = N/A                                    *
  1980*                                                                *
  1981*   LOG = NO                                                     *
  1982*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1983*                                                                *
  1984*                                                                *
  1985******************************************************************
  1986
  1987 01  PLAN-MASTER.
  1988     12  PL-RECORD-ID                      PIC XX.
  1989         88  VALID-PL-ID                      VALUE 'PL'.
  1990
  1991     12  PL-CONTROL-PRIMARY.
  1992         16  PL-COMPANY-CD                 PIC X.
  1993         16  PL-MSTR-CNTRL.
  1994             20  PL-CONTROL-A.
  1995                 24  PL-CARRIER            PIC X.
  1996                 24  PL-GROUPING           PIC X(6).
  1997                 24  PL-STATE              PIC XX.
  1998                 24  PL-ACCOUNT            PIC X(10).
  1999             20  PL-BENEFIT-TYPE           PIC X.
  2000             20  PL-BENEFIT-CODE           PIC XX.
  2001             20  PL-REVISION-NO            PIC X(3).
  2002
  2003     12  PL-CONTROL-BY-VAR-GRP.
  2004         16  PL-COMPANY-CD-A1              PIC X.
  2005         16  PL-VG-CARRIER                 PIC X.
  2006         16  PL-VG-GROUPING                PIC X(6).
  2007         16  PL-VG-STATE                   PIC XX.
  2008         16  PL-VG-ACCOUNT                 PIC X(10).
  2009         16  PL-BENEFIT-TYPE-A1            PIC X.
  2010         16  PL-BENEFIT-CODE-A1            PIC XX.
  2011         16  PL-REVISION-NO-A1             PIC 999.
  2012
  2013     12  PL-MAINT-INFORMATION.
  2014         16  PL-LAST-MAINT-DT              PIC XX.
  2015         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2016         16  PL-LAST-MAINT-USER            PIC X(4).
  2017         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  39
* EL050.cbl
  2018
  2019     12  PL-LIABILITY-LIMITS.
  2020         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2021         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2022             20  PL-LM-AGE                 PIC S99        COMP-3.
  2023             20  PL-LM-DUR                 PIC S999       COMP-3.
  2024             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2025             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2026
  2027     12  FILLER                            PIC X(30).
  2028
  2029     12  PL-GL-ACCOUNT-NOS.
  2030         16  PL-PREMIUM-GL                 PIC X(8).
  2031         16  PL-COMM-GL                    PIC X(8).
  2032         16  PL-CLAIM-GL                   PIC X(8).
  2033     12  FILLER                            PIC X(24).
  2034     12  PL-TOLERANCES.
  2035         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2036         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2037         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2038         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2039         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2040         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2041     12  PL-OVER-SHORT.
  2042         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2043         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2044     12  FILLER                            PIC X(24).
  2045     12  PLAN-MISC.
  2046         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2047         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2048         16  PL-IG                         PIC X.
  2049         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2050         16  PL-POLICY-FORM                PIC X(12).
  2051         16  PL-EDIT-FOR-FORM              PIC X(01).
  2052         16  PL-DEV-CODE                   PIC XXX.
  2053         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2054         16  PL-CALC-METHOD                PIC X.
  2055         16  PL-BENEFIT-GROUP              PIC X(05).
  2056         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2057
  2058         16  FILLER                        PIC X(99).
  2059******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  40
* EL050.cbl
  2061*    COPY ELCCERT.
  2062******************************************************************
  2063*                                                                *
  2064*                            ELCCERT.                            *
  2065*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2066*                            VMOD=2.013                          *
  2067*                                                                *
  2068*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2069*                                                                *
  2070*   FILE TYPE = VSAM,KSDS                                        *
  2071*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2072*                                                                *
  2073*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2074*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2075*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2076*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2077*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2078*                                                                *
  2079*   LOG = YES                                                    *
  2080*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2081******************************************************************
  2082*                   C H A N G E   L O G
  2083*
  2084* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2085*-----------------------------------------------------------------
  2086*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2087* EFFECTIVE    NUMBER
  2088*-----------------------------------------------------------------
  2089* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2090* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2091* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2092* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2093* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2094* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2095* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2096* 032612  CR2011110200001  PEMA  AHL CHANGES
  2097******************************************************************
  2098
  2099 01  CERTIFICATE-MASTER.
  2100     12  CM-RECORD-ID                      PIC XX.
  2101         88  VALID-CM-ID                      VALUE 'CM'.
  2102
  2103     12  CM-CONTROL-PRIMARY.
  2104         16  CM-COMPANY-CD                 PIC X.
  2105         16  CM-CARRIER                    PIC X.
  2106         16  CM-GROUPING.
  2107             20  CM-GROUPING-PREFIX        PIC X(3).
  2108             20  CM-GROUPING-PRIME         PIC X(3).
  2109         16  CM-STATE                      PIC XX.
  2110         16  CM-ACCOUNT.
  2111             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2112             20  CM-ACCOUNT-PRIME          PIC X(6).
  2113         16  CM-CERT-EFF-DT                PIC XX.
  2114         16  CM-CERT-NO.
  2115             20  CM-CERT-PRIME             PIC X(10).
  2116             20  CM-CERT-SFX               PIC X.
  2117
  2118     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  41
* EL050.cbl
  2119         16  CM-COMPANY-CD-A1              PIC X.
  2120         16  CM-INSURED-LAST-NAME          PIC X(15).
  2121         16  CM-INSURED-INITIALS.
  2122             20  CM-INSURED-INITIAL1       PIC X.
  2123             20  CM-INSURED-INITIAL2       PIC X.
  2124
  2125     12  CM-CONTROL-BY-SSN.
  2126         16  CM-COMPANY-CD-A2              PIC X.
  2127         16  CM-SOC-SEC-NO.
  2128             20  CM-SSN-STATE              PIC XX.
  2129             20  CM-SSN-ACCOUNT            PIC X(6).
  2130             20  CM-SSN-LN3.
  2131                 25  CM-INSURED-INITIALS-A2.
  2132                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2133                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2134                 25 CM-PART-LAST-NAME-A2         PIC X.
  2135
  2136     12  CM-CONTROL-BY-CERT-NO.
  2137         16  CM-COMPANY-CD-A4              PIC X.
  2138         16  CM-CERT-NO-A4                 PIC X(11).
  2139
  2140     12  CM-CONTROL-BY-MEMB.
  2141         16  CM-COMPANY-CD-A5              PIC X.
  2142         16  CM-MEMBER-NO.
  2143             20  CM-MEMB-STATE             PIC XX.
  2144             20  CM-MEMB-ACCOUNT           PIC X(6).
  2145             20  CM-MEMB-LN4.
  2146                 25  CM-INSURED-INITIALS-A5.
  2147                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2148                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2149                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2150
  2151     12  CM-INSURED-PROFILE-DATA.
  2152         16  CM-INSURED-FIRST-NAME.
  2153             20  CM-INSURED-1ST-INIT       PIC X.
  2154             20  FILLER                    PIC X(9).
  2155         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2156         16  CM-INSURED-SEX                PIC X.
  2157             88  CM-SEX-MALE                  VALUE 'M'.
  2158             88  CM-SEX-FEMAL                 VALUE 'F'.
  2159         16  CM-INSURED-JOINT-AGE          PIC 99.
  2160         16  CM-JOINT-INSURED-NAME.
  2161             20  CM-JT-LAST-NAME           PIC X(15).
  2162             20  CM-JT-FIRST-NAME.
  2163                 24  CM-JT-1ST-INIT        PIC X.
  2164                 24  FILLER                PIC X(9).
  2165             20  CM-JT-INITIAL             PIC X.
  2166
  2167     12  CM-LIFE-DATA.
  2168         16  CM-LF-BENEFIT-CD              PIC XX.
  2169         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2170         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2171         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2172         16  CM-LF-DEV-CODE                PIC XXX.
  2173         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2174         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2175         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2176         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  42
* EL050.cbl
  2177         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2178         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2179         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2180         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2181         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2182         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2183         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2184         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2185         16  FILLER                        PIC XX.
  2186
  2187     12  CM-AH-DATA.
  2188         16  CM-AH-BENEFIT-CD              PIC XX.
  2189         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2190         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2191         16  CM-AH-DEV-CODE                PIC XXX.
  2192         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2193         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2194         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2195         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2196         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2197         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2198         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2199         16  CM-AH-PAID-THRU-DT            PIC XX.
  2200             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2201         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2202         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2203         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2204         16  FILLER                        PIC X.
  2205
  2206     12  CM-LOAN-INFORMATION.
  2207         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2208         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2209                                           PIC S9(5)V99  COMP-3.
  2210         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2211         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2212         16  CM-PAY-FREQUENCY              PIC S99.
  2213         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2214         16  CM-RATE-CLASS                 PIC XX.
  2215         16  CM-BENEFICIARY                PIC X(25).
  2216         16  CM-POLICY-FORM-NO             PIC X(12).
  2217         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2218         16  CM-LAST-ADD-ON-DT             PIC XX.
  2219         16  CM-DEDUCTIBLE-AMOUNTS.
  2220             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2221             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2222         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2223             20  CM-RESIDENT-STATE         PIC XX.
  2224             20  CM-RATE-CODE              PIC X(4).
  2225             20  FILLER                    PIC XX.
  2226         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2227             20  CM-LOAN-OFFICER           PIC X(5).
  2228             20  FILLER                    PIC XXX.
  2229         16  CM-CSR-CODE                   PIC XXX.
  2230         16  CM-UNDERWRITING-CODE          PIC X.
  2231             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2232         16  CM-POST-CARD-IND              PIC X.
  2233         16  CM-NH-INTERFACE-SW            PIC X.
  2234         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  43
* EL050.cbl
  2235             88  CM-SING-PRM                  VALUE '1'.
  2236             88  CM-O-B-COVERAGE              VALUE '2'.
  2237             88  CM-OPEN-END                  VALUE '3'.
  2238         16  CM-IND-GRP-TYPE               PIC X.
  2239             88  CM-INDIVIDUAL                VALUE 'I'.
  2240             88  CM-GROUP                     VALUE 'G'.
  2241         16  CM-SKIP-CODE                  PIC X.
  2242             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2243             88  SKIP-JULY                    VALUE '1'.
  2244             88  SKIP-AUGUST                  VALUE '2'.
  2245             88  SKIP-SEPTEMBER               VALUE '3'.
  2246             88  SKIP-JULY-AUG                VALUE '4'.
  2247             88  SKIP-AUG-SEPT                VALUE '5'.
  2248             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2249             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2250             88  SKIP-JUNE                    VALUE '8'.
  2251             88  SKIP-JUNE-JULY               VALUE '9'.
  2252             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2253             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2254         16  CM-PAYMENT-MODE               PIC X.
  2255             88  PAY-MONTHLY                  VALUE SPACE.
  2256             88  PAY-WEEKLY                   VALUE '1'.
  2257             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2258             88  PAY-BI-WEEKLY                VALUE '3'.
  2259             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2260         16  CM-LOAN-NUMBER                PIC X(8).
  2261         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2262         16  CM-OLD-LOF                    PIC XXX.
  2263*        16  CM-LOAN-OFFICER               PIC XXX.
  2264         16  CM-REIN-TABLE                 PIC XXX.
  2265         16  CM-SPECIAL-REIN-CODE          PIC X.
  2266         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2267         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2268         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2269
  2270     12  CM-STATUS-DATA.
  2271         16  CM-ENTRY-STATUS               PIC X.
  2272         16  CM-ENTRY-DT                   PIC XX.
  2273
  2274         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2275         16  CM-LF-CANCEL-DT               PIC XX.
  2276         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2277
  2278         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2279         16  CM-LF-DEATH-DT                PIC XX.
  2280         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2281
  2282         16  CM-LF-CURRENT-STATUS          PIC X.
  2283             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2284                                                'M' '4' '5' '9'.
  2285             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2286             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2287             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2288             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2289             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2290             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2291             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2292             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  44
* EL050.cbl
  2293             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2294             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2295             88  CM-LF-DECLINED               VALUE 'D'.
  2296             88  CM-LF-VOIDED                 VALUE 'V'.
  2297
  2298         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2299         16  CM-AH-CANCEL-DT               PIC XX.
  2300         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2301
  2302         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2303         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2304         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2305
  2306         16  CM-AH-CURRENT-STATUS          PIC X.
  2307             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2308                                                'M' '4' '5' '9'.
  2309             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2310             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2311             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2312             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2313             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2314             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2315             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2316             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2317             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2318             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2319             88  CM-AH-DECLINED               VALUE 'D'.
  2320             88  CM-AH-VOIDED                 VALUE 'V'.
  2321
  2322         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2323             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2324             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2325             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2326         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2327
  2328         16  CM-ENTRY-BATCH                PIC X(6).
  2329         16  CM-LF-EXIT-BATCH              PIC X(6).
  2330         16  CM-AH-EXIT-BATCH              PIC X(6).
  2331         16  CM-LAST-MONTH-END             PIC XX.
  2332
  2333     12  CM-NOTE-SW                        PIC X.
  2334         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2335         88  CERT-NOTES-PRESENT               VALUE '1'.
  2336         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2337         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2338         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2339         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2340         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2341         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2342     12  CM-COMP-EXCP-SW                   PIC X.
  2343         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2344         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2345     12  CM-INSURED-ADDRESS-SW             PIC X.
  2346         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2347         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2348
  2349*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2350     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  45
* EL050.cbl
  2351     12  FILLER                            PIC X.
  2352
  2353*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2354     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2355     12  FILLER                            PIC X.
  2356*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2357     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2358
  2359     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2360         88  CERT-ADDED-BATCH                 VALUE ' '.
  2361         88  CERT-ADDED-ONLINE                VALUE '1'.
  2362         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2363         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2364         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2365     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2366         88  CERT-AS-LOADED                   VALUE ' '.
  2367         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2368         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2369         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2370         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2371         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2372         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2373         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2374
  2375     12  CM-ACCOUNT-COMM-PCTS.
  2376         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2377         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2378
  2379     12  CM-USER-FIELD                     PIC X.
  2380     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2381     12  CM-CLP-STATE                      PIC XX.
  2382     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2383     12  CM-USER-RESERVED                  PIC XXX.
  2384     12  FILLER REDEFINES CM-USER-RESERVED.
  2385         16  CM-AH-CLASS-CD                PIC XX.
  2386         16  F                             PIC X.
  2387******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  46
* EL050.cbl
  2389*    COPY ERCMAIL.
  2390******************************************************************
  2391*                                                                *
  2392*                                                                *
  2393*                            ERCMAIL                             *
  2394*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2395*                            VMOD=2.003                          *
  2396*                                                                *
  2397*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2398*                                                                *
  2399*   FILE TYPE = VSAM,KSDS                                        *
  2400*   RECORD SIZE = 374   RECFORM = FIX                            *
  2401*                                                                *
  2402*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2403*   ALTERNATE PATH    = NOT USED                                 *
  2404*                                                                *
  2405*   LOG = YES                                                    *
  2406*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2407******************************************************************
  2408*                   C H A N G E   L O G
  2409*
  2410* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2411*-----------------------------------------------------------------
  2412*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2413* EFFECTIVE    NUMBER
  2414*-----------------------------------------------------------------
  2415* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2416* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2417* 111108                   PEMA  ADD CRED BENE ADDR2
  2418******************************************************************
  2419
  2420 01  MAILING-DATA.
  2421     12  MA-RECORD-ID                      PIC XX.
  2422         88  VALID-MA-ID                       VALUE 'MA'.
  2423
  2424     12  MA-CONTROL-PRIMARY.
  2425         16  MA-COMPANY-CD                 PIC X.
  2426         16  MA-CARRIER                    PIC X.
  2427         16  MA-GROUPING.
  2428             20  MA-GROUPING-PREFIX        PIC XXX.
  2429             20  MA-GROUPING-PRIME         PIC XXX.
  2430         16  MA-STATE                      PIC XX.
  2431         16  MA-ACCOUNT.
  2432             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2433             20  MA-ACCOUNT-PRIME          PIC X(6).
  2434         16  MA-CERT-EFF-DT                PIC XX.
  2435         16  MA-CERT-NO.
  2436             20  MA-CERT-PRIME             PIC X(10).
  2437             20  MA-CERT-SFX               PIC X.
  2438
  2439     12  FILLER                            PIC XX.
  2440
  2441     12  MA-ACCESS-CONTROL.
  2442         16  MA-SOURCE-SYSTEM              PIC XX.
  2443             88  MA-FROM-CREDIT                VALUE 'CR'.
  2444             88  MA-FROM-VSI                   VALUE 'VS'.
  2445             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2446             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  47
* EL050.cbl
  2447         16  MA-RECORD-ADD-DT              PIC XX.
  2448         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2449         16  MA-LAST-MAINT-DT              PIC XX.
  2450         16  MA-LAST-MAINT-BY              PIC XXXX.
  2451         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2452
  2453     12  MA-PROFILE-INFO.
  2454         16  MA-QUALIFY-CODE-1             PIC XX.
  2455         16  MA-QUALIFY-CODE-2             PIC XX.
  2456         16  MA-QUALIFY-CODE-3             PIC XX.
  2457         16  MA-QUALIFY-CODE-4             PIC XX.
  2458         16  MA-QUALIFY-CODE-5             PIC XX.
  2459
  2460         16  MA-INSURED-LAST-NAME          PIC X(15).
  2461         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2462         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2463         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2464         16  MA-INSURED-BIRTH-DT           PIC XX.
  2465         16  MA-INSURED-SEX                PIC X.
  2466             88  MA-SEX-MALE                   VALUE 'M'.
  2467             88  MA-SEX-FEMALE                 VALUE 'F'.
  2468         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2469
  2470         16  MA-ADDRESS-CORRECTED          PIC X.
  2471         16  MA-JOINT-BIRTH-DT             PIC XX.
  2472*        16  FILLER                        PIC X(12).
  2473
  2474         16  MA-ADDRESS-LINE-1             PIC X(30).
  2475         16  MA-ADDRESS-LINE-2             PIC X(30).
  2476         16  MA-CITY-STATE.
  2477             20  MA-CITY                   PIC X(28).
  2478             20  MA-ADDR-STATE             PIC XX.
  2479         16  MA-ZIP.
  2480             20  MA-ZIP-CODE.
  2481                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2482                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2483                 24  FILLER                PIC X(4).
  2484             20  MA-ZIP-PLUS4              PIC X(4).
  2485         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2486             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2487             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2488             20  FILLER                    PIC X(3).
  2489
  2490         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2491
  2492         16  FILLER                        PIC XXX.
  2493*        16  FILLER                        PIC X(10).
  2494
  2495     12  MA-CRED-BENE-INFO.
  2496         16  MA-CRED-BENE-NAME                 PIC X(25).
  2497         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2498         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2499         16  MA-CRED-BENE-CTYST.
  2500             20  MA-CRED-BENE-CITY             PIC X(28).
  2501             20  MA-CRED-BENE-STATE            PIC XX.
  2502         16  MA-CRED-BENE-ZIP.
  2503             20  MA-CB-ZIP-CODE.
  2504                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  48
* EL050.cbl
  2505                     88  MA-CB-CANADIAN-POST-CODE
  2506                                           VALUE 'A' THRU 'Z'.
  2507                 24  FILLER                    PIC X(4).
  2508             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2509         16  MA-CB-CANADIAN-POSTAL-CODE
  2510                            REDEFINES MA-CRED-BENE-ZIP.
  2511             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2512             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2513             20  FILLER                        PIC X(3).
  2514     12  MA-POST-CARD-MAIL-DATA.
  2515         16  MA-MAIL-DATA OCCURS 7.
  2516             20  MA-MAIL-TYPE              PIC X.
  2517                 88  MA-12MO-MAILING           VALUE '1'.
  2518                 88  MA-EXP-MAILING            VALUE '2'.
  2519             20  MA-MAIL-STATUS            PIC X.
  2520                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2521                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2522                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2523             20  MA-MAIL-DATE              PIC XX.
  2524     12  FILLER                            PIC XX.
  2525     12  FILLER                            PIC XX.
  2526*    12  FILLER                            PIC X(30).
  2527******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  49
* EL050.cbl
  2529*    COPY ERCPNDM.
  2530******************************************************************
  2531*                                                                *
  2532*                                                                *
  2533*                            ERCPNDM                             *
  2534*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2535*                            VMOD=2.003                          *
  2536*                                                                *
  2537*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2538*                                                                *
  2539*   FILE TYPE = VSAM,KSDS                                        *
  2540*   RECORD SIZE = 374   RECFORM = FIX                            *
  2541*                                                                *
  2542*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2543*   ALTERNATE PATH    = NOT USED                                 *
  2544*                                                                *
  2545*   LOG = YES                                                    *
  2546*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2547******************************************************************
  2548*                   C H A N G E   L O G
  2549*
  2550* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2551*-----------------------------------------------------------------
  2552*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2553* EFFECTIVE    NUMBER
  2554*-----------------------------------------------------------------
  2555* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2556* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2557* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2558******************************************************************
  2559
  2560 01  PENDING-MAILING-DATA.
  2561     12  PM-RECORD-ID                      PIC XX.
  2562         88  VALID-MA-ID                       VALUE 'PM'.
  2563
  2564     12  PM-CONTROL-PRIMARY.
  2565         16  PM-COMPANY-CD                 PIC X.
  2566         16  PM-ENTRY-BATCH                PIC X(6).
  2567         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2568         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2569
  2570     12  FILLER                            PIC X(14).
  2571
  2572     12  PM-ACCESS-CONTROL.
  2573         16  PM-SOURCE-SYSTEM              PIC XX.
  2574             88  PM-FROM-CREDIT                VALUE 'CR'.
  2575             88  PM-FROM-VSI                   VALUE 'VS'.
  2576             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2577             88  PM-FROM-OTHER                 VALUE 'OT'.
  2578         16  PM-RECORD-ADD-DT              PIC XX.
  2579         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2580         16  PM-LAST-MAINT-DT              PIC XX.
  2581         16  PM-LAST-MAINT-BY              PIC XXXX.
  2582         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2583
  2584     12  PM-PROFILE-INFO.
  2585         16  PM-QUALIFY-CODE-1             PIC XX.
  2586         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  50
* EL050.cbl
  2587         16  PM-QUALIFY-CODE-3             PIC XX.
  2588         16  PM-QUALIFY-CODE-4             PIC XX.
  2589         16  PM-QUALIFY-CODE-5             PIC XX.
  2590
  2591         16  PM-INSURED-LAST-NAME          PIC X(15).
  2592         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2593         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2594         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2595         16  PM-INSURED-BIRTH-DT           PIC XX.
  2596         16  PM-INSURED-SEX                PIC X.
  2597             88  PM-SEX-MALE                   VALUE 'M'.
  2598             88  PM-SEX-FEMALE                 VALUE 'F'.
  2599         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2600
  2601         16  PM-ADDRESS-CORRECTED          PIC X.
  2602         16  PM-JOINT-BIRTH-DT             PIC XX.
  2603*        16  FILLER                        PIC X(12).
  2604
  2605         16  PM-ADDRESS-LINE-1             PIC X(30).
  2606         16  PM-ADDRESS-LINE-2             PIC X(30).
  2607         16  PM-CITY-STATE.
  2608             20  PM-CITY                   PIC X(28).
  2609             20  PM-STATE                  PIC XX.
  2610         16  PM-ZIP.
  2611             20  PM-ZIP-CODE.
  2612                 24  PM-ZIP-1              PIC X.
  2613                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2614                 24  FILLER                PIC X(4).
  2615             20  PM-ZIP-PLUS4              PIC X(4).
  2616         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2617             20  PM-CAN-POST1              PIC XXX.
  2618             20  PM-CAN-POST2              PIC XXX.
  2619             20  FILLER                    PIC XXX.
  2620
  2621         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2622
  2623         16  FILLER                        PIC X(03).
  2624
  2625     12  PM-CRED-BENE-INFO.
  2626         16  PM-CRED-BENE-NAME             PIC X(25).
  2627         16  PM-CRED-BENE-ADDR             PIC X(30).
  2628         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2629         16  PM-CRED-BENE-CTYST.
  2630             20  PM-CRED-BENE-CITY         PIC X(28).
  2631             20  PM-CRED-BENE-STATE        PIC XX.
  2632         16  PM-CRED-BENE-ZIP.
  2633             20  PM-CB-ZIP-CODE.
  2634                 24  PM-CB-ZIP-1           PIC X.
  2635                     88  PM-CB-CANADIAN-POST-CODE
  2636                                  VALUE 'A' THRU 'Z'.
  2637                 24  FILLER                PIC X(4).
  2638             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2639         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2640             20  PM-CB-CAN-POST1           PIC XXX.
  2641             20  PM-CB-CAN-POST2           PIC XXX.
  2642             20  FILLER                    PIC XXX.
  2643     12  PM-POST-CARD-MAIL-DATA.
  2644         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  51
* EL050.cbl
  2645             20  PM-MAIL-TYPE              PIC X.
  2646                 88  PM-12MO-MAILING           VALUE '1'.
  2647                 88  PM-EXP-MAILING            VALUE '2'.
  2648             20  PM-MAIL-STATUS            PIC X.
  2649                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2650                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2651                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2652             20  PM-MAIL-DATE              PIC XX.
  2653     12  FILLER                            PIC XX.
  2654     12  FILLER                            PIC X(12).
  2655*    12  FILLER                            PIC X(30).
  2656
  2657******************************************************************
  2658*                                COPY ERCLOFC.
  2659******************************************************************
  2660*                                                                *
  2661*                                                                *
  2662*                            ERCLOFC                             *
  2663*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2664*                            VMOD=2.003                          *
  2665*                                                                *
  2666*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2667*                                                                *
  2668*   FILE TYPE = VSAM,KSDS                                        *
  2669*   RECORD SIZE = 670   RECFORM = FIX                            *
  2670*                                                                *
  2671*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2672*                                                                *
  2673*   LOG = YES                                                    *
  2674*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2675*                                                                *
  2676******************************************************************
  2677
  2678 01  LOAN-OFFICER-MASTER.
  2679     12  LO-RECORD-ID                PIC XX.
  2680         88  VALID-LO-ID                VALUE 'LO'.
  2681
  2682     12  LO-CONTROL-PRIMARY.
  2683         16  LO-COMPANY-CD           PIC X.
  2684         16  LO-CARRIER              PIC X.
  2685         16  LO-GROUPING.
  2686             20  LO-GROUPING-PREFIX  PIC XXX.
  2687             20  LO-GROUPING-PRIME   PIC XXX.
  2688         16  LO-STATE                PIC XX.
  2689         16  LO-ACCOUNT.
  2690             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2691             20  LO-ACCOUNT-PRIME    PIC X(6).
  2692         16  LO-OFFICER-CODE         PIC X(5).
  2693
  2694     12  LO-OFFICER-NAME             PIC X(30).
  2695
  2696     12  LO-LAST-MAINT-DT            PIC XX.
  2697     12  LO-LAST-USER                PIC X(4).
  2698     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2699
  2700     12  LO-COMP-CONTROL             PIC X.
  2701             88  LO-SHOW-COMP           VALUE 'Y'.
  2702             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  52
* EL050.cbl
  2703     12  LO-DETAIL-CONTROL           PIC X.
  2704             88  LO-PRINT-DETAIL        VALUE 'D'.
  2705             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2706
  2707     12  LO-SV-CARRIER               PIC X.
  2708     12  LO-SV-GROUPING              PIC X(6).
  2709     12  LO-SV-STATE                 PIC XX.
  2710
  2711     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2712     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2713
  2714     12  LO-OFFICER-INFO.
  2715         16  FILLER OCCURS 12 TIMES.
  2716             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2717             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2718             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2719             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2720             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2721             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2722             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2723             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2724     12  FILLER                      PIC X(198).
  2725******************************************************************
  2726*                                COPY ERCPDEF.
  2727******************************************************************
  2728*                                                                *
  2729*                                                                *
  2730*                            ERCPDEF.                            *
  2731*                                                                *
  2732*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2733*                                                                *
  2734*    FILE TYPE = VSAM,KSDS                                       *
  2735*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2736*                                                                *
  2737*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2738*                                                                *
  2739*    LOG = YES                                                   *
  2740*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2741******************************************************************
  2742 01  PRODUCT-MASTER.
  2743    12  PD-RECORD-ID                 PIC X(02).
  2744        88  VALID-PD-ID                  VALUE 'PD'.
  2745    12  PD-CONTROL-PRIMARY.
  2746        16  PD-COMPANY-CD            PIC X.
  2747        16  PD-STATE                 PIC XX.
  2748        16  PD-PRODUCT-CD            PIC XXX.
  2749        16  PD-FILLER                PIC X(7).
  2750        16  PD-BEN-TYPE              PIC X.
  2751        16  PD-BEN-CODE              PIC XX.
  2752        16  PD-PROD-EXP-DT           PIC XX.
  2753    12  FILLER                       PIC X(50).
  2754    12  PD-PRODUCT-DATA OCCURS 8.
  2755        16  PD-PROD-CODE             PIC X.
  2756            88  PD-PROD-LIFE           VALUE 'L'.
  2757            88  PD-PROD-PROP           VALUE 'P'.
  2758            88  PD-PROD-AH             VALUE 'A'.
  2759            88  PD-PROD-IU             VALUE 'I'.
  2760            88  PD-PROD-GAP            VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  53
* EL050.cbl
  2761        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2762        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2763        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2764        16  PD-MAX-TERM              PIC S999        COMP-3.
  2765        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2766        16  FILLER                   PIC X.
  2767        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2768        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2769        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2770        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2771        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2772        16  PD-REC-CRIT-PERIOD       PIC X.
  2773        16  PD-RTW-MOS               PIC 99.
  2774        16  FILLER                   PIC X(5).
  2775    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2776    12  PD-TERM-LIMITS OCCURS 15.
  2777        16  PD-LOW-TERM              PIC S999        COMP-3.
  2778        16  PD-HI-TERM               PIC S999        COMP-3.
  2779*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2780    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2781        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2782        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2783    12  PD-EARN-FACTORS.
  2784        16  FILLER OCCURS 15.
  2785            20  FILLER OCCURS 15.
  2786                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2787    12  PD-PRODUCT-DESC              PIC X(80).
  2788    12  PD-TRUNCATED                 PIC X.
  2789    12  FILLER                       PIC X(59).
  2790    12  PD-MAINT-INFORMATION.
  2791        16  PD-LAST-MAINT-DT         PIC X(02).
  2792        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2793        16  PD-LAST-MAINT-BY         PIC X(04).
  2794*                                COPY ELCSTATE.
  2795******************************************************************
  2796*                                                                *
  2797*                                                                *
  2798*                            ELCSTATE.                           *
  2799*                                                                *
  2800*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2801*                                                                *
  2802*   FILE TYPE = VSAM,KSDS                                        *
  2803*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2804*                                                                *
  2805*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2806*       ALTERNATE INDEX = NONE                                   *
  2807*                                                                *
  2808*   LOG = YES                                                    *
  2809*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2810******************************************************************
  2811*                   C H A N G E   L O G
  2812*
  2813* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2814*-----------------------------------------------------------------
  2815*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2816* EFFECTIVE    NUMBER
  2817*-----------------------------------------------------------------
  2818* 122710  CR2010012700001  PEMA  NEW COPYBOOK
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  54
* EL050.cbl
  2819******************************************************************
  2820*
  2821 01  STATE-FILE.
  2822     12  SF-RECORD-ID                       PIC XX.
  2823         88  VALID-CF-ID                        VALUE 'SF'.
  2824     12  SF-CONTROL-PRIMARY.
  2825         16  SF-COMPANY-ID                  PIC XXX.
  2826         16  SF-CARRIER-CODE                PIC X.
  2827         16  SF-GROUPING                    PIC X(6).
  2828         16  SF-STATE-CODE                  PIC XX.
  2829         16  SF-EXPIRE-DATE                 PIC 9(8).
  2830****************************************************************
  2831*             STATE CONTROLS
  2832****************************************************************
  2833     12  SF-LAST-MAINT-DT                   PIC XX.
  2834     12  SF-LAST-MAINT-BY                   PIC X(4).
  2835     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2836     12  SF-STATE-RT-CONTROLS.
  2837         16  SF-ST-RT-CALC                  PIC X.
  2838     12  SF-ST-TAX-CONTROLS.
  2839         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2840         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2841         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2842     12  SF-ST-REFUND-OPTIONS.
  2843         16  SF-ST-RF-LR-CALC               PIC X.
  2844         16  SF-ST-RF-LL-CALC               PIC X.
  2845         16  SF-ST-RF-LN-CALC               PIC X.
  2846         16  SF-ST-RF-AH-CALC               PIC X.
  2847         16  SF-ST-RF-CP-CALC               PIC X.
  2848     12  SF-ST-UNEARN-PREM-OPTIONS.
  2849         16  SF-ST-LUEP-R78                 PIC X.
  2850         16  SF-ST-LUEP-PRO                 PIC X.
  2851         16  SF-ST-LUEP-ST                  PIC X.
  2852         16  SF-ST-LUEP-DOM                 PIC X.
  2853         16  SF-ST-AUEP-R78                 PIC X.
  2854         16  SF-ST-AUEP-PRO                 PIC X.
  2855         16  SF-ST-AUEP-ST                  PIC X.
  2856         16  SF-ST-AUEP-DOM                 PIC X.
  2857         16  SF-ST-CUEP-R78                 PIC X.
  2858         16  SF-ST-CUEP-PRO                 PIC X.
  2859         16  SF-ST-CUEP-ST                  PIC X.
  2860         16  SF-ST-CUEP-DOM                 PIC X.
  2861     12  SF-ST-EARN-PREM-OPTIONS.
  2862         16  SF-ST-LEP-R78                  PIC X.
  2863         16  SF-ST-LEP-PRO                  PIC X.
  2864         16  SF-ST-LEP-ST                   PIC X.
  2865         16  SF-ST-LEP-DOM                  PIC X.
  2866         16  SF-ST-AEP-R78                  PIC X.
  2867         16  SF-ST-AEP-PRO                  PIC X.
  2868         16  SF-ST-AEP-ST                   PIC X.
  2869         16  SF-ST-AEP-DOM                  PIC X.
  2870         16  SF-ST-CEP-R78                  PIC X.
  2871         16  SF-ST-CEP-PRO                  PIC X.
  2872         16  SF-ST-CEP-ST                   PIC X.
  2873         16  SF-ST-CEP-DOM                  PIC X.
  2874     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  55
* EL050.cbl
  2876*    COPY ELCCRTT.
  2877******************************************************************
  2878*                                                                *
  2879*                            ELCCRTT.                            *
  2880*                                                                *
  2881*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2882*                                                                *
  2883*   FILE TYPE = VSAM,KSDS                                        *
  2884*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2885*                                                                *
  2886*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2887*                                                                *
  2888*   LOG = YES                                                    *
  2889*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2890******************************************************************
  2891*                   C H A N G E   L O G
  2892*
  2893* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2894*-----------------------------------------------------------------
  2895*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2896* EFFECTIVE    NUMBER
  2897*-----------------------------------------------------------------
  2898* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2899* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2900* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2901* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2902* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2903******************************************************************
  2904
  2905 01  CERTIFICATE-TRAILERS.
  2906     12  CS-RECORD-ID                      PIC XX.
  2907         88  VALID-CS-ID                      VALUE 'CS'.
  2908
  2909     12  CS-CONTROL-PRIMARY.
  2910         16  CS-COMPANY-CD                 PIC X.
  2911         16  CS-CARRIER                    PIC X.
  2912         16  CS-GROUPING                   PIC X(6).
  2913         16  CS-STATE                      PIC XX.
  2914         16  CS-ACCOUNT                    PIC X(10).
  2915         16  CS-CERT-EFF-DT                PIC XX.
  2916         16  CS-CERT-NO.
  2917             20  CS-CERT-PRIME             PIC X(10).
  2918             20  CS-CERT-SFX               PIC X.
  2919         16  CS-TRAILER-TYPE               PIC X.
  2920             88  COMM-TRLR           VALUE 'A'.
  2921             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  2922             88  CERT-DATA-TRLR      VALUE 'C'.
  2923
  2924     12  CS-DATA-AREA                      PIC X(516).
  2925
  2926     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2927         16  CS-BANK-COMMISSION-AREA.
  2928             20  CS-BANK-COMMS       OCCURS 10.
  2929                 24  CS-AGT                PIC X(10).
  2930                 24  CS-COM-TYP            PIC X.
  2931                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2932                 24  CS-RECALC-LV-INDIC    PIC X.
  2933                 24  FILLER                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  56
* EL050.cbl
  2934         16  FILLER                        PIC X(256).
  2935
  2936     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  2937****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  2938****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  2939         16  CS-MB-CLAIM-DATA OCCURS 2.
  2940             20  FILLER OCCURS 10.
  2941                 24  CS-CLAIM-TYPE         PIC X.
  2942                     88  CS-AH-CLM           VALUE 'A'.
  2943                     88  CS-IU-CLM           VALUE 'I'.
  2944                     88  CS-GP-CLM           VALUE 'G'.
  2945                     88  CS-LF-CLM           VALUE 'L'.
  2946                     88  CS-PR-CLM           VALUE 'P'.
  2947                 24  CS-BANK               PIC S999 COMP-3.
  2948                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  2949                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  2950                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  2951         16  FILLER                        PIC X(216).
  2952     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2953         16  CS-VIN-NUMBER                 PIC X(17).
  2954         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2955         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  2956         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  2957         16  FILLER                        PIC X(496).
  2958******************************************************************
  2959*    COPY ELCCRTO.
  2960******************************************************************
  2961*                                                                *
  2962*                            ELCCRTO.                            *
  2963*                                                                *
  2964*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  2965*                                                                *
  2966*   FILE TYPE = VSAM,KSDS                                        *
  2967*   RECORD SIZE = 524  RECFORM = FIXED                           *
  2968*                                                                *
  2969*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  2970*                                                                *
  2971*   LOG = YES                                                    *
  2972*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2973******************************************************************
  2974*                   C H A N G E   L O G
  2975*
  2976* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2977*-----------------------------------------------------------------
  2978*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2979* EFFECTIVE    NUMBER
  2980*-----------------------------------------------------------------
  2981* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  2982* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  2983* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  2984* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2985* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  2986******************************************************************
  2987 01  ORIGINAL-CERTIFICATE.
  2988     12  OC-RECORD-ID                      PIC XX.
  2989         88  VALID-OC-ID                      VALUE 'OC'.
  2990     12  OC-CONTROL-PRIMARY.
  2991         16  OC-COMPANY-CD                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  57
* EL050.cbl
  2992         16  OC-CARRIER                    PIC X.
  2993         16  OC-GROUPING                   PIC X(6).
  2994         16  OC-STATE                      PIC XX.
  2995         16  OC-ACCOUNT                    PIC X(10).
  2996         16  OC-CERT-EFF-DT                PIC XX.
  2997         16  OC-CERT-NO.
  2998             20  OC-CERT-PRIME             PIC X(10).
  2999             20  OC-CERT-SFX               PIC X.
  3000         16  OC-RECORD-TYPE                PIC X.
  3001         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3002     12  OC-LAST-MAINT-DT                  PIC XX.
  3003     12  OC-LAST-MAINT-BY                  PIC X(4).
  3004     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3005     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3006     12  FILLER                            PIC X(49).
  3007     12  OC-ORIG-REC.
  3008         16  OC-INS-LAST-NAME              PIC X(15).
  3009         16  OC-INS-FIRST-NAME             PIC X(10).
  3010         16  OC-INS-MIDDLE-INIT            PIC X.
  3011         16  OC-INS-AGE                    PIC S999     COMP-3.
  3012         16  OC-JNT-LAST-NAME              PIC X(15).
  3013         16  OC-JNT-FIRST-NAME             PIC X(10).
  3014         16  OC-JNT-MIDDLE-INIT            PIC X.
  3015         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3016         16  OC-LF-BENCD                   PIC XX.
  3017         16  OC-LF-TERM                    PIC S999      COMP-3.
  3018         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3019         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3020         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3021         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3022         16  OC-LF-EXP-DT                  PIC XX.
  3023         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  3024         16  OC-LF-CANCEL-DT               PIC XX.
  3025         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3026         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3027         16  OC-AH-BENCD                   PIC XX.
  3028         16  OC-AH-TERM                    PIC S999      COMP-3.
  3029         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3030         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3031         16  OC-AH-EXP-DT                  PIC XX.
  3032         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3033         16  OC-AH-CP                      PIC 99.
  3034         16  OC-AH-CANCEL-DT               PIC XX.
  3035         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3036         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3037         16  OC-CRED-BENE-NAME             PIC X(25).
  3038         16  OC-1ST-PMT-DT                 PIC XX.
  3039         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3040         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3041         16  OC-ISSUE-TRAN-IND             PIC X.
  3042         16  OC-CANCEL-TRAN-IND            PIC X.
  3043         16  FILLER                        PIC X(211).
  3044
  3045     12  FILLER                            PIC X(50).
  3046******************************************************************
  3047
  3048*    COPY ELCDATE.
  3049******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  58
* EL050.cbl
  3050*                                                                *
  3051*                                                                *
  3052*                            ELCDATE.                            *
  3053*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3054*                            VMOD=2.003
  3055*                                                                *
  3056*                                                                *
  3057*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3058*                 LENGTH = 200                                   *
  3059******************************************************************
  3060
  3061 01  DATE-CONVERSION-DATA.
  3062     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3063     12  DC-OPTION-CODE                PIC X.
  3064         88  BIN-TO-GREG                VALUE ' '.
  3065         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3066         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3067         88  YMD-GREG-TO-BIN            VALUE '3'.
  3068         88  MDY-GREG-TO-BIN            VALUE '4'.
  3069         88  JULIAN-TO-BIN              VALUE '5'.
  3070         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3071         88  FIND-CENTURY               VALUE '7'.
  3072         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3073         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3074         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3075         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3076         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3077         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3078         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3079         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3080         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3081         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3082         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3083         88  BIN-3-TO-GREG              VALUE 'I'.
  3084         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3085         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3086         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3087         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3088         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3089         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3090         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3091         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3092         88  THREE-CHARACTER-BIN
  3093                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3094         88  GREGORIAN-TO-BIN
  3095                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3096         88  BIN-TO-GREGORIAN
  3097                  VALUES ' ' '1' 'I' '8' 'G'.
  3098         88  JULIAN-TO-BINARY
  3099                  VALUES '5' 'C' 'E' 'F'.
  3100     12  DC-ERROR-CODE                 PIC X.
  3101         88  NO-CONVERSION-ERROR        VALUE ' '.
  3102         88  DATE-CONVERSION-ERROR
  3103                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3104         88  DATE-IS-ZERO               VALUE '1'.
  3105         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3106         88  DATE-IS-INVALID            VALUE '3'.
  3107         88  DATE1-GREATER-DATE2        VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  59
* EL050.cbl
  3108         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3109         88  DATE-INVALID-OPTION        VALUE '9'.
  3110         88  INVALID-CENTURY            VALUE 'A'.
  3111         88  ONLY-CENTURY               VALUE 'B'.
  3112         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3113         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3114     12  DC-END-OF-MONTH               PIC X.
  3115         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3116     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3117         88  USE-NORMAL-PROCESS         VALUE ' '.
  3118         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3119         88  ADJUST-UP-100-YRS          VALUE '2'.
  3120     12  FILLER                        PIC X.
  3121     12  DC-CONVERSION-DATES.
  3122         16  DC-BIN-DATE-1             PIC XX.
  3123         16  DC-BIN-DATE-2             PIC XX.
  3124         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3125         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3126                       DC-GREG-DATE-1-EDIT.
  3127             20  DC-EDIT1-MONTH        PIC 99.
  3128             20  SLASH1-1              PIC X.
  3129             20  DC-EDIT1-DAY          PIC 99.
  3130             20  SLASH1-2              PIC X.
  3131             20  DC-EDIT1-YEAR         PIC 99.
  3132         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3133         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3134                     DC-GREG-DATE-2-EDIT.
  3135             20  DC-EDIT2-MONTH        PIC 99.
  3136             20  SLASH2-1              PIC X.
  3137             20  DC-EDIT2-DAY          PIC 99.
  3138             20  SLASH2-2              PIC X.
  3139             20  DC-EDIT2-YEAR         PIC 99.
  3140         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3141         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3142                     DC-GREG-DATE-1-YMD.
  3143             20  DC-YMD-YEAR           PIC 99.
  3144             20  DC-YMD-MONTH          PIC 99.
  3145             20  DC-YMD-DAY            PIC 99.
  3146         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3147         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3148                      DC-GREG-DATE-1-MDY.
  3149             20  DC-MDY-MONTH          PIC 99.
  3150             20  DC-MDY-DAY            PIC 99.
  3151             20  DC-MDY-YEAR           PIC 99.
  3152         16  DC-GREG-DATE-1-ALPHA.
  3153             20  DC-ALPHA-MONTH        PIC X(10).
  3154             20  DC-ALPHA-DAY          PIC 99.
  3155             20  FILLER                PIC XX.
  3156             20  DC-ALPHA-CENTURY.
  3157                 24 DC-ALPHA-CEN-N     PIC 99.
  3158             20  DC-ALPHA-YEAR         PIC 99.
  3159         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3160         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3161         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3162         16  DC-JULIAN-DATE            PIC 9(05).
  3163         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3164                                       PIC 9(05).
  3165         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  60
* EL050.cbl
  3166             20  DC-JULIAN-YEAR        PIC 99.
  3167             20  DC-JULIAN-DAYS        PIC 999.
  3168         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3169         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3170         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3171     12  DATE-CONVERSION-VARIBLES.
  3172         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3173         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3174             20  FILLER                PIC 9(3).
  3175             20  HOLD-CEN-1-CCYY.
  3176                 24  HOLD-CEN-1-CC     PIC 99.
  3177                 24  HOLD-CEN-1-YY     PIC 99.
  3178             20  HOLD-CEN-1-MO         PIC 99.
  3179             20  HOLD-CEN-1-DA         PIC 99.
  3180         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3181             20  HOLD-CEN-1-R-MO       PIC 99.
  3182             20  HOLD-CEN-1-R-DA       PIC 99.
  3183             20  HOLD-CEN-1-R-CCYY.
  3184                 24  HOLD-CEN-1-R-CC   PIC 99.
  3185                 24  HOLD-CEN-1-R-YY   PIC 99.
  3186             20  FILLER                PIC 9(3).
  3187         16  HOLD-CENTURY-1-X.
  3188             20  FILLER                PIC X(3)  VALUE SPACES.
  3189             20  HOLD-CEN-1-X-CCYY.
  3190                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3191                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3192             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3193             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3194         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3195             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3196             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3197             20  HOLD-CEN-1-R-X-CCYY.
  3198                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3199                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3200             20  FILLER                PIC XXX.
  3201         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3202         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3203         16  DC-JULIAN-DATE-1          PIC 9(07).
  3204         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3205             20  DC-JULIAN-1-CCYY.
  3206                 24  DC-JULIAN-1-CC    PIC 99.
  3207                 24  DC-JULIAN-1-YR    PIC 99.
  3208             20  DC-JULIAN-DA-1        PIC 999.
  3209         16  DC-JULIAN-DATE-2          PIC 9(07).
  3210         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3211             20  DC-JULIAN-2-CCYY.
  3212                 24  DC-JULIAN-2-CC    PIC 99.
  3213                 24  DC-JULIAN-2-YR    PIC 99.
  3214             20  DC-JULIAN-DA-2        PIC 999.
  3215         16  DC-GREG-DATE-A-EDIT.
  3216             20  DC-EDITA-MONTH        PIC 99.
  3217             20  SLASHA-1              PIC X VALUE '/'.
  3218             20  DC-EDITA-DAY          PIC 99.
  3219             20  SLASHA-2              PIC X VALUE '/'.
  3220             20  DC-EDITA-CCYY.
  3221                 24  DC-EDITA-CENT     PIC 99.
  3222                 24  DC-EDITA-YEAR     PIC 99.
  3223         16  DC-GREG-DATE-B-EDIT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  61
* EL050.cbl
  3224             20  DC-EDITB-MONTH        PIC 99.
  3225             20  SLASHB-1              PIC X VALUE '/'.
  3226             20  DC-EDITB-DAY          PIC 99.
  3227             20  SLASHB-2              PIC X VALUE '/'.
  3228             20  DC-EDITB-CCYY.
  3229                 24  DC-EDITB-CENT     PIC 99.
  3230                 24  DC-EDITB-YEAR     PIC 99.
  3231         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3232         16  DC-GREG-DATE-CYMD-R REDEFINES
  3233                              DC-GREG-DATE-CYMD.
  3234             20  DC-CYMD-CEN           PIC 99.
  3235             20  DC-CYMD-YEAR          PIC 99.
  3236             20  DC-CYMD-MONTH         PIC 99.
  3237             20  DC-CYMD-DAY           PIC 99.
  3238         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3239         16  DC-GREG-DATE-MDCY-R REDEFINES
  3240                              DC-GREG-DATE-MDCY.
  3241             20  DC-MDCY-MONTH         PIC 99.
  3242             20  DC-MDCY-DAY           PIC 99.
  3243             20  DC-MDCY-CEN           PIC 99.
  3244             20  DC-MDCY-YEAR          PIC 99.
  3245    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3246        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3247    12  DC-EL310-DATE                  PIC X(21).
  3248    12  FILLER                         PIC X(28).
  3249
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  62
* EL050.cbl
  3251*    COPY ELCCALC.
  3252******************************************************************
  3253*                                                                *
  3254*                           ELCCALC.                            *
  3255*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3256*                            VMOD=2.025                          *
  3257*                                                                *
  3258*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3259*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3260*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3261*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3262*                                                                *
  3263*  PASSED TO ELRTRM                                              *
  3264*  -----------------                                             *
  3265*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3266*  ORIGINAL TERM                                                 *
  3267*  BEGINNING DATE                                                *
  3268*  ENDING DATE                                                   *
  3269*  COMPANY I.D.                                                  *
  3270*  ACCOUNT MASTER USER FIELD                                     *
  3271*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3272*  FREE LOOK DAYS                                                *
  3273*                                                                *
  3274*  RETURNED FROM ELRTRM                                          *
  3275*  ---------------------                                         *
  3276*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3277*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3278*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3279*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3280*----------------------------------------------------------------*
  3281*  PASSED TO ELRAMT                                              *
  3282*  ----------------                                              *
  3283*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3284*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3285*  ORIGINAL AMOUNT                                               *
  3286*  ALTERNATE BENEFIT (BALLON)                                    *
  3287*  A.P.R. - NET PAY ONLY                                         *
  3288*  METHOD
  3289*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3290*  COMPANY I.D.                                                  *
  3291*  BENEFIT TYPE                                                  *
  3292*                                                                *
  3293*  RETURNED FROM ELRAMT                                          *
  3294*  --------------------                                          *
  3295*  REMAINING AMOUNT 1 - CURRENT                                  *
  3296*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3297*  REMAINING AMOUNT FACTOR
  3298*----------------------------------------------------------------*
  3299*  PASSED TO ELRESV                                              *
  3300*  -----------------                                             *
  3301*  CERTIFICATE EFFECTIVE DATE                                    *
  3302*  VALUATION DATE                                                *
  3303*  PAID THRU DATE                                                *
  3304*  BENEFIT                                                       *
  3305*  INCURRED DATE                                                 *
  3306*  REPORTED DATE                                                 *
  3307*  ISSUE AGE                                                     *
  3308*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  63
* EL050.cbl
  3309*  CDT PERCENT                                                   *
  3310*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3311* *CLAIM TYPE (LIFE, A/H)                                        *
  3312* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3313* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3314*                                                                *
  3315*  RETURNED FROM ELRESV                                          *
  3316*  --------------------                                          *
  3317*  CDT TABLE USED                                                *
  3318*  CDT FACTOR USED                                               *
  3319*  PAY TO CURRENT RESERVE                                        *
  3320*  I.B.N.R. - A/H ONLY                                           *
  3321*  FUTURE (ACCRUED) AH ONLY                                      *
  3322*----------------------------------------------------------------*
  3323*  PASSED TO ELRATE                                              *
  3324*  ----------------                                              *
  3325*  CERT ISSUE DATE                                               *
  3326*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3327*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3328*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3329*  STATE CODE (CLIENT DEFINED)                                   *
  3330*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3331*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3332*  DEVIATION CODE                                                *
  3333*  ISSUE AGE                                                     *
  3334*  ORIGINAL BENEFIT AMOUNT                                       *
  3335*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3336*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3337*  BENEFIT KIND (LIFE OR A/H)                                    *
  3338*  A.P.R.                                                        *
  3339*  METHOD
  3340*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3341*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3342*  COMPANY I.D. (3 CHARACTER)                                    *
  3343*  BENEFIT CODE                                                  *
  3344*  BENEFIT OVERRIDE CODE                                         *
  3345*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3346*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3347*  JOINT INDICATOR (CSL ONLY)                                    *
  3348*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3349*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3350*                                                                *
  3351*  RETURNED FROM ELRATE                                          *
  3352*  --------------------                                          *
  3353*  CALCULATED PREMIUM                                            *
  3354*  PREMIUM RATE                                                  *
  3355*  MORTALITY CODE                                                *
  3356*  MAX ATTAINED AGE                                              *
  3357*  MAX AGE                                                       *
  3358*  MAX TERM                                                      *
  3359*  MAX MONTHLY BENEFIT                                           *
  3360*  MAX TOTAL BENIFIT                                             *
  3361*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3362*----------------------------------------------------------------*
  3363*  PASSED TO ELRFND                                              *
  3364*  ----------------                                              *
  3365*  CERT ISSUE DATE                                               *
  3366*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  64
* EL050.cbl
  3367*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3368*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3369*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3370*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3371*  STATE CODE (CLIENT DEFINED)                                   *
  3372*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3373*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3374*  DEVIATION CODE                                                *
  3375*  ISSUE AGE                                                     *
  3376*  ORIGINAL BENEFIT AMOUNT                                       *
  3377*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3378*  PROCESS TYPE (CANCEL)                                         *
  3379*  BENEFIT KIND (LIFE OR A/H)                                    *
  3380*  A.P.R.                                                        *
  3381*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3382*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3383*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3384*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3385*  COMPANY I.D. (3 CHARACTER)                                    *
  3386*  BENEFIT CODE                                                  *
  3387*  BENEFIT OVERRIDE CODE                                         *
  3388*                                                                *
  3389*  RETURNED FROM ELRFND                                          *
  3390*  --------------------                                          *
  3391*  CALCULATED REFUND                                             *
  3392*----------------------------------------------------------------*
  3393*  PASSED TO ELEARN                                              *
  3394*  ----------------                                              *
  3395*  CERT ISSUE DATE                                               *
  3396*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3397*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3398*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3399*  STATE CODE (CLIENT DEFINED)                                   *
  3400*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3401*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3402*  DEVIATION CODE                                                *
  3403*  ISSUE AGE                                                     *
  3404*  ORIGINAL BENEFIT AMOUNT                                       *
  3405*  BENEFIT KIND (LIFE OR A/H)                                    *
  3406*  A.P.R.                                                        *
  3407*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3408*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3409*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3410*  COMPANY I.D. (3 CHARACTER)                                    *
  3411*  BENEFIT CODE                                                  *
  3412*  BENEFIT OVERRIDE CODE                                         *
  3413*                                                                *
  3414*  RETURNED FROM ELEARN                                          *
  3415*  --------------------                                          *
  3416*  INDICATED  EARNINGS                                           *
  3417*----------------------------------------------------------------*
  3418*                 LENGTH = 450                                   *
  3419*                                                                *
  3420******************************************************************
  3421******************************************************************
  3422*                   C H A N G E   L O G
  3423*
  3424* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  65
* EL050.cbl
  3425*-----------------------------------------------------------------
  3426*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3427* EFFECTIVE    NUMBER
  3428*-----------------------------------------------------------------
  3429* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3430* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3431* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3432* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3433* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3434* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3435* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3436* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3437* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3438******************************************************************
  3439
  3440 01  CALCULATION-PASS-AREA.
  3441     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3442                                     COMP.
  3443
  3444     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3445       88  NO-CP-ERROR                             VALUE ZERO.
  3446       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3447                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3448       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3449       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3450       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3451       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3452       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3453       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3454       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3455       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3456       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3457       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3458       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3459       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3460       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3461       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3462       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3463       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3464       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3465
  3466     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3467       88  NO-CP-ERROR-2                           VALUE ZERO.
  3468***********************  INPUT AREAS ****************************
  3469
  3470     12  CP-CALCULATION-AREA.
  3471         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3472         16  CP-CERT-EFF-DT        PIC XX.
  3473         16  CP-VALUATION-DT       PIC XX.
  3474         16  CP-PAID-THRU-DT       PIC XX.
  3475         16  CP-BENEFIT-TYPE       PIC X.
  3476           88  CP-AH                               VALUE 'A' 'D'
  3477                                                   'I' 'U'.
  3478           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3479           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3480         16  CP-INCURRED-DT        PIC XX.
  3481         16  CP-REPORTED-DT        PIC XX.
  3482         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  66
* EL050.cbl
  3483         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3484         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3485                                     COMP-3.
  3486         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3487                                     COMP-3.
  3488         16  CP-CDT-METHOD         PIC X.
  3489           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3490           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3491           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3492         16  CP-CLAIM-TYPE         PIC X.
  3493           88  CP-AH-CLAIM                         VALUE 'A'.
  3494           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3495         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3496                                     COMP-3.
  3497         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3498                                     COMP-3.
  3499         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3500                                     COMP-3.
  3501         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3502                                     COMP-3.
  3503         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3504                                     COMP-3.
  3505         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3506                                     COMP-3.
  3507         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3508                                     COMP-3.
  3509         16  CP-REM-TERM-METHOD    PIC X.
  3510           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3511           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3512           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3513           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3514           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3515           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3516           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3517         16  CP-EARNING-METHOD     PIC X.
  3518           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3519           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3520           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3521           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3522           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3523           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3524           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3525           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3526           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3527           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3528           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3529           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3530           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3531           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3532         16  CP-PROCESS-TYPE       PIC X.
  3533           88  CP-CLAIM                            VALUE '1'.
  3534           88  CP-CANCEL                           VALUE '2'.
  3535           88  CP-ISSUE                            VALUE '3'.
  3536         16  CP-SPECIAL-CALC-CD    PIC X.
  3537           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3538           88  CP-1-MTH-INTEREST               VALUE ' '.
  3539           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3540           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  67
* EL050.cbl
  3541           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3542           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3543           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3544           88  CP-FARM-PLAN                    VALUE 'F'.
  3545           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3546           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3547           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3548           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3549           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3550           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3551           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3552           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3553           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3554           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3555                                                     'W' 'X'.
  3556           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3557           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3558           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3559           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3560           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3561           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3562           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3563           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3564           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3565           88  CP-CSL-METH-1                   VALUE '5'.
  3566           88  CP-CSL-METH-2                   VALUE '6'.
  3567           88  CP-CSL-METH-3                   VALUE '7'.
  3568           88  CP-CSL-METH-4                   VALUE '8'.
  3569
  3570         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3571                                     COMP-3.
  3572         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3573         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3574         16  CP-STATE              PIC XX          VALUE SPACE.
  3575         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3576         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3577           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3578               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3579         16  CP-R78-OPTION         PIC X.
  3580           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3581           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3582
  3583         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3584         16  CP-IBNR-RESERVE-SW    PIC X.
  3585         16  CP-CLAIM-STATUS       PIC X.
  3586         16  CP-RATE-FILE          PIC X.
  3587         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3588                                     COMP-3.
  3589
  3590         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3591         16  CP-AH-OVERRIDE-CODE   PIC X.
  3592
  3593         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3594                                     COMP-3.
  3595         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3596                                   PIC S9(5)V99 COMP-3.
  3597         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3598                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  68
* EL050.cbl
  3599         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3600                                     COMP-3.
  3601         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3602                                     COMP-3.
  3603         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3604                                  PIC S9(7)V99 COMP-3.
  3605
  3606         16  CP-PAID-FROM-DATE     PIC X(02).
  3607         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3608         16  CP-EXT-DAYS-CALC      PIC X.
  3609           88  CP-EXT-NO-CHG                   VALUE ' '.
  3610           88  CP-EXT-CHG-LF                   VALUE '1'.
  3611           88  CP-EXT-CHG-AH                   VALUE '2'.
  3612           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3613         16  CP-DOMICILE-STATE     PIC XX.
  3614         16  CP-CARRIER            PIC X.
  3615         16  CP-REIN-FLAG          PIC X.
  3616         16  CP-REM-TRM-CALC-OPTION PIC X.
  3617           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3618                      '2' '3' '4' '5'.
  3619           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3620           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3621           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3622           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3623           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3624           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3625           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3626           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3627         16  CP-SIG-SWITCH         PIC X.
  3628         16  CP-RATING-METHOD      PIC X.
  3629           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3630           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3631           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3632           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3633           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3634           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3635           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3636           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3637           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3638         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3639                                     COMP-3.
  3640         16  CP-BEN-CATEGORY       PIC X.
  3641         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3642         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3643                                   PIC S99V9(5) COMP-3.
  3644         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3645         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3646                                   PIC S99V9(5) COMP-3.
  3647         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3648         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3649         16  CP-EXPIRE-DT          PIC XX.
  3650         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3651         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3652         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3653         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3654         16  CP-DDF-SPEC-CALC      PIC X.
  3655             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3656             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  69
* EL050.cbl
  3657         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3658         16  CP-CANCEL-REASON      PIC X.
  3659         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3660         16  CP-PMT-MODE           PIC X.
  3661         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3662         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3663         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3664         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3665         16  FILLER                PIC X.
  3666
  3667***************    OUTPUT FROM ELRESV   ************************
  3668
  3669         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3670
  3671         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3672                                     COMP-3.
  3673         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3674                                     COMP-3.
  3675         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3676                                     COMP-3.
  3677         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3678                                     COMP-3.
  3679         16  FILLER                PIC X(09).
  3680***************    OUTPUT FROM ELRTRM   *************************
  3681
  3682         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3683                                     COMP-3.
  3684         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3685                                     COMP-3.
  3686         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3687                                     COMP-3.
  3688         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3689                                     COMP-3.
  3690         16  FILLER                PIC X(12).
  3691
  3692***************    OUTPUT FROM ELRAMT   *************************
  3693
  3694         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3695                                     COMP-3.
  3696         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3697                                     COMP-3.
  3698         16  FILLER                PIC X(12).
  3699
  3700***************    OUTPUT FROM ELRATE   *************************
  3701
  3702         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3703                                     COMP-3.
  3704         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3705                                     COMP-3.
  3706         16  CP-MORTALITY-CODE     PIC X(4).
  3707         16  CP-RATE-EDIT-FLAG     PIC X.
  3708             88  CP-RATES-NEED-APR                  VALUE '1'.
  3709         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3710                                     COMP-3.
  3711         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3712         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3713         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3714                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  70
* EL050.cbl
  3715         16  FILLER                PIC X(07).
  3716
  3717***************    OUTPUT FROM ELRFND   *************************
  3718
  3719         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3720                                     COMP-3.
  3721         16  CP-REFUND-TYPE-USED   PIC X.
  3722           88  CP-R-AS-R78                         VALUE '1'.
  3723           88  CP-R-AS-PRORATA                     VALUE '2'.
  3724           88  CP-R-AS-CALIF                       VALUE '3'.
  3725           88  CP-R-AS-TEXAS                       VALUE '4'.
  3726           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3727           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3728           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3729           88  CP-R-AS-MEAN                        VALUE '8'.
  3730           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3731           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3732           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3733           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3734           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3735           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3736         16  FILLER                PIC X(12).
  3737
  3738***************    OUTPUT FROM ELEARN   *************************
  3739
  3740         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3741                                     COMP-3.
  3742         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3743                                     COMP-3.
  3744         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3745                                     COMP-3.
  3746         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3747                                     COMP-3.
  3748         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3749                                     COMP-3.
  3750         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3751                                     COMP-3.
  3752         16  CP-EARNING-TYPE-USED  PIC X.
  3753           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3754           88  CP-E-AS-R78                         VALUE '1'.
  3755           88  CP-E-AS-PRORATA                     VALUE '2'.
  3756           88  CP-E-AS-TEXAS                       VALUE '4'.
  3757           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3758           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3759           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3760           88  CP-E-AS-MEAN                        VALUE '8'.
  3761           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3762         16  FILLER                PIC X(12).
  3763
  3764***************    OUTPUT FROM ELPMNT   *************************
  3765
  3766         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3767                                     COMP-3.
  3768         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3769                                     COMP-3.
  3770         16  FILLER                PIC X(12).
  3771
  3772***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  71
* EL050.cbl
  3773         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3774                                     COMP-3.
  3775         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3776                                     COMP-3.
  3777         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3778                                     COMP-3.
  3779         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3780                                     COMP-3.
  3781         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3782                                     COMP-3.
  3783         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3784                                     COMP-3.
  3785         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3786             88  OPEN-RATE-FILE                   VALUE 'O'.
  3787             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3788             88  IO-ERROR                         VALUE 'E'.
  3789
  3790         16  CP-FIRST-PAY-DATE     PIC XX.
  3791
  3792         16  CP-JOINT-INDICATOR    PIC X.
  3793
  3794         16  CP-RESERVE-REMAINING-TERM
  3795                                   PIC S9(4)V9    VALUE ZERO
  3796                                     COMP-3.
  3797
  3798         16  CP-INSURED-BIRTH-DT   PIC XX.
  3799
  3800         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3801                                     COMP-3.
  3802
  3803         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3804                                     COMP-3.
  3805
  3806         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3807                                     COMP-3.
  3808
  3809         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3810                                     COMP-3.
  3811
  3812         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3813                                     COMP-3.
  3814
  3815         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3816                                     COMP-3.
  3817
  3818         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3819                                     COMP-3.
  3820
  3821         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3822             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3823
  3824         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3825                                     COMP-3.
  3826         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3827                                     COMP-3.
  3828         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3829         16  FILLER                PIC X(15).
  3830******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  72
* EL050.cbl
  3832******************************************************************
  3833*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3834*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3835*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3836*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3837*** MODIFICATION.                                              ***
  3838*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3839*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3840******************************************************************
  3841*    COPY ERCPNDB.
  3842******************************************************************
  3843*                                                                *
  3844*                                                                *
  3845*                            ERCPNDB.                            *
  3846*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3847*                            VMOD=2.025                          *
  3848*                                                                *
  3849*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3850*                                                                *
  3851******************************************************************
  3852*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3853*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3854******************************************************************
  3855*                                                                *
  3856*                                                                *
  3857*   FILE TYPE = VSAM,KSDS                                        *
  3858*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3859*                                                                *
  3860*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3861*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3862*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3863*                                                 RKP=13,LEN=36  *
  3864*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3865*                                      AND CHG-SEQ.)             *
  3866*                                                RKP=49,LEN=11   *
  3867*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3868*                                      AND CHG-SEQ.)             *
  3869*                                                RKP=60,LEN=15   *
  3870*                                                                *
  3871*   LOG = NO                                                     *
  3872*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3873******************************************************************
  3874******************************************************************
  3875*                   C H A N G E   L O G
  3876*
  3877* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3878*-----------------------------------------------------------------
  3879*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3880* EFFECTIVE    NUMBER
  3881*-----------------------------------------------------------------
  3882* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3883* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3884* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3885* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3886* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3887* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3888* 032306                   PEMA  ADD BOW LOAN NUMBER
  3889* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  73
* EL050.cbl
  3890* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3891* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3892* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3893* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3894* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3895* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3896* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3897******************************************************************
  3898
  3899 01  PENDING-BUSINESS.
  3900     12  PB-RECORD-ID                     PIC XX.
  3901         88  VALID-PB-ID                        VALUE 'PB'.
  3902
  3903     12  PB-CONTROL-PRIMARY.
  3904         16  PB-COMPANY-CD                PIC X.
  3905         16  PB-ENTRY-BATCH               PIC X(6).
  3906         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3907         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3908
  3909     12  PB-CONTROL-BY-ACCOUNT.
  3910         16  PB-COMPANY-CD-A1             PIC X.
  3911         16  PB-CARRIER                   PIC X.
  3912         16  PB-GROUPING.
  3913             20  PB-GROUPING-PREFIX       PIC XXX.
  3914             20  PB-GROUPING-PRIME        PIC XXX.
  3915         16  PB-STATE                     PIC XX.
  3916         16  PB-ACCOUNT.
  3917             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3918             20  PB-ACCOUNT-PRIME         PIC X(6).
  3919         16  PB-CERT-EFF-DT               PIC XX.
  3920         16  PB-CERT-NO.
  3921             20  PB-CERT-PRIME            PIC X(10).
  3922             20  PB-CERT-SFX              PIC X.
  3923         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3924
  3925         16  PB-RECORD-TYPE               PIC X.
  3926             88  PB-MAILING-DATA                VALUE '0'.
  3927             88  PB-ISSUE                       VALUE '1'.
  3928             88  PB-CANCELLATION                VALUE '2'.
  3929             88  PB-BATCH-TRAILER               VALUE '9'.
  3930
  3931     12  PB-CONTROL-BY-ORIG-BATCH.
  3932         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3933         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3934         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3935         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3936
  3937     12  PB-CONTROL-BY-CSR.
  3938         16  PB-CSR-COMPANY-CD            PIC X.
  3939         16  PB-CSR-ID                    PIC X(4).
  3940         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3941         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3942         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3943******************************************************************
  3944*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3945******************************************************************
  3946
  3947     12  PB-LAST-MAINT-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  74
* EL050.cbl
  3948     12  PB-LAST-MAINT-BY                 PIC X(4).
  3949     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3950
  3951     12  PB-RECORD-BODY                   PIC X(375).
  3952
  3953     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3954         16  PB-CERT-ORIGIN               PIC X.
  3955             88  CLASIC-CREATED-CERT         VALUE '1'.
  3956         16  PB-I-NAME.
  3957             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3958             20  PB-I-INSURED-FIRST-NAME.
  3959                 24  PB-I-INSURED-1ST-INIT PIC X.
  3960                 24  FILLER                PIC X(9).
  3961             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3962         16  PB-I-AGE                     PIC S99   COMP-3.
  3963         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3964         16  PB-I-BIRTHDAY                PIC XX.
  3965         16  PB-I-INSURED-SEX             PIC X.
  3966             88  PB-SEX-MALE     VALUE 'M'.
  3967             88  PB-SEX-FEMALE   VALUE 'F'.
  3968
  3969         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3970         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3971         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  3972         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  3973         16  PB-I-SKIP-CODE               PIC X.
  3974             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  3975             88  PB-SKIP-JULY              VALUE '1'.
  3976             88  PB-SKIP-AUGUST            VALUE '2'.
  3977             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  3978             88  PB-SKIP-JULY-AUG          VALUE '4'.
  3979             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  3980             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  3981             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  3982             88  PB-SKIP-JUNE              VALUE '8'.
  3983             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  3984             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  3985             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  3986         16  PB-I-TERM-TYPE               PIC X.
  3987             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  3988             88  PB-PAID-WEEKLY            VALUE 'W'.
  3989             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  3990             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  3991             88  PB-PAID-13-YEARLY         VALUE 'T'.
  3992         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  3993         16  PB-I-POLICY-FORM-NO          PIC X(12).
  3994         16  PB-I-DATA-ENTRY-SW           PIC X.
  3995             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  3996             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  3997             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  3998             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  3999         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4000         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4001*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4002         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4003         16  FILLER                       PIC X.
  4004
  4005         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  75
* EL050.cbl
  4006             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4007             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4008                                                   '90' THRU '99'.
  4009         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4010                                          PIC XX.
  4011         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4012         16  PB-I-AMOUNT-FINANCED REDEFINES
  4013                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4014         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4015         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4016                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4017         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4018         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4019         16  PB-I-CLP-AMOUNT REDEFINES
  4020                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4021         16  PB-I-LF-CALC-FLAG            PIC X.
  4022             88 PB-COMP-LF-PREM               VALUE '?'.
  4023         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4024         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4025         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4026         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4027         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4028         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4029         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4030         16  PB-I-LF-ABBR                 PIC XXX.
  4031         16  PB-I-LF-INPUT-CD             PIC XX.
  4032
  4033         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4034             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4035             88  PB-INVALID-AH               VALUE '  ' '00'
  4036                                                   '90' THRU '99'.
  4037         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4038         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4039         16  PB-I-AH-CALC-FLAG            PIC X.
  4040             88 PB-COMP-AH-PREM                  VALUE '?'.
  4041         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4042         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4043         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4044         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4045         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4046         16  PB-I-AH-ABBR                 PIC XXX.
  4047         16  PB-I-AH-INPUT-CD             PIC XXX.
  4048
  4049         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4050         16  PB-I-REIN-TABLE              PIC XXX.
  4051         16  PB-I-BUSINESS-TYPE           PIC 99.
  4052         16  PB-I-INDV-GRP-CD             PIC X.
  4053         16  PB-I-MORT-CODE.
  4054             20  PB-I-TABLE               PIC X.
  4055             20  PB-I-INTEREST            PIC XX.
  4056             20  PB-I-MORT-TYP            PIC X.
  4057         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4058         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4059         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4060         16  PB-I-INDV-GRP-OVRD           PIC X.
  4061         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4062         16  PB-I-SIG-SW                  PIC X.
  4063             88  PB-POLICY-SIGNED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  76
* EL050.cbl
  4064         16  PB-I-RATE-CLASS              PIC XX.
  4065         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4066         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4067         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4068         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4069         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4070         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4071         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4072         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4073         16  PB-I-OB-FLAG                 PIC X.
  4074             88  PB-I-OB                      VALUE 'B'.
  4075             88  PB-I-SUMMARY                 VALUE 'Z'.
  4076         16  PB-I-ENTRY-STATUS            PIC X.
  4077             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4078                                              'M' '5' '9' '2'.
  4079             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4080             88  PB-I-POLICY-PENDING          VALUE '2'.
  4081             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4082             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4083             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4084             88  PB-I-REIN-ONLY               VALUE '9'.
  4085             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4086             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4087             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4088             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4089         16  PB-I-INT-CODE                PIC X.
  4090             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4091             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4092         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4093         16  PB-I-SOC-SEC-NO              PIC X(11).
  4094         16  PB-I-MEMBER-NO               PIC X(12).
  4095         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4096*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4097         16  PB-I-OLD-LOF                 PIC XXX.
  4098         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4099         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4100         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4101         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4102         16  PB-I-LIFE-INDICATOR          PIC X.
  4103             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4104         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4105         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4106                                          PIC S9(5)V99    COMP-3.
  4107         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4108             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4109             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4110         16  PB-I-1ST-PMT-DT              PIC XX.
  4111         16  PB-I-JOINT-INSURED.
  4112             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4113             20 PB-I-JOINT-FIRST-NAME.
  4114                24  PB-I-JOINT-FIRST-INIT PIC X.
  4115                24  FILLER                PIC X(9).
  4116             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4117*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4118         16  PB-I-BENEFICIARY-NAME.
  4119             20  PB-I-BANK-NUMBER         PIC X(10).
  4120             20  FILLER                   PIC X(15).
  4121         16  PB-I-LAST-ADD-ON-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  77
* EL050.cbl
  4122         16  PB-I-REFERENCE               PIC X(12).
  4123         16  FILLER REDEFINES PB-I-REFERENCE.
  4124             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4125             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4126             20  PB-I-CLP-STATE           PIC XX.
  4127         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4128             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4129             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4130             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4131         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4132         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4133         16  PB-I-RESIDENT-STATE          PIC XX.
  4134         16  PB-I-RATE-CODE               PIC X(4).
  4135         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4136         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4137         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4138         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4139         16  PB-I-BANK-NOCHRGB            PIC 99.
  4140         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4141         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4142
  4143     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4144         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4145             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4146         16  PB-C-CANCEL-ORIGIN           PIC X.
  4147             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4148         16  PB-C-LF-CANCEL-DT            PIC XX.
  4149         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4150         16  PB-C-LF-CALC-REQ             PIC X.
  4151             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4152         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4153         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4154         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4155             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4156         16  PB-C-AH-CANCEL-DT            PIC XX.
  4157         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4158         16  PB-C-AH-CALC-REQ             PIC X.
  4159             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4160         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4161         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4162         16  PB-C-LAST-NAME               PIC X(15).
  4163         16  PB-C-REFUND-SW               PIC X.
  4164             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4165             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4166         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4167         16  PB-C-PAYEE-CODE              PIC X(6).
  4168         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4169         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4170         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4171         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4172         16  PB-C-REFERENCE               PIC X(12).
  4173         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4174         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4175         16  PB-C-POST-CARD-IND           PIC X.
  4176         16  PB-C-CANCEL-REASON           PIC X.
  4177         16  PB-C-REF-INTERFACE-SW        PIC X.
  4178         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4179         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  78
* EL050.cbl
  4180         16  FILLER                       PIC X(01).
  4181*        16  FILLER                       PIC X(18).
  4182         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4183*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4184         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4185         16  PB-CANCELED-CERT-DATA.
  4186             20  PB-CI-INSURED-NAME.
  4187                 24  PB-CI-LAST-NAME      PIC X(15).
  4188                 24  PB-CI-INITIALS       PIC XX.
  4189             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4190             20  PB-CI-INSURED-SEX        PIC X.
  4191             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4192             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4193             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4194             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4195             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4196             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4197             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4198             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4199             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4200             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4201             20  PB-CI-RATE-CLASS         PIC XX.
  4202             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4203             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4204             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4205             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4206             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4207             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4208             20  PB-CI-LF-ABBR            PIC X(3).
  4209             20  PB-CI-AH-ABBR            PIC X(3).
  4210             20  PB-CI-OB-FLAG            PIC X.
  4211                 88  PB-CI-OB                VALUE 'B'.
  4212             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4213                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4214                                           'M' '4' '5' '9' '2'.
  4215                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4216                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4217                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4218                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4219                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4220                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4221                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4222                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4223                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4224                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4225                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4226                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4227             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4228                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4229                                           'M' '4' '5' '9' '2'.
  4230                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4231                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4232                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4233                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4234                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4235                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4236                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4237                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  79
* EL050.cbl
  4238                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4239                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4240                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4241                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4242             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4243             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4244             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4245             20  PB-CI-MEMBER-NO          PIC X(12).
  4246             20  PB-CI-INT-CODE           PIC X.
  4247                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4248                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4249             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4250             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4251             20  PB-CI-COMP-EXCP-SW       PIC X.
  4252                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4253                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4254             20  PB-CI-ENTRY-STATUS       PIC X.
  4255             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4256             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4257             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4258             20  PB-CI-DEATH-DT           PIC XX.
  4259             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4260             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4261             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4262             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4263             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4264             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4265             20  PB-CI-ENTRY-DT              PIC XX.
  4266             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4267             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4268             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4269             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4270             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4271             20  PB-CI-OLD-LOF               PIC XXX.
  4272*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4273             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4274             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4275             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4276             20  PB-CI-INDV-GRP-CD           PIC X.
  4277             20  PB-CI-BENEFICIARY-NAME.
  4278                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4279                 24  FILLER                  PIC X(15).
  4280             20  PB-CI-NOTE-SW               PIC X.
  4281             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4282             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4283             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4284             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4285             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4286             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4287             20  PB-CI-FIRST-NAME            PIC X(10).
  4288             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4289
  4290         16  FILLER                       PIC X(13).
  4291*032306  16  FILLER                       PIC X(27).
  4292*        16  FILLER                       PIC X(46).
  4293
  4294     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4295         16  FILLER                       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  80
* EL050.cbl
  4296         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4297         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4298         16  PB-M-INSURED-MID-INIT        PIC X.
  4299         16  PB-M-INSURED-AGE             PIC 99.
  4300         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4301         16  PB-M-INSURED-SEX             PIC X.
  4302         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4303         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4304         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4305         16  PB-M-INSURED-CITY-STATE.
  4306             20  PB-M-INSURED-CITY        PIC X(28).
  4307             20  PB-M-INSURED-STATE       PIC XX.
  4308         16  PB-M-INSURED-ZIP-CODE.
  4309             20  PB-M-INSURED-ZIP-PRIME.
  4310                 24  PB-M-INSURED-ZIP-1   PIC X.
  4311                     88  PB-M-CANADIAN-POST-CODE
  4312                                             VALUE 'A' THRU 'Z'.
  4313                 24  FILLER               PIC X(4).
  4314             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4315         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4316                                        PB-M-INSURED-ZIP-CODE.
  4317             20  PM-M-INS-CAN-POST1       PIC XXX.
  4318             20  PM-M-INS-CAN-POST2       PIC XXX.
  4319             20  FILLER                   PIC XXX.
  4320         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4321         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4322         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4323         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4324         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4325         16  PB-M-CRED-BENE-CITYST.
  4326             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4327             20  PB-M-CRED-BENE-STATE     PIC XX.
  4328         16  FILLER                       PIC X(92).
  4329
  4330     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4331         16  FILLER                       PIC X(10).
  4332         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4333         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4334         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4335         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4336         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4337         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4338         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4339         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4340         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4341         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4342         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4343         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4344         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4345         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4346         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4347         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4348         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4349         16  PB-ACCOUNT-NAME              PIC X(30).
  4350         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4351         16  PB-REFERENCE                 PIC X(12).
  4352         16  PB-B-RECEIVED-DT             PIC XX.
  4353         16  FILLER                       PIC X(234).
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  81
* EL050.cbl
  4354
  4355     12  PB-RECORD-STATUS.
  4356         16  PB-CREDIT-SELECT-DT          PIC XX.
  4357         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4358         16  PB-BILLED-DT                 PIC XX.
  4359         16  PB-BILLING-STATUS            PIC X.
  4360             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4361             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4362             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4363         16  PB-RECORD-BILL               PIC X.
  4364             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4365             88  PB-RECORD-RETURNED           VALUE 'R'.
  4366             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4367             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4368             88  PB-OVERRIDE-AH               VALUE 'A'.
  4369             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4370         16  PB-BATCH-ENTRY               PIC X.
  4371             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4372             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4373             88  PB-REISSUED-CERT             VALUE 'E'.
  4374             88  PB-MONTHLY-CERT              VALUE 'M'.
  4375             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4376             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4377             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4378         16  PB-FORCE-CODE                PIC X.
  4379             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4380             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4381             88  PB-CANCEL-FORCE              VALUE '8'.
  4382             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4383             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4384             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4385             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4386             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4387             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4388             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4389         16  PB-FATAL-FLAG                PIC X.
  4390             88  PB-FATAL-ERRORS              VALUE 'X'.
  4391         16  PB-FORCE-ER-CD               PIC X.
  4392             88  PB-FORCE-ERRORS              VALUE 'F'.
  4393             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4394         16  PB-WARN-ER-CD                PIC X.
  4395             88  PB-WARNING-ERRORS            VALUE 'W'.
  4396         16  FILLER                       PIC X.
  4397         16  PB-OUT-BAL-CD                PIC X.
  4398             88  PB-OUT-OF-BAL                VALUE 'O'.
  4399         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4400         16  PB-AH-OVERRIDE-L1            PIC X.
  4401         16  PB-INPUT-DT                  PIC XX.
  4402         16  PB-INPUT-BY                  PIC X(4).
  4403         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4404         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4405         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4406         16  PB-LF-EARNING-METHOD         PIC X.
  4407         16  PB-AH-EARNING-METHOD         PIC X.
  4408         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4409         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4410         16  PB-REIN-CD                   PIC XXX.
  4411         16  PB-LF-REFUND-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  82
* EL050.cbl
  4412         16  PB-AH-REFUND-TYPE            PIC X.
  4413         16  PB-ACCT-EFF-DT               PIC XX.
  4414         16  PB-ACCT-EXP-DT               PIC XX.
  4415         16  PB-COMPANY-ID                PIC X(3).
  4416         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4417         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4418         16  PB-SV-CARRIER                PIC X.
  4419         16  PB-SV-GROUPING               PIC X(6).
  4420         16  PB-SV-STATE                  PIC XX.
  4421         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4422         16  PB-GA-BILLING-INFO.
  4423             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4424                                          PIC XX.
  4425         16  PB-SV-REMIT-TO  REDEFINES
  4426             PB-GA-BILLING-INFO           PIC X(10).
  4427         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4428         16  PB-I-LOAN-OFFICER            PIC X(5).
  4429         16  PB-I-VIN                     PIC X(17).
  4430
  4431         16  FILLER                       PIC X(04).
  4432         16  IMNET-BYPASS-SW              PIC X.
  4433
  4434******************************************************************
  4435*                COMMON EDIT ERRORS                              *
  4436******************************************************************
  4437
  4438     12  PB-COMMON-ERRORS.
  4439         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4440                                           PIC S9(4)     COMP.
  4441
  4442******************************************************************
  4443
  4444* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4445*    COPY ELC50W1.
  4446******************************************************************
  4447*                                                                *
  4448*                                                                *
  4449*                             ELC50W1                            *
  4450*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4451*                            VMOD=2.004                          *
  4452*                                                                *
  4453*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4454*                                                                *
  4455*                                                                *
  4456******************************************************************
  4457
  4458     12  WK-WORK-AREA.
  4459         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4460         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4461         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4462         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4463         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4464         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4465         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4466         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4467         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4468         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4469         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  83
* EL050.cbl
  4470         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4471         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4472         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4473         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4474         16  WK-CREDIT-EDIT-CONTROLS.
  4475             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4476             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4477             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4478             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4479             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4480             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4481         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4482         16  WK-SAVE-REIN-DATA.
  4483             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4484             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4485             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4486         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4487             88  ENTRY-FROM-EL6311       VALUE '6'.
  4488         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4489         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4490     12  WK-RECORD-ADDRESSES.
  4491         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4492         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4493         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4494         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4495         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4496         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4497         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4498         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4499     12  WK-OVER-SHORT-AREA.
  4500         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4501         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4502         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4503             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4504         16  FILLER                   PIC X(5) VALUE SPACES.
  4505
  4506*    COPY ELCEDITC.
  4507******************************************************************
  4508*                                                                *
  4509*                                                                *
  4510*                            ELCEDITC                            *
  4511*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4512*                            VMOD=2.012                          *
  4513*                                                                *
  4514*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4515*                     EL6313, EL050 AND EL517.                   *
  4516*                                                                *
  4517******************************************************************
  4518******************************************************************
  4519*                   C H A N G E   L O G
  4520*
  4521* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4522*-----------------------------------------------------------------
  4523*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4524* EFFECTIVE    NUMBER
  4525*-----------------------------------------------------------------
  4526* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4527******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  84
* EL050.cbl
  4528
  4529     12  EDIT-CRITERIA-DATA.
  4530         16  EC-CO-MONTH-END-DT       PIC XX.
  4531         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4532         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4533         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4534         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4535         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4536         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4537         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4538         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4539         16  EC-CO-REM-TERM-CALC      PIC X.
  4540               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4541               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4542               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4543               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4544
  4545         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4546               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4547               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4548               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4549               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4550               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4551               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4552               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4553               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4554               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4555               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4556
  4557         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4558               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4559               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4560               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4561               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4562               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4563               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4564               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4565               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4566
  4567         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4568                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4569                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4570
  4571         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4572                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4573                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4574                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4575                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4576                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4577                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4578                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4579                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4580
  4581         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4582               88  EC-BR-REDUCING                   VALUE 'R'.
  4583               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4584
  4585         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  85
* EL050.cbl
  4586         16  EC-BR-LF-DESC             PIC X(10).
  4587         16  EC-BR-AH-DESC             PIC X(10).
  4588         16  EC-BR-LF-COMMENT          PIC X(10).
  4589         16  EC-BR-AH-COMMENT          PIC X(10).
  4590
  4591         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4592               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4593               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4594               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4595               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4596
  4597         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4598               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4599               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4600               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4601               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4602
  4603         16  EC-BR-LF-REFUND-CALC      PIC X.
  4604                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4605                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4606                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4607                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4608                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4609                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4610                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4611
  4612         16  EC-BR-AH-REFUND-CALC      PIC X.
  4613                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4614                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4615                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4616                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4617                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4618                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4619                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4620                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4621
  4622         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4623                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4624                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4625                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4626
  4627         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4628                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4629                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4630                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4631
  4632         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4633         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4634         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4635         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4636
  4637         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4638         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4639                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4640                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4641                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4642                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4643
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  86
* EL050.cbl
  4644         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4645               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4646               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4647               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4648               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4649               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4650
  4651         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4652               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4653               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4654               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4655               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4656               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4657
  4658         16  EC-ST-LF-REFUND-CALC      PIC X.
  4659                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4660                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4661                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4662                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4663                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4664                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4665                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4666                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4667
  4668         16  EC-ST-AH-REFUND-CALC      PIC X.
  4669                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4670                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4671                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4672                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4673                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4674                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4675                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4676                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4677
  4678         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4679         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4680         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4681         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4682         16  EC-AM-EXPIRATION-DT       PIC XX.
  4683         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4684         16  EC-AM-CLASS-CD            PIC XX.
  4685         16  EC-AM-LF-DEVIATION        PIC XXX.
  4686         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4687         16  EC-AM-AH-DEVIATION        PIC XXX.
  4688         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4689         16  EC-AM-PHONE-NO            PIC X(10).
  4690
  4691         16  EC-AM-LF-REFUND-CALC      PIC X.
  4692                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4693                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4694                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4695                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4696                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4697                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4698                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4699
  4700         16  EC-AM-AH-REFUND-CALC      PIC X.
  4701                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  87
* EL050.cbl
  4702                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4703                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4704                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4705                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4706                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4707                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4708
  4709         16  EC-AM-BEN-I-G-CD          PIC X.
  4710                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4711                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4712                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4713
  4714         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4715         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4716         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4717         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4718         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4719         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4720         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4721         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4722         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4723
  4724         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4725         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4726         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4727         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4728         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4729         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4730         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4731         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4732         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4733         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4734         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4735         16  EC-RT-LF-NSP-ST           PIC XX.
  4736         16  EC-RT-AH-NSP-ST           PIC XX.
  4737         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4738         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4739
  4740         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4741             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4742                                             'M' '5' '9' '2'.
  4743             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4744             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4745             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4746             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4747             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4748             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4749             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4750             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4751             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4752             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4753
  4754         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4755             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4756                                             'M' '5' '9' '2'.
  4757             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4758             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4759             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  88
* EL050.cbl
  4760             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4761             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4762             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4763             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4764             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4765             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4766             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4767
  4768         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4769         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4770         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4771         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4772         16  EC-CM-DEATH-DT            PIC XX.
  4773
  4774*DMD CUSTOM CODING FIELDS BELOW
  4775*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4776         16  EC-BR-DMD-RATING-SW       PIC X.
  4777                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4778                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4779                 88  NO-DMD-RATING               VALUE 'N'.
  4780
  4781         16  EC-NEW-CERT               PIC X(11).
  4782         16  EC-NEW-STATE              PIC XX.
  4783         16  FILLER                    PIC X.
  4784*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4785         16  OVER-SHORT-EDIT-FIELDS.
  4786             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4787             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4788             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4789             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4790             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4791             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4792             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4793             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4794             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4795         16  FILLER                    PIC X(71).
  4796******************************************************************
  4797
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  89
* EL050.cbl
  4799*    COPY ELCDIFRD.
  4800******************************************************************
  4801*                                                                *
  4802*                                                                *
  4803*                            ELCDIFRD.                           *
  4804*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4805*                            VMOD=2.004                          *
  4806*                                                                *
  4807*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4808*                                                                *
  4809******************************************************************
  4810*
  4811  01  WS-DIFFERENCE-CALCULATION.
  4812        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4813        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4814        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4815        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4816        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4817        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4818        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4819        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4820        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4821        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4822        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4823
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  90
* EL050.cbl
  4825****************************************************************
  4826*
  4827* Copyright (c) 2007 by Clerity Solutions, Inc.
  4828* All rights reserved.
  4829*
  4830****************************************************************
  4831 01  DFHEIV.
  4832   02  DFHEIV0               PIC X(35).
  4833   02  DFHEIV1               PIC X(08).
  4834   02  DFHEIV2               PIC X(08).
  4835   02  DFHEIV3               PIC X(08).
  4836   02  DFHEIV4               PIC X(06).
  4837   02  DFHEIV5               PIC X(04).
  4838   02  DFHEIV6               PIC X(04).
  4839   02  DFHEIV7               PIC X(02).
  4840   02  DFHEIV8               PIC X(02).
  4841   02  DFHEIV9               PIC X(01).
  4842   02  DFHEIV10              PIC S9(7) COMP-3.
  4843   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4844   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4845   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4846   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4847   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4848   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4849   02  DFHEIV17              PIC X(04).
  4850   02  DFHEIV18              PIC X(04).
  4851   02  DFHEIV19              PIC X(04).
  4852   02  DFHEIV20              USAGE IS POINTER.
  4853   02  DFHEIV21              USAGE IS POINTER.
  4854   02  DFHEIV22              USAGE IS POINTER.
  4855   02  DFHEIV23              USAGE IS POINTER.
  4856   02  DFHEIV24              USAGE IS POINTER.
  4857   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4858   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4859   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4860   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4861   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4862   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4863   02  FILLER                PIC X(02).
  4864   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4865   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4866   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4867   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4868   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4869 LINKAGE  SECTION.
  4870*****************************************************************
  4871*                                                               *
  4872* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4873* All rights reserved.                                          *
  4874*                                                               *
  4875*****************************************************************
  4876 01  dfheiblk.
  4877     02  eibtime          pic s9(7) comp-3.
  4878     02  eibdate          pic s9(7) comp-3.
  4879     02  eibtrnid         pic x(4).
  4880     02  eibtaskn         pic s9(7) comp-3.
  4881     02  eibtrmid         pic x(4).
  4882     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  91
* EL050.cbl
  4883     02  eibcposn         pic s9(4) comp.
  4884     02  eibcalen         pic s9(4) comp.
  4885     02  eibaid           pic x(1).
  4886     02  eibfiller1       pic x(1).
  4887     02  eibfn            pic x(2).
  4888     02  eibfiller2       pic x(2).
  4889     02  eibrcode         pic x(6).
  4890     02  eibfiller3       pic x(2).
  4891     02  eibds            pic x(8).
  4892     02  eibreqid         pic x(8).
  4893     02  eibrsrce         pic x(8).
  4894     02  eibsync          pic x(1).
  4895     02  eibfree          pic x(1).
  4896     02  eibrecv          pic x(1).
  4897     02  eibsend          pic x(1).
  4898     02  eibatt           pic x(1).
  4899     02  eibeoc           pic x(1).
  4900     02  eibfmh           pic x(1).
  4901     02  eibcompl         pic x(1).
  4902     02  eibsig           pic x(1).
  4903     02  eibconf          pic x(1).
  4904     02  eiberr           pic x(1).
  4905     02  eibrldbk         pic x(1).
  4906     02  eiberrcd         pic x(4).
  4907     02  eibsynrb         pic x(1).
  4908     02  eibnodat         pic x(1).
  4909     02  eibfiller5       pic x(2).
  4910     02  eibresp          pic 9(09) comp.
  4911     02  eibresp2         pic 9(09) comp.
  4912     02  dfheigdj         pic s9(4) comp.
  4913     02  dfheigdk         pic s9(4) comp.
  4914
  4915 01  DFHCOMMAREA                   PIC X(1036).
  4916
  4917*01 PARMLIST .
  4918*    02  FILLER                    PIC S9(8)   COMP.
  4919*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  4920*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  4921*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  4922*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  4923*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  4924*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  4925*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  4926
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  92
* EL050.cbl
  4928*    COPY ELCCNTL.
  4929******************************************************************
  4930*                                                                *
  4931*                                                                *
  4932*                            ELCCNTL.                            *
  4933*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4934*                            VMOD=2.059                          *
  4935*                                                                *
  4936*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4937*                                                                *
  4938*   FILE TYPE = VSAM,KSDS                                        *
  4939*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4940*                                                                *
  4941*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4942*       ALTERNATE INDEX = NONE                                   *
  4943*                                                                *
  4944*   LOG = YES                                                    *
  4945*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4946******************************************************************
  4947*                   C H A N G E   L O G
  4948*
  4949* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4950*-----------------------------------------------------------------
  4951*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4952* EFFECTIVE    NUMBER
  4953*-----------------------------------------------------------------
  4954* 082503                   PEMA  ADD BENEFIT GROUP
  4955* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4956* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4957* 092705    2005050300006  PEMA  ADD SPP LEASES
  4958* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4959* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4960* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4961* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4962* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4963* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4964* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4965* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4966* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4967******************************************************************
  4968*
  4969 01  CONTROL-FILE.
  4970     12  CF-RECORD-ID                       PIC XX.
  4971         88  VALID-CF-ID                        VALUE 'CF'.
  4972
  4973     12  CF-CONTROL-PRIMARY.
  4974         16  CF-COMPANY-ID                  PIC XXX.
  4975         16  CF-RECORD-TYPE                 PIC X.
  4976             88  CF-COMPANY-MASTER              VALUE '1'.
  4977             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4978             88  CF-STATE-MASTER                VALUE '3'.
  4979             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4980             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4981             88  CF-CARRIER-MASTER              VALUE '6'.
  4982             88  CF-MORTALITY-MASTER            VALUE '7'.
  4983             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4984             88  CF-TERMINAL-MASTER             VALUE '9'.
  4985             88  CF-AH-EDIT-MASTER              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  93
* EL050.cbl
  4986             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4987             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4988             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4989             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4990             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4991             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4992             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4993             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4994         16  CF-ACCESS-CD-GENL              PIC X(4).
  4995         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4996             20  CF-PROCESSOR               PIC X(4).
  4997         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4998             20  CF-STATE-CODE              PIC XX.
  4999             20  FILLER                     PIC XX.
  5000         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5001             20  FILLER                     PIC XX.
  5002             20  CF-HI-BEN-IN-REC           PIC XX.
  5003         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5004             20  FILLER                     PIC XXX.
  5005             20  CF-CARRIER-CNTL            PIC X.
  5006         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5007             20  FILLER                     PIC XX.
  5008             20  CF-HI-TYPE-IN-REC          PIC 99.
  5009         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5010             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5011                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5012             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5013             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5014         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5015             20  FILLER                     PIC X.
  5016             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5017         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5018             20  FILLER                     PIC XX.
  5019             20  CF-MORTGAGE-PLAN           PIC XX.
  5020         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5021
  5022     12  CF-LAST-MAINT-DT                   PIC XX.
  5023     12  CF-LAST-MAINT-BY                   PIC X(4).
  5024     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5025
  5026     12  CF-RECORD-BODY                     PIC X(728).
  5027
  5028
  5029****************************************************************
  5030*             COMPANY MASTER RECORD                            *
  5031****************************************************************
  5032
  5033     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5034         16  CF-COMPANY-ADDRESS.
  5035             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5036             20  CF-CL-IN-CARE-OF           PIC X(30).
  5037             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5038             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5039             20  CF-CL-CITY-STATE           PIC X(30).
  5040             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5041             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5042         16  CF-COMPANY-CD                  PIC X.
  5043         16  CF-COMPANY-PASSWORD            PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  94
* EL050.cbl
  5044         16  CF-SECURITY-OPTION             PIC X.
  5045             88  ALL-SECURITY                   VALUE '1'.
  5046             88  COMPANY-VERIFY                 VALUE '2'.
  5047             88  PROCESSOR-VERIFY               VALUE '3'.
  5048             88  NO-SECURITY                    VALUE '4'.
  5049             88  ALL-BUT-TERM                   VALUE '5'.
  5050         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5051             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5052         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5053             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5054         16  CF-INFORCE-LOCATION            PIC X.
  5055             88  CERTS-ARE-ONLINE               VALUE '1'.
  5056             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5057             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5058         16  CF-LOWER-CASE-LETTERS          PIC X.
  5059         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5060             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5061             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5062             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5063             88  CF-ACCNT-CNTL                  VALUE '3'.
  5064             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5065
  5066         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5067         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5068
  5069         16  CF-LGX-CREDIT-USER             PIC X.
  5070             88  CO-IS-NOT-USER                 VALUE 'N'.
  5071             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5072
  5073         16 CF-CREDIT-CALC-CODES.
  5074             20  CF-CR-REM-TERM-CALC PIC X.
  5075               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5076               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5077               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5078               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5079               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5080               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5081               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5082             20  CF-CR-R78-METHOD           PIC X.
  5083               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5084               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5085
  5086         16  CF-CLAIM-CONTROL-COUNTS.
  5087             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5088                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5089
  5090             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5091                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5092
  5093             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5094                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5095
  5096             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5097                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5098
  5099         16  CF-CURRENT-MONTH-END           PIC XX.
  5100
  5101         16  CF-CO-CALC-QUOTE-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  95
* EL050.cbl
  5102             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5103             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5104             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5105             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5106                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5107                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5108             20  CF-CO-PREM-REJECT-SW       PIC X.
  5109                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5110                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5111             20  CF-CO-REF-REJECT-SW        PIC X.
  5112                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5113                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5114
  5115         16  CF-CO-REPORTING-DT             PIC XX.
  5116         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5117         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5118           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5119           88  CF-CO-MONTH-END                  VALUE '1'.
  5120
  5121         16  CF-LGX-CLAIM-USER              PIC X.
  5122             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5123             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5124
  5125         16  CF-CREDIT-EDIT-CONTROLS.
  5126             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5127             20  CF-MIN-AGE                 PIC 99.
  5128             20  CF-DEFAULT-AGE             PIC 99.
  5129             20  CF-MIN-TERM                PIC S999      COMP-3.
  5130             20  CF-MAX-TERM                PIC S999      COMP-3.
  5131             20  CF-DEFAULT-SEX             PIC X.
  5132             20  CF-JOINT-AGE-INPUT         PIC X.
  5133                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5134             20  CF-BIRTH-DATE-INPUT        PIC X.
  5135                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5136             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5137                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5138                 88  CF-ZERO-CARRIER            VALUE '1'.
  5139                 88  CF-ZERO-GROUPING           VALUE '2'.
  5140                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5141             20  CF-EDIT-SW                 PIC X.
  5142                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5143             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5144             20  CF-CR-PR-METHOD            PIC X.
  5145               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5146               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5147             20  FILLER                     PIC X.
  5148
  5149         16  CF-CREDIT-MISC-CONTROLS.
  5150             20  CF-REIN-TABLE-SW           PIC X.
  5151                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5152             20  CF-COMP-TABLE-SW           PIC X.
  5153                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5154             20  CF-EXPERIENCE-RETENTION-AGE
  5155                                            PIC S9        COMP-3.
  5156             20  CF-CONVERSION-DT           PIC XX.
  5157             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5158             20  CF-RUN-FREQUENCY-SW        PIC X.
  5159                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  96
* EL050.cbl
  5160                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5161
  5162             20  CF-CR-CHECK-NO-CONTROL.
  5163                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5164                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5165                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5166                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5167                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5168                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5169
  5170                 24  CF-CR-CHECK-COUNT       REDEFINES
  5171                     CF-CR-CHECK-COUNTER      PIC X(4).
  5172
  5173                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5174                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5175
  5176                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5177                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5178                 24  CF-MAIL-PROCESSING       PIC X.
  5179                     88  MAIL-PROCESSING          VALUE 'Y'.
  5180
  5181         16  CF-MISC-SYSTEM-CONTROL.
  5182             20  CF-SYSTEM-C                 PIC X.
  5183                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5184             20  CF-SYSTEM-D                 PIC X.
  5185                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5186             20  CF-SOC-SEC-NO-SW            PIC X.
  5187                 88  SOC-SEC-NO-USED             VALUE '1'.
  5188             20  CF-MEMBER-NO-SW             PIC X.
  5189                 88  MEMBER-NO-USED              VALUE '1'.
  5190             20  CF-TAX-ID-NUMBER            PIC X(11).
  5191             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5192             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5193                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5194                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5195                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5196                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5197             20  CF-SYSTEM-E                 PIC X.
  5198                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5199
  5200         16  CF-LGX-LIFE-USER               PIC X.
  5201             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5202             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5203
  5204         16  CF-CR-MONTH-END-DT             PIC XX.
  5205
  5206         16  CF-FILE-MAINT-DATES.
  5207             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5208                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5209             20  CF-LAST-BATCH       REDEFINES
  5210                 CF-LAST-BATCH-NO               PIC X(4).
  5211             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5212             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5213             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5214             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5215             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5216             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5217             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  97
* EL050.cbl
  5218             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5219             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5220             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5221
  5222         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5223         16  FILLER                         PIC X.
  5224
  5225         16  CF-ALT-MORT-CODE               PIC X(4).
  5226         16  CF-MEMBER-CAPTION              PIC X(10).
  5227
  5228         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5229             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5230             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5231             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5232             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5233             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5234
  5235         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5236
  5237         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5238         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5239         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5240         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5241
  5242         16  CF-AH-OVERRIDE-L1              PIC X.
  5243         16  CF-AH-OVERRIDE-L2              PIC XX.
  5244         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5245         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5246
  5247         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5248         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5249
  5250         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5251         16  CF-AR-LAST-EL860-DT            PIC XX.
  5252         16  CF-MP-MONTH-END-DT             PIC XX.
  5253
  5254         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5255         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5256             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5257
  5258         16  CF-AR-MONTH-END-DT             PIC XX.
  5259
  5260         16  CF-CRDTCRD-USER                PIC X.
  5261             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5262             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5263
  5264         16  CF-CC-MONTH-END-DT             PIC XX.
  5265
  5266         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5267
  5268         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5269             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5270             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5271             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5272         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5273         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5274         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5275         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  98
* EL050.cbl
  5276             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5277             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5278         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5279         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5280         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5281             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5282         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5283
  5284         16  CF-CL-ZIP-CODE.
  5285             20  CF-CL-ZIP-PRIME.
  5286                 24  CF-CL-ZIP-1ST          PIC X.
  5287                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5288                 24  FILLER                 PIC X(4).
  5289             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5290         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5291             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5292             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5293             20  FILLER                     PIC XXX.
  5294
  5295         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5296         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5297         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5298         16  CF-CO-OPTION-START-DATE        PIC XX.
  5299         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5300           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5301                                                      '3' '4'.
  5302           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5303           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5304           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5305           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5306           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5307           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5308
  5309         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5310
  5311         16  CF-PAYMENT-APPROVAL-LEVELS.
  5312             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5313             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5314             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5315             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5316             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5317             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5318
  5319         16  CF-END-USER-REPORTING-USER     PIC X.
  5320             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5321             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5322
  5323         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5324             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5325             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5326
  5327         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5328
  5329         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5330         16  FILLER                         PIC X.
  5331
  5332         16  CF-CREDIT-ARCHIVE-CNTL.
  5333             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page  99
* EL050.cbl
  5334             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5335             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5336
  5337         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5338
  5339         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5340             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5341             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5342
  5343         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5344             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5345             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5346
  5347         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5348
  5349         16  CF-CO-ACH-ID-CODE              PIC  X.
  5350             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5351             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5352             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5353         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5354         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5355         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5356         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5357         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5358         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5359         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5360         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5361         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5362                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5363         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5364                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5365
  5366         16  CF-CO-OVER-SHORT.
  5367             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5368             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5369
  5370*         16  FILLER                         PIC X(102).
  5371         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5372             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5373             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5374
  5375         16  CF-AH-APPROVAL-DAYS.
  5376             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5377             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5378             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5379             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5380
  5381         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5382
  5383         16  CF-APPROV-LEV-5.
  5384             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5385             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5386             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5387
  5388         16  FILLER                         PIC X(68).
  5389****************************************************************
  5390*             PROCESSOR/USER RECORD                            *
  5391****************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 100
* EL050.cbl
  5392
  5393     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5394         16  CF-PROCESSOR-NAME              PIC X(30).
  5395         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5396         16  CF-PROCESSOR-TITLE             PIC X(26).
  5397         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5398                 88  MESSAGE-YES                VALUE 'Y'.
  5399                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5400
  5401*****************************************************
  5402****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5403****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5404****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5405****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5406*****************************************************
  5407
  5408         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5409             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5410             20  CF-APPLICATION-FORCE       PIC X.
  5411             20  CF-INDIVIDUAL-APP.
  5412                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5413                     28  CF-BROWSE-APP      PIC X.
  5414                     28  CF-UPDATE-APP      PIC X.
  5415
  5416         16  CF-CURRENT-TERM-ON             PIC X(4).
  5417         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5418             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5419             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5420             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5421             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5422             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5423             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5424             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5425         16  CF-PROCESSOR-CARRIER           PIC X.
  5426             88  NO-CARRIER-SECURITY            VALUE ' '.
  5427         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5428             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5429         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5430             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5431         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5432             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5433
  5434         16  CF-PROC-SYS-ACCESS-SW.
  5435             20  CF-PROC-CREDIT-CLAIMS-SW.
  5436                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5437                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5438                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5439                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5440             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5441                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5442                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5443             20  CF-PROC-LIFE-GNRLDGR-SW.
  5444                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5445                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5446                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5447                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5448             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5449                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 101
* EL050.cbl
  5450                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5451         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5452             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5453             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5454         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5455
  5456         16  CF-APPROVAL-LEVEL                  PIC X.
  5457             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5458             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5459             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5460             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5461             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5462
  5463         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5464
  5465         16  CF-LANGUAGE-TYPE                   PIC X.
  5466             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5467             88  CF-LANG-IS-FR                      VALUE 'F'.
  5468
  5469         16  CF-CSR-IND                         PIC X.
  5470         16  FILLER                             PIC X(239).
  5471
  5472****************************************************************
  5473*             PROCESSOR/REMINDERS RECORD                       *
  5474****************************************************************
  5475
  5476     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5477         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5478             20  CF-START-REMIND-DT         PIC XX.
  5479             20  CF-END-REMIND-DT           PIC XX.
  5480             20  CF-REMINDER-TEXT           PIC X(50).
  5481         16  FILLER                         PIC X(296).
  5482
  5483
  5484****************************************************************
  5485*             STATE MASTER RECORD                              *
  5486****************************************************************
  5487
  5488     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5489         16  CF-STATE-ABBREVIATION          PIC XX.
  5490         16  CF-STATE-NAME                  PIC X(25).
  5491         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5492         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5493             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5494             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5495             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5496             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5497                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5498                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5499             20  CF-ST-PREM-REJECT-SW       PIC X.
  5500                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5501                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5502             20  CF-ST-REF-REJECT-SW        PIC X.
  5503                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5504                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5505         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5506         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5507         16  CF-ST-REFUND-RULES.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 102
* EL050.cbl
  5508             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5509             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5510             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5511         16  CF-ST-FST-PMT-EXTENSION.
  5512             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5513             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5514                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5515                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5516                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5517                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5518         16  CF-ST-STATE-CALL.
  5519             20  CF-ST-CALL-UNEARNED        PIC X.
  5520             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5521             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5522         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5523             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5524             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5525         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5526         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5527         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5528         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5529         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5530         16  FILLER                         PIC X.
  5531         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5532             20  CF-ST-BENEFIT-CD           PIC XX.
  5533             20  CF-ST-BENEFIT-KIND         PIC X.
  5534                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5535                 88  CF-ST-AH-KIND              VALUE 'A'.
  5536             20  CF-ST-REM-TERM-CALC        PIC X.
  5537                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5538                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5539                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5540                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5541                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5542                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5543                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5544                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5545
  5546             20  CF-ST-REFUND-CALC          PIC X.
  5547                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5548                 88  ST-REFD-BY-R78             VALUE '1'.
  5549                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5550                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5551                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5552                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5553                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5554                 88  ST-REFD-UTAH               VALUE '7'.
  5555                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5556                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5557                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5558
  5559             20  CF-ST-EARNING-CALC         PIC X.
  5560                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5561                 88  ST-EARN-BY-R78             VALUE '1'.
  5562                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5563                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5564                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5565                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 103
* EL050.cbl
  5566                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5567                 88  ST-EARN-MEAN               VALUE '8'.
  5568                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5569
  5570             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5571                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5572                 88  ST-OVRD-BY-R78             VALUE '1'.
  5573                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5574                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5575                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5576                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5577                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5578                 88  ST-OVRD-MEAN               VALUE '8'.
  5579                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5580             20  FILLER                     PIC X.
  5581
  5582         16  CF-ST-COMMISSION-CAPS.
  5583             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5584             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5585             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5586             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5587         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5588                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5589
  5590         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5591
  5592         16  CF-ST-STATUTORY-INTEREST.
  5593             20  CF-ST-STAT-DATE-FROM       PIC X.
  5594                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5595                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5596             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5597             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5598             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5599             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5600             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5601
  5602         16  CF-ST-OVER-SHORT.
  5603             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5604             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5605
  5606         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5607
  5608         16  CF-ST-RT-CALC                  PIC X.
  5609
  5610         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5611         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5612         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5613         16  CF-ST-RF-LR-CALC               PIC X.
  5614         16  CF-ST-RF-LL-CALC               PIC X.
  5615         16  CF-ST-RF-LN-CALC               PIC X.
  5616         16  CF-ST-RF-AH-CALC               PIC X.
  5617         16  CF-ST-RF-CP-CALC               PIC X.
  5618*        16  FILLER                         PIC X(206).
  5619*CIDMOD         16  FILLER                         PIC X(192).
  5620         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5621             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5622         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5623         16  CF-ST-VFY-2ND-BENE             PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 104
* EL050.cbl
  5624         16  CF-ST-CAUSAL-STATE             PIC X.
  5625         16  FILLER                         PIC X(185).
  5626
  5627****************************************************************
  5628*             BENEFIT MASTER RECORD                            *
  5629****************************************************************
  5630
  5631     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5632         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5633             20  CF-BENEFIT-CODE            PIC XX.
  5634             20  CF-BENEFIT-NUMERIC  REDEFINES
  5635                 CF-BENEFIT-CODE            PIC XX.
  5636             20  CF-BENEFIT-ALPHA           PIC XXX.
  5637             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5638             20  CF-BENEFIT-COMMENT         PIC X(10).
  5639
  5640             20  CF-LF-COVERAGE-TYPE        PIC X.
  5641                 88  CF-REDUCING                VALUE 'R'.
  5642                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5643
  5644             20  CF-SPECIAL-CALC-CD         PIC X.
  5645                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5646                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5647                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5648                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5649                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5650                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5651                 88  CF-FARM-PLAN               VALUE 'F'.
  5652                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5653                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5654                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5655                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5656                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5657                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5658                 88  CF-PRUDENTIAL              VALUE 'P'.
  5659                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5660                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5661                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5662                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5663                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5664                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5665
  5666             20  CF-JOINT-INDICATOR         PIC X.
  5667                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5668
  5669*            20  FILLER                     PIC X(12).
  5670             20  FILLER                     PIC X(11).
  5671             20  CF-BENEFIT-CATEGORY        PIC X.
  5672             20  CF-LOAN-TYPE               PIC X(8).
  5673
  5674             20  CF-CO-REM-TERM-CALC        PIC X.
  5675                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5676                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5677                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5678                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5679                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5680
  5681             20  CF-CO-EARNINGS-CALC        PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 105
* EL050.cbl
  5682                 88  CO-EARN-BY-R78             VALUE '1'.
  5683                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5684                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5685                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5686                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5687                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5688                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5689                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5690
  5691             20  CF-CO-REFUND-CALC          PIC X.
  5692                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5693                 88  CO-REFD-BY-R78             VALUE '1'.
  5694                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5695                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5696                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5697                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5698                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5699                 88  CO-REFD-MEAN               VALUE '8'.
  5700                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5701                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5702                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5703
  5704             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5705                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5706                 88  CO-OVRD-BY-R78             VALUE '1'.
  5707                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5708                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5709                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5710                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5711                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5712                 88  CO-OVRD-MEAN               VALUE '8'.
  5713                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5714
  5715             20  CF-CO-BEN-I-G-CD           PIC X.
  5716                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5717                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5718                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5719
  5720         16  FILLER                         PIC X(304).
  5721
  5722
  5723****************************************************************
  5724*             CARRIER MASTER RECORD                            *
  5725****************************************************************
  5726
  5727     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5728         16  CF-ADDRESS-DATA.
  5729             20  CF-MAIL-TO-NAME            PIC X(30).
  5730             20  CF-IN-CARE-OF              PIC X(30).
  5731             20  CF-ADDRESS-LINE-1          PIC X(30).
  5732             20  CF-ADDRESS-LINE-2          PIC X(30).
  5733             20  CF-CITY-STATE              PIC X(30).
  5734             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5735             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5736
  5737         16  CF-CLAIM-NO-CONTROL.
  5738             20  CF-CLAIM-NO-METHOD         PIC X.
  5739                 88  CLAIM-NO-MANUAL            VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 106
* EL050.cbl
  5740                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5741                 88  CLAIM-NO-SEQ               VALUE '3'.
  5742                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5743             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5744                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5745                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5746                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5747
  5748         16  CF-CHECK-NO-CONTROL.
  5749             20  CF-CHECK-NO-METHOD         PIC X.
  5750                 88  CHECK-NO-MANUAL            VALUE '1'.
  5751                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5752                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5753                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5754             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5755                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5756
  5757         16  CF-DOMICILE-STATE              PIC XX.
  5758
  5759         16  CF-EXPENSE-CONTROLS.
  5760             20  CF-EXPENSE-METHOD          PIC X.
  5761                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5762                 88  DOLLARS-PER-PMT            VALUE '2'.
  5763                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5764                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5765             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5766             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5767
  5768         16  CF-CORRESPONDENCE-CONTROL.
  5769             20  CF-LETTER-RESEND-OPT       PIC X.
  5770                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5771                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5772             20  FILLER                     PIC X(4).
  5773
  5774         16  CF-RESERVE-CONTROLS.
  5775             20  CF-MANUAL-SW               PIC X.
  5776                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5777             20  CF-FUTURE-SW               PIC X.
  5778                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5779             20  CF-PTC-SW                  PIC X.
  5780                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5781             20  CF-IBNR-SW                 PIC X.
  5782                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5783             20  CF-PTC-LF-SW               PIC X.
  5784                 88  CF-LF-PTC-USED             VALUE '1'.
  5785             20  CF-CDT-ACCESS-METHOD       PIC X.
  5786                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5787                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5788                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5789             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5790
  5791         16  CF-CLAIM-CALC-METHOD           PIC X.
  5792             88  360-PLUS-MONTHS                VALUE '1'.
  5793             88  365-PLUS-MONTHS                VALUE '2'.
  5794             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5795             88  360-DAILY                      VALUE '4'.
  5796             88  365-DAILY                      VALUE '5'.
  5797
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 107
* EL050.cbl
  5798         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5799         16  FILLER                         PIC X(11).
  5800
  5801         16  CF-LIMIT-AMOUNTS.
  5802             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5803             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5804             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5805             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5806             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5807             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5808             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5809             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5810             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5811             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5812
  5813         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5814         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5815         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5816
  5817         16  CF-ZIP-CODE.
  5818             20  CF-ZIP-PRIME.
  5819                 24  CF-ZIP-1ST             PIC X.
  5820                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5821                 24  FILLER                 PIC X(4).
  5822             20  CF-ZIP-PLUS4               PIC X(4).
  5823         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5824             20  CF-CAN-POSTAL-1            PIC XXX.
  5825             20  CF-CAN-POSTAL-2            PIC XXX.
  5826             20  FILLER                     PIC XXX.
  5827
  5828         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5829         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5830         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5831
  5832         16  CF-RATING-SWITCH               PIC X.
  5833             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5834             88  CF-NO-RATING                   VALUE 'N'.
  5835
  5836         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5837
  5838         16  CF-CARRIER-OVER-SHORT.
  5839             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5840             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5841
  5842         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5843         16  CF-SECPAY-SWITCH               PIC X.
  5844             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5845             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5846         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5847         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5848         16  FILLER                         PIC X(444).
  5849*        16  FILLER                         PIC X(452).
  5850
  5851
  5852****************************************************************
  5853*             MORTALITY MASTER RECORD                          *
  5854****************************************************************
  5855
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 108
* EL050.cbl
  5856     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5857         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5858                                INDEXED BY CF-MORT-NDX.
  5859             20  CF-MORT-TABLE              PIC X(5).
  5860             20  CF-MORT-TABLE-TYPE         PIC X.
  5861                 88  CF-MORT-JOINT              VALUE 'J'.
  5862                 88  CF-MORT-SINGLE             VALUE 'S'.
  5863                 88  CF-MORT-COMBINED           VALUE 'C'.
  5864                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5865                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5866             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5867             20  CF-MORT-AGE-METHOD         PIC XX.
  5868                 88  CF-AGE-LAST                VALUE 'AL'.
  5869                 88  CF-AGE-NEAR                VALUE 'AN'.
  5870             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5871             20  CF-MORT-ADJUSTMENT-DIRECTION
  5872                                            PIC X.
  5873                 88  CF-MINUS                   VALUE '-'.
  5874                 88  CF-PLUS                    VALUE '+'.
  5875             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5876             20  CF-MORT-JOINT-CODE         PIC X.
  5877                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5878             20  CF-MORT-PC-Q               PIC X.
  5879                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5880             20  CF-MORT-TABLE-CODE         PIC X(4).
  5881             20  CF-MORT-COMMENTS           PIC X(15).
  5882             20  FILLER                     PIC X(14).
  5883
  5884         16  FILLER                         PIC X(251).
  5885
  5886
  5887****************************************************************
  5888*             BUSSINESS TYPE MASTER RECORD                     *
  5889****************************************************************
  5890
  5891     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5892* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5893* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5894* AND RECORD 05 IS TYPES 81-99
  5895         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5896             20  CF-BUSINESS-TITLE          PIC  X(19).
  5897             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5898                                            PIC S9V9(4) COMP-3.
  5899             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5900             20  FILLER                     PIC  X.
  5901         16  FILLER                         PIC  X(248).
  5902
  5903
  5904****************************************************************
  5905*             TERMINAL MASTER RECORD                           *
  5906****************************************************************
  5907
  5908     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5909
  5910         16  CF-COMPANY-TERMINALS.
  5911             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5912                                  PIC X(4).
  5913         16  FILLER               PIC X(248).
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 109
* EL050.cbl
  5914
  5915
  5916****************************************************************
  5917*             LIFE EDIT MASTER RECORD                          *
  5918****************************************************************
  5919
  5920     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5921         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5922             20  CF-LIFE-CODE-IN            PIC XX.
  5923             20  CF-LIFE-CODE-OUT           PIC XX.
  5924         16  FILLER                         PIC X(248).
  5925
  5926
  5927****************************************************************
  5928*             AH EDIT MASTER RECORD                            *
  5929****************************************************************
  5930
  5931     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5932         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5933             20  CF-AH-CODE-IN              PIC XXX.
  5934             20  CF-AH-CODE-OUT             PIC XX.
  5935         16  FILLER                         PIC X(248).
  5936
  5937
  5938****************************************************************
  5939*             CREDIBILITY TABLES                               *
  5940****************************************************************
  5941
  5942     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5943         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5944                             INDEXED BY CF-CRDB-NDX.
  5945             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5946             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5947             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5948         16  FILLER                         PIC  X(332).
  5949
  5950
  5951****************************************************************
  5952*             REPORT CUSTOMIZATION RECORD                      *
  5953****************************************************************
  5954
  5955     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5956         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5957             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5958             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5959             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5960**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5961****       A T-TRANSFER.                                   ****
  5962             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5963
  5964         16  FILLER                         PIC XX.
  5965
  5966         16  CF-CARRIER-CNTL-OPT.
  5967             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5968                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5969                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5970             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5971                                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 110
* EL050.cbl
  5972         16  CF-GROUP-CNTL-OPT.
  5973             20  CF-GROUP-OPT-SEQ           PIC 9.
  5974                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5975                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5976             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5977                                            PIC X(6).
  5978         16  CF-STATE-CNTL-OPT.
  5979             20  CF-STATE-OPT-SEQ           PIC 9.
  5980                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5981                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5982             20  CF-STATE-SELECT OCCURS 3 TIMES
  5983                                            PIC XX.
  5984         16  CF-ACCOUNT-CNTL-OPT.
  5985             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5986                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5987                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5988             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5989                                            PIC X(10).
  5990         16  CF-BUS-TYP-CNTL-OPT.
  5991             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5992                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5993                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5994             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5995                                            PIC XX.
  5996         16  CF-LF-TYP-CNTL-OPT.
  5997             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5998                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5999                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6000             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6001                                            PIC XX.
  6002         16  CF-AH-TYP-CNTL-OPT.
  6003             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6004                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6005                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6006             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  6007                                            PIC XX.
  6008         16  CF-REPTCD1-CNTL-OPT.
  6009             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6010                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6011                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6012             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6013                                            PIC X(10).
  6014         16  CF-REPTCD2-CNTL-OPT.
  6015             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6016                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6017                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6018             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6019                                            PIC X(10).
  6020         16  CF-USER1-CNTL-OPT.
  6021             20  CF-USER1-OPT-SEQ           PIC 9.
  6022                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6023                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6024             20  CF-USER1-SELECT OCCURS 3 TIMES
  6025                                            PIC X(10).
  6026         16  CF-USER2-CNTL-OPT.
  6027             20  CF-USER2-OPT-SEQ           PIC 9.
  6028                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6029                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 111
* EL050.cbl
  6030             20  CF-USER2-SELECT OCCURS 3 TIMES
  6031                                            PIC X(10).
  6032         16  CF-USER3-CNTL-OPT.
  6033             20  CF-USER3-OPT-SEQ           PIC 9.
  6034                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6035                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6036             20  CF-USER3-SELECT OCCURS 3 TIMES
  6037                                            PIC X(10).
  6038         16  CF-USER4-CNTL-OPT.
  6039             20  CF-USER4-OPT-SEQ           PIC 9.
  6040                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6041                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6042             20  CF-USER4-SELECT OCCURS 3 TIMES
  6043                                            PIC X(10).
  6044         16  CF-USER5-CNTL-OPT.
  6045             20  CF-USER5-OPT-SEQ           PIC 9.
  6046                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6047                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6048             20  CF-USER5-SELECT OCCURS 3 TIMES
  6049                                            PIC X(10).
  6050         16  CF-REINS-CNTL-OPT.
  6051             20  CF-REINS-OPT-SEQ           PIC 9.
  6052                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6053                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6054             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6055                 24  CF-REINS-PRIME         PIC XXX.
  6056                 24  CF-REINS-SUB           PIC XXX.
  6057
  6058         16  CF-AGENT-CNTL-OPT.
  6059             20  CF-AGENT-OPT-SEQ           PIC 9.
  6060                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6061                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6062             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6063                                            PIC X(10).
  6064
  6065         16  FILLER                         PIC X(43).
  6066
  6067         16  CF-LOSS-RATIO-SELECT.
  6068             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6069             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6070         16  CF-ENTRY-DATE-SELECT.
  6071             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6072             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6073         16  CF-EFFECTIVE-DATE-SELECT.
  6074             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6075             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6076
  6077         16  CF-EXCEPTION-LIST-IND          PIC X.
  6078             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6079
  6080         16  FILLER                         PIC X(318).
  6081
  6082****************************************************************
  6083*                  EXCEPTION REPORTING RECORD                  *
  6084****************************************************************
  6085
  6086     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6087         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 112
* EL050.cbl
  6088             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6089
  6090         16  CF-COMBINED-LIFE-AH-OPT.
  6091             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6092             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6093             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6094             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6095
  6096         16  CF-LIFE-OPT.
  6097             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6098             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6099             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6100             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6101             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6102             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6103             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6104             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6105             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6106             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6107
  6108         16  CF-AH-OPT.
  6109             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6110             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6111             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6112             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6113             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6114             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6115             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6116             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6117             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6118             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6119
  6120         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6121             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6122             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6123             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6124
  6125         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6126
  6127         16  FILLER                         PIC X(673).
  6128
  6129
  6130****************************************************************
  6131*             MORTGAGE SYSTEM PLAN RECORD                      *
  6132****************************************************************
  6133
  6134     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6135         16  CF-PLAN-TYPE                   PIC X.
  6136             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6137             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6138             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6139         16  CF-PLAN-ABBREV                 PIC XXX.
  6140         16  CF-PLAN-DESCRIPT               PIC X(10).
  6141         16  CF-PLAN-NOTES                  PIC X(20).
  6142         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6143         16  CF-PLAN-UNDERWRITING.
  6144             20  CF-PLAN-TERM-DATA.
  6145                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 113
* EL050.cbl
  6146                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6147             20  CF-PLAN-AGE-DATA.
  6148                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6149                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6150                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6151             20  CF-PLAN-BENEFIT-DATA.
  6152                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6153                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6154                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6155                                            PIC S9(7)V99  COMP-3.
  6156         16  CF-PLAN-POLICY-FORMS.
  6157             20  CF-POLICY-FORM             PIC X(12).
  6158             20  CF-MASTER-APPLICATION      PIC X(12).
  6159             20  CF-MASTER-POLICY           PIC X(12).
  6160         16  CF-PLAN-RATING.
  6161             20  CF-RATE-CODE               PIC X(5).
  6162             20  CF-SEX-RATING              PIC X.
  6163                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6164                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6165             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6166             20  CF-SUB-STD-TYPE            PIC X.
  6167                 88  CF-PCT-OF-PREM            VALUE '1'.
  6168                 88  CF-PCT-OF-BENE            VALUE '2'.
  6169         16  CF-PLAN-PREM-TOLERANCES.
  6170             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6171             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6172         16  CF-PLAN-PYMT-TOLERANCES.
  6173             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6174             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6175         16  CF-PLAN-MISC-DATA.
  6176             20  FILLER                     PIC X.
  6177             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6178             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6179         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6180         16  CF-PLAN-IND-GRP                PIC X.
  6181             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6182                                                     '1'.
  6183             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6184                                                     '2'.
  6185         16  CF-MIB-SEARCH-SW               PIC X.
  6186             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6187             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6188             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6189             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6190         16  CF-ALPHA-SEARCH-SW             PIC X.
  6191             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6192             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6193             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6194             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6195             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6196             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6197             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6198             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6199             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6200             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6201                                                     'A' 'B' 'C'
  6202                                                     'X' 'Y' 'Z'.
  6203         16  CF-EFF-DT-RULE-SW              PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 114
* EL050.cbl
  6204             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6205             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6206             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6207             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6208             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6209         16  FILLER                         PIC X(4).
  6210         16  CF-HEALTH-QUESTIONS            PIC X.
  6211             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6212         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6213         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6214         16  CF-PLAN-SNGL-JNT               PIC X.
  6215             88  CF-COMBINED-PLAN              VALUE 'C'.
  6216             88  CF-JNT-PLAN                   VALUE 'J'.
  6217             88  CF-SNGL-PLAN                  VALUE 'S'.
  6218         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6219         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6220         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6221         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6222         16  CF-RERATE-CNTL                 PIC  X.
  6223             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6224             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6225             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6226             88  CF-AUTO-RECALC                 VALUE '4'.
  6227         16  CF-BENEFIT-TYPE                PIC  X.
  6228             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6229             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6230         16  CF-POLICY-FEE                  PIC S999V99
  6231                                                    COMP-3.
  6232         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6233         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6234         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6235         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6236         16  FILLER                         PIC  X(32).
  6237         16  CF-TERMINATION-FORM            PIC  X(04).
  6238         16  FILLER                         PIC  X(08).
  6239         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6240                                                       COMP-3.
  6241         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6242         16  CF-ISSUE-LETTER                PIC  X(4).
  6243         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6244         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6245             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6246             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6247         16  CF-MP-REFUND-CALC              PIC X.
  6248             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6249             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6250             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6251             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6252             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6253             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6254             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6255             88  CF-MP-REFD-MEAN                VALUE '8'.
  6256         16  CF-ALT-RATE-CODE               PIC  X(5).
  6257
  6258
  6259         16  FILLER                         PIC X(498).
  6260****************************************************************
  6261*             MORTGAGE COMPANY MASTER RECORD                   *
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 115
* EL050.cbl
  6262****************************************************************
  6263
  6264     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6265         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6266         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6267             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6268             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6269             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6270             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6271             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6272
  6273         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6274         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6275         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6276         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6277         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6278
  6279         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6280             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6281         16  CF-MP-RECON-USE-IND            PIC X(1).
  6282             88  CF-MP-USE-RECON             VALUE 'Y'.
  6283         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6284             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6285         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6286             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6287             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6288         16  FILLER                         PIC X(1).
  6289         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6290             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6291         16  CF-MORTG-MIB-VERSION           PIC X.
  6292             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6293             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6294             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6295         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6296             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6297                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6298             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6299                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6300             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6301                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6302             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6303                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6304             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6305                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6306             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6307                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6308         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6309         16  FILLER                         PIC X(7).
  6310         16  CF-MORTG-DESTINATION-SYMBOL.
  6311             20  CF-MORTG-MIB-COMM          PIC X(5).
  6312             20  CF-MORTG-MIB-TERM          PIC X(5).
  6313         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6314             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6315         16  FILLER                         PIC X(03).
  6316         16  CF-MP-CHECK-NO-CONTROL.
  6317             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6318                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6319                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 116
* EL050.cbl
  6320                                                ' ' LOW-VALUES.
  6321                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6322                                               VALUE '3'.
  6323         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6324         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6325         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6326             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6327                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6328             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6329                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6330             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6331                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6332             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6333                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6334             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6335                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6336             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6337                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6338         16  CF-MORTG-BILLING-AREA.
  6339             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6340                                            PIC X.
  6341         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6342         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6343         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6344         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6345             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6346             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6347         16  FILLER                         PIC X.
  6348         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6349             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6350             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6351         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6352         16  FILLER                         PIC X(8).
  6353         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6354         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6355         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6356         16  CF-ACH-COMPANY-ID.
  6357             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6358                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6359                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6360                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6361             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6362         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6363             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6364         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6365             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6366             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6367         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6368         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6369         16  FILLER                         PIC X(536).
  6370
  6371****************************************************************
  6372*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6373****************************************************************
  6374
  6375     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6376         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6377             20  CF-FEMALE-HEIGHT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 117
* EL050.cbl
  6378                 24  CF-FEMALE-FT           PIC 99.
  6379                 24  CF-FEMALE-IN           PIC 99.
  6380             20  CF-FEMALE-MIN-WT           PIC 999.
  6381             20  CF-FEMALE-MAX-WT           PIC 999.
  6382         16  FILLER                         PIC X(428).
  6383
  6384     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6385         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6386             20  CF-MALE-HEIGHT.
  6387                 24  CF-MALE-FT             PIC 99.
  6388                 24  CF-MALE-IN             PIC 99.
  6389             20  CF-MALE-MIN-WT             PIC 999.
  6390             20  CF-MALE-MAX-WT             PIC 999.
  6391         16  FILLER                         PIC X(428).
  6392******************************************************************
  6393*             AUTOMATIC ACTIVITY RECORD                          *
  6394******************************************************************
  6395     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6396         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6397             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6398             20  CF-SYS-LETTER-ID           PIC X(04).
  6399             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6400             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6401             20  CF-SYS-RESET-SW            PIC X(01).
  6402             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6403             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6404
  6405         16  FILLER                         PIC X(50).
  6406
  6407         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6408             20  CF-USER-ACTIVE-SW          PIC X(01).
  6409             20  CF-USER-LETTER-ID          PIC X(04).
  6410             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6411             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6412             20  CF-USER-RESET-SW           PIC X(01).
  6413             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6414             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6415             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6416
  6417         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 118
* EL050.cbl
  6419*    COPY ERCACCT.
  6420******************************************************************
  6421*                                                                *
  6422*                                                                *
  6423*                            ERCACCT                             *
  6424*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6425*                            VMOD=2.031                          *
  6426*                                                                *
  6427*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6428*                                                                *
  6429*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6430*   VSAM ACCOUNT MASTER FILES.                                   *
  6431*                                                                *
  6432*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6433*                                                                *
  6434*   FILE TYPE = VSAM,KSDS                                        *
  6435*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6436*                                                                *
  6437*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6438*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6439*                                                                *
  6440*   LOG = NO                                                     *
  6441*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6442*                                                                *
  6443*                                                                *
  6444******************************************************************
  6445*                   C H A N G E   L O G
  6446*
  6447* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6448*-----------------------------------------------------------------
  6449*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6450* EFFECTIVE    NUMBER
  6451*-----------------------------------------------------------------
  6452* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6453* 092705    2005050300006  PEMA  ADD SPP LEASES
  6454* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6455* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6456* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6457* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6458* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6459******************************************************************
  6460
  6461 01  ACCOUNT-MASTER.
  6462     12  AM-RECORD-ID                      PIC XX.
  6463         88  VALID-AM-ID                      VALUE 'AM'.
  6464
  6465     12  AM-CONTROL-PRIMARY.
  6466         16  AM-COMPANY-CD                 PIC X.
  6467         16  AM-MSTR-CNTRL.
  6468             20  AM-CONTROL-A.
  6469                 24  AM-CARRIER            PIC X.
  6470                 24  AM-GROUPING.
  6471                     28 AM-GROUPING-PREFIX PIC XXX.
  6472                     28 AM-GROUPING-PRIME  PIC XXX.
  6473                 24  AM-STATE              PIC XX.
  6474                 24  AM-ACCOUNT.
  6475                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6476                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 119
* EL050.cbl
  6477             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6478                                           PIC X(19).
  6479             20  AM-CNTRL-B.
  6480                 24  AM-EXPIRATION-DT      PIC XX.
  6481                 24  FILLER                PIC X(4).
  6482             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6483                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6484
  6485     12  AM-CONTROL-BY-VAR-GRP.
  6486         16  AM-COMPANY-CD-A1              PIC X.
  6487         16  AM-VG-CARRIER                 PIC X.
  6488         16  AM-VG-GROUPING                PIC X(6).
  6489         16  AM-VG-STATE                   PIC XX.
  6490         16  AM-VG-ACCOUNT                 PIC X(10).
  6491         16  AM-VG-DATE.
  6492             20  AM-VG-EXPIRATION-DT       PIC XX.
  6493             20  FILLER                    PIC X(4).
  6494         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6495                                           PIC 9(11)      COMP-3.
  6496     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6497         16  FILLER                        PIC X(10).
  6498         16  AM-VG-KEY3.
  6499             20  AM-VG3-ACCOUNT            PIC X(10).
  6500             20  AM-VG3-EXP-DT             PIC XX.
  6501         16  FILLER                        PIC X(4).
  6502     12  AM-MAINT-INFORMATION.
  6503         16  AM-LAST-MAINT-DT              PIC XX.
  6504         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6505         16  AM-LAST-MAINT-USER            PIC X(4).
  6506         16  FILLER                        PIC XX.
  6507
  6508     12  AM-EFFECTIVE-DT                   PIC XX.
  6509     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6510
  6511     12  AM-PREV-DATES  COMP-3.
  6512         16  AM-PREV-EXP-DT                PIC 9(11).
  6513         16  AM-PREV-EFF-DT                PIC 9(11).
  6514
  6515     12  AM-REPORT-CODE-1                  PIC X(10).
  6516     12  AM-REPORT-CODE-2                  PIC X(10).
  6517
  6518     12  AM-CITY-CODE                      PIC X(4).
  6519     12  AM-COUNTY-PARISH                  PIC X(6).
  6520
  6521     12  AM-NAME                           PIC X(30).
  6522     12  AM-PERSON                         PIC X(30).
  6523     12  AM-ADDRS                          PIC X(30).
  6524     12  AM-CITY.
  6525         16  AM-ADDR-CITY                  PIC X(28).
  6526         16  AM-ADDR-STATE                 PIC XX.
  6527     12  AM-ZIP.
  6528         16  AM-ZIP-PRIME.
  6529             20  AM-ZIP-PRI-1ST            PIC X.
  6530                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6531             20  FILLER                    PIC X(4).
  6532         16  AM-ZIP-PLUS4                  PIC X(4).
  6533     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6534         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 120
* EL050.cbl
  6535         16  AM-CAN-POSTAL-2               PIC XXX.
  6536         16  FILLER                        PIC XXX.
  6537     12  AM-TEL-NO.
  6538         16  AM-AREA-CODE                  PIC 999.
  6539         16  AM-TEL-PRE                    PIC 999.
  6540         16  AM-TEL-NBR                    PIC 9(4).
  6541     12  AM-TEL-LOC                        PIC X.
  6542         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6543         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6544
  6545     12  AM-COMM-STRUCTURE.
  6546         16  AM-DEFN-1.
  6547             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6548                 24  AM-AGT.
  6549                     28  AM-AGT-PREFIX     PIC X(4).
  6550                     28  AM-AGT-PRIME      PIC X(6).
  6551                 24  AM-COM-TYP            PIC X.
  6552                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6553                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6554                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6555                 24  AM-RECALC-LV-INDIC    PIC X.
  6556                 24  AM-RETRO-LV-INDIC     PIC X.
  6557                 24  AM-GL-CODES           PIC X.
  6558                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6559                 24  FILLER                PIC X(01).
  6560         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6561             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6562                 24  FILLER                PIC X(11).
  6563                 24  AM-L-COMA             PIC XXX.
  6564                 24  AM-J-COMA             PIC XXX.
  6565                 24  AM-A-COMA             PIC XXX.
  6566                 24  FILLER                PIC X(6).
  6567
  6568     12  AM-COMM-CHANGE-STATUS             PIC X.
  6569         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6570
  6571     12  AM-CSR-CODE                       PIC X(4).
  6572
  6573     12  AM-BILLING-STATUS                 PIC X.
  6574         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6575         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6576     12  AM-AUTO-REFUND-SW                 PIC X.
  6577         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6578         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6579     12  AM-GPCD                           PIC 99.
  6580     12  AM-IG                             PIC X.
  6581         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6582         88  AM-HAS-GROUP                     VALUE '2'.
  6583     12  AM-STATUS                         PIC X.
  6584         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6585         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6586         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6587         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6588         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6589         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6590     12  AM-REMIT-TO                       PIC 99.
  6591     12  AM-ID-NO                          PIC X(11).
  6592
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 121
* EL050.cbl
  6593     12  AM-CAL-TABLE                      PIC XX.
  6594     12  AM-LF-DEVIATION                   PIC XXX.
  6595     12  AM-AH-DEVIATION                   PIC XXX.
  6596     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6597     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6598     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6599     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6600     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6601     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6602
  6603     12  AM-USER-FIELDS.
  6604         16  AM-FLD-1                      PIC XX.
  6605         16  AM-FLD-2                      PIC XX.
  6606         16  AM-FLD-3                      PIC XX.
  6607         16  AM-FLD-4                      PIC XX.
  6608         16  AM-FLD-5                      PIC XX.
  6609
  6610     12  AM-1ST-PROD-DATE.
  6611         16  AM-1ST-PROD-YR                PIC XX.
  6612         16  AM-1ST-PROD-MO                PIC XX.
  6613         16  AM-1ST-PROD-DA                PIC XX.
  6614     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6615     12  AM-CERTS-PURGED-DATE.
  6616         16  AM-PUR-YR                     PIC XX.
  6617         16  AM-PUR-MO                     PIC XX.
  6618         16  AM-PUR-DA                     PIC XX.
  6619     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6620     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6621     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6622     12  AM-INACTIVE-DATE.
  6623         16  AM-INA-MO                     PIC 99.
  6624         16  AM-INA-DA                     PIC 99.
  6625         16  AM-INA-YR                     PIC 99.
  6626     12  AM-AR-HI-CERT-DATE                PIC XX.
  6627
  6628     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6629     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6630
  6631     12  AM-OB-PAYMENT-MODE                PIC X.
  6632         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6633         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6634         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6635         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6636
  6637     12  AM-AH-ONLY-INDICATOR              PIC X.
  6638         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6639         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6640
  6641     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6642
  6643     12  AM-OVER-SHORT.
  6644         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6645         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6646
  6647     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6648     12  AM-DCC-CLP-STATE                  PIC XX.
  6649
  6650     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 122
* EL050.cbl
  6651     12  AM-RECALC-REIN                    PIC X.
  6652
  6653     12  AM-REI-TABLE                      PIC XXX.
  6654     12  AM-REI-ET-LF                      PIC X.
  6655     12  AM-REI-ET-AH                      PIC X.
  6656     12  AM-REI-PE-LF                      PIC X.
  6657     12  AM-REI-PE-AH                      PIC X.
  6658     12  AM-REI-PRT-ST                     PIC X.
  6659     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6660     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6661     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6662     12  AM-REI-GROUP-A                    PIC X(6).
  6663     12  AM-REI-MORT                       PIC X(4).
  6664     12  AM-REI-PRT-OW                     PIC X.
  6665     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6666     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6667     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6668     12  AM-REI-GROUP-B                    PIC X(6).
  6669
  6670     12  AM-TRUST-TYPE                     PIC X(2).
  6671
  6672     12  AM-EMPLOYER-STMT-USED             PIC X.
  6673     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6674
  6675     12  AM-STD-AH-TYPE                    PIC XX.
  6676     12  AM-EARN-METHODS.
  6677         16  AM-EARN-METHOD-R              PIC X.
  6678             88 AM-REF-RL-R78                 VALUE 'R'.
  6679             88 AM-REF-RL-PR                  VALUE 'P'.
  6680             88 AM-REF-RL-MEAN                VALUE 'M'.
  6681             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6682         16  AM-EARN-METHOD-L              PIC X.
  6683             88 AM-REF-LL-R78                 VALUE 'R'.
  6684             88 AM-REF-LL-PR                  VALUE 'P'.
  6685             88 AM-REF-LL-MEAN                VALUE 'M'.
  6686             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6687         16  AM-EARN-METHOD-A              PIC X.
  6688             88 AM-REF-AH-R78                 VALUE 'R'.
  6689             88 AM-REF-AH-PR                  VALUE 'P'.
  6690             88 AM-REF-AH-MEAN                VALUE 'M'.
  6691             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6692             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6693             88 AM-REF-AH-NET                 VALUE 'N'.
  6694
  6695     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6696     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6697     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6698
  6699     12  AM-RET-Y-N                        PIC X.
  6700     12  AM-RET-P-E                        PIC X.
  6701     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6702     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6703     12  AM-RET-GRP                        PIC X(6).
  6704     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6705         16  AM-POOL-PRIME                 PIC XXX.
  6706         16  AM-POOL-SUB                   PIC XXX.
  6707     12  AM-RETRO-EARNINGS.
  6708         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 123
* EL050.cbl
  6709         16  AM-RET-EARN-L                 PIC X.
  6710         16  AM-RET-EARN-A                 PIC X.
  6711     12  AM-RET-ST-TAX-USE                 PIC X.
  6712         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6713         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6714     12  AM-RETRO-BEG-EARNINGS.
  6715         16  AM-RET-BEG-EARN-R             PIC X.
  6716         16  AM-RET-BEG-EARN-L             PIC X.
  6717         16  AM-RET-BEG-EARN-A             PIC X.
  6718     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6719     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6720
  6721     12  AM-USER-SELECT-OPTIONS.
  6722         16  AM-USER-SELECT-1              PIC X(10).
  6723         16  AM-USER-SELECT-2              PIC X(10).
  6724         16  AM-USER-SELECT-3              PIC X(10).
  6725         16  AM-USER-SELECT-4              PIC X(10).
  6726         16  AM-USER-SELECT-5              PIC X(10).
  6727
  6728     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6729
  6730     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6731
  6732     12  AM-RPT045A-SWITCH                 PIC X.
  6733         88  RPT045A-OFF                   VALUE 'N'.
  6734
  6735     12  AM-INSURANCE-LIMITS.
  6736         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6737         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6738
  6739     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6740         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6741
  6742     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6743         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6744         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6745
  6746     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6747
  6748     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6749     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6750     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6751     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6752     12  AM-DCC-UEF-STATE                  PIC XX.
  6753     12  FILLER                            PIC XXX.
  6754     12  AM-REPORT-CODE-3                  PIC X(10).
  6755*    12  FILLER                            PIC X(22).
  6756
  6757     12  AM-RESERVE-DATE.
  6758         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6759         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6760         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6761
  6762     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6763     12  AM-NOTIFICATION-TYPES.
  6764         16  AM-NOTIF-OF-LETTERS           PIC X.
  6765         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6766         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 124
* EL050.cbl
  6767         16  AM-NOTIF-OF-STATUS            PIC X.
  6768
  6769     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6770         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6771         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6772         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6773         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6774
  6775     12  AM-BENEFIT-CONTROLS.
  6776         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6777             20  AM-BENEFIT-CODE           PIC XX.
  6778             20  AM-BENEFIT-TYPE           PIC X.
  6779             20  AM-BENEFIT-REVISION       PIC XXX.
  6780             20  AM-BENEFIT-REM-TERM       PIC X.
  6781             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6782             20  FILLER                    PIC XX.
  6783         16  FILLER                        PIC X(80).
  6784
  6785     12  AM-TRANSFER-DATA.
  6786         16  AM-TRANSFERRED-FROM.
  6787             20  AM-TRNFROM-CARRIER        PIC X.
  6788             20  AM-TRNFROM-GROUPING.
  6789                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6790                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6791             20  AM-TRNFROM-STATE          PIC XX.
  6792             20  AM-TRNFROM-ACCOUNT.
  6793                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6794                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6795             20  AM-TRNFROM-DTE            PIC XX.
  6796         16  AM-TRANSFERRED-TO.
  6797             20  AM-TRNTO-CARRIER          PIC X.
  6798             20  AM-TRNTO-GROUPING.
  6799                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6800                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6801             20  AM-TRNTO-STATE            PIC XX.
  6802             20  AM-TRNTO-ACCOUNT.
  6803                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6804                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6805             20  AM-TRNTO-DTE              PIC XX.
  6806         16  FILLER                        PIC X(10).
  6807
  6808     12  AM-SAVED-REMIT-TO                 PIC 99.
  6809
  6810     12  AM-COMM-STRUCTURE-SAVED.
  6811         16  AM-DEFN-1-SAVED.
  6812             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6813                 24  AM-AGT-SV             PIC X(10).
  6814                 24  AM-COM-TYP-SV         PIC X.
  6815                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6816                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6817                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6818                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6819                 24  FILLER                PIC X.
  6820                 24  AM-GL-CODES-SV        PIC X.
  6821                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6822                 24  FILLER                PIC X.
  6823         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6824             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 125
* EL050.cbl
  6825                 24  FILLER                PIC X(11).
  6826                 24  AM-L-COMA-SV          PIC XXX.
  6827                 24  AM-J-COMA-SV          PIC XXX.
  6828                 24  AM-A-COMA-SV          PIC XXX.
  6829                 24  FILLER                PIC X(6).
  6830
  6831     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6832         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6833            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6834            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6835            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6836
  6837     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6838     12  FILLER                            PIC X(120).
  6839
  6840     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6841         16  AM-CONTROL-NAME               PIC X(30).
  6842         16  AM-EXECUTIVE-ONE.
  6843             20  AM-EXEC1-NAME             PIC X(15).
  6844             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6845                                                          COMP-3.
  6846             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6847                                                          COMP-3.
  6848         16  AM-EXECUTIVE-TWO.
  6849             20  AM-EXEC2-NAME             PIC X(15).
  6850             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6851                                                          COMP-3.
  6852             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6853                                                          COMP-3.
  6854
  6855     12  AM-RETRO-ADDITIONAL-DATA.
  6856         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6857         16  AM-RETRO-PREM-P-E             PIC X.
  6858         16  AM-RETRO-CLMS-P-I             PIC X.
  6859         16  AM-RETRO-RET-BRACKET-LF.
  6860             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6861                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6862                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6863             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6864                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6865                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6866             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6867                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6868                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6869         16  AM-RETRO-RET-BRACKET-AH.
  6870             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6871                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6872                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6873                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6874             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6875                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6876                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6877             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6878                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6879                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6880
  6881     12  AM-COMMENTS.
  6882         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 126
* EL050.cbl
  6883
  6884     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6885         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6886         16  AM-FLI-BILLING-CODE           PIC X.
  6887         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6888         16  AM-FLI-UNITED-IDENT           PIC X.
  6889         16  AM-FLI-INTEREST-LOST-DATA.
  6890             20  AM-FLI-BANK-NO            PIC X(5).
  6891             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6892             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6893             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6894         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6895             20  AM-FLI-AGT                PIC X(9).
  6896             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6897             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6898         16  FILLER                        PIC X(102).
  6899
  6900     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6901         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6902             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6903             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6904             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6905             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6906             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6907         16  FILLER                          PIC X(10).
  6908******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 127
* EL050.cbl
  6910*    COPY ERCREIN.
  6911******************************************************************
  6912*                                                                *
  6913*                            ERCREIN                             *
  6914*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6915*                            VMOD=2.010                          *
  6916*                                                                *
  6917*   ONLINE CREDIT SYSTEM                                         *
  6918*                                                                *
  6919*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6920*                                                                *
  6921*   FILE TYPE = VSAM,KSDS                                        *
  6922*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6923*                                                                *
  6924*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6925*       ALTERNATE PATH = NONE                                    *
  6926*                                                                *
  6927*   LOG = NO                                                     *
  6928*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6929*                                                                *
  6930******************************************************************
  6931*                   C H A N G E   L O G
  6932*
  6933* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6934*-----------------------------------------------------------------
  6935*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6936* EFFECTIVE    NUMBER
  6937*-----------------------------------------------------------------
  6938* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6939* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6940******************************************************************
  6941 01  REINSURANCE-RECORD.
  6942     12  RE-RECORD-ID                      PIC XX.
  6943         88  VALID-RE-ID                      VALUE 'RE'.
  6944
  6945     12  RE-CONTROL-PRIMARY.
  6946         16  RE-COMPANY-CD                 PIC X.
  6947         16  RE-KEY.
  6948             20  RE-CODE                   PIC X.
  6949                 88  RE-TABLE-RECORD          VALUE 'A'.
  6950                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6951             20  RE-TABLE                  PIC XXX.
  6952             20  FILLER                    PIC XXX.
  6953         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6954             20  FILLER                    PIC X.
  6955             20  RE-COMPANY.
  6956                 24  RE-COMP-PRIME         PIC XXX.
  6957                 24  RE-COMP-SUB           PIC XXX.
  6958
  6959     12  RE-MAINT-INFORMATION.
  6960         16  RE-LAST-MAINT-DT              PIC XX.
  6961         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6962         16  RE-LAST-MAINT-USER            PIC X(4).
  6963         16  FILLER                        PIC X(10).
  6964
  6965     12  RE-TABLE-DATA.
  6966         16  RE-100-COMP                   PIC 99.
  6967
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 128
* EL050.cbl
  6968         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6969             20  RE-REI-COMP-NO.
  6970                 24  RE-REI-COMP           PIC XXX.
  6971                 24  RE-REI-COMP-SUB       PIC XXX.
  6972             20  RE-LF-QC                  PIC X.
  6973             20  RE-AH-QC                  PIC X.
  6974             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6975             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6976             20  RE-LFAGE-LO               PIC 99.
  6977             20  RE-LFAGE-HI               PIC 99.
  6978             20  RE-AHAGE-LO               PIC 99.
  6979             20  RE-AHAGE-HI               PIC 99.
  6980             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6981             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6982             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6983             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6984             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6985             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6986             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6987             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6988             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6989             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6990             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6991             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6992             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6993             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6994             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6995             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6996             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6997             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6998             20  RE-LF-BEN-CODE            PIC X.
  6999             20  RE-AH-BEN-CODE            PIC X.
  7000             20  RE-INTERACTIVE            PIC X.
  7001             20  RE-REMAINING              PIC X.
  7002             20  RE-LF-RUNOFF-SW           PIC X.
  7003             20  RE-AH-RUNOFF-SW           PIC X.
  7004             20  FILLER                    PIC X(19).
  7005
  7006         16  RE-COMP-INFO-END              PIC X(6).
  7007         16  RE-NSP-ST-CD-LF               PIC XX.
  7008         16  RE-NSP-ST-CD-AH               PIC XX.
  7009         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7010             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7011
  7012         16  FILLER                        PIC X(27).
  7013
  7014     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7015         16  RE-NAME                       PIC X(30).
  7016         16  RE-LF-PE                      PIC X.
  7017         16  RE-AH-PE                      PIC X.
  7018         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7019         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7020         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7021         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7022         16  RE-PRT-ST                     PIC X.
  7023         16  RE-PRT-OW                     PIC X.
  7024         16  RE-MORT-CODE                  PIC X(4).
  7025         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 129
* EL050.cbl
  7026         16  RE-ZERO-LF-FEE                PIC X.
  7027         16  RE-ZERO-AH-FEE                PIC X.
  7028         16  RE-CEDE-NAME                  PIC X(30).
  7029         16  RE-LF-COMM                    PIC X.
  7030         16  RE-AH-COMM                    PIC X.
  7031         16  RE-LF-TAX                     PIC X.
  7032         16  RE-AH-TAX                     PIC X.
  7033         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7034         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7035         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7036
  7037         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7038             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7039
  7040         16  RE-LF-CEDING-FEE-BRACKETS.
  7041             20  RE-LF-FEE-METHOD          PIC X.
  7042                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7043                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7044                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7045                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7046             20  RE-LF-FEE-BASIS           PIC X.
  7047                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7048                 88  RE-LF-NET-CEDED               VALUE '2'.
  7049                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7050                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7051                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7052                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7053                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7054                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7055             20  FILLER                    PIC XXX.
  7056             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7057                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7058                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7059
  7060         16  RE-AH-CEDING-FEE-BRACKETS.
  7061             20  RE-AH-FEE-METHOD          PIC X.
  7062                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7063                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7064                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7065                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7066             20  RE-AH-FEE-BASIS           PIC X.
  7067                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7068                 88  RE-AH-NET-CEDED               VALUE '2'.
  7069                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7070                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7071                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7072                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7073                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7074                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7075             20  FILLER                    PIC XXX.
  7076             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7077                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7078                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7079
  7080         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7081
  7082         16  RE-OLD-CEDING-STMT            PIC X.
  7083
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 130
* EL050.cbl
  7084         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7085         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7086         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7087         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7088         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7089         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7090         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7091         16  RE-MORT-SW                    PIC X.
  7092         16  RE-CEDING-TYPE-FLAG           PIC X.
  7093             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7094             88  RE-CEDED                          VALUE 'C'.
  7095             88  RE-ASSUMED                        VALUE 'A'.
  7096             88  RE-PHANTOM                        VALUE 'P'.
  7097
  7098         16  RE-CEDING-STMT-OPT-A          PIC X.
  7099             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7100         16  RE-CEDING-STMT-OPT-B          PIC X.
  7101             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7102         16  RE-CEDING-STMT-OPT-C          PIC X.
  7103             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7104         16  RE-CEDING-STMT-OPT-D          PIC X.
  7105             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7106         16  RE-CEDING-STMT-OPT-E          PIC X.
  7107             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7108
  7109         16  RE-PRT-CRSV                   PIC X.
  7110
  7111         16  RE-GL-CENTER                  PIC X(4).
  7112
  7113         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7114
  7115         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7116
  7117         16  RE-EARN-STOP-CODE             PIC X.
  7118             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7119             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7120
  7121         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7122             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7123
  7124         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7125         16  FILLER                        PIC X(2281).
  7126
  7127         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7128
  7129******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 131
* EL050.cbl
  7131*    COPY ERCCTBL.
  7132******************************************************************
  7133*                                                                *
  7134*                                                                *
  7135*                            ERCCTBL                             *
  7136*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7137*                            VMOD=2.003
  7138*                                                                *
  7139*   ONLINE CREDIT SYSTEM                                         *
  7140*                                                                *
  7141*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7142*                                                                *
  7143*   FILE TYPE = VSAM,KSDS                                        *
  7144*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7145*                                                                *
  7146*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7147*       ALTERNATE PATH = NONE                                    *
  7148*                                                                *
  7149*   LOG = NO                                                     *
  7150*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7151*                                                                *
  7152*                                                                *
  7153******************************************************************
  7154
  7155 01  COMM-TABLE-RECORD.
  7156     12  CT-RECORD-ID                      PIC XX.
  7157         88  VALID-CT-ID                      VALUE 'CT'.
  7158
  7159     12  CT-CONTROL-PRIMARY.
  7160         16  CT-COMPANY-CD                 PIC X.
  7161         16  CT-TABLE                      PIC XXX.
  7162         16  CT-CNTRL-2.
  7163             20  CT-BEN-TYPE               PIC X.
  7164             20  CT-BEN-CODE               PIC XX.
  7165
  7166     12  CT-MAINT-INFORMATION.
  7167         16  CT-LAST-MAINT-DT              PIC XX.
  7168         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7169         16  CT-LAST-MAINT-USER            PIC X(4).
  7170         16  FILLER                        PIC X(31).
  7171
  7172     12  CT-LIMITS.
  7173         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7174
  7175         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7176
  7177         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7178
  7179     12  CT-RATES.
  7180         16  CT-RTX          OCCURS 27 TIMES.
  7181             20  CT-RT                     PIC SV9(5)     COMP-3.
  7182             20  CT-RT-R   REDEFINES
  7183                 CT-RT                     PIC XXX.
  7184
  7185     12  FILLER                            PIC  X(42).
  7186
  7187******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 132
* EL050.cbl
  7189*    COPY ERCFORM.
  7190******************************************************************
  7191*                                                                *
  7192*                                                                *
  7193*                            ERCFORM.                            *
  7194*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7195*                            VMOD=2.003                          *
  7196*                                                                *
  7197*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7198*                                                                *
  7199*    FILE TYPE = VSAM,KSDS                                       *
  7200*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7201*                                                                *
  7202*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7203*                                                                *
  7204*    LOG = YES                                                   *
  7205*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7206******************************************************************
  7207 01  FORM-MASTER.
  7208    12  FO-RECORD-ID                 PIC X(02).
  7209        88  VALID-FO-ID                  VALUE 'FO'.
  7210
  7211    12  FO-CONTROL-PRIMARY.
  7212        16  FO-COMPANY-CD            PIC X(01).
  7213        16  FO-STATE                 PIC X(02).
  7214        16  FO-FORM-ID               PIC X(12).
  7215        16  FO-FORM-EXP-DT           PIC X(02).
  7216
  7217    12  FO-POLICY-FORM-DATA.
  7218        16  FO-IND-GRP-CD            PIC X(01).
  7219        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7220        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7221        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7222        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7223        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7224        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7225        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7226        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7227        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7228        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7229        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7230        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7231        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7232        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7233        16  FO-APP-CERT-USE-CD       PIC X(01).
  7234
  7235    12  FILLER                       PIC X(29).
  7236
  7237    12  FO-FORM-PLAN-TABLE.
  7238        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7239            20  FO-PLAN-TYPE         PIC X(01).
  7240            20  FO-PLAN-ID           PIC X(02).
  7241            20  FO-PLAN-TERM         PIC 9(03).
  7242            20  FO-PLAN-REFUND-METHOD
  7243                                     PIC X.
  7244
  7245    12  FILLER                       PIC X(30).
  7246
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 133
* EL050.cbl
  7247    12  FO-COMMENTS-AREA.
  7248        16  FO-COMMENT-LINE-1        PIC X(78).
  7249
  7250    12  FILLER                       PIC X(20).
  7251
  7252    12  FO-MAINT-INFORMATION.
  7253        16  FO-LAST-MAINT-DT         PIC X(02).
  7254        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7255        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 134
* EL050.cbl
  7257*    COPY ELCMSTR.
  7258******************************************************************
  7259*                                                                *
  7260*                            ELCMSTR.                            *
  7261*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7262*                            VMOD=2.012                          *
  7263*                                                                *
  7264*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7265*                                                                *
  7266*   FILE TYPE = VSAM,KSDS                                        *
  7267*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7268*                                                                *
  7269*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7270*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7271*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7272*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7273*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7274*                                                 RKP=75,LEN=21  *
  7275*                                                                *
  7276*   **** NOTE ****                                               *
  7277*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7278*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7279*                                                                *
  7280*   LOG = YES                                                    *
  7281*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7282******************************************************************
  7283*                   C H A N G E   L O G
  7284*
  7285* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7286*-----------------------------------------------------------------
  7287*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7288* EFFECTIVE    NUMBER
  7289*-----------------------------------------------------------------
  7290* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7291* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7292* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7293******************************************************************
  7294 01  CLAIM-MASTER.
  7295     12  CL-RECORD-ID                PIC XX.
  7296         88  VALID-CL-ID         VALUE 'CL'.
  7297
  7298     12  CL-CONTROL-PRIMARY.
  7299         16  CL-COMPANY-CD           PIC X.
  7300         16  CL-CARRIER              PIC X.
  7301         16  CL-CLAIM-NO             PIC X(7).
  7302         16  CL-CERT-NO.
  7303             20  CL-CERT-PRIME       PIC X(10).
  7304             20  CL-CERT-SFX         PIC X.
  7305
  7306     12  CL-CONTROL-BY-NAME.
  7307         16  CL-COMPANY-CD-A1        PIC X.
  7308         16  CL-INSURED-LAST-NAME    PIC X(15).
  7309         16  CL-INSURED-NAME.
  7310             20  CL-INSURED-1ST-NAME PIC X(12).
  7311             20  CL-INSURED-MID-INIT PIC X.
  7312
  7313     12  CL-CONTROL-BY-SSN.
  7314         16  CL-COMPANY-CD-A2        PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 135
* EL050.cbl
  7315         16  CL-SOC-SEC-NO.
  7316             20  CL-SSN-STATE        PIC XX.
  7317             20  CL-SSN-ACCOUNT      PIC X(6).
  7318             20  CL-SSN-LN3          PIC X(3).
  7319
  7320     12  CL-CONTROL-BY-CERT-NO.
  7321         16  CL-COMPANY-CD-A4        PIC X.
  7322         16  CL-CERT-NO-A4.
  7323             20  CL-CERT-A4-PRIME    PIC X(10).
  7324             20  CL-CERT-A4-SFX      PIC X.
  7325
  7326     12  CL-CONTROL-BY-CCN.
  7327         16  CL-COMPANY-CD-A5        PIC X.
  7328         16  CL-CCN-A5.
  7329             20  CL-CCN.
  7330                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7331                 24  CL-CCN-PRIME-A5 PIC X(12).
  7332             20  CL-CCN-FILLER-A5    PIC X(4).
  7333
  7334     12  CL-INSURED-PROFILE-DATA.
  7335         16  CL-INSURED-BIRTH-DT     PIC XX.
  7336         16  CL-INSURED-SEX-CD       PIC X.
  7337             88  INSURED-IS-MALE        VALUE 'M'.
  7338             88  INSURED-IS-FEMALE      VALUE 'F'.
  7339             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7340         16  CL-INSURED-OCC-CD       PIC X(6).
  7341         16  FILLER                  PIC X(5).
  7342
  7343     12  CL-PROCESSING-INFO.
  7344         16  CL-PROCESSOR-ID         PIC X(4).
  7345         16  CL-CLAIM-STATUS         PIC X.
  7346             88  CLAIM-IS-OPEN          VALUE 'O'.
  7347             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7348         16  CL-CLAIM-TYPE           PIC X.
  7349*            88  AH-CLAIM               VALUE 'A'.
  7350*            88  LIFE-CLAIM             VALUE 'L'.
  7351*            88  PROPERTY-CLAIM         VALUE 'P'.
  7352*            88  IUI-CLAIM              VALUE 'I'.
  7353*            88  GAP-CLAIM              VALUE 'G'.
  7354         16  CL-CLAIM-PREM-TYPE      PIC X.
  7355             88  SINGLE-PREMIUM         VALUE '1'.
  7356             88  O-B-COVERAGE           VALUE '2'.
  7357             88  OPEN-END-COVERAGE      VALUE '3'.
  7358         16  CL-INCURRED-DT          PIC XX.
  7359         16  CL-REPORTED-DT          PIC XX.
  7360         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7361         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7362         16  CL-LAST-PMT-DT          PIC XX.
  7363         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7364         16  CL-PAID-THRU-DT         PIC XX.
  7365         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7366         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7367         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7368         16  CL-PMT-CALC-METHOD      PIC X.
  7369             88  CL-360-DAY-YR          VALUE '1'.
  7370             88  CL-365-DAY-YR          VALUE '2'.
  7371             88  CL-FULL-MONTHS         VALUE '3'.
  7372         16  CL-CAUSE-CD             PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 136
* EL050.cbl
  7373
  7374         16  CL-PRIME-CERT-NO.
  7375             20  CL-PRIME-CERT-PRIME PIC X(10).
  7376             20  CL-PRIME-CERT-SFX   PIC X.
  7377
  7378         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7379             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7380             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7381
  7382         16  CL-MICROFILM-NO         PIC X(10).
  7383         16  CL-PROG-FORM-TYPE       PIC X.
  7384         16  CL-LAST-ADD-ON-DT       PIC XX.
  7385
  7386         16  CL-LAST-REOPEN-DT       PIC XX.
  7387         16  CL-LAST-CLOSE-DT        PIC XX.
  7388         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7389             88  FINAL-PAID             VALUE '1'.
  7390             88  CLAIM-DENIED           VALUE '2'.
  7391             88  AUTO-CLOSE             VALUE '3'.
  7392             88  MANUAL-CLOSE           VALUE '4'.
  7393             88  BENEFITS-CHANGED       VALUE 'C'.
  7394             88  SETUP-ERRORS           VALUE 'E'.
  7395         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7396         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7397         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7398             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7399         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7400         16  FILLER                  PIC X.
  7401
  7402     12  CL-CERTIFICATE-DATA.
  7403         16  CL-CERT-ORIGIN          PIC X.
  7404             88  CERT-WAS-ONLINE        VALUE '1'.
  7405             88  CERT-WAS-CREATED       VALUE '2'.
  7406             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7407         16  CL-CERT-KEY-DATA.
  7408             20  CL-CERT-CARRIER     PIC X.
  7409             20  CL-CERT-GROUPING    PIC X(6).
  7410             20  CL-CERT-STATE       PIC XX.
  7411             20  CL-CERT-ACCOUNT.
  7412                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7413                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7414             20  CL-CERT-EFF-DT      PIC XX.
  7415
  7416     12  CL-STATUS-CONTROLS.
  7417         16  CL-PRIORITY-CD          PIC X.
  7418             88  CONFIDENTIAL-DATA      VALUE '8'.
  7419             88  HIGHEST-PRIORITY       VALUE '9'.
  7420         16  CL-SUPV-ATTN-CD         PIC X.
  7421             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7422             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7423         16  CL-PURGED-DT            PIC XX.
  7424         16  CL-RESTORED-DT          PIC XX.
  7425         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7426         16  CL-NEXT-RESEND-DT       PIC XX.
  7427         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7428         16  CL-CRITICAL-PERIOD      PIC 99.
  7429*        16  FILLER                  PIC XX.
  7430         16  CL-LAST-MAINT-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 137
* EL050.cbl
  7431         16  CL-LAST-MAINT-USER      PIC X(4).
  7432         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7433         16  CL-LAST-MAINT-TYPE      PIC X.
  7434             88  CLAIM-SET-UP           VALUE ' '.
  7435             88  PAYMENT-MADE           VALUE '1'.
  7436             88  LETTER-SENT            VALUE '2'.
  7437             88  MASTER-WAS-ALTERED     VALUE '3'.
  7438             88  MASTER-WAS-RESTORED    VALUE '4'.
  7439             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7440             88  FILE-CONVERTED         VALUE '6'.
  7441             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7442             88  ERROR-CORRECTION       VALUE 'E'.
  7443         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7444         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7445         16  CL-BENEFICIARY          PIC X(10).
  7446         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7447         16  CL-DENIAL-TYPE          PIC X.
  7448             88  CL-TYPE-DENIAL          VALUE '1'.
  7449             88  CL-TYPE-RESCISSION      VALUE '2'.
  7450             88  CL-TYPE-REFORMATION     VALUE '3'.
  7451             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7452             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7453         16  CL-CRIT-PER-RECURRENT   PIC X.
  7454         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7455         16  CL-RTW-DT               PIC XX.
  7456
  7457     12  CL-TRAILER-CONTROLS.
  7458         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7459             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7460             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7461             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7462         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7463         16  FILLER                  PIC XX.
  7464         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7465         16  CL-ADDRESS-TRAILER-CNT.
  7466             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7467                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7468             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7469                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7470             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7471                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7472             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7473                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7474             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7475                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7476             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7477                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7478             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7479                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7480
  7481     12  CL-CV-REFERENCE-NO.
  7482         16  CL-CV-REFNO-PRIME       PIC X(18).
  7483         16  CL-CV-REFNO-SFX         PIC XX.
  7484
  7485     12  CL-FILE-LOCATION            PIC X(4).
  7486
  7487     12  CL-PROCESS-ERRORS.
  7488         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 138
* EL050.cbl
  7489             88  NO-FATAL-ERRORS        VALUE ZERO.
  7490         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7491             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7492
  7493     12  CL-PRODUCT-CD               PIC X.
  7494
  7495     12  CL-CURRENT-KEY-DATA.
  7496         16  CL-CURRENT-CARRIER      PIC X.
  7497         16  CL-CURRENT-GROUPING     PIC X(6).
  7498         16  CL-CURRENT-STATE        PIC XX.
  7499         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7500
  7501     12  CL-ASSOCIATES               PIC X.
  7502         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7503         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7504         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7505         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7506
  7507     12  CL-ACTIVITY-CODE            PIC 99.
  7508     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7509     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7510
  7511     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7512     12  CL-LAG-REPORT-CODE          PIC 9.
  7513     12  CL-LOAN-TYPE                PIC XX.
  7514     12  CL-LEGAL-STATE              PIC XX.
  7515
  7516     12  CL-YESNOSW                  PIC X.
  7517     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7518         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7519         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7520         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7521     12  cl-insured-claim            pic x.
  7522         88  cl-claim-on-primary         value 'P'.
  7523         88  cl-claim-on-secondary       value 'S'.
  7524     12  cl-benefit-expiration-dt    PIC XX.
  7525
  7526 01  PLAN-RECORDS.
  7527     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7528     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7529
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 139
* EL050.cbl
  7531 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7532                          ACCOUNT-MASTER REINSURANCE-RECORD
  7533                          COMM-TABLE-RECORD FORM-MASTER
  7534                          CLAIM-MASTER PLAN-RECORDS.
  7535 0000-DFHEXIT SECTION.
  7536     MOVE '9#                    $   ' TO DFHEIV0.
  7537     MOVE 'EL050' TO DFHEIV1.
  7538     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7539
  7540     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7541
  7542
  7543* EXEC CICS  HANDLE CONDITION
  7544*           ERROR    (9300-ABEND)
  7545*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7546*    END-EXEC.
  7547*    MOVE '"$.J                  ! " #00007538' TO DFHEIV0
  7548     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7549     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7550     MOVE X'2220233030303037353338' TO DFHEIV0(25:11)
  7551     CALL 'kxdfhei1' USING DFHEIV0
  7552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7553
  7554
  7555 0000-COPY-PROCEDURE-DIV.
  7556*                          COPY ELC50PD.
  7557******************************************************************
  7558*                                                                *
  7559*                            ELC50PD                             *
  7560*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7561*                            VMOD=2.188                          *
  7562*                                                                *
  7563******************************************************************
  7564*                   C H A N G E   L O G
  7565*
  7566* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7567*-----------------------------------------------------------------
  7568*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7569* EFFECTIVE    NUMBER
  7570*-----------------------------------------------------------------
  7571* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7572* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7573* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7574*                             2709 AND 2718
  7575* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7576* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7577* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7578* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7579* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7580*                                IS OPEN OR CNC DT < PD THRU
  7581* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7582* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7583* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7584* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7585* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7586* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7587* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7588* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 140
* EL050.cbl
  7589* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7590* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7591* 020906                   PEMA  EXPAND LOAN OFFICER
  7592* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7593* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7594* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7595* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7596* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7597* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7598* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7599* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7600* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7601* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7602* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7603* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7604* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7605* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7606* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7607* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7608* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7609* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7610* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7611* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7612* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7613* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7614* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7615* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7616* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7617*                                UPDATE VIN ON CERT TRAILER
  7618* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7619* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7620* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7621* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7622* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7623* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7624* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7625* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  7626* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7627* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7628* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7629* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7630* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7631* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7632* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7633* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7634* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7635* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7636* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7637* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7638* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7639* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7640* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7641* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7642* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7643* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7644* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7645* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7646* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 141
* EL050.cbl
  7647* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7648* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7649* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7650* 032912  CR2011110200001  PEMA  AHL CHANGES
  7651* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7652* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7653* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7654* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7655* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7656* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7657* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7658* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7659* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7660* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7661* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7662* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7663* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7664* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7665* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7666* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7667* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7668* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7669* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7670* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7671******************************************************************
  7672************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7673******************************************************************
  7674
  7675     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7676
  7677     MOVE SPACES                 TO PB-FATAL-FLAG
  7678                                    PB-FORCE-ER-CD
  7679                                    PB-WARN-ER-CD
  7680                                    PB-OUT-BAL-CD.
  7681
  7682     MOVE SPACE                  TO WS-IG-OVRD-AH
  7683                                    WS-IG-OVRD-LF
  7684                                    WS-IG-OVRD-AM
  7685                                    WS-IG-OVRD
  7686                                    WS-IG-OVRD-AH-PL
  7687                                    WS-IG-OVRD-LF-PL
  7688                                    WS-IG-OVRD-AH-BEN
  7689                                    WS-IG-OVRD-LF-BEN.
  7690
  7691******************************************************************
  7692*************       INITIALIZE COMMON ERRORS       ***************
  7693******************************************************************
  7694
  7695     MOVE +0                     TO PB-NO-OF-ERRORS.
  7696     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7697
  7698******************************************************************
  7699
  7700     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7701     SET JULIAN-TO-BIN           TO TRUE.
  7702*    MOVE 5                      TO DC-OPTION-CODE.
  7703     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7704     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 142
* EL050.cbl
  7705
  7706     MOVE ZERO                   TO  SUB4.
  7707
  7708 0040-INITIALIZE-GA-BILL-DT.
  7709
  7710     ADD +1                      TO  SUB4.
  7711
  7712     IF  SUB4 GREATER THAN +5
  7713         GO TO 0050-CHECK-CNTL-FOUND.
  7714
  7715     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7716         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7717
  7718     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7719
  7720 0050-CHECK-CNTL-FOUND.
  7721
  7722     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7723        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7724                                         WS-AH-REM-TERM-CALC
  7725                                         EC-CO-REM-TERM-CALC
  7726        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7727        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7728        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7729                                         WS-TOL-AH-CLAIM
  7730        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7731                                         WS-TOL-AH-PREM
  7732                                         EC-CO-TOL-PREM
  7733        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7734                                         WS-TOL-AH-REFUND
  7735                                         EC-CO-TOL-REFUND
  7736        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7737                                         WS-AH-REFUND-OVS-AMT
  7738                                         EC-CO-OVR-SHT-AMT
  7739        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7740                                         WS-TOL-AH-PREM-PCT
  7741                                         EC-CO-TOL-PREM-PCT
  7742        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7743                                         WS-TOL-AH-REFUND-PCT
  7744                                         EC-CO-TOL-REFUND-PCT
  7745        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7746                                         WS-AH-REFUND-OVS-PCT
  7747                                         EC-CO-OVR-SHT-PCT
  7748        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7749        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7750        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7751        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7752        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7753        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7754        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7755        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7756        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7757        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7758        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7759        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7760                                         EC-CO-MONTH-END-DT
  7761        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7762          GO TO 0100-READ-ACCT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 143
* EL050.cbl
  7763
  7764     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7765     MOVE SPACES                 TO CNTL-ACCESS.
  7766     MOVE '1'                    TO CNTL-REC-TYPE.
  7767     MOVE +0                     TO CNTL-SEQ-NO.
  7768
  7769     MOVE '1' TO RC-SW-1.
  7770     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7771     IF NOT CF-COMPANY-MASTER
  7772         MOVE ZEROS             TO WK-CO-TOL-PREM
  7773                                   WK-CO-TOL-CLAIM
  7774                                   WK-CO-TOL-REFUND
  7775                                   WK-REFUND-OVS-AMT
  7776                                   WK-REFUND-OVS-PCT
  7777                                   WK-CO-TOL-PREM-PCT
  7778                                   WK-CO-TOL-REFUND-PCT
  7779                                   WK-DEFAULT-APR
  7780                                   WK-CO-MAX-CAP
  7781        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7782                                   WK-CR-R78-METHOD
  7783                                   WK-CO-REF-REJECT-SW
  7784                                   WK-CO-PREM-REJECT-SW
  7785                                   WK-REM-TRM-CALC-OPTION
  7786                                   WK-BIRTH-DATE-INPUT
  7787                                   WK-JOINT-AGE-INPUT
  7788        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7789        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7790        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7791        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7792          GO TO 0099-COMPANY-NOT-FOUND.
  7793
  7794     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7795        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7796     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7797        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7798     IF CF-CO-TOL-CAP NOT NUMERIC
  7799        MOVE +0                    TO CF-CO-TOL-CAP.
  7800     IF CF-DEFAULT-APR NOT NUMERIC
  7801        MOVE +0                    TO CF-DEFAULT-APR.
  7802
  7803     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7804     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7805     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7806     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7807     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7808     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7809     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7810     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7811     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7812     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7813     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7814     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7815
  7816     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7817          CF-CO-OVR-SHT-AMT > +0
  7818        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7819
  7820     IF CF-CO-OVR-SHT-PCT NUMERIC AND
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 144
* EL050.cbl
  7821          CF-CO-OVR-SHT-PCT > +0
  7822        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7823
  7824     IF CF-VALID-REM-TRM-OPTION
  7825         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7826     ELSE
  7827         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7828
  7829     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7830     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7831     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7832     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7833
  7834     GO TO 0050-CHECK-CNTL-FOUND.
  7835
  7836 0099-COMPANY-NOT-FOUND.
  7837
  7838     MOVE ER-2616                TO WS-ERROR.
  7839     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7840
  7841 0100-READ-ACCT.
  7842
  7843     MOVE SPACES                 TO DATE-RANGE-SW.
  7844
  7845     IF WK-ACCT-ADDR = ZEROS
  7846        GO TO 0102-ACCT-GETMAIN.
  7847
  7848     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7849     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7850     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7851
  7852     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7853        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7854        GO TO 0105-READ-ACCT
  7855     END-IF
  7856
  7857     IF PB-CARRIER NOT = SPACES
  7858        IF PB-CARRIER NOT = AM-VG-CARRIER
  7859           GO TO 0105-READ-ACCT.
  7860
  7861     IF PB-STATE NOT = SPACES
  7862        IF PB-STATE NOT = AM-VG-STATE
  7863           GO TO 0105-READ-ACCT.
  7864
  7865     IF PB-GROUPING NOT = SPACES
  7866        IF PB-GROUPING NOT = AM-VG-GROUPING
  7867           GO TO 0105-READ-ACCT.
  7868
  7869     MOVE 'X'                 TO DATE-RANGE-SW.
  7870
  7871     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7872        MOVE 'X'                 TO DATE-RANGE-SW
  7873        GO TO 0105-READ-ACCT.
  7874
  7875     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7876        GO TO 0105-READ-ACCT.
  7877
  7878     GO TO 0180-ACCOUNT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 145
* EL050.cbl
  7879
  7880 0102-ACCT-GETMAIN.
  7881     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  7882     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  7883
  7884 0105-READ-ACCT.
  7885     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  7886     MOVE PB-CARRIER             TO ACCT-CARRIER.
  7887     MOVE PB-GROUPING            TO ACCT-GROUPING.
  7888     MOVE PB-STATE               TO ACCT-STATE.
  7889     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  7890     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  7891
  7892     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  7893
  7894     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  7895
  7896 0110-FIND-ACCT-TOLERANCES-LOOP.
  7897     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  7898
  7899     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7900        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7901        GO TO 0199-ACCT-NOT-FOUND
  7902     END-IF
  7903     IF PB-CARRIER NOT = SPACES
  7904        IF PB-CARRIER NOT = AM-VG-CARRIER
  7905           GO TO 0199-ACCT-NOT-FOUND.
  7906
  7907     IF PB-STATE NOT = SPACES
  7908        IF PB-STATE NOT = AM-VG-STATE
  7909           GO TO 0199-ACCT-NOT-FOUND.
  7910
  7911     IF PB-GROUPING NOT = SPACES
  7912        IF PB-GROUPING NOT = AM-VG-GROUPING
  7913           GO TO 0199-ACCT-NOT-FOUND.
  7914
  7915     MOVE 'X'                    TO DATE-RANGE-SW.
  7916
  7917     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7918        MOVE 'X'                 TO DATE-RANGE-SW
  7919        GO TO 0199-ACCT-NOT-FOUND.
  7920
  7921     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7922        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  7923
  7924 0180-ACCOUNT-FOUND.
  7925     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  7926     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  7927     MOVE AM-STATE               TO PB-SV-STATE.
  7928     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  7929
  7930     IF AM-CANCEL-FEE  NOT NUMERIC
  7931        MOVE ZEROS TO AM-CANCEL-FEE.
  7932
  7933     IF AM-MAX-MON-BEN NOT NUMERIC
  7934        MOVE ZEROS TO AM-MAX-MON-BEN.
  7935
  7936     IF AM-MAX-TOT-BEN NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 146
* EL050.cbl
  7937        MOVE ZEROS TO AM-MAX-TOT-BEN.
  7938
  7939     IF AM-CLP-TOL-PCT NOT NUMERIC
  7940        MOVE +0                  TO AM-CLP-TOL-PCT
  7941     END-IF
  7942     IF AM-SPP-LEASE-COMM NOT NUMERIC
  7943        MOVE +0                  TO AM-SPP-LEASE-COMM
  7944     END-IF
  7945     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7946        MOVE ER-2611             TO   WS-ERROR
  7947        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7948
  7949     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7950        MOVE ER-2621             TO   WS-ERROR
  7951        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7952
  7953     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  7954        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  7955        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  7956        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  7957         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  7958
  7959     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  7960     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  7961     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  7962     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  7963     IF AM-CLP-TOL-PCT NOT = ZEROS
  7964        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  7965     END-IF
  7966     IF AM-SPP-LEASE-COMM NOT = ZEROS
  7967        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  7968     END-IF
  7969*    IF PB-COMPANY-ID = 'DCC'
  7970*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  7971*                                   WS-ADMIN-FEES
  7972*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  7973*          (SUB5 > +10)
  7974*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7975*             AND (AM-A-COM (SUB5) NUMERIC)
  7976*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7977*                + (AM-A-COM (SUB5) * 1000)
  7978*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  7979*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  7980*                + (AM-A-COM (SUB5) * 1000)
  7981*             END-IF
  7982*             IF AM-COM-TYP (SUB5) = 'N'
  7983*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  7984*                + (AM-A-COM (SUB5) * 1000)
  7985*             END-IF
  7986*          END-IF
  7987*       END-PERFORM
  7988*    END-IF
  7989     IF (PB-COMPANY-ID = 'DCC')
  7990        AND (PB-ISSUE)
  7991        MOVE +0                  TO WS-ACCT-ADDL-CLP
  7992        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  7993           (SUB5 > +10)
  7994           MOVE +0 TO WS-WK-RATE
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 147
* EL050.cbl
  7995           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7996              IF (AM-A-COM (SUB5) NUMERIC)
  7997                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  7998                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  7999              ELSE
  8000                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8001                 IF PB-ISSUE
  8002                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8003                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8004                 ELSE
  8005                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8006                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8007                 END-IF
  8008                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8009                 MOVE ZEROS             TO WS-SUB1
  8010                                           WS-COMMISSION
  8011                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8012                 MOVE '0530'               TO CTBL-SW
  8013                 MOVE ' '                  TO WS-CTBL-READ-SW
  8014                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8015                 IF FIRST-TIME-THROUGH
  8016                    MOVE 'AA'              TO CTBL-BEN-CODE
  8017                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8018                 END-IF
  8019                 IF CTBL-TABLE-FOUND
  8020                    IF PB-ISSUE
  8021                       COMPUTE WS-COMM-CK-AMT =
  8022                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8023                    ELSE
  8024                       COMPUTE WS-COMM-CK-AMT =
  8025                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8026                    END-IF
  8027                    PERFORM 8800-GET-COMP-RATE
  8028                              THRU 8800-EXIT
  8029                 END-IF
  8030              END-IF
  8031              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8032                + (WS-WK-RATE * 1000)
  8033           END-IF
  8034        END-PERFORM
  8035     END-IF
  8036     IF PB-COMPANY-ID EQUAL 'CRI'
  8037         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8038
  8039     IF PB-COMPANY-ID EQUAL 'NCL'
  8040         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8041     END-IF
  8042
  8043     GO TO 0200-READ-CERT.
  8044
  8045 0199-ACCT-NOT-FOUND.
  8046
  8047     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8048
  8049     IF DATE-RANGE-SW NOT = SPACES
  8050        MOVE ER-2601             TO WS-ERROR
  8051        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8052     ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 148
* EL050.cbl
  8053        MOVE ER-2619             TO WS-ERROR
  8054        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8055
  8056     GO TO 9990-RETURN.
  8057
  8058 0200-READ-CERT.
  8059
  8060     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8061     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8062     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8063     MOVE PB-SV-STATE            TO CERT-STATE.
  8064     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8065     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8066     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8067
  8068     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8069
  8070     IF CERT-WAS-NOT-FOUND
  8071        GO TO 0299-CERT-NOT-FOUND.
  8072
  8073     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8074        MOVE ER-2759             TO WS-ERROR
  8075        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8076        GO TO 0298-UNLOCK-RETURN.
  8077
  8078     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8079         MOVE ER-2758            TO WS-ERROR
  8080         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8081         GO TO 0298-UNLOCK-RETURN.
  8082
  8083     IF PB-ISSUE
  8084        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8085           IF CERT-WAS-CREATED-FOR-CLAIM
  8086              NEXT SENTENCE
  8087            ELSE
  8088              MOVE ER-2626       TO WS-ERROR
  8089              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8090              GO TO 0298-UNLOCK-RETURN.
  8091
  8092     IF NOT PB-CANCELLATION
  8093        GO TO 0300-CONTINUE-EDIT.
  8094
  8095     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8096     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8097     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8098     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8099     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8100     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8101
  8102     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8103     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8104     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8105     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8106     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8107     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8108     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8109     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8110     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 149
* EL050.cbl
  8111
  8112     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8113     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8114     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8115     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8116     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8117     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8118     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8119
  8120     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8121     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8122
  8123     MOVE CM-CREDIT-INTERFACE-SW-1
  8124                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8125     MOVE CM-CREDIT-INTERFACE-SW-2
  8126                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8127
  8128     IF CM-O-B-COVERAGE
  8129         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8130
  8131     IF CM-LIVES NOT NUMERIC
  8132         MOVE ZERO                TO CM-LIVES.
  8133
  8134     IF CM-BILLED NOT NUMERIC
  8135         MOVE ZERO                TO CM-BILLED.
  8136
  8137     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8138         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8139         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8140         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8141         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8142         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8143         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8144         MOVE CM-LIVES             TO PB-CI-LIVES
  8145*The next line causes a problem with my change  I dont think it is
  8146*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8147
  8148     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8149     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8150     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8151     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8152     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8153     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8154
  8155     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8156     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8157     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8158     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8159
  8160     IF CM-LIFE-COMM-PCT NUMERIC
  8161         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8162     ELSE
  8163         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8164
  8165     IF CM-AH-COMM-PCT NUMERIC
  8166         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8167     ELSE
  8168         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 150
* EL050.cbl
  8169
  8170     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8171
  8172     IF CM-LOAN-APR       NOT NUMERIC
  8173           MOVE ZERO               TO CM-LOAN-APR.
  8174
  8175     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8176           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8177
  8178     IF CM-LOAN-TERM      NOT NUMERIC
  8179           MOVE ZERO               TO CM-LOAN-TERM.
  8180
  8181     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8182           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8183
  8184     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8185           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8186
  8187     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8188     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8189     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8190     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8191     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8192     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8193     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8194     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8195     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8196     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8197     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8198     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8199
  8200     IF CM-STATE = CM-SSN-STATE
  8201         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8202
  8203     IF CM-STATE NOT = CM-MEMB-STATE
  8204         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8205
  8206     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8207
  8208     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
  8209        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8210        IF CM-ADDL-CLP NOT NUMERIC
  8211           MOVE +0               TO CM-ADDL-CLP
  8212        END-IF
  8213        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8214        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8215           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8216        END-IF
  8217     END-IF
  8218     IF PB-COMPANY-ID = 'DCC'
  8219        MOVE +0                  TO WS-ADMIN-FEES
  8220                                    WS-CSO-ADMIN-FEE
  8221                                    WS-COMM-AND-MFEE
  8222                                    WS-1ST-YR-ALLOW
  8223        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8224           (SUB5 > +10)
  8225           MOVE +0 TO WS-WK-RATE
  8226           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 151
* EL050.cbl
  8227              IF (AM-A-COM (SUB5) NUMERIC)
  8228                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8229                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8230              ELSE
  8231                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8232                 IF PB-ISSUE
  8233                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8234                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8235                 ELSE
  8236                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8237                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8238                 END-IF
  8239                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8240                 MOVE ZEROS             TO WS-SUB1
  8241                                           WS-COMMISSION
  8242                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8243                 MOVE '0530'               TO CTBL-SW
  8244                 MOVE ' '                  TO WS-CTBL-READ-SW
  8245                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8246                 IF FIRST-TIME-THROUGH
  8247                    MOVE 'AA'              TO CTBL-BEN-CODE
  8248                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8249                 END-IF
  8250                 IF CTBL-TABLE-FOUND
  8251                    IF PB-ISSUE
  8252                       COMPUTE WS-COMM-CK-AMT =
  8253                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8254                    ELSE
  8255                       COMPUTE WS-COMM-CK-AMT =
  8256                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8257                    END-IF
  8258                    PERFORM 8800-GET-COMP-RATE
  8259                              THRU 8800-EXIT
  8260                 END-IF
  8261              END-IF
  8262              IF AM-COM-TYP (SUB5) = 'I'
  8263                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8264                   + (WS-WK-RATE * 1000)
  8265              END-IF
  8266              IF AM-COM-TYP (SUB5) = 'N'
  8267                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8268                   + (WS-WK-RATE * 1000)
  8269              END-IF
  8270              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8271                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8272                   + (WS-WK-RATE * 1000)
  8273              END-IF
  8274              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8275                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8276                   + (WS-WK-RATE * 1000)
  8277              END-IF
  8278           END-IF
  8279        END-PERFORM
  8280     END-IF
  8281     GO TO 0300-CONTINUE-EDIT.
  8282
  8283 0298-UNLOCK-RETURN.
  8284      PERFORM 9250-UNLOCK-RETURN
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 152
* EL050.cbl
  8285      GO TO 9990-RETURN.
  8286
  8287 0299-CERT-NOT-FOUND.
  8288
  8289     MOVE '1'                     TO CERT-STATUS-SW.
  8290
  8291     IF PB-COMPANY-ID = 'UCL'
  8292         IF WS-ERROR = ER-2799
  8293             GO TO 3000-CONTINUE-EDIT.
  8294
  8295     IF NOT PB-CANCELLATION
  8296         GO TO 0300-CONTINUE-EDIT.
  8297
  8298     MOVE ER-2726                  TO  WS-ERROR.
  8299     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8300     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8301     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8302                                    PB-CI-LF-TERM
  8303                                    PB-C-LF-REM-TERM
  8304                                    PB-CI-AH-TERM
  8305                                    PB-C-AH-REM-TERM
  8306                                    PB-CI-LF-BENEFIT-CD
  8307                                    PB-CI-LF-BENEFIT-AMT
  8308                                    PB-CI-LF-ALT-BENEFIT-AMT
  8309                                    PB-CI-LF-PREMIUM-AMT
  8310                                    PB-CI-LF-ALT-PREMIUM-AMT
  8311                                    PB-CI-AH-BENEFIT-CD
  8312                                    PB-CI-AH-BENEFIT-AMT
  8313                                    PB-CI-AH-PREMIUM-AMT
  8314                                    PB-CI-PAY-FREQUENCY
  8315                                    PB-CI-LOAN-APR
  8316                                    PB-CI-LOAN-TERM
  8317                                    PB-CI-LIFE-COMMISSION
  8318                                    PB-CI-AH-COMMISSION
  8319                                    PB-CI-CURR-SEQ
  8320                                    PB-CI-AH-CANCEL-AMT
  8321                                    PB-CI-LF-CANCEL-AMT
  8322                                    PB-CI-RATE-DEV-PCT-LF
  8323                                    PB-CI-RATE-DEV-PCT-AH
  8324                                    PB-CI-EXTENTION-DAYS
  8325                                    PB-CI-TERM-IN-DAYS
  8326                                    PB-CI-LIVES
  8327                                    PB-CI-LF-CRIT-PER
  8328                                    PB-CI-AH-CRIT-PER
  8329                                    PB-CI-ADDL-CLP
  8330                                    PB-CI-DDF-IU-RATE-UP.
  8331
  8332     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8333                                    PB-CI-AH-SETTLEMENT-DT
  8334                                    PB-CI-DEATH-DT
  8335                                    PB-CI-LF-PRIOR-CANCEL-DT
  8336                                    PB-CI-AH-PRIOR-CANCEL-DT
  8337                                    PB-CI-ENTRY-DT
  8338                                    PB-CI-LF-EXPIRE-DT
  8339                                    PB-CI-AH-EXPIRE-DT
  8340                                    PB-CI-LOAN-1ST-PMT-DT.
  8341
  8342     IF ACCOUNT-MAST-FOUND
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 153
* EL050.cbl
  8343        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8344        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8345
  8346
  8347 0300-CONTINUE-EDIT.
  8348
  8349     IF PB-ISSUE
  8350        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8351            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8352
  8353     IF PB-ISSUE
  8354        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8355            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8356
  8357     IF PB-ISSUE
  8358       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8359          (AM-NO-AH-ONLY)
  8360           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8361               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8362                   MOVE ER-2679 TO WS-ERROR
  8363                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8364
  8365     IF PB-ISSUE
  8366        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8367        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8368        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8369     ELSE
  8370        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8371        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8372        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8373
  8374     MOVE 'N'                    TO PLAN-MASTER-SW
  8375                                    PLAN-MASTER-LIFE-SW
  8376                                    FORM-MASTER-SW
  8377                                    WS-APP-CERT-SW.
  8378
  8379     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8380                                    WS-PL-TOL-LF-REFUND
  8381                                    WS-PL-REF-OVS-AMT
  8382                                    WS-PL-TOL-LF-PREM-PCT
  8383                                    WS-PL-TOL-LF-REFUND-PCT
  8384                                    WS-PL-REF-OVS-PCT
  8385                                    WS-PL-TOL-LF-CLAIM.
  8386
  8387     IF PB-COMPANY-ID = 'NCL'
  8388       IF PB-ISSUE
  8389         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8390             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8391             IF FORM-MASTER-FOUND
  8392                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8393
  8394     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8395        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8396
  8397********************** MON CODE **********************
  8398     IF PB-COMPANY-ID = 'MON'
  8399     IF PB-ISSUE
  8400     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 154
* EL050.cbl
  8401        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8402             PB-I-LOAN-APR = ZERO)
  8403               MOVE 14.0         TO PB-I-LOAN-APR.
  8404******************************************************
  8405
  8406     IF PB-COMPANY-ID = 'NCL'
  8407       IF PB-ISSUE
  8408           IF FORM-MASTER-FOUND
  8409             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8410                AM-DISMBR-COVERAGE
  8411                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8412                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8413                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8414                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8415                                           PB-I-LIFE-BENEFIT-CD.
  8416
  8417     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8418
  8419     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8420         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8421         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8422         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8423         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8424         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8425           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8426             GO TO 0301-LIFE-BENEFIT-SEARCH
  8427         ELSE
  8428             NEXT SENTENCE
  8429     ELSE
  8430         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8431
  8432     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8433     MOVE '4'                    TO CNTL-REC-TYPE.
  8434     MOVE +0                     TO CNTL-SEQ-NO.
  8435     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8436
  8437     MOVE '1' TO RC-SW-2.
  8438     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8439
  8440     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8441        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8442         GO TO 0305-BENEFIT-NOT-FOUND.
  8443
  8444     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8445
  8446 0301-LIFE-BENEFIT-SEARCH.
  8447
  8448     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8449
  8450     IF NO-BENEFIT-FOUND
  8451        GO TO 0305-BENEFIT-NOT-FOUND.
  8452
  8453     IF WS-BEN-CD = '99'
  8454        GO TO 0305-BENEFIT-NOT-FOUND.
  8455
  8456     IF PB-COMPANY-ID = 'NCL'
  8457         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8458             GO TO 0304-LIFE-BENEFIT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 155
* EL050.cbl
  8459
  8460     MOVE +1                     TO SUB5.
  8461     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8462
  8463* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8464* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8465     IF PB-COMPANY-ID = 'DMD'
  8466         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8467
  8468 0302-EDIT-ACCT-LF-BENEFITS.
  8469
  8470     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8471        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8472           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8473                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8474           GO TO 03XX-GET-LIFE-ERPLAN.
  8475
  8476     IF SUB5 LESS THAN +20
  8477        ADD +1                   TO SUB5
  8478        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8479
  8480     MOVE +1                     TO SUB5.
  8481
  8482     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8483        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8484
  8485 0303-EDIT-DMD-EXTRA-BENEFITS.
  8486
  8487     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8488        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8489           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8490                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8491           GO TO 03XX-GET-LIFE-ERPLAN.
  8492
  8493     IF SUB5 LESS THAN +30
  8494        ADD +1                   TO SUB5
  8495        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8496
  8497     MOVE +1                     TO SUB5.
  8498
  8499 03XX-EDIT-FOR-NINETY-LF.
  8500
  8501***************************************************************
  8502*                                                             *
  8503*    NINETY BENEFIT PLAN TYPES:                               *
  8504*                                                             *
  8505*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8506*      92 = ALL GROUP REDUCING BENEFITS                       *
  8507*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8508*      94 = ALL GROUP LEVEL BENEFITS                          *
  8509*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8510*           BENEFIT CONTROLS.                                 *
  8511*      99 = ALL BENEFITS                                      *
  8512*                                                             *
  8513***************************************************************
  8514
  8515     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8516                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 156
* EL050.cbl
  8517
  8518     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8519       AND
  8520        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8521        GO TO 03XX-GET-LIFE-ERPLAN.
  8522
  8523     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8524       AND
  8525        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8526        IF CF-REDUCING (SUB3)
  8527           IF (PB-I-INDV-GRP-OVRD = 'I')
  8528              OR
  8529           ((AM-IG = '1') AND
  8530           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8531              OR
  8532           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8533           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8534           (AM-IG NOT = '2'))
  8535              GO TO 03XX-GET-LIFE-ERPLAN.
  8536
  8537     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8538       AND
  8539        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8540        IF CF-REDUCING (SUB3)
  8541           IF (PB-I-INDV-GRP-OVRD = 'G')
  8542              OR
  8543           ((AM-IG = '2') AND
  8544           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8545              OR
  8546           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8547           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8548           (AM-IG NOT = '1'))
  8549              GO TO 03XX-GET-LIFE-ERPLAN.
  8550
  8551     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8552       AND
  8553        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8554        IF CF-LEVEL    (SUB3)
  8555           IF (PB-I-INDV-GRP-OVRD = 'I')
  8556              OR
  8557           ((AM-IG = '1') AND
  8558           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8559              OR
  8560           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8561           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8562            (AM-IG NOT = '2'))
  8563              GO TO 03XX-GET-LIFE-ERPLAN.
  8564
  8565     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8566       AND
  8567        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8568        IF CF-LEVEL    (SUB3)
  8569           IF (PB-I-INDV-GRP-OVRD = 'G')
  8570              OR
  8571           ((AM-IG = '2') AND
  8572           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8573              OR
  8574           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 157
* EL050.cbl
  8575           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8576           (AM-IG NOT = '1'))
  8577              GO TO 03XX-GET-LIFE-ERPLAN.
  8578
  8579     IF SUB5 LESS THAN +20
  8580        ADD +1                   TO SUB5
  8581        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8582
  8583     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8584
  8585     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8586        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8587
  8588     MOVE +1                     TO SUB5.
  8589
  8590 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8591
  8592     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8593                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8594
  8595     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8596       AND
  8597        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8598        GO TO 03XX-GET-LIFE-ERPLAN.
  8599
  8600     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8601       AND
  8602        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8603        IF CF-REDUCING (SUB3)
  8604           IF (PB-I-INDV-GRP-OVRD = 'I')
  8605              OR
  8606           ((AM-IG = '1') AND
  8607           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8608              OR
  8609           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8610           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8611           (AM-IG NOT = '2'))
  8612              GO TO 03XX-GET-LIFE-ERPLAN.
  8613
  8614     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8615       AND
  8616        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8617        IF CF-REDUCING (SUB3)
  8618           IF (PB-I-INDV-GRP-OVRD = 'G')
  8619              OR
  8620           ((AM-IG = '2') AND
  8621           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8622              OR
  8623           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8624           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8625           (AM-IG NOT = '1'))
  8626              GO TO 03XX-GET-LIFE-ERPLAN.
  8627
  8628     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8629       AND
  8630        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8631        IF CF-LEVEL    (SUB3)
  8632           IF (PB-I-INDV-GRP-OVRD = 'I')
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 158
* EL050.cbl
  8633              OR
  8634           ((AM-IG = '1') AND
  8635           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8636              OR
  8637           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8638           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8639            (AM-IG NOT = '2'))
  8640              GO TO 03XX-GET-LIFE-ERPLAN.
  8641
  8642     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8643       AND
  8644        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8645        IF CF-LEVEL    (SUB3)
  8646           IF (PB-I-INDV-GRP-OVRD = 'G')
  8647              OR
  8648           ((AM-IG = '2') AND
  8649           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8650              OR
  8651           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8652           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8653           (AM-IG NOT = '1'))
  8654              GO TO 03XX-GET-LIFE-ERPLAN.
  8655
  8656     IF SUB5 LESS THAN +30
  8657        ADD +1                   TO SUB5
  8658        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8659
  8660     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8661
  8662 03XX-EDIT-FOR-NINETY-LF-CONT.
  8663
  8664     MOVE +99                    TO SUB5.
  8665
  8666     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8667        IF PB-ISSUE
  8668           MOVE ER-1924          TO  WS-ERROR
  8669           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8670
  8671     GO TO 0304-LIFE-BENEFIT-FOUND.
  8672
  8673 03XX-GET-LIFE-ERPLAN.
  8674
  8675     IF WK-PLAN-ADDR EQUAL +0
  8676        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8677
  8678     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8679     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8680     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8681     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8682     MOVE 'Y'                    TO PLAN-MASTER-SW
  8683                                    PLAN-MASTER-LIFE-SW.
  8684     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8685
  8686 03XX-ERPLAN-LIFE-GETMAIN.
  8687
  8688     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8689     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8690
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 159
* EL050.cbl
  8691 03XX-ERPLAN-LIFE-READ.
  8692
  8693     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8694     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8695     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8696     MOVE PB-SV-STATE            TO PLAN-STATE.
  8697     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8698     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8699     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8700     MOVE WS-SAVE-BENEFIT-REVISION
  8701                                 TO PLAN-REVISION-NO.
  8702
  8703     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8704     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8705
  8706     IF PB-COMPANY-ID = 'NCL'
  8707       IF NOT LF-PLAN-MASTER-FOUND
  8708         IF NOT PB-POLICY-IS-DECLINED  AND
  8709            NOT PB-POLICY-IS-VOIDED
  8710             MOVE  ER-1921         TO  WS-ERROR
  8711             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8712             GO TO 0304-LIFE-BENEFIT-FOUND.
  8713
  8714     IF NOT LF-PLAN-MASTER-FOUND
  8715        GO TO 0304-LIFE-BENEFIT-FOUND.
  8716
  8717 XXXX-CHECK-LF-PLAN-KEY.
  8718
  8719     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8720        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8721        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8722        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8723        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8724        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8725        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8726        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8727        MOVE 'N'                 TO PLAN-MASTER-SW
  8728          GO TO 03XX-ERPLAN-LIFE-READ.
  8729
  8730     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8731
  8732     IF  PB-CANCELLATION
  8733         GO TO  0303-LF-ACCT-BEN-FOUND.
  8734
  8735     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8736        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8737           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8738           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8739              MOVE ER-2644             TO WS-ERROR
  8740              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8741           ELSE
  8742              NEXT SENTENCE
  8743        ELSE
  8744           IF PB-COMPANY-ID NOT = 'NCL'
  8745              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8746                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8747
  8748 0303-LF-ACCT-BEN-FOUND.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 160
* EL050.cbl
  8749
  8750     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8751
  8752     IF PL-DEV-CODE NOT = SPACES
  8753        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8754
  8755     IF PL-DEV-PCT NUMERIC AND
  8756        PL-DEV-PCT NOT = ZEROS
  8757        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8758
  8759     IF PL-TOL-PREM-AMT GREATER THAN +0
  8760        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8761
  8762     IF PL-TOL-REF-AMT GREATER THAN +0
  8763        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8764
  8765     IF PL-TOL-PREM-PCT GREATER THAN +0
  8766        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8767
  8768     IF PL-TOL-REF-PCT GREATER THAN +0
  8769        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8770
  8771     IF PL-TOL-CLM-AMT GREATER THAN +0
  8772        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8773
  8774     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8775                          PL-OVER-SHORT-AMT > +0
  8776        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8777
  8778     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8779                          PL-OVER-SHORT-PCT > +0
  8780        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8781
  8782     IF PL-SALES-TAX NUMERIC AND
  8783                          PL-SALES-TAX > +0
  8784         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8785
  8786     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8787        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8788                                    WS-IG-OVRD-AM.
  8789
  8790 0304-LIFE-BENEFIT-FOUND.
  8791
  8792     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8793
  8794     IF PB-ISSUE
  8795        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8796     ELSE
  8797        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8798
  8799     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8800     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8801     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8802     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8803     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8804                                         WS-LF-REFUND-CALC.
  8805     if (ws-lf-earnings-calc = '5')
  8806        and (pb-i-loan-apr = zeros)
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 161
* EL050.cbl
  8807        and (benefit-code-chg)
  8808        move +99.9999 to pb-i-loan-apr
  8809     end-if
  8810
  8811     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8812        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8813
  8814     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  8815        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8816     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8817
  8818     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8819     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8820     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8821     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8822     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8823     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8824
  8825     IF PB-COMPANY-ID = 'NCL'  AND
  8826        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8827         NEXT SENTENCE
  8828     ELSE
  8829         IF SUB5 NOT GREATER THAN +20
  8830            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8831               MOVE WS-SAVE-BENEFIT-REM-TERM
  8832                                      TO WS-AM-LF-BENE-REM-TERM
  8833                                         EC-BR-LF-REM-TERM-CALC.
  8834
  8835     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8836     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8837
  8838     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8839
  8840 0305-BENEFIT-NOT-FOUND.
  8841
  8842     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8843     MOVE ER-2604                TO WS-ERROR.
  8844     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8845
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 162
* EL050.cbl
  8847
  8848 0310-FIND-AH-BENEFIT-RECORD.
  8849
  8850     MOVE 'N'                    TO PLAN-MASTER-SW
  8851                                    PLAN-MASTER-AH-SW.
  8852
  8853     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  8854                                    WS-PL-TOL-AH-REFUND
  8855                                    WS-AH-PL-REF-OVS-AMT
  8856                                    WS-PL-TOL-AH-PREM-PCT
  8857                                    WS-PL-TOL-AH-REFUND-PCT
  8858                                    WS-AH-PL-REF-OVS-PCT
  8859                                    WS-PL-TOL-AH-CLAIM.
  8860     MOVE ' '                    TO WS-AH-DCC-TRUNC
  8861
  8862
  8863     if pb-issue
  8864        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  8865           MOVE SPACES              TO PB-I-AH-INPUT-CD
  8866        end-if
  8867        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  8868           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  8869           GO TO 0399-BENEFIT-NOT-FOUND
  8870        end-if
  8871     end-if
  8872
  8873     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  8874        GO TO 0400-FIND-CARRIER.
  8875
  8876     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  8877
  8878     IF WK-AH-BEN-ADDR NOT = ZEROS
  8879         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  8880         SET ELCNTL-FILE-ADDRESSED TO TRUE
  8881         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8882         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8883           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8884             GO TO 0311-AH-BENEFIT-SEARCH
  8885         ELSE
  8886             NEXT SENTENCE
  8887     ELSE
  8888         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8889
  8890     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8891     MOVE '5'                    TO CNTL-REC-TYPE.
  8892     MOVE +0                     TO CNTL-SEQ-NO.
  8893     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8894
  8895     MOVE '2' TO RC-SW-2.
  8896     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8897
  8898     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8899        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8900          GO TO 0399-BENEFIT-NOT-FOUND.
  8901
  8902     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  8903
  8904 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 163
* EL050.cbl
  8905
  8906     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8907
  8908     IF NO-BENEFIT-FOUND
  8909         GO TO 0399-BENEFIT-NOT-FOUND.
  8910
  8911     IF WS-BEN-CD = '99'
  8912        GO TO 0399-BENEFIT-NOT-FOUND.
  8913
  8914     IF PB-COMPANY-ID  =  'NCL'
  8915         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8916             GO TO 0314-A-H-BENEFIT-FOUND.
  8917
  8918     MOVE +1                     TO SUB5.
  8919     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8920
  8921* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8922* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8923     IF PB-COMPANY-ID = 'DMD'
  8924         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8925
  8926 0312-EDIT-ACCT-AH-BENEFITS.
  8927
  8928     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8929        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  8930           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8931                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8932           GO TO 03XX-GET-AH-ERPLAN.
  8933
  8934     IF SUB5 LESS THAN +20
  8935        ADD +1                   TO SUB5
  8936        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  8937
  8938     MOVE +1                     TO SUB5.
  8939
  8940     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8941        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8942
  8943 0313-EDIT-DMD-EXTRA-BENEFITS.
  8944
  8945     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8946        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  8947           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8948                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8949           GO TO 03XX-GET-AH-ERPLAN.
  8950
  8951     IF SUB5 LESS THAN +30
  8952        ADD +1                   TO SUB5
  8953        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  8954
  8955     MOVE +1                     TO SUB5.
  8956
  8957 03XX-EDIT-FOR-NINETY-AH.
  8958
  8959***************************************************************
  8960*                                                             *
  8961*    NINETY BENEFIT PLAN TYPES:                               *
  8962*                                                             *
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 164
* EL050.cbl
  8963*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8964*      92 = ALL GROUP REDUCING BENEFITS.                      *
  8965*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8966*           BENEFIT CONTROLS.                                 *
  8967*      99 = ALL BENEFITS.                                     *
  8968*                                                             *
  8969***************************************************************
  8970
  8971     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8972                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8973
  8974     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8975       AND
  8976        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8977        GO TO 03XX-GET-AH-ERPLAN.
  8978
  8979     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  8980       AND
  8981        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8982           IF (PB-I-INDV-GRP-OVRD = 'I')
  8983              OR
  8984           ((AM-IG = '1') AND
  8985           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8986              OR
  8987           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8988           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8989           (AM-IG NOT = '2'))
  8990              GO TO 03XX-GET-AH-ERPLAN.
  8991
  8992     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  8993       AND
  8994        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8995           IF (PB-I-INDV-GRP-OVRD = 'G')
  8996              OR
  8997           ((AM-IG = '2') AND
  8998           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8999              OR
  9000           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9001           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9002           (AM-IG NOT = '1'))
  9003              GO TO 03XX-GET-AH-ERPLAN.
  9004
  9005     IF SUB5 LESS THAN +20
  9006        ADD +1                   TO SUB5
  9007        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9008
  9009     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9010        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9011
  9012     MOVE +1                    TO SUB5.
  9013
  9014 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9015
  9016     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9017                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9018
  9019     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9020       AND
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 165
* EL050.cbl
  9021        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9022        GO TO 03XX-GET-AH-ERPLAN.
  9023
  9024     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9025       AND
  9026        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9027           IF (PB-I-INDV-GRP-OVRD = 'I')
  9028              OR
  9029           ((AM-IG = '1') AND
  9030           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9031              OR
  9032           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9033           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9034           (AM-IG NOT = '2'))
  9035              GO TO 03XX-GET-AH-ERPLAN.
  9036
  9037     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9038       AND
  9039        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9040           IF (PB-I-INDV-GRP-OVRD = 'G')
  9041              OR
  9042           ((AM-IG = '2') AND
  9043           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9044              OR
  9045           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9046           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9047           (AM-IG NOT = '1'))
  9048              GO TO 03XX-GET-AH-ERPLAN.
  9049
  9050     IF SUB5 LESS THAN +30
  9051        ADD +1                   TO SUB5
  9052        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9053
  9054 03XX-EDIT-FOR-NINETY-AH-CONT.
  9055
  9056     MOVE +99                    TO SUB5.
  9057
  9058     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9059
  9060     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9061        IF PB-ISSUE
  9062           MOVE ER-1925          TO  WS-ERROR
  9063           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9064
  9065     GO TO 0314-A-H-BENEFIT-FOUND.
  9066
  9067 03XX-GET-AH-ERPLAN.
  9068
  9069     IF WK-PLAN-ADDR EQUAL +0
  9070         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9071
  9072     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9073     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9074     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9075     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9076     MOVE 'Y'                    TO PLAN-MASTER-SW
  9077                                    PLAN-MASTER-AH-SW.
  9078*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 166
* EL050.cbl
  9079     GO TO 03XX-ERPLAN-AH-READ.
  9080
  9081 03XX-ERPLAN-AH-GETMAIN.
  9082
  9083     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9084     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9085
  9086 03XX-ERPLAN-AH-READ.
  9087
  9088     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9089     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9090     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9091     MOVE PB-SV-STATE            TO PLAN-STATE.
  9092     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9093     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9094     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9095     MOVE WS-SAVE-BENEFIT-REVISION
  9096                                 TO PLAN-REVISION-NO.
  9097
  9098     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9099     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9100
  9101     IF PB-COMPANY-ID = 'NCL'
  9102       IF NOT AH-PLAN-MASTER-FOUND
  9103         IF NOT PB-POLICY-IS-DECLINED  AND
  9104            NOT PB-POLICY-IS-VOIDED
  9105             MOVE  ER-1922         TO  WS-ERROR
  9106             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9107             GO TO 0314-A-H-BENEFIT-FOUND.
  9108
  9109     IF NOT AH-PLAN-MASTER-FOUND
  9110        GO TO 0314-A-H-BENEFIT-FOUND.
  9111
  9112 XXXX-CHECK-AH-PLAN-KEY.
  9113
  9114     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9115        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9116        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9117        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9118        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9119        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9120        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9121        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9122        MOVE 'N'                 TO PLAN-MASTER-SW
  9123          GO TO 03XX-ERPLAN-AH-READ.
  9124
  9125     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9126
  9127     IF  PB-CANCELLATION
  9128         GO TO  0313-AH-ACCT-BEN-FOUND.
  9129
  9130     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9131       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9132          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9133          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9134             MOVE ER-2644             TO WS-ERROR
  9135             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9136          ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 167
* EL050.cbl
  9137             NEXT SENTENCE
  9138       ELSE
  9139          IF PB-COMPANY-ID NOT = 'NCL'
  9140             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9141                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9142
  9143 0313-AH-ACCT-BEN-FOUND.
  9144
  9145     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9146
  9147     IF PL-DEV-CODE NOT = SPACES
  9148        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9149
  9150     IF PL-DEV-PCT NUMERIC AND
  9151        PL-DEV-PCT NOT = ZEROS
  9152        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9153
  9154     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9155        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9156
  9157     IF PL-TOL-REF-AMT NOT EQUAL +0
  9158        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9159
  9160     IF PL-TOL-PREM-PCT GREATER THAN +0
  9161        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9162
  9163     IF PL-TOL-REF-PCT GREATER THAN +0
  9164        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9165
  9166     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9167        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9168
  9169     IF PL-OVER-SHORT-AMT NUMERIC AND
  9170                          PL-OVER-SHORT-AMT > +0
  9171        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9172
  9173     IF PL-OVER-SHORT-PCT NUMERIC AND
  9174                          PL-OVER-SHORT-PCT > +0
  9175        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9176
  9177     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9178        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9179        IF WS-IG-OVRD-AM EQUAL SPACES
  9180            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9181
  9182 0314-A-H-BENEFIT-FOUND.
  9183
  9184     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9185
  9186     IF PB-ISSUE
  9187        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9188       ELSE
  9189        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9190
  9191     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD.
  9192     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9193     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9194     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 168
* EL050.cbl
  9195                                         WS-AH-REFUND-CALC.
  9196
  9197     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9198        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9199
  9200     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9201        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9202     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9203
  9204     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9205     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9206     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9207     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9208     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9209     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9210
  9211     IF PB-COMPANY-ID = 'NCL'  AND
  9212        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9213         NEXT SENTENCE
  9214     ELSE
  9215         IF SUB5 NOT GREATER THAN +20
  9216            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9217                MOVE WS-SAVE-BENEFIT-REM-TERM
  9218                                      TO WS-AM-AH-BENE-REM-TERM
  9219                                         EC-BR-AH-REM-TERM-CALC.
  9220
  9221     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9222     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9223
  9224     GO TO 0400-FIND-CARRIER.
  9225
  9226 0399-BENEFIT-NOT-FOUND.
  9227
  9228     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9229     MOVE ER-2605                TO WS-ERROR.
  9230     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9231
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 169
* EL050.cbl
  9233
  9234 0400-FIND-CARRIER.
  9235
  9236     MOVE PB-SV-CARRIER          TO WS-CARR.
  9237
  9238     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9239     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9240     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9241     MOVE '6'                    TO CNTL-REC-TYPE.
  9242
  9243*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9244     MOVE SPACE                  TO WS-DMD-RATING-SW
  9245                                    EC-BR-DMD-RATING-SW.
  9246
  9247     MOVE '2'                    TO RC-SW-1.
  9248     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9249
  9250     IF NOT CF-CARRIER-MASTER
  9251        GO TO 0400-CARRIER-NOT-FOUND.
  9252
  9253 0400-BUILD-CARR-TOL.
  9254
  9255     IF CF-CR-TOL-PREM NUMERIC AND
  9256        CF-CR-TOL-PREM GREATER THAN +0
  9257        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9258                                    WS-TOL-AH-PREM.
  9259
  9260     IF CF-CR-TOL-REFUND NUMERIC AND
  9261        CF-CR-TOL-REFUND GREATER THAN +0
  9262        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9263                                    WS-TOL-AH-REFUND.
  9264
  9265     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9266        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9267        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9268                                    WS-AH-REFUND-OVS-AMT.
  9269
  9270     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9271        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9272        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9273                                    WS-AH-REFUND-OVS-PCT.
  9274
  9275     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9276        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9277        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9278                                    WS-TOL-AH-PREM-PCT.
  9279
  9280     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9281        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9282        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9283                                     WS-TOL-AH-REFUND-PCT.
  9284
  9285     IF CF-COMPANY-ID EQUAL 'DMD'
  9286         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9287                                    EC-BR-DMD-RATING-SW.
  9288
  9289     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9290     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 170
* EL050.cbl
  9291        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9292     END-IF
  9293     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9294        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9295     END-IF
  9296     IF WS-TOL-CLP-PCT = ZEROS
  9297        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9298     END-IF
  9299
  9300     IF WS-SPP-LEASE-COMM = ZEROS
  9301        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9302     END-IF
  9303     GO TO 0400-FIND-ERPDEF.
  9304
  9305 0400-CARRIER-NOT-FOUND.
  9306
  9307     MOVE ER-2602                TO WS-ERROR.
  9308     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9309
  9310 0400-FIND-ERPDEF.
  9311     IF PB-COMPANY-ID = 'DCC'
  9312        AND AM-DCC-PRODUCT-CODE = 'DDF'
  9313        CONTINUE
  9314     ELSE
  9315        GO TO 0400-FIND-ERCOMP
  9316     END-IF
  9317     MOVE ' '                    TO PDEF-MASTER-SW
  9318     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9319     MOVE PB-STATE               TO ERPDEF-STATE
  9320     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9321     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9322     IF PB-ISSUE
  9323        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9324     ELSE
  9325        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9326     END-IF
  9327     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9328     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9329     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9330     IF PDEF-MASTER-FOUND
  9331        MOVE 'N'                 TO PDEF-MASTER-SW
  9332        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9333        IF PDEF-MASTER-FOUND
  9334           IF (ERPDEF-KEY-SAVE (1:16) =
  9335                        PD-CONTROL-PRIMARY (1:16))
  9336              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9337              CONTINUE
  9338           ELSE
  9339              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9340              IF (ERPDEF-KEY-SAVE (1:16) =
  9341                        PD-CONTROL-PRIMARY (1:16))
  9342                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9343                 CONTINUE
  9344              ELSE
  9345                 MOVE 'N'        TO PDEF-MASTER-SW
  9346              END-IF
  9347           END-IF
  9348        END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 171
* EL050.cbl
  9349        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9350     END-IF
  9351     IF PDEF-MASTER-FOUND
  9352        IF PD-TRUNCATED = 'Y'
  9353           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9354        END-IF
  9355     END-IF
  9356     .
  9357 0400-FIND-ERCOMP.
  9358     IF PB-COMPANY-ID = 'DCC'
  9359        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9360           (WS-SUB1 > +10)
  9361           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9362                 OR 'A' OR 'N'
  9363              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9364              MOVE PB-CARRIER    TO COMP-CARRIER
  9365              MOVE PB-GROUPING   TO COMP-GROUPING
  9366              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9367              MOVE AM-AGT (WS-SUB1)
  9368                                 TO COMP-FIN-RESP
  9369              MOVE 'G'           TO COMP-TYPE
  9370              PERFORM 8582-READ-COMPENSATION-MASTER
  9371                                 THRU 8582-EXIT
  9372              IF COMP-MASTER-FOUND
  9373                 IF CO-GA-INACTIVE
  9374                    MOVE ER-2763 TO WS-ERROR
  9375                    PERFORM 9900-ERROR-FORMAT
  9376                                 THRU 9900-EXIT
  9377                    MOVE +11     TO WS-SUB1
  9378                 END-IF
  9379                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9380                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9381                    MOVE ER-2788 TO WS-ERROR
  9382                    PERFORM 9900-ERROR-FORMAT
  9383                                 THRU 9900-EXIT
  9384                    MOVE +11     TO WS-SUB1
  9385                 END-IF
  9386              END-IF
  9387           END-IF
  9388        END-PERFORM
  9389     END-IF
  9390     IF PB-COMPANY-ID = 'DCC'
  9391        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9392           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9393                                    WS-CLP-STATE
  9394        ELSE
  9395           MOVE SPACES           TO PB-I-CLP-STATE
  9396                                    WS-CLP-STATE
  9397        END-IF
  9398     END-IF
  9399
  9400     IF (PB-COMPANY-ID = 'DCC')
  9401        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9402        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9403        CONTINUE
  9404     ELSE
  9405        GO TO 0400-FIND-STATE-RECORD
  9406     END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 172
* EL050.cbl
  9407     MOVE SPACES                 TO WS-CLP-STATE
  9408     MOVE +0                     TO WS-BANK-FEE
  9409                                    WS-BANK-LFEE
  9410                                    WS-BANK-NOCHRGB
  9411
  9412     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9413     IF (PB-ISSUE)
  9414        AND (PB-I-BANK-NUMBER NOT =
  9415            SPACES AND ZEROS AND LOW-VALUES)
  9416        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9417     ELSE
  9418        IF (PB-CANCELLATION)
  9419           AND (PB-CI-BANK-NUMBER NOT =
  9420                SPACES AND ZEROS AND LOW-VALUES)
  9421           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9422        END-IF
  9423     END-IF
  9424     IF COMP-FIN-RESP NOT = LOW-VALUES
  9425        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9426        MOVE PB-CARRIER          TO COMP-CARRIER
  9427        MOVE PB-GROUPING         TO COMP-GROUPING
  9428        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9429        MOVE 'B'                 TO COMP-TYPE
  9430        PERFORM 8582-READ-COMPENSATION-MASTER
  9431                                 THRU 8582-EXIT
  9432        IF COMP-MASTER-FOUND
  9433           IF CO-MAX-BANK-FEE NOT NUMERIC
  9434              MOVE +0            TO CO-MAX-BANK-FEE
  9435           END-IF
  9436           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9437              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9438           END-IF
  9439           IF CO-GA-INACTIVE
  9440              MOVE ER-2763       TO WS-ERROR
  9441              PERFORM 9900-ERROR-FORMAT
  9442                                 THRU 9900-EXIT
  9443           END-IF
  9444           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9445              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9446              MOVE ER-2788 TO WS-ERROR
  9447              PERFORM 9900-ERROR-FORMAT
  9448                                 THRU 9900-EXIT
  9449              MOVE +11     TO WS-SUB1
  9450           END-IF
  9451           IF WS-AH-BEN-CATEGORY = 'G'
  9452              MOVE CO-MAX-BANK-FEE
  9453                                 TO WS-BANK-FEE
  9454                                    PB-I-BANK-FEE
  9455           ELSE
  9456              MOVE CO-MAX-BANK-FEE-LEASE
  9457                                 TO WS-BANK-LFEE
  9458                                    PB-I-BANK-FEE
  9459           END-IF
  9460           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
  9461              AND (WS-AH-REFUND-CALC = 'G'))
  9462                        OR
  9463              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9464              AND (WS-AH-REFUND-CALC NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 173
* EL050.cbl
  9465              CONTINUE
  9466           ELSE
  9467              MOVE ER-2789 TO WS-ERROR
  9468              PERFORM 9900-ERROR-FORMAT
  9469                                 THRU 9900-EXIT
  9470           END-IF
  9471           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9472                                    PB-I-CLP-STATE
  9473           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9474           MOVE CO-CARRIER       TO BXRF-CARRIER
  9475           MOVE CO-GROUPING      TO BXRF-GROUPING
  9476           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9477           MOVE BXRF-MAX-REC-LENGTH
  9478                                 TO BXRF-REC-LENGTH
  9479           PERFORM 8584-READ-BANK-CROSS-REF
  9480                                 THRU 8584-EXIT
  9481           IF BXRF-MASTER-FOUND
  9482              MOVE ' '           TO BANK-ACCT-SW
  9483              MOVE BK-BANK-POINTER-CNT
  9484                                 TO BK-BANK-POINTER-CNT
  9485              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9486                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9487                 OR (BANK-ACCT-FOUND)
  9488                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9489                    AND (BK-AM-EXP-DT (WS-SUB1)
  9490                                 > PB-CERT-EFF-DT)
  9491                    AND (BK-AM-EFF-DT (WS-SUB1)
  9492                                 NOT > PB-CERT-EFF-DT)
  9493                    SET BANK-ACCT-FOUND TO TRUE
  9494                 END-IF
  9495              END-PERFORM
  9496              IF NOT BANK-ACCT-FOUND
  9497                 MOVE ZEROS      TO WS-BANK-FEE
  9498                                    WS-BANK-LFEE
  9499                 MOVE ER-2869    TO WS-ERROR
  9500                 PERFORM 9900-ERROR-FORMAT
  9501                                 THRU 9900-EXIT
  9502              ELSE
  9503                 PERFORM 5000-PROCESS-REPS
  9504                                 THRU 5000-EXIT
  9505                 IF AGENT-MASTER-FOUND
  9506                    MOVE +0      TO WS-BANK-FEE
  9507                                    WS-BANK-LFEE
  9508*                   MOVE AG-SPP-FEES (1)
  9509*                                TO PB-I-BANK-FEE
  9510*                                   WS-BANK-FEE
  9511                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9512                       (WS-SUB1 > +10)
  9513                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9514                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9515                       END-IF
  9516                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9517                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9518                       END-IF
  9519                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9520                          AG-SPP-FEES (WS-SUB1)
  9521                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9522                          AG-SPP-LFEES (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 174
* EL050.cbl
  9523                    END-PERFORM
  9524                    IF WS-AH-BEN-CATEGORY = 'G'
  9525                       MOVE WS-BANK-FEE
  9526                                 TO PB-I-BANK-FEE
  9527                    ELSE
  9528                       MOVE WS-BANK-LFEE
  9529                                 TO PB-I-BANK-FEE
  9530                    END-IF
  9531                 END-IF
  9532              END-IF
  9533           END-IF
  9534        ELSE
  9535           MOVE ER-2879          TO WS-ERROR
  9536           PERFORM 9900-ERROR-FORMAT
  9537                                 THRU 9900-EXIT
  9538        END-IF
  9539     ELSE
  9540        MOVE ER-2879             TO WS-ERROR
  9541        PERFORM 9900-ERROR-FORMAT
  9542                                 THRU 9900-EXIT
  9543     END-IF
  9544     IF WS-AH-BEN-CATEGORY = 'G'
  9545        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9546        + WS-BANK-FEE
  9547     ELSE
  9548        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9549        + WS-BANK-LFEE
  9550     END-IF
  9551     .
  9552 0400-FIND-STATE-RECORD.
  9553
  9554     IF WK-STATE-ADDR NOT = ZEROS
  9555         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9556         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9557         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9558         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9559         IF PB-SV-STATE = CF-STATE-CODE
  9560             GO TO 0405-CONTINUE-EDIT
  9561         ELSE
  9562             NEXT SENTENCE
  9563     ELSE
  9564         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9565
  9566     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9567     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9568     MOVE '3'                    TO CNTL-REC-TYPE.
  9569     MOVE +0                     TO CNTL-SEQ-NO.
  9570
  9571     MOVE '3'                    TO RC-SW-2.
  9572     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9573
  9574     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9575        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9576        PB-SV-STATE   NOT = CF-STATE-CODE)
  9577        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9578                                    WS-TOL-AH-CLAIM
  9579                                    WS-MINIMUM-REFUND
  9580                                    WS-TOL-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 175
* EL050.cbl
  9581                                    WS-TOL-AH-PREM
  9582                                    WS-TOL-LF-REFUND
  9583                                    WS-TOL-AH-REFUND
  9584                                    EC-ST-TOL-PREM-PCT
  9585                                    WS-TOL-LF-PREM-PCT
  9586                                    WS-TOL-AH-PREM-PCT
  9587                                    EC-ST-TOL-REFUND-PCT
  9588                                    WS-TOL-LF-REFUND-PCT
  9589                                    WS-TOL-AH-REFUND-PCT
  9590                                    EC-ST-TOL-PREM
  9591                                    EC-ST-TOL-REFUND
  9592                                    EC-ST-FST-PMT-DAYS-MAX
  9593                                    WS-FREE-LOOK-PERIOD
  9594                                    WS-ST-LF-PREM-TAX
  9595                                    WS-ST-AH-PREM-TAX-I
  9596                                    WS-ST-AH-PREM-TAX-G
  9597                                    WS-BANK-FEE
  9598                                    WS-BANK-LFEE
  9599                                    WS-TOL-CLP-PCT
  9600                                    WS-SPP-LEASE-COMM
  9601        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9602                                    EC-ST-FST-PMT-DAYS-CHG
  9603                                    WS-LF-REM-TERM-CALC
  9604                                    WS-LF-REFUND-CALC
  9605                                    EC-ST-LF-REM-TERM-CALC
  9606                                    EC-ST-LF-REFUND-CALC
  9607                                    WS-AH-REM-TERM-CALC
  9608                                    WS-AH-REFUND-CALC
  9609                                    WS-LF-BEN-CATEGORY
  9610                                    WS-AH-BEN-CATEGORY
  9611                                    WS-CLP-STATE
  9612                                    WS-ST-REFUND-CLAIM-FLAG
  9613                                    EC-ST-AH-REM-TERM-CALC
  9614                                    EC-ST-AH-REFUND-CALC
  9615          GO TO 0499-STATE-NOT-FOUND.
  9616
  9617     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9618
  9619 0405-CONTINUE-EDIT.
  9620
  9621     if pb-company-id = 'AHL'
  9622        continue
  9623     else
  9624        IF PB-CERT-PRIME NOT NUMERIC
  9625           MOVE ER-2722          TO WS-ERROR
  9626           PERFORM 9900-ERROR-FORMAT
  9627                                 THRU 9900-EXIT
  9628        end-if
  9629     END-IF
  9630*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9631*       MOVE +0                  TO SUB3
  9632*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9633*       IF SUB3 > +0
  9634*          MOVE ER-2722          TO WS-ERROR
  9635*          PERFORM 9900-ERROR-FORMAT
  9636*                                THRU 9900-EXIT
  9637*       END-IF
  9638*    END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 176
* EL050.cbl
  9639*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9640*       IF PB-CERT-PRIME NOT NUMERIC
  9641*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9642*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9643*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9644*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9645*
  9646*          MOVE ER-2722          TO WS-ERROR
  9647*          PERFORM 9900-ERROR-FORMAT
  9648*                                THRU 9900-EXIT
  9649*       END-IF
  9650*    END-IF
  9651
  9652     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9653
  9654     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9655        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9656                                    WS-TOL-AH-CLAIM.
  9657
  9658     IF CF-ST-REFUND-MIN NOT NUMERIC
  9659        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9660
  9661     IF CF-ST-REFUND-MIN NOT = ZEROS
  9662        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9663
  9664     IF CF-ST-TOL-PREM  NOT = ZEROS
  9665        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9666                                    WS-TOL-AH-PREM
  9667        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9668
  9669     IF CF-ST-TOL-REFUND NOT = ZEROS
  9670        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9671                                    WS-TOL-AH-REFUND
  9672        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9673
  9674     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9675        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9676        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9677                                    WS-AH-REFUND-OVS-AMT
  9678                                    EC-ST-OVR-SHT-AMT.
  9679
  9680     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9681        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9682        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9683                                    WS-TOL-LF-PREM-PCT
  9684                                    WS-TOL-AH-PREM-PCT.
  9685
  9686     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9687        CF-ST-TOL-REF-PCT GREATER THAN +0
  9688        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9689                                    WS-TOL-LF-REFUND-PCT
  9690                                    WS-TOL-AH-REFUND-PCT.
  9691
  9692     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9693        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9694        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9695                                    WS-AH-REFUND-OVS-PCT
  9696                                    EC-ST-OVR-SHT-PCT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 177
* EL050.cbl
  9697
  9698     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9699     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9700
  9701     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9702          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9703
  9704     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9705     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9706     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9707
  9708     IF CF-ST-LF-PREM-TAX NUMERIC
  9709        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9710     END-IF
  9711     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9712        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9713     END-IF
  9714     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9715        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9716     END-IF
  9717
  9718     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9719         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9720     END-IF.
  9721
  9722     IF WS-LF-BENEFIT-CD = ZEROS
  9723        GO TO 0410-CHECK-AH.
  9724
  9725     IF CF-ST-RT-CALC NOT = SPACES
  9726        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9727                                    EC-ST-LF-REM-TERM-CALC
  9728     END-IF
  9729
  9730     IF WS-LF-COVERAGE-TYPE = 'R'
  9731        IF WS-LF-EARNINGS-CALC = '5'
  9732           IF CF-ST-RF-LN-CALC > '0'
  9733              MOVE CF-ST-RF-LN-CALC
  9734                                 TO WS-LF-REFUND-CALC
  9735                                    EC-ST-LF-REFUND-CALC
  9736           END-IF
  9737        ELSE
  9738           IF CF-ST-RF-LR-CALC > '0'
  9739              MOVE CF-ST-RF-LR-CALC
  9740                                 TO WS-LF-REFUND-CALC
  9741                                    EC-ST-LF-REFUND-CALC
  9742           END-IF
  9743        END-IF
  9744     ELSE
  9745        IF CF-ST-RF-LL-CALC > '0'
  9746           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9747                                    EC-ST-LF-REFUND-CALC
  9748        END-IF
  9749     END-IF
  9750
  9751     IF CF-ST-RT-CALC NOT = SPACES
  9752        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9753                                    EC-ST-LF-REM-TERM-CALC
  9754     END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 178
* EL050.cbl
  9755
  9756     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9757     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9758
  9759     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9760
  9761     IF NO-BENEFIT-FOUND
  9762        GO TO 0410-CHECK-AH.
  9763
  9764     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9765        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9766                                 TO EC-ST-LF-REM-TERM-CALC
  9767                                    WS-LF-REM-TERM-CALC
  9768     END-IF
  9769
  9770     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9771        MOVE CF-ST-REFUND-CALC (SUB3)
  9772                                 TO WS-LF-REFUND-CALC
  9773                                    EC-ST-LF-REFUND-CALC
  9774     END-IF
  9775*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9776
  9777     .
  9778 0410-CHECK-AH.
  9779
  9780     IF WS-AH-BENEFIT-CD = ZEROS
  9781        GO TO 0500-SET-ACCOUNT.
  9782
  9783     IF CF-ST-RT-CALC NOT = SPACES
  9784        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9785                                    EC-ST-AH-REM-TERM-CALC
  9786     END-IF
  9787
  9788     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9789        IF CF-ST-RF-CP-CALC > '0'
  9790           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9791                                    EC-ST-AH-REFUND-CALC
  9792        END-IF
  9793     ELSE
  9794        IF CF-ST-RF-AH-CALC > '0'
  9795           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9796                                    EC-ST-AH-REFUND-CALC
  9797        END-IF
  9798     END-IF
  9799     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9800     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9801
  9802     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9803
  9804     IF NO-BENEFIT-FOUND
  9805        GO TO 0500-SET-ACCOUNT.
  9806
  9807     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9808        MOVE CF-ST-REM-TERM-CALC (SUB3)
  9809                                 TO WS-AH-REM-TERM-CALC
  9810                                    EC-ST-AH-REM-TERM-CALC
  9811     END-IF
  9812
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 179
* EL050.cbl
  9813     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
  9814        MOVE CF-ST-REFUND-CALC (SUB3)
  9815                                 TO WS-AH-REFUND-CALC
  9816                                    EC-ST-AH-REFUND-CALC
  9817     END-IF
  9818
  9819*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
  9820
  9821     GO TO 0500-SET-ACCOUNT.
  9822
  9823 0499-STATE-NOT-FOUND.
  9824
  9825     MOVE ER-2603                TO WS-ERROR.
  9826     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9827
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 180
* EL050.cbl
  9829
  9830 0500-SET-ACCOUNT.
  9831*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
  9832     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9833        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
  9834        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
  9835        MOVE WS-CLP-STATE        TO CNTL-ACCESS
  9836        MOVE '3'                 TO CNTL-REC-TYPE
  9837        MOVE +0                  TO CNTL-SEQ-NO
  9838
  9839        MOVE '3'                 TO RC-SW-2
  9840        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
  9841
  9842        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9843           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9844           WS-CLP-STATE  NOT = CF-STATE-CODE)
  9845           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
  9846                                    WS-ST-AH-PREM-TAX-I
  9847                                    WS-ST-AH-PREM-TAX-G
  9848        ELSE
  9849           IF CF-ST-LF-PREM-TAX NUMERIC
  9850              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9851           END-IF
  9852           IF CF-ST-AH-PREM-TAX-I NUMERIC
  9853              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9854           END-IF
  9855           IF CF-ST-AH-PREM-TAX-G NUMERIC
  9856              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9857           END-IF
  9858        END-IF
  9859        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
  9860     END-IF
  9861*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
  9862*  FOR DCC ONLY
  9863     IF PB-COMPANY-ID = 'DCC'
  9864
  9865     MOVE ' '                    TO STAT-MASTER-SW
  9866     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
  9867     MOVE PB-CARRIER             TO ELSTAT-CARRIER
  9868     MOVE PB-GROUPING            TO ELSTAT-GROUP
  9869     MOVE PB-STATE               TO ELSTAT-STATE
  9870     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9871        MOVE WS-CLP-STATE        TO ELSTAT-STATE
  9872     END-IF
  9873
  9874     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  9875     SET BIN-TO-GREG             TO TRUE
  9876     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
  9877     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
  9878     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
  9879
  9880     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
  9881     IF STAT-MASTER-FOUND
  9882        MOVE 'N'                 TO STAT-MASTER-SW
  9883        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9884        IF STAT-MASTER-FOUND
  9885           IF (ELSTAT-KEY-SAVE (1:12) =
  9886                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 181
* EL050.cbl
  9887              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9888                 MOVE 'F'        TO STAT-MASTER-SW
  9889              ELSE
  9890                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9891                 IF (STAT-MASTER-FOUND)
  9892                    AND (ELSTAT-KEY-SAVE (1:12) =
  9893                        SF-CONTROL-PRIMARY (1:12))
  9894                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9895                    MOVE 'F'     TO STAT-MASTER-SW
  9896                 END-IF
  9897              END-IF
  9898           END-IF
  9899        END-IF
  9900     END-IF
  9901
  9902     IF STAT-MASTER-SW = 'F'
  9903        IF SF-ST-LF-PREM-TAX NUMERIC
  9904           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9905        END-IF
  9906        IF SF-ST-AH-PREM-TAX-I NUMERIC
  9907           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9908        END-IF
  9909        IF SF-ST-AH-PREM-TAX-G NUMERIC
  9910           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9911        END-IF
  9912     END-IF
  9913
  9914     END-IF
  9915     IF (PB-COMPANY-ID = 'DCC')
  9916        AND (PB-ISSUE)
  9917        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9918        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  9919        AND (AM-GPCD = 06)
  9920        MOVE 'Y'                 TO WS-GOOD-HIN
  9921        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9922           MOVE PB-I-VIN         TO WS-WORK-VIN
  9923           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9924              (V1 > 16)
  9925              IF WS-WORK-VIN (V1:1) NUMERIC
  9926                 MOVE WS-WORK-VIN-N (V1)
  9927                                 TO WS-ROW-B-VAL (V1)
  9928              ELSE
  9929                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
  9930                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
  9931                    OR (V2 > 26)
  9932                 END-PERFORM
  9933                 IF V2 < 27
  9934                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
  9935                 ELSE
  9936                    MOVE 'N'     TO WS-GOOD-HIN
  9937                 END-IF
  9938              END-IF
  9939              COMPUTE WS-ROW-D-VAL (V1) =
  9940                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
  9941              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
  9942                 WS-ROW-D-VAL (V1)
  9943           END-PERFORM
  9944           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 182
* EL050.cbl
  9945           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
  9946             REMAINDER WS-VIN-REMAINDER
  9947           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
  9948              CONTINUE
  9949           ELSE
  9950              MOVE 'N'           TO WS-GOOD-HIN
  9951           END-IF
  9952        ELSE
  9953           MOVE 'N'              TO WS-GOOD-HIN
  9954        END-IF
  9955        IF WS-GOOD-HIN NOT = 'Y'
  9956           MOVE ER-3826           TO WS-ERROR
  9957           PERFORM 9900-ERROR-FORMAT
  9958                                 THRU 9900-EXIT
  9959        END-IF
  9960     END-IF
  9961     IF (PB-COMPANY-ID = 'DCC')
  9962        AND (PB-ISSUE)
  9963        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9964        AND (AM-GPCD NOT = 06)
  9965        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9966          MOVE PB-I-VIN          TO WS-WORK-VIN
  9967          MOVE +8                TO V2
  9968          MOVE ZEROS             TO WS-VIN-TOTAL
  9969          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9970           (V1 > 17)
  9971             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
  9972                MOVE ER-3825     TO WS-ERROR
  9973                PERFORM 9900-ERROR-FORMAT
  9974                                 THRU 9900-EXIT
  9975             ELSE
  9976                IF V1 = 8
  9977                   MOVE 10       TO V2
  9978                END-IF
  9979                IF V1 = 9
  9980                   MOVE 0        TO V2
  9981                END-IF
  9982                IF V1 = 10
  9983                   MOVE 9        TO V2
  9984                END-IF
  9985                IF WS-WORK-VIN (V1:1) NUMERIC
  9986                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9987                    + (WS-WORK-VIN-N (V1) * V2)
  9988                ELSE
  9989                   MOVE WS-WORK-VIN (V1:1)
  9990                                 TO WS-HEX-BYTE
  9991                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
  9992                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9993                    + (WS-NUM (V3) * V2)
  9994                END-IF
  9995                COMPUTE V2 = V2 - 1
  9996             END-IF
  9997          END-PERFORM
  9998          MOVE ZEROS TO WS-VIN-REMAINDER
  9999          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 10000             REMAINDER WS-VIN-REMAINDER
 10001          IF ((WS-WORK-VIN (9:1) = 'X')
 10002             AND (WS-VIN-REMAINDER = 10))
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 183
* EL050.cbl
 10003                     OR
 10004             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 10005             CONTINUE
 10006          ELSE
 10007             MOVE ER-3826        TO WS-ERROR
 10008             PERFORM 9900-ERROR-FORMAT
 10009                                 THRU 9900-EXIT
 10010          END-IF
 10011        ELSE
 10012          MOVE ER-3826           TO WS-ERROR
 10013          PERFORM 9900-ERROR-FORMAT
 10014                                 THRU 9900-EXIT
 10015        END-IF
 10016     END-IF
 10017******************************************************************
 10018******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10019******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10020******* METHODS.
 10021******************************************************************
 10022     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10023        IF PB-CANCELLATION
 10024           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10025              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10026                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10027                IF FORM-MASTER-FOUND
 10028                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10029******************************************************************
 10030
 10031     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10032     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10033
 10034     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10035     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10036     MOVE AM-STATUS              TO WS-ACCT-STATUS.
 10037     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10038
 10039
 10040     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10041     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
 10042     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10043
 10044     IF AM-LF-OB-RATE NOT NUMERIC
 10045         MOVE ZERO               TO AM-LF-OB-RATE.
 10046
 10047     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10048         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10049
 10050     IF AM-AH-OB-RATE NOT NUMERIC
 10051         MOVE ZERO               TO AM-AH-OB-RATE.
 10052
 10053     IF WS-LF-JOINT-INDICATOR = 'J'
 10054         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10055     ELSE
 10056         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10057
 10058     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10059
 10060     IF WS-IG-OVRD-AM  EQUAL SPACE
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 184
* EL050.cbl
 10061         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10062
 10063     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10064         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10065                                       WS-IG-OVRD
 10066     ELSE
 10067         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10068             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10069                                       WS-IG-OVRD
 10070         ELSE
 10071             MOVE AM-IG             TO WS-IG-OVRD-AH
 10072                                       WS-IG-OVRD.
 10073
 10074     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10075         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10076                                       WS-IG-OVRD
 10077     ELSE
 10078         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10079             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10080                                       WS-IG-OVRD
 10081         ELSE
 10082             MOVE AM-IG             TO WS-IG-OVRD-LF
 10083                                       WS-IG-OVRD.
 10084
 10085     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10086     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10087     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10088     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10089     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10090
 10091     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10092     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
 10093     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10094     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10095
 10096     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10097     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10098     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10099     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10100     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10101     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10102     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10103
 10104     IF WS-ACCT-AH-DEV-PCT > +0
 10105        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10106     ELSE
 10107        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10108
 10109     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10110        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10111     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10112        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10113
 10114        IF AM-EARN-METHOD-L = 'S'
 10115            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10116                                        WS-LF-REFUND-CALC.
 10117
 10118        IF AM-EARN-METHOD-R = 'S'
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 185
* EL050.cbl
 10119            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10120                                        WS-LF-REFUND-CALC.
 10121
 10122     IF WS-LF-COVERAGE-TYPE = 'R'
 10123         IF AM-EARN-METHOD-R = 'R'
 10124            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10125                                    WS-LF-REFUND-CALC.
 10126     IF WS-LF-COVERAGE-TYPE = 'R'
 10127         IF AM-EARN-METHOD-R = 'P'
 10128            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10129                                    WS-LF-REFUND-CALC.
 10130     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10131         IF AM-EARN-METHOD-L = 'R'
 10132            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10133                                    WS-LF-REFUND-CALC.
 10134     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10135         IF AM-EARN-METHOD-L = 'P'
 10136            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10137                                    WS-LF-REFUND-CALC.
 10138     IF WS-LF-COVERAGE-TYPE = 'R'
 10139         IF AM-EARN-METHOD-R = 'A'
 10140            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10141                                    WS-LF-REFUND-CALC.
 10142     IF WS-LF-COVERAGE-TYPE = 'R'
 10143         IF AM-EARN-METHOD-R = 'M'
 10144            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10145                                    WS-LF-REFUND-CALC.
 10146     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10147         IF AM-EARN-METHOD-L = 'A'
 10148            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10149                                    WS-LF-REFUND-CALC.
 10150     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10151         IF AM-EARN-METHOD-L = 'M'
 10152            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10153                                    WS-LF-REFUND-CALC.
 10154
 10155     IF AM-EARN-METHOD-A = 'R'
 10156        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10157                                    WS-AH-REFUND-CALC.
 10158     IF AM-EARN-METHOD-A = 'P'
 10159        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10160                                    WS-AH-REFUND-CALC.
 10161     IF AM-EARN-METHOD-A = 'C'
 10162        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10163                                    WS-AH-REFUND-CALC.
 10164     IF AM-EARN-METHOD-A = 'A'
 10165        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10166                                    WS-AH-REFUND-CALC.
 10167     IF AM-EARN-METHOD-A = 'M'
 10168        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10169                                    WS-AH-REFUND-CALC.
 10170     IF AM-EARN-METHOD-A = 'N'
 10171        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10172                                    WS-AH-REFUND-CALC.
 10173     IF AM-EARN-METHOD-A = 'S'
 10174        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10175                                    WS-AH-REFUND-CALC.
 10176
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 186
* EL050.cbl
 10177     IF AM-TOL-PREM NOT = ZEROS
 10178        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10179                                    WS-TOL-AH-PREM.
 10180
 10181     IF AM-OVR-SHT-AMT NUMERIC AND
 10182                  AM-OVR-SHT-AMT > 0
 10183        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10184                                    EC-AM-LF-OVR-SHT-AMT
 10185                                    WS-AH-REFUND-OVS-AMT
 10186                                    EC-AM-AH-OVR-SHT-AMT.
 10187
 10188     IF AM-OVR-SHT-PCT NUMERIC AND
 10189                    AM-OVR-SHT-PCT > 0
 10190        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10191                                    EC-AM-LF-OVR-SHT-PCT
 10192                                    WS-AH-REFUND-OVS-PCT
 10193                                    EC-AM-AH-OVR-SHT-PCT.
 10194
 10195     IF AM-TOL-REF-PCT NUMERIC AND
 10196                  AM-TOL-REF-PCT > 0
 10197        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10198                                    WS-TOL-AH-REFUND-PCT.
 10199
 10200     IF AM-TOL-REF  NOT = ZEROS  AND
 10201                  AM-TOL-REF NUMERIC
 10202        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10203                                    EC-AM-LF-TOL-REFUND
 10204                                    WS-TOL-AH-REFUND
 10205                                    EC-AM-AH-TOL-REFUND.
 10206
 10207     IF AM-TOL-CLM  NOT = ZEROS
 10208        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
 10209                                    WS-TOL-AH-CLAIM.
 10210
 10211     IF AM-CLP-TOL-PCT NOT NUMERIC
 10212        MOVE +0                  TO AM-CLP-TOL-PCT
 10213     END-IF
 10214
 10215     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10216        MOVE +0                  TO AM-SPP-LEASE-COMM
 10217     END-IF
 10218     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10219        MOVE WS-PL-TOL-LF-PREM-PCT
 10220                                 TO WS-TOL-LF-PREM-PCT.
 10221
 10222     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10223        MOVE WS-PL-TOL-AH-PREM-PCT
 10224                                 TO WS-TOL-AH-PREM-PCT.
 10225
 10226     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10227        MOVE WS-PL-TOL-LF-REFUND-PCT
 10228                                 TO WS-TOL-LF-REFUND-PCT.
 10229
 10230     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10231        MOVE WS-PL-TOL-AH-REFUND-PCT
 10232                                 TO WS-TOL-AH-REFUND-PCT.
 10233
 10234     IF WS-PL-REF-OVS-AMT > +0
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 187
* EL050.cbl
 10235        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10236
 10237     IF WS-PL-REF-OVS-PCT > +0
 10238        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10239
 10240     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10241        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10242     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10243        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10244     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10245        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10246     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10247        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10248     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10249        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10250     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10251        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10252
 10253     IF WS-AH-PL-REF-OVS-AMT > +0
 10254        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10255
 10256     IF WS-AH-PL-REF-OVS-PCT > +0
 10257        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10258
 10259     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10260     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10261
 10262     IF PB-CANCELLATION
 10263        GO TO 3000-CONTINUE-EDIT.
 10264
 10265     MOVE +1 TO SUB1.
 10266     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10267     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10268
 10269     IF CF-COMPANY-ID = 'DMD'
 10270       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10271         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10272        ELSE
 10273         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10274
 10275  0525-FIND-ACCT-COMM.
 10276     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10277        NEXT SENTENCE
 10278      ELSE
 10279         ADD +1 TO SUB1
 10280         IF SUB1 LESS +11
 10281            GO TO 0525-FIND-ACCT-COMM
 10282          ELSE
 10283             GO TO 0560-EDIT-CONTINUE.
 10284
 10285     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10286     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10287                                    PB-I-LIFE-COMMISSION.
 10288***  IF PB-COMPANY-ID = 'CRI'
 10289     IF PB-PREM-ACCTNG-ONLY
 10290         GO TO 0560-EDIT-CONTINUE.
 10291
 10292     MOVE '0530' TO CTBL-SW.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 188
* EL050.cbl
 10293     MOVE ' '    TO WS-CTBL-READ-SW.
 10294
 10295
 10296 0530-GET-AH-COMP.
 10297     IF NO-AH-COVERAGE  OR
 10298        NO-AH-BENEFIT-MATCH
 10299           GO TO 0540-NEXT-READ-STEP.
 10300
 10301     IF AM-A-COM (SUB1) NUMERIC
 10302        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10303         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10304         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10305         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10306         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10307     ELSE
 10308          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10309          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10310          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10311          MOVE ZEROS             TO WS-SUB1
 10312                                    WS-COMMISSION
 10313          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10314          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10315          IF WS-COMMISSION > ZEROS
 10316             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10317             GO TO 0540-NEXT-READ-STEP
 10318          END-IF
 10319          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10320          IF CTBL-TABLE-FOUND
 10321             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10322                                        PB-I-AH-TERM
 10323             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10324             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10325             GO TO 0540-NEXT-READ-STEP
 10326          ELSE
 10327             IF FIRST-TIME-THROUGH
 10328                 GO TO 0530-GET-AH-COMP
 10329             ELSE
 10330                 MOVE ER-2609                TO WS-ERROR
 10331                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10332
 10333 0540-NEXT-READ-STEP.
 10334     MOVE '0540' TO CTBL-SW.
 10335     MOVE ' '    TO WS-CTBL-READ-SW.
 10336
 10337 0540-GET-LF-COMP.
 10338     IF NO-LIFE-COVERAGE  OR
 10339        NO-LF-BENEFIT-MATCH
 10340           GO TO 0560-EDIT-CONTINUE.
 10341
 10342     IF WS-LF-JOINT-INDICATOR = 'J'
 10343        IF AM-J-COM (SUB1) NUMERIC
 10344           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10345           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10346           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10347           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10348           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10349        ELSE
 10350           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 189
* EL050.cbl
 10351           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10352           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10353           MOVE ZEROS                TO WS-SUB1
 10354                                        WS-COMMISSION
 10355           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10356           IF WS-COMMISSION > ZEROS
 10357              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10358              GO TO 0560-EDIT-CONTINUE
 10359           END-IF
 10360           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10361           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10362           IF CTBL-TABLE-FOUND
 10363              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10364              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10365              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10366              GO TO 0560-EDIT-CONTINUE
 10367           ELSE
 10368              IF FIRST-TIME-THROUGH
 10369                  GO TO 0540-GET-LF-COMP
 10370              ELSE
 10371                  MOVE ER-2609                TO WS-ERROR
 10372                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10373                  GO TO 0560-EDIT-CONTINUE.
 10374
 10375     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10376        IF AM-L-COM (SUB1) NUMERIC
 10377           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10378           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10379           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10380           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10381           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10382        ELSE
 10383           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10384           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10385           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10386           MOVE ZEROS                TO WS-SUB1
 10387                                        WS-COMMISSION
 10388           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10389           IF WS-COMMISSION IS GREATER THAN ZEROS
 10390              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10391              GO TO 0560-EDIT-CONTINUE
 10392           END-IF
 10393           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10394           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10395           IF CTBL-TABLE-FOUND
 10396              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10397              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10398              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10399              GO TO 0560-EDIT-CONTINUE
 10400           ELSE
 10401              IF FIRST-TIME-THROUGH
 10402                  GO TO 0540-GET-LF-COMP
 10403              ELSE
 10404                  MOVE ER-2609                TO WS-ERROR
 10405                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10406
 10407*    GO TO 0560-EDIT-CONTINUE.
 10408
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 190
* EL050.cbl
 10409 0560-EDIT-CONTINUE.
 10410     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10411                                    WS-AH-PMF-COMM
 10412*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10413*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10414     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10415        (SUB1 > +10)
 10416        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10417           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10418           MOVE '0530'           TO CTBL-SW
 10419           MOVE ' '              TO WS-CTBL-READ-SW
 10420           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10421           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10422           MOVE '0540'           TO CTBL-SW
 10423           MOVE ' '              TO WS-CTBL-READ-SW
 10424           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10425        END-IF
 10426     END-PERFORM
 10427     GO TO 0564-EDIT-CONTINUE
 10428     .
 10429 0561-CHECK-AH.
 10430     IF (NO-AH-COVERAGE)
 10431        OR (NO-AH-BENEFIT-MATCH)
 10432        CONTINUE
 10433     ELSE
 10434        IF (AM-A-COM (SUB1) NUMERIC)
 10435           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10436           IF (AM-COM-TYP (SUB1) = 'A')
 10437              AND (WS-AH-PMF-COMM = ZEROS)
 10438              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10439           END-IF
 10440           CONTINUE
 10441        ELSE
 10442           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10443           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10444           MOVE PB-AH-OVERRIDE-L1
 10445                                 TO CTBL-BEN-TYPE
 10446           MOVE ZEROS            TO WS-SUB1
 10447                                    WS-COMMISSION
 10448           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10449           PERFORM 8300-READ-CTBL-TABLE
 10450                                 THRU 8300-EXIT
 10451           IF CTBL-TABLE-FOUND
 10452              IF (AM-COM-TYP (SUB1) = 'A')
 10453                 AND (WS-AH-PMF-COMM = ZEROS)
 10454                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10455                                        PB-I-AH-TERM
 10456                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10457                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10458              END-IF
 10459              CONTINUE
 10460           ELSE
 10461              IF FIRST-TIME-THROUGH
 10462                 GO TO 0561-CHECK-AH
 10463              ELSE
 10464                 MOVE ER-2609    TO WS-ERROR
 10465                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10466              END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 191
* EL050.cbl
 10467           END-IF
 10468        END-IF
 10469     END-IF
 10470     .
 10471 0561-EXIT.
 10472     EXIT.
 10473 0563-CHECK-LF.
 10474     IF (NO-LIFE-COVERAGE)
 10475        OR (NO-LF-BENEFIT-MATCH)
 10476        CONTINUE
 10477     ELSE
 10478        IF WS-LF-JOINT-INDICATOR = 'J'
 10479           IF AM-J-COM (SUB1) NUMERIC
 10480              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10481              IF (AM-COM-TYP (SUB1) = 'A')
 10482                 AND (WS-LF-PMF-COMM = ZEROS)
 10483                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10484              END-IF
 10485              CONTINUE
 10486           ELSE
 10487              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10488              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10489              MOVE PB-LIFE-OVERRIDE-L1
 10490                                 TO CTBL-BEN-TYPE
 10491              MOVE ZEROS         TO WS-SUB1
 10492                                    WS-COMMISSION
 10493              MOVE AM-J-COMA (SUB1)
 10494                                 TO CTBL-TABLE
 10495              PERFORM 8300-READ-CTBL-TABLE
 10496                                 THRU 8300-EXIT
 10497              IF CTBL-TABLE-FOUND
 10498                 IF (AM-COM-TYP (SUB1) = 'A')
 10499                    AND (WS-LF-PMF-COMM = ZEROS)
 10500                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10501                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10502                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10503                 END-IF
 10504                 CONTINUE
 10505              ELSE
 10506                 IF FIRST-TIME-THROUGH
 10507                    GO TO 0563-CHECK-LF
 10508                 ELSE
 10509                    MOVE ER-2609 TO WS-ERROR
 10510                    PERFORM 9900-ERROR-FORMAT
 10511                                 THRU 9900-EXIT
 10512*                   GO TO 0560-EDIT-CONTINUE
 10513                 END-IF
 10514              END-IF
 10515           END-IF
 10516        ELSE
 10517           IF AM-L-COM (SUB1) NUMERIC
 10518              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10519              IF (AM-COM-TYP (SUB1) = 'A')
 10520                 AND (WS-LF-PMF-COMM = ZEROS)
 10521                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10522              END-IF
 10523              CONTINUE
 10524           ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 192
* EL050.cbl
 10525              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10526              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10527              MOVE PB-LIFE-OVERRIDE-L1
 10528                                 TO CTBL-BEN-TYPE
 10529              MOVE ZEROS         TO WS-SUB1
 10530                                    WS-COMMISSION
 10531              MOVE AM-L-COMA (SUB1)
 10532                                 TO CTBL-TABLE
 10533              PERFORM 8300-READ-CTBL-TABLE
 10534                                 THRU 8300-EXIT
 10535              IF CTBL-TABLE-FOUND
 10536                 CONTINUE
 10537              ELSE
 10538                 IF FIRST-TIME-THROUGH
 10539                    GO TO 0563-CHECK-LF
 10540                 ELSE
 10541                    MOVE ER-2609 TO WS-ERROR
 10542                    PERFORM 9900-ERROR-FORMAT
 10543                                 THRU 9900-EXIT
 10544                 END-IF
 10545              END-IF
 10546           END-IF
 10547        END-IF
 10548     END-IF
 10549     .
 10550 0563-EXIT.
 10551     EXIT.
 10552 0564-EDIT-CONTINUE.
 10553
 10554     IF  PB-COMPANY-ID EQUAL 'DMD'
 10555         IF PB-I-NUM-BILLED EQUAL ZEROS
 10556            MOVE ER-8148       TO WS-ERROR
 10557            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10558
 10559*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10560*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10561*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10562*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10563*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10564*         IF NO-CONVERSION-ERROR
 10565*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10566*         ELSE
 10567*             IF PB-COMPANY-ID EQUAL 'HAN'
 10568*                 MOVE ZEROS     TO PB-I-AGE.
 10569     IF PB-I-BIRTHDAY > LOW-VALUES
 10570        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10571        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10572        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10573        PERFORM 8500-DATE-CONVERT
 10574                                 THRU 8500-EXIT
 10575        IF NO-CONVERSION-ERROR
 10576           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10577           IF PB-I-AGE > ZEROS
 10578              IF WS-WORK-AGE NOT = PB-I-AGE
 10579                 MOVE ER-9501    TO WS-ERROR
 10580                 PERFORM 9900-ERROR-FORMAT
 10581                                 THRU 9900-EXIT
 10582              END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 193
* EL050.cbl
 10583           ELSE
 10584              MOVE WS-WORK-AGE   TO PB-I-AGE
 10585           END-IF
 10586        END-IF
 10587     END-IF
 10588     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 10589                                   WS-INS-AGE-SET
 10590     IF PB-I-AGE = ZEROS
 10591        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10592           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 10593                                   WS-INS-AGE-SET
 10594           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10595
 10596     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10597                                   WS-AH-EDIT-AGE.
 10598
 10599     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10600        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10601        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10602        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10603        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10604        IF NO-CONVERSION-ERROR
 10605           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10606           IF PB-I-JOINT-AGE > 0
 10607              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10608                 MOVE ER-9503    TO WS-ERROR
 10609                 PERFORM 9900-ERROR-FORMAT
 10610                                 THRU 9900-EXIT
 10611              END-IF
 10612           ELSE
 10613              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10614           END-IF
 10615        ELSE
 10616           MOVE ZEROS            TO PB-I-JOINT-AGE
 10617        END-IF
 10618     END-IF
 10619     IF PB-I-JOINT-AGE NOT NUMERIC
 10620        MOVE ZERO               TO PB-I-JOINT-AGE.
 10621
 10622     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 10623                                   WS-JNT-AGE-SET
 10624     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 10625        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10626           (WS-AH-JOINT-INDICATOR = 'J')
 10627           IF PB-I-JOINT-AGE = ZEROS
 10628               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 10629                                          WS-JNT-AGE-SET
 10630               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10631           END-IF
 10632        END-IF
 10633     END-IF
 10634
 10635     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10636     IF WS-LF-JOINT-INDICATOR = 'J'
 10637        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10638        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10639            IF  PB-I-JOINT-AGE = ZERO
 10640                MOVE ER-2686       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 194
* EL050.cbl
 10641                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10642            ELSE
 10643                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10644                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10645                    IF PB-COMPANY-ID NOT = 'LBL'
 10646                        MOVE ER-2685    TO WS-ERROR
 10647                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10648
 10649     IF WS-AH-JOINT-INDICATOR = 'J'
 10650        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10651            IF  PB-I-JOINT-AGE = ZERO
 10652                MOVE ER-2686       TO WS-ERROR
 10653                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10654            ELSE
 10655                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10656                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10657                                           WS-EDIT-AGE
 10658                    IF PB-COMPANY-ID NOT = 'LBL'
 10659                        MOVE ER-2685    TO WS-ERROR
 10660                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10661
 10662******************************************************************
 10663*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10664******************************************************************
 10665
 10666     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10667        (WS-AH-SPECIAL-CALC-CD = 'O')
 10668        NEXT SENTENCE
 10669     ELSE
 10670        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10671          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10672           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10673            WS-AH-JOINT-INDICATOR = 'J')  AND
 10674           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10675            MOVE ER-2627             TO WS-ERROR
 10676            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10677
 10678     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10679        (WS-AH-SPECIAL-CALC-CD = 'O')
 10680         NEXT SENTENCE
 10681     ELSE
 10682         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10683            WS-AH-JOINT-INDICATOR = 'J'
 10684             IF PB-I-JOINT-INSURED = SPACES
 10685                 IF PB-COMPANY-ID NOT = 'JAL'
 10686                     MOVE ER-2696    TO WS-ERROR
 10687                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10688
 10689     IF PB-COMPANY-ID NOT = 'BOA'
 10690        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10691           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10692           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10693               PB-I-JOINT-INSURED NOT = SPACES)
 10694                MOVE ER-2691         TO WS-ERROR
 10695                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10696
 10697     IF PB-COMPANY-ID = 'BOA'
 10698        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 195
* EL050.cbl
 10699           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10700            IF PB-I-JOINT-AGE NOT = ZEROS
 10701                MOVE ER-2691         TO WS-ERROR
 10702                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10703
 10704     IF PB-COMPANY-ID = 'CRI'
 10705        IF PB-I-SIG-SW = 'J'
 10706           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 10707              WS-AH-JOINT-INDICATOR NOT = 'J'
 10708              MOVE ER-2675       TO WS-ERROR
 10709              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10710
 10711     IF PB-COMPANY-ID = 'CRI'
 10712        IF PB-I-SIG-SW = 'S'
 10713           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10714              WS-AH-JOINT-INDICATOR = 'J'
 10715              MOVE ER-2676       TO WS-ERROR
 10716              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10717
 10718     IF PB-COMPANY-ID = 'CVL'
 10719         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10720            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10721              MOVE ER-2783           TO WS-ERROR
 10722              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10723     IF (WS-LF-JOINT-INDICATOR = 'J')
 10724        AND (WS-AH-JOINT-INDICATOR = 'J')
 10725        AND (PB-I-LF-TERM > 120)
 10726        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10727        MOVE ER-2783             TO WS-ERROR
 10728        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10729     END-IF
 10730     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10731
 10732     IF PB-I-INDV-GRP-OVRD = 'I'
 10733        MOVE ER-2666             TO WS-ERROR
 10734        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10735        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10736
 10737     IF PB-I-INDV-GRP-OVRD = 'G'
 10738        MOVE ER-2666             TO WS-ERROR
 10739        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10740        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10741
 10742     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10743        NEXT SENTENCE
 10744     ELSE
 10745        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10746
 10747     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10748        IF WS-ERROR = ER-2666
 10749           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10750           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10751
 10752     IF PB-COMPANY-ID = 'CID'
 10753        IF PB-STATE = 'UT' OR 'MO'
 10754           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10755                 OR '76' OR '77')
 10756                      OR
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 196
* EL050.cbl
 10757               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10758                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10759                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10760                   OR '2K' OR '2L'))
 10761              AND PB-I-INDV-GRP-CD = 'I'
 10762              MOVE ER-2721             TO WS-ERROR
 10763              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10764           END-IF
 10765        END-IF
 10766     END-IF
 10767
 10768     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10769     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10770        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10771     ELSE
 10772        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10773     END-IF
 10774
 10775*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10776*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10777     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10778                                    ACCOUNT-AH-CK-SW.
 10779
 10780     IF PB-REISSUED-CERT       OR
 10781        PB-REIN-ONLY-CERT      OR
 10782        PB-POLICY-IS-DECLINED  OR
 10783        PB-POLICY-IS-VOIDED
 10784*       OR PB-MONTHLY-CERT
 10785         GO TO 3000-CONTINUE-EDIT.
 10786
 10787     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10788        IF WS-EDIT-AGE           > +65
 10789           MOVE ER-2709          TO WS-ERROR
 10790           PERFORM 9900-ERROR-FORMAT
 10791                                 THRU 9900-EXIT
 10792        ELSE
 10793           IF WS-EDIT-AGE        > +55
 10794              MOVE ER-2718       TO WS-ERROR
 10795              PERFORM 9900-ERROR-FORMAT
 10796                                 THRU 9900-EXIT
 10797           END-IF
 10798        END-IF
 10799     IF PB-COMPANY-ID = 'DCC'
 10800        IF WS-EDIT-AGE           > +65
 10801           MOVE ER-2709          TO WS-ERROR
 10802           PERFORM 9900-ERROR-FORMAT
 10803                                 THRU 9900-EXIT
 10804        END-IF
 10805     END-IF
 10806     .
 10807
 10808 0565-LIFE-PLAN-LIMIT-EDITS.
 10809
 10810     IF NOT LF-PLAN-MASTER-FOUND
 10811        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10812                                    EC-AM-LF-MAX-TOT-BEN
 10813        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10814
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 197
* EL050.cbl
 10815     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10816
 10817     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10818         IF PL-LM-AGE (1) = ZEROS
 10819             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10820
 10821     IF NO-LF-BENEFIT-MATCH          OR
 10822        WS-LF-BENEFIT-CD = ZEROS     OR
 10823        WS-LF-SPECIAL-CALC-CD = 'M'
 10824        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10825
 10826     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10827     MOVE +1                     TO SUB2.
 10828
 10829     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10830        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10831           MOVE +5   TO SUB2
 10832           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10833              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10834              (PL-LM-AGE (SUB2) EQUAL +0)
 10835              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10836              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10837
 10838     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10839
 10840     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10841                               + PB-I-LF-ALT-BENEFIT-AMT.
 10842
 10843 0568-CHECK-LIFE-ATT-AGE.
 10844
 10845     IF PL-ATT-AGE NUMERIC AND
 10846        PL-ATT-AGE > +0
 10847        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10848     END-IF
 10849*    IF PL-ATT-AGE NUMERIC AND
 10850*       PL-ATT-AGE > +0
 10851*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10852*       IF PB-I-BIRTHDAY > LOW-VALUES
 10853*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10854*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 10855*          MOVE ZERO             TO DC-ELAPSED-DAYS
 10856*          SET BIN-PLUS-ELAPSED  TO TRUE
 10857*          PERFORM 8500-DATE-CONVERT
 10858*                                THRU 8500-EXIT
 10859*          IF NO-CONVERSION-ERROR
 10860*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 10861*             MOVE ER-2669       TO WS-ERROR
 10862*             PERFORM 9900-ERROR-FORMAT
 10863*                                THRU 9900-EXIT
 10864*          END-IF
 10865*       ELSE
 10866*          IF WS-ATT-AGE >= PL-ATT-AGE
 10867*             MOVE ER-2669       TO WS-ERROR
 10868*             PERFORM 9900-ERROR-FORMAT
 10869*                                THRU 9900-EXIT
 10870*          END-IF
 10871*       END-IF
 10872*    END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 198
* EL050.cbl
 10873     .
 10874 0570-CHECK-LIFE-LIMITS.
 10875
 10876     IF PB-COMPANY-ID EQUAL 'CRI'
 10877        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10878           IF SUB2 GREATER THAN +4
 10879              MOVE ER-2637 TO WS-ERROR
 10880              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10881              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10882
 10883     IF PB-COMPANY-ID  =  'NCL'
 10884        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10885            SUB2 GREATER THAN +8
 10886             MOVE 'U'         TO PB-BATCH-ENTRY
 10887             MOVE ER-2637     TO WS-ERROR
 10888             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10889             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10890
 10891     IF SUB2 > +8
 10892        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10893           AND (PB-I-SIG-SW = 'Y')
 10894           CONTINUE
 10895        ELSE
 10896           MOVE ER-2637          TO WS-ERROR
 10897           PERFORM 9900-ERROR-FORMAT
 10898                                 THRU 9900-EXIT
 10899        END-IF
 10900        GO TO 0580-AH-PLAN-LIMIT-EDITS
 10901     END-IF
 10902     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 10903     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 10904     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 10905
 10906     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10907        ADD +1  TO SUB2
 10908        GO TO 0570-CHECK-LIFE-LIMITS.
 10909
 10910     IF PB-COMPANY-ID = 'NCL'
 10911         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 10912
 10913     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 10914        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 10915        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10916           AND (PB-I-SIG-SW = 'Y')
 10917           CONTINUE
 10918        ELSE
 10919           MOVE ER-2637          TO WS-ERROR
 10920           PERFORM 9900-ERROR-FORMAT
 10921                                 THRU 9900-EXIT
 10922        END-IF
 10923     END-IF
 10924     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10925
 10926
 10927 0570-CHECK-NCL-LIFE-LIMITS.
 10928
 10929     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 10930        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 199
* EL050.cbl
 10931         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10932
 10933     IF APP-CERT-USED
 10934         IF SUB2  LESS THAN  +5
 10935             MOVE +5          TO SUB2
 10936             GO TO 0570-CHECK-LIFE-LIMITS.
 10937
 10938     MOVE ER-2637             TO WS-ERROR.
 10939     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10940
 10941     MOVE 'U'                 TO PB-BATCH-ENTRY.
 10942
 10943 0575-CHECK-NCL-SIG-SWITCH.
 10944
 10945     IF NOT APP-CERT-USED
 10946         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10947
 10948     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 10949        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 10950        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 10951        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 10952         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10953
 10954     IF SUB2 GREATER THAN +4
 10955         IF PL-LM-AGE (5) = ZEROS  AND
 10956            PL-LM-AGE (6) = ZEROS  AND
 10957            PL-LM-AGE (7) = ZEROS  AND
 10958            PL-LM-AGE (8) = ZEROS
 10959             MOVE  ER-1927        TO WS-ERROR
 10960             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 10961             GO TO 0580-AH-PLAN-LIMIT-EDITS
 10962         ELSE
 10963             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 10964                 MOVE  ER-1920    TO WS-ERROR
 10965                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10966
 10967     IF PB-I-SIG-SW  = 'Y'
 10968       IF NOT PB-I-POLICY-ACCEPTED  AND
 10969          NOT PB-I-POLICY-DECLINED
 10970           MOVE 'U'               TO PB-BATCH-ENTRY
 10971           MOVE  ER-1926          TO WS-ERROR
 10972           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10973
 10974
 10975 0580-AH-PLAN-LIMIT-EDITS.
 10976
 10977     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10978        IF PB-I-AH-BENEFIT-AMT > +1250
 10979           MOVE ER-2702          TO WS-ERROR
 10980           PERFORM 9900-ERROR-FORMAT
 10981                                 THRU 9900-EXIT
 10982        END-IF
 10983     END-IF
 10984
 10985     IF (PB-COMPANY-ID = 'DCC')
 10986        AND (PB-MONTHLY-CERT)
 10987        IF PB-I-AH-BENEFIT-AMT > +3000
 10988           MOVE ER-2881          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 200
* EL050.cbl
 10989           PERFORM 9900-ERROR-FORMAT
 10990                                 THRU 9900-EXIT
 10991        END-IF
 10992     END-IF
 10993     IF NOT AH-PLAN-MASTER-FOUND
 10994        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 10995        GO TO 3000-CONTINUE-EDIT.
 10996
 10997     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 10998
 10999     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11000         IF PL-LM-AGE (1) = ZEROS
 11001             GO TO 3000-CONTINUE-EDIT.
 11002
 11003     IF NO-AH-BENEFIT-MATCH          OR
 11004        WS-AH-BENEFIT-CD = ZEROS     OR
 11005        WS-AH-SPECIAL-CALC-CD = 'M'
 11006        GO TO 3000-CONTINUE-EDIT.
 11007
 11008     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11009     MOVE +1                     TO SUB2.
 11010
 11011     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11012        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11013           MOVE +5 TO SUB2
 11014           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11015              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11016              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11017              (PL-LM-AGE (SUB2) EQUAL +0)
 11018              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 11019              GO TO 3000-CONTINUE-EDIT.
 11020
 11021     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11022
 11023 0590-CHECK-AH-ATT-AGE.
 11024
 11025     IF PL-ATT-AGE NUMERIC AND
 11026        PL-ATT-AGE GREATER THAN +0
 11027        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11028     END-IF
 11029*       IF WS-ATT-AGE >= PL-ATT-AGE
 11030*          MOVE ER-3054          TO WS-ERROR
 11031*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11032     .
 11033 0597-CHECK-AH-LIMITS.
 11034
 11035     IF PB-COMPANY-ID EQUAL 'CRI'
 11036        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11037           IF SUB2 GREATER THAN +4
 11038              MOVE ER-2638       TO WS-ERROR
 11039              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11040              GO TO 3000-CONTINUE-EDIT.
 11041
 11042     IF PB-COMPANY-ID  =  'NCL'
 11043        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11044            SUB2 GREATER THAN +8
 11045             MOVE 'U'            TO PB-BATCH-ENTRY
 11046             MOVE ER-2638        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 201
* EL050.cbl
 11047             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11048             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11049
 11050     IF SUB2 > +8
 11051        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11052           AND (PB-I-SIG-SW = 'Y')
 11053           CONTINUE
 11054        ELSE
 11055           MOVE ER-2638          TO WS-ERROR
 11056           PERFORM 9900-ERROR-FORMAT
 11057                                 THRU 9900-EXIT
 11058        END-IF
 11059        GO TO 3000-CONTINUE-EDIT
 11060     END-IF
 11061
 11062     IF PB-COMPANY-ID = 'CRI'
 11063        IF WS-ERROR = ER-2638
 11064           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11065
 11066     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11067     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11068     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11069     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11070
 11071     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11072        ADD +1                   TO SUB2
 11073        GO TO 0597-CHECK-AH-LIMITS.
 11074
 11075     IF PB-COMPANY-ID = 'NCL'
 11076         GO TO 0597-CHECK-NCL-AH-LIMITS.
 11077
 11078     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11079        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11080        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11081                                 > PL-LM-AMT (SUB2))
 11082        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11083           AND (PB-I-SIG-SW = 'Y')
 11084           CONTINUE
 11085        ELSE
 11086           MOVE ER-2638          TO WS-ERROR
 11087           PERFORM 9900-ERROR-FORMAT
 11088                                 THRU 9900-EXIT
 11089        END-IF
 11090     END-IF
 11091
 11092     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11093         IF  WS-ERROR    EQUAL    ER-2638
 11094             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11095                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11096                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11097                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11098                MOVE  ER-1910    TO  WS-ERROR
 11099                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11100
 11101     IF PB-COMPANY-ID = 'CRI'
 11102        IF WS-ERROR = ER-2638
 11103            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11104            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 202
* EL050.cbl
 11105            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11106
 11107     GO TO 3000-CONTINUE-EDIT.
 11108
 11109 0597-CHECK-NCL-AH-LIMITS.
 11110
 11111     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11112        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11113        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11114                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11115         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11116
 11117     IF APP-CERT-USED
 11118         IF SUB2  LESS THAN  +5
 11119             MOVE +5             TO SUB2
 11120             GO TO 0597-CHECK-AH-LIMITS.
 11121
 11122     MOVE ER-2638                TO WS-ERROR.
 11123     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11124
 11125     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11126
 11127 0599-CHECK-NCL-SIG-SWITCH.
 11128
 11129     IF NOT APP-CERT-USED
 11130         GO TO 3000-CONTINUE-EDIT.
 11131
 11132     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11133        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11134        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11135        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11136         GO TO 3000-CONTINUE-EDIT.
 11137
 11138     IF SUB2 GREATER THAN +4
 11139         IF PL-LM-AGE (5) = ZEROS  AND
 11140            PL-LM-AGE (6) = ZEROS  AND
 11141            PL-LM-AGE (7) = ZEROS  AND
 11142            PL-LM-AGE (8) = ZEROS
 11143             MOVE  ER-1927        TO WS-ERROR
 11144             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11145             GO TO 3000-CONTINUE-EDIT
 11146         ELSE
 11147             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11148                 MOVE  ER-1920    TO WS-ERROR
 11149                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11150
 11151     IF PB-I-SIG-SW  = 'Y'
 11152       IF NOT PB-I-POLICY-ACCEPTED  AND
 11153          NOT PB-I-POLICY-DECLINED
 11154           MOVE 'U'               TO PB-BATCH-ENTRY
 11155           MOVE  ER-1926          TO WS-ERROR
 11156           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11157
 11158******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 203
* EL050.cbl
 11160
 11161 3000-CONTINUE-EDIT.
 11162
 11163     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11164     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11165     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11166     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11167     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11168
 11169     IF BROWSE-STARTED
 11170        PERFORM 9990-RETURN THRU 9990-EXIT
 11171        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11172
 11173     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11174        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11175        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11176        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11177*       MOVE 1                   TO DC-OPTION-CODE
 11178        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11179        IF DATE-CONVERSION-ERROR
 11180           MOVE ER-2622          TO WS-ERROR
 11181           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11182        ELSE
 11183           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11184              MOVE ER-2623       TO WS-ERROR
 11185              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11186           ELSE
 11187              MOVE ER-2622       TO WS-ERROR
 11188              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11189
 11190     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11191     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11192     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11193*    MOVE 1                      TO DC-OPTION-CODE.
 11194     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11195     IF DATE-CONVERSION-ERROR
 11196        GO TO 3005-EDIT-CONTINUE
 11197     ELSE
 11198        IF DC-ELAPSED-DAYS GREATER +180
 11199           MOVE ER-2613          TO WS-ERROR
 11200           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11201        ELSE
 11202           IF DC-ELAPSED-DAYS GREATER +90
 11203              MOVE ER-2612       TO WS-ERROR
 11204              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11205           ELSE
 11206             IF DC-ELAPSED-DAYS GREATER +60
 11207                MOVE ER-2614     TO WS-ERROR
 11208                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11209
 11210 3005-EDIT-CONTINUE.
 11211
 11212     IF PB-CANCELLATION
 11213         GO TO 3700-EDIT-CANCEL.
 11214
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 204
* EL050.cbl
 11216******************************************************************
 11217*                  E D I T   I S S U E                           *
 11218******************************************************************
 11219
 11220 3020-EDIT-ISSUE.
 11221
 11222      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11223      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11224      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11225      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11226      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11227
 11228     IF PB-ISSUE-FORCE
 11229        OR PB-ISSUE-DATE-FORCED
 11230        OR PB-FORCE-OFF
 11231        OR PB-OVERCHARGE-FORCE
 11232        CONTINUE
 11233     ELSE
 11234        MOVE ER-2670             TO WS-ERROR
 11235        PERFORM 9900-ERROR-FORMAT
 11236                                 THRU 9900-EXIT
 11237     END-IF
 11238     .
 11239 3022-SET-POLICY-STATUS.
 11240
 11241     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11242
 11243     IF (PB-REISSUED-CERT)
 11244             OR
 11245        ((PB-COMPANY-ID NOT = 'DCC')
 11246         AND (PB-MONTHLY-CERT))
 11247         MOVE '5'                TO PB-I-ENTRY-STATUS
 11248         MOVE 'E'                TO PB-BATCH-ENTRY
 11249     END-IF
 11250
 11251     IF PB-COMPANY-ID = 'DCC'
 11252        IF PB-MONTHLY-CERT
 11253           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11254        END-IF
 11255     END-IF
 11256     IF PB-POLICY-IS-DECLINED
 11257         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11258     IF PB-POLICY-IS-VOIDED
 11259         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11260     IF PB-NEEDS-UNDERWRITING
 11261         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11262     IF PB-REIN-ONLY-CERT
 11263         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11264     IF PB-PREM-ACCTNG-ONLY
 11265         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11266
 11267     MOVE SPACE                  TO PB-I-OB-FLAG.
 11268
 11269     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 11270         MOVE ER-2665            TO WS-ERROR
 11271         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11272         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11273
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 205
* EL050.cbl
 11274     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11275        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11276           MOVE 'Z'             TO PB-I-OB-FLAG.
 11277
 11278     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11279        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11280           MOVE 'Z'             TO PB-I-OB-FLAG.
 11281
 11282     IF ACCOUNT-MAST-FOUND
 11283         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11284         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11285         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11286         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11287         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11288         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11289         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11290     END-IF
 11291
 11292     IF ACCOUNT-MAST-FOUND
 11293        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11294         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11295
 11296     IF (ACCOUNT-MAST-FOUND)
 11297        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11298        IF PB-REISSUED-CERT
 11299           CONTINUE
 11300        ELSE
 11301           MOVE ER-2608          TO WS-ERROR
 11302           PERFORM 9900-ERROR-FORMAT
 11303                                 THRU 9900-EXIT
 11304         END-IF
 11305     END-IF
 11306
 11307     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11308        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11309        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11310
 11311**********   DMD CUSTOM CODE FOLLOWS  **********
 11312 3024-EDIT-DMD-FIELDS.
 11313     IF PB-COMPANY-ID NOT = 'DMD'
 11314        GO TO 3025-EDIT-REINSURANCE.
 11315
 11316*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11317*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11318*** ERROR IF THEY ARE NOT EQUAL.
 11319
 11320     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11321     SET BIN-TO-GREG               TO TRUE.
 11322     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11323     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11324**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11325
 11326     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11327     SET BIN-TO-GREG               TO TRUE.
 11328     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11329     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11330**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11331
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 206
* EL050.cbl
 11332     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11333        MOVE ER-8116               TO WS-ERROR
 11334        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11335
 11336     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11337
 11338     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11339                                      WK-FULL-CERT-NO.
 11340     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11341
 11342     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11343
 11344     IF PB-VALID-LIFE
 11345        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11346     ELSE
 11347        IF PB-VALID-AH
 11348          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11349
 11350
 11351     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11352     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11353     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11354                                      DCUA-UNDRWRTR-CODE
 11355                                      DCUA-UNDRWRTR-GROUP-CODE
 11356                                      DCUA-RETURN-CODE.
 11357
 11358****************************************************************
 11359*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11360***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11361***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11362***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11363***   TO THIS RECORD.                                        ***
 11364****************************************************************
 11365     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11366     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11367     IF DCUA-SUCCESSFUL-PROCESS
 11368        GO TO 3024-EDIT-DL7-CONT.
 11369
 11370     IF DCUA-RETURN-CODE EQUAL '01'
 11371        MOVE ER-8110               TO WS-ERROR
 11372        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11373        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11374        GO TO 3024-EDIT-DL7-CONT.
 11375
 11376     IF DCUA-RETURN-CODE EQUAL '02'
 11377        MOVE ER-8111               TO WS-ERROR
 11378        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11379        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11380        GO TO 3024-EDIT-DL7-CONT.
 11381
 11382     IF DCUA-RETURN-CODE EQUAL '03'
 11383        MOVE ER-8074               TO WS-ERROR
 11384        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11385        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11386        GO TO 3024-EDIT-DL7-CONT.
 11387
 11388     IF DCUA-RETURN-CODE EQUAL '04'
 11389        MOVE ER-8075               TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 207
* EL050.cbl
 11390        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11391        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11392        GO TO 3024-EDIT-DL7-CONT.
 11393
 11394     IF DCUA-RETURN-CODE EQUAL '05'
 11395        MOVE ER-8076               TO WS-ERROR
 11396        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11397        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11398        GO TO 3024-EDIT-DL7-CONT.
 11399
 11400     IF DCUA-RETURN-CODE EQUAL '06'
 11401        MOVE ER-8077               TO WS-ERROR
 11402        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11403        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11404        GO TO 3024-EDIT-DL7-CONT.
 11405
 11406     IF DCUA-RETURN-CODE EQUAL '07'
 11407        MOVE ER-8078               TO WS-ERROR
 11408        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11409        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11410        GO TO 3024-EDIT-DL7-CONT.
 11411
 11412     IF DCUA-RETURN-CODE EQUAL 'E1'
 11413        MOVE ER-8079               TO WS-ERROR
 11414        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11415        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11416        GO TO 3024-EDIT-DL7-CONT.
 11417
 11418     IF DCUA-RETURN-CODE EQUAL 'E2'
 11419        MOVE ER-8080               TO WS-ERROR
 11420        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11421        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11422        GO TO 3024-EDIT-DL7-CONT.
 11423
 11424     IF DCUA-RETURN-CODE EQUAL 'E3'
 11425        MOVE ER-8098               TO WS-ERROR
 11426        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11427        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11428        GO TO 3024-EDIT-DL7-CONT.
 11429
 11430     IF DCUA-RETURN-CODE EQUAL 'C1'
 11431        MOVE ER-8099               TO WS-ERROR
 11432        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11433        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11434        GO TO 3024-EDIT-DL7-CONT.
 11435
 11436     IF DCUA-RETURN-CODE EQUAL 'U1'
 11437        MOVE ER-8109               TO WS-ERROR
 11438        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11439        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11440        GO TO 3024-EDIT-DL7-CONT.
 11441
 11442     IF DCUA-RETURN-CODE EQUAL 'N1'
 11443        MOVE ER-8112               TO WS-ERROR
 11444        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11445        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11446        GO TO 3024-EDIT-DL7-CONT.
 11447
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 208
* EL050.cbl
 11448     IF DCUA-RETURN-CODE EQUAL 'N2'
 11449        MOVE ER-8113               TO WS-ERROR
 11450        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11451        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11452        GO TO 3024-EDIT-DL7-CONT.
 11453
 11454     IF DCUA-RETURN-CODE EQUAL 'N3'
 11455        MOVE ER-8114               TO WS-ERROR
 11456        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11457        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11458        GO TO 3024-EDIT-DL7-CONT.
 11459
 11460     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11461     MOVE ER-8097                  TO WS-ERROR.
 11462     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11463     GO TO 3024-EDIT-DL7-CONT.
 11464
 11465 3024-EDIT-DL7-CONT.
 11466
 11467     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11468     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11469     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11470        NEXT SENTENCE
 11471     ELSE
 11472        MOVE ER-9263               TO WS-ERROR
 11473        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11474
 11475******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11476******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11477     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11478        NEXT SENTENCE
 11479     ELSE
 11480        MOVE ER-8039               TO WS-ERROR
 11481        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11482
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 209
* EL050.cbl
 11484****************************************************************
 11485*** VALIDATE STATE  : DLO022                                 ***
 11486****************************************************************
 11487     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11488     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11489
 11490     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11491     IF DVSC-SUCCESSFUL-EDIT
 11492        GO TO 3024-EDIT-DL22-CONT.
 11493
 11494     IF DVSC-RETURN-CODE EQUAL '01'
 11495        MOVE ER-8300               TO WS-ERROR
 11496        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11497        GO TO 3024-EDIT-DL22-CONT.
 11498
 11499     IF DVSC-RETURN-CODE EQUAL '02'
 11500        MOVE ER-8301               TO WS-ERROR
 11501        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11502        GO TO 3024-EDIT-DL22-CONT.
 11503
 11504     IF DVSC-RETURN-CODE EQUAL '03'
 11505        MOVE ER-8302               TO WS-ERROR
 11506        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11507        GO TO 3024-EDIT-DL22-CONT.
 11508
 11509     IF DVSC-RETURN-CODE EQUAL 'N1'
 11510        MOVE ER-8304               TO WS-ERROR
 11511        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11512        GO TO 3024-EDIT-DL22-CONT.
 11513
 11514     MOVE ER-8303                  TO WS-ERROR
 11515     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11516
 11517 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 210
* EL050.cbl
 11519****************************************************************
 11520*** VALIDATE LOAN OFFICER : DLO021                           ***
 11521****************************************************************
 11522
 11523     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11524     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11525     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11526     IF DVLO-SUCCESSFUL-EDIT
 11527        GO TO 3024-EDIT-DL21-CONT.
 11528
 11529     IF DVLO-RETURN-CODE EQUAL '01'
 11530        MOVE ER-8081               TO WS-ERROR
 11531        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11532        GO TO 3024-EDIT-DL21-CONT.
 11533
 11534     IF DVLO-RETURN-CODE EQUAL '02'
 11535        MOVE ER-8082               TO WS-ERROR
 11536        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11537        GO TO 3024-EDIT-DL21-CONT.
 11538
 11539     IF DVLO-RETURN-CODE EQUAL '03'
 11540        MOVE ER-8083               TO WS-ERROR
 11541        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11542        GO TO 3024-EDIT-DL21-CONT.
 11543
 11544     IF DVLO-RETURN-CODE EQUAL '04'
 11545        MOVE ER-8084               TO WS-ERROR
 11546        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11547        GO TO 3024-EDIT-DL21-CONT.
 11548
 11549     IF DVLO-RETURN-CODE EQUAL '05'
 11550        MOVE ER-8085               TO WS-ERROR
 11551        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11552        GO TO 3024-EDIT-DL21-CONT.
 11553
 11554     MOVE ER-7825                  TO WS-ERROR
 11555     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11556     GO TO 3024-EDIT-DL21-CONT.
 11557
 11558 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 211
* EL050.cbl
 11560
 11561****************************************************************
 11562*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11563****************************************************************
 11564
 11565     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11566     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11567     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11568     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11569     IF DIPF-SUCCESSFUL-EDIT
 11570        GO TO 3024-EDIT-DL02-CONT.
 11571
 11572     IF DIPF-RETURN-CODE EQUAL '01'
 11573        MOVE ER-8086               TO WS-ERROR
 11574        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11575        GO TO 3024-EDIT-DL02-CONT.
 11576
 11577     IF DIPF-RETURN-CODE EQUAL '02'
 11578        MOVE ER-8087               TO WS-ERROR
 11579        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11580        GO TO 3024-EDIT-DL02-CONT.
 11581
 11582     IF DIPF-RETURN-CODE EQUAL '03'
 11583        MOVE ER-8088               TO WS-ERROR
 11584        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11585        GO TO 3024-EDIT-DL02-CONT.
 11586
 11587     MOVE ER-8095                  TO WS-ERROR
 11588     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11589     GO TO 3024-EDIT-DL02-CONT.
 11590
 11591 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 212
* EL050.cbl
 11593
 11594****************************************************************
 11595*** VALIDATE BANK ID : DLO003                                ***
 11596****************************************************************
 11597
 11598     MOVE WK-GREG-CENT           TO WCG-CENT.
 11599     MOVE WK-GREG-YYMM           TO WCG-REST.
 11600     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11601        MOVE ER-8040               TO WS-ERROR
 11602        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11603
 11604     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11605     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11606     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11607     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11608     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11609     IF DVBI-SUCCESSFUL-EDIT
 11610        GO TO 3024-EDIT-DL03-CONT.
 11611
 11612     IF DVBI-RETURN-CODE EQUAL '01'
 11613        MOVE ER-8089               TO WS-ERROR
 11614        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11615        GO TO 3024-EDIT-DL03-CONT.
 11616
 11617     IF DVBI-RETURN-CODE EQUAL '02'
 11618        MOVE ER-8090               TO WS-ERROR
 11619        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11620        GO TO 3024-EDIT-DL03-CONT.
 11621
 11622     IF DVBI-RETURN-CODE EQUAL '03'
 11623        MOVE ER-8091               TO WS-ERROR
 11624        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11625        GO TO 3024-EDIT-DL03-CONT.
 11626
 11627     IF DVBI-RETURN-CODE EQUAL '04'
 11628        MOVE ER-8092               TO WS-ERROR
 11629        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11630        GO TO 3024-EDIT-DL03-CONT.
 11631
 11632     IF DVBI-RETURN-CODE EQUAL '05'
 11633        MOVE ER-8093               TO WS-ERROR
 11634        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11635        GO TO 3024-EDIT-DL03-CONT.
 11636
 11637     IF DVBI-RETURN-CODE EQUAL '06'
 11638        MOVE ER-8094               TO WS-ERROR
 11639        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11640        GO TO 3024-EDIT-DL03-CONT.
 11641
 11642     MOVE ER-8096                  TO WS-ERROR
 11643     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11644     GO TO 3024-EDIT-DL03-CONT.
 11645
 11646 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 213
* EL050.cbl
 11648
 11649     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11650        NEXT SENTENCE
 11651     ELSE
 11652        MOVE ER-8042               TO WS-ERROR
 11653        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11654
 11655     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11656     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11657     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11658
 11659     IF DMPF-RETURN-CODE = '01'
 11660        MOVE ER-8067               TO WS-ERROR
 11661        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11662        GO TO 3024-EDIT-DL01-CONT.
 11663
 11664     IF DMPF-RETURN-CODE = '02'
 11665        MOVE ER-8068               TO WS-ERROR
 11666        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11667        GO TO 3024-EDIT-DL01-CONT.
 11668
 11669     IF DMPF-RETURN-CODE = '03'
 11670        MOVE ER-8069               TO WS-ERROR
 11671        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11672        GO TO 3024-EDIT-DL01-CONT.
 11673
 11674     IF DMPF-RETURN-CODE = 'E1'
 11675        MOVE ER-8070               TO WS-ERROR
 11676        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11677        GO TO 3024-EDIT-DL01-CONT.
 11678
 11679     IF DMPF-RETURN-CODE = 'N1'
 11680        MOVE ER-8071               TO WS-ERROR
 11681        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11682        GO TO 3024-EDIT-DL01-CONT.
 11683
 11684     IF DMPF-RETURN-CODE NOT = 'OK'
 11685        MOVE ER-8072               TO WS-ERROR
 11686        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11687
 11688 3024-EDIT-DL01-CONT.
 11689******************************************************************
 11690***  VALIDATES RATE CODES : DLO017                             ***
 11691******************************************************************
 11692
 11693      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11694      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11695      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11696      IF DVRC-SUCCESSFUL-EDIT
 11697        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11698        GO TO 3024-CHECK-VALID-RATE.
 11699
 11700      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11701
 11702      IF DVRC-RETURN-CODE EQUAL '01'
 11703         MOVE ER-7817                   TO WS-ERROR
 11704         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11705         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 214
* EL050.cbl
 11706
 11707      IF DVRC-RETURN-CODE EQUAL '02'
 11708         MOVE ER-7818                   TO WS-ERROR
 11709         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11710         GO TO 3025-EDIT-REINSURANCE.
 11711
 11712      IF DVRC-RETURN-CODE EQUAL '03'
 11713         MOVE ER-7819                   TO WS-ERROR
 11714         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11715         GO TO 3025-EDIT-REINSURANCE.
 11716
 11717       MOVE ER-7820                     TO WS-ERROR.
 11718       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11719       GO TO 3025-EDIT-REINSURANCE.
 11720
 11721******************************************************************
 11722***  GET PREMIUM RATES : DLO011                                ***
 11723******************************************************************
 11724
 11725 3024-CHECK-VALID-RATE.
 11726
 11727     IF VALID-RATE-CODE
 11728        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11729        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11730        MOVE SPACES                TO DPRB-RETURN-CODE
 11731        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11732     ELSE
 11733         GO TO 3025-EDIT-REINSURANCE.
 11734
 11735      IF DPRB-SUCCESSFUL-PROCESS
 11736         IF PB-VALID-LIFE
 11737             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11738             GO TO 3025-EDIT-REINSURANCE
 11739         ELSE
 11740             IF PB-VALID-AH
 11741                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11742                 GO TO 3025-EDIT-REINSURANCE.
 11743
 11744      IF DPRB-RETURN-CODE EQUAL '01'
 11745         MOVE ER-7812                   TO WS-ERROR
 11746         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11747         GO TO 3025-EDIT-REINSURANCE.
 11748
 11749      IF DPRB-RETURN-CODE EQUAL '02'
 11750         MOVE ER-7813                   TO WS-ERROR
 11751         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11752         GO TO 3025-EDIT-REINSURANCE.
 11753
 11754      IF DPRB-RETURN-CODE EQUAL '03'
 11755         MOVE ER-7814                   TO WS-ERROR
 11756         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11757         GO TO 3025-EDIT-REINSURANCE.
 11758
 11759      IF DPRB-RETURN-CODE EQUAL '04'
 11760         IF NOT DPRB-1ST-TIME
 11761            MOVE ER-7815                   TO WS-ERROR
 11762            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11763            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 215
* EL050.cbl
 11764          ELSE
 11765         IF PB-VALID-LIFE
 11766            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11767          ELSE
 11768            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11769         END-IF
 11770         MOVE SPACES                TO DOCC-RETURN-CODE
 11771         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11772         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11773         IF DOCC-RETURN-CODE = 'OK'
 11774             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11775             GO TO 3024-CHECK-VALID-RATE
 11776           ELSE
 11777             MOVE ER-7823               TO WS-ERROR
 11778             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11779             GO TO 3025-EDIT-REINSURANCE.
 11780
 11781       MOVE ER-7816                     TO WS-ERROR.
 11782       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11783       GO TO 3025-EDIT-REINSURANCE.
 11784
 11785**********   DMD CUSTOM CODE ABOVE    **********
 11786
 11787 3025-EDIT-REINSURANCE.
 11788     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11789         GO TO 3027-EDIT-CONTINUE.
 11790
 11791     MOVE LOW-VALUES               TO ERREIN-KEY.
 11792     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11793     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11794                                      REIN-CODE-2
 11795                                      REIN-CODE-3.
 11796     MOVE 'A'                      TO REIN-TYPE.
 11797
 11798     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11799
 11800     MOVE '3026' TO REIN-SW.
 11801     MOVE ' '                   TO WS-REIN-READ-SW.
 11802
 11803     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11804     IF REIN-TABLE-NOT-FOUND
 11805         GO TO 3026-NO-SPEC-TABLE.
 11806
 11807     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11808     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11809                                   WS-NSP-ST-CD-LF.
 11810     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11811                                   WS-NSP-ST-CD-AH.
 11812
 11813     GO TO 3040-EDIT-CONTINUE.
 11814
 11815 3026-NO-SPEC-TABLE.
 11816
 11817     MOVE ER-2664                TO WS-ERROR.
 11818     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11819     GO TO 3040-EDIT-CONTINUE.
 11820
 11821 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 216
* EL050.cbl
 11822
 11823     IF PB-I-REIN-TABLE = SPACES
 11824       GO TO 3040-EDIT-CONTINUE.
 11825
 11826     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11827          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11828          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11829           GO TO 3040-EDIT-CONTINUE.
 11830
 11831     MOVE LOW-VALUES            TO ERREIN-KEY.
 11832     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11833     MOVE 'A'                   TO REIN-TYPE.
 11834     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11835
 11836     MOVE '3028'                TO REIN-SW.
 11837     MOVE ' '                   TO WS-REIN-READ-SW.
 11838
 11839     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11840     IF REIN-TABLE-NOT-FOUND
 11841         GO TO 3028-NO-REIN-TABLE.
 11842
 11843     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 11844     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11845                                   WS-NSP-ST-CD-LF.
 11846     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11847                                   WS-NSP-ST-CD-AH.
 11848
 11849     GO TO 3040-EDIT-CONTINUE.
 11850
 11851 3028-NO-REIN-TABLE.
 11852
 11853     MOVE ER-2615                TO WS-ERROR.
 11854     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11855     GO TO 3040-EDIT-CONTINUE.
 11856
 11857 3040-EDIT-CONTINUE.
 11858
 11859     IF PB-I-LF-PREM-CALC NOT NUMERIC
 11860         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 11861
 11862     IF PB-I-AH-PREM-CALC NOT NUMERIC
 11863         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 11864
 11865     IF (NOT PB-REISSUED-CERT)
 11866        AND (NOT PB-MONTHLY-CERT)
 11867        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 11868            MOVE '001'           TO PB-I-LF-TERM
 11869            MOVE 'M'             TO PB-I-INSURED-SEX.
 11870
 11871     IF (NOT PB-REISSUED-CERT)
 11872        AND (NOT PB-MONTHLY-CERT)
 11873        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 11874            MOVE '001'           TO PB-I-AH-TERM
 11875            MOVE 'M'             TO PB-I-INSURED-SEX.
 11876
 11877 3040-EDIT-1ST-PMT-DT.
 11878     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 11879     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 217
* EL050.cbl
 11880         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 11881
 11882******************************************************************
 11883*                                                                *
 11884*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 11885*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 11886*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 11887*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 11888*                                                                *
 11889******************************************************************
 11890
 11891     IF PB-EFF-DT-PROCESSING
 11892        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11893                                    PB-I-LF-EXPIRE-DT
 11894                                    PB-I-AH-EXPIRE-DT
 11895        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11896        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11897        MOVE ZERO                TO DC-ELAPSED-DAYS
 11898        MOVE +1                  TO DC-ELAPSED-MONTHS
 11899        SET BIN-PLUS-ELAPSED     TO TRUE
 11900*       MOVE 6                   TO DC-OPTION-CODE
 11901        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11902        IF NO-CONVERSION-ERROR
 11903           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11904
 11905******************************************************************
 11906*                                                                *
 11907*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 11908*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 11909*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11910*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 11911*                                                                *
 11912******************************************************************
 11913
 11914     IF PB-EXT-DAYS-PROCESSING
 11915          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 11916                                         PB-I-LF-EXPIRE-DT
 11917                                         PB-I-AH-EXPIRE-DT
 11918          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 11919          MOVE ZERO                   TO DC-ELAPSED-DAYS
 11920          MOVE +1                     TO DC-ELAPSED-MONTHS
 11921          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 11922          SET BIN-PLUS-ELAPSED        TO TRUE
 11923*         MOVE 6                      TO DC-OPTION-CODE
 11924          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11925          IF NO-CONVERSION-ERROR
 11926             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 11927
 11928******************************************************************
 11929*                                                                *
 11930*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 11931*        BASED ON THE OLDEST EXPIRE DATE.                        *
 11932*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11933*        (EXPIRE DATE - (TERM -1))  *  -1.
 11934*                                                                *
 11935******************************************************************
 11936
 11937     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 218
* EL050.cbl
 11938        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 11939           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 11940              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11941              MOVE PB-I-AH-TERM      TO WS-TERM
 11942           ELSE
 11943              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11944              MOVE PB-I-LF-TERM      TO WS-TERM
 11945        ELSE
 11946           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 11947              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11948              MOVE PB-I-LF-TERM      TO WS-TERM
 11949           ELSE
 11950              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11951              MOVE PB-I-AH-TERM      TO WS-TERM.
 11952
 11953     IF PB-EXPIRE-DT-PROCESSING
 11954        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11955        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11956        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 11957        MOVE ZERO                TO DC-ELAPSED-DAYS
 11958                                    DC-ODD-DAYS-OVER
 11959          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 11960          SET BIN-PLUS-ELAPSED    TO TRUE
 11961*         MOVE 6                  TO DC-OPTION-CODE
 11962          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11963          IF NO-CONVERSION-ERROR
 11964             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11965
 11966******************************************************************
 11967*                                                                *
 11968*            1ST PAYMENT DATE PROCESSING                         *
 11969*                                                                *
 11970******************************************************************
 11971
 11972     IF PB-1ST-PMT-DT-PROCESSING
 11973        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 11974                                    PB-I-AH-EXPIRE-DT
 11975        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 11976
 11977     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 11978         NEXT SENTENCE
 11979     ELSE
 11980         MOVE ER-2680                 TO WS-ERROR
 11981         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11982         GO TO 3060-ORIG-TERM-CHECK.
 11983
 11984     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 11985     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 11986     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11987*    MOVE 1                      TO DC-OPTION-CODE.
 11988     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 11989                                    DC-ELAPSED-DAYS
 11990                                    DC-ODD-DAYS-OVER.
 11991
 11992     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11993
 11994     IF DATE-CONVERSION-ERROR
 11995        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 219
* EL050.cbl
 11996
 11997     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 11998     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 11999        AND (WS-LF-COVERAGE-TYPE = 'L')
 12000        IF (DC-ELAPSED-MONTHS > 1)
 12001                      OR
 12002           ((DC-ELAPSED-MONTHS = 1)
 12003           AND (DC-ODD-DAYS-OVER > 0))
 12004           MOVE ER-2882          TO WS-ERROR
 12005           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12006        END-IF
 12007     END-IF
 12008     if dc-elapsed-months > 0
 12009        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12010        + dc-odd-days-over
 12011     end-if
 12012     IF PB-EXT-DAYS-PROCESSING
 12013        CONTINUE
 12014     ELSE
 12015        IF DC-ELAPSED-MONTHS = +0
 12016           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12017        ELSE
 12018           IF (WS-LF-EARNINGS-CALC = '4')
 12019              AND (DC-ELAPSED-MONTHS > ZERO)
 12020              AND (DC-ELAPSED-DAYS > ZERO)
 12021              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12022           ELSE
 12023              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12024                                 THRU 6499-EXIT
 12025              MOVE WS-ODD-DAYS-OVER
 12026                                 TO PB-I-EXTENTION-DAYS
 12027           END-IF
 12028        END-IF
 12029     END-IF
 12030******************************************************************
 12031*                                                                *
 12032*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12033*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12034*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12035*            AND ANY ODD DAYS.                                   *
 12036*                                                                *
 12037******************************************************************
 12038
 12039     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12040                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12041     IF WS-LF-EARNINGS-CALC NOT = '4'
 12042        IF DC-ELAPSED-DAYS > ZEROS
 12043           MOVE ER-2681          TO WS-ERROR
 12044           PERFORM 9900-ERROR-FORMAT
 12045                                 THRU 9900-EXIT
 12046        END-IF
 12047     END-IF
 12048
 12049     IF WS-LF-EARNINGS-CALC NOT = '4'
 12050        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12051           MOVE ER-2681          TO WS-ERROR
 12052           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12053
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 220
* EL050.cbl
 12054     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12055        (PB-I-LF-TERM NOT = ZERO) AND
 12056         NOT NO-LIFE-COVERAGE
 12057          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12058          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12059          IF WS-LF-EARNINGS-CALC = '4'
 12060             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12061             PB-I-PAY-FREQUENCY
 12062          END-IF
 12063          MOVE ZERO              TO DC-ELAPSED-DAYS
 12064                                    DC-ODD-DAYS-OVER
 12065          MOVE 1                 TO DC-END-OF-MONTH
 12066          SET BIN-PLUS-ELAPSED        TO TRUE
 12067*         MOVE 6                 TO DC-OPTION-CODE
 12068          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12069          IF NO-CONVERSION-ERROR
 12070             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12071             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12072                (WS-LF-SPECIAL-CALC-CD = 'L')
 12073                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12074                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12075                  MOVE +1             TO DC-ELAPSED-MONTHS
 12076                  SET BIN-PLUS-ELAPSED  TO TRUE
 12077*                 MOVE 6              TO DC-OPTION-CODE
 12078                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12079                  IF NO-CONVERSION-ERROR
 12080                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12081
 12082* okay, i had to move the new att age edit down here because the
 12083* expiration date could get recalculated and i need the exp date
 12084     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12085        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12086        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12087        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12088           AND ZEROS
 12089           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12090           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12091           SET ELAPSED-BETWEEN-BIN TO TRUE
 12092           PERFORM 8500-DATE-CONVERT
 12093                                 THRU 8500-EXIT
 12094           IF NO-CONVERSION-ERROR
 12095              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12096                 MOVE ER-2669       TO WS-ERROR
 12097*                PERFORM 9900-ERROR-FORMAT
 12098*                                THRU 9900-EXIT
 12099              END-IF
 12100           END-IF
 12101        ELSE
 12102           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12103           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12104              MOVE ER-2669       TO WS-ERROR
 12105*             PERFORM 9900-ERROR-FORMAT
 12106*                                THRU 9900-EXIT
 12107           ELSE
 12108              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12109                 MOVE ER-1570    TO WS-ERROR
 12110                 PERFORM 9900-ERROR-FORMAT
 12111                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 221
* EL050.cbl
 12112              END-IF
 12113           END-IF
 12114        END-IF
 12115        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12116           AND ZEROS
 12117           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12118           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12119           SET ELAPSED-BETWEEN-BIN TO TRUE
 12120           PERFORM 8500-DATE-CONVERT
 12121                                 THRU 8500-EXIT
 12122           IF NO-CONVERSION-ERROR
 12123              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12124                 MOVE ER-2669       TO WS-ERROR
 12125*                PERFORM 9900-ERROR-FORMAT
 12126*                                THRU 9900-EXIT
 12127              END-IF
 12128           END-IF
 12129        ELSE
 12130           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12131             (PB-I-LF-TERM / 12)
 12132           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12133              MOVE ER-2669       TO WS-ERROR
 12134*             PERFORM 9900-ERROR-FORMAT
 12135*                                THRU 9900-EXIT
 12136           ELSE
 12137              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12138                 MOVE ER-1571    TO WS-ERROR
 12139                 PERFORM 9900-ERROR-FORMAT
 12140                                 THRU 9900-EXIT
 12141              END-IF
 12142           END-IF
 12143        END-IF
 12144        IF WS-ERROR = ER-2669
 12145           PERFORM 9900-ERROR-FORMAT
 12146                                 THRU 9900-EXIT
 12147        END-IF
 12148     END-IF
 12149     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12150        (PB-I-AH-TERM NOT = ZERO) AND
 12151         NOT NO-AH-COVERAGE
 12152          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12153             AND (PB-COMPANY-ID = 'DCC')
 12154             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12155             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12156          ELSE
 12157             IF WS-LF-EARNINGS-CALC = '4'
 12158                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12159                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12160                PB-I-PAY-FREQUENCY
 12161             ELSE
 12162                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12163                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12164             END-IF
 12165          END-IF
 12166          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12167                                         DC-ODD-DAYS-OVER
 12168          MOVE 1                      TO DC-END-OF-MONTH
 12169          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 222
* EL050.cbl
 12170*         MOVE 6                      TO DC-OPTION-CODE
 12171          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12172          IF NO-CONVERSION-ERROR
 12173             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12174     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12175        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12176        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12177        IF PB-I-BIRTHDAY > LOW-VALUES
 12178           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12179           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12180           SET ELAPSED-BETWEEN-BIN TO TRUE
 12181           PERFORM 8500-DATE-CONVERT
 12182                                 THRU 8500-EXIT
 12183           IF NO-CONVERSION-ERROR
 12184              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12185                 MOVE ER-3054       TO WS-ERROR
 12186*                PERFORM 9900-ERROR-FORMAT
 12187*                                THRU 9900-EXIT
 12188              END-IF
 12189           END-IF
 12190        ELSE
 12191           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12192           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12193              MOVE ER-3054       TO WS-ERROR
 12194*             PERFORM 9900-ERROR-FORMAT
 12195*                                THRU 9900-EXIT
 12196           END-IF
 12197        END-IF
 12198        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12199           AND ZEROS
 12200           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12201           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12202           SET ELAPSED-BETWEEN-BIN TO TRUE
 12203           PERFORM 8500-DATE-CONVERT
 12204                                 THRU 8500-EXIT
 12205           IF NO-CONVERSION-ERROR
 12206              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12207                 MOVE ER-3054       TO WS-ERROR
 12208*                PERFORM 9900-ERROR-FORMAT
 12209*                                THRU 9900-EXIT
 12210              END-IF
 12211           END-IF
 12212        ELSE
 12213           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12214             (PB-I-AH-TERM / 12)
 12215           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12216              MOVE ER-3054       TO WS-ERROR
 12217*             PERFORM 9900-ERROR-FORMAT
 12218*                                THRU 9900-EXIT
 12219           END-IF
 12220        END-IF
 12221        IF WS-ERROR = ER-3054
 12222           PERFORM 9900-ERROR-FORMAT
 12223                                 THRU 9900-EXIT
 12224        END-IF
 12225     END-IF
 12226     MOVE SPACE                       TO DC-END-OF-MONTH.
 12227
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 223
* EL050.cbl
 12228     IF PB-COMPANY-ID = 'NCB'
 12229        GO TO 3040-EDIT-EXTENSION-DAYS.
 12230
 12231     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12232       AND
 12233        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12234        NEXT SENTENCE
 12235     ELSE
 12236        GO TO 3040-EDIT-EXTENSION-DAYS.
 12237
 12238     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12239        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12240        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12241     ELSE
 12242        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12243        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12244
 12245     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12246*    MOVE '1'      TO DC-OPTION-CODE
 12247     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12248     IF (NO-CONVERSION-ERROR)
 12249        AND (DC-ELAPSED-MONTHS > +1)
 12250        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12251        MOVE ER-2668   TO WS-ERROR
 12252        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12253
 12254 3040-EDIT-EXTENSION-DAYS.
 12255
 12256     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12257        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12258         GO TO 3050-EDIT-TERM-IN-DAYS
 12259     ELSE
 12260         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12261
 12262     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12263         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12264     ELSE
 12265        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12266           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12267           MOVE ER-2681         TO WS-ERROR
 12268           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12269
 12270     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12271        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12272        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12273         GO TO 3060-ORIG-TERM-CHECK.
 12274
 12275     GO TO 3060-ORIG-TERM-CHECK.
 12276
 12277 3050-EDIT-TERM-IN-DAYS.
 12278
 12279     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12280
 12281     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12282         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12283     ELSE
 12284         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12285            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 224
* EL050.cbl
 12286            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12287
 12288     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12289                                       REMAINDER WS-WORK-TERM.
 12290     IF WS-WORK-TERM GREATER THAN ZERO
 12291         ADD +1 TO PB-I-LF-TERM.
 12292
 12293     IF NOT NO-AH-COVERAGE
 12294         MOVE ER-2684            TO WS-ERROR
 12295         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12296
 12297
 12298 3060-ORIG-TERM-CHECK.
 12299
 12300******************************************************************
 12301*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12302******************************************************************
 12303
 12304     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12305        NEXT SENTENCE
 12306     ELSE
 12307        IF NOT NO-LIFE-COVERAGE
 12308           IF PB-I-LF-TERM NUMERIC
 12309              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12310              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12311              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12312                  NEXT SENTENCE
 12313           ELSE
 12314              MOVE ER-2647       TO WS-ERROR
 12315              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12316
 12317     IF NOT NO-AH-COVERAGE
 12318         IF PB-I-AH-TERM NUMERIC
 12319            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12320            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12321            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12322             NEXT SENTENCE
 12323          ELSE
 12324              MOVE ER-2658       TO WS-ERROR
 12325              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12326
 12327     IF PB-COMPANY-ID = 'NCB'
 12328        GO TO 3070-LOAN-TERM-CHECK.
 12329
 12330     IF POLICY-HAS-AH
 12331       AND
 12332        POLICY-HAS-LIFE
 12333       AND
 12334        PB-I-LF-TERM NUMERIC
 12335       AND
 12336        PB-I-AH-TERM NUMERIC
 12337        NEXT SENTENCE
 12338     ELSE
 12339        GO TO 3070-LOAN-TERM-CHECK.
 12340
 12341     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12342     IF WS-TEX-FACT-2 LESS THAN +0
 12343        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 225
* EL050.cbl
 12344
 12345     IF WS-TEX-FACT-2 GREATER THAN +1
 12346        MOVE ER-2668             TO WS-ERROR
 12347        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12348
 12349 3070-LOAN-TERM-CHECK.
 12350
 12351     IF (WS-LF-BENEFIT-CD = ZERO)
 12352         OR (NO-LF-BENEFIT-MATCH)
 12353            GO TO 3125-EDIT-PMT-FREQ.
 12354*    IF PB-COMPANY-ID NOT = 'DCC'
 12355*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12356*          AND 'V' AND 'W' AND 'X'
 12357*          GO TO 3125-EDIT-PMT-FREQ
 12358*       END-IF
 12359*    ELSE
 12360*       IF WS-AH-DCC-TRUNC = 'T'
 12361*          CONTINUE
 12362*       ELSE
 12363*          GO TO 3125-EDIT-PMT-FREQ
 12364*       END-IF
 12365*    END-IF
 12366     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12367                    OR
 12368        ((PB-COMPANY-ID = 'DCC')
 12369        AND (WS-AH-DCC-TRUNC = 'T'))
 12370        CONTINUE
 12371     ELSE
 12372        GO TO 3125-EDIT-PMT-FREQ
 12373     END-IF
 12374     IF PB-I-LOAN-TERM NOT NUMERIC
 12375         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12376
 12377     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12378        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12379*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12380        PB-I-LOAN-TERM NOT GREATER THAN +360
 12381         NEXT SENTENCE
 12382     ELSE
 12383         MOVE ER-2648            TO WS-ERROR
 12384         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12385
 12386     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12387        MOVE ER-3058             TO WS-ERROR
 12388        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12389     end-if
 12390
 12391     IF WS-STATE-ABBREVIATION = 'NC'
 12392        IF PB-I-LOAN-TERM > +59
 12393           CONTINUE
 12394        ELSE
 12395           MOVE ER-2792          TO WS-ERROR
 12396           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12397        END-IF
 12398     END-IF
 12399
 12400     .
 12401 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 226
* EL050.cbl
 12402     IF (WS-LF-BENEFIT-CD = ZERO)
 12403         OR (NO-LF-BENEFIT-MATCH)
 12404            GO TO 3127-EDIT-LOAN-OFFICER.
 12405     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12406                    OR
 12407        ((PB-COMPANY-ID = 'DCC')
 12408        AND (WS-AH-DCC-TRUNC = 'T'))
 12409                    OR
 12410         (PB-COMPANY-ID = 'AHL')
 12411        CONTINUE
 12412     ELSE
 12413        IF (PB-I-LOAN-TERM > ZEROS)
 12414           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12415           MOVE ER-1575          TO WS-ERROR
 12416           PERFORM 9900-ERROR-FORMAT
 12417                                 THRU 9900-EXIT
 12418        END-IF
 12419     END-IF
 12420     IF WS-LF-EARNINGS-CALC NOT = '4'
 12421         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12422            MOVE ER-2653         TO WS-ERROR
 12423            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12424            GO TO 3127-EDIT-LOAN-OFFICER
 12425         ELSE
 12426            GO TO 3127-EDIT-LOAN-OFFICER.
 12427
 12428     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12429         MOVE ER-2655            TO WS-ERROR
 12430         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12431         GO TO 3127-EDIT-LOAN-OFFICER.
 12432
 12433     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12434         MOVE ER-2654            TO WS-ERROR
 12435         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12436         GO TO 3127-EDIT-LOAN-OFFICER.
 12437
 12438     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12439         GIVING WS-TEX-FACT-2
 12440             REMAINDER WS-TEX-FACT-3.
 12441
 12442*    IF WS-TEX-FACT-3 NOT = ZERO
 12443*       MOVE ER-2654             TO WS-ERROR
 12444*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12445
 12446
 12447 3127-EDIT-LOAN-OFFICER.
 12448
 12449     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12450        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12451           MOVE ER-2690          TO WS-ERROR
 12452           PERFORM 9900-ERROR-FORMAT
 12453                                 THRU 9900-EXIT
 12454        ELSE
 12455           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12456           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12457           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12458           MOVE PB-SV-STATE      TO LOFC-STATE
 12459           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 227
* EL050.cbl
 12460           MOVE PB-I-LOAN-OFFICER
 12461                                 TO LOFC-CODE
 12462           PERFORM 8586-READ-LOAN-OFFICER
 12463                                 THRU 8586-EXIT
 12464           IF (NOT LOFC-MASTER-FOUND)
 12465              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12466              MOVE ER-3006       TO WS-ERROR
 12467              PERFORM 9900-ERROR-FORMAT
 12468                                 THRU 9900-EXIT
 12469           END-IF
 12470        END-IF
 12471     END-IF
 12472     .
 12473 3129-EDIT-APR.
 12474
 12475     IF (WS-LF-BENEFIT-CD = ZERO)
 12476        OR (NO-LF-BENEFIT-MATCH)
 12477        IF PB-COMPANY-ID NOT = 'DCC'
 12478           GO TO 3130-EDIT-AGE
 12479*       ELSE
 12480*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12481*             GO TO 3130-EDIT-AGE
 12482*          END-IF
 12483        END-IF
 12484     END-IF
 12485
 12486     IF (WS-STATE-ABBREVIATION = 'OH')
 12487         AND (PB-I-RATE-CLASS NOT = 'L ')
 12488         AND (PB-I-LF-TERM GREATER THAN 60)
 12489         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12490         GO TO 3129-APR-CONT.
 12491
 12492     IF (WS-STATE-ABBREVIATION = 'RI')
 12493         AND (PB-I-LF-TERM GREATER THAN 60)
 12494         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12495         GO TO 3129-APR-CONT.
 12496
 12497     IF (WS-STATE-ABBREVIATION = 'UT')
 12498         AND (PB-I-LF-TERM GREATER THAN 62)
 12499         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12500         AND (PB-CERT-EFF-DT LESS WS-830901)
 12501         GO TO 3129-APR-CONT.
 12502
 12503     IF PB-COMPANY-ID = 'LAP'
 12504        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12505           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12506              MOVE ER-2656         TO WS-ERROR
 12507              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12508              GO TO 3130-EDIT-AGE.
 12509
 12510     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12511        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12512        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12513        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12514        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 12515        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 12516         GO TO 3130-EDIT-AGE.
 12517
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 228
* EL050.cbl
 12518 3129-APR-CONT.
 12519     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12520         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12521         GO TO 3130-EDIT-AGE.
 12522
 12523     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 12524         WS-AH-BENEFIT-CD (1:1) = 'S')
 12525        AND (PB-COMPANY-ID = 'DCC')
 12526        AND (PB-I-LOAN-APR = ZERO)
 12527        MOVE ER-2657             TO WS-ERROR
 12528        PERFORM 9900-ERROR-FORMAT
 12529                                 THRU 9900-EXIT
 12530        GO TO 3130-EDIT-AGE
 12531     END-IF
 12532*    IF PB-I-LOAN-APR = ZERO
 12533*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12534*    END-IF
 12535
 12536     if pb-i-loan-apr = +99.9999
 12537        move er-2656             to ws-error
 12538        PERFORM 9900-ERROR-FORMAT
 12539                                 THRU 9900-EXIT
 12540        GO TO 3130-EDIT-AGE
 12541     end-if
 12542*    IF PB-I-LOAN-APR = ZERO
 12543*       MOVE ER-2656             TO WS-ERROR
 12544*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12545*       GO TO 3130-EDIT-AGE.
 12546
 12547*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12548     if pb-i-loan-apr not = +99.9999
 12549        IF PB-I-LOAN-APR > +30.000
 12550           MOVE ER-2657          TO WS-ERROR
 12551           PERFORM 9900-ERROR-FORMAT
 12552                                 THRU 9900-EXIT
 12553        end-if
 12554     end-if
 12555     .
 12556 3130-EDIT-AGE.
 12557
 12558******************************************************************
 12559*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12560******************************************************************
 12561
 12562     IF NOT NO-LIFE-COVERAGE
 12563        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12564           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12565               MOVE ER-2628             TO WS-ERROR
 12566               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12567
 12568     IF NOT NO-AH-COVERAGE
 12569        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12570           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12571               MOVE ER-2628         TO WS-ERROR
 12572               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12573
 12574 3133-SEX-CODE.
 12575     IF PB-I-INSURED-SEX = SPACE OR ZERO
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 229
* EL050.cbl
 12576         IF WS-DEFAULT-SEX = 'M'
 12577             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12578          ELSE
 12579             IF WS-DEFAULT-SEX = 'F'
 12580             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12581
 12582     IF PB-I-INSURED-SEX = '1'
 12583         MOVE 'M' TO PB-I-INSURED-SEX.
 12584
 12585     IF PB-I-INSURED-SEX = '2'
 12586         MOVE 'F' TO PB-I-INSURED-SEX.
 12587
 12588 3134-SIG-SW-EDIT.
 12589     IF PB-I-SIG-SW = SPACE
 12590         MOVE 'N'                TO  PB-I-SIG-SW.
 12591
 12592     IF PB-COMPANY-ID = 'NCL'
 12593         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12594             NEXT SENTENCE
 12595         ELSE
 12596             MOVE ER-1923        TO  WS-ERROR
 12597             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12598     ELSE
 12599     IF PB-COMPANY-ID = 'CRI'
 12600         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12601             NEXT SENTENCE
 12602         ELSE
 12603             MOVE ER-2606        TO  WS-ERROR
 12604             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12605     ELSE
 12606     IF PB-COMPANY-ID = 'TMS'
 12607         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12608             NEXT SENTENCE
 12609         ELSE
 12610             MOVE ER-2689        TO  WS-ERROR
 12611             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12612     ELSE
 12613         IF PB-I-SIG-SW = 'Y' OR 'N'
 12614             NEXT SENTENCE
 12615         ELSE
 12616             MOVE ER-2651        TO  WS-ERROR
 12617             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12618
 12619     IF PB-COMPANY-ID = 'FLA'
 12620         IF (WS-EDIT-AGE GREATER 54  OR
 12621             WS-AH-EDIT-AGE GREATER 54)  AND
 12622            PB-I-SIG-SW = 'N'
 12623            MOVE ER-2651         TO  WS-ERROR
 12624            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12625
 12626 3135-NAME-EDIT.
 12627
 12628     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12629        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12630        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12631           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12632                                 TO PB-I-JOINT-FIRST-NAME
 12633        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 230
* EL050.cbl
 12634     END-IF
 12635     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12636        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12637        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12638           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12639                                 TO PB-I-JOINT-LAST-NAME
 12640        END-PERFORM
 12641     END-IF
 12642     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12643        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12644        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12645           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12646                                 TO PB-I-INSURED-FIRST-NAME
 12647        END-PERFORM
 12648     END-IF
 12649     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12650        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12651        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12652           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12653                                 TO PB-I-INSURED-LAST-NAME
 12654        END-PERFORM
 12655     END-IF
 12656     IF PB-I-INSURED-LAST-NAME = SPACES
 12657       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12658       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12659           MOVE ER-2660    TO WS-ERROR
 12660           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12661
 12662 3136-EDIT-SEX.
 12663
 12664******************************************************************
 12665*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12666******************************************************************
 12667
 12668     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12669        (WS-AH-SPECIAL-CALC-CD = 'O')
 12670        NEXT SENTENCE
 12671     ELSE
 12672        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12673           NEXT SENTENCE
 12674        ELSE
 12675           MOVE ER-2629            TO WS-ERROR
 12676           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12677
 12678 3137-EDIT-EFF-DATE.
 12679
 12680     IF PB-REISSUED-CERT       OR
 12681        PB-POLICY-IS-DECLINED  OR
 12682        PB-POLICY-IS-VOIDED
 12683         GO TO 3139-EDIT-COVERAGE-CODES.
 12684
 12685     MOVE SPACE                  TO WS-2671-SW
 12686                                    WS-2672-SW.
 12687
 12688     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12689         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12690             MOVE ER-2703        TO WS-ERROR
 12691             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 231
* EL050.cbl
 12692             GO TO 3139-EDIT-COVERAGE-CODES.
 12693
 12694     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12695         GO TO 3139-EDIT-COVERAGE-CODES.
 12696
 12697     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12698     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12699*    MOVE '1'                    TO DC-OPTION-CODE.
 12700     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12701     MOVE +0                     TO DC-ELAPSED-MONTHS
 12702                                    DC-ELAPSED-DAYS.
 12703     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12704
 12705     IF DATE-CONVERSION-ERROR
 12706         GO TO 3139-EDIT-COVERAGE-CODES.
 12707
 12708     IF DC-ELAPSED-DAYS GREATER +180
 12709         MOVE ER-2672            TO WS-ERROR
 12710         MOVE 'Y'                TO WS-2672-SW
 12711         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12712     END-IF
 12713
 12714     IF WS-ERROR = ER-2671  AND
 12715        PB-COMPANY-ID  = 'LBL'
 12716        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12717        MOVE SPACE               TO WS-2671-SW
 12718        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12719
 12720     IF PB-ISSUE-DATE-FORCED  AND
 12721      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12722         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12723         MOVE ER-2673            TO WS-ERROR
 12724         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12725         MOVE SPACE              TO WS-2671-SW
 12726                                    WS-2672-SW.
 12727
 12728     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12729         IF PB-ISSUE-DATE-FORCED
 12730             MOVE ER-2600          TO  WS-ERROR
 12731             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12732         ELSE
 12733             MOVE ER-2692          TO  WS-ERROR
 12734             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12735
 12736
 12737 3139-EDIT-COVERAGE-CODES.
 12738
 12739     if pb-company-id not = 'AHL'
 12740        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12741           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12742           MOVE ER-2787          TO WS-ERROR
 12743           PERFORM 9900-ERROR-FORMAT
 12744                                 THRU 9900-EXIT
 12745        END-IF
 12746     end-if
 12747     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12748        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12749                                 > 250000.00
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 232
* EL050.cbl
 12750           MOVE ER-2719          TO WS-ERROR
 12751           PERFORM 9900-ERROR-FORMAT
 12752                                 THRU 9900-EXIT
 12753        END-IF
 12754     END-IF
 12755
 12756     IF PB-POLICY-IS-DECLINED  OR
 12757        PB-POLICY-IS-VOIDED
 12758         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12759
 12760     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12761        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12762         MOVE ER-2630                TO WS-ERROR
 12763         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12764
 12765     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12766        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12767        PB-I-LF-PREMIUM-AMT = ZERO
 12768         GO TO 3140-CHECK-AH-FOR-ZERO.
 12769
 12770     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12771        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12772        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12773         GO TO 3140-CHECK-AH-FOR-ZERO.
 12774
 12775     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12776        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12777        MOVE ER-2631             TO WS-ERROR
 12778        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12779     END-IF
 12780
 12781
 12782******************************************************************
 12783*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12784******************************************************************
 12785
 12786     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12787        NEXT SENTENCE
 12788     ELSE
 12789        IF PB-I-LF-BENEFIT-AMT = ZERO
 12790           MOVE ER-2632             TO WS-ERROR
 12791           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12792
 12793
 12794******************************************************************
 12795*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12796******************************************************************
 12797
 12798     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12799        CONTINUE
 12800     ELSE
 12801        IF PB-I-LF-PREMIUM-AMT = ZERO
 12802           IF (NOT PB-COMP-LF-PREM)
 12803              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12804              MOVE ER-2633       TO WS-ERROR
 12805              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12806           END-IF
 12807        END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 233
* EL050.cbl
 12808     END-IF
 12809     .
 12810 3140-CHECK-AH-FOR-ZERO.
 12811
 12812     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12813        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12814        PB-I-AH-PREMIUM-AMT = ZERO
 12815         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12816
 12817     IF PB-COMPANY-ID = 'CSL'  AND
 12818        PB-I-AH-BENEFIT-CD = ZERO  AND
 12819        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12820        PB-I-AH-PREMIUM-AMT = ZERO
 12821         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12822
 12823     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12824        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12825        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12826         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12827
 12828     IF PB-I-AH-BENEFIT-CD = ZERO
 12829         MOVE ER-2634            TO WS-ERROR
 12830         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12831
 12832******************************************************************
 12833*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12834******************************************************************
 12835
 12836     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12837        NEXT SENTENCE
 12838     ELSE
 12839        IF PB-I-AH-BENEFIT-AMT = ZERO
 12840           MOVE ER-2635             TO WS-ERROR
 12841           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12842
 12843******************************************************************
 12844*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12845******************************************************************
 12846
 12847     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12848        NEXT SENTENCE
 12849     ELSE
 12850        IF PB-I-AH-PREMIUM-AMT = ZERO
 12851            IF NOT PB-COMP-AH-PREM
 12852                MOVE ER-2636    TO WS-ERROR
 12853                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12854
 12855
 12856 3140-EDIT-MAX-AMT-SIZES.
 12857* CUSTOM CODE FOR CLIENT    'DMD'
 12858     MOVE ZEROS                   TO WS-RES-STATE-TAX
 12859                                     WS-RES-MUNI-TAX
 12860                                     PB-I-STATE-TAX
 12861                                     PB-I-MUNI-TAX.
 12862
 12863     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 12864
 12865     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 234
* EL050.cbl
 12866        GO TO 3150-RATE-OUTSTAND-BAL.
 12867
 12868     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 12869        GO TO 3150-RATE-OUTSTAND-BAL.
 12870
 12871     IF WS-LF-EARNINGS-CALC EQUAL '5'
 12872        GO TO 3150-RATE-OUTSTAND-BAL.
 12873
 12874     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 12875                             OR 'RIC')
 12876        GO TO 3150-RATE-OUTSTAND-BAL.
 12877
 12878     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 12879        IF PB-I-LOAN-APR GREATER THAN ZEROS
 12880            GO TO 3150-RATE-OUTSTAND-BAL
 12881        ELSE
 12882           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 12883               GO TO 3150-RATE-OUTSTAND-BAL.
 12884
 12885     IF NOT PB-NO-MONTHS-SKIPPED
 12886        GO TO 3150-RATE-OUTSTAND-BAL.
 12887
 12888     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 12889        GO TO 3150-RATE-OUTSTAND-BAL.
 12890
 12891     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 12892        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 12893           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 12894             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12895           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 12896           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 12897              MOVE ER-2693     TO WS-ERROR
 12898              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12899              GO TO 3150-RATE-OUTSTAND-BAL
 12900           ELSE
 12901              GO TO 3150-RATE-OUTSTAND-BAL.
 12902
 12903 3150-RATE-OUTSTAND-BAL.
 12904
 12905* DMD RATING TEST
 12906     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 12907         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12908         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12909         MOVE ER-2687                 TO WS-ERROR
 12910         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12911         MOVE 'B'                     TO PB-I-OB-FLAG
 12912         GO TO 3260-EDIT-CONTINUE.
 12913
 12914     IF  PB-COMPANY-ID   EQUAL    'CRI'
 12915         IF  WS-ERROR    EQUAL    ER-2693
 12916             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 12917                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12918                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12919                 MOVE  +0            TO  WS-ERROR.
 12920
 12921     IF  PB-COMPANY-ID   EQUAL    'CDL'
 12922         IF  WS-ERROR    EQUAL    ER-2693
 12923             IF WS-STATE-ABBREVIATION EQUAL 'NC'
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 235
* EL050.cbl
 12924                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12925                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12926                 MOVE  +0            TO  WS-ERROR.
 12927
 12928     IF PLAN-MASTER-AH-SW = 'Y'
 12929        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12930            IF  WS-ERROR    EQUAL    ER-2693
 12931              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12932                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12933                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12934                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12935                 MOVE  ER-1910           TO  WS-ERROR
 12936                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12937
 12938     IF PLAN-MASTER-AH-SW = 'Y'
 12939        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12940            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12941               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12942               MOVE  ER-1910           TO  WS-ERROR
 12943               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12944
 12945     IF PLAN-MASTER-AH-SW = 'Y'
 12946        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12947            IF  WS-ERROR    EQUAL    ER-2693
 12948                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 12949                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12950                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12951                 MOVE  +0       TO  WS-ERROR.
 12952
 12953     IF WS-ERROR = ER-2693
 12954        IF PB-COMPANY-ID = 'JAL' AND
 12955           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 12956           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12957           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12958
 12959     IF WS-ERROR = ER-2693
 12960        IF PB-COMPANY-ID = 'NCL'  AND
 12961           PB-I-AH-BENEFIT-CD = 'OA'
 12962           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12963           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12964
 12965     IF WS-ERROR = ER-2693
 12966        IF PB-COMPANY-ID = 'CNL' AND
 12967           PB-I-LF-BENEFIT-CD = '71' OR '72'
 12968           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12969           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12970
 12971     IF WS-ERROR = ER-2693
 12972        IF PB-COMPANY-ID = 'HER'
 12973           IF WS-LEVEL
 12974              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12975              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12976
 12977     IF ((LF-BENEFIT-FOUND) AND
 12978         (NOT NO-LIFE-COVERAGE)  AND
 12979         (WS-LF-SPECIAL-CALC-CD = 'O'))
 12980       OR   ((AH-BENEFIT-FOUND) AND
 12981             (NOT NO-AH-COVERAGE)    AND
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 236
* EL050.cbl
 12982             (WS-AH-SPECIAL-CALC-CD = 'O'))
 12983         NEXT SENTENCE
 12984     ELSE
 12985         GO TO 3215-EDIT-RATES.
 12986
 12987     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12988        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12989           MOVE ER-2674          TO WS-ERROR
 12990           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12991           GO TO 3215-EDIT-RATES.
 12992
 12993     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12994        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12995           MOVE ER-2674          TO WS-ERROR
 12996           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12997           GO TO 3215-EDIT-RATES.
 12998
 12999     MOVE 'B'                    TO PB-I-OB-FLAG.
 13000
 13001     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13002         NEXT SENTENCE
 13003     ELSE
 13004         IF NOT NO-LIFE-COVERAGE
 13005             IF WS-ACCT-LF-OB-RT = ZERO
 13006                MOVE ER-2641    TO WS-ERROR
 13007                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13008
 13009     IF PB-COMPANY-ID = 'CRI'
 13010       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13011         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13012         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13013         IF WS-ERROR = ER-2675
 13014            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13015            MOVE ER-2687              TO WS-ERROR
 13016            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13017         ELSE
 13018            MOVE ER-2687              TO WS-ERROR
 13019            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13020
 13021
 13022     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13023         NEXT SENTENCE
 13024     ELSE
 13025       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13026            NEXT SENTENCE
 13027       ELSE
 13028         IF NOT NO-AH-COVERAGE
 13029             IF WS-ACCT-AH-OB-RT = ZERO
 13030                MOVE ER-2642    TO WS-ERROR
 13031                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13032
 13033     IF PB-COMPANY-ID = 'CRI'
 13034       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13035         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13036         IF WS-ERROR = ER-2676
 13037            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13038            MOVE ER-2687              TO WS-ERROR
 13039            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 237
* EL050.cbl
 13040         ELSE
 13041            MOVE ER-2687              TO WS-ERROR
 13042            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13043
 13044     IF PB-COMPANY-ID NOT = 'GIC'
 13045         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13046            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13047     ELSE
 13048         IF PB-I-LF-PREM-CALC = ZEROS
 13049             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13050                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13051
 13052     IF PB-COMPANY-ID NOT = 'GIC'
 13053         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13054            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13055     ELSE
 13056         IF PB-I-AH-PREM-CALC = ZEROS
 13057             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13058                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13059
 13060     MOVE ZEROS TO PB-I-MORT-CODE.
 13061
 13062     GO TO 3260-EDIT-CONTINUE.
 13063
 13064
 13065 3215-EDIT-RATES.
 13066     IF ACCOUNT-MAST-FOUND
 13067         NEXT SENTENCE
 13068     ELSE
 13069         GO TO 3999-END-EDIT.
 13070
 13071 3220-CHECK-LF-RATES.
 13072
 13073     IF PB-COMPANY-ID = 'DCC'
 13074        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13075        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13076        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13077           AND (NOT WS-LF-CASH))
 13078                           OR
 13079           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13080           AND (NOT WS-AH-CASH)))
 13081                       AND
 13082           (PB-I-ENTRY-STATUS NOT = '5')
 13083           MOVE 'M'              TO PB-BATCH-ENTRY
 13084                                    PB-I-ENTRY-STATUS
 13085        END-IF
 13086     END-IF
 13087     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13088                                    PB-I-AH-PREM-CALC
 13089                                    PB-I-LF-ALT-PREM-CALC
 13090                                    PB-I-LF-ALT-RATE
 13091                                    PB-I-LF-REI-RATE
 13092                                    PB-I-LF-ALT-REI-RATE
 13093                                    PB-I-AH-REI-RATE
 13094                                    PB-I-TOT-FEES-CALC.
 13095
 13096     IF PB-COMPANY-ID EQUAL 'DMD'
 13097        NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 238
* EL050.cbl
 13098     ELSE
 13099        MOVE ZEROS               TO PB-I-LF-RATE
 13100                                    PB-I-AH-RATE.
 13101
 13102     IF PB-I-TOT-FEES NOT NUMERIC
 13103        MOVE ZEROS               TO PB-I-TOT-FEES
 13104     END-IF
 13105     IF PB-I-LIVES NOT NUMERIC
 13106         MOVE ZERO               TO PB-I-LIVES.
 13107
 13108     IF PB-I-NUM-BILLED NOT NUMERIC
 13109         MOVE ZERO               TO PB-I-NUM-BILLED.
 13110
 13111     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13112        MOVE +0                  TO PB-I-LF-PREM-TAX
 13113     END-IF
 13114
 13115     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13116        MOVE +0                  TO PB-I-AH-PREM-TAX
 13117     END-IF
 13118
 13119     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13120        PB-I-PAY-FREQUENCY = ZEROS
 13121            MOVE 12 TO CP-PAY-FREQUENCY
 13122     ELSE
 13123            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13124
 13125     IF PB-I-STATE-TAX NOT NUMERIC
 13126         MOVE ZEROS               TO PB-I-STATE-TAX.
 13127
 13128     IF PB-I-MUNI-TAX NOT NUMERIC
 13129         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13130
 13131     MOVE SPACES                 TO CP-BEN-CATEGORY
 13132     IF PB-COMPANY-ID  = 'CSL'  AND
 13133        PB-I-LF-TERM NOT = ZERO
 13134        COMPUTE WS-PAYMENT-AMT =
 13135             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13136        COMPUTE WS-CSL-AMT1 =
 13137             PB-I-LF-TERM * AM-MAX-MON-BEN
 13138        COMPUTE WS-CSL-AMT2 =
 13139             WS-PAYMENT-AMT * PB-I-LF-TERM
 13140        IF CP-PAY-FREQUENCY NOT = 12
 13141           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13142           MOVE '8' TO WS-CSL-CALC-CD
 13143        ELSE
 13144           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13145              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13146               AM-MAX-TOT-BEN
 13147               MOVE '6' TO WS-CSL-CALC-CD
 13148           ELSE
 13149              IF (WS-CSL-AMT1  GREATER THAN
 13150                 AM-MAX-TOT-BEN) AND
 13151                 (WS-CSL-AMT2  GREATER THAN
 13152                 AM-MAX-TOT-BEN)
 13153                 MOVE '7' TO WS-CSL-CALC-CD
 13154              ELSE
 13155                 MOVE '5' TO WS-CSL-CALC-CD.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 239
* EL050.cbl
 13156
 13157     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13158         NEXT SENTENCE
 13159     ELSE
 13160         GO TO 3300-CHECK-AH-RATES.
 13161
 13162*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13163
 13164     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13165        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13166              OR
 13167           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13168           MOVE ER-2618          TO WS-ERROR
 13169           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13170           GO TO 3300-CHECK-AH-RATES.
 13171
 13172     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13173           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13174                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13175
 13176     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13177         MOVE ER-2687             TO WS-ERROR
 13178         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13179         MOVE 'Z000'              TO PB-I-MORT-CODE
 13180         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13181         GO TO 3300-CHECK-AH-RATES.
 13182
 13183     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13184        IF PB-I-LIVES = ZERO
 13185           MOVE ER-2688          TO WS-ERROR
 13186           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13187
 13188     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13189
 13190     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13191     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13192     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13193     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13194     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13195     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13196     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13197     MOVE '3'                    TO CP-PROCESS-TYPE.
 13198     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13199     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13200
 13201******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13202     IF PB-COMPANY-ID EQUAL 'CDL'
 13203         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13204            CP-EARN-AS-NET-PAY)
 13205             IF PB-CERT-EFF-DT GREATER  WS-931231
 13206                 MOVE '1'        TO CP-EARNING-METHOD.
 13207*******
 13208
 13209     MOVE PB-SV-STATE            TO CP-STATE.
 13210     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13211     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13212     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 13213     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 240
* EL050.cbl
 13214     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13215                                    CP-RATING-BENEFIT-AMT.
 13216     IF CP-STATE-STD-ABBRV = 'OR'
 13217         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13218                                         PB-I-LF-ALT-BENEFIT-AMT.
 13219     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13220     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13221     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13222     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13223     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13224     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13225     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13226     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13227     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13228                                    CP-REMAINING-TERM
 13229                                    CP-LOAN-TERM.
 13230
 13231     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13232         NEXT SENTENCE
 13233     ELSE
 13234         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13235             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13236                                           PB-I-LF-PREMIUM-AMT.
 13237
 13238     IF PB-COMPANY-ID EQUAL 'CSL'
 13239        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13240           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13241                                         PB-I-LF-PREMIUM-AMT.
 13242
 13243     IF PB-COMPANY-ID EQUAL 'NCB'
 13244         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13245            CP-EARN-AS-NET-PAY
 13246             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13247                 PB-I-LF-PREMIUM-AMT.
 13248
 13249     IF (CP-TRUNCATED-LIFE)
 13250        or ((pb-company-id = 'AHL')
 13251           and (pb-i-loan-term > pb-i-lf-term))
 13252        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13253
 13254     IF PB-COMPANY-ID EQUAL 'CRI'
 13255        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13256
 13257     IF CP-TERM-IS-DAYS
 13258         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13259     ELSE
 13260         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13261     IF PB-COMPANY-ID = 'DCC'
 13262        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13263        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13264        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13265        IF WS-LF-BEN-CATEGORY = 'D'
 13266           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13267           MOVE PB-I-LIFE-COMMISSION
 13268                                 TO CP-DCC-ACT-COMM
 13269           MOVE WS-LF-BEN-CATEGORY
 13270                                 TO CP-BEN-CATEGORY
 13271        END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 241
* EL050.cbl
 13272        IF (CP-BENEFIT-CD (1:1) = 'P')
 13273           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13274           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13275           add pb-i-ah-premium-amt to cp-original-premium
 13276        END-IF
 13277     END-IF
 13278     IF PB-COMPANY-ID = 'CSL'
 13279         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13280         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13281         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13282
 13283     IF PB-COMPANY-ID = 'CSL'
 13284        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13285
 13286     IF (CP-SPECIAL-CALC-CD = 'H')
 13287        OR (PB-COMPANY-ID = 'DCC')
 13288         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13289                                    TO CP-ALTERNATE-BENEFIT
 13290         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13291
 13292     IF (PB-COMPANY-ID = 'CID')
 13293        AND (WS-LF-EARNINGS-CALC = 'B')
 13294        AND (CP-STATE-STD-ABBRV = 'MN')
 13295        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13296                                 TO CP-ALTERNATE-BENEFIT
 13297        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13298     END-IF
 13299     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13300     MOVE 'R'                   TO CP-RATE-FILE.
 13301     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13302
 13303     IF CP-ERROR-RATE-NOT-FOUND
 13304        MOVE ER-2641            TO WS-ERROR
 13305        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13306        GO TO 3300-CHECK-AH-RATES.
 13307
 13308     IF PB-COMPANY-ID EQUAL 'CRI'
 13309        IF CP-ERROR-NO-LIMITS-CRI
 13310           IF NOT ACCOUNT-LIFE-CHECKED
 13311              MOVE ER-2607      TO WS-ERROR
 13312              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13313
 13314******************************************************************
 13315*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13316*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13317******************************************************************
 13318
 13319* CALC LIFE AGE AT EXPIRATION.
 13320
 13321     COMPUTE WS-AGE-AT-EXPIRE =
 13322          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13323
 13324*    IF PB-STATE = 'CO' OR 'UT'
 13325*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13326*        MOVE 'F'            TO PB-FATAL-FLAG
 13327*        MOVE ER-2709        TO WS-ERROR
 13328*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13329*        GO TO PREMIUM-EDITING-IS-BYPASSED.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 242
* EL050.cbl
 13330
 13331*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13332*        MOVE 'X'            TO PB-FATAL-FLAG
 13333*        MOVE ER-2718        TO WS-ERROR
 13334*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13335*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13336
 13337* CALC A & H AGE AT EXPIRATION.
 13338
 13339     COMPUTE WS-AGE-AT-EXPIRE =
 13340          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13341
 13342*    IF PB-STATE = 'CO' OR 'UT'
 13343*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13344*        MOVE 'F'            TO PB-FATAL-FLAG
 13345*        MOVE ER-2709        TO WS-ERROR
 13346*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13347*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13348
 13349*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13350*        MOVE 'X'            TO PB-FATAL-FLAG
 13351*        MOVE ER-2718        TO WS-ERROR
 13352*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13353*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13354
 13355     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13356        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13357
 13358     IF WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z'
 13359        GO TO 3221-CHECK-ERROR-RATE-OPEN
 13360     end-if
 13361
 13362     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13363        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13364
 13365     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13366         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13367         MOVE ER-2639        TO WS-ERROR
 13368         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13369
 13370
 13371******************************************************************
 13372*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13373******************************************************************
 13374
 13375 PREMIUM-EDITING-IS-BYPASSED.
 13376     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13377        AND (CP-R-MAX-ATT-AGE > +0)
 13378        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13379        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13380           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13381           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13382           MOVE '1'              TO DC-OPTION-CODE
 13383           PERFORM 8500-DATE-CONVERT
 13384                                 THRU 8500-EXIT
 13385           IF NO-CONVERSION-ERROR
 13386              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13387                 MOVE ER-2661       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 243
* EL050.cbl
 13388*                PERFORM 9900-ERROR-FORMAT
 13389*                                THRU 9900-EXIT
 13390              END-IF
 13391           END-IF
 13392        ELSE
 13393           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13394           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13395              MOVE ER-2661       TO WS-ERROR
 13396*             PERFORM 9900-ERROR-FORMAT
 13397*                                THRU 9900-EXIT
 13398           ELSE
 13399              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13400                 MOVE ER-1570    TO WS-ERROR
 13401                 PERFORM 9900-ERROR-FORMAT
 13402                                 THRU 9900-EXIT
 13403              END-IF
 13404           END-IF
 13405        END-IF
 13406        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13407           MOVE PB-I-JOINT-BIRTHDAY
 13408                                 TO DC-BIN-DATE-1
 13409           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13410           MOVE '1'              TO DC-OPTION-CODE
 13411           PERFORM 8500-DATE-CONVERT
 13412                                 THRU 8500-EXIT
 13413           IF NO-CONVERSION-ERROR
 13414              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13415                 MOVE ER-2661       TO WS-ERROR
 13416*                PERFORM 9900-ERROR-FORMAT
 13417*                                THRU 9900-EXIT
 13418              END-IF
 13419           ELSE
 13420              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13421           END-IF
 13422        ELSE
 13423           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13424             (PB-I-LF-TERM / 12)
 13425           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13426              MOVE ER-2661       TO WS-ERROR
 13427*             PERFORM 9900-ERROR-FORMAT
 13428*                                THRU 9900-EXIT
 13429           ELSE
 13430              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13431                 MOVE ER-1571    TO WS-ERROR
 13432                 PERFORM 9900-ERROR-FORMAT
 13433                                 THRU 9900-EXIT
 13434              END-IF
 13435           END-IF
 13436        END-IF
 13437        IF WS-ERROR = ER-2661
 13438           PERFORM 9900-ERROR-FORMAT
 13439                                 THRU 9900-EXIT
 13440        END-IF
 13441     END-IF
 13442*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13443*       MOVE ER-2661             TO WS-ERROR
 13444*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13445
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 244
* EL050.cbl
 13446     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13447        MOVE ER-2662             TO WS-ERROR
 13448        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13449
 13450     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13451        MOVE ER-2677             TO WS-ERROR
 13452        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13453
 13454     IF CP-ERROR-LOAN-TERM
 13455        MOVE ER-2648             TO WS-ERROR
 13456        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13457
 13458 3221-CHECK-ERROR-RATE-OPEN.
 13459
 13460     IF CP-ERROR-RATE-FILE-NOTOPEN
 13461         GO TO 3990-FILES-NOT-OPEN.
 13462
 13463     IF PB-COMPANY-ID NOT = 'DMD'
 13464        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13465     END-IF
 13466     .
 13467 3221-CONTINUE.
 13468     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13469                                    WS-DCC-AH-RATE
 13470     IF PB-COMPANY-ID = 'DCC'
 13471        IF WS-LF-BEN-CATEGORY = 'D'
 13472           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13473              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13474        END-IF
 13475     END-IF
 13476     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13477*   X'A4FF' = 12/31/2009
 13478     IF (PB-COMPANY-ID = 'CID')
 13479        AND (WS-LF-EARNINGS-CALC = 'B')
 13480        AND (CP-STATE-STD-ABBRV = 'MN')
 13481        AND (PB-CERT-EFF-DT > X'A4FF')
 13482        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13483     END-IF
 13484     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.
 13485
 13486     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13487     IF (PB-COMPANY-ID = 'DCC')
 13488        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13489        AND (PB-I-POLICY-IS-MONTHLY)
 13490        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13491        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13492     END-IF
 13493     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13494     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13495     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13496     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13497     IF (PB-COMPANY-ID = 'DCC')
 13498        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13499        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13500        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13501        MOVE ER-2786             TO WS-ERROR
 13502        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13503     END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 245
* EL050.cbl
 13504
 13505     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13506
 13507******************************************************************
 13508*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13509******************************************************************
 13510     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13511        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13512
 13513     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13514        GO TO 3225-CHECK-ALT-LIFE-RATE
 13515     ELSE
 13516       IF PB-I-LF-RATE = ZERO
 13517          MOVE ER-2641          TO WS-ERROR
 13518          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13519
 13520 3225-CHECK-ALT-LIFE-RATE.
 13521
 13522     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13523        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13524        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13525         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13526
 13527     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13528         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13529             AND PB-COMPANY-ID NOT = 'DCC')
 13530                   OR
 13531              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13532              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13533              AND PB-COMPANY-ID NOT = 'DCC')
 13534             MOVE ER-2720        TO  WS-ERROR
 13535             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13536             GO TO 3225-RATING-CONT
 13537         ELSE
 13538             GO TO 3225-RATING-CONT.
 13539     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13540        AND (AM-GPCD = 01 OR 06 OR 15)
 13541        MOVE ER-2798             TO WS-ERROR
 13542        PERFORM 9900-ERROR-FORMAT
 13543                                 THRU 9900-EXIT
 13544*       GO TO 3225-RATING-CONT
 13545     END-IF
 13546     IF (PB-COMPANY-ID = 'CID')
 13547        AND (WS-LF-EARNINGS-CALC = 'B')
 13548        AND (CP-STATE-STD-ABBRV = 'MN')
 13549        AND (PB-CERT-EFF-DT > X'A4FF')
 13550        GO TO 3225-RATING-CONT
 13551     END-IF
 13552     IF PB-COMPANY-ID = 'DCC'
 13553        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13554           AND (PB-I-POLICY-IS-MONTHLY)
 13555           GO TO 3225-RATING-CONT
 13556        END-IF
 13557     END-IF
 13558
 13559     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13560        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13561        CP-EARN-AS-REG-BALLOON
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 246
* EL050.cbl
 13562        NEXT SENTENCE
 13563     ELSE
 13564        MOVE '2'                 TO CP-EARNING-METHOD.
 13565
 13566 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13567
 13568     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13569
 13570     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13571        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13572        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13573         NEXT SENTENCE
 13574     ELSE
 13575         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13576
 13577     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13578     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13579     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13580                                     CP-RATING-BENEFIT-AMT.
 13581     IF CP-STATE-STD-ABBRV = 'OR'
 13582         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13583                                         PB-I-LF-ALT-BENEFIT-AMT.
 13584     IF PB-COMPANY-ID = 'DCC'
 13585        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13586     END-IF
 13587     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13588     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13589     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13590                                    CP-REMAINING-TERM
 13591                                    CP-LOAN-TERM.
 13592     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13593        ADD +1                   TO CP-ORIGINAL-TERM
 13594                                    CP-REMAINING-TERM
 13595                                    CP-LOAN-TERM.
 13596
 13597     MOVE 'R'                   TO CP-RATE-FILE.
 13598     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13599
 13600     IF CP-ERROR-RATE-NOT-FOUND
 13601         MOVE ER-2641            TO WS-ERROR
 13602         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13603         GO TO 3300-CHECK-AH-RATES.
 13604
 13605     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13606     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13607
 13608     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13609         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13610
 13611     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13612                               + PB-I-LF-ALT-BENEFIT-AMT.
 13613
 13614     IF ACCOUNT-LIFE-CHECKED  OR
 13615        PB-POLICY-IS-VOIDED   OR
 13616        (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13617        GO TO 3225-CONTINUE.
 13618
 13619     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 247
* EL050.cbl
 13620        GO TO 3225-CONTINUE.
 13621
 13622     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13623                             EC-RT-LF-MAX-TOT-BEN
 13624        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13625        MOVE ER-2639       TO WS-ERROR
 13626        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13627
 13628 3225-CONTINUE.
 13629     IF PB-I-LF-ALT-RATE = ZERO
 13630         MOVE ER-2659            TO WS-ERROR
 13631         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13632
 13633     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13634        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13635        MOVE ER-2698             TO WS-ERROR
 13636        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13637
 13638 3225-RATING-CONT.
 13639
 13640     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13641         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13642         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13643         IF (PB-COMPANY-ID = 'DCC')
 13644            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13645            CONTINUE
 13646         ELSE
 13647            MOVE ER-2687         TO WS-ERROR
 13648            PERFORM 9900-ERROR-FORMAT
 13649                                 THRU 9900-EXIT
 13650         END-IF
 13651         GO TO 3290-EDIT-LF-REIN-RATE
 13652     END-IF
 13653
 13654* DMD RATING TEST
 13655     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13656         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13657         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13658         MOVE ER-2687                 TO WS-ERROR
 13659         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13660         GO TO 3290-EDIT-LF-REIN-RATE.
 13661
 13662 3230-CLIENT-MORT-CD-SPECIALS.
 13663
 13664     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13665     SET BIN-TO-GREG          TO TRUE.
 13666*    MOVE ' '                 TO DC-OPTION-CODE.
 13667     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13668     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13669
 13670 C-POS-3230-MORT-CD.
 13671     IF PB-COMPANY-ID = 'POS' AND
 13672        PB-SV-CARRIER = '2'
 13673         NEXT SENTENCE
 13674     ELSE
 13675         GO TO C-POS-3240-MORT-CD.
 13676
 13677     IF PB-SV-GROUPING = '030'
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 248
* EL050.cbl
 13678        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13679         MOVE '2350' TO PB-I-MORT-CODE
 13680      ELSE
 13681         MOVE '3300' TO PB-I-MORT-CODE.
 13682
 13683
 13684 C-POS-3240-MORT-CD.
 13685     IF PB-COMPANY-ID = 'POS' AND
 13686        PB-SV-CARRIER = '1'
 13687         NEXT SENTENCE
 13688     ELSE
 13689         GO TO 3230-CONTINUE.
 13690
 13691     IF PB-SV-STATE = '45' OR '47'
 13692        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13693         MOVE '5200' TO PB-I-MORT-CODE
 13694     ELSE
 13695         MOVE '8300' TO PB-I-MORT-CODE.
 13696
 13697 3230-CONTINUE.
 13698
 13699     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13700        GO TO 3240-CONTINUE
 13701     END-IF
 13702
 13703     IF PB-CERT-EFF-DT > WS-971231
 13704        GO TO 3240-CONTINUE
 13705     END-IF
 13706
 13707     IF LF-BENEFIT-FOUND AND
 13708        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13709         MOVE 'F250'       TO PB-I-MORT-CODE
 13710     ELSE
 13711         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13712             MOVE '7250'   TO PB-I-MORT-CODE
 13713         ELSE
 13714             MOVE '4251'   TO PB-I-MORT-CODE
 13715         END-IF
 13716     END-IF
 13717
 13718     .
 13719 3240-CONTINUE.
 13720
 13721     IF PB-COMPANY-ID NOT = 'GNL'
 13722         GO TO 3256-CONTINUE.
 13723
 13724     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13725         MOVE 'A300' TO PB-I-MORT-CODE
 13726     ELSE
 13727         MOVE '8350' TO PB-I-MORT-CODE.
 13728
 13729 3256-CONTINUE.
 13730     IF PB-COMPANY-ID NOT = 'ABL'
 13731         GO TO 3260-EDIT-CONTINUE.
 13732
 13733     IF PB-I-LF-TERM GREATER THAN 59
 13734         MOVE 'F550' TO PB-I-MORT-CODE
 13735     ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 249
* EL050.cbl
 13736         MOVE 'E550' TO PB-I-MORT-CODE.
 13737
 13738 3260-EDIT-CONTINUE.
 13739     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13740
 13741 3290-EDIT-LF-REIN-RATE.
 13742     IF LF-REIN-NSP-NOT-USED
 13743         GO TO 3290-RATING-CONT.
 13744
 13745     IF PB-COMPANY-ID = 'DCC'
 13746        GO TO 3290-RATING-CONT.
 13747     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13748     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13749     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13750     MOVE '3'                   TO CP-PROCESS-TYPE.
 13751     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13752
 13753******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13754     IF PB-COMPANY-ID EQUAL 'CDL'
 13755         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13756            CP-EARN-AS-NET-PAY)
 13757             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13758*            MOVE SPACE          TO DC-OPTION-CODE
 13759             SET BIN-TO-GREG     TO TRUE
 13760             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13761***  Y2K PROJ 7744
 13762             IF DC-GREG-DATE-CYMD GREATER 19931231
 13763                 MOVE '1'        TO CP-EARNING-METHOD.
 13764***  Y2K PROJ 7744
 13765*******
 13766
 13767     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13768     MOVE PB-SV-STATE           TO CP-STATE.
 13769     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13770     MOVE ZERO                  TO CP-DEVIATION-CODE
 13771                                   CP-RATE-DEV-PCT.
 13772     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13773     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13774                                   CP-RATING-BENEFIT-AMT.
 13775
 13776************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13777     IF PB-COMPANY-ID EQUAL 'NCB'
 13778         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13779            CP-EARN-AS-NET-PAY
 13780             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13781                 PB-I-LF-PREMIUM-AMT.
 13782************
 13783
 13784     IF CP-STATE-STD-ABBRV = 'OR'
 13785         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13786                                         PB-I-LF-ALT-BENEFIT-AMT.
 13787     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13788     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13789     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13790     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13791     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13792     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13793     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 250
* EL050.cbl
 13794     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13795                                   CP-REMAINING-TERM
 13796                                   CP-LOAN-TERM.
 13797     IF CP-TRUNCATED-LIFE
 13798        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13799
 13800     IF CP-TERM-IS-DAYS
 13801         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13802     ELSE
 13803         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13804
 13805     IF PB-COMPANY-ID = 'DCC'
 13806        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13807     END-IF
 13808     IF PB-COMPANY-ID NOT = 'TIC'
 13809          MOVE ZERO          TO CP-CLASS-CODE.
 13810
 13811     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 13812
 13813     MOVE 'R'                   TO CP-RATE-FILE.
 13814     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13815
 13816     IF CP-ERROR-RATE-NOT-FOUND
 13817        IF PB-I-OB
 13818           MOVE ER-2625      TO WS-ERROR
 13819           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13820           GO TO 3299-EDIT-CONTINUE
 13821        ELSE
 13822           MOVE ER-2643      TO WS-ERROR
 13823           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13824           GO TO 3299-EDIT-CONTINUE.
 13825
 13826     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 13827
 13828     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 13829     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 13830
 13831     IF PB-I-LF-REI-RATE = ZERO
 13832         MOVE ER-2643        TO WS-ERROR
 13833         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13834
 13835 3290-CHECK-ALT-REIN-RATE.
 13836
 13837     IF WS-LF-EARNINGS-CALC NOT = 'B'
 13838        GO TO 3290-RATING-CONT.
 13839
 13840     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13841     MOVE '2'                    TO CP-EARNING-METHOD.
 13842     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 13843     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13844     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13845     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13846                                     CP-RATING-BENEFIT-AMT.
 13847     IF CP-STATE-STD-ABBRV = 'OR'
 13848         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13849                                         PB-I-LF-ALT-BENEFIT-AMT.
 13850     IF PB-COMPANY-ID = 'DCC'
 13851        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 251
* EL050.cbl
 13852     END-IF
 13853     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13854     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13855     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13856                                    CP-REMAINING-TERM
 13857                                    CP-LOAN-TERM.
 13858     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13859        ADD +1                   TO CP-ORIGINAL-TERM
 13860                                    CP-REMAINING-TERM
 13861                                    CP-LOAN-TERM.
 13862
 13863     MOVE 'R'                   TO CP-RATE-FILE.
 13864     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13865
 13866     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 13867
 13868     IF PB-I-LF-ALT-REI-RATE = ZERO
 13869         MOVE ER-2643            TO WS-ERROR
 13870         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13871
 13872 3290-RATING-CONT.
 13873
 13874     IF PB-I-OB
 13875*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13876        GO TO 3300-CHECK-AH-RATES.
 13877
 13878 3299-EDIT-CONTINUE.
 13879
 13880     IF  PB-I-MORT-CODE GREATER THAN SPACES
 13881         NEXT SENTENCE
 13882     ELSE
 13883         MOVE ER-2620           TO WS-ERROR
 13884         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13885
 13886 3300-CHECK-AH-RATES.
 13887     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 13888         NEXT SENTENCE
 13889     ELSE
 13890         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13891
 13892     IF (WS-AH-SPECIAL-CALC-CD = 'E')   OR
 13893        ((CF-COMPANY-ID = 'DMD') AND
 13894                (NO-DMD-RATING))
 13895         IF (PB-COMPANY-ID = 'DCC')
 13896            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13897            CONTINUE
 13898         ELSE
 13899            MOVE ER-2687         TO WS-ERROR
 13900            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13901         END-IF
 13902         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13903         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 13904     END-IF
 13905
 13906     IF PB-I-OB
 13907        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13908
 13909     IF WS-AH-SPECIAL-CALC-CD = 'M'
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 252
* EL050.cbl
 13910         MOVE ER-2687             TO WS-ERROR
 13911         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13912         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13913         GO TO 3999-END-EDIT.
 13914
 13915*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 13916     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 13917        IF PB-I-AH-CRIT-PER = ZERO
 13918           IF PB-COMPANY-ID = 'DCC'
 13919              AND AM-DCC-PRODUCT-CODE = 'DDF'
 13920              CONTINUE
 13921           ELSE
 13922              MOVE ER-2618       TO WS-ERROR
 13923              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13924              GO TO 3999-END-EDIT
 13925           END-IF
 13926        END-IF
 13927     END-IF
 13928     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13929     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13930     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13931     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13932     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13933     MOVE PB-SV-STATE            TO CP-STATE.
 13934     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13935     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 13936     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 13937*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 13938     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 13939     MOVE '3'                    TO CP-PROCESS-TYPE.
 13940     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 13941     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13942                                    CP-RATING-BENEFIT-AMT.
 13943     IF PB-COMPANY-ID = 'CID'
 13944               OR
 13945        CP-STATE-STD-ABBRV = 'OR'
 13946         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 13947                                         PB-I-AH-TERM.
 13948     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 13949        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 13950           AND (PB-I-POLICY-IS-MONTHLY)
 13951           MOVE PB-I-LF-BENEFIT-AMT
 13952                                 TO CP-NET-BENEFIT-AMT
 13953           move pb-i-ah-premium-amt to cp-original-premium
 13954           add pb-i-lf-premium-amt to cp-original-premium
 13955        END-IF
 13956     END-IF
 13957     MOVE SPACES                 TO CP-BEN-CATEGORY
 13958     IF PB-COMPANY-ID = 'DCC'
 13959        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13960        EVALUATE TRUE
 13961           WHEN (WS-AH-BEN-CATEGORY = 'G')
 13962              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13963              MOVE PB-I-LF-BENEFIT-AMT
 13964                                 TO CP-RATING-BENEFIT-AMT
 13965              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 13966           WHEN WS-AH-BEN-CATEGORY = 'G'
 13967              MOVE PB-I-UNPAID-CASH-PRICE
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 253
* EL050.cbl
 13968                                 TO CP-RATING-BENEFIT-AMT
 13969           WHEN WS-AH-BEN-CATEGORY = 'D'
 13970              MOVE WS-AH-PMF-COMM
 13971                                 TO CP-DCC-PMF-COMM
 13972              MOVE PB-I-AH-COMMISSION
 13973                                 TO CP-DCC-ACT-COMM
 13974        END-EVALUATE
 13975     END-IF
 13976     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 13977     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13978     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13979     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13980     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13981     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 13982     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 13983                                    CP-REMAINING-TERM
 13984                                    WS-WORK-TERM.
 13985     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 13986
 13987     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13988     SET BIN-TO-GREG             TO TRUE.
 13989*    MOVE ' '                    TO DC-OPTION-CODE.
 13990     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13991     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 13992
 13993     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 13994     IF NOT VALID-SKIP-CODE
 13995         MOVE ER-2683            TO WS-ERROR
 13996         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13997         GO TO 3320-RATE-CONTINUE.
 13998
 13999     IF PB-NO-MONTHS-SKIPPED
 14000         GO TO 3320-RATE-CONTINUE.
 14001
 14002     MOVE SPACE TO NUMBER-OF-MONTHS.
 14003
 14004     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14005         MOVE 'S'                TO SK-MO (6).
 14006     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14007         MOVE 'S'                TO SK-MO (7).
 14008     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14009         MOVE 'S'                TO SK-MO (8).
 14010     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14011         MOVE 'S'                TO SK-MO (9).
 14012     IF PB-I-SKIP-CODE = 'A'
 14013         MOVE 'S'                TO SK-MO (10).
 14014
 14015     MOVE 1                      TO SUB2.
 14016     MOVE PB-I-AH-TERM           TO SUB3.
 14017     MOVE WS-MONTH               TO SUB1.
 14018     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14019     GO TO 3320-RATE-CONTINUE.
 14020
 14021 3310-GET-SKIP-MO.
 14022     IF SUB1 = 13
 14023         MOVE 1                  TO SUB1.
 14024
 14025     IF SK-MO (SUB1) = 'S'
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 254
* EL050.cbl
 14026         SUBTRACT 1 FROM WS-WORK-TERM.
 14027
 14028     ADD 1 TO SUB2
 14029              SUB1.
 14030
 14031 3320-RATE-CONTINUE.
 14032
 14033     IF WS-WORK-TERM = ZERO
 14034         MOVE 1                  TO WS-WORK-TERM.
 14035
 14036     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14037                                    CP-LOAN-TERM.
 14038
 14039     IF PB-COMPANY-ID EQUAL 'DMD'
 14040         NEXT SENTENCE
 14041     ELSE
 14042         MOVE ZERO               TO PB-I-AH-RATE
 14043                                    PB-I-AH-REI-RATE.
 14044
 14045
 14046     IF PB-COMPANY-ID EQUAL 'CRI'
 14047        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14048
 14049     IF PB-COMPANY-ID = 'CSL'
 14050         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14051         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14052         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14053         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14054
 14055     IF PB-COMPANY-ID = 'DCC'
 14056        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14057           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14058              PB-I-RATE-DEV-PCT-LF
 14059        END-IF
 14060        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14061                                 TO CP-ALTERNATE-BENEFIT
 14062        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14063        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14064        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14065     END-IF
 14066     IF (PB-COMPANY-ID = 'CID')
 14067        AND (WS-LF-EARNINGS-CALC = 'B')
 14068        AND (CP-STATE-STD-ABBRV = 'MN')
 14069        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14070     ELSE
 14071        MOVE ' '                 TO CP-AH-BALLOON-SW
 14072     END-IF
 14073     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14074     MOVE 'R'                   TO CP-RATE-FILE.
 14075     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14076
 14077     IF CP-ERROR-RATE-NOT-FOUND
 14078        IF PB-I-OB
 14079           MOVE ER-2624          TO WS-ERROR
 14080           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14081           GO TO 3340-CALCULATE-PREMIUM-AMT
 14082        ELSE
 14083          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 255
* EL050.cbl
 14084              NEXT SENTENCE
 14085          ELSE
 14086           MOVE ER-2642          TO WS-ERROR
 14087           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14088           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14089
 14090     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14091        CP-ERROR-DIV-BY-ZERO
 14092           MOVE ER-3782          TO WS-ERROR
 14093           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14094
 14095     IF PB-COMPANY-ID EQUAL 'CRI'
 14096        IF CP-ERROR-NO-LIMITS-CRI
 14097           IF NOT ACCOUNT-AH-CHECKED
 14098              MOVE ER-2607          TO WS-ERROR
 14099              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14100
 14101     IF ACCOUNT-AH-CHECKED
 14102        NEXT SENTENCE
 14103     ELSE
 14104       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14105          MOVE ER-2640           TO WS-ERROR
 14106          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14107
 14108     IF PB-COMPANY-ID = 'CRI'
 14109         IF WS-ERROR = ER-2640
 14110             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14111     IF ACCOUNT-AH-CHECKED
 14112        CONTINUE
 14113     ELSE
 14114        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14115           AND (CP-R-MAX-ATT-AGE > +0)
 14116           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14117           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14118              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14119              MOVE PB-I-AH-EXPIRE-DT
 14120                                 TO DC-BIN-DATE-2
 14121              MOVE '1'           TO DC-OPTION-CODE
 14122              PERFORM 8500-DATE-CONVERT
 14123                                 THRU 8500-EXIT
 14124              IF NO-CONVERSION-ERROR
 14125                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14126                    MOVE ER-2661       TO WS-ERROR
 14127*                   PERFORM 9900-ERROR-FORMAT
 14128*                                THRU 9900-EXIT
 14129                 END-IF
 14130              END-IF
 14131           ELSE
 14132              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14133              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14134                 MOVE ER-2661    TO WS-ERROR
 14135*                PERFORM 9900-ERROR-FORMAT
 14136*                                THRU 9900-EXIT
 14137              ELSE
 14138                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14139                    MOVE ER-1570 TO WS-ERROR
 14140                    PERFORM 9900-ERROR-FORMAT
 14141                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 256
* EL050.cbl
 14142                 END-IF
 14143              END-IF
 14144           END-IF
 14145           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14146              MOVE PB-I-JOINT-BIRTHDAY
 14147                                    TO DC-BIN-DATE-1
 14148              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14149              MOVE '1'              TO DC-OPTION-CODE
 14150              PERFORM 8500-DATE-CONVERT
 14151                                    THRU 8500-EXIT
 14152              IF NO-CONVERSION-ERROR
 14153                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14154                    MOVE ER-2661       TO WS-ERROR
 14155*                   PERFORM 9900-ERROR-FORMAT
 14156*                                   THRU 9900-EXIT
 14157                 END-IF
 14158              END-IF
 14159           ELSE
 14160              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14161                (PB-I-AH-TERM / 12)
 14162              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14163                 MOVE ER-2661       TO WS-ERROR
 14164*                PERFORM 9900-ERROR-FORMAT
 14165*                                   THRU 9900-EXIT
 14166              ELSE
 14167                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14168                    MOVE ER-1571 TO WS-ERROR
 14169                    PERFORM 9900-ERROR-FORMAT
 14170                                 THRU 9900-EXIT
 14171                 END-IF
 14172              END-IF
 14173           END-IF
 14174           IF WS-ERROR = ER-2661
 14175              PERFORM 9900-ERROR-FORMAT
 14176                                    THRU 9900-EXIT
 14177           END-IF
 14178        END-IF
 14179     END-IF
 14180*    IF ACCOUNT-AH-CHECKED
 14181*       NEXT SENTENCE
 14182*    ELSE
 14183*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14184*          MOVE ER-2661          TO WS-ERROR
 14185*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14186
 14187     IF ACCOUNT-AH-CHECKED
 14188        NEXT SENTENCE
 14189     ELSE
 14190        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14191           MOVE ER-2663          TO WS-ERROR
 14192           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14193
 14194     IF ACCOUNT-AH-CHECKED OR
 14195        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14196         PB-POLICY-IS-VOIDED
 14197        NEXT SENTENCE
 14198     ELSE
 14199        IF CP-ERROR-TOT-OUTSIDE-LIMIT
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 257
* EL050.cbl
 14200           MOVE ER-2667            TO WS-ERROR
 14201           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14202
 14203     IF PB-COMPANY-ID = 'CRI'
 14204         IF WS-ERROR = ER-2667
 14205             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14206
 14207     IF ACCOUNT-AH-CHECKED
 14208        NEXT SENTENCE
 14209     ELSE
 14210        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14211           MOVE ER-2678            TO WS-ERROR
 14212           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14213
 14214     IF CP-ERROR-RATE-FILE-NOTOPEN
 14215         GO TO 3990-FILES-NOT-OPEN.
 14216
 14217 3321-CONTINUE.
 14218     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14219     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14220     IF (PB-COMPANY-ID = 'DCC')
 14221        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14222        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14223                                    PB-I-LF-ALT-PREM-CALC
 14224        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14225        IF WS-AH-BEN-CATEGORY = 'G'
 14226           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14227           + PB-I-ADDL-CLP)
 14228           * (1 + WS-TOL-CLP-PCT)
 14229*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14230        ELSE
 14231           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14232           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14233*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14234        END-IF
 14235        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14236                                 TO PB-I-AH-PREM-CALC
 14237        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14238           MOVE ER-8152          TO WS-ERROR
 14239           PERFORM 9900-ERROR-FORMAT
 14240                                 THRU 9900-EXIT
 14241        ELSE
 14242           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14243                 PB-I-ADDL-CLP)
 14244              MOVE ER-8148       TO WS-ERROR
 14245              PERFORM 9900-ERROR-FORMAT
 14246                                 THRU 9900-EXIT
 14247           END-IF
 14248        END-IF
 14249     END-IF
 14250     IF (PB-COMPANY-ID = 'DCC')
 14251        AND (PB-I-POLICY-IS-MONTHLY)
 14252        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14253        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14254        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14255           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14256        END-IF
 14257     END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 258
* EL050.cbl
 14258     IF (PB-COMPANY-ID = 'DCC')
 14259        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14260        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14261        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14262        MOVE ER-2786             TO WS-ERROR
 14263        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14264     END-IF
 14265     MOVE +0                     TO PB-I-AH-CLP
 14266     IF PB-COMPANY-ID = 'DCC'
 14267        IF WS-AH-BEN-CATEGORY = 'D'
 14268           COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT *
 14269              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14270        ELSE
 14271           IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14272              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14273           END-IF
 14274        END-IF
 14275     END-IF
 14276     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.
 14277
 14278     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14279         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14280
 14281     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14282         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14283
 14284     IF PB-COMPANY-ID = 'CRI'
 14285         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14286            PB-I-PAYMENT-AMOUNT = ZERO
 14287             NEXT SENTENCE
 14288         ELSE
 14289             COMPUTE PB-I-AH-PREM-CALC =
 14290                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14291                 (CP-PREMIUM-RATE / 100)
 14292             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14293                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14294                                             PB-I-RATE-DEV-PCT-AH.
 14295
 14296     IF PB-I-AH-RATE  = ZERO
 14297       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14298           NEXT SENTENCE
 14299       ELSE
 14300         MOVE ER-2642            TO WS-ERROR
 14301         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14302
 14303     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14304     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14305     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14306     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14307     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14308     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14309
 14310     IF (PB-COMPANY-ID = 'DCC')
 14311        AND (WS-AH-BEN-CATEGORY = 'G')
 14312        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14313        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14314        IF CP-DEVIATION-CODE NOT = '000'
 14315           MOVE '000'            TO CP-DEVIATION-CODE
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 259
* EL050.cbl
 14316           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14317           IF NO-CP-ERROR
 14318              COMPUTE PB-I-DDF-IU-RATE-UP =
 14319              PB-I-AH-CLP - CP-CALC-PREMIUM
 14320           ELSE
 14321              MOVE ER-3057        TO WS-ERROR
 14322              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14323           END-IF
 14324        END-IF
 14325     END-IF
 14326     .
 14327 3335-EDIT-AH-REIN-NSP-RATE.
 14328     IF AH-REIN-NSP-NOT-USED
 14329         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14330
 14331     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14332     IF PB-COMPANY-ID = 'DCC'
 14333         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14334     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14335     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14336     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14337     MOVE PB-SV-STATE            TO CP-STATE.
 14338     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14339     MOVE ZERO                   TO CP-DEVIATION-CODE
 14340                                    CP-RATE-DEV-PCT.
 14341*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14342     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14343     MOVE '3'                    TO CP-PROCESS-TYPE.
 14344     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14345     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14346                                    CP-RATING-BENEFIT-AMT.
 14347     IF CP-STATE-STD-ABBRV = 'OR'
 14348         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14349                                         PB-I-AH-TERM.
 14350     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14351     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14352     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14353     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14354     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14355     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14356                                    CP-REMAINING-TERM
 14357                                    WS-WORK-TERM.
 14358     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14359     IF PB-COMPANY-ID = 'DCC'
 14360        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14361     END-IF
 14362     IF  PB-COMPANY-ID = 'TIC'
 14363         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14364            MOVE ZERO TO CP-CLASS-CODE.
 14365
 14366     IF PB-COMPANY-ID NOT = 'TIC'
 14367          MOVE ZERO          TO CP-CLASS-CODE.
 14368
 14369     MOVE ZERO               TO CP-DEVIATION-CODE.
 14370
 14371     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14372
 14373     MOVE ZERO               TO PB-I-AH-REI-RATE.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 260
* EL050.cbl
 14374
 14375     MOVE 'R'                   TO CP-RATE-FILE.
 14376     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14377
 14378     IF CP-ERROR-RATE-NOT-FOUND
 14379         MOVE ER-2645        TO WS-ERROR
 14380         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14381         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14382
 14383     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14384
 14385     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14386     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14387
 14388     IF PB-I-AH-REI-RATE = ZERO
 14389         MOVE ER-2645        TO WS-ERROR
 14390         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14391
 14392
 14393 3340-CALCULATE-PREMIUM-AMT.
 14394
 14395     IF PB-COMPANY-ID = 'NCL'
 14396         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14397             WS-AH-SPECIAL-CALC-CD = 'O')
 14398             GO TO 3999-END-EDIT.
 14399
 14400     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14401                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14402                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'
 14403                         OR 'AHL'
 14404         NEXT SENTENCE
 14405     ELSE
 14406         IF WS-STATE-ABBREVIATION = 'CT'
 14407             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14408                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14409                 COMPUTE PB-I-LF-PREM-CALC =
 14410                                     PB-I-LF-PREM-CALC * .90
 14411                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14412                                     PB-I-LF-ALT-PREM-CALC * .90
 14413                 COMPUTE PB-I-AH-PREM-CALC =
 14414                                     PB-I-AH-PREM-CALC * .90.
 14415
 14416     IF PB-COMP-LF-PREM
 14417        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14418        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14419
 14420     IF PB-COMP-AH-PREM
 14421        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14422
 14423 3340-CHECK-DCC-TOT-FEES.
 14424     IF (PB-COMPANY-ID = 'DCC')
 14425        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14426        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14427        AND (PB-I-POLICY-IS-MONTHLY)
 14428        CONTINUE
 14429     ELSE
 14430        GO TO 3340-EDIT-LF-AH-TOL
 14431     END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 261
* EL050.cbl
 14432     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14433     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14434     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14435        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14436           PB-I-RATE-DEV-PCT-LF
 14437     END-IF
 14438     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14439        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14440           PB-I-RATE-DEV-PCT-AH
 14441     END-IF
 14442     MOVE 'N'                    TO CP-BEN-CATEGORY
 14443     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14444
 14445     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14446     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14447     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14448     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14449     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14450     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14451     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14452     MOVE '3'                    TO CP-PROCESS-TYPE.
 14453     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14454     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14455
 14456     MOVE PB-SV-STATE            TO CP-STATE.
 14457     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14458     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14459     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14460     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14461     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14462                                    CP-RATING-BENEFIT-AMT.
 14463     IF CP-STATE-STD-ABBRV = 'OR'
 14464         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14465                                         PB-I-LF-ALT-BENEFIT-AMT.
 14466     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14467     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14468     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14469     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14470     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14471     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14472     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14473     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14474     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14475                                    CP-REMAINING-TERM
 14476                                    CP-LOAN-TERM.
 14477     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14478        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14479           PB-I-LF-PREMIUM-AMT
 14480     end-if
 14481
 14482     IF CP-TRUNCATED-LIFE
 14483        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14484
 14485     IF CP-TERM-IS-DAYS
 14486         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14487     ELSE
 14488         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14489
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 262
* EL050.cbl
 14490     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14491     IF CP-SPECIAL-CALC-CD = 'H'
 14492         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14493                                    TO CP-ALTERNATE-BENEFIT
 14494         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14495     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14496     MOVE 'R'                    TO CP-RATE-FILE
 14497     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14498     IF NOT CP-ERROR-RATE-NOT-FOUND
 14499        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14500        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14501           AND (CP-BENEFIT-CD (1:1) = 'S')
 14502           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14503                                    PB-I-LF-PREMIUM-AMT
 14504        END-IF
 14505     ELSE
 14506        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14507     END-IF
 14508     .
 14509 3340-EDIT-LF-AH-TOL.
 14510
 14511***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14512***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14513***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14514***
 14515     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14516         PB-I-AH-PREMIUM-AMT
 14517          GIVING WS-CALC-WORK.
 14518
 14519     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14520        AND WS-CALC-WORK NOT = ZERO
 14521         MOVE ER-2649            TO WS-ERROR
 14522         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14523
 14524     SUBTRACT PB-I-LF-PREM-CALC
 14525             FROM PB-I-LF-PREMIUM-AMT
 14526                 GIVING WS-UNSIGN-WRK1.
 14527
 14528     SUBTRACT PB-I-LF-ALT-PREM-CALC
 14529             FROM PB-I-LF-ALT-PREMIUM-AMT
 14530                 GIVING WS-UNSIGN-WRK4.
 14531
 14532     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14533                                + WS-UNSIGN-WRK4.
 14534
 14535     SUBTRACT PB-I-AH-PREM-CALC
 14536             FROM PB-I-AH-PREMIUM-AMT
 14537                 GIVING WS-UNSIGN-WRK2.
 14538
 14539******************************************************************
 14540*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14541******************************************************************
 14542
 14543     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14544         MOVE ZERO TO WS-UNSIGN-WRK1.
 14545
 14546     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14547         MOVE ZERO TO WS-UNSIGN-WRK2.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 263
* EL050.cbl
 14548
 14549     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14550             GIVING WS-UNSIGN-WRK3.
 14551
 14552 3342-CONTINUE.
 14553
 14554     IF (PB-I-LF-RATE = ZERO  AND
 14555         PB-I-AH-RATE = ZERO)
 14556         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14557            WS-AH-SPECIAL-CALC-CD = 'O'
 14558              NEXT SENTENCE
 14559         ELSE
 14560             GO TO 3345-EDIT-CONTINUE.
 14561
 14562     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14563         NEXT SENTENCE
 14564     ELSE
 14565     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14566        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14567           IF (PB-REISSUED-CERT         OR
 14568               PB-POLICY-IS-DECLINED    OR
 14569               PB-POLICY-IS-VOIDED)
 14570              NEXT SENTENCE
 14571           ELSE
 14572              IF WS-PREM-REJECT-SW = SPACE
 14573                 MOVE ER-2652    TO WS-ERROR
 14574                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14575                 GO TO 3344-CHECK-AH
 14576              ELSE
 14577                 MOVE ER-2650    TO WS-ERROR
 14578                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14579                 GO TO 3344-CHECK-AH.
 14580
 14581***
 14582***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14583***
 14584
 14585     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14586         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 14587            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14588             (1 + WS-TOL-LF-PREM-PCT)
 14589         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14590            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14591             (1 - WS-TOL-LF-PREM-PCT)
 14592     ELSE
 14593         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 14594         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 14595
 14596***
 14597***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14598***
 14599
 14600     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14601         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14602          WS-TOL-LF-PREM.
 14603
 14604     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14605         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 264
* EL050.cbl
 14606          WS-TOL-LF-PREM.
 14607
 14608     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14609        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14610
 14611     IF PB-REISSUED-CERT
 14612        or PB-POLICY-IS-DECLINED
 14613        or PB-POLICY-IS-VOIDED
 14614        continue
 14615     ELSE
 14616        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14617              > WS-TOL-LF-HIGH-PREM-AMT)
 14618           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14619              < WS-TOL-LF-LOW-PREM-AMT))
 14620                      or
 14621           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14622              > WS-TOL-LF-HIGH-PREM-PCT)
 14623           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14624              < WS-TOL-LF-LOW-PREM-PCT))
 14625           IF WS-PREM-REJECT-SW = SPACE
 14626              MOVE ER-2652       TO WS-ERROR
 14627              PERFORM 9900-ERROR-FORMAT
 14628                                 THRU 9900-EXIT
 14629           ELSE
 14630              MOVE ER-2650       TO WS-ERROR
 14631              PERFORM 9900-ERROR-FORMAT
 14632                                 THRU 9900-EXIT
 14633           end-if
 14634        end-if
 14635     end-if
 14636
 14637*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14638*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14639*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14640*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14641
 14642     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14643        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14644                      OR
 14645           ((PB-COMPANY-ID = 'DCC')
 14646           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 14647           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14648           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14649        END-IF
 14650     END-IF
 14651
 14652     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14653        IF WS-COMP-MAX-CAP GREATER THAN +0
 14654           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14655              IF (PB-REISSUED-CERT         OR
 14656                  PB-POLICY-IS-DECLINED    OR
 14657                  PB-POLICY-IS-VOIDED)
 14658                 NEXT SENTENCE
 14659              ELSE
 14660                  MOVE ER-2646   TO  WS-ERROR
 14661                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14662
 14663 3344-CVL-TOLERANCE-CHECK.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 265
* EL050.cbl
 14664
 14665      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14666          GO TO 3344-CHECK-AH.
 14667
 14668      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14669          GO TO 3344-CHECK-AH.
 14670
 14671      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14672                                     WS-UNSIGN-WRK6.
 14673
 14674      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14675          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14676                                 + PB-I-LF-PREMIUM-AMT
 14677                                 - PB-I-LF-PREM-CALC.
 14678
 14679      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14680          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14681                                 + PB-I-LF-ALT-PREMIUM-AMT
 14682                                 - PB-I-LF-ALT-PREM-CALC.
 14683
 14684      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14685          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14686              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14687                 MOVE ER-2652    TO  WS-ERROR
 14688                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14689              ELSE
 14690                 MOVE ER-2650    TO  WS-ERROR
 14691                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14692
 14693      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14694          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14695              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14696                 MOVE ER-2652    TO  WS-ERROR
 14697                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14698              ELSE
 14699                 MOVE ER-2650    TO  WS-ERROR
 14700                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14701
 14702 3344-CHECK-AH.
 14703
 14704****************************************************************
 14705***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14706***
 14707
 14708     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14709         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14710             (1 + WS-TOL-AH-PREM-PCT)
 14711         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14712             (1 - WS-TOL-AH-PREM-PCT)
 14713     ELSE
 14714         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 14715         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 14716
 14717***
 14718***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14719***
 14720
 14721     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 266
* EL050.cbl
 14722         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14723
 14724     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14725         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14726
 14727     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14728        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14729
 14730     IF (PB-REISSUED-CERT)
 14731        OR (PB-POLICY-IS-DECLINED)
 14732        OR (PB-POLICY-IS-VOIDED)
 14733        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14734        CONTINUE
 14735     ELSE
 14736        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14737              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14738                          or
 14739           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 14740              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14741           IF WS-PREM-REJECT-SW = SPACE
 14742              MOVE ER-3052       TO WS-ERROR
 14743              PERFORM 9900-ERROR-FORMAT
 14744                                 THRU 9900-EXIT
 14745           ELSE
 14746              MOVE ER-3050       TO WS-ERROR
 14747              PERFORM 9900-ERROR-FORMAT
 14748                                 THRU 9900-EXIT
 14749           END-IF
 14750        END-IF
 14751     END-IF
 14752     if (pb-company-id = 'DCC')
 14753        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 14754        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 14755        and (pb-i-policy-is-monthly)
 14756        compute ws-tol-ah-high-prem-amt =
 14757           pb-i-tot-fees-calc + ws-tol-ah-prem
 14758        compute ws-tol-ah-low-prem-amt =
 14759           pb-i-tot-fees-calc - ws-tol-ah-prem
 14760        if ws-tol-ah-prem-pct > zeros
 14761           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 14762              (1 + ws-tol-ah-prem-pct)
 14763           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 14764              (1 - ws-tol-ah-prem-pct)
 14765        else
 14766           move +9999999.99      to ws-tol-ah-high-prem-pct
 14767           move +0               to ws-tol-ah-low-prem-pct
 14768        end-if
 14769        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 14770            or
 14771           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 14772                          or
 14773           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 14774           or
 14775           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 14776            move er-3049         to ws-error
 14777           perform 9900-error-format
 14778                                 thru 9900-exit
 14779
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 267
* EL050.cbl
 14780        end-if
 14781     end-if
 14782     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 14783         IF  PB-RECORD-BILL   =  'B' OR 'A'
 14784             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14785             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14786
 14787     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14788        IF WS-COMP-MAX-CAP GREATER THAN +0
 14789           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 14790              IF (PB-REISSUED-CERT         OR
 14791                  PB-POLICY-IS-DECLINED    OR
 14792                  PB-POLICY-IS-VOIDED)
 14793                 NEXT SENTENCE
 14794              ELSE
 14795                  MOVE ER-2646   TO  WS-ERROR
 14796                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14797
 14798     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 14799        (WS-COMP-MAX-CAP EQUAL +0)
 14800           GO TO 3345-EDIT-CONTINUE.
 14801
 14802     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 14803        GREATER THAN WS-COMP-MAX-CAP
 14804           MOVE ER-2646          TO  WS-ERROR
 14805           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14806
 14807 3345-EDIT-CONTINUE.
 14808
 14809*    IF PB-COMPANY-ID    EQUAL    'NCL'
 14810*       IF PB-ENTRY-BATCH   NUMERIC
 14811*          IF PB-ISSUE
 14812*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 14813*          ELSE
 14814*              IF PB-CANCELLATION
 14815*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 14816
 14817*    IF  PB-COMPANY-ID    EQUAL    'HER'
 14818*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 14819*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 14820*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 14821*        ELSE
 14822*            MOVE  ER-1909            TO  WS-ERROR
 14823*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14824
 14825     IF PB-I-POLICY-ACCEPTED
 14826        IF PB-POLICY-IS-DECLINED  OR
 14827           PB-REISSUED-CERT  OR
 14828           PB-REIN-ONLY-CERT  OR
 14829           PB-POLICY-IS-VOIDED
 14830            MOVE  ER-1891         TO  WS-ERROR
 14831            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14832        ELSE
 14833            MOVE SPACE            TO  PB-BATCH-ENTRY
 14834            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 14835
 14836     IF PB-I-POLICY-DECLINED
 14837        IF PB-REISSUED-CERT  OR
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 268
* EL050.cbl
 14838           PB-REIN-ONLY-CERT  OR
 14839           PB-POLICY-IS-VOIDED
 14840            MOVE  ER-1906         TO  WS-ERROR
 14841            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14842        ELSE
 14843            MOVE  'D'             TO  PB-BATCH-ENTRY
 14844                                      PB-I-ENTRY-STATUS.
 14845
 14846     IF PB-I-NEEDS-UNDERWRITING
 14847        IF PB-POLICY-IS-DECLINED OR
 14848           PB-REISSUED-CERT  OR
 14849           PB-REIN-ONLY-CERT  OR
 14850           PB-POLICY-IS-VOIDED
 14851            MOVE  ER-1907         TO  WS-ERROR
 14852            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14853        ELSE
 14854            MOVE 'U'              TO  PB-BATCH-ENTRY
 14855                                      PB-I-ENTRY-STATUS.
 14856
 14857     IF PB-NEEDS-UNDERWRITING
 14858        MOVE  ER-1901             TO  WS-ERROR
 14859        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 14860     IF PB-COMPANY-ID = 'DCC'
 14861        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 14862        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 14863        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14864           AND (NOT WS-LF-CASH))
 14865                           OR
 14866           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14867           AND (NOT WS-AH-CASH)))
 14868                       AND
 14869           (PB-I-ENTRY-STATUS NOT = '5')
 14870           MOVE 'M'              TO PB-BATCH-ENTRY
 14871                                    PB-I-ENTRY-STATUS
 14872        END-IF
 14873     END-IF
 14874     IF  PB-COMPANY-ID NOT = 'NCL'
 14875         GO TO 3999-END-EDIT.
 14876
 14877     IF PB-REISSUED-CERT  OR
 14878        PB-POLICY-IS-DECLINED  OR
 14879        PB-POLICY-IS-VOIDED  OR
 14880        PB-I-OB
 14881         GO TO 3999-END-EDIT.
 14882
 14883     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 14884         MOVE  ER-2644            TO  WS-ERROR
 14885         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 14886         GO TO 3999-END-EDIT.
 14887
 14888     MOVE 'N'                     TO  FORM-MASTER-SW.
 14889     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 14890
 14891     IF NOT FORM-MASTER-FOUND
 14892         GO TO 3999-END-EDIT.
 14893
 14894     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 14895                                      FORM-MASTER-AH-SW.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 269
* EL050.cbl
 14896
 14897     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14898         MOVE  +1                 TO SUB6
 14899         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 14900
 14901     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14902         MOVE  +1                 TO SUB6
 14903         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 14904
 14905     IF LF-FORM-MASTER-FOUND  OR
 14906        AH-FORM-MASTER-FOUND
 14907         GO TO 3360-CHECK-FORM-LIMITS
 14908     ELSE
 14909         GO TO 3999-END-EDIT.
 14910
 14911******************************************************************
 14912*                  3350-GET-ERFORM                               *
 14913*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 14914*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 14915******************************************************************
 14916
 14917 3350-GET-ERFORM.
 14918
 14919     IF  WK-FORM-ADDR      EQUAL    ZEROS
 14920         GO TO  3350-ERFORM-GETMAIN.
 14921
 14922     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 14923     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 14924     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 14925     MOVE 'Y'                     TO FORM-MASTER-SW.
 14926
 14927     IF PB-CANCELLATION
 14928         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14929            PB-SV-STATE          EQUAL   FO-STATE       AND
 14930            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14931              GO TO 3350-EXIT
 14932         ELSE
 14933             NEXT SENTENCE
 14934     ELSE
 14935         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14936            PB-SV-STATE          EQUAL   FO-STATE       AND
 14937            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14938              GO TO 3350-EXIT.
 14939
 14940 3350-ERFORM-GETMAIN.
 14941
 14942     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 14943     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 14944
 14945 3350-ERFORM-READ.
 14946
 14947     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 14948     MOVE  PB-SV-STATE            TO  FORM-STATE.
 14949     IF PB-CANCELLATION
 14950         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 14951     ELSE
 14952         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 14953     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 270
* EL050.cbl
 14954
 14955     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 14956
 14957     IF FORM-MASTER-FOUND
 14958       IF PB-CANCELLATION
 14959          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14960             PB-SV-STATE          EQUAL   FO-STATE       AND
 14961             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14962              GO  TO 3350-EXIT
 14963          ELSE
 14964              NEXT SENTENCE
 14965       ELSE
 14966          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14967             PB-SV-STATE          EQUAL   FO-STATE       AND
 14968             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14969              GO  TO 3350-EXIT.
 14970
 14971     MOVE  'N'                    TO  FORM-MASTER-SW.
 14972     MOVE  ER-1895                TO  WS-ERROR.
 14973     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14974
 14975 3350-EXIT.
 14976      EXIT.
 14977
 14978******************************************************************
 14979*                  3355-EDIT-FORM-LF-BENEFITS                    *
 14980*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 14981*   VALID FOR THE POLICY FORM USED.                              *
 14982******************************************************************
 14983
 14984 3355-EDIT-FORM-LF-BENEFITS.
 14985
 14986     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14987        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14988         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 14989         GO TO   3355-EXIT.
 14990
 14991     IF  SUB6    LESS THAN   +40
 14992         ADD  +1      TO  SUB6
 14993         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 14994
 14995     MOVE  ER-1896         TO  WS-ERROR.
 14996     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14997
 14998 3355-EXIT.
 14999      EXIT.
 15000
 15001******************************************************************
 15002*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15003*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15004*   VALID FOR THE POLICY FORM USED.                              *
 15005******************************************************************
 15006
 15007 3356-EDIT-FORM-AH-BENEFITS.
 15008
 15009     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15010        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15011         MOVE  'Y'                TO  FORM-MASTER-AH-SW
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 271
* EL050.cbl
 15012         GO TO  3356-EXIT.
 15013
 15014      IF  SUB6    LESS THAN     +40
 15015          ADD  +1      TO  SUB6
 15016          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15017
 15018     MOVE  ER-1897         TO  WS-ERROR.
 15019     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15020
 15021 3356-EXIT.
 15022      EXIT.
 15023
 15024******************************************************************
 15025*                  3357-BENEFIT-SEARCH                           *
 15026*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15027*   CANCELLATIONS ONLY.                                          *
 15028******************************************************************
 15029 3357-BENEFIT-SEARCH.
 15030     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15031         MOVE +1                          TO SUB6
 15032         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15033
 15034     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15035         MOVE +1                          TO SUB6
 15036         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15037
 15038 3357-EXIT.
 15039     EXIT.
 15040
 15041******************************************************************
 15042*                  3358-BENEFIT-LIFE-SEARCH                      *
 15043*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15044*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15045*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15046******************************************************************
 15047 3358-BENEFIT-LIFE-SEARCH.
 15048     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15049       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15050         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15051           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15052              IF FO-PLAN-REFUND-METHOD (SUB6)
 15053                     IS GREATER THAN SPACES
 15054                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15055                                          WS-LF-REFUND-CALC
 15056                 GO TO 3358-EXIT.
 15057
 15058     IF SUB6 LESS THAN +40
 15059         ADD +1                 TO SUB6
 15060         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15061
 15062 3358-EXIT.
 15063     EXIT.
 15064******************************************************************
 15065*                  3359-BENEFIT-AH-SEARCH                        *
 15066*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15067*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15068*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15069******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 272
* EL050.cbl
 15070 3359-BENEFIT-AH-SEARCH.
 15071     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15072       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15073         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15074           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15075              IF FO-PLAN-REFUND-METHOD (SUB6)
 15076                      IS GREATER THAN SPACES
 15077                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15078                                          WS-AH-REFUND-CALC
 15079                 GO TO 3359-EXIT.
 15080
 15081     IF SUB6 LESS THAN +40
 15082         ADD +1                 TO SUB6
 15083         GO TO 3359-BENEFIT-AH-SEARCH.
 15084
 15085 3359-EXIT.
 15086     EXIT.
 15087
 15088******************************************************************
 15089*                  3360-CHECK-FORM-LIMITS                        *
 15090*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15091*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15092******************************************************************
 15093
 15094 3360-CHECK-FORM-LIMITS.
 15095
 15096     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15097         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15098
 15099     IF NOT LF-FORM-MASTER-FOUND
 15100         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15101
 15102 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15103
 15104     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15105       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15106        WS-LF-JOINT-INDICATOR = 'J'  AND
 15107        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15108         IF PB-COMPANY-ID = 'NCL'
 15109            MOVE  ER-1911          TO  WS-ERROR
 15110            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15111         ELSE
 15112            MOVE  ER-1892          TO  WS-ERROR
 15113            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15114
 15115 3360-CHECK-FORM-LF-ATT-AGE.
 15116
 15117     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15118
 15119     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15120         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15121         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15122            IF PB-COMPANY-ID = 'NCL'
 15123                MOVE  ER-1913      TO  WS-ERROR
 15124                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15125            ELSE
 15126                MOVE  ER-1894      TO  WS-ERROR
 15127                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 273
* EL050.cbl
 15128
 15129 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15130
 15131     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15132         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15133         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15134            IF PB-COMPANY-ID = 'NCL'
 15135                MOVE  ER-1914      TO  WS-ERROR
 15136                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15137            ELSE
 15138                MOVE  ER-1899      TO  WS-ERROR
 15139                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15140
 15141 3360-CHECK-FORM-LF-TERM-BAMT.
 15142
 15143     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15144         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15145         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15146           IF  PB-COMPANY-ID = 'NCL'
 15147               MOVE  ER-1916       TO  WS-ERROR
 15148               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15149           ELSE
 15150               MOVE  ER-1902       TO  WS-ERROR
 15151               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15152
 15153     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15154                                    PB-I-LF-ALT-BENEFIT-AMT.
 15155
 15156     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15157         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15158         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15159             IF  PB-COMPANY-ID = 'NCL'
 15160                 MOVE  ER-1918     TO  WS-ERROR
 15161                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15162             ELSE
 15163                 MOVE  ER-1904     TO  WS-ERROR
 15164                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15165
 15166******************************************************************
 15167*                  3360-CHECK-FORM-AH-LIMITS                     *
 15168*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15169*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15170******************************************************************
 15171
 15172 3360-CHECK-FORM-AH-LIMITS.
 15173
 15174     IF NOT AH-FORM-MASTER-FOUND
 15175         GO TO 3999-END-EDIT.
 15176
 15177 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15178
 15179     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15180       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15181        WS-AH-JOINT-INDICATOR = 'J'  AND
 15182        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15183         IF PB-COMPANY-ID = 'NCL'
 15184            MOVE  ER-1912          TO  WS-ERROR
 15185            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 274
* EL050.cbl
 15186         ELSE
 15187            MOVE  ER-1893          TO  WS-ERROR
 15188            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15189
 15190 3360-CHECK-FORM-AH-ATT-AGE.
 15191
 15192     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15193
 15194     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15195         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15196         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15197            IF PB-COMPANY-ID = 'NCL'
 15198                MOVE  ER-1913      TO  WS-ERROR
 15199                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15200            ELSE
 15201                MOVE  ER-1894      TO  WS-ERROR
 15202                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15203
 15204 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15205
 15206     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15207         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15208         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15209            IF PB-COMPANY-ID = 'NCL'
 15210                MOVE  ER-1915      TO  WS-ERROR
 15211                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15212            ELSE
 15213                MOVE  ER-1900      TO  WS-ERROR
 15214                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15215
 15216 3360-CHECK-FORM-AH-TERM-BAMT.
 15217
 15218     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15219         FO-AH-MAX-TERM    GREATER THAN  +0
 15220         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15221             IF  PB-COMPANY-ID = 'NCL'
 15222                 MOVE  ER-1917     TO  WS-ERROR
 15223                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15224             ELSE
 15225                  MOVE  ER-1903    TO  WS-ERROR
 15226                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15227
 15228     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15229         FO-MAX-AH-AMT    GREATER THAN  +0
 15230         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15231             IF  PB-COMPANY-ID = 'NCL'
 15232                 MOVE  ER-1919     TO  WS-ERROR
 15233                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15234             ELSE
 15235                 MOVE  ER-1905     TO  WS-ERROR
 15236                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15237
 15238     GO TO 3999-END-EDIT.
 15239
 15240******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 275
* EL050.cbl
 15242******************************************************************
 15243*                  E D I T   C A N C E L                         *
 15244******************************************************************
 15245
 15246 3700-EDIT-CANCEL.
 15247     IF PB-COMPANY-ID = 'DMD'
 15248         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15249                                         WS-RES-MUNI-TAX
 15250                                         PB-CI-STATE-TAX
 15251                                         PB-CI-MUNI-TAX
 15252         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15253
 15254*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15255*       IF PB-ENTRY-BATCH  NUMERIC
 15256*          IF PB-CANCELLATION
 15257*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15258*          ELSE
 15259*             IF PB-ISSUE
 15260*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15261
 15262     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15263        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15264     END-IF
 15265*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15266*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15267
 15268     IF CM-ENTRY-STATUS = 'V'
 15269        MOVE ER-2780             TO WS-ERROR
 15270        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15271        GO TO 3999-END-EDIT.
 15272
 15273     IF CM-ENTRY-STATUS = 'D'
 15274        MOVE ER-2781             TO WS-ERROR
 15275        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15276        GO TO 3999-END-EDIT.
 15277
 15278     IF CM-ENTRY-STATUS = 'U'
 15279        MOVE ER-2782             TO WS-ERROR
 15280        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15281
 15282***************************************************************
 15283*                                                             *
 15284*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15285*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15286*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15287*   OF ANOTHER COVERAGE.                                      *
 15288*                                                             *
 15289***************************************************************
 15290
 15291     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15292                                    PB-C-AH-CANCEL-VOID-SW.
 15293
 15294     IF PB-C-LF-CANCEL-AMT = ZERO
 15295        NEXT SENTENCE
 15296     ELSE
 15297        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15298           AND
 15299           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 276
* EL050.cbl
 15300               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 15301               MOVE ER-2745           TO WS-ERROR
 15302               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15303
 15304     IF PB-C-AH-CANCEL-AMT = ZERO
 15305        NEXT SENTENCE
 15306     ELSE
 15307        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15308           AND
 15309           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15310               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15311               MOVE ER-2745           TO WS-ERROR
 15312               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15313
 15314     IF WS-LF-EARNINGS-CALC = '4'
 15315        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15316
 15317     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15318     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15319     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15320     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15321     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15322     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15323
 15324     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15325                                      PB-C-AH-REF-CALC.
 15326     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15327
 15328******************************************************************
 15329*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15330*             TO VALIDATE COVERAGE.                              *
 15331******************************************************************
 15332
 15333     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15334        PB-C-LF-CANCEL-AMT = ZEROS
 15335          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15336      ELSE
 15337          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15338
 15339     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15340        PB-C-AH-CANCEL-AMT = ZEROS
 15341          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15342      ELSE
 15343          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15344
 15345     EVALUATE TRUE
 15346         WHEN PB-CANCEL-FORCE             OR
 15347              PB-CANCEL-DATE-FORCED       OR
 15348              PB-FORCE-OFF
 15349                  IF PB-COMPANY-ID = 'ACE'
 15350                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15351                  END-IF
 15352         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15353               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15354              (PB-COMPANY-ID = 'ACE' )
 15355                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15356         WHEN OTHER
 15357              IF PB-COMPANY-ID = 'ACE'
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 277
* EL050.cbl
 15358                 MOVE ER-2794              TO WS-ERROR
 15359              ELSE
 15360                 MOVE ER-2749              TO WS-ERROR
 15361              END-IF
 15362              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15363     END-EVALUATE.
 15364
 15365
 15366*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15367*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15368*            MOVE  ER-1909            TO  WS-ERROR
 15369*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15370*        ELSE
 15371*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15372
 15373     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15374     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15375        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15376     ELSE
 15377        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15378     END-IF
 15379     .
 15380 3705-EDIT-CANCEL-DT.
 15381
 15382     IF LF-COVERAGE-CANCELLED
 15383        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15384         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15385         MOVE WS-CURRENT-MONTH-END
 15386                                 TO DC-BIN-DATE-2
 15387         SET ELAPSED-BETWEEN-BIN TO TRUE
 15388*        MOVE 1                  TO DC-OPTION-CODE
 15389         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15390         IF DATE-CONVERSION-ERROR
 15391            NEXT SENTENCE
 15392          ELSE
 15393             IF DC-ELAPSED-DAYS GREATER +180
 15394                IF PB-CANCEL-DATE-FORCED  OR
 15395                   PB-CANCEL-DATE-FORCED-NO-FEE
 15396                      MOVE ER-2751  TO WS-ERROR
 15397                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15398                 ELSE
 15399                   MOVE ER-2752  TO WS-ERROR
 15400                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15401
 15402     IF AH-COVERAGE-CANCELLED
 15403        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15404         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15405         MOVE WS-CURRENT-MONTH-END
 15406                                 TO DC-BIN-DATE-2
 15407         SET ELAPSED-BETWEEN-BIN TO TRUE
 15408*        MOVE 1                  TO DC-OPTION-CODE
 15409         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15410         IF DATE-CONVERSION-ERROR
 15411            NEXT SENTENCE
 15412          ELSE
 15413             IF DC-ELAPSED-DAYS GREATER +180
 15414                IF PB-CANCEL-DATE-FORCED OR
 15415                   PB-CANCEL-DATE-FORCED-NO-FEE
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 278
* EL050.cbl
 15416                      MOVE ER-2751  TO WS-ERROR
 15417                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15418                 ELSE
 15419                   MOVE ER-2752  TO WS-ERROR
 15420                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15421
 15422     IF WS-ERROR = ER-2752
 15423        AND (PB-COMPANY-ID = 'ABL'
 15424         OR  PB-COMPANY-ID = 'FGL'
 15425         OR  PB-COMPANY-ID = 'IST'
 15426         OR  PB-COMPANY-ID = 'JHL'
 15427         OR  PB-COMPANY-ID = 'LAP'
 15428         OR  PB-COMPANY-ID = 'LBL'
 15429         OR  PB-COMPANY-ID = 'NCB'
 15430         OR  PB-COMPANY-ID = 'NLI'
 15431         OR  PB-COMPANY-ID = 'OFI'
 15432         OR  PB-COMPANY-ID = 'PLI'
 15433         OR  PB-COMPANY-ID = 'TAO'
 15434         OR  PB-COMPANY-ID = 'TIC'
 15435         OR  PB-COMPANY-ID = 'HER'
 15436         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15437         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15438            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15439            MOVE ER-2762     TO WS-ERROR
 15440            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15441
 15442     IF LF-COVERAGE-CANCELLED
 15443        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15444        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15445             MOVE ER-2733         TO WS-ERROR
 15446             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15447
 15448     IF AH-COVERAGE-CANCELLED
 15449        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15450        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15451              MOVE ER-2733        TO WS-ERROR
 15452              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15453
 15454     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15455        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15456        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15457           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15458            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15459              IF PB-COMPANY-ID NOT = 'LAP'
 15460               MOVE ER-2704            TO WS-ERROR
 15461               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15462
 15463     IF CERT-WAS-NOT-FOUND
 15464         GO TO 3999-END-EDIT.
 15465
 15466     IF PB-COMPANY-ID EQUAL 'CDC'
 15467        IF LF-COVERAGE-CANCELLED
 15468           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15469            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15470            MOVE PB-C-LF-CANCEL-DT
 15471                                 TO DC-BIN-DATE-2
 15472            SET ELAPSED-BETWEEN-BIN TO TRUE
 15473*           MOVE 1               TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 279
* EL050.cbl
 15474            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15475            IF DATE-CONVERSION-ERROR
 15476               NEXT SENTENCE
 15477             ELSE
 15478                IF DC-ELAPSED-DAYS GREATER +60
 15479                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15480
 15481     IF PB-COMPANY-ID EQUAL 'CDC'
 15482        IF AH-COVERAGE-CANCELLED
 15483           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15484            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15485            MOVE PB-C-AH-CANCEL-DT
 15486                                 TO DC-BIN-DATE-2
 15487            MOVE +0              TO DC-ELAPSED-DAYS
 15488                                    DC-ELAPSED-MONTHS
 15489            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15490*           MOVE 1               TO DC-OPTION-CODE
 15491            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15492            IF DATE-CONVERSION-ERROR
 15493               NEXT SENTENCE
 15494             ELSE
 15495                IF DC-ELAPSED-DAYS GREATER +60
 15496                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15497
 15498     MOVE +0                     TO DC-ELAPSED-DAYS
 15499                                    DC-ELAPSED-MONTHS.
 15500
 15501     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15502        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15503          MOVE 'Z'                TO PB-CI-OB-FLAG
 15504          MOVE ER-2767            TO WS-ERROR
 15505          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15506          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15507          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15508          GO TO 3775-OVER-REF-CHK
 15509        ELSE
 15510          MOVE ZEROS              TO PB-CI-LIVES
 15511                                     PB-C-LIVES
 15512          IF PB-CI-OB-FLAG NOT = 'B'
 15513             MOVE SPACE           TO PB-CI-OB-FLAG.
 15514
 15515     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15516         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15517     ELSE
 15518         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15519
 15520     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15521        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15522            MOVE ER-2760         TO WS-ERROR
 15523            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15524
 15525     IF LF-COVERAGE-CANCELLED
 15526        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15527         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15528            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15529               MOVE ER-2774       TO WS-ERROR
 15530               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15531
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 280
* EL050.cbl
 15532     IF AH-COVERAGE-CANCELLED
 15533        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15534         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15535            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15536               MOVE ER-2775       TO WS-ERROR
 15537               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15538
 15539     IF LF-COVERAGE-CANCELLED
 15540        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15541         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15542            MOVE ER-2776         TO WS-ERROR
 15543            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15544
 15545     IF AH-COVERAGE-CANCELLED
 15546        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15547         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15548            MOVE ER-2777         TO WS-ERROR
 15549            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15550
 15551     IF LF-COVERAGE-CANCELLED
 15552        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15553        if pb-ci-lf-expire-dt = low-values or spaces
 15554           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15555           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 15556           MOVE PB-CI-EXTENTION-DAYS
 15557                                 TO DC-ELAPSED-DAYS
 15558           SET BIN-PLUS-ELAPSED  TO TRUE
 15559           PERFORM 8500-DATE-CONVERT
 15560                                 THRU 8500-EXIT
 15561           IF DATE-CONVERSION-ERROR
 15562              move low-values    to dc-bin-date-2
 15563           end-if
 15564        else
 15565           move pb-ci-lf-expire-dt
 15566                                 to dc-bin-date-2
 15567        end-if
 15568        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15569           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15570                             OR  'FIA'
 15571              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 15572           ELSE
 15573              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15574              MOVE ER-2731       TO WS-ERROR
 15575              PERFORM 9900-ERROR-FORMAT
 15576                                 THRU 9900-EXIT
 15577           end-if
 15578        end-if
 15579     end-if
 15580*    IF LF-COVERAGE-CANCELLED
 15581*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15582*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15583*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15584*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15585*        SET BIN-PLUS-ELAPSED      TO TRUE
 15586*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15587*        IF DATE-CONVERSION-ERROR
 15588*           NEXT SENTENCE
 15589*         ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 281
* EL050.cbl
 15590*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15591*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15592*                            OR  'FIA'
 15593*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15594*              ELSE
 15595*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15596*               MOVE ER-2731       TO WS-ERROR
 15597*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15598     .
 15599 3705-EDIT-AH-CANCEL-DT.
 15600     IF AH-COVERAGE-CANCELLED
 15601        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15602        if pb-ci-AH-expire-dt = low-values or spaces
 15603           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15604           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 15605           MOVE PB-CI-EXTENTION-DAYS
 15606                                 TO DC-ELAPSED-DAYS
 15607           SET BIN-PLUS-ELAPSED  TO TRUE
 15608           PERFORM 8500-DATE-CONVERT
 15609                                 THRU 8500-EXIT
 15610           IF DATE-CONVERSION-ERROR
 15611              move low-values    to dc-bin-date-2
 15612           end-if
 15613        else
 15614           move pb-ci-ah-expire-dt
 15615                                 to dc-bin-date-2
 15616        end-if
 15617        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15618           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15619                             OR  'FIA'
 15620              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 15621           ELSE
 15622              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15623              MOVE ER-2771       TO WS-ERROR
 15624              PERFORM 9900-ERROR-FORMAT
 15625                                 THRU 9900-EXIT
 15626           end-if
 15627        end-if
 15628     end-if
 15629*    IF AH-COVERAGE-CANCELLED
 15630*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15631*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15632*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15633*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15634**       MOVE 6                    TO DC-OPTION-CODE
 15635*        SET BIN-PLUS-ELAPSED      TO TRUE
 15636*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15637*        IF DATE-CONVERSION-ERROR
 15638*           NEXT SENTENCE
 15639*         ELSE
 15640*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15641*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15642*                             OR 'FIA'
 15643*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15644*             ELSE
 15645*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15646*              MOVE ER-2771       TO WS-ERROR
 15647*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 282
* EL050.cbl
 15648     .
 15649 3705-EDIT-CONTINUED.
 15650
 15651*    IF LF-COVERAGE-CANCELLED
 15652*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15653*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15654*            MOVE ER-2727         TO WS-ERROR
 15655*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15656*
 15657*    IF AH-COVERAGE-CANCELLED
 15658*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15659*        IF PB-COMPANY-ID = 'ACE'
 15660*           MOVE ER-2727        TO WS-ERROR
 15661*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15662*        ELSE
 15663*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15664*              MOVE ER-2727     TO WS-ERROR
 15665*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15666
 15667     IF PB-COMPANY-ID = 'ACE'
 15668       IF AH-COVERAGE-CANCELLED
 15669         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15670           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15671              MOVE ER-2732      TO WS-ERROR
 15672              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15673
 15674     IF PB-COMPANY-ID      EQUAL   'HER'
 15675        IF WS-ERROR        EQUAL   ER-2727
 15676            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15677            MOVE  ER-2725          TO  WS-ERROR
 15678            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15679
 15680     IF PB-C-CLAIM-CREATED-CANCEL
 15681            MOVE ER-2748         TO WS-ERROR
 15682            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15683
 15684     IF PB-C-LAST-NAME NOT = SPACES
 15685         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15686            MOVE ER-2747         TO WS-ERROR
 15687            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15688
 15689 3710-EDIT-LUMP-SUM-PRIOR.
 15690
 15691     IF AH-COVERAGE-CANCELLED
 15692         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15693             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15694                MOVE ER-2735    TO WS-ERROR
 15695                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15696
 15697     IF LF-COVERAGE-CANCELLED
 15698         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15699             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 15700                MOVE ER-2735    TO WS-ERROR
 15701                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15702
 15703 3710-EDIT-PRIOR-DEATH.
 15704
 15705*    IF LF-COVERAGE-CANCELLED
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 283
* EL050.cbl
 15706*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15707*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15708*           (NOT PB-CI-OB)
 15709*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 15710*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 15711*                   MOVE ER-2732  TO WS-ERROR
 15712*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15713*
 15714*    IF AH-COVERAGE-CANCELLED
 15715*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15716*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15717*           (NOT PB-CI-OB)
 15718*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 15719*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 15720*                   MOVE ER-2732  TO WS-ERROR
 15721*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15722
 15723     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 15724         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 15725            (NOT PB-COMP-LF-CANCEL)
 15726             NEXT SENTENCE
 15727         ELSE
 15728           IF PB-C-LF-CANCEL-VOIDED
 15729              NEXT SENTENCE
 15730           ELSE
 15731              MOVE ER-2753      TO WS-ERROR
 15732              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15733
 15734     IF CANCEL-FUTURE-DT
 15735         GO TO 3999-END-EDIT.
 15736
 15737 3715-GET-REMAIN-TERM-LF.
 15738
 15739     IF NO-LF-BENEFIT-MATCH  OR
 15740        WS-LF-BENEFIT-CD = ZEROS
 15741        GO TO 3730-GET-AH-REMAIN-TERM.
 15742
 15743     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15744     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15745     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15746     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 15747     MOVE PB-SV-STATE            TO CP-STATE.
 15748     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15749     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15750     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15751     MOVE '2'                    TO CP-PROCESS-TYPE.
 15752     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15753     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15754     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15755     IF (PB-COMPANY-ID = 'CID')
 15756        AND (CP-STATE-STD-ABBRV = 'WI')
 15757        MOVE '7'                 TO CP-REM-TERM-METHOD
 15758        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15759     ELSE
 15760        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15761        MOVE WS-REM-TRM-CALC-OPTION
 15762                                 TO CP-REM-TRM-CALC-OPTION
 15763     END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 284
* EL050.cbl
 15764**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 15765     IF (PB-COMPANY-ID = 'CID')
 15766        AND (CP-STATE-STD-ABBRV = 'MO')
 15767        AND (PB-CERT-EFF-DT >= X'9B41')
 15768        AND (PB-CERT-EFF-DT <= X'A2FB')
 15769        MOVE '7'                 TO CP-REM-TERM-METHOD
 15770        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15771     END-IF
 15772     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 15773                                    CP-LOAN-TERM.
 15774     IF CP-TRUNCATED-LIFE
 15775        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 15776
 15777     IF CP-TERM-IS-DAYS
 15778         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 15779     ELSE
 15780         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15781
 15782     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 15783
 15784     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15785
 15786     IF LF-COVERAGE-CANCELLED
 15787        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 15788        NEXT SENTENCE
 15789      ELSE
 15790          GO TO 3730-GET-AH-REMAIN-TERM.
 15791
 15792 3720-GET-LF-REFUND.
 15793
 15794     IF PB-C-LF-CANCEL-VOIDED OR
 15795        PB-C-AH-CANCEL-VOIDED
 15796        GO TO 3780-UPDATE-CANCEL-CERT.
 15797
 15798     IF PB-COMPANY-ID EQUAL 'BOA'
 15799         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15800         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15801         GO TO 3730-GET-AH-REMAIN-TERM.
 15802
 15803     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 15804        (WS-AH-SPECIAL-CALC-CD = 'M')
 15805         MOVE ER-2767            TO WS-ERROR
 15806         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15807         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15808         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15809         GO TO 3780-UPDATE-CANCEL-CERT.
 15810
 15811*    if (ws-lf-earnings-calc = '6')
 15812*       or (pb-c-lf-refund-override = '6')
 15813*       move cp-remaining-term-1 to cp-remaining-term-2
 15814*    end-if
 15815     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 15816
 15817     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15818     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 15819     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15820     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 15821     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 285
* EL050.cbl
 15822     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 15823     IF (PB-COMPANY-ID = 'DCC')
 15824        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15825        IF PDEF-MASTER-FOUND
 15826           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15827              (V1 > +8)
 15828              OR (PD-PROD-CODE (V1) = 'L')
 15829           END-PERFORM
 15830           IF V1 < +9
 15831              MOVE PD-MAX-AMT (V1)
 15832                           TO CP-R-MAX-TOT-BEN
 15833                              EC-AM-LF-MAX-TOT-BEN
 15834           END-IF
 15835        ELSE
 15836        MOVE ' '                 TO PDEF-MASTER-SW
 15837        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15838        MOVE PB-STATE            TO ERPDEF-STATE
 15839        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15840        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15841        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15842        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15843        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15844        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15845        IF PDEF-MASTER-FOUND
 15846           MOVE 'N'              TO PDEF-MASTER-SW
 15847           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15848           IF PDEF-MASTER-FOUND
 15849              IF (ERPDEF-KEY-SAVE (1:16) =
 15850                           PD-CONTROL-PRIMARY (1:16))
 15851                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15852                 CONTINUE
 15853              ELSE
 15854                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15855                 IF (ERPDEF-KEY-SAVE (1:16) =
 15856                           PD-CONTROL-PRIMARY (1:16))
 15857                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15858                    CONTINUE
 15859                 ELSE
 15860                    MOVE 'N'     TO PDEF-MASTER-SW
 15861                 END-IF
 15862              END-IF
 15863              DISPLAY ' MADE IT TO REM AMT  IN IF STMT '
 15864
 15865              IF PDEF-MASTER-FOUND
 15866                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15867                    (V1 > +8)
 15868                    OR (PD-PROD-CODE (V1) = 'L')
 15869                 END-PERFORM
 15870                 IF V1 < +9
 15871                    MOVE PD-MAX-AMT (V1)
 15872                                 TO CP-R-MAX-TOT-BEN
 15873                                    EC-AM-LF-MAX-TOT-BEN
 15874                 END-IF
 15875              END-IF
 15876           END-IF
 15877           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 15878        END-IF
 15879        END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 286
* EL050.cbl
 15880     END-IF
 15881     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 15882
 15883     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 15884
 15885     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15886                                    PB-C-LF-REM-TERM.
 15887
 15888     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 15889     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 15890
 15891     IF PB-COMPANY-ID EQUAL 'FLC'
 15892        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 15893           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 15894           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 15895                    + PB-CI-LF-ALT-PREMIUM-AMT)
 15896                    - CM-LF-ITD-DEATH-AMT
 15897           IF PB-C-LF-REF-CALC LESS THAN +0
 15898              MOVE +0            TO PB-C-LF-REF-CALC
 15899              GO TO 3730-GET-AH-REMAIN-TERM
 15900           ELSE
 15901              GO TO 3730-GET-AH-REMAIN-TERM.
 15902
 15903     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15904                            OR '4' OR '5' OR '6' OR '8'
 15905                            OR '9' OR 'G'
 15906        MOVE PB-C-LF-REFUND-OVERRIDE
 15907                                 TO CP-EARNING-METHOD.
 15908
 15909     if pb-company-id = 'AHL'
 15910        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 15911        if cp-class-code = spaces
 15912           move zeros            to cp-class-code
 15913        end-if
 15914     ELSE
 15915        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 15916     END-IF
 15917*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15918     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 15919     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15920                                    CP-RATING-BENEFIT-AMT.
 15921     IF CP-STATE-STD-ABBRV = 'OR'
 15922         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15923                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15924     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15925     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15926     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15927     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 15928     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 15929     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15930     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 15931     IF WS-DEFAULT-APR NOT NUMERIC
 15932         MOVE ZEROS TO WS-DEFAULT-APR.
 15933****   N O T E   ****
 15934*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 15935*      THE OH HARD CODING IN ELCRFNDP
 15936
 15937     IF PB-COMPANY-ID = 'CID'
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 287
* EL050.cbl
 15938        IF CP-STATE-STD-ABBRV = 'OH'
 15939           MOVE WS-LF-EARNINGS-CALC
 15940                                 TO CP-EARNING-METHOD
 15941        END-IF
 15942     END-IF
 15943
 15944****   N O T E   ****
 15945
 15946     IF CP-EARN-AS-NET-PAY
 15947         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 15948            IF WS-DEFAULT-APR GREATER THAN ZEROS
 15949                MOVE WS-DEFAULT-APR
 15950                                 TO  CP-LOAN-APR
 15951                MOVE ER-3780     TO  WS-ERROR
 15952                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 15953            ELSE
 15954                MOVE ER-3781     TO  WS-ERROR
 15955                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15956*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 15957     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15958
 15959     IF CP-REFUND-TYPE-USED NOT = SPACE
 15960         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 15961
 15962     IF CP-ERROR-RATE-IS-ZERO OR
 15963        CP-ERROR-RATE-NOT-FOUND
 15964        MOVE ER-2740             TO WS-ERROR
 15965        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15966
 15967     IF CP-ERROR-RATE-FILE-NOTOPEN
 15968        MOVE ER-2617             TO WS-ERROR
 15969        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15970
 15971     IF PB-COMPANY-ID = 'DCC'
 15972        AND PB-CI-ENTRY-STATUS = 'M'
 15973        MOVE +0                  TO PB-C-LF-REF-CALC
 15974     ELSE
 15975        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 15976     END-IF
 15977
 15978     IF WS-LF-EARNINGS-CALC NOT = 'B'
 15979         GO TO 3730-GET-AH-REMAIN-TERM.
 15980
 15981*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 15982*       ADD +1                   TO PB-C-LF-REM-TERM
 15983*                                   CP-REMAINING-TERM
 15984*                                   CP-ORIGINAL-TERM.
 15985
 15986     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 15987     MOVE '2'                    TO CP-EARNING-METHOD
 15988                                    CP-RATING-METHOD.
 15989     IF PB-COMPANY-ID = 'CID'
 15990        IF (CP-STATE-STD-ABBRV = 'MN')
 15991           AND (PB-CERT-EFF-DT > X'A4FF')
 15992           AND (WS-LF-EARNINGS-CALC = 'B')
 15993           MOVE '5'              TO CP-EARNING-METHOD
 15994           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 15995        END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 288
* EL050.cbl
 15996     END-IF
 15997     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15998                                        CP-REMAINING-BENEFIT
 15999                                        CP-RATING-BENEFIT-AMT.
 16000     IF CP-STATE-STD-ABBRV = 'OR'
 16001         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16002                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16003     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16004     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16005
 16006     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16007
 16008     IF CP-ERROR-RATE-IS-ZERO OR
 16009        CP-ERROR-RATE-NOT-FOUND
 16010        MOVE ER-2740             TO WS-ERROR
 16011        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16012
 16013     IF CP-ERROR-RATE-FILE-NOTOPEN
 16014        MOVE ER-2617             TO WS-ERROR
 16015        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16016
 16017     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16018
 16019******************************************************************
 16020
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 289
* EL050.cbl
 16022 3730-GET-AH-REMAIN-TERM.
 16023     IF NO-AH-BENEFIT-MATCH  OR
 16024        WS-AH-BENEFIT-CD = ZEROS
 16025         GO TO 3770-CHECK-REFUNDS.
 16026
 16027     IF PB-CI-AH-LUMP-SUM-DISAB
 16028         IF  PB-C-AH-CANCEL-AMT = ZERO
 16029            IF NOT PB-COMP-AH-CANCEL
 16030             GO TO 3770-CHECK-REFUNDS.
 16031
 16032     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16033     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16034     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16035     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16036     MOVE PB-SV-STATE            TO CP-STATE.
 16037     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16038     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16039     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16040     MOVE '2'                    TO CP-PROCESS-TYPE.
 16041     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16042     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16043     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16044     IF (PB-COMPANY-ID = 'CID')
 16045        AND (CP-STATE-STD-ABBRV = 'WI')
 16046        MOVE '7'                 TO CP-REM-TERM-METHOD
 16047        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16048     ELSE
 16049        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16050        MOVE WS-REM-TRM-CALC-OPTION
 16051                                 TO CP-REM-TRM-CALC-OPTION
 16052     END-IF
 16053     IF (PB-COMPANY-ID = 'CID')
 16054        AND (CP-STATE-STD-ABBRV = 'MO')
 16055        AND (PB-CERT-EFF-DT >= X'9B41')
 16056        AND (PB-CERT-EFF-DT <= X'A2FB')
 16057        MOVE '7'                 TO CP-REM-TERM-METHOD
 16058        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16059     END-IF
 16060     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16061                                    CP-LOAN-TERM.
 16062     IF NOT CP-TERM-IS-DAYS
 16063         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16064
 16065     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16066
 16067     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16068
 16069     IF AH-COVERAGE-CANCELLED
 16070        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16071        NEXT SENTENCE
 16072      ELSE
 16073         GO TO 3770-CHECK-REFUNDS.
 16074
 16075 3740-GET-AH-REFUND.
 16076
 16077     IF PB-C-LF-CANCEL-VOIDED OR
 16078        PB-C-AH-CANCEL-VOIDED
 16079        GO TO 3780-UPDATE-CANCEL-CERT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 290
* EL050.cbl
 16080
 16081     IF PB-COMPANY-ID = 'BOA'
 16082         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16083         GO TO 3770-CHECK-REFUNDS.
 16084
 16085     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16086*    MOVE ' '                    TO DC-OPTION-CODE
 16087     SET BIN-TO-GREG             TO TRUE
 16088     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16089     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16090                                    PB-C-AH-REM-TERM.
 16091     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16092     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16093
 16094     IF PB-COMPANY-ID EQUAL 'FLC'
 16095        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16096           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16097           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16098                    - CM-AH-ITD-AH-PMT)
 16099           IF PB-C-AH-REF-CALC LESS THAN +0
 16100              MOVE +0            TO PB-C-AH-REF-CALC
 16101              GO TO 3770-CHECK-REFUNDS
 16102           ELSE
 16103              GO TO 3770-CHECK-REFUNDS.
 16104
 16105     IF PB-COMPANY-ID = 'DCC'
 16106        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16107            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16108           MOVE 'S'              TO CP-EARNING-METHOD
 16109        END-IF
 16110     END-IF
 16111     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16112                            OR '4' OR '5' OR '6' OR '8'
 16113                            OR '9' OR 'G' OR 'S'
 16114        MOVE PB-C-AH-REFUND-OVERRIDE
 16115                                 TO CP-EARNING-METHOD.
 16116
 16117     if pb-company-id = 'AHL'
 16118        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16119        if cp-class-code = spaces
 16120           move zeros            to cp-class-code
 16121        end-if
 16122     ELSE
 16123        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16124     END-IF
 16125*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16126     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16127     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16128                                    CP-RATING-BENEFIT-AMT.
 16129     IF CP-STATE-STD-ABBRV = 'OR'
 16130         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16131                                         PB-CI-AH-TERM.
 16132     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16133     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16134     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16135     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16136     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16137     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 291
* EL050.cbl
 16138
 16139     IF CP-STATE-STD-ABBRV = 'OH'
 16140        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16141                                AND 'CID' AND 'DCC' AND 'AHL')
 16142           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16143              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16144              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16145              MOVE '6' TO CP-EARNING-METHOD
 16146           END-IF
 16147        END-IF
 16148        IF PB-COMPANY-ID = 'CID'
 16149           IF NO-LIFE-COVERAGE
 16150              IF CP-CRITICAL-PERIOD
 16151                 MOVE '2'       TO CP-EARNING-METHOD
 16152              ELSE
 16153                 MOVE '6'       TO CP-EARNING-METHOD
 16154              END-IF
 16155           ELSE
 16156              IF WS-LF-COVERAGE-TYPE = 'L'
 16157                 MOVE '2'       TO CP-EARNING-METHOD
 16158              ELSE
 16159                 IF (PB-CI-LF-TERM > +60) OR
 16160                    (WS-LF-EARNINGS-CALC = '5')
 16161                    IF CP-CRITICAL-PERIOD
 16162                       MOVE '2'  TO CP-EARNING-METHOD
 16163                    ELSE
 16164                       MOVE '6'  TO CP-EARNING-METHOD
 16165                    END-IF
 16166                 ELSE
 16167                    MOVE '1'     TO CP-EARNING-METHOD
 16168                 END-IF
 16169              END-IF
 16170           END-IF
 16171        END-IF
 16172     END-IF
 16173
 16174*    IF CP-STATE-STD-ABBRV = 'VA'
 16175*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16176*          IF CP-ORIGINAL-TERM GREATER 61
 16177*             MOVE '6' TO CP-EARNING-METHOD
 16178*          ELSE
 16179*             MOVE '1' TO CP-EARNING-METHOD.
 16180
 16181     IF WS-DEFAULT-APR NOT NUMERIC
 16182         MOVE ZEROS TO WS-DEFAULT-APR.
 16183     IF CP-EARN-AS-NET-PAY
 16184         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16185            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16186                MOVE WS-DEFAULT-APR
 16187                                 TO  CP-LOAN-APR
 16188                MOVE ER-3780     TO  WS-ERROR
 16189                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16190            ELSE
 16191                MOVE ER-3781     TO  WS-ERROR
 16192                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16193     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16194     IF PB-COMPANY-ID = 'DCC'
 16195        AND CP-CANCEL-REASON = 'R'
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 292
* EL050.cbl
 16196        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16197        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16198     END-IF
 16199     IF PB-COMPANY-ID = 'DCC'
 16200        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16201        AND (CP-EARNING-METHOD = 'D')
 16202        AND (CP-CANCEL-REASON NOT = 'R')
 16203        CONTINUE
 16204     ELSE
 16205        GO TO 3750-CONTINUE
 16206     END-IF
 16207     MOVE ' '                    TO DD-IU-SW
 16208     IF NOT PDEF-MASTER-FOUND
 16209        MOVE ' '                 TO PDEF-MASTER-SW
 16210        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16211        MOVE PB-STATE            TO ERPDEF-STATE
 16212        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16213        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16214        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16215        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16216        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16217        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16218        IF PDEF-MASTER-FOUND
 16219           MOVE 'N'              TO PDEF-MASTER-SW
 16220           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16221           IF PDEF-MASTER-FOUND
 16222              IF (ERPDEF-KEY-SAVE (1:16) =
 16223                           PD-CONTROL-PRIMARY (1:16))
 16224                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16225                 CONTINUE
 16226              ELSE
 16227                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16228                 IF (ERPDEF-KEY-SAVE (1:16) =
 16229                           PD-CONTROL-PRIMARY (1:16))
 16230                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16231                    CONTINUE
 16232                 ELSE
 16233                    MOVE ER-2740 TO WS-ERROR
 16234                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16235                    GO TO 3770-CHECK-REFUNDS
 16236                 END-IF
 16237              END-IF
 16238           END-IF
 16239           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16240        END-IF
 16241     END-IF
 16242     IF PDEF-MASTER-FOUND
 16243        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16244           (V1 > +8)
 16245           OR (PD-PROD-CODE (V1) = 'I')
 16246        END-PERFORM
 16247        IF V1 < +9
 16248           SET DD-IU-PRESENT        TO TRUE
 16249        END-IF
 16250        IF WS-AH-DCC-TRUNC = 'T'
 16251           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16252        ELSE
 16253           MOVE CP-ORIGINAL-TERM    TO WS-TERM
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 293
* EL050.cbl
 16254        END-IF
 16255        EVALUATE TRUE
 16256           WHEN WS-TERM > +168
 16257              MOVE 15               TO V1
 16258           WHEN WS-TERM > +156
 16259              MOVE 14               TO V1
 16260           WHEN WS-TERM > +144
 16261              MOVE 13               TO V1
 16262           WHEN WS-TERM > +132
 16263              MOVE 12               TO V1
 16264           WHEN WS-TERM > +120
 16265              MOVE 11               TO V1
 16266           WHEN WS-TERM > +108
 16267              MOVE 10               TO V1
 16268           WHEN WS-TERM > +96
 16269              MOVE 9                TO V1
 16270           WHEN WS-TERM > +84
 16271              MOVE 8                TO V1
 16272           WHEN WS-TERM > +72
 16273              MOVE 7                TO V1
 16274           WHEN WS-TERM > +60
 16275              MOVE 6                TO V1
 16276           WHEN WS-TERM > +48
 16277              MOVE 5                TO V1
 16278           WHEN WS-TERM > +36
 16279              MOVE 4                TO V1
 16280           WHEN WS-TERM > +24
 16281              MOVE 3                TO V1
 16282           WHEN WS-TERM > +12
 16283              MOVE 2                TO V1
 16284           WHEN OTHER
 16285              MOVE 1                TO V1
 16286        END-EVALUATE
 16287
 16288        EVALUATE TRUE
 16289*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 16290*             < +13)
 16291*             AND (DD-IU-PRESENT)
 16292*             MOVE 2                TO V2
 16293*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 16294*             MOVE 1                TO V2
 16295           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 16296              MOVE 2                TO V2
 16297           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 16298              MOVE 3                TO V2
 16299           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 16300              MOVE 4                TO V2
 16301           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 16302              MOVE 5                TO V2
 16303           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 16304              MOVE 6                TO V2
 16305           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 16306              MOVE 7                TO V2
 16307           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 16308              MOVE 8                TO V2
 16309           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 16310              MOVE 9                TO V2
 16311           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 294
* EL050.cbl
 16312              MOVE 10               TO V2
 16313           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 16314              MOVE 11               TO V2
 16315           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 16316              MOVE 12               TO V2
 16317           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 16318              MOVE 13               TO V2
 16319           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 16320              MOVE 14               TO V2
 16321           WHEN OTHER
 16322              MOVE 15               TO V2
 16323        END-EVALUATE
 16324
 16325        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 16326                                 TO CP-DDF-LO-FACT
 16327        MOVE PD-UEP-FACTOR (V1 V2)
 16328                                 TO CP-DDF-HI-FACT
 16329
 16330        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 16331        MOVE CM-AH-CLP     TO CP-DDF-CLP
 16332        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 16333           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 16334        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 16335        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 16336        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 16337           + PD-1ST-YR-ADMIN-ALLOW
 16338
 16339        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16340*       IF PI-CLP-YN = 'Y'
 16341*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 16342*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 16343*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 16344*       END-IF
 16345
 16346        IF DD-IU-PRESENT
 16347           MOVE 'I'              TO CP-EARNING-METHOD
 16348        END-IF
 16349        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16350                                     CP-CLP-RATE-UP
 16351        IF CP-IU-RATE-UP NOT = ZEROS
 16352           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 16353              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 16354           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 16355              / (1 - WS-WORK-FACT)
 16356        END-IF
 16357     END-IF
 16358     .
 16359 3750-CONTINUE.
 16360     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16361
 16362     IF CP-REFUND-TYPE-USED NOT = SPACE
 16363         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16364
 16365     IF CP-ERROR-RATE-IS-ZERO OR
 16366        CP-ERROR-RATE-NOT-FOUND
 16367        MOVE ER-2740             TO WS-ERROR
 16368        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16369
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 295
* EL050.cbl
 16370     IF CP-ERROR-RATE-FILE-NOTOPEN
 16371        MOVE ER-2617             TO WS-ERROR
 16372        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16373     IF PB-COMPANY-ID = 'DCC'
 16374        AND PB-CI-ENTRY-STATUS = 'M'
 16375        MOVE +0                  TO PB-C-AH-REF-CALC
 16376     ELSE
 16377        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 16378     END-IF
 16379     IF PB-COMPANY-ID = 'DCC'
 16380        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16381        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16382        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16383        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16384        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16385        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16386        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16387        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16388        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16389     END-IF
 16390     GO TO 3770-CHECK-REFUNDS.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 296
* EL050.cbl
 16392
 16393 3770-CHECK-REFUNDS.
 16394
 16395     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16396        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16397           MOVE ER-2766          TO WS-ERROR
 16398           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16399           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16400           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16401              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16402
 16403     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16404        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16405           MOVE ER-2766          TO WS-ERROR
 16406           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16407           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16408           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16409              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16410
 16411     IF PB-COMP-LF-CANCEL
 16412        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 16413        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16414           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16415              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16416
 16417     IF PB-COMP-AH-CANCEL
 16418        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16419        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16420           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16421              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16422
 16423     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16424             GIVING WS-UNSIGN-WRK1
 16425     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16426             GIVING WS-UNSIGN-WRK2.
 16427
 16428     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16429         MOVE ZERO TO WS-UNSIGN-WRK1.
 16430
 16431     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16432         MOVE ZERO TO WS-UNSIGN-WRK2.
 16433
 16434     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16435
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 297
* EL050.cbl
 16437
 16438 3772-CONTINUE.
 16439
 16440**********************************
 16441*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16442*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16443*** DOUBLES THE TOLERANCE AMOUNT.
 16444***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16445**********************************
 16446     IF PB-COMPANY-ID = 'MON'
 16447     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND
 16448         IF WS-REF-REJECT-SW = SPACE
 16449             MOVE ER-2754        TO WS-ERROR
 16450             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16451           ELSE
 16452             MOVE ER-2736        TO WS-ERROR
 16453             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16454**********************************
 16455
 16456 3773-CONTINUE.
 16457
 16458     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16459        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16460           MOVE ER-2723          TO WS-ERROR
 16461           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16462
 16463     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16464        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16465           MOVE ER-2724          TO WS-ERROR
 16466           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16467
 16468     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16469         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16470             (1 + WS-LF-REFUND-OVS-PCT)
 16471     ELSE
 16472         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16473
 16474     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16475         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16476             (1 - WS-TOL-LF-REFUND-PCT)
 16477     ELSE
 16478         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16479
 16480     IF (PB-COMPANY-ID = 'DCC')
 16481        AND (PB-CI-ENTRY-STATUS = 'M')
 16482        AND (PB-C-LF-CANCEL-AMT > +0)
 16483        MOVE ER-3843             TO WS-ERROR
 16484        PERFORM 9900-ERROR-FORMAT
 16485                                 THRU 9900-EXIT
 16486     END-IF
 16487     EVALUATE TRUE
 16488        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16489           CONTINUE
 16490        WHEN PB-C-LF-CANCEL-AMT = +0
 16491                 AND PB-C-LF-REF-CALC > +0
 16492           CONTINUE
 16493        WHEN WS-LF-REFUND-OVS-AMT = 0
 16494                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 298
* EL050.cbl
 16495           CONTINUE
 16496        WHEN OTHER
 16497           IF WS-TOL-LF-REFUND  = +0
 16498              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16499           END-IF
 16500           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16501                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16502                          (PB-C-LF-CANCEL-AMT))
 16503              CONTINUE
 16504           ELSE
 16505              IF WS-LF-REFUND-OVS-AMT = +0
 16506                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16507              END-IF
 16508              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16509                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16510                                       PB-C-LF-CANCEL-AMT)
 16511                 CONTINUE
 16512              ELSE
 16513                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16514                   MOVE ER-2754   TO  WS-ERROR
 16515                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16516                 ELSE
 16517                    MOVE ER-2736   TO  WS-ERROR
 16518                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16519                 END-IF
 16520              END-IF
 16521           END-IF
 16522     END-EVALUATE.
 16523
 16524     EVALUATE TRUE
 16525        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16526           CONTINUE
 16527        WHEN PB-C-LF-CANCEL-AMT = +0
 16528                 AND PB-C-LF-REF-CALC > +0
 16529           CONTINUE
 16530        WHEN OTHER
 16531           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16532               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16533              CONTINUE
 16534           ELSE
 16535              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16536               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16537                CONTINUE
 16538              ELSE
 16539                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16540                     MOVE ER-2754   TO  WS-ERROR
 16541                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16542                 ELSE
 16543                     MOVE ER-2736   TO  WS-ERROR
 16544                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16545                 END-IF
 16546              END-IF
 16547           END-IF
 16548     END-EVALUATE.
 16549
 16550     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16551         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16552             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 299
* EL050.cbl
 16553     ELSE
 16554         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16555
 16556     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16557         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16558             (1 - WS-TOL-AH-REFUND-PCT)
 16559     ELSE
 16560         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16561
 16562     IF (PB-COMPANY-ID = 'DCC')
 16563        AND (PB-CI-ENTRY-STATUS = 'M')
 16564        AND (PB-C-AH-CANCEL-AMT > +0)
 16565        MOVE ER-3843             TO WS-ERROR
 16566        PERFORM 9900-ERROR-FORMAT
 16567                                 THRU 9900-EXIT
 16568     END-IF
 16569     EVALUATE TRUE
 16570        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16571           CONTINUE
 16572*       WHEN PB-C-AH-REF-CALC = +0 AND
 16573*                  PB-C-AH-CANCEL-AMT > +0
 16574        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16575                   PB-C-AH-REF-CALC > +0
 16576           CONTINUE
 16577        WHEN WS-AH-REFUND-OVS-AMT = +0
 16578                AND WS-TOL-AH-REFUND = +0
 16579           CONTINUE
 16580        WHEN OTHER
 16581           IF WS-TOL-AH-REFUND = +0
 16582              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16583           END-IF
 16584           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16585               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16586                                         PB-C-AH-CANCEL-AMT)
 16587              CONTINUE
 16588           ELSE
 16589              IF WS-AH-REFUND-OVS-AMT = +0
 16590                 MOVE +9999999.99 TO
 16591                         WS-AH-REFUND-OVS-AMT
 16592              END-IF
 16593              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16594                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16595                                         PB-C-AH-CANCEL-AMT)
 16596                 CONTINUE
 16597              ELSE
 16598                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16599                    MOVE ER-2754   TO  WS-ERROR
 16600                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16601                 ELSE
 16602                    MOVE ER-2736   TO  WS-ERROR
 16603                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16604                 END-IF
 16605              END-IF
 16606           END-IF
 16607     END-EVALUATE.
 16608
 16609     EVALUATE TRUE
 16610        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 300
* EL050.cbl
 16611           CONTINUE
 16612*       WHEN PB-C-AH-REF-CALC > +0 AND
 16613*                  PB-C-AH-CANCEL-AMT = +0
 16614        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16615                   PB-C-AH-REF-CALC = +0
 16616           CONTINUE
 16617        WHEN OTHER
 16618           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16619               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16620              CONTINUE
 16621           ELSE
 16622              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16623                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16624                 CONTINUE
 16625              ELSE
 16626                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16627                     MOVE ER-2754   TO  WS-ERROR
 16628                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16629                 ELSE
 16630                     MOVE ER-2736   TO  WS-ERROR
 16631                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16632                 END-IF
 16633              END-IF
 16634           END-IF
 16635     END-EVALUATE.
 16636
 16637     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16638        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16639        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16640           AND  PB-C-LF-REF-CALC < +1.00
 16641           AND  PB-C-AH-REF-CALC < +1.00
 16642           CONTINUE
 16643        ELSE
 16644           IF (PB-COMPANY-ID = 'DCC')
 16645              AND (PB-CI-ENTRY-STATUS = 'M')
 16646              CONTINUE
 16647           ELSE
 16648              MOVE ER-2741       TO WS-ERROR
 16649              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16650           END-IF
 16651        END-IF
 16652     END-IF
 16653
 16654     IF (PB-C-LF-CANCEL-AMT = ZERO
 16655        AND WS-LF-BENEFIT-CD NOT = ZERO
 16656        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16657        AND PB-C-LF-REF-CALC NOT = ZERO)
 16658        OR
 16659        (PB-C-LF-CANCEL-AMT = ZERO
 16660        AND WS-LF-BENEFIT-CD NOT = ZERO
 16661        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16662             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16663                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16664                NEXT SENTENCE
 16665             ELSE
 16666                MOVE ER-2739        TO WS-ERROR
 16667                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16668
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 301
* EL050.cbl
 16669     IF (PB-C-AH-CANCEL-AMT = ZERO
 16670        AND WS-AH-BENEFIT-CD NOT = ZERO
 16671        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16672        AND PB-C-AH-REF-CALC NOT = ZERO)
 16673        OR
 16674        (PB-C-AH-CANCEL-AMT = ZERO
 16675        AND WS-AH-BENEFIT-CD NOT = ZERO
 16676        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16677             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16678                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16679                NEXT SENTENCE
 16680             ELSE
 16681                MOVE ER-2738        TO WS-ERROR
 16682                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16683
 16684 3775-OVER-REF-CHK.
 16685
 16686     IF PB-CI-ENTRY-STATUS = '5'
 16687        GO TO 3780-UPDATE-CANCEL-CERT.
 16688
 16689     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 16690                              PB-CI-LF-ALT-PREMIUM-AMT.
 16691
 16692     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16693        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16694                                 PB-C-LF-REF-CALC
 16695      ELSE
 16696        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16697                                 PB-C-LF-CANCEL-AMT.
 16698
 16699     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 16700        MOVE ER-2755             TO WS-ERROR
 16701        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16702
 16703     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 16704
 16705     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 16706        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16707                                 PB-C-AH-REF-CALC
 16708      ELSE
 16709        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16710                                 PB-C-AH-CANCEL-AMT.
 16711
 16712     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 16713        MOVE ER-2778             TO WS-ERROR
 16714        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16715
 16716     IF PB-CI-OB-FLAG NOT = 'Z'
 16717        NEXT SENTENCE
 16718       ELSE
 16719         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16720            MOVE ER-2757           TO WS-ERROR
 16721            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16722
 16723 3780-UPDATE-CANCEL-CERT.
 16724
 16725     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 16726        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 302
* EL050.cbl
 16727        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16728
 16729     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 16730         MOVE ER-2729              TO WS-ERROR
 16731         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16732
 16733     IF PB-CI-LF-BENEFIT-CD = ZERO
 16734         GO TO 3780-UPDATE-CONT-1.
 16735
 16736     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 16737         GO TO 3780-UPDATE-CONT-1.
 16738
 16739     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16740       AND
 16741        (PB-C-LF-CANCEL-AMT NEGATIVE)
 16742       AND
 16743        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 16744       AND
 16745        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16746            NEXT SENTENCE
 16747       ELSE
 16748        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16749          AND
 16750***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16751***       AND
 16752           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 16753            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16754               MOVE ER-2730      TO WS-ERROR
 16755               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16756               GO TO 3999-END-EDIT
 16757            ELSE
 16758               GO TO 3999-END-EDIT
 16759        ELSE
 16760            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 16761               MOVE ER-2765           TO WS-ERROR
 16762               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16763               GO TO 3785-CHECK-NH.
 16764*              GO TO 3999-END-EDIT.
 16765
 16766 3780-UPDATE-CONT-1.
 16767     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 16768
 16769     IF PB-CI-AH-BENEFIT-CD = ZERO
 16770         GO TO 3780-UPDATE-CONT-2.
 16771
 16772     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 16773         GO TO 3780-UPDATE-CONT-2.
 16774
 16775     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 16776
 16777     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16778       AND
 16779        (PB-C-AH-CANCEL-AMT NEGATIVE)
 16780       AND
 16781        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 16782       AND
 16783        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 16784            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 303
* EL050.cbl
 16785       ELSE
 16786        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16787          AND
 16788***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16789***       AND
 16790           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 16791           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 16792            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16793               MOVE ER-2773      TO WS-ERROR
 16794               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16795               GO TO 3999-END-EDIT
 16796            ELSE
 16797               GO TO 3999-END-EDIT
 16798            END-IF
 16799           ELSE
 16800             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16801                MOVE ER-2890 TO WS-ERROR
 16802                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16803                GO TO 3999-END-EDIT
 16804             ELSE
 16805                GO TO 3785-CHECK-NH
 16806             END-IF
 16807           END-IF
 16808          ELSE
 16809            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 16810              IF WS-AH-CLAIM-RESCINDED = 'Y'
 16811                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16812                   MOVE ER-2890 TO WS-ERROR
 16813                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16814                   GO TO 3999-END-EDIT
 16815                ELSE
 16816                   MOVE ER-2765 TO WS-ERROR
 16817                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16818                   GO TO 3785-CHECK-NH
 16819                END-IF
 16820              ELSE
 16821               MOVE ER-2765      TO WS-ERROR
 16822               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16823               GO TO 3785-CHECK-NH.
 16824*              GO TO 3999-END-EDIT.
 16825
 16826 3780-UPDATE-CONT-2.
 16827
 16828     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 16829        AND WS-LF-BENEFIT-CD = ZERO
 16830           MOVE ER-2743           TO WS-ERROR
 16831           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16832
 16833     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 16834        AND WS-AH-BENEFIT-CD = ZERO
 16835           MOVE ER-2744           TO WS-ERROR
 16836           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16837
 16838     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 16839        (PB-C-AH-CANCEL-AMT NEGATIVE))
 16840        AND
 16841        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 16842         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 304
* EL050.cbl
 16843           MOVE ER-2746           TO WS-ERROR
 16844           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16845
 16846     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16847       AND
 16848        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 16849             MOVE ER-2737        TO WS-ERROR
 16850             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16851
 16852     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16853       AND
 16854        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 16855             MOVE ER-2737        TO WS-ERROR
 16856             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16857
 16858     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 16859         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 16860             OR 'CID' OR 'DCC' OR 'AHL'
 16861             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 16862         ELSE
 16863             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 16864                 MOVE ER-2768    TO WS-ERROR
 16865                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16866             ELSE
 16867                 MOVE ER-2756    TO WS-ERROR
 16868                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16869
 16870     IF CERT-PEND-ISSUE-RETURNED
 16871        MOVE ER-2772             TO WS-ERROR
 16872        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16873 3785-CHECK-NH.
 16874     IF PB-STATE NOT = 'NH'
 16875        GO TO 3999-END-EDIT
 16876     END-IF
 16877
 16878     MOVE ER-2796                TO WS-ERROR
 16879     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 16880     IF (PB-C-REF-INTERFACE-SW = 'Y')
 16881        OR (CM-NH-INTERFACE-SW = 'Y')
 16882        MOVE ER-2793             TO WS-ERROR
 16883        PERFORM 9900-ERROR-FORMAT
 16884                                 THRU 9900-EXIT
 16885     END-IF
 16886     MOVE +0                     TO WS-PAYMENT-AMT
 16887     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 16888        GO TO 3999-END-EDIT
 16889     END-IF
 16890     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 16891        GO TO 3999-END-EDIT
 16892     END-IF
 16893     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16894     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 16895     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 16896        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 16897     END-IF
 16898     MOVE '1'                    TO DC-OPTION-CODE
 16899     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16900     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 305
* EL050.cbl
 16901        IF DC-ELAPSED-DAYS < +16
 16902           GO TO 3999-END-EDIT
 16903        END-IF
 16904     END-IF
 16905     MOVE +0                     TO DC-ELAPSED-DAYS
 16906     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 16907     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 16908     MOVE '1'                    TO DC-OPTION-CODE
 16909     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16910     IF NO-CONVERSION-ERROR
 16911        IF DC-ELAPSED-DAYS > +30
 16912           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 16913        ELSE
 16914           GO TO 3999-END-EDIT
 16915        END-IF
 16916     ELSE
 16917        GO TO 3999-END-EDIT
 16918     END-IF
 16919     COMPUTE WS-PAYMENT-AMT ROUNDED =
 16920        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 16921           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 16922     IF WS-PAYMENT-AMT < 600.00
 16923        GO TO 3999-END-EDIT
 16924     END-IF
 16925     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 16926
 16927     IF (ERMAIL-FOUND = ' ')
 16928         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 16929         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 16930        GO TO 3999-END-EDIT
 16931     END-IF
 16932     MOVE ER-2795                TO WS-ERROR
 16933     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 16934
 16935     GO TO 3999-END-EDIT.
 16936******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 306
* EL050.cbl
 16938 3990-FILES-NOT-OPEN.
 16939
 16940     MOVE ER-2617                TO WS-ERROR.
 16941     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16942     GO TO 9990-RETURN.
 16943
 16944 3999-END-EDIT.
 16945
 16946     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 16947
 16948     IF PB-CANCELLATION AND CERT-WAS-FOUND
 16949         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 16950         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16951             PERFORM 9250-UNLOCK-RETURN
 16952             GO TO 9990-RETURN
 16953          ELSE
 16954             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16955             GO TO 9990-RETURN.
 16956
 16957     IF PB-CANCELLATION
 16958          GO TO 9990-RETURN.
 16959
 16960     IF CERT-WAS-NOT-FOUND
 16961        MOVE SPACES              TO CERTIFICATE-MASTER.
 16962
 16963     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 16964
 16965     IF CERT-WAS-FOUND
 16966         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16967             PERFORM 9250-UNLOCK-RETURN
 16968          ELSE
 16969            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16970      ELSE
 16971         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 16972
 16973     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 16974        IF PB-COMPANY-ID = 'DCC' AND
 16975           (PB-CARRIER = '2' OR '4' OR '6')
 16976              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 16977        END-IF
 16978     END-IF.
 16979
 16980     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 16981         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 16982     END-IF.
 16983     move ' '                    to ws-ins-age-defaulted
 16984     perform 8150-read-elcrtt    thru 8150-exit
 16985     if ws-ins-age-defaulted = 'Y'
 16986        move er-1573             to ws-error
 16987        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16988     end-if
 16989
 16990     if ws-jnt-age-defaulted = 'Y'
 16991        move er-1574             to ws-error
 16992        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16993     end-if
 16994
 16995     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 307
* EL050.cbl
 16996     IF ((PB-COMPANY-ID = 'DCC')
 16997        AND (WS-NO-SECURE-PAY))
 16998                  OR
 16999        (WS-LF-SPECIAL-CALC-CD = 'O'
 17000        OR WS-AH-SPECIAL-CALC-CD = 'O')
 17001        SET SKIP-ADDR-EDIT       TO TRUE
 17002     END-IF
 17003     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 17004        AND (NOT SKIP-ADDR-EDIT)
 17005        MOVE ER-2963             TO WS-ERROR
 17006        PERFORM 9900-ERROR-FORMAT
 17007                                 THRU 9900-EXIT
 17008        GO TO 9990-RETURN
 17009     END-IF
 17010     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 17011     IF ERPNDM-FOUND NOT = 'X'
 17012        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17013           OR (PM-CITY        = SPACES OR LOW-VALUES)
 17014           OR (PM-STATE       = SPACES OR LOW-VALUES)
 17015           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 17016           AND (NOT SKIP-ADDR-EDIT)
 17017           MOVE ER-2694          TO WS-ERROR
 17018           PERFORM 9900-ERROR-FORMAT
 17019                                 THRU 9900-EXIT
 17020        END-IF
 17021        MOVE ' '                 TO STATE-RECORD-ERROR
 17022        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17023        MOVE PM-STATE            TO CNTL-ACCESS
 17024        MOVE '3'                 TO CNTL-REC-TYPE
 17025        MOVE +0                  TO CNTL-SEQ-NO
 17026        MOVE '0'                 TO RC-SW-2
 17027        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17028        IF (NO-STATE-RECORD)
 17029           OR (CF-RECORD-TYPE NOT = '3')
 17030           OR (PM-STATE NOT = CF-STATE-CODE)
 17031           IF (PM-STATE = SPACES)
 17032              AND (SKIP-ADDR-EDIT)
 17033              CONTINUE
 17034           ELSE
 17035              MOVE ER-2963       TO WS-ERROR
 17036              PERFORM 9900-ERROR-FORMAT
 17037                                 THRU 9900-EXIT
 17038           END-IF
 17039        END-IF
 17040        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 17041           MOVE ER-2883          TO WS-ERROR
 17042           PERFORM 9900-ERROR-FORMAT
 17043                                 THRU 9900-EXIT
 17044        END-IF
 17045        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 17046           MOVE ' '                 TO STATE-RECORD-ERROR
 17047           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17048           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 17049           MOVE '3'                 TO CNTL-REC-TYPE
 17050           MOVE +0                  TO CNTL-SEQ-NO
 17051           MOVE '0'                 TO RC-SW-2
 17052           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17053           IF NO-STATE-RECORD
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 308
* EL050.cbl
 17054              OR (CF-RECORD-TYPE NOT = '3')
 17055              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 17056              MOVE ER-2964          TO WS-ERROR
 17057              PERFORM 9900-ERROR-FORMAT
 17058                                    THRU 9900-EXIT
 17059           END-IF
 17060        END-IF
 17061     ELSE
 17062        IF NOT SKIP-ADDR-EDIT
 17063           MOVE ER-2393          TO WS-ERROR
 17064           PERFORM 9900-ERROR-FORMAT
 17065                                 THRU 9900-EXIT
 17066        END-IF
 17067     END-IF
 17068
 17069     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17070
 17071     IF (ERMAIL-FOUND = ' ' AND
 17072        ERPNDM-FOUND = ' ')
 17073        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 17074           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 17075           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 17076          OR
 17077           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 17078          OR
 17079           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 17080           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 17081           GO TO 3999-UNLOCK-ERMAIL.
 17082
 17083     IF ERPNDM-FOUND = 'X'
 17084        GO TO 3999-UNLOCK-ERMAIL.
 17085
 17086     IF PM-INSURED-LAST-NAME      = SPACES
 17087        AND PM-INSURED-FIRST-NAME = SPACES
 17088        AND PM-ADDRESS-LINE-1     = SPACES
 17089        AND PM-ADDRESS-LINE-2     = SPACES
 17090        AND PM-CITY-STATE         = SPACES
 17091        AND PM-CRED-BENE-NAME     = SPACES
 17092        AND PM-CRED-BENE-ADDR     = SPACES
 17093        AND PM-CRED-BENE-CTYST    = SPACES
 17094        GO TO 3999-UNLOCK-ERMAIL
 17095     END-IF
 17096
 17097     MOVE SPACES                 TO MAILING-DATA.
 17098
 17099     MOVE 'MA'                   TO MA-RECORD-ID.
 17100     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 17101     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 17102     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 17103     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 17104     MOVE PB-SV-STATE            TO MA-STATE.
 17105     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 17106     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 17107
 17108     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 17109     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 17110
 17111     IF ERMAIL-FOUND = ' '
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 309
* EL050.cbl
 17112        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 17113     ELSE
 17114        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 17115        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 17116        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 17117
 17118     GO TO 9990-RETURN.
 17119
 17120 3999-UNLOCK-ERMAIL.
 17121     IF ERMAIL-FOUND = ' '
 17122        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 17123
 17124     GO TO 9990-RETURN.
 17125******************************************************************
 17126
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 310
* EL050.cbl
 17128 4000-UPDATE-CANCELLED-CERT.
 17129     IF CERT-WAS-NOT-FOUND
 17130        GO TO 4299-EXIT.
 17131
 17132*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 17133     IF PB-C-NH-INT-ON-REFS > ZEROS
 17134        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 17135     END-IF
 17136     IF PB-C-REF-INTERFACE-SW = 'Y'
 17137        MOVE PB-C-REF-INTERFACE-SW
 17138                                 TO CM-NH-INTERFACE-SW
 17139     END-IF
 17140     IF PB-C-POST-CARD-IND = 'Y'
 17141        MOVE +8                  TO SUB
 17142        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17143        IF ERMAIL-FOUND = ' '
 17144           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 17145              (SUB > +7)
 17146              OR (MA-MAIL-STATUS (SUB) = '1')
 17147           END-PERFORM
 17148        END-IF
 17149        IF (SUB > +7)
 17150           OR (ERMAIL-FOUND = 'X')
 17151           MOVE ER-3789          TO WS-ERROR
 17152           PERFORM 9900-ERROR-FORMAT
 17153                                 THRU 9900-EXIT
 17154        END-IF
 17155     ELSE
 17156        MOVE 'N'                 TO PB-C-POST-CARD-IND
 17157     END-IF
 17158     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 17159
 17160     IF PB-CI-OB-FLAG = 'Z'
 17161        GO TO 4150-SUMMARY-CERT-CANCEL.
 17162
 17163     IF PB-C-LF-CANCEL-VOIDED
 17164         PERFORM 4200-REVERSE-LF-CANCEL.
 17165     IF PB-C-AH-CANCEL-VOIDED
 17166         PERFORM 4200-REVERSE-AH-CANCEL.
 17167
 17168 4100-APPLY-LF-CANCEL.
 17169
 17170     MOVE +0                     TO WS-SUB.
 17171
 17172 4100-CHECK-LF-ERRORS.
 17173
 17174     ADD +1                       TO WS-SUB.
 17175
 17176     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17177        IF LF-COVERAGE-CANCELLED
 17178           GO TO 4100-LF-CANCEL-CONT
 17179        ELSE
 17180           GO TO 4100-UPDATE-LF-COVERAGE.
 17181
 17182     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17183                                   ER-2729 OR
 17184                                   ER-2730 OR
 17185                                   ER-2731 OR
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 311
* EL050.cbl
 17186                                   ER-2732 OR
 17187                                   ER-2737 OR
 17188                                   ER-2740 OR
 17189                                   ER-2743 OR
 17190                                   ER-2749 OR
 17191                                   ER-2750 OR
 17192                                   ER-2755 OR
 17193                                   ER-2757 OR
 17194                                   ER-2760 OR
 17195                                   ER-2772 OR
 17196                                   ER-2774 OR
 17197                                   ER-2776 OR
 17198                                   ER-2794
 17199        GO TO 4100-UPDATE-LF-COVERAGE.
 17200
 17201     GO TO 4100-CHECK-LF-ERRORS.
 17202
 17203 4100-UPDATE-LF-COVERAGE.
 17204
 17205     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 17206     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 17207     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 17208        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 17209     END-IF
 17210     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17211                                      TO CM-CREDIT-INTERFACE-SW-2.
 17212     IF CM-LF-CANCEL-DT = LOW-VALUE
 17213         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 17214
 17215     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 17216         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 17217                                         CM-LF-STATUS-AT-CANCEL.
 17218
 17219     GO TO 4100-APPLY-AH-CANCEL.
 17220
 17221 4100-LF-CANCEL-CONT.
 17222     IF PB-C-LF-CANCEL-VOIDED
 17223         GO TO 4100-APPLY-AH-CANCEL.
 17224
 17225     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17226         GO TO 4100-APPLY-AH-CANCEL.
 17227
 17228     IF PB-C-LF-CANCEL-AMT GREATER ZERO
 17229        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17230           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 17231        ELSE
 17232           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 17233
 17234     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 17235     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 17236
 17237     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 17238         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 17239
 17240     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 17241        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 17242         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 17243         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 312
* EL050.cbl
 17244
 17245     IF PB-RECORD-RETURNED
 17246        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17247      ELSE
 17248        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 17249
 17250 4100-APPLY-AH-CANCEL.
 17251
 17252     MOVE +0                      TO WS-SUB.
 17253
 17254 4100-CHECK-AH-ERRORS.
 17255
 17256     ADD +1                       TO WS-SUB.
 17257
 17258     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17259        IF AH-COVERAGE-CANCELLED
 17260           GO TO 4100-AH-CANCEL-CONT
 17261        ELSE
 17262           GO TO 4100-UPDATE-AH-COVERAGE.
 17263
 17264     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17265                                   ER-2729 OR
 17266                                   ER-2732 OR
 17267                                   ER-2737 OR
 17268                                   ER-2740 OR
 17269                                   ER-2744 OR
 17270                                   ER-2749 OR
 17271                                   ER-2750 OR
 17272                                   ER-2755 OR
 17273                                   ER-2757 OR
 17274                                   ER-2760 OR
 17275                                   ER-2771 OR
 17276                                   ER-2772 OR
 17277                                   ER-2773 OR
 17278                                   ER-2775 OR
 17279                                   ER-2777 OR
 17280                                   ER-2794
 17281        GO TO 4100-UPDATE-AH-COVERAGE.
 17282
 17283     GO TO 4100-CHECK-AH-ERRORS.
 17284
 17285 4100-UPDATE-AH-COVERAGE.
 17286
 17287     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 17288     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 17289     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 17290     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17291                                      TO CM-CREDIT-INTERFACE-SW-2.
 17292     IF CM-AH-CANCEL-DT = LOW-VALUE
 17293         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 17294
 17295     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 17296         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 17297                                         CM-AH-STATUS-AT-CANCEL.
 17298
 17299     IF LF-COVERAGE-CANCELLED
 17300         IF PB-RECORD-RETURNED
 17301              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 313
* EL050.cbl
 17302          ELSE
 17303              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 17304
 17305     GO TO 4299-EXIT.
 17306
 17307 4100-AH-CANCEL-CONT.
 17308     IF PB-C-AH-CANCEL-VOIDED
 17309         GO TO 4299-EXIT.
 17310
 17311     if cm-credit-interface-sw-2 = ' '
 17312        if pb-fatal-errors or pb-unforced-errors
 17313           move '4'              to cm-credit-interface-sw-2
 17314        else
 17315           move '1'              to cm-credit-interface-sw-2
 17316        end-if
 17317     end-if
 17318     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17319         GO TO 4299-EXIT.
 17320
 17321     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 17322        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17323           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 17324        ELSE
 17325           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 17326
 17327     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 17328     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 17329
 17330     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 17331         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 17332
 17333     IF CM-AH-STATUS-AT-CANCEL = SPACE
 17334         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 17335         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 17336
 17337     IF PB-RECORD-RETURNED
 17338        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 17339      ELSE
 17340        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 17341
 17342     GO TO 4299-EXIT.
 17343
 17344 4150-SUMMARY-CERT-CANCEL.
 17345     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 17346
 17347     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17348        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17349                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 17350     ELSE
 17351        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17352                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 17353
 17354     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17355        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17356                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 17357     ELSE
 17358        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17359                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 314
* EL050.cbl
 17360
 17361     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17362        NEXT SENTENCE
 17363     ELSE
 17364        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 17365
 17366     GO TO 4299-EXIT.
 17367
 17368 4200-REVERSE-LF-CANCEL.
 17369     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 17370
 17371     IF CM-LF-CANCEL-APPLIED
 17372        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 17373        MOVE SPACES                TO CM-LF-EXIT-BATCH
 17374        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 17375
 17376     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 17377
 17378     IF PB-RECORD-RETURNED
 17379        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17380       ELSE
 17381        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17382
 17383 4200-REVERSE-LF-EXIT.
 17384       EXIT.
 17385
 17386 4200-REVERSE-AH-CANCEL.
 17387     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17388
 17389     IF CM-AH-CANCEL-APPLIED
 17390        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17391        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17392        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17393
 17394     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17395
 17396     IF PB-RECORD-RETURNED
 17397        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17398       ELSE
 17399        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17400
 17401 4200-REVERSE-AH-EXIT.
 17402       EXIT.
 17403
 17404 4299-EXIT.
 17405       EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 315
* EL050.cbl
 17407
 17408 4500-UPDATE-NEW-CERT.
 17409     IF CERT-WAS-FOUND
 17410         NEXT SENTENCE
 17411       ELSE
 17412         GO TO 4520-BUILD-NEW-KEY.
 17413
 17414     IF  CLASIC-CREATED-CERT
 17415         GO TO 4999-EXIT.
 17416
 17417     IF  CERT-WAS-CREATED-FOR-CLAIM
 17418         GO TO 4520-BUILD-NEW-KEY.
 17419
 17420     IF CERT-ADDED-BATCH
 17421        IF CM-RECORD-ID = 'CM'
 17422            GO TO 4999-EXIT.
 17423
 17424 4520-BUILD-NEW-KEY.
 17425* BUILD CONTROL PRIMARY
 17426
 17427     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17428                                       CM-COMPANY-CD-A1
 17429                                       CM-COMPANY-CD-A2
 17430                                       CM-COMPANY-CD-A4
 17431                                       CM-COMPANY-CD-A5.
 17432
 17433     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17434     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17435     MOVE PB-SV-STATE               TO CM-STATE.
 17436     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17437     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17438     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17439     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17440
 17441     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17442
 17443     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17444     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17445     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17446     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17447
 17448     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17449        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17450
 17451     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17452         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17453         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17454         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17455         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17456     ELSE
 17457         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17458
 17459     IF PB-COMPANY-ID   EQUAL  'CRI'
 17460         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17461         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17462         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17463         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17464         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 316
* EL050.cbl
 17465
 17466     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17467        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17468         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17469
 17470     IF PB-COMPANY-ID  = 'LBL'
 17471        IF PB-I-JOINT-COVERAGE
 17472            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17473                                           PB-I-MEMBER-NO
 17474            GO TO 4550-CONT-CERT-PROCESS.
 17475
 17476     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17477        NEXT SENTENCE
 17478     ELSE
 17479        GO TO 4540-BUILD-MEMBER-NO.
 17480
 17481******************************************************************
 17482*                                                                *
 17483*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17484*    FOR 'MON'.                                                  *
 17485*                                                                *
 17486******************************************************************
 17487
 17488     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17489     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17490     MOVE +1                     TO WS-SUB1
 17491                                    WS-SUB2.
 17492
 17493 4530-EDIT-MEMB-NAME.
 17494
 17495     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17496        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17497        ADD +1                       TO WS-SUB2.
 17498
 17499     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17500        ADD +1                       TO WS-SUB1
 17501        GO TO 4530-EDIT-MEMB-NAME.
 17502
 17503     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17504     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17505     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17506*    MOVE SPACE                      TO DC-OPTION-CODE.
 17507     SET  BIN-TO-GREG                TO TRUE.
 17508     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17509     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17510
 17511     GO TO 4550-CONT-CERT-PROCESS.
 17512
 17513******************************************************************
 17514*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17515******************************************************************
 17516
 17517 4540-BUILD-MEMBER-NO.
 17518
 17519     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17520         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17521         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17522         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 317
* EL050.cbl
 17523         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17524     ELSE
 17525         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17526
 17527     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17528        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17529         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17530
 17531 4550-CONT-CERT-PROCESS.
 17532
 17533*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17534*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17535*    ELSE
 17536*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17537
 17538     IF CERT-WAS-CREATED-FOR-CLAIM
 17539        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17540        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17541
 17542     IF CERT-AND-CLAIM-ONLINE
 17543        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17544        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17545
 17546     MOVE 'CM'                     TO CM-RECORD-ID.
 17547     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17548
 17549     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17550        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17551        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17552     ELSE
 17553        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17554        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17555
 17556     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17557     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17558     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17559     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17560     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 17561     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 17562     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 17563                                      CM-LF-ITD-CANCEL-AMT
 17564                                      CM-LF-ITD-DEATH-AMT
 17565                                      CM-AH-ITD-AH-PMT
 17566                                      CM-AH-ITD-LUMP-PMT
 17567                                      CM-AH-ITD-CANCEL-AMT
 17568                                      CM-LF-NSP-PREMIUM-AMT
 17569                                      CM-AH-NSP-PREMIUM-AMT.
 17570*                                     CM-CLAIM-DEDUCT-WITHHELD
 17571*                                     CM-CANCEL-DEDUCT-WITHHELD.
 17572     if pb-i-loan-apr = +99.9999
 17573        move zeros                 to cm-loan-apr
 17574     else
 17575        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 17576     end-if
 17577     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 17578     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 17579     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 17580     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 318
* EL050.cbl
 17581     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 17582     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 17583     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 17584     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 17585     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 17586     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 17587     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 17588
 17589     IF PB-I-LIVES NOT NUMERIC
 17590         MOVE ZERO                 TO PB-I-LIVES.
 17591
 17592     IF PB-I-NUM-BILLED NOT NUMERIC
 17593         MOVE ZERO                 TO PB-I-NUM-BILLED.
 17594
 17595     MOVE PB-I-LIVES               TO CM-LIVES.
 17596     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 17597
 17598     IF PB-COMPANY-ID EQUAL  'DMD'
 17599         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 17600         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 17601
 17602     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 17603     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 17604     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 17605     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 17606     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 17607     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 17608
 17609     IF PB-I-LF-POLICY-FEE NUMERIC
 17610        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 17611     ELSE
 17612        MOVE +0                    TO CM-LF-POLICY-FEE.
 17613
 17614     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17615        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 17616        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 17617     ELSE
 17618        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 17619
 17620     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 17621     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 17622     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 17623     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 17624     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 17625     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 17626     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 17627     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 17628     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 17629
 17630     IF PB-I-AH-POLICY-FEE NUMERIC
 17631        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE
 17632     ELSE
 17633        MOVE +0                    TO CM-AH-POLICY-FEE.
 17634
 17635     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17636        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 17637     ELSE
 17638        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 319
* EL050.cbl
 17639
 17640     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 17641     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 17642
 17643     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 17644                                      CM-LF-DEATH-EXIT-DT
 17645                                      CM-AH-SETTLEMENT-EXIT-DT.
 17646
 17647*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 17648*                       'TIH' OR 'OFL' OR 'FLA' OR
 17649*                       'TII' OR 'TMS' OR 'CRI' OR
 17650*                       'NCL'
 17651     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 17652
 17653     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 17654         IF WS-LF-SPECIAL-CALC-CD = 'O'
 17655            MOVE '2'                TO CM-PREMIUM-TYPE.
 17656
 17657     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 17658         IF WS-AH-SPECIAL-CALC-CD = 'O'
 17659            MOVE '2'                TO CM-PREMIUM-TYPE.
 17660
 17661     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 17662         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 17663     ELSE
 17664         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 17665         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 17666
 17667     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 17668     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 17669     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 17670     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 17671     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 17672     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 17673     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 17674     MOVE SPACE                     TO CM-PAYMENT-MODE.
 17675
 17676     IF PB-NO-MONTHS-SKIPPED
 17677         MOVE SPACE                 TO CM-SKIP-CODE
 17678     ELSE
 17679         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 17680
 17681     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 17682     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 17683                                       CM-LF-STATUS-AT-CANCEL.
 17684
 17685     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 17686     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 17687                                       CM-AH-STATUS-AT-CANCEL.
 17688
 17689     MOVE '1'                       TO CM-ENTRY-STATUS.
 17690
 17691     IF PB-REISSUED-CERT
 17692        MOVE '5'                    TO CM-ENTRY-STATUS.
 17693
 17694     IF PB-MONTHLY-CERT
 17695        MOVE 'M'                    TO CM-ENTRY-STATUS.
 17696
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 320
* EL050.cbl
 17697     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 17698     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 17699     IF PB-POLICY-IS-DECLINED
 17700        MOVE 'D'                    TO CM-ENTRY-STATUS.
 17701
 17702     IF PB-POLICY-IS-VOIDED
 17703        MOVE 'V'                    TO CM-ENTRY-STATUS.
 17704
 17705     IF PB-NEEDS-UNDERWRITING
 17706        MOVE 'U'                    TO CM-ENTRY-STATUS.
 17707
 17708     IF PB-REIN-ONLY-CERT
 17709        MOVE '9'                    TO CM-ENTRY-STATUS.
 17710
 17711     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 17712         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 17713     ELSE
 17714         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 17715
 17716     IF PB-RECORD-RETURNED
 17717        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 17718      ELSE
 17719        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 17720
 17721     IF PB-I-MAIL-ADDRS-PRESENT
 17722        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 17723
 17724     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 17725                                       CM-ENTRY-DT.
 17726
 17727 4999-EXIT.
 17728     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 321
* EL050.cbl
 17730
 17731 5000-PROCESS-REPS.
 17732     MOVE ' '                    TO AGTC-MASTER-SW
 17733     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 17734     MOVE CO-TYPE                TO AGTC-TYPE
 17735     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 17736     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 17737     IF (AGTC-MASTER-SW NOT = 'N')
 17738        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 17739        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 17740        PERFORM 8583-READ-ERAGTC-NEXT
 17741                                 THRU 8583-EXIT
 17742     END-IF
 17743     IF AGTC-MASTER-SW = 'N'
 17744        CONTINUE
 17745     ELSE
 17746        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 17747           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 17748              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 17749              MOVE 'Y'           TO AGTC-MASTER-SW
 17750           END-IF
 17751        END-IF
 17752     END-IF
 17753     .
 17754 5000-EXIT.
 17755     EXIT.
 17756 6370-EDIT-INPUT-LF-CODE.
 17757     move ' ' to ws-benefit-cd-chg-sw
 17758     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 17759        MOVE +1                  TO SUB
 17760        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 17761        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17762        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17763        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17764        GO TO 6370-SEARCH-LOOP.
 17765
 17766     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17767
 17768     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17769     MOVE SPACES                 TO CNTL-ACCESS.
 17770*    MOVE 'L'                    TO CNTL-REC-TYPE.
 17771     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 17772     MOVE +0                     TO CNTL-SEQ-NO.
 17773     MOVE '4' TO RC-SW-2.
 17774     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17775
 17776     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17777        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17778        GO TO 6370-NO-LF-FOUND.
 17779
 17780     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 17781     MOVE +1                     TO SUB.
 17782
 17783 6370-SEARCH-LOOP.
 17784     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 17785         GO TO 6370-NO-LF-FOUND.
 17786
 17787     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 322
* EL050.cbl
 17788        if (pb-i-lf-benefit-cd not = zeros and spaces)
 17789           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 17790           set benefit-code-chg to true
 17791        end-if
 17792        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 17793        GO TO 6370-HER-NET-PAY-CHECK.
 17794
 17795     ADD 1   TO SUB.
 17796*    IF SUB GREATER 120
 17797     IF SUB GREATER 200
 17798         GO TO 6370-NO-LF-FOUND.
 17799
 17800     GO TO 6370-SEARCH-LOOP.
 17801
 17802 6370-NO-LF-FOUND.
 17803
 17804     if (pb-i-lf-benefit-cd not = zeros and spaces)
 17805        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 17806        set benefit-code-chg to true
 17807     end-if
 17808     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 17809
 17810 6370-HER-NET-PAY-CHECK.
 17811
 17812     IF PB-COMPANY-ID = 'CID'
 17813        IF PB-SV-STATE = 'CA' OR 'MN'
 17814           IF PB-I-LF-BENEFIT-CD = '02'
 17815              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 17816           ELSE
 17817              IF PB-I-LF-BENEFIT-CD = '04'
 17818                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 17819              END-IF
 17820           END-IF
 17821        END-IF
 17822     END-IF
 17823
 17824     IF PB-COMPANY-ID NOT = 'HER'
 17825         GO TO 6370-EXIT.
 17826
 17827     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 17828         GO TO 6370-EXIT.
 17829
 17830     IF PB-I-LF-TERM NOT NUMERIC
 17831         MOVE ZEROS              TO PB-I-LF-TERM.
 17832
 17833     IF PB-I-LOAN-TERM NOT NUMERIC
 17834         MOVE ZEROS              TO PB-I-LOAN-TERM.
 17835
 17836     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 17837         GO TO 6370-EXIT.
 17838
 17839     IF PB-I-LF-BENEFIT-CD = '33'
 17840         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 17841
 17842     IF PB-I-LF-BENEFIT-CD = '34'
 17843         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 17844
 17845 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 323
* EL050.cbl
 17846     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 324
* EL050.cbl
 17848
 17849 6380-EDIT-INPUT-AH-CODE.
 17850     IF WK-AH-EDIT-ADDR NOT = ZEROS
 17851        MOVE +1                  TO SUB
 17852        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 17853        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17854        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17855        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17856        GO TO 6380-SEARCH-LOOP.
 17857
 17858     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17859
 17860     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17861     MOVE SPACES                 TO CNTL-ACCESS.
 17862     MOVE 'A'                    TO CNTL-REC-TYPE.
 17863*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 17864     MOVE +0                     TO CNTL-SEQ-NO.
 17865     MOVE '5' TO RC-SW-2.
 17866     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17867
 17868     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17869        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17870        GO TO 6380-NO-AH-FOUND.
 17871
 17872     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 17873     MOVE +1 TO SUB.
 17874
 17875 6380-SEARCH-LOOP.
 17876     IF CF-AH-CODE-OUT (SUB) = ZEROS
 17877         GO TO 6380-NO-AH-FOUND.
 17878
 17879     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 17880         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 17881         GO TO 6380-CSO-AH-ONLY-CHECKS.
 17882
 17883     ADD 1   TO SUB.
 17884     IF SUB GREATER THAN 96
 17885*    IF SUB GREATER THAN 300
 17886         GO TO 6380-NO-AH-FOUND.
 17887
 17888     GO TO 6380-SEARCH-LOOP.
 17889
 17890 6380-NO-AH-FOUND.
 17891
 17892     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 17893
 17894     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 17895         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 17896     ELSE
 17897         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 17898
 17899 6380-CSO-AH-ONLY-CHECKS.
 17900
 17901     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 17902        NEXT SENTENCE
 17903      ELSE
 17904        GO TO 6380-EXIT.
 17905
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 325
* EL050.cbl
 17906     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 17907         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 17908
 17909
 17910     GO TO 6380-EXIT
 17911     .
 17912 6380-CSO-LIFE-WITH-AH-CHECKS.
 17913
 17914
 17915     .
 17916 6380-EXIT.
 17917     EXIT.
 17918
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 326
* EL050.cbl
 17920
 17921 6400-COMPUTE-EXTENSION-DAYS.
 17922
 17923******************************************************************
 17924*                                                                *
 17925*                   COMPUTE EXTENSION DAYS                       *
 17926*                                                                *
 17927*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 17928*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 17929*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 17930*    THE EXTENSION DAYS.                                         *
 17931*                                                                *
 17932******************************************************************
 17933
 17934     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 17935     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 17936
 17937******************************************************************
 17938*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 17939*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 17940******************************************************************
 17941
 17942     IF DC-ELAPSED-MONTHS GREATER THAN +0
 17943        COMPUTE WS-ODD-DAYS-OVER =
 17944               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 17945     ELSE
 17946        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 17947
 17948     IF WS-ODD-DAYS-OVER = ZEROS
 17949           GO TO 6499-EXIT
 17950     ELSE
 17951        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 17952           IF WS-WDF-MONTH = 02
 17953              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 17954              ADD 2       TO  WS-ODD-DAYS-OVER
 17955              GO TO 6499-EXIT
 17956           ELSE
 17957              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 17958                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 17959                 GO TO 6499-EXIT
 17960               ELSE
 17961                 GO TO 6499-EXIT
 17962        ELSE
 17963           GO TO 6499-EXIT.
 17964
 17965 6412-CHECK-TO-DAY.
 17966
 17967        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 17968           IF WS-WDT-DAY = 28
 17969              ADD 2              TO WS-ODD-DAYS-OVER
 17970           ELSE
 17971              IF WS-WDT-DAY = 29
 17972                 ADD 1           TO WS-ODD-DAYS-OVER
 17973              ELSE
 17974                 NEXT SENTENCE
 17975        ELSE
 17976           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 17977              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 327
* EL050.cbl
 17978
 17979     GO TO 6499-EXIT.
 17980
 17981
 17982 6415-CHECK-LEAP-YEAR.
 17983
 17984     IF DC-DAYS-IN-MONTH = 29
 17985        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 17986
 17987 6415-EXIT.
 17988     EXIT.
 17989
 17990 6499-EXIT.
 17991      EXIT.
 17992
 17993 6500-END.
 17994     EXIT.
 17995
 17996
 17997******************************************************************
 17998************* PROCEDURE DIVISION FOR EL050 ***********************
 17999********************** ELC50PD END *******************************
 18000
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 328
* EL050.cbl
 18002
 18003**START***********************************************************
 18004*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 18005*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 18006******************************************************************
 18007*
 18008 6600-GET-STATE-MUNICIPAL-TAX.
 18009
 18010     IF PB-COMPANY-ID NOT = 'DMD'
 18011         GO TO 6640-EXIT.
 18012
 18013     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 18014     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 18015     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 18016*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 18017*
 18018***  Y2K PROJ 7744
 18019     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18020     SET BIN-TO-GREG          TO TRUE.
 18021     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18022
 18023     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18024
 18025     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 18026     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 18027
 18028
 18029* EXEC CICS HANDLE CONDITION
 18030*        INVREQ    (6610-START-BROWSE)
 18031*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18032*        NOTFND    (6630-END-OF-FILE)
 18033*    END-EXEC.
 18034*    MOVE '"$8JI                 ! # #00018016' TO DFHEIV0
 18035     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 18036     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18037     MOVE X'2320233030303138303136' TO DFHEIV0(25:11)
 18038     CALL 'kxdfhei1' USING DFHEIV0
 18039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18040
 18041
 18042 6610-START-BROWSE.
 18043
 18044
 18045* EXEC CICS HANDLE CONDITION
 18046*        NOTFND    (6630-END-OF-FILE)
 18047*        DISABLED  (6630-ERRESS-PROBLEM)
 18048*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18049*        ENDFILE   (6630-END-OF-FILE)
 18050*    END-EXEC.
 18051*    MOVE '"$IcJ''                ! $ #00018024' TO DFHEIV0
 18052     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18053     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18054     MOVE X'2420233030303138303234' TO DFHEIV0(25:11)
 18055     CALL 'kxdfhei1' USING DFHEIV0
 18056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18057
 18058
 18059
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 329
* EL050.cbl
 18060* EXEC CICS STARTBR
 18061*        DATASET (FILE-ID-ERRESS)
 18062*        RIDFLD  (WS-ERRESS-KEY)
 18063*        GTEQ
 18064*    END-EXEC.
 18065     MOVE 0
 18066       TO DFHEIV11
 18067*    MOVE '&,         G          &   #00018031' TO DFHEIV0
 18068     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18069     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18070     MOVE X'2020233030303138303331' TO DFHEIV0(25:11)
 18071     CALL 'kxdfhei1' USING DFHEIV0,
 18072           FILE-ID-ERRESS,
 18073           WS-ERRESS-KEY,
 18074           DFHEIV99,
 18075           DFHEIV11,
 18076           DFHEIV99
 18077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18078
 18079
 18080 6620-READ-NEXT-ERRESS-MASTER.
 18081
 18082
 18083* EXEC CICS HANDLE CONDITION
 18084*        NOTFND    (6630-END-OF-FILE)
 18085*        ENDFILE   (6630-END-OF-FILE)
 18086*        DISABLED  (6630-ERRESS-PROBLEM)
 18087*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18088*    END-EXEC.
 18089*    MOVE '"$I''cJ                ! % #00018039' TO DFHEIV0
 18090     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 18091     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18092     MOVE X'2520233030303138303339' TO DFHEIV0(25:11)
 18093     CALL 'kxdfhei1' USING DFHEIV0
 18094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18095
 18096
 18097
 18098* EXEC CICS READNEXT
 18099*        DATASET (FILE-ID-ERRESS)
 18100*        INTO    (RESIDENT-STATE-TAX-MASTER)
 18101*        RIDFLD  (WS-ERRESS-KEY)
 18102*    END-EXEC.
 18103     MOVE LENGTH OF
 18104      RESIDENT-STATE-TAX-MASTER
 18105       TO DFHEIV12
 18106     MOVE 0
 18107       TO DFHEIV11
 18108*    MOVE '&.IL                  )   #00018046' TO DFHEIV0
 18109     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18110     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18111     MOVE X'2020233030303138303436' TO DFHEIV0(25:11)
 18112     CALL 'kxdfhei1' USING DFHEIV0,
 18113           FILE-ID-ERRESS,
 18114           RESIDENT-STATE-TAX-MASTER,
 18115           DFHEIV12,
 18116           WS-ERRESS-KEY,
 18117           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 330
* EL050.cbl
 18118           DFHEIV11,
 18119           DFHEIV99,
 18120           DFHEIV99
 18121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18122
 18123
 18124     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 18125
 18126* EXEC CICS ENDBR
 18127*            DATASET (FILE-ID-ERRESS)
 18128*       END-EXEC
 18129     MOVE 0
 18130       TO DFHEIV11
 18131*    MOVE '&2                    $   #00018053' TO DFHEIV0
 18132     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18133     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18134     MOVE X'2020233030303138303533' TO DFHEIV0(25:11)
 18135     CALL 'kxdfhei1' USING DFHEIV0,
 18136           FILE-ID-ERRESS,
 18137           DFHEIV11,
 18138           DFHEIV99
 18139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18140        GO TO 6630-END-OF-FILE.
 18141
 18142     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 18143        NEXT SENTENCE
 18144      ELSE
 18145        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 18146
 18147*IS IT LIFE(1) OR IS IT P&C(2) ?????
 18148*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 18149*
 18150     MOVE +2                     TO WS-SUB1.
 18151
 18152     IF PB-ISSUE
 18153     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 18154        MOVE +1                  TO WS-SUB1.
 18155
 18156     IF PB-CANCELLATION
 18157     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 18158        MOVE +1                  TO WS-SUB1.
 18159*
 18160*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 18161*
 18162***  Y2K PROJ 7744
 18163     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 18164***  Y2K PROJ 7744
 18165
 18166*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 18167* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 18168* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 18169
 18170     ADD 1                    TO WS-YEAR-YY.
 18171
 18172     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 18173         MOVE RES-REN-STATE-TAX (WS-SUB1)
 18174                              TO WS-RES-STATE-TAX
 18175         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 331
* EL050.cbl
 18176                              TO WS-RES-MUNI-TAX
 18177     ELSE
 18178         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 18179                              TO WS-RES-STATE-TAX
 18180         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 18181                              TO WS-RES-MUNI-TAX.
 18182
 18183*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 18184
 18185     IF PB-CANCELLATION
 18186         GO TO 6640-CANCEL-TAX.
 18187
 18188     IF PB-I-LF-PREMIUM-AMT > ZEROS
 18189         COMPUTE PB-I-STATE-TAX ROUNDED =
 18190                                   PB-I-LF-PREMIUM-AMT
 18191                                 * WS-RES-STATE-TAX
 18192         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18193                                   PB-I-LF-PREMIUM-AMT
 18194                                 * WS-RES-MUNI-TAX
 18195     ELSE
 18196     IF PB-I-AH-PREMIUM-AMT > ZEROS
 18197         COMPUTE PB-I-STATE-TAX ROUNDED =
 18198                                   PB-I-AH-PREMIUM-AMT
 18199                                 * WS-RES-STATE-TAX
 18200         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18201                                   PB-I-AH-PREMIUM-AMT
 18202                                 * WS-RES-MUNI-TAX.
 18203
 18204
 18205* EXEC CICS ENDBR
 18206*         DATASET (FILE-ID-ERRESS)
 18207*    END-EXEC.
 18208     MOVE 0
 18209       TO DFHEIV11
 18210*    MOVE '&2                    $   #00018120' TO DFHEIV0
 18211     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18212     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18213     MOVE X'2020233030303138313230' TO DFHEIV0(25:11)
 18214     CALL 'kxdfhei1' USING DFHEIV0,
 18215           FILE-ID-ERRESS,
 18216           DFHEIV11,
 18217           DFHEIV99
 18218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18219
 18220
 18221     GO TO 6640-EXIT.
 18222
 18223 6640-CANCEL-TAX.
 18224     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 18225
 18226     IF PB-C-LF-CANCEL-AMT > ZEROS
 18227         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18228                                   PB-C-LF-CANCEL-AMT
 18229                                 * WS-RES-STATE-TAX
 18230         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18231                                   PB-C-LF-CANCEL-AMT
 18232                                *  WS-RES-MUNI-TAX
 18233     ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 332
* EL050.cbl
 18234     IF PB-C-AH-CANCEL-AMT > ZEROS
 18235         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18236                                   PB-C-AH-CANCEL-AMT
 18237                                 * WS-RES-STATE-TAX
 18238         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18239                                   PB-C-AH-CANCEL-AMT
 18240                                *  WS-RES-MUNI-TAX.
 18241
 18242
 18243* EXEC CICS ENDBR
 18244*         DATASET (FILE-ID-ERRESS)
 18245*    END-EXEC.
 18246     MOVE 0
 18247       TO DFHEIV11
 18248*    MOVE '&2                    $   #00018145' TO DFHEIV0
 18249     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18250     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18251     MOVE X'2020233030303138313435' TO DFHEIV0(25:11)
 18252     CALL 'kxdfhei1' USING DFHEIV0,
 18253           FILE-ID-ERRESS,
 18254           DFHEIV11,
 18255           DFHEIV99
 18256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18257
 18258
 18259     GO TO 6640-EXIT.
 18260
 18261 6630-END-OF-FILE.
 18262     MOVE ER-8002              TO WS-ERROR.
 18263     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18264
 18265     GO TO 6640-EXIT.
 18266
 18267 6630-ERRESS-PROBLEM.
 18268     MOVE ER-8044              TO WS-ERROR.
 18269     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18270
 18271 6640-EXIT.
 18272     EXIT.
 18273
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 333
* EL050.cbl
 18275 6650-GET-RES-STATE-COMM.
 18276
 18277     IF PB-COMPANY-ID NOT = 'DMD'
 18278         GO TO 6700-COMM-EXIT.
 18279
 18280     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 18281     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 18282     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 18283     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 18284     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 18285     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 18286     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 18287
 18288*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 18289*
 18290***  Y2K PROJ 7744
 18291     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18292     SET BIN-TO-GREG          TO TRUE.
 18293     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18294
 18295     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18296***  Y2K PROJ 7744
 18297
 18298     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 18299
 18300
 18301* EXEC CICS HANDLE CONDITION
 18302*        INVREQ    (6660-START-BROWSE)
 18303*        DISABLED  (6690-ERRESC-PROBLEM)
 18304*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18305*        NOTFND    (6690-END-OF-FILE)
 18306*    END-EXEC.
 18307*    MOVE '"$8cJI                ! & #00018190' TO DFHEIV0
 18308     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 18309     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18310     MOVE X'2620233030303138313930' TO DFHEIV0(25:11)
 18311     CALL 'kxdfhei1' USING DFHEIV0
 18312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18313
 18314
 18315
 18316* EXEC CICS RESETBR
 18317*        DATASET (FILE-ID-ERRESC)
 18318*        RIDFLD  (WS-ERRESC-KEY)
 18319*    END-EXEC.
 18320     MOVE 0
 18321       TO DFHEIV11
 18322*    MOVE '&4         G          &   #00018197' TO DFHEIV0
 18323     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18324     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18325     MOVE X'2020233030303138313937' TO DFHEIV0(25:11)
 18326     CALL 'kxdfhei1' USING DFHEIV0,
 18327           FILE-ID-ERRESC,
 18328           WS-ERRESC-KEY,
 18329           DFHEIV99,
 18330           DFHEIV11,
 18331           DFHEIV99
 18332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 334
* EL050.cbl
 18333
 18334
 18335 6660-START-BROWSE.
 18336
 18337
 18338* EXEC CICS HANDLE CONDITION
 18339*        NOTFND    (6690-END-OF-FILE)
 18340*        DISABLED  (6690-ERRESC-PROBLEM)
 18341*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18342*        ENDFILE   (6690-END-OF-FILE)
 18343*    END-EXEC.
 18344*    MOVE '"$IcJ''                ! '' #00018204' TO DFHEIV0
 18345     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18346     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18347     MOVE X'2720233030303138323034' TO DFHEIV0(25:11)
 18348     CALL 'kxdfhei1' USING DFHEIV0
 18349     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18350
 18351
 18352
 18353* EXEC CICS STARTBR
 18354*        DATASET (FILE-ID-ERRESC)
 18355*        RIDFLD  (WS-ERRESC-KEY)
 18356*        GTEQ
 18357*    END-EXEC.
 18358     MOVE 0
 18359       TO DFHEIV11
 18360*    MOVE '&,         G          &   #00018211' TO DFHEIV0
 18361     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18362     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18363     MOVE X'2020233030303138323131' TO DFHEIV0(25:11)
 18364     CALL 'kxdfhei1' USING DFHEIV0,
 18365           FILE-ID-ERRESC,
 18366           WS-ERRESC-KEY,
 18367           DFHEIV99,
 18368           DFHEIV11,
 18369           DFHEIV99
 18370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18371
 18372
 18373     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 18374
 18375 6670-READ-NEXT-ERRESC-MASTER.
 18376
 18377
 18378* EXEC CICS HANDLE CONDITION
 18379*        NOTFND    (6690-END-OF-FILE)
 18380*        DISABLED  (6690-ERRESC-PROBLEM)
 18381*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18382*        ENDFILE   (6690-END-OF-FILE)
 18383*    END-EXEC.
 18384*    MOVE '"$IcJ''                ! ( #00018221' TO DFHEIV0
 18385     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18386     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18387     MOVE X'2820233030303138323231' TO DFHEIV0(25:11)
 18388     CALL 'kxdfhei1' USING DFHEIV0
 18389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18390
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 335
* EL050.cbl
 18391
 18392
 18393* EXEC CICS READNEXT
 18394*        DATASET (FILE-ID-ERRESC)
 18395*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18396*        RIDFLD  (ERRESC-RECORD-KEY)
 18397*    END-EXEC.
 18398     MOVE LENGTH OF
 18399      ACCOUNT-RESIDENT-ST-COMMISSION
 18400       TO DFHEIV12
 18401     MOVE 0
 18402       TO DFHEIV11
 18403*    MOVE '&.IL                  )   #00018228' TO DFHEIV0
 18404     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18405     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18406     MOVE X'2020233030303138323238' TO DFHEIV0(25:11)
 18407     CALL 'kxdfhei1' USING DFHEIV0,
 18408           FILE-ID-ERRESC,
 18409           ACCOUNT-RESIDENT-ST-COMMISSION,
 18410           DFHEIV12,
 18411           ERRESC-RECORD-KEY,
 18412           DFHEIV99,
 18413           DFHEIV11,
 18414           DFHEIV99,
 18415           DFHEIV99
 18416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18417
 18418
 18419     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18420        NEXT SENTENCE
 18421     ELSE
 18422
 18423* EXEC CICS ENDBR
 18424*            DATASET (FILE-ID-ERRESC)
 18425*       END-EXEC
 18426     MOVE 0
 18427       TO DFHEIV11
 18428*    MOVE '&2                    $   #00018237' TO DFHEIV0
 18429     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18430     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18431     MOVE X'2020233030303138323337' TO DFHEIV0(25:11)
 18432     CALL 'kxdfhei1' USING DFHEIV0,
 18433           FILE-ID-ERRESC,
 18434           DFHEIV11,
 18435           DFHEIV99
 18436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18437        GO TO 6690-END-OF-FILE.
 18438
 18439     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18440
 18441* EXEC CICS ENDBR
 18442*            DATASET (FILE-ID-ERRESC)
 18443*       END-EXEC
 18444     MOVE 0
 18445       TO DFHEIV11
 18446*    MOVE '&2                    $   #00018243' TO DFHEIV0
 18447     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18448     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 336
* EL050.cbl
 18449     MOVE X'2020233030303138323433' TO DFHEIV0(25:11)
 18450     CALL 'kxdfhei1' USING DFHEIV0,
 18451           FILE-ID-ERRESC,
 18452           DFHEIV11,
 18453           DFHEIV99
 18454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18455        GO TO 6690-END-OF-FILE.
 18456
 18457     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18458        NEXT SENTENCE
 18459      ELSE
 18460        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18461
 18462* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18463*
 18464     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18465
 18466     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18467
 18468     IF WS-SUB1 > ZERO
 18469         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18470             PERFORM 6680-SET-COMMISSION
 18471         ELSE
 18472             PERFORM 6680-SET-TABLE-CODE.
 18473
 18474
 18475* EXEC CICS ENDBR
 18476*         DATASET (FILE-ID-ERRESC)
 18477*    END-EXEC.
 18478     MOVE 0
 18479       TO DFHEIV11
 18480*    MOVE '&2                    $   #00018265' TO DFHEIV0
 18481     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18482     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18483     MOVE X'2020233030303138323635' TO DFHEIV0(25:11)
 18484     CALL 'kxdfhei1' USING DFHEIV0,
 18485           FILE-ID-ERRESC,
 18486           DFHEIV11,
 18487           DFHEIV99
 18488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18489
 18490
 18491     GO TO 6700-COMM-EXIT.
 18492
 18493 6680-SET-TABLE-CODE.
 18494     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18495        MOVE ZEROS             TO WS-SUB1
 18496     ELSE
 18497* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18498* TO COMPUTE AH COMMISSION.
 18499        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18500        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18501        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18502        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18503        PERFORM 6680-READ-CTBL-TABLE
 18504        IF WS-CTBL-READ-SW NOT = 'Y'
 18505           MOVE ZEROS          TO WS-SUB1.
 18506
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 337
* EL050.cbl
 18507 6680-READ-CTBL-TABLE.
 18508*
 18509* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18510* TO COMPUTE LIFE COMMISSION
 18511
 18512     IF CTBL-SW = '0540'
 18513        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18514        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18515        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18516
 18517     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18518
 18519     IF CTBL-TABLE-FOUND
 18520        IF CTBL-SW = '0530'
 18521             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18522                                    * PB-I-AH-TERM
 18523             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18524             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18525        ELSE
 18526             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18527             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18528             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18529     ELSE
 18530        IF FIRST-TIME-THROUGH
 18531            GO TO 6680-READ-CTBL-TABLE
 18532        ELSE
 18533            MOVE ZEROS         TO WS-SUB1.
 18534
 18535 6680-SET-COMMISSION.
 18536     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18537           MOVE ZEROS          TO WS-SUB1
 18538       ELSE
 18539           MOVE RESC-COMMISSION-PER (WS-SUB)
 18540                               TO WS-COMMISSION
 18541           IF CTBL-SW = '0530'
 18542               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18543           ELSE
 18544               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18545
 18546 6680-SEARCH-CATEGORY.
 18547     ADD +1                   TO WS-SUB.
 18548     IF WS-SUB > +12
 18549         GO TO 6680-EXIT.
 18550
 18551     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18552          MOVE WS-SUB         TO WS-SUB1
 18553          GO TO 6680-EXIT.
 18554
 18555     GO TO 6680-SEARCH-CATEGORY.
 18556
 18557 6680-EXIT.
 18558     EXIT.
 18559
 18560 6690-END-OF-FILE.
 18561     GO TO 6700-COMM-EXIT.
 18562
 18563 6690-ERRESC-PROBLEM.
 18564      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 338
* EL050.cbl
 18565      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18566
 18567      GO TO 6700-COMM-EXIT.
 18568
 18569 6700-COMM-EXIT.
 18570     EXIT.
 18571
 18572 7000-GET-RATE.
 18573
 18574* EXEC CICS LINK
 18575*        PROGRAM    ('ELRATE')
 18576*        COMMAREA   (CALCULATION-PASS-AREA)
 18577*        LENGTH     (CP-COMM-LENGTH)
 18578*    END-EXEC.
 18579     MOVE 'ELRATE' TO DFHEIV1
 18580*    MOVE '."C                   (   #00018351' TO DFHEIV0
 18581     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18582     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18583     MOVE X'2020233030303138333531' TO DFHEIV0(25:11)
 18584     CALL 'kxdfhei1' USING DFHEIV0,
 18585           DFHEIV1,
 18586           CALCULATION-PASS-AREA,
 18587           CP-COMM-LENGTH,
 18588           DFHEIV99,
 18589           DFHEIV99,
 18590           DFHEIV99,
 18591           DFHEIV99
 18592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18593
 18594
 18595 7000-EXIT.
 18596     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 339
* EL050.cbl
 18598 7100-FIND-BENEFIT-IN-STATE.
 18599     MOVE 'N'                    TO BEN-SEARCH-SW.
 18600
 18601     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 18602         VARYING SUB3 FROM 1 BY 1 UNTIL
 18603            ((SUB3 GREATER 50) OR
 18604              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 18605               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 18606
 18607     IF SUB3 NOT = 51
 18608         MOVE 'Y'                TO BEN-SEARCH-SW.
 18609
 18610     GO TO 7199-EXIT.
 18611
 18612 7100-BENEFIT-DUMMY.
 18613
 18614 7100-DUMMY-EXIT.
 18615     EXIT.
 18616
 18617 7199-EXIT.
 18618     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 340
* EL050.cbl
 18620 7200-FIND-BENEFIT.
 18621     MOVE 'N'                    TO BEN-SEARCH-SW.
 18622
 18623     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18624         VARYING SUB3 FROM 1 BY 1 UNTIL
 18625            ((SUB3 GREATER 8) OR
 18626            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 18627
 18628     IF SUB3 NOT = 9
 18629         MOVE 'Y'                TO BEN-SEARCH-SW.
 18630
 18631     GO TO 7200-EXIT.
 18632
 18633 7200-BENEFIT-DUMMY.
 18634
 18635 7200-DUMMY-EXIT.
 18636     EXIT.
 18637
 18638 7200-EXIT.
 18639     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 341
* EL050.cbl
 18641 7250-LOOK-FOR-RESCINDED-CLAIM.
 18642     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18643                                    W-CL-COMP-CD.
 18644     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18645                                    W-CL-CERT-NO.
 18646
 18647
 18648* EXEC CICS HANDLE CONDITION
 18649*        NOTFND  (7250-CONTINUE)
 18650*        ENDFILE (7250-CONTINUE)
 18651*    END-EXEC.
 18652*    MOVE '"$I''                  ! ) #00018409' TO DFHEIV0
 18653     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18654     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18655     MOVE X'2920233030303138343039' TO DFHEIV0(25:11)
 18656     CALL 'kxdfhei1' USING DFHEIV0
 18657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18658
 18659
 18660
 18661* EXEC CICS IGNORE CONDITION
 18662*        DUPKEY
 18663*    END-EXEC.
 18664*    MOVE '"*$                   !   #00018414' TO DFHEIV0
 18665     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18666     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18667     MOVE X'2020233030303138343134' TO DFHEIV0(25:11)
 18668     CALL 'kxdfhei1' USING DFHEIV0
 18669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18670
 18671
 18672
 18673* EXEC CICS STARTBR
 18674*        DATASET   (CLMS-ID)
 18675*        RIDFLD    (ELMSTR-KEY)
 18676*        GENERIC   EQUAL
 18677*        KEYLENGTH (ELMSTR-LENGTH)
 18678*    END-EXEC.
 18679     MOVE 0
 18680       TO DFHEIV11
 18681*    MOVE '&,   KG    E          &   #00018418' TO DFHEIV0
 18682     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18683     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18684     MOVE X'2020233030303138343138' TO DFHEIV0(25:11)
 18685     CALL 'kxdfhei1' USING DFHEIV0,
 18686           CLMS-ID,
 18687           ELMSTR-KEY,
 18688           ELMSTR-LENGTH,
 18689           DFHEIV11,
 18690           DFHEIV99
 18691     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18692
 18693
 18694     MOVE 'Y'                    TO W-BROWSE-SW.
 18695
 18696 7250-NEXT-CLAIM.
 18697
 18698
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 342
* EL050.cbl
 18699* EXEC CICS READNEXT
 18700*        DATASET   (CLMS-ID)
 18701*        RIDFLD    (ELMSTR-KEY)
 18702*        SET       (ADDRESS OF CLAIM-MASTER)
 18703*    END-EXEC.
 18704     MOVE 0
 18705       TO DFHEIV11
 18706*    MOVE '&.S                   )   #00018429' TO DFHEIV0
 18707     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18708     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18709     MOVE X'2020233030303138343239' TO DFHEIV0(25:11)
 18710     CALL 'kxdfhei1' USING DFHEIV0,
 18711           CLMS-ID,
 18712           DFHEIV20,
 18713           DFHEIV99,
 18714           ELMSTR-KEY,
 18715           DFHEIV99,
 18716           DFHEIV11,
 18717           DFHEIV99,
 18718           DFHEIV99
 18719     SET ADDRESS OF CLAIM-MASTER TO
 18720         DFHEIV20
 18721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18722
 18723
 18724     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18725        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18726         GO TO 7250-CONTINUE
 18727     END-IF.
 18728
 18729     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18730        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18731        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18732        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18733        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18734         GO TO 7250-NEXT-CLAIM
 18735     END-IF.
 18736
 18737     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18738        OR (CL-CLAIM-TYPE = 'I')
 18739        OR (CL-CLAIM-TYPE = 'G')
 18740          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18741              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 18742              GO TO 7250-CONTINUE
 18743          END-IF
 18744     END-IF.
 18745
 18746     GO TO 7250-NEXT-CLAIM.
 18747
 18748 7250-CONTINUE.
 18749
 18750     IF W-BROWSE-SW = 'Y'
 18751
 18752* EXEC CICS ENDBR
 18753*            DATASET   (CLMS-ID)
 18754*        END-EXEC
 18755     MOVE 0
 18756       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 343
* EL050.cbl
 18757*    MOVE '&2                    $   #00018462' TO DFHEIV0
 18758     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18759     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18760     MOVE X'2020233030303138343632' TO DFHEIV0(25:11)
 18761     CALL 'kxdfhei1' USING DFHEIV0,
 18762           CLMS-ID,
 18763           DFHEIV11,
 18764           DFHEIV99
 18765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18766         MOVE 'N' TO W-BROWSE-SW
 18767     END-IF.
 18768
 18769 7250-EXIT.
 18770     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 344
* EL050.cbl
 18772 7300-CHECK-FOR-OPEN-CLMS.
 18773
 18774*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 18775*    MOVE SPACES                 TO CNTL-ACCESS.
 18776*    MOVE '1'                    TO CNTL-REC-TYPE.
 18777*    MOVE +0                     TO CNTL-SEQ-NO.
 18778
 18779*    MOVE '3'                    TO RC-SW-1.
 18780*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 18781
 18782*    IF NOT CF-COMPANY-MASTER
 18783*         PERFORM 0099-COMPANY-NOT-FOUND
 18784*         GO TO 7300-EXIT.
 18785
 18786     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18787                                    W-CL-COMP-CD.
 18788     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18789                                    W-CL-CERT-NO.
 18790
 18791
 18792* EXEC CICS HANDLE CONDITION
 18793*        NOTFND  (7300-CONTINUE)
 18794*        ENDFILE (7300-CONTINUE)
 18795*    END-EXEC.
 18796*    MOVE '"$I''                  ! * #00018490' TO DFHEIV0
 18797     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18798     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18799     MOVE X'2A20233030303138343930' TO DFHEIV0(25:11)
 18800     CALL 'kxdfhei1' USING DFHEIV0
 18801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18802
 18803
 18804
 18805* EXEC CICS IGNORE CONDITION
 18806*        DUPKEY
 18807*    END-EXEC.
 18808*    MOVE '"*$                   !   #00018495' TO DFHEIV0
 18809     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18810     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18811     MOVE X'2020233030303138343935' TO DFHEIV0(25:11)
 18812     CALL 'kxdfhei1' USING DFHEIV0
 18813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18814
 18815
 18816
 18817* EXEC CICS STARTBR
 18818*        DATASET   (CLMS-ID)
 18819*        RIDFLD    (ELMSTR-KEY)
 18820*        GENERIC   EQUAL
 18821*        KEYLENGTH (ELMSTR-LENGTH)
 18822*    END-EXEC.
 18823     MOVE 0
 18824       TO DFHEIV11
 18825*    MOVE '&,   KG    E          &   #00018499' TO DFHEIV0
 18826     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18827     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18828     MOVE X'2020233030303138343939' TO DFHEIV0(25:11)
 18829     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 345
* EL050.cbl
 18830           CLMS-ID,
 18831           ELMSTR-KEY,
 18832           ELMSTR-LENGTH,
 18833           DFHEIV11,
 18834           DFHEIV99
 18835     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18836
 18837
 18838     MOVE 'Y'                    TO W-BROWSE-SW.
 18839
 18840 7300-NEXT-CLAIM.
 18841
 18842
 18843* EXEC CICS READNEXT
 18844*        DATASET   (CLMS-ID)
 18845*        RIDFLD    (ELMSTR-KEY)
 18846*        SET       (ADDRESS OF CLAIM-MASTER)
 18847*    END-EXEC.
 18848     MOVE 0
 18849       TO DFHEIV11
 18850*    MOVE '&.S                   )   #00018510' TO DFHEIV0
 18851     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18852     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18853     MOVE X'2020233030303138353130' TO DFHEIV0(25:11)
 18854     CALL 'kxdfhei1' USING DFHEIV0,
 18855           CLMS-ID,
 18856           DFHEIV20,
 18857           DFHEIV99,
 18858           ELMSTR-KEY,
 18859           DFHEIV99,
 18860           DFHEIV11,
 18861           DFHEIV99,
 18862           DFHEIV99
 18863     SET ADDRESS OF CLAIM-MASTER TO
 18864         DFHEIV20
 18865     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18866
 18867
 18868     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18869        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18870         GO TO 7300-CONTINUE.
 18871
 18872     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18873        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18874        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18875        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18876        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18877         GO TO 7300-NEXT-CLAIM.
 18878
 18879*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 18880     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18881        OR (CL-CLAIM-TYPE = 'I')
 18882        OR (CL-CLAIM-TYPE = 'G')
 18883        IF CLAIM-IS-OPEN
 18884           EVALUATE TRUE
 18885             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 18886                 MOVE ER-2884      TO WS-ERROR
 18887             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 346
* EL050.cbl
 18888                 MOVE ER-2887      TO WS-ERROR
 18889             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 18890                 MOVE ER-2886      TO WS-ERROR
 18891             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 18892                 MOVE ER-2888      TO WS-ERROR
 18893             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 18894                 MOVE ER-2885      TO WS-ERROR
 18895             WHEN OTHER
 18896                 MOVE ER-2768      TO WS-ERROR
 18897           END-EVALUATE
 18898           IF PB-C-AH-CANCEL-VOIDED OR
 18899              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18900                NOT AH-COVERAGE-CANCELLED)
 18901               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18902               MOVE ER-2768      TO WS-ERROR
 18903           END-IF
 18904           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18905           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18906              PB-FORCE-CODE NOT EQUAL '8'
 18907               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18908           END-IF
 18909           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 18910           GO TO 7300-CONTINUE
 18911        ELSE
 18912           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18913*****THIS IS A RESCISSION OR REFORMATION
 18914              IF (AH-COVERAGE-CANCELLED AND
 18915                  PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT)
 18916                    MOVE ER-2890 TO WS-ERROR
 18917                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18918                    GO TO 7300-CONTINUE
 18919              END-IF
 18920           ELSE
 18921              IF CL-DENIAL-TYPE = '1'  AND
 18922                 CL-TOTAL-PAID-AMT = 0
 18923                    GO TO 7300-NEXT-CLAIM
 18924              END-IF
 18925              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 18926               AND PB-C-AH-CANCEL-DT > SPACES
 18927                 MOVE ER-2756        TO WS-ERROR
 18928                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18929                 GO TO 7300-CONTINUE
 18930              END-IF
 18931           END-IF
 18932        END-IF
 18933     ELSE
 18934*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 18935        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 18936           IF CLAIM-IS-OPEN
 18937              MOVE ER-2889      TO WS-ERROR
 18938              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18939              GO TO 7300-CONTINUE
 18940           ELSE
 18941              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18942*****THIS IS A RESCISSION OR REFORMATION
 18943                 IF (LF-COVERAGE-CANCELLED AND
 18944                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 18945                       MOVE ER-2890 TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 347
* EL050.cbl
 18946                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18947                       GO TO 7300-CONTINUE
 18948                 END-IF
 18949              ELSE
 18950                 IF CL-DENIAL-TYPE = '1'  AND
 18951                    CL-TOTAL-PAID-AMT = 0
 18952                       GO TO 7300-NEXT-CLAIM
 18953                 END-IF
 18954                 IF (AH-COVERAGE-CANCELLED AND
 18955                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 18956                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 18957                    (LF-COVERAGE-CANCELLED AND
 18958                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 18959                     WS-ST-REFUND-CLAIM-FLAG = '4')
 18960                       MOVE ER-2965 TO WS-ERROR
 18961                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18962                       GO TO 7300-CONTINUE
 18963                 END-IF
 18964                 IF LF-COVERAGE-CANCELLED
 18965                  IF CL-TOTAL-PAID-AMT > 0
 18966                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 18967                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 18968                        MOVE ER-2891 TO WS-ERROR
 18969                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18970                        GO TO 7300-CONTINUE
 18971                      END-IF
 18972                    ELSE
 18973                      MOVE ER-2892 TO WS-ERROR
 18974                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18975                      GO TO 7300-CONTINUE
 18976                    END-IF
 18977                  END-IF
 18978                 END-IF
 18979              END-IF
 18980           END-IF
 18981        END-IF
 18982     END-IF
 18983
 18984     GO TO 7300-NEXT-CLAIM.
 18985
 18986 7300-CONTINUE.
 18987
 18988     IF W-BROWSE-SW = 'Y'
 18989
 18990* EXEC CICS ENDBR
 18991*            DATASET   (CLMS-ID)
 18992*        END-EXEC.
 18993     MOVE 0
 18994       TO DFHEIV11
 18995*    MOVE '&2                    $   #00018637' TO DFHEIV0
 18996     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18997     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18998     MOVE X'2020233030303138363337' TO DFHEIV0(25:11)
 18999     CALL 'kxdfhei1' USING DFHEIV0,
 19000           CLMS-ID,
 19001           DFHEIV11,
 19002           DFHEIV99
 19003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 348
* EL050.cbl
 19004
 19005
 19006 7300-EXIT.
 19007     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 349
* EL050.cbl
 19009
 19010 7400-GET-REMAIN-TERM.
 19011
 19012* EXEC CICS LINK
 19013*        PROGRAM    ('ELRTRM')
 19014*        COMMAREA   (CALCULATION-PASS-AREA)
 19015*        LENGTH     (CP-COMM-LENGTH)
 19016*    END-EXEC.
 19017     MOVE 'ELRTRM' TO DFHEIV1
 19018*    MOVE '."C                   (   #00018646' TO DFHEIV0
 19019     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19020     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19021     MOVE X'2020233030303138363436' TO DFHEIV0(25:11)
 19022     CALL 'kxdfhei1' USING DFHEIV0,
 19023           DFHEIV1,
 19024           CALCULATION-PASS-AREA,
 19025           CP-COMM-LENGTH,
 19026           DFHEIV99,
 19027           DFHEIV99,
 19028           DFHEIV99,
 19029           DFHEIV99
 19030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19031
 19032
 19033 7400-EXIT.
 19034     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 350
* EL050.cbl
 19036
 19037 7500-GET-REMAIN-AMOUNT.
 19038
 19039* EXEC CICS LINK
 19040*        PROGRAM    ('ELRAMT')
 19041*        COMMAREA   (CALCULATION-PASS-AREA)
 19042*        LENGTH     (CP-COMM-LENGTH)
 19043*    END-EXEC.
 19044     MOVE 'ELRAMT' TO DFHEIV1
 19045*    MOVE '."C                   (   #00018657' TO DFHEIV0
 19046     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19047     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19048     MOVE X'2020233030303138363537' TO DFHEIV0(25:11)
 19049     CALL 'kxdfhei1' USING DFHEIV0,
 19050           DFHEIV1,
 19051           CALCULATION-PASS-AREA,
 19052           CP-COMM-LENGTH,
 19053           DFHEIV99,
 19054           DFHEIV99,
 19055           DFHEIV99,
 19056           DFHEIV99
 19057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19058
 19059
 19060 7500-EXIT.
 19061     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 351
* EL050.cbl
 19063
 19064 7600-GET-REFUND.
 19065
 19066* EXEC CICS LINK
 19067*        PROGRAM    ('ELRFND')
 19068*        COMMAREA   (CALCULATION-PASS-AREA)
 19069*        LENGTH     (CP-COMM-LENGTH)
 19070*    END-EXEC.
 19071     MOVE 'ELRFND' TO DFHEIV1
 19072*    MOVE '."C                   (   #00018668' TO DFHEIV0
 19073     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19074     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19075     MOVE X'2020233030303138363638' TO DFHEIV0(25:11)
 19076     CALL 'kxdfhei1' USING DFHEIV0,
 19077           DFHEIV1,
 19078           CALCULATION-PASS-AREA,
 19079           CP-COMM-LENGTH,
 19080           DFHEIV99,
 19081           DFHEIV99,
 19082           DFHEIV99,
 19083           DFHEIV99
 19084     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19085
 19086
 19087 7600-EXIT.
 19088     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 352
* EL050.cbl
 19090 7700-CALL-DL1.
 19091
 19092* EXEC CICS LINK
 19093*        PROGRAM    ('DLO001')
 19094*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 19095*        LENGTH     (DLO001-COMM-LENGTH)
 19096*    END-EXEC.
 19097     MOVE 'DLO001' TO DFHEIV1
 19098*    MOVE '."C                   (   #00018678' TO DFHEIV0
 19099     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19100     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19101     MOVE X'2020233030303138363738' TO DFHEIV0(25:11)
 19102     CALL 'kxdfhei1' USING DFHEIV0,
 19103           DFHEIV1,
 19104           WS-DLO-MASTER-POLICY-FORM,
 19105           DLO001-COMM-LENGTH,
 19106           DFHEIV99,
 19107           DFHEIV99,
 19108           DFHEIV99,
 19109           DFHEIV99
 19110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19111
 19112
 19113 7700-EXIT.
 19114     EXIT.
 19115
 19116 7710-CALL-DL2.
 19117
 19118* EXEC CICS LINK
 19119*        PROGRAM    ('DLO002')
 19120*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 19121*        LENGTH     (DLO002-COMM-LENGTH)
 19122*    END-EXEC.
 19123     MOVE 'DLO002' TO DFHEIV1
 19124*    MOVE '."C                   (   #00018688' TO DFHEIV0
 19125     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19126     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19127     MOVE X'2020233030303138363838' TO DFHEIV0(25:11)
 19128     CALL 'kxdfhei1' USING DFHEIV0,
 19129           DFHEIV1,
 19130           WS-DLO-INTERNAL-POLICY-FORM,
 19131           DLO002-COMM-LENGTH,
 19132           DFHEIV99,
 19133           DFHEIV99,
 19134           DFHEIV99,
 19135           DFHEIV99
 19136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19137
 19138
 19139 7710-EXIT.
 19140     EXIT.
 19141
 19142 7720-CALL-DL3.
 19143
 19144* EXEC CICS LINK
 19145*        PROGRAM    ('DLO003')
 19146*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 19147*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 353
* EL050.cbl
 19148*    END-EXEC.
 19149     MOVE 'DLO003' TO DFHEIV1
 19150*    MOVE '."C                   (   #00018698' TO DFHEIV0
 19151     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19152     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19153     MOVE X'2020233030303138363938' TO DFHEIV0(25:11)
 19154     CALL 'kxdfhei1' USING DFHEIV0,
 19155           DFHEIV1,
 19156           WS-DLO-VALID-BANK-ID,
 19157           DLO003-COMM-LENGTH,
 19158           DFHEIV99,
 19159           DFHEIV99,
 19160           DFHEIV99,
 19161           DFHEIV99
 19162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19163
 19164
 19165 7720-EXIT.
 19166     EXIT.
 19167
 19168 7730-CALL-DL7.
 19169
 19170* EXEC CICS LINK
 19171*        PROGRAM    ('DLO007')
 19172*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 19173*        LENGTH     (DLO007-COMM-LENGTH)
 19174*    END-EXEC.
 19175     MOVE 'DLO007' TO DFHEIV1
 19176*    MOVE '."C                   (   #00018708' TO DFHEIV0
 19177     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19178     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19179     MOVE X'2020233030303138373038' TO DFHEIV0(25:11)
 19180     CALL 'kxdfhei1' USING DFHEIV0,
 19181           DFHEIV1,
 19182           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 19183           DLO007-COMM-LENGTH,
 19184           DFHEIV99,
 19185           DFHEIV99,
 19186           DFHEIV99,
 19187           DFHEIV99
 19188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19189
 19190
 19191 7730-EXIT.
 19192     EXIT.
 19193
 19194 7740-CALL-DL11.
 19195
 19196* EXEC CICS LINK
 19197*        PROGRAM    ('DLO011')
 19198*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 19199*        LENGTH     (DLO011-COMM-LENGTH)
 19200*    END-EXEC.
 19201     MOVE 'DLO011' TO DFHEIV1
 19202*    MOVE '."C                   (   #00018718' TO DFHEIV0
 19203     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19204     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19205     MOVE X'2020233030303138373138' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 354
* EL050.cbl
 19206     CALL 'kxdfhei1' USING DFHEIV0,
 19207           DFHEIV1,
 19208           WS-DLO-PREM-RATES-BEN-TYPE,
 19209           DLO011-COMM-LENGTH,
 19210           DFHEIV99,
 19211           DFHEIV99,
 19212           DFHEIV99,
 19213           DFHEIV99
 19214     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19215
 19216
 19217 7740-EXIT.
 19218     EXIT.
 19219
 19220 7750-CALL-DL17.
 19221
 19222* EXEC CICS LINK
 19223*        PROGRAM    ('DLO017')
 19224*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 19225*        LENGTH     (DLO017-COMM-LENGTH)
 19226*    END-EXEC.
 19227     MOVE 'DLO017' TO DFHEIV1
 19228*    MOVE '."C                   (   #00018728' TO DFHEIV0
 19229     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19230     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19231     MOVE X'2020233030303138373238' TO DFHEIV0(25:11)
 19232     CALL 'kxdfhei1' USING DFHEIV0,
 19233           DFHEIV1,
 19234           WS-DLO-VALID-RATE-CODE,
 19235           DLO017-COMM-LENGTH,
 19236           DFHEIV99,
 19237           DFHEIV99,
 19238           DFHEIV99,
 19239           DFHEIV99
 19240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19241
 19242
 19243 7750-EXIT.
 19244     EXIT.
 19245
 19246 7755-CALL-DL19.
 19247
 19248* EXEC CICS LINK
 19249*        PROGRAM    ('DLO019')
 19250*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 19251*        LENGTH     (DLO019-COMM-LENGTH)
 19252*    END-EXEC.
 19253     MOVE 'DLO019' TO DFHEIV1
 19254*    MOVE '."C                   (   #00018738' TO DFHEIV0
 19255     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19256     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19257     MOVE X'2020233030303138373338' TO DFHEIV0(25:11)
 19258     CALL 'kxdfhei1' USING DFHEIV0,
 19259           DFHEIV1,
 19260           WS-DLO-ORIG-COV-CAT,
 19261           DLO019-COMM-LENGTH,
 19262           DFHEIV99,
 19263           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 355
* EL050.cbl
 19264           DFHEIV99,
 19265           DFHEIV99
 19266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19267
 19268
 19269 7755-EXIT.
 19270     EXIT.
 19271
 19272 7760-CALL-DL21.
 19273
 19274* EXEC CICS LINK
 19275*        PROGRAM    ('DLO021')
 19276*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 19277*        LENGTH     (DLO021-COMM-LENGTH)
 19278*    END-EXEC.
 19279     MOVE 'DLO021' TO DFHEIV1
 19280*    MOVE '."C                   (   #00018748' TO DFHEIV0
 19281     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19282     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19283     MOVE X'2020233030303138373438' TO DFHEIV0(25:11)
 19284     CALL 'kxdfhei1' USING DFHEIV0,
 19285           DFHEIV1,
 19286           WS-DLO-VALID-LOAN-OFFICER,
 19287           DLO021-COMM-LENGTH,
 19288           DFHEIV99,
 19289           DFHEIV99,
 19290           DFHEIV99,
 19291           DFHEIV99
 19292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19293
 19294
 19295 7760-EXIT.
 19296     EXIT.
 19297
 19298 7770-CALL-DL22.
 19299
 19300* EXEC CICS LINK
 19301*        PROGRAM    ('DLO022')
 19302*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 19303*        LENGTH     (DLO022-COMM-LENGTH)
 19304*    END-EXEC.
 19305     MOVE 'DLO022' TO DFHEIV1
 19306*    MOVE '."C                   (   #00018758' TO DFHEIV0
 19307     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19308     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19309     MOVE X'2020233030303138373538' TO DFHEIV0(25:11)
 19310     CALL 'kxdfhei1' USING DFHEIV0,
 19311           DFHEIV1,
 19312           WS-DLO-VALID-STATE-CODE,
 19313           DLO022-COMM-LENGTH,
 19314           DFHEIV99,
 19315           DFHEIV99,
 19316           DFHEIV99,
 19317           DFHEIV99
 19318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19319
 19320
 19321 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 356
* EL050.cbl
 19322     EXIT.
 19323
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 357
* EL050.cbl
 19325
 19326 7800-REWRITE-CERT.
 19327******************************************************************
 19328*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 19329*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 19330******************************************************************
 19331
 19332     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 19333        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 19334        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 19335        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 19336
 19337* EXEC CICS REWRITE
 19338*                  DATASET (CERT-ID)
 19339*                  FROM    (CERTIFICATE-MASTER)
 19340*              END-EXEC
 19341     MOVE LENGTH OF
 19342      CERTIFICATE-MASTER
 19343       TO DFHEIV11
 19344*    MOVE '&& L                  %   #00018779' TO DFHEIV0
 19345     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19346     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19347     MOVE X'2020233030303138373739' TO DFHEIV0(25:11)
 19348     CALL 'kxdfhei1' USING DFHEIV0,
 19349           CERT-ID,
 19350           CERTIFICATE-MASTER,
 19351           DFHEIV11,
 19352           DFHEIV99
 19353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19354        GO TO 7800-EXIT.
 19355
 19356       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 19357       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 19358
 19359 7800-EXIT.
 19360      EXIT.
 19361
 19362 7900-DELETE-CERT.
 19363
 19364* EXEC CICS DELETE
 19365*        DATASET (CERT-ID)
 19366*    END-EXEC.
 19367*    MOVE '&(                    &   #00018792' TO DFHEIV0
 19368     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 19369     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19370     MOVE X'2020233030303138373932' TO DFHEIV0(25:11)
 19371     CALL 'kxdfhei1' USING DFHEIV0,
 19372           CERT-ID,
 19373           DFHEIV99,
 19374           DFHEIV99,
 19375           DFHEIV99,
 19376           DFHEIV99
 19377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19378
 19379
 19380 7900-EXIT.
 19381     EXIT.
 19382
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 358
* EL050.cbl
 19383 8000-WRITE-CERT.
 19384
 19385* EXEC CICS HANDLE CONDITION
 19386*        DUPKEY    (8000-FREE-MAIN)
 19387*    END-EXEC.
 19388*    MOVE '"$$                   ! + #00018800' TO DFHEIV0
 19389     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19390     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19391     MOVE X'2B20233030303138383030' TO DFHEIV0(25:11)
 19392     CALL 'kxdfhei1' USING DFHEIV0
 19393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19394
 19395
 19396
 19397* EXEC CICS WRITE
 19398*        DATASET     (CERT-ID)
 19399*        FROM        (CERTIFICATE-MASTER)
 19400*        RIDFLD      (ELCERT-KEY)
 19401*    END-EXEC.
 19402     MOVE LENGTH OF
 19403      CERTIFICATE-MASTER
 19404       TO DFHEIV11
 19405*    MOVE '&$ L                  ''   #00018804' TO DFHEIV0
 19406     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19407     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19408     MOVE X'2020233030303138383034' TO DFHEIV0(25:11)
 19409     CALL 'kxdfhei1' USING DFHEIV0,
 19410           CERT-ID,
 19411           CERTIFICATE-MASTER,
 19412           DFHEIV11,
 19413           ELCERT-KEY,
 19414           DFHEIV99,
 19415           DFHEIV99
 19416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19417
 19418
 19419 8000-FREE-MAIN.
 19420
 19421 8000-EXIT.
 19422      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 359
* EL050.cbl
 19424
 19425 8100-READ-ERPNDM.
 19426
 19427* EXEC CICS HANDLE CONDITION
 19428*         NOTFND     (8100-NOTFND)
 19429*         ENDFILE    (8100-NOTFND)
 19430*    END-EXEC.
 19431*    MOVE '"$I''                  ! , #00018817' TO DFHEIV0
 19432     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19433     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19434     MOVE X'2C20233030303138383137' TO DFHEIV0(25:11)
 19435     CALL 'kxdfhei1' USING DFHEIV0
 19436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19437
 19438
 19439     MOVE SPACES                 TO ERPNDM-FOUND.
 19440     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19441
 19442
 19443* EXEC CICS READ
 19444*         DATASET   (FILE-ERPNDM)
 19445*         RIDFLD    (PM-CONTROL-PRIMARY)
 19446*         INTO      (PENDING-MAILING-DATA)
 19447*    END-EXEC.
 19448     MOVE LENGTH OF
 19449      PENDING-MAILING-DATA
 19450       TO DFHEIV11
 19451*    MOVE '&"IL       E          (   #00018825' TO DFHEIV0
 19452     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19453     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19454     MOVE X'2020233030303138383235' TO DFHEIV0(25:11)
 19455     CALL 'kxdfhei1' USING DFHEIV0,
 19456           FILE-ERPNDM,
 19457           PENDING-MAILING-DATA,
 19458           DFHEIV11,
 19459           PM-CONTROL-PRIMARY,
 19460           DFHEIV99,
 19461           DFHEIV99,
 19462           DFHEIV99
 19463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19464
 19465
 19466     GO TO 8100-EXIT.
 19467
 19468 8100-NOTFND.
 19469
 19470     MOVE 'X'                    TO ERPNDM-FOUND.
 19471     MOVE ER-2694                TO WS-ERROR.
 19472     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19473     MOVE ER-2883                TO WS-ERROR
 19474     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 19475     .
 19476 8100-EXIT.
 19477     EXIT.
 19478
 19479 8110-READ-ERMAIL.
 19480
 19481* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 360
* EL050.cbl
 19482*         NOTFND     (8110-NOTFND)
 19483*         ENDFILE    (8110-NOTFND)
 19484*    END-EXEC.
 19485*    MOVE '"$I''                  ! - #00018845' TO DFHEIV0
 19486     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19487     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19488     MOVE X'2D20233030303138383435' TO DFHEIV0(25:11)
 19489     CALL 'kxdfhei1' USING DFHEIV0
 19490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19491
 19492
 19493     MOVE SPACES                 TO ERMAIL-FOUND.
 19494     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 19495     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 19496     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 19497     MOVE PB-SV-STATE            TO MA-STATE.
 19498
 19499
 19500* EXEC CICS READ
 19501*         UPDATE
 19502*         DATASET   (FILE-ERMAIL)
 19503*         RIDFLD    (MA-CONTROL-PRIMARY)
 19504*         INTO      (MAILING-DATA)
 19505*    END-EXEC.
 19506     MOVE LENGTH OF
 19507      MAILING-DATA
 19508       TO DFHEIV11
 19509*    MOVE '&"IL       EU         (   #00018856' TO DFHEIV0
 19510     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19511     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19512     MOVE X'2020233030303138383536' TO DFHEIV0(25:11)
 19513     CALL 'kxdfhei1' USING DFHEIV0,
 19514           FILE-ERMAIL,
 19515           MAILING-DATA,
 19516           DFHEIV11,
 19517           MA-CONTROL-PRIMARY,
 19518           DFHEIV99,
 19519           DFHEIV99,
 19520           DFHEIV99
 19521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19522
 19523
 19524     GO TO 8110-EXIT.
 19525
 19526 8110-NOTFND.
 19527     MOVE 'X'                    TO ERMAIL-FOUND.
 19528
 19529 8110-EXIT.
 19530     EXIT.
 19531
 19532 8120-REWRITE-ERMAIL.
 19533
 19534* EXEC CICS REWRITE
 19535*         DATASET    (FILE-ERMAIL)
 19536*         FROM       (MAILING-DATA)
 19537*    END-EXEC.
 19538     MOVE LENGTH OF
 19539      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 361
* EL050.cbl
 19540       TO DFHEIV11
 19541*    MOVE '&& L                  %   #00018872' TO DFHEIV0
 19542     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19543     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19544     MOVE X'2020233030303138383732' TO DFHEIV0(25:11)
 19545     CALL 'kxdfhei1' USING DFHEIV0,
 19546           FILE-ERMAIL,
 19547           MAILING-DATA,
 19548           DFHEIV11,
 19549           DFHEIV99
 19550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19551
 19552
 19553 8120-EXIT.
 19554     EXIT.
 19555
 19556 8130-WRITE-ERMAIL.
 19557
 19558* EXEC CICS HANDLE CONDITION
 19559*         DUPKEY   (8130-EXIT)
 19560*    END-EXEC.
 19561*    MOVE '"$$                   ! . #00018881' TO DFHEIV0
 19562     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19563     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19564     MOVE X'2E20233030303138383831' TO DFHEIV0(25:11)
 19565     CALL 'kxdfhei1' USING DFHEIV0
 19566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19567
 19568
 19569
 19570* EXEC CICS WRITE
 19571*         DATASET     (FILE-ERMAIL)
 19572*         RIDFLD      (MA-CONTROL-PRIMARY)
 19573*         FROM        (MAILING-DATA)
 19574*    END-EXEC.
 19575     MOVE LENGTH OF
 19576      MAILING-DATA
 19577       TO DFHEIV11
 19578*    MOVE '&$ L                  ''   #00018885' TO DFHEIV0
 19579     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19580     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19581     MOVE X'2020233030303138383835' TO DFHEIV0(25:11)
 19582     CALL 'kxdfhei1' USING DFHEIV0,
 19583           FILE-ERMAIL,
 19584           MAILING-DATA,
 19585           DFHEIV11,
 19586           MA-CONTROL-PRIMARY,
 19587           DFHEIV99,
 19588           DFHEIV99
 19589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19590
 19591
 19592 8130-EXIT.
 19593     EXIT.
 19594
 19595 8140-UNLOCK-ERMAIL.
 19596
 19597* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 362
* EL050.cbl
 19598*         DATASET   (FILE-ERMAIL)
 19599*    END-EXEC.
 19600*    MOVE '&*                    #   #00018895' TO DFHEIV0
 19601     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19602     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19603     MOVE X'2020233030303138383935' TO DFHEIV0(25:11)
 19604     CALL 'kxdfhei1' USING DFHEIV0,
 19605           FILE-ERMAIL,
 19606           DFHEIV99
 19607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19608
 19609
 19610 8140-EXIT.
 19611     EXIT.
 19612
 19613 8150-read-elcrtt.
 19614
 19615
 19616* EXEC CICS HANDLE CONDITION
 19617*        NOTFND   (8150-exit)
 19618*    END-EXEC
 19619*    MOVE '"$I                   ! / #00018904' TO DFHEIV0
 19620     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19621     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19622     MOVE X'2F20233030303138393034' TO DFHEIV0(25:11)
 19623     CALL 'kxdfhei1' USING DFHEIV0
 19624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19625
 19626     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19627     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19628
 19629
 19630* EXEC CICS READ
 19631*        DATASET  (CRTT-ID)
 19632*        RIDFLD   (WS-ELCRTT-KEY)
 19633*        INTO     (CERTIFICATE-TRAILERS)
 19634*    END-EXEC
 19635     MOVE LENGTH OF
 19636      CERTIFICATE-TRAILERS
 19637       TO DFHEIV11
 19638*    MOVE '&"IL       E          (   #00018911' TO DFHEIV0
 19639     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19640     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19641     MOVE X'2020233030303138393131' TO DFHEIV0(25:11)
 19642     CALL 'kxdfhei1' USING DFHEIV0,
 19643           CRTT-ID,
 19644           CERTIFICATE-TRAILERS,
 19645           DFHEIV11,
 19646           WS-ELCRTT-KEY,
 19647           DFHEIV99,
 19648           DFHEIV99,
 19649           DFHEIV99
 19650     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19651
 19652     move cs-ins-age-default-flag to ws-ins-age-defaulted
 19653     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 19654
 19655     .
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 363
* EL050.cbl
 19656 8150-exit.
 19657     exit.
 19658 8180-UPDATE-VIN-NUMBER.
 19659
 19660* EXEC CICS HANDLE CONDITION
 19661*        NOTFND   (8180-NOTFND)
 19662*    END-EXEC.
 19663*    MOVE '"$I                   ! 0 #00018924' TO DFHEIV0
 19664     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19665     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19666     MOVE X'3020233030303138393234' TO DFHEIV0(25:11)
 19667     CALL 'kxdfhei1' USING DFHEIV0
 19668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19669
 19670
 19671     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19672     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19673
 19674
 19675* EXEC CICS READ
 19676*        UPDATE
 19677*        DATASET  (CRTT-ID)
 19678*        RIDFLD   (WS-ELCRTT-KEY)
 19679*        INTO     (CERTIFICATE-TRAILERS)
 19680*    END-EXEC.
 19681     MOVE LENGTH OF
 19682      CERTIFICATE-TRAILERS
 19683       TO DFHEIV11
 19684*    MOVE '&"IL       EU         (   #00018931' TO DFHEIV0
 19685     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19686     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19687     MOVE X'2020233030303138393331' TO DFHEIV0(25:11)
 19688     CALL 'kxdfhei1' USING DFHEIV0,
 19689           CRTT-ID,
 19690           CERTIFICATE-TRAILERS,
 19691           DFHEIV11,
 19692           WS-ELCRTT-KEY,
 19693           DFHEIV99,
 19694           DFHEIV99,
 19695           DFHEIV99
 19696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19697
 19698
 19699     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 19700         MOVE PB-I-VIN TO CS-VIN-NUMBER
 19701
 19702* EXEC CICS REWRITE
 19703*           DATASET  (CRTT-ID)
 19704*           FROM     (CERTIFICATE-TRAILERS)
 19705*        END-EXEC
 19706     MOVE LENGTH OF
 19707      CERTIFICATE-TRAILERS
 19708       TO DFHEIV11
 19709*    MOVE '&& L                  %   #00018940' TO DFHEIV0
 19710     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19711     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19712     MOVE X'2020233030303138393430' TO DFHEIV0(25:11)
 19713     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 364
* EL050.cbl
 19714           CRTT-ID,
 19715           CERTIFICATE-TRAILERS,
 19716           DFHEIV11,
 19717           DFHEIV99
 19718     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19719     ELSE
 19720
 19721* EXEC CICS UNLOCK
 19722*          DATASET  (CRTT-ID)
 19723*       END-EXEC
 19724*    MOVE '&*                    #   #00018945' TO DFHEIV0
 19725     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19726     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19727     MOVE X'2020233030303138393435' TO DFHEIV0(25:11)
 19728     CALL 'kxdfhei1' USING DFHEIV0,
 19729           CRTT-ID,
 19730           DFHEIV99
 19731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19732     END-IF.
 19733
 19734     GO TO 8180-EXIT.
 19735
 19736 8180-NOTFND.
 19737
 19738     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19739     MOVE 'CS'         TO CS-RECORD-ID.
 19740     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19741     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19742     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19743     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 19744
 19745* EXEC CICS WRITE
 19746*       DATASET  (CRTT-ID)
 19747*       RIDFLD   (WS-ELCRTT-KEY)
 19748*       FROM     (CERTIFICATE-TRAILERS)
 19749*    END-EXEC.
 19750     MOVE LENGTH OF
 19751      CERTIFICATE-TRAILERS
 19752       TO DFHEIV11
 19753*    MOVE '&$ L                  ''   #00018960' TO DFHEIV0
 19754     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19755     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19756     MOVE X'2020233030303138393630' TO DFHEIV0(25:11)
 19757     CALL 'kxdfhei1' USING DFHEIV0,
 19758           CRTT-ID,
 19759           CERTIFICATE-TRAILERS,
 19760           DFHEIV11,
 19761           WS-ELCRTT-KEY,
 19762           DFHEIV99,
 19763           DFHEIV99
 19764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19765
 19766
 19767 8180-EXIT.
 19768     EXIT.
 19769
 19770 8190-UPDATE-REFUND-CLAIM-FLAG.
 19771
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 365
* EL050.cbl
 19772* EXEC CICS HANDLE CONDITION
 19773*        NOTFND   (8190-NOTFND)
 19774*    END-EXEC.
 19775*    MOVE '"$I                   ! 1 #00018970' TO DFHEIV0
 19776     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19777     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19778     MOVE X'3120233030303138393730' TO DFHEIV0(25:11)
 19779     CALL 'kxdfhei1' USING DFHEIV0
 19780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19781
 19782
 19783     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19784     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19785
 19786
 19787* EXEC CICS READ
 19788*        UPDATE
 19789*        DATASET  (CRTT-ID)
 19790*        RIDFLD   (WS-ELCRTT-KEY)
 19791*        INTO     (CERTIFICATE-TRAILERS)
 19792*    END-EXEC.
 19793     MOVE LENGTH OF
 19794      CERTIFICATE-TRAILERS
 19795       TO DFHEIV11
 19796*    MOVE '&"IL       EU         (   #00018977' TO DFHEIV0
 19797     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19798     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19799     MOVE X'2020233030303138393737' TO DFHEIV0(25:11)
 19800     CALL 'kxdfhei1' USING DFHEIV0,
 19801           CRTT-ID,
 19802           CERTIFICATE-TRAILERS,
 19803           DFHEIV11,
 19804           WS-ELCRTT-KEY,
 19805           DFHEIV99,
 19806           DFHEIV99,
 19807           DFHEIV99
 19808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19809
 19810
 19811     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19812
 19813* EXEC CICS REWRITE
 19814*       DATASET  (CRTT-ID)
 19815*       FROM     (CERTIFICATE-TRAILERS)
 19816*    END-EXEC.
 19817     MOVE LENGTH OF
 19818      CERTIFICATE-TRAILERS
 19819       TO DFHEIV11
 19820*    MOVE '&& L                  %   #00018985' TO DFHEIV0
 19821     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19822     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19823     MOVE X'2020233030303138393835' TO DFHEIV0(25:11)
 19824     CALL 'kxdfhei1' USING DFHEIV0,
 19825           CRTT-ID,
 19826           CERTIFICATE-TRAILERS,
 19827           DFHEIV11,
 19828           DFHEIV99
 19829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 366
* EL050.cbl
 19830
 19831
 19832     GO TO 8190-EXIT.
 19833
 19834 8190-NOTFND.
 19835
 19836     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19837     MOVE 'CS'         TO CS-RECORD-ID.
 19838     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19839     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19840     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19841     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19842
 19843* EXEC CICS WRITE
 19844*       DATASET  (CRTT-ID)
 19845*       RIDFLD   (WS-ELCRTT-KEY)
 19846*       FROM     (CERTIFICATE-TRAILERS)
 19847*    END-EXEC.
 19848     MOVE LENGTH OF
 19849      CERTIFICATE-TRAILERS
 19850       TO DFHEIV11
 19851*    MOVE '&$ L                  ''   #00019000' TO DFHEIV0
 19852     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19853     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19854     MOVE X'2020233030303139303030' TO DFHEIV0(25:11)
 19855     CALL 'kxdfhei1' USING DFHEIV0,
 19856           CRTT-ID,
 19857           CERTIFICATE-TRAILERS,
 19858           DFHEIV11,
 19859           WS-ELCRTT-KEY,
 19860           DFHEIV99,
 19861           DFHEIV99
 19862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19863
 19864
 19865 8190-EXIT.
 19866     EXIT.
 19867
 19868 8195-UPDATE-AGE-FLAGS.
 19869
 19870* EXEC CICS HANDLE CONDITION
 19871*        NOTFND   (8195-NOTFND)
 19872*    END-EXEC.
 19873*    MOVE '"$I                   ! 2 #00019010' TO DFHEIV0
 19874     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19875     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19876     MOVE X'3220233030303139303130' TO DFHEIV0(25:11)
 19877     CALL 'kxdfhei1' USING DFHEIV0
 19878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19879
 19880
 19881     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19882     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19883
 19884
 19885* EXEC CICS READ
 19886*        UPDATE
 19887*        DATASET  (CRTT-ID)
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 367
* EL050.cbl
 19888*        RIDFLD   (WS-ELCRTT-KEY)
 19889*        INTO     (CERTIFICATE-TRAILERS)
 19890*    END-EXEC.
 19891     MOVE LENGTH OF
 19892      CERTIFICATE-TRAILERS
 19893       TO DFHEIV11
 19894*    MOVE '&"IL       EU         (   #00019017' TO DFHEIV0
 19895     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19896     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19897     MOVE X'2020233030303139303137' TO DFHEIV0(25:11)
 19898     CALL 'kxdfhei1' USING DFHEIV0,
 19899           CRTT-ID,
 19900           CERTIFICATE-TRAILERS,
 19901           DFHEIV11,
 19902           WS-ELCRTT-KEY,
 19903           DFHEIV99,
 19904           DFHEIV99,
 19905           DFHEIV99
 19906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19907
 19908
 19909     IF WS-INS-AGE-SET = 'Y'
 19910        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 19911     END-IF
 19912     IF WS-JNT-AGE-SET = 'Y'
 19913        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 19914     END-IF
 19915
 19916
 19917* EXEC CICS REWRITE
 19918*       DATASET  (CRTT-ID)
 19919*       FROM     (CERTIFICATE-TRAILERS)
 19920*    END-EXEC.
 19921     MOVE LENGTH OF
 19922      CERTIFICATE-TRAILERS
 19923       TO DFHEIV11
 19924*    MOVE '&& L                  %   #00019031' TO DFHEIV0
 19925     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19926     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19927     MOVE X'2020233030303139303331' TO DFHEIV0(25:11)
 19928     CALL 'kxdfhei1' USING DFHEIV0,
 19929           CRTT-ID,
 19930           CERTIFICATE-TRAILERS,
 19931           DFHEIV11,
 19932           DFHEIV99
 19933     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19934
 19935
 19936     GO TO 8195-EXIT.
 19937
 19938 8195-NOTFND.
 19939
 19940     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19941     MOVE 'CS'         TO CS-RECORD-ID.
 19942     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19943     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19944     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19945     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 368
* EL050.cbl
 19946     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 19947
 19948* EXEC CICS WRITE
 19949*       DATASET  (CRTT-ID)
 19950*       RIDFLD   (WS-ELCRTT-KEY)
 19951*       FROM     (CERTIFICATE-TRAILERS)
 19952*    END-EXEC.
 19953     MOVE LENGTH OF
 19954      CERTIFICATE-TRAILERS
 19955       TO DFHEIV11
 19956*    MOVE '&$ L                  ''   #00019047' TO DFHEIV0
 19957     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19958     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19959     MOVE X'2020233030303139303437' TO DFHEIV0(25:11)
 19960     CALL 'kxdfhei1' USING DFHEIV0,
 19961           CRTT-ID,
 19962           CERTIFICATE-TRAILERS,
 19963           DFHEIV11,
 19964           WS-ELCRTT-KEY,
 19965           DFHEIV99,
 19966           DFHEIV99
 19967     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19968
 19969
 19970 8195-EXIT.
 19971     EXIT.
 19972
 19973 8200-READ-REIN-TABLE.
 19974
 19975* EXEC CICS HANDLE CONDITION
 19976*         NOTFND   (8200-NOTFND)
 19977*    END-EXEC.
 19978*    MOVE '"$I                   ! 3 #00019057' TO DFHEIV0
 19979     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19980     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19981     MOVE X'3320233030303139303537' TO DFHEIV0(25:11)
 19982     CALL 'kxdfhei1' USING DFHEIV0
 19983     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19984
 19985
 19986
 19987* EXEC CICS READ
 19988*        DATASET     (REIN-ID)
 19989*        SET         (ADDRESS OF REINSURANCE-RECORD)
 19990*        RIDFLD      (ERREIN-KEY)
 19991*    END-EXEC.
 19992*    MOVE '&"S        E          (   #00019061' TO DFHEIV0
 19993     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19994     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19995     MOVE X'2020233030303139303631' TO DFHEIV0(25:11)
 19996     CALL 'kxdfhei1' USING DFHEIV0,
 19997           REIN-ID,
 19998           DFHEIV20,
 19999           DFHEIV99,
 20000           ERREIN-KEY,
 20001           DFHEIV99,
 20002           DFHEIV99,
 20003           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 369
* EL050.cbl
 20004     SET ADDRESS OF REINSURANCE-RECORD TO
 20005         DFHEIV20
 20006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20007
 20008
 20009     GO TO 8200-EXIT.
 20010
 20011 8200-NOTFND.
 20012     MOVE 'N'             TO WS-REIN-READ-SW.
 20013
 20014 8200-EXIT.
 20015      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 370
* EL050.cbl
 20017
 20018 8300-READ-CTBL-TABLE.
 20019
 20020* EXEC CICS HANDLE CONDITION
 20021*        NOTFND    (8300-NOTFND)
 20022*        DISABLED  (8300-ERRESS-PROBLEM)
 20023*        NOTOPEN   (8300-ERRESS-PROBLEM)
 20024*        ENDFILE   (8300-NOTFND)
 20025*    END-EXEC.
 20026*    MOVE '"$IcJ''                ! 4 #00019077' TO DFHEIV0
 20027     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 20028     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20029     MOVE X'3420233030303139303737' TO DFHEIV0(25:11)
 20030     CALL 'kxdfhei1' USING DFHEIV0
 20031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20032
 20033
 20034
 20035* EXEC CICS READ
 20036*        DATASET     (CTBL-ID)
 20037*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 20038*        RIDFLD      (ERCTBL-KEY)
 20039*    END-EXEC.
 20040*    MOVE '&"S        E          (   #00019084' TO DFHEIV0
 20041     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20042     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20043     MOVE X'2020233030303139303834' TO DFHEIV0(25:11)
 20044     CALL 'kxdfhei1' USING DFHEIV0,
 20045           CTBL-ID,
 20046           DFHEIV20,
 20047           DFHEIV99,
 20048           ERCTBL-KEY,
 20049           DFHEIV99,
 20050           DFHEIV99,
 20051           DFHEIV99
 20052     SET ADDRESS OF COMM-TABLE-RECORD TO
 20053         DFHEIV20
 20054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20055
 20056
 20057     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 20058
 20059     GO TO 8300-EXIT.
 20060
 20061 8300-NOTFND.
 20062
 20063     IF CTBL-SW = '0530'
 20064         MOVE 'AA'                     TO WS-AH-COMP-CD
 20065         MOVE '0550'                   TO CTBL-SW
 20066         MOVE '1'                      TO WS-CTBL-READ-SW
 20067         GO TO 8300-EXIT.
 20068
 20069     IF CTBL-SW = '0540'
 20070         MOVE 'AA'                     TO WS-LF-COMP-CD
 20071         MOVE '0550'                   TO CTBL-SW
 20072         MOVE '1'                      TO WS-CTBL-READ-SW
 20073         GO TO 8300-EXIT.
 20074
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 371
* EL050.cbl
 20075     IF CTBL-SW = '0550'
 20076         MOVE '2'                      TO WS-CTBL-READ-SW
 20077         GO TO 8300-EXIT.
 20078
 20079     GO TO 8300-EXIT.
 20080
 20081 8300-ERRESS-PROBLEM.
 20082
 20083      MOVE ER-8050              TO WS-ERROR.
 20084      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20085
 20086     GO TO 8300-EXIT.
 20087
 20088 8300-EXIT.
 20089      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 372
* EL050.cbl
 20091
 20092
 20093 8400-GETMAIN-ERFORM.
 20094
 20095
 20096* EXEC CICS   GETMAIN
 20097*        LENGTH  (500)
 20098*        SET     (ADDRESS OF FORM-MASTER)
 20099*    END-EXEC.
 20100     MOVE 500
 20101       TO DFHEIV11
 20102*    MOVE '," L                  $   #00019128' TO DFHEIV0
 20103     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20104     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20105     MOVE X'2020233030303139313238' TO DFHEIV0(25:11)
 20106     CALL 'kxdfhei1' USING DFHEIV0,
 20107           DFHEIV20,
 20108           DFHEIV11,
 20109           DFHEIV99
 20110     SET ADDRESS OF FORM-MASTER TO
 20111         DFHEIV20
 20112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20113
 20114
 20115     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 20116
 20117 8400-EXIT.
 20118      EXIT.
 20119
 20120 8450-READ-FORM-MASTER.
 20121
 20122
 20123* EXEC CICS  HANDLE CONDITION
 20124*        NOTFND   (8450-FORM-NOT-FOUND)
 20125*        ENDFILE  (8450-FORM-NOT-FOUND)
 20126*    END-EXEC.
 20127*    MOVE '"$I''                  ! 5 #00019140' TO DFHEIV0
 20128     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20129     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20130     MOVE X'3520233030303139313430' TO DFHEIV0(25:11)
 20131     CALL 'kxdfhei1' USING DFHEIV0
 20132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20133
 20134
 20135
 20136* EXEC CICS   READ
 20137*        DATASET   (FORM-ID)
 20138*        RIDFLD    (ERFORM-KEY)
 20139*        INTO      (FORM-MASTER)
 20140*        GTEQ
 20141*    END-EXEC.
 20142     MOVE LENGTH OF
 20143      FORM-MASTER
 20144       TO DFHEIV11
 20145*    MOVE '&"IL       G          (   #00019145' TO DFHEIV0
 20146     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20147     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20148     MOVE X'2020233030303139313435' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 373
* EL050.cbl
 20149     CALL 'kxdfhei1' USING DFHEIV0,
 20150           FORM-ID,
 20151           FORM-MASTER,
 20152           DFHEIV11,
 20153           ERFORM-KEY,
 20154           DFHEIV99,
 20155           DFHEIV99,
 20156           DFHEIV99
 20157     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20158
 20159
 20160     MOVE  'Y'           TO  FORM-MASTER-SW.
 20161
 20162     GO TO  8450-EXIT.
 20163
 20164 8450-FORM-NOT-FOUND.
 20165
 20166     MOVE  'N'           TO  FORM-MASTER-SW.
 20167
 20168 8450-EXIT.
 20169      EXIT.
 20170
 20171 8500-DATE-CONVERT.
 20172
 20173* EXEC CICS LINK
 20174*        PROGRAM    ('ELDATCV')
 20175*        COMMAREA   (DATE-CONVERSION-DATA)
 20176*        LENGTH     (DC-COMM-LENGTH)
 20177*    END-EXEC.
 20178     MOVE 'ELDATCV' TO DFHEIV1
 20179*    MOVE '."C                   (   #00019164' TO DFHEIV0
 20180     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20181     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20182     MOVE X'2020233030303139313634' TO DFHEIV0(25:11)
 20183     CALL 'kxdfhei1' USING DFHEIV0,
 20184           DFHEIV1,
 20185           DATE-CONVERSION-DATA,
 20186           DC-COMM-LENGTH,
 20187           DFHEIV99,
 20188           DFHEIV99,
 20189           DFHEIV99,
 20190           DFHEIV99
 20191     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20192
 20193
 20194 8500-EXIT.
 20195     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 374
* EL050.cbl
 20197
 20198 8555-RELOAD-CONTROL-FILE.
 20199     CONTINUE.
 20200
 20201 8555-EXIT.
 20202     EXIT.
 20203
 20204 8557-GETMAIN-ERPLAN.
 20205
 20206
 20207* EXEC CICS GETMAIN
 20208*        LENGTH    (840)
 20209*        SET       (ADDRESS OF PLAN-RECORDS)
 20210*    END-EXEC.
 20211     MOVE 840
 20212       TO DFHEIV11
 20213*    MOVE '," L                  $   #00019182' TO DFHEIV0
 20214     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20215     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20216     MOVE X'2020233030303139313832' TO DFHEIV0(25:11)
 20217     CALL 'kxdfhei1' USING DFHEIV0,
 20218           DFHEIV20,
 20219           DFHEIV11,
 20220           DFHEIV99
 20221     SET ADDRESS OF PLAN-RECORDS TO
 20222         DFHEIV20
 20223     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20224
 20225
 20226     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 20227
 20228 8557-EXIT.
 20229     EXIT.
 20230
 20231 8560-GETMAIN.
 20232
 20233* EXEC CICS GETMAIN
 20234*        LENGTH    (2000)
 20235*        SET       (ADDRESS OF ACCOUNT-MASTER)
 20236*    END-EXEC.
 20237     MOVE 2000
 20238       TO DFHEIV11
 20239*    MOVE '," L                  $   #00019193' TO DFHEIV0
 20240     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20241     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20242     MOVE X'2020233030303139313933' TO DFHEIV0(25:11)
 20243     CALL 'kxdfhei1' USING DFHEIV0,
 20244           DFHEIV20,
 20245           DFHEIV11,
 20246           DFHEIV99
 20247     SET ADDRESS OF ACCOUNT-MASTER TO
 20248         DFHEIV20
 20249     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20250
 20251
 20252     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 20253
 20254 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 375
* EL050.cbl
 20255     EXIT.
 20256
 20257 8570-START-ACCOUNT-MASTER.
 20258
 20259* EXEC CICS HANDLE CONDITION
 20260*        NOTFND    (0199-ACCT-NOT-FOUND)
 20261*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20262*    END-EXEC.
 20263*    MOVE '"$I''                  ! 6 #00019204' TO DFHEIV0
 20264     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20265     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20266     MOVE X'3620233030303139323034' TO DFHEIV0(25:11)
 20267     CALL 'kxdfhei1' USING DFHEIV0
 20268     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20269
 20270
 20271
 20272* EXEC CICS STARTBR
 20273*        DATASET    (ACCT-ID)
 20274*        RIDFLD     (ERACCT-KEY)
 20275*        GTEQ
 20276*    END-EXEC.
 20277     MOVE 0
 20278       TO DFHEIV11
 20279*    MOVE '&,         G          &   #00019209' TO DFHEIV0
 20280     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20281     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20282     MOVE X'2020233030303139323039' TO DFHEIV0(25:11)
 20283     CALL 'kxdfhei1' USING DFHEIV0,
 20284           ACCT-ID,
 20285           ERACCT-KEY,
 20286           DFHEIV99,
 20287           DFHEIV11,
 20288           DFHEIV99
 20289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20290
 20291
 20292 8570-EXIT.
 20293     EXIT.
 20294
 20295 8580-READ-ACCOUNT-MASTER.
 20296
 20297* EXEC CICS HANDLE CONDITION
 20298*        NOTFND    (0199-ACCT-NOT-FOUND)
 20299*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20300*    END-EXEC.
 20301*    MOVE '"$I''                  ! 7 #00019219' TO DFHEIV0
 20302     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20303     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20304     MOVE X'3720233030303139323139' TO DFHEIV0(25:11)
 20305     CALL 'kxdfhei1' USING DFHEIV0
 20306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20307
 20308
 20309
 20310* EXEC CICS READNEXT
 20311*        DATASET     (ACCT-ID)
 20312*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 376
* EL050.cbl
 20313*        RIDFLD      (ERACCT-KEY)
 20314*    END-EXEC.
 20315     MOVE LENGTH OF
 20316      ACCOUNT-MASTER
 20317       TO DFHEIV12
 20318     MOVE 0
 20319       TO DFHEIV11
 20320*    MOVE '&.IL                  )   #00019224' TO DFHEIV0
 20321     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20322     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20323     MOVE X'2020233030303139323234' TO DFHEIV0(25:11)
 20324     CALL 'kxdfhei1' USING DFHEIV0,
 20325           ACCT-ID,
 20326           ACCOUNT-MASTER,
 20327           DFHEIV12,
 20328           ERACCT-KEY,
 20329           DFHEIV99,
 20330           DFHEIV11,
 20331           DFHEIV99,
 20332           DFHEIV99
 20333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20334
 20335
 20336 8580-EXIT.
 20337     EXIT.
 20338
 20339 8582-READ-COMPENSATION-MASTER.
 20340
 20341* EXEC CICS HANDLE CONDITION
 20342*        NOTFND    (8582-COMP-NOT-FOUND)
 20343*        ENDFILE   (8582-COMP-NOT-FOUND)
 20344*    END-EXEC.
 20345*    MOVE '"$I''                  ! 8 #00019234' TO DFHEIV0
 20346     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20347     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20348     MOVE X'3820233030303139323334' TO DFHEIV0(25:11)
 20349     CALL 'kxdfhei1' USING DFHEIV0
 20350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20351
 20352
 20353
 20354* EXEC CICS READ
 20355*        DATASET     (COMP-ID)
 20356*        INTO        (COMPENSATION-MASTER)
 20357*        RIDFLD      (ERCOMP-KEY)
 20358*    END-EXEC.
 20359     MOVE LENGTH OF
 20360      COMPENSATION-MASTER
 20361       TO DFHEIV11
 20362*    MOVE '&"IL       E          (   #00019239' TO DFHEIV0
 20363     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20364     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20365     MOVE X'2020233030303139323339' TO DFHEIV0(25:11)
 20366     CALL 'kxdfhei1' USING DFHEIV0,
 20367           COMP-ID,
 20368           COMPENSATION-MASTER,
 20369           DFHEIV11,
 20370           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 377
* EL050.cbl
 20371           DFHEIV99,
 20372           DFHEIV99,
 20373           DFHEIV99
 20374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20375
 20376
 20377     MOVE 'Y'                    TO COMP-MASTER-SW
 20378
 20379     GO TO 8582-EXIT
 20380     .
 20381 8582-COMP-NOT-FOUND.
 20382
 20383     MOVE 'N'                    TO COMP-MASTER-SW.
 20384
 20385 8582-EXIT.
 20386     EXIT.
 20387
 20388 8583-READ-ERAGTC.
 20389
 20390* EXEC CICS HANDLE CONDITION
 20391*        NOTFND    (8583-AGTC-NOT-FOUND)
 20392*        ENDFILE   (8583-AGTC-NOT-FOUND)
 20393*    END-EXEC.
 20394*    MOVE '"$I''                  ! 9 #00019257' TO DFHEIV0
 20395     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20396     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20397     MOVE X'3920233030303139323537' TO DFHEIV0(25:11)
 20398     CALL 'kxdfhei1' USING DFHEIV0
 20399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20400
 20401
 20402
 20403* EXEC CICS STARTBR
 20404*        DATASET    (AGTC-ID)
 20405*        RIDFLD     (ERAGTC-KEY)
 20406*        GTEQ
 20407*    END-EXEC.
 20408     MOVE 0
 20409       TO DFHEIV11
 20410*    MOVE '&,         G          &   #00019262' TO DFHEIV0
 20411     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20412     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20413     MOVE X'2020233030303139323632' TO DFHEIV0(25:11)
 20414     CALL 'kxdfhei1' USING DFHEIV0,
 20415           AGTC-ID,
 20416           ERAGTC-KEY,
 20417           DFHEIV99,
 20418           DFHEIV11,
 20419           DFHEIV99
 20420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20421
 20422
 20423 8583-READ-ERAGTC-NEXT.
 20424
 20425* EXEC CICS READNEXT
 20426*        DATASET     (AGTC-ID)
 20427*        INTO        (AGENT-COMMISSIONS)
 20428*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 378
* EL050.cbl
 20429*    END-EXEC.
 20430     MOVE LENGTH OF
 20431      AGENT-COMMISSIONS
 20432       TO DFHEIV12
 20433     MOVE 0
 20434       TO DFHEIV11
 20435*    MOVE '&.IL                  )   #00019269' TO DFHEIV0
 20436     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20437     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20438     MOVE X'2020233030303139323639' TO DFHEIV0(25:11)
 20439     CALL 'kxdfhei1' USING DFHEIV0,
 20440           AGTC-ID,
 20441           AGENT-COMMISSIONS,
 20442           DFHEIV12,
 20443           ERAGTC-KEY,
 20444           DFHEIV99,
 20445           DFHEIV11,
 20446           DFHEIV99,
 20447           DFHEIV99
 20448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20449
 20450
 20451*    MOVE 'Y'                    TO AGTC-MASTER-SW
 20452
 20453     GO TO 8583-EXIT
 20454     .
 20455 8583-AGTC-NOT-FOUND.
 20456
 20457     MOVE 'N'                    TO AGTC-MASTER-SW.
 20458
 20459 8583-EXIT.
 20460     EXIT.
 20461
 20462 8584-READ-BANK-CROSS-REF.
 20463
 20464* EXEC CICS HANDLE CONDITION
 20465*        NOTFND    (8584-BXRF-NOT-FOUND)
 20466*        ENDFILE   (8584-BXRF-NOT-FOUND)
 20467*    END-EXEC.
 20468*    MOVE '"$I''                  ! : #00019287' TO DFHEIV0
 20469     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20470     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20471     MOVE X'3A20233030303139323837' TO DFHEIV0(25:11)
 20472     CALL 'kxdfhei1' USING DFHEIV0
 20473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20474
 20475
 20476
 20477* EXEC CICS READ
 20478*        DATASET     (BXRF-ID)
 20479*        INTO        (BANK-CROSS-REFERENCE)
 20480*        RIDFLD      (ERBXRF-KEY)
 20481*        LENGTH      (BXRF-REC-LENGTH)
 20482*    END-EXEC.
 20483*    MOVE '&"IL       E          (   #00019292' TO DFHEIV0
 20484     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20485     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20486     MOVE X'2020233030303139323932' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 379
* EL050.cbl
 20487     CALL 'kxdfhei1' USING DFHEIV0,
 20488           BXRF-ID,
 20489           BANK-CROSS-REFERENCE,
 20490           BXRF-REC-LENGTH,
 20491           ERBXRF-KEY,
 20492           DFHEIV99,
 20493           DFHEIV99,
 20494           DFHEIV99
 20495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20496
 20497
 20498     MOVE 'Y'                    TO BXRF-MASTER-SW
 20499
 20500     GO TO 8584-EXIT
 20501     .
 20502 8584-BXRF-NOT-FOUND.
 20503
 20504     MOVE 'N'                    TO BXRF-MASTER-SW.
 20505
 20506 8584-EXIT.
 20507     EXIT.
 20508
 20509 8585-READ-PLAN-MASTER.
 20510
 20511
 20512* EXEC CICS HANDLE CONDITION
 20513*        NOTFND    (8585-PLAN-NOT-FOUND)
 20514*        ENDFILE   (8585-PLAN-NOT-FOUND)
 20515*    END-EXEC.
 20516*    MOVE '"$I''                  ! ; #00019312' TO DFHEIV0
 20517     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20518     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20519     MOVE X'3B20233030303139333132' TO DFHEIV0(25:11)
 20520     CALL 'kxdfhei1' USING DFHEIV0
 20521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20522
 20523
 20524
 20525* EXEC CICS READ
 20526*        DATASET     (PLAN-ID)
 20527*        INTO        (PLAN-MASTER)
 20528*        RIDFLD      (ERPLAN-KEY)
 20529*    END-EXEC.
 20530     MOVE LENGTH OF
 20531      PLAN-MASTER
 20532       TO DFHEIV11
 20533*    MOVE '&"IL       E          (   #00019317' TO DFHEIV0
 20534     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20535     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20536     MOVE X'2020233030303139333137' TO DFHEIV0(25:11)
 20537     CALL 'kxdfhei1' USING DFHEIV0,
 20538           PLAN-ID,
 20539           PLAN-MASTER,
 20540           DFHEIV11,
 20541           ERPLAN-KEY,
 20542           DFHEIV99,
 20543           DFHEIV99,
 20544           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 380
* EL050.cbl
 20545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20546
 20547
 20548     MOVE 'Y'                    TO PLAN-MASTER-SW.
 20549
 20550     GO TO 8585-EXIT.
 20551
 20552 8585-PLAN-NOT-FOUND.
 20553
 20554     MOVE 'N'                    TO PLAN-MASTER-SW.
 20555
 20556 8585-EXIT.
 20557     EXIT.
 20558
 20559 8586-READ-LOAN-OFFICER.
 20560
 20561* EXEC CICS READ
 20562*        DATASET     (LOFC-ID)
 20563*        INTO        (LOAN-OFFICER-MASTER)
 20564*        RIDFLD      (ERLOFC-KEY)
 20565*        RESP        (WS-RESPONSE)
 20566*    END-EXEC
 20567     MOVE LENGTH OF
 20568      LOAN-OFFICER-MASTER
 20569       TO DFHEIV11
 20570*    MOVE '&"IL       E          (  N#00019335' TO DFHEIV0
 20571     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20572     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20573     MOVE X'204E233030303139333335' TO DFHEIV0(25:11)
 20574     CALL 'kxdfhei1' USING DFHEIV0,
 20575           LOFC-ID,
 20576           LOAN-OFFICER-MASTER,
 20577           DFHEIV11,
 20578           ERLOFC-KEY,
 20579           DFHEIV99,
 20580           DFHEIV99,
 20581           DFHEIV99
 20582     MOVE EIBRESP  TO WS-RESPONSE
 20583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20584
 20585     IF WS-RESP-NORMAL
 20586        MOVE 'Y'                 TO LOFC-MASTER-SW
 20587     ELSE
 20588        MOVE 'N'                 TO LOFC-MASTER-SW
 20589     END-IF
 20590     .
 20591 8586-EXIT.
 20592     EXIT.
 20593 8587-START-ERPDEF.
 20594
 20595* EXEC CICS STARTBR
 20596*       DATASET   (PDEF-ID)
 20597*       RIDFLD    (ERPDEF-KEY)
 20598*       GTEQ
 20599*       RESP      (WS-RESPONSE)
 20600*    END-EXEC
 20601     MOVE 0
 20602       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 381
* EL050.cbl
 20603*    MOVE '&,         G          &  N#00019351' TO DFHEIV0
 20604     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20605     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20606     MOVE X'204E233030303139333531' TO DFHEIV0(25:11)
 20607     CALL 'kxdfhei1' USING DFHEIV0,
 20608           PDEF-ID,
 20609           ERPDEF-KEY,
 20610           DFHEIV99,
 20611           DFHEIV11,
 20612           DFHEIV99
 20613     MOVE EIBRESP  TO WS-RESPONSE
 20614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20615     IF WS-RESP-NORMAL
 20616        MOVE 'Y'                 TO PDEF-MASTER-SW
 20617     ELSE
 20618        MOVE 'N'                 TO PDEF-MASTER-SW
 20619     END-IF
 20620     .
 20621 8587-EXIT.
 20622     EXIT.
 20623 8588-READ-ERPDEF.
 20624
 20625* EXEC CICS READNEXT
 20626*       DATASET   (PDEF-ID)
 20627*       RIDFLD    (ERPDEF-KEY)
 20628*       INTO      (PRODUCT-MASTER)
 20629*       RESP      (WS-RESPONSE)
 20630*    END-EXEC
 20631     MOVE LENGTH OF
 20632      PRODUCT-MASTER
 20633       TO DFHEIV12
 20634     MOVE 0
 20635       TO DFHEIV11
 20636*    MOVE '&.IL                  )  N#00019366' TO DFHEIV0
 20637     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20638     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20639     MOVE X'204E233030303139333636' TO DFHEIV0(25:11)
 20640     CALL 'kxdfhei1' USING DFHEIV0,
 20641           PDEF-ID,
 20642           PRODUCT-MASTER,
 20643           DFHEIV12,
 20644           ERPDEF-KEY,
 20645           DFHEIV99,
 20646           DFHEIV11,
 20647           DFHEIV99,
 20648           DFHEIV99
 20649     MOVE EIBRESP  TO WS-RESPONSE
 20650     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20651     IF WS-RESP-NORMAL
 20652        MOVE 'Y'                 TO PDEF-MASTER-SW
 20653     ELSE
 20654        MOVE 'N'                 TO PDEF-MASTER-SW
 20655     END-IF
 20656     .
 20657 8588-EXIT.
 20658     EXIT.
 20659 8589-ENDBR-ERPDEF.
 20660
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 382
* EL050.cbl
 20661* EXEC CICS ENDBR
 20662*       DATASET   (PDEF-ID)
 20663*    END-EXEC
 20664     MOVE 0
 20665       TO DFHEIV11
 20666*    MOVE '&2                    $   #00019381' TO DFHEIV0
 20667     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20668     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20669     MOVE X'2020233030303139333831' TO DFHEIV0(25:11)
 20670     CALL 'kxdfhei1' USING DFHEIV0,
 20671           PDEF-ID,
 20672           DFHEIV11,
 20673           DFHEIV99
 20674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20675     .
 20676 8589-EXIT.
 20677     EXIT.
 20678 8590-READ-CERT-MASTER.
 20679     IF PB-COMPANY-ID = 'UCL'
 20680         GO TO 8690-READ-CERT-MASTER-UCL.
 20681
 20682
 20683* EXEC CICS HANDLE CONDITION
 20684*         NOTFND    (0299-CERT-NOT-FOUND)
 20685*    END-EXEC.
 20686*    MOVE '"$I                   ! < #00019391' TO DFHEIV0
 20687     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20688     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20689     MOVE X'3C20233030303139333931' TO DFHEIV0(25:11)
 20690     CALL 'kxdfhei1' USING DFHEIV0
 20691     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20692
 20693
 20694
 20695* EXEC CICS READ
 20696*        DATASET     (CERT-ID)
 20697*        INTO        (CERTIFICATE-MASTER)
 20698*        RIDFLD      (ELCERT-KEY)
 20699*        UPDATE
 20700*    END-EXEC.
 20701     MOVE LENGTH OF
 20702      CERTIFICATE-MASTER
 20703       TO DFHEIV11
 20704*    MOVE '&"IL       EU         (   #00019395' TO DFHEIV0
 20705     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20706     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20707     MOVE X'2020233030303139333935' TO DFHEIV0(25:11)
 20708     CALL 'kxdfhei1' USING DFHEIV0,
 20709           CERT-ID,
 20710           CERTIFICATE-MASTER,
 20711           DFHEIV11,
 20712           ELCERT-KEY,
 20713           DFHEIV99,
 20714           DFHEIV99,
 20715           DFHEIV99
 20716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20717
 20718
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 383
* EL050.cbl
 20719 8590-EXIT.
 20720     EXIT.
 20721
 20722 8690-READ-CERT-MASTER-UCL.
 20723
 20724* EXEC CICS HANDLE CONDITION
 20725*         NOTFND    (8700-READ-CERT-MASTER)
 20726*    END-EXEC.
 20727*    MOVE '"$I                   ! = #00019406' TO DFHEIV0
 20728     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20729     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20730     MOVE X'3D20233030303139343036' TO DFHEIV0(25:11)
 20731     CALL 'kxdfhei1' USING DFHEIV0
 20732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20733
 20734
 20735 8690-READ-CERT-CONT.
 20736
 20737* EXEC CICS READ
 20738*        DATASET     (CERT-ID)
 20739*        INTO        (CERTIFICATE-MASTER)
 20740*        RIDFLD      (ELCERT-KEY)
 20741*        UPDATE
 20742*    END-EXEC.
 20743     MOVE LENGTH OF
 20744      CERTIFICATE-MASTER
 20745       TO DFHEIV11
 20746*    MOVE '&"IL       EU         (   #00019411' TO DFHEIV0
 20747     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20748     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20749     MOVE X'2020233030303139343131' TO DFHEIV0(25:11)
 20750     CALL 'kxdfhei1' USING DFHEIV0,
 20751           CERT-ID,
 20752           CERTIFICATE-MASTER,
 20753           DFHEIV11,
 20754           ELCERT-KEY,
 20755           DFHEIV99,
 20756           DFHEIV99,
 20757           DFHEIV99
 20758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20759
 20760
 20761     GO TO 8590-EXIT.
 20762
 20763 8700-READ-CERT-MASTER.
 20764     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 20765     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 20766
 20767* EXEC CICS HANDLE CONDITION
 20768*         DUPKEY    (8720-COMP-ACCOUNTS)
 20769*         ENDFILE   (8730-END-BROWSE)
 20770*         NOTFND    (8740-NOT-FOUND)
 20771*    END-EXEC.
 20772*    MOVE '"$$''I                 ! > #00019423' TO DFHEIV0
 20773     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 20774     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20775     MOVE X'3E20233030303139343233' TO DFHEIV0(25:11)
 20776     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 384
* EL050.cbl
 20777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20778
 20779
 20780
 20781* EXEC CICS STARTBR
 20782*        DATASET     ('ELCERT5')
 20783*        RIDFLD      (ELCERT2-KEY)
 20784*        EQUAL
 20785*    END-EXEC.
 20786     MOVE 'ELCERT5' TO DFHEIV1
 20787     MOVE 0
 20788       TO DFHEIV11
 20789*    MOVE '&,         E          &   #00019429' TO DFHEIV0
 20790     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 20791     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20792     MOVE X'2020233030303139343239' TO DFHEIV0(25:11)
 20793     CALL 'kxdfhei1' USING DFHEIV0,
 20794           DFHEIV1,
 20795           ELCERT2-KEY,
 20796           DFHEIV99,
 20797           DFHEIV11,
 20798           DFHEIV99
 20799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20800
 20801
 20802 8710-READ-NEXT.
 20803
 20804* EXEC CICS READNEXT
 20805*        DATASET     ('ELCERT5')
 20806*        INTO        (CERTIFICATE-MASTER)
 20807*        RIDFLD      (ELCERT2-KEY)
 20808*    END-EXEC.
 20809     MOVE LENGTH OF
 20810      CERTIFICATE-MASTER
 20811       TO DFHEIV12
 20812     MOVE 'ELCERT5' TO DFHEIV1
 20813     MOVE 0
 20814       TO DFHEIV11
 20815*    MOVE '&.IL                  )   #00019436' TO DFHEIV0
 20816     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20817     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20818     MOVE X'2020233030303139343336' TO DFHEIV0(25:11)
 20819     CALL 'kxdfhei1' USING DFHEIV0,
 20820           DFHEIV1,
 20821           CERTIFICATE-MASTER,
 20822           DFHEIV12,
 20823           ELCERT2-KEY,
 20824           DFHEIV99,
 20825           DFHEIV11,
 20826           DFHEIV99,
 20827           DFHEIV99
 20828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20829
 20830
 20831 8720-COMP-ACCOUNTS.
 20832
 20833* EXEC CICS ENTER
 20834*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 385
* EL050.cbl
 20835*         FROM (PB-C-LAST-NAME)
 20836*    END-EXEC.
 20837     MOVE 001
 20838       TO DFHEIV11
 20839*    MOVE ':$F                   %   #00019443' TO DFHEIV0
 20840     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20841     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20842     MOVE X'2020233030303139343433' TO DFHEIV0(25:11)
 20843     CALL 'kxdfhei1' USING DFHEIV0,
 20844           DFHEIV11,
 20845           PB-C-LAST-NAME,
 20846           DFHEIV99,
 20847           DFHEIV99
 20848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20849
 20850
 20851
 20852* EXEC CICS ENTER
 20853*         TRACEID (002)
 20854*         FROM (CM-INSURED-LAST-NAME)
 20855*    END-EXEC.
 20856     MOVE 002
 20857       TO DFHEIV11
 20858*    MOVE ':$F                   %   #00019448' TO DFHEIV0
 20859     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20860     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20861     MOVE X'2020233030303139343438' TO DFHEIV0(25:11)
 20862     CALL 'kxdfhei1' USING DFHEIV0,
 20863           DFHEIV11,
 20864           CM-INSURED-LAST-NAME,
 20865           DFHEIV99,
 20866           DFHEIV99
 20867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20868
 20869
 20870     IF PB-CERT-NO NOT = CM-CERT-NO
 20871         GO TO 8730-END-BROWSE.
 20872
 20873     IF PB-ACCOUNT = CM-ACCOUNT
 20874         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 20875             MOVE ER-2799        TO WS-ERROR
 20876             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20877             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 20878             GO TO 8730-END-BROWSE.
 20879
 20880     GO TO 8710-READ-NEXT.
 20881
 20882 8730-END-BROWSE.
 20883
 20884* EXEC CICS ENDBR
 20885*         DATASET    ('ELCERT5')
 20886*    END-EXEC.
 20887     MOVE 'ELCERT5' TO DFHEIV1
 20888     MOVE 0
 20889       TO DFHEIV11
 20890*    MOVE '&2                    $   #00019466' TO DFHEIV0
 20891     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20892     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 386
* EL050.cbl
 20893     MOVE X'2020233030303139343636' TO DFHEIV0(25:11)
 20894     CALL 'kxdfhei1' USING DFHEIV0,
 20895           DFHEIV1,
 20896           DFHEIV11,
 20897           DFHEIV99
 20898     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20899
 20900
 20901 8740-NOT-FOUND.
 20902     GO TO 0299-CERT-NOT-FOUND.
 20903
 20904 8750-START-ELSTAT.
 20905
 20906* EXEC CICS STARTBR
 20907*       DATASET   (STAT-ID)
 20908*       RIDFLD    (ELSTAT-KEY)
 20909*       GTEQ
 20910*       RESP      (WS-RESPONSE)
 20911*    END-EXEC
 20912     MOVE 0
 20913       TO DFHEIV11
 20914*    MOVE '&,         G          &  N#00019474' TO DFHEIV0
 20915     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20916     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20917     MOVE X'204E233030303139343734' TO DFHEIV0(25:11)
 20918     CALL 'kxdfhei1' USING DFHEIV0,
 20919           STAT-ID,
 20920           ELSTAT-KEY,
 20921           DFHEIV99,
 20922           DFHEIV11,
 20923           DFHEIV99
 20924     MOVE EIBRESP  TO WS-RESPONSE
 20925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20926     IF WS-RESP-NORMAL
 20927        MOVE 'Y'                 TO STAT-MASTER-SW
 20928     ELSE
 20929        MOVE 'N'                 TO STAT-MASTER-SW
 20930     END-IF
 20931     .
 20932 8750-EXIT.
 20933     EXIT.
 20934 8752-READ-ELSTAT.
 20935
 20936* EXEC CICS READNEXT
 20937*       DATASET   (STAT-ID)
 20938*       RIDFLD    (ELSTAT-KEY)
 20939*       INTO      (STATE-FILE)
 20940*       RESP      (WS-RESPONSE)
 20941*    END-EXEC
 20942     MOVE LENGTH OF
 20943      STATE-FILE
 20944       TO DFHEIV12
 20945     MOVE 0
 20946       TO DFHEIV11
 20947*    MOVE '&.IL                  )  N#00019489' TO DFHEIV0
 20948     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20949     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20950     MOVE X'204E233030303139343839' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 387
* EL050.cbl
 20951     CALL 'kxdfhei1' USING DFHEIV0,
 20952           STAT-ID,
 20953           STATE-FILE,
 20954           DFHEIV12,
 20955           ELSTAT-KEY,
 20956           DFHEIV99,
 20957           DFHEIV11,
 20958           DFHEIV99,
 20959           DFHEIV99
 20960     MOVE EIBRESP  TO WS-RESPONSE
 20961     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20962     IF WS-RESP-NORMAL
 20963        MOVE 'Y'                 TO STAT-MASTER-SW
 20964     ELSE
 20965        MOVE 'N'                 TO STAT-MASTER-SW
 20966     END-IF
 20967     .
 20968 8752-EXIT.
 20969     EXIT.
 20970 8800-GET-COMP-RATE.
 20971     MOVE +1 TO IB.
 20972     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 20973         ADD +9 TO IB
 20974         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 20975             ADD +9 TO IB
 20976             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 20977                MOVE ZEROS       TO WS-WK-RATE
 20978                GO TO 8800-EXIT.
 20979
 20980     IF PB-I-AGE GREATER CT-AGE (1)
 20981         ADD +3 TO IB
 20982         IF PB-I-AGE GREATER CT-AGE (2)
 20983             ADD +3 TO IB
 20984             IF PB-I-AGE GREATER CT-AGE (3)
 20985                MOVE ZEROS       TO WS-WK-RATE
 20986                GO TO 8800-EXIT.
 20987
 20988     IF WS-WORK-TERM GREATER CT-TRM (1)
 20989         ADD +1 TO IB
 20990         IF WS-WORK-TERM GREATER CT-TRM (2)
 20991             ADD +1 TO IB
 20992             IF WS-WORK-TERM GREATER CT-TRM (3)
 20993                MOVE ZEROS       TO WS-WK-RATE
 20994                GO TO 8800-EXIT.
 20995
 20996     IF CT-RT (IB) NOT NUMERIC
 20997         MOVE CT-RT-R (IB) TO CTBL-TABLE
 20998         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 20999         GO TO 8800-GET-COMP-RATE.
 21000
 21001     MOVE CT-RT (IB) TO WS-WK-RATE.
 21002
 21003 8800-EXIT.
 21004     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 388
* EL050.cbl
 21006 8900-ADDRESS-FILE.
 21007     IF ERACCT-FILE-ADDRESSED
 21008         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 21009         GO TO 8900-ADDRESS-EXIT.
 21010
 21011     IF ELCNTL-FILE-ADDRESSED
 21012         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 21013         GO TO 8900-ADDRESS-EXIT.
 21014
 21015     IF ERPLAN-FILE-ADDRESSED
 21016         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 21017         GO TO 8900-ADDRESS-EXIT.
 21018
 21019     IF ERFORM-FILE-ADDRESSED
 21020         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 21021         GO TO 8900-ADDRESS-EXIT.
 21022
 21023 8900-ADDRESS-EXIT.
 21024     EXIT.
 21025
 21026 9000-READ-CONTROL.
 21027
 21028* EXEC CICS HANDLE CONDITION
 21029*        NOTFND    (9000-NOTFND)
 21030*    END-EXEC.
 21031*    MOVE '"$I                   ! ? #00019560' TO DFHEIV0
 21032     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21033     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21034     MOVE X'3F20233030303139353630' TO DFHEIV0(25:11)
 21035     CALL 'kxdfhei1' USING DFHEIV0
 21036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21037
 21038
 21039
 21040* EXEC CICS READ
 21041*        DATASET     (CNTL-ID)
 21042*        SET         (ADDRESS OF CONTROL-FILE)
 21043*        RIDFLD      (ELCNTL-KEY)
 21044*        GTEQ
 21045*    END-EXEC.
 21046*    MOVE '&"S        G          (   #00019564' TO DFHEIV0
 21047     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21048     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21049     MOVE X'2020233030303139353634' TO DFHEIV0(25:11)
 21050     CALL 'kxdfhei1' USING DFHEIV0,
 21051           CNTL-ID,
 21052           DFHEIV20,
 21053           DFHEIV99,
 21054           ELCNTL-KEY,
 21055           DFHEIV99,
 21056           DFHEIV99,
 21057           DFHEIV99
 21058     SET ADDRESS OF CONTROL-FILE TO
 21059         DFHEIV20
 21060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21061
 21062
 21063     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 389
* EL050.cbl
 21064
 21065 9000-NOTFND.
 21066     IF RC-SW-1 = '1'
 21067        MOVE ER-2616              TO WS-ERROR
 21068        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21069        GO TO 9000-EXIT.
 21070
 21071     IF RC-SW-1 = '2'
 21072        MOVE ER-2602              TO WS-ERROR
 21073        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21074
 21075 9000-EXIT.
 21076      EXIT.
 21077
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 390
* EL050.cbl
 21079 9100-READ-CONTROL.
 21080
 21081* EXEC CICS HANDLE CONDITION
 21082*        NOTFND  (9100-NOTFND)
 21083*        ENDFILE (9100-NOTFND)
 21084*    END-EXEC.
 21085*    MOVE '"$I''                  ! @ #00019588' TO DFHEIV0
 21086     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21087     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21088     MOVE X'4020233030303139353838' TO DFHEIV0(25:11)
 21089     CALL 'kxdfhei1' USING DFHEIV0
 21090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21091
 21092
 21093
 21094* EXEC CICS READ
 21095*        DATASET     (CNTL-ID)
 21096*        INTO        (CONTROL-FILE)
 21097*        RIDFLD      (ELCNTL-KEY)
 21098*        GTEQ
 21099*    END-EXEC.
 21100     MOVE LENGTH OF
 21101      CONTROL-FILE
 21102       TO DFHEIV11
 21103*    MOVE '&"IL       G          (   #00019593' TO DFHEIV0
 21104     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21105     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21106     MOVE X'2020233030303139353933' TO DFHEIV0(25:11)
 21107     CALL 'kxdfhei1' USING DFHEIV0,
 21108           CNTL-ID,
 21109           CONTROL-FILE,
 21110           DFHEIV11,
 21111           ELCNTL-KEY,
 21112           DFHEIV99,
 21113           DFHEIV99,
 21114           DFHEIV99
 21115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21116
 21117
 21118     GO TO 9100-EXIT.
 21119
 21120 9100-NOTFND.
 21121     IF RC-SW-2 = '0'
 21122        MOVE '1'                  TO STATE-RECORD-ERROR
 21123        GO TO 9100-EXIT
 21124     END-IF
 21125     IF RC-SW-2 = '1'
 21126        MOVE '1'                  TO LF-BENEFIT-ERROR
 21127        MOVE ER-2604              TO WS-ERROR
 21128        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21129        GO TO 9100-EXIT.
 21130
 21131     IF RC-SW-2 = '2'
 21132        MOVE '1'                  TO AH-BENEFIT-ERROR
 21133        MOVE ER-2605              TO WS-ERROR
 21134        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21135        GO TO 9100-EXIT.
 21136
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 391
* EL050.cbl
 21137     IF RC-SW-2 = '3'
 21138         MOVE ER-2603           TO WS-ERROR
 21139         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21140         GO TO 9100-EXIT.
 21141
 21142     IF RC-SW-2 = '4'
 21143         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 21144         GO TO 9100-EXIT.
 21145
 21146     IF RC-SW-2 = '5'
 21147         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 21148         IF WS-AH-INPUT-CD-1 = SPACE
 21149             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 21150         ELSE
 21151             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 21152
 21153 9100-EXIT.
 21154      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 392
* EL050.cbl
 21156 9200-CONTROL-GETMAIN.
 21157
 21158* EXEC CICS GETMAIN
 21159*         LENGTH   (750)
 21160*         SET      (ADDRESS OF CONTROL-FILE)
 21161*    END-EXEC.
 21162     MOVE 750
 21163       TO DFHEIV11
 21164*    MOVE '," L                  $   #00019639' TO DFHEIV0
 21165     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21166     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21167     MOVE X'2020233030303139363339' TO DFHEIV0(25:11)
 21168     CALL 'kxdfhei1' USING DFHEIV0,
 21169           DFHEIV20,
 21170           DFHEIV11,
 21171           DFHEIV99
 21172     SET ADDRESS OF CONTROL-FILE TO
 21173         DFHEIV20
 21174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21175
 21176
 21177     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 21178
 21179 9200-EXIT.
 21180     EXIT.
 21181
 21182 9250-UNLOCK-RETURN.
 21183
 21184* EXEC CICS UNLOCK
 21185*        DATASET   (CERT-ID)
 21186*    END-EXEC.
 21187*    MOVE '&*                    #   #00019650' TO DFHEIV0
 21188     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21189     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21190     MOVE X'2020233030303139363530' TO DFHEIV0(25:11)
 21191     CALL 'kxdfhei1' USING DFHEIV0,
 21192           CERT-ID,
 21193           DFHEIV99
 21194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21195
 21196
 21197 9300-ABEND.
 21198     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 21199
 21200
 21201* EXEC CICS LINK
 21202*        PROGRAM   ('EL004')
 21203*        COMMAREA  (WS-ERROR-LINE)
 21204*        LENGTH    (72)
 21205*    END-EXEC.
 21206     MOVE 'EL004' TO DFHEIV1
 21207     MOVE 72
 21208       TO DFHEIV11
 21209*    MOVE '."C                   (   #00019657' TO DFHEIV0
 21210     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21211     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21212     MOVE X'2020233030303139363537' TO DFHEIV0(25:11)
 21213     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 393
* EL050.cbl
 21214           DFHEIV1,
 21215           WS-ERROR-LINE,
 21216           DFHEIV11,
 21217           DFHEIV99,
 21218           DFHEIV99,
 21219           DFHEIV99,
 21220           DFHEIV99
 21221     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21222
 21223
 21224     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 21225
 21226
 21227* EXEC CICS ABEND
 21228*        ABCODE ('EL50')
 21229*    END-EXEC.
 21230     MOVE 'EL50' TO DFHEIV5
 21231*    MOVE '.,A                   "   #00019665' TO DFHEIV0
 21232     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 21233     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 21234     MOVE X'2020233030303139363635' TO DFHEIV0(25:11)
 21235     CALL 'kxdfhei1' USING DFHEIV0,
 21236           DFHEIV5
 21237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21238
 21239
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 394
* EL050.cbl
 21241
 21242******************************************************************
 21243*                                                                *
 21244*            E R R O R   F O R M A T   R O U T I N E             *
 21245*                                                                *
 21246******************************************************************
 21247
 21248 9900-ERROR-FORMAT.
 21249
 21250     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 21251                    PB-COMMON-ERROR (2) OR
 21252                    PB-COMMON-ERROR (3) OR
 21253                    PB-COMMON-ERROR (4) OR
 21254                    PB-COMMON-ERROR (5) OR
 21255                    PB-COMMON-ERROR (6) OR
 21256                    PB-COMMON-ERROR (7) OR
 21257                    PB-COMMON-ERROR (8) OR
 21258                    PB-COMMON-ERROR (9) OR
 21259                    PB-COMMON-ERROR (10)
 21260        GO TO 9900-EXIT.
 21261
 21262     IF PB-NO-OF-ERRORS = +10
 21263        GO TO 9900-EXIT.
 21264
 21265     ADD +1  TO PB-NO-OF-ERRORS.
 21266     MOVE WS-ERROR               TO PB-COMMON-ERROR
 21267                                       (PB-NO-OF-ERRORS).
 21268 9900-EXIT.
 21269     EXIT.
 21270
 21271 9990-RETURN.
 21272     IF BROWSE-STARTED
 21273
 21274* EXEC CICS ENDBR
 21275*            DATASET  (ACCT-ID)
 21276*       END-EXEC.
 21277     MOVE 0
 21278       TO DFHEIV11
 21279*    MOVE '&2                    $   #00019702' TO DFHEIV0
 21280     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21281     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21282     MOVE X'2020233030303139373032' TO DFHEIV0(25:11)
 21283     CALL 'kxdfhei1' USING DFHEIV0,
 21284           ACCT-ID,
 21285           DFHEIV11,
 21286           DFHEIV99
 21287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21288
 21289
 21290 9990-EXIT.
 21291     EXIT.
 21292
 21293
 21294****Check for CRTO record, add one if not found.
 21295 9991-CHECK-FOR-ELCRTO.
 21296
 21297* EXEC CICS HANDLE CONDITION
 21298*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 395
* EL050.cbl
 21299*         ENDFILE (9991-CRTO-NOT-FOUND)
 21300*     END-EXEC.
 21301*    MOVE '"$I''                  ! A #00019712' TO DFHEIV0
 21302     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21303     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21304     MOVE X'4120233030303139373132' TO DFHEIV0(25:11)
 21305     CALL 'kxdfhei1' USING DFHEIV0
 21306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21307
 21308     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21309     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21310     MOVE +0                     TO ELCRTO-SEQ-NO
 21311
 21312
 21313* EXEC CICS READ
 21314*       DATASET   ('ELCRTO')
 21315*       INTO      (ORIGINAL-CERTIFICATE)
 21316*       RIDFLD    (ELCRTO-KEY)
 21317*       GTEQ
 21318*       RESP      (WS-RESPONSE)
 21319*    END-EXEC
 21320     MOVE LENGTH OF
 21321      ORIGINAL-CERTIFICATE
 21322       TO DFHEIV11
 21323     MOVE 'ELCRTO' TO DFHEIV1
 21324*    MOVE '&"IL       G          (  N#00019720' TO DFHEIV0
 21325     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21326     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21327     MOVE X'204E233030303139373230' TO DFHEIV0(25:11)
 21328     CALL 'kxdfhei1' USING DFHEIV0,
 21329           DFHEIV1,
 21330           ORIGINAL-CERTIFICATE,
 21331           DFHEIV11,
 21332           ELCRTO-KEY,
 21333           DFHEIV99,
 21334           DFHEIV99,
 21335           DFHEIV99
 21336     MOVE EIBRESP  TO WS-RESPONSE
 21337     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21338
 21339     IF WS-RESP-NORMAL
 21340        AND (OC-CONTROL-PRIMARY (1:33) =
 21341                 PB-CONTROL-BY-ACCOUNT (1:33))
 21342        AND (OC-RECORD-TYPE =  'I')
 21343           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21344               GO TO 9991-CHECK-INDICATORS
 21345           ELSE
 21346               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21347               GO TO 9991-CRTO-ADD-REC
 21348           END-IF
 21349     END-IF.
 21350
 21351 9991-CRTO-NOT-FOUND.
 21352
 21353     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21354     MOVE 'OC'                TO OC-RECORD-ID
 21355     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21356                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 396
* EL050.cbl
 21357     MOVE +4096               TO OC-KEY-SEQ-NO.
 21358
 21359 9991-CRTO-ADD-REC.
 21360
 21361     MOVE 'E050'              TO OC-LAST-MAINT-BY
 21362     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 21363     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21364     MOVE 'I'                 TO OC-RECORD-TYPE
 21365     IF PB-ISSUE
 21366         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21367         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21368         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21369         MOVE PB-I-AGE               TO OC-INS-AGE
 21370         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21371         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21372         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21373         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21374         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21375         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21376         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21377         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21378         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21379         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21380         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21381         IF PB-I-JOINT-COMMISSION > +0
 21382             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21383         ELSE
 21384             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21385         END-IF
 21386         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21387         MOVE +0                     TO OC-LF-CANCEL-AMT
 21388                                        OC-LF-ITD-CANCEL-AMT
 21389         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21390         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21391         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21392         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21393         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21394         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21395         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21396         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21397         MOVE +0                     TO OC-AH-CANCEL-AMT
 21398                                        OC-AH-ITD-CANCEL-AMT
 21399         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21400         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21401         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 21402     ELSE
 21403         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21404         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21405         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21406         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21407         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21408         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21409         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21410         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21411         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21412          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21413             MOVE SPACES             TO OC-LF-BENCD
 21414             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 397
* EL050.cbl
 21415                                        OC-LF-BEN-AMT
 21416                                        OC-LF-PRM-AMT
 21417                                        OC-LF-ALT-BEN-AMT
 21418                                        OC-LF-ALT-PRM-AMT
 21419                                        OC-LF-COMM-PCT
 21420                                        OC-LF-CANCEL-AMT
 21421             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21422             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21423         ELSE
 21424             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21425             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21426             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21427             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21428             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21429             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21430             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21431             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21432             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21433             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21434         END-IF
 21435         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21436         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21437          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21438             MOVE SPACES             TO OC-AH-BENCD
 21439             MOVE ZEROS              TO OC-AH-TERM
 21440                                        OC-AH-BEN-AMT
 21441                                        OC-AH-PRM-AMT
 21442                                        OC-AH-COMM-PCT
 21443                                        OC-AH-CANCEL-AMT
 21444                                        OC-AH-CP
 21445             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21446             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21447         ELSE
 21448             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21449             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21450             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21451             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21452             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21453             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21454             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 21455             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21456             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21457         END-IF
 21458         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21459         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21460         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 21461         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 21462     END-IF
 21463     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21464
 21465     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21466
 21467
 21468* EXEC CICS READ
 21469*         DATASET   (FILE-ERMAIL)
 21470*         RIDFLD    (MA-CONTROL-PRIMARY)
 21471*         INTO      (MAILING-DATA)
 21472*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 398
* EL050.cbl
 21473*    END-EXEC
 21474     MOVE LENGTH OF
 21475      MAILING-DATA
 21476       TO DFHEIV11
 21477*    MOVE '&"IL       E          (  N#00019856' TO DFHEIV0
 21478     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21479     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21480     MOVE X'204E233030303139383536' TO DFHEIV0(25:11)
 21481     CALL 'kxdfhei1' USING DFHEIV0,
 21482           FILE-ERMAIL,
 21483           MAILING-DATA,
 21484           DFHEIV11,
 21485           MA-CONTROL-PRIMARY,
 21486           DFHEIV99,
 21487           DFHEIV99,
 21488           DFHEIV99
 21489     MOVE EIBRESP  TO WS-RESPONSE
 21490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21491
 21492     IF WS-RESP-NORMAL
 21493         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21494     END-IF.
 21495
 21496     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21497     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21498
 21499
 21500* EXEC CICS READ
 21501*         DATASET  (CRTT-ID)
 21502*         RIDFLD   (WS-ELCRTT-KEY)
 21503*         INTO     (CERTIFICATE-TRAILERS)
 21504*         RESP     (WS-RESPONSE)
 21505*    END-EXEC
 21506     MOVE LENGTH OF
 21507      CERTIFICATE-TRAILERS
 21508       TO DFHEIV11
 21509*    MOVE '&"IL       E          (  N#00019870' TO DFHEIV0
 21510     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21511     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21512     MOVE X'204E233030303139383730' TO DFHEIV0(25:11)
 21513     CALL 'kxdfhei1' USING DFHEIV0,
 21514           CRTT-ID,
 21515           CERTIFICATE-TRAILERS,
 21516           DFHEIV11,
 21517           WS-ELCRTT-KEY,
 21518           DFHEIV99,
 21519           DFHEIV99,
 21520           DFHEIV99
 21521     MOVE EIBRESP  TO WS-RESPONSE
 21522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21523
 21524     IF WS-RESP-NORMAL
 21525         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 21526         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21527     END-IF.
 21528
 21529
 21530* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 399
* EL050.cbl
 21531*       DATASET   ('ELCRTO')
 21532*       FROM      (ORIGINAL-CERTIFICATE)
 21533*       RIDFLD    (OC-CONTROL-PRIMARY)
 21534*       RESP      (WS-RESPONSE)
 21535*    END-EXEC.
 21536     MOVE LENGTH OF
 21537      ORIGINAL-CERTIFICATE
 21538       TO DFHEIV11
 21539     MOVE 'ELCRTO' TO DFHEIV1
 21540*    MOVE '&$ L                  ''  N#00019882' TO DFHEIV0
 21541     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21542     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21543     MOVE X'204E233030303139383832' TO DFHEIV0(25:11)
 21544     CALL 'kxdfhei1' USING DFHEIV0,
 21545           DFHEIV1,
 21546           ORIGINAL-CERTIFICATE,
 21547           DFHEIV11,
 21548           OC-CONTROL-PRIMARY,
 21549           DFHEIV99,
 21550           DFHEIV99
 21551     MOVE EIBRESP  TO WS-RESPONSE
 21552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21553
 21554
 21555     GO TO 9991-EXIT.
 21556
 21557 9991-CHECK-INDICATORS.
 21558
 21559     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 21560         GO TO 9991-EXIT
 21561     END-IF.
 21562
 21563     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 21564         GO TO 9991-EXIT
 21565     END-IF.
 21566
 21567
 21568* EXEC CICS READ
 21569*       DATASET   ('ELCRTO')
 21570*       INTO      (ORIGINAL-CERTIFICATE)
 21571*       RIDFLD    (OC-CONTROL-PRIMARY)
 21572*       UPDATE
 21573*       RESP      (WS-RESPONSE)
 21574*    END-EXEC
 21575     MOVE LENGTH OF
 21576      ORIGINAL-CERTIFICATE
 21577       TO DFHEIV11
 21578     MOVE 'ELCRTO' TO DFHEIV1
 21579*    MOVE '&"IL       EU         (  N#00019901' TO DFHEIV0
 21580     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21581     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21582     MOVE X'204E233030303139393031' TO DFHEIV0(25:11)
 21583     CALL 'kxdfhei1' USING DFHEIV0,
 21584           DFHEIV1,
 21585           ORIGINAL-CERTIFICATE,
 21586           DFHEIV11,
 21587           OC-CONTROL-PRIMARY,
 21588           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 400
* EL050.cbl
 21589           DFHEIV99,
 21590           DFHEIV99
 21591     MOVE EIBRESP  TO WS-RESPONSE
 21592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21593     IF WS-RESP-NORMAL
 21594        IF PB-ISSUE
 21595          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21596          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21597          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21598          MOVE PB-I-AGE               TO OC-INS-AGE
 21599          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21600          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21601          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21602          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21603          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21604          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21605          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21606          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21607          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21608          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21609          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21610          IF PB-I-JOINT-COMMISSION > +0
 21611              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21612          ELSE
 21613              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21614          END-IF
 21615          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21616          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21617          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21618          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21619          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21620          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21621          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21622          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21623          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21624
 21625          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21626
 21627* EXEC CICS READ
 21628*             DATASET   (FILE-ERMAIL)
 21629*             RIDFLD    (MA-CONTROL-PRIMARY)
 21630*             INTO      (MAILING-DATA)
 21631*             RESP      (WS-RESPONSE)
 21632*         END-EXEC
 21633     MOVE LENGTH OF
 21634      MAILING-DATA
 21635       TO DFHEIV11
 21636*    MOVE '&"IL       E          (  N#00019941' TO DFHEIV0
 21637     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21638     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21639     MOVE X'204E233030303139393431' TO DFHEIV0(25:11)
 21640     CALL 'kxdfhei1' USING DFHEIV0,
 21641           FILE-ERMAIL,
 21642           MAILING-DATA,
 21643           DFHEIV11,
 21644           MA-CONTROL-PRIMARY,
 21645           DFHEIV99,
 21646           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 401
* EL050.cbl
 21647           DFHEIV99
 21648     MOVE EIBRESP  TO WS-RESPONSE
 21649     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21650          IF WS-RESP-NORMAL
 21651             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21652          END-IF
 21653
 21654          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21655          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21656
 21657* EXEC CICS READ
 21658*             DATASET  (CRTT-ID)
 21659*             RIDFLD   (WS-ELCRTT-KEY)
 21660*             INTO     (CERTIFICATE-TRAILERS)
 21661*             RESP     (WS-RESPONSE)
 21662*         END-EXEC
 21663     MOVE LENGTH OF
 21664      CERTIFICATE-TRAILERS
 21665       TO DFHEIV11
 21666*    MOVE '&"IL       E          (  N#00019953' TO DFHEIV0
 21667     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21668     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21669     MOVE X'204E233030303139393533' TO DFHEIV0(25:11)
 21670     CALL 'kxdfhei1' USING DFHEIV0,
 21671           CRTT-ID,
 21672           CERTIFICATE-TRAILERS,
 21673           DFHEIV11,
 21674           WS-ELCRTT-KEY,
 21675           DFHEIV99,
 21676           DFHEIV99,
 21677           DFHEIV99
 21678     MOVE EIBRESP  TO WS-RESPONSE
 21679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21680          IF WS-RESP-NORMAL
 21681             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 21682                               OC-INS-AGE-DEFAULT-FLAG
 21683             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 21684                               OC-JNT-AGE-DEFAULT-FLAG
 21685          END-IF
 21686
 21687        ELSE
 21688          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21689             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21690             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21691             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 21692          END-IF
 21693          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21694             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21695             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21696             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 21697          END-IF
 21698          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 21699        END-IF
 21700
 21701* EXEC CICS REWRITE
 21702*          DATASET   ('ELCRTO')
 21703*          FROM      (ORIGINAL-CERTIFICATE)
 21704*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 402
* EL050.cbl
 21705*       END-EXEC
 21706     MOVE LENGTH OF
 21707      ORIGINAL-CERTIFICATE
 21708       TO DFHEIV11
 21709     MOVE 'ELCRTO' TO DFHEIV1
 21710*    MOVE '&& L                  %  N#00019979' TO DFHEIV0
 21711     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21712     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21713     MOVE X'204E233030303139393739' TO DFHEIV0(25:11)
 21714     CALL 'kxdfhei1' USING DFHEIV0,
 21715           DFHEIV1,
 21716           ORIGINAL-CERTIFICATE,
 21717           DFHEIV11,
 21718           DFHEIV99
 21719     MOVE EIBRESP  TO WS-RESPONSE
 21720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21721     END-IF.
 21722
 21723 9991-EXIT.
 21724     EXIT.
 21725
 21726
 21727 9999-RETURN.
 21728     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 21729
 21730
 21731* EXEC CICS RETURN
 21732*    END-EXEC.
 21733*    MOVE '.(                    ''   #00019993' TO DFHEIV0
 21734     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 21735     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21736     MOVE X'2020233030303139393933' TO DFHEIV0(25:11)
 21737     CALL 'kxdfhei1' USING DFHEIV0,
 21738           DFHEIV99,
 21739           DFHEIV99,
 21740           DFHEIV99,
 21741           DFHEIV99,
 21742           DFHEIV99,
 21743           DFHEIV99
 21744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21745
 21746
 21747
 21748* GOBACK.
 21749     MOVE '9%                    "   ' TO DFHEIV0
 21750     MOVE 'EL050' TO DFHEIV1
 21751     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21752     GOBACK.
 21753
 21754 9999-DFHBACK SECTION.
 21755     MOVE '9%                    "   ' TO DFHEIV0
 21756     MOVE 'EL050' TO DFHEIV1
 21757     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21758     GOBACK.
 21759 9999-DFHEXIT.
 21760     IF DFHEIGDJ EQUAL 0001
 21761         NEXT SENTENCE
 21762     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 403
* EL050.cbl
 21763         GO TO 9300-ABEND,
 21764               3990-FILES-NOT-OPEN
 21765         DEPENDING ON DFHEIGDI
 21766     ELSE IF DFHEIGDJ EQUAL 3
 21767         GO TO 6610-START-BROWSE,
 21768               6630-ERRESS-PROBLEM,
 21769               6630-END-OF-FILE
 21770         DEPENDING ON DFHEIGDI
 21771     ELSE IF DFHEIGDJ EQUAL 4
 21772         GO TO 6630-END-OF-FILE,
 21773               6630-ERRESS-PROBLEM,
 21774               6630-ERRESS-PROBLEM,
 21775               6630-END-OF-FILE
 21776         DEPENDING ON DFHEIGDI
 21777     ELSE IF DFHEIGDJ EQUAL 5
 21778         GO TO 6630-END-OF-FILE,
 21779               6630-END-OF-FILE,
 21780               6630-ERRESS-PROBLEM,
 21781               6630-ERRESS-PROBLEM
 21782         DEPENDING ON DFHEIGDI
 21783     ELSE IF DFHEIGDJ EQUAL 6
 21784         GO TO 6660-START-BROWSE,
 21785               6690-ERRESC-PROBLEM,
 21786               6690-ERRESC-PROBLEM,
 21787               6690-END-OF-FILE
 21788         DEPENDING ON DFHEIGDI
 21789     ELSE IF DFHEIGDJ EQUAL 7
 21790         GO TO 6690-END-OF-FILE,
 21791               6690-ERRESC-PROBLEM,
 21792               6690-ERRESC-PROBLEM,
 21793               6690-END-OF-FILE
 21794         DEPENDING ON DFHEIGDI
 21795     ELSE IF DFHEIGDJ EQUAL 8
 21796         GO TO 6690-END-OF-FILE,
 21797               6690-ERRESC-PROBLEM,
 21798               6690-ERRESC-PROBLEM,
 21799               6690-END-OF-FILE
 21800         DEPENDING ON DFHEIGDI
 21801     ELSE IF DFHEIGDJ EQUAL 9
 21802         GO TO 7250-CONTINUE,
 21803               7250-CONTINUE
 21804         DEPENDING ON DFHEIGDI
 21805     ELSE IF DFHEIGDJ EQUAL 10
 21806         GO TO 7300-CONTINUE,
 21807               7300-CONTINUE
 21808         DEPENDING ON DFHEIGDI
 21809     ELSE IF DFHEIGDJ EQUAL 11
 21810         GO TO 8000-FREE-MAIN
 21811         DEPENDING ON DFHEIGDI
 21812     ELSE IF DFHEIGDJ EQUAL 12
 21813         GO TO 8100-NOTFND,
 21814               8100-NOTFND
 21815         DEPENDING ON DFHEIGDI
 21816     ELSE IF DFHEIGDJ EQUAL 13
 21817         GO TO 8110-NOTFND,
 21818               8110-NOTFND
 21819         DEPENDING ON DFHEIGDI
 21820     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 404
* EL050.cbl
 21821         GO TO 8130-EXIT
 21822         DEPENDING ON DFHEIGDI
 21823     ELSE IF DFHEIGDJ EQUAL 15
 21824         GO TO 8150-exit
 21825         DEPENDING ON DFHEIGDI
 21826     ELSE IF DFHEIGDJ EQUAL 16
 21827         GO TO 8180-NOTFND
 21828         DEPENDING ON DFHEIGDI
 21829     ELSE IF DFHEIGDJ EQUAL 17
 21830         GO TO 8190-NOTFND
 21831         DEPENDING ON DFHEIGDI
 21832     ELSE IF DFHEIGDJ EQUAL 18
 21833         GO TO 8195-NOTFND
 21834         DEPENDING ON DFHEIGDI
 21835     ELSE IF DFHEIGDJ EQUAL 19
 21836         GO TO 8200-NOTFND
 21837         DEPENDING ON DFHEIGDI
 21838     ELSE IF DFHEIGDJ EQUAL 20
 21839         GO TO 8300-NOTFND,
 21840               8300-ERRESS-PROBLEM,
 21841               8300-ERRESS-PROBLEM,
 21842               8300-NOTFND
 21843         DEPENDING ON DFHEIGDI
 21844     ELSE IF DFHEIGDJ EQUAL 21
 21845         GO TO 8450-FORM-NOT-FOUND,
 21846               8450-FORM-NOT-FOUND
 21847         DEPENDING ON DFHEIGDI
 21848     ELSE IF DFHEIGDJ EQUAL 22
 21849         GO TO 0199-ACCT-NOT-FOUND,
 21850               0199-ACCT-NOT-FOUND
 21851         DEPENDING ON DFHEIGDI
 21852     ELSE IF DFHEIGDJ EQUAL 23
 21853         GO TO 0199-ACCT-NOT-FOUND,
 21854               0199-ACCT-NOT-FOUND
 21855         DEPENDING ON DFHEIGDI
 21856     ELSE IF DFHEIGDJ EQUAL 24
 21857         GO TO 8582-COMP-NOT-FOUND,
 21858               8582-COMP-NOT-FOUND
 21859         DEPENDING ON DFHEIGDI
 21860     ELSE IF DFHEIGDJ EQUAL 25
 21861         GO TO 8583-AGTC-NOT-FOUND,
 21862               8583-AGTC-NOT-FOUND
 21863         DEPENDING ON DFHEIGDI
 21864     ELSE IF DFHEIGDJ EQUAL 26
 21865         GO TO 8584-BXRF-NOT-FOUND,
 21866               8584-BXRF-NOT-FOUND
 21867         DEPENDING ON DFHEIGDI
 21868     ELSE IF DFHEIGDJ EQUAL 27
 21869         GO TO 8585-PLAN-NOT-FOUND,
 21870               8585-PLAN-NOT-FOUND
 21871         DEPENDING ON DFHEIGDI
 21872     ELSE IF DFHEIGDJ EQUAL 28
 21873         GO TO 0299-CERT-NOT-FOUND
 21874         DEPENDING ON DFHEIGDI
 21875     ELSE IF DFHEIGDJ EQUAL 29
 21876         GO TO 8700-READ-CERT-MASTER
 21877         DEPENDING ON DFHEIGDI
 21878     ELSE IF DFHEIGDJ EQUAL 30
* Micro Focus Server Express         V5.1 revision 000 18-Feb-14 11:30 Page 405
* EL050.cbl
 21879         GO TO 8720-COMP-ACCOUNTS,
 21880               8730-END-BROWSE,
 21881               8740-NOT-FOUND
 21882         DEPENDING ON DFHEIGDI
 21883     ELSE IF DFHEIGDJ EQUAL 31
 21884         GO TO 9000-NOTFND
 21885         DEPENDING ON DFHEIGDI
 21886     ELSE IF DFHEIGDJ EQUAL 32
 21887         GO TO 9100-NOTFND,
 21888               9100-NOTFND
 21889         DEPENDING ON DFHEIGDI
 21890     ELSE IF DFHEIGDJ EQUAL 33
 21891         GO TO 9991-CRTO-NOT-FOUND,
 21892               9991-CRTO-NOT-FOUND
 21893         DEPENDING ON DFHEIGDI.
 21894     MOVE '9%                    "   ' TO DFHEIV0
 21895     MOVE 'EL050' TO DFHEIV1
 21896     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21897     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       40016     Code:       88244
