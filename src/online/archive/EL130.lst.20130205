* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL130.cbl
* Options: int("EL130.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL130.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL130.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL130.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL130 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/18/95 07:28:16.
     7*                            VMOD=2.055.
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX19 - NEW CLAIM SETUP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL130.cbl
    14*
    15******************************************************************
    16*                   C H A N G E   L O G
    17*
    18* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    19*-----------------------------------------------------------------
    20*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    21* EFFECTIVE    NUMBER
    22*-----------------------------------------------------------------
    23* 041002    2002040200004  SMVA  MAKE SURE CLAIM TYPE IS ALWAYS
    24*                               POPULATED -MOVE PI-LAST-CLAIM-TYPE
    25* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    26* 031405                   PEMA  ADD PROCESSING FOR NEW CLAM TYP G
    27* 050807    2007020800002  AJRA  AUTO POPULATE I1 ADDRESS FROM CER
    28* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    29* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    30* 041309    2009031600001  AJRA  ADD VIN TO DIAG FOR BENE 55 AND 5
    31* 100809    2009081800004  AJRA  ADD MSG FOR BENE CD 2O - 2V
    32* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    33* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    34******************************************************************
    35
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL130.cbl
    37 ENVIRONMENT DIVISION.
    38 DATA DIVISION.
    39 WORKING-STORAGE SECTION.
    40 01  DFH-START PIC X(04).
    41 77  FILLER  PIC X(32)  VALUE '********************************'.
    42 77  FILLER  PIC X(32)  VALUE '*    EL130 WORKING STORAGE     *'.
    43 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.055 **********'.
    44
    45*    COPY ELCSCTM.
    46******************************************************************
    47*                                                                *
    48*                                                                *
    49*                            ELCSCTM                             *
    50*                            VMOD=2.001                          *
    51*                                                                *
    52*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    53*                                                                *
    54******************************************************************
    55 01  SECURITY-MESSAGE.
    56     12  FILLER                          PIC X(30)
    57            VALUE '** LOGIC SECURITY VIOLATION -'.
    58     12  SM-READ                         PIC X(6).
    59     12  FILLER                          PIC X(5)
    60            VALUE ' PGM='.
    61     12  SM-PGM                          PIC X(6).
    62     12  FILLER                          PIC X(5)
    63            VALUE ' OPR='.
    64     12  SM-PROCESSOR-ID                 PIC X(4).
    65     12  FILLER                          PIC X(6)
    66            VALUE ' TERM='.
    67     12  SM-TERMID                       PIC X(4).
    68     12  FILLER                          PIC XX   VALUE SPACE.
    69     12  SM-JUL-DATE                     PIC 9(5).
    70     12  FILLER                          PIC X    VALUE SPACE.
    71     12  SM-TIME                         PIC 99.99.
    72
    73
    74*    COPY ELCSCRTY.
    75******************************************************************
    76*                                                                *
    77*                                                                *
    78*                            ELCSCRTY                            *
    79*                            VMOD=2.001                          *
    80*                                                                *
    81*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    82*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    83*        SAVED IN PI-SECURITY-ADDRESS.                           *
    84*                                                                *
    85******************************************************************
    86 01  SECURITY-CONTROL.
    87     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    88     12  FILLER                       PIC XX    VALUE 'SC'.
    89     12  SC-CREDIT-CODES.
    90         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    91             20  SC-CREDIT-DISPLAY    PIC X.
    92             20  SC-CREDIT-UPDATE     PIC X.
    93     12  SC-CLAIMS-CODES.
    94         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL130.cbl
    95             20  SC-CLAIMS-DISPLAY    PIC X.
    96             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL130.cbl
    98 01  WS-DATE-AREA.
    99     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
   100     05  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   101     05  SAVE-SEND-DT        PIC XX      VALUE LOW-VALUES.
   102
   103 01  WS-CRI-SSN-WORK-AREA.
   104     05  WS-CRI-SOC-SEC-NO.
   105         10  WS-SS-REPT-CD       PIC X(5).
   106         10  WS-SS-LAST-NAME     PIC X(5).
   107         10  WS-SS-INITIAL       PIC X.
   108
   109     05  WS-CRI-REPORT-CODE.
   110         10  FILLER              PIC X(5).
   111         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   112
   113     05  WS-CRI-LAST-NAME.
   114         10  WS-CRI-NAME-MOVE    PIC X(5).
   115         10  FILLER              PIC X(10).
   116
   117 01  STANDARD-AREAS.
   118     12  SC-ITEM             PIC S9(4)   VALUE +0001      COMP.
   119     12  GETMAIN-SPACE       PIC X       VALUE SPACES.
   120     12  MAP-NAME            PIC X(8)    VALUE 'EL130A'.
   121     12  MAPSET-NAME         PIC X(8)    VALUE 'EL130S'.
   122     12  TRANS-ID            PIC X(4)    VALUE 'EX19'.
   123     12  START-TRANS-ID      PIC X(4)    VALUE 'EX58'.
   124     12  THIS-PGM            PIC X(8)    VALUE 'EL130'.
   125     12  PGM-NAME            PIC X(8).
   126     12  TIME-IN             PIC S9(7).
   127     12  TIME-OUT-R  REDEFINES TIME-IN.
   128         16  FILLER          PIC X.
   129         16  TIME-OUT        PIC 99V99.
   130         16  FILLER          PIC X(2).
   131     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   132     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   133     12  XCTL-114            PIC X(8)    VALUE 'EL114'.
   134     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   135     12  XCTL-127            PIC X(8)    VALUE 'EL127'.
   136     12  XCTL-727            PIC X(8)    VALUE 'EL727'.
   137     12  XCTL-131            PIC X(8)    VALUE 'EL131'.
   138     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   139     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   140     12  XCTL-150            PIC X(8)    VALUE 'EL150'.
   141     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   142     12  XCTL-650            PIC X(8)    VALUE 'EL650'.
   143     12  XCTL-659            PIC X(8)    VALUE 'EL659'.
   144     12  XCTL-6592           PIC X(8)    VALUE 'EL6592'.
   145     12  XCTL-725            PIC X(8)    VALUE 'EL725'.
   146     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   147     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   148     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   149     12  LINK-ELRTRM         PIC X(8)    VALUE 'ELRTRM'.
   150     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   151     12  ELCNTL-DSID         PIC X(8)    VALUE 'ELCNTL'.
   152     12  ELMSTR-DSID         PIC X(8)    VALUE 'ELMSTR'.
   153     12  ELMSTR5-DSID        PIC X(8)    VALUE 'ELMSTR5'.
   154     12  ELTRLR-DSID         PIC X(8)    VALUE 'ELTRLR'.
   155     12  ERACCT2-DSID        PIC X(8)    VALUE 'ERACCT2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL130.cbl
   156     12  ELCERT-DSID         PIC X(8)    VALUE 'ELCERT'.
   157     12  ELCERT5-DSID        PIC X(8)    VALUE 'ELCERT5'.
   158     12  ELACTQ-DSID         PIC X(8)    VALUE 'ELACTQ'.
   159     12  ELARCH-DSID         PIC X(8)    VALUE 'ELARCH'.
   160     12  ELBENE-DSID         PIC X(8)    VALUE 'ELBENE'.
   161     12  ERREIN-DSID         PIC X(8)    VALUE 'ERREIN'.
   162     12  DLYACTV-DSID        PIC X(8)    VALUE 'DLYACTV'.
   163     12  ERMAIL-DSID         PIC X(8)    VALUE 'ERMAIL'.
   164     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   165     12  FILE-ID             PIC X(8).
   166     12  DLYACTV-LENGTH      PIC S9(04)    COMP     VALUE +25.
   167     12  ELACTQ-LENGTH       PIC S9(04)    COMP     VALUE +60.
   168     12  ELARCH-LENGTH       PIC S9(04)    COMP     VALUE +90.
   169     12  ELCERT-LENGTH       PIC S9(04)    COMP     VALUE +450.
   170     12  ELMSTR-LENGTH       PIC S9(04)    COMP     VALUE +350.
   171     12  ELTRLR-LENGTH       PIC S9(04)    COMP     VALUE +200.
   172     12  ELMSTR-GENERIC-LENGTH PIC S9(4)   VALUE +9      COMP.
   173     12  ERMAIL-LENGTH       PIC S9(04)    COMP     VALUE +374.
   174     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +550.
   175
   176 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   177     12  M                   PIC S9(7)V99           VALUE ZEROS.
   178     12  L                   PIC S9(7)V99           VALUE ZEROS.
   179     12  N                   PIC S9(3)              VALUE ZEROS.
   180     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   181     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   182     12  I                   PIC S99V9(5)           VALUE ZEROS.
   183     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   184     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   185     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   186     12  R                   PIC S9(3)              VALUE ZEROS.
   187     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   188     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   189     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   190     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   191     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
   192     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
   193     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   194     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   195     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   196
   197 01  TERM-CALC-WORK-AREA.
   198     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   199     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   200     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   201     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   202     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   203     12  V-EXPONENTS.
   204        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   205     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   206
   207 01  MISC-WORK-AREAS.
   208     12  SAVE-BENEFICIARY    PIC X(10)   VALUE LOW-VALUES.
   209     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   210     12  CLAIM-SWITCH        PIC X       VALUE 'N'.
   211     12  QID.
   212         16  QID-TERM        PIC X(4).
   213         16  FILLER          PIC X(4)    VALUE '130A'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL130.cbl
   214     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   215     12  SAVE-AT-PRIMARY-KEY PIC X(22)   VALUE SPACES.
   216     12  WS-GROUP-NO.
   217         16  WS-GROUP-NO-1   PIC X(01)   VALUE SPACES.
   218         16  WS-GROUP-NO-2-6 PIC X(05)   VALUE SPACES.
   219
   220     12  WS-RESPONSE         PIC S9(8)   COMP.
   221         88  WS-RESP-NORMAL              VALUE +00.
   222         88  WS-RESP-ERROR               VALUE +01.
   223         88  WS-RESP-NOTFND              VALUE +13.
   224
   225***************************************************************
   226*                                                             *
   227*    QID-MAP-LENGTH MUST BE ADJUSTED EVERY TIME THAT ANY      *
   228*    FIELDS ARE ADDED, DELETED, OR THE SIZE OF ANY FIELD      *
   229*    CHANGES WITH IN MAP EL130A.                              *
   230*                                                             *
   231***************************************************************
   232
   233     12  QID-MAP-LENGTH            PIC S9(4) VALUE +1084 COMP.
   234     12  WS-SAVE-CLAIM-MASTER.
   235         16  FILLER                    PIC XX.
   236         16  WS-SAVE-CLAIM-KEY.
   237             20  WS-SAVE-COMPANY-CD    PIC X.
   238             20  WS-SAVE-CARRIER       PIC X.
   239             20  WS-SAVE-CLAIM-NO      PIC X(7).
   240             20  WS-SAVE-CERT-NO       PIC X(11).
   241         16  FILLER                    PIC X(328).
   242     12  SAVE-CURRENT-DATE         PIC XX.
   243     12  SAVE-CONTROL              PIC X(39).
   244     12  SAVE-ERACCT-KEY           PIC X(26).
   245     12  SAVE-COUNTER              PIC S9(8)   COMP.
   246     12  SAVE-METHOD               PIC X.
   247     12  SAVE-COMPANY-ID           PIC XXX.
   248     12  SAVE-COMPANY-CD           PIC X.
   249     12  SAVE-JOURNAL-FILE-ID      PIC S9(4)   COMP.
   250     12  SAVE-CREDIT-USER          PIC X.
   251     12  SAVE-CLAIM-USER           PIC X.
   252     12  SAVE-LIFE-OVERRIDE-L1     PIC X.
   253     12  SAVE-LIFE-OVERRIDE-L2     PIC XX.
   254     12  SAVE-LIFE-OVERRIDE-L6     PIC X(6).
   255     12  SAVE-LIFE-OVERRIDE-L12    PIC X(12).
   256     12  SAVE-AH-OVERRIDE-L1       PIC X.
   257     12  SAVE-AH-OVERRIDE-L2       PIC XX.
   258     12  SAVE-AH-OVERRIDE-L6       PIC X(6).
   259     12  SAVE-AH-OVERRIDE-L12      PIC X(12).
   260     12  FILLER                    PIC X.
   261*    12  SAVE-CLAIM-ACCESS-CONTROL PIC X.
   262     12  SAVE-CERT-ACCESS-CONTROL  PIC X.
   263     12  SAVE-CARRIER-CONTROL-LEVEL    PIC X.
   264     12  SAVE-EL127-TO-EL130-CNTRL.
   265         16  SAVE-CERT-SELECT-CNT    PIC S9(04) COMP.
   266         16  SAVE-CERT-PROCESSED     PIC S9(04) COMP.
   267         16  SAVE-CERT-CONTROLS-EL127 OCCURS 5 TIMES.
   268             20  SAVE-EL127-CARRIER  PIC X.
   269             20  SAVE-EL127-GROUPING PIC X(6).
   270             20  SAVE-EL127-STATE    PIC X(2).
   271             20  SAVE-EL127-ACCOUNT  PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL130.cbl
   272             20  SAVE-EL127-CERT-NO  PIC X(11).
   273             20  SAVE-EL127-EFF-DT   PIC XX.
   274     12  SAVE-EL659-TO-EL130-CNTRL.
   275         16  SAVE-EL659-CARRIER    PIC X.
   276         16  SAVE-EL659-GROUPING   PIC X(6).
   277         16  SAVE-EL659-STATE      PIC XX.
   278         16  SAVE-EL659-ACCOUNT    PIC X(10).
   279     12  DIVIDE-QUOT               PIC 999.
   280     12  DIVIDE-REM                PIC 999.
   281     12  WS-CURRENT-MANUAL-RESERVE PIC S9(5)V99 COMP-3.
   282     12  WS-ITD-ADDITIONAL-RESERVE PIC S9(5)V99 COMP-3.
   283     12  WS-ITD-PAID-EXPENSE       PIC S9(3)V99 COMP-3.
   284     12  WS-ITD-CHARGABLE-EXPENSE  PIC S9(5)V99 COMP-3.
   285     12  WS-INITIAL-MANUAL-RESERVE PIC S9(5)V99 COMP-3.
   286     12  WS-RESERVE-CONTROLS       PIC X(9).
   287     12  WS-EXPENSE-CONTROLS       PIC X(7).
   288     12  WS-REIN-TABLE.
   289         16  WS-REIN-1             PIC X            VALUE SPACE.
   290         16  WS-REIN-2             PIC X            VALUE SPACE.
   291         16  WS-REIN-3             PIC X            VALUE SPACE.
   292     12  WS-BENE-CALC-METHOD       PIC X.
   293     12  WS-EARNINGS-CALC          PIC X.
   294     12  WS-LF-EARNINGS-CALC       PIC X.
   295         88 TEX-REG                VALUE '4'.
   296         88 NET-PAY                VALUE '5'.
   297     12  WS-AH-EARNINGS-CALC       PIC X.
   298     12  WS-SPECIAL-CALC-CD        PIC X(01).
   299     12  WS-LF-SPECIAL-CALC-CD     PIC X(01).
   300     12  WS-AH-SPECIAL-CALC-CD     PIC X(01).
   301     12  WS-DIAGNOSIS-DESCRIPT     PIC X(60).
   302     12  WS-CLAIM-NUMBER.
   303         16  WS-CN-PREFIX.
   304             20  WS-CN-PRF-A PIC X.
   305             20  WS-CN-PRF-B PIC X.
   306         16  WS-CN-NUMBER    PIC 9(5).
   307     12  WS-CLAIM-NUMBER-R1 REDEFINES WS-CLAIM-NUMBER PIC 9(7).
   308     12  WS-CLAIM-SEQU.
   309         16  FILLER          PIC X    VALUE '('.
   310         16  WS-CURRENT-SEQU PIC Z9.
   311         16  FILLER          PIC X(4) VALUE ' OF '.
   312         16  WS-OF-SEQU      PIC Z9.
   313         16  FILLER          PIC X    VALUE ')'.
   314     12  DATE-WORK.
   315       14  FILLER                PIC XX.
   316       14  DATE-MM               PIC XX.
   317       14  DATE-DD               PIC XX.
   318       14  DATE-YY               PIC XX.
   319     12  CURR-DATE REDEFINES DATE-WORK.
   320         16  CURR-MM.
   321           18  CURR-M1           PIC 9.
   322           18  CURR-M2           PIC 9.
   323         16  FILLER              PIC X(5).
   324         16  CURR-YEAR           PIC 9.
   325     12  NUM-WORK   REDEFINES DATE-WORK   PIC 9(8).
   326     12  SUB                     PIC 99.
   327     12  MY-DATE.
   328         16  MY-MM               PIC XX.
   329         16  FILLER              PIC X VALUE '/'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL130.cbl
   330         16  MY-YY               PIC XX.
   331
   332     12  WS-EDIT-BEN-CODE        PIC XX.
   333         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   334                                          '90' THRU '99'.
   335
   336     12  WS-NUM-HOLD             PIC S9(4)     VALUE +0  COMP-3.
   337     12  WS-BEN-HOLD             PIC XX.
   338     12  WS-BEN-ALPHA-HOLD.
   339         15  WS-BEN-ALPHA-2      PIC XX.
   340         15  WS-BEN-ALPHA-1      PIC X.
   341     12  WS-FORM-HOLD            PIC X(12)  VALUE SPACES.
   342     12  WS-REC-TYPE             PIC X.
   343     12  HOLD-LOAN-BAL           PIC 9(7)V99   VALUE ZEROS.
   344     12  DEEDIT-FIELD            PIC 9(10)V99  VALUE ZEROS.
   345     12  ARCH-NUMBER             PIC S9(8)   COMP.
   346     12  WS-REIN-REC-FOUND-SW    PIC X(01)   VALUE ' '.
   347         88  REIN-REC-NOT-FOUND              VALUE 'N'.
   348         88  REIN-REC-FOUND                  VALUE 'Y'.
   349
   350     12  WS-REC-FOUND-SW         PIC X(01)   VALUE ' '.
   351     12  WS-LETTER-SW            PIC X(01)   VALUE 'N'.
   352
   353
   354 01  CSO-WORK-FIELDS.
   355     12  WS-BLANK            PIC X       VALUE ' '.
   356
   357     12  WS-MA-CONTROL-PRIMARY.
   358         16  WS-MA-COMPANY-CD        PIC  X.
   359         16  WS-MA-CARRIER           PIC  X.
   360         16  WS-MA-GROUPING          PIC  X(6).
   361         16  WS-MA-STATE             PIC  XX.
   362         16  WS-MA-ACCOUNT           PIC  X(10).
   363         16  WS-MA-CERT-EFF-DT       PIC  XX.
   364         16  WS-MA-CERT-NO.
   365             20  WS-MA-CERT-PRIME    PIC  X(10).
   366             20  WS-MA-CERT-SFX      PIC  X.
   367
   368     12  WS-INSURED-ADDR-CNT         PIC  S9(1) VALUE +0.
   369     12  WS-NO-INSURED-ADDRESS       PIC  X(01) VALUE 'N'.
   370     12  WS-SOC-SEC-NUMBER.
   371         16  WS-SOC-SEC-NO       PIC 9(9).
   372         16  WS-SOC-SEC-BLANK    PIC X(2).
   373     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   374         16  WS-SSN-1-3          PIC 9(3).
   375         16  WS-SSN-DASH1        PIC X(1).
   376         16  WS-SSN-4-5          PIC 9(2).
   377         16  WS-SSN-DASH2        PIC X(1).
   378         16  WS-SSN-6-9          PIC 9(4).
   379
   380     12  WS-DIAG-VIN-MSG.
   381         16  FILLER          PIC X(11)
   382             VALUE 'VIN NUMBER '.
   383         16  WS-DIAG-VIN     PIC X(17).
   384
   385     12  WS-VERIFY-NOTE      PIC X(34)
   386         VALUE '2ND BENE SSN VERIFICATION REQUIRED'.
   387
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL130.cbl
   388 01  MAP-DATE-AREAS.
   389     12  WS-EFFDT            PIC XX      VALUE LOW-VALUES.
   390     12  WS-EXPIRE           PIC XX      VALUE LOW-VALUES.
   391     12  WS-ADD-ON-DT        PIC XX      VALUE LOW-VALUES.
   392     12  WS-BIRTHDT          PIC XX      VALUE LOW-VALUES.
   393     12  WS-INCUR            PIC XX      VALUE LOW-VALUES.
   394     12  WS-REPORT           PIC XX      VALUE LOW-VALUES.
   395     12  WS-ESTEND           PIC XX      VALUE LOW-VALUES.
   396     12  WS-ACVCNDT          PIC XX      VALUE LOW-VALUES.
   397     12  WS-LCVCNDT          PIC XX      VALUE LOW-VALUES.
   398     12  WS-TODAY-DT         PIC XX      VALUE LOW-VALUES.
   399     12  WS-ENTRYDT          PIC XX      VALUE LOW-VALUES.
   400     12  WS-MANRSV           PIC S9(6)V99  VALUE ZEROS COMP-3.
   401     12  WS-ACVRATE          PIC S9(4)V99  VALUE ZEROS COMP-3.
   402     12  WS-ACVBENE          PIC S9(9)V99  VALUE ZEROS COMP-3.
   403     12  WS-LCVRATE          PIC S9(4)V99  VALUE ZEROS COMP-3.
   404     12  WS-LCVBENE          PIC S9(9)V99  VALUE ZEROS COMP-3.
   405     12  WS-APR              PIC S999V9999 VALUE ZEROS COMP-3.
   406     12  WS-PMTFREQ          PIC 99        VALUE ZEROS COMP-3.
   407     12  WS-ASSOC-CERT-TOTAL PIC S99       VALUE ZEROS.
   408         88  NO-ASSOCIATED-CERTS           VALUE ZEROS.
   409     12  WS-ASSOC-CERT-SEQU  PIC S99       VALUE ZEROS.
   410     12  WS-READNEXT-SWITCH  PIC S99       VALUE +1.
   411     12  WS-ASSOCIATED-CERTS PIC S9        VALUE ZEROS COMP-3.
   412     12  ONE-OR-MIN1         PIC S9        VALUE +1    COMP-3.
   413
   414 01  ACCESS-KEYS.
   415     12  ELACTQ-KEY.
   416         16  ELACTQ-COMPANY-CD       PIC X.
   417         16  ELACTQ-CARRIER          PIC X.
   418         16  ELACTQ-CLAIM-NO         PIC X(7).
   419         16  ELACTQ-CERT-NO          PIC X(11).
   420     12  ELMSTR-KEY.
   421         16  MSTR-COMP-CD            PIC X.
   422         16  MSTR-CARRIER            PIC X.
   423         16  MSTR-CLAIM-NO           PIC X(7).
   424         16  MSTR-CERT-NO.
   425             20  MSTR-CERT-NO-PRIME  PIC X(10).
   426             20  MSTR-CERT-NO-SUFX   PIC X.
   427     12  SAVE-ELMSTR-KEY.
   428         16  SAVE-COMP-CD            PIC X.
   429         16  SAVE-CARRIER            PIC X.
   430         16  SAVE-CLAIM-NO           PIC X(7).
   431         16  SAVE-CERT-NO.
   432             20  SAVE-CERT-NO-PRIME  PIC X(10).
   433             20  SAVE-CERT-NO-SUFX   PIC X.
   434     12  ELMSTR5-KEY.
   435         16  MSTR5-COMP-CD           PIC X.
   436         16  MSTR5-CERT-NO.
   437             20  MSTR5-CERT-NO-PRIME PIC X(10).
   438             20  MSTR5-CERT-NO-SUFX  PIC X.
   439     12  INCUR-DTE-DUPE-SW           PIC X VALUE 'N'.
   440         88  NO-CLAIMS-FOR-CERT            VALUE 'N'.
   441         88  INCURRED-DATE-MATCH           VALUE 'Y'.
   442         88  CLAIM-RECORD-FOUND            VALUE 'H'.
   443     12  ELCNTL-KEY.
   444         16  CNTL-COMP-ID    PIC X(3).
   445         16  CNTL-REC-TYPE   PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL130.cbl
   446         16  CNTL-ACCESS.
   447             20  FILLER      PIC XX.
   448             20  CNTL-BENEFIT.
   449                 24  FILLER  PIC X.
   450                 24  CNTL-CARRIER PIC X.
   451         16  CNTL-SEQ-NO     PIC S9(4)    COMP.
   452     12  ELCERT-KEY.
   453         16  CERT-COMP-CD    PIC X.
   454         16  CERT-CARRIER    PIC X.
   455         16  CERT-GROUPING   PIC X(6).
   456         16  CERT-STATE      PIC X(2).
   457         16  CERT-ACCOUNT.
   458             20  CERT-ACCOUNT-PREFIX PIC X(4).
   459             20  CERT-ACCOUNT-PRIME  PIC X(6).
   460         16  CERT-EFF-DT     PIC XX.
   461         16  CERT-CERT-NO.
   462             20  CERT-CERT-NO-PRIME  PIC X(10).
   463             20  CERT-CERT-NO-SUFX   PIC X.
   464     12  ELCERT-KEY-5.
   465         16  CERT-COMP-CD-5      PIC X.
   466         16  CERT-CERT-5.
   467             20  CERT-CERT-5-PRIME   PIC X(10).
   468             20  CERT-CERT-5-SUFX    PIC X.
   469     12  ERACCT-KEY.
   470         16  ACCT-COMP-CD    PIC X.
   471         16  ACCT-CARRIER    PIC X.
   472         16  ACCT-GROUPING   PIC X(6).
   473         16  ACCT-STATE      PIC X(2).
   474         16  ACCT-ACCOUNT    PIC X(10).
   475         16  ACCT-EXP-DT     PIC XX.
   476     12  ELTRLR-KEY.
   477         16  TRLR-COMP-CD    PIC X.
   478         16  TRLR-CARRIER    PIC X.
   479         16  TRLR-CLAIM-NO   PIC X(7).
   480         16  TRLR-CERT-NO.
   481             20  TRLR-CERT-NO-PRIME  PIC X(10).
   482             20  TRLR-CERT-NO-SUFX   PIC X.
   483         16  TRLR-SEQ-NO     PIC S9(4)   COMP.
   484         16  TRLR-TYPE       PIC X.
   485     12  ELBENE-KEY.
   486         16  BENE-COMP-CD    PIC X.
   487         16  BENE-RCD-TYPE   PIC X.
   488         16  BENE-CODE       PIC X(10).
   489     12  ERREIN-KEY.
   490         16  REIN-COMP-CD        PIC X(01).
   491         16  REIN-TYPE           PIC X(01).
   492         16  REIN-TABLE-CO.
   493             20  REIN-CODE-1     PIC X(01).
   494             20  REIN-CODE-2     PIC X(01).
   495             20  REIN-CODE-3     PIC X(01).
   496         16  FILLER              PIC X(03).
   497     12  ELCRTT-KEY.
   498         16  CTRLR-COMP-CD       PIC X.
   499         16  CTRLR-CARRIER       PIC X.
   500         16  CTRLR-GROUPING      PIC X(6).
   501         16  CTRLR-STATE         PIC X(2).
   502         16  CTRLR-ACCOUNT       PIC X(10).
   503         16  CTRLR-EFF-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL130.cbl
   504         16  CTRLR-CERT-NO       PIC X(11).
   505         16  CTRLR-REC-TYPE      PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL130.cbl
   507 01  ERROR-MESSAGES.
   508     12  ER-0000                 PIC X(4)  VALUE '0000'.
   509     12  ER-0004                 PIC X(4)  VALUE '0004'.
   510     12  ER-0019                 PIC X(4)  VALUE '0019'.
   511     12  ER-0023                 PIC X(4)  VALUE '0023'.
   512     12  ER-0029                 PIC X(4)  VALUE '0029'.
   513     12  ER-0033                 PIC X(4)  VALUE '0033'.
   514     12  ER-0068                 PIC X(4)  VALUE '0068'.
   515     12  ER-0070                 PIC X(4)  VALUE '0070'.
   516     12  ER-0194                 PIC X(4)  VALUE '0194'.
   517     12  ER-0202                 PIC X(4)  VALUE '0202'.
   518     12  ER-0203                 PIC X(4)  VALUE '0203'.
   519     12  ER-0204                 PIC X(4)  VALUE '0204'.
   520     12  ER-0205                 PIC X(4)  VALUE '0205'.
   521     12  ER-0206                 PIC X(4)  VALUE '0206'.
   522     12  ER-0207                 PIC X(4)  VALUE '0207'.
   523     12  ER-0213                 PIC X(4)  VALUE '0213'.
   524     12  ER-0214                 PIC X(4)  VALUE '0214'.
   525     12  ER-0217                 PIC X(4)  VALUE '0217'.
   526     12  ER-0219                 PIC X(4)  VALUE '0219'.
   527     12  ER-0220                 PIC X(4)  VALUE '0220'.
   528     12  ER-0221                 PIC X(4)  VALUE '0221'.
   529     12  ER-0222                 PIC X(4)  VALUE '0222'.
   530     12  ER-0223                 PIC X(4)  VALUE '0223'.
   531     12  ER-0224                 PIC X(4)  VALUE '0224'.
   532     12  ER-0225                 PIC X(4)  VALUE '0225'.
   533     12  ER-0226                 PIC X(4)  VALUE '0226'.
   534     12  ER-0227                 PIC X(4)  VALUE '0227'.
   535     12  ER-0229                 PIC X(4)  VALUE '0229'.
   536     12  ER-0230                 PIC X(4)  VALUE '0230'.
   537     12  ER-0231                 PIC X(4)  VALUE '0231'.
   538     12  ER-0232                 PIC X(4)  VALUE '0232'.
   539     12  ER-0233                 PIC X(4)  VALUE '0233'.
   540     12  ER-0234                 PIC X(4)  VALUE '0234'.
   541     12  ER-0235                 PIC X(4)  VALUE '0235'.
   542     12  ER-0236                 PIC X(4)  VALUE '0236'.
   543     12  ER-0237                 PIC X(4)  VALUE '0237'.
   544     12  ER-0238                 PIC X(4)  VALUE '0238'.
   545     12  ER-0239                 PIC X(4)  VALUE '0239'.
   546     12  ER-0240                 PIC X(4)  VALUE '0240'.
   547     12  ER-0241                 PIC X(4)  VALUE '0241'.
   548     12  ER-0243                 PIC X(4)  VALUE '0243'.
   549     12  ER-0244                 PIC X(4)  VALUE '0244'.
   550     12  ER-0245                 PIC X(4)  VALUE '0245'.
   551     12  ER-0246                 PIC X(4)  VALUE '0246'.
   552     12  ER-0247                 PIC X(4)  VALUE '0247'.
   553     12  ER-0248                 PIC X(4)  VALUE '0248'.
   554     12  ER-0250                 PIC X(4)  VALUE '0250'.
   555     12  ER-0251                 PIC X(4)  VALUE '0251'.
   556     12  ER-0252                 PIC X(4)  VALUE '0252'.
   557     12  ER-0253                 PIC X(4)  VALUE '0253'.
   558     12  ER-0254                 PIC X(4)  VALUE '0254'.
   559     12  ER-0257                 PIC X(4)  VALUE '0257'.
   560     12  ER-0258                 PIC X(4)  VALUE '0258'.
   561     12  ER-0260                 PIC X(4)  VALUE '0260'.
   562     12  ER-0261                 PIC X(4)  VALUE '0261'.
   563     12  ER-0263                 PIC X(4)  VALUE '0263'.
   564     12  ER-0264                 PIC X(4)  VALUE '0264'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL130.cbl
   565     12  ER-0265                 PIC X(4)  VALUE '0265'.
   566     12  ER-0266                 PIC X(4)  VALUE '0266'.
   567     12  ER-0267                 PIC X(4)  VALUE '0267'.
   568     12  ER-0334                 PIC X(4)  VALUE '0334'.
   569     12  ER-0337                 PIC X(4)  VALUE '0337'.
   570     12  ER-0412                 PIC X(4)  VALUE '0412'.
   571     12  ER-0413                 PIC X(4)  VALUE '0413'.
   572     12  ER-0428                 PIC X(4)  VALUE '0428'.
   573     12  ER-0429                 PIC X(4)  VALUE '0429'.
   574     12  ER-0430                 PIC X(4)  VALUE '0430'.
   575     12  ER-0433                 PIC X(4)  VALUE '0433'.
   576     12  ER-0434                 PIC X(4)  VALUE '0434'.
   577     12  ER-0458                 PIC X(4)  VALUE '0458'.
   578     12  ER-0489                 PIC X(4)  VALUE '0489'.
   579     12  ER-0509                 PIC X(4)  VALUE '0509'.
   580     12  ER-0510                 PIC X(4)  VALUE '0510'.
   581     12  ER-0511                 PIC X(4)  VALUE '0511'.
   582     12  ER-0512                 PIC X(4)  VALUE '0512'.
   583     12  ER-0516                 PIC X(4)  VALUE '0516'.
   584     12  ER-0517                 PIC X(4)  VALUE '0517'.
   585     12  ER-0518                 PIC X(4)  VALUE '0518'.
   586     12  ER-0519                 PIC X(4)  VALUE '0519'.
   587     12  ER-0520                 PIC X(4)  VALUE '0520'.
   588     12  ER-0521                 PIC X(4)  VALUE '0521'.
   589     12  ER-0522                 PIC X(4)  VALUE '0522'.
   590     12  ER-0523                 PIC X(4)  VALUE '0523'.
   591     12  ER-0544                 PIC X(4)  VALUE '0544'.
   592     12  ER-0546                 PIC X(4)  VALUE '0546'.
   593     12  ER-0558                 PIC X(4)  VALUE '0558'.
   594     12  ER-0560                 PIC X(4)  VALUE '0560'.
   595     12  ER-0562                 PIC X(4)  VALUE '0562'.
   596     12  ER-0565                 PIC X(4)  VALUE '0565'.
   597     12  ER-0569                 PIC X(4)  VALUE '0569'.
   598     12  ER-0693                 PIC X(4)  VALUE '0693'.
   599     12  ER-0715                 PIC X(4)  VALUE '0715'.
   600     12  ER-0840                 PIC X(4)  VALUE '0840'.
   601     12  ER-0841                 PIC X(4)  VALUE '0841'.
   602     12  ER-0842                 PIC X(4)  VALUE '0842'.
   603     12  ER-0843                 PIC X(4)  VALUE '0843'.
   604     12  ER-0878                 PIC X(4)  VALUE '0878'.
   605     12  ER-0887                 PIC X(4)  VALUE '0887'.
   606     12  ER-2280                 PIC X(4)  VALUE '2280'.
   607     12  ER-2370                 PIC X(4)  VALUE '2370'.
   608     12  ER-2371                 PIC X(4)  VALUE '2371'.
   609     12  ER-2378                 PIC X(4)  VALUE '2378'.
   610     12  ER-2380                 PIC X(4)  VALUE '2380'.
   611     12  ER-2566                 PIC X(4)  VALUE '2566'.
   612     12  ER-2848                 PIC X(4)  VALUE '2848'.
   613     12  ER-3548                 PIC X(4)  VALUE '3548'.
   614     12  ER-7008                 PIC X(4)  VALUE '7008'.
   615     12  ER-7319                 PIC X(4)  VALUE '7319'.
   616     12  ER-7321                 PIC X(4)  VALUE '7321'.
   617     12  ER-7352                 PIC X(4)  VALUE '7352'.
   618     12  ER-7353                 PIC X(4)  VALUE '7353'.
   619     12  ER-7575                 PIC X(4)  VALUE '7575'.
   620     12  ER-7634                 PIC X(4)  VALUE '7634'.
   621     12  ER-7635                 PIC X(4)  VALUE '7635'.
   622     12  ER-7636                 PIC X(4)  VALUE '7636'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL130.cbl
   623     12  ER-7637                 PIC X(4)  VALUE '7637'.
   624     12  ER-7638                 PIC X(4)  VALUE '7638'.
   625     12  ER-7639                 PIC X(4)  VALUE '7639'.
   626     12  ER-7640                 PIC X(4)  VALUE '7640'.
   627     12  ER-7641                 PIC X(4)  VALUE '7641'.
   628     12  ER-7642                 PIC X(4)  VALUE '7642'.
   629     12  ER-7643                 PIC X(4)  VALUE '7643'.
   630     12  ER-7646                 PIC X(4)  VALUE '7646'.
   631     12  ER-7647                 PIC X(4)  VALUE '7647'.
   632     12  ER-7648                 PIC X(4)  VALUE '7648'.
   633     12  ER-7649                 PIC X(4)  VALUE '7649'.
   634     12  ER-7651                 PIC X(4)  VALUE '7651'.
   635     12  ER-7670                 PIC X(4)  VALUE '7670'.
   636     12  ER-7671                 PIC X(4)  VALUE '7671'.
   637     12  ER-7686                 PIC X(4)  VALUE '7686'.
   638     12  ER-7688                 PIC X(4)  VALUE '7688'.
   639     12  ER-7689                 PIC X(4)  VALUE '7689'.
   640     12  ER-7691                 PIC X(4)  VALUE '7691'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL130.cbl
   642*    COPY ELCLNKLT.
   643******************************************************************
   644*                                                                *
   645*                                                                *
   646*                           ELCLNKLT                             *
   647*                            VMOD=2.003                          *
   648*                                                                *
   649*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   650*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   651*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   652*                                                                *
   653*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   654*   COMPLETING THE REQUIRED FIELDS.                              *
   655*                                                                *
   656*   THE CALLING PROGRAM SHOULD CHECK:                            *
   657*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   658*                              9999 INDICATES AN UNKNOWN ABEND   *
   659*                                   WAS DETECTED.                *
   660*                              ALL OTHER VALUES ARE NORMAL ERROR *
   661*                              CODES FOUND IN THE ERROR FILE.    *
   662******************************************************************
   663 01  W-1523-LINKDATA.
   664     12  W-1523-COMMON-PI-DATA.
   665         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   666         16  FILLER              PIC  X(67).
   667         16  W-1523-COMPANY-CD   PIC  X(01).
   668         16  FILLER              PIC  X(10).
   669         16  W-1523-CONTROL-IN-PROGRESS.
   670             20  W-1523-CARRIER  PIC  X(01).
   671             20  W-1523-GROUPING PIC  X(06).
   672             20  W-1523-STATE    PIC  X(02).
   673             20  W-1523-ACCOUNT  PIC  X(10).
   674             20  W-1523-CLAIM-CERT-GRP.
   675                 24  W-1523-CLAIM-NO
   676                                 PIC  X(07).
   677                 24  W-1523-CERT-NO.
   678                     28  W-1523-CERT-PRIME
   679                                 PIC  X(10).
   680                     28  W-1523-CERT-SFX
   681                                 PIC  X(01).
   682                 24  W-1523-CERT-EFF-DT
   683                                 PIC  X(02).
   684         16  FILLER              PIC X(265).
   685
   686     12  W-1523-WORK-AREA.
   687         16  W-1523-FORM-NUMBER  PIC  X(04).
   688         16  W-1523-NUMBER-COPIES
   689                                 PIC  9(01).
   690         16  W-1523-ADDR-TYPE    PIC  X(02).
   691         16  W-1523-FOLLOW-UP-DATE
   692                                 PIC  X(02).
   693         16  W-1523-RESEND-DATE  PIC  X(02).
   694         16  W-1523-ERROR-CODE   PIC  9(04).
   695             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   696             88  W-1523-FATAL-ERROR
   697                                    VALUES  0006 0013 0042
   698                                            0154 0168 0169
   699                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL130.cbl
   700                                            0179 0186 0281
   701                                            0332 2055 3697
   702                                            3698 3699 3770
   703                                            3771 3772 7675
   704                                            9106 9808 9883
   705                                            9887.
   706             88  W-1523-STOP-ERRORS
   707                                    VALUES  0013 0042 0154
   708                                            0168 0169 0172
   709                                            0281 0332 2055
   710                                            3698 3699 7675
   711                                            9106 9808 9883
   712                                            9999.
   713         16  W-1523-REASON       PIC  X(70).
   714         16  W-1523-ARCHIVE-NUMBER
   715                                 PIC  9(08).
   716     12  W-1523-POINTER-AREA.
   717         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   718         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   719         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   720         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   721         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL130.cbl
   723*    COPY ELCINTF.
   724******************************************************************
   725*                                                                *
   726*                                                                *
   727*                            ELCINTF.                            *
   728*                            VMOD=2.017                          *
   729*                                                                *
   730*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   731*                                                                *
   732*       LENGTH = 1024                                            *
   733*                                                                *
   734******************************************************************
   735 01  PROGRAM-INTERFACE-BLOCK.
   736     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   737     12  PI-CALLING-PROGRAM              PIC X(8).
   738     12  PI-SAVED-PROGRAM-1              PIC X(8).
   739     12  PI-SAVED-PROGRAM-2              PIC X(8).
   740     12  PI-SAVED-PROGRAM-3              PIC X(8).
   741     12  PI-SAVED-PROGRAM-4              PIC X(8).
   742     12  PI-SAVED-PROGRAM-5              PIC X(8).
   743     12  PI-SAVED-PROGRAM-6              PIC X(8).
   744     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   745     12  PI-COMPANY-ID                   PIC XXX.
   746     12  PI-COMPANY-CD                   PIC X.
   747
   748     12  PI-COMPANY-PASSWORD             PIC X(8).
   749
   750     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   751
   752     12  PI-CONTROL-IN-PROGRESS.
   753         16  PI-CARRIER                  PIC X.
   754         16  PI-GROUPING                 PIC X(6).
   755         16  PI-STATE                    PIC XX.
   756         16  PI-ACCOUNT                  PIC X(10).
   757         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   758                                         PIC X(10).
   759         16  PI-CLAIM-CERT-GRP.
   760             20  PI-CLAIM-NO             PIC X(7).
   761             20  PI-CERT-NO.
   762                 25  PI-CERT-PRIME       PIC X(10).
   763                 25  PI-CERT-SFX         PIC X.
   764             20  PI-CERT-EFF-DT          PIC XX.
   765         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   766             20  PI-PLAN-CODE            PIC X(2).
   767             20  PI-REVISION-NUMBER      PIC X(3).
   768             20  PI-PLAN-EFF-DT          PIC X(2).
   769             20  PI-PLAN-EXP-DT          PIC X(2).
   770             20  FILLER                  PIC X(11).
   771         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   772             20  PI-OE-REFERENCE-1.
   773                 25  PI-OE-REF-1-PRIME   PIC X(18).
   774                 25  PI-OE-REF-1-SUFF    PIC XX.
   775
   776     12  PI-SESSION-IN-PROGRESS          PIC X.
   777         88  CLAIM-SESSION                   VALUE '1'.
   778         88  CREDIT-SESSION                  VALUE '2'.
   779         88  WARRANTY-SESSION                VALUE '3'.
   780         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL130.cbl
   781         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   782
   783
   784*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   785
   786     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   787     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   788
   789     12  PI-CREDIT-USER                  PIC X.
   790         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   791         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   792
   793     12  PI-CLAIM-USER                   PIC X.
   794         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   795         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   796
   797     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   798         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   799         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   800         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   801         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   802         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   803
   804     12  PI-PROCESSOR-ID                 PIC X(4).
   805
   806     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   807
   808     12  PI-MEMBER-CAPTION               PIC X(10).
   809
   810     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   811         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   812
   813     12  PI-LIFE-OVERRIDE-L1             PIC X.
   814     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   815     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   816     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   817
   818     12  PI-AH-OVERRIDE-L1               PIC X.
   819     12  PI-AH-OVERRIDE-L2               PIC XX.
   820     12  PI-AH-OVERRIDE-L6               PIC X(6).
   821     12  PI-AH-OVERRIDE-L12              PIC X(12).
   822
   823     12  PI-NEW-SYSTEM                   PIC X(2).
   824
   825     12  PI-PRIMARY-CERT-NO              PIC X(11).
   826     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   827         88  PI-USES-PAID-TO                 VALUE '1'.
   828     12  PI-CRDTCRD-SYSTEM.
   829         16  PI-CRDTCRD-USER             PIC X.
   830             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   831             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   832         16  PI-CC-MONTH-END-DT          PIC XX.
   833     12  PI-PROCESSOR-PRINTER            PIC X(4).
   834
   835     12  PI-OE-REFERENCE-2.
   836         16  PI-OE-REF-2-PRIME           PIC X(10).
   837         16  PI-OE-REF-2-SUFF            PIC X.
   838
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL130.cbl
   839     12  PI-REM-TRM-CALC-OPTION          PIC X.
   840
   841     12  PI-LANGUAGE-TYPE                PIC X.
   842             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   843             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   844             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   845
   846     12  PI-POLICY-LINKAGE-IND           PIC X.
   847         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   848         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   849                                                   LOW-VALUES.
   850
   851     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   852     12  PI-CLAIM-PW-SESSION             PIC X(1).
   853         88  PI-CLAIM-CREDIT                 VALUE '1'.
   854         88  PI-CLAIM-CONVEN                 VALUE '2'.
   855     12  FILLER                          PIC X(4).
   856
   857     12  PI-SYSTEM-LEVEL                 PIC X(145).
   858
   859     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   860         PI-SYSTEM-LEVEL.
   861
   862         16  PI-ENTRY-CODES.
   863             20  PI-ENTRY-CD-1           PIC X.
   864             20  PI-ENTRY-CD-2           PIC X.
   865
   866         16  PI-RETURN-CODES.
   867             20  PI-RETURN-CD-1          PIC X.
   868             20  PI-RETURN-CD-2          PIC X.
   869
   870         16  PI-UPDATE-STATUS-SAVE.
   871             20  PI-UPDATE-BY            PIC X(4).
   872             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   873
   874         16  PI-LOWER-CASE-LETTERS       PIC X.
   875             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   876
   877*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   878*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   879*            88  CARRIER-CLM-CNTL            VALUE '2'.
   880
   881         16  PI-CERT-ACCESS-CONTROL      PIC X.
   882             88  ST-ACCNT-CNTL               VALUE ' '.
   883             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   884             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   885             88  ACCNT-CNTL                  VALUE '3'.
   886             88  CARR-ACCNT-CNTL             VALUE '4'.
   887
   888         16  PI-PROCESSOR-CAP-LIST.
   889             20  PI-SYSTEM-CONTROLS.
   890                24 PI-SYSTEM-DISPLAY     PIC X.
   891                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   892                24 PI-SYSTEM-MODIFY      PIC X.
   893                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   894             20  FILLER                  PIC XX.
   895             20  PI-DISPLAY-CAP          PIC X.
   896                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL130.cbl
   897             20  PI-MODIFY-CAP           PIC X.
   898                 88  MODIFY-CAP              VALUE 'Y'.
   899             20  PI-MSG-AT-LOGON-CAP     PIC X.
   900                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   901             20  PI-FORCE-CAP            PIC X.
   902                 88  FORCE-CAP               VALUE 'Y'.
   903
   904         16  PI-PROGRAM-CONTROLS.
   905             20  PI-PGM-PRINT-OPT        PIC X.
   906             20  PI-PGM-FORMAT-OPT       PIC X.
   907             20  PI-PGM-PROCESS-OPT      PIC X.
   908             20  PI-PGM-TOTALS-OPT       PIC X.
   909
   910         16  PI-HELP-INTERFACE.
   911             20  PI-LAST-ERROR-NO        PIC X(4).
   912             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   913
   914         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   915             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   916
   917         16  PI-CR-CONTROL-IN-PROGRESS.
   918             20  PI-CR-CARRIER           PIC X.
   919             20  PI-CR-GROUPING          PIC X(6).
   920             20  PI-CR-STATE             PIC XX.
   921             20  PI-CR-ACCOUNT           PIC X(10).
   922             20  PI-CR-FIN-RESP          PIC X(10).
   923             20  PI-CR-TYPE              PIC X.
   924
   925         16  PI-CR-BATCH-NUMBER          PIC X(6).
   926
   927         16  PI-CR-MONTH-END-DT          PIC XX.
   928
   929         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   930             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   931             88  PI-ZERO-CARRIER             VALUE '1'.
   932             88  PI-ZERO-GROUPING            VALUE '2'.
   933             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   934
   935         16  PI-CARRIER-SECURITY         PIC X.
   936             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   937
   938         16  PI-ACCOUNT-SECURITY         PIC X(10).
   939             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   940             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   941
   942         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   943             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   944                                         INDEXED BY PI-ACCESS-NDX
   945                                         PIC X.
   946
   947         16  PI-GA-BILLING-CONTROL       PIC X.
   948             88  PI-GA-BILLING               VALUE '1'.
   949
   950         16  PI-MAIL-PROCESSING          PIC X.
   951             88  PI-MAIL-YES                 VALUE 'Y'.
   952
   953         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   954
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL130.cbl
   955         16  PI-AR-SYSTEM.
   956             20  PI-AR-PROCESSING-CNTL   PIC X.
   957                 88  PI-AR-PROCESSING        VALUE 'Y'.
   958             20  PI-AR-SUMMARY-CODE      PIC X(6).
   959             20  PI-AR-MONTH-END-DT      PIC XX.
   960
   961         16  PI-MP-SYSTEM.
   962             20  PI-MORTGAGE-USER            PIC X.
   963                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   964                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   965             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   966                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   967                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   968                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   969                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   970                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   971             20  PI-MP-MONTH-END-DT          PIC XX.
   972             20  PI-MP-REFERENCE-NO.
   973                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   974                 24  PI-MP-REFERENCE-SFX     PIC XX.
   975
   976         16  PI-LABEL-CONTROL            PIC X(01).
   977             88  PI-CREATE-LABELS                    VALUE 'Y'.
   978             88  PI-BYPASS-LABELS                    VALUE 'N'.
   979
   980         16  PI-BILL-GROUPING-CODE       PIC X(01).
   981             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   982
   983         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   984             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   985             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   986
   987         16  FILLER                      PIC X(14).
   988
   989     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   990******************************************************************
   991     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
   992         16  PI-MSTR-DT               PIC XX.
   993         16  PI-MSTR-WHEN             PIC S9(6)   COMP-3.
   994         16  PI-TRLR-DT               PIC XX.
   995         16  PI-TRLR-WHEN             PIC S9(6)   COMP-3.
   996         16  PI-LAST-CLAIM            PIC X(7).
   997         16  PI-LAST-CARR             PIC X.
   998         16  PI-LAST-CERT.
   999             20  PI-LAST-CERT-PRIME   PIC X(10).
  1000             20  PI-LAST-CERT-SUFX    PIC X.
  1001         16  PI-LAST-CLAIM-TYPE       PIC X.
  1002         16  PI-CURSOR                PIC S9(4)   COMP.
  1003         16  PI-SAVE-CERT.
  1004             20  PI-SAVE-CERT-PRIME   PIC X(10).
  1005             20  PI-SAVE-CERT-SUFX    PIC X.
  1006         16  PI-SAVE-EFFDT            PIC X(2).
  1007         16  PI-SAVE-ACCOUNT          PIC X(10).
  1008         16  PI-INCURR-SW             PIC X.
  1009         16  PI-PRT-OPT               PIC X.
  1010         16  PI-ALT-PRT               PIC X(4).
  1011         16  PI-CLAIM-DELETED-SWITCH  PIC X.
  1012             88  CLAIM-DELETED-BY-EL131   VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL130.cbl
  1013         16  FILLER                   PIC X(272).
  1014         16  PI-EL127-TO-EL130-CNTRL.
  1015             20  PI-CERT-SELECT-CNT          PIC S9(04) COMP.
  1016             20  PI-CERT-PROCESSED           PIC S9(04) COMP.
  1017             20  PI-CERT-CONTROLS-EL127  OCCURS 5 TIMES.
  1018                 24  PI-EL127-CARRIER        PIC X.
  1019                 24  PI-EL127-GROUPING       PIC X(6).
  1020                 24  PI-EL127-STATE          PIC X(2).
  1021                 24  PI-EL127-ACCOUNT        PIC X(10).
  1022                 24  PI-EL127-CERT-NO.
  1023                     28  PI-EL127-CERT-PRIME PIC X(10).
  1024                     28  PI-EL127-CERT-SUFX  PIC X.
  1025                 24  PI-EL127-EFF-DT         PIC XX.
  1026*        16  FILLER                          PIC X(50).
  1027         16  FILLER                          PIC X(31).
  1028         16  PI-EL659-TO-EL130-CNTRL.
  1029             20  PI-EL659-CARRIER            PIC X.
  1030             20  PI-EL659-GROUPING           PIC X(6).
  1031             20  PI-EL659-STATE              PIC XX.
  1032             20  PI-EL659-ACCOUNT            PIC X(10).
  1033
  1034         16  FILLER                          PIC X(19).
  1035
  1036         16  PI-SAVE-INCUR-DT                PIC X(02).
  1037         16  PI-LETTER-ERROR-CODE            PIC 9(04).
  1038*         16  FILLER                          PIC X(65).
  1039         16  PI-ST-VFY-2ND-BENE              PIC X.
  1040         16  FILLER                          PIC X(64).
  1041
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL130.cbl
  1043*    COPY EL130S.
  1044 01  EL130AI.
  1045     05  FILLER            PIC  X(0012).
  1046*    -------------------------------
  1047     05  RUNDTEL PIC S9(0004) COMP.
  1048     05  RUNDTEF PIC  X(0001).
  1049     05  FILLER REDEFINES RUNDTEF.
  1050         10  RUNDTEA PIC  X(0001).
  1051     05  RUNDTEI PIC  X(0008).
  1052*    -------------------------------
  1053     05  RUNTIMEL PIC S9(0004) COMP.
  1054     05  RUNTIMEF PIC  X(0001).
  1055     05  FILLER REDEFINES RUNTIMEF.
  1056         10  RUNTIMEA PIC  X(0001).
  1057     05  RUNTIMEI PIC  X(0005).
  1058*    -------------------------------
  1059     05  COMPL PIC S9(0004) COMP.
  1060     05  COMPF PIC  X(0001).
  1061     05  FILLER REDEFINES COMPF.
  1062         10  COMPA PIC  X(0001).
  1063     05  COMPI PIC  X(0003).
  1064*    -------------------------------
  1065     05  SEQUL PIC S9(0004) COMP.
  1066     05  SEQUF PIC  X(0001).
  1067     05  FILLER REDEFINES SEQUF.
  1068         10  SEQUA PIC  X(0001).
  1069     05  SEQUI PIC  X(0010).
  1070*    -------------------------------
  1071     05  MAINTL PIC S9(0004) COMP.
  1072     05  MAINTF PIC  X(0001).
  1073     05  FILLER REDEFINES MAINTF.
  1074         10  MAINTA PIC  X(0001).
  1075     05  MAINTI PIC  X(0001).
  1076*    -------------------------------
  1077     05  CLMNOL PIC S9(0004) COMP.
  1078     05  CLMNOF PIC  X(0001).
  1079     05  FILLER REDEFINES CLMNOF.
  1080         10  CLMNOA PIC  X(0001).
  1081     05  CLMNOI PIC  X(0007).
  1082*    -------------------------------
  1083     05  CLMCARRL PIC S9(0004) COMP.
  1084     05  CLMCARRF PIC  X(0001).
  1085     05  FILLER REDEFINES CLMCARRF.
  1086         10  CLMCARRA PIC  X(0001).
  1087     05  CLMCARRI PIC  X(0001).
  1088*    -------------------------------
  1089     05  CLMTYPEL PIC S9(0004) COMP.
  1090     05  CLMTYPEF PIC  X(0001).
  1091     05  FILLER REDEFINES CLMTYPEF.
  1092         10  CLMTYPEA PIC  X(0001).
  1093     05  CLMTYPEI PIC  X(0001).
  1094*    -------------------------------
  1095     05  CERTNOL PIC S9(0004) COMP.
  1096     05  CERTNOF PIC  X(0001).
  1097     05  FILLER REDEFINES CERTNOF.
  1098         10  CERTNOA PIC  X(0001).
  1099     05  CERTNOI PIC  X(0010).
  1100*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL130.cbl
  1101     05  SUFXL PIC S9(0004) COMP.
  1102     05  SUFXF PIC  X(0001).
  1103     05  FILLER REDEFINES SUFXF.
  1104         10  SUFXA PIC  X(0001).
  1105     05  SUFXI PIC  X(0001).
  1106*    -------------------------------
  1107     05  PCERTNOL PIC S9(0004) COMP.
  1108     05  PCERTNOF PIC  X(0001).
  1109     05  FILLER REDEFINES PCERTNOF.
  1110         10  PCERTNOA PIC  X(0001).
  1111     05  PCERTNOI PIC  X(0010).
  1112*    -------------------------------
  1113     05  PSUFXL PIC S9(0004) COMP.
  1114     05  PSUFXF PIC  X(0001).
  1115     05  FILLER REDEFINES PSUFXF.
  1116         10  PSUFXA PIC  X(0001).
  1117     05  PSUFXI PIC  X(0001).
  1118*    -------------------------------
  1119     05  INCURL PIC S9(0004) COMP.
  1120     05  INCURF PIC  X(0001).
  1121     05  FILLER REDEFINES INCURF.
  1122         10  INCURA PIC  X(0001).
  1123     05  INCURI PIC  X(0008).
  1124*    -------------------------------
  1125     05  REPORTL PIC S9(0004) COMP.
  1126     05  REPORTF PIC  X(0001).
  1127     05  FILLER REDEFINES REPORTF.
  1128         10  REPORTA PIC  X(0001).
  1129     05  REPORTI PIC  X(0008).
  1130*    -------------------------------
  1131     05  CAUSEL PIC S9(0004) COMP.
  1132     05  CAUSEF PIC  X(0001).
  1133     05  FILLER REDEFINES CAUSEF.
  1134         10  CAUSEA PIC  X(0001).
  1135     05  CAUSEI PIC  X(0006).
  1136*    -------------------------------
  1137     05  ESTENDL PIC S9(0004) COMP.
  1138     05  ESTENDF PIC  X(0001).
  1139     05  FILLER REDEFINES ESTENDF.
  1140         10  ESTENDA PIC  X(0001).
  1141     05  ESTENDI PIC  X(0008).
  1142*    -------------------------------
  1143     05  DIAGL PIC S9(0004) COMP.
  1144     05  DIAGF PIC  X(0001).
  1145     05  FILLER REDEFINES DIAGF.
  1146         10  DIAGA PIC  X(0001).
  1147     05  DIAGI PIC  X(0060).
  1148*    -------------------------------
  1149     05  BENECDL PIC S9(0004) COMP.
  1150     05  BENECDF PIC  X(0001).
  1151     05  FILLER REDEFINES BENECDF.
  1152         10  BENECDA PIC  X(0001).
  1153     05  BENECDI PIC  X(0010).
  1154*    -------------------------------
  1155     05  BIRTHDTL PIC S9(0004) COMP.
  1156     05  BIRTHDTF PIC  X(0001).
  1157     05  FILLER REDEFINES BIRTHDTF.
  1158         10  BIRTHDTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL130.cbl
  1159     05  BIRTHDTI PIC  X(0008).
  1160*    -------------------------------
  1161     05  SSNL PIC S9(0004) COMP.
  1162     05  SSNF PIC  X(0001).
  1163     05  FILLER REDEFINES SSNF.
  1164         10  SSNA PIC  X(0001).
  1165     05  SSNI PIC  X(0011).
  1166*    -------------------------------
  1167     05  SEXL PIC S9(0004) COMP.
  1168     05  SEXF PIC  X(0001).
  1169     05  FILLER REDEFINES SEXF.
  1170         10  SEXA PIC  X(0001).
  1171     05  SEXI PIC  X(0001).
  1172*    -------------------------------
  1173     05  OCCCDL PIC S9(0004) COMP.
  1174     05  OCCCDF PIC  X(0001).
  1175     05  FILLER REDEFINES OCCCDF.
  1176         10  OCCCDA PIC  X(0001).
  1177     05  OCCCDI PIC  X(0006).
  1178*    -------------------------------
  1179     05  LSTNMEL PIC S9(0004) COMP.
  1180     05  LSTNMEF PIC  X(0001).
  1181     05  FILLER REDEFINES LSTNMEF.
  1182         10  LSTNMEA PIC  X(0001).
  1183     05  LSTNMEI PIC  X(0015).
  1184*    -------------------------------
  1185     05  FSTNMEL PIC S9(0004) COMP.
  1186     05  FSTNMEF PIC  X(0001).
  1187     05  FILLER REDEFINES FSTNMEF.
  1188         10  FSTNMEA PIC  X(0001).
  1189     05  FSTNMEI PIC  X(0012).
  1190*    -------------------------------
  1191     05  INITL PIC S9(0004) COMP.
  1192     05  INITF PIC  X(0001).
  1193     05  FILLER REDEFINES INITF.
  1194         10  INITA PIC  X(0001).
  1195     05  INITI PIC  X(0001).
  1196*    -------------------------------
  1197     05  LOANNOL PIC S9(0004) COMP.
  1198     05  LOANNOF PIC  X(0001).
  1199     05  FILLER REDEFINES LOANNOF.
  1200         10  LOANNOA PIC  X(0001).
  1201     05  LOANNOI PIC  X(0008).
  1202*    -------------------------------
  1203     05  CRTLNMEL PIC S9(0004) COMP.
  1204     05  CRTLNMEF PIC  X(0001).
  1205     05  FILLER REDEFINES CRTLNMEF.
  1206         10  CRTLNMEA PIC  X(0001).
  1207     05  CRTLNMEI PIC  X(0015).
  1208*    -------------------------------
  1209     05  CRTFNMEL PIC S9(0004) COMP.
  1210     05  CRTFNMEF PIC  X(0001).
  1211     05  FILLER REDEFINES CRTFNMEF.
  1212         10  CRTFNMEA PIC  X(0001).
  1213     05  CRTFNMEI PIC  X(0012).
  1214*    -------------------------------
  1215     05  CRTINITL PIC S9(0004) COMP.
  1216     05  CRTINITF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL130.cbl
  1217     05  FILLER REDEFINES CRTINITF.
  1218         10  CRTINITA PIC  X(0001).
  1219     05  CRTINITI PIC  X(0001).
  1220*    -------------------------------
  1221     05  LOANBALL PIC S9(0004) COMP.
  1222     05  LOANBALF PIC  X(0001).
  1223     05  FILLER REDEFINES LOANBALF.
  1224         10  LOANBALA PIC  X(0001).
  1225     05  LOANBALI PIC  9(7)V99.
  1226*    -------------------------------
  1227     05  MANRSVL PIC S9(0004) COMP.
  1228     05  MANRSVF PIC  X(0001).
  1229     05  FILLER REDEFINES MANRSVF.
  1230         10  MANRSVA PIC  X(0001).
  1231     05  MANRSVI PIC  9(7)V99.
  1232*    -------------------------------
  1233     05  SUPVL PIC S9(0004) COMP.
  1234     05  SUPVF PIC  X(0001).
  1235     05  FILLER REDEFINES SUPVF.
  1236         10  SUPVA PIC  X(0001).
  1237     05  SUPVI PIC  X(0001).
  1238*    -------------------------------
  1239     05  PRICDL PIC S9(0004) COMP.
  1240     05  PRICDF PIC  X(0001).
  1241     05  FILLER REDEFINES PRICDF.
  1242         10  PRICDA PIC  X(0001).
  1243     05  PRICDI PIC  X(0001).
  1244*    -------------------------------
  1245     05  PRODL PIC S9(0004) COMP.
  1246     05  PRODF PIC  X(0001).
  1247     05  FILLER REDEFINES PRODF.
  1248         10  PRODA PIC  X(0001).
  1249     05  PRODI PIC  X(0008).
  1250*    -------------------------------
  1251     05  PRODCDL PIC S9(0004) COMP.
  1252     05  PRODCDF PIC  X(0001).
  1253     05  FILLER REDEFINES PRODCDF.
  1254         10  PRODCDA PIC  X(0001).
  1255     05  PRODCDI PIC  X(0001).
  1256*    -------------------------------
  1257     05  FILETOL PIC S9(0004) COMP.
  1258     05  FILETOF PIC  X(0001).
  1259     05  FILLER REDEFINES FILETOF.
  1260         10  FILETOA PIC  X(0001).
  1261     05  FILETOI PIC  X(0004).
  1262*    -------------------------------
  1263     05  PROCCDL PIC S9(0004) COMP.
  1264     05  PROCCDF PIC  X(0001).
  1265     05  FILLER REDEFINES PROCCDF.
  1266         10  PROCCDA PIC  X(0001).
  1267     05  PROCCDI PIC  X(0004).
  1268*    -------------------------------
  1269     05  RELCLML PIC S9(0004) COMP.
  1270     05  RELCLMF PIC  X(0001).
  1271     05  FILLER REDEFINES RELCLMF.
  1272         10  RELCLMA PIC  X(0001).
  1273     05  RELCLMI PIC  X(0007).
  1274*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL130.cbl
  1275     05  PRTOPTL PIC S9(0004) COMP.
  1276     05  PRTOPTF PIC  X(0001).
  1277     05  FILLER REDEFINES PRTOPTF.
  1278         10  PRTOPTA PIC  X(0001).
  1279     05  PRTOPTI PIC  X(0001).
  1280*    -------------------------------
  1281     05  ALTPRTL PIC S9(0004) COMP.
  1282     05  ALTPRTF PIC  X(0001).
  1283     05  FILLER REDEFINES ALTPRTF.
  1284         10  ALTPRTA PIC  X(0001).
  1285     05  ALTPRTI PIC  X(0004).
  1286*    -------------------------------
  1287     05  CERTMTL PIC S9(0004) COMP.
  1288     05  CERTMTF PIC  X(0001).
  1289     05  FILLER REDEFINES CERTMTF.
  1290         10  CERTMTA PIC  X(0001).
  1291     05  CERTMTI PIC  X(0001).
  1292*    -------------------------------
  1293     05  CRTCARRL PIC S9(0004) COMP.
  1294     05  CRTCARRF PIC  X(0001).
  1295     05  FILLER REDEFINES CRTCARRF.
  1296         10  CRTCARRA PIC  X(0001).
  1297     05  CRTCARRI PIC  X(0001).
  1298*    -------------------------------
  1299     05  GROUPL PIC S9(0004) COMP.
  1300     05  GROUPF PIC  X(0001).
  1301     05  FILLER REDEFINES GROUPF.
  1302         10  GROUPA PIC  X(0001).
  1303     05  GROUPI PIC  X(0006).
  1304*    -------------------------------
  1305     05  STATEL PIC S9(0004) COMP.
  1306     05  STATEF PIC  X(0001).
  1307     05  FILLER REDEFINES STATEF.
  1308         10  STATEA PIC  X(0001).
  1309     05  STATEI PIC  X(0002).
  1310*    -------------------------------
  1311     05  ACCOUNTL PIC S9(0004) COMP.
  1312     05  ACCOUNTF PIC  X(0001).
  1313     05  FILLER REDEFINES ACCOUNTF.
  1314         10  ACCOUNTA PIC  X(0001).
  1315     05  ACCOUNTI PIC  X(0010).
  1316*    -------------------------------
  1317     05  EFFDTL PIC S9(0004) COMP.
  1318     05  EFFDTF PIC  X(0001).
  1319     05  FILLER REDEFINES EFFDTF.
  1320         10  EFFDTA PIC  X(0001).
  1321     05  EFFDTI PIC  X(0008).
  1322*    -------------------------------
  1323     05  CRTSSNL PIC S9(0004) COMP.
  1324     05  CRTSSNF PIC  X(0001).
  1325     05  FILLER REDEFINES CRTSSNF.
  1326         10  CRTSSNA PIC  X(0001).
  1327     05  CRTSSNI PIC  X(0011).
  1328*    -------------------------------
  1329     05  MEMCAPL PIC S9(0004) COMP.
  1330     05  MEMCAPF PIC  X(0001).
  1331     05  FILLER REDEFINES MEMCAPF.
  1332         10  MEMCAPA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL130.cbl
  1333     05  MEMCAPI PIC  X(0010).
  1334*    -------------------------------
  1335     05  MEMBERL PIC S9(0004) COMP.
  1336     05  MEMBERF PIC  X(0001).
  1337     05  FILLER REDEFINES MEMBERF.
  1338         10  MEMBERA PIC  X(0001).
  1339     05  MEMBERI PIC  X(0012).
  1340*    -------------------------------
  1341     05  REINCDL PIC S9(0004) COMP.
  1342     05  REINCDF PIC  X(0001).
  1343     05  FILLER REDEFINES REINCDF.
  1344         10  REINCDA PIC  X(0001).
  1345     05  REINCDI PIC  X(0001).
  1346*    -------------------------------
  1347     05  ISSAGEL PIC S9(0004) COMP.
  1348     05  ISSAGEF PIC  X(0001).
  1349     05  FILLER REDEFINES ISSAGEF.
  1350         10  ISSAGEA PIC  X(0001).
  1351     05  ISSAGEI PIC  X(0002).
  1352*    -------------------------------
  1353     05  APRL PIC S9(0004) COMP.
  1354     05  APRF PIC  X(0001).
  1355     05  FILLER REDEFINES APRF.
  1356         10  APRA PIC  X(0001).
  1357     05  APRI PIC  9(4)V9(4).
  1358*    -------------------------------
  1359     05  PMTFREQL PIC S9(0004) COMP.
  1360     05  PMTFREQF PIC  X(0001).
  1361     05  FILLER REDEFINES PMTFREQF.
  1362         10  PMTFREQA PIC  X(0001).
  1363     05  PMTFREQI PIC  99.
  1364*    -------------------------------
  1365     05  INDGRPL PIC S9(0004) COMP.
  1366     05  INDGRPF PIC  X(0001).
  1367     05  FILLER REDEFINES INDGRPF.
  1368         10  INDGRPA PIC  X(0001).
  1369     05  INDGRPI PIC  X(0001).
  1370*    -------------------------------
  1371     05  PREMTYPL PIC S9(0004) COMP.
  1372     05  PREMTYPF PIC  X(0001).
  1373     05  FILLER REDEFINES PREMTYPF.
  1374         10  PREMTYPA PIC  X(0001).
  1375     05  PREMTYPI PIC  X(0001).
  1376*    -------------------------------
  1377     05  ADDONDTL PIC S9(0004) COMP.
  1378     05  ADDONDTF PIC  X(0001).
  1379     05  FILLER REDEFINES ADDONDTF.
  1380         10  ADDONDTA PIC  X(0001).
  1381     05  ADDONDTI PIC  X(0008).
  1382*    -------------------------------
  1383     05  JNTLNMEL PIC S9(0004) COMP.
  1384     05  JNTLNMEF PIC  X(0001).
  1385     05  FILLER REDEFINES JNTLNMEF.
  1386         10  JNTLNMEA PIC  X(0001).
  1387     05  JNTLNMEI PIC  X(0015).
  1388*    -------------------------------
  1389     05  JNTFNMEL PIC S9(0004) COMP.
  1390     05  JNTFNMEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL130.cbl
  1391     05  FILLER REDEFINES JNTFNMEF.
  1392         10  JNTFNMEA PIC  X(0001).
  1393     05  JNTFNMEI PIC  X(0002).
  1394*    -------------------------------
  1395     05  JNTINITL PIC S9(0004) COMP.
  1396     05  JNTINITF PIC  X(0001).
  1397     05  FILLER REDEFINES JNTINITF.
  1398         10  JNTINITA PIC  X(0001).
  1399     05  JNTINITI PIC  X(0001).
  1400*    -------------------------------
  1401     05  JNTAGEL PIC S9(0004) COMP.
  1402     05  JNTAGEF PIC  X(0001).
  1403     05  FILLER REDEFINES JNTAGEF.
  1404         10  JNTAGEA PIC  X(0001).
  1405     05  JNTAGEI PIC  X(0002).
  1406*    -------------------------------
  1407     05  LCVDSCRL PIC S9(0004) COMP.
  1408     05  LCVDSCRF PIC  X(0001).
  1409     05  FILLER REDEFINES LCVDSCRF.
  1410         10  LCVDSCRA PIC  X(0001).
  1411     05  LCVDSCRI PIC  X(0006).
  1412*    -------------------------------
  1413     05  LCVKINDL PIC S9(0004) COMP.
  1414     05  LCVKINDF PIC  X(0001).
  1415     05  FILLER REDEFINES LCVKINDF.
  1416         10  LCVKINDA PIC  X(0001).
  1417     05  LCVKINDI PIC  X(0003).
  1418*    -------------------------------
  1419     05  LCVCDL PIC S9(0004) COMP.
  1420     05  LCVCDF PIC  X(0001).
  1421     05  FILLER REDEFINES LCVCDF.
  1422         10  LCVCDA PIC  X(0001).
  1423     05  LCVCDI PIC  X(0002).
  1424*    -------------------------------
  1425     05  LCVOTRML PIC S9(0004) COMP.
  1426     05  LCVOTRMF PIC  X(0001).
  1427     05  FILLER REDEFINES LCVOTRMF.
  1428         10  LCVOTRMA PIC  X(0001).
  1429     05  LCVOTRMI PIC  999.
  1430*    -------------------------------
  1431     05  LCVRTRML PIC S9(0004) COMP.
  1432     05  LCVRTRMF PIC  X(0001).
  1433     05  FILLER REDEFINES LCVRTRMF.
  1434         10  LCVRTRMA PIC  X(0001).
  1435     05  LCVRTRMI PIC  X(0003).
  1436*    -------------------------------
  1437     05  LCVRATEL PIC S9(0004) COMP.
  1438     05  LCVRATEF PIC  X(0001).
  1439     05  FILLER REDEFINES LCVRATEF.
  1440         10  LCVRATEA PIC  X(0001).
  1441     05  LCVRATEI PIC  9999V99.
  1442*    -------------------------------
  1443     05  LCVBENEL PIC S9(0004) COMP.
  1444     05  LCVBENEF PIC  X(0001).
  1445     05  FILLER REDEFINES LCVBENEF.
  1446         10  LCVBENEA PIC  X(0001).
  1447     05  LCVBENEI PIC  9(9)V99.
  1448*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL130.cbl
  1449     05  LCVFORML PIC S9(0004) COMP.
  1450     05  LCVFORMF PIC  X(0001).
  1451     05  FILLER REDEFINES LCVFORMF.
  1452         10  LCVFORMA PIC  X(0001).
  1453     05  LCVFORMI PIC  X(0012).
  1454*    -------------------------------
  1455     05  LCVCNDTL PIC S9(0004) COMP.
  1456     05  LCVCNDTF PIC  X(0001).
  1457     05  FILLER REDEFINES LCVCNDTF.
  1458         10  LCVCNDTA PIC  X(0001).
  1459     05  LCVCNDTI PIC  X(0008).
  1460*    -------------------------------
  1461     05  LCVEXITL PIC S9(0004) COMP.
  1462     05  LCVEXITF PIC  X(0001).
  1463     05  FILLER REDEFINES LCVEXITF.
  1464         10  LCVEXITA PIC  X(0001).
  1465     05  LCVEXITI PIC  X(0008).
  1466*    -------------------------------
  1467     05  LCVSTATL PIC S9(0004) COMP.
  1468     05  LCVSTATF PIC  X(0001).
  1469     05  FILLER REDEFINES LCVSTATF.
  1470         10  LCVSTATA PIC  X(0001).
  1471     05  LCVSTATI PIC  X(0006).
  1472*    -------------------------------
  1473     05  ACVDSCRL PIC S9(0004) COMP.
  1474     05  ACVDSCRF PIC  X(0001).
  1475     05  FILLER REDEFINES ACVDSCRF.
  1476         10  ACVDSCRA PIC  X(0001).
  1477     05  ACVDSCRI PIC  X(0006).
  1478*    -------------------------------
  1479     05  ACVKINDL PIC S9(0004) COMP.
  1480     05  ACVKINDF PIC  X(0001).
  1481     05  FILLER REDEFINES ACVKINDF.
  1482         10  ACVKINDA PIC  X(0001).
  1483     05  ACVKINDI PIC  X(0003).
  1484*    -------------------------------
  1485     05  ACVCDL PIC S9(0004) COMP.
  1486     05  ACVCDF PIC  X(0001).
  1487     05  FILLER REDEFINES ACVCDF.
  1488         10  ACVCDA PIC  X(0001).
  1489     05  ACVCDI PIC  X(0002).
  1490*    -------------------------------
  1491     05  ACVOTRML PIC S9(0004) COMP.
  1492     05  ACVOTRMF PIC  X(0001).
  1493     05  FILLER REDEFINES ACVOTRMF.
  1494         10  ACVOTRMA PIC  X(0001).
  1495     05  ACVOTRMI PIC  999.
  1496*    -------------------------------
  1497     05  ACVRTRML PIC S9(0004) COMP.
  1498     05  ACVRTRMF PIC  X(0001).
  1499     05  FILLER REDEFINES ACVRTRMF.
  1500         10  ACVRTRMA PIC  X(0001).
  1501     05  ACVRTRMI PIC  X(0003).
  1502*    -------------------------------
  1503     05  ACVRATEL PIC S9(0004) COMP.
  1504     05  ACVRATEF PIC  X(0001).
  1505     05  FILLER REDEFINES ACVRATEF.
  1506         10  ACVRATEA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL130.cbl
  1507     05  ACVRATEI PIC  9999V99.
  1508*    -------------------------------
  1509     05  ACVBENEL PIC S9(0004) COMP.
  1510     05  ACVBENEF PIC  X(0001).
  1511     05  FILLER REDEFINES ACVBENEF.
  1512         10  ACVBENEA PIC  X(0001).
  1513     05  ACVBENEI PIC  9(9)V99.
  1514*    -------------------------------
  1515     05  ACVFORML PIC S9(0004) COMP.
  1516     05  ACVFORMF PIC  X(0001).
  1517     05  FILLER REDEFINES ACVFORMF.
  1518         10  ACVFORMA PIC  X(0001).
  1519     05  ACVFORMI PIC  X(0012).
  1520*    -------------------------------
  1521     05  ACVCNDTL PIC S9(0004) COMP.
  1522     05  ACVCNDTF PIC  X(0001).
  1523     05  FILLER REDEFINES ACVCNDTF.
  1524         10  ACVCNDTA PIC  X(0001).
  1525     05  ACVCNDTI PIC  X(0008).
  1526*    -------------------------------
  1527     05  ACVEXITL PIC S9(0004) COMP.
  1528     05  ACVEXITF PIC  X(0001).
  1529     05  FILLER REDEFINES ACVEXITF.
  1530         10  ACVEXITA PIC  X(0001).
  1531     05  ACVEXITI PIC  X(0008).
  1532*    -------------------------------
  1533     05  ACVSTATL PIC S9(0004) COMP.
  1534     05  ACVSTATF PIC  X(0001).
  1535     05  FILLER REDEFINES ACVSTATF.
  1536         10  ACVSTATA PIC  X(0001).
  1537     05  ACVSTATI PIC  X(0006).
  1538*    -------------------------------
  1539     05  ERRMSG1L PIC S9(0004) COMP.
  1540     05  ERRMSG1F PIC  X(0001).
  1541     05  FILLER REDEFINES ERRMSG1F.
  1542         10  ERRMSG1A PIC  X(0001).
  1543     05  ERRMSG1I PIC  X(0072).
  1544*    -------------------------------
  1545     05  ERRMSG2L PIC S9(0004) COMP.
  1546     05  ERRMSG2F PIC  X(0001).
  1547     05  FILLER REDEFINES ERRMSG2F.
  1548         10  ERRMSG2A PIC  X(0001).
  1549     05  ERRMSG2I PIC  X(0072).
  1550*    -------------------------------
  1551     05  BCERT1L PIC S9(0004) COMP.
  1552     05  BCERT1F PIC  X(0001).
  1553     05  FILLER REDEFINES BCERT1F.
  1554         10  BCERT1A PIC  X(0001).
  1555     05  BCERT1I PIC  X(0010).
  1556*    -------------------------------
  1557     05  BSUFX1L PIC S9(0004) COMP.
  1558     05  BSUFX1F PIC  X(0001).
  1559     05  FILLER REDEFINES BSUFX1F.
  1560         10  BSUFX1A PIC  X(0001).
  1561     05  BSUFX1I PIC  X(0001).
  1562*    -------------------------------
  1563     05  BCERT2L PIC S9(0004) COMP.
  1564     05  BCERT2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL130.cbl
  1565     05  FILLER REDEFINES BCERT2F.
  1566         10  BCERT2A PIC  X(0001).
  1567     05  BCERT2I PIC  X(0010).
  1568*    -------------------------------
  1569     05  BSUFX2L PIC S9(0004) COMP.
  1570     05  BSUFX2F PIC  X(0001).
  1571     05  FILLER REDEFINES BSUFX2F.
  1572         10  BSUFX2A PIC  X(0001).
  1573     05  BSUFX2I PIC  X(0001).
  1574*    -------------------------------
  1575     05  BCERT3L PIC S9(0004) COMP.
  1576     05  BCERT3F PIC  X(0001).
  1577     05  FILLER REDEFINES BCERT3F.
  1578         10  BCERT3A PIC  X(0001).
  1579     05  BCERT3I PIC  X(0010).
  1580*    -------------------------------
  1581     05  BSUFX3L PIC S9(0004) COMP.
  1582     05  BSUFX3F PIC  X(0001).
  1583     05  FILLER REDEFINES BSUFX3F.
  1584         10  BSUFX3A PIC  X(0001).
  1585     05  BSUFX3I PIC  X(0001).
  1586*    -------------------------------
  1587     05  BCERT4L PIC S9(0004) COMP.
  1588     05  BCERT4F PIC  X(0001).
  1589     05  FILLER REDEFINES BCERT4F.
  1590         10  BCERT4A PIC  X(0001).
  1591     05  BCERT4I PIC  X(0010).
  1592*    -------------------------------
  1593     05  BSUFX4L PIC S9(0004) COMP.
  1594     05  BSUFX4F PIC  X(0001).
  1595     05  FILLER REDEFINES BSUFX4F.
  1596         10  BSUFX4A PIC  X(0001).
  1597     05  BSUFX4I PIC  X(0001).
  1598*    -------------------------------
  1599     05  BCERT5L PIC S9(0004) COMP.
  1600     05  BCERT5F PIC  X(0001).
  1601     05  FILLER REDEFINES BCERT5F.
  1602         10  BCERT5A PIC  X(0001).
  1603     05  BCERT5I PIC  X(0010).
  1604*    -------------------------------
  1605     05  BSUFX5L PIC S9(0004) COMP.
  1606     05  BSUFX5F PIC  X(0001).
  1607     05  FILLER REDEFINES BSUFX5F.
  1608         10  BSUFX5A PIC  X(0001).
  1609     05  BSUFX5I PIC  X(0001).
  1610*    -------------------------------
  1611     05  ENTERPFL PIC S9(0004) COMP.
  1612     05  ENTERPFF PIC  X(0001).
  1613     05  FILLER REDEFINES ENTERPFF.
  1614         10  ENTERPFA PIC  X(0001).
  1615     05  ENTERPFI PIC  99.
  1616*    -------------------------------
  1617     05  PF5L PIC S9(0004) COMP.
  1618     05  PF5F PIC  X(0001).
  1619     05  FILLER REDEFINES PF5F.
  1620         10  PF5A PIC  X(0001).
  1621     05  PF5I PIC  X(0013).
  1622 01  EL130AO REDEFINES EL130AI.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL130.cbl
  1623     05  FILLER            PIC  X(0012).
  1624*    -------------------------------
  1625     05  FILLER            PIC  X(0003).
  1626     05  RUNDTEO PIC  X(0008).
  1627*    -------------------------------
  1628     05  FILLER            PIC  X(0003).
  1629     05  RUNTIMEO PIC  99.99.
  1630*    -------------------------------
  1631     05  FILLER            PIC  X(0003).
  1632     05  COMPO PIC  X(0003).
  1633*    -------------------------------
  1634     05  FILLER            PIC  X(0003).
  1635     05  SEQUO PIC  X(0010).
  1636*    -------------------------------
  1637     05  FILLER            PIC  X(0003).
  1638     05  MAINTO PIC  X(0001).
  1639*    -------------------------------
  1640     05  FILLER            PIC  X(0003).
  1641     05  CLMNOO PIC  X(0007).
  1642*    -------------------------------
  1643     05  FILLER            PIC  X(0003).
  1644     05  CLMCARRO PIC  X(0001).
  1645*    -------------------------------
  1646     05  FILLER            PIC  X(0003).
  1647     05  CLMTYPEO PIC  X(0001).
  1648*    -------------------------------
  1649     05  FILLER            PIC  X(0003).
  1650     05  CERTNOO PIC  X(0010).
  1651*    -------------------------------
  1652     05  FILLER            PIC  X(0003).
  1653     05  SUFXO PIC  X(0001).
  1654*    -------------------------------
  1655     05  FILLER            PIC  X(0003).
  1656     05  PCERTNOO PIC  X(0010).
  1657*    -------------------------------
  1658     05  FILLER            PIC  X(0003).
  1659     05  PSUFXO PIC  X(0001).
  1660*    -------------------------------
  1661     05  FILLER            PIC  X(0003).
  1662     05  INCURO PIC  X(0008).
  1663*    -------------------------------
  1664     05  FILLER            PIC  X(0003).
  1665     05  REPORTO PIC  X(0008).
  1666*    -------------------------------
  1667     05  FILLER            PIC  X(0003).
  1668     05  CAUSEO PIC  X(0006).
  1669*    -------------------------------
  1670     05  FILLER            PIC  X(0003).
  1671     05  ESTENDO PIC  X(0008).
  1672*    -------------------------------
  1673     05  FILLER            PIC  X(0003).
  1674     05  DIAGO PIC  X(0060).
  1675*    -------------------------------
  1676     05  FILLER            PIC  X(0003).
  1677     05  BENECDO PIC  X(0010).
  1678*    -------------------------------
  1679     05  FILLER            PIC  X(0003).
  1680     05  BIRTHDTO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL130.cbl
  1681*    -------------------------------
  1682     05  FILLER            PIC  X(0003).
  1683     05  SSNO PIC  X(0011).
  1684*    -------------------------------
  1685     05  FILLER            PIC  X(0003).
  1686     05  SEXO PIC  X(0001).
  1687*    -------------------------------
  1688     05  FILLER            PIC  X(0003).
  1689     05  OCCCDO PIC  X(0006).
  1690*    -------------------------------
  1691     05  FILLER            PIC  X(0003).
  1692     05  LSTNMEO PIC  X(0015).
  1693*    -------------------------------
  1694     05  FILLER            PIC  X(0003).
  1695     05  FSTNMEO PIC  X(0012).
  1696*    -------------------------------
  1697     05  FILLER            PIC  X(0003).
  1698     05  INITO PIC  X(0001).
  1699*    -------------------------------
  1700     05  FILLER            PIC  X(0003).
  1701     05  LOANNOO PIC  X(0008).
  1702*    -------------------------------
  1703     05  FILLER            PIC  X(0003).
  1704     05  CRTLNMEO PIC  X(0015).
  1705*    -------------------------------
  1706     05  FILLER            PIC  X(0003).
  1707     05  CRTFNMEO PIC  X(0012).
  1708*    -------------------------------
  1709     05  FILLER            PIC  X(0003).
  1710     05  CRTINITO PIC  X(0001).
  1711*    -------------------------------
  1712     05  FILLER            PIC  X(0003).
  1713     05  LOANBALO PIC  ZZZZZ9.99.
  1714*    -------------------------------
  1715     05  FILLER            PIC  X(0003).
  1716     05  MANRSVO PIC  Z(5)9.99.
  1717*    -------------------------------
  1718     05  FILLER            PIC  X(0003).
  1719     05  SUPVO PIC  X(0001).
  1720*    -------------------------------
  1721     05  FILLER            PIC  X(0003).
  1722     05  PRICDO PIC  X(0001).
  1723*    -------------------------------
  1724     05  FILLER            PIC  X(0003).
  1725     05  PRODO PIC  X(0008).
  1726*    -------------------------------
  1727     05  FILLER            PIC  X(0003).
  1728     05  PRODCDO PIC  X(0001).
  1729*    -------------------------------
  1730     05  FILLER            PIC  X(0003).
  1731     05  FILETOO PIC  X(0004).
  1732*    -------------------------------
  1733     05  FILLER            PIC  X(0003).
  1734     05  PROCCDO PIC  X(0004).
  1735*    -------------------------------
  1736     05  FILLER            PIC  X(0003).
  1737     05  RELCLMO PIC  X(0007).
  1738*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL130.cbl
  1739     05  FILLER            PIC  X(0003).
  1740     05  PRTOPTO PIC  X(0001).
  1741*    -------------------------------
  1742     05  FILLER            PIC  X(0003).
  1743     05  ALTPRTO PIC  X(0004).
  1744*    -------------------------------
  1745     05  FILLER            PIC  X(0003).
  1746     05  CERTMTO PIC  X(0001).
  1747*    -------------------------------
  1748     05  FILLER            PIC  X(0003).
  1749     05  CRTCARRO PIC  X(0001).
  1750*    -------------------------------
  1751     05  FILLER            PIC  X(0003).
  1752     05  GROUPO PIC  X(0006).
  1753*    -------------------------------
  1754     05  FILLER            PIC  X(0003).
  1755     05  STATEO PIC  X(0002).
  1756*    -------------------------------
  1757     05  FILLER            PIC  X(0003).
  1758     05  ACCOUNTO PIC  X(0010).
  1759*    -------------------------------
  1760     05  FILLER            PIC  X(0003).
  1761     05  EFFDTO PIC  X(0008).
  1762*    -------------------------------
  1763     05  FILLER            PIC  X(0003).
  1764     05  CRTSSNO PIC  X(0011).
  1765*    -------------------------------
  1766     05  FILLER            PIC  X(0003).
  1767     05  MEMCAPO PIC  X(0010).
  1768*    -------------------------------
  1769     05  FILLER            PIC  X(0003).
  1770     05  MEMBERO PIC  X(0012).
  1771*    -------------------------------
  1772     05  FILLER            PIC  X(0003).
  1773     05  REINCDO PIC  X(0001).
  1774*    -------------------------------
  1775     05  FILLER            PIC  X(0003).
  1776     05  ISSAGEO PIC  X(0002).
  1777*    -------------------------------
  1778     05  FILLER            PIC  X(0003).
  1779     05  APRO PIC  9(3).9(4).
  1780*    -------------------------------
  1781     05  FILLER            PIC  X(0003).
  1782     05  PMTFREQO PIC  99.
  1783*    -------------------------------
  1784     05  FILLER            PIC  X(0003).
  1785     05  INDGRPO PIC  X(0001).
  1786*    -------------------------------
  1787     05  FILLER            PIC  X(0003).
  1788     05  PREMTYPO PIC  X(0001).
  1789*    -------------------------------
  1790     05  FILLER            PIC  X(0003).
  1791     05  ADDONDTO PIC  X(0008).
  1792*    -------------------------------
  1793     05  FILLER            PIC  X(0003).
  1794     05  JNTLNMEO PIC  X(0015).
  1795*    -------------------------------
  1796     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL130.cbl
  1797     05  JNTFNMEO PIC  X(0002).
  1798*    -------------------------------
  1799     05  FILLER            PIC  X(0003).
  1800     05  JNTINITO PIC  X(0001).
  1801*    -------------------------------
  1802     05  FILLER            PIC  X(0003).
  1803     05  JNTAGEO PIC  X(0002).
  1804*    -------------------------------
  1805     05  FILLER            PIC  X(0003).
  1806     05  LCVDSCRO PIC  X(0006).
  1807*    -------------------------------
  1808     05  FILLER            PIC  X(0003).
  1809     05  LCVKINDO PIC  X(0003).
  1810*    -------------------------------
  1811     05  FILLER            PIC  X(0003).
  1812     05  LCVCDO PIC  X(0002).
  1813*    -------------------------------
  1814     05  FILLER            PIC  X(0003).
  1815     05  LCVOTRMO PIC  999.
  1816*    -------------------------------
  1817     05  FILLER            PIC  X(0003).
  1818     05  LCVRTRMO PIC  ZZZ.
  1819*    -------------------------------
  1820     05  FILLER            PIC  X(0003).
  1821     05  LCVRATEO PIC  ZZZ.ZZ.
  1822*    -------------------------------
  1823     05  FILLER            PIC  X(0003).
  1824     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  1825*    -------------------------------
  1826     05  FILLER            PIC  X(0003).
  1827     05  LCVFORMO PIC  X(0012).
  1828*    -------------------------------
  1829     05  FILLER            PIC  X(0003).
  1830     05  LCVCNDTO PIC  X(0008).
  1831*    -------------------------------
  1832     05  FILLER            PIC  X(0003).
  1833     05  LCVEXITO PIC  X(0008).
  1834*    -------------------------------
  1835     05  FILLER            PIC  X(0003).
  1836     05  LCVSTATO PIC  X(0006).
  1837*    -------------------------------
  1838     05  FILLER            PIC  X(0003).
  1839     05  ACVDSCRO PIC  X(0006).
  1840*    -------------------------------
  1841     05  FILLER            PIC  X(0003).
  1842     05  ACVKINDO PIC  X(0003).
  1843*    -------------------------------
  1844     05  FILLER            PIC  X(0003).
  1845     05  ACVCDO PIC  X(0002).
  1846*    -------------------------------
  1847     05  FILLER            PIC  X(0003).
  1848     05  ACVOTRMO PIC  999.
  1849*    -------------------------------
  1850     05  FILLER            PIC  X(0003).
  1851     05  ACVRTRMO PIC  ZZZ.
  1852*    -------------------------------
  1853     05  FILLER            PIC  X(0003).
  1854     05  ACVRATEO PIC  ZZZ.ZZ.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL130.cbl
  1855*    -------------------------------
  1856     05  FILLER            PIC  X(0003).
  1857     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
  1858*    -------------------------------
  1859     05  FILLER            PIC  X(0003).
  1860     05  ACVFORMO PIC  X(0012).
  1861*    -------------------------------
  1862     05  FILLER            PIC  X(0003).
  1863     05  ACVCNDTO PIC  X(0008).
  1864*    -------------------------------
  1865     05  FILLER            PIC  X(0003).
  1866     05  ACVEXITO PIC  X(0008).
  1867*    -------------------------------
  1868     05  FILLER            PIC  X(0003).
  1869     05  ACVSTATO PIC  X(0006).
  1870*    -------------------------------
  1871     05  FILLER            PIC  X(0003).
  1872     05  ERRMSG1O PIC  X(0072).
  1873*    -------------------------------
  1874     05  FILLER            PIC  X(0003).
  1875     05  ERRMSG2O PIC  X(0072).
  1876*    -------------------------------
  1877     05  FILLER            PIC  X(0003).
  1878     05  BCERT1O PIC  X(0010).
  1879*    -------------------------------
  1880     05  FILLER            PIC  X(0003).
  1881     05  BSUFX1O PIC  X(0001).
  1882*    -------------------------------
  1883     05  FILLER            PIC  X(0003).
  1884     05  BCERT2O PIC  X(0010).
  1885*    -------------------------------
  1886     05  FILLER            PIC  X(0003).
  1887     05  BSUFX2O PIC  X(0001).
  1888*    -------------------------------
  1889     05  FILLER            PIC  X(0003).
  1890     05  BCERT3O PIC  X(0010).
  1891*    -------------------------------
  1892     05  FILLER            PIC  X(0003).
  1893     05  BSUFX3O PIC  X(0001).
  1894*    -------------------------------
  1895     05  FILLER            PIC  X(0003).
  1896     05  BCERT4O PIC  X(0010).
  1897*    -------------------------------
  1898     05  FILLER            PIC  X(0003).
  1899     05  BSUFX4O PIC  X(0001).
  1900*    -------------------------------
  1901     05  FILLER            PIC  X(0003).
  1902     05  BCERT5O PIC  X(0010).
  1903*    -------------------------------
  1904     05  FILLER            PIC  X(0003).
  1905     05  BSUFX5O PIC  X(0001).
  1906*    -------------------------------
  1907     05  FILLER            PIC  X(0003).
  1908     05  ENTERPFO PIC  X(0002).
  1909*    -------------------------------
  1910     05  FILLER            PIC  X(0003).
  1911     05  PF5O PIC  X(0013).
  1912*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL130.cbl
  1914*    COPY ELCDATE.
  1915******************************************************************
  1916*                                                                *
  1917*                                                                *
  1918*                            ELCDATE.                            *
  1919*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1920*                            VMOD=2.003
  1921*                                                                *
  1922*                                                                *
  1923*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1924*                 LENGTH = 200                                   *
  1925******************************************************************
  1926
  1927 01  DATE-CONVERSION-DATA.
  1928     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1929     12  DC-OPTION-CODE                PIC X.
  1930         88  BIN-TO-GREG                VALUE ' '.
  1931         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1932         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1933         88  YMD-GREG-TO-BIN            VALUE '3'.
  1934         88  MDY-GREG-TO-BIN            VALUE '4'.
  1935         88  JULIAN-TO-BIN              VALUE '5'.
  1936         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1937         88  FIND-CENTURY               VALUE '7'.
  1938         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1939         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1940         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1941         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1942         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1943         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1944         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1945         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1946         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1947         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1948         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1949         88  BIN-3-TO-GREG              VALUE 'I'.
  1950         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1951         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1952         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1953         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1954         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1955         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1956         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1957         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1958         88  THREE-CHARACTER-BIN
  1959                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1960         88  GREGORIAN-TO-BIN
  1961                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1962         88  BIN-TO-GREGORIAN
  1963                  VALUES ' ' '1' 'I' '8' 'G'.
  1964         88  JULIAN-TO-BINARY
  1965                  VALUES '5' 'C' 'E' 'F'.
  1966     12  DC-ERROR-CODE                 PIC X.
  1967         88  NO-CONVERSION-ERROR        VALUE ' '.
  1968         88  DATE-CONVERSION-ERROR
  1969                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1970         88  DATE-IS-ZERO               VALUE '1'.
  1971         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL130.cbl
  1972         88  DATE-IS-INVALID            VALUE '3'.
  1973         88  DATE1-GREATER-DATE2        VALUE '4'.
  1974         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1975         88  DATE-INVALID-OPTION        VALUE '9'.
  1976         88  INVALID-CENTURY            VALUE 'A'.
  1977         88  ONLY-CENTURY               VALUE 'B'.
  1978         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1979         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1980     12  DC-END-OF-MONTH               PIC X.
  1981         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1982     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1983         88  USE-NORMAL-PROCESS         VALUE ' '.
  1984         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1985         88  ADJUST-UP-100-YRS          VALUE '2'.
  1986     12  FILLER                        PIC X.
  1987     12  DC-CONVERSION-DATES.
  1988         16  DC-BIN-DATE-1             PIC XX.
  1989         16  DC-BIN-DATE-2             PIC XX.
  1990         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1991         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1992                       DC-GREG-DATE-1-EDIT.
  1993             20  DC-EDIT1-MONTH        PIC 99.
  1994             20  SLASH1-1              PIC X.
  1995             20  DC-EDIT1-DAY          PIC 99.
  1996             20  SLASH1-2              PIC X.
  1997             20  DC-EDIT1-YEAR         PIC 99.
  1998         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1999         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2000                     DC-GREG-DATE-2-EDIT.
  2001             20  DC-EDIT2-MONTH        PIC 99.
  2002             20  SLASH2-1              PIC X.
  2003             20  DC-EDIT2-DAY          PIC 99.
  2004             20  SLASH2-2              PIC X.
  2005             20  DC-EDIT2-YEAR         PIC 99.
  2006         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2007         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2008                     DC-GREG-DATE-1-YMD.
  2009             20  DC-YMD-YEAR           PIC 99.
  2010             20  DC-YMD-MONTH          PIC 99.
  2011             20  DC-YMD-DAY            PIC 99.
  2012         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2013         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2014                      DC-GREG-DATE-1-MDY.
  2015             20  DC-MDY-MONTH          PIC 99.
  2016             20  DC-MDY-DAY            PIC 99.
  2017             20  DC-MDY-YEAR           PIC 99.
  2018         16  DC-GREG-DATE-1-ALPHA.
  2019             20  DC-ALPHA-MONTH        PIC X(10).
  2020             20  DC-ALPHA-DAY          PIC 99.
  2021             20  FILLER                PIC XX.
  2022             20  DC-ALPHA-CENTURY.
  2023                 24 DC-ALPHA-CEN-N     PIC 99.
  2024             20  DC-ALPHA-YEAR         PIC 99.
  2025         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2026         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2027         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2028         16  DC-JULIAN-DATE            PIC 9(05).
  2029         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL130.cbl
  2030                                       PIC 9(05).
  2031         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2032             20  DC-JULIAN-YEAR        PIC 99.
  2033             20  DC-JULIAN-DAYS        PIC 999.
  2034         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2035         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2036         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2037     12  DATE-CONVERSION-VARIBLES.
  2038         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2039         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2040             20  FILLER                PIC 9(3).
  2041             20  HOLD-CEN-1-CCYY.
  2042                 24  HOLD-CEN-1-CC     PIC 99.
  2043                 24  HOLD-CEN-1-YY     PIC 99.
  2044             20  HOLD-CEN-1-MO         PIC 99.
  2045             20  HOLD-CEN-1-DA         PIC 99.
  2046         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2047             20  HOLD-CEN-1-R-MO       PIC 99.
  2048             20  HOLD-CEN-1-R-DA       PIC 99.
  2049             20  HOLD-CEN-1-R-CCYY.
  2050                 24  HOLD-CEN-1-R-CC   PIC 99.
  2051                 24  HOLD-CEN-1-R-YY   PIC 99.
  2052             20  FILLER                PIC 9(3).
  2053         16  HOLD-CENTURY-1-X.
  2054             20  FILLER                PIC X(3)  VALUE SPACES.
  2055             20  HOLD-CEN-1-X-CCYY.
  2056                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2057                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2058             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2059             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2060         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2061             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2062             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2063             20  HOLD-CEN-1-R-X-CCYY.
  2064                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2065                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2066             20  FILLER                PIC XXX.
  2067         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2068         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2069         16  DC-JULIAN-DATE-1          PIC 9(07).
  2070         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2071             20  DC-JULIAN-1-CCYY.
  2072                 24  DC-JULIAN-1-CC    PIC 99.
  2073                 24  DC-JULIAN-1-YR    PIC 99.
  2074             20  DC-JULIAN-DA-1        PIC 999.
  2075         16  DC-JULIAN-DATE-2          PIC 9(07).
  2076         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2077             20  DC-JULIAN-2-CCYY.
  2078                 24  DC-JULIAN-2-CC    PIC 99.
  2079                 24  DC-JULIAN-2-YR    PIC 99.
  2080             20  DC-JULIAN-DA-2        PIC 999.
  2081         16  DC-GREG-DATE-A-EDIT.
  2082             20  DC-EDITA-MONTH        PIC 99.
  2083             20  SLASHA-1              PIC X VALUE '/'.
  2084             20  DC-EDITA-DAY          PIC 99.
  2085             20  SLASHA-2              PIC X VALUE '/'.
  2086             20  DC-EDITA-CCYY.
  2087                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL130.cbl
  2088                 24  DC-EDITA-YEAR     PIC 99.
  2089         16  DC-GREG-DATE-B-EDIT.
  2090             20  DC-EDITB-MONTH        PIC 99.
  2091             20  SLASHB-1              PIC X VALUE '/'.
  2092             20  DC-EDITB-DAY          PIC 99.
  2093             20  SLASHB-2              PIC X VALUE '/'.
  2094             20  DC-EDITB-CCYY.
  2095                 24  DC-EDITB-CENT     PIC 99.
  2096                 24  DC-EDITB-YEAR     PIC 99.
  2097         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2098         16  DC-GREG-DATE-CYMD-R REDEFINES
  2099                              DC-GREG-DATE-CYMD.
  2100             20  DC-CYMD-CEN           PIC 99.
  2101             20  DC-CYMD-YEAR          PIC 99.
  2102             20  DC-CYMD-MONTH         PIC 99.
  2103             20  DC-CYMD-DAY           PIC 99.
  2104         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2105         16  DC-GREG-DATE-MDCY-R REDEFINES
  2106                              DC-GREG-DATE-MDCY.
  2107             20  DC-MDCY-MONTH         PIC 99.
  2108             20  DC-MDCY-DAY           PIC 99.
  2109             20  DC-MDCY-CEN           PIC 99.
  2110             20  DC-MDCY-YEAR          PIC 99.
  2111    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2112        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2113    12  DC-EL310-DATE                  PIC X(21).
  2114    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL130.cbl
  2116*    COPY ELCCALC.
  2117******************************************************************
  2118*                                                                *
  2119*                           ELCCALC.                            *
  2120*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2121*                            VMOD=2.025                          *
  2122*                                                                *
  2123*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2124*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2125*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2126*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2127*                                                                *
  2128*  PASSED TO ELRTRM                                              *
  2129*  -----------------                                             *
  2130*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2131*  ORIGINAL TERM                                                 *
  2132*  BEGINNING DATE                                                *
  2133*  ENDING DATE                                                   *
  2134*  COMPANY I.D.                                                  *
  2135*  ACCOUNT MASTER USER FIELD                                     *
  2136*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2137*  FREE LOOK DAYS                                                *
  2138*                                                                *
  2139*  RETURNED FROM ELRTRM                                          *
  2140*  ---------------------                                         *
  2141*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2142*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2143*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2144*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2145*----------------------------------------------------------------*
  2146*  PASSED TO ELRAMT                                              *
  2147*  ----------------                                              *
  2148*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2149*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2150*  ORIGINAL AMOUNT                                               *
  2151*  ALTERNATE BENEFIT (BALLON)                                    *
  2152*  A.P.R. - NET PAY ONLY                                         *
  2153*  METHOD
  2154*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2155*  COMPANY I.D.                                                  *
  2156*  BENEFIT TYPE                                                  *
  2157*                                                                *
  2158*  RETURNED FROM ELRAMT                                          *
  2159*  --------------------                                          *
  2160*  REMAINING AMOUNT 1 - CURRENT                                  *
  2161*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2162*  REMAINING AMOUNT FACTOR
  2163*----------------------------------------------------------------*
  2164*  PASSED TO ELRESV                                              *
  2165*  -----------------                                             *
  2166*  CERTIFICATE EFFECTIVE DATE                                    *
  2167*  VALUATION DATE                                                *
  2168*  PAID THRU DATE                                                *
  2169*  BENEFIT                                                       *
  2170*  INCURRED DATE                                                 *
  2171*  REPORTED DATE                                                 *
  2172*  ISSUE AGE                                                     *
  2173*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL130.cbl
  2174*  CDT PERCENT                                                   *
  2175*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2176* *CLAIM TYPE (LIFE, A/H)                                        *
  2177* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2178* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2179*                                                                *
  2180*  RETURNED FROM ELRESV                                          *
  2181*  --------------------                                          *
  2182*  CDT TABLE USED                                                *
  2183*  CDT FACTOR USED                                               *
  2184*  PAY TO CURRENT RESERVE                                        *
  2185*  I.B.N.R. - A/H ONLY                                           *
  2186*  FUTURE (ACCRUED) AH ONLY                                      *
  2187*----------------------------------------------------------------*
  2188*  PASSED TO ELRATE                                              *
  2189*  ----------------                                              *
  2190*  CERT ISSUE DATE                                               *
  2191*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2192*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2193*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2194*  STATE CODE (CLIENT DEFINED)                                   *
  2195*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2196*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2197*  DEVIATION CODE                                                *
  2198*  ISSUE AGE                                                     *
  2199*  ORIGINAL BENEFIT AMOUNT                                       *
  2200*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2201*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2202*  BENEFIT KIND (LIFE OR A/H)                                    *
  2203*  A.P.R.                                                        *
  2204*  METHOD
  2205*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2206*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2207*  COMPANY I.D. (3 CHARACTER)                                    *
  2208*  BENEFIT CODE                                                  *
  2209*  BENEFIT OVERRIDE CODE                                         *
  2210*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2211*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2212*  JOINT INDICATOR (CSL ONLY)                                    *
  2213*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2214*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2215*                                                                *
  2216*  RETURNED FROM ELRATE                                          *
  2217*  --------------------                                          *
  2218*  CALCULATED PREMIUM                                            *
  2219*  PREMIUM RATE                                                  *
  2220*  MORTALITY CODE                                                *
  2221*  MAX ATTAINED AGE                                              *
  2222*  MAX AGE                                                       *
  2223*  MAX TERM                                                      *
  2224*  MAX MONTHLY BENEFIT                                           *
  2225*  MAX TOTAL BENIFIT                                             *
  2226*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2227*----------------------------------------------------------------*
  2228*  PASSED TO ELRFND                                              *
  2229*  ----------------                                              *
  2230*  CERT ISSUE DATE                                               *
  2231*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL130.cbl
  2232*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2233*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2234*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2235*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2236*  STATE CODE (CLIENT DEFINED)                                   *
  2237*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2238*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2239*  DEVIATION CODE                                                *
  2240*  ISSUE AGE                                                     *
  2241*  ORIGINAL BENEFIT AMOUNT                                       *
  2242*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2243*  PROCESS TYPE (CANCEL)                                         *
  2244*  BENEFIT KIND (LIFE OR A/H)                                    *
  2245*  A.P.R.                                                        *
  2246*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2247*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2248*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2249*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2250*  COMPANY I.D. (3 CHARACTER)                                    *
  2251*  BENEFIT CODE                                                  *
  2252*  BENEFIT OVERRIDE CODE                                         *
  2253*                                                                *
  2254*  RETURNED FROM ELRFND                                          *
  2255*  --------------------                                          *
  2256*  CALCULATED REFUND                                             *
  2257*----------------------------------------------------------------*
  2258*  PASSED TO ELEARN                                              *
  2259*  ----------------                                              *
  2260*  CERT ISSUE DATE                                               *
  2261*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2262*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2263*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2264*  STATE CODE (CLIENT DEFINED)                                   *
  2265*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2266*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2267*  DEVIATION CODE                                                *
  2268*  ISSUE AGE                                                     *
  2269*  ORIGINAL BENEFIT AMOUNT                                       *
  2270*  BENEFIT KIND (LIFE OR A/H)                                    *
  2271*  A.P.R.                                                        *
  2272*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2273*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2274*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2275*  COMPANY I.D. (3 CHARACTER)                                    *
  2276*  BENEFIT CODE                                                  *
  2277*  BENEFIT OVERRIDE CODE                                         *
  2278*                                                                *
  2279*  RETURNED FROM ELEARN                                          *
  2280*  --------------------                                          *
  2281*  INDICATED  EARNINGS                                           *
  2282*----------------------------------------------------------------*
  2283*                 LENGTH = 450                                   *
  2284*                                                                *
  2285******************************************************************
  2286******************************************************************
  2287*                   C H A N G E   L O G
  2288*
  2289* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL130.cbl
  2290*-----------------------------------------------------------------
  2291*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2292* EFFECTIVE    NUMBER
  2293*-----------------------------------------------------------------
  2294* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2295* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2296* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2297* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2298* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2299* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2300* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2301* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2302* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2303******************************************************************
  2304
  2305 01  CALCULATION-PASS-AREA.
  2306     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2307                                     COMP.
  2308
  2309     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2310       88  NO-CP-ERROR                             VALUE ZERO.
  2311       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2312                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2313       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2314       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2315       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2316       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2317       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2318       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2319       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2320       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2321       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2322       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2323       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2324       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2325       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2326       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2327       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2328       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2329       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2330
  2331     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2332       88  NO-CP-ERROR-2                           VALUE ZERO.
  2333***********************  INPUT AREAS ****************************
  2334
  2335     12  CP-CALCULATION-AREA.
  2336         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2337         16  CP-CERT-EFF-DT        PIC XX.
  2338         16  CP-VALUATION-DT       PIC XX.
  2339         16  CP-PAID-THRU-DT       PIC XX.
  2340         16  CP-BENEFIT-TYPE       PIC X.
  2341           88  CP-AH                               VALUE 'A' 'D'
  2342                                                   'I' 'U'.
  2343           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2344           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2345         16  CP-INCURRED-DT        PIC XX.
  2346         16  CP-REPORTED-DT        PIC XX.
  2347         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL130.cbl
  2348         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2349         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2350                                     COMP-3.
  2351         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2352                                     COMP-3.
  2353         16  CP-CDT-METHOD         PIC X.
  2354           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2355           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2356           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2357         16  CP-CLAIM-TYPE         PIC X.
  2358           88  CP-AH-CLAIM                         VALUE 'A'.
  2359           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2360         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2361                                     COMP-3.
  2362         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2363                                     COMP-3.
  2364         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2365                                     COMP-3.
  2366         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2367                                     COMP-3.
  2368         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2369                                     COMP-3.
  2370         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2371                                     COMP-3.
  2372         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2373                                     COMP-3.
  2374         16  CP-REM-TERM-METHOD    PIC X.
  2375           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2376           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2377           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2378           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2379           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2380           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2381           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2382         16  CP-EARNING-METHOD     PIC X.
  2383           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2384           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2385           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2386           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2387           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2388           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2389           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2390           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2391           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2392           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2393           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2394           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2395           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2396           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2397         16  CP-PROCESS-TYPE       PIC X.
  2398           88  CP-CLAIM                            VALUE '1'.
  2399           88  CP-CANCEL                           VALUE '2'.
  2400           88  CP-ISSUE                            VALUE '3'.
  2401         16  CP-SPECIAL-CALC-CD    PIC X.
  2402           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2403           88  CP-1-MTH-INTEREST               VALUE ' '.
  2404           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2405           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL130.cbl
  2406           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2407           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2408           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2409           88  CP-FARM-PLAN                    VALUE 'F'.
  2410           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2411           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2412           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2413           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2414           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2415           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2416           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2417           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2418           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2419           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2420                                                     'W' 'X'.
  2421           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2422           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2423           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2424           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2425           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2426           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2427           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2428           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2429           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2430           88  CP-CSL-METH-1                   VALUE '5'.
  2431           88  CP-CSL-METH-2                   VALUE '6'.
  2432           88  CP-CSL-METH-3                   VALUE '7'.
  2433           88  CP-CSL-METH-4                   VALUE '8'.
  2434
  2435         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2436                                     COMP-3.
  2437         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2438         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2439         16  CP-STATE              PIC XX          VALUE SPACE.
  2440         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2441         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2442           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2443               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2444         16  CP-R78-OPTION         PIC X.
  2445           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2446           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2447
  2448         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2449         16  CP-IBNR-RESERVE-SW    PIC X.
  2450         16  CP-CLAIM-STATUS       PIC X.
  2451         16  CP-RATE-FILE          PIC X.
  2452         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2453                                     COMP-3.
  2454
  2455         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2456         16  CP-AH-OVERRIDE-CODE   PIC X.
  2457
  2458         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2459                                     COMP-3.
  2460         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2461                                   PIC S9(5)V99 COMP-3.
  2462         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2463                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL130.cbl
  2464         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2465                                     COMP-3.
  2466         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2467                                     COMP-3.
  2468         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2469                                  PIC S9(7)V99 COMP-3.
  2470
  2471         16  CP-PAID-FROM-DATE     PIC X(02).
  2472         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2473         16  CP-EXT-DAYS-CALC      PIC X.
  2474           88  CP-EXT-NO-CHG                   VALUE ' '.
  2475           88  CP-EXT-CHG-LF                   VALUE '1'.
  2476           88  CP-EXT-CHG-AH                   VALUE '2'.
  2477           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2478         16  CP-DOMICILE-STATE     PIC XX.
  2479         16  CP-CARRIER            PIC X.
  2480         16  CP-REIN-FLAG          PIC X.
  2481         16  CP-REM-TRM-CALC-OPTION PIC X.
  2482           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2483                      '2' '3' '4' '5'.
  2484           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2485           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2486           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2487           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2488           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2489           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2490           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2491           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2492         16  CP-SIG-SWITCH         PIC X.
  2493         16  CP-RATING-METHOD      PIC X.
  2494           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2495           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2496           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2497           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2498           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2499           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2500           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2501           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2502           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2503         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2504                                     COMP-3.
  2505         16  CP-BEN-CATEGORY       PIC X.
  2506         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2507         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2508                                   PIC S99V9(5) COMP-3.
  2509         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2510         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2511                                   PIC S99V9(5) COMP-3.
  2512         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2513         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2514         16  CP-EXPIRE-DT          PIC XX.
  2515         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2516         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2517         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2518         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2519         16  CP-DDF-SPEC-CALC      PIC X.
  2520             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2521             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL130.cbl
  2522         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2523         16  CP-CANCEL-REASON      PIC X.
  2524         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2525         16  CP-PMT-MODE           PIC X.
  2526         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2527         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2528         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2529         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2530         16  FILLER                PIC X.
  2531
  2532***************    OUTPUT FROM ELRESV   ************************
  2533
  2534         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2535
  2536         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2537                                     COMP-3.
  2538         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2539                                     COMP-3.
  2540         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2541                                     COMP-3.
  2542         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2543                                     COMP-3.
  2544         16  FILLER                PIC X(09).
  2545***************    OUTPUT FROM ELRTRM   *************************
  2546
  2547         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2548                                     COMP-3.
  2549         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2550                                     COMP-3.
  2551         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2552                                     COMP-3.
  2553         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2554                                     COMP-3.
  2555         16  FILLER                PIC X(12).
  2556
  2557***************    OUTPUT FROM ELRAMT   *************************
  2558
  2559         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2560                                     COMP-3.
  2561         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2562                                     COMP-3.
  2563         16  FILLER                PIC X(12).
  2564
  2565***************    OUTPUT FROM ELRATE   *************************
  2566
  2567         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2568                                     COMP-3.
  2569         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2570                                     COMP-3.
  2571         16  CP-MORTALITY-CODE     PIC X(4).
  2572         16  CP-RATE-EDIT-FLAG     PIC X.
  2573             88  CP-RATES-NEED-APR                  VALUE '1'.
  2574         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2575                                     COMP-3.
  2576         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2577         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2578         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2579                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL130.cbl
  2580         16  FILLER                PIC X(07).
  2581
  2582***************    OUTPUT FROM ELRFND   *************************
  2583
  2584         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2585                                     COMP-3.
  2586         16  CP-REFUND-TYPE-USED   PIC X.
  2587           88  CP-R-AS-R78                         VALUE '1'.
  2588           88  CP-R-AS-PRORATA                     VALUE '2'.
  2589           88  CP-R-AS-CALIF                       VALUE '3'.
  2590           88  CP-R-AS-TEXAS                       VALUE '4'.
  2591           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2592           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2593           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2594           88  CP-R-AS-MEAN                        VALUE '8'.
  2595           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2596           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2597           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2598           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2599           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2600           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2601         16  FILLER                PIC X(12).
  2602
  2603***************    OUTPUT FROM ELEARN   *************************
  2604
  2605         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2606                                     COMP-3.
  2607         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2608                                     COMP-3.
  2609         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2610                                     COMP-3.
  2611         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2612                                     COMP-3.
  2613         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2614                                     COMP-3.
  2615         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2616                                     COMP-3.
  2617         16  CP-EARNING-TYPE-USED  PIC X.
  2618           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2619           88  CP-E-AS-R78                         VALUE '1'.
  2620           88  CP-E-AS-PRORATA                     VALUE '2'.
  2621           88  CP-E-AS-TEXAS                       VALUE '4'.
  2622           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2623           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2624           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2625           88  CP-E-AS-MEAN                        VALUE '8'.
  2626           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2627         16  FILLER                PIC X(12).
  2628
  2629***************    OUTPUT FROM ELPMNT   *************************
  2630
  2631         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2632                                     COMP-3.
  2633         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2634                                     COMP-3.
  2635         16  FILLER                PIC X(12).
  2636
  2637***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL130.cbl
  2638         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2639                                     COMP-3.
  2640         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2641                                     COMP-3.
  2642         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2643                                     COMP-3.
  2644         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2645                                     COMP-3.
  2646         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2647                                     COMP-3.
  2648         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2649                                     COMP-3.
  2650         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2651             88  OPEN-RATE-FILE                   VALUE 'O'.
  2652             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2653             88  IO-ERROR                         VALUE 'E'.
  2654
  2655         16  CP-FIRST-PAY-DATE     PIC XX.
  2656
  2657         16  CP-JOINT-INDICATOR    PIC X.
  2658
  2659         16  CP-RESERVE-REMAINING-TERM
  2660                                   PIC S9(4)V9    VALUE ZERO
  2661                                     COMP-3.
  2662
  2663         16  CP-INSURED-BIRTH-DT   PIC XX.
  2664
  2665         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2666                                     COMP-3.
  2667
  2668         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2669                                     COMP-3.
  2670
  2671         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2672                                     COMP-3.
  2673
  2674         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2675                                     COMP-3.
  2676
  2677         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2678                                     COMP-3.
  2679
  2680         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2681                                     COMP-3.
  2682
  2683         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2684                                     COMP-3.
  2685
  2686         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2687             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2688
  2689         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2690                                     COMP-3.
  2691         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2692                                     COMP-3.
  2693         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  2694         16  FILLER                PIC X(15).
  2695******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL130.cbl
  2697*    COPY ELCLOGOF.
  2698******************************************************************
  2699*                                                                *
  2700*                                                                *
  2701*                            ELCLOGOF.                           *
  2702*                            VMOD=2.001                          *
  2703*                                                                *
  2704*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2705*                                                                *
  2706******************************************************************
  2707 01  CLASIC-LOGOFF.
  2708     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2709     12  LOGOFF-TEXT.
  2710         16  FILLER          PIC X(5)    VALUE SPACES.
  2711         16  LOGOFF-MSG.
  2712             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2713             20  FILLER      PIC X       VALUE SPACES.
  2714             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2715         16  FILLER          PIC X(80)
  2716           VALUE '* YOU ARE NOW LOGGED OFF'.
  2717         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2718         16  FILLER          PIC X       VALUE QUOTE.
  2719         16  LOGOFF-SYS-MSG  PIC X(17)
  2720           VALUE 'S CLAS-IC SYSTEM '.
  2721     12  TEXT-MESSAGES.
  2722         16  UNACCESS-MSG    PIC X(29)
  2723             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2724         16  PGMIDERR-MSG    PIC X(17)
  2725             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL130.cbl
  2727*    COPY ELCATTR.
  2728******************************************************************
  2729*                                                                *
  2730*                            ELCATTR.                            *
  2731*                            VMOD=2.001                          *
  2732*                                                                *
  2733*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2734*                                                                *
  2735*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2736*                                                                *
  2737*                   POS 1   P=PROTECTED                          *
  2738*                           U=UNPROTECTED                        *
  2739*                           S=ASKIP                              *
  2740*                   POS 2   A=ALPHA/NUMERIC                      *
  2741*                           N=NUMERIC                            *
  2742*                   POS 3   N=NORMAL                             *
  2743*                           B=BRIGHT                             *
  2744*                           D=DARK                               *
  2745*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2746*                           OF=MODIFIED DATA TAG OFF             *
  2747*                                                                *
  2748*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2749******************************************************************
  2750 01  ATTRIBUTE-LIST.
  2751     12  AL-PABOF            PIC X       VALUE 'Y'.
  2752     12  AL-PABON            PIC X       VALUE 'Z'.
  2753     12  AL-PADOF            PIC X       VALUE '%'.
  2754     12  AL-PADON            PIC X       VALUE '_'.
  2755     12  AL-PANOF            PIC X       VALUE '-'.
  2756     12  AL-PANON            PIC X       VALUE '/'.
  2757     12  AL-SABOF            PIC X       VALUE '8'.
  2758     12  AL-SABON            PIC X       VALUE '9'.
  2759     12  AL-SADOF            PIC X       VALUE '@'.
  2760     12  AL-SADON            PIC X       VALUE QUOTE.
  2761     12  AL-SANOF            PIC X       VALUE '0'.
  2762     12  AL-SANON            PIC X       VALUE '1'.
  2763     12  AL-UABOF            PIC X       VALUE 'H'.
  2764     12  AL-UABON            PIC X       VALUE 'I'.
  2765     12  AL-UADOF            PIC X       VALUE '<'.
  2766     12  AL-UADON            PIC X       VALUE '('.
  2767     12  AL-UANOF            PIC X       VALUE ' '.
  2768     12  AL-UANON            PIC X       VALUE 'A'.
  2769     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2770     12  AL-UNBON            PIC X       VALUE 'R'.
  2771     12  AL-UNDOF            PIC X       VALUE '*'.
  2772     12  AL-UNDON            PIC X       VALUE ')'.
  2773     12  AL-UNNOF            PIC X       VALUE '&'.
  2774     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL130.cbl
  2776*    COPY ELCEMIB.
  2777******************************************************************
  2778*                                                                *
  2779*                                                                *
  2780*                            ELCEMIB.                            *
  2781*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2782*                            VMOD=2.005                          *
  2783*                                                                *
  2784*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2785*                                                                *
  2786******************************************************************
  2787 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2788     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2789     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2790     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2791     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2792     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2793     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2794     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2795     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2796     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2797         88  EMI-NO-ERRORS                    VALUE '1'.
  2798         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2799         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2800     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2801         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2802     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2803         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2804         88  EMI-AREA1-FULL                   VALUE '2'.
  2805     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2806         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2807         88  EMI-AREA2-FULL                   VALUE '2'.
  2808     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2809         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2810         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2811         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2812         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2813         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2814     12  EMI-ERROR-LINES.
  2815         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2816         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2817         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2818         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2819             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2820                 24  EMI-ERR-NUM         PIC X(4).
  2821                 24  EMI-FILLER          PIC X.
  2822                 24  EMI-SEV             PIC X.
  2823                 24  FILLER              PIC X.
  2824             20  FILLER                  PIC X(02).
  2825     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2826         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2827             20  EMI-ERROR-NUMBER    PIC X(4).
  2828             20  EMI-FILL            PIC X.
  2829             20  EMI-SEVERITY        PIC X.
  2830             20  FILLER              PIC X.
  2831             20  EMI-ERROR-TEXT.
  2832                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2833                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL130.cbl
  2834     12  EMI-SEVERITY-SAVE           PIC X.
  2835         88  EMI-NOTE                    VALUE 'N'.
  2836         88  EMI-WARNING                 VALUE 'W'.
  2837         88  EMI-FORCABLE                VALUE 'F'.
  2838         88  EMI-FATAL                   VALUE 'X'.
  2839     12  EMI-MESSAGE-FLAG            PIC X.
  2840         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2841         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2842     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2843     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2844         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2845         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2846         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2847     12  FILLER                      PIC X(137)  VALUE SPACES.
  2848     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2849     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2850     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2851     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL130.cbl
  2853*    COPY ELCJPFX.
  2854******************************************************************
  2855*                                                                *
  2856*                                                                *
  2857*                            ELCJPFX.                            *
  2858*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2859*                            VMOD=2.002                          *
  2860*                                                                *
  2861*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2862*                                                                *
  2863*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2864*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2865*        ELCNTL - CONTROL FILE                                   *
  2866*        ELMSTR - CLAIM MASTERS                                  *
  2867*        ELTRLR - ACTIVITY TRAILERS                              *
  2868*        ELCHKQ - CHECK QUE                                      *
  2869******************************************************************
  2870 01  JOURNAL-RECORD.
  2871     12  JP-USER-ID                  PIC X(4).
  2872     12  JP-FILE-ID                  PIC X(8).
  2873     12  JP-PROGRAM-ID               PIC X(8).
  2874     12  JP-RECORD-TYPE              PIC X.
  2875         88 JP-ADD              VALUE 'A'.
  2876         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2877         88 JP-AFTER-CHANGE     VALUE 'C'.
  2878         88 JP-DELETE           VALUE 'D'.
  2879         88 JP-GENERIC-DELETE   VALUE 'G'.
  2880         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2881         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2882     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2883     12  JP-RECORD-AREA
  2884
  2885
  2886         PIC X(512).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL130.cbl
  2888*    COPY ELCAID.
  2889******************************************************************
  2890*                                                                *
  2891*                            ELCAID.                             *
  2892*                            VMOD=2.001                          *
  2893*                                                                *
  2894*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2895*                                                                *
  2896*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2897*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2898******************************************************************
  2899
  2900 01  DFHAID.
  2901   02  DFHNULL   PIC  X  VALUE  ' '.
  2902   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2903   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2904   02  DFHPEN    PIC  X  VALUE  '='.
  2905   02  DFHOPID   PIC  X  VALUE  'W'.
  2906   02  DFHPA1    PIC  X  VALUE  '%'.
  2907   02  DFHPA2    PIC  X  VALUE  '>'.
  2908   02  DFHPA3    PIC  X  VALUE  ','.
  2909   02  DFHPF1    PIC  X  VALUE  '1'.
  2910   02  DFHPF2    PIC  X  VALUE  '2'.
  2911   02  DFHPF3    PIC  X  VALUE  '3'.
  2912   02  DFHPF4    PIC  X  VALUE  '4'.
  2913   02  DFHPF5    PIC  X  VALUE  '5'.
  2914   02  DFHPF6    PIC  X  VALUE  '6'.
  2915   02  DFHPF7    PIC  X  VALUE  '7'.
  2916   02  DFHPF8    PIC  X  VALUE  '8'.
  2917   02  DFHPF9    PIC  X  VALUE  '9'.
  2918   02  DFHPF10   PIC  X  VALUE  ':'.
  2919   02  DFHPF11   PIC  X  VALUE  '#'.
  2920   02  DFHPF12   PIC  X  VALUE  '@'.
  2921   02  DFHPF13   PIC  X  VALUE  'A'.
  2922   02  DFHPF14   PIC  X  VALUE  'B'.
  2923   02  DFHPF15   PIC  X  VALUE  'C'.
  2924   02  DFHPF16   PIC  X  VALUE  'D'.
  2925   02  DFHPF17   PIC  X  VALUE  'E'.
  2926   02  DFHPF18   PIC  X  VALUE  'F'.
  2927   02  DFHPF19   PIC  X  VALUE  'G'.
  2928   02  DFHPF20   PIC  X  VALUE  'H'.
  2929   02  DFHPF21   PIC  X  VALUE  'I'.
  2930*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2931   02  DFHPF22   PIC  X  VALUE  '['.
  2932   02  DFHPF23   PIC  X  VALUE  '.'.
  2933   02  DFHPF24   PIC  X  VALUE  '<'.
  2934   02  DFHMSRE   PIC  X  VALUE  'X'.
  2935   02  DFHSTRF   PIC  X  VALUE  'h'.
  2936   02  DFHTRIG   PIC  X  VALUE  '"'.
  2937
  2938 01  FILLER    REDEFINES DFHAID.
  2939     12  FILLER              PIC X(8).
  2940     12  PF-VALUES           PIC X       OCCURS 12.
  2941
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL130.cbl
  2943****************************************************************
  2944*
  2945* Copyright (c) 2007 by Clerity Solutions, Inc.
  2946* All rights reserved.
  2947*
  2948****************************************************************
  2949 01  DFHEIV.
  2950   02  DFHEIV0               PIC X(35).
  2951   02  DFHEIV1               PIC X(08).
  2952   02  DFHEIV2               PIC X(08).
  2953   02  DFHEIV3               PIC X(08).
  2954   02  DFHEIV4               PIC X(06).
  2955   02  DFHEIV5               PIC X(04).
  2956   02  DFHEIV6               PIC X(04).
  2957   02  DFHEIV7               PIC X(02).
  2958   02  DFHEIV8               PIC X(02).
  2959   02  DFHEIV9               PIC X(01).
  2960   02  DFHEIV10              PIC S9(7) COMP-3.
  2961   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2962   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2963   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2964   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2965   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2966   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2967   02  DFHEIV17              PIC X(04).
  2968   02  DFHEIV18              PIC X(04).
  2969   02  DFHEIV19              PIC X(04).
  2970   02  DFHEIV20              USAGE IS POINTER.
  2971   02  DFHEIV21              USAGE IS POINTER.
  2972   02  DFHEIV22              USAGE IS POINTER.
  2973   02  DFHEIV23              USAGE IS POINTER.
  2974   02  DFHEIV24              USAGE IS POINTER.
  2975   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2976   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2977   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2978   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2979   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2980   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2981   02  FILLER                PIC X(02).
  2982   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2983   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2984   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2985   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2986   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2987 LINKAGE  SECTION.
  2988*****************************************************************
  2989*                                                               *
  2990* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2991* All rights reserved.                                          *
  2992*                                                               *
  2993*****************************************************************
  2994 01  dfheiblk.
  2995     02  eibtime          pic s9(7) comp-3.
  2996     02  eibdate          pic s9(7) comp-3.
  2997     02  eibtrnid         pic x(4).
  2998     02  eibtaskn         pic s9(7) comp-3.
  2999     02  eibtrmid         pic x(4).
  3000     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL130.cbl
  3001     02  eibcposn         pic s9(4) comp.
  3002     02  eibcalen         pic s9(4) comp.
  3003     02  eibaid           pic x(1).
  3004     02  eibfiller1       pic x(1).
  3005     02  eibfn            pic x(2).
  3006     02  eibfiller2       pic x(2).
  3007     02  eibrcode         pic x(6).
  3008     02  eibfiller3       pic x(2).
  3009     02  eibds            pic x(8).
  3010     02  eibreqid         pic x(8).
  3011     02  eibrsrce         pic x(8).
  3012     02  eibsync          pic x(1).
  3013     02  eibfree          pic x(1).
  3014     02  eibrecv          pic x(1).
  3015     02  eibsend          pic x(1).
  3016     02  eibatt           pic x(1).
  3017     02  eibeoc           pic x(1).
  3018     02  eibfmh           pic x(1).
  3019     02  eibcompl         pic x(1).
  3020     02  eibsig           pic x(1).
  3021     02  eibconf          pic x(1).
  3022     02  eiberr           pic x(1).
  3023     02  eibrldbk         pic x(1).
  3024     02  eiberrcd         pic x(4).
  3025     02  eibsynrb         pic x(1).
  3026     02  eibnodat         pic x(1).
  3027     02  eibfiller5       pic x(2).
  3028     02  eibresp          pic 9(09) comp.
  3029     02  eibresp2         pic 9(09) comp.
  3030     02  dfheigdj         pic s9(4) comp.
  3031     02  dfheigdk         pic s9(4) comp.
  3032
  3033 01  DFHCOMMAREA             PIC X(1024).
  3034
  3035*01 PARMLIST .
  3036*    02  FILLER              PIC S9(8)   COMP.
  3037*    02  ELMSTR-POINTER      PIC S9(8)   COMP.
  3038*    02  ELCNTL-POINTER      PIC S9(8)   COMP.
  3039*    02  ELCERT-POINTER      PIC S9(8)   COMP.
  3040*    02  ERACCT-POINTER      PIC S9(8)   COMP.
  3041*    02  ELTRLR-POINTER      PIC S9(8)   COMP.
  3042*    02  ELBENE-POINTER      PIC S9(8)   COMP.
  3043*    02  ELACTQ-POINTER      PIC S9(8)   COMP.
  3044*    02  ELARCH-POINTER      PIC S9(8)   COMP.
  3045*    02  ERREIN-POINTER      PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL130.cbl
  3047*    COPY ELCMSTR.
  3048******************************************************************
  3049*                                                                *
  3050*                            ELCMSTR.                            *
  3051*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3052*                            VMOD=2.012                          *
  3053*                                                                *
  3054*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3055*                                                                *
  3056*   FILE TYPE = VSAM,KSDS                                        *
  3057*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3058*                                                                *
  3059*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3060*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3061*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3062*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3063*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3064*                                                 RKP=75,LEN=21  *
  3065*                                                                *
  3066*   **** NOTE ****                                               *
  3067*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3068*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3069*                                                                *
  3070*   LOG = YES                                                    *
  3071*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3072******************************************************************
  3073*                   C H A N G E   L O G
  3074*
  3075* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3076*-----------------------------------------------------------------
  3077*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3078* EFFECTIVE    NUMBER
  3079*-----------------------------------------------------------------
  3080* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3081* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3082******************************************************************
  3083 01  CLAIM-MASTER.
  3084     12  CL-RECORD-ID                PIC XX.
  3085         88  VALID-CL-ID         VALUE 'CL'.
  3086
  3087     12  CL-CONTROL-PRIMARY.
  3088         16  CL-COMPANY-CD           PIC X.
  3089         16  CL-CARRIER              PIC X.
  3090         16  CL-CLAIM-NO             PIC X(7).
  3091         16  CL-CERT-NO.
  3092             20  CL-CERT-PRIME       PIC X(10).
  3093             20  CL-CERT-SFX         PIC X.
  3094
  3095     12  CL-CONTROL-BY-NAME.
  3096         16  CL-COMPANY-CD-A1        PIC X.
  3097         16  CL-INSURED-LAST-NAME    PIC X(15).
  3098         16  CL-INSURED-NAME.
  3099             20  CL-INSURED-1ST-NAME PIC X(12).
  3100             20  CL-INSURED-MID-INIT PIC X.
  3101
  3102     12  CL-CONTROL-BY-SSN.
  3103         16  CL-COMPANY-CD-A2        PIC X.
  3104         16  CL-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL130.cbl
  3105             20  CL-SSN-STATE        PIC XX.
  3106             20  CL-SSN-ACCOUNT      PIC X(6).
  3107             20  CL-SSN-LN3          PIC X(3).
  3108
  3109     12  CL-CONTROL-BY-CERT-NO.
  3110         16  CL-COMPANY-CD-A4        PIC X.
  3111         16  CL-CERT-NO-A4.
  3112             20  CL-CERT-A4-PRIME    PIC X(10).
  3113             20  CL-CERT-A4-SFX      PIC X.
  3114
  3115     12  CL-CONTROL-BY-CCN.
  3116         16  CL-COMPANY-CD-A5        PIC X.
  3117         16  CL-CCN-A5.
  3118             20  CL-CCN.
  3119                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3120                 24  CL-CCN-PRIME-A5 PIC X(12).
  3121             20  CL-CCN-FILLER-A5    PIC X(4).
  3122
  3123     12  CL-INSURED-PROFILE-DATA.
  3124         16  CL-INSURED-BIRTH-DT     PIC XX.
  3125         16  CL-INSURED-SEX-CD       PIC X.
  3126             88  INSURED-IS-MALE        VALUE 'M'.
  3127             88  INSURED-IS-FEMALE      VALUE 'F'.
  3128             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3129         16  CL-INSURED-OCC-CD       PIC X(6).
  3130         16  FILLER                  PIC X(5).
  3131
  3132     12  CL-PROCESSING-INFO.
  3133         16  CL-PROCESSOR-ID         PIC X(4).
  3134         16  CL-CLAIM-STATUS         PIC X.
  3135             88  CLAIM-IS-OPEN          VALUE 'O'.
  3136             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3137         16  CL-CLAIM-TYPE           PIC X.
  3138*            88  AH-CLAIM               VALUE 'A'.
  3139*            88  LIFE-CLAIM             VALUE 'L'.
  3140*            88  PROPERTY-CLAIM         VALUE 'P'.
  3141*            88  IUI-CLAIM              VALUE 'I'.
  3142*            88  GAP-CLAIM              VALUE 'G'.
  3143         16  CL-CLAIM-PREM-TYPE      PIC X.
  3144             88  SINGLE-PREMIUM         VALUE '1'.
  3145             88  O-B-COVERAGE           VALUE '2'.
  3146             88  OPEN-END-COVERAGE      VALUE '3'.
  3147         16  CL-INCURRED-DT          PIC XX.
  3148         16  CL-REPORTED-DT          PIC XX.
  3149         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3150         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3151         16  CL-LAST-PMT-DT          PIC XX.
  3152         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3153         16  CL-PAID-THRU-DT         PIC XX.
  3154         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3155         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3156         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3157         16  CL-PMT-CALC-METHOD      PIC X.
  3158             88  CL-360-DAY-YR          VALUE '1'.
  3159             88  CL-365-DAY-YR          VALUE '2'.
  3160             88  CL-FULL-MONTHS         VALUE '3'.
  3161         16  CL-CAUSE-CD             PIC X(6).
  3162
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL130.cbl
  3163         16  CL-PRIME-CERT-NO.
  3164             20  CL-PRIME-CERT-PRIME PIC X(10).
  3165             20  CL-PRIME-CERT-SFX   PIC X.
  3166
  3167         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3168             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3169             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3170
  3171         16  CL-MICROFILM-NO         PIC X(10).
  3172         16  CL-PROG-FORM-TYPE       PIC X.
  3173         16  CL-LAST-ADD-ON-DT       PIC XX.
  3174
  3175         16  CL-LAST-REOPEN-DT       PIC XX.
  3176         16  CL-LAST-CLOSE-DT        PIC XX.
  3177         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3178             88  FINAL-PAID             VALUE '1'.
  3179             88  CLAIM-DENIED           VALUE '2'.
  3180             88  AUTO-CLOSE             VALUE '3'.
  3181             88  MANUAL-CLOSE           VALUE '4'.
  3182             88  BENEFITS-CHANGED       VALUE 'C'.
  3183             88  SETUP-ERRORS           VALUE 'E'.
  3184         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3185         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3186         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3187             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3188         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3189         16  FILLER                  PIC X.
  3190
  3191     12  CL-CERTIFICATE-DATA.
  3192         16  CL-CERT-ORIGIN          PIC X.
  3193             88  CERT-WAS-ONLINE        VALUE '1'.
  3194             88  CERT-WAS-CREATED       VALUE '2'.
  3195             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3196         16  CL-CERT-KEY-DATA.
  3197             20  CL-CERT-CARRIER     PIC X.
  3198             20  CL-CERT-GROUPING    PIC X(6).
  3199             20  CL-CERT-STATE       PIC XX.
  3200             20  CL-CERT-ACCOUNT.
  3201                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3202                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3203             20  CL-CERT-EFF-DT      PIC XX.
  3204
  3205     12  CL-STATUS-CONTROLS.
  3206         16  CL-PRIORITY-CD          PIC X.
  3207             88  CONFIDENTIAL-DATA      VALUE '8'.
  3208             88  HIGHEST-PRIORITY       VALUE '9'.
  3209         16  CL-SUPV-ATTN-CD         PIC X.
  3210             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3211             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3212         16  CL-PURGED-DT            PIC XX.
  3213         16  CL-RESTORED-DT          PIC XX.
  3214         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3215         16  CL-NEXT-RESEND-DT       PIC XX.
  3216         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3217         16  FILLER                  PIC XX.
  3218         16  CL-LAST-MAINT-DT        PIC XX.
  3219         16  CL-LAST-MAINT-USER      PIC X(4).
  3220         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL130.cbl
  3221         16  CL-LAST-MAINT-TYPE      PIC X.
  3222             88  CLAIM-SET-UP           VALUE ' '.
  3223             88  PAYMENT-MADE           VALUE '1'.
  3224             88  LETTER-SENT            VALUE '2'.
  3225             88  MASTER-WAS-ALTERED     VALUE '3'.
  3226             88  MASTER-WAS-RESTORED    VALUE '4'.
  3227             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3228             88  FILE-CONVERTED         VALUE '6'.
  3229             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3230             88  ERROR-CORRECTION       VALUE 'E'.
  3231         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3232         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3233         16  CL-BENEFICIARY          PIC X(10).
  3234         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3235         16  CL-DENIAL-TYPE          PIC X.
  3236             88  CL-TYPE-DENIAL          VALUE '1'.
  3237             88  CL-TYPE-RESCISSION      VALUE '2'.
  3238             88  CL-TYPE-REFORMATION     VALUE '3'.
  3239             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3240             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3241         16  FILLER                  PIC X(5).
  3242
  3243     12  CL-TRAILER-CONTROLS.
  3244         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3245             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3246             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3247             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3248         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3249         16  FILLER                  PIC XX.
  3250         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3251         16  CL-ADDRESS-TRAILER-CNT.
  3252             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3253                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3254             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3255                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3256             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3257                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3258             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3259                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3260             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3261                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3262             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3263                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3264             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3265                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3266
  3267     12  CL-CV-REFERENCE-NO.
  3268         16  CL-CV-REFNO-PRIME       PIC X(18).
  3269         16  CL-CV-REFNO-SFX         PIC XX.
  3270
  3271     12  CL-FILE-LOCATION            PIC X(4).
  3272
  3273     12  CL-PROCESS-ERRORS.
  3274         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3275             88  NO-FATAL-ERRORS        VALUE ZERO.
  3276         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3277             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3278
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL130.cbl
  3279     12  CL-PRODUCT-CD               PIC X.
  3280
  3281     12  CL-CURRENT-KEY-DATA.
  3282         16  CL-CURRENT-CARRIER      PIC X.
  3283         16  CL-CURRENT-GROUPING     PIC X(6).
  3284         16  CL-CURRENT-STATE        PIC XX.
  3285         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3286
  3287     12  CL-ASSOCIATES               PIC X.
  3288         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3289         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3290         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3291         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3292
  3293     12  CL-ACTIVITY-CODE            PIC 99.
  3294     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3295     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3296
  3297     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3298     12  CL-LAG-REPORT-CODE          PIC 9.
  3299     12  CL-LOAN-TYPE                PIC XX.
  3300     12  CL-LEGAL-STATE              PIC XX.
  3301
  3302*    12  FILLER                      PIC X(5).
  3303     12  CL-YESNOSW                  PIC X.
  3304     12  FILLER                      PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL130.cbl
  3306*    COPY ELCCNTL.
  3307******************************************************************
  3308*                                                                *
  3309*                                                                *
  3310*                            ELCCNTL.                            *
  3311*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3312*                            VMOD=2.059                          *
  3313*                                                                *
  3314*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3315*                                                                *
  3316*   FILE TYPE = VSAM,KSDS                                        *
  3317*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3318*                                                                *
  3319*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3320*       ALTERNATE INDEX = NONE                                   *
  3321*                                                                *
  3322*   LOG = YES                                                    *
  3323*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3324******************************************************************
  3325*                   C H A N G E   L O G
  3326*
  3327* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3328*-----------------------------------------------------------------
  3329*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3330* EFFECTIVE    NUMBER
  3331*-----------------------------------------------------------------
  3332* 082503                   PEMA  ADD BENEFIT GROUP
  3333* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3334* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3335* 092705    2005050300006  PEMA  ADD SPP LEASES
  3336* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3337* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3338* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3339* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3340* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3341******************************************************************
  3342*
  3343 01  CONTROL-FILE.
  3344     12  CF-RECORD-ID                       PIC XX.
  3345         88  VALID-CF-ID                        VALUE 'CF'.
  3346
  3347     12  CF-CONTROL-PRIMARY.
  3348         16  CF-COMPANY-ID                  PIC XXX.
  3349         16  CF-RECORD-TYPE                 PIC X.
  3350             88  CF-COMPANY-MASTER              VALUE '1'.
  3351             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3352             88  CF-STATE-MASTER                VALUE '3'.
  3353             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3354             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3355             88  CF-CARRIER-MASTER              VALUE '6'.
  3356             88  CF-MORTALITY-MASTER            VALUE '7'.
  3357             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3358             88  CF-TERMINAL-MASTER             VALUE '9'.
  3359             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3360             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3361             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3362             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3363             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL130.cbl
  3364             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3365             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3366             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3367             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3368         16  CF-ACCESS-CD-GENL              PIC X(4).
  3369         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3370             20  CF-PROCESSOR               PIC X(4).
  3371         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3372             20  CF-STATE-CODE              PIC XX.
  3373             20  FILLER                     PIC XX.
  3374         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3375             20  FILLER                     PIC XX.
  3376             20  CF-HI-BEN-IN-REC           PIC XX.
  3377         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3378             20  FILLER                     PIC XXX.
  3379             20  CF-CARRIER-CNTL            PIC X.
  3380         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3381             20  FILLER                     PIC XX.
  3382             20  CF-HI-TYPE-IN-REC          PIC 99.
  3383         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3384             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3385                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3386             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3387             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3388         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3389             20  FILLER                     PIC X.
  3390             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3391         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3392             20  FILLER                     PIC XX.
  3393             20  CF-MORTGAGE-PLAN           PIC XX.
  3394         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3395
  3396     12  CF-LAST-MAINT-DT                   PIC XX.
  3397     12  CF-LAST-MAINT-BY                   PIC X(4).
  3398     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3399
  3400     12  CF-RECORD-BODY                     PIC X(728).
  3401
  3402
  3403****************************************************************
  3404*             COMPANY MASTER RECORD                            *
  3405****************************************************************
  3406
  3407     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3408         16  CF-COMPANY-ADDRESS.
  3409             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3410             20  CF-CL-IN-CARE-OF           PIC X(30).
  3411             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3412             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3413             20  CF-CL-CITY-STATE           PIC X(30).
  3414             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3415             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3416         16  CF-COMPANY-CD                  PIC X.
  3417         16  CF-COMPANY-PASSWORD            PIC X(8).
  3418         16  CF-SECURITY-OPTION             PIC X.
  3419             88  ALL-SECURITY                   VALUE '1'.
  3420             88  COMPANY-VERIFY                 VALUE '2'.
  3421             88  PROCESSOR-VERIFY               VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL130.cbl
  3422             88  NO-SECURITY                    VALUE '4'.
  3423             88  ALL-BUT-TERM                   VALUE '5'.
  3424         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3425             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3426         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3427             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3428         16  CF-INFORCE-LOCATION            PIC X.
  3429             88  CERTS-ARE-ONLINE               VALUE '1'.
  3430             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3431             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3432         16  CF-LOWER-CASE-LETTERS          PIC X.
  3433         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3434             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3435             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3436             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3437             88  CF-ACCNT-CNTL                  VALUE '3'.
  3438             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3439
  3440         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3441         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3442
  3443         16  CF-LGX-CREDIT-USER             PIC X.
  3444             88  CO-IS-NOT-USER                 VALUE 'N'.
  3445             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3446
  3447         16 CF-CREDIT-CALC-CODES.
  3448             20  CF-CR-REM-TERM-CALC PIC X.
  3449               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3450               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3451               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3452               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3453               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3454               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3455               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3456             20  CF-CR-R78-METHOD           PIC X.
  3457               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3458               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3459
  3460         16  CF-CLAIM-CONTROL-COUNTS.
  3461             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3462                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3463
  3464             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3465                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3466
  3467             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3468                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3469
  3470             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3471                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3472
  3473         16  CF-CURRENT-MONTH-END           PIC XX.
  3474
  3475         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3476             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3477             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3478             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3479             20  CF-CO-CLAIM-REJECT-SW      PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL130.cbl
  3480                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3481                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3482             20  CF-CO-PREM-REJECT-SW       PIC X.
  3483                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3484                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3485             20  CF-CO-REF-REJECT-SW        PIC X.
  3486                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3487                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3488
  3489         16  CF-CO-REPORTING-DT             PIC XX.
  3490         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3491         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3492           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3493           88  CF-CO-MONTH-END                  VALUE '1'.
  3494
  3495         16  CF-LGX-CLAIM-USER              PIC X.
  3496             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3497             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3498
  3499         16  CF-CREDIT-EDIT-CONTROLS.
  3500             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3501             20  CF-MIN-AGE                 PIC 99.
  3502             20  CF-DEFAULT-AGE             PIC 99.
  3503             20  CF-MIN-TERM                PIC S999      COMP-3.
  3504             20  CF-MAX-TERM                PIC S999      COMP-3.
  3505             20  CF-DEFAULT-SEX             PIC X.
  3506             20  CF-JOINT-AGE-INPUT         PIC X.
  3507                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3508             20  CF-BIRTH-DATE-INPUT        PIC X.
  3509                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3510             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3511                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3512                 88  CF-ZERO-CARRIER            VALUE '1'.
  3513                 88  CF-ZERO-GROUPING           VALUE '2'.
  3514                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3515             20  CF-EDIT-SW                 PIC X.
  3516                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3517             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3518             20  CF-CR-PR-METHOD            PIC X.
  3519               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3520               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3521             20  FILLER                     PIC X.
  3522
  3523         16  CF-CREDIT-MISC-CONTROLS.
  3524             20  CF-REIN-TABLE-SW           PIC X.
  3525                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3526             20  CF-COMP-TABLE-SW           PIC X.
  3527                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3528             20  CF-EXPERIENCE-RETENTION-AGE
  3529                                            PIC S9        COMP-3.
  3530             20  CF-CONVERSION-DT           PIC XX.
  3531             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3532             20  CF-RUN-FREQUENCY-SW        PIC X.
  3533                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3534                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3535
  3536             20  CF-CR-CHECK-NO-CONTROL.
  3537                 24  CF-CR-CHECK-NO-METHOD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL130.cbl
  3538                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3539                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3540                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3541                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3542                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3543
  3544                 24  CF-CR-CHECK-COUNT       REDEFINES
  3545                     CF-CR-CHECK-COUNTER      PIC X(4).
  3546
  3547                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3548                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3549
  3550                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3551                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3552                 24  CF-MAIL-PROCESSING       PIC X.
  3553                     88  MAIL-PROCESSING          VALUE 'Y'.
  3554
  3555         16  CF-MISC-SYSTEM-CONTROL.
  3556             20  CF-SYSTEM-C                 PIC X.
  3557                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3558             20  CF-SYSTEM-D                 PIC X.
  3559                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3560             20  CF-SOC-SEC-NO-SW            PIC X.
  3561                 88  SOC-SEC-NO-USED             VALUE '1'.
  3562             20  CF-MEMBER-NO-SW             PIC X.
  3563                 88  MEMBER-NO-USED              VALUE '1'.
  3564             20  CF-TAX-ID-NUMBER            PIC X(11).
  3565             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3566             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3567                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3568                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3569                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3570                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3571             20  CF-SYSTEM-E                 PIC X.
  3572                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3573
  3574         16  CF-LGX-LIFE-USER               PIC X.
  3575             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3576             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3577
  3578         16  CF-CR-MONTH-END-DT             PIC XX.
  3579
  3580         16  CF-FILE-MAINT-DATES.
  3581             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3582                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3583             20  CF-LAST-BATCH       REDEFINES
  3584                 CF-LAST-BATCH-NO               PIC X(4).
  3585             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3586             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3587             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3588             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3589             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3590             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3591             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3592             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3593             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3594             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3595
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL130.cbl
  3596         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3597         16  FILLER                         PIC X.
  3598
  3599         16  CF-ALT-MORT-CODE               PIC X(4).
  3600         16  CF-MEMBER-CAPTION              PIC X(10).
  3601
  3602         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3603             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3604             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3605             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3606             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3607             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3608
  3609         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3610
  3611         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3612         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3613         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3614         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3615
  3616         16  CF-AH-OVERRIDE-L1              PIC X.
  3617         16  CF-AH-OVERRIDE-L2              PIC XX.
  3618         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3619         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3620
  3621         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3622         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3623
  3624         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3625         16  CF-AR-LAST-EL860-DT            PIC XX.
  3626         16  CF-MP-MONTH-END-DT             PIC XX.
  3627
  3628         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3629         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3630             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3631
  3632         16  CF-AR-MONTH-END-DT             PIC XX.
  3633
  3634         16  CF-CRDTCRD-USER                PIC X.
  3635             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3636             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3637
  3638         16  CF-CC-MONTH-END-DT             PIC XX.
  3639
  3640         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3641
  3642         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3643             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3644             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3645             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3646         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3647         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3648         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3649         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3650             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3651             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3652         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3653         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL130.cbl
  3654         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3655             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3656         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3657
  3658         16  CF-CL-ZIP-CODE.
  3659             20  CF-CL-ZIP-PRIME.
  3660                 24  CF-CL-ZIP-1ST          PIC X.
  3661                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3662                 24  FILLER                 PIC X(4).
  3663             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3664         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3665             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3666             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3667             20  FILLER                     PIC XXX.
  3668
  3669         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3670         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3671         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3672         16  CF-CO-OPTION-START-DATE        PIC XX.
  3673         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3674           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3675                                                      '3' '4'.
  3676           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3677           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3678           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3679           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3680           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3681           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3682
  3683         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3684
  3685         16  CF-PAYMENT-APPROVAL-LEVELS.
  3686             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3687             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3688             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3689             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3690             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3691             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3692
  3693         16  CF-END-USER-REPORTING-USER     PIC X.
  3694             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3695             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3696
  3697         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3698             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3699             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3700
  3701         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3702
  3703         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3704         16  FILLER                         PIC X.
  3705
  3706         16  CF-CREDIT-ARCHIVE-CNTL.
  3707             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3708             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3709             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3710
  3711         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL130.cbl
  3712
  3713         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3714             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3715             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3716
  3717         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3718             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3719             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3720
  3721         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3722
  3723         16  CF-CO-ACH-ID-CODE              PIC  X.
  3724             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3725             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3726             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3727         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3728         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3729         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3730         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3731         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3732         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3733         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3734         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3735         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3736                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3737         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3738                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3739
  3740         16  CF-CO-OVER-SHORT.
  3741             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3742             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3743
  3744*         16  FILLER                         PIC X(102).
  3745         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3746             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3747             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3748
  3749         16  CF-AH-APPROVAL-DAYS.
  3750             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3751             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3752             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3753             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3754
  3755         16  FILLER                         PIC X(82).
  3756****************************************************************
  3757*             PROCESSOR/USER RECORD                            *
  3758****************************************************************
  3759
  3760     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3761         16  CF-PROCESSOR-NAME              PIC X(30).
  3762         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3763         16  CF-PROCESSOR-TITLE             PIC X(26).
  3764         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3765                 88  MESSAGE-YES                VALUE 'Y'.
  3766                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3767
  3768*****************************************************
  3769****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL130.cbl
  3770****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3771****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3772****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3773*****************************************************
  3774
  3775         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3776             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3777             20  CF-APPLICATION-FORCE       PIC X.
  3778             20  CF-INDIVIDUAL-APP.
  3779                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3780                     28  CF-BROWSE-APP      PIC X.
  3781                     28  CF-UPDATE-APP      PIC X.
  3782
  3783         16  CF-CURRENT-TERM-ON             PIC X(4).
  3784         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3785             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3786             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3787             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3788             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3789             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3790             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3791             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3792         16  CF-PROCESSOR-CARRIER           PIC X.
  3793             88  NO-CARRIER-SECURITY            VALUE ' '.
  3794         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3795             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3796         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3797             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3798         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3799             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3800
  3801         16  CF-PROC-SYS-ACCESS-SW.
  3802             20  CF-PROC-CREDIT-CLAIMS-SW.
  3803                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3804                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3805                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3806                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3807             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3808                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3809                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3810             20  CF-PROC-LIFE-GNRLDGR-SW.
  3811                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3812                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3813                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3814                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3815             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3816                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3817                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3818         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3819             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3820             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3821         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3822
  3823         16  CF-APPROVAL-LEVEL                  PIC X.
  3824             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3825             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3826             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3827             88  APPROVAL-LEVEL-4                   VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL130.cbl
  3828
  3829         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3830
  3831         16  CF-LANGUAGE-TYPE                   PIC X.
  3832             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3833             88  CF-LANG-IS-FR                      VALUE 'F'.
  3834         16  FILLER                             PIC  X(240).
  3835
  3836****************************************************************
  3837*             PROCESSOR/REMINDERS RECORD                       *
  3838****************************************************************
  3839
  3840     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3841         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3842             20  CF-START-REMIND-DT         PIC XX.
  3843             20  CF-END-REMIND-DT           PIC XX.
  3844             20  CF-REMINDER-TEXT           PIC X(50).
  3845         16  FILLER                         PIC X(296).
  3846
  3847
  3848****************************************************************
  3849*             STATE MASTER RECORD                              *
  3850****************************************************************
  3851
  3852     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3853         16  CF-STATE-ABBREVIATION          PIC XX.
  3854         16  CF-STATE-NAME                  PIC X(25).
  3855         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3856         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3857             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3858             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3859             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3860             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3861                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3862                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3863             20  CF-ST-PREM-REJECT-SW       PIC X.
  3864                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3865                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3866             20  CF-ST-REF-REJECT-SW        PIC X.
  3867                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3868                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3869         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3870         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3871         16  CF-ST-REFUND-RULES.
  3872             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3873             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3874             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3875         16  CF-ST-FST-PMT-EXTENSION.
  3876             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3877             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3878                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3879                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3880                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3881                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3882         16  CF-ST-STATE-CALL.
  3883             20  CF-ST-CALL-UNEARNED        PIC X.
  3884             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3885             20  CF-ST-CALL-RATE-DEV        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL130.cbl
  3886         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3887             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3888             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3889         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3890         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3891         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3892         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3893         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3894         16  FILLER                         PIC X.
  3895         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3896             20  CF-ST-BENEFIT-CD           PIC XX.
  3897             20  CF-ST-BENEFIT-KIND         PIC X.
  3898                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3899                 88  CF-ST-AH-KIND              VALUE 'A'.
  3900             20  CF-ST-REM-TERM-CALC        PIC X.
  3901                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3902                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3903                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3904                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3905                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3906                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3907                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3908                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3909
  3910             20  CF-ST-REFUND-CALC          PIC X.
  3911                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3912                 88  ST-REFD-BY-R78             VALUE '1'.
  3913                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3914                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3915                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3916                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3917                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3918                 88  ST-REFD-UTAH               VALUE '7'.
  3919                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3920                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3921                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3922
  3923             20  CF-ST-EARNING-CALC         PIC X.
  3924                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3925                 88  ST-EARN-BY-R78             VALUE '1'.
  3926                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3927                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3928                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3929                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3930                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3931                 88  ST-EARN-MEAN               VALUE '8'.
  3932                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3933
  3934             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3935                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3936                 88  ST-OVRD-BY-R78             VALUE '1'.
  3937                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3938                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3939                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3940                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3941                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3942                 88  ST-OVRD-MEAN               VALUE '8'.
  3943                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL130.cbl
  3944             20  FILLER                     PIC X.
  3945
  3946         16  CF-ST-COMMISSION-CAPS.
  3947             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3948             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3949             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3950             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3951         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3952                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3953
  3954         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3955
  3956         16  CF-ST-STATUTORY-INTEREST.
  3957             20  CF-ST-STAT-DATE-FROM       PIC X.
  3958                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3959                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3960             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3961             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3962             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3963             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3964             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3965
  3966         16  CF-ST-OVER-SHORT.
  3967             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3968             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3969
  3970         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3971
  3972         16  CF-ST-RT-CALC                  PIC X.
  3973
  3974         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3975         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3976         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3977         16  CF-ST-RF-LR-CALC               PIC X.
  3978         16  CF-ST-RF-LL-CALC               PIC X.
  3979         16  CF-ST-RF-LN-CALC               PIC X.
  3980         16  CF-ST-RF-AH-CALC               PIC X.
  3981         16  CF-ST-RF-CP-CALC               PIC X.
  3982*        16  FILLER                         PIC X(206).
  3983*CIDMOD         16  FILLER                         PIC X(192).
  3984         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3985             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3986         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3987         16  CF-ST-VFY-2ND-BENE             PIC X.
  3988         16  FILLER                         PIC X(186).
  3989
  3990****************************************************************
  3991*             BENEFIT MASTER RECORD                            *
  3992****************************************************************
  3993
  3994     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3995         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3996             20  CF-BENEFIT-CODE            PIC XX.
  3997             20  CF-BENEFIT-NUMERIC  REDEFINES
  3998                 CF-BENEFIT-CODE            PIC XX.
  3999             20  CF-BENEFIT-ALPHA           PIC XXX.
  4000             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4001             20  CF-BENEFIT-COMMENT         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL130.cbl
  4002
  4003             20  CF-LF-COVERAGE-TYPE        PIC X.
  4004                 88  CF-REDUCING                VALUE 'R'.
  4005                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4006
  4007             20  CF-SPECIAL-CALC-CD         PIC X.
  4008                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4009                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4010                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4011                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4012                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4013                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4014                 88  CF-FARM-PLAN               VALUE 'F'.
  4015                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4016                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4017                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4018                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4019                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4020                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4021                 88  CF-PRUDENTIAL              VALUE 'P'.
  4022                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4023                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4024                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4025                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4026                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4027                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4028
  4029             20  CF-JOINT-INDICATOR         PIC X.
  4030                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4031
  4032*            20  FILLER                     PIC X(12).
  4033             20  FILLER                     PIC X(11).
  4034             20  CF-BENEFIT-CATEGORY        PIC X.
  4035             20  CF-LOAN-TYPE               PIC X(8).
  4036
  4037             20  CF-CO-REM-TERM-CALC        PIC X.
  4038                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4039                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4040                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4041                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4042                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4043
  4044             20  CF-CO-EARNINGS-CALC        PIC X.
  4045                 88  CO-EARN-BY-R78             VALUE '1'.
  4046                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4047                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4048                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4049                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4050                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4051                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4052                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4053
  4054             20  CF-CO-REFUND-CALC          PIC X.
  4055                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4056                 88  CO-REFD-BY-R78             VALUE '1'.
  4057                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4058                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4059                 88  CO-REFD-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL130.cbl
  4060                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4061                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4062                 88  CO-REFD-MEAN               VALUE '8'.
  4063                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4064                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4065                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4066
  4067             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4068                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4069                 88  CO-OVRD-BY-R78             VALUE '1'.
  4070                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4071                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4072                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4073                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4074                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4075                 88  CO-OVRD-MEAN               VALUE '8'.
  4076                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4077
  4078             20  CF-CO-BEN-I-G-CD           PIC X.
  4079                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4080                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4081                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4082
  4083         16  FILLER                         PIC X(304).
  4084
  4085
  4086****************************************************************
  4087*             CARRIER MASTER RECORD                            *
  4088****************************************************************
  4089
  4090     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4091         16  CF-ADDRESS-DATA.
  4092             20  CF-MAIL-TO-NAME            PIC X(30).
  4093             20  CF-IN-CARE-OF              PIC X(30).
  4094             20  CF-ADDRESS-LINE-1          PIC X(30).
  4095             20  CF-ADDRESS-LINE-2          PIC X(30).
  4096             20  CF-CITY-STATE              PIC X(30).
  4097             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4098             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4099
  4100         16  CF-CLAIM-NO-CONTROL.
  4101             20  CF-CLAIM-NO-METHOD         PIC X.
  4102                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4103                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4104                 88  CLAIM-NO-SEQ               VALUE '3'.
  4105                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4106             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4107                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4108                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4109                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4110
  4111         16  CF-CHECK-NO-CONTROL.
  4112             20  CF-CHECK-NO-METHOD         PIC X.
  4113                 88  CHECK-NO-MANUAL            VALUE '1'.
  4114                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4115                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4116                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4117             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL130.cbl
  4118                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4119
  4120         16  CF-DOMICILE-STATE              PIC XX.
  4121
  4122         16  CF-EXPENSE-CONTROLS.
  4123             20  CF-EXPENSE-METHOD          PIC X.
  4124                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4125                 88  DOLLARS-PER-PMT            VALUE '2'.
  4126                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4127                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4128             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4129             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4130
  4131         16  CF-CORRESPONDENCE-CONTROL.
  4132             20  CF-LETTER-RESEND-OPT       PIC X.
  4133                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4134                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4135             20  FILLER                     PIC X(4).
  4136
  4137         16  CF-RESERVE-CONTROLS.
  4138             20  CF-MANUAL-SW               PIC X.
  4139                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4140             20  CF-FUTURE-SW               PIC X.
  4141                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4142             20  CF-PTC-SW                  PIC X.
  4143                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4144             20  CF-IBNR-SW                 PIC X.
  4145                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4146             20  CF-PTC-LF-SW               PIC X.
  4147                 88  CF-LF-PTC-USED             VALUE '1'.
  4148             20  CF-CDT-ACCESS-METHOD       PIC X.
  4149                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4150                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4151                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4152             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4153
  4154         16  CF-CLAIM-CALC-METHOD           PIC X.
  4155             88  360-PLUS-MONTHS                VALUE '1'.
  4156             88  365-PLUS-MONTHS                VALUE '2'.
  4157             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4158             88  360-DAILY                      VALUE '4'.
  4159             88  365-DAILY                      VALUE '5'.
  4160
  4161         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4162         16  FILLER                         PIC X(11).
  4163
  4164         16  CF-LIMIT-AMOUNTS.
  4165             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4166             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4167             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4168             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4169             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4170             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4171             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4172             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4173             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4174             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4175
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL130.cbl
  4176         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4177         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4178         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4179
  4180         16  CF-ZIP-CODE.
  4181             20  CF-ZIP-PRIME.
  4182                 24  CF-ZIP-1ST             PIC X.
  4183                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4184                 24  FILLER                 PIC X(4).
  4185             20  CF-ZIP-PLUS4               PIC X(4).
  4186         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4187             20  CF-CAN-POSTAL-1            PIC XXX.
  4188             20  CF-CAN-POSTAL-2            PIC XXX.
  4189             20  FILLER                     PIC XXX.
  4190
  4191         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4192         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4193         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4194
  4195         16  CF-RATING-SWITCH               PIC X.
  4196             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4197             88  CF-NO-RATING                   VALUE 'N'.
  4198
  4199         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4200
  4201         16  CF-CARRIER-OVER-SHORT.
  4202             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4203             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4204
  4205         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4206         16  CF-SECPAY-SWITCH               PIC X.
  4207             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4208             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4209         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4210         16  FILLER                         PIC X(448).
  4211*        16  FILLER                         PIC X(452).
  4212
  4213
  4214****************************************************************
  4215*             MORTALITY MASTER RECORD                          *
  4216****************************************************************
  4217
  4218     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4219         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4220                                INDEXED BY CF-MORT-NDX.
  4221             20  CF-MORT-TABLE              PIC X(5).
  4222             20  CF-MORT-TABLE-TYPE         PIC X.
  4223                 88  CF-MORT-JOINT              VALUE 'J'.
  4224                 88  CF-MORT-SINGLE             VALUE 'S'.
  4225                 88  CF-MORT-COMBINED           VALUE 'C'.
  4226                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4227                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4228             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4229             20  CF-MORT-AGE-METHOD         PIC XX.
  4230                 88  CF-AGE-LAST                VALUE 'AL'.
  4231                 88  CF-AGE-NEAR                VALUE 'AN'.
  4232             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4233             20  CF-MORT-ADJUSTMENT-DIRECTION
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL130.cbl
  4234                                            PIC X.
  4235                 88  CF-MINUS                   VALUE '-'.
  4236                 88  CF-PLUS                    VALUE '+'.
  4237             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4238             20  CF-MORT-JOINT-CODE         PIC X.
  4239                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4240             20  CF-MORT-PC-Q               PIC X.
  4241                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4242             20  CF-MORT-TABLE-CODE         PIC X(4).
  4243             20  CF-MORT-COMMENTS           PIC X(15).
  4244             20  FILLER                     PIC X(14).
  4245
  4246         16  FILLER                         PIC X(251).
  4247
  4248
  4249****************************************************************
  4250*             BUSSINESS TYPE MASTER RECORD                     *
  4251****************************************************************
  4252
  4253     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4254* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4255* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4256* AND RECORD 05 IS TYPES 81-99
  4257         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4258             20  CF-BUSINESS-TITLE          PIC  X(19).
  4259             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4260                                            PIC S9V9(4) COMP-3.
  4261             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4262             20  FILLER                     PIC  X.
  4263         16  FILLER                         PIC  X(248).
  4264
  4265
  4266****************************************************************
  4267*             TERMINAL MASTER RECORD                           *
  4268****************************************************************
  4269
  4270     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4271
  4272         16  CF-COMPANY-TERMINALS.
  4273             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4274                                  PIC X(4).
  4275         16  FILLER               PIC X(248).
  4276
  4277
  4278****************************************************************
  4279*             LIFE EDIT MASTER RECORD                          *
  4280****************************************************************
  4281
  4282     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4283         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4284             20  CF-LIFE-CODE-IN            PIC XX.
  4285             20  CF-LIFE-CODE-OUT           PIC XX.
  4286         16  FILLER                         PIC X(248).
  4287
  4288
  4289****************************************************************
  4290*             AH EDIT MASTER RECORD                            *
  4291****************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL130.cbl
  4292
  4293     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4294         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4295             20  CF-AH-CODE-IN              PIC XXX.
  4296             20  CF-AH-CODE-OUT             PIC XX.
  4297         16  FILLER                         PIC X(248).
  4298
  4299
  4300****************************************************************
  4301*             CREDIBILITY TABLES                               *
  4302****************************************************************
  4303
  4304     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4305         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4306                             INDEXED BY CF-CRDB-NDX.
  4307             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4308             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4309             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4310         16  FILLER                         PIC  X(332).
  4311
  4312
  4313****************************************************************
  4314*             REPORT CUSTOMIZATION RECORD                      *
  4315****************************************************************
  4316
  4317     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4318         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4319             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4320             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4321             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4322**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4323****       A T-TRANSFER.                                   ****
  4324             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4325
  4326         16  FILLER                         PIC XX.
  4327
  4328         16  CF-CARRIER-CNTL-OPT.
  4329             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4330                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4331                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4332             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4333                                            PIC X.
  4334         16  CF-GROUP-CNTL-OPT.
  4335             20  CF-GROUP-OPT-SEQ           PIC 9.
  4336                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4337                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4338             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4339                                            PIC X(6).
  4340         16  CF-STATE-CNTL-OPT.
  4341             20  CF-STATE-OPT-SEQ           PIC 9.
  4342                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4343                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4344             20  CF-STATE-SELECT OCCURS 3 TIMES
  4345                                            PIC XX.
  4346         16  CF-ACCOUNT-CNTL-OPT.
  4347             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4348                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4349                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL130.cbl
  4350             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4351                                            PIC X(10).
  4352         16  CF-BUS-TYP-CNTL-OPT.
  4353             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4354                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4355                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4356             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4357                                            PIC XX.
  4358         16  CF-LF-TYP-CNTL-OPT.
  4359             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4360                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4361                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4362             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4363                                            PIC XX.
  4364         16  CF-AH-TYP-CNTL-OPT.
  4365             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4366                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4367                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4368             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4369                                            PIC XX.
  4370         16  CF-REPTCD1-CNTL-OPT.
  4371             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4372                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4373                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4374             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4375                                            PIC X(10).
  4376         16  CF-REPTCD2-CNTL-OPT.
  4377             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4378                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4379                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4380             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4381                                            PIC X(10).
  4382         16  CF-USER1-CNTL-OPT.
  4383             20  CF-USER1-OPT-SEQ           PIC 9.
  4384                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4385                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4386             20  CF-USER1-SELECT OCCURS 3 TIMES
  4387                                            PIC X(10).
  4388         16  CF-USER2-CNTL-OPT.
  4389             20  CF-USER2-OPT-SEQ           PIC 9.
  4390                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4391                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4392             20  CF-USER2-SELECT OCCURS 3 TIMES
  4393                                            PIC X(10).
  4394         16  CF-USER3-CNTL-OPT.
  4395             20  CF-USER3-OPT-SEQ           PIC 9.
  4396                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4397                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4398             20  CF-USER3-SELECT OCCURS 3 TIMES
  4399                                            PIC X(10).
  4400         16  CF-USER4-CNTL-OPT.
  4401             20  CF-USER4-OPT-SEQ           PIC 9.
  4402                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4403                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4404             20  CF-USER4-SELECT OCCURS 3 TIMES
  4405                                            PIC X(10).
  4406         16  CF-USER5-CNTL-OPT.
  4407             20  CF-USER5-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL130.cbl
  4408                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4409                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4410             20  CF-USER5-SELECT OCCURS 3 TIMES
  4411                                            PIC X(10).
  4412         16  CF-REINS-CNTL-OPT.
  4413             20  CF-REINS-OPT-SEQ           PIC 9.
  4414                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4415                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4416             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4417                 24  CF-REINS-PRIME         PIC XXX.
  4418                 24  CF-REINS-SUB           PIC XXX.
  4419
  4420         16  CF-AGENT-CNTL-OPT.
  4421             20  CF-AGENT-OPT-SEQ           PIC 9.
  4422                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4423                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4424             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4425                                            PIC X(10).
  4426
  4427         16  FILLER                         PIC X(43).
  4428
  4429         16  CF-LOSS-RATIO-SELECT.
  4430             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4431             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4432         16  CF-ENTRY-DATE-SELECT.
  4433             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4434             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4435         16  CF-EFFECTIVE-DATE-SELECT.
  4436             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4437             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4438
  4439         16  CF-EXCEPTION-LIST-IND          PIC X.
  4440             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4441
  4442         16  FILLER                         PIC X(318).
  4443
  4444****************************************************************
  4445*                  EXCEPTION REPORTING RECORD                  *
  4446****************************************************************
  4447
  4448     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4449         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4450             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4451
  4452         16  CF-COMBINED-LIFE-AH-OPT.
  4453             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4454             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4455             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4456             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4457
  4458         16  CF-LIFE-OPT.
  4459             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4460             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4461             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4462             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4463             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4464             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4465             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL130.cbl
  4466             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4467             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4468             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4469
  4470         16  CF-AH-OPT.
  4471             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4472             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4473             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4474             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4475             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4476             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4477             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4478             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4479             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4480             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4481
  4482         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4483             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4484             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4485             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4486
  4487         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4488
  4489         16  FILLER                         PIC X(673).
  4490
  4491
  4492****************************************************************
  4493*             MORTGAGE SYSTEM PLAN RECORD                      *
  4494****************************************************************
  4495
  4496     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4497         16  CF-PLAN-TYPE                   PIC X.
  4498             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4499             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4500             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4501         16  CF-PLAN-ABBREV                 PIC XXX.
  4502         16  CF-PLAN-DESCRIPT               PIC X(10).
  4503         16  CF-PLAN-NOTES                  PIC X(20).
  4504         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4505         16  CF-PLAN-UNDERWRITING.
  4506             20  CF-PLAN-TERM-DATA.
  4507                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4508                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4509             20  CF-PLAN-AGE-DATA.
  4510                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4511                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4512                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4513             20  CF-PLAN-BENEFIT-DATA.
  4514                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4515                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4516                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4517                                            PIC S9(7)V99  COMP-3.
  4518         16  CF-PLAN-POLICY-FORMS.
  4519             20  CF-POLICY-FORM             PIC X(12).
  4520             20  CF-MASTER-APPLICATION      PIC X(12).
  4521             20  CF-MASTER-POLICY           PIC X(12).
  4522         16  CF-PLAN-RATING.
  4523             20  CF-RATE-CODE               PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL130.cbl
  4524             20  CF-SEX-RATING              PIC X.
  4525                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4526                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4527             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4528             20  CF-SUB-STD-TYPE            PIC X.
  4529                 88  CF-PCT-OF-PREM            VALUE '1'.
  4530                 88  CF-PCT-OF-BENE            VALUE '2'.
  4531         16  CF-PLAN-PREM-TOLERANCES.
  4532             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4533             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4534         16  CF-PLAN-PYMT-TOLERANCES.
  4535             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4536             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4537         16  CF-PLAN-MISC-DATA.
  4538             20  FILLER                     PIC X.
  4539             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4540             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4541         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4542         16  CF-PLAN-IND-GRP                PIC X.
  4543             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4544                                                     '1'.
  4545             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4546                                                     '2'.
  4547         16  CF-MIB-SEARCH-SW               PIC X.
  4548             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4549             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4550             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4551             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4552         16  CF-ALPHA-SEARCH-SW             PIC X.
  4553             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4554             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4555             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4556             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4557             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4558             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4559             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4560             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4561             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4562             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4563                                                     'A' 'B' 'C'
  4564                                                     'X' 'Y' 'Z'.
  4565         16  CF-EFF-DT-RULE-SW              PIC X.
  4566             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4567             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4568             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4569             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4570             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4571         16  FILLER                         PIC X(4).
  4572         16  CF-HEALTH-QUESTIONS            PIC X.
  4573             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4574         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4575         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4576         16  CF-PLAN-SNGL-JNT               PIC X.
  4577             88  CF-COMBINED-PLAN              VALUE 'C'.
  4578             88  CF-JNT-PLAN                   VALUE 'J'.
  4579             88  CF-SNGL-PLAN                  VALUE 'S'.
  4580         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4581         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* EL130.cbl
  4582         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4583         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4584         16  CF-RERATE-CNTL                 PIC  X.
  4585             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4586             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4587             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4588             88  CF-AUTO-RECALC                 VALUE '4'.
  4589         16  CF-BENEFIT-TYPE                PIC  X.
  4590             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4591             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4592         16  CF-POLICY-FEE                  PIC S999V99
  4593                                                    COMP-3.
  4594         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4595         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4596         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4597         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4598         16  FILLER                         PIC  X(32).
  4599         16  CF-TERMINATION-FORM            PIC  X(04).
  4600         16  FILLER                         PIC  X(08).
  4601         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4602                                                       COMP-3.
  4603         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4604         16  CF-ISSUE-LETTER                PIC  X(4).
  4605         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4606         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4607             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4608             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4609         16  CF-MP-REFUND-CALC              PIC X.
  4610             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4611             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4612             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4613             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4614             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4615             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4616             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4617             88  CF-MP-REFD-MEAN                VALUE '8'.
  4618         16  CF-ALT-RATE-CODE               PIC  X(5).
  4619
  4620
  4621         16  FILLER                         PIC X(498).
  4622****************************************************************
  4623*             MORTGAGE COMPANY MASTER RECORD                   *
  4624****************************************************************
  4625
  4626     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4627         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4628         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4629             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4630             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4631             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4632             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4633             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4634
  4635         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4636         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4637         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4638         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4639         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* EL130.cbl
  4640
  4641         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4642             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4643         16  CF-MP-RECON-USE-IND            PIC X(1).
  4644             88  CF-MP-USE-RECON             VALUE 'Y'.
  4645         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4646             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4647         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4648             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4649             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4650         16  FILLER                         PIC X(1).
  4651         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4652             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4653         16  CF-MORTG-MIB-VERSION           PIC X.
  4654             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4655             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4656             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4657         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4658             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4659                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4660             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4661                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4662             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4663                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4664             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4665                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4666             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4667                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4668             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4669                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4670         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4671         16  FILLER                         PIC X(7).
  4672         16  CF-MORTG-DESTINATION-SYMBOL.
  4673             20  CF-MORTG-MIB-COMM          PIC X(5).
  4674             20  CF-MORTG-MIB-TERM          PIC X(5).
  4675         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4676             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4677         16  FILLER                         PIC X(03).
  4678         16  CF-MP-CHECK-NO-CONTROL.
  4679             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4680                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4681                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4682                                                ' ' LOW-VALUES.
  4683                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4684                                               VALUE '3'.
  4685         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4686         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4687         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4688             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4689                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4690             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4691                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4692             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4693                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4694             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4695                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4696             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4697                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* EL130.cbl
  4698             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4699                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4700         16  CF-MORTG-BILLING-AREA.
  4701             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4702                                            PIC X.
  4703         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4704         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4705         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4706         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4707             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4708             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4709         16  FILLER                         PIC X.
  4710         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4711             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4712             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4713         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4714         16  FILLER                         PIC X(8).
  4715         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4716         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4717         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4718         16  CF-ACH-COMPANY-ID.
  4719             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4720                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4721                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4722                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4723             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4724         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4725             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4726         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4727             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4728             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4729         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4730         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4731         16  FILLER                         PIC X(536).
  4732
  4733****************************************************************
  4734*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4735****************************************************************
  4736
  4737     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4738         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4739             20  CF-FEMALE-HEIGHT.
  4740                 24  CF-FEMALE-FT           PIC 99.
  4741                 24  CF-FEMALE-IN           PIC 99.
  4742             20  CF-FEMALE-MIN-WT           PIC 999.
  4743             20  CF-FEMALE-MAX-WT           PIC 999.
  4744         16  FILLER                         PIC X(428).
  4745
  4746     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4747         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4748             20  CF-MALE-HEIGHT.
  4749                 24  CF-MALE-FT             PIC 99.
  4750                 24  CF-MALE-IN             PIC 99.
  4751             20  CF-MALE-MIN-WT             PIC 999.
  4752             20  CF-MALE-MAX-WT             PIC 999.
  4753         16  FILLER                         PIC X(428).
  4754******************************************************************
  4755*             AUTOMATIC ACTIVITY RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* EL130.cbl
  4756******************************************************************
  4757     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4758         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4759             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4760             20  CF-SYS-LETTER-ID           PIC X(04).
  4761             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4762             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4763             20  CF-SYS-RESET-SW            PIC X(01).
  4764             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4765             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4766
  4767         16  FILLER                         PIC X(50).
  4768
  4769         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4770             20  CF-USER-ACTIVE-SW          PIC X(01).
  4771             20  CF-USER-LETTER-ID          PIC X(04).
  4772             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4773             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4774             20  CF-USER-RESET-SW           PIC X(01).
  4775             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4776             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4777             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4778
  4779         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* EL130.cbl
  4781*    COPY ELCCERT.
  4782******************************************************************
  4783*                                                                *
  4784*                            ELCCERT.                            *
  4785*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4786*                            VMOD=2.013                          *
  4787*                                                                *
  4788*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4789*                                                                *
  4790*   FILE TYPE = VSAM,KSDS                                        *
  4791*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4792*                                                                *
  4793*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4794*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4795*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4796*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4797*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4798*                                                                *
  4799*   LOG = YES                                                    *
  4800*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4801******************************************************************
  4802*                   C H A N G E   L O G
  4803*
  4804* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4805*-----------------------------------------------------------------
  4806*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4807* EFFECTIVE    NUMBER
  4808*-----------------------------------------------------------------
  4809* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4810* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4811* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4812* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4813* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4814* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4815* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4816* 032612  CR2011110200001  PEMA  AHL CHANGES
  4817******************************************************************
  4818
  4819 01  CERTIFICATE-MASTER.
  4820     12  CM-RECORD-ID                      PIC XX.
  4821         88  VALID-CM-ID                      VALUE 'CM'.
  4822
  4823     12  CM-CONTROL-PRIMARY.
  4824         16  CM-COMPANY-CD                 PIC X.
  4825         16  CM-CARRIER                    PIC X.
  4826         16  CM-GROUPING.
  4827             20  CM-GROUPING-PREFIX        PIC X(3).
  4828             20  CM-GROUPING-PRIME         PIC X(3).
  4829         16  CM-STATE                      PIC XX.
  4830         16  CM-ACCOUNT.
  4831             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4832             20  CM-ACCOUNT-PRIME          PIC X(6).
  4833         16  CM-CERT-EFF-DT                PIC XX.
  4834         16  CM-CERT-NO.
  4835             20  CM-CERT-PRIME             PIC X(10).
  4836             20  CM-CERT-SFX               PIC X.
  4837
  4838     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* EL130.cbl
  4839         16  CM-COMPANY-CD-A1              PIC X.
  4840         16  CM-INSURED-LAST-NAME          PIC X(15).
  4841         16  CM-INSURED-INITIALS.
  4842             20  CM-INSURED-INITIAL1       PIC X.
  4843             20  CM-INSURED-INITIAL2       PIC X.
  4844
  4845     12  CM-CONTROL-BY-SSN.
  4846         16  CM-COMPANY-CD-A2              PIC X.
  4847         16  CM-SOC-SEC-NO.
  4848             20  CM-SSN-STATE              PIC XX.
  4849             20  CM-SSN-ACCOUNT            PIC X(6).
  4850             20  CM-SSN-LN3.
  4851                 25  CM-INSURED-INITIALS-A2.
  4852                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4853                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4854                 25 CM-PART-LAST-NAME-A2         PIC X.
  4855
  4856     12  CM-CONTROL-BY-CERT-NO.
  4857         16  CM-COMPANY-CD-A4              PIC X.
  4858         16  CM-CERT-NO-A4                 PIC X(11).
  4859
  4860     12  CM-CONTROL-BY-MEMB.
  4861         16  CM-COMPANY-CD-A5              PIC X.
  4862         16  CM-MEMBER-NO.
  4863             20  CM-MEMB-STATE             PIC XX.
  4864             20  CM-MEMB-ACCOUNT           PIC X(6).
  4865             20  CM-MEMB-LN4.
  4866                 25  CM-INSURED-INITIALS-A5.
  4867                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4868                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4869                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4870
  4871     12  CM-INSURED-PROFILE-DATA.
  4872         16  CM-INSURED-FIRST-NAME.
  4873             20  CM-INSURED-1ST-INIT       PIC X.
  4874             20  FILLER                    PIC X(9).
  4875         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4876         16  CM-INSURED-SEX                PIC X.
  4877             88  CM-SEX-MALE                  VALUE 'M'.
  4878             88  CM-SEX-FEMAL                 VALUE 'F'.
  4879         16  CM-INSURED-JOINT-AGE          PIC 99.
  4880         16  CM-JOINT-INSURED-NAME.
  4881             20  CM-JT-LAST-NAME           PIC X(15).
  4882             20  CM-JT-FIRST-NAME.
  4883                 24  CM-JT-1ST-INIT        PIC X.
  4884                 24  FILLER                PIC X(9).
  4885             20  CM-JT-INITIAL             PIC X.
  4886
  4887     12  CM-LIFE-DATA.
  4888         16  CM-LF-BENEFIT-CD              PIC XX.
  4889         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4890         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4891         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4892         16  CM-LF-DEV-CODE                PIC XXX.
  4893         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4894         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4895         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4896         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* EL130.cbl
  4897         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4898         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4899         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4900         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4901         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4902         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4903         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4904         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4905         16  FILLER                        PIC XX.
  4906
  4907     12  CM-AH-DATA.
  4908         16  CM-AH-BENEFIT-CD              PIC XX.
  4909         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4910         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4911         16  CM-AH-DEV-CODE                PIC XXX.
  4912         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4913         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4914         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4915         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4916         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4917         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4918         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4919         16  CM-AH-PAID-THRU-DT            PIC XX.
  4920             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4921         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4922         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4923         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4924         16  FILLER                        PIC X.
  4925
  4926     12  CM-LOAN-INFORMATION.
  4927         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4928         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4929                                           PIC S9(5)V99  COMP-3.
  4930         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4931         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4932         16  CM-PAY-FREQUENCY              PIC S99.
  4933         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4934         16  CM-RATE-CLASS                 PIC XX.
  4935         16  CM-BENEFICIARY                PIC X(25).
  4936         16  CM-POLICY-FORM-NO             PIC X(12).
  4937         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4938         16  CM-LAST-ADD-ON-DT             PIC XX.
  4939         16  CM-DEDUCTIBLE-AMOUNTS.
  4940             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4941             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4942         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4943             20  CM-RESIDENT-STATE         PIC XX.
  4944             20  CM-RATE-CODE              PIC X(4).
  4945             20  FILLER                    PIC XX.
  4946         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4947             20  CM-LOAN-OFFICER           PIC X(5).
  4948             20  FILLER                    PIC XXX.
  4949         16  CM-CSR-CODE                   PIC XXX.
  4950         16  CM-UNDERWRITING-CODE          PIC X.
  4951             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4952         16  CM-POST-CARD-IND              PIC X.
  4953         16  CM-NH-INTERFACE-SW            PIC X.
  4954         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* EL130.cbl
  4955             88  CM-SING-PRM                  VALUE '1'.
  4956             88  CM-O-B-COVERAGE              VALUE '2'.
  4957             88  CM-OPEN-END                  VALUE '3'.
  4958         16  CM-IND-GRP-TYPE               PIC X.
  4959             88  CM-INDIVIDUAL                VALUE 'I'.
  4960             88  CM-GROUP                     VALUE 'G'.
  4961         16  CM-SKIP-CODE                  PIC X.
  4962             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4963             88  SKIP-JULY                    VALUE '1'.
  4964             88  SKIP-AUGUST                  VALUE '2'.
  4965             88  SKIP-SEPTEMBER               VALUE '3'.
  4966             88  SKIP-JULY-AUG                VALUE '4'.
  4967             88  SKIP-AUG-SEPT                VALUE '5'.
  4968             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4969             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4970             88  SKIP-JUNE                    VALUE '8'.
  4971             88  SKIP-JUNE-JULY               VALUE '9'.
  4972             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4973             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4974         16  CM-PAYMENT-MODE               PIC X.
  4975             88  PAY-MONTHLY                  VALUE SPACE.
  4976             88  PAY-WEEKLY                   VALUE '1'.
  4977             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4978             88  PAY-BI-WEEKLY                VALUE '3'.
  4979             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4980         16  CM-LOAN-NUMBER                PIC X(8).
  4981         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4982         16  CM-OLD-LOF                    PIC XXX.
  4983*        16  CM-LOAN-OFFICER               PIC XXX.
  4984         16  CM-REIN-TABLE                 PIC XXX.
  4985         16  CM-SPECIAL-REIN-CODE          PIC X.
  4986         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4987         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4988         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4989
  4990     12  CM-STATUS-DATA.
  4991         16  CM-ENTRY-STATUS               PIC X.
  4992         16  CM-ENTRY-DT                   PIC XX.
  4993
  4994         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4995         16  CM-LF-CANCEL-DT               PIC XX.
  4996         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4997
  4998         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4999         16  CM-LF-DEATH-DT                PIC XX.
  5000         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5001
  5002         16  CM-LF-CURRENT-STATUS          PIC X.
  5003             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5004                                                'M' '4' '5' '9'.
  5005             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5006             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5007             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5008             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5009             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5010             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5011             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5012             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* EL130.cbl
  5013             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5014             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5015             88  CM-LF-DECLINED               VALUE 'D'.
  5016             88  CM-LF-VOIDED                 VALUE 'V'.
  5017
  5018         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5019         16  CM-AH-CANCEL-DT               PIC XX.
  5020         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5021
  5022         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5023         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5024         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5025
  5026         16  CM-AH-CURRENT-STATUS          PIC X.
  5027             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5028                                                'M' '4' '5' '9'.
  5029             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5030             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5031             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5032             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5033             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5034             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5035             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5036             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5037             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5038             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5039             88  CM-AH-DECLINED               VALUE 'D'.
  5040             88  CM-AH-VOIDED                 VALUE 'V'.
  5041
  5042         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5043             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5044             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5045             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5046         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5047
  5048         16  CM-ENTRY-BATCH                PIC X(6).
  5049         16  CM-LF-EXIT-BATCH              PIC X(6).
  5050         16  CM-AH-EXIT-BATCH              PIC X(6).
  5051         16  CM-LAST-MONTH-END             PIC XX.
  5052
  5053     12  CM-NOTE-SW                        PIC X.
  5054         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5055         88  CERT-NOTES-PRESENT               VALUE '1'.
  5056         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5057         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5058         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5059         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5060         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5061         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5062     12  CM-COMP-EXCP-SW                   PIC X.
  5063         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5064         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5065     12  CM-INSURED-ADDRESS-SW             PIC X.
  5066         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5067         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5068
  5069*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5070     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* EL130.cbl
  5071     12  FILLER                            PIC X.
  5072
  5073*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5074     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5075     12  FILLER                            PIC X.
  5076*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5077     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5078
  5079     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5080         88  CERT-ADDED-BATCH                 VALUE ' '.
  5081         88  CERT-ADDED-ONLINE                VALUE '1'.
  5082         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5083         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5084         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5085     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5086         88  CERT-AS-LOADED                   VALUE ' '.
  5087         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5088         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5089         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5090         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5091         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5092         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5093         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5094
  5095     12  CM-ACCOUNT-COMM-PCTS.
  5096         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5097         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5098
  5099     12  CM-USER-FIELD                     PIC X.
  5100     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5101     12  CM-CLP-STATE                      PIC XX.
  5102     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5103     12  CM-USER-RESERVED                  PIC XXX.
  5104     12  FILLER REDEFINES CM-USER-RESERVED.
  5105         16  CM-AH-CLASS-CD                PIC XX.
  5106         16  F                             PIC X.
  5107******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* EL130.cbl
  5109*    COPY ERCACCT.
  5110******************************************************************
  5111*                                                                *
  5112*                                                                *
  5113*                            ERCACCT                             *
  5114*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5115*                            VMOD=2.031                          *
  5116*                                                                *
  5117*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  5118*                                                                *
  5119*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5120*   VSAM ACCOUNT MASTER FILES.                                   *
  5121*                                                                *
  5122*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  5123*                                                                *
  5124*   FILE TYPE = VSAM,KSDS                                        *
  5125*   RECORD SIZE = 2000  RECFORM = FIX                            *
  5126*                                                                *
  5127*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  5128*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  5129*                                                                *
  5130*   LOG = NO                                                     *
  5131*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5132*                                                                *
  5133*                                                                *
  5134******************************************************************
  5135*                   C H A N G E   L O G
  5136*
  5137* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5138*-----------------------------------------------------------------
  5139*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5140* EFFECTIVE    NUMBER
  5141*-----------------------------------------------------------------
  5142* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  5143* 092705    2005050300006  PEMA  ADD SPP LEASES
  5144* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  5145* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5146* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  5147* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  5148* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  5149******************************************************************
  5150
  5151 01  ACCOUNT-MASTER.
  5152     12  AM-RECORD-ID                      PIC XX.
  5153         88  VALID-AM-ID                      VALUE 'AM'.
  5154
  5155     12  AM-CONTROL-PRIMARY.
  5156         16  AM-COMPANY-CD                 PIC X.
  5157         16  AM-MSTR-CNTRL.
  5158             20  AM-CONTROL-A.
  5159                 24  AM-CARRIER            PIC X.
  5160                 24  AM-GROUPING.
  5161                     28 AM-GROUPING-PREFIX PIC XXX.
  5162                     28 AM-GROUPING-PRIME  PIC XXX.
  5163                 24  AM-STATE              PIC XX.
  5164                 24  AM-ACCOUNT.
  5165                     28  AM-ACCOUNT-PREFIX PIC X(4).
  5166                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* EL130.cbl
  5167             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  5168                                           PIC X(19).
  5169             20  AM-CNTRL-B.
  5170                 24  AM-EXPIRATION-DT      PIC XX.
  5171                 24  FILLER                PIC X(4).
  5172             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  5173                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  5174
  5175     12  AM-CONTROL-BY-VAR-GRP.
  5176         16  AM-COMPANY-CD-A1              PIC X.
  5177         16  AM-VG-CARRIER                 PIC X.
  5178         16  AM-VG-GROUPING                PIC X(6).
  5179         16  AM-VG-STATE                   PIC XX.
  5180         16  AM-VG-ACCOUNT                 PIC X(10).
  5181         16  AM-VG-DATE.
  5182             20  AM-VG-EXPIRATION-DT       PIC XX.
  5183             20  FILLER                    PIC X(4).
  5184         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  5185                                           PIC 9(11)      COMP-3.
  5186     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  5187         16  FILLER                        PIC X(10).
  5188         16  AM-VG-KEY3.
  5189             20  AM-VG3-ACCOUNT            PIC X(10).
  5190             20  AM-VG3-EXP-DT             PIC XX.
  5191         16  FILLER                        PIC X(4).
  5192     12  AM-MAINT-INFORMATION.
  5193         16  AM-LAST-MAINT-DT              PIC XX.
  5194         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5195         16  AM-LAST-MAINT-USER            PIC X(4).
  5196         16  FILLER                        PIC XX.
  5197
  5198     12  AM-EFFECTIVE-DT                   PIC XX.
  5199     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  5200
  5201     12  AM-PREV-DATES  COMP-3.
  5202         16  AM-PREV-EXP-DT                PIC 9(11).
  5203         16  AM-PREV-EFF-DT                PIC 9(11).
  5204
  5205     12  AM-REPORT-CODE-1                  PIC X(10).
  5206     12  AM-REPORT-CODE-2                  PIC X(10).
  5207
  5208     12  AM-CITY-CODE                      PIC X(4).
  5209     12  AM-COUNTY-PARISH                  PIC X(6).
  5210
  5211     12  AM-NAME                           PIC X(30).
  5212     12  AM-PERSON                         PIC X(30).
  5213     12  AM-ADDRS                          PIC X(30).
  5214     12  AM-CITY.
  5215         16  AM-ADDR-CITY                  PIC X(28).
  5216         16  AM-ADDR-STATE                 PIC XX.
  5217     12  AM-ZIP.
  5218         16  AM-ZIP-PRIME.
  5219             20  AM-ZIP-PRI-1ST            PIC X.
  5220                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  5221             20  FILLER                    PIC X(4).
  5222         16  AM-ZIP-PLUS4                  PIC X(4).
  5223     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  5224         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* EL130.cbl
  5225         16  AM-CAN-POSTAL-2               PIC XXX.
  5226         16  FILLER                        PIC XXX.
  5227     12  AM-TEL-NO.
  5228         16  AM-AREA-CODE                  PIC 999.
  5229         16  AM-TEL-PRE                    PIC 999.
  5230         16  AM-TEL-NBR                    PIC 9(4).
  5231     12  AM-TEL-LOC                        PIC X.
  5232         88  AM-TEL-AT-HOME                   VALUE 'H'.
  5233         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  5234
  5235     12  AM-COMM-STRUCTURE.
  5236         16  AM-DEFN-1.
  5237             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  5238                 24  AM-AGT.
  5239                     28  AM-AGT-PREFIX     PIC X(4).
  5240                     28  AM-AGT-PRIME      PIC X(6).
  5241                 24  AM-COM-TYP            PIC X.
  5242                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  5243                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  5244                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  5245                 24  AM-RECALC-LV-INDIC    PIC X.
  5246                 24  AM-RETRO-LV-INDIC     PIC X.
  5247                 24  AM-GL-CODES           PIC X.
  5248                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  5249                 24  FILLER                PIC X(01).
  5250         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  5251             20  AM-COM-TBLS        OCCURS 10 TIMES.
  5252                 24  FILLER                PIC X(11).
  5253                 24  AM-L-COMA             PIC XXX.
  5254                 24  AM-J-COMA             PIC XXX.
  5255                 24  AM-A-COMA             PIC XXX.
  5256                 24  FILLER                PIC X(6).
  5257
  5258     12  AM-COMM-CHANGE-STATUS             PIC X.
  5259         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  5260
  5261     12  AM-CSR-CODE                       PIC X(4).
  5262
  5263     12  AM-BILLING-STATUS                 PIC X.
  5264         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  5265         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  5266     12  AM-AUTO-REFUND-SW                 PIC X.
  5267         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  5268         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  5269     12  AM-GPCD                           PIC 99.
  5270     12  AM-IG                             PIC X.
  5271         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5272         88  AM-HAS-GROUP                     VALUE '2'.
  5273     12  AM-STATUS                         PIC X.
  5274         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  5275         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5276         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5277         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  5278         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5279         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  5280     12  AM-REMIT-TO                       PIC 99.
  5281     12  AM-ID-NO                          PIC X(11).
  5282
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* EL130.cbl
  5283     12  AM-CAL-TABLE                      PIC XX.
  5284     12  AM-LF-DEVIATION                   PIC XXX.
  5285     12  AM-AH-DEVIATION                   PIC XXX.
  5286     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5287     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5288     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  5289     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  5290     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5291     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5292
  5293     12  AM-USER-FIELDS.
  5294         16  AM-FLD-1                      PIC XX.
  5295         16  AM-FLD-2                      PIC XX.
  5296         16  AM-FLD-3                      PIC XX.
  5297         16  AM-FLD-4                      PIC XX.
  5298         16  AM-FLD-5                      PIC XX.
  5299
  5300     12  AM-1ST-PROD-DATE.
  5301         16  AM-1ST-PROD-YR                PIC XX.
  5302         16  AM-1ST-PROD-MO                PIC XX.
  5303         16  AM-1ST-PROD-DA                PIC XX.
  5304     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5305     12  AM-CERTS-PURGED-DATE.
  5306         16  AM-PUR-YR                     PIC XX.
  5307         16  AM-PUR-MO                     PIC XX.
  5308         16  AM-PUR-DA                     PIC XX.
  5309     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5310     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5311     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5312     12  AM-INACTIVE-DATE.
  5313         16  AM-INA-MO                     PIC 99.
  5314         16  AM-INA-DA                     PIC 99.
  5315         16  AM-INA-YR                     PIC 99.
  5316     12  AM-AR-HI-CERT-DATE                PIC XX.
  5317
  5318     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5319     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5320
  5321     12  AM-OB-PAYMENT-MODE                PIC X.
  5322         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5323         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5324         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5325         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5326
  5327     12  AM-AH-ONLY-INDICATOR              PIC X.
  5328         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  5329         88  AM-NO-AH-ONLY                    VALUE 'N'.
  5330
  5331     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  5332
  5333     12  AM-OVER-SHORT.
  5334         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5335         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  5336
  5337     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5338     12  AM-DCC-CLP-STATE                  PIC XX.
  5339
  5340     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 102
* EL130.cbl
  5341     12  AM-RECALC-REIN                    PIC X.
  5342
  5343     12  AM-REI-TABLE                      PIC XXX.
  5344     12  AM-REI-ET-LF                      PIC X.
  5345     12  AM-REI-ET-AH                      PIC X.
  5346     12  AM-REI-PE-LF                      PIC X.
  5347     12  AM-REI-PE-AH                      PIC X.
  5348     12  AM-REI-PRT-ST                     PIC X.
  5349     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  5350     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  5351     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  5352     12  AM-REI-GROUP-A                    PIC X(6).
  5353     12  AM-REI-MORT                       PIC X(4).
  5354     12  AM-REI-PRT-OW                     PIC X.
  5355     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  5356     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  5357     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  5358     12  AM-REI-GROUP-B                    PIC X(6).
  5359
  5360     12  AM-TRUST-TYPE                     PIC X(2).
  5361
  5362     12  AM-EMPLOYER-STMT-USED             PIC X.
  5363     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  5364
  5365     12  AM-STD-AH-TYPE                    PIC XX.
  5366     12  AM-EARN-METHODS.
  5367         16  AM-EARN-METHOD-R              PIC X.
  5368             88 AM-REF-RL-R78                 VALUE 'R'.
  5369             88 AM-REF-RL-PR                  VALUE 'P'.
  5370             88 AM-REF-RL-MEAN                VALUE 'M'.
  5371             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  5372         16  AM-EARN-METHOD-L              PIC X.
  5373             88 AM-REF-LL-R78                 VALUE 'R'.
  5374             88 AM-REF-LL-PR                  VALUE 'P'.
  5375             88 AM-REF-LL-MEAN                VALUE 'M'.
  5376             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  5377         16  AM-EARN-METHOD-A              PIC X.
  5378             88 AM-REF-AH-R78                 VALUE 'R'.
  5379             88 AM-REF-AH-PR                  VALUE 'P'.
  5380             88 AM-REF-AH-MEAN                VALUE 'M'.
  5381             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  5382             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  5383             88 AM-REF-AH-NET                 VALUE 'N'.
  5384
  5385     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  5386     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  5387     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  5388
  5389     12  AM-RET-Y-N                        PIC X.
  5390     12  AM-RET-P-E                        PIC X.
  5391     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  5392     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  5393     12  AM-RET-GRP                        PIC X(6).
  5394     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  5395         16  AM-POOL-PRIME                 PIC XXX.
  5396         16  AM-POOL-SUB                   PIC XXX.
  5397     12  AM-RETRO-EARNINGS.
  5398         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 103
* EL130.cbl
  5399         16  AM-RET-EARN-L                 PIC X.
  5400         16  AM-RET-EARN-A                 PIC X.
  5401     12  AM-RET-ST-TAX-USE                 PIC X.
  5402         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  5403         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  5404     12  AM-RETRO-BEG-EARNINGS.
  5405         16  AM-RET-BEG-EARN-R             PIC X.
  5406         16  AM-RET-BEG-EARN-L             PIC X.
  5407         16  AM-RET-BEG-EARN-A             PIC X.
  5408     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  5409     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  5410
  5411     12  AM-USER-SELECT-OPTIONS.
  5412         16  AM-USER-SELECT-1              PIC X(10).
  5413         16  AM-USER-SELECT-2              PIC X(10).
  5414         16  AM-USER-SELECT-3              PIC X(10).
  5415         16  AM-USER-SELECT-4              PIC X(10).
  5416         16  AM-USER-SELECT-5              PIC X(10).
  5417
  5418     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5419
  5420     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5421
  5422     12  AM-RPT045A-SWITCH                 PIC X.
  5423         88  RPT045A-OFF                   VALUE 'N'.
  5424
  5425     12  AM-INSURANCE-LIMITS.
  5426         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  5427         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  5428
  5429     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  5430         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  5431
  5432     12  AM-DISMBR-COVERAGE-SW             PIC X.
  5433         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  5434         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  5435
  5436     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  5437
  5438     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  5439     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  5440     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  5441     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  5442     12  AM-DCC-UEF-STATE                  PIC XX.
  5443     12  FILLER                            PIC XXX.
  5444     12  AM-REPORT-CODE-3                  PIC X(10).
  5445*    12  FILLER                            PIC X(22).
  5446
  5447     12  AM-RESERVE-DATE.
  5448         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  5449         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  5450         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  5451
  5452     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  5453     12  AM-NOTIFICATION-TYPES.
  5454         16  AM-NOTIF-OF-LETTERS           PIC X.
  5455         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  5456         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 104
* EL130.cbl
  5457         16  AM-NOTIF-OF-STATUS            PIC X.
  5458
  5459     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  5460         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  5461         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  5462         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  5463         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  5464
  5465     12  AM-BENEFIT-CONTROLS.
  5466         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  5467             20  AM-BENEFIT-CODE           PIC XX.
  5468             20  AM-BENEFIT-TYPE           PIC X.
  5469             20  AM-BENEFIT-REVISION       PIC XXX.
  5470             20  AM-BENEFIT-REM-TERM       PIC X.
  5471             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  5472             20  FILLER                    PIC XX.
  5473         16  FILLER                        PIC X(80).
  5474
  5475     12  AM-TRANSFER-DATA.
  5476         16  AM-TRANSFERRED-FROM.
  5477             20  AM-TRNFROM-CARRIER        PIC X.
  5478             20  AM-TRNFROM-GROUPING.
  5479                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  5480                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  5481             20  AM-TRNFROM-STATE          PIC XX.
  5482             20  AM-TRNFROM-ACCOUNT.
  5483                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  5484                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  5485             20  AM-TRNFROM-DTE            PIC XX.
  5486         16  AM-TRANSFERRED-TO.
  5487             20  AM-TRNTO-CARRIER          PIC X.
  5488             20  AM-TRNTO-GROUPING.
  5489                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  5490                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  5491             20  AM-TRNTO-STATE            PIC XX.
  5492             20  AM-TRNTO-ACCOUNT.
  5493                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  5494                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  5495             20  AM-TRNTO-DTE              PIC XX.
  5496         16  FILLER                        PIC X(10).
  5497
  5498     12  AM-SAVED-REMIT-TO                 PIC 99.
  5499
  5500     12  AM-COMM-STRUCTURE-SAVED.
  5501         16  AM-DEFN-1-SAVED.
  5502             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  5503                 24  AM-AGT-SV             PIC X(10).
  5504                 24  AM-COM-TYP-SV         PIC X.
  5505                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  5506                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  5507                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  5508                 24  AM-RECALC-LV-INDIC-SV PIC X.
  5509                 24  FILLER                PIC X.
  5510                 24  AM-GL-CODES-SV        PIC X.
  5511                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  5512                 24  FILLER                PIC X.
  5513         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  5514             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 105
* EL130.cbl
  5515                 24  FILLER                PIC X(11).
  5516                 24  AM-L-COMA-SV          PIC XXX.
  5517                 24  AM-J-COMA-SV          PIC XXX.
  5518                 24  AM-A-COMA-SV          PIC XXX.
  5519                 24  FILLER                PIC X(6).
  5520
  5521     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  5522         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  5523            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  5524            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  5525            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  5526
  5527     12  AM-ORIG-DEALER-NO                 PIC X(10).
  5528     12  FILLER                            PIC X(120).
  5529
  5530     12  AM-ACCOUNT-EXECUTIVE-DATA.
  5531         16  AM-CONTROL-NAME               PIC X(30).
  5532         16  AM-EXECUTIVE-ONE.
  5533             20  AM-EXEC1-NAME             PIC X(15).
  5534             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  5535                                                          COMP-3.
  5536             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  5537                                                          COMP-3.
  5538         16  AM-EXECUTIVE-TWO.
  5539             20  AM-EXEC2-NAME             PIC X(15).
  5540             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  5541                                                          COMP-3.
  5542             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  5543                                                          COMP-3.
  5544
  5545     12  AM-RETRO-ADDITIONAL-DATA.
  5546         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  5547         16  AM-RETRO-PREM-P-E             PIC X.
  5548         16  AM-RETRO-CLMS-P-I             PIC X.
  5549         16  AM-RETRO-RET-BRACKET-LF.
  5550             20  AM-RETRO-RET-METHOD-LF    PIC X.
  5551                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  5552                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  5553             20  AM-RETRO-RET-BASIS-LF     PIC X.
  5554                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  5555                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  5556             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  5557                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  5558                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  5559         16  AM-RETRO-RET-BRACKET-AH.
  5560             20  AM-RETRO-RET-METHOD-AH    PIC X.
  5561                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  5562                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  5563                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  5564             20  AM-RETRO-RET-BASIS-AH     PIC X.
  5565                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  5566                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  5567             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  5568                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  5569                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  5570
  5571     12  AM-COMMENTS.
  5572         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 106
* EL130.cbl
  5573
  5574     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  5575         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  5576         16  AM-FLI-BILLING-CODE           PIC X.
  5577         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  5578         16  AM-FLI-UNITED-IDENT           PIC X.
  5579         16  AM-FLI-INTEREST-LOST-DATA.
  5580             20  AM-FLI-BANK-NO            PIC X(5).
  5581             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  5582             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  5583             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  5584         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  5585             20  AM-FLI-AGT                PIC X(9).
  5586             20  AM-FLI-AGT-COMM-ACC       PIC X.
  5587             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  5588         16  FILLER                        PIC X(102).
  5589
  5590     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5591         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5592             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5593             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5594             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5595             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5596             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5597         16  FILLER                          PIC X(10).
  5598******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 107
* EL130.cbl
  5600*    COPY ELCTRLR.
  5601******************************************************************
  5602*                                                                *
  5603*                            ELCTRLR.                            *
  5604*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5605*                            VMOD=2.014                          *
  5606*                                                                *
  5607*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5608*                                                                *
  5609*   FILE TYPE = VSAM,KSDS                                        *
  5610*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5611*                                                                *
  5612*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5613*       ALTERNATE INDEX = NONE                                   *
  5614*                                                                *
  5615*   LOG = YES                                                    *
  5616*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5617******************************************************************
  5618*                   C H A N G E   L O G
  5619*
  5620* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5621*-----------------------------------------------------------------
  5622*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5623* EFFECTIVE    NUMBER
  5624*-----------------------------------------------------------------
  5625* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5626* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5627* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5628* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5629* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5630* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5631* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5632* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5633* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5634* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5635* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5636* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5637* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5638******************************************************************
  5639 01  ACTIVITY-TRAILERS.
  5640     12  AT-RECORD-ID                    PIC XX.
  5641         88  VALID-AT-ID                       VALUE 'AT'.
  5642
  5643     12  AT-CONTROL-PRIMARY.
  5644         16  AT-COMPANY-CD               PIC X.
  5645         16  AT-CARRIER                  PIC X.
  5646         16  AT-CLAIM-NO                 PIC X(7).
  5647         16  AT-CERT-NO.
  5648             20  AT-CERT-PRIME           PIC X(10).
  5649             20  AT-CERT-SFX             PIC X.
  5650         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  5651             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5652             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5653             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5654             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5655             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5656             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5657             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 108
* EL130.cbl
  5658             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5659             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5660             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5661             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5662             88  AT-BENEFICIARY-TRL           VALUE +91.
  5663             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5664             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5665
  5666     12  AT-TRAILER-TYPE                 PIC X.
  5667         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5668         88  PAYMENT-TR                       VALUE '2'.
  5669         88  AUTO-PAY-TR                      VALUE '3'.
  5670         88  CORRESPONDENCE-TR                VALUE '4'.
  5671         88  ADDRESS-TR                       VALUE '5'.
  5672         88  GENERAL-INFO-TR                  VALUE '6'.
  5673         88  AUTO-PROMPT-TR                   VALUE '7'.
  5674         88  DENIAL-TR                        VALUE '8'.
  5675         88  INCURRED-CHG-TR                  VALUE '9'.
  5676         88  FORM-CONTROL-TR                  VALUE 'A'.
  5677
  5678     12  AT-RECORDED-DT                  PIC XX.
  5679     12  AT-RECORDED-BY                  PIC X(4).
  5680     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5681
  5682     12  AT-TRAILER-BODY                 PIC X(165).
  5683
  5684     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5685         16  AT-RESERVE-CONTROLS.
  5686             20  AT-MANUAL-SW            PIC X.
  5687                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5688             20  AT-FUTURE-SW            PIC X.
  5689                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  5690             20  AT-PTC-SW               PIC X.
  5691                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  5692             20  AT-IBNR-SW              PIC X.
  5693                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  5694             20  AT-PTC-LF-SW            PIC X.
  5695                 88  AT-LF-PTC-USED          VALUE '1'.
  5696             20  AT-CDT-ACCESS-METHOD    PIC X.
  5697                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  5698                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  5699                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  5700             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  5701         16  AT-LAST-COMPUTED-DT         PIC XX.
  5702         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  5703         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  5704         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  5705         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5706         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5707         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  5708         16  AT-EXPENSE-CONTROLS.
  5709             20  AT-EXPENSE-METHOD       PIC X.
  5710                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  5711                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  5712                 88  PERCENT-OF-PMT           VALUE '3'.
  5713                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  5714             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  5715             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 109
* EL130.cbl
  5716         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  5717         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  5718
  5719         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  5720         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  5721
  5722*        16  FILLER                      PIC X(53).
  5723         16  FILLER                      PIC X(47).
  5724
  5725         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  5726         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  5727
  5728         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  5729             20  AT-OPEN-CLOSE-DATE      PIC XX.
  5730             20  AT-OPEN-CLOSE-TYPE      PIC X.
  5731*                    C = CLOSED
  5732*                    O = OPEN
  5733             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  5734*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  5735
  5736     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  5737         16  AT-PAYMENT-TYPE             PIC X.
  5738             88  PARTIAL-PAYMENT                VALUE '1'.
  5739             88  FINAL-PAYMENT                  VALUE '2'.
  5740             88  LUMP-SUM-PAYMENT               VALUE '3'.
  5741             88  ADDITIONAL-PAYMENT             VALUE '4'.
  5742             88  CHARGEABLE-EXPENSE             VALUE '5'.
  5743             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  5744             88  VOIDED-PAYMENT                 VALUE '9'.
  5745             88  TRANSFER                       VALUE 'T'.
  5746             88  LIFE-INTEREST                  VALUE 'I'.
  5747
  5748         16  AT-CLAIM-TYPE               PIC X.
  5749             88  PAID-FOR-AH                    VALUE 'A'.
  5750             88  PAID-FOR-LIFE                  VALUE 'L'.
  5751             88  PAID-FOR-IUI                   VALUE 'I'.
  5752             88  PAID-FOR-GAP                   VALUE 'G'.
  5753         16  AT-CLAIM-PREM-TYPE          PIC X.
  5754             88  AT-SINGLE-PREMIUM              VALUE '1'.
  5755             88  AT-O-B-COVERAGE                VALUE '2'.
  5756             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  5757         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  5758         16  AT-CHECK-NO                 PIC X(7).
  5759         16  AT-PAID-FROM-DT             PIC XX.
  5760         16  AT-PAID-THRU-DT             PIC XX.
  5761         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  5762         16  FILLER                      PIC X.
  5763         16  AT-PAYEES-NAME              PIC X(30).
  5764         16  AT-PAYMENT-ORIGIN           PIC X.
  5765             88  ONLINE-MANUAL-PMT              VALUE '1'.
  5766             88  ONLINE-AUTO-PMT                VALUE '2'.
  5767             88  OFFLINE-PMT                    VALUE '3'.
  5768         16  AT-CHECK-WRITTEN-DT         PIC XX.
  5769         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  5770         16  AT-VOID-DATA.
  5771             20  AT-VOID-DT              PIC XX.
  5772*00144       20  AT-VOID-REASON          PIC X(30).
  5773             20  AT-VOID-REASON          PIC X(26).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 110
* EL130.cbl
  5774         16  AT-PMT-APPROVED-BY          PIC X(04).
  5775         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  5776         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  5777         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  5778                                         PIC S99V9(5)  COMP-3.
  5779         16  AT-CREDIT-INTERFACE.
  5780             20  AT-PMT-SELECT-DT        PIC XX.
  5781                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  5782             20  AT-PMT-ACCEPT-DT        PIC XX.
  5783                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  5784             20  AT-VOID-SELECT-DT       PIC XX.
  5785                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  5786             20  AT-VOID-ACCEPT-DT       PIC XX.
  5787                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  5788
  5789         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  5790                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  5791                 88  CONVERSION-PAYMENT           VALUE +99999999.
  5792         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  5793
  5794         16  AT-FORCE-CONTROL            PIC X.
  5795             88  PAYMENT-WAS-FORCED           VALUE '1'.
  5796         16  AT-PREV-LAST-PMT-DT         PIC XX.
  5797         16  AT-PREV-PAID-THRU-DT        PIC XX.
  5798         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  5799         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  5800         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  5801         16  AT-BENEFIT-TYPE             PIC X.
  5802
  5803         16  AT-EXPENSE-TYPE             PIC X.
  5804         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  5805
  5806         16  AT-PAYEE-TYPE-CD.
  5807             20  AT-PAYEE-TYPE           PIC X.
  5808                 88  INSURED-PAID           VALUE 'I'.
  5809                 88  BENEFICIARY-PAID       VALUE 'B'.
  5810                 88  ACCOUNT-PAID           VALUE 'A'.
  5811                 88  OTHER-1-PAID           VALUE 'O'.
  5812                 88  OTHER-2-PAID           VALUE 'Q'.
  5813                 88  DOCTOR-PAID            VALUE 'P'.
  5814                 88  EMPLOYER-PAID          VALUE 'E'.
  5815             20  AT-PAYEE-SEQ            PIC X.
  5816
  5817         16  AT-CASH-PAYMENT             PIC X.
  5818         16  AT-GROUPED-PAYMENT          PIC X.
  5819         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  5820         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  5821         16  AT-APPROVED-LEVEL           PIC X.
  5822         16  AT-VOID-TYPE                PIC X.
  5823             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  5824             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  5825         16  AT-AIG-UNEMP-IND            PIC X.
  5826             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  5827         16  AT-ASSOCIATES               PIC X.
  5828             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  5829             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  5830
  5831         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 111
* EL130.cbl
  5832         16  AT-CV-PMT-CODE              PIC X.
  5833             88  FULL-DEATH-PAYMENT         VALUE '1'.
  5834             88  HALF-DEATH-PAYMENT         VALUE '2'.
  5835             88  FULL-ADD-PAYMENT           VALUE '3'.
  5836             88  HALF-ADD-PAYMENT           VALUE '4'.
  5837             88  FULL-RIDER-PAYMENT         VALUE '5'.
  5838             88  HALF-RIDER-PAYMENT         VALUE '6'.
  5839             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  5840             88  ADDL-PAYMENT               VALUE '8'.
  5841
  5842         16  AT-EOB-CODE1                PIC XXX.
  5843         16  AT-EOB-CODE2                PIC XXX.
  5844         16  AT-EOB-CODE3                PIC XXX.
  5845         16  AT-EOB-CODE4                PIC XXX.
  5846         16  FILLER REDEFINES AT-EOB-CODE4.
  5847             20  AT-INT-PMT-SELECT-DT    PIC XX.
  5848             20  FILLER                  PIC X.
  5849         16  AT-EOB-CODE5                PIC XXX.
  5850         16  FILLER REDEFINES AT-EOB-CODE5.
  5851             20  AT-PMT-PROOF-DT         PIC XX.
  5852             20  FILLER                  PIC X.
  5853
  5854         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  5855             88  AT-PRINT-EOB            VALUE 'Y'.
  5856
  5857         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  5858         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  5859
  5860     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  5861         16  AT-SCHEDULE-START-DT        PIC XX.
  5862         16  AT-SCHEDULE-END-DT          PIC XX.
  5863         16  AT-TERMINATED-DT            PIC XX.
  5864         16  AT-LAST-PMT-TYPE            PIC X.
  5865             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  5866             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  5867         16  AT-FIRST-PMT-DATA.
  5868             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  5869             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  5870             20  AT-1ST-PAY-THRU-DT      PIC XX.
  5871         16  AT-REGULAR-PMT-DATA.
  5872             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  5873             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  5874             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  5875         16  AT-AUTO-PAYEE-CD.
  5876             20  AT-AUTO-PAYEE-TYPE      PIC X.
  5877                 88  INSURED-PAID-AUTO      VALUE 'I'.
  5878                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  5879                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  5880                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  5881                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  5882             20  AT-AUTO-PAYEE-SEQ       PIC X.
  5883         16  AT-AUTO-PAY-DAY             PIC 99.
  5884         16  AT-AUTO-CASH                PIC X.
  5885             88  AT-CASH                      VALUE 'Y'.
  5886             88  AT-NON-CASH                  VALUE 'N'.
  5887*        16  FILLER                      PIC X(129).
  5888         16  AT-AUTO-END-LETTER          PIC X(4).
  5889         16  FILLER                      PIC X(125).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 112
* EL130.cbl
  5890
  5891         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  5892         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  5893
  5894     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  5895         16  AT-LETTER-SENT-DT           PIC XX.
  5896         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  5897         16  AT-AUTO-RE-SEND-DT          PIC XX.
  5898         16  AT-LETTER-ANSWERED-DT       PIC XX.
  5899         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  5900         16  AT-LETTER-ORIGIN            PIC X.
  5901             88  ONLINE-CREATION              VALUE '1' '3'.
  5902             88  OFFLINE-CREATION             VALUE '2' '4'.
  5903             88  NAPER-ONLINE-CREATION        VALUE '3'.
  5904             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  5905         16  AT-STD-LETTER-FORM          PIC X(4).
  5906         16  AT-REASON-TEXT              PIC X(70).
  5907         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  5908         16  AT-ADDRESEE-TYPE            PIC X.
  5909              88  INSURED-ADDRESEE            VALUE 'I'.
  5910              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  5911              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  5912              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  5913              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  5914              88  OTHER-ADDRESEE-1            VALUE 'O'.
  5915              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  5916         16  AT-ADDRESSEE-NAME           PIC X(30).
  5917         16  AT-INITIAL-PRINT-DATE       PIC XX.
  5918         16  AT-RESEND-PRINT-DATE        PIC XX.
  5919         16  AT-CORR-SOL-UNSOL           PIC X.
  5920         16  AT-LETTER-PURGED-DT         PIC XX.
  5921*
  5922*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  5923*
  5924         16  AT-CSO-REDEFINITION.
  5925             20  AT-RESEND-LETTER-FORM   PIC X(4).
  5926             20  AT-AUTO-CLOSE-IND       PIC X(1).
  5927             20  AT-LETTER-TO-BENE       PIC X(1).
  5928             20  AT-STOP-LETTER-DT       PIC X(2).
  5929             20  FILLER                  PIC X(19).
  5930*             20  FILLER                  PIC X(27).
  5931             20  AT-CSO-LETTER-STATUS    PIC X.
  5932                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  5933                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  5934                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  5935             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  5936             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  5937*
  5938*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  5939*
  5940*        16  FILLER                      PIC X(26).
  5941*
  5942*        16  AT-DMD-BSR-CODE             PIC X.
  5943*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  5944*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  5945*
  5946*        16  AT-DMD-LETTER-STATUS        PIC X.
  5947*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 113
* EL130.cbl
  5948*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  5949*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  5950*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  5951*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  5952
  5953         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  5954         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  5955
  5956     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  5957         16  AT-ADDRESS-TYPE             PIC X.
  5958             88  INSURED-ADDRESS               VALUE 'I'.
  5959             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  5960             88  ACCOUNT-ADDRESS               VALUE 'A'.
  5961             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  5962             88  EMPLOYER-ADDRESS              VALUE 'E'.
  5963             88  OTHER-ADDRESS-1               VALUE 'O'.
  5964             88  OTHER-ADDRESS-2               VALUE 'Q'.
  5965         16  AT-MAIL-TO-NAME             PIC X(30).
  5966         16  AT-ADDRESS-LINE-1           PIC X(30).
  5967         16  AT-ADDRESS-LINE-2           PIC X(30).
  5968         16  AT-CITY-STATE.
  5969             20  AT-CITY                 PIC X(28).
  5970             20  AT-STATE                PIC XX.
  5971         16  AT-ZIP.
  5972             20  AT-ZIP-CODE.
  5973                 24  AT-ZIP-1ST          PIC X.
  5974                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5975                 24  FILLER              PIC X(4).
  5976             20  AT-ZIP-PLUS4            PIC X(4).
  5977         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  5978             20  AT-CAN-POSTAL-1         PIC XXX.
  5979             20  AT-CAN-POSTAL-2         PIC XXX.
  5980             20  FILLER                  PIC XXX.
  5981         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  5982*         16  FILLER                      PIC X(23).
  5983         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  5984         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  5985         16  FILLER                      PIC X(13).
  5986         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  5987         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  5988
  5989     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  5990         16  AT-INFO-LINE-1              PIC X(60).
  5991         16  AT-INFO-LINE-2              PIC X(60).
  5992         16  AT-INFO-TRAILER-TYPE        PIC X.
  5993             88  AT-PAYMENT-NOTE         VALUE 'P'.
  5994             88  AT-CALL-NOTE            VALUE 'C'.
  5995             88  AT-MAINT-NOTE           VALUE 'M'.
  5996             88  AT-CERT-CHANGE          VALUE 'X'.
  5997             88  AT-APPROVAL-NOTE        VALUE 'R'.
  5998             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  5999         16  AT-CALL-TYPE                PIC X.
  6000             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6001             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6002         16  AT-NOTE-CONTINUATION        PIC X.
  6003             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6004         16  AT-EOB-CODES-EXIST          PIC X.
  6005             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 114
* EL130.cbl
  6006         16  FILLER                      PIC X(35).
  6007         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6008         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6009
  6010     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6011         16  AT-PROMPT-LINE-1            PIC X(60).
  6012         16  AT-PROMPT-LINE-2            PIC X(60).
  6013         16  AT-PROMPT-START-DT          PIC XX.
  6014         16  AT-PROMPT-END-DT            PIC XX.
  6015         16  FILLER                      PIC X(35).
  6016         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6017         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6018
  6019     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6020         16  AT-DENIAL-INFO-1            PIC X(60).
  6021         16  AT-DENIAL-INFO-2            PIC X(60).
  6022         16  AT-DENIAL-DT                PIC XX.
  6023         16  AT-RETRACTION-DT            PIC XX.
  6024         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6025*         16  FILLER                      PIC X(31).
  6026         16  AT-DENIAL-PROOF-DT          PIC XX.
  6027         16  FILLER                      PIC X(29).
  6028         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6029         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6030
  6031     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6032         16  AT-OLD-INCURRED-DT          PIC XX.
  6033         16  AT-OLD-REPORTED-DT          PIC XX.
  6034         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6035         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6036         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6037         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6038         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6039         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6040         16  FILLER                      PIC X(26).
  6041         16  AT-OLD-DIAG-CODE            PIC X(6).
  6042         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6043         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6044         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6045         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6046         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6047         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6048         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6049         16  FILLER                      PIC X(25).
  6050         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6051
  6052     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6053         16  AT-FORM-SEND-ON-DT          PIC XX.
  6054         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6055         16  AT-FORM-RE-SEND-DT          PIC XX.
  6056         16  AT-FORM-ANSWERED-DT         PIC XX.
  6057         16  AT-FORM-PRINTED-DT          PIC XX.
  6058         16  AT-FORM-REPRINT-DT          PIC XX.
  6059         16  AT-FORM-TYPE                PIC X.
  6060             88  INITIAL-FORM                  VALUE '1'.
  6061             88  PROGRESS-FORM                 VALUE '2'.
  6062         16  AT-INSTRUCT-LN-1            PIC X(28).
  6063         16  AT-INSTRUCT-LN-2            PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 115
* EL130.cbl
  6064         16  AT-INSTRUCT-LN-3            PIC X(28).
  6065         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6066         16  AT-FORM-ADDRESS             PIC X.
  6067             88  FORM-TO-INSURED              VALUE 'I'.
  6068             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6069             88  FORM-TO-OTHER-1              VALUE 'O'.
  6070             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6071         16  AT-RELATED-1.
  6072             20 AT-REL-CARR-1            PIC X.
  6073             20 AT-REL-CLAIM-1           PIC X(7).
  6074             20 AT-REL-CERT-1            PIC X(11).
  6075         16  AT-RELATED-2.
  6076             20 AT-REL-CARR-2            PIC X.
  6077             20 AT-REL-CLAIM-2           PIC X(7).
  6078             20 AT-REL-CERT-2            PIC X(11).
  6079         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6080         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6081         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6082         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6083         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6084         16  AT-STOP-FORM-DT             PIC X(2).
  6085
  6086         16  FILLER                      PIC X(09).
  6087         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6088         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6089******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 116
* EL130.cbl
  6091*    COPY ELCBENE.
  6092******************************************************************
  6093*                                                                *
  6094*                            ELCBENE.                            *
  6095*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6096*                            VMOD=2.006                          *
  6097*                                                                *
  6098*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6099*                                                                *
  6100*   FILE TYPE = VSAM,KSDS                                        *
  6101*   RECORD SIZE = 500   RECFORM = FIX                            *
  6102*                                                                *
  6103*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6104*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6105*                                                                *
  6106*   LOG = YES                                                    *
  6107*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6108*                                                                *
  6109*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6110******************************************************************
  6111
  6112 01  BENEFICIARY-MASTER.
  6113     12  BE-RECORD-ID                PIC XX.
  6114         88  VALID-BE-ID                VALUE 'BE'.
  6115
  6116     12  BE-CONTROL-PRIMARY.
  6117         16  BE-COMPANY-CD           PIC X.
  6118         16  BE-RECORD-TYPE          PIC X.
  6119             88  BENEFICIARY-RECORD  VALUE 'B'.
  6120             88  ADJUSTOR-RECORD     VALUE 'A'.
  6121         16  BE-BENEFICIARY          PIC X(10).
  6122     12  BE-CONTROL-BY-NAME.
  6123         16  BE-COMPANY-CD-A1        PIC X.
  6124         16  BE-RECORD-TYPE-A1       PIC X.
  6125         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6126         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6127
  6128     12  BE-LAST-MAINT-DT            PIC XX.
  6129     12  BE-LAST-MAINT-BY            PIC X(4).
  6130     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6131
  6132     12  BE-ADDRESS-DATA.
  6133         16  BE-MAIL-TO-NAME         PIC X(30).
  6134         16  BE-ADDRESS-LINE-1       PIC X(30).
  6135         16  BE-ADDRESS-LINE-2       PIC X(30).
  6136         16  BE-ADDRESS-LINE-3       PIC X(30).
  6137         16  BE-CITY-STATE.
  6138             20  BE-CITY             PIC X(28).
  6139             20  BE-STATE            PIC XX.
  6140         16  BE-ZIP-CODE.
  6141             20  BE-ZIP-PRIME.
  6142                 24  BE-ZIP-1ST      PIC X.
  6143                     88  BE-CANADIAN-POST-CODE
  6144                                         VALUE 'A' THRU 'Z'.
  6145                 24  FILLER          PIC X(4).
  6146             20  BE-ZIP-PLUS4        PIC X(4).
  6147         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6148             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 117
* EL130.cbl
  6149             20  BE-CAN-POSTAL-2     PIC XXX.
  6150             20  FILLER              PIC XXX.
  6151         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6152         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6153
  6154******************************************************************
  6155*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6156*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6157******************************************************************
  6158     12  BE-CARRIER                  PIC X.
  6159
  6160     12  BE-ADDRESS-DATA2.
  6161         16  BE-MAIL-TO-NAME2        PIC X(30).
  6162         16  BE-ADDRESS-LINE-12      PIC X(30).
  6163         16  BE-ADDRESS-LINE-22      PIC X(30).
  6164         16  BE-ADDRESS-LINE-32      PIC X(30).
  6165         16  BE-CITY-STATE2.
  6166             20  BE-CITY2            PIC X(28).
  6167             20  BE-STATE2           PIC XX.
  6168         16  BE-ZIP-CODE2.
  6169             20  BE-ZIP-PRIME2.
  6170                 24  BE-ZIP-1ST2     PIC X.
  6171                     88  BE-CANADIAN-POST-CODE2
  6172                                         VALUE 'A' THRU 'Z'.
  6173                 24  FILLER          PIC X(4).
  6174             20  BE-ZIP-PLUS42       PIC X(4).
  6175         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6176             20  BE-CAN-POSTAL-12    PIC XXX.
  6177             20  BE-CAN-POSTAL-22    PIC XXX.
  6178             20  FILLER              PIC XXX.
  6179         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6180         16  BE-BILLING-STMT-DATA.
  6181             20  BE-BSR              PIC X.
  6182                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  6183                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  6184             20  BE-BSR-FROM         PIC X(30).
  6185             20  BE-BSR-DEPT         PIC X(30).
  6186             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  6187             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  6188             20  BE-OUTPUT-TYPE      PIC X.
  6189                 88  BE-FAX-OUTPUT         VALUE 'F'.
  6190                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  6191
  6192     12  FILLER                      PIC X(28).
  6193******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 118
* EL130.cbl
  6195*    COPY ELCDAR.
  6196******************************************************************
  6197*                                                                *
  6198*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  6199*   FILE TYPE = VSAM,KSDS                                        *
  6200*   RECORD SIZE = 25   RECFORM = FIXED                           *
  6201*   BASE CLUSTER = DLYACTV                                       *
  6202*   LOG = YES                                                    *
  6203*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  6204*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  6205*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  6206*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  6207*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  6208*               BY PROGRAM "LGINFCE".                            *
  6209*                                                                *
  6210******************************************************************
  6211 01  DAILY-ACTIVITY-RECORD.
  6212     05  DA-KEY.
  6213         10  DA-COMP-CD          PIC X.
  6214         10  DA-CARRIER          PIC X.
  6215         10  DA-CLAIM-NO         PIC X(7).
  6216         10  DA-CERT-NO.
  6217             15  DA-CERT-PRIME   PIC X(10).
  6218             15  DA-CERT-SFX     PIC X.
  6219     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  6220     05  DA-RECORD-TYPE          PIC X.
  6221     05  FILLER                  PIC X(2).
  6222******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 119
* EL130.cbl
  6224*    COPY ELCACTQ.
  6225******************************************************************
  6226*                                                                *
  6227*                            ELCACTQ.                            *
  6228*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6229*                            VMOD=2.004                          *
  6230*                                                                *
  6231*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6232*                                                                *
  6233*   FILE TYPE = VSAM,KSDS                                        *
  6234*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6235*                                                                *
  6236*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6237*       ALTERNATE INDEX = NONE                                   *
  6238*                                                                *
  6239*   LOG = YES                                                    *
  6240*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6241*                                                                *
  6242*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6243******************************************************************
  6244
  6245 01  ACTIVITY-QUE.
  6246     12  AQ-RECORD-ID                PIC XX.
  6247         88  VALID-AQ-ID                VALUE 'AQ'.
  6248
  6249     12  AQ-CONTROL-PRIMARY.
  6250         16  AQ-COMPANY-CD           PIC X.
  6251         16  AQ-CARRIER              PIC X.
  6252         16  AQ-CLAIM-NO             PIC X(7).
  6253         16  AQ-CERT-NO.
  6254             20  AQ-CERT-PRIME       PIC X(10).
  6255             20  AQ-CERT-SFX         PIC X.
  6256
  6257     12  AQ-PENDING-ACTIVITY-FLAGS.
  6258         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6259         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6260             88  PENDING-PAYMENTS       VALUE '1'.
  6261         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6262             88  PENDING-FULL-PRINT     VALUE '1'.
  6263             88  PENDING-PART-PRINT     VALUE '2'.
  6264         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6265             88  PENDING-LETTERS        VALUE '1'.
  6266         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6267             88  PENDING-RESTORE        VALUE 'C'.
  6268             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6269
  6270     12  FILLER                      PIC X(20).
  6271
  6272     12  AQ-RESEND-DATE              PIC XX.
  6273     12  AQ-FOLLOWUP-DATE            PIC XX.
  6274     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6275     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6276     12  AQ-AUTO-LETTER              PIC X(4).
  6277     12  FILLER                      PIC XX.
  6278     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6279*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 120
* EL130.cbl
  6281*    COPY ELCARCH.
  6282******************************************************************
  6283*                                                                *
  6284*                            ELCARCH.                            *
  6285*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6286*                            VMOD=2.007                          *
  6287*                                                                *
  6288*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6289*                                                                *
  6290*   FILE TYPE = VSAM,KSDS                                        *
  6291*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6292*                                                                *
  6293*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6294*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6295*                                                                *
  6296*   LOG = NO                                                     *
  6297*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6298*                                                                *
  6299*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6300******************************************************************
  6301 01  LETTER-ARCHIVE.
  6302     12  LA-RECORD-ID                PIC XX.
  6303         88  VALID-LA-ID                VALUE 'LA'.
  6304
  6305     12  LA-CONTROL-PRIMARY.
  6306         16  LA-COMPANY-CD           PIC X.
  6307         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6308         16  LA-RECORD-TYPE          PIC X.
  6309             88  LA-HEADER-DATA         VALUE '1'.
  6310             88  LA-ADDRESS-DATA        VALUE '2'.
  6311             88  LA-TEXT-DATA           VALUE '3'.
  6312             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6313         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6314
  6315     12  LA-CONTROL-BY-TYPE.
  6316         16  LA-COMPANY-CD-A1        PIC X.
  6317         16  LA-RECORD-TYPE-A1       PIC X.
  6318         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6319         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6320
  6321     12  LA-TEXT-RECORD.
  6322         16  LA-SKIP-CONTROL         PIC XX.
  6323             88  NO-LINES-SKIPPED       VALUE SPACES.
  6324             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6325         16  LA-TEXT-LINE            PIC X(70).
  6326
  6327     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6328         16  FILLER                  PIC XX.
  6329         16  LA-ADDRESS-LINE         PIC X(30).
  6330         16  FILLER                  PIC X(40).
  6331
  6332     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6333         16  FILLER                  PIC XX.
  6334         16  LA-CARRIER              PIC X.
  6335         16  LA-CLAIM-NO             PIC X(7).
  6336         16  LA-CERT-NO.
  6337             20  LA-CERT-PRIME       PIC X(10).
  6338             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 121
* EL130.cbl
  6339         16  LA-NO-OF-COPIES         PIC S9.
  6340         16  LA-RESEND-DATE          PIC XX.
  6341         16  LA-PROCESSOR-CD         PIC X(4).
  6342         16  LA-CREATION-DT          PIC XX.
  6343         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6344         16  LA-RESEND-PRINT-DATE    PIC XX.
  6345         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6346         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6347*
  6348* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6349*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6350*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6351*   I        20  LA-DMD-RES-ST           PIC XX.
  6352*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6353*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6354*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6355*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6356*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6357*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6358*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6359*   I        20  LA-DMD-UND-CODE         PIC XX.
  6360*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6361*   V    16  FILLER                  PIC X(15).
  6362* -----
  6363*
  6364* REINSERTED  CSO  MODS
  6365*
  6366         16  FILLER.
  6367             20  FILLER                  PIC X(29).
  6368             20  LA-CSO-LETTER-STATUS    PIC X.
  6369                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6370                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6371                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6372             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  6373             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  6374*
  6375
  6376     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  6377         16  FILLER                  PIC XX.
  6378         16  LA4-CARRIER             PIC X.
  6379         16  LA4-CLAIM-NO            PIC X(7).
  6380         16  LA4-CERT-NO.
  6381             20  LA4-CERT-PRIME      PIC X(10).
  6382             20  LA4-CERT-SFX        PIC X.
  6383         16  LA4-NO-OF-COPIES        PIC S9.
  6384         16  LA4-RESEND-DATE         PIC XX.
  6385         16  LA4-PROCESSOR-CD        PIC X(4).
  6386         16  LA4-CREATION-DT         PIC XX.
  6387         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  6388         16  LA4-RESEND-PRINT-DATE   PIC XX.
  6389         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  6390         16  LA4-FORM-TYPE           PIC X.
  6391             88  LA4-INITIAL-FORM    VALUE '1'.
  6392             88  LA4-PROGRESS-FORM   VALUE '2'.
  6393         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  6394         16  LA4-STATE               PIC X(02).
  6395         16  FILLER                  PIC X(31).
  6396******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 122
* EL130.cbl
  6398*    COPY ERCREIN.
  6399******************************************************************
  6400*                                                                *
  6401*                            ERCREIN                             *
  6402*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6403*                            VMOD=2.010                          *
  6404*                                                                *
  6405*   ONLINE CREDIT SYSTEM                                         *
  6406*                                                                *
  6407*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6408*                                                                *
  6409*   FILE TYPE = VSAM,KSDS                                        *
  6410*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6411*                                                                *
  6412*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6413*       ALTERNATE PATH = NONE                                    *
  6414*                                                                *
  6415*   LOG = NO                                                     *
  6416*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6417*                                                                *
  6418******************************************************************
  6419*                   C H A N G E   L O G
  6420*
  6421* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6422*-----------------------------------------------------------------
  6423*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6424* EFFECTIVE    NUMBER
  6425*-----------------------------------------------------------------
  6426* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6427* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6428******************************************************************
  6429 01  REINSURANCE-RECORD.
  6430     12  RE-RECORD-ID                      PIC XX.
  6431         88  VALID-RE-ID                      VALUE 'RE'.
  6432
  6433     12  RE-CONTROL-PRIMARY.
  6434         16  RE-COMPANY-CD                 PIC X.
  6435         16  RE-KEY.
  6436             20  RE-CODE                   PIC X.
  6437                 88  RE-TABLE-RECORD          VALUE 'A'.
  6438                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6439             20  RE-TABLE                  PIC XXX.
  6440             20  FILLER                    PIC XXX.
  6441         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6442             20  FILLER                    PIC X.
  6443             20  RE-COMPANY.
  6444                 24  RE-COMP-PRIME         PIC XXX.
  6445                 24  RE-COMP-SUB           PIC XXX.
  6446
  6447     12  RE-MAINT-INFORMATION.
  6448         16  RE-LAST-MAINT-DT              PIC XX.
  6449         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6450         16  RE-LAST-MAINT-USER            PIC X(4).
  6451         16  FILLER                        PIC X(10).
  6452
  6453     12  RE-TABLE-DATA.
  6454         16  RE-100-COMP                   PIC 99.
  6455
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 123
* EL130.cbl
  6456         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6457             20  RE-REI-COMP-NO.
  6458                 24  RE-REI-COMP           PIC XXX.
  6459                 24  RE-REI-COMP-SUB       PIC XXX.
  6460             20  RE-LF-QC                  PIC X.
  6461             20  RE-AH-QC                  PIC X.
  6462             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6463             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6464             20  RE-LFAGE-LO               PIC 99.
  6465             20  RE-LFAGE-HI               PIC 99.
  6466             20  RE-AHAGE-LO               PIC 99.
  6467             20  RE-AHAGE-HI               PIC 99.
  6468             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6469             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6470             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6471             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6472             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6473             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6474             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6475             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6476             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6477             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6478             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6479             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6480             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6481             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6482             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6483             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6484             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6485             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6486             20  RE-LF-BEN-CODE            PIC X.
  6487             20  RE-AH-BEN-CODE            PIC X.
  6488             20  RE-INTERACTIVE            PIC X.
  6489             20  RE-REMAINING              PIC X.
  6490             20  RE-LF-RUNOFF-SW           PIC X.
  6491             20  RE-AH-RUNOFF-SW           PIC X.
  6492             20  FILLER                    PIC X(19).
  6493
  6494         16  RE-COMP-INFO-END              PIC X(6).
  6495         16  RE-NSP-ST-CD-LF               PIC XX.
  6496         16  RE-NSP-ST-CD-AH               PIC XX.
  6497         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  6498             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  6499
  6500         16  FILLER                        PIC X(27).
  6501
  6502     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  6503         16  RE-NAME                       PIC X(30).
  6504         16  RE-LF-PE                      PIC X.
  6505         16  RE-AH-PE                      PIC X.
  6506         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  6507         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  6508         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  6509         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  6510         16  RE-PRT-ST                     PIC X.
  6511         16  RE-PRT-OW                     PIC X.
  6512         16  RE-MORT-CODE                  PIC X(4).
  6513         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 124
* EL130.cbl
  6514         16  RE-ZERO-LF-FEE                PIC X.
  6515         16  RE-ZERO-AH-FEE                PIC X.
  6516         16  RE-CEDE-NAME                  PIC X(30).
  6517         16  RE-LF-COMM                    PIC X.
  6518         16  RE-AH-COMM                    PIC X.
  6519         16  RE-LF-TAX                     PIC X.
  6520         16  RE-AH-TAX                     PIC X.
  6521         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  6522         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  6523         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  6524
  6525         16  RE-COMP-CARRIER-SECURITY      PIC X.
  6526             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  6527
  6528         16  RE-LF-CEDING-FEE-BRACKETS.
  6529             20  RE-LF-FEE-METHOD          PIC X.
  6530                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  6531                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  6532                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  6533                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  6534             20  RE-LF-FEE-BASIS           PIC X.
  6535                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  6536                 88  RE-LF-NET-CEDED               VALUE '2'.
  6537                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  6538                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  6539                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  6540                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  6541                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6542                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  6543             20  FILLER                    PIC XXX.
  6544             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  6545                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6546                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6547
  6548         16  RE-AH-CEDING-FEE-BRACKETS.
  6549             20  RE-AH-FEE-METHOD          PIC X.
  6550                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  6551                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  6552                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  6553                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  6554             20  RE-AH-FEE-BASIS           PIC X.
  6555                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  6556                 88  RE-AH-NET-CEDED               VALUE '2'.
  6557                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  6558                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  6559                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  6560                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  6561                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6562                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  6563             20  FILLER                    PIC XXX.
  6564             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  6565                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6566                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6567
  6568         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  6569
  6570         16  RE-OLD-CEDING-STMT            PIC X.
  6571
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 125
* EL130.cbl
  6572         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  6573         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  6574         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6575         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6576         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  6577         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  6578         16  RE-REINS-GROUPING-CODE        PIC X(6).
  6579         16  RE-MORT-SW                    PIC X.
  6580         16  RE-CEDING-TYPE-FLAG           PIC X.
  6581             88  RE-NO-CESSION-TYPE                VALUE ' '.
  6582             88  RE-CEDED                          VALUE 'C'.
  6583             88  RE-ASSUMED                        VALUE 'A'.
  6584             88  RE-PHANTOM                        VALUE 'P'.
  6585
  6586         16  RE-CEDING-STMT-OPT-A          PIC X.
  6587             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  6588         16  RE-CEDING-STMT-OPT-B          PIC X.
  6589             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  6590         16  RE-CEDING-STMT-OPT-C          PIC X.
  6591             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  6592         16  RE-CEDING-STMT-OPT-D          PIC X.
  6593             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  6594         16  RE-CEDING-STMT-OPT-E          PIC X.
  6595             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  6596
  6597         16  RE-PRT-CRSV                   PIC X.
  6598
  6599         16  RE-GL-CENTER                  PIC X(4).
  6600
  6601         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  6602
  6603         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  6604
  6605         16  RE-EARN-STOP-CODE             PIC X.
  6606             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  6607             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  6608
  6609         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  6610             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  6611
  6612         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  6613         16  FILLER                        PIC X(2281).
  6614
  6615         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  6616
  6617******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 126
* EL130.cbl
  6619*    COPY ERCMAIL.
  6620******************************************************************
  6621*                                                                *
  6622*                                                                *
  6623*                            ERCMAIL                             *
  6624*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6625*                            VMOD=2.003                          *
  6626*                                                                *
  6627*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6628*                                                                *
  6629*   FILE TYPE = VSAM,KSDS                                        *
  6630*   RECORD SIZE = 374   RECFORM = FIX                            *
  6631*                                                                *
  6632*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6633*   ALTERNATE PATH    = NOT USED                                 *
  6634*                                                                *
  6635*   LOG = YES                                                    *
  6636*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6637******************************************************************
  6638*                   C H A N G E   L O G
  6639*
  6640* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6641*-----------------------------------------------------------------
  6642*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6643* EFFECTIVE    NUMBER
  6644*-----------------------------------------------------------------
  6645* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6646* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6647* 111108                   PEMA  ADD CRED BENE ADDR2
  6648******************************************************************
  6649
  6650 01  MAILING-DATA.
  6651     12  MA-RECORD-ID                      PIC XX.
  6652         88  VALID-MA-ID                       VALUE 'MA'.
  6653
  6654     12  MA-CONTROL-PRIMARY.
  6655         16  MA-COMPANY-CD                 PIC X.
  6656         16  MA-CARRIER                    PIC X.
  6657         16  MA-GROUPING.
  6658             20  MA-GROUPING-PREFIX        PIC XXX.
  6659             20  MA-GROUPING-PRIME         PIC XXX.
  6660         16  MA-STATE                      PIC XX.
  6661         16  MA-ACCOUNT.
  6662             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6663             20  MA-ACCOUNT-PRIME          PIC X(6).
  6664         16  MA-CERT-EFF-DT                PIC XX.
  6665         16  MA-CERT-NO.
  6666             20  MA-CERT-PRIME             PIC X(10).
  6667             20  MA-CERT-SFX               PIC X.
  6668
  6669     12  FILLER                            PIC XX.
  6670
  6671     12  MA-ACCESS-CONTROL.
  6672         16  MA-SOURCE-SYSTEM              PIC XX.
  6673             88  MA-FROM-CREDIT                VALUE 'CR'.
  6674             88  MA-FROM-VSI                   VALUE 'VS'.
  6675             88  MA-FROM-WARRANTY              VALUE 'WA'.
  6676             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 127
* EL130.cbl
  6677         16  MA-RECORD-ADD-DT              PIC XX.
  6678         16  MA-RECORD-ADDED-BY            PIC XXXX.
  6679         16  MA-LAST-MAINT-DT              PIC XX.
  6680         16  MA-LAST-MAINT-BY              PIC XXXX.
  6681         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6682
  6683     12  MA-PROFILE-INFO.
  6684         16  MA-QUALIFY-CODE-1             PIC XX.
  6685         16  MA-QUALIFY-CODE-2             PIC XX.
  6686         16  MA-QUALIFY-CODE-3             PIC XX.
  6687         16  MA-QUALIFY-CODE-4             PIC XX.
  6688         16  MA-QUALIFY-CODE-5             PIC XX.
  6689
  6690         16  MA-INSURED-LAST-NAME          PIC X(15).
  6691         16  MA-INSURED-FIRST-NAME         PIC X(10).
  6692         16  MA-INSURED-MIDDLE-INIT        PIC X.
  6693         16  MA-INSURED-ISSUE-AGE          PIC 99.
  6694         16  MA-INSURED-BIRTH-DT           PIC XX.
  6695         16  MA-INSURED-SEX                PIC X.
  6696             88  MA-SEX-MALE                   VALUE 'M'.
  6697             88  MA-SEX-FEMALE                 VALUE 'F'.
  6698         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  6699
  6700         16  MA-ADDRESS-CORRECTED          PIC X.
  6701         16  MA-JOINT-BIRTH-DT             PIC XX.
  6702*        16  FILLER                        PIC X(12).
  6703
  6704         16  MA-ADDRESS-LINE-1             PIC X(30).
  6705         16  MA-ADDRESS-LINE-2             PIC X(30).
  6706         16  MA-CITY-STATE.
  6707             20  MA-CITY                   PIC X(28).
  6708             20  MA-ADDR-STATE             PIC XX.
  6709         16  MA-ZIP.
  6710             20  MA-ZIP-CODE.
  6711                 24  MA-ZIP-CODE-1ST       PIC X(1).
  6712                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6713                 24  FILLER                PIC X(4).
  6714             20  MA-ZIP-PLUS4              PIC X(4).
  6715         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  6716             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  6717             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  6718             20  FILLER                    PIC X(3).
  6719
  6720         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  6721
  6722         16  FILLER                        PIC XXX.
  6723*        16  FILLER                        PIC X(10).
  6724
  6725     12  MA-CRED-BENE-INFO.
  6726         16  MA-CRED-BENE-NAME                 PIC X(25).
  6727         16  MA-CRED-BENE-ADDR                 PIC X(30).
  6728         16  MA-CRED-BENE-ADDR2                PIC X(30).
  6729         16  MA-CRED-BENE-CTYST.
  6730             20  MA-CRED-BENE-CITY             PIC X(28).
  6731             20  MA-CRED-BENE-STATE            PIC XX.
  6732         16  MA-CRED-BENE-ZIP.
  6733             20  MA-CB-ZIP-CODE.
  6734                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 128
* EL130.cbl
  6735                     88  MA-CB-CANADIAN-POST-CODE
  6736                                           VALUE 'A' THRU 'Z'.
  6737                 24  FILLER                    PIC X(4).
  6738             20  MA-CB-ZIP-PLUS4               PIC X(4).
  6739         16  MA-CB-CANADIAN-POSTAL-CODE
  6740                            REDEFINES MA-CRED-BENE-ZIP.
  6741             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  6742             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  6743             20  FILLER                        PIC X(3).
  6744     12  MA-POST-CARD-MAIL-DATA.
  6745         16  MA-MAIL-DATA OCCURS 7.
  6746             20  MA-MAIL-TYPE              PIC X.
  6747                 88  MA-12MO-MAILING           VALUE '1'.
  6748                 88  MA-EXP-MAILING            VALUE '2'.
  6749             20  MA-MAIL-STATUS            PIC X.
  6750                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  6751                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  6752                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  6753             20  MA-MAIL-DATE              PIC XX.
  6754     12  FILLER                            PIC XX.
  6755     12  FILLER                            PIC XX.
  6756*    12  FILLER                            PIC X(30).
  6757******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 129
* EL130.cbl
  6759*    COPY ELCCRTT.
  6760******************************************************************
  6761*                                                                *
  6762*                            ELCCRTT.                            *
  6763*                                                                *
  6764*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  6765*                                                                *
  6766*   FILE TYPE = VSAM,KSDS                                        *
  6767*   RECORD SIZE = 552  RECFORM = FIXED                           *
  6768*                                                                *
  6769*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  6770*                                                                *
  6771*   LOG = YES                                                    *
  6772*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6773******************************************************************
  6774*                   C H A N G E   L O G
  6775*
  6776* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6777*-----------------------------------------------------------------
  6778*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6779* EFFECTIVE    NUMBER
  6780*-----------------------------------------------------------------
  6781* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  6782* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  6783* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  6784******************************************************************
  6785
  6786 01  CERTIFICATE-TRAILERS.
  6787     12  CS-RECORD-ID                      PIC XX.
  6788         88  VALID-CS-ID                      VALUE 'CS'.
  6789
  6790     12  CS-CONTROL-PRIMARY.
  6791         16  CS-COMPANY-CD                 PIC X.
  6792         16  CS-CARRIER                    PIC X.
  6793         16  CS-GROUPING                   PIC X(6).
  6794         16  CS-STATE                      PIC XX.
  6795         16  CS-ACCOUNT                    PIC X(10).
  6796         16  CS-CERT-EFF-DT                PIC XX.
  6797         16  CS-CERT-NO.
  6798             20  CS-CERT-PRIME             PIC X(10).
  6799             20  CS-CERT-SFX               PIC X.
  6800         16  CS-TRAILER-TYPE               PIC X.
  6801             88  COMM-TRLR           VALUE 'A'.
  6802             88  FUTURE-TRLR         VALUE 'B'.
  6803             88  CERT-DATA-TRLR      VALUE 'C'.
  6804
  6805     12  CS-DATA-AREA                      PIC X(516).
  6806
  6807     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  6808         16  CS-BANK-COMMISSION-AREA.
  6809             20  CS-BANK-COMMS       OCCURS 10.
  6810                 24  CS-AGT                PIC X(10).
  6811                 24  CS-COM-TYP            PIC X.
  6812                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  6813                 24  CS-RECALC-LV-INDIC    PIC X.
  6814                 24  FILLER                PIC X(10).
  6815         16  FILLER                        PIC X(256).
  6816
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 130
* EL130.cbl
  6817     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  6818         16  CS-VIN-NUMBER                 PIC X(17).
  6819         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  6820         16  FILLER                        PIC X(498).
  6821******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 131
* EL130.cbl
  6823
  6824 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  6825                          CONTROL-FILE CERTIFICATE-MASTER
  6826                          ACCOUNT-MASTER ACTIVITY-TRAILERS
  6827                          BENEFICIARY-MASTER
  6828                          DAILY-ACTIVITY-RECORD ACTIVITY-QUE
  6829                          LETTER-ARCHIVE REINSURANCE-RECORD
  6830                          MAILING-DATA CERTIFICATE-TRAILERS.
  6831 0000-DFHEXIT SECTION.
  6832     MOVE '9#                    $   ' TO DFHEIV0.
  6833     MOVE 'EL130' TO DFHEIV1.
  6834     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  6835     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  6836     MOVE '5'                    TO DC-OPTION-CODE.
  6837     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  6838     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  6839     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  6840
  6841     IF EIBCALEN = ZERO
  6842         GO TO 8800-UNAUTHORIZED-ACCESS
  6843     END-IF.
  6844
  6845     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  6846     MOVE EIBTRMID               TO QID-TERM.
  6847     MOVE +2                     TO EMI-NUMBER-OF-LINES.
  6848     MOVE '2'                    TO EMI-SWITCH2.
  6849     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  6850     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  6851
  6852
  6853
  6854* EXEC CICS HANDLE CONDITION
  6855*        QIDERR     (0100-TEST-ENTRY)
  6856*        MAPFAIL    (8100-SEND-INITIAL-MAP)
  6857*        PGMIDERR   (9600-PGMID-ERROR)
  6858*        TERMIDERR  (8820-TERM-ERROR)
  6859*        TRANSIDERR (8830-TRAN-ERROR)
  6860*        ERROR      (9990-ABEND)
  6861*    END-EXEC.
  6862*    MOVE '"$N?L[\.              ! " #00006849' TO DFHEIV0
  6863     MOVE X'22244E3F4C5B5C2E20202020' TO DFHEIV0(1:12)
  6864     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6865     MOVE X'2220233030303036383439' TO DFHEIV0(25:11)
  6866     CALL 'kxdfhei1' USING DFHEIV0
  6867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6868
  6869
  6870     IF PI-RETURN-TO-PROGRAM = THIS-PGM  OR
  6871        PI-CALLING-PROGRAM   = XCTL-6592
  6872         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM
  6873     ELSE
  6874         MOVE SPACES             TO RETURNED-FROM
  6875     END-IF.
  6876
  6877     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  6878         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  6879             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  6880             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 132
* EL130.cbl
  6881             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  6882             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  6883             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  6884             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  6885             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  6886             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  6887         ELSE
  6888             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  6889             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  6890             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  6891             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  6892             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  6893             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  6894             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  6895             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  6896         END-IF
  6897     END-IF.
  6898
  6899     IF EIBTRNID = TRANS-ID
  6900         IF EIBAID = DFHCLEAR
  6901             GO TO 9400-CLEAR
  6902         ELSE
  6903             GO TO 0200-RECEIVE
  6904         END-IF
  6905     END-IF.
  6906
  6907     IF RETURNED-FROM NOT = SPACES
  6908         GO TO 0600-RECOVER-TEMP-STORAGE
  6909     END-IF.
  6910
  6911     MOVE LOW-VALUES TO EL130AO.
  6912
  6913
  6914
  6915* EXEC CICS DELETEQ TS
  6916*         QUEUE   (QID)
  6917*    END-EXEC.
  6918*    MOVE '*&                    #   #00006902' TO DFHEIV0
  6919     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  6920     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6921     MOVE X'2020233030303036393032' TO DFHEIV0(25:11)
  6922     CALL 'kxdfhei1' USING DFHEIV0,
  6923           QID,
  6924           DFHEIV99
  6925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6926
  6927
  6928 0100-TEST-ENTRY.
  6929     IF PI-RETURN-TO-PROGRAM = XCTL-127 OR XCTL-727
  6930         GO TO 0650-FROM-EL127
  6931     ELSE
  6932         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  6933                                    PI-CERT-PROCESSED
  6934                                    PI-LETTER-ERROR-CODE
  6935     END-IF.
  6936
  6937     IF PI-RETURN-TO-PROGRAM = XCTL-132
  6938         GO TO 0640-FROM-EL132
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 133
* EL130.cbl
  6939     END-IF.
  6940
  6941     GO TO 8100-SEND-INITIAL-MAP.
  6942
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 134
* EL130.cbl
  6944 0200-RECEIVE.
  6945     MOVE LOW-VALUES             TO EL130AI.
  6946
  6947     IF PI-PROCESSOR-ID = 'LGXX'
  6948*        NEXT SENTENCE
  6949         CONTINUE
  6950     ELSE
  6951
  6952* EXEC CICS READQ TS
  6953*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  6954*            INTO    (SECURITY-CONTROL)
  6955*            LENGTH  (SC-COMM-LENGTH)
  6956*            ITEM    (SC-ITEM)
  6957*        END-EXEC
  6958*    MOVE '*$II   L              ''   #00006929' TO DFHEIV0
  6959     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  6960     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6961     MOVE X'2020233030303036393239' TO DFHEIV0(25:11)
  6962     CALL 'kxdfhei1' USING DFHEIV0,
  6963           PI-SECURITY-TEMP-STORE-ID,
  6964           SECURITY-CONTROL,
  6965           SC-COMM-LENGTH,
  6966           SC-ITEM,
  6967           DFHEIV99,
  6968           DFHEIV99
  6969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6970         MOVE SC-CLAIMS-DISPLAY (1)   TO  PI-DISPLAY-CAP
  6971         MOVE SC-CLAIMS-UPDATE  (1)   TO  PI-MODIFY-CAP
  6972         IF NOT DISPLAY-CAP
  6973             MOVE 'READ'              TO  SM-READ
  6974             PERFORM 9995-SECURITY-VIOLATION
  6975             MOVE ER-0070             TO  EMI-ERROR
  6976             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6977             GO TO 8100-SEND-INITIAL-MAP
  6978         END-IF
  6979     END-IF.
  6980
  6981     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  6982         MOVE ER-7008 TO EMI-ERROR
  6983         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6984         MOVE -1 TO MAINTL
  6985         GO TO 8200-SEND-DATAONLY
  6986     END-IF.
  6987
  6988
  6989
  6990* EXEC CICS RECEIVE
  6991*         MAP     (MAP-NAME)
  6992*         MAPSET  (MAPSET-NAME)
  6993*         INTO    (EL130AI)
  6994*    END-EXEC.
  6995     MOVE LENGTH OF
  6996      EL130AI
  6997       TO DFHEIV11
  6998*    MOVE '8"T I  L              ''   #00006954' TO DFHEIV0
  6999     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  7000     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7001     MOVE X'2020233030303036393534' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 135
* EL130.cbl
  7002     CALL 'kxdfhei1' USING DFHEIV0,
  7003           MAP-NAME,
  7004           EL130AI,
  7005           DFHEIV11,
  7006           MAPSET-NAME,
  7007           DFHEIV99,
  7008           DFHEIV99
  7009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7010
  7011
  7012     IF NOT PI-NO-CARRIER-SECURITY
  7013        MOVE +1                  TO CLMCARRL
  7014        MOVE PI-CARRIER-SECURITY TO CLMCARRI
  7015     END-IF.
  7016
  7017     IF ENTERPFL = ZERO
  7018         GO TO 0300-CHECK-PFKEYS
  7019     END-IF.
  7020
  7021     IF EIBAID NOT = DFHENTER
  7022         MOVE ER-0004            TO EMI-ERROR
  7023         GO TO 0320-INPUT-ERROR
  7024     END-IF.
  7025
  7026     IF (ENTERPFI NUMERIC) AND (ENTERPFI GREATER 0 AND LESS 25)
  7027         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  7028     ELSE
  7029         MOVE ER-0029            TO EMI-ERROR
  7030         GO TO 0320-INPUT-ERROR
  7031     END-IF.
  7032
  7033 0300-CHECK-PFKEYS.
  7034     IF EIBAID = DFHPF23
  7035         GO TO 8810-PF23
  7036     END-IF.
  7037
  7038     IF EIBAID = DFHPF24
  7039         GO TO 9200-RETURN-MAIN-MENU
  7040     END-IF.
  7041
  7042     IF EIBAID = DFHPF12
  7043         GO TO 9500-PF12
  7044     END-IF.
  7045
  7046     IF EIBAID = DFHPF3
  7047         MOVE SPACES              TO MAINTI
  7048         MOVE ZEROS               TO MAINTL
  7049         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7050         MOVE XCTL-127            TO PGM-NAME
  7051         GO TO 9300-XCTL
  7052     END-IF.
  7053
  7054     IF EIBAID = DFHPF4
  7055         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7056         MOVE XCTL-132            TO PGM-NAME
  7057         GO TO 9300-XCTL
  7058     END-IF.
  7059
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 136
* EL130.cbl
  7060     IF EIBAID = DFHPF13
  7061         IF PI-ACCESS-TO-BOTH-SYSTEMS
  7062             PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7063             MOVE PI-CARRIER          TO  PI-CR-CARRIER
  7064             MOVE PI-GROUPING         TO  PI-CR-GROUPING
  7065             MOVE PI-STATE            TO  PI-CR-STATE
  7066             MOVE PI-ACCOUNT          TO  PI-CR-ACCOUNT
  7067             MOVE XCTL-650            TO  PGM-NAME
  7068             GO TO 9300-XCTL
  7069         ELSE
  7070             MOVE -1                  TO  ENTERPFL
  7071             MOVE ER-2566             TO  EMI-ERROR
  7072             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7073             GO TO 8100-SEND-INITIAL-MAP
  7074         END-IF
  7075     END-IF.
  7076
  7077     IF EIBAID = DFHPF5
  7078         IF PI-CERT-PROCESSED LESS THAN PI-CERT-SELECT-CNT
  7079             ADD +1 TO PI-CERT-PROCESSED
  7080             GO TO 0650-FROM-EL127
  7081         ELSE
  7082             MOVE ER-7686         TO EMI-ERROR
  7083             GO TO 0320-INPUT-ERROR
  7084         END-IF
  7085     END-IF.
  7086
  7087     IF EIBAID = DFHPF7 OR DFHPF8 OR DFHPF9
  7088         GO TO 0800-TEST-PREVIOUS-CONTROL
  7089     END-IF.
  7090
  7091     IF PI-HAS-CLAS-IC-CRDTCRD
  7092         IF EIBAID = DFHPF10
  7093             MOVE XCTL-725          TO PGM-NAME
  7094             GO TO 9300-XCTL
  7095         END-IF
  7096     END-IF.
  7097
  7098     IF EIBAID = DFHPF14
  7099         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7100         MOVE SPACES              TO PI-EL659-TO-EL130-CNTRL
  7101         MOVE XCTL-659            TO PGM-NAME
  7102         GO TO 9300-XCTL
  7103     END-IF.
  7104
  7105     IF EIBAID = DFHPF15
  7106         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7107         MOVE XCTL-114            TO PGM-NAME
  7108         GO TO 9300-XCTL
  7109     END-IF.
  7110
  7111     IF EIBAID = DFHENTER OR DFHPF6 OR DFHPF11
  7112         GO TO 0330-EDIT-DATA
  7113     END-IF.
  7114
  7115     MOVE ER-0029                TO EMI-ERROR.
  7116
  7117 0320-INPUT-ERROR.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 137
* EL130.cbl
  7118     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7119
  7120     MOVE AL-UNBON               TO ENTERPFA.
  7121
  7122     IF ENTERPFL = ZERO
  7123         MOVE -1                 TO MAINTL
  7124     ELSE
  7125         MOVE -1                 TO ENTERPFL
  7126     END-IF.
  7127
  7128     GO TO 8200-SEND-DATAONLY.
  7129
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 138
* EL130.cbl
  7131 0330-EDIT-DATA.
  7132
  7133     IF MAINTI = 'S'
  7134         IF PRTOPTL GREATER THAN 0
  7135             IF PRTOPTI NOT = 'N' AND 'L'
  7136                 MOVE AL-UABON   TO  PRTOPTA
  7137                 MOVE -1         TO  PRTOPTL
  7138                 MOVE ER-0334    TO  EMI-ERROR
  7139                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7140                 GO TO 8200-SEND-DATAONLY
  7141             ELSE
  7142                 IF PRTOPTI = 'L'
  7143                     GO TO 0400-CREATE-ELACTQ
  7144                 ELSE
  7145                     GO TO 0480-PRINT-NOW
  7146                 END-IF
  7147             END-IF
  7148         ELSE
  7149             GO TO 1000-SHOW-CLAIM
  7150         END-IF
  7151     END-IF.
  7152
  7153     IF NOT MODIFY-CAP
  7154         MOVE 'UPDATE'       TO  SM-READ
  7155         PERFORM 9995-SECURITY-VIOLATION
  7156         MOVE ER-0070        TO  EMI-ERROR
  7157         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7158         GO TO 8100-SEND-INITIAL-MAP
  7159     END-IF.
  7160
  7161     IF MAINTI = 'D'
  7162         GO TO 2000-DELETE-CLAIM
  7163     END-IF.
  7164
  7165     IF MAINTI = 'A'
  7166         GO TO 3000-ADD-CLAIM
  7167     END-IF.
  7168
  7169     IF MAINTI = 'I'
  7170         GO TO 5000-INCURRED-CHANGE
  7171     END-IF.
  7172
  7173     MOVE ER-0023                TO EMI-ERROR.
  7174     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7175     MOVE -1                     TO MAINTL.
  7176     MOVE AL-UABON               TO MAINTA.
  7177
  7178     GO TO 8200-SEND-DATAONLY.
  7179
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 139
* EL130.cbl
  7181 0400-CREATE-ELACTQ.
  7182     IF CLMNOI   = PI-LAST-CLAIM      AND
  7183        CLMCARRI = PI-LAST-CARR       AND
  7184        CERTNOI  = PI-LAST-CERT-PRIME AND
  7185        SUFXI    = PI-LAST-CERT-SUFX
  7186         MOVE PI-LAST-CLAIM      TO PI-CLAIM-NO
  7187         MOVE PI-LAST-CARR       TO PI-CARRIER
  7188         MOVE PI-LAST-CERT       TO PI-CERT-NO
  7189     ELSE
  7190         MOVE ER-0207            TO EMI-ERROR
  7191         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7192         MOVE -1                 TO MAINTL
  7193         GO TO 8200-SEND-DATAONLY
  7194     END-IF.
  7195
  7196     IF (NOT PI-NO-CARRIER-SECURITY OR
  7197         NOT PI-NO-ACCOUNT-SECURITY)
  7198         MOVE AL-UABON      TO  PRTOPTA
  7199         MOVE -1            TO  PRTOPTL
  7200         MOVE ER-2378       TO  EMI-ERROR
  7201         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7202         GO TO 8200-SEND-DATAONLY
  7203     END-IF.
  7204
  7205     MOVE PI-COMPANY-CD      TO ELACTQ-COMPANY-CD.
  7206     MOVE PI-LAST-CARR       TO ELACTQ-CARRIER.
  7207     MOVE PI-LAST-CLAIM      TO ELACTQ-CLAIM-NO.
  7208     MOVE PI-LAST-CERT       TO ELACTQ-CERT-NO.
  7209
  7210
  7211
  7212* EXEC CICS HANDLE CONDITION
  7213*         NOTFND     (0450-ADD-ELACTQ-RECORD)
  7214*    END-EXEC.
  7215*    MOVE '"$I                   ! # #00007159' TO DFHEIV0
  7216     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7217     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7218     MOVE X'2320233030303037313539' TO DFHEIV0(25:11)
  7219     CALL 'kxdfhei1' USING DFHEIV0
  7220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7221
  7222
  7223
  7224
  7225* EXEC CICS READ
  7226*         UPDATE
  7227*         DATASET    (ELACTQ-DSID)
  7228*         SET        (ADDRESS OF ACTIVITY-QUE)
  7229*         RIDFLD     (ELACTQ-KEY)
  7230*    END-EXEC.
  7231*    MOVE '&"S        EU         (   #00007164' TO DFHEIV0
  7232     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7233     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7234     MOVE X'2020233030303037313634' TO DFHEIV0(25:11)
  7235     CALL 'kxdfhei1' USING DFHEIV0,
  7236           ELACTQ-DSID,
  7237           DFHEIV20,
  7238           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 140
* EL130.cbl
  7239           ELACTQ-KEY,
  7240           DFHEIV99,
  7241           DFHEIV99,
  7242           DFHEIV99
  7243     SET ADDRESS OF ACTIVITY-QUE TO
  7244         DFHEIV20
  7245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7246
  7247
  7248     MOVE '2'         TO AQ-PENDING-STATUS-FLAG.
  7249     MOVE +130        TO AQ-LAST-UPDATED-BY.
  7250
  7251
  7252
  7253* EXEC CICS REWRITE
  7254*         DATASET     (ELACTQ-DSID)
  7255*         FROM        (ACTIVITY-QUE)
  7256*    END-EXEC.
  7257     MOVE LENGTH OF
  7258      ACTIVITY-QUE
  7259       TO DFHEIV11
  7260*    MOVE '&& L                  %   #00007175' TO DFHEIV0
  7261     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7262     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7263     MOVE X'2020233030303037313735' TO DFHEIV0(25:11)
  7264     CALL 'kxdfhei1' USING DFHEIV0,
  7265           ELACTQ-DSID,
  7266           ACTIVITY-QUE,
  7267           DFHEIV11,
  7268           DFHEIV99
  7269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7270
  7271
  7272     GO TO 0470-STATUS-FINISH.
  7273
  7274 0450-ADD-ELACTQ-RECORD.
  7275
  7276
  7277* EXEC CICS GETMAIN
  7278*        SET     (ADDRESS OF ACTIVITY-QUE)
  7279*        LENGTH  (ELACTQ-LENGTH)
  7280*        INITIMG (GETMAIN-SPACE)
  7281*    END-EXEC.
  7282*    MOVE ',"IL                  $   #00007184' TO DFHEIV0
  7283     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7284     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7285     MOVE X'2020233030303037313834' TO DFHEIV0(25:11)
  7286     CALL 'kxdfhei1' USING DFHEIV0,
  7287           DFHEIV20,
  7288           ELACTQ-LENGTH,
  7289           GETMAIN-SPACE
  7290     SET ADDRESS OF ACTIVITY-QUE TO
  7291         DFHEIV20
  7292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7293
  7294
  7295     MOVE 'AQ'              TO AQ-RECORD-ID.
  7296     MOVE ELACTQ-KEY        TO AQ-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 141
* EL130.cbl
  7297     MOVE +0                TO AQ-PAYMENT-COUNTER
  7298                               AQ-PMT-UNAPPROVED-COUNT.
  7299     MOVE LOW-VALUES        TO AQ-RESEND-DATE
  7300                               AQ-FOLLOWUP-DATE.
  7301     MOVE '2'               TO AQ-PENDING-STATUS-FLAG.
  7302     MOVE +130              TO AQ-LAST-UPDATED-BY.
  7303
  7304
  7305
  7306* EXEC CICS WRITE
  7307*         DATASET     (ELACTQ-DSID)
  7308*         FROM        (ACTIVITY-QUE)
  7309*         RIDFLD      (ELACTQ-KEY)
  7310*    END-EXEC.
  7311     MOVE LENGTH OF
  7312      ACTIVITY-QUE
  7313       TO DFHEIV11
  7314*    MOVE '&$ L                  ''   #00007200' TO DFHEIV0
  7315     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7316     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7317     MOVE X'2020233030303037323030' TO DFHEIV0(25:11)
  7318     CALL 'kxdfhei1' USING DFHEIV0,
  7319           ELACTQ-DSID,
  7320           ACTIVITY-QUE,
  7321           DFHEIV11,
  7322           ELACTQ-KEY,
  7323           DFHEIV99,
  7324           DFHEIV99
  7325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7326
  7327
  7328 0470-STATUS-FINISH.
  7329     MOVE AL-UANOF               TO  PRTOPTA
  7330                                     ALTPRTA.
  7331
  7332     MOVE SPACES                 TO  PRTOPTO
  7333                                     ALTPRTO.
  7334
  7335     MOVE ER-0000                TO EMI-ERROR.
  7336     MOVE -1                     TO MAINTL.
  7337     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7338     GO TO 8100-SEND-INITIAL-MAP.
  7339
  7340 0480-PRINT-NOW.
  7341
  7342
  7343* EXEC CICS HANDLE CONDITION
  7344*        TERMIDERR   (8820-TERM-ERROR)
  7345*        TRANSIDERR  (8830-TRAN-ERROR)
  7346*    END-EXEC.
  7347*    MOVE '"$[\                  ! $ #00007220' TO DFHEIV0
  7348     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
  7349     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7350     MOVE X'2420233030303037323230' TO DFHEIV0(25:11)
  7351     CALL 'kxdfhei1' USING DFHEIV0
  7352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7353
  7354
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 142
* EL130.cbl
  7355     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  7356     MOVE '1'                    TO  CNTL-REC-TYPE.
  7357     MOVE SPACES                 TO  CNTL-ACCESS.
  7358     MOVE +0                     TO  CNTL-SEQ-NO.
  7359     MOVE 'CNTL'                 TO  FILE-SWITCH.
  7360
  7361     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
  7362
  7363     IF CF-FORMS-PRINTER-ID = SPACES
  7364         IF ALTPRTL NOT GREATER THAN 0
  7365             MOVE ER-0337        TO  EMI-ERROR
  7366             MOVE -1             TO  ALTPRTL
  7367             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7368             GO TO 8200-SEND-DATAONLY
  7369         END-IF
  7370     END-IF.
  7371
  7372     IF ALTPRTL GREATER THAN 0
  7373         MOVE ALTPRTI            TO  CF-FORMS-PRINTER-ID
  7374     END-IF.
  7375
  7376     MOVE PI-LAST-CLAIM          TO  PI-CLAIM-NO.
  7377     MOVE PI-LAST-CARR           TO  PI-CARRIER.
  7378     MOVE PI-LAST-CERT           TO  PI-CERT-NO.
  7379
  7380
  7381
  7382* EXEC CICS START
  7383*        TRANSID   (START-TRANS-ID)
  7384*        TERMID    (CF-FORMS-PRINTER-ID)
  7385*        FROM      (PROGRAM-INTERFACE-BLOCK)
  7386*        LENGTH    (PI-COMM-LENGTH)
  7387*    END-EXEC.
  7388*    MOVE '0( LFT                0   #00007251' TO DFHEIV0
  7389     MOVE X'3028204C4654202020202020' TO DFHEIV0(1:12)
  7390     MOVE X'202020202020202020203020' TO DFHEIV0(13:12)
  7391     MOVE X'2020233030303037323531' TO DFHEIV0(25:11)
  7392     CALL 'kxdfhei1' USING DFHEIV0,
  7393           DFHEIV99,
  7394           START-TRANS-ID,
  7395           DFHEIV99,
  7396           PROGRAM-INTERFACE-BLOCK,
  7397           PI-COMM-LENGTH,
  7398           CF-FORMS-PRINTER-ID,
  7399           DFHEIV99,
  7400           DFHEIV99,
  7401           DFHEIV99,
  7402           DFHEIV99,
  7403           DFHEIV99,
  7404           DFHEIV99,
  7405           DFHEIV99,
  7406           DFHEIV99,
  7407           DFHEIV99
  7408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7409
  7410
  7411     MOVE AL-UANOF               TO  PRTOPTA
  7412                                     ALTPRTA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 143
* EL130.cbl
  7413
  7414     MOVE SPACES                 TO  PRTOPTO
  7415                                     ALTPRTO.
  7416
  7417     MOVE ER-0000                TO  EMI-ERROR.
  7418     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7419     MOVE -1                     TO  MAINTL.
  7420     GO TO 8100-SEND-INITIAL-MAP.
  7421
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 144
* EL130.cbl
  7423 0500-CREATE-TEMP-STORAGE.
  7424     MOVE EIBCPOSN               TO PI-CURSOR.
  7425
  7426
  7427
  7428* EXEC CICS WRITEQ TS
  7429*        QUEUE   (QID)
  7430*        FROM    (EL130AI)
  7431*        LENGTH  (QID-MAP-LENGTH)
  7432*    END-EXEC.
  7433*    MOVE '*"                    ''   #00007274' TO DFHEIV0
  7434     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7435     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7436     MOVE X'2020233030303037323734' TO DFHEIV0(25:11)
  7437     CALL 'kxdfhei1' USING DFHEIV0,
  7438           QID,
  7439           EL130AI,
  7440           QID-MAP-LENGTH,
  7441           DFHEIV99,
  7442           DFHEIV99,
  7443           DFHEIV99
  7444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7445
  7446
  7447
  7448
  7449* EXEC CICS WRITEQ TS
  7450*        QUEUE    (QID)
  7451*        FROM     (PROGRAM-INTERFACE-BLOCK)
  7452*        LENGTH   (PI-COMM-LENGTH)
  7453*    END-EXEC.
  7454*    MOVE '*"                    ''   #00007281' TO DFHEIV0
  7455     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7456     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7457     MOVE X'2020233030303037323831' TO DFHEIV0(25:11)
  7458     CALL 'kxdfhei1' USING DFHEIV0,
  7459           QID,
  7460           PROGRAM-INTERFACE-BLOCK,
  7461           PI-COMM-LENGTH,
  7462           DFHEIV99,
  7463           DFHEIV99,
  7464           DFHEIV99
  7465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7466
  7467
  7468 0599-EXIT.
  7469      EXIT.
  7470
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 145
* EL130.cbl
  7472 0600-RECOVER-TEMP-STORAGE.
  7473     MOVE PI-CONTROL-IN-PROGRESS TO SAVE-CONTROL.
  7474     MOVE PI-EL127-TO-EL130-CNTRL
  7475                                 TO SAVE-EL127-TO-EL130-CNTRL.
  7476     MOVE PI-EL659-TO-EL130-CNTRL
  7477                                 TO SAVE-EL659-TO-EL130-CNTRL.
  7478     MOVE PI-COMPANY-ID          TO SAVE-COMPANY-ID.
  7479     MOVE PI-COMPANY-CD          TO SAVE-COMPANY-CD.
  7480     MOVE PI-JOURNAL-FILE-ID     TO SAVE-JOURNAL-FILE-ID.
  7481     MOVE PI-CREDIT-USER         TO SAVE-CREDIT-USER.
  7482     MOVE PI-CLAIM-USER          TO SAVE-CLAIM-USER.
  7483     MOVE PI-LIFE-OVERRIDE-L1    TO SAVE-LIFE-OVERRIDE-L1.
  7484     MOVE PI-LIFE-OVERRIDE-L2    TO SAVE-LIFE-OVERRIDE-L2.
  7485     MOVE PI-LIFE-OVERRIDE-L6    TO SAVE-LIFE-OVERRIDE-L6.
  7486     MOVE PI-LIFE-OVERRIDE-L12   TO SAVE-LIFE-OVERRIDE-L12.
  7487     MOVE PI-AH-OVERRIDE-L1      TO SAVE-AH-OVERRIDE-L1.
  7488     MOVE PI-AH-OVERRIDE-L2      TO SAVE-AH-OVERRIDE-L2.
  7489     MOVE PI-AH-OVERRIDE-L6      TO SAVE-AH-OVERRIDE-L6.
  7490     MOVE PI-AH-OVERRIDE-L12     TO SAVE-AH-OVERRIDE-L12.
  7491     MOVE PI-CERT-ACCESS-CONTROL TO SAVE-CERT-ACCESS-CONTROL.
  7492     MOVE PI-CARRIER-CONTROL-LEVEL  TO SAVE-CARRIER-CONTROL-LEVEL.
  7493     MOVE PI-PROGRAM-WORK-AREA (1:10)
  7494                                 TO SAVE-BENEFICIARY
  7495
  7496
  7497
  7498* EXEC CICS HANDLE CONDITION
  7499*        NOTFND  (0660-NOT-FOUND)
  7500*        QIDERR  (0670-QIDERR)
  7501*    END-EXEC.
  7502*    MOVE '"$IN                  ! % #00007316' TO DFHEIV0
  7503     MOVE X'2224494E2020202020202020' TO DFHEIV0(1:12)
  7504     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7505     MOVE X'2520233030303037333136' TO DFHEIV0(25:11)
  7506     CALL 'kxdfhei1' USING DFHEIV0
  7507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7508
  7509
  7510
  7511
  7512* EXEC CICS READQ TS
  7513*        QUEUE    (QID)
  7514*        INTO     (EL130AI)
  7515*        LENGTH   (QID-MAP-LENGTH)
  7516*    END-EXEC.
  7517*    MOVE '*$I    L              ''   #00007322' TO DFHEIV0
  7518     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7519     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7520     MOVE X'2020233030303037333232' TO DFHEIV0(25:11)
  7521     CALL 'kxdfhei1' USING DFHEIV0,
  7522           QID,
  7523           EL130AI,
  7524           QID-MAP-LENGTH,
  7525           DFHEIV99,
  7526           DFHEIV99,
  7527           DFHEIV99
  7528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7529
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 146
* EL130.cbl
  7530
  7531     IF RETURNED-FROM = XCTL-131
  7532        IF CLAIM-DELETED-BY-EL131
  7533            MOVE LOW-VALUES      TO CERTNOI
  7534                                    SUFXI
  7535            MOVE ZEROS           TO CERTNOL
  7536                                    SUFXL
  7537         END-IF
  7538     END-IF.
  7539
  7540     IF RETURNED-FROM = XCTL-131
  7541         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  7542         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7543                                    PI-CERT-PROCESSED
  7544     ELSE
  7545
  7546
  7547* EXEC CICS READQ TS
  7548*             QUEUE   (QID)
  7549*             INTO    (PROGRAM-INTERFACE-BLOCK)
  7550*             LENGTH  (PI-COMM-LENGTH)
  7551*        END-EXEC
  7552*    MOVE '*$I    L              ''   #00007343' TO DFHEIV0
  7553     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7554     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7555     MOVE X'2020233030303037333433' TO DFHEIV0(25:11)
  7556     CALL 'kxdfhei1' USING DFHEIV0,
  7557           QID,
  7558           PROGRAM-INTERFACE-BLOCK,
  7559           PI-COMM-LENGTH,
  7560           DFHEIV99,
  7561           DFHEIV99,
  7562           DFHEIV99
  7563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7564     END-IF.
  7565
  7566
  7567* EXEC CICS DELETEQ TS
  7568*        QUEUE   (QID)
  7569*    END-EXEC.
  7570*    MOVE '*&                    #   #00007350' TO DFHEIV0
  7571     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7572     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7573     MOVE X'2020233030303037333530' TO DFHEIV0(25:11)
  7574     CALL 'kxdfhei1' USING DFHEIV0,
  7575           QID,
  7576           DFHEIV99
  7577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7578
  7579
  7580     MOVE SAVE-CONTROL           TO PI-CONTROL-IN-PROGRESS.
  7581
  7582     IF RETURNED-FROM = XCTL-127 OR XCTL-132
  7583         MOVE SAVE-COMPANY-CD        TO PI-COMPANY-CD
  7584         MOVE SAVE-COMPANY-ID        TO PI-COMPANY-ID
  7585         MOVE SAVE-JOURNAL-FILE-ID   TO PI-JOURNAL-FILE-ID
  7586         MOVE SAVE-CREDIT-USER       TO PI-CREDIT-USER
  7587         MOVE SAVE-CLAIM-USER        TO PI-CLAIM-USER
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 147
* EL130.cbl
  7588         MOVE SAVE-LIFE-OVERRIDE-L1  TO PI-LIFE-OVERRIDE-L1
  7589         MOVE SAVE-LIFE-OVERRIDE-L2  TO PI-LIFE-OVERRIDE-L2
  7590         MOVE SAVE-LIFE-OVERRIDE-L6  TO PI-LIFE-OVERRIDE-L6
  7591         MOVE SAVE-LIFE-OVERRIDE-L12 TO PI-LIFE-OVERRIDE-L12
  7592         MOVE SAVE-AH-OVERRIDE-L1    TO PI-AH-OVERRIDE-L1
  7593         MOVE SAVE-AH-OVERRIDE-L2    TO PI-AH-OVERRIDE-L2
  7594         MOVE SAVE-AH-OVERRIDE-L6    TO PI-AH-OVERRIDE-L6
  7595         MOVE SAVE-AH-OVERRIDE-L12   TO PI-AH-OVERRIDE-L12
  7596         MOVE SAVE-CERT-ACCESS-CONTROL
  7597                                    TO PI-CERT-ACCESS-CONTROL
  7598         MOVE SAVE-CARRIER-CONTROL-LEVEL
  7599                                    TO PI-CARRIER-CONTROL-LEVEL
  7600     END-IF.
  7601
  7602     IF RETURNED-FROM = XCTL-127
  7603         MOVE SAVE-EL127-TO-EL130-CNTRL
  7604                                 TO PI-EL127-TO-EL130-CNTRL
  7605     END-IF.
  7606
  7607     IF RETURNED-FROM = XCTL-6592
  7608        MOVE SAVE-EL659-TO-EL130-CNTRL
  7609                                 TO PI-EL659-TO-EL130-CNTRL
  7610     END-IF.
  7611
  7612     IF RETURNED-FROM = XCTL-114
  7613        IF SAVE-BENEFICIARY NOT = SPACES AND LOW-VALUES
  7614           MOVE SAVE-BENEFICIARY TO BENECDI
  7615           MOVE +10              TO BENECDL
  7616           MOVE -1               TO BIRTHDTL
  7617        END-IF
  7618     END-IF.
  7619     PERFORM 3993-MODIFY-SCREEN-ATTRB THRU 3993-EXIT.
  7620
  7621     IF MAINTL NOT = ZERO
  7622         MOVE AL-UANON           TO MAINTA
  7623     END-IF.
  7624
  7625     IF ENTERPFL NOT = ZERO
  7626         MOVE AL-UNNON           TO ENTERPFA
  7627     END-IF.
  7628
  7629     IF RETURNED-FROM = XCTL-127
  7630         GO TO 0650-FROM-EL127
  7631     END-IF.
  7632
  7633     IF RETURNED-FROM = XCTL-132
  7634         GO TO 0640-FROM-EL132
  7635     END-IF.
  7636
  7637     IF RETURNED-FROM = XCTL-650
  7638         MOVE AL-SABON           TO PF5A
  7639         PERFORM 0690-HIGHLIGHT-CERTS THRU 0690-EXIT
  7640     END-IF.
  7641
  7642     IF RETURNED-FROM = XCTL-6592
  7643         GO TO 0630-FROM-EL6592
  7644     END-IF.
  7645
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 148
* EL130.cbl
  7646     IF MAINTI = 'S' OR 'I'
  7647        GO TO 1000-SHOW-CLAIM
  7648     END-IF.
  7649
  7650     GO TO 8100-SEND-INITIAL-MAP.
  7651
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 149
* EL130.cbl
  7653 0630-FROM-EL6592.
  7654     MOVE PI-EL659-CARRIER       TO CRTCARRO.
  7655     MOVE PI-EL659-GROUPING      TO GROUPO.
  7656     MOVE PI-EL659-STATE         TO STATEO.
  7657     MOVE PI-EL659-ACCOUNT       TO ACCOUNTO.
  7658
  7659     MOVE AL-UANON               TO CRTCARRA
  7660                                    GROUPA
  7661                                    STATEA
  7662                                    ACCOUNTA.
  7663     GO TO 8100-SEND-INITIAL-MAP.
  7664
  7665 0640-FROM-EL132.
  7666     IF PI-CLAIM-NO = SPACES
  7667         GO TO 0645-NO-CLAIM-SELECTED
  7668     END-IF.
  7669
  7670     MOVE LOW-VALUES             TO EL130AI.
  7671     MOVE 'MSTR'                 TO FILE-SWITCH.
  7672     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  7673     MOVE PI-CARRIER             TO MSTR-CARRIER.
  7674     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO
  7675                                    CLMNOO.
  7676     MOVE AL-UANON               TO CLMNOA.
  7677     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  7678
  7679
  7680
  7681* EXEC CICS HANDLE CONDITION
  7682*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  7683*    END-EXEC.
  7684*    MOVE '"$I                   ! & #00007454' TO DFHEIV0
  7685     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7686     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7687     MOVE X'2620233030303037343534' TO DFHEIV0(25:11)
  7688     CALL 'kxdfhei1' USING DFHEIV0
  7689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7690
  7691
  7692     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  7693     MOVE 'X'                    TO CLAIM-SWITCH.
  7694     PERFORM 7910-READ-NINETY THRU 7910-EXIT.
  7695     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
  7696     PERFORM 7910-READ-ACTV THRU 7910-EXIT.
  7697     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  7698
  7699     MOVE ER-0213                TO EMI-ERROR.
  7700     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7701     MOVE PI-CLAIM-NO            TO EMI-TEXT-VARIABLE (1).
  7702     GO TO 8100-SEND-INITIAL-MAP.
  7703
  7704 0645-NO-CLAIM-SELECTED.
  7705
  7706     IF MAINTI = 'S' OR 'I'
  7707        GO TO 1000-SHOW-CLAIM
  7708     END-IF.
  7709
  7710     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 150
* EL130.cbl
  7711
  7712 0650-FROM-EL127.
  7713
  7714     IF PI-CERT-SELECT-CNT GREATER THAN +6
  7715         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7716                                    PI-CERT-PROCESSED
  7717     END-IF.
  7718
  7719     IF PI-RETURN-TO-PROGRAM = XCTL-727
  7720         MOVE +1                 TO PI-CERT-SELECT-CNT
  7721                                    PI-CERT-PROCESSED
  7722         MOVE PI-CARRIER         TO PI-EL127-CARRIER (1)
  7723         MOVE PI-GROUPING        TO PI-EL127-GROUPING (1)
  7724         MOVE PI-STATE           TO PI-EL127-STATE   (1)
  7725         MOVE PI-ACCOUNT         TO PI-EL127-ACCOUNT (1)
  7726         MOVE PI-CERT-EFF-DT     TO PI-EL127-EFF-DT  (1)
  7727         MOVE PI-CERT-NO         TO PI-EL127-CERT-NO (1)
  7728     END-IF.
  7729
  7730     IF PI-CERT-SELECT-CNT = ZERO
  7731         IF CERTNOI NOT = SPACES AND LOW-VALUES
  7732             MOVE CERTNOI        TO PI-CERT-NO
  7733             MOVE SUFXI          TO PI-CERT-SFX
  7734             GO TO 3000-READ-CERT
  7735         ELSE
  7736             GO TO 8100-SEND-INITIAL-MAP
  7737         END-IF
  7738     END-IF.
  7739
  7740     MOVE AL-SABON               TO PF5A.
  7741
  7742     IF PI-CERT-PROCESSED = 1
  7743         PERFORM 0680-PLUG-SELECTED-CERTS THRU 0680-EXIT
  7744     END-IF.
  7745
  7746     PERFORM 0690-HIGHLIGHT-CERTS    THRU 0690-EXIT.
  7747     PERFORM 3993-MODIFY-CLAIM-ATTRB THRU 3993-EXIT.
  7748
  7749     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  7750     MOVE PI-EL127-CARRIER (PI-CERT-PROCESSED)
  7751                                 TO CERT-CARRIER
  7752                                    PI-CARRIER.
  7753     MOVE PI-EL127-GROUPING(PI-CERT-PROCESSED)
  7754                                 TO CERT-GROUPING
  7755                                    PI-GROUPING.
  7756     MOVE PI-EL127-STATE   (PI-CERT-PROCESSED)
  7757                                 TO CERT-STATE
  7758                                    PI-STATE.
  7759     MOVE PI-EL127-ACCOUNT (PI-CERT-PROCESSED)
  7760                                 TO CERT-ACCOUNT
  7761                                    PI-ACCOUNT.
  7762     MOVE PI-EL127-EFF-DT  (PI-CERT-PROCESSED)
  7763                                 TO CERT-EFF-DT
  7764                                    PI-CERT-EFF-DT.
  7765     MOVE PI-EL127-CERT-NO (PI-CERT-PROCESSED)
  7766                                 TO CERT-CERT-NO
  7767                                    PI-CERT-NO.
  7768
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 151
* EL130.cbl
  7769     MOVE 'CERT'                 TO FILE-SWITCH.
  7770     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  7771
  7772     MOVE CERT-CERT-NO           TO PI-SAVE-CERT.
  7773     MOVE CERT-ACCOUNT           TO PI-SAVE-ACCOUNT.
  7774     MOVE CERT-EFF-DT            TO PI-SAVE-EFFDT.
  7775
  7776     IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  7777         MOVE PI-COMPANY-CD      TO MSTR5-COMP-CD
  7778         MOVE CERT-CERT-NO       TO MSTR5-CERT-NO
  7779         PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  7780         IF INCURRED-DATE-MATCH
  7781             MOVE ER-7352        TO EMI-ERROR
  7782             MOVE -1             TO CERTNOL
  7783             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7784         ELSE
  7785             IF NO-CLAIMS-FOR-CERT
  7786                 MOVE ER-7353    TO EMI-ERROR
  7787                 MOVE -1         TO CERTNOL
  7788                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7789             ELSE
  7790                 MOVE ER-0558    TO EMI-ERROR
  7791                 MOVE -1         TO CERTNOL
  7792                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7793             END-IF
  7794         END-IF
  7795     END-IF.
  7796
  7797     MOVE SPACES                 TO PI-PRT-OPT
  7798                                    PI-ALT-PRT.
  7799
  7800     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  7801
  7802     IF LSTNMEL NOT GREATER ZERO
  7803        AND CRTLNMEI NOT = (SPACES AND LOW-VALUES)
  7804         MOVE CRTLNMEI           TO  LSTNMEO
  7805         MOVE CRTFNMEI           TO  FSTNMEO
  7806         MOVE CRTINITI           TO  INITO
  7807         MOVE AL-UANON           TO  LSTNMEA
  7808                                     FSTNMEA
  7809                                     INITA
  7810     END-IF.
  7811
  7812     IF SSNL GREATER ZERO
  7813         GO TO 0655-SKIP-SOCIAL-SECURITY
  7814     END-IF.
  7815
  7816     IF CRTSSNI = SPACES OR LOW-VALUES
  7817         GO TO 0655-SKIP-SOCIAL-SECURITY
  7818     END-IF.
  7819
  7820     IF CM-SSN-STATE   = CM-STATE AND
  7821        CM-SSN-ACCOUNT = CM-ACCOUNT-PRIME
  7822            GO TO 0655-SKIP-SOCIAL-SECURITY
  7823     END-IF.
  7824
  7825     MOVE CRTSSNI                TO SSNO
  7826     MOVE AL-UANON               TO SSNA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 152
* EL130.cbl
  7827
  7828 0655-SKIP-SOCIAL-SECURITY.
  7829
  7830     IF CLMCARRL NOT = ZERO  AND
  7831        CLMCARRI NOT = CRTCARRI
  7832        MOVE ER-0562             TO EMI-ERROR
  7833        MOVE AL-UABON            TO CLMCARRA
  7834        MOVE -1                  TO CLMCARRL
  7835        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7836     END-IF.
  7837
  7838     IF CLMCARRL = ZERO
  7839        MOVE AL-UANON            TO CLMCARRA
  7840        MOVE CRTCARRI            TO CLMCARRI
  7841     END-IF.
  7842
  7843     MOVE 'A'                    TO MAINTO.
  7844     MOVE AL-UANON               TO MAINTA.
  7845
  7846     IF PI-RETURN-TO-PROGRAM = XCTL-127 OR XCTL-727
  7847        GO TO 8100-SEND-INITIAL-MAP
  7848     ELSE
  7849        GO TO 8150-SEND-MAP-CURSOR
  7850     END-IF.
  7851
  7852 0660-NOT-FOUND.
  7853     MOVE ER-0214                TO EMI-ERROR.
  7854     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7855     GO TO 8100-SEND-INITIAL-MAP.
  7856
  7857 0670-QIDERR.
  7858     MOVE ER-0033                TO EMI-ERROR.
  7859     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7860     GO TO 8100-SEND-INITIAL-MAP.
  7861
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 153
* EL130.cbl
  7863 0680-PLUG-SELECTED-CERTS.
  7864
  7865     MOVE AL-SANON               TO BCERT1A
  7866                                    BSUFX1A
  7867                                    BCERT2A
  7868                                    BSUFX2A
  7869                                    BCERT3A
  7870                                    BSUFX3A
  7871                                    BCERT4A
  7872                                    BSUFX4A
  7873                                    BCERT5A
  7874                                    BSUFX5A.
  7875
  7876     IF PCERTNOO = SPACES OR LOW-VALUES
  7877         MOVE PI-EL127-CERT-PRIME (1)
  7878                                 TO PCERTNOO
  7879         MOVE PI-EL127-CERT-SUFX  (1)
  7880                                 TO PSUFXO
  7881     END-IF.
  7882
  7883     MOVE PI-EL127-CERT-PRIME (1)
  7884                                 TO BCERT1O.
  7885     MOVE PI-EL127-CERT-SUFX  (1)
  7886                                 TO BSUFX1O.
  7887
  7888     IF PI-CERT-SELECT-CNT GREATER THAN 1
  7889         MOVE PI-EL127-CERT-PRIME (2)
  7890                                 TO BCERT2O
  7891         MOVE PI-EL127-CERT-SUFX  (2)
  7892                                 TO BSUFX2O
  7893     ELSE
  7894         MOVE LOW-VALUES         TO BCERT2O
  7895                                    BSUFX2O
  7896     END-IF.
  7897
  7898     IF PI-CERT-SELECT-CNT GREATER THAN 2
  7899         MOVE PI-EL127-CERT-PRIME (3)
  7900                                 TO BCERT3O
  7901         MOVE PI-EL127-CERT-SUFX  (3)
  7902                                 TO BSUFX3O
  7903     ELSE
  7904         MOVE LOW-VALUES         TO BCERT3O
  7905                                    BSUFX3O
  7906     END-IF.
  7907
  7908     IF PI-CERT-SELECT-CNT GREATER THAN 3
  7909         MOVE PI-EL127-CERT-PRIME (4)
  7910                                 TO BCERT4O
  7911         MOVE PI-EL127-CERT-SUFX  (4)
  7912                                 TO BSUFX4O
  7913     ELSE
  7914         MOVE LOW-VALUES         TO BCERT4O
  7915                                    BSUFX4O
  7916     END-IF.
  7917
  7918     IF PI-CERT-SELECT-CNT GREATER THAN 4
  7919         MOVE PI-EL127-CERT-PRIME (5)
  7920                                 TO BCERT5O
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 154
* EL130.cbl
  7921         MOVE PI-EL127-CERT-SUFX  (5)
  7922                                 TO BSUFX5O
  7923     ELSE
  7924         MOVE LOW-VALUES         TO BCERT5O
  7925                                    BSUFX5O
  7926     END-IF.
  7927
  7928 0680-EXIT.
  7929     EXIT.
  7930
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 155
* EL130.cbl
  7932 0690-HIGHLIGHT-CERTS.
  7933
  7934     MOVE AL-UANON               TO PCERTNOA
  7935                                    PSUFXA.
  7936
  7937     IF BCERT1O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  7938        BSUFX1O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  7939            MOVE AL-SABON        TO BCERT1A
  7940                                    BSUFX1A
  7941     ELSE
  7942         MOVE AL-SANON           TO BCERT1A
  7943                                    BSUFX1A
  7944     END-IF.
  7945
  7946     IF BCERT2O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  7947        BSUFX2O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  7948            MOVE AL-SABON        TO BCERT2A
  7949                                    BSUFX2A
  7950     ELSE
  7951         MOVE AL-SANON           TO BCERT2A
  7952                                    BSUFX2A
  7953     END-IF.
  7954
  7955     IF BCERT3O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  7956        BSUFX3O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  7957            MOVE AL-SABON        TO BCERT3A
  7958                                    BSUFX3A
  7959     ELSE
  7960         MOVE AL-SANON           TO BCERT3A
  7961                                    BSUFX3A
  7962     END-IF.
  7963
  7964     IF BCERT4O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  7965        BSUFX4O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  7966            MOVE AL-SABON        TO BCERT4A
  7967                                    BSUFX4A
  7968     ELSE
  7969         MOVE AL-SANON           TO BCERT4A
  7970                                    BSUFX4A
  7971     END-IF.
  7972
  7973     IF BCERT5O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  7974        BSUFX5O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  7975            MOVE AL-SABON        TO BCERT5A
  7976                                    BSUFX5A
  7977     ELSE
  7978         MOVE AL-SANON           TO BCERT5A
  7979                                    BSUFX5A
  7980     END-IF.
  7981
  7982 0690-EXIT.
  7983     EXIT.
  7984
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 156
* EL130.cbl
  7986 0800-TEST-PREVIOUS-CONTROL.
  7987     IF CLMNOI   = PI-LAST-CLAIM       AND
  7988        CLMCARRI = PI-LAST-CARR        AND
  7989        CERTNOI  = PI-LAST-CERT-PRIME  AND
  7990        SUFXI    = PI-LAST-CERT-SUFX
  7991*        NEXT SENTENCE
  7992         CONTINUE
  7993     ELSE
  7994         MOVE ER-0207            TO EMI-ERROR
  7995         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7996         MOVE -1                 TO MAINTL
  7997         GO TO 8200-SEND-DATAONLY
  7998     END-IF.
  7999
  8000     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
  8001
  8002     MOVE PI-LAST-CLAIM          TO PI-CLAIM-NO.
  8003     MOVE PI-LAST-CARR           TO PI-CARRIER.
  8004     MOVE PI-LAST-CERT           TO PI-CERT-NO.
  8005
  8006     IF EIBAID = DFHPF7
  8007         MOVE XCTL-157           TO PGM-NAME
  8008     END-IF.
  8009
  8010     IF EIBAID = DFHPF8
  8011         MOVE XCTL-141           TO PGM-NAME
  8012     END-IF.
  8013
  8014     IF EIBAID = DFHPF9
  8015        MOVE SPACES              TO PI-SAVED-PROGRAM-1
  8016                                    PI-SAVED-PROGRAM-2
  8017                                    PI-SAVED-PROGRAM-3
  8018                                    PI-SAVED-PROGRAM-4
  8019                                    PI-SAVED-PROGRAM-5
  8020                                    PI-SAVED-PROGRAM-6
  8021        MOVE XCTL-126            TO PI-RETURN-TO-PROGRAM
  8022        MOVE XCTL-132            TO PI-CALLING-PROGRAM
  8023        MOVE XCTL-150            TO PGM-NAME
  8024     END-IF.
  8025
  8026     GO TO 9300-XCTL.
  8027
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 157
* EL130.cbl
  8029 1000-SHOW-CLAIM.
  8030
  8031     IF CLMNOL = ZERO
  8032         MOVE -1                 TO CLMNOL
  8033         MOVE AL-UABON           TO CLMNOA
  8034         MOVE ER-0202            TO EMI-ERROR
  8035         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8036     ELSE
  8037         MOVE AL-UANON           TO CLMNOA
  8038     END-IF.
  8039
  8040     IF PI-NO-CARRIER-SECURITY
  8041        IF CLMCARRL = ZERO
  8042             MOVE -1             TO CLMCARRL
  8043             MOVE AL-UABON       TO CLMCARRA
  8044             MOVE ER-0194        TO EMI-ERROR
  8045             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8046         ELSE
  8047             MOVE AL-UANON       TO CLMCARRA
  8048         END-IF
  8049     END-IF.
  8050
  8051     IF SUFXL = ZERO
  8052         MOVE SPACES             TO SUFXI
  8053         MOVE AL-UANON           TO SUFXA
  8054     ELSE
  8055         MOVE AL-UANON           TO SUFXA
  8056     END-IF.
  8057
  8058     IF NOT EMI-NO-ERRORS
  8059         GO TO 1050-SEND-CHECK
  8060     END-IF.
  8061
  8062
  8063
  8064* EXEC CICS HANDLE CONDITION
  8065*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8066*    END-EXEC.
  8067*    MOVE '"$I                   ! '' #00007829' TO DFHEIV0
  8068     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8069     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8070     MOVE X'2720233030303037383239' TO DFHEIV0(25:11)
  8071     CALL 'kxdfhei1' USING DFHEIV0
  8072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8073
  8074
  8075     MOVE 'MSTR'                 TO FILE-SWITCH
  8076     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8077
  8078     MOVE CLMCARRI               TO MSTR-CARRIER.
  8079     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8080
  8081     IF CERTNOL = ZERO     OR
  8082        CERTNOI = SPACES   OR
  8083        CERTNOI = LOW-VALUES
  8084         PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT
  8085         MOVE AL-SANON        TO CERTNOA
  8086                                 SUFXA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 158
* EL130.cbl
  8087     ELSE
  8088         PERFORM 7610-BROWSE-CLAIM-LOOP THRU 7699-EXIT
  8089     END-IF.
  8090
  8091     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8092     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8093
  8094
  8095
  8096* EXEC CICS HANDLE CONDITION
  8097*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8098*    END-EXEC.
  8099*    MOVE '"$I                   ! ( #00007853' TO DFHEIV0
  8100     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8101     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8102     MOVE X'2820233030303037383533' TO DFHEIV0(25:11)
  8103     CALL 'kxdfhei1' USING DFHEIV0
  8104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8105
  8106
  8107     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  8108
  8109     IF NOT PI-NO-ACCOUNT-SECURITY
  8110         IF PI-ACCOUNT-SECURITY NOT = CL-CERT-ACCOUNT
  8111           MOVE ER-2371          TO EMI-ERROR
  8112           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8113           MOVE -1               TO MAINTL
  8114           GO TO 8200-SEND-DATAONLY
  8115         END-IF
  8116     END-IF.
  8117
  8118
  8119
  8120* EXEC CICS HANDLE CONDITION
  8121*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8122*    END-EXEC.
  8123*    MOVE '"$I                   ! ) #00007869' TO DFHEIV0
  8124     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8125     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8126     MOVE X'2920233030303037383639' TO DFHEIV0(25:11)
  8127     CALL 'kxdfhei1' USING DFHEIV0
  8128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8129
  8130
  8131     MOVE 'Y'                    TO CLAIM-SWITCH.
  8132     PERFORM 7910-READ-NINETY THRU 7910-EXIT.
  8133     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
  8134     PERFORM 7910-READ-ACTV THRU 7910-EXIT.
  8135
  8136 1000-SHOW-END-OF-PERFORM.
  8137
  8138     MOVE MSTR-COMP-CD           TO CERT-COMP-CD.
  8139     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  8140     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  8141     MOVE CL-CERT-STATE          TO CERT-STATE.
  8142     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  8143     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  8144     MOVE CL-CERT-NO             TO CERT-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 159
* EL130.cbl
  8145
  8146     MOVE 'CERT'                 TO FILE-SWITCH.
  8147
  8148     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  8149
  8150     MOVE CL-LAST-MAINT-DT       TO PI-MSTR-DT.
  8151     MOVE CL-LAST-MAINT-HHMMSS   TO PI-MSTR-WHEN.
  8152     MOVE AT-RECORDED-DT         TO PI-TRLR-DT.
  8153     MOVE AT-LAST-MAINT-HHMMSS   TO PI-TRLR-WHEN.
  8154     MOVE CLMNOI                 TO PI-LAST-CLAIM.
  8155     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
  8156     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
  8157     MOVE CLMCARRI               TO PI-LAST-CARR.
  8158
  8159     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  8160
  8161     IF MAINTI = 'I'
  8162         MOVE AL-SANOF TO  FSTNMEA   INITA     SEXA
  8163                 BIRTHDTA  LSTNMEA   RELCLMA   OCCCDA
  8164                 LOANNOA   LOANBALA  BENECDA
  8165         MOVE AL-SANON TO  SSNA
  8166         MOVE SPACES   TO  INCURI    REPORTI  ESTENDI
  8167         MOVE 'Y'      TO PI-INCURR-SW
  8168         MOVE ER-0522  TO EMI-ERROR
  8169         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8170     ELSE
  8171         MOVE ' '      TO PI-INCURR-SW
  8172     END-IF.
  8173
  8174     MOVE -1                     TO MAINTL.
  8175     MOVE MSTR-CARRIER           TO PI-CARRIER.
  8176     MOVE CERT-GROUPING          TO PI-GROUPING.
  8177     MOVE CERT-STATE             TO PI-STATE.
  8178     MOVE CERT-ACCOUNT           TO PI-ACCOUNT.
  8179     MOVE MSTR-CLAIM-NO          TO PI-CLAIM-NO.
  8180     MOVE MSTR-CERT-NO           TO PI-CERT-NO.
  8181     MOVE CERT-EFF-DT            TO PI-CERT-EFF-DT.
  8182
  8183     IF RETURNED-FROM NOT = SPACES
  8184         GO TO 8100-SEND-INITIAL-MAP
  8185     ELSE
  8186         GO TO 8200-SEND-DATAONLY
  8187     END-IF.
  8188
  8189 1025-SHOW-RECORD-NOT-FOUND.
  8190
  8191     IF FILE-SWITCH = 'MSTR'
  8192         MOVE ER-0204            TO EMI-ERROR
  8193     ELSE
  8194         IF FILE-SWITCH = 'TRLR'
  8195             MOVE ER-0205        TO EMI-ERROR
  8196         ELSE
  8197             MOVE ER-0206        TO EMI-ERROR
  8198         END-IF
  8199     END-IF.
  8200
  8201     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8202
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 160
* EL130.cbl
  8203 1050-SEND-CHECK.
  8204
  8205     IF RETURNED-FROM NOT = SPACES
  8206         GO TO 8100-SEND-INITIAL-MAP
  8207     ELSE
  8208         MOVE -1                 TO MAINTL
  8209         GO TO 8200-SEND-DATAONLY
  8210     END-IF.
  8211
  8212 2000-DELETE-CLAIM.
  8213     IF NOT MODIFY-CAP
  8214         MOVE ER-0070            TO EMI-ERROR
  8215         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8216         MOVE -1                 TO MAINTL
  8217         GO TO 8200-SEND-DATAONLY
  8218     END-IF.
  8219
  8220     IF CLMNOI   NOT = PI-LAST-CLAIM       OR
  8221        CLMCARRI NOT = PI-LAST-CARR        OR
  8222        CERTNOI  NOT = PI-LAST-CERT-PRIME  OR
  8223        SUFXI    NOT = PI-LAST-CERT-SUFX
  8224         MOVE ER-0207            TO EMI-ERROR
  8225         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8226         MOVE -1                 TO MAINTL
  8227         GO TO 8200-SEND-DATAONLY
  8228     END-IF.
  8229
  8230
  8231
  8232* EXEC CICS HANDLE CONDITION
  8233*        NOTFND   (2050-DELETE-NOT-FOUND)
  8234*    END-EXEC.
  8235*    MOVE '"$I                   ! * #00007973' TO DFHEIV0
  8236     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8237     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8238     MOVE X'2A20233030303037393733' TO DFHEIV0(25:11)
  8239     CALL 'kxdfhei1' USING DFHEIV0
  8240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8241
  8242
  8243     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8244
  8245     MOVE CLMCARRI               TO MSTR-CARRIER.
  8246     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8247     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8248     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8249
  8250     MOVE 'MSTR'                 TO FILE-SWITCH.
  8251     PERFORM 7920-READ-CLAIM-UPDATE THRU 7920-EXIT.
  8252
  8253     MOVE 'Y'                    TO CLAIM-SWITCH.
  8254
  8255     IF PI-MSTR-DT   NOT = CL-LAST-MAINT-DT  OR
  8256        PI-MSTR-WHEN NOT = CL-LAST-MAINT-HHMMSS
  8257         MOVE ER-0068        TO EMI-ERROR
  8258         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8259         MOVE -1             TO MAINTL
  8260         GO TO 8200-SEND-DATAONLY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 161
* EL130.cbl
  8261     END-IF.
  8262
  8263     IF CL-TRAILER-SEQ-CNT NOT = 4095
  8264         MOVE ER-0569            TO EMI-ERROR
  8265         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8266         MOVE -1                 TO MAINTL
  8267         GO TO 8200-SEND-DATAONLY
  8268     END-IF.
  8269
  8270     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
  8271         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS
  8272     END-IF.
  8273
  8274     IF CL-PURGED-DT NOT = LOW-VALUES
  8275         MOVE ER-7691            TO EMI-ERROR
  8276         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8277         MOVE -1                 TO MAINTL
  8278         GO TO 8200-SEND-DATAONLY
  8279     END-IF.
  8280
  8281     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
  8282     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
  8283     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
  8284     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
  8285     MOVE +0                     TO TRLR-SEQ-NO.
  8286     MOVE '1'                    TO TRLR-TYPE.
  8287
  8288     MOVE 'TRLR'                 TO FILE-SWITCH.
  8289
  8290
  8291
  8292* EXEC CICS READ
  8293*        UPDATE
  8294*        DATASET  (ELTRLR-DSID)
  8295*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8296*        RIDFLD   (ELTRLR-KEY)
  8297*    END-EXEC.
  8298*    MOVE '&"S        EU         (   #00008025' TO DFHEIV0
  8299     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8300     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8301     MOVE X'2020233030303038303235' TO DFHEIV0(25:11)
  8302     CALL 'kxdfhei1' USING DFHEIV0,
  8303           ELTRLR-DSID,
  8304           DFHEIV20,
  8305           DFHEIV99,
  8306           ELTRLR-KEY,
  8307           DFHEIV99,
  8308           DFHEIV99,
  8309           DFHEIV99
  8310     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8311         DFHEIV20
  8312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8313
  8314
  8315     IF PI-TRLR-DT   NOT = AT-RECORDED-DT  OR
  8316        PI-TRLR-WHEN NOT = AT-LAST-MAINT-HHMMSS
  8317         MOVE ER-0068        TO EMI-ERROR
  8318         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 162
* EL130.cbl
  8319         MOVE -1             TO MAINTL
  8320         GO TO 8200-SEND-DATAONLY
  8321     END-IF.
  8322
  8323
  8324
  8325* EXEC CICS DELETE
  8326*        DATASET   (ELTRLR-DSID)
  8327*    END-EXEC.
  8328*    MOVE '&(                    &   #00008041' TO DFHEIV0
  8329     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8330     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8331     MOVE X'2020233030303038303431' TO DFHEIV0(25:11)
  8332     CALL 'kxdfhei1' USING DFHEIV0,
  8333           ELTRLR-DSID,
  8334           DFHEIV99,
  8335           DFHEIV99,
  8336           DFHEIV99,
  8337           DFHEIV99
  8338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8339
  8340
  8341     MOVE +90                    TO TRLR-SEQ-NO.
  8342     MOVE '6'                    TO TRLR-TYPE.
  8343
  8344
  8345
  8346* EXEC CICS READ
  8347*        UPDATE
  8348*        DATASET  (ELTRLR-DSID)
  8349*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8350*        RIDFLD   (ELTRLR-KEY)
  8351*    END-EXEC.
  8352*    MOVE '&"S        EU         (   #00008049' TO DFHEIV0
  8353     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8354     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8355     MOVE X'2020233030303038303439' TO DFHEIV0(25:11)
  8356     CALL 'kxdfhei1' USING DFHEIV0,
  8357           ELTRLR-DSID,
  8358           DFHEIV20,
  8359           DFHEIV99,
  8360           ELTRLR-KEY,
  8361           DFHEIV99,
  8362           DFHEIV99,
  8363           DFHEIV99
  8364     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8365         DFHEIV20
  8366     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8367
  8368
  8369
  8370
  8371* EXEC CICS DELETE
  8372*        DATASET   (ELTRLR-DSID)
  8373*    END-EXEC.
  8374*    MOVE '&(                    &   #00008057' TO DFHEIV0
  8375     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8376     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 163
* EL130.cbl
  8377     MOVE X'2020233030303038303537' TO DFHEIV0(25:11)
  8378     CALL 'kxdfhei1' USING DFHEIV0,
  8379           ELTRLR-DSID,
  8380           DFHEIV99,
  8381           DFHEIV99,
  8382           DFHEIV99,
  8383           DFHEIV99
  8384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8385
  8386
  8387     MOVE +91                    TO TRLR-SEQ-NO.
  8388     MOVE '6'                    TO TRLR-TYPE.
  8389
  8390
  8391
  8392* EXEC CICS READ
  8393*        UPDATE
  8394*        DATASET  (ELTRLR-DSID)
  8395*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8396*        RIDFLD   (ELTRLR-KEY)
  8397*        RESP     (WS-RESPONSE)
  8398*    END-EXEC
  8399*    MOVE '&"S        EU         (  N#00008065' TO DFHEIV0
  8400     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8401     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8402     MOVE X'204E233030303038303635' TO DFHEIV0(25:11)
  8403     CALL 'kxdfhei1' USING DFHEIV0,
  8404           ELTRLR-DSID,
  8405           DFHEIV20,
  8406           DFHEIV99,
  8407           ELTRLR-KEY,
  8408           DFHEIV99,
  8409           DFHEIV99,
  8410           DFHEIV99
  8411     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8412         DFHEIV20
  8413     MOVE EIBRESP  TO WS-RESPONSE
  8414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8415
  8416     IF WS-RESP-NORMAL
  8417
  8418* EXEC CICS DELETE
  8419*          DATASET   (ELTRLR-DSID)
  8420*       END-EXEC
  8421*    MOVE '&(                    &   #00008074' TO DFHEIV0
  8422     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8423     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8424     MOVE X'2020233030303038303734' TO DFHEIV0(25:11)
  8425     CALL 'kxdfhei1' USING DFHEIV0,
  8426           ELTRLR-DSID,
  8427           DFHEIV99,
  8428           DFHEIV99,
  8429           DFHEIV99,
  8430           DFHEIV99
  8431     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8432     END-IF.
  8433
  8434     MOVE MSTR-COMP-CD           TO CERT-COMP-CD.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 164
* EL130.cbl
  8435     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  8436     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  8437     MOVE CL-CERT-STATE          TO CERT-STATE.
  8438     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  8439     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  8440     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  8441
  8442     MOVE 'CERT'                 TO FILE-SWITCH.
  8443
  8444     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
  8445
  8446     SUBTRACT +1 FROM CM-CLAIM-ATTACHED-COUNT GIVING WS-NUM-HOLD.
  8447
  8448     IF WS-NUM-HOLD NOT = +0
  8449         GO TO 2005-REWRITE-CERT
  8450     END-IF.
  8451
  8452     IF NOT CERT-WAS-CREATED
  8453         MOVE SPACE              TO CM-CLAIM-INTERFACE-SW
  8454         GO TO 2005-REWRITE-CERT
  8455     END-IF.
  8456
  8457
  8458
  8459* EXEC CICS DELETE
  8460*        DATASET   (ELCERT-DSID)
  8461*    END-EXEC.
  8462*    MOVE '&(                    &   #00008103' TO DFHEIV0
  8463     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8464     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8465     MOVE X'2020233030303038313033' TO DFHEIV0(25:11)
  8466     CALL 'kxdfhei1' USING DFHEIV0,
  8467           ELCERT-DSID,
  8468           DFHEIV99,
  8469           DFHEIV99,
  8470           DFHEIV99,
  8471           DFHEIV99
  8472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8473
  8474
  8475     GO TO 2010-DELETE-CL.
  8476
  8477 2005-REWRITE-CERT.
  8478
  8479     SUBTRACT +1 FROM CM-CLAIM-ATTACHED-COUNT.
  8480
  8481
  8482
  8483* EXEC CICS HANDLE CONDITION
  8484*         DUPKEY   (2010-DELETE-CL)
  8485*    END-EXEC.
  8486*    MOVE '"$$                   ! + #00008114' TO DFHEIV0
  8487     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8488     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8489     MOVE X'2B20233030303038313134' TO DFHEIV0(25:11)
  8490     CALL 'kxdfhei1' USING DFHEIV0
  8491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8492
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 165
* EL130.cbl
  8493
  8494
  8495
  8496* EXEC CICS REWRITE
  8497*        DATASET  (ELCERT-DSID)
  8498*        FROM     (CERTIFICATE-MASTER)
  8499*    END-EXEC.
  8500     MOVE LENGTH OF
  8501      CERTIFICATE-MASTER
  8502       TO DFHEIV11
  8503*    MOVE '&& L                  %   #00008119' TO DFHEIV0
  8504     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8505     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8506     MOVE X'2020233030303038313139' TO DFHEIV0(25:11)
  8507     CALL 'kxdfhei1' USING DFHEIV0,
  8508           ELCERT-DSID,
  8509           CERTIFICATE-MASTER,
  8510           DFHEIV11,
  8511           DFHEIV99
  8512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8513
  8514
  8515 2010-DELETE-CL.
  8516
  8517
  8518
  8519* EXEC CICS DELETE
  8520*        DATASET  (ELMSTR-DSID)
  8521*    END-EXEC.
  8522*    MOVE '&(                    &   #00008127' TO DFHEIV0
  8523     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8524     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8525     MOVE X'2020233030303038313237' TO DFHEIV0(25:11)
  8526     CALL 'kxdfhei1' USING DFHEIV0,
  8527           ELMSTR-DSID,
  8528           DFHEIV99,
  8529           DFHEIV99,
  8530           DFHEIV99,
  8531           DFHEIV99
  8532     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8533
  8534
  8535     MOVE -1                     TO ONE-OR-MIN1.
  8536     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
  8537
  8538     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
  8539         MOVE CL-CONTROL-PRIMARY TO ELMSTR-KEY
  8540                                    WS-SAVE-CLAIM-KEY
  8541         MOVE +1                 TO ONE-OR-MIN1
  8542         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT
  8543     END-IF.
  8544
  8545     MOVE ER-0000                TO EMI-ERROR.
  8546     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8547     MOVE LOW-VALUES             TO EL130AO.
  8548     MOVE -1                     TO MAINTL.
  8549     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
  8550     MOVE ZEROS                  TO PI-CERT-SELECT-CNT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 166
* EL130.cbl
  8551                                    PI-CERT-PROCESSED
  8552                                    PI-LETTER-ERROR-CODE.
  8553     GO TO 8100-SEND-INITIAL-MAP.
  8554
  8555 2050-DELETE-NOT-FOUND.
  8556     IF FILE-SWITCH = 'MSTR'
  8557         MOVE -1                 TO CLMNOL
  8558         MOVE ER-0204            TO EMI-ERROR
  8559     ELSE
  8560         IF FILE-SWITCH = 'TRLR'
  8561             MOVE -1             TO MAINTL
  8562             MOVE ER-0205        TO EMI-ERROR
  8563         ELSE
  8564             MOVE -1             TO CERTNOL
  8565             MOVE ER-0206        TO EMI-ERROR
  8566         END-IF
  8567     END-IF.
  8568
  8569     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8570     GO TO 8200-SEND-DATAONLY.
  8571
  8572 3000-ADD-CLAIM.
  8573     IF NOT MODIFY-CAP
  8574         MOVE ER-0070            TO EMI-ERROR
  8575         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8576         MOVE -1                 TO MAINTL
  8577         GO TO 8200-SEND-DATAONLY
  8578     END-IF.
  8579
  8580     PERFORM 6000-EDIT-CLAIM-DATA THRU 6000-EXIT.
  8581
  8582     IF CERTMTI = 'S'
  8583         IF CERTNOI  = PI-SAVE-CERT-PRIME  AND
  8584            SUFXI    = PI-SAVE-CERT-SUFX   AND
  8585            WS-EFFDT = PI-SAVE-EFFDT       AND
  8586            ACCOUNTI = PI-SAVE-ACCOUNT
  8587             IF EMI-ERROR = 0
  8588                 GO TO 3010-TEST-FOR-ERRORS
  8589             ELSE
  8590                 MOVE PI-COMPANY-CD    TO  CERT-COMP-CD
  8591                 MOVE PI-CARRIER       TO  CERT-CARRIER
  8592                 MOVE PI-GROUPING      TO  CERT-GROUPING
  8593                 MOVE PI-STATE         TO  CERT-STATE
  8594                 MOVE PI-ACCOUNT       TO  CERT-ACCOUNT
  8595                 MOVE PI-CERT-EFF-DT   TO  CERT-EFF-DT
  8596                 MOVE PI-CERT-NO       TO  CERT-CERT-NO
  8597
  8598
  8599* EXEC CICS HANDLE CONDITION
  8600*                    NOTFND   (3010-TEST-FOR-ERRORS)
  8601*                END-EXEC
  8602*    MOVE '"$I                   ! , #00008194' TO DFHEIV0
  8603     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8604     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8605     MOVE X'2C20233030303038313934' TO DFHEIV0(25:11)
  8606     CALL 'kxdfhei1' USING DFHEIV0
  8607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8608                 PERFORM 7940-READ-CERT THRU 7940-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 167
* EL130.cbl
  8609                 PERFORM 7050-BUILD-MAP-CERT-DATA THRU 7099-EXIT
  8610                 GO TO 3010-TEST-FOR-ERRORS
  8611             END-IF
  8612         END-IF
  8613     END-IF.
  8614
  8615     IF CERTMTI = 'A'
  8616         IF NOT PI-NO-CARRIER-SECURITY OR
  8617             NOT PI-NO-ACCOUNT-SECURITY
  8618             MOVE ER-2370          TO EMI-ERROR
  8619             MOVE -1               TO MAINTL
  8620             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8621             GO TO 8200-SEND-DATAONLY
  8622         ELSE
  8623             PERFORM 6300-REQUIRED-CERT-EDIT THRU 6399-EXIT
  8624             GO TO 3010-TEST-FOR-ERRORS
  8625         END-IF
  8626     END-IF.
  8627
  8628     IF CERTNOL = ZEROS
  8629        GO TO 3010-TEST-FOR-ERRORS
  8630     END-IF.
  8631
  8632 3000-READ-CERT.
  8633
  8634     MOVE PI-COMPANY-CD          TO CERT-COMP-CD-5
  8635                                    MSTR5-COMP-CD.
  8636     MOVE CERTNOI                TO CERT-CERT-5-PRIME
  8637                                    MSTR5-CERT-NO-PRIME.
  8638     MOVE SUFXI                  TO CERT-CERT-5-SUFX
  8639                                    MSTR5-CERT-NO-SUFX.
  8640
  8641
  8642
  8643* EXEC CICS HANDLE CONDITION
  8644*         DUPKEY   (3008-DUP-ERROR)
  8645*         NOTFND   (3009-NOT-FOUND)
  8646*    END-EXEC
  8647*    MOVE '"$$I                  ! - #00008231' TO DFHEIV0
  8648     MOVE X'222424492020202020202020' TO DFHEIV0(1:12)
  8649     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8650     MOVE X'2D20233030303038323331' TO DFHEIV0(25:11)
  8651     CALL 'kxdfhei1' USING DFHEIV0
  8652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8653
  8654     PERFORM 7980-READ-CERT5 THRU 7980-EXIT.
  8655
  8656     IF NOT PI-NO-ACCOUNT-SECURITY
  8657         IF PI-ACCOUNT-SECURITY NOT = CM-ACCOUNT
  8658             MOVE ER-2371          TO EMI-ERROR
  8659             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8660             MOVE -1               TO MAINTL
  8661             GO TO 8200-SEND-DATAONLY
  8662         END-IF
  8663     END-IF.
  8664
  8665     MOVE CM-CERT-NO             TO PI-SAVE-CERT.
  8666     MOVE CM-ACCOUNT             TO PI-SAVE-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 168
* EL130.cbl
  8667     MOVE CM-CERT-EFF-DT         TO PI-SAVE-EFFDT.
  8668     MOVE CM-COMPANY-CD          TO PI-COMPANY-CD.
  8669     MOVE CM-CARRIER             TO PI-CARRIER.
  8670     MOVE CM-GROUPING            TO PI-GROUPING.
  8671     MOVE CM-STATE               TO PI-STATE.
  8672     MOVE CM-ACCOUNT             TO PI-ACCOUNT.
  8673     MOVE CM-CERT-EFF-DT         TO PI-CERT-EFF-DT.
  8674     MOVE CM-CERT-NO             TO PI-CERT-NO.
  8675     PERFORM 7050-BUILD-MAP-CERT-DATA THRU 7099-EXIT.
  8676
  8677     IF CRTLNMEI NOT = SPACES AND LOW-VALUES
  8678         IF LSTNMEO = SPACES OR LOW-VALUES
  8679             MOVE CRTLNMEI       TO  LSTNMEO
  8680             MOVE AL-UANON       TO  LSTNMEA
  8681         END-IF
  8682     END-IF.
  8683
  8684     MOVE 'S'                    TO CERTMTO.
  8685*    MOVE AL-UANON               TO CERTMTA  CERTNOA  CLMCARRA
  8686     MOVE AL-SANON               TO CERTNOA.
  8687     MOVE AL-UANON               TO CERTMTA   CLMCARRA
  8688                                 EFFDTA ACCOUNTA STATEA   GROUPA.
  8689     IF EMI-NO-ERRORS
  8690         MOVE -1                  TO MAINTL
  8691     END-IF.
  8692
  8693     IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  8694         PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  8695         IF INCURRED-DATE-MATCH
  8696             MOVE ER-7352         TO EMI-ERROR
  8697             MOVE -1              TO CERTNOL
  8698             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8699         ELSE
  8700             IF NO-CLAIMS-FOR-CERT
  8701                 MOVE ER-7353     TO EMI-ERROR
  8702                 MOVE -1          TO CERTNOL
  8703                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8704             ELSE
  8705                 MOVE ER-0558     TO EMI-ERROR
  8706                 MOVE -1          TO CERTNOL
  8707                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8708                 GO TO 3010-TEST-FOR-ERRORS
  8709             END-IF
  8710         END-IF
  8711     END-IF.
  8712
  8713 3007-SEND-SCREEN.
  8714     IF RETURNED-FROM = XCTL-132 OR XCTL-127
  8715         GO TO 8150-SEND-MAP-CURSOR
  8716     ELSE
  8717         GO TO 8200-SEND-DATAONLY
  8718     END-IF.
  8719
  8720 3008-DUP-ERROR.
  8721     MOVE ER-0560                TO EMI-ERROR.
  8722     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8723     MOVE -1                     TO CERTNOL.
  8724     GO TO 3007-SEND-SCREEN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 169
* EL130.cbl
  8725
  8726 3009-NOT-FOUND.
  8727     MOVE ER-0214                TO EMI-ERROR.
  8728     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8729     MOVE -1                     TO CERTNOL.
  8730     GO TO 3007-SEND-SCREEN.
  8731
  8732 3010-TEST-FOR-ERRORS.
  8733
  8734     PERFORM 6200-EDIT-CERT-DATA           THRU 6200-EXIT.
  8735     PERFORM 6400-TEST-CLAIM-REASONABILITY THRU 6499-EXIT.
  8736
  8737     IF CERTMTI NOT = 'A'
  8738         IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  8739             MOVE PI-COMPANY-CD       TO MSTR5-COMP-CD
  8740             MOVE CERTNOI             TO MSTR5-CERT-NO-PRIME
  8741             MOVE SUFXI               TO MSTR5-CERT-NO-SUFX
  8742             PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  8743             IF INCURRED-DATE-MATCH
  8744                 MOVE ER-7352         TO EMI-ERROR
  8745                 MOVE -1              TO CERTNOL
  8746                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8747             ELSE
  8748                 IF NO-CLAIMS-FOR-CERT
  8749                     MOVE ER-7353     TO EMI-ERROR
  8750                     MOVE -1          TO CERTNOL
  8751                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8752                 ELSE
  8753                     MOVE ER-0558     TO EMI-ERROR
  8754                     MOVE -1          TO CERTNOL
  8755                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8756                 END-IF
  8757             END-IF
  8758         END-IF
  8759     END-IF.
  8760
  8761     IF EIBAID = DFHPF6  AND NOT FORCE-CAP
  8762         MOVE ER-0433             TO EMI-ERROR
  8763         MOVE -1                  TO MAINTL
  8764         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8765         GO TO 8200-SEND-DATAONLY
  8766     END-IF.
  8767
  8768     IF EMI-NO-ERRORS
  8769         GO TO 3015-TRY-TO-BUILD
  8770     END-IF.
  8771
  8772     IF EIBAID = DFHPF6
  8773         IF EMI-FATAL-CTR NOT EQUAL ZERO
  8774             MOVE ER-0434         TO EMI-ERROR
  8775             MOVE -1              TO MAINTL
  8776             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8777             GO TO 8200-SEND-DATAONLY
  8778         ELSE
  8779             MOVE +1              TO INCURL
  8780             GO TO 3015-TRY-TO-BUILD
  8781         END-IF
  8782     END-IF.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 170
* EL130.cbl
  8783
  8784     IF RETURNED-FROM = XCTL-132 OR XCTL-127
  8785         GO TO 8150-SEND-MAP-CURSOR
  8786     ELSE
  8787         GO TO 8200-SEND-DATAONLY
  8788     END-IF.
  8789
  8790 3015-TRY-TO-BUILD.
  8791     IF CLMNOL EQUAL ZERO
  8792         GO TO 3030-BUILD-CONT
  8793     END-IF.
  8794
  8795
  8796
  8797* EXEC CICS HANDLE CONDITION
  8798*        NOTFND   (3030-BUILD-CONT)
  8799*    END-EXEC.
  8800*    MOVE '"$I                   ! . #00008378' TO DFHEIV0
  8801     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8802     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8803     MOVE X'2E20233030303038333738' TO DFHEIV0(25:11)
  8804     CALL 'kxdfhei1' USING DFHEIV0
  8805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8806
  8807
  8808     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8809
  8810     MOVE CLMCARRI               TO MSTR-CARRIER.
  8811     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8812     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8813     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8814
  8815     MOVE 'MSTR'                 TO FILE-SWITCH.
  8816
  8817     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  8818
  8819     MOVE ER-0221                TO EMI-ERROR.
  8820
  8821     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8822     MOVE -1                     TO MAINTL.
  8823     GO TO 8200-SEND-DATAONLY.
  8824
  8825 3030-BUILD-CONT.
  8826     IF CERTMTI NOT = 'A'
  8827         GO TO 3060-BUILD-CONT
  8828     END-IF.
  8829
  8830
  8831
  8832* EXEC CICS HANDLE CONDITION
  8833*        NOTFND   (3033-ACCT-NOT-FOUND)
  8834*        ENDFILE  (3033-ACCT-NOT-FOUND)
  8835*    END-EXEC.
  8836*    MOVE '"$I''                  ! / #00008405' TO DFHEIV0
  8837     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8838     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8839     MOVE X'2F20233030303038343035' TO DFHEIV0(25:11)
  8840     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 171
* EL130.cbl
  8841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8842
  8843
  8844     MOVE SPACES                 TO ERACCT-KEY.
  8845
  8846     IF CARR-GROUP-ST-ACCNT-CNTL
  8847         MOVE PI-COMPANY-CD      TO ACCT-COMP-CD
  8848         MOVE CRTCARRI           TO ACCT-CARRIER
  8849         MOVE GROUPI             TO ACCT-GROUPING
  8850         MOVE STATEI             TO ACCT-STATE
  8851         MOVE ACCOUNTI           TO ACCT-ACCOUNT
  8852         GO TO 3031-MOVE-ACCT-KEY
  8853     END-IF.
  8854
  8855     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
  8856     MOVE ACCOUNTI               TO ACCT-ACCOUNT.
  8857
  8858     IF PI-CERT-ACCESS-CONTROL = ' ' OR '2'
  8859         MOVE STATEI             TO ACCT-STATE
  8860     END-IF.
  8861
  8862     IF PI-CERT-ACCESS-CONTROL = '2' OR '4'
  8863         MOVE CRTCARRI           TO ACCT-CARRIER
  8864     END-IF.
  8865
  8866 3031-MOVE-ACCT-KEY.
  8867     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY.
  8868
  8869
  8870
  8871* EXEC CICS STARTBR
  8872*        DATASET     (ERACCT2-DSID)
  8873*        RIDFLD      (SAVE-ERACCT-KEY)
  8874*        GENERIC
  8875*        KEYLENGTH   (20)
  8876*    END-EXEC.
  8877     MOVE 20
  8878       TO DFHEIV11
  8879     MOVE 0
  8880       TO DFHEIV12
  8881*    MOVE '&,   KG    G          &   #00008436' TO DFHEIV0
  8882     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  8883     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8884     MOVE X'2020233030303038343336' TO DFHEIV0(25:11)
  8885     CALL 'kxdfhei1' USING DFHEIV0,
  8886           ERACCT2-DSID,
  8887           SAVE-ERACCT-KEY,
  8888           DFHEIV11,
  8889           DFHEIV12,
  8890           DFHEIV99
  8891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8892
  8893
  8894
  8895
  8896* EXEC CICS HANDLE CONDITION
  8897*        ENDFILE   (3032-NOT-IN-DT-RANGE)
  8898*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 172
* EL130.cbl
  8899*    MOVE '"$''                   ! 0 #00008444' TO DFHEIV0
  8900     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  8901     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8902     MOVE X'3020233030303038343434' TO DFHEIV0(25:11)
  8903     CALL 'kxdfhei1' USING DFHEIV0
  8904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8905
  8906
  8907 3031-READ-ACCT-LOOP.
  8908
  8909
  8910* EXEC CICS READNEXT
  8911*        DATASET   (ERACCT2-DSID)
  8912*        SET       (ADDRESS OF ACCOUNT-MASTER)
  8913*        RIDFLD    (SAVE-ERACCT-KEY)
  8914*    END-EXEC.
  8915     MOVE 0
  8916       TO DFHEIV11
  8917*    MOVE '&.S                   )   #00008450' TO DFHEIV0
  8918     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8919     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8920     MOVE X'2020233030303038343530' TO DFHEIV0(25:11)
  8921     CALL 'kxdfhei1' USING DFHEIV0,
  8922           ERACCT2-DSID,
  8923           DFHEIV20,
  8924           DFHEIV99,
  8925           SAVE-ERACCT-KEY,
  8926           DFHEIV99,
  8927           DFHEIV11,
  8928           DFHEIV99,
  8929           DFHEIV99
  8930     SET ADDRESS OF ACCOUNT-MASTER TO
  8931         DFHEIV20
  8932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8933
  8934
  8935     IF ACCT-COMP-CD  NOT = AM-COMPANY-CD-A1  OR
  8936        ACCT-CARRIER  NOT = AM-VG-CARRIER     OR
  8937        ACCT-GROUPING NOT = AM-VG-GROUPING    OR
  8938        ACCT-STATE    NOT = AM-VG-STATE       OR
  8939        ACCT-ACCOUNT  NOT = AM-VG-ACCOUNT
  8940         GO TO 3033-ACCT-NOT-FOUND
  8941     END-IF.
  8942
  8943     IF WS-EFFDT NOT LESS AM-EFFECTIVE-DT  AND
  8944        WS-EFFDT LESS AM-EXPIRATION-DT
  8945         MOVE PI-COMPANY-CD    TO CERT-COMP-CD
  8946         MOVE AM-CARRIER       TO CERT-CARRIER
  8947         MOVE AM-GROUPING      TO CERT-GROUPING
  8948         MOVE AM-STATE         TO CERT-STATE
  8949         MOVE AM-ACCOUNT       TO CERT-ACCOUNT
  8950         MOVE WS-EFFDT         TO CERT-EFF-DT
  8951         MOVE CERTNOI          TO CERT-CERT-NO-PRIME
  8952         MOVE SUFXI            TO CERT-CERT-NO-SUFX
  8953         MOVE AM-REI-TABLE     TO WS-REIN-TABLE
  8954         GO TO 3034-CHECK-EMPLOYER-STATEMENT
  8955     END-IF.
  8956
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 173
* EL130.cbl
  8957     IF WS-EFFDT NOT LESS AM-EXPIRATION-DT
  8958         GO TO 3031-READ-ACCT-LOOP
  8959     END-IF.
  8960
  8961 3032-NOT-IN-DT-RANGE.
  8962     MOVE ER-0226                TO EMI-ERROR.
  8963     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8964     MOVE -1                     TO EFFDTL.
  8965     GO TO 8200-SEND-DATAONLY.
  8966
  8967 3033-ACCT-NOT-FOUND.
  8968     MOVE ER-0226 TO EMI-ERROR.
  8969     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8970     MOVE -1                     TO ACCOUNTL.
  8971     GO TO 8200-SEND-DATAONLY.
  8972
  8973 3034-CHECK-EMPLOYER-STATEMENT.
  8974
  8975     IF AM-EMPLOYER-STMT-USED = '1' OR '2' OR '3' OR 'Y'
  8976*        NEXT SENTENCE
  8977         CONTINUE
  8978     ELSE
  8979         GO TO  3034-CHECK-ACCOUNT-LIMITS
  8980     END-IF.
  8981
  8982     MOVE CERT-EFF-DT            TO  DC-BIN-DATE-1.
  8983     MOVE WS-INCUR               TO  DC-BIN-DATE-2.
  8984     MOVE '1'                    TO  DC-OPTION-CODE.
  8985     MOVE +0                     TO  DC-ELAPSED-MONTHS
  8986                                     DC-ELAPSED-DAYS.
  8987     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  8988
  8989     IF (AM-EMPLOYER-STMT-USED = '1' AND
  8990         DC-ELAPSED-DAYS LESS THAN +31)
  8991                      OR
  8992        (AM-EMPLOYER-STMT-USED = '2' AND
  8993         DC-ELAPSED-DAYS LESS THAN +61)
  8994                      OR
  8995        (AM-EMPLOYER-STMT-USED = '3' AND
  8996         DC-ELAPSED-DAYS LESS THAN +91)
  8997            MOVE 'Y'             TO  AM-EMPLOYER-STMT-USED
  8998     END-IF.
  8999
  9000 3034-CHECK-ACCOUNT-LIMITS.
  9001
  9002     IF CERTMTI NOT = 'A'
  9003         GO TO 3060-BUILD-CONT
  9004     END-IF.
  9005
  9006     IF AM-STATUS NOT = '0'
  9007         MOVE ER-0225                TO EMI-ERROR
  9008         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9009         MOVE -1                     TO ACCOUNTL
  9010     END-IF.
  9011
  9012     IF EIBAID = DFHPF6
  9013         IF EMI-FATAL-CTR NOT = ZERO
  9014             MOVE ER-0434         TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 174
* EL130.cbl
  9015             MOVE -1              TO MAINTL
  9016             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9017             GO TO 8200-SEND-DATAONLY
  9018         END-IF
  9019     END-IF.
  9020
  9021*    IF PI-COMPANY-ID NOT = 'CRI'
  9022*        GO TO 3035-END-BROWSE
  9023*    END-IF.
  9024
  9025 3035-END-BROWSE.
  9026
  9027
  9028* EXEC CICS ENDBR
  9029*        DATASET    (ERACCT2-DSID)
  9030*    END-EXEC.
  9031     MOVE 0
  9032       TO DFHEIV11
  9033*    MOVE '&2                    $   #00008548' TO DFHEIV0
  9034     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9035     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9036     MOVE X'2020233030303038353438' TO DFHEIV0(25:11)
  9037     CALL 'kxdfhei1' USING DFHEIV0,
  9038           ERACCT2-DSID,
  9039           DFHEIV11,
  9040           DFHEIV99
  9041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9042
  9043
  9044 3040-CHECK-CERT-ALREADY-ON.
  9045
  9046
  9047* EXEC CICS HANDLE CONDITION
  9048*        NOTFND   (3070-BUILD-CONT)
  9049*    END-EXEC.
  9050*    MOVE '"$I                   ! 1 #00008554' TO DFHEIV0
  9051     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9052     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9053     MOVE X'3120233030303038353534' TO DFHEIV0(25:11)
  9054     CALL 'kxdfhei1' USING DFHEIV0
  9055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9056
  9057
  9058     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  9059
  9060     MOVE ER-0229                TO EMI-ERROR.
  9061     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9062     MOVE -1                     TO MAINTL.
  9063     GO TO 8200-SEND-DATAONLY.
  9064
  9065 3060-BUILD-CONT.
  9066     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9067     MOVE CRTCARRI               TO CERT-CARRIER.
  9068     MOVE GROUPI                 TO CERT-GROUPING.
  9069     MOVE STATEI                 TO CERT-STATE.
  9070     MOVE PI-SAVE-ACCOUNT        TO CERT-ACCOUNT.
  9071     MOVE CERTNOI                TO CERT-CERT-NO-PRIME.
  9072     MOVE SUFXI                  TO CERT-CERT-NO-SUFX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 175
* EL130.cbl
  9073     MOVE PI-SAVE-EFFDT          TO CERT-EFF-DT.
  9074
  9075
  9076
  9077* EXEC CICS HANDLE CONDITION
  9078*        NOTFND  (3065-CERT-NOT-FOUND)
  9079*    END-EXEC.
  9080*    MOVE '"$I                   ! 2 #00008576' TO DFHEIV0
  9081     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9082     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9083     MOVE X'3220233030303038353736' TO DFHEIV0(25:11)
  9084     CALL 'kxdfhei1' USING DFHEIV0
  9085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9086
  9087
  9088     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
  9089
  9090     GO TO 3070-BUILD-CONT.
  9091
  9092 3065-CERT-NOT-FOUND.
  9093     MOVE ER-0244                TO EMI-ERROR.
  9094     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9095     MOVE -1                     TO CERTNOL.
  9096     GO TO 8200-SEND-DATAONLY.
  9097
  9098 3070-BUILD-CONT.
  9099     IF CLMNOL NOT = ZERO
  9100         GO TO 3200-BUILD-ZERO-TRAILER
  9101     END-IF.
  9102
  9103     MOVE SPACES                 TO ELCNTL-KEY.
  9104
  9105     IF CONTROL-IS-ACTUAL-CARRIER
  9106         MOVE PI-CARRIER         TO CNTL-CARRIER
  9107     ELSE
  9108         MOVE PI-CARRIER-CONTROL-LEVEL
  9109                                 TO CNTL-CARRIER
  9110     END-IF.
  9111
  9112     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9113     MOVE '6'                    TO CNTL-REC-TYPE.
  9114     MOVE +0                     TO CNTL-SEQ-NO.
  9115
  9116
  9117
  9118* EXEC CICS HANDLE CONDITION
  9119*        NOTFND   (3100-CARRIER-NOT-FOUND)
  9120*    END-EXEC.
  9121*    MOVE '"$I                   ! 3 #00008609' TO DFHEIV0
  9122     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9123     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9124     MOVE X'3320233030303038363039' TO DFHEIV0(25:11)
  9125     CALL 'kxdfhei1' USING DFHEIV0
  9126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9127
  9128
  9129
  9130
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 176
* EL130.cbl
  9131* EXEC CICS READ
  9132*        UPDATE
  9133*        DATASET   (ELCNTL-DSID)
  9134*        SET       (ADDRESS OF CONTROL-FILE)
  9135*        RIDFLD    (ELCNTL-KEY)
  9136*    END-EXEC.
  9137*    MOVE '&"S        EU         (   #00008614' TO DFHEIV0
  9138     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9139     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9140     MOVE X'2020233030303038363134' TO DFHEIV0(25:11)
  9141     CALL 'kxdfhei1' USING DFHEIV0,
  9142           ELCNTL-DSID,
  9143           DFHEIV20,
  9144           DFHEIV99,
  9145           ELCNTL-KEY,
  9146           DFHEIV99,
  9147           DFHEIV99,
  9148           DFHEIV99
  9149     SET ADDRESS OF CONTROL-FILE TO
  9150         DFHEIV20
  9151     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9152
  9153
  9154     IF CLAIM-NO-MANUAL
  9155         GO TO 3120-CLAIM-MUST-BE-INPUT
  9156     END-IF.
  9157
  9158     MOVE CF-CLAIM-NO-METHOD     TO SAVE-METHOD.
  9159     MOVE CF-CLAIM-COUNTER       TO SAVE-COUNTER.
  9160
  9161     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  9162         CONTINUE
  9163     ELSE
  9164         GO TO 3080-ASSIGN-LOOP
  9165     END-IF.
  9166
  9167
  9168
  9169* EXEC CICS UNLOCK
  9170*        DATASET   (ELCNTL-DSID)
  9171*    END-EXEC.
  9172*    MOVE '&*                    #   #00008635' TO DFHEIV0
  9173     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  9174     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9175     MOVE X'2020233030303038363335' TO DFHEIV0(25:11)
  9176     CALL 'kxdfhei1' USING DFHEIV0,
  9177           ELCNTL-DSID,
  9178           DFHEIV99
  9179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9180
  9181
  9182     MOVE '1'                    TO CNTL-REC-TYPE.
  9183     MOVE SPACES                 TO CNTL-ACCESS.
  9184
  9185     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9186
  9187
  9188
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 177
* EL130.cbl
  9189* EXEC CICS HANDLE CONDITION
  9190*        NOTFND   (3110-COMPANY-NOT-FOUND)
  9191*    END-EXEC.
  9192*    MOVE '"$I                   ! 4 #00008645' TO DFHEIV0
  9193     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9194     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9195     MOVE X'3420233030303038363435' TO DFHEIV0(25:11)
  9196     CALL 'kxdfhei1' USING DFHEIV0
  9197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9198
  9199
  9200     PERFORM 7960-READ-CNTL-UPDATE THRU 7960-EXIT.
  9201
  9202     MOVE CF-CO-CLAIM-COUNTER    TO SAVE-COUNTER.
  9203
  9204 3080-ASSIGN-LOOP.
  9205     IF (SAVE-COUNTER = +99999   AND SAVE-METHOD = '2') OR
  9206        (SAVE-COUNTER = +9999999 AND SAVE-METHOD = '3')
  9207         MOVE +0                 TO SAVE-COUNTER
  9208     END-IF.
  9209
  9210     ADD +1 TO SAVE-COUNTER.
  9211
  9212     IF SAVE-METHOD  = '3'
  9213         MOVE SAVE-COUNTER        TO WS-CLAIM-NUMBER-R1
  9214         GO TO 3090-SET-COMP
  9215     END-IF.
  9216
  9217     IF SAVE-METHOD  = '4'
  9218         MOVE SAVE-COUNTER       TO WS-CLAIM-NUMBER-R1
  9219         MOVE CLMCARRI           TO WS-CN-PRF-A
  9220         GO TO 3090-SET-COMP
  9221     END-IF.
  9222
  9223     MOVE ZEROS                  TO WS-CLAIM-NUMBER.
  9224     MOVE SAVE-COUNTER           TO WS-CN-NUMBER.
  9225     MOVE SAVE-DATE              TO CURR-DATE.
  9226
  9227     IF CURR-MM LESS '10'
  9228         MOVE CURR-M2             TO WS-CN-PRF-B
  9229     END-IF.
  9230
  9231     IF CURR-MM = '10'
  9232        MOVE 'A'                 TO WS-CN-PRF-B
  9233     END-IF.
  9234     IF CURR-MM = '11'
  9235        MOVE 'B'                 TO WS-CN-PRF-B
  9236     END-IF.
  9237     IF CURR-MM = '12'
  9238        MOVE 'C'                 TO WS-CN-PRF-B
  9239     END-IF.
  9240
  9241     MOVE CURR-YEAR              TO WS-CN-PRF-A.
  9242
  9243 3090-SET-COMP.
  9244
  9245     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9246     MOVE WS-CLAIM-NUMBER        TO MSTR-CLAIM-NO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 178
* EL130.cbl
  9247                                    CLMNOO.
  9248     MOVE AL-UANON               TO CLMNOA.
  9249     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  9250     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  9251     MOVE CLMCARRI               TO MSTR-CARRIER.
  9252
  9253
  9254
  9255* EXEC CICS HANDLE CONDITION
  9256*        NOTFND  (3200-BUILD-ZERO-TRAILER)
  9257*    END-EXEC.
  9258*    MOVE '"$I                   ! 5 #00008703' TO DFHEIV0
  9259     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9260     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9261     MOVE X'3520233030303038373033' TO DFHEIV0(25:11)
  9262     CALL 'kxdfhei1' USING DFHEIV0
  9263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9264
  9265
  9266     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  9267
  9268     GO TO 3080-ASSIGN-LOOP.
  9269
  9270 3100-CARRIER-NOT-FOUND.
  9271     MOVE ER-0252                TO EMI-ERROR.
  9272     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9273     MOVE -1                     TO CLMCARRL.
  9274     GO TO 8200-SEND-DATAONLY.
  9275
  9276 3110-COMPANY-NOT-FOUND.
  9277     MOVE ER-0254                TO EMI-ERROR.
  9278     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9279     MOVE -1                     TO MAINTL.
  9280     GO TO 8200-SEND-DATAONLY.
  9281
  9282 3120-CLAIM-MUST-BE-INPUT.
  9283     MOVE ER-0264                TO EMI-ERROR.
  9284     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9285     MOVE -1                     TO CLMNOL.
  9286     GO TO 8200-SEND-DATAONLY.
  9287
  9288 3200-BUILD-ZERO-TRAILER.
  9289
  9290
  9291* EXEC CICS HANDLE CONDITION
  9292*        NOTFND
  9293*    END-EXEC.
  9294*    MOVE '"$                   ! 6 #00008731' TO DFHEIV0
  9295     MOVE X'2224B9202020202020202020' TO DFHEIV0(1:12)
  9296     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9297     MOVE X'3620233030303038373331' TO DFHEIV0(25:11)
  9298     CALL 'kxdfhei1' USING DFHEIV0
  9299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9300
  9301
  9302
  9303
  9304* EXEC CICS GETMAIN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 179
* EL130.cbl
  9305*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
  9306*        LENGTH  (ELTRLR-LENGTH)
  9307*    END-EXEC.
  9308*    MOVE '," L                  $   #00008736' TO DFHEIV0
  9309     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  9310     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9311     MOVE X'2020233030303038373336' TO DFHEIV0(25:11)
  9312     CALL 'kxdfhei1' USING DFHEIV0,
  9313           DFHEIV20,
  9314           ELTRLR-LENGTH,
  9315           DFHEIV99
  9316     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9317         DFHEIV20
  9318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9319
  9320
  9321     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9322     MOVE 'AT'                   TO AT-RECORD-ID.
  9323
  9324     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
  9325     MOVE CLMCARRI               TO AT-CARRIER.
  9326     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9327     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9328     MOVE +0                     TO AT-SEQUENCE-NO.
  9329     MOVE '1'                    TO AT-TRAILER-TYPE.
  9330
  9331     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  9332     MOVE '5'                    TO DC-OPTION-CODE.
  9333     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9334     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9335                                    AT-RESERVES-LAST-MAINT-DT.
  9336
  9337     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9338                                    AT-RESERVES-LAST-UPDATED-BY.
  9339
  9340     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9341
  9342     MOVE WS-RESERVE-CONTROLS    TO AT-RESERVE-CONTROLS.
  9343
  9344     MOVE +0                     TO AT-FUTURE-RESERVE
  9345                                    AT-IBNR-RESERVE
  9346                                    AT-PAY-CURRENT-RESERVE
  9347                                    AT-INITIAL-MANUAL-RESERVE
  9348                                    AT-CURRENT-MANUAL-RESERVE
  9349                                    AT-ITD-LIFE-REFUNDS
  9350                                    AT-ITD-AH-REFUNDS
  9351                                    AT-ITD-ADDITIONAL-RESERVE.
  9352
  9353     MOVE LOW-VALUES             TO AT-LAST-COMPUTED-DT.
  9354
  9355     IF MANRSVL NOT = ZERO
  9356         MOVE WS-MANRSV          TO AT-INITIAL-MANUAL-RESERVE
  9357                                    AT-CURRENT-MANUAL-RESERVE
  9358     END-IF.
  9359
  9360     MOVE WS-EXPENSE-CONTROLS    TO AT-EXPENSE-CONTROLS.
  9361
  9362     MOVE +0                     TO AT-ITD-PAID-EXPENSES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 180
* EL130.cbl
  9363                                    AT-ITD-CHARGEABLE-EXPENSE.
  9364
  9365     MOVE WS-TODAY-DT            TO AT-OPEN-CLOSE-DATE (1).
  9366     MOVE 'O'                    TO AT-OPEN-CLOSE-TYPE (1).
  9367     MOVE 'NEW'                  TO AT-OPEN-CLOSE-REASON (1).
  9368
  9369
  9370
  9371* EXEC CICS WRITE
  9372*        DATASET   (ELTRLR-DSID)
  9373*        FROM      (ACTIVITY-TRAILERS)
  9374*        RIDFLD    (AT-CONTROL-PRIMARY)
  9375*    END-EXEC.
  9376     MOVE LENGTH OF
  9377      ACTIVITY-TRAILERS
  9378       TO DFHEIV11
  9379*    MOVE '&$ L                  ''   #00008790' TO DFHEIV0
  9380     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9381     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9382     MOVE X'2020233030303038373930' TO DFHEIV0(25:11)
  9383     CALL 'kxdfhei1' USING DFHEIV0,
  9384           ELTRLR-DSID,
  9385           ACTIVITY-TRAILERS,
  9386           DFHEIV11,
  9387           AT-CONTROL-PRIMARY,
  9388           DFHEIV99,
  9389           DFHEIV99
  9390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9391
  9392
  9393     MOVE AT-CONTROL-PRIMARY  TO  SAVE-AT-PRIMARY-KEY.
  9394
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 181
* EL130.cbl
  9396
  9397 3250-BUILD-I1-ADDRESS-TRAILER.
  9398
  9399     MOVE 'N'                    TO WS-NO-INSURED-ADDRESS.
  9400     MOVE +0                     TO WS-INSURED-ADDR-CNT.
  9401     MOVE PI-COMPANY-CD          TO WS-MA-COMPANY-CD.
  9402     MOVE CRTCARRI               TO WS-MA-CARRIER.
  9403     MOVE GROUPI                 TO WS-MA-GROUPING.
  9404     MOVE STATEI                 TO WS-MA-STATE.
  9405     MOVE PI-SAVE-ACCOUNT        TO WS-MA-ACCOUNT.
  9406     MOVE CERTNOI                TO WS-MA-CERT-PRIME.
  9407     MOVE SUFXI                  TO WS-MA-CERT-SFX.
  9408     MOVE PI-SAVE-EFFDT          TO WS-MA-CERT-EFF-DT.
  9409
  9410
  9411* EXEC CICS HANDLE CONDITION
  9412*        NOTFND   (3290-NO-INSURED-ADDRESS)
  9413*    END-EXEC.
  9414*    MOVE '"$I                   ! 7 #00008813' TO DFHEIV0
  9415     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9416     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9417     MOVE X'3720233030303038383133' TO DFHEIV0(25:11)
  9418     CALL 'kxdfhei1' USING DFHEIV0
  9419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9420
  9421
  9422
  9423* EXEC CICS READ
  9424*        EQUAL
  9425*        DATASET   (ERMAIL-DSID)
  9426*        SET       (ADDRESS OF MAILING-DATA)
  9427*        RIDFLD    (WS-MA-CONTROL-PRIMARY)
  9428*    END-EXEC.
  9429*    MOVE '&"S        E          (   #00008817' TO DFHEIV0
  9430     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9431     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9432     MOVE X'2020233030303038383137' TO DFHEIV0(25:11)
  9433     CALL 'kxdfhei1' USING DFHEIV0,
  9434           ERMAIL-DSID,
  9435           DFHEIV20,
  9436           DFHEIV99,
  9437           WS-MA-CONTROL-PRIMARY,
  9438           DFHEIV99,
  9439           DFHEIV99,
  9440           DFHEIV99
  9441     SET ADDRESS OF MAILING-DATA TO
  9442         DFHEIV20
  9443     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9444
  9445
  9446     IF MA-INSURED-LAST-NAME NOT GREATER THAN SPACES
  9447         GO TO 3290-NO-INSURED-ADDRESS
  9448     END-IF.
  9449
  9450     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9451     MOVE 'AT'                   TO AT-RECORD-ID.
  9452
  9453     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 182
* EL130.cbl
  9454     MOVE CLMCARRI               TO AT-CARRIER.
  9455     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9456     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9457     MOVE +1                     TO AT-SEQUENCE-NO.
  9458     MOVE '5'                    TO AT-TRAILER-TYPE.
  9459
  9460     MOVE 'I'                    TO AT-ADDRESS-TYPE.
  9461     IF MA-INSURED-MIDDLE-INIT > SPACES
  9462        STRING MA-INSURED-FIRST-NAME DELIMITED BY '  '
  9463               ' ' DELIMITED BY SIZE
  9464               MA-INSURED-MIDDLE-INIT DELIMITED BY SIZE
  9465               ' ' DELIMITED BY SIZE
  9466               MA-INSURED-LAST-NAME DELIMITED BY SIZE
  9467        INTO AT-MAIL-TO-NAME
  9468     ELSE
  9469        STRING MA-INSURED-FIRST-NAME DELIMITED BY '  '
  9470               ' ' DELIMITED BY SIZE
  9471               MA-INSURED-LAST-NAME DELIMITED BY SIZE
  9472        INTO AT-MAIL-TO-NAME
  9473     END-IF.
  9474     MOVE MA-ADDRESS-LINE-1      TO AT-ADDRESS-LINE-1.
  9475     MOVE MA-ADDRESS-LINE-2      TO AT-ADDRESS-LINE-2.
  9476*    MOVE MA-CITY-STATE          TO AT-CITY-STATE.
  9477     MOVE MA-CITY                TO AT-CITY
  9478     MOVE MA-ADDR-STATE          TO AT-STATE
  9479     MOVE MA-ZIP                 TO AT-ZIP
  9480     MOVE MA-PHONE-NO            TO AT-PHONE-NO
  9481
  9482     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9483                                    AT-ADDRESS-LAST-MAINT-DT.
  9484
  9485     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9486                                    AT-ADDRESS-LAST-UPDATED-BY.
  9487
  9488     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9489
  9490
  9491* EXEC CICS WRITE
  9492*        DATASET   (ELTRLR-DSID)
  9493*        FROM      (ACTIVITY-TRAILERS)
  9494*        RIDFLD    (AT-CONTROL-PRIMARY)
  9495*    END-EXEC.
  9496     MOVE LENGTH OF
  9497      ACTIVITY-TRAILERS
  9498       TO DFHEIV11
  9499*    MOVE '&$ L                  ''   #00008868' TO DFHEIV0
  9500     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9501     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9502     MOVE X'2020233030303038383638' TO DFHEIV0(25:11)
  9503     CALL 'kxdfhei1' USING DFHEIV0,
  9504           ELTRLR-DSID,
  9505           ACTIVITY-TRAILERS,
  9506           DFHEIV11,
  9507           AT-CONTROL-PRIMARY,
  9508           DFHEIV99,
  9509           DFHEIV99
  9510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9511
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 183
* EL130.cbl
  9512
  9513     ADD +1                      TO WS-INSURED-ADDR-CNT.
  9514     GO TO 3300-BUILD-NINETY-TRAILER.
  9515
  9516 3290-NO-INSURED-ADDRESS.
  9517      MOVE 'Y' TO WS-NO-INSURED-ADDRESS.
  9518
  9519 3300-BUILD-NINETY-TRAILER.
  9520
  9521     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9522     MOVE 'AT'                   TO AT-RECORD-ID.
  9523
  9524     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
  9525     MOVE CLMCARRI               TO AT-CARRIER.
  9526
  9527     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9528     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9529     MOVE +90                    TO AT-SEQUENCE-NO.
  9530     MOVE '6'                    TO AT-TRAILER-TYPE.
  9531
  9532     IF DIAGL NOT = ZERO
  9533         MOVE DIAGI              TO AT-INFO-LINE-1
  9534     END-IF.
  9535
  9536     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9537                                    AT-GEN-INFO-LAST-MAINT-DT.
  9538
  9539     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9540                                    AT-GEN-INFO-LAST-UPDATED-BY.
  9541     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9542
  9543
  9544
  9545* EXEC CICS WRITE
  9546*        DATASET   (ELTRLR-DSID)
  9547*        FROM      (ACTIVITY-TRAILERS)
  9548*        RIDFLD    (AT-CONTROL-PRIMARY)
  9549*    END-EXEC.
  9550     MOVE LENGTH OF
  9551      ACTIVITY-TRAILERS
  9552       TO DFHEIV11
  9553*    MOVE '&$ L                  ''   #00008905' TO DFHEIV0
  9554     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9555     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9556     MOVE X'2020233030303038393035' TO DFHEIV0(25:11)
  9557     CALL 'kxdfhei1' USING DFHEIV0,
  9558           ELTRLR-DSID,
  9559           ACTIVITY-TRAILERS,
  9560           DFHEIV11,
  9561           AT-CONTROL-PRIMARY,
  9562           DFHEIV99,
  9563           DFHEIV99
  9564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9565
  9566
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 184
* EL130.cbl
  9568 3400-CHECK-CERT-MAINT.
  9569
  9570     IF CERTMTI = 'A'
  9571         GO TO 3600-BUILD-NEW-CERT
  9572     END-IF.
  9573
  9574     IF NO-CLAIM-ATTACHED
  9575         MOVE '1'                TO CM-CLAIM-INTERFACE-SW
  9576     END-IF.
  9577
  9578     ADD +1                      TO CM-CLAIM-ATTACHED-COUNT.
  9579
  9580     IF CM-LF-CURRENT-STATUS = '2' OR
  9581        CM-AH-CURRENT-STATUS = '2'
  9582         GO TO 3400-REWRITE-CERT
  9583     END-IF.
  9584
  9585     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
  9586
  9587 3400-REWRITE-CERT.
  9588
  9589
  9590
  9591* EXEC CICS HANDLE CONDITION
  9592*        DUPKEY (3410-DUP-KEY)
  9593*    END-EXEC.
  9594*    MOVE '"$$                   ! 8 #00008934' TO DFHEIV0
  9595     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9596     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9597     MOVE X'3820233030303038393334' TO DFHEIV0(25:11)
  9598     CALL 'kxdfhei1' USING DFHEIV0
  9599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9600
  9601
  9602
  9603
  9604* EXEC CICS REWRITE
  9605*        DATASET   (ELCERT-DSID)
  9606*        FROM      (CERTIFICATE-MASTER)
  9607*    END-EXEC.
  9608     MOVE LENGTH OF
  9609      CERTIFICATE-MASTER
  9610       TO DFHEIV11
  9611*    MOVE '&& L                  %   #00008939' TO DFHEIV0
  9612     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9613     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9614     MOVE X'2020233030303038393339' TO DFHEIV0(25:11)
  9615     CALL 'kxdfhei1' USING DFHEIV0,
  9616           ELCERT-DSID,
  9617           CERTIFICATE-MASTER,
  9618           DFHEIV11,
  9619           DFHEIV99
  9620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9621
  9622
  9623 3410-DUP-KEY.
  9624     GO TO 3800-BUILD-NEW-CLAIM.
  9625
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 185
* EL130.cbl
  9626 3600-BUILD-NEW-CERT.
  9627
  9628
  9629* EXEC CICS GETMAIN
  9630*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  9631*        LENGTH   (ELCERT-LENGTH)
  9632*    END-EXEC.
  9633*    MOVE '," L                  $   #00008949' TO DFHEIV0
  9634     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  9635     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9636     MOVE X'2020233030303038393439' TO DFHEIV0(25:11)
  9637     CALL 'kxdfhei1' USING DFHEIV0,
  9638           DFHEIV20,
  9639           ELCERT-LENGTH,
  9640           DFHEIV99
  9641     SET ADDRESS OF CERTIFICATE-MASTER TO
  9642         DFHEIV20
  9643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9644
  9645
  9646     MOVE SPACES                 TO CERTIFICATE-MASTER.
  9647
  9648     MOVE 'CM'                   TO CM-RECORD-ID.
  9649
  9650     MOVE PI-COMPANY-CD          TO CM-COMPANY-CD
  9651                                    CM-COMPANY-CD-A1
  9652                                    CM-COMPANY-CD-A2
  9653                                    CM-COMPANY-CD-A4
  9654                                    CM-COMPANY-CD-A5.
  9655
  9656     MOVE CERT-CARRIER           TO CM-CARRIER.
  9657     MOVE CERT-GROUPING          TO CM-GROUPING.
  9658     MOVE CERT-STATE             TO CM-STATE.
  9659     MOVE CERT-ACCOUNT           TO CM-ACCOUNT.
  9660     MOVE CERT-CERT-NO           TO CM-CERT-NO  CM-CERT-NO-A4.
  9661     MOVE CERT-EFF-DT            TO CM-CERT-EFF-DT.
  9662
  9663     MOVE ZERO      TO CM-LF-ORIG-TERM       CM-LF-BENEFIT-AMT
  9664                       CM-INSURED-ISSUE-AGE  CM-INSURED-JOINT-AGE
  9665                       CM-LF-BENEFIT-CD      CM-AH-BENEFIT-CD
  9666                       CM-LF-PREMIUM-AMT     CM-LF-REMAINING-AMT
  9667                       CM-LF-ITD-CANCEL-AMT  CM-LF-ITD-DEATH-AMT
  9668                       CM-LIVES              CM-LOAN-TERM
  9669                       CM-AH-ITD-AH-PMT      CM-AH-NSP-PREMIUM-AMT
  9670                       CM-AH-DEV-PCT         CM-AH-CRITICAL-PERIOD
  9671                       CM-LF-TERM-IN-DAYS    CM-LF-ALT-PREMIUM-AMT
  9672                       CM-LF-DEV-PCT         CM-LF-NSP-PREMIUM-AMT
  9673                       CM-LF-CRITICAL-PERIOD CM-LF-ALT-BENEFIT-AMT
  9674                       CM-LF-PREMIUM-RATE    CM-AH-PREMIUM-RATE
  9675                       CM-LF-ALT-PREMIUM-RATE
  9676                       CM-AH-ORIG-TERM       CM-AH-BENEFIT-AMT
  9677                       CM-AH-PREMIUM-AMT     CM-AH-ITD-CANCEL-AMT
  9678                       CM-AH-ITD-LUMP-PMT    CM-LOAN-APR
  9679                       CM-LOAN-BALANCE       CM-PAY-FREQUENCY
  9680                       CM-LIFE-COMM-PCT      CM-AH-COMM-PCT.
  9681
  9682     MOVE LOW-VALUES             TO CM-AH-LOAN-EXPIRE-DT
  9683                                    CM-AH-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 186
* EL130.cbl
  9684                                    CM-AH-SETTLEMENT-DT
  9685                                    CM-AH-CANCEL-EXIT-DT
  9686                                    CM-AH-SETTLEMENT-EXIT-DT
  9687                                    CM-LF-LOAN-EXPIRE-DT
  9688                                    CM-LF-CANCEL-DT
  9689                                    CM-LF-DEATH-DT
  9690                                    CM-LF-CANCEL-EXIT-DT
  9691                                    CM-LF-DEATH-EXIT-DT
  9692                                    CM-LAST-ADD-ON-DT
  9693                                    CM-ENTRY-DT.
  9694
  9695     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW.
  9696     MOVE +1                     TO CM-CLAIM-ATTACHED-COUNT.
  9697     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
  9698
  9699     MOVE CRTLNMEI               TO CM-INSURED-LAST-NAME
  9700                                    CM-PART-LAST-NAME-A2
  9701                                    CM-PART-LAST-NAME-A5.
  9702
  9703     MOVE CRTFNMEI               TO CM-INSURED-INITIAL1
  9704                                    CM-INSURED-INITIAL1-A2
  9705                                    CM-INSURED-INITIAL1-A5
  9706                                    CM-INSURED-FIRST-NAME.
  9707
  9708     IF CRTINITL GREATER ZERO
  9709         MOVE CRTINITI           TO CM-INSURED-INITIAL2
  9710                                    CM-INSURED-INITIAL2-A2
  9711                                    CM-INSURED-INITIAL2-A5
  9712     ELSE
  9713         MOVE SPACES             TO CM-INSURED-INITIAL2
  9714                                    CM-INSURED-INITIAL2-A2
  9715                                    CM-INSURED-INITIAL2-A5
  9716     END-IF.
  9717
  9718     IF CM-INSURED-INITIALS = SPACES
  9719         MOVE '**'               TO CM-INSURED-INITIALS
  9720     END-IF.
  9721
  9722     IF MEMBERL GREATER ZERO
  9723         MOVE MEMBERI              TO CM-MEMBER-NO
  9724     ELSE
  9725         MOVE CERT-STATE           TO CM-MEMB-STATE
  9726         MOVE CERT-ACCOUNT-PRIME   TO CM-MEMB-ACCOUNT
  9727         MOVE CM-INSURED-INITIALS  TO CM-INSURED-INITIALS-A5
  9728         MOVE CM-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
  9729     END-IF.
  9730
  9731     IF JNTLNMEL GREATER ZERO
  9732         MOVE JNTLNMEI           TO CM-JT-LAST-NAME
  9733     END-IF.
  9734
  9735     IF JNTFNMEL GREATER ZERO
  9736         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME
  9737     END-IF.
  9738
  9739     IF JNTINITL GREATER ZERO
  9740         MOVE JNTINITI           TO CM-JT-INITIAL
  9741     END-IF.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 187
* EL130.cbl
  9742
  9743     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
  9744
  9745
  9746
  9747* EXEC CICS HANDLE CONDITION
  9748*        DUPKEY   (3690-CERT-WRITTEN)
  9749*    END-EXEC.
  9750*    MOVE '"$$                   ! 9 #00009054' TO DFHEIV0
  9751     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9752     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9753     MOVE X'3920233030303039303534' TO DFHEIV0(25:11)
  9754     CALL 'kxdfhei1' USING DFHEIV0
  9755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9756
  9757
  9758
  9759
  9760* EXEC CICS WRITE
  9761*        DATASET   (ELCERT-DSID)
  9762*        FROM      (CERTIFICATE-MASTER)
  9763*        RIDFLD    (CM-CONTROL-PRIMARY)
  9764*    END-EXEC.
  9765     MOVE LENGTH OF
  9766      CERTIFICATE-MASTER
  9767       TO DFHEIV11
  9768*    MOVE '&$ L                  ''   #00009059' TO DFHEIV0
  9769     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9770     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9771     MOVE X'2020233030303039303539' TO DFHEIV0(25:11)
  9772     CALL 'kxdfhei1' USING DFHEIV0,
  9773           ELCERT-DSID,
  9774           CERTIFICATE-MASTER,
  9775           DFHEIV11,
  9776           CM-CONTROL-PRIMARY,
  9777           DFHEIV99,
  9778           DFHEIV99
  9779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9780
  9781
  9782 3690-CERT-WRITTEN.
  9783
  9784     GO TO 3800-BUILD-NEW-CLAIM.
  9785
  9786 3690-EXIT.
  9787      EXIT.
  9788
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 188
* EL130.cbl
  9790 3700-BUILD-CERT.
  9791
  9792     IF CERTMTI NOT = 'A'
  9793         GO TO 3700-FINISH-CERT-BUILD
  9794     END-IF.
  9795
  9796     IF CERTMTI = 'A'
  9797         IF LCVCDL = ZEROS
  9798             MOVE ZEROS          TO CM-LF-BENEFIT-CD
  9799                                    CM-LF-ORIG-TERM
  9800                                    CM-LF-BENEFIT-AMT
  9801                                    CM-LF-PREMIUM-RATE
  9802             GO TO 3700-BUILD-AH-COVERAGE-SIDE
  9803         END-IF
  9804     END-IF.
  9805
  9806     IF LCVCDL GREATER ZERO
  9807         MOVE LCVCDI             TO CM-LF-BENEFIT-CD
  9808     END-IF.
  9809
  9810     IF LCVOTRML GREATER ZERO
  9811         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM
  9812     END-IF.
  9813
  9814     IF LCVBENEL GREATER ZERO
  9815         MOVE WS-LCVBENE         TO CM-LF-BENEFIT-AMT
  9816     END-IF.
  9817
  9818     IF LCVRATEL GREATER ZERO
  9819         MOVE WS-LCVRATE         TO CM-LF-PREMIUM-RATE
  9820     END-IF.
  9821
  9822     IF WS-EXPIRE NOT = LOW-VALUES
  9823         MOVE WS-EXPIRE          TO CM-LF-LOAN-EXPIRE-DT
  9824     END-IF.
  9825
  9826     IF LCVFORML GREATER ZERO
  9827         MOVE LCVFORMI           TO CM-POLICY-FORM-NO
  9828     END-IF.
  9829
  9830     IF LCVCNDTL = ZERO
  9831        GO TO 3700-BUILD-AH-COVERAGE-SIDE
  9832     END-IF.
  9833
  9834     IF WS-LCVCNDT NOT = LOW-VALUES
  9835        MOVE '8'                 TO CM-LF-CURRENT-STATUS
  9836        MOVE WS-LCVCNDT          TO CM-LF-CANCEL-DT
  9837        GO TO 3700-BUILD-AH-COVERAGE-SIDE
  9838     END-IF.
  9839
  9840     IF CM-LF-CURRENT-STATUS = '7'
  9841        MOVE CM-LF-STATUS-AT-DEATH TO CM-LF-CURRENT-STATUS
  9842        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
  9843        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
  9844                                    CM-LF-DEATH-DT
  9845        GO TO 3700-BUILD-AH-COVERAGE-SIDE
  9846     END-IF.
  9847
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 189
* EL130.cbl
  9848     IF CM-LF-CURRENT-STATUS = '8'
  9849        MOVE '1'                 TO CM-LF-CURRENT-STATUS
  9850        MOVE LOW-VALUES          TO CM-LF-CANCEL-DT
  9851     END-IF.
  9852
  9853 3700-BUILD-AH-COVERAGE-SIDE.
  9854
  9855     IF CERTMTI = 'A'
  9856         IF ACVCDL = ZEROS
  9857             MOVE ZEROS          TO CM-AH-BENEFIT-CD
  9858                                    CM-AH-ORIG-TERM
  9859                                    CM-AH-BENEFIT-AMT
  9860                                    CM-AH-PREMIUM-RATE
  9861             GO TO 3700-COVERAGE-BUILT
  9862         END-IF
  9863     END-IF.
  9864
  9865     IF ACVCDL GREATER ZERO
  9866         MOVE ACVCDI             TO CM-AH-BENEFIT-CD
  9867     END-IF.
  9868
  9869     IF ACVOTRML GREATER ZERO
  9870         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM
  9871     END-IF.
  9872
  9873     IF ACVBENEL GREATER ZERO
  9874         MOVE WS-ACVBENE         TO CM-AH-BENEFIT-AMT
  9875     END-IF.
  9876
  9877     IF ACVRATEL GREATER ZERO
  9878         MOVE WS-ACVRATE         TO CM-AH-PREMIUM-RATE
  9879     END-IF.
  9880
  9881     IF WS-EXPIRE NOT = LOW-VALUES
  9882         MOVE WS-EXPIRE          TO CM-AH-LOAN-EXPIRE-DT
  9883     END-IF.
  9884
  9885     IF ACVFORML GREATER ZERO
  9886         MOVE ACVFORMI           TO CM-POLICY-FORM-NO
  9887     END-IF.
  9888
  9889     IF ACVCNDTL = ZERO
  9890        GO TO 3700-COVERAGE-BUILT
  9891     END-IF.
  9892
  9893     IF WS-ACVCNDT NOT = LOW-VALUES
  9894        MOVE '8'                 TO CM-AH-CURRENT-STATUS
  9895        MOVE WS-ACVCNDT          TO CM-AH-CANCEL-DT
  9896        GO TO 3700-COVERAGE-BUILT
  9897     END-IF.
  9898
  9899     IF CM-AH-CURRENT-STATUS = '6'
  9900        MOVE CM-AH-STATUS-AT-SETTLEMENT TO CM-AH-CURRENT-STATUS
  9901        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
  9902        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
  9903        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-DT
  9904        GO TO 3700-COVERAGE-BUILT
  9905     END-IF.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 190
* EL130.cbl
  9906
  9907     IF CM-AH-CURRENT-STATUS = '8'
  9908        MOVE '1'                 TO CM-AH-CURRENT-STATUS
  9909        MOVE LOW-VALUES          TO CM-AH-CANCEL-DT
  9910     END-IF.
  9911
  9912 3700-COVERAGE-BUILT.
  9913     IF ISSAGEL GREATER ZERO
  9914         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE
  9915     END-IF.
  9916
  9917     IF JNTAGEL GREATER ZERO
  9918         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE
  9919     END-IF.
  9920
  9921     IF SEXL GREATER ZERO
  9922         MOVE SEXI               TO CM-INSURED-SEX
  9923     END-IF.
  9924
  9925     IF APRL GREATER ZERO
  9926         MOVE WS-APR             TO CM-LOAN-APR
  9927     END-IF.
  9928
  9929     IF PMTFREQL GREATER ZERO
  9930         MOVE WS-PMTFREQ         TO CM-PAY-FREQUENCY
  9931     END-IF.
  9932
  9933     IF INDGRPL GREATER ZERO
  9934         MOVE INDGRPI            TO CM-IND-GRP-TYPE
  9935     END-IF.
  9936
  9937     IF CERTMTI = 'A'
  9938         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE
  9939     END-IF.
  9940
  9941     IF REINCDL GREATER ZERO
  9942         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
  9943                                    WS-REIN-1
  9944                                    WS-REIN-2
  9945                                    WS-REIN-3
  9946         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE
  9947     END-IF.
  9948
  9949     IF WS-ADD-ON-DT NOT = LOW-VALUES
  9950         MOVE WS-ADD-ON-DT   TO CM-LAST-ADD-ON-DT
  9951     END-IF.
  9952
  9953     IF CRTSSNL GREATER ZERO
  9954         MOVE CRTSSNI            TO CM-SOC-SEC-NO
  9955     ELSE
  9956         IF SSNL GREATER ZERO
  9957             MOVE SSNI           TO CM-SOC-SEC-NO
  9958         END-IF
  9959     END-IF.
  9960
  9961     IF CRTSSNL = ZERO AND
  9962        SSNL    = ZERO
  9963         MOVE CM-STATE             TO CM-SSN-STATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 191
* EL130.cbl
  9964         MOVE CM-ACCOUNT-PRIME     TO CM-SSN-ACCOUNT
  9965         MOVE CM-INSURED-INITIALS  TO CM-INSURED-INITIALS-A2
  9966         MOVE CM-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
  9967     END-IF.
  9968
  9969     IF CM-LF-CURRENT-STATUS = SPACES
  9970         MOVE '1'                TO CM-LF-CURRENT-STATUS
  9971     END-IF.
  9972
  9973     IF CM-AH-CURRENT-STATUS = SPACES
  9974         MOVE '1'                TO CM-AH-CURRENT-STATUS
  9975     END-IF.
  9976
  9977     IF CERTMTI = 'A'
  9978         MOVE SAVE-BIN-DATE      TO CM-ENTRY-DT
  9979     END-IF.
  9980
  9981 3700-FINISH-CERT-BUILD.
  9982
  9983     IF LOANNOL GREATER ZERO
  9984         MOVE LOANNOI            TO CM-LOAN-NUMBER
  9985     END-IF.
  9986
  9987     IF LOANBALL GREATER ZERO
  9988         MOVE HOLD-LOAN-BAL      TO CM-LOAN-BALANCE
  9989     END-IF.
  9990
  9991     IF PREMTYPL GREATER ZERO
  9992         MOVE PREMTYPI           TO CM-PREMIUM-TYPE
  9993     END-IF.
  9994
  9995 3700-EXIT.
  9996      EXIT.
  9997
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 192
* EL130.cbl
  9999 3800-BUILD-NEW-CLAIM.
 10000
 10001*************************************************************
 10002*****           START OF ACTIVITY FILE PROCESSING          **
 10003*************************************************************
 10004     IF PI-COMPANY-ID EQUAL 'CID' OR 'AHL'
 10005         PERFORM 6700-OUTPUT-ACTIVITY-RECORD THRU
 10006                 6700-EXIT
 10007     END-IF.
 10008*************************************************************
 10009*****            END OF ACTIVITY FILE PROCESSING           **
 10010*************************************************************
 10011
 10012
 10013
 10014
 10015* EXEC CICS GETMAIN
 10016*        SET     (ADDRESS OF CLAIM-MASTER)
 10017*        LENGTH  (ELMSTR-LENGTH)
 10018*    END-EXEC.
 10019*    MOVE '," L                  $   #00009297' TO DFHEIV0
 10020     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10021     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10022     MOVE X'2020233030303039323937' TO DFHEIV0(25:11)
 10023     CALL 'kxdfhei1' USING DFHEIV0,
 10024           DFHEIV20,
 10025           ELMSTR-LENGTH,
 10026           DFHEIV99
 10027     SET ADDRESS OF CLAIM-MASTER TO
 10028         DFHEIV20
 10029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10030
 10031
 10032     MOVE SPACES TO CLAIM-MASTER.
 10033
 10034     MOVE LOW-VALUES   TO       CL-INSURED-BIRTH-DT CL-INCURRED-DT
 10035         CL-NEXT-FOLLOWUP-DT    CL-REPORTED-DT      CL-LAST-PMT-DT
 10036         CL-EST-END-OF-DISAB-DT CL-PAID-THRU-DT   CL-LAST-CLOSE-DT
 10037         CL-LAST-REOPEN-DT      CL-PURGED-DT        CL-RESTORED-DT
 10038         CL-NEXT-AUTO-PAY-DT    CL-NEXT-RESEND-DT
 10039         CL-LAST-ADD-ON-DT      CL-FILE-ESTABLISH-DT
 10040         CL-LAST-MAINT-DT       CL-HISTORY-ARCHIVE-DT
 10041         CL-ACTIVITY-MAINT-DT.
 10042
 10043     MOVE +0 TO CL-LAST-PMT-AMT      CL-TOTAL-PAID-AMT
 10044             CL-NO-OF-PMTS-MADE      CL-NO-OF-DAYS-PAID
 10045             CL-LAST-INC-DT-CHANGE   CL-AUTO-PAY-SEQ
 10046             CL-INSURED-ADDR-CNT     CL-ACCOUNT-ADDR-CNT
 10047             CL-BENIF-ADDR-CNT       CL-EMPLOYER-ADDR-CNT
 10048             CL-DOCTOR-ADDR-CNT      CL-OTHER-1-ADDR-CNT
 10049             CL-OTHER-2-ADDR-CNT     CL-FATAL-ERROR-CNT
 10050             CL-CLAIM-PAYMENT-STATUS CL-LAST-MAINT-HHMMSS
 10051             CL-FORCEABLE-ERROR-CNT.
 10052
 10053     MOVE WS-INSURED-ADDR-CNT    TO CL-INSURED-ADDR-CNT.
 10054
 10055     MOVE ZEROS                  TO CL-ACTIVITY-CODE
 10056                                    CL-LAPSE-REPORT-CODE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 193
* EL130.cbl
 10057                                    CL-LAG-REPORT-CODE.
 10058
 10059     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 10060     MOVE +4095                  TO CL-TRAILER-SEQ-CNT.
 10061
 10062     IF BENECDL NOT = ZEROS
 10063        MOVE BENECDI             TO CL-BENEFICIARY
 10064     END-IF.
 10065
 10066     MOVE 'CL'                   TO CL-RECORD-ID.
 10067     MOVE 'CR'                   TO CL-SYSTEM-IDENTIFIER.
 10068
 10069     MOVE PI-COMPANY-CD  TO  CL-COMPANY-CD     CL-COMPANY-CD-A1
 10070                             CL-COMPANY-CD-A2  CL-COMPANY-CD-A4
 10071                             CL-COMPANY-CD-A5.
 10072
 10073     MOVE CLMCARRI               TO CL-CARRIER.
 10074
 10075     IF CLMNOL = ZERO
 10076         MOVE WS-CLAIM-NUMBER    TO CL-CLAIM-NO
 10077     ELSE
 10078         MOVE CLMNOI             TO CL-CLAIM-NO
 10079     END-IF.
 10080
 10081     MOVE CERTNOI                TO CL-CERT-PRIME
 10082                                    CL-CERT-A4-PRIME.
 10083
 10084     MOVE SUFXI                  TO CL-CERT-SFX
 10085                                    CL-CERT-A4-SFX.
 10086
 10087     MOVE PCERTNOI               TO CL-PRIME-CERT-PRIME.
 10088
 10089     MOVE PSUFXI                 TO CL-PRIME-CERT-SFX.
 10090
 10091     MOVE CL-PRIME-CERT-NO       TO PI-PRIMARY-CERT-NO.
 10092
 10093     MOVE LSTNMEI                TO CL-INSURED-LAST-NAME.
 10094
 10095     MOVE WS-TODAY-DT            TO CL-FILE-ESTABLISH-DT.
 10096     MOVE ' '                    TO CL-LAST-MAINT-TYPE.
 10097
 10098     PERFORM 3995-BUILD-CLAIM-RECORD THRU 3995-EXIT.
 10099
 10100     IF CERTMTI = 'A'
 10101         MOVE '2'                TO CL-CERT-ORIGIN
 10102     ELSE
 10103         MOVE '1'                TO CL-CERT-ORIGIN
 10104     END-IF.
 10105
 10106     MOVE CERT-CARRIER        TO CL-CERT-CARRIER   PI-CARRIER.
 10107     MOVE CERT-GROUPING       TO CL-CERT-GROUPING  PI-GROUPING.
 10108     MOVE CERT-STATE          TO CL-CERT-STATE     PI-STATE.
 10109     MOVE CERT-ACCOUNT        TO CL-CERT-ACCOUNT   PI-ACCOUNT.
 10110     MOVE WS-EFFDT            TO CL-CERT-EFF-DT    PI-CERT-EFF-DT.
 10111
 10112 3820-REWRITE-CONTROL-FILE.
 10113
 10114     IF CLMNOL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 194
* EL130.cbl
 10115         GO TO 3830-SEQUENCE-CLAIM-RECORDS
 10116     END-IF.
 10117
 10118     IF CF-RECORD-TYPE = '6'
 10119         MOVE SAVE-COUNTER    TO  CF-CLAIM-COUNTER
 10120     ELSE
 10121         MOVE SAVE-COUNTER    TO  CF-CO-CLAIM-COUNTER
 10122     END-IF.
 10123
 10124
 10125
 10126* EXEC CICS REWRITE
 10127*        DATASET   (ELCNTL-DSID)
 10128*        FROM      (CONTROL-FILE)
 10129*    END-EXEC.
 10130     MOVE LENGTH OF
 10131      CONTROL-FILE
 10132       TO DFHEIV11
 10133*    MOVE '&& L                  %   #00009395' TO DFHEIV0
 10134     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10135     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10136     MOVE X'2020233030303039333935' TO DFHEIV0(25:11)
 10137     CALL 'kxdfhei1' USING DFHEIV0,
 10138           ELCNTL-DSID,
 10139           CONTROL-FILE,
 10140           DFHEIV11,
 10141           DFHEIV99
 10142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10143
 10144
 10145 3830-SEQUENCE-CLAIM-RECORDS.
 10146
 10147     MOVE CLAIM-MASTER           TO WS-SAVE-CLAIM-MASTER.
 10148     MOVE CL-CONTROL-PRIMARY     TO ELMSTR-KEY.
 10149     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 10150
 10151     IF WS-ASSOC-CERT-TOTAL = ZERO
 10152         MOVE 1                  TO CL-ASSOC-CERT-SEQU
 10153                                    CL-ASSOC-CERT-TOTAL
 10154         GO TO 3840-WRITE-CLAIM-MASTER
 10155     END-IF.
 10156
 10157     IF CL-CONTROL-PRIMARY LESS THAN WS-SAVE-CLAIM-KEY
 10158         MOVE CL-CONTROL-PRIMARY TO ELMSTR-KEY
 10159     ELSE
 10160         MOVE WS-SAVE-CLAIM-KEY  TO ELMSTR-KEY
 10161     END-IF.
 10162
 10163     MOVE WS-SAVE-CLAIM-MASTER   TO CLAIM-MASTER.
 10164     MOVE ZERO                   TO CL-ASSOC-CERT-SEQU.
 10165     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 10166
 10167 3840-WRITE-CLAIM-MASTER.
 10168
 10169     PERFORM 6600-CHECK-AUTO-ACTIVITY THRU 6600-EXIT.
 10170     IF WS-REC-FOUND-SW = 'Y'
 10171         MOVE 01                 TO  CL-ACTIVITY-CODE
 10172         MOVE SAVE-BIN-DATE      TO  CL-ACTIVITY-MAINT-DT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 195
* EL130.cbl
 10173         MOVE 'ADD '             TO  CL-ACTIVITY-MAINT-TYPE
 10174     END-IF.
 10175
 10176
 10177
 10178* EXEC CICS HANDLE CONDITION
 10179*         DUPKEY    (3850-CLAIM-MSTR-WRITTEN)
 10180*    END-EXEC.
 10181*    MOVE '"$$                   ! : #00009432' TO DFHEIV0
 10182     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10183     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10184     MOVE X'3A20233030303039343332' TO DFHEIV0(25:11)
 10185     CALL 'kxdfhei1' USING DFHEIV0
 10186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10187
 10188
 10189** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
 10190     MOVE CL-CERT-NO             TO CL-CCN-A5.
 10191
 10192
 10193
 10194* EXEC CICS WRITE
 10195*        DATASET   (ELMSTR-DSID)
 10196*        FROM      (CLAIM-MASTER)
 10197*        RIDFLD    (CL-CONTROL-PRIMARY)
 10198*    END-EXEC.
 10199     MOVE LENGTH OF
 10200      CLAIM-MASTER
 10201       TO DFHEIV11
 10202*    MOVE '&$ L                  ''   #00009440' TO DFHEIV0
 10203     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10204     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10205     MOVE X'2020233030303039343430' TO DFHEIV0(25:11)
 10206     CALL 'kxdfhei1' USING DFHEIV0,
 10207           ELMSTR-DSID,
 10208           CLAIM-MASTER,
 10209           DFHEIV11,
 10210           CL-CONTROL-PRIMARY,
 10211           DFHEIV99,
 10212           DFHEIV99
 10213     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10214
 10215
 10216 3850-CLAIM-MSTR-WRITTEN.
 10217
 10218     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 10219         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT
 10220     END-IF.
 10221
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 196
* EL130.cbl
 10223 3990-ADD-DONE.
 10224     MOVE 1                     TO EMI-SWITCH1  EMI-SWITCH-AREA-1
 10225                                   EMI-SUB      EMI-SWITCH-AREA-2.
 10226     MOVE SPACES                TO EMI-ACTION-SWITCH
 10227                                   EMI-ERROR-LINES.
 10228
 10229     IF CLMNOL = ZERO
 10230         MOVE ER-0265            TO EMI-ERROR
 10231         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10232         MOVE WS-CLAIM-NUMBER    TO EMI-TEXT-VARIABLE (1)
 10233                                    PI-LAST-CLAIM
 10234     ELSE
 10235         MOVE CLMNOI             TO PI-LAST-CLAIM
 10236         MOVE ER-0000            TO EMI-ERROR
 10237         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10238     END-IF.
 10239
 10240     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 10241       AND PI-ST-VFY-2ND-BENE = 'Y'
 10242         PERFORM 3994-BUILD-NINETY-THREE-TRAILER THRU 3994-EXIT
 10243         MOVE ER-7575            TO EMI-ERROR
 10244         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10245     END-IF.
 10246
 10247     IF WS-NO-INSURED-ADDRESS = 'Y'
 10248         MOVE ER-3548            TO EMI-ERROR
 10249         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10250     END-IF.
 10251
 10252     MOVE CLMNOI                     TO  PI-CLAIM-NO.
 10253     MOVE CLMCARRI                   TO  PI-CARRIER.
 10254     MOVE CERTNOI                    TO  PI-CERT-PRIME.
 10255     MOVE SUFXI                      TO  PI-CERT-SFX.
 10256
 10257     IF WS-LETTER-SW = 'Y'
 10258         PERFORM 6600-START-AUTO-LETTER-WRITER THRU 6600-EXIT
 10259         IF W-1523-ERROR-CODE NOT = ZEROS
 10260             MOVE W-1523-ERROR-CODE  TO  EMI-ERROR
 10261             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10262         END-IF
 10263     END-IF.
 10264
 10265     MOVE CLMTYPEI               TO PI-LAST-CLAIM-TYPE.
 10266     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
 10267     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
 10268     MOVE CLMCARRI               TO PI-LAST-CARR.
 10269
 10270     IF PRTOPTL GREATER THAN 0
 10271         MOVE PRTOPTI            TO PI-PRT-OPT
 10272     END-IF.
 10273     IF ALTPRTL GREATER THAN 0
 10274         MOVE ALTPRTI            TO PI-ALT-PRT
 10275     END-IF.
 10276
 10277     IF PI-CERT-PROCESSED NOT LESS THAN PI-CERT-SELECT-CNT
 10278         MOVE LOW-VALUES         TO EL130AI
 10279         MOVE PI-LAST-CERT-PRIME TO CERTNOO
 10280         MOVE AL-SANON           TO CERTNOA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 197
* EL130.cbl
 10281         MOVE PI-LAST-CERT-SUFX  TO SUFXO
 10282         MOVE AL-SANON           TO SUFXA
 10283         MOVE PI-LAST-CARR       TO CLMCARRO
 10284         MOVE AL-UANON           TO CLMCARRA
 10285         MOVE PI-LAST-CLAIM      TO CLMNOO
 10286         MOVE AL-UANON           TO CLMNOA
 10287         MOVE PI-LAST-CLAIM-TYPE TO CLMTYPEO
 10288         MOVE AL-UANON           TO CLMTYPEA
 10289     ELSE
 10290         PERFORM 0690-HIGHLIGHT-CERTS THRU 0690-EXIT
 10291         PERFORM 3993-MODIFY-CLAIM-ATTRB THRU 3993-EXIT
 10292     END-IF.
 10293
 10294     IF PI-PRT-OPT = 'N' OR 'L'
 10295         MOVE PI-PRT-OPT         TO PRTOPTO
 10296         MOVE 1                  TO PRTOPTL
 10297     END-IF.
 10298
 10299     IF PI-ALT-PRT NOT = SPACES AND LOW-VALUES
 10300         MOVE PI-ALT-PRT         TO ALTPRTO
 10301         MOVE 4                  TO ALTPRTL
 10302     END-IF.
 10303
 10304     IF PRTOPTL GREATER THAN 0
 10305         IF PRTOPTI = 'L'
 10306             GO TO 0400-CREATE-ELACTQ
 10307         ELSE
 10308             GO TO 0480-PRINT-NOW
 10309         END-IF
 10310     END-IF.
 10311
 10312     IF PI-CERT-PROCESSED NOT LESS THAN PI-CERT-SELECT-CNT
 10313         GO TO 8100-SEND-INITIAL-MAP
 10314     ELSE
 10315         MOVE LOW-VALUES         TO MAINTO
 10316         MOVE -1                 TO MAINTL
 10317         GO TO 8200-SEND-DATAONLY
 10318     END-IF.
 10319
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 198
* EL130.cbl
 10321 3993-MODIFY-SCREEN-ATTRB.
 10322
 10323     IF CERTMTL GREATER ZERO
 10324         MOVE AL-UANON           TO CERTMTA
 10325     END-IF.
 10326
 10327     IF EFFDTL GREATER ZERO
 10328         MOVE AL-UANON           TO EFFDTA
 10329     END-IF.
 10330
 10331     IF ACCOUNTL GREATER ZERO
 10332         MOVE AL-UANON           TO ACCOUNTA
 10333     END-IF.
 10334
 10335     IF STATEL GREATER ZERO
 10336         MOVE AL-UANON           TO STATEA
 10337     END-IF.
 10338
 10339     IF CRTCARRL GREATER ZERO
 10340         MOVE AL-UANON           TO CRTCARRA
 10341     END-IF.
 10342
 10343     IF GROUPL GREATER ZERO
 10344         MOVE AL-UANON           TO GROUPA
 10345     END-IF.
 10346
 10347     IF CRTLNMEL GREATER ZERO
 10348         MOVE AL-UANON           TO CRTLNMEA
 10349     END-IF.
 10350
 10351     IF CRTFNMEL GREATER ZERO
 10352         MOVE AL-UANON           TO CRTFNMEA
 10353     END-IF.
 10354
 10355     IF CRTINITL GREATER ZERO
 10356         MOVE AL-UANON           TO CRTINITA
 10357     END-IF.
 10358
 10359     IF ISSAGEL GREATER ZERO
 10360         MOVE AL-UNNON           TO ISSAGEA
 10361     END-IF.
 10362
 10363     IF JNTLNMEL GREATER ZERO
 10364         MOVE AL-UANON           TO JNTLNMEA
 10365     END-IF.
 10366
 10367     IF JNTFNMEL GREATER ZERO
 10368         MOVE AL-UANON           TO JNTFNMEA
 10369     END-IF.
 10370
 10371     IF JNTINITL GREATER ZERO
 10372         MOVE AL-UANON           TO JNTINITA
 10373     END-IF.
 10374
 10375     IF JNTAGEL GREATER ZERO
 10376         MOVE AL-UNNON           TO JNTAGEA
 10377     END-IF.
 10378
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 199
* EL130.cbl
 10379     IF CRTSSNL GREATER ZERO
 10380         MOVE AL-UANON           TO CRTSSNA
 10381     END-IF.
 10382
 10383     IF ACVDSCRL GREATER ZERO
 10384         MOVE AL-SANON           TO ACVDSCRA
 10385     END-IF.
 10386
 10387     IF ACVKINDL GREATER ZERO
 10388         MOVE AL-SANON           TO ACVKINDA
 10389     END-IF.
 10390
 10391     IF ACVCDL GREATER ZERO
 10392         MOVE AL-UANON           TO ACVCDA
 10393     END-IF.
 10394
 10395     IF ACVOTRML GREATER ZERO
 10396         MOVE AL-UNNON           TO ACVOTRMA
 10397     END-IF.
 10398
 10399     IF ACVRTRML GREATER ZERO
 10400         MOVE AL-UNNON           TO ACVRTRMA
 10401     END-IF.
 10402
 10403     IF ACVRATEL GREATER ZERO
 10404         MOVE AL-UNNON           TO ACVRATEA
 10405     END-IF.
 10406
 10407     IF ACVBENEL GREATER ZERO
 10408         MOVE AL-UNNON           TO ACVBENEA
 10409     END-IF.
 10410
 10411     IF ACVFORML GREATER ZERO
 10412         MOVE AL-UANON           TO ACVFORMA
 10413     END-IF.
 10414
 10415     IF ACVCNDTL GREATER ZERO
 10416         MOVE AL-UANON           TO ACVCNDTA
 10417     END-IF.
 10418
 10419     IF ACVEXITL GREATER ZERO
 10420         MOVE AL-UANON           TO ACVEXITA
 10421     END-IF.
 10422
 10423     IF ACVSTATL GREATER ZERO
 10424         MOVE AL-UANON           TO ACVSTATA
 10425     END-IF.
 10426
 10427     IF LCVDSCRL GREATER ZERO
 10428         MOVE AL-SANON           TO LCVDSCRA
 10429     END-IF.
 10430
 10431     IF LCVKINDL GREATER ZERO
 10432         MOVE AL-SANON           TO LCVKINDA
 10433     END-IF.
 10434
 10435     IF LCVCDL GREATER ZERO
 10436         MOVE AL-UANON           TO LCVCDA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 200
* EL130.cbl
 10437     END-IF.
 10438
 10439     IF LCVOTRML GREATER ZERO
 10440         MOVE AL-UNNON           TO LCVOTRMA
 10441     END-IF.
 10442
 10443     IF LCVRTRML GREATER ZERO
 10444         MOVE AL-UNNON           TO LCVRTRMA
 10445     END-IF.
 10446
 10447     IF LCVRATEL GREATER ZERO
 10448         MOVE AL-UNNON           TO LCVRATEA
 10449     END-IF.
 10450
 10451     IF LCVBENEL GREATER ZERO
 10452         MOVE AL-UNNON           TO LCVBENEA
 10453     END-IF.
 10454
 10455     IF LCVFORML GREATER ZERO
 10456         MOVE AL-UANON           TO LCVFORMA
 10457     END-IF.
 10458
 10459     IF LCVCNDTL GREATER ZERO
 10460         MOVE AL-UANON           TO LCVCNDTA
 10461     END-IF.
 10462
 10463     IF LCVEXITL GREATER ZERO
 10464         MOVE AL-UANON           TO LCVEXITA
 10465     END-IF.
 10466
 10467     IF LCVSTATL GREATER ZERO
 10468         MOVE AL-UANON           TO LCVSTATA
 10469     END-IF.
 10470
 10471     IF MEMCAPL GREATER ZERO
 10472         MOVE AL-UANON           TO MEMCAPA
 10473     END-IF.
 10474
 10475     IF APRL GREATER ZERO
 10476         MOVE AL-UNNON           TO APRA
 10477     END-IF.
 10478
 10479     IF PMTFREQL GREATER ZERO
 10480         MOVE AL-UNNON           TO PMTFREQA
 10481     END-IF.
 10482
 10483     IF INDGRPL GREATER ZERO
 10484         MOVE AL-UANON           TO INDGRPA
 10485     END-IF.
 10486
 10487     IF PREMTYPL GREATER ZERO
 10488         MOVE AL-UANON           TO PREMTYPA
 10489     END-IF.
 10490
 10491     IF REINCDL GREATER ZERO
 10492         MOVE AL-UANON           TO REINCDA
 10493     END-IF.
 10494
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 201
* EL130.cbl
 10495     IF ADDONDTL GREATER ZERO
 10496         MOVE AL-UANON           TO ADDONDTA
 10497     END-IF.
 10498
 10499     IF MEMBERL GREATER ZERO
 10500         MOVE AL-UANON           TO MEMBERA
 10501     END-IF.
 10502
 10503     IF BCERT1L GREATER ZERO
 10504         MOVE AL-SANON           TO BCERT1A
 10505                                    BSUFX1A
 10506     END-IF.
 10507
 10508     IF BCERT2L GREATER ZERO
 10509         MOVE AL-SANON           TO BCERT2A
 10510                                    BSUFX2A
 10511     END-IF.
 10512
 10513     IF BCERT3L GREATER ZERO
 10514         MOVE AL-SANON           TO BCERT3A
 10515                                    BSUFX3A
 10516     END-IF.
 10517
 10518     IF BCERT4L GREATER ZERO
 10519         MOVE AL-SANON           TO BCERT4A
 10520                                    BSUFX4A
 10521     END-IF.
 10522
 10523     IF BCERT5L GREATER ZERO
 10524         MOVE AL-SANON           TO BCERT5A
 10525                                    BSUFX5A
 10526     END-IF.
 10527
 10528 3993-MODIFY-CLAIM-ATTRB.
 10529
 10530     IF PCERTNOL GREATER ZERO
 10531         MOVE AL-UANON           TO PCERTNOA
 10532     END-IF.
 10533
 10534     IF PSUFXL GREATER ZERO
 10535         MOVE AL-UANON           TO PSUFXA
 10536     END-IF.
 10537
 10538     IF LSTNMEL GREATER ZERO
 10539         MOVE AL-UANON           TO LSTNMEA
 10540     END-IF.
 10541
 10542     IF FSTNMEL GREATER ZERO
 10543         MOVE AL-UANON           TO FSTNMEA
 10544     END-IF.
 10545
 10546     IF INITL GREATER ZERO
 10547         MOVE AL-UANON           TO INITA
 10548     END-IF.
 10549
 10550     IF SEXL GREATER ZERO
 10551         MOVE AL-UANON           TO SEXA
 10552     END-IF.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 202
* EL130.cbl
 10553
 10554     IF OCCCDL GREATER ZERO
 10555         MOVE AL-UANON           TO OCCCDA
 10556     END-IF.
 10557
 10558     IF BIRTHDTL GREATER ZERO
 10559         MOVE AL-UANON           TO BIRTHDTA
 10560     END-IF.
 10561
 10562     IF SSNL GREATER ZERO
 10563         MOVE AL-UANON           TO SSNA
 10564     END-IF.
 10565
 10566     IF INCURL GREATER ZERO
 10567         MOVE AL-UANON           TO INCURA
 10568     END-IF.
 10569
 10570     IF REPORTL GREATER ZERO
 10571         MOVE AL-UANON           TO REPORTA
 10572     END-IF.
 10573
 10574     IF ESTENDL GREATER ZERO
 10575         MOVE AL-UANON           TO ESTENDA
 10576     END-IF.
 10577
 10578     IF DIAGL GREATER ZERO
 10579         MOVE AL-UANON           TO DIAGA
 10580     END-IF.
 10581
 10582     IF CAUSEL GREATER ZERO
 10583         MOVE AL-UANON           TO CAUSEA
 10584     END-IF.
 10585
 10586     IF MANRSVL GREATER ZERO
 10587         MOVE AL-UNNON           TO MANRSVA
 10588     END-IF.
 10589
 10590     IF RELCLML GREATER ZERO
 10591         MOVE AL-UANON           TO RELCLMA
 10592     END-IF.
 10593
 10594     IF LOANNOL GREATER ZERO
 10595         MOVE AL-UANON           TO LOANNOA
 10596     END-IF.
 10597
 10598     IF LOANBALL GREATER ZERO
 10599         MOVE AL-UNNON           TO LOANBALA
 10600     END-IF.
 10601
 10602     IF PROCCDL GREATER ZERO
 10603         MOVE AL-UANON           TO PROCCDA
 10604     END-IF.
 10605
 10606     IF BENECDL GREATER THAN ZERO
 10607         MOVE AL-UANON           TO  BENECDA
 10608     END-IF.
 10609
 10610     IF PRICDL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 203
* EL130.cbl
 10611         MOVE AL-UANON           TO PRICDA
 10612     END-IF.
 10613
 10614     IF SUPVL GREATER ZERO
 10615         MOVE AL-UANON           TO SUPVA
 10616     END-IF.
 10617
 10618     IF FILETOL GREATER ZERO
 10619         MOVE AL-UANON           TO FILETOA
 10620     END-IF.
 10621
 10622
 10623 3993-MODIFY-CLAIM-KEY-ATTRB.
 10624
 10625     IF CLMNOL GREATER ZERO
 10626         MOVE AL-UANON           TO CLMNOA
 10627     END-IF.
 10628
 10629     IF CLMCARRL GREATER ZERO
 10630         MOVE AL-UANON           TO CLMCARRA
 10631     END-IF.
 10632
 10633     IF CLMTYPEL GREATER ZERO
 10634         MOVE AL-UANON           TO CLMTYPEA
 10635     END-IF.
 10636
 10637     IF CERTNOL GREATER ZERO
 10638         MOVE AL-SANON           TO CERTNOA
 10639     END-IF.
 10640
 10641     IF SUFXL GREATER ZERO
 10642         MOVE AL-SANON           TO SUFXA
 10643     END-IF.
 10644
 10645 3993-EXIT.
 10646     EXIT.
 10647
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 204
* EL130.cbl
 10649 3994-BUILD-NINETY-THREE-TRAILER.
 10650
 10651     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 10652     MOVE 'AT'                   TO AT-RECORD-ID.
 10653
 10654     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 10655     MOVE CLMCARRI               TO AT-CARRIER.
 10656
 10657     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 10658     MOVE CERT-CERT-NO           TO AT-CERT-NO.
 10659     MOVE +93                    TO AT-SEQUENCE-NO.
 10660     MOVE '6'                    TO AT-TRAILER-TYPE.
 10661     MOVE 'M'                    TO AT-INFO-TRAILER-TYPE.
 10662
 10663     MOVE WS-VERIFY-NOTE         TO AT-INFO-LINE-1.
 10664
 10665     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 10666                                    AT-GEN-INFO-LAST-MAINT-DT.
 10667
 10668     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 10669                                    AT-GEN-INFO-LAST-UPDATED-BY.
 10670     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 10671
 10672
 10673
 10674* EXEC CICS WRITE
 10675*        DATASET   (ELTRLR-DSID)
 10676*        FROM      (ACTIVITY-TRAILERS)
 10677*        RIDFLD    (AT-CONTROL-PRIMARY)
 10678*    END-EXEC.
 10679     MOVE LENGTH OF
 10680      ACTIVITY-TRAILERS
 10681       TO DFHEIV11
 10682*    MOVE '&$ L                  ''   #00009903' TO DFHEIV0
 10683     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10684     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10685     MOVE X'2020233030303039393033' TO DFHEIV0(25:11)
 10686     CALL 'kxdfhei1' USING DFHEIV0,
 10687           ELTRLR-DSID,
 10688           ACTIVITY-TRAILERS,
 10689           DFHEIV11,
 10690           AT-CONTROL-PRIMARY,
 10691           DFHEIV99,
 10692           DFHEIV99
 10693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10694
 10695
 10696 3994-EXIT.
 10697     EXIT.
 10698
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 205
* EL130.cbl
 10700 3995-BUILD-CLAIM-RECORD.
 10701
 10702     IF PROCCDL GREATER ZERO
 10703         MOVE PROCCDI            TO CL-PROCESSOR-ID
 10704     ELSE
 10705         MOVE PI-PROCESSOR-ID    TO CL-PROCESSOR-ID
 10706     END-IF.
 10707
 10708     IF FSTNMEL GREATER ZERO
 10709         MOVE FSTNMEI            TO CL-INSURED-1ST-NAME
 10710     END-IF.
 10711
 10712     IF INITL GREATER ZERO
 10713         MOVE INITI              TO CL-INSURED-MID-INIT
 10714     END-IF.
 10715
 10716     IF BIRTHDTL GREATER ZERO
 10717         MOVE WS-BIRTHDT         TO CL-INSURED-BIRTH-DT
 10718     END-IF.
 10719
 10720     IF SEXL GREATER ZERO
 10721         MOVE SEXI               TO CL-INSURED-SEX-CD
 10722     END-IF.
 10723
 10724     IF OCCCDL GREATER ZERO
 10725         MOVE OCCCDI             TO CL-INSURED-OCC-CD
 10726     END-IF.
 10727
 10728     MOVE 'O'                    TO CL-CLAIM-STATUS.
 10729
 10730*    IF CLMTYPEL GREATER ZERO
 10731     MOVE CLMTYPEI               TO CL-CLAIM-TYPE.
 10732*    END-IF.
 10733
 10734     IF PREMTYPL GREATER ZERO
 10735         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE
 10736     END-IF.
 10737
 10738     IF INCURL GREATER ZERO
 10739         MOVE WS-INCUR           TO CL-INCURRED-DT
 10740     END-IF.
 10741
 10742     IF REPORTL GREATER ZERO
 10743         MOVE WS-REPORT          TO CL-REPORTED-DT
 10744     END-IF.
 10745
 10746     IF EIBAID = DFHPF6
 10747         IF WS-REPORT = LOW-VALUES  OR   REPORTL = ZEROS
 10748             MOVE WS-TODAY-DT    TO CL-REPORTED-DT
 10749                 IF EMI-FORCABLE-CTR = +1
 10750                     MOVE ZEROS  TO CL-FORCEABLE-ERROR-CNT
 10751                 END-IF
 10752         END-IF
 10753     END-IF.
 10754
 10755     IF ESTENDL GREATER ZERO
 10756        MOVE WS-ESTEND           TO CL-EST-END-OF-DISAB-DT
 10757     END-IF.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 206
* EL130.cbl
 10758
 10759     IF ADDONDTL GREATER ZERO
 10760         MOVE WS-ADD-ON-DT   TO CL-LAST-ADD-ON-DT
 10761     END-IF.
 10762
 10763     IF CAUSEL GREATER ZERO
 10764         MOVE CAUSEI             TO CL-CAUSE-CD
 10765     END-IF.
 10766
 10767     IF SSNL GREATER ZERO
 10768         MOVE SSNI               TO CL-SOC-SEC-NO
 10769     ELSE
 10770         MOVE CERT-STATE         TO CL-SSN-STATE
 10771         MOVE CERT-ACCOUNT-PRIME TO CL-SSN-ACCOUNT
 10772         MOVE CL-INSURED-LAST-NAME TO CL-SSN-LN3
 10773     END-IF.
 10774
 10775     IF PRICDL GREATER ZERO
 10776         MOVE PRICDI             TO CL-PRIORITY-CD
 10777     END-IF.
 10778
 10779     IF SUPVL GREATER ZERO
 10780         MOVE SUPVI              TO CL-SUPV-ATTN-CD
 10781     END-IF.
 10782
 10783     MOVE WS-TODAY-DT            TO CL-LAST-MAINT-DT.
 10784     MOVE CL-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 10785     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 10786
 10787     IF RELCLML GREATER ZERO
 10788         MOVE RELCLMI            TO CL-RELATED-CLAIM-NO
 10789     END-IF.
 10790
 10791     IF FILETOL GREATER ZERO
 10792         MOVE FILETOI            TO CL-FILE-LOCATION
 10793     END-IF.
 10794
 10795 3995-EXIT.
 10796      EXIT.
 10797
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 207
* EL130.cbl
 10799 4000-CALCULATE-CERT-TERM.
 10800
 10801     PERFORM 4100-CALC-GROSS-TERM THRU 4200-EXIT.
 10802
 10803     MOVE N                      TO WS-TERM.
 10804
 10805     IF WS-TERM GREATER 120
 10806         MOVE 120                TO WS-TERM
 10807     END-IF.
 10808
 10809 4000-CALC-TERM-EXIT.
 10810      EXIT.
 10811
 10812 4100-CALC-GROSS-TERM.
 10813     MOVE HOLD-LOAN-BAL           TO L.
 10814     MOVE WS-ACVBENE              TO M.
 10815     COMPUTE N = L / M.
 10816     IF N LESS 1
 10817         MOVE 1  TO N
 10818     END-IF.
 10819
 10820     IF LCVCDL GREATER ZERO
 10821         COMPUTE WS-LF-RATE = WS-LCVRATE / +1000
 10822     ELSE
 10823         MOVE ZEROS               TO WS-LF-RATE
 10824     END-IF.
 10825
 10826     IF ACVCDL GREATER ZERO
 10827         COMPUTE WS-AH-RATE = WS-ACVRATE / +1000
 10828     ELSE
 10829         MOVE ZEROS               TO WS-AH-RATE
 10830     END-IF.
 10831
 10832     COMPUTE I = WS-APR / +1200.
 10833
 10834 4105-LOOP.
 10835     IF N GREATER 240
 10836         GO TO 4200-EXIT
 10837     END-IF.
 10838
 10839     PERFORM 4210-CALC-LEFT-RIGHTONE THRU 4220-EXIT.
 10840
 10841     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 10842         ADD 1 TO N
 10843         GO TO 4105-LOOP
 10844     END-IF.
 10845
 10846 4200-EXIT.
 10847      EXIT.
 10848
 10849 4210-CALC-LEFT-RIGHTONE.
 10850      MOVE L         TO LEFT-TOT-1.
 10851      SUBTRACT 1 FROM N.
 10852      PERFORM 4300-CALC-A-N THRU 4300-EXIT.
 10853      PERFORM 4350-CALC-IA-N THRU 4400-EXIT.
 10854      ADD 1 TO N.
 10855
 10856 4211-CALC-TERM1.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 208
* EL130.cbl
 10857      MOVE N         TO TERM1.
 10858      MULTIPLY M BY TERM1.
 10859
 10860 4212-LOOP.
 10861      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 10862      ADD 1 TO A-N.
 10863      MULTIPLY A-N BY TERM1.
 10864      SUBTRACT 1 FROM A-N.
 10865      ADD TERM1 TO LEFT-TOT-1.
 10866
 10867 4213-CALC-TERM2.
 10868      MOVE M         TO TERM2.
 10869      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 10870      MULTIPLY IA-N BY TERM2.
 10871      SUBTRACT TERM2 FROM LEFT-TOT-1.
 10872
 10873 4215-CALC-RIGHTONE.
 10874      MOVE M         TO RIGHT-TOT-1.
 10875      PERFORM 4300-CALC-A-N THRU 4300-EXIT.
 10876      MULTIPLY A-N BY RIGHT-TOT-1.
 10877
 10878 4220-EXIT.
 10879      EXIT.
 10880
 10881 4300-CALC-A-N.
 10882     IF N LESS 1
 10883         MOVE 0     TO A-N
 10884         GO TO 4300-EXIT
 10885     END-IF.
 10886
 10887     IF I = 0
 10888         MOVE .00001 TO I
 10889     END-IF.
 10890
 10891     ADD 1 TO I.
 10892     DIVIDE I INTO 1 GIVING V.
 10893     SUBTRACT 1 FROM I.
 10894     PERFORM 4450-CALC-V-EX-N THRU 4490-EXIT.
 10895     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 10896     DIVIDE I INTO TERM3 GIVING A-N.
 10897
 10898 4300-EXIT.
 10899      EXIT.
 10900
 10901 4350-CALC-IA-N.
 10902     IF N LESS 1
 10903         MOVE 0      TO IA-N
 10904         GO TO 4400-EXIT
 10905     END-IF.
 10906
 10907     ADD 1 TO N.
 10908     PERFORM 4450-CALC-V-EX-N THRU 4490-EXIT.
 10909     SUBTRACT 1 FROM N.
 10910     MULTIPLY N BY V-EX-N GIVING TERM3.
 10911     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 10912     SUBTRACT V FROM 1 GIVING TERM4.
 10913     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 10914
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 209
* EL130.cbl
 10915 4400-EXIT.
 10916      EXIT.
 10917
 10918 4450-CALC-V-EX-N.
 10919     IF N LESS 1
 10920         MOVE 1    TO V-EX-N
 10921         GO TO 4490-EXIT
 10922     END-IF.
 10923
 10924     MOVE N        TO NV-STORE.
 10925
 10926     IF V-EX-ONETIME = 1  OR
 10927        V NOT = V-EXPONENT (1)
 10928          PERFORM 4470-BUILD-V-EX-TABLE THRU 4480-EXIT
 10929     END-IF.
 10930
 10931 4460-LOOP.
 10932     IF N GREATER 248
 10933         MOVE 248 TO N
 10934     END-IF.
 10935
 10936     IF N = 1
 10937         MOVE V               TO V-EX-N
 10938     ELSE
 10939         MOVE V-EXPONENT (N)  TO V-EX-N
 10940     END-IF.
 10941
 10942     GO TO 4490-EXIT.
 10943
 10944 4470-BUILD-V-EX-TABLE.
 10945     MOVE 2      TO N.
 10946     MOVE V      TO V-EXPONENT (1)
 10947                    V-EX-N.
 10948
 10949 4471-LOOP.
 10950     MULTIPLY V BY V-EX-N.
 10951     MOVE V-EX-N   TO V-EXPONENT (N).
 10952
 10953     ADD 1 TO N.
 10954     IF N LESS 248
 10955         GO TO 4471-LOOP
 10956     END-IF.
 10957
 10958     MOVE NV-STORE     TO N.
 10959     MOVE ZERO         TO V-EX-ONETIME.
 10960
 10961 4480-EXIT.
 10962      EXIT.
 10963
 10964 4490-EXIT.
 10965      EXIT.
 10966
 10967 4500-CALC-NET-TERM.
 10968     MOVE HOLD-LOAN-BAL           TO L.
 10969     MOVE WS-ACVBENE              TO M.
 10970     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 10971
 10972     IF WS-REMAIN GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 210
* EL130.cbl
 10973         ADD 1 TO N
 10974     END-IF.
 10975
 10976     IF N = 0
 10977         MOVE 1 TO N
 10978     END-IF.
 10979
 10980 4700-EXIT.
 10981      EXIT.
 10982
 10983 4999-CALC-TERM-EXIT.
 10984     EXIT.
 10985
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 211
* EL130.cbl
 10987 5000-INCURRED-CHANGE.
 10988     IF NOT MODIFY-CAP
 10989         MOVE ER-0070            TO EMI-ERROR
 10990         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10991         MOVE -1                 TO MAINTL
 10992         GO TO 8200-SEND-DATAONLY
 10993     END-IF.
 10994
 10995     IF CLMNOI       NOT = PI-LAST-CLAIM       OR
 10996        CLMCARRI     NOT = PI-LAST-CARR        OR
 10997        CERTNOI      NOT = PI-LAST-CERT-PRIME  OR
 10998        SUFXI        NOT = PI-LAST-CERT-SUFX   OR
 10999        PI-INCURR-SW NOT = 'Y'
 11000          GO TO 1000-SHOW-CLAIM
 11001     END-IF.
 11002
 11003     PERFORM 6000-EDIT-CLAIM-DATA THRU 6000-EXIT.
 11004     PERFORM 6200-EDIT-CERT-DATA  THRU 6200-EXIT.
 11005     PERFORM 6400-TEST-CLAIM-REASONABILITY THRU 6499-EXIT.
 11006
 11007     IF EMI-NO-ERRORS
 11008         GO TO 5000-TRY-TO-BUILD
 11009     END-IF.
 11010
 11011     IF EIBAID = DFHPF6  AND NOT FORCE-CAP
 11012        MOVE ER-0433             TO EMI-ERROR
 11013        MOVE -1                  TO MAINTL
 11014        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11015        GO TO 8200-SEND-DATAONLY
 11016     END-IF.
 11017
 11018     IF EIBAID = DFHPF6
 11019         IF EMI-FATAL-CTR NOT EQUAL ZERO
 11020            MOVE ER-0434         TO EMI-ERROR
 11021            MOVE -1              TO MAINTL
 11022            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11023            GO TO 8200-SEND-DATAONLY
 11024         ELSE
 11025            MOVE +1              TO INCURL
 11026            GO TO 5000-TRY-TO-BUILD
 11027         END-IF
 11028     END-IF.
 11029
 11030     GO TO 8200-SEND-DATAONLY.
 11031
 11032 5000-TRY-TO-BUILD.
 11033
 11034     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 11035
 11036     MOVE CLMCARRI               TO MSTR-CARRIER.
 11037
 11038     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
 11039     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
 11040     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
 11041
 11042     PERFORM 7920-READ-CLAIM-UPDATE THRU 7920-EXIT.
 11043
 11044     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 212
* EL130.cbl
 11045         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS
 11046     END-IF.
 11047
 11048     IF CL-PURGED-DT NOT = LOW-VALUES
 11049
 11050
 11051* EXEC CICS UNLOCK
 11052*            DATASET   (ELMSTR-DSID)
 11053*        END-EXEC
 11054*    MOVE '&*                    #   #00010263' TO DFHEIV0
 11055     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11056     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11057     MOVE X'2020233030303130323633' TO DFHEIV0(25:11)
 11058     CALL 'kxdfhei1' USING DFHEIV0,
 11059           ELMSTR-DSID,
 11060           DFHEIV99
 11061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11062         MOVE ER-7691            TO EMI-ERROR
 11063         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11064         MOVE -1                 TO MAINTL
 11065         GO TO 8200-SEND-DATAONLY
 11066     END-IF.
 11067
 11068     IF CL-AUTO-PAY-SEQ NOT = ZERO
 11069
 11070
 11071* EXEC CICS UNLOCK
 11072*            DATASET   (ELMSTR-DSID)
 11073*       END-EXEC
 11074*    MOVE '&*                    #   #00010274' TO DFHEIV0
 11075     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11076     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11077     MOVE X'2020233030303130323734' TO DFHEIV0(25:11)
 11078     CALL 'kxdfhei1' USING DFHEIV0,
 11079           ELMSTR-DSID,
 11080           DFHEIV99
 11081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11082         MOVE ER-0523             TO EMI-ERROR
 11083         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11084         MOVE -1                  TO MAINTL
 11085         GO TO 8200-SEND-DATAONLY
 11086     END-IF.
 11087
 11088     PERFORM 7900-READ-ACTV-UPDATE THRU 7900-EXIT.
 11089
 11090     MOVE AT-ITD-PAID-EXPENSES       TO WS-ITD-PAID-EXPENSE.
 11091     MOVE AT-ITD-CHARGEABLE-EXPENSE  TO WS-ITD-CHARGABLE-EXPENSE.
 11092     MOVE AT-INITIAL-MANUAL-RESERVE  TO WS-INITIAL-MANUAL-RESERVE.
 11093     MOVE AT-CURRENT-MANUAL-RESERVE  TO WS-CURRENT-MANUAL-RESERVE.
 11094     MOVE AT-ITD-ADDITIONAL-RESERVE  TO WS-ITD-ADDITIONAL-RESERVE.
 11095
 11096     IF MANRSVL GREATER ZERO
 11097        MOVE WS-MANRSV           TO AT-INITIAL-MANUAL-RESERVE
 11098                                    AT-CURRENT-MANUAL-RESERVE
 11099     END-IF.
 11100     MOVE 1                      TO SUB.
 11101
 11102 5010-LOOP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 213
* EL130.cbl
 11103     IF SUB = 1
 11104        MOVE WS-TODAY-DT         TO AT-OPEN-CLOSE-DATE   (SUB)
 11105        MOVE 'O'                 TO AT-OPEN-CLOSE-TYPE   (SUB)
 11106        MOVE 'NEW'               TO AT-OPEN-CLOSE-REASON (SUB)
 11107     ELSE
 11108        MOVE LOW-VALUES          TO AT-OPEN-CLOSE-DATE   (SUB)
 11109        MOVE SPACES              TO AT-OPEN-CLOSE-TYPE   (SUB)
 11110                                    AT-OPEN-CLOSE-REASON (SUB)
 11111     END-IF.
 11112
 11113     IF SUB NOT = 6
 11114        ADD 1                    TO SUB
 11115        GO TO 5010-LOOP
 11116     END-IF.
 11117
 11118 5020-UPDATE.
 11119
 11120     PERFORM 7915-REWRITE-TRAILER THRU 7915-EXIT.
 11121
 11122     IF DIAGL = ZERO
 11123         PERFORM 7910-READ-NINETY THRU 7910-EXIT
 11124         MOVE AT-INFO-LINE-1     TO WS-DIAGNOSIS-DESCRIPT
 11125         GO TO 5025-BYPASS-UPDATE
 11126     END-IF.
 11127
 11128     PERFORM 7900-READ-NINETY-UPDATE THRU 7900-EXIT.
 11129
 11130     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
 11131     MOVE DIAGI                  TO AT-INFO-LINE-1.
 11132
 11133     PERFORM 7915-REWRITE-TRAILER THRU 7915-EXIT.
 11134
 11135 5025-BYPASS-UPDATE.
 11136
 11137
 11138
 11139* EXEC CICS GETMAIN
 11140*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11141*        LENGTH   (ELTRLR-LENGTH)
 11142*    END-EXEC.
 11143*    MOVE '," L                  $   #00010333' TO DFHEIV0
 11144     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 11145     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11146     MOVE X'2020233030303130333333' TO DFHEIV0(25:11)
 11147     CALL 'kxdfhei1' USING DFHEIV0,
 11148           DFHEIV20,
 11149           ELTRLR-LENGTH,
 11150           DFHEIV99
 11151     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11152         DFHEIV20
 11153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11154
 11155
 11156     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 11157     MOVE 'AT'                   TO AT-RECORD-ID.
 11158
 11159     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 11160     MOVE MSTR-CARRIER           TO AT-CARRIER.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 214
* EL130.cbl
 11161     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 11162     MOVE MSTR-CERT-NO           TO AT-CERT-NO.
 11163     MOVE CL-TRAILER-SEQ-CNT     TO AT-TRAILER-CNT-AT-CHG.
 11164     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 11165     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 11166     MOVE '9'                    TO AT-TRAILER-TYPE.
 11167     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11168     MOVE '5'                    TO DC-OPTION-CODE.
 11169     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11170     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT.
 11171
 11172     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY.
 11173     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 11174
 11175     MOVE CL-INCURRED-DT         TO AT-OLD-INCURRED-DT.
 11176     MOVE CL-REPORTED-DT         TO AT-OLD-REPORTED-DT.
 11177     MOVE CL-FILE-ESTABLISH-DT   TO AT-OLD-ESTABLISHED-DT.
 11178     MOVE CL-TOTAL-PAID-AMT      TO AT-OLD-TOTAL-PAID.
 11179     MOVE CL-NO-OF-DAYS-PAID     TO AT-OLD-DAYS-PAID.
 11180     MOVE CL-NO-OF-PMTS-MADE     TO AT-OLD-NO-OF-PMTS.
 11181     MOVE CL-PAID-THRU-DT        TO AT-OLD-PAID-THRU-DT.
 11182     MOVE CL-LAST-PMT-DT         TO AT-LAST-PMT-MADE-DT.
 11183     MOVE WS-DIAGNOSIS-DESCRIPT  TO AT-OLD-DIAG-DESCRIP.
 11184     MOVE CL-CAUSE-CD            TO AT-OLD-DIAG-CODE.
 11185
 11186     MOVE WS-ITD-PAID-EXPENSE    TO AT-OLD-ITD-PAID-EXPENSE.
 11187     MOVE WS-ITD-CHARGABLE-EXPENSE   TO AT-OLD-CHARGABLE-EXPENSE.
 11188     MOVE WS-INITIAL-MANUAL-RESERVE  TO AT-OLD-INIT-MAN-RESV.
 11189     MOVE WS-CURRENT-MANUAL-RESERVE  TO AT-OLD-CURRENT-MAN-RESV.
 11190     MOVE WS-ITD-ADDITIONAL-RESERVE  TO AT-OLD-ADDL-MAN-RESV.
 11191
 11192
 11193
 11194* EXEC CICS WRITE
 11195*        DATASET   (ELTRLR-DSID)
 11196*        FROM      (ACTIVITY-TRAILERS)
 11197*        RIDFLD    (AT-CONTROL-PRIMARY)
 11198*    END-EXEC.
 11199     MOVE LENGTH OF
 11200      ACTIVITY-TRAILERS
 11201       TO DFHEIV11
 11202*    MOVE '&$ L                  ''   #00010375' TO DFHEIV0
 11203     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11204     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11205     MOVE X'2020233030303130333735' TO DFHEIV0(25:11)
 11206     CALL 'kxdfhei1' USING DFHEIV0,
 11207           ELTRLR-DSID,
 11208           ACTIVITY-TRAILERS,
 11209           DFHEIV11,
 11210           AT-CONTROL-PRIMARY,
 11211           DFHEIV99,
 11212           DFHEIV99
 11213     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11214
 11215
 11216     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 11217     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 11218     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 215
* EL130.cbl
 11219     MOVE CL-CERT-STATE          TO CERT-STATE.
 11220     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 11221     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 11222     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 11223
 11224
 11225
 11226* EXEC CICS HANDLE CONDITION
 11227*        NOTFND   (5050-CERT-NOT-FOUND)
 11228*    END-EXEC.
 11229*    MOVE '"$I                   ! ; #00010390' TO DFHEIV0
 11230     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11231     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11232     MOVE X'3B20233030303130333930' TO DFHEIV0(25:11)
 11233     CALL 'kxdfhei1' USING DFHEIV0
 11234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11235
 11236
 11237     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
 11238
 11239     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
 11240
 11241
 11242
 11243* EXEC CICS HANDLE CONDITION
 11244*         DUPKEY   (5030-CERT-WRITTEN)
 11245*    END-EXEC.
 11246*    MOVE '"$$                   ! < #00010399' TO DFHEIV0
 11247     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11248     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11249     MOVE X'3C20233030303130333939' TO DFHEIV0(25:11)
 11250     CALL 'kxdfhei1' USING DFHEIV0
 11251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11252
 11253
 11254
 11255
 11256* EXEC CICS REWRITE
 11257*        DATASET  (ELCERT-DSID)
 11258*        FROM     (CERTIFICATE-MASTER)
 11259*    END-EXEC.
 11260     MOVE LENGTH OF
 11261      CERTIFICATE-MASTER
 11262       TO DFHEIV11
 11263*    MOVE '&& L                  %   #00010404' TO DFHEIV0
 11264     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11265     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11266     MOVE X'2020233030303130343034' TO DFHEIV0(25:11)
 11267     CALL 'kxdfhei1' USING DFHEIV0,
 11268           ELCERT-DSID,
 11269           CERTIFICATE-MASTER,
 11270           DFHEIV11,
 11271           DFHEIV99
 11272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11273
 11274
 11275 5030-CERT-WRITTEN.
 11276
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 216
* EL130.cbl
 11277     MOVE LOW-VALUES             TO CL-LAST-PMT-DT
 11278                                    CL-INCURRED-DT
 11279                                    CL-REPORTED-DT
 11280                                    CL-EST-END-OF-DISAB-DT
 11281                                    CL-PAID-THRU-DT.
 11282
 11283     MOVE ZEROS                  TO CL-TOTAL-PAID-AMT
 11284                                    CL-NO-OF-PMTS-MADE
 11285                                    CL-NO-OF-DAYS-PAID.
 11286
 11287     IF CLAIM-IS-CLOSED
 11288        MOVE WS-TODAY-DT         TO CL-LAST-REOPEN-DT
 11289        MOVE 'O'                 TO CL-CLAIM-STATUS
 11290     END-IF.
 11291
 11292     PERFORM 3995-BUILD-CLAIM-RECORD THRU 3995-EXIT.
 11293     MOVE '5'                    TO CL-LAST-MAINT-TYPE.
 11294     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 11295
 11296
 11297
 11298* EXEC CICS HANDLE CONDITION
 11299*         DUPKEY   (5035-CLAIM-WRITTEN)
 11300*    END-EXEC.
 11301*    MOVE '"$$                   ! = #00010431' TO DFHEIV0
 11302     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11303     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11304     MOVE X'3D20233030303130343331' TO DFHEIV0(25:11)
 11305     CALL 'kxdfhei1' USING DFHEIV0
 11306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11307
 11308
 11309
 11310
 11311* EXEC CICS REWRITE
 11312*        DATASET   (ELMSTR-DSID)
 11313*        FROM      (CLAIM-MASTER)
 11314*    END-EXEC.
 11315     MOVE LENGTH OF
 11316      CLAIM-MASTER
 11317       TO DFHEIV11
 11318*    MOVE '&& L                  %   #00010436' TO DFHEIV0
 11319     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11320     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11321     MOVE X'2020233030303130343336' TO DFHEIV0(25:11)
 11322     CALL 'kxdfhei1' USING DFHEIV0,
 11323           ELMSTR-DSID,
 11324           CLAIM-MASTER,
 11325           DFHEIV11,
 11326           DFHEIV99
 11327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11328
 11329
 11330 5035-CLAIM-WRITTEN.
 11331
 11332     MOVE ER-0000                TO EMI-ERROR.
 11333     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11334
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 217
* EL130.cbl
 11335     MOVE CLMNOI                 TO PI-LAST-CLAIM.
 11336     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
 11337     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
 11338     MOVE CLMCARRI               TO PI-LAST-CARR.
 11339
 11340     IF PRTOPTL GREATER ZERO
 11341         MOVE PRTOPTI            TO PI-PRT-OPT
 11342     END-IF.
 11343
 11344     IF ALTPRTL GREATER ZERO
 11345         MOVE ALTPRTI            TO PI-ALT-PRT
 11346     END-IF.
 11347
 11348     MOVE LOW-VALUES             TO EL130AI.
 11349
 11350     MOVE PI-LAST-CERT-PRIME     TO CERTNOO.
 11351     MOVE PI-LAST-CERT-SUFX      TO SUFXO.
 11352     MOVE PI-LAST-CARR           TO CLMCARRO.
 11353     MOVE PI-LAST-CLAIM          TO CLMNOO.
 11354
 11355     IF PI-PRT-OPT = 'N' OR 'L'
 11356         MOVE PI-PRT-OPT         TO PRTOPTO
 11357         MOVE 1                  TO PRTOPTL
 11358     END-IF.
 11359
 11360     IF PI-ALT-PRT NOT = SPACES AND LOW-VALUES
 11361         MOVE PI-ALT-PRT         TO ALTPRTO
 11362         MOVE 4                  TO ALTPRTL
 11363     END-IF.
 11364
 11365     MOVE AL-UANON               TO CLMNOA CLMCARRA.
 11366     MOVE AL-SANON               TO CERTNOA SUFXA.
 11367
 11368     MOVE SPACES                 TO PI-INCURR-SW.
 11369
 11370     IF PRTOPTL GREATER ZERO
 11371         IF PRTOPTI = 'L'
 11372             GO TO 0400-CREATE-ELACTQ
 11373         ELSE
 11374             GO TO 0480-PRINT-NOW
 11375         END-IF
 11376     END-IF.
 11377
 11378     GO TO 8100-SEND-INITIAL-MAP.
 11379
 11380 5050-CERT-NOT-FOUND.
 11381
 11382     MOVE ER-0244                TO EMI-ERROR.
 11383     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11384     MOVE -1                     TO CERTNOL.
 11385     GO TO 8200-SEND-DATAONLY.
 11386
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 218
* EL130.cbl
 11388 5500-BUILD-FORM-TRAILER.
 11389*************************************************************
 11390*           THIS CODE IS FOR 'CRI' ONLY         04/18/88
 11391*************************************************************
 11392
 11393     MOVE WS-TODAY-DT            TO SAVE-SEND-DT.
 11394
 11395     IF  WS-BEN-ALPHA-2 = '30'
 11396         MOVE WS-TODAY-DT        TO DC-BIN-DATE-1
 11397         MOVE '6'                TO DC-OPTION-CODE
 11398         IF CL-CARRIER = 'C'
 11399             MOVE +14            TO DC-ELAPSED-DAYS
 11400             MOVE +0             TO DC-ELAPSED-MONTHS
 11401             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11402             MOVE DC-BIN-DATE-2  TO SAVE-SEND-DT
 11403         ELSE
 11404             MOVE +21            TO DC-ELAPSED-DAYS
 11405             MOVE +0             TO DC-ELAPSED-MONTHS
 11406             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11407             MOVE DC-BIN-DATE-2      TO  SAVE-SEND-DT
 11408         END-IF
 11409     END-IF.
 11410
 11411
 11412
 11413* EXEC CICS GETMAIN
 11414*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11415*         LENGTH   (ELTRLR-LENGTH)
 11416*         INITIMG  (GETMAIN-SPACE)
 11417*    END-EXEC.
 11418*    MOVE ',"IL                  $   #00010523' TO DFHEIV0
 11419     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11420     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11421     MOVE X'2020233030303130353233' TO DFHEIV0(25:11)
 11422     CALL 'kxdfhei1' USING DFHEIV0,
 11423           DFHEIV20,
 11424           ELTRLR-LENGTH,
 11425           GETMAIN-SPACE
 11426     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11427         DFHEIV20
 11428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11429
 11430
 11431     MOVE SAVE-AT-PRIMARY-KEY    TO AT-CONTROL-PRIMARY.
 11432     MOVE 'AT'                   TO AT-RECORD-ID.
 11433
 11434     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 11435     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 11436     MOVE 'A'                    TO AT-TRAILER-TYPE.
 11437     MOVE WS-TODAY-DT            TO AT-RECORDED-DT
 11438                                    AT-FORM-LAST-MAINT-DT.
 11439     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11440                                    AT-FORM-LAST-UPDATED-BY.
 11441     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 11442     MOVE SAVE-SEND-DT           TO AT-FORM-SEND-ON-DT.
 11443     MOVE LOW-VALUES             TO AT-FORM-FOLLOW-UP-DT
 11444                                    AT-FORM-RE-SEND-DT
 11445                                    AT-FORM-ANSWERED-DT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 219
* EL130.cbl
 11446                                    AT-EMP-FORM-ANSWERED-DT
 11447                                    AT-PHY-FORM-ANSWERED-DT
 11448                                    AT-EMP-FORM-SEND-ON-DT
 11449                                    AT-FORM-PRINTED-DT
 11450                                    AT-FORM-REPRINT-DT.
 11451     MOVE '1'                    TO AT-FORM-TYPE.
 11452
 11453     MOVE SPACES                 TO AT-INSTRUCT-LN-1
 11454                                    AT-INSTRUCT-LN-2
 11455                                    AT-INSTRUCT-LN-3.
 11456
 11457     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 11458     MOVE 'I'                    TO AT-FORM-ADDRESS.
 11459
 11460     MOVE SAVE-SEND-DT           TO AT-PHY-FORM-SEND-ON-DT.
 11461
 11462     IF AM-EMPLOYER-STMT-USED = 'Y'
 11463        MOVE SAVE-SEND-DT       TO AT-EMP-FORM-SEND-ON-DT
 11464     END-IF.
 11465
 11466
 11467
 11468* EXEC CICS WRITE
 11469*         DATASET  (ELTRLR-DSID)
 11470*         FROM     (ACTIVITY-TRAILERS)
 11471*         RIDFLD   (AT-CONTROL-PRIMARY)
 11472*    END-EXEC.
 11473     MOVE LENGTH OF
 11474      ACTIVITY-TRAILERS
 11475       TO DFHEIV11
 11476*    MOVE '&$ L                  ''   #00010565' TO DFHEIV0
 11477     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11478     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11479     MOVE X'2020233030303130353635' TO DFHEIV0(25:11)
 11480     CALL 'kxdfhei1' USING DFHEIV0,
 11481           ELTRLR-DSID,
 11482           ACTIVITY-TRAILERS,
 11483           DFHEIV11,
 11484           AT-CONTROL-PRIMARY,
 11485           DFHEIV99,
 11486           DFHEIV99
 11487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11488
 11489
 11490 5599-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 220
* EL130.cbl
 11492*************************************************************
 11493*           THIS CODE IS FOR 'CRI' ONLY         04/18/88
 11494*************************************************************
 11495
 11496 5700-BUILD-ARCHIVE-HEADER.
 11497
 11498     MOVE '1'                    TO CNTL-REC-TYPE.
 11499     MOVE ZEROS                  TO CNTL-SEQ-NO.
 11500     MOVE SPACES                 TO CNTL-ACCESS.
 11501
 11502
 11503
 11504* EXEC CICS READ
 11505*         DATASET  (ELCNTL-DSID)
 11506*         SET      (ADDRESS OF CONTROL-FILE)
 11507*         RIDFLD   (ELCNTL-KEY)
 11508*         UPDATE
 11509*    END-EXEC.
 11510*    MOVE '&"S        EU         (   #00010584' TO DFHEIV0
 11511     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11512     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11513     MOVE X'2020233030303130353834' TO DFHEIV0(25:11)
 11514     CALL 'kxdfhei1' USING DFHEIV0,
 11515           ELCNTL-DSID,
 11516           DFHEIV20,
 11517           DFHEIV99,
 11518           ELCNTL-KEY,
 11519           DFHEIV99,
 11520           DFHEIV99,
 11521           DFHEIV99
 11522     SET ADDRESS OF CONTROL-FILE TO
 11523         DFHEIV20
 11524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11525
 11526
 11527     ADD 1 TO CF-CO-ARCHIVE-COUNTER.
 11528
 11529     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 11530
 11531
 11532
 11533* EXEC CICS REWRITE
 11534*         FROM     (CONTROL-FILE)
 11535*         DATASET  (ELCNTL-DSID)
 11536*    END-EXEC.
 11537     MOVE LENGTH OF
 11538      CONTROL-FILE
 11539       TO DFHEIV11
 11540*    MOVE '&& L                  %   #00010596' TO DFHEIV0
 11541     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11542     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11543     MOVE X'2020233030303130353936' TO DFHEIV0(25:11)
 11544     CALL 'kxdfhei1' USING DFHEIV0,
 11545           ELCNTL-DSID,
 11546           CONTROL-FILE,
 11547           DFHEIV11,
 11548           DFHEIV99
 11549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 221
* EL130.cbl
 11550
 11551
 11552
 11553
 11554* EXEC CICS HANDLE CONDITION
 11555*         NOTOPEN  (9990-ABEND)
 11556*         DUPKEY   (5799-EXIT)
 11557*    END-EXEC.
 11558*    MOVE '"$J$                  ! > #00010602' TO DFHEIV0
 11559     MOVE X'22244A242020202020202020' TO DFHEIV0(1:12)
 11560     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11561     MOVE X'3E20233030303130363032' TO DFHEIV0(25:11)
 11562     CALL 'kxdfhei1' USING DFHEIV0
 11563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11564
 11565
 11566
 11567
 11568* EXEC CICS GETMAIN
 11569*         SET     (ADDRESS OF LETTER-ARCHIVE)
 11570*         LENGTH  (ELARCH-LENGTH)
 11571*    END-EXEC.
 11572*    MOVE '," L                  $   #00010608' TO DFHEIV0
 11573     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 11574     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11575     MOVE X'2020233030303130363038' TO DFHEIV0(25:11)
 11576     CALL 'kxdfhei1' USING DFHEIV0,
 11577           DFHEIV20,
 11578           ELARCH-LENGTH,
 11579           DFHEIV99
 11580     SET ADDRESS OF LETTER-ARCHIVE TO
 11581         DFHEIV20
 11582     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11583
 11584
 11585     MOVE SPACES                 TO LETTER-ARCHIVE.
 11586     MOVE 'LA'                   TO LA-RECORD-ID.
 11587     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 11588                                    LA-ARCHIVE-NO-A1.
 11589     MOVE '4'                    TO LA-RECORD-TYPE
 11590                                    LA-RECORD-TYPE-A1.
 11591     MOVE ZEROS                  TO LA-LINE-SEQ-NO
 11592                                    LA-LINE-SEQ-NO-A1.
 11593     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 11594                                    LA-COMPANY-CD-A1.
 11595     MOVE CL-CARRIER             TO LA4-CARRIER.
 11596     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 11597     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 11598     MOVE CL-CERT-STATE          TO LA4-STATE.
 11599     MOVE  ZEROS                 TO LA4-NO-OF-COPIES.
 11600     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 11601     MOVE WS-TODAY-DT            TO LA4-CREATION-DT.
 11602     MOVE LOW-VALUES             TO LA4-INITIAL-PRINT-DATE
 11603                                    LA4-RESEND-PRINT-DATE
 11604                                    LA4-FORM-REM-PRINT-DT
 11605                                    LA4-RESEND-DATE.
 11606     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 11607     MOVE '1'                    TO LA4-FORM-TYPE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 222
* EL130.cbl
 11608
 11609
 11610
 11611* EXEC CICS WRITE
 11612*         DATASET  (ELARCH-DSID)
 11613*         FROM     (LETTER-ARCHIVE)
 11614*         RIDFLD   (LA-CONTROL-PRIMARY)
 11615*    END-EXEC.
 11616     MOVE LENGTH OF
 11617      LETTER-ARCHIVE
 11618       TO DFHEIV11
 11619*    MOVE '&$ L                  ''   #00010638' TO DFHEIV0
 11620     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11621     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11622     MOVE X'2020233030303130363338' TO DFHEIV0(25:11)
 11623     CALL 'kxdfhei1' USING DFHEIV0,
 11624           ELARCH-DSID,
 11625           LETTER-ARCHIVE,
 11626           DFHEIV11,
 11627           LA-CONTROL-PRIMARY,
 11628           DFHEIV99,
 11629           DFHEIV99
 11630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11631
 11632
 11633 5799-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 223
* EL130.cbl
 11635 6000-EDIT-CLAIM-DATA.
 11636
 11637     MOVE SAVE-DATE              TO DC-GREG-DATE-1-EDIT.
 11638     MOVE '2'                    TO DC-OPTION-CODE.
 11639     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11640     MOVE DC-BIN-DATE-1          TO WS-TODAY-DT.
 11641
 11642     IF CLMNOL GREATER ZERO
 11643         IF CLMNOI = SPACES OR LOW-VALUES
 11644             MOVE -1             TO CLMNOL
 11645             MOVE AL-UABON       TO CLMNOA
 11646             MOVE ER-7688        TO EMI-ERROR
 11647             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11648         ELSE
 11649             MOVE AL-UANON       TO CLMNOA
 11650         END-IF
 11651     END-IF.
 11652
 11653     IF CERTNOL = ZERO
 11654         MOVE -1                 TO CERTNOL
 11655         MOVE AL-SABON           TO CERTNOA
 11656         MOVE ER-0203            TO EMI-ERROR
 11657         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11658     ELSE
 11659         MOVE AL-SANON           TO CERTNOA
 11660     END-IF.
 11661
 11662     IF SUFXL = ZERO
 11663         MOVE SPACES             TO SUFXI
 11664         MOVE AL-SANON           TO SUFXA
 11665     ELSE
 11666         MOVE AL-SANON           TO SUFXA
 11667     END-IF.
 11668
 11669     IF CLMCARRL = ZERO
 11670         MOVE -1                 TO CLMCARRL
 11671         MOVE ER-0194            TO EMI-ERROR
 11672         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11673     ELSE
 11674         MOVE CLMCARRI           TO PI-CARRIER
 11675         IF PI-NO-CARRIER-SECURITY
 11676             MOVE AL-UANON       TO CLMCARRA
 11677         END-IF
 11678     END-IF.
 11679
 11680     IF CLMTYPEL > ZERO
 11681        IF ((PI-COMPANY-ID = 'DCC')
 11682           AND (CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 11683              AND PI-AH-OVERRIDE-L1 AND 'I' AND 'G'))
 11684                        OR
 11685           ((PI-COMPANY-ID = 'CID' OR 'AHL')
 11686           AND (CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 11687              AND PI-AH-OVERRIDE-L1))
 11688              MOVE -1             TO CLMTYPEL
 11689              MOVE AL-UABON       TO CLMTYPEA
 11690              MOVE ER-7634        TO EMI-ERROR
 11691              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11692        ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 224
* EL130.cbl
 11693           MOVE AL-UANON       TO CLMTYPEA
 11694        END-IF
 11695     ELSE
 11696        IF MAINTI = 'A'
 11697           MOVE -1             TO CLMTYPEL
 11698           MOVE AL-UABON       TO CLMTYPEA
 11699           MOVE ER-0546        TO EMI-ERROR
 11700           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11701        END-IF
 11702     END-IF
 11703
 11704     IF PCERTNOL = ZERO
 11705        MOVE CERTNOI             TO PCERTNOI
 11706        MOVE CERTNOL             TO PCERTNOL
 11707        MOVE AL-UANON            TO PCERTNOA
 11708     ELSE
 11709        MOVE AL-UANON            TO PCERTNOA
 11710     END-IF.
 11711
 11712     IF PSUFXL = ZERO
 11713        MOVE SUFXI               TO PSUFXI
 11714        MOVE SUFXL               TO PSUFXL
 11715        MOVE AL-UANON            TO PSUFXA
 11716     ELSE
 11717        MOVE AL-UANON            TO PSUFXA
 11718     END-IF.
 11719
 11720     IF MAINTI = 'I'
 11721         GO TO 6020-EDIT
 11722     END-IF.
 11723
 11724     IF LSTNMEL = ZERO AND CERTMTL NOT = ZEROS
 11725         MOVE -1                 TO LSTNMEL
 11726         MOVE ER-0236            TO EMI-ERROR
 11727         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11728     ELSE
 11729         MOVE AL-UANON           TO LSTNMEA
 11730     END-IF.
 11731
 11732     IF SEXI NOT = 'M' AND 'F'
 11733         MOVE -1                 TO SEXL
 11734         MOVE AL-UABON           TO SEXA
 11735         MOVE ER-0219            TO EMI-ERROR
 11736         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11737     ELSE
 11738         MOVE AL-UANON           TO SEXA
 11739     END-IF.
 11740
 11741     IF SSNL GREATER THAN ZERO
 11742         MOVE SSNI TO WS-SOC-SEC-NUMBER
 11743         IF WS-SOC-SEC-NO NUMERIC AND
 11744           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
 11745             NEXT SENTENCE
 11746         ELSE
 11747            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
 11748               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
 11749               WS-SSN-DASH2 = '-'
 11750                 NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 225
* EL130.cbl
 11751            ELSE
 11752                 MOVE ER-0887        TO  EMI-ERROR
 11753                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11754                 MOVE AL-UABON       TO  SSNA
 11755                 MOVE -1             TO  SSNL
 11756            END-IF
 11757        END-IF
 11758     END-IF.
 11759
 11760     IF BIRTHDTL = ZERO
 11761         GO TO 6020-EDIT
 11762     END-IF.
 11763
 11764     IF BIRTHDTL GREATER ZERO
 11765         MOVE BIRTHDTI           TO DATE-WORK
 11766         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 11767         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 11768         MOVE '4'                TO DC-OPTION-CODE
 11769         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11770         IF DATE-CONVERSION-ERROR
 11771             MOVE AL-UABON       TO BIRTHDTA
 11772             MOVE -1             TO BIRTHDTL
 11773             MOVE ER-0220        TO EMI-ERROR
 11774             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11775             GO TO 6020-EDIT
 11776         END-IF
 11777     END-IF.
 11778
 11779******************************************************************
 11780**   IF CALCULATED BIRTH DATE GREATER THAN TODAYS DATE          **
 11781**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
 11782**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
 11783******************************************************************
 11784
 11785     IF DC-BIN-DATE-1 GREATER THAN SAVE-BIN-DATE
 11786         MOVE BIRTHDTI           TO  DATE-WORK
 11787         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 11788         MOVE NUM-WORK           TO  DC-GREG-DATE-1-MDY
 11789         MOVE '4'                TO  DC-OPTION-CODE
 11790         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
 11791         MOVE +0                 TO  DC-ELAPSED-MONTHS
 11792                                     DC-ELAPSED-DAYS
 11793         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11794         IF DATE-CONVERSION-ERROR
 11795             MOVE AL-UABON       TO  BIRTHDTA
 11796             MOVE -1             TO  BIRTHDTL
 11797             MOVE ER-0220        TO  EMI-ERROR
 11798             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11799             GO TO 6020-EDIT
 11800         END-IF
 11801     END-IF.
 11802
 11803     MOVE AL-UANON               TO  BIRTHDTA.
 11804     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHDTI.
 11805     MOVE DC-BIN-DATE-1          TO  WS-BIRTHDT.
 11806     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
 11807
 11808 6020-EDIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 226
* EL130.cbl
 11809     IF INCURL GREATER ZERO
 11810         MOVE INCURI             TO DATE-WORK
 11811         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 11812         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 11813         MOVE '4'                TO DC-OPTION-CODE
 11814         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11815         IF DATE-CONVERSION-ERROR
 11816             MOVE AL-UABON       TO INCURA
 11817             MOVE -1             TO INCURL
 11818             MOVE ER-0222        TO EMI-ERROR
 11819             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11820         ELSE
 11821             MOVE AL-UANON       TO INCURA
 11822             MOVE DC-GREG-DATE-1-EDIT  TO INCURI
 11823             MOVE DC-BIN-DATE-1  TO WS-INCUR
 11824                                    PI-SAVE-INCUR-DT
 11825             IF WS-INCUR GREATER THAN WS-TODAY-DT
 11826                 MOVE ER-0511     TO EMI-ERROR
 11827                 MOVE -1          TO INCURL
 11828                 MOVE AL-UABON    TO INCURA
 11829                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11830             ELSE
 11831*                NEXT SENTENCE
 11832                 CONTINUE
 11833             END-IF
 11834         END-IF
 11835     ELSE
 11836         MOVE ER-0516         TO EMI-ERROR
 11837         MOVE AL-UABON        TO INCURA
 11838         MOVE -1              TO INCURL
 11839         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11840     END-IF.
 11841
 11842     IF REPORTL GREATER ZERO
 11843         MOVE REPORTI            TO DATE-WORK
 11844         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 11845         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 11846         MOVE '4'                TO DC-OPTION-CODE
 11847         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11848         IF DATE-CONVERSION-ERROR
 11849             MOVE AL-UABON       TO REPORTA
 11850             MOVE -1             TO REPORTL
 11851             MOVE ER-0223        TO EMI-ERROR
 11852             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11853         ELSE
 11854             MOVE AL-UANON       TO REPORTA
 11855             MOVE DC-GREG-DATE-1-EDIT  TO REPORTI
 11856             MOVE DC-BIN-DATE-1  TO WS-REPORT
 11857             IF WS-REPORT GREATER THAN WS-TODAY-DT
 11858                 MOVE ER-0512     TO EMI-ERROR
 11859                 MOVE -1          TO REPORTL
 11860                 MOVE AL-UABON    TO REPORTA
 11861                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11862             ELSE
 11863*                NEXT SENTENCE
 11864                 CONTINUE
 11865             END-IF
 11866         END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 227
* EL130.cbl
 11867     ELSE
 11868         MOVE ER-0517         TO EMI-ERROR
 11869         MOVE -1              TO REPORTL
 11870         MOVE AL-UABON        TO REPORTA
 11871         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11872     END-IF.
 11873
 11874     IF WS-REPORT NOT = LOW-VALUES
 11875         IF WS-INCUR GREATER THAN WS-REPORT
 11876             MOVE AL-UABON       TO REPORTA
 11877             MOVE -1             TO REPORTL
 11878             MOVE ER-0509        TO EMI-ERROR
 11879             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11880         END-IF
 11881     END-IF.
 11882
 11883     IF ESTENDL GREATER ZERO
 11884         MOVE ESTENDI            TO DATE-WORK
 11885         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 11886         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 11887         MOVE '4'                TO DC-OPTION-CODE
 11888         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11889         IF DATE-CONVERSION-ERROR
 11890             MOVE AL-UABON       TO ESTENDA
 11891             MOVE -1             TO ESTENDL
 11892             MOVE ER-0224        TO EMI-ERROR
 11893             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11894         ELSE
 11895             MOVE AL-UANON       TO ESTENDA
 11896             MOVE DC-GREG-DATE-1-EDIT  TO ESTENDI
 11897             MOVE DC-BIN-DATE-1  TO WS-ESTEND
 11898             IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 11899                MOVE AL-UABON    TO ESTENDA
 11900                MOVE -1          TO ESTENDL
 11901                MOVE ER-0544     TO EMI-ERROR
 11902                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11903             END-IF
 11904         END-IF
 11905     END-IF.
 11906
 11907     IF WS-ESTEND NOT = LOW-VALUES
 11908         IF WS-INCUR GREATER THAN WS-ESTEND
 11909             MOVE AL-UABON       TO ESTENDA
 11910             MOVE -1             TO ESTENDL
 11911             MOVE ER-0510        TO EMI-ERROR
 11912             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11913         END-IF
 11914     END-IF.
 11915
 11916     IF PRTOPTL GREATER ZERO
 11917         IF PRTOPTI NOT = 'N' AND 'L'
 11918             MOVE AL-UABON       TO PRTOPTA
 11919             MOVE -1             TO PRTOPTL
 11920             MOVE ER-0334        TO EMI-ERROR
 11921             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11922         END-IF
 11923     END-IF.
 11924
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 228
* EL130.cbl
 11925     IF MANRSVL GREATER ZERO
 11926
 11927* EXEC CICS BIF DEEDIT
 11928*            FIELD   (MANRSVI)
 11929*            LENGTH  (9)
 11930*        END-EXEC
 11931     MOVE 9
 11932       TO DFHEIV11
 11933*    MOVE '@"L                   #   #00010937' TO DFHEIV0
 11934     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 11935     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11936     MOVE X'2020233030303130393337' TO DFHEIV0(25:11)
 11937     CALL 'kxdfhei1' USING DFHEIV0,
 11938           MANRSVI,
 11939           DFHEIV11
 11940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11941         IF MANRSVI NOT NUMERIC
 11942             MOVE AL-UNBON       TO MANRSVA
 11943             MOVE -1             TO MANRSVL
 11944             MOVE ER-0489        TO EMI-ERROR
 11945             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11946         ELSE
 11947             MOVE AL-UNNON       TO MANRSVA
 11948             MOVE MANRSVI        TO WS-MANRSV  MANRSVO
 11949         END-IF
 11950     END-IF.
 11951
 11952     MOVE SPACES                 TO ELCNTL-KEY.
 11953
 11954     IF CONTROL-IS-ACTUAL-CARRIER
 11955         MOVE PI-CARRIER         TO CNTL-CARRIER
 11956     ELSE
 11957         MOVE PI-CARRIER-CONTROL-LEVEL TO CNTL-CARRIER
 11958     END-IF.
 11959
 11960     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11961     MOVE '6'                    TO CNTL-REC-TYPE.
 11962     MOVE +0                     TO CNTL-SEQ-NO.
 11963
 11964
 11965
 11966* EXEC CICS HANDLE CONDITION
 11967*        NOTFND   (3100-CARRIER-NOT-FOUND)
 11968*    END-EXEC.
 11969*    MOVE '"$I                   ! ? #00010965' TO DFHEIV0
 11970     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11971     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11972     MOVE X'3F20233030303130393635' TO DFHEIV0(25:11)
 11973     CALL 'kxdfhei1' USING DFHEIV0
 11974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11975
 11976
 11977     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 11978
 11979     IF NOT CF-MANUAL-RESERVES-USED AND
 11980           WS-MANRSV GREATER ZERO
 11981         MOVE ER-0518             TO EMI-ERROR
 11982         MOVE -1                  TO MANRSVL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 229
* EL130.cbl
 11983         MOVE AL-UNBON            TO MANRSVA
 11984         MOVE ZEROS               TO WS-MANRSV
 11985         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11986     END-IF.
 11987
 11988     MOVE CF-RESERVE-CONTROLS    TO WS-RESERVE-CONTROLS.
 11989     MOVE CF-EXPENSE-CONTROLS    TO WS-EXPENSE-CONTROLS.
 11990
 11991     IF SUPVL GREATER ZERO
 11992         IF SUPVI NOT = ' ' AND 'Y' AND 'N'
 11993             MOVE -1             TO SUPVL
 11994             MOVE AL-UABON       TO SUPVA
 11995             MOVE ER-0230        TO EMI-ERROR
 11996             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11997         ELSE
 11998             MOVE AL-UANON       TO SUPVA
 11999         END-IF
 12000     END-IF.
 12001
 12002     IF PROCCDL = ZERO
 12003        GO TO 6050-CONTINUE-EDITS
 12004     END-IF.
 12005
 12006     MOVE SPACES                 TO ELCNTL-KEY.
 12007     MOVE PROCCDI                TO CNTL-ACCESS.
 12008
 12009     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12010     MOVE '2'                    TO CNTL-REC-TYPE.
 12011     MOVE +0                     TO CNTL-SEQ-NO.
 12012
 12013
 12014
 12015* EXEC CICS HANDLE CONDITION
 12016*        NOTFND   (6040-NO-PROCESSOR-RECORD)
 12017*    END-EXEC.
 12018*    MOVE '"$I                   ! @ #00011006' TO DFHEIV0
 12019     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12020     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12021     MOVE X'4020233030303131303036' TO DFHEIV0(25:11)
 12022     CALL 'kxdfhei1' USING DFHEIV0
 12023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12024
 12025
 12026     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 12027
 12028     GO TO 6050-CONTINUE-EDITS.
 12029
 12030 6040-NO-PROCESSOR-RECORD.
 12031     MOVE ER-0019                TO EMI-ERROR.
 12032     MOVE -1                     TO PROCCDL.
 12033     MOVE AL-UABON               TO PROCCDA.
 12034     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12035
 12036 6050-CONTINUE-EDITS.
 12037     IF (BENECDL = ZERO) OR (BENECDI = SPACES OR LOW-VALUES)
 12038           GO TO 6070-CONTINUE-EDITS
 12039     END-IF.
 12040
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 230
* EL130.cbl
 12041     MOVE BENECDI                TO BENE-CODE.
 12042     MOVE 'B'                    TO BENE-RCD-TYPE.
 12043     MOVE PI-COMPANY-CD          TO BENE-COMP-CD.
 12044
 12045
 12046
 12047* EXEC CICS HANDLE CONDITION
 12048*        NOTFND   (6060-NO-BENEFICIARY-RECORD)
 12049*    END-EXEC.
 12050*    MOVE '"$I                   ! A #00011030' TO DFHEIV0
 12051     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12052     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12053     MOVE X'4120233030303131303330' TO DFHEIV0(25:11)
 12054     CALL 'kxdfhei1' USING DFHEIV0
 12055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12056
 12057
 12058
 12059* EXEC CICS READ
 12060*         DATASET   (ELBENE-DSID)
 12061*         SET       (ADDRESS OF BENEFICIARY-MASTER)
 12062*         RIDFLD    (ELBENE-KEY)
 12063*    END-EXEC.
 12064*    MOVE '&"S        E          (   #00011034' TO DFHEIV0
 12065     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12066     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12067     MOVE X'2020233030303131303334' TO DFHEIV0(25:11)
 12068     CALL 'kxdfhei1' USING DFHEIV0,
 12069           ELBENE-DSID,
 12070           DFHEIV20,
 12071           DFHEIV99,
 12072           ELBENE-KEY,
 12073           DFHEIV99,
 12074           DFHEIV99,
 12075           DFHEIV99
 12076     SET ADDRESS OF BENEFICIARY-MASTER TO
 12077         DFHEIV20
 12078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12079
 12080
 12081     GO TO 6070-CONTINUE-EDITS.
 12082
 12083 6060-NO-BENEFICIARY-RECORD.
 12084     MOVE ER-0565                TO EMI-ERROR.
 12085     MOVE -1                     TO BENECDL.
 12086     MOVE AL-UABON               TO BENECDA.
 12087     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12088
 12089
 12090 6070-CONTINUE-EDITS.
 12091     IF CERTMTL GREATER ZERO
 12092         IF CERTMTI NOT = 'A' AND 'S'
 12093             MOVE -1             TO CERTMTL
 12094             MOVE AL-UABON       TO CERTMTA
 12095             MOVE ER-0267        TO EMI-ERROR
 12096             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12097         ELSE
 12098             MOVE AL-UANON       TO CERTMTA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 231
* EL130.cbl
 12099         END-IF
 12100     ELSE
 12101         GO TO 6000-EXIT
 12102     END-IF.
 12103
 12104     IF EFFDTL GREATER ZERO
 12105         MOVE EFFDTI             TO DATE-WORK
 12106         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12107         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 12108         MOVE '4'                TO DC-OPTION-CODE
 12109         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12110         IF DATE-CONVERSION-ERROR
 12111             MOVE AL-UABON       TO EFFDTA
 12112             MOVE -1             TO EFFDTL
 12113             MOVE ER-0231        TO EMI-ERROR
 12114             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12115         ELSE
 12116             MOVE AL-UANON       TO EFFDTA
 12117             MOVE DC-GREG-DATE-1-EDIT  TO EFFDTI
 12118             MOVE DC-BIN-DATE-1  TO WS-EFFDT
 12119         END-IF
 12120     ELSE
 12121         MOVE ER-0231            TO EMI-ERROR
 12122         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12123         MOVE -1                 TO EFFDTL
 12124         MOVE AL-UABON           TO EFFDTA
 12125     END-IF.
 12126
 12127     IF ACCOUNTL = ZERO
 12128         MOVE ER-0232            TO EMI-ERROR
 12129         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12130         MOVE AL-UABON           TO ACCOUNTA
 12131         MOVE -1                 TO ACCOUNTL
 12132     ELSE
 12133         MOVE AL-UANON           TO ACCOUNTA
 12134     END-IF.
 12135
 12136     IF (PI-CERT-ACCESS-CONTROL = ' ' OR '1' OR '2')  AND
 12137        (STATEL = ZERO)
 12138         MOVE ER-0233        TO EMI-ERROR
 12139         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12140         MOVE AL-UABON       TO STATEA
 12141         MOVE -1             TO STATEL
 12142     ELSE
 12143         MOVE AL-UANON       TO STATEA
 12144     END-IF.
 12145
 12146     IF (PI-CERT-ACCESS-CONTROL = '1' OR '2' OR '4') AND
 12147        (CRTCARRL = ZERO)
 12148         MOVE ER-0234        TO EMI-ERROR
 12149         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12150         MOVE AL-UABON       TO CRTCARRA
 12151         MOVE -1             TO CRTCARRL
 12152     ELSE
 12153         MOVE AL-UANON       TO CRTCARRA
 12154     END-IF.
 12155
 12156     IF PI-CERT-ACCESS-CONTROL = '1' AND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 232
* EL130.cbl
 12157        GROUPL = ZERO
 12158         MOVE ER-0235            TO EMI-ERROR
 12159         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12160         MOVE AL-UABON           TO GROUPA
 12161         MOVE -1                 TO GROUPL
 12162     ELSE
 12163         MOVE AL-UANON           TO GROUPA
 12164     END-IF.
 12165
 12166     IF CRTLNMEL = ZERO
 12167         IF LSTNMEI = SPACES OR LOW-VALUES
 12168             MOVE ER-0236            TO  EMI-ERROR
 12169             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12170             MOVE AL-UABON           TO  CRTLNMEA
 12171             MOVE -1                 TO  CRTLNMEL
 12172         ELSE
 12173             MOVE LSTNMEI            TO  CRTLNMEI
 12174             MOVE AL-UANON           TO  CRTLNMEA
 12175         END-IF
 12176     ELSE
 12177         MOVE AL-UANON               TO  CRTLNMEA
 12178     END-IF.
 12179
 12180     IF CRTFNMEL = ZERO
 12181         IF FSTNMEI = SPACES OR LOW-VALUES
 12182*            NEXT SENTENCE
 12183             CONTINUE
 12184         ELSE
 12185             MOVE FSTNMEI            TO  CRTFNMEI
 12186             MOVE AL-UANON           TO  CRTFNMEA
 12187         END-IF
 12188     END-IF.
 12189
 12190     IF CRTINITL = ZERO
 12191         IF INITI = SPACES OR LOW-VALUES
 12192*            NEXT SENTENCE
 12193             CONTINUE
 12194         ELSE
 12195             MOVE INITI              TO  CRTINITI
 12196             MOVE AL-UANON           TO  CRTINITA
 12197         END-IF
 12198     END-IF.
 12199
 12200 6000-EXIT.
 12201     EXIT.
 12202
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 233
* EL130.cbl
 12204 6200-EDIT-CERT-DATA.
 12205     IF ISSAGEL GREATER ZERO
 12206         IF ISSAGEI NOT NUMERIC
 12207             MOVE ER-0237        TO EMI-ERROR
 12208             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12209             MOVE -1             TO ISSAGEL
 12210             MOVE AL-UNBON       TO ISSAGEA
 12211         ELSE
 12212             MOVE AL-UNNON       TO ISSAGEA
 12213         END-IF
 12214     END-IF.
 12215
 12216     IF JNTAGEL GREATER ZERO
 12217         IF JNTAGEI NOT NUMERIC
 12218             MOVE ER-0238        TO EMI-ERROR
 12219             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12220             MOVE -1             TO JNTAGEL
 12221             MOVE AL-UNBON       TO JNTAGEA
 12222         ELSE
 12223             MOVE AL-UNNON       TO JNTAGEA
 12224         END-IF
 12225     END-IF.
 12226
 12227     IF LCVCDL GREATER ZERO
 12228         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
 12229         IF INVALID-BENEFIT-CODE
 12230             MOVE ER-7635        TO EMI-ERROR
 12231             MOVE -1             TO LCVCDL
 12232             MOVE AL-UABON       TO LCVCDA
 12233             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12234         ELSE
 12235             MOVE LCVCDI         TO WS-BEN-HOLD
 12236             MOVE '4'            TO WS-REC-TYPE
 12237             PERFORM 7100-READ-BENEFIT THRU 7199-EXIT
 12238             IF WS-BEN-ALPHA-HOLD = SPACES
 12239                MOVE ER-7635     TO EMI-ERROR
 12240                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12241                MOVE -1          TO LCVCDL
 12242                MOVE AL-UABON    TO LCVCDA
 12243             ELSE
 12244                MOVE WS-BEN-ALPHA-HOLD  TO LCVKINDO
 12245                MOVE WS-EARNINGS-CALC   TO WS-LF-EARNINGS-CALC
 12246                MOVE WS-SPECIAL-CALC-CD TO WS-LF-SPECIAL-CALC-CD
 12247                MOVE AL-UANON           TO LCVCDA
 12248             END-IF
 12249         END-IF
 12250     END-IF.
 12251
 12252     IF ACVCDL GREATER ZERO
 12253         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
 12254         IF INVALID-BENEFIT-CODE
 12255             MOVE ER-7635        TO EMI-ERROR
 12256             MOVE -1             TO ACVCDL
 12257             MOVE AL-UABON       TO ACVCDA
 12258             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12259         ELSE
 12260             MOVE ACVCDI         TO WS-BEN-HOLD
 12261             MOVE '5'            TO WS-REC-TYPE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 234
* EL130.cbl
 12262             PERFORM 7100-READ-BENEFIT THRU 7199-EXIT
 12263             IF WS-BEN-ALPHA-HOLD = SPACES
 12264                MOVE ER-7635     TO EMI-ERROR
 12265                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12266                MOVE -1          TO ACVCDL
 12267                MOVE AL-UABON    TO ACVCDA
 12268             ELSE
 12269                MOVE WS-BEN-ALPHA-HOLD  TO ACVKINDO
 12270                MOVE WS-EARNINGS-CALC   TO WS-AH-EARNINGS-CALC
 12271                MOVE WS-SPECIAL-CALC-CD TO WS-AH-SPECIAL-CALC-CD
 12272                MOVE AL-UANON           TO ACVCDA
 12273             END-IF
 12274         END-IF
 12275     END-IF.
 12276
 12277     IF LCVOTRML GREATER ZERO
 12278         IF LCVOTRMI NOT NUMERIC
 12279             MOVE ER-7636        TO EMI-ERROR
 12280             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12281             MOVE -1             TO LCVOTRML
 12282             MOVE AL-UNBON       TO LCVOTRMA
 12283         ELSE
 12284             MOVE AL-UNNON       TO LCVOTRMA
 12285         END-IF
 12286     END-IF.
 12287
 12288     IF ACVOTRML GREATER ZERO
 12289         IF ACVOTRMI NOT NUMERIC
 12290             MOVE ER-7636        TO EMI-ERROR
 12291             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12292             MOVE -1             TO ACVOTRML
 12293             MOVE AL-UNBON       TO ACVOTRMA
 12294         ELSE
 12295             MOVE AL-UNNON       TO ACVOTRMA
 12296         END-IF
 12297     END-IF.
 12298
 12299     IF LCVRATEL GREATER ZERO
 12300
 12301* EXEC CICS BIF DEEDIT
 12302*            FIELD    (LCVRATEI)
 12303*            LENGTH   (06)
 12304*        END-EXEC
 12305     MOVE 06
 12306       TO DFHEIV11
 12307*    MOVE '@"L                   #   #00011259' TO DFHEIV0
 12308     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12309     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12310     MOVE X'2020233030303131323539' TO DFHEIV0(25:11)
 12311     CALL 'kxdfhei1' USING DFHEIV0,
 12312           LCVRATEI,
 12313           DFHEIV11
 12314     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12315         IF LCVRATEI NOT NUMERIC
 12316             MOVE AL-UNBON       TO LCVRATEA
 12317             MOVE -1             TO LCVRATEL
 12318             MOVE ER-2280        TO EMI-ERROR
 12319             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 235
* EL130.cbl
 12320         ELSE
 12321             MOVE AL-UNNON       TO LCVRATEA
 12322             MOVE LCVRATEI       TO WS-LCVRATE LCVRATEO
 12323         END-IF
 12324     END-IF.
 12325
 12326     IF ACVRATEL GREATER ZERO
 12327
 12328* EXEC CICS BIF DEEDIT
 12329*            FIELD    (ACVRATEI)
 12330*            LENGTH   (06)
 12331*        END-EXEC
 12332     MOVE 06
 12333       TO DFHEIV11
 12334*    MOVE '@"L                   #   #00011275' TO DFHEIV0
 12335     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12336     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12337     MOVE X'2020233030303131323735' TO DFHEIV0(25:11)
 12338     CALL 'kxdfhei1' USING DFHEIV0,
 12339           ACVRATEI,
 12340           DFHEIV11
 12341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12342         IF ACVRATEI NOT NUMERIC
 12343             MOVE AL-UNBON       TO ACVRATEA
 12344             MOVE -1             TO ACVRATEL
 12345             MOVE ER-2280        TO EMI-ERROR
 12346             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12347         ELSE
 12348             MOVE AL-UNNON       TO ACVRATEA
 12349             MOVE ACVRATEI       TO WS-ACVRATE ACVRATEO
 12350         END-IF
 12351     END-IF.
 12352
 12353     IF LCVBENEL GREATER ZERO
 12354
 12355* EXEC CICS BIF DEEDIT
 12356*            FIELD    (LCVBENEI)
 12357*            LENGTH   (11)
 12358*        END-EXEC
 12359     MOVE 11
 12360       TO DFHEIV11
 12361*    MOVE '@"L                   #   #00011291' TO DFHEIV0
 12362     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12363     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12364     MOVE X'2020233030303131323931' TO DFHEIV0(25:11)
 12365     CALL 'kxdfhei1' USING DFHEIV0,
 12366           LCVBENEI,
 12367           DFHEIV11
 12368     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12369         IF LCVBENEI NOT NUMERIC
 12370             MOVE AL-UNBON       TO LCVBENEA
 12371             MOVE -1             TO LCVBENEL
 12372             MOVE ER-7637        TO EMI-ERROR
 12373             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12374         ELSE
 12375             MOVE AL-UNNON       TO LCVBENEA
 12376             MOVE LCVBENEI       TO WS-LCVBENE LCVBENEO
 12377         END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 236
* EL130.cbl
 12378     END-IF.
 12379
 12380     IF ACVBENEL GREATER ZERO
 12381
 12382* EXEC CICS BIF DEEDIT
 12383*            FIELD    (ACVBENEI)
 12384*            LENGTH   (11)
 12385*        END-EXEC
 12386     MOVE 11
 12387       TO DFHEIV11
 12388*    MOVE '@"L                   #   #00011307' TO DFHEIV0
 12389     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12390     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12391     MOVE X'2020233030303131333037' TO DFHEIV0(25:11)
 12392     CALL 'kxdfhei1' USING DFHEIV0,
 12393           ACVBENEI,
 12394           DFHEIV11
 12395     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12396         IF ACVBENEI NOT NUMERIC
 12397             MOVE AL-UNBON       TO ACVBENEA
 12398             MOVE -1             TO ACVBENEL
 12399             MOVE ER-7637        TO EMI-ERROR
 12400             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12401         ELSE
 12402             MOVE AL-UNNON       TO ACVBENEA
 12403             MOVE ACVBENEI       TO WS-ACVBENE ACVBENEO
 12404         END-IF
 12405     END-IF.
 12406
 12407     IF LCVCNDTL GREATER ZERO
 12408         IF LCVCNDTI NOT = SPACES
 12409             MOVE LCVCNDTI        TO DATE-WORK
 12410             PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12411             MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 12412             MOVE '4'             TO DC-OPTION-CODE
 12413             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12414             IF DATE-CONVERSION-ERROR
 12415                 MOVE AL-UABON    TO LCVCNDTA
 12416                 MOVE -1          TO LCVCNDTL
 12417                 MOVE ER-7638     TO EMI-ERROR
 12418                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12419             ELSE
 12420                 MOVE AL-UANON    TO LCVCNDTA
 12421                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTI
 12422                 MOVE DC-BIN-DATE-1 TO WS-LCVCNDT
 12423             END-IF
 12424         END-IF
 12425     END-IF.
 12426
 12427     IF ACVCNDTL GREATER ZERO
 12428         IF ACVCNDTI NOT = SPACES
 12429             MOVE ACVCNDTI        TO DATE-WORK
 12430             PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12431             MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 12432             MOVE '4'             TO DC-OPTION-CODE
 12433             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12434             IF DATE-CONVERSION-ERROR
 12435                 MOVE AL-UABON    TO ACVCNDTA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 237
* EL130.cbl
 12436                 MOVE -1          TO ACVCNDTL
 12437                 MOVE ER-7638     TO EMI-ERROR
 12438                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12439             ELSE
 12440                 MOVE AL-UANON    TO ACVCNDTA
 12441                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTI
 12442                 MOVE DC-BIN-DATE-1 TO WS-ACVCNDT
 12443             END-IF
 12444         END-IF
 12445     END-IF.
 12446
 12447     IF ADDONDTL GREATER ZERO
 12448         MOVE ADDONDTI        TO DATE-WORK
 12449         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12450         MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 12451         MOVE '4'             TO DC-OPTION-CODE
 12452         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12453         IF DATE-CONVERSION-ERROR
 12454             MOVE AL-UABON    TO ADDONDTA
 12455             MOVE -1          TO ADDONDTL
 12456             MOVE ER-7651     TO EMI-ERROR
 12457             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12458         ELSE
 12459             MOVE AL-UANON    TO ADDONDTA
 12460             MOVE DC-GREG-DATE-1-EDIT TO ADDONDTI
 12461             MOVE DC-BIN-DATE-1 TO WS-ADD-ON-DT
 12462         END-IF
 12463     END-IF.
 12464
 12465     IF APRL GREATER ZERO
 12466
 12467* EXEC CICS BIF DEEDIT
 12468*            FIELD    (APRI)
 12469*            LENGTH   (8)
 12470*        END-EXEC
 12471     MOVE 8
 12472       TO DFHEIV11
 12473*    MOVE '@"L                   #   #00011381' TO DFHEIV0
 12474     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12475     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12476     MOVE X'2020233030303131333831' TO DFHEIV0(25:11)
 12477     CALL 'kxdfhei1' USING DFHEIV0,
 12478           APRI,
 12479           DFHEIV11
 12480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12481         IF APRI NOT NUMERIC
 12482             MOVE AL-UNBON       TO APRA
 12483             MOVE -1             TO APRL
 12484             MOVE ER-0248        TO EMI-ERROR
 12485             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12486         ELSE
 12487             MOVE AL-UNNON       TO APRA
 12488             MOVE APRI           TO WS-APR APRO
 12489         END-IF
 12490     END-IF.
 12491
 12492     IF PMTFREQL GREATER ZERO
 12493
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 238
* EL130.cbl
 12494* EXEC CICS BIF DEEDIT
 12495*            FIELD   (PMTFREQI)
 12496*            LENGTH  (2)
 12497*        END-EXEC
 12498     MOVE 2
 12499       TO DFHEIV11
 12500*    MOVE '@"L                   #   #00011397' TO DFHEIV0
 12501     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12502     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12503     MOVE X'2020233030303131333937' TO DFHEIV0(25:11)
 12504     CALL 'kxdfhei1' USING DFHEIV0,
 12505           PMTFREQI,
 12506           DFHEIV11
 12507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12508         IF PMTFREQI NOT NUMERIC
 12509             MOVE -1             TO PMTFREQL
 12510             MOVE AL-UNBON       TO PMTFREQA
 12511             MOVE ER-0258        TO EMI-ERROR
 12512             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12513         ELSE
 12514             MOVE AL-UNNON       TO PMTFREQA
 12515             MOVE PMTFREQI       TO WS-PMTFREQ  PMTFREQO
 12516         END-IF
 12517     END-IF.
 12518
 12519     IF INDGRPL GREATER ZERO
 12520         IF INDGRPI = 'I' OR 'G'
 12521             MOVE AL-UANON       TO INDGRPA
 12522         ELSE
 12523             MOVE -1 TO INDGRPL
 12524             MOVE AL-UABON       TO INDGRPA
 12525             MOVE ER-0260        TO EMI-ERROR
 12526             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12527         END-IF
 12528     END-IF.
 12529
 12530     IF LOANBALL GREATER ZERO
 12531         MOVE LOANBALI           TO DEEDIT-FIELD
 12532
 12533* EXEC CICS BIF DEEDIT
 12534*            FIELD   (DEEDIT-FIELD)
 12535*            LENGTH  (12)
 12536*        END-EXEC
 12537     MOVE 12
 12538       TO DFHEIV11
 12539*    MOVE '@"L                   #   #00011425' TO DFHEIV0
 12540     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12541     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12542     MOVE X'2020233030303131343235' TO DFHEIV0(25:11)
 12543     CALL 'kxdfhei1' USING DFHEIV0,
 12544           DEEDIT-FIELD,
 12545           DFHEIV11
 12546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12547         IF DEEDIT-FIELD NOT NUMERIC
 12548             MOVE AL-UNBON       TO LOANBALA
 12549             MOVE -1             TO LOANBALL
 12550             MOVE ER-0247        TO EMI-ERROR
 12551             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 239
* EL130.cbl
 12552         ELSE
 12553             MOVE AL-UNNON       TO LOANBALA
 12554             MOVE DEEDIT-FIELD   TO HOLD-LOAN-BAL  LOANBALO
 12555         END-IF
 12556     END-IF.
 12557
 12558     IF PREMTYPL GREATER ZERO
 12559         IF (PREMTYPI = '1' OR '2' OR '3')
 12560             MOVE AL-UANON       TO PREMTYPA
 12561         ELSE
 12562             MOVE -1             TO PREMTYPL
 12563             MOVE AL-UABON       TO PREMTYPA
 12564             MOVE ER-0227        TO EMI-ERROR
 12565             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12566         END-IF
 12567     END-IF.
 12568
 12569     IF REINCDL GREATER ZERO
 12570         MOVE LOW-VALUES         TO  ERREIN-KEY
 12571         MOVE PI-COMPANY-CD      TO  REIN-COMP-CD
 12572         MOVE REINCDI            TO  REIN-CODE-1
 12573                                     REIN-CODE-2
 12574                                     REIN-CODE-3
 12575         MOVE 'A'                TO  REIN-TYPE
 12576         PERFORM 7992-READ-REIN THRU 7992-EXIT
 12577         IF REIN-REC-NOT-FOUND
 12578             MOVE ER-0266        TO  EMI-ERROR
 12579             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12580             MOVE -1             TO  REINCDL
 12581             MOVE AL-UABON       TO  REINCDA
 12582         ELSE
 12583             MOVE AL-UANON       TO  REINCDA
 12584         END-IF
 12585     END-IF.
 12586
 12587     IF CERTMTI NOT = 'A'
 12588        GO TO 6200-EXIT
 12589     END-IF.
 12590
 12591     IF PREMTYPI = '1'
 12592         IF LCVCDL GREATER ZERO
 12593             IF WS-LF-SPECIAL-CALC-CD = 'O'
 12594                 MOVE ER-0841        TO  EMI-ERROR
 12595                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12596                 MOVE -1             TO  PREMTYPL
 12597                 MOVE AL-UABON       TO  PREMTYPA
 12598             END-IF
 12599         END-IF
 12600     END-IF.
 12601
 12602     IF PREMTYPI = '1'
 12603         IF ACVCDL GREATER ZERO
 12604             IF WS-AH-SPECIAL-CALC-CD = 'O'
 12605                 MOVE ER-0841        TO  EMI-ERROR
 12606                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12607                 MOVE -1             TO  PREMTYPL
 12608                 MOVE AL-UABON       TO  PREMTYPA
 12609             END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 240
* EL130.cbl
 12610         END-IF
 12611     END-IF.
 12612
 12613     IF PREMTYPI = '2'
 12614         IF LCVCDL GREATER ZERO
 12615             IF (PI-COMPANY-ID = 'HAN') AND
 12616                (WS-LF-SPECIAL-CALC-CD = 'O' OR 'M')
 12617                        OR
 12618                 WS-LF-SPECIAL-CALC-CD = 'O'
 12619*                NEXT SENTENCE
 12620                 CONTINUE
 12621             ELSE
 12622                 MOVE ER-0840        TO  EMI-ERROR
 12623                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12624                 MOVE -1             TO  PREMTYPL
 12625                 MOVE AL-UABON       TO  PREMTYPA
 12626             END-IF
 12627         END-IF
 12628     END-IF.
 12629
 12630     IF PREMTYPI = '2'
 12631         IF ACVCDL GREATER ZERO
 12632             IF (PI-COMPANY-ID = 'HAN')  AND
 12633                (WS-AH-SPECIAL-CALC-CD = 'O' OR 'M')
 12634                        OR
 12635                 WS-AH-SPECIAL-CALC-CD = 'O'
 12636*                NEXT SENTENCE
 12637                 CONTINUE
 12638             ELSE
 12639                 MOVE ER-0840        TO  EMI-ERROR
 12640                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12641                 MOVE -1             TO  PREMTYPL
 12642                 MOVE AL-UABON       TO  PREMTYPA
 12643             END-IF
 12644         END-IF
 12645     END-IF.
 12646
 12647     IF LCVCDL = ZEROS
 12648        GO TO 6200-EXIT
 12649     END-IF.
 12650
 12651     IF PMTFREQL NOT = ZEROS  AND NOT TEX-REG
 12652         IF PMTFREQI NOT = ZEROS
 12653             MOVE ER-0428        TO EMI-ERROR
 12654             MOVE -1             TO PMTFREQL
 12655             MOVE AL-UNBON       TO PMTFREQA
 12656             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12657             GO TO 6200-CHECK-APR
 12658         END-IF
 12659     END-IF.
 12660
 12661     IF PMTFREQL = ZEROS AND TEX-REG
 12662         MOVE ER-0429            TO EMI-ERROR
 12663         MOVE -1                 TO PMTFREQL
 12664         MOVE AL-UNBON           TO PMTFREQA
 12665         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12666         GO TO 6200-CHECK-APR
 12667     END-IF.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 241
* EL130.cbl
 12668
 12669     IF LCVOTRMI NOT NUMERIC
 12670         GO TO 6200-CHECK-APR
 12671     END-IF.
 12672
 12673     IF WS-PMTFREQ NOT = ZERO
 12674         DIVIDE WS-PMTFREQ INTO LCVOTRMI
 12675         GIVING DIVIDE-QUOT
 12676         REMAINDER DIVIDE-REM
 12677         IF DIVIDE-REM GREATER ZERO
 12678             MOVE ER-0430            TO EMI-ERROR
 12679             MOVE -1                 TO PMTFREQL
 12680             MOVE AL-UNBON           TO PMTFREQA
 12681             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12682         END-IF
 12683     END-IF.
 12684
 12685 6200-CHECK-APR.
 12686     IF NET-PAY AND APRL = ZEROS
 12687        MOVE ER-0257             TO EMI-ERROR
 12688        MOVE -1                  TO APRL
 12689        MOVE AL-UABON            TO APRA
 12690        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12691     END-IF.
 12692
 12693 6200-EXIT.
 12694     EXIT.
 12695
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 242
* EL130.cbl
 12697 6300-REQUIRED-CERT-EDIT.
 12698
 12699     IF CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 12700        GO TO 6300-REQUIRED-AH-EDIT
 12701     END-IF
 12702
 12703     IF LCVCDL = ZERO
 12704        MOVE ER-7639             TO EMI-ERROR
 12705        MOVE -1                  TO LCVCDL
 12706        MOVE AL-UABON            TO LCVCDA
 12707        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12708     END-IF.
 12709
 12710     IF LCVOTRML = ZERO
 12711        MOVE ER-7670             TO EMI-ERROR
 12712        MOVE -1                  TO LCVOTRML
 12713        MOVE AL-UNBON            TO LCVOTRMA
 12714        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12715     END-IF.
 12716
 12717     IF LCVBENEL = ZERO
 12718        MOVE ER-7671             TO EMI-ERROR
 12719        MOVE -1                  TO LCVBENEL
 12720        MOVE AL-UNBON            TO LCVBENEA
 12721        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12722     END-IF.
 12723
 12724     GO TO 6399-EXIT.
 12725
 12726 6300-REQUIRED-AH-EDIT.
 12727
 12728     IF ACVCDL = ZERO
 12729        MOVE ER-7639             TO EMI-ERROR
 12730        MOVE -1                  TO ACVCDL
 12731        MOVE AL-UABON            TO ACVCDA
 12732        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12733     END-IF.
 12734
 12735     IF ACVOTRML = ZERO
 12736         MOVE ER-7670             TO EMI-ERROR
 12737         MOVE -1                  TO ACVOTRML
 12738         MOVE AL-UNBON            TO ACVOTRMA
 12739         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12740     END-IF.
 12741
 12742     IF ACVBENEL = ZERO
 12743        MOVE ER-7671             TO EMI-ERROR
 12744        MOVE -1                  TO ACVBENEL
 12745        MOVE AL-UNBON            TO ACVBENEA
 12746        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12747     END-IF.
 12748
 12749 6399-EXIT.
 12750      EXIT.
 12751
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 243
* EL130.cbl
 12753 6400-TEST-CLAIM-REASONABILITY.
 12754
 12755     IF WS-INCUR = LOW-VALUES
 12756        GO TO 6499-EXIT
 12757     END-IF.
 12758
 12759     IF WS-EFFDT NOT = LOW-VALUES
 12760         IF WS-INCUR LESS WS-EFFDT
 12761             MOVE ER-0458          TO EMI-ERROR
 12762             MOVE -1               TO INCURL
 12763             MOVE AL-UABON         TO INCURA
 12764             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12765         END-IF
 12766     END-IF.
 12767
 12768     IF CERTMTI = 'A'
 12769        GO TO 6460-TEST-NEW-CERT
 12770     END-IF.
 12771
 12772     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 12773     MOVE CRTCARRI               TO CERT-CARRIER.
 12774     MOVE GROUPI                 TO CERT-GROUPING.
 12775     MOVE STATEI                 TO CERT-STATE.
 12776     MOVE PI-SAVE-ACCOUNT        TO CERT-ACCOUNT.
 12777     MOVE PI-SAVE-CERT           TO CERT-CERT-NO.
 12778     MOVE PI-SAVE-EFFDT          TO CERT-EFF-DT.
 12779
 12780
 12781
 12782* EXEC CICS HANDLE CONDITION
 12783*         DUPKEY   (6499-EXIT)
 12784*         NOTFND   (6499-EXIT)
 12785*    END-EXEC.
 12786*    MOVE '"$$I                  ! B #00011663' TO DFHEIV0
 12787     MOVE X'222424492020202020202020' TO DFHEIV0(1:12)
 12788     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12789     MOVE X'4220233030303131363633' TO DFHEIV0(25:11)
 12790     CALL 'kxdfhei1' USING DFHEIV0
 12791     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12792
 12793
 12794     PERFORM 7940-READ-CERT THRU 7940-EXIT.
 12795
 12796     IF (CLMTYPEI = PI-AH-OVERRIDE-L1  OR
 12797        'I' OR 'G')
 12798        MOVE CM-AH-ORIG-TERM     TO DC-ELAPSED-MONTHS
 12799     ELSE
 12800        MOVE CM-LF-ORIG-TERM     TO DC-ELAPSED-MONTHS
 12801     END-IF.
 12802
 12803     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12804     MOVE '6'                    TO DC-OPTION-CODE.
 12805     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12806
 12807     IF WS-INCUR GREATER THAN DC-BIN-DATE-2
 12808        MOVE ER-0519             TO EMI-ERROR
 12809        MOVE -1                  TO INCURL
 12810        MOVE AL-UABON            TO INCURA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 244
* EL130.cbl
 12811        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12812     END-IF.
 12813
 12814     IF CLMCARRI NOT = CRTCARRI
 12815        MOVE ER-0562             TO EMI-ERROR
 12816        MOVE AL-UABON            TO CLMCARRA
 12817        MOVE -1                  TO CLMCARRL
 12818        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12819     END-IF.
 12820
 12821     IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G') AND
 12822        CM-AH-BENEFIT-CD = '00')
 12823                  OR
 12824        (CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 12825        CM-LF-BENEFIT-CD = '00')
 12826         MOVE ER-0521         TO EMI-ERROR
 12827         MOVE AL-UABON        TO CLMTYPEA
 12828         MOVE -1              TO CLMTYPEL
 12829         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12830     END-IF.
 12831*    IF CLMTYPEI = 'I' AND
 12832*       CM-AH-CRITICAL-PERIOD = +0
 12833*        MOVE ER-0521         TO EMI-ERROR
 12834*        MOVE AL-UABON        TO CLMTYPEA
 12835*        MOVE -1              TO CLMTYPEL
 12836*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12837*    END-IF
 12838
 12839*    IF PI-COMPANY-ID = 'CRI'
 12840*        IF MAINTI = 'A'
 12841*            IF CERT-PEND-ISSUE-ERROR  OR
 12842*               CERT-PEND-ISSUE-RETURNED
 12843*                MOVE -1                 TO CERTNOL
 12844*                MOVE AL-UABON           TO CERTNOA
 12845*                MOVE ER-7640            TO EMI-ERROR
 12846*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12847*            END-IF
 12848*        END-IF
 12849*    END-IF.
 12850
 12851     IF (CM-AH-CANCEL-DT  NOT  =  LOW-VALUES AND
 12852         (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'))
 12853         IF WS-INCUR GREATER THAN CM-AH-CANCEL-DT
 12854             GO TO 6450-DATE-ERROR
 12855         END-IF
 12856     END-IF.
 12857
 12858     IF (CM-LF-CANCEL-DT  NOT  =  LOW-VALUES AND
 12859         CLMTYPEI = PI-LIFE-OVERRIDE-L1)
 12860         IF WS-INCUR GREATER THAN CM-LF-CANCEL-DT
 12861             GO TO 6450-DATE-ERROR
 12862         END-IF
 12863     END-IF.
 12864
 12865     IF CM-LF-DEATH-DT NOT = LOW-VALUES
 12866         IF WS-INCUR GREATER THAN CM-LF-DEATH-DT
 12867             GO TO 6450-DATE-ERROR
 12868         END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 245
* EL130.cbl
 12869     END-IF.
 12870
 12871     GO TO 6499-EXIT.
 12872
 12873 6450-DATE-ERROR.
 12874     MOVE ER-0520                TO EMI-ERROR.
 12875     MOVE -1                     TO INCURL.
 12876     MOVE AL-UABON               TO INCURA.
 12877     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12878
 12879*    IF (PI-COMPANY-ID = 'FIM' OR 'LGX') AND
 12880*       (EMI-SEVERITY-SAVE = 'X')
 12881*        ADD 1                TO EMI-FORCABLE-CTR
 12882*        SUBTRACT 1 FROM EMI-FATAL-CTR
 12883*    END-IF.
 12884
 12885     GO TO 6499-EXIT.
 12886
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 246
* EL130.cbl
 12888 6460-TEST-NEW-CERT.
 12889
 12890     IF NOT EMI-NO-ERRORS
 12891        GO TO 6499-EXIT
 12892     END-IF.
 12893
 12894     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 12895
 12896     IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G') AND
 12897         ACVOTRML GREATER ZERO)
 12898        MOVE ACVOTRMI       TO DC-ELAPSED-MONTHS
 12899     END-IF.
 12900
 12901     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 12902         LCVOTRML GREATER ZERO
 12903        MOVE LCVOTRMI       TO DC-ELAPSED-MONTHS
 12904     END-IF.
 12905
 12906     MOVE WS-EFFDT               TO DC-BIN-DATE-1.
 12907
 12908*    IF PI-COMPANY-ID = 'HAN'
 12909*        IF ADDONDTL GREATER ZERO
 12910*            MOVE WS-ADD-ON-DT   TO  DC-BIN-DATE-1
 12911*            IF CLMTYPEI = 'A'
 12912*                IF ACVOTRMI NOT = ZEROS
 12913*                    COMPUTE DC-ELAPSED-MONTHS = (ACVOTRMI - 1)
 12914*                ELSE
 12915*                    NEXT SENTENCE
 12916*                    CONTINUE
 12917*                END-IF
 12918*            ELSE
 12919*                IF LCVOTRMI NOT = ZEROS
 12920*                    COMPUTE DC-ELAPSED-MONTHS = (LCVOTRMI - 1)
 12921*                END-IF
 12922*            END-IF
 12923*        END-IF
 12924*    END-IF.
 12925
 12926     MOVE '6'                    TO DC-OPTION-CODE.
 12927     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12928
 12929     IF NO-CONVERSION-ERROR
 12930         MOVE DC-BIN-DATE-2      TO WS-EXPIRE
 12931     END-IF.
 12932
 12933     IF WS-INCUR GREATER THAN WS-EXPIRE
 12934        MOVE ER-0519             TO EMI-ERROR
 12935        MOVE -1                  TO INCURL
 12936        MOVE AL-UABON            TO INCURA
 12937        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12938     END-IF.
 12939
 12940     IF CLMCARRI NOT = CRTCARRI
 12941        MOVE ER-0562             TO EMI-ERROR
 12942        MOVE AL-UABON            TO CLMCARRA
 12943        MOVE -1                  TO CLMCARRL
 12944        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12945     END-IF.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 247
* EL130.cbl
 12946
 12947     IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G') AND
 12948         ACVCDL = ZEROS)
 12949             MOVE ER-0521        TO EMI-ERROR
 12950             MOVE AL-UABON       TO CLMTYPEA
 12951             MOVE -1             TO CLMTYPEL
 12952             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12953     END-IF.
 12954
 12955     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 12956         LCVCDL = ZEROS
 12957             MOVE ER-0521        TO EMI-ERROR
 12958             MOVE AL-UABON       TO CLMTYPEA
 12959             MOVE -1             TO CLMTYPEL
 12960             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12961     END-IF.
 12962
 12963     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 12964         IF LCVCNDTL GREATER ZERO
 12965             IF WS-INCUR GREATER THAN WS-LCVCNDT
 12966                 GO TO 6450-DATE-ERROR
 12967             END-IF
 12968         END-IF
 12969     END-IF.
 12970
 12971     IF CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 12972         IF ACVCNDTL GREATER ZERO
 12973             IF WS-INCUR GREATER THAN WS-ACVCNDT
 12974                 GO TO 6450-DATE-ERROR
 12975             END-IF
 12976         END-IF
 12977     END-IF.
 12978
 12979 6499-EXIT.
 12980     EXIT.
 12981
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 248
* EL130.cbl
 12983 6600-CHECK-AUTO-ACTIVITY.
 12984
 12985
 12986* EXEC CICS HANDLE CONDITION
 12987*        NOTFND   (6600-NOT-FOUND)
 12988*    END-EXEC.
 12989*    MOVE '"$I                   ! C #00011859' TO DFHEIV0
 12990     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12991     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12992     MOVE X'4320233030303131383539' TO DFHEIV0(25:11)
 12993     CALL 'kxdfhei1' USING DFHEIV0
 12994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12995
 12996
 12997     MOVE PI-COMPANY-ID              TO  CNTL-COMP-ID.
 12998     MOVE 'T'                        TO  CNTL-REC-TYPE.
 12999     MOVE SPACES                     TO  CNTL-ACCESS.
 13000     MOVE +0                         TO  CNTL-SEQ-NO.
 13001
 13002     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 13003
 13004     IF CF-SYS-ACTIVE-SW (1) = 'N' OR ' '
 13005         MOVE 'N'                    TO  WS-REC-FOUND-SW
 13006                                         WS-LETTER-SW
 13007         GO TO 6600-EXIT
 13008     END-IF.
 13009
 13010     IF CF-SYS-LETTER-ID (1) = SPACES OR LOW-VALUES
 13011         MOVE 'N'                     TO  WS-LETTER-SW
 13012     ELSE
 13013         MOVE 'Y'                     TO  WS-LETTER-SW
 13014     END-IF.
 13015
 13016     MOVE 'Y'                         TO  WS-REC-FOUND-SW.
 13017     GO TO 6600-EXIT.
 13018
 13019 6600-START-AUTO-LETTER-WRITER.
 13020
 13021     MOVE LOW-VALUES                  TO  W-1523-LINKDATA.
 13022     MOVE PROGRAM-INTERFACE-BLOCK     TO  W-1523-COMMON-PI-DATA.
 13023
 13024     MOVE CF-SYS-LETTER-ID (1)        TO  W-1523-FORM-NUMBER.
 13025
 13026     IF CF-SYS-RESEND-DAYS (1) NOT = ZEROS
 13027         MOVE SAVE-BIN-DATE           TO  DC-BIN-DATE-1
 13028         MOVE '6'                     TO  DC-OPTION-CODE
 13029         MOVE CF-SYS-RESEND-DAYS (1)  TO  DC-ELAPSED-DAYS
 13030         MOVE +0                      TO  DC-ELAPSED-MONTHS
 13031         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13032         IF NO-CONVERSION-ERROR
 13033             MOVE DC-BIN-DATE-2       TO  W-1523-RESEND-DATE
 13034         ELSE
 13035             MOVE LOW-VALUES          TO  W-1523-RESEND-DATE
 13036         END-IF
 13037     END-IF.
 13038
 13039     IF CF-SYS-FOLLOW-UP-DAYS (1) NOT = ZEROS
 13040         MOVE SAVE-BIN-DATE           TO  DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 249
* EL130.cbl
 13041         MOVE '6'                     TO  DC-OPTION-CODE
 13042         MOVE CF-SYS-FOLLOW-UP-DAYS (1)   TO  DC-ELAPSED-DAYS
 13043         MOVE +0                      TO  DC-ELAPSED-MONTHS
 13044         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13045         IF NO-CONVERSION-ERROR
 13046             MOVE DC-BIN-DATE-2       TO  W-1523-FOLLOW-UP-DATE
 13047         ELSE
 13048             MOVE LOW-VALUES          TO  W-1523-FOLLOW-UP-DATE
 13049         END-IF
 13050     END-IF.
 13051
 13052
 13053
 13054* EXEC CICS LINK
 13055*        PROGRAM    (LINK-1523)
 13056*        COMMAREA   (W-1523-LINKDATA)
 13057*        LENGTH     (W-1523-COMM-LENGTH)
 13058*    END-EXEC.
 13059*    MOVE '."C                   ''   #00011919' TO DFHEIV0
 13060     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13061     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13062     MOVE X'2020233030303131393139' TO DFHEIV0(25:11)
 13063     CALL 'kxdfhei1' USING DFHEIV0,
 13064           LINK-1523,
 13065           W-1523-LINKDATA,
 13066           W-1523-COMM-LENGTH,
 13067           DFHEIV99,
 13068           DFHEIV99,
 13069           DFHEIV99
 13070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13071
 13072
 13073     GO TO 6600-EXIT.
 13074
 13075 6600-NOT-FOUND.
 13076     MOVE 'N'                         TO  WS-REC-FOUND-SW.
 13077
 13078 6600-EXIT.
 13079     EXIT.
 13080
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 250
* EL130.cbl
 13081/
 13082*************************************************************
 13083*****        START OF ACTIVITY FILE OUTPUT PROCESSING      **
 13084*************************************************************
 13085
 13086 6700-OUTPUT-ACTIVITY-RECORD.
 13087
 13088
 13089
 13090* EXEC CICS GETMAIN
 13091*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
 13092*        LENGTH (DLYACTV-LENGTH)
 13093*        INITIMG (WS-BLANK)
 13094*    END-EXEC.
 13095*    MOVE ',"IL                  $   #00011941' TO DFHEIV0
 13096     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13097     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13098     MOVE X'2020233030303131393431' TO DFHEIV0(25:11)
 13099     CALL 'kxdfhei1' USING DFHEIV0,
 13100           DFHEIV20,
 13101           DLYACTV-LENGTH,
 13102           WS-BLANK
 13103     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 13104         DFHEIV20
 13105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13106
 13107
 13108     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 13109     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
 13110     MOVE CLMCARRI               TO DA-CARRIER.
 13111     IF CLMNOL EQUAL ZERO
 13112         MOVE WS-CLAIM-NUMBER    TO DA-CLAIM-NO
 13113     ELSE
 13114         MOVE CLMNOI             TO DA-CLAIM-NO
 13115     END-IF.
 13116     MOVE CERTNOI                TO DA-CERT-PRIME.
 13117     MOVE SUFXI                  TO DA-CERT-SFX.
 13118     MOVE +0                     TO DA-TRAILER-SEQ-NO.
 13119     MOVE 'A'                    TO DA-RECORD-TYPE.
 13120
 13121
 13122* EXEC CICS HANDLE CONDITION
 13123*        NOTOPEN (6700-NOTOPEN-ERROR)
 13124*        DUPREC (6700-EXIT)
 13125*    END-EXEC.
 13126*    MOVE '"$J%                  ! D #00011960' TO DFHEIV0
 13127     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 13128     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13129     MOVE X'4420233030303131393630' TO DFHEIV0(25:11)
 13130     CALL 'kxdfhei1' USING DFHEIV0
 13131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13132
 13133
 13134
 13135* EXEC CICS WRITE
 13136*        DATASET (DLYACTV-DSID)
 13137*        RIDFLD (DA-KEY)
 13138*        FROM (DAILY-ACTIVITY-RECORD)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 251
* EL130.cbl
 13139*        LENGTH (DLYACTV-LENGTH)
 13140*    END-EXEC.
 13141*    MOVE '&$ L                  ''   #00011965' TO DFHEIV0
 13142     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13143     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13144     MOVE X'2020233030303131393635' TO DFHEIV0(25:11)
 13145     CALL 'kxdfhei1' USING DFHEIV0,
 13146           DLYACTV-DSID,
 13147           DAILY-ACTIVITY-RECORD,
 13148           DLYACTV-LENGTH,
 13149           DA-KEY,
 13150           DFHEIV99,
 13151           DFHEIV99
 13152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13153
 13154     GO TO 6700-EXIT.
 13155
 13156 6700-NOTOPEN-ERROR.
 13157     MOVE '2955'                 TO EMI-ERROR.
 13158     MOVE -1                     TO MAINTL.
 13159     MOVE AL-UANON               TO MAINTA.
 13160     PERFORM 9900-ERROR-FORMAT THRU
 13161             9900-EXIT.
 13162     GO TO 8200-SEND-DATAONLY.
 13163
 13164 6700-EXIT.
 13165     EXIT.
 13166
 13167*************************************************************
 13168*****         END OF ACTIVITY FILE OUTPUT PROCESSING        *
 13169*************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 252
* EL130.cbl
 13170/
 13171 6990-DEEDIT-DATE.
 13172
 13173
 13174* EXEC CICS BIF DEEDIT
 13175*        FIELD   (DATE-WORK)
 13176*        LENGTH  (8)
 13177*    END-EXEC.
 13178     MOVE 8
 13179       TO DFHEIV11
 13180*    MOVE '@"L                   #   #00011990' TO DFHEIV0
 13181     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13182     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13183     MOVE X'2020233030303131393930' TO DFHEIV0(25:11)
 13184     CALL 'kxdfhei1' USING DFHEIV0,
 13185           DATE-WORK,
 13186           DFHEIV11
 13187     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13188
 13189 6990-EXIT.
 13190     EXIT.
 13191
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 253
* EL130.cbl
 13193 7000-BUILD-OUTPUT-MAP.
 13194
 13195     IF CLAIM-SWITCH = 'N'
 13196         GO TO 7050-BUILD-MAP-CERT-DATA
 13197     END-IF.
 13198
 13199     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 13200         MOVE SPACES                 TO SEQUO
 13201         MOVE AL-SABOF               TO SEQUA
 13202     ELSE
 13203         MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU
 13204         MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU
 13205         MOVE WS-CLAIM-SEQU          TO SEQUO
 13206         MOVE AL-SABON               TO SEQUA
 13207     END-IF.
 13208
 13209     MOVE CL-CARRIER             TO CLMCARRO.
 13210     MOVE CL-CLAIM-TYPE          TO CLMTYPEO.
 13211     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 13212     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 13213     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 13214     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 13215     MOVE CL-INSURED-MID-INIT    TO INITO.
 13216     MOVE CL-INSURED-SEX-CD      TO SEXO.
 13217     MOVE CL-INSURED-OCC-CD      TO OCCCDO.
 13218
 13219     MOVE AL-UANON               TO CLMCARRA
 13220                                    CLMTYPEA
 13221                                    PCERTNOA
 13222                                    PSUFXA
 13223                                    LSTNMEA
 13224                                    FSTNMEA
 13225                                    INITA
 13226                                    SEXA
 13227                                    OCCCDA.
 13228
 13229     MOVE CL-PRIME-CERT-NO       TO PI-PRIMARY-CERT-NO.
 13230
 13231     IF CL-INSURED-BIRTH-DT NOT = LOW-VALUES
 13232         MOVE ' '                 TO DC-OPTION-CODE
 13233         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 13234         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13235         IF NOT DATE-CONVERSION-ERROR
 13236             MOVE DC-GREG-DATE-1-EDIT TO BIRTHDTO
 13237             MOVE AL-UANON            TO BIRTHDTA
 13238         END-IF
 13239     END-IF.
 13240
 13241     MOVE CL-SOC-SEC-NO          TO SSNO.
 13242     MOVE AL-UANON               TO SSNA.
 13243
 13244     IF CL-INCURRED-DT NOT = LOW-VALUES
 13245         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 13246         MOVE ' '                TO DC-OPTION-CODE
 13247         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13248         IF NOT DATE-CONVERSION-ERROR
 13249             MOVE DC-GREG-DATE-1-EDIT TO INCURO
 13250             MOVE AL-UANON            TO INCURA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 254
* EL130.cbl
 13251         END-IF
 13252     END-IF.
 13253
 13254     IF CL-REPORTED-DT NOT = LOW-VALUES
 13255         MOVE ' '                TO DC-OPTION-CODE
 13256         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 13257         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13258         IF NOT DATE-CONVERSION-ERROR
 13259             MOVE DC-GREG-DATE-1-EDIT TO REPORTO
 13260             MOVE AL-UANON            TO REPORTA
 13261         END-IF
 13262     END-IF.
 13263
 13264     IF CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES
 13265         MOVE ' '                 TO DC-OPTION-CODE
 13266         MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 13267         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13268         IF NOT DATE-CONVERSION-ERROR
 13269             MOVE DC-GREG-DATE-1-EDIT TO ESTENDO
 13270             MOVE AL-UANON            TO ESTENDA
 13271         END-IF
 13272     END-IF.
 13273
 13274     MOVE WS-DIAGNOSIS-DESCRIPT  TO DIAGO.
 13275     MOVE CL-CAUSE-CD            TO CAUSEO.
 13276     MOVE AT-CURRENT-MANUAL-RESERVE TO MANRSVO.
 13277     MOVE CL-RELATED-CLAIM-NO    TO RELCLMO.
 13278     MOVE CL-PROCESSOR-ID        TO PROCCDO.
 13279     MOVE CL-PRIORITY-CD         TO PRICDO.
 13280     MOVE AL-UANON               TO DIAGA
 13281                                    CAUSEA
 13282                                    RELCLMA
 13283                                    PROCCDA
 13284                                    PRICDA.
 13285     MOVE AL-UNNON               TO MANRSVA.
 13286
 13287*    IF PI-COMPANY-ID  = 'ACC'  OR  'FDL' OR 'LGX'
 13288*        MOVE CL-PRODUCT-CD          TO PRODCDO
 13289*        MOVE AL-UANON               TO PRODCDA
 13290*    END-IF.
 13291
 13292     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 13293     MOVE CL-FILE-LOCATION       TO FILETOO.
 13294     MOVE CL-BENEFICIARY         TO BENECDO.
 13295     MOVE AL-UANON               TO SUPVA
 13296                                    FILETOA
 13297                                    BENECDA.
 13298
 13299     IF CLAIM-SWITCH = 'X'
 13300         GO TO 7099-EXIT
 13301     END-IF.
 13302
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 255
* EL130.cbl
 13304 7050-BUILD-MAP-CERT-DATA.
 13305     MOVE CM-CERT-PRIME          TO CERTNOO.
 13306     MOVE CM-CERT-SFX            TO SUFXO.
 13307     MOVE AL-SANON               TO CERTNOA
 13308                                    SUFXA.
 13309
 13310     IF CM-CERT-EFF-DT NOT = LOW-VALUES
 13311         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 13312         MOVE ' '                TO DC-OPTION-CODE
 13313         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13314         IF NOT DATE-CONVERSION-ERROR
 13315             MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
 13316         END-IF
 13317     END-IF.
 13318
 13319     MOVE CM-ACCOUNT             TO ACCOUNTO.
 13320     MOVE CM-STATE               TO STATEO.
 13321     MOVE CM-CARRIER             TO CRTCARRO.
 13322     MOVE CM-GROUPING            TO GROUPO.
 13323     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 13324     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 13325     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 13326     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 13327     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 13328     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 13329     MOVE CM-JT-INITIAL          TO JNTINITO.
 13330     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 13331     MOVE AL-UANON               TO ACCOUNTA
 13332                                    STATEA
 13333                                    CRTCARRA
 13334                                    GROUPA
 13335                                    CRTLNMEA
 13336                                    CRTFNMEA
 13337                                    CRTINITA
 13338                                    JNTLNMEA
 13339                                    JNTFNMEA
 13340                                    JNTINITA.
 13341     MOVE AL-UNNON               TO ISSAGEA
 13342                                    JNTAGEA.
 13343
 13344     IF CM-SSN-STATE   = CM-STATE AND
 13345        CM-SSN-ACCOUNT = CM-ACCOUNT-PRIME
 13346*        NEXT SENTENCE
 13347         CONTINUE
 13348     ELSE
 13349         MOVE CM-SOC-SEC-NO      TO CRTSSNO
 13350     END-IF.
 13351
 13352     MOVE AL-UANON               TO CRTSSNA.
 13353
 13354     MOVE SAVE-DATE              TO DC-GREG-DATE-1-EDIT.
 13355     MOVE '2'                    TO DC-OPTION-CODE.
 13356     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13357     MOVE DC-BIN-DATE-1          TO SAVE-CURRENT-DATE.
 13358
 13359*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 13360     MOVE SPACES                 TO ELCNTL-KEY.
 13361     MOVE CM-STATE               TO CNTL-ACCESS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 256
* EL130.cbl
 13362     MOVE '3'                    TO CNTL-REC-TYPE.
 13363     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13364     MOVE ZEROS                  TO CNTL-SEQ-NO.
 13365
 13366
 13367
 13368* EXEC CICS READ
 13369*        DATASET  (ELCNTL-DSID)
 13370*        SET      (ADDRESS OF CONTROL-FILE)
 13371*        RIDFLD   (ELCNTL-KEY)
 13372*        RESP     (WS-RESPONSE)
 13373*    END-EXEC.
 13374*    MOVE '&"S        E          (  N#00012172' TO DFHEIV0
 13375     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13376     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13377     MOVE X'204E233030303132313732' TO DFHEIV0(25:11)
 13378     CALL 'kxdfhei1' USING DFHEIV0,
 13379           ELCNTL-DSID,
 13380           DFHEIV20,
 13381           DFHEIV99,
 13382           ELCNTL-KEY,
 13383           DFHEIV99,
 13384           DFHEIV99,
 13385           DFHEIV99
 13386     SET ADDRESS OF CONTROL-FILE TO
 13387         DFHEIV20
 13388     MOVE EIBRESP  TO WS-RESPONSE
 13389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13390
 13391
 13392     IF WS-RESP-NOTFND
 13393          MOVE ER-2848           TO EMI-ERROR
 13394          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13395          GO TO 8100-SEND-INITIAL-MAP
 13396     END-IF.
 13397
 13398     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 13399     MOVE CF-ST-VFY-2ND-BENE TO PI-ST-VFY-2ND-BENE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 257
* EL130.cbl
 13401     IF CM-LF-BENEFIT-CD = '00'
 13402         MOVE ZEROS              TO LCVOTRMO
 13403                                    LCVRTRMO
 13404                                    LCVRATEO
 13405                                    LCVBENEO
 13406         MOVE SPACES             TO LCVDSCRO
 13407                                    LCVCDO
 13408                                    LCVKINDO
 13409                                    LCVFORMO
 13410                                    LCVCNDTO
 13411                                    LCVEXITO
 13412                                    LCVSTATO
 13413         IF CLMTYPEL GREATER THAN ZERO AND
 13414            CLMTYPEI = PI-LIFE-OVERRIDE-L1
 13415                MOVE ER-0521     TO EMI-ERROR
 13416                MOVE AL-UABON    TO CLMTYPEA
 13417                MOVE -1          TO CLMTYPEL
 13418                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13419                GO TO 7060-FILL-AH-COVERAGE
 13420         ELSE
 13421             GO TO 7060-FILL-AH-COVERAGE
 13422         END-IF
 13423     END-IF.
 13424
 13425     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 13426     MOVE AL-UANON               TO LCVDSCRA.
 13427     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-HOLD.
 13428     MOVE '4'                    TO WS-REC-TYPE.
 13429     PERFORM 7100-READ-BENEFIT THRU 7199-EXIT.
 13430     MOVE WS-BEN-ALPHA-HOLD      TO LCVKINDO.
 13431     MOVE CM-LF-BENEFIT-CD       TO LCVCDO.
 13432     MOVE AL-UANON               TO LCVCDA.
 13433     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO
 13434                                    CP-ORIGINAL-TERM.
 13435     MOVE AL-UNNON               TO LCVOTRMA.
 13436     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13437     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 13438     MOVE SAVE-CURRENT-DATE      TO CP-VALUATION-DT.
 13439     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 13440     MOVE '4'                    TO CP-REM-TERM-METHOD.
 13441     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 13442
 13443     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 13444     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 13445
 13446     IF CM-LF-PREMIUM-RATE NUMERIC
 13447         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 13448     ELSE
 13449         MOVE ZEROS              TO LCVRATEO
 13450     END-IF.
 13451
 13452     MOVE AL-UNNON               TO LCVRATEA.
 13453
 13454     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 13455         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT
 13456     END-IF.
 13457
 13458     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 258
* EL130.cbl
 13459
 13460     MOVE AL-UNNON               TO LCVBENEA.
 13461
 13462     IF CM-POLICY-FORM-NO NOT = SPACES
 13463         MOVE CM-POLICY-FORM-NO  TO LCVFORMO
 13464     ELSE
 13465         MOVE WS-FORM-HOLD       TO LCVFORMO
 13466     END-IF.
 13467
 13468     MOVE SPACES                 TO WS-FORM-HOLD.
 13469     MOVE 'L'                    TO WS-REC-TYPE.
 13470     PERFORM 7400-READ-STATE THRU 7499-EXIT.
 13471
 13472     IF WS-FORM-HOLD NOT = SPACES
 13473         MOVE WS-FORM-HOLD       TO LCVFORMO
 13474         MOVE AL-UANON           TO LCVFORMA
 13475     END-IF.
 13476
 13477     IF CM-LF-CURRENT-STATUS = '8'
 13478         IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 13479             MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 13480             MOVE ' '             TO DC-OPTION-CODE
 13481             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13482             IF NOT DATE-CONVERSION-ERROR
 13483                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
 13484                 MOVE AL-UANON            TO LCVCNDTA
 13485             END-IF
 13486         END-IF
 13487     END-IF.
 13488
 13489     IF CM-LF-CURRENT-STATUS = '7'
 13490         IF CM-LF-DEATH-DT NOT = LOW-VALUES
 13491             MOVE CM-LF-DEATH-DT TO DC-BIN-DATE-1
 13492             MOVE ' '            TO DC-OPTION-CODE
 13493             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13494             IF NOT DATE-CONVERSION-ERROR
 13495                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
 13496                 MOVE AL-UANON   TO LCVCNDTA
 13497             END-IF
 13498         END-IF
 13499     END-IF.
 13500
 13501     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 13502         IF CM-LF-DEATH-EXIT-DT NOT = SPACES
 13503             MOVE ' '            TO DC-OPTION-CODE
 13504             MOVE CM-LF-DEATH-EXIT-DT
 13505                                 TO DC-BIN-DATE-1
 13506             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13507             IF NOT DATE-CONVERSION-ERROR
 13508                 MOVE DC-GREG-DATE-1-EDIT
 13509                                 TO LCVEXITO
 13510             END-IF
 13511         END-IF
 13512     END-IF.
 13513
 13514     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 13515         IF CP-REMAINING-TERM-3 = ZEROS
 13516             MOVE 'EXPIRED'      TO LCVSTATO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 259
* EL130.cbl
 13517         ELSE
 13518             MOVE 'ACTIVE'       TO LCVSTATO
 13519         END-IF
 13520     END-IF.
 13521
 13522     IF CM-LF-CURRENT-STATUS = '2'
 13523        MOVE 'PEND  '            TO LCVSTATO
 13524     END-IF.
 13525     IF CM-LF-CURRENT-STATUS = '3'
 13526        MOVE 'RESTORE'           TO LCVSTATO
 13527     END-IF.
 13528     IF CM-LF-CURRENT-STATUS = '5'
 13529        MOVE 'REISSUE'           TO LCVSTATO
 13530     END-IF.
 13531     IF CM-LF-CURRENT-STATUS = '6'
 13532        MOVE 'LMP DIS'           TO LCVSTATO
 13533     END-IF.
 13534     IF CM-LF-CURRENT-STATUS = '7'
 13535        MOVE 'DEATH  '           TO LCVSTATO
 13536     END-IF.
 13537     IF CM-LF-CURRENT-STATUS = '8'
 13538        MOVE 'CANCEL '           TO LCVSTATO
 13539     END-IF.
 13540     IF CM-LF-CURRENT-STATUS = '9'
 13541        MOVE 'RE-ONLY'           TO LCVSTATO
 13542     END-IF.
 13543     IF CM-LF-CURRENT-STATUS = 'V'
 13544        MOVE 'VOID   '           TO LCVSTATO
 13545     END-IF.
 13546     IF CM-LF-CURRENT-STATUS = 'D'
 13547        MOVE 'DECLINE'           TO LCVSTATO
 13548     END-IF.
 13549
 13550     IF PI-COMPANY-ID = 'CID'
 13551         IF CM-LF-BENEFIT-CD >= '2O' AND
 13552            CM-LF-BENEFIT-CD <= '2V'
 13553             MOVE ER-0878       TO EMI-ERROR
 13554             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13555         END-IF
 13556     END-IF.
 13557
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 260
* EL130.cbl
 13559 7060-FILL-AH-COVERAGE.
 13560
 13561     IF CM-AH-BENEFIT-CD = '00'
 13562         MOVE ZEROS              TO ACVOTRMO
 13563                                    ACVRTRMO
 13564                                    ACVRATEO
 13565                                    ACVBENEO
 13566         MOVE SPACES             TO ACVDSCRO
 13567                                    ACVCDO
 13568                                    ACVKINDO
 13569                                    ACVFORMO
 13570                                    ACVCNDTO
 13571                                    ACVEXITO
 13572                                    ACVSTATO
 13573         IF (CLMTYPEL GREATER THAN ZERO AND
 13574             (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'))
 13575             MOVE ER-0521     TO EMI-ERROR
 13576             MOVE AL-UABON    TO CLMTYPEA
 13577             MOVE -1          TO CLMTYPEL
 13578             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13579             GO TO 7070-BUILD-MAP-FINISH
 13580         ELSE
 13581             GO TO 7070-BUILD-MAP-FINISH
 13582         END-IF
 13583     END-IF.
 13584
 13585     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 13586     MOVE CM-AH-BENEFIT-CD       TO ACVCDO WS-BEN-HOLD.
 13587     MOVE AL-UANON               TO ACVDSCRA
 13588                                    ACVCDA.
 13589     MOVE '5'                    TO WS-REC-TYPE.
 13590     PERFORM 7100-READ-BENEFIT THRU 7199-EXIT.
 13591     MOVE WS-BEN-ALPHA-HOLD      TO ACVKINDO.
 13592
 13593     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO
 13594                                    CP-ORIGINAL-TERM.
 13595     MOVE AL-UNNON               TO ACVOTRMA.
 13596
 13597     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13598     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 13599     MOVE SAVE-CURRENT-DATE      TO CP-VALUATION-DT.
 13600     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 13601     MOVE '4'                    TO CP-REM-TERM-METHOD.
 13602     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 13603
 13604     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 13605     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 13606
 13607     IF CM-AH-PREMIUM-RATE NUMERIC
 13608         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 13609     ELSE
 13610         MOVE ZEROS              TO ACVRATEO
 13611     END-IF.
 13612
 13613     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO.
 13614     MOVE AL-UNNON               TO ACVRATEA
 13615                                    ACVBENEA.
 13616
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 261
* EL130.cbl
 13617     IF CM-POLICY-FORM-NO NOT = SPACES
 13618         MOVE CM-POLICY-FORM-NO  TO ACVFORMO
 13619     ELSE
 13620         MOVE WS-FORM-HOLD       TO ACVFORMO
 13621         MOVE SPACES TO WS-FORM-HOLD
 13622         MOVE 'A'                TO WS-REC-TYPE
 13623         PERFORM 7400-READ-STATE THRU 7499-EXIT
 13624         IF WS-FORM-HOLD NOT = SPACES
 13625             MOVE WS-FORM-HOLD   TO ACVFORMO
 13626         END-IF
 13627     END-IF.
 13628
 13629     MOVE AL-UANON               TO ACVFORMA.
 13630
 13631     IF CM-AH-CURRENT-STATUS = '8'
 13632         IF CM-AH-CANCEL-DT NOT = LOW-VALUES
 13633             MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 13634             MOVE ' '             TO DC-OPTION-CODE
 13635             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13636             IF NOT DATE-CONVERSION-ERROR
 13637                MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
 13638                MOVE AL-UANON    TO ACVCNDTA
 13639             END-IF
 13640         END-IF
 13641     END-IF.
 13642
 13643     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 13644         IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 13645             MOVE CM-AH-SETTLEMENT-DT TO DC-BIN-DATE-1
 13646             MOVE ' '             TO DC-OPTION-CODE
 13647             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13648             IF NOT DATE-CONVERSION-ERROR
 13649                MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
 13650                MOVE AL-UANON            TO ACVCNDTA
 13651             END-IF
 13652         END-IF
 13653     END-IF.
 13654
 13655     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 13656         MOVE ' '                TO DC-OPTION-CODE
 13657         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 13658         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13659         IF NOT DATE-CONVERSION-ERROR
 13660             MOVE DC-GREG-DATE-1-EDIT TO ACVEXITO
 13661         END-IF
 13662     END-IF.
 13663
 13664     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 13665         IF CP-REMAINING-TERM-3 = ZEROS
 13666             MOVE 'EXPIRED'      TO ACVSTATO
 13667         ELSE
 13668             MOVE 'ACTIVE'       TO ACVSTATO
 13669         END-IF
 13670     END-IF.
 13671
 13672     IF CM-AH-CURRENT-STATUS = '2'
 13673         MOVE 'PEND  '           TO ACVSTATO
 13674     END-IF.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 262
* EL130.cbl
 13675     IF CM-AH-CURRENT-STATUS = '3'
 13676         MOVE 'RESTORE'          TO ACVSTATO
 13677     END-IF.
 13678     IF CM-AH-CURRENT-STATUS = '5'
 13679         MOVE 'REISSUE'          TO ACVSTATO
 13680     END-IF.
 13681     IF CM-AH-CURRENT-STATUS = '6'
 13682         MOVE 'LMP DIS'          TO ACVSTATO
 13683     END-IF.
 13684     IF CM-AH-CURRENT-STATUS = '7'
 13685         MOVE 'DEATH  '          TO ACVSTATO
 13686     END-IF.
 13687     IF CM-AH-CURRENT-STATUS = '8'
 13688         MOVE 'CANCEL '          TO ACVSTATO
 13689     END-IF.
 13690     IF CM-AH-CURRENT-STATUS = '9'
 13691         MOVE 'RE-ONLY'          TO ACVSTATO
 13692     END-IF.
 13693     IF CM-AH-CURRENT-STATUS = 'V'
 13694         MOVE 'VOID   '          TO ACVSTATO
 13695     END-IF.
 13696     IF CM-AH-CURRENT-STATUS = 'D'
 13697         MOVE 'DECLINE'          TO ACVSTATO
 13698     END-IF.
 13699
 13700     IF PI-COMPANY-ID = 'DCC'
 13701        IF CM-ACCOUNT (9:2) = 'BI'
 13702           MOVE CM-COMPANY-CD    TO CTRLR-COMP-CD
 13703           MOVE CM-CARRIER       TO CTRLR-CARRIER
 13704           MOVE CM-GROUPING      TO CTRLR-GROUPING
 13705           MOVE CM-STATE         TO CTRLR-STATE
 13706           MOVE CM-ACCOUNT       TO CTRLR-ACCOUNT
 13707           MOVE CM-CERT-EFF-DT   TO CTRLR-EFF-DT
 13708           MOVE CM-CERT-NO       TO CTRLR-CERT-NO
 13709           MOVE 'C'              TO CTRLR-REC-TYPE
 13710
 13711* EXEC CICS READ
 13712*            DATASET  (ELCRTT-DSID)
 13713*            SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 13714*            RIDFLD   (ELCRTT-KEY)
 13715*            RESP     (WS-RESPONSE)
 13716*          END-EXEC
 13717*    MOVE '&"S        E          (  N#00012497' TO DFHEIV0
 13718     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13719     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13720     MOVE X'204E233030303132343937' TO DFHEIV0(25:11)
 13721     CALL 'kxdfhei1' USING DFHEIV0,
 13722           ELCRTT-DSID,
 13723           DFHEIV20,
 13724           DFHEIV99,
 13725           ELCRTT-KEY,
 13726           DFHEIV99,
 13727           DFHEIV99,
 13728           DFHEIV99
 13729     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13730         DFHEIV20
 13731     MOVE EIBRESP  TO WS-RESPONSE
 13732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 263
* EL130.cbl
 13733           IF WS-RESP-NORMAL
 13734               MOVE CS-VIN-NUMBER   TO WS-DIAG-VIN
 13735               MOVE WS-DIAG-VIN-MSG TO DIAGO
 13736               MOVE AL-UANON        TO DIAGA
 13737           END-IF
 13738        END-IF
 13739     END-IF.
 13740
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 264
* EL130.cbl
 13742 7070-BUILD-MAP-FINISH.
 13743     MOVE CM-LOAN-APR            TO APRO.
 13744     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 13745     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 13746     MOVE CM-PREMIUM-TYPE        TO PREMTYPO.
 13747     MOVE AL-UNNON               TO APRA
 13748                                    PMTFREQA.
 13749     MOVE AL-UANON               TO INDGRPA
 13750                                    PREMTYPA.
 13751
 13752     IF (CM-SPECIAL-REIN-CODE NOT = SPACES AND LOW-VALUES)
 13753         MOVE CM-SPECIAL-REIN-CODE   TO REINCDO
 13754         MOVE AL-UANON               TO REINCDA
 13755     END-IF.
 13756
 13757     IF CM-LAST-ADD-ON-DT = SPACES OR LOW-VALUES
 13758*        NEXT SENTENCE
 13759         CONTINUE
 13760     ELSE
 13761         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 13762         MOVE ' '                TO DC-OPTION-CODE
 13763         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13764         IF NOT DATE-CONVERSION-ERROR
 13765             MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
 13766             MOVE AL-UANON            TO ADDONDTA
 13767         END-IF
 13768     END-IF.
 13769
 13770     IF CLAIM-SWITCH = 'N'
 13771         IF SEXL = ZEROS
 13772             MOVE CM-INSURED-SEX TO SEXO
 13773             MOVE AL-UANON       TO SEXA
 13774         END-IF
 13775     END-IF.
 13776
 13777     IF CM-MEMB-ACCOUNT NOT = CM-ACCOUNT-PRIME
 13778         MOVE CM-MEMBER-NO       TO MEMBERO
 13779         MOVE AL-UANON           TO MEMBERA
 13780     END-IF.
 13781
 13782     IF MAINTI = 'A'
 13783         IF (LOANNOL = ZEROS OR
 13784             EIBAID = DFHPF5)
 13785             MOVE CM-LOAN-NUMBER TO LOANNOO
 13786             MOVE AL-UANON       TO LOANNOA
 13787         ELSE
 13788*            NEXT SENTENCE
 13789             CONTINUE
 13790         END-IF
 13791     ELSE
 13792         MOVE CM-LOAN-NUMBER     TO LOANNOO
 13793         MOVE AL-UANON           TO LOANNOA
 13794     END-IF.
 13795
 13796     IF MAINTI = 'A'
 13797         IF (LOANBALL = ZEROS OR
 13798             EIBAID = DFHPF5)
 13799             MOVE CM-LOAN-BALANCE TO LOANBALO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 265
* EL130.cbl
 13800             MOVE AL-UNNON       TO LOANBALA
 13801         ELSE
 13802*            NEXT SENTENCE
 13803             CONTINUE
 13804         END-IF
 13805     ELSE
 13806         MOVE CM-LOAN-BALANCE    TO LOANBALO
 13807         MOVE AL-UNNON           TO LOANBALA
 13808     END-IF.
 13809
 13810     IF CM-PREMIUM-TYPE NOT = '3'
 13811         IF NOT CERT-WAS-CREATED-FOR-CLAIM
 13812             PERFORM 7200-PROTECT-CERT-FIELDS
 13813         ELSE
 13814             PERFORM 7300-RESET-KEY-ATTRBS
 13815         END-IF
 13816     ELSE
 13817         PERFORM 7300-RESET-KEY-ATTRBS
 13818     END-IF.
 13819
 13820*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 13821*        NEXT SENTENCE
 13822*        CONTINUE
 13823*    ELSE
 13824         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 13825*    END-IF.
 13826
 13827 7099-EXIT.
 13828     EXIT.
 13829
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 266
* EL130.cbl
 13831 7100-READ-BENEFIT.
 13832
 13833
 13834* EXEC CICS HANDLE CONDITION
 13835*         NOTFND   (7120-NOT-FOUND)
 13836*    END-EXEC.
 13837*    MOVE '"$I                   ! E #00012603' TO DFHEIV0
 13838     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13839     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13840     MOVE X'4520233030303132363033' TO DFHEIV0(25:11)
 13841     CALL 'kxdfhei1' USING DFHEIV0
 13842     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13843
 13844
 13845     MOVE SPACES                 TO ELCNTL-KEY.
 13846     MOVE WS-BEN-HOLD            TO CNTL-BENEFIT.
 13847     MOVE WS-REC-TYPE            TO CNTL-REC-TYPE.
 13848     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13849     MOVE ZEROS                  TO CNTL-SEQ-NO.
 13850
 13851 7105-READ-FILE.
 13852     PERFORM 7975-READ-CNTL-GTEQ THRU 7975-EXIT.
 13853
 13854     IF PI-COMPANY-ID NOT = CF-COMPANY-ID  OR
 13855        WS-REC-TYPE   NOT = CF-RECORD-TYPE
 13856          GO TO 7120-NOT-FOUND
 13857     END-IF.
 13858
 13859     MOVE 1                      TO SUB.
 13860 7110-LOOP.
 13861     IF SUB = 9
 13862         GO TO 7120-NOT-FOUND
 13863     END-IF.
 13864
 13865     IF WS-BEN-HOLD NOT = CF-BENEFIT-CODE (SUB)
 13866         ADD 1                   TO SUB
 13867         GO TO 7110-LOOP
 13868     END-IF.
 13869
 13870     MOVE CF-BENEFIT-ALPHA (SUB)    TO WS-BEN-ALPHA-HOLD.
 13871     MOVE CF-CO-EARNINGS-CALC (SUB) TO WS-EARNINGS-CALC.
 13872     MOVE CF-SPECIAL-CALC-CD (SUB)  TO WS-SPECIAL-CALC-CD.
 13873
 13874     GO TO 7199-EXIT.
 13875
 13876 7120-NOT-FOUND.
 13877     MOVE SPACES                 TO WS-BEN-ALPHA-HOLD
 13878                                    WS-FORM-HOLD.
 13879
 13880 7199-EXIT.
 13881      EXIT.
 13882
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 267
* EL130.cbl
 13884 7200-PROTECT-CERT-FIELDS.
 13885     MOVE AL-SANON           TO CERTMTA EFFDTA ACCOUNTA STATEA
 13886                                CRTCARRA GROUPA CRTLNMEA CRTFNMEA
 13887                                LCVFORMA ACVFORMA JNTLNMEA
 13888                                JNTFNMEA JNTINITA.
 13889
 13890     IF CM-LF-CURRENT-STATUS = '2' OR
 13891        CM-AH-CURRENT-STATUS = '2'
 13892         MOVE AL-SANON           TO LOANNOA LOANBALA PREMTYPA
 13893     END-IF.
 13894
 13895     MOVE AL-SANOF TO
 13896            CRTINITA   ISSAGEA    JNTAGEA    CRTSSNA   ADDONDTA
 13897            LCVDSCRA   LCVCDA     LCVOTRMA   LCVBENEA  LCVCNDTA
 13898            ACVDSCRA   ACVCDA     ACVOTRMA   ACVBENEA  ACVCNDTA
 13899            APRA       PMTFREQA   INDGRPA    MEMBERA   REINCDA
 13900            LCVRATEA   ACVRATEA.
 13901
 13902     MOVE 'S'                    TO CERTMTI.
 13903
 13904 7300-RESET-KEY-ATTRBS.
 13905     MOVE AL-UANON           TO CERTMTA EFFDTA ACCOUNTA STATEA
 13906                                CRTCARRA GROUPA CRTLNMEA CRTFNMEA
 13907                                LCVFORMA ACVFORMA JNTLNMEA
 13908                                JNTFNMEA JNTINITA.
 13909
 13910     IF NOT CERT-WAS-CREATED-FOR-CLAIM
 13911         MOVE AL-SANOF           TO REINCDA
 13912     END-IF.
 13913
 13914     MOVE 'S'                    TO CERTMTI.
 13915
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 268
* EL130.cbl
 13917 7400-READ-STATE.
 13918
 13919
 13920* EXEC CICS HANDLE CONDITION
 13921*         NOTFND   (7499-EXIT)
 13922*    END-EXEC.
 13923*    MOVE '"$I                   ! F #00012681' TO DFHEIV0
 13924     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13925     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13926     MOVE X'4620233030303132363831' TO DFHEIV0(25:11)
 13927     CALL 'kxdfhei1' USING DFHEIV0
 13928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13929
 13930
 13931     MOVE SPACES                 TO ELCNTL-KEY.
 13932     MOVE CM-STATE               TO CNTL-ACCESS.
 13933     MOVE '3'                    TO CNTL-REC-TYPE.
 13934     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13935     MOVE ZEROS                  TO CNTL-SEQ-NO.
 13936
 13937     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 13938
 13939     MOVE 1                      TO SUB.
 13940
 13941 7410-LOOP.
 13942     IF SUB = 21
 13943        GO TO 7499-EXIT
 13944     END-IF.
 13945
 13946*    IF (WS-BEN-HOLD  = CF-ST-BENEFIT-CD (SUB))  AND
 13947*       (WS-REC-TYPE  = CF-ST-BENEFIT-KIND (SUB))
 13948*        MOVE CF-ST-FORM-NO (SUB) TO WS-FORM-HOLD
 13949*        GO TO 7499-EXIT.
 13950
 13951     ADD 1                       TO SUB.
 13952     GO TO 7410-LOOP.
 13953
 13954 7499-EXIT.
 13955      EXIT.
 13956
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 269
* EL130.cbl
 13958 7500-BROWSE-FOR-DUPLICATE.
 13959
 13960     MOVE 'N'                    TO INCUR-DTE-DUPE-SW.
 13961
 13962
 13963
 13964* EXEC CICS HANDLE CONDITION
 13965*        NOTFND   (7500-EXIT)
 13966*        DUPKEY   (7500-DUPLICATE-KEY)
 13967*        ENDFILE  (7500-EXIT)
 13968*    END-EXEC.
 13969*    MOVE '"$I$''                 ! G #00012717' TO DFHEIV0
 13970     MOVE X'222449242720202020202020' TO DFHEIV0(1:12)
 13971     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13972     MOVE X'4720233030303132373137' TO DFHEIV0(25:11)
 13973     CALL 'kxdfhei1' USING DFHEIV0
 13974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13975
 13976
 13977
 13978
 13979* EXEC CICS STARTBR
 13980*        DATASET    (ELMSTR5-DSID)
 13981*        RIDFLD     (ELMSTR5-KEY)
 13982*    END-EXEC.
 13983     MOVE 0
 13984       TO DFHEIV11
 13985*    MOVE '&,         G          &   #00012724' TO DFHEIV0
 13986     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13987     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13988     MOVE X'2020233030303132373234' TO DFHEIV0(25:11)
 13989     CALL 'kxdfhei1' USING DFHEIV0,
 13990           ELMSTR5-DSID,
 13991           ELMSTR5-KEY,
 13992           DFHEIV99,
 13993           DFHEIV11,
 13994           DFHEIV99
 13995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13996
 13997
 13998
 13999
 14000* EXEC CICS HANDLE CONDITION
 14001*        ENDFILE  (7500-END-BROWSE)
 14002*    END-EXEC.
 14003*    MOVE '"$''                   ! H #00012730' TO DFHEIV0
 14004     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 14005     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14006     MOVE X'4820233030303132373330' TO DFHEIV0(25:11)
 14007     CALL 'kxdfhei1' USING DFHEIV0
 14008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14009
 14010
 14011 7500-READ-CLAIM-LOOP.
 14012
 14013
 14014
 14015* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 270
* EL130.cbl
 14016*        DATASET   (ELMSTR5-DSID)
 14017*        SET       (ADDRESS OF CLAIM-MASTER)
 14018*        RIDFLD    (ELMSTR5-KEY)
 14019*    END-EXEC.
 14020     MOVE 0
 14021       TO DFHEIV11
 14022*    MOVE '&.S                   )   #00012737' TO DFHEIV0
 14023     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14024     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14025     MOVE X'2020233030303132373337' TO DFHEIV0(25:11)
 14026     CALL 'kxdfhei1' USING DFHEIV0,
 14027           ELMSTR5-DSID,
 14028           DFHEIV20,
 14029           DFHEIV99,
 14030           ELMSTR5-KEY,
 14031           DFHEIV99,
 14032           DFHEIV11,
 14033           DFHEIV99,
 14034           DFHEIV99
 14035     SET ADDRESS OF CLAIM-MASTER TO
 14036         DFHEIV20
 14037     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14038
 14039
 14040 7500-DUPLICATE-KEY.
 14041
 14042     IF CL-COMPANY-CD     NOT = CM-COMPANY-CD  OR
 14043        CL-CERT-CARRIER   NOT = CM-CARRIER     OR
 14044        CL-CERT-GROUPING  NOT = CM-GROUPING    OR
 14045        CL-CERT-STATE     NOT = CM-STATE       OR
 14046        CL-CERT-ACCOUNT   NOT = CM-ACCOUNT     OR
 14047        CL-CERT-EFF-DT    NOT = CM-CERT-EFF-DT OR
 14048        CL-CERT-NO        NOT = CM-CERT-NO
 14049           GO TO 7500-CHECK-MATCH-COUNT
 14050     END-IF.
 14051
 14052     MOVE 'H'                    TO INCUR-DTE-DUPE-SW.
 14053
 14054     IF CL-INCURRED-DT = PI-SAVE-INCUR-DT
 14055        MOVE 'Y'                 TO INCUR-DTE-DUPE-SW
 14056        GO TO 7500-END-BROWSE
 14057     ELSE
 14058        GO TO 7500-READ-CLAIM-LOOP
 14059     END-IF.
 14060
 14061 7500-CHECK-MATCH-COUNT.
 14062
 14063     IF CL-COMPANY-CD = CM-COMPANY-CD AND
 14064        CL-CERT-NO    = CM-CERT-NO
 14065          GO TO 7500-READ-CLAIM-LOOP
 14066     END-IF.
 14067
 14068 7500-END-BROWSE.
 14069
 14070
 14071
 14072* EXEC CICS ENDBR
 14073*        DATASET   (ELMSTR5-DSID)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 271
* EL130.cbl
 14074*    END-EXEC.
 14075     MOVE 0
 14076       TO DFHEIV11
 14077*    MOVE '&2                    $   #00012774' TO DFHEIV0
 14078     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14079     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14080     MOVE X'2020233030303132373734' TO DFHEIV0(25:11)
 14081     CALL 'kxdfhei1' USING DFHEIV0,
 14082           ELMSTR5-DSID,
 14083           DFHEIV11,
 14084           DFHEIV99
 14085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14086
 14087
 14088 7500-EXIT.
 14089     EXIT.
 14090
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 272
* EL130.cbl
 14092 7550-FALL-THRU-PARA.
 14093
 14094
 14095
 14096* EXEC CICS DUMP
 14097*         DUMPCODE ('E130')
 14098*         TASK
 14099*    END-EXEC.
 14100     MOVE 'E130' TO DFHEIV5
 14101*    MOVE '<"   T                $   #00012785' TO DFHEIV0
 14102     MOVE X'3C2220202054202020202020' TO DFHEIV0(1:12)
 14103     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14104     MOVE X'2020233030303132373835' TO DFHEIV0(25:11)
 14105     CALL 'kxdfhei1' USING DFHEIV0,
 14106           DFHEIV5,
 14107           DFHEIV99,
 14108           DFHEIV99
 14109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14110
 14111
 14112
 14113
 14114* EXEC CICS RETURN
 14115*    END-EXEC.
 14116*    MOVE '.(                    &   #00012791' TO DFHEIV0
 14117     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 14118     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14119     MOVE X'2020233030303132373931' TO DFHEIV0(25:11)
 14120     CALL 'kxdfhei1' USING DFHEIV0,
 14121           DFHEIV99,
 14122           DFHEIV99,
 14123           DFHEIV99,
 14124           DFHEIV99,
 14125           DFHEIV99
 14126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14127
 14128
 14129 7600-BROWSE-CLAIM.
 14130
 14131
 14132
 14133* EXEC CICS READ
 14134*        DATASET(ELMSTR-DSID)
 14135*        SET    (ADDRESS OF CLAIM-MASTER)
 14136*        RIDFLD (ELMSTR-KEY)
 14137*        GENERIC
 14138*        EQUAL
 14139*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 14140*    END-EXEC.
 14141*    MOVE '&"S  KG    E          (   #00012797' TO DFHEIV0
 14142     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 14143     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14144     MOVE X'2020233030303132373937' TO DFHEIV0(25:11)
 14145     CALL 'kxdfhei1' USING DFHEIV0,
 14146           ELMSTR-DSID,
 14147           DFHEIV20,
 14148           DFHEIV99,
 14149           ELMSTR-KEY,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 273
* EL130.cbl
 14150           ELMSTR-GENERIC-LENGTH,
 14151           DFHEIV99,
 14152           DFHEIV99
 14153     SET ADDRESS OF CLAIM-MASTER TO
 14154         DFHEIV20
 14155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14156
 14157
 14158     MOVE CL-CERT-PRIME          TO CERTNOI.
 14159     MOVE CL-CERT-SFX            TO SUFXI.
 14160
 14161 7610-BROWSE-CLAIM-LOOP.
 14162
 14163     MOVE LOW-VALUES             TO BCERT1O
 14164                                    BSUFX1O
 14165                                    BCERT2O
 14166                                    BSUFX2O
 14167                                    BCERT3O
 14168                                    BSUFX3O
 14169                                    BCERT4O
 14170                                    BSUFX4O
 14171                                    BCERT5O
 14172                                    BSUFX5O.
 14173
 14174     MOVE ELMSTR-KEY             TO SAVE-ELMSTR-KEY.
 14175
 14176
 14177
 14178* EXEC CICS HANDLE CONDITION
 14179*        ENDFILE  (7630-END-BROWSE)
 14180*    END-EXEC.
 14181*    MOVE '"$''                   ! I #00012825' TO DFHEIV0
 14182     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 14183     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14184     MOVE X'4920233030303132383235' TO DFHEIV0(25:11)
 14185     CALL 'kxdfhei1' USING DFHEIV0
 14186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14187
 14188
 14189
 14190
 14191* EXEC CICS STARTBR
 14192*        DATASET    (ELMSTR-DSID)
 14193*        RIDFLD     (ELMSTR-KEY)
 14194*    END-EXEC.
 14195     MOVE 0
 14196       TO DFHEIV11
 14197*    MOVE '&,         G          &   #00012830' TO DFHEIV0
 14198     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14199     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14200     MOVE X'2020233030303132383330' TO DFHEIV0(25:11)
 14201     CALL 'kxdfhei1' USING DFHEIV0,
 14202           ELMSTR-DSID,
 14203           ELMSTR-KEY,
 14204           DFHEIV99,
 14205           DFHEIV11,
 14206           DFHEIV99
 14207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 274
* EL130.cbl
 14208
 14209
 14210     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 14211
 14212 7620-READ-CLAIM-LOOP.
 14213
 14214
 14215
 14216* EXEC CICS READNEXT
 14217*        DATASET   (ELMSTR-DSID)
 14218*        SET       (ADDRESS OF CLAIM-MASTER)
 14219*        RIDFLD    (ELMSTR-KEY)
 14220*    END-EXEC.
 14221     MOVE 0
 14222       TO DFHEIV11
 14223*    MOVE '&.S                   )   #00012840' TO DFHEIV0
 14224     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14225     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14226     MOVE X'2020233030303132383430' TO DFHEIV0(25:11)
 14227     CALL 'kxdfhei1' USING DFHEIV0,
 14228           ELMSTR-DSID,
 14229           DFHEIV20,
 14230           DFHEIV99,
 14231           ELMSTR-KEY,
 14232           DFHEIV99,
 14233           DFHEIV11,
 14234           DFHEIV99,
 14235           DFHEIV99
 14236     SET ADDRESS OF CLAIM-MASTER TO
 14237         DFHEIV20
 14238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14239
 14240
 14241     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD  OR
 14242        CL-CARRIER     NOT = CLMCARRI       OR
 14243        CL-CLAIM-NO    NOT = CLMNOI
 14244          GO TO 7630-END-BROWSE
 14245     END-IF.
 14246
 14247     IF WS-ASSOCIATED-CERTS = 1
 14248         MOVE CL-CERT-PRIME      TO BCERT1O
 14249         MOVE CL-CERT-SFX        TO BSUFX1O
 14250     END-IF.
 14251
 14252     IF WS-ASSOCIATED-CERTS = 2
 14253         MOVE CL-CERT-PRIME      TO BCERT2O
 14254         MOVE CL-CERT-SFX        TO BSUFX2O
 14255     END-IF.
 14256
 14257     IF WS-ASSOCIATED-CERTS = 3
 14258         MOVE CL-CERT-PRIME      TO BCERT3O
 14259         MOVE CL-CERT-SFX        TO BSUFX3O
 14260     END-IF.
 14261
 14262     IF WS-ASSOCIATED-CERTS = 4
 14263         MOVE CL-CERT-PRIME      TO BCERT4O
 14264         MOVE CL-CERT-SFX        TO BSUFX4O
 14265     END-IF.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 275
* EL130.cbl
 14266
 14267     IF WS-ASSOCIATED-CERTS = 5
 14268         MOVE CL-CERT-PRIME      TO BCERT5O
 14269         MOVE CL-CERT-SFX        TO BSUFX5O
 14270     ELSE
 14271         ADD +1                  TO WS-ASSOCIATED-CERTS
 14272         GO TO 7620-READ-CLAIM-LOOP
 14273     END-IF.
 14274
 14275 7630-END-BROWSE.
 14276
 14277
 14278
 14279* EXEC CICS ENDBR
 14280*        DATASET   (ELMSTR-DSID)
 14281*    END-EXEC.
 14282     MOVE 0
 14283       TO DFHEIV11
 14284*    MOVE '&2                    $   #00012883' TO DFHEIV0
 14285     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14286     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14287     MOVE X'2020233030303132383833' TO DFHEIV0(25:11)
 14288     CALL 'kxdfhei1' USING DFHEIV0,
 14289           ELMSTR-DSID,
 14290           DFHEIV11,
 14291           DFHEIV99
 14292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14293
 14294
 14295 7640-HIGHLIGHT-CERT-DISPLAYED.
 14296
 14297     MOVE SAVE-ELMSTR-KEY        TO ELMSTR-KEY.
 14298     MOVE AL-SANON               TO BCERT1A
 14299                                    BSUFX1A
 14300                                    BCERT2A
 14301                                    BSUFX2A
 14302                                    BCERT3A
 14303                                    BSUFX3A
 14304                                    BCERT4A
 14305                                    BSUFX4A
 14306                                    BCERT5A
 14307                                    BSUFX5A.
 14308
 14309     IF BCERT1O = CERTNOI AND
 14310        BSUFX1O = SUFXI
 14311            MOVE AL-SABON        TO BCERT1A
 14312                                    BSUFX1A
 14313     END-IF.
 14314
 14315     IF BCERT2O = CERTNOI AND
 14316        BSUFX2O = SUFXI
 14317            MOVE AL-SABON        TO BCERT2A
 14318                                    BSUFX2A
 14319     END-IF.
 14320
 14321     IF BCERT3O = CERTNOI AND
 14322        BSUFX3O = SUFXI
 14323            MOVE AL-SABON        TO BCERT3A
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 276
* EL130.cbl
 14324                                    BSUFX3A
 14325     END-IF.
 14326
 14327     IF BCERT4O = CERTNOI AND
 14328        BSUFX4O = SUFXI
 14329            MOVE AL-SABON        TO BCERT4A
 14330                                    BSUFX4A
 14331     END-IF.
 14332
 14333     IF BCERT5O = CERTNOI AND
 14334        BSUFX5O = SUFXI
 14335            MOVE AL-SABON        TO BCERT5A
 14336                                    BSUFX5A
 14337     END-IF.
 14338
 14339 7699-EXIT.
 14340     EXIT.
 14341
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 277
* EL130.cbl
 14343 7700-CHECK-SEQUENCE.
 14344
 14345
 14346
 14347* EXEC CICS HANDLE CONDITION
 14348*        ENDFILE  (7799-EXIT)
 14349*        NOTFND   (7799-EXIT)
 14350*    END-EXEC.
 14351*    MOVE '"$''I                  ! J #00012938' TO DFHEIV0
 14352     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 14353     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14354     MOVE X'4A20233030303132393338' TO DFHEIV0(25:11)
 14355     CALL 'kxdfhei1' USING DFHEIV0
 14356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14357
 14358
 14359
 14360
 14361* EXEC CICS READ
 14362*        DATASET(ELMSTR-DSID)
 14363*        SET    (ADDRESS OF CLAIM-MASTER)
 14364*        RIDFLD (ELMSTR-KEY)
 14365*        GENERIC
 14366*        EQUAL
 14367*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 14368*    END-EXEC.
 14369*    MOVE '&"S  KG    E          (   #00012944' TO DFHEIV0
 14370     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 14371     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14372     MOVE X'2020233030303132393434' TO DFHEIV0(25:11)
 14373     CALL 'kxdfhei1' USING DFHEIV0,
 14374           ELMSTR-DSID,
 14375           DFHEIV20,
 14376           DFHEIV99,
 14377           ELMSTR-KEY,
 14378           ELMSTR-GENERIC-LENGTH,
 14379           DFHEIV99,
 14380           DFHEIV99
 14381     SET ADDRESS OF CLAIM-MASTER TO
 14382         DFHEIV20
 14383     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14384
 14385
 14386     COMPUTE WS-ASSOC-CERT-TOTAL =
 14387             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 14388
 14389     GO TO 7799-EXIT.
 14390
 14391 7710-RESEQUENCE-CLAIMS.
 14392
 14393
 14394
 14395* EXEC CICS HANDLE CONDITION
 14396*        ENDFILE  (7790-END-BROWSE)
 14397*    END-EXEC.
 14398*    MOVE '"$''                   ! K #00012961' TO DFHEIV0
 14399     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 14400     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 278
* EL130.cbl
 14401     MOVE X'4B20233030303132393631' TO DFHEIV0(25:11)
 14402     CALL 'kxdfhei1' USING DFHEIV0
 14403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14404
 14405
 14406
 14407
 14408* EXEC CICS STARTBR
 14409*        DATASET    (ELMSTR-DSID)
 14410*        RIDFLD     (ELMSTR-KEY)
 14411*    END-EXEC.
 14412     MOVE 0
 14413       TO DFHEIV11
 14414*    MOVE '&,         G          &   #00012966' TO DFHEIV0
 14415     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14416     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14417     MOVE X'2020233030303132393636' TO DFHEIV0(25:11)
 14418     CALL 'kxdfhei1' USING DFHEIV0,
 14419           ELMSTR-DSID,
 14420           ELMSTR-KEY,
 14421           DFHEIV99,
 14422           DFHEIV11,
 14423           DFHEIV99
 14424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14425
 14426
 14427     ADD +1 TO WS-ASSOC-CERT-SEQU
 14428               WS-READNEXT-SWITCH.
 14429
 14430 7720-READ-CLAIM-LOOP.
 14431
 14432
 14433
 14434* EXEC CICS READNEXT
 14435*        DATASET   (ELMSTR-DSID)
 14436*        SET       (ADDRESS OF CLAIM-MASTER)
 14437*        RIDFLD    (ELMSTR-KEY)
 14438*    END-EXEC.
 14439     MOVE 0
 14440       TO DFHEIV11
 14441*    MOVE '&.S                   )   #00012977' TO DFHEIV0
 14442     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14443     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14444     MOVE X'2020233030303132393737' TO DFHEIV0(25:11)
 14445     CALL 'kxdfhei1' USING DFHEIV0,
 14446           ELMSTR-DSID,
 14447           DFHEIV20,
 14448           DFHEIV99,
 14449           ELMSTR-KEY,
 14450           DFHEIV99,
 14451           DFHEIV11,
 14452           DFHEIV99,
 14453           DFHEIV99
 14454     SET ADDRESS OF CLAIM-MASTER TO
 14455         DFHEIV20
 14456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14457
 14458
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 279
* EL130.cbl
 14459     IF WS-READNEXT-SWITCH = 1
 14460         ADD 1 TO WS-READNEXT-SWITCH
 14461         GO TO 7720-READ-CLAIM-LOOP
 14462     END-IF.
 14463
 14464 7730-END-BROWSE.
 14465
 14466
 14467
 14468* EXEC CICS ENDBR
 14469*        DATASET   (ELMSTR-DSID)
 14470*    END-EXEC.
 14471     MOVE 0
 14472       TO DFHEIV11
 14473*    MOVE '&2                    $   #00012991' TO DFHEIV0
 14474     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14475     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14476     MOVE X'2020233030303132393931' TO DFHEIV0(25:11)
 14477     CALL 'kxdfhei1' USING DFHEIV0,
 14478           ELMSTR-DSID,
 14479           DFHEIV11,
 14480           DFHEIV99
 14481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14482
 14483
 14484 7740-READ-CLAIM-UPDATE.
 14485
 14486     IF CL-COMPANY-CD NOT = WS-SAVE-COMPANY-CD OR
 14487        CL-CARRIER    NOT = WS-SAVE-CARRIER    OR
 14488        CL-CLAIM-NO   NOT = WS-SAVE-CLAIM-NO
 14489          GO TO 7799-EXIT
 14490     ELSE
 14491          MOVE ZERO              TO WS-READNEXT-SWITCH
 14492     END-IF.
 14493
 14494
 14495
 14496* EXEC CICS READ
 14497*        DATASET(ELMSTR-DSID)
 14498*        SET    (ADDRESS OF CLAIM-MASTER)
 14499*        RIDFLD (ELMSTR-KEY)
 14500*        UPDATE
 14501*    END-EXEC.
 14502*    MOVE '&"S        EU         (   #00013006' TO DFHEIV0
 14503     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14504     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14505     MOVE X'2020233030303133303036' TO DFHEIV0(25:11)
 14506     CALL 'kxdfhei1' USING DFHEIV0,
 14507           ELMSTR-DSID,
 14508           DFHEIV20,
 14509           DFHEIV99,
 14510           ELMSTR-KEY,
 14511           DFHEIV99,
 14512           DFHEIV99,
 14513           DFHEIV99
 14514     SET ADDRESS OF CLAIM-MASTER TO
 14515         DFHEIV20
 14516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 280
* EL130.cbl
 14517
 14518
 14519     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 14520     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 14521
 14522
 14523
 14524* EXEC CICS REWRITE
 14525*         DATASET     (ELMSTR-DSID)
 14526*         FROM        (CLAIM-MASTER)
 14527*    END-EXEC.
 14528     MOVE LENGTH OF
 14529      CLAIM-MASTER
 14530       TO DFHEIV11
 14531*    MOVE '&& L                  %   #00013017' TO DFHEIV0
 14532     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14533     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14534     MOVE X'2020233030303133303137' TO DFHEIV0(25:11)
 14535     CALL 'kxdfhei1' USING DFHEIV0,
 14536           ELMSTR-DSID,
 14537           CLAIM-MASTER,
 14538           DFHEIV11,
 14539           DFHEIV99
 14540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14541
 14542
 14543     GO TO 7710-RESEQUENCE-CLAIMS.
 14544
 14545 7790-END-BROWSE.
 14546
 14547
 14548
 14549* EXEC CICS ENDBR
 14550*        DATASET   (ELMSTR-DSID)
 14551*    END-EXEC.
 14552     MOVE 0
 14553       TO DFHEIV11
 14554*    MOVE '&2                    $   #00013027' TO DFHEIV0
 14555     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14556     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14557     MOVE X'2020233030303133303237' TO DFHEIV0(25:11)
 14558     CALL 'kxdfhei1' USING DFHEIV0,
 14559           ELMSTR-DSID,
 14560           DFHEIV11,
 14561           DFHEIV99
 14562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14563
 14564
 14565 7799-EXIT.
 14566     EXIT.
 14567
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 281
* EL130.cbl
 14569************************************************
 14570*  I/O REQUESTS AGAINST ACTIVITY TRAILER FILE  *
 14571************************************************
 14572
 14573 7900-READ-ACTV-UPDATE.
 14574     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 14575     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 14576     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 14577     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 14578     MOVE +0                     TO TRLR-SEQ-NO.
 14579     MOVE '1'                    TO TRLR-TYPE.
 14580     GO TO 7900-READ-TRAILER-UPDATE.
 14581
 14582 7900-READ-NINETY-UPDATE.
 14583     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 14584     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 14585     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 14586     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 14587     MOVE +90                    TO TRLR-SEQ-NO.
 14588     MOVE '6'                    TO TRLR-TYPE.
 14589
 14590 7900-READ-TRAILER-UPDATE.
 14591
 14592
 14593* EXEC CICS READ  UPDATE
 14594*        DATASET    (ELTRLR-DSID)
 14595*        SET        (ADDRESS OF ACTIVITY-TRAILERS)
 14596*        RIDFLD     (ELTRLR-KEY)
 14597*    END-EXEC.
 14598*    MOVE '&"S        EU         (   #00013058' TO DFHEIV0
 14599     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14600     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14601     MOVE X'2020233030303133303538' TO DFHEIV0(25:11)
 14602     CALL 'kxdfhei1' USING DFHEIV0,
 14603           ELTRLR-DSID,
 14604           DFHEIV20,
 14605           DFHEIV99,
 14606           ELTRLR-KEY,
 14607           DFHEIV99,
 14608           DFHEIV99,
 14609           DFHEIV99
 14610     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14611         DFHEIV20
 14612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14613
 14614
 14615 7900-EXIT.
 14616      EXIT.
 14617
 14618 7910-READ-ACTV.
 14619     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 14620     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 14621     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 14622     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 14623     MOVE +0                     TO TRLR-SEQ-NO.
 14624     MOVE '1'                    TO TRLR-TYPE.
 14625     GO TO 7910-READ-TRAILER.
 14626
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 282
* EL130.cbl
 14627 7910-READ-NINETY.
 14628     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 14629     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 14630     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 14631     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 14632     MOVE +90                    TO TRLR-SEQ-NO.
 14633     MOVE '6'                    TO TRLR-TYPE.
 14634
 14635 7910-READ-TRAILER.
 14636     MOVE 'TRLR'                 TO FILE-SWITCH.
 14637
 14638
 14639
 14640* EXEC CICS READ
 14641*        DATASET   (ELTRLR-DSID)
 14642*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 14643*        RIDFLD    (ELTRLR-KEY)
 14644*    END-EXEC.
 14645*    MOVE '&"S        E          (   #00013088' TO DFHEIV0
 14646     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14647     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14648     MOVE X'2020233030303133303838' TO DFHEIV0(25:11)
 14649     CALL 'kxdfhei1' USING DFHEIV0,
 14650           ELTRLR-DSID,
 14651           DFHEIV20,
 14652           DFHEIV99,
 14653           ELTRLR-KEY,
 14654           DFHEIV99,
 14655           DFHEIV99,
 14656           DFHEIV99
 14657     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14658         DFHEIV20
 14659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14660
 14661
 14662 7910-EXIT.
 14663      EXIT.
 14664
 14665 7915-REWRITE-TRAILER.
 14666
 14667
 14668* EXEC CICS REWRITE
 14669*        DATASET   (ELTRLR-DSID)
 14670*        FROM      (ACTIVITY-TRAILERS)
 14671*    END-EXEC.
 14672     MOVE LENGTH OF
 14673      ACTIVITY-TRAILERS
 14674       TO DFHEIV11
 14675*    MOVE '&& L                  %   #00013099' TO DFHEIV0
 14676     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14677     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14678     MOVE X'2020233030303133303939' TO DFHEIV0(25:11)
 14679     CALL 'kxdfhei1' USING DFHEIV0,
 14680           ELTRLR-DSID,
 14681           ACTIVITY-TRAILERS,
 14682           DFHEIV11,
 14683           DFHEIV99
 14684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 283
* EL130.cbl
 14685
 14686
 14687 7915-EXIT.
 14688      EXIT.
 14689
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 284
* EL130.cbl
 14691********************************************
 14692*  I/O REQUESTS AGAINST CLAIM MASTER FILE  *
 14693********************************************
 14694
 14695 7920-READ-CLAIM-UPDATE.
 14696
 14697
 14698
 14699* EXEC CICS READ
 14700*        UPDATE
 14701*        DATASET   (ELMSTR-DSID)
 14702*        SET       (ADDRESS OF CLAIM-MASTER)
 14703*        RIDFLD    (ELMSTR-KEY)
 14704*    END-EXEC.
 14705*    MOVE '&"S        EU         (   #00013115' TO DFHEIV0
 14706     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14707     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14708     MOVE X'2020233030303133313135' TO DFHEIV0(25:11)
 14709     CALL 'kxdfhei1' USING DFHEIV0,
 14710           ELMSTR-DSID,
 14711           DFHEIV20,
 14712           DFHEIV99,
 14713           ELMSTR-KEY,
 14714           DFHEIV99,
 14715           DFHEIV99,
 14716           DFHEIV99
 14717     SET ADDRESS OF CLAIM-MASTER TO
 14718         DFHEIV20
 14719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14720
 14721
 14722 7920-EXIT.
 14723      EXIT.
 14724
 14725 7950-READ-CLAIM.
 14726
 14727
 14728* EXEC CICS READ
 14729*        DATASET   (ELMSTR-DSID)
 14730*        SET       (ADDRESS OF CLAIM-MASTER)
 14731*        RIDFLD    (ELMSTR-KEY)
 14732*    END-EXEC.
 14733*    MOVE '&"S        E          (   #00013127' TO DFHEIV0
 14734     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14735     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14736     MOVE X'2020233030303133313237' TO DFHEIV0(25:11)
 14737     CALL 'kxdfhei1' USING DFHEIV0,
 14738           ELMSTR-DSID,
 14739           DFHEIV20,
 14740           DFHEIV99,
 14741           ELMSTR-KEY,
 14742           DFHEIV99,
 14743           DFHEIV99,
 14744           DFHEIV99
 14745     SET ADDRESS OF CLAIM-MASTER TO
 14746         DFHEIV20
 14747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14748
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 285
* EL130.cbl
 14749
 14750 7950-EXIT.
 14751      EXIT.
 14752
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 286
* EL130.cbl
 14754***************************************
 14755*  I/O REQUESTS AGAINST CONTROL FILE  *
 14756***************************************
 14757
 14758 7960-READ-CNTL-UPDATE.
 14759
 14760
 14761* EXEC CICS READ
 14762*        UPDATE
 14763*        DATASET  (ELCNTL-DSID)
 14764*        SET      (ADDRESS OF CONTROL-FILE)
 14765*        RIDFLD   (ELCNTL-KEY)
 14766*    END-EXEC.
 14767*    MOVE '&"S        EU         (   #00013143' TO DFHEIV0
 14768     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14769     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14770     MOVE X'2020233030303133313433' TO DFHEIV0(25:11)
 14771     CALL 'kxdfhei1' USING DFHEIV0,
 14772           ELCNTL-DSID,
 14773           DFHEIV20,
 14774           DFHEIV99,
 14775           ELCNTL-KEY,
 14776           DFHEIV99,
 14777           DFHEIV99,
 14778           DFHEIV99
 14779     SET ADDRESS OF CONTROL-FILE TO
 14780         DFHEIV20
 14781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14782
 14783
 14784 7960-EXIT.
 14785      EXIT.
 14786
 14787 7970-READ-CNTL.
 14788
 14789
 14790* EXEC CICS READ
 14791*        DATASET  (ELCNTL-DSID)
 14792*        SET      (ADDRESS OF CONTROL-FILE)
 14793*        RIDFLD   (ELCNTL-KEY)
 14794*    END-EXEC.
 14795*    MOVE '&"S        E          (   #00013155' TO DFHEIV0
 14796     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14797     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14798     MOVE X'2020233030303133313535' TO DFHEIV0(25:11)
 14799     CALL 'kxdfhei1' USING DFHEIV0,
 14800           ELCNTL-DSID,
 14801           DFHEIV20,
 14802           DFHEIV99,
 14803           ELCNTL-KEY,
 14804           DFHEIV99,
 14805           DFHEIV99,
 14806           DFHEIV99
 14807     SET ADDRESS OF CONTROL-FILE TO
 14808         DFHEIV20
 14809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14810
 14811
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 287
* EL130.cbl
 14812 7970-EXIT.
 14813      EXIT.
 14814
 14815 7975-READ-CNTL-GTEQ.
 14816
 14817
 14818* EXEC CICS READ
 14819*         DATASET   (ELCNTL-DSID)
 14820*         SET       (ADDRESS OF CONTROL-FILE)
 14821*         RIDFLD    (ELCNTL-KEY)
 14822*         GTEQ
 14823*     END-EXEC.
 14824*    MOVE '&"S        G          (   #00013166' TO DFHEIV0
 14825     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14826     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14827     MOVE X'2020233030303133313636' TO DFHEIV0(25:11)
 14828     CALL 'kxdfhei1' USING DFHEIV0,
 14829           ELCNTL-DSID,
 14830           DFHEIV20,
 14831           DFHEIV99,
 14832           ELCNTL-KEY,
 14833           DFHEIV99,
 14834           DFHEIV99,
 14835           DFHEIV99
 14836     SET ADDRESS OF CONTROL-FILE TO
 14837         DFHEIV20
 14838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14839
 14840
 14841 7975-EXIT.
 14842      EXIT.
 14843
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 288
* EL130.cbl
 14845**************************************************
 14846*  I/O REQUESTS AGAINST CERTIFICATE MASTER FILE  *
 14847**************************************************
 14848
 14849 7980-READ-CERT5.
 14850
 14851
 14852* EXEC CICS READ
 14853*         DATASET  (ELCERT5-DSID)
 14854*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 14855*         RIDFLD   (ELCERT-KEY-5)
 14856*     END-EXEC.
 14857*    MOVE '&"S        E          (   #00013183' TO DFHEIV0
 14858     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14859     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14860     MOVE X'2020233030303133313833' TO DFHEIV0(25:11)
 14861     CALL 'kxdfhei1' USING DFHEIV0,
 14862           ELCERT5-DSID,
 14863           DFHEIV20,
 14864           DFHEIV99,
 14865           ELCERT-KEY-5,
 14866           DFHEIV99,
 14867           DFHEIV99,
 14868           DFHEIV99
 14869     SET ADDRESS OF CERTIFICATE-MASTER TO
 14870         DFHEIV20
 14871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14872
 14873
 14874 7980-EXIT.
 14875      EXIT.
 14876
 14877 7930-READ-CERT-UPDATE.
 14878
 14879
 14880* EXEC CICS READ
 14881*        DATASET  (ELCERT-DSID)
 14882*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 14883*        RIDFLD   (ELCERT-KEY)
 14884*        UPDATE
 14885*    END-EXEC.
 14886*    MOVE '&"S        EU         (   #00013194' TO DFHEIV0
 14887     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14888     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14889     MOVE X'2020233030303133313934' TO DFHEIV0(25:11)
 14890     CALL 'kxdfhei1' USING DFHEIV0,
 14891           ELCERT-DSID,
 14892           DFHEIV20,
 14893           DFHEIV99,
 14894           ELCERT-KEY,
 14895           DFHEIV99,
 14896           DFHEIV99,
 14897           DFHEIV99
 14898     SET ADDRESS OF CERTIFICATE-MASTER TO
 14899         DFHEIV20
 14900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14901
 14902
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 289
* EL130.cbl
 14903 7930-EXIT.
 14904      EXIT.
 14905
 14906 7940-READ-CERT.
 14907
 14908
 14909* EXEC CICS READ
 14910*        DATASET  (ELCERT-DSID)
 14911*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 14912*        RIDFLD   (ELCERT-KEY)
 14913*    END-EXEC.
 14914*    MOVE '&"S        E          (   #00013206' TO DFHEIV0
 14915     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14916     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14917     MOVE X'2020233030303133323036' TO DFHEIV0(25:11)
 14918     CALL 'kxdfhei1' USING DFHEIV0,
 14919           ELCERT-DSID,
 14920           DFHEIV20,
 14921           DFHEIV99,
 14922           ELCERT-KEY,
 14923           DFHEIV99,
 14924           DFHEIV99,
 14925           DFHEIV99
 14926     SET ADDRESS OF CERTIFICATE-MASTER TO
 14927         DFHEIV20
 14928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14929
 14930
 14931 7940-EXIT.
 14932      EXIT.
 14933
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 290
* EL130.cbl
 14935**************************************************
 14936*  I/O REQUESTS AGAINST BENEFICIARY MASTER FILE  *
 14937**************************************************
 14938
 14939 7991-READ-BENE.
 14940
 14941
 14942* EXEC CICS READ
 14943*         DATASET   (ELBENE-DSID)
 14944*         SET       (ADDRESS OF BENEFICIARY-MASTER)
 14945*         RIDFLD    (ELBENE-KEY)
 14946*     END-EXEC.
 14947*    MOVE '&"S        E          (   #00013222' TO DFHEIV0
 14948     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14949     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14950     MOVE X'2020233030303133323232' TO DFHEIV0(25:11)
 14951     CALL 'kxdfhei1' USING DFHEIV0,
 14952           ELBENE-DSID,
 14953           DFHEIV20,
 14954           DFHEIV99,
 14955           ELBENE-KEY,
 14956           DFHEIV99,
 14957           DFHEIV99,
 14958           DFHEIV99
 14959     SET ADDRESS OF BENEFICIARY-MASTER TO
 14960         DFHEIV20
 14961     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14962
 14963
 14964 7991-EXIT.
 14965      EXIT.
 14966
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 291
* EL130.cbl
 14968**************************************************
 14969*  I/O REQUESTS AGAINST REINSURANCE MASTER FILE  *
 14970**************************************************
 14971
 14972 7992-READ-REIN.
 14973
 14974
 14975
 14976* EXEC CICS HANDLE CONDITION
 14977*        NOTFND   (7992-NOT-FOUND)
 14978*    END-EXEC.
 14979*    MOVE '"$I                   ! L #00013239' TO DFHEIV0
 14980     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14981     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14982     MOVE X'4C20233030303133323339' TO DFHEIV0(25:11)
 14983     CALL 'kxdfhei1' USING DFHEIV0
 14984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14985
 14986
 14987
 14988
 14989* EXEC CICS READ
 14990*        DATASET   (ERREIN-DSID)
 14991*        SET       (ADDRESS OF REINSURANCE-RECORD)
 14992*        RIDFLD    (ERREIN-KEY)
 14993*    END-EXEC.
 14994*    MOVE '&"S        E          (   #00013244' TO DFHEIV0
 14995     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14996     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14997     MOVE X'2020233030303133323434' TO DFHEIV0(25:11)
 14998     CALL 'kxdfhei1' USING DFHEIV0,
 14999           ERREIN-DSID,
 15000           DFHEIV20,
 15001           DFHEIV99,
 15002           ERREIN-KEY,
 15003           DFHEIV99,
 15004           DFHEIV99,
 15005           DFHEIV99
 15006     SET ADDRESS OF REINSURANCE-RECORD TO
 15007         DFHEIV20
 15008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15009
 15010
 15011     MOVE 'Y'                       TO  WS-REIN-REC-FOUND-SW.
 15012
 15013     GO TO 7992-EXIT.
 15014
 15015 7992-NOT-FOUND.
 15016     MOVE 'N'                       TO  WS-REIN-REC-FOUND-SW.
 15017
 15018 7992-EXIT.
 15019     EXIT.
 15020
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 292
* EL130.cbl
 15022 8000-LOAD-ERROR-MESSAGES.
 15023     MOVE SPACES                 TO ERRMSG1O  ERRMSG2O.
 15024
 15025     IF EMI-NO-ERRORS
 15026         GO TO 8000-EXIT
 15027     END-IF.
 15028
 15029     IF EMI-NUMBER-OF-LINES = 1
 15030         MOVE EMI-LINE1          TO ERRMSG1O
 15031         GO TO 8000-EXIT
 15032     END-IF.
 15033
 15034     IF EMI-NUMBER-OF-LINES = 2
 15035          MOVE EMI-LINE1         TO ERRMSG1O
 15036          MOVE EMI-LINE2         TO ERRMSG2O
 15037          GO TO 8000-EXIT
 15038     END-IF.
 15039
 15040     MOVE EMI-LINE1              TO ERRMSG1O.
 15041
 15042 8000-EXIT.
 15043     EXIT.
 15044
 15045 8100-SEND-INITIAL-MAP.
 15046     MOVE SAVE-DATE              TO RUNDTEO.
 15047     MOVE EIBTIME                TO TIME-IN.
 15048     MOVE TIME-OUT               TO RUNTIMEO.
 15049     IF RETURNED-FROM = XCTL-114
 15050        CONTINUE
 15051     ELSE
 15052        MOVE -1                  TO MAINTL
 15053     END-IF.
 15054
 15055*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 15056         MOVE SPACES             TO PRODO.
 15057         MOVE AL-SANOF           TO PRODCDA.
 15058*    END-IF.
 15059
 15060     MOVE PI-COMPANY-ID          TO COMPO.
 15061     MOVE AL-PABOF               TO COMPA.
 15062     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 15063     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 15064     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 15065
 15066     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 15067
 15068     IF NOT PI-NO-CARRIER-SECURITY
 15069        MOVE PI-CARRIER-SECURITY TO CLMCARRO
 15070        MOVE AL-SABOF            TO CLMCARRA
 15071     END-IF.
 15072
 15073     IF PI-PROCESSOR-ID = 'PEMA'
 15074        MOVE AL-UANON            TO CERTNOA
 15075                                    SUFXA
 15076     END-IF.
 15077*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 15078*        NEXT SENTENCE
 15079*        CONTINUE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 293
* EL130.cbl
 15080*    ELSE
 15081         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 15082*    END-IF.
 15083
 15084
 15085
 15086* EXEC CICS SEND
 15087*        MAP     (MAP-NAME)
 15088*        MAPSET  (MAPSET-NAME)
 15089*        FROM    (EL130AO)
 15090*        ERASE
 15091*        CURSOR
 15092*    END-EXEC.
 15093     MOVE LENGTH OF
 15094      EL130AO
 15095       TO DFHEIV12
 15096     MOVE -1
 15097       TO DFHEIV11
 15098*    MOVE '8$     CT  E    H L F ,   #00013324' TO DFHEIV0
 15099     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 15100     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 15101     MOVE X'2020233030303133333234' TO DFHEIV0(25:11)
 15102     CALL 'kxdfhei1' USING DFHEIV0,
 15103           MAP-NAME,
 15104           EL130AO,
 15105           DFHEIV12,
 15106           MAPSET-NAME,
 15107           DFHEIV99,
 15108           DFHEIV99,
 15109           DFHEIV99,
 15110           DFHEIV11,
 15111           DFHEIV99,
 15112           DFHEIV99,
 15113           DFHEIV99
 15114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15115
 15116
 15117     GO TO 9100-RETURN-TRAN.
 15118
 15119 8150-SEND-MAP-CURSOR.
 15120     MOVE SAVE-DATE              TO RUNDTEO.
 15121     MOVE EIBTIME                TO TIME-IN.
 15122     MOVE TIME-OUT               TO RUNTIMEO.
 15123     MOVE PI-COMPANY-ID          TO COMPO.
 15124     MOVE AL-PABOF               TO COMPA
 15125     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 15126     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 15127     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 15128
 15129*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 15130         MOVE SPACES             TO PRODO.
 15131         MOVE AL-SANOF           TO PRODCDA.
 15132*    END-IF.
 15133
 15134     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 15135
 15136     IF NOT PI-NO-CARRIER-SECURITY
 15137         MOVE PI-CARRIER-SECURITY TO CLMCARRO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 294
* EL130.cbl
 15138         MOVE AL-SABOF            TO CLMCARRA
 15139     END-IF.
 15140
 15141     IF PI-PROCESSOR-ID = 'PEMA'
 15142        MOVE AL-UANON            TO CERTNOA
 15143                                    SUFXA
 15144     END-IF.
 15145*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 15146*        NEXT SENTENCE
 15147*        CONTINUE
 15148*    ELSE
 15149         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 15150*    END-IF.
 15151
 15152
 15153
 15154* EXEC CICS SEND
 15155*        MAP      (MAP-NAME)
 15156*        MAPSET   (MAPSET-NAME)
 15157*        FROM     (EL130AO)
 15158*        CURSOR   (PI-CURSOR)
 15159*        ERASE
 15160*    END-EXEC.
 15161     MOVE LENGTH OF
 15162      EL130AO
 15163       TO DFHEIV11
 15164*    MOVE '8$     CT  E    H L F ,   #00013368' TO DFHEIV0
 15165     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 15166     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 15167     MOVE X'2020233030303133333638' TO DFHEIV0(25:11)
 15168     CALL 'kxdfhei1' USING DFHEIV0,
 15169           MAP-NAME,
 15170           EL130AO,
 15171           DFHEIV11,
 15172           MAPSET-NAME,
 15173           DFHEIV99,
 15174           DFHEIV99,
 15175           DFHEIV99,
 15176           PI-CURSOR,
 15177           DFHEIV99,
 15178           DFHEIV99,
 15179           DFHEIV99
 15180     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15181
 15182
 15183     GO TO 9100-RETURN-TRAN.
 15184
 15185 8200-SEND-DATAONLY.
 15186     IF EIBAID = DFHPF11
 15187        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 15188        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15189     END-IF.
 15190
 15191     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 15192
 15193 8200-BYPASS-ERROR.
 15194     MOVE SAVE-DATE              TO RUNDTEO.
 15195     MOVE EIBTIME                TO TIME-IN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 295
* EL130.cbl
 15196     MOVE TIME-OUT               TO RUNTIMEO.
 15197     MOVE PI-COMPANY-ID          TO COMPO.
 15198     MOVE AL-PABOF               TO COMPA
 15199     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 15200
 15201*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 15202         MOVE SPACES             TO PRODO.
 15203         MOVE AL-SANOF           TO PRODCDA.
 15204*    END-IF.
 15205
 15206     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 15207     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 15208
 15209     IF PI-PROCESSOR-ID = 'PEMA'
 15210        MOVE AL-UANON            TO CERTNOA
 15211                                    SUFXA
 15212     END-IF.
 15213     IF NOT PI-NO-CARRIER-SECURITY
 15214        MOVE PI-CARRIER-SECURITY TO CLMCARRO
 15215        MOVE AL-SABOF            TO CLMCARRA
 15216     END-IF.
 15217
 15218*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 15219*        NEXT SENTENCE
 15220*        CONTINUE
 15221*    ELSE
 15222         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 15223*    END-IF.
 15224
 15225*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL'
 15226         MOVE AL-SANOF           TO PRODCDA.
 15227*    END-IF.
 15228
 15229
 15230
 15231* EXEC CICS SEND
 15232*        MAP      (MAP-NAME)
 15233*        MAPSET   (MAPSET-NAME)
 15234*        FROM     (EL130AO)
 15235*        DATAONLY
 15236*        CURSOR
 15237*    END-EXEC.
 15238     MOVE LENGTH OF
 15239      EL130AO
 15240       TO DFHEIV12
 15241     MOVE -1
 15242       TO DFHEIV11
 15243*    MOVE '8$D    CT       H L F ,   #00013423' TO DFHEIV0
 15244     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 15245     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 15246     MOVE X'2020233030303133343233' TO DFHEIV0(25:11)
 15247     CALL 'kxdfhei1' USING DFHEIV0,
 15248           MAP-NAME,
 15249           EL130AO,
 15250           DFHEIV12,
 15251           MAPSET-NAME,
 15252           DFHEIV99,
 15253           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 296
* EL130.cbl
 15254           DFHEIV99,
 15255           DFHEIV11,
 15256           DFHEIV99,
 15257           DFHEIV99,
 15258           DFHEIV99
 15259     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15260
 15261
 15262     GO TO 9100-RETURN-TRAN.
 15263
 15264 8300-SEND-TEXT.
 15265
 15266
 15267* EXEC CICS SEND TEXT
 15268*        FROM     (LOGOFF-TEXT)
 15269*        LENGTH   (LOGOFF-LENGTH)
 15270*        ERASE
 15271*        FREEKB
 15272*    END-EXEC.
 15273*    MOVE '8&      T  E F  H   F -   #00013435' TO DFHEIV0
 15274     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 15275     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 15276     MOVE X'2020233030303133343335' TO DFHEIV0(25:11)
 15277     CALL 'kxdfhei1' USING DFHEIV0,
 15278           LOGOFF-TEXT,
 15279           LOGOFF-LENGTH,
 15280           DFHEIV99,
 15281           DFHEIV99,
 15282           DFHEIV99,
 15283           DFHEIV99,
 15284           DFHEIV99,
 15285           DFHEIV99,
 15286           DFHEIV99,
 15287           DFHEIV99,
 15288           DFHEIV99,
 15289           DFHEIV99
 15290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15291
 15292
 15293
 15294
 15295* EXEC CICS RETURN
 15296*    END-EXEC.
 15297*    MOVE '.(                    &   #00013443' TO DFHEIV0
 15298     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 15299     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15300     MOVE X'2020233030303133343433' TO DFHEIV0(25:11)
 15301     CALL 'kxdfhei1' USING DFHEIV0,
 15302           DFHEIV99,
 15303           DFHEIV99,
 15304           DFHEIV99,
 15305           DFHEIV99,
 15306           DFHEIV99
 15307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15308
 15309
 15310 8800-UNAUTHORIZED-ACCESS.
 15311     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 297
* EL130.cbl
 15312     GO TO 8300-SEND-TEXT.
 15313
 15314 8810-PF23.
 15315     MOVE EIBAID TO PI-ENTRY-CD-1.
 15316     MOVE XCTL-005               TO PGM-NAME.
 15317     GO TO 9300-XCTL.
 15318
 15319 8820-TERM-ERROR.
 15320     MOVE ER-0412                TO EMI-ERROR.
 15321     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15322     MOVE -1                     TO MAINTL.
 15323     GO TO 8200-SEND-DATAONLY.
 15324
 15325 8830-TRAN-ERROR.
 15326     MOVE ER-0413                TO EMI-ERROR.
 15327     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15328     MOVE -1                     TO MAINTL.
 15329     GO TO 8200-SEND-DATAONLY.
 15330
 15331 9000-RETURN-CICS.
 15332
 15333
 15334* EXEC CICS RETURN
 15335*    END-EXEC.
 15336*    MOVE '.(                    &   #00013469' TO DFHEIV0
 15337     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 15338     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15339     MOVE X'2020233030303133343639' TO DFHEIV0(25:11)
 15340     CALL 'kxdfhei1' USING DFHEIV0,
 15341           DFHEIV99,
 15342           DFHEIV99,
 15343           DFHEIV99,
 15344           DFHEIV99,
 15345           DFHEIV99
 15346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15347
 15348
 15349 9100-RETURN-TRAN.
 15350     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 15351     MOVE '130A'                 TO PI-CURRENT-SCREEN-NO.
 15352
 15353
 15354
 15355* EXEC CICS RETURN
 15356*        TRANSID   (TRANS-ID)
 15357*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 15358*        LENGTH    (PI-COMM-LENGTH)
 15359*    END-EXEC.
 15360*    MOVE '.(CT                  &   #00013477' TO DFHEIV0
 15361     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 15362     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15363     MOVE X'2020233030303133343737' TO DFHEIV0(25:11)
 15364     CALL 'kxdfhei1' USING DFHEIV0,
 15365           TRANS-ID,
 15366           PROGRAM-INTERFACE-BLOCK,
 15367           PI-COMM-LENGTH,
 15368           DFHEIV99,
 15369           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 298
* EL130.cbl
 15370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15371
 15372
 15373 9200-RETURN-MAIN-MENU.
 15374     MOVE XCTL-126               TO PGM-NAME.
 15375     GO TO 9300-XCTL.
 15376
 15377 9300-XCTL.
 15378
 15379
 15380* EXEC CICS XCTL
 15381*        PROGRAM   (PGM-NAME)
 15382*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 15383*        LENGTH    (PI-COMM-LENGTH)
 15384*    END-EXEC.
 15385*    MOVE '.$C                   $   #00013489' TO DFHEIV0
 15386     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 15387     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15388     MOVE X'2020233030303133343839' TO DFHEIV0(25:11)
 15389     CALL 'kxdfhei1' USING DFHEIV0,
 15390           PGM-NAME,
 15391           PROGRAM-INTERFACE-BLOCK,
 15392           PI-COMM-LENGTH
 15393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15394
 15395
 15396 9400-CLEAR.
 15397     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 15398     GO TO 9300-XCTL.
 15399
 15400 9500-PF12.
 15401     MOVE XCTL-010               TO PGM-NAME.
 15402     GO TO 9300-XCTL.
 15403
 15404 9600-PGMID-ERROR.
 15405
 15406
 15407* EXEC CICS HANDLE CONDITION
 15408*        PGMIDERR  (8300-SEND-TEXT)
 15409*    END-EXEC.
 15410*    MOVE '"$L                   ! M #00013505' TO DFHEIV0
 15411     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 15412     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15413     MOVE X'4D20233030303133353035' TO DFHEIV0(25:11)
 15414     CALL 'kxdfhei1' USING DFHEIV0
 15415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15416
 15417
 15418     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 15419     MOVE ' '                    TO PI-ENTRY-CD-1.
 15420     MOVE XCTL-005               TO PGM-NAME.
 15421     MOVE PGM-NAME               TO LOGOFF-PGM.
 15422     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 15423     GO TO 9300-XCTL.
 15424
 15425 9700-LINK-DATE-CONVERT.
 15426     MOVE LINK-ELDATCV           TO PGM-NAME.
 15427
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 299
* EL130.cbl
 15428
 15429* EXEC CICS LINK
 15430*        PROGRAM    (PGM-NAME)
 15431*        COMMAREA   (DATE-CONVERSION-DATA)
 15432*        LENGTH     (DC-COMM-LENGTH)
 15433*    END-EXEC.
 15434*    MOVE '."C                   ''   #00013519' TO DFHEIV0
 15435     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15436     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15437     MOVE X'2020233030303133353139' TO DFHEIV0(25:11)
 15438     CALL 'kxdfhei1' USING DFHEIV0,
 15439           PGM-NAME,
 15440           DATE-CONVERSION-DATA,
 15441           DC-COMM-LENGTH,
 15442           DFHEIV99,
 15443           DFHEIV99,
 15444           DFHEIV99
 15445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15446
 15447
 15448 9700-EXIT.
 15449     EXIT.
 15450
 15451 9800-LINK-REM-TERM.
 15452     MOVE LINK-ELRTRM            TO PGM-NAME.
 15453
 15454
 15455* EXEC CICS LINK
 15456*        PROGRAM    (PGM-NAME)
 15457*        COMMAREA   (CALCULATION-PASS-AREA)
 15458*        LENGTH     (CP-COMM-LENGTH)
 15459*    END-EXEC.
 15460*    MOVE '."C                   ''   #00013531' TO DFHEIV0
 15461     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15462     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15463     MOVE X'2020233030303133353331' TO DFHEIV0(25:11)
 15464     CALL 'kxdfhei1' USING DFHEIV0,
 15465           PGM-NAME,
 15466           CALCULATION-PASS-AREA,
 15467           CP-COMM-LENGTH,
 15468           DFHEIV99,
 15469           DFHEIV99,
 15470           DFHEIV99
 15471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15472
 15473
 15474 9800-EXIT.
 15475     EXIT.
 15476
 15477 9900-ERROR-FORMAT.
 15478     IF NOT EMI-ERRORS-COMPLETE
 15479         MOVE LINK-001           TO PGM-NAME
 15480
 15481* EXEC CICS LINK
 15482*            PROGRAM   (PGM-NAME)
 15483*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
 15484*            LENGTH    (EMI-COMM-LENGTH)
 15485*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 300
* EL130.cbl
 15486*    MOVE '."C                   ''   #00013543' TO DFHEIV0
 15487     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15488     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15489     MOVE X'2020233030303133353433' TO DFHEIV0(25:11)
 15490     CALL 'kxdfhei1' USING DFHEIV0,
 15491           PGM-NAME,
 15492           ERROR-MESSAGE-INTERFACE-BLOCK,
 15493           EMI-COMM-LENGTH,
 15494           DFHEIV99,
 15495           DFHEIV99,
 15496           DFHEIV99
 15497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15498     END-IF.
 15499
 15500 9900-EXIT.
 15501     EXIT.
 15502
 15503 9990-ABEND.
 15504     MOVE -1                     TO MAINTL.
 15505     MOVE LINK-004               TO PGM-NAME.
 15506     MOVE DFHEIBLK               TO EMI-LINE1.
 15507
 15508
 15509* EXEC CICS LINK
 15510*        PROGRAM   (PGM-NAME)
 15511*        COMMAREA  (EMI-LINE1)
 15512*        LENGTH    (72)
 15513*    END-EXEC.
 15514     MOVE 72
 15515       TO DFHEIV11
 15516*    MOVE '."C                   ''   #00013558' TO DFHEIV0
 15517     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15518     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15519     MOVE X'2020233030303133353538' TO DFHEIV0(25:11)
 15520     CALL 'kxdfhei1' USING DFHEIV0,
 15521           PGM-NAME,
 15522           EMI-LINE1,
 15523           DFHEIV11,
 15524           DFHEIV99,
 15525           DFHEIV99,
 15526           DFHEIV99
 15527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15528
 15529
 15530     MOVE EMI-LINE1              TO ERRMSG2O.
 15531
 15532     GO TO 8200-BYPASS-ERROR.
 15533
 15534
 15535
 15536* GOBACK.
 15537     MOVE '9%                    "   ' TO DFHEIV0
 15538     MOVE 'EL130' TO DFHEIV1
 15539     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 15540     GOBACK.
 15541
 15542 9995-SECURITY-VIOLATION.
 15543*             COPY ELCSCTP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 301
* EL130.cbl
 15544******************************************************************
 15545*                                                                *
 15546*                            ELCSCTP                             *
 15547*                            VMOD=2.001                          *
 15548*                                                                *
 15549*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 15550******************************************************************
 15551
 15552
 15553     MOVE EIBDATE          TO SM-JUL-DATE.
 15554     MOVE EIBTRMID         TO SM-TERMID.
 15555     MOVE THIS-PGM         TO SM-PGM.
 15556     MOVE EIBTIME          TO TIME-IN.
 15557     MOVE TIME-OUT         TO SM-TIME.
 15558     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 15559
 15560
 15561* EXEC CICS LINK
 15562*         PROGRAM  ('EL003')
 15563*         COMMAREA (SECURITY-MESSAGE)
 15564*         LENGTH   (80)
 15565*    END-EXEC.
 15566     MOVE 'EL003' TO DFHEIV1
 15567     MOVE 80
 15568       TO DFHEIV11
 15569*    MOVE '."C                   ''   #00013589' TO DFHEIV0
 15570     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15571     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15572     MOVE X'2020233030303133353839' TO DFHEIV0(25:11)
 15573     CALL 'kxdfhei1' USING DFHEIV0,
 15574           DFHEIV1,
 15575           SECURITY-MESSAGE,
 15576           DFHEIV11,
 15577           DFHEIV99,
 15578           DFHEIV99,
 15579           DFHEIV99
 15580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15581
 15582
 15583******************************************************************
 15584
 15585
 15586 9995-EXIT.
 15587     EXIT.
 15588
 15589
 15590 9999-DFHBACK SECTION.
 15591     MOVE '9%                    "   ' TO DFHEIV0
 15592     MOVE 'EL130' TO DFHEIV1
 15593     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 15594     GOBACK.
 15595 9999-DFHEXIT.
 15596     IF DFHEIGDJ EQUAL 0001
 15597         NEXT SENTENCE
 15598     ELSE IF DFHEIGDJ EQUAL 2
 15599         GO TO 0100-TEST-ENTRY,
 15600               8100-SEND-INITIAL-MAP,
 15601               9600-PGMID-ERROR,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 302
* EL130.cbl
 15602               8820-TERM-ERROR,
 15603               8830-TRAN-ERROR,
 15604               9990-ABEND
 15605         DEPENDING ON DFHEIGDI
 15606     ELSE IF DFHEIGDJ EQUAL 3
 15607         GO TO 0450-ADD-ELACTQ-RECORD
 15608         DEPENDING ON DFHEIGDI
 15609     ELSE IF DFHEIGDJ EQUAL 4
 15610         GO TO 8820-TERM-ERROR,
 15611               8830-TRAN-ERROR
 15612         DEPENDING ON DFHEIGDI
 15613     ELSE IF DFHEIGDJ EQUAL 5
 15614         GO TO 0660-NOT-FOUND,
 15615               0670-QIDERR
 15616         DEPENDING ON DFHEIGDI
 15617     ELSE IF DFHEIGDJ EQUAL 6
 15618         GO TO 1025-SHOW-RECORD-NOT-FOUND
 15619         DEPENDING ON DFHEIGDI
 15620     ELSE IF DFHEIGDJ EQUAL 7
 15621         GO TO 1025-SHOW-RECORD-NOT-FOUND
 15622         DEPENDING ON DFHEIGDI
 15623     ELSE IF DFHEIGDJ EQUAL 8
 15624         GO TO 1025-SHOW-RECORD-NOT-FOUND
 15625         DEPENDING ON DFHEIGDI
 15626     ELSE IF DFHEIGDJ EQUAL 9
 15627         GO TO 1025-SHOW-RECORD-NOT-FOUND
 15628         DEPENDING ON DFHEIGDI
 15629     ELSE IF DFHEIGDJ EQUAL 10
 15630         GO TO 2050-DELETE-NOT-FOUND
 15631         DEPENDING ON DFHEIGDI
 15632     ELSE IF DFHEIGDJ EQUAL 11
 15633         GO TO 2010-DELETE-CL
 15634         DEPENDING ON DFHEIGDI
 15635     ELSE IF DFHEIGDJ EQUAL 12
 15636         GO TO 3010-TEST-FOR-ERRORS
 15637         DEPENDING ON DFHEIGDI
 15638     ELSE IF DFHEIGDJ EQUAL 13
 15639         GO TO 3008-DUP-ERROR,
 15640               3009-NOT-FOUND
 15641         DEPENDING ON DFHEIGDI
 15642     ELSE IF DFHEIGDJ EQUAL 14
 15643         GO TO 3030-BUILD-CONT
 15644         DEPENDING ON DFHEIGDI
 15645     ELSE IF DFHEIGDJ EQUAL 15
 15646         GO TO 3033-ACCT-NOT-FOUND,
 15647               3033-ACCT-NOT-FOUND
 15648         DEPENDING ON DFHEIGDI
 15649     ELSE IF DFHEIGDJ EQUAL 16
 15650         GO TO 3032-NOT-IN-DT-RANGE
 15651         DEPENDING ON DFHEIGDI
 15652     ELSE IF DFHEIGDJ EQUAL 17
 15653         GO TO 3070-BUILD-CONT
 15654         DEPENDING ON DFHEIGDI
 15655     ELSE IF DFHEIGDJ EQUAL 18
 15656         GO TO 3065-CERT-NOT-FOUND
 15657         DEPENDING ON DFHEIGDI
 15658     ELSE IF DFHEIGDJ EQUAL 19
 15659         GO TO 3100-CARRIER-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 303
* EL130.cbl
 15660         DEPENDING ON DFHEIGDI
 15661     ELSE IF DFHEIGDJ EQUAL 20
 15662         GO TO 3110-COMPANY-NOT-FOUND
 15663         DEPENDING ON DFHEIGDI
 15664     ELSE IF DFHEIGDJ EQUAL 21
 15665         GO TO 3200-BUILD-ZERO-TRAILER
 15666         DEPENDING ON DFHEIGDI
 15667     ELSE IF DFHEIGDJ EQUAL 22
 15668         GO TO 9999-DFHBACK
 15669         DEPENDING ON DFHEIGDI
 15670     ELSE IF DFHEIGDJ EQUAL 23
 15671         GO TO 3290-NO-INSURED-ADDRESS
 15672         DEPENDING ON DFHEIGDI
 15673     ELSE IF DFHEIGDJ EQUAL 24
 15674         GO TO 3410-DUP-KEY
 15675         DEPENDING ON DFHEIGDI
 15676     ELSE IF DFHEIGDJ EQUAL 25
 15677         GO TO 3690-CERT-WRITTEN
 15678         DEPENDING ON DFHEIGDI
 15679     ELSE IF DFHEIGDJ EQUAL 26
 15680         GO TO 3850-CLAIM-MSTR-WRITTEN
 15681         DEPENDING ON DFHEIGDI
 15682     ELSE IF DFHEIGDJ EQUAL 27
 15683         GO TO 5050-CERT-NOT-FOUND
 15684         DEPENDING ON DFHEIGDI
 15685     ELSE IF DFHEIGDJ EQUAL 28
 15686         GO TO 5030-CERT-WRITTEN
 15687         DEPENDING ON DFHEIGDI
 15688     ELSE IF DFHEIGDJ EQUAL 29
 15689         GO TO 5035-CLAIM-WRITTEN
 15690         DEPENDING ON DFHEIGDI
 15691     ELSE IF DFHEIGDJ EQUAL 30
 15692         GO TO 9990-ABEND,
 15693               5799-EXIT
 15694         DEPENDING ON DFHEIGDI
 15695     ELSE IF DFHEIGDJ EQUAL 31
 15696         GO TO 3100-CARRIER-NOT-FOUND
 15697         DEPENDING ON DFHEIGDI
 15698     ELSE IF DFHEIGDJ EQUAL 32
 15699         GO TO 6040-NO-PROCESSOR-RECORD
 15700         DEPENDING ON DFHEIGDI
 15701     ELSE IF DFHEIGDJ EQUAL 33
 15702         GO TO 6060-NO-BENEFICIARY-RECORD
 15703         DEPENDING ON DFHEIGDI
 15704     ELSE IF DFHEIGDJ EQUAL 34
 15705         GO TO 6499-EXIT,
 15706               6499-EXIT
 15707         DEPENDING ON DFHEIGDI
 15708     ELSE IF DFHEIGDJ EQUAL 35
 15709         GO TO 6600-NOT-FOUND
 15710         DEPENDING ON DFHEIGDI
 15711     ELSE IF DFHEIGDJ EQUAL 36
 15712         GO TO 6700-NOTOPEN-ERROR,
 15713               6700-EXIT
 15714         DEPENDING ON DFHEIGDI
 15715     ELSE IF DFHEIGDJ EQUAL 37
 15716         GO TO 7120-NOT-FOUND
 15717         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 304
* EL130.cbl
 15718     ELSE IF DFHEIGDJ EQUAL 38
 15719         GO TO 7499-EXIT
 15720         DEPENDING ON DFHEIGDI
 15721     ELSE IF DFHEIGDJ EQUAL 39
 15722         GO TO 7500-EXIT,
 15723               7500-DUPLICATE-KEY,
 15724               7500-EXIT
 15725         DEPENDING ON DFHEIGDI
 15726     ELSE IF DFHEIGDJ EQUAL 40
 15727         GO TO 7500-END-BROWSE
 15728         DEPENDING ON DFHEIGDI
 15729     ELSE IF DFHEIGDJ EQUAL 41
 15730         GO TO 7630-END-BROWSE
 15731         DEPENDING ON DFHEIGDI
 15732     ELSE IF DFHEIGDJ EQUAL 42
 15733         GO TO 7799-EXIT,
 15734               7799-EXIT
 15735         DEPENDING ON DFHEIGDI
 15736     ELSE IF DFHEIGDJ EQUAL 43
 15737         GO TO 7790-END-BROWSE
 15738         DEPENDING ON DFHEIGDI
 15739     ELSE IF DFHEIGDJ EQUAL 44
 15740         GO TO 7992-NOT-FOUND
 15741         DEPENDING ON DFHEIGDI
 15742     ELSE IF DFHEIGDJ EQUAL 45
 15743         GO TO 8300-SEND-TEXT
 15744         DEPENDING ON DFHEIGDI.
 15745     MOVE '9%                    "   ' TO DFHEIV0
 15746     MOVE 'EL130' TO DFHEIV1
 15747     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 15748     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       10512     Code:       48503
