* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page   1
* EL6318.cbl
* Options: int("EL6318.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6318.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6318.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6318.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                 EL6318.
     3*
     4*AUTHOR.        PABLO
     5*               OMAHA, NEBRASKA
     6*DATE-COMPILED.
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CNETRAL STATES  *
    10*            *   HEALTH AND LIFE                                 *
    11*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    12*            *   OF CSO.        IS EXPRESSLY PROHIBITED WITHOUT  *
    13*            *   THE PRIOR WRITTEN PERMISSION OF CENTRAL STATES. *
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page   2
* EL6318.cbl
    14*            *                                                   *
    15*            *****************************************************
    16*-----------------------------------------------------------------
    17*                   C H A N G E   L O G
    18*
    19* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    20*-----------------------------------------------------------------
    21*  CHANGE  CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    22* EFFECTIVE    NUMBER
    23*-----------------------------------------------------------------
    24*          2011022800001  PEMA  NEW PROGRAM
    25* 012412   2011022800001  AJRA  NAPERSOFT
    26* 060612   2011022800001  AJRA  NAPERSOFT
    27* 062712   2011022800001  AJRA  REDEFINE ORIG DATA
    28* 072312   2011022800001  AJRA  NAPERSOFT MISC
    29* 102212   2012101700002  AJRA  SCREEN ID
    30* 103012   2012101700002  AJRA  ADD CERT NOTES TO TOP OF LIST
    31* 110612   2012101700002  AJRA  ADD NEW FIELDS
    32* 112612   2012101700002  AJRA  CHECK FOR PROMPT LETTER
    33* 121012   2012101700002  AJRA  HIGHLIGHT REASON CODES
    34* 121112   2012101700002  AJRA  CHANGE PF1, PF2 TO PF3, PF4
    35* 121212   2012101700002  AJRA  CHG LAST 2 CERT NOTES TO BILLING N
    36* 122712   2012122700001  AJRA  FIX CERT PRINT FLAG
    37*-----------------------------------------------------------------
    38*REMARKS.
    39*        TRANSACTION - EXBE - GENERAL CHANGE ENDORSEMENT
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page   3
* EL6318.cbl
    41 ENVIRONMENT DIVISION.
    42 DATA DIVISION.
    43 WORKING-STORAGE SECTION.
    44 01  DFH-START PIC X(04).
    45 77  FILLER  PIC X(32)  VALUE '********************************'.
    46 77  FILLER  PIC X(32)  VALUE '*    EL6318 WORKING STORAGE    *'.
    47 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.001 ************'.
    48 77  NOTE-SUB PIC S9(5) COMP-3 VALUE +0.
    49 77  WS-SEQ-NO                   PIC 9(4) BINARY.
    50 77  WS-SET-CODES-MDT            PIC X  VALUE SPACES.
    51 77  s1                          pic s999 comp-3 value +0.
    52 77  s2                          pic s999 comp-3 value +0.
    53 77  W-ARCH-NUMBER               PIC S9(08)      COMP value +0.
    54 77  WS-ERACCT-SW                PIC X  VALUE ' '.
    55     88  ACCT-FOUND                 VALUE 'Y'.
    56 77  WS-CHGBACK                 PIC 99  VALUE ZEROS.
    57 77  WS-CSO-PORTION              PIC S9(5)V99 COMP-3 VALUE +0.
    58 77  WS-ACCT-PORTION             PIC S9(5)V99 COMP-3 VALUE +0.
    59 77  WS-DIFF                     PIC 99 VALUE ZEROS.
    60 77  WS-SAVE-ERACCT-KEY          PIC X(20)  VALUE SPACES.
    61 77  WS-DUE-BORROWER             PIC S9(7)V99 COMP-3 VALUE +0.
    62 77  WS-REASON-SW                PIC X  VALUE ' '.
    63     88  REASONS-FOUND                  VALUE 'Y'.
    64     88  REASONS-NOT-FOUND              VALUE 'N'.
    65 77  WS-CERT-UPDATE-SW           PIC X  VALUE ' '.
    66     88  NO-CERT-RW                 VALUE 'N'.
    67     88  CERT-RW                    VALUE 'Y'.
    68 01  P pointer.
    69 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    70 01  KIXHOST             pic x(9) value Z"HOSTNAME".
    71 01  var-ptr pointer.
    72 01  env-var-len                 pic 9(4)  binary.
    73 01  rc                          pic 9(9)  binary.
    74 01  WS-KIXHOST                  PIC X(10).
    75 01  WS-KIXSYS.
    76     05  WS-KIX-FIL1             PIC X(10).
    77     05  WS-KIX-APPS             PIC X(10).
    78     05  WS-KIX-ENV              PIC X(10).
    79     05  WS-KIX-MYENV            PIC X(10).
    80     05  WS-KIX-SYS              PIC X(10).
    81*                                COPY ELCSCTM.
    82******************************************************************
    83*                                                                *
    84*                                                                *
    85*                            ELCSCTM                             *
    86*                            VMOD=2.001                          *
    87*                                                                *
    88*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    89*                                                                *
    90******************************************************************
    91 01  SECURITY-MESSAGE.
    92     12  FILLER                          PIC X(30)
    93            VALUE '** LOGIC SECURITY VIOLATION -'.
    94     12  SM-READ                         PIC X(6).
    95     12  FILLER                          PIC X(5)
    96            VALUE ' PGM='.
    97     12  SM-PGM                          PIC X(6).
    98     12  FILLER                          PIC X(5)
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page   4
* EL6318.cbl
    99            VALUE ' OPR='.
   100     12  SM-PROCESSOR-ID                 PIC X(4).
   101     12  FILLER                          PIC X(6)
   102            VALUE ' TERM='.
   103     12  SM-TERMID                       PIC X(4).
   104     12  FILLER                          PIC XX   VALUE SPACE.
   105     12  SM-JUL-DATE                     PIC 9(5).
   106     12  FILLER                          PIC X    VALUE SPACE.
   107     12  SM-TIME                         PIC 99.99.
   108
   109*                                COPY ELCSCRTY.
   110******************************************************************
   111*                                                                *
   112*                                                                *
   113*                            ELCSCRTY                            *
   114*                            VMOD=2.001                          *
   115*                                                                *
   116*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   117*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   118*        SAVED IN PI-SECURITY-ADDRESS.                           *
   119*                                                                *
   120******************************************************************
   121 01  SECURITY-CONTROL.
   122     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   123     12  FILLER                       PIC XX    VALUE 'SC'.
   124     12  SC-CREDIT-CODES.
   125         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   126             20  SC-CREDIT-DISPLAY    PIC X.
   127             20  SC-CREDIT-UPDATE     PIC X.
   128     12  SC-CLAIMS-CODES.
   129         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   130             20  SC-CLAIMS-DISPLAY    PIC X.
   131             20  SC-CLAIMS-UPDATE     PIC X.
   132 01 srch-commarea.
   133*                                copy ELCADLTRSPI.
   134******************************************************************
   135*                   C H A N G E   L O G
   136*
   137* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   138*-----------------------------------------------------------------
   139*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   140* EFFECTIVE    NUMBER
   141*-----------------------------------------------------------------
   142* 060611    2011022800001  PEMA  NEW COPYBOOK
   143* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   144* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   145******************************************************************
   146****************************************
   147*  commarea for NaperSoft On Demand Admin services letters
   148*  (business logic input & output)
   149****************************************
   150     03  BL-INPUT.
   151         05  BL-DATA-SRCE        PIC X.
   152         05  BL-LETTER-ID        PIC XXXX.
   153         05  BL-CARRIER          PIC X.
   154         05  BL-GROUP            PIC X(6).
   155         05  BL-STATE            PIC XX.
   156         05  BL-ACCOUNT          PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page   5
* EL6318.cbl
   157         05  BL-EFF-DT           PIC X(10).
   158         05  BL-CERT-NO          PIC X(11).
   159         05  BL-BATCH-NO         PIC X(6).
   160         05  BL-BATCH-SEQ        PIC 9(8).
   161         05  BL-RESP-NO          PIC X(10).
   162         05  BL-NO-OF-COPIES     PIC 99.
   163         05  BL-PROC-ID          PIC XXXX.
   164         05  BL-COMP-ID          PIC XXX.
   165         05  BL-PRINT-NOW-SW     PIC X.
   166         05  BL-ENC-CD           PIC XXX.
   167         05  BL-RESEND-DT        PIC X(10).
   168         05  BL-FOLLOW-UP-DT     PIC X(10).
   169         05  BL-ARCHIVE-NO       PIC 9(8).
   170         05  BL-FUNC             PIC X(8).
   171         05  BL-COMMENTS         PIC X(100).
   172         05  FILLER REDEFINES BL-COMMENTS.
   173             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   174             10  BL-LETTER-TO-ACCT PIC X.
   175             10  BL-LETTER-TO-BENE PIC X.
   176             10  BL-WRITE-ERARCH   PIC X.
   177                 88  ERARCH-QWS      VALUE 'Q'.
   178                 88  ERARCH-BATCH    VALUE 'B'.
   179                 88  ERARCH-TEMP     VALUE 'T'.
   180             10  BL-PROCESS-TYPE PIC X(07).
   181             10  BL-CERT-FORM-ID PIC X(05).
   182             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   183             10  BL-SOURCE-SCREEN PIC X(8).
   184             10  FILLER          PIC X(25).
   185     03  BL-OUTPUT.
   186         05  BL-STATUS                   PIC X.
   187             88  BL-OK                      VALUE "P".
   188             88  BL-FAIL                  VALUE "F".
   189         05  BL-MESSAGE          PIC X(50).
   190     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   191     03  FILLER                  PIC X(31).
   192
   193*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   194*                                COPY ELCZREC.
   195******************************************************************
   196*                                                                *
   197*                                                                *
   198*                            ELCZREC.                            *
   199*                                                                *
   200*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   201*                                                                *
   202******************************************************************
   203*-----------------------------------------------------------------
   204*                   C H A N G E   L O G
   205*
   206* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   207*-----------------------------------------------------------------
   208*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   209* EFFECTIVE    NUMBER
   210*-----------------------------------------------------------------
   211* 122011    2011022800001  AJRA  NEW FILE
   212* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   213*-----------------------------------------------------------------
   214 01  W-Z-CONTROL-DATA.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page   6
* EL6318.cbl
   215     05  W-NUMBER-OF-COPIES      PIC  9.
   216     05  FILLER                  PIC  X.
   217     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   218     05  FILLER                  PIC  X.
   219     05  W-DAYS-TO-RESEND        PIC  999.
   220     05  FILLER                  PIC  X.
   221     05  W-FORM-TO-RESEND        PIC  X(4).
   222     05  FILLER                  PIC  X.
   223     05  W-PROMPT-LETTER         PIC  X.
   224     05  FILLER                  PIC  X.
   225     05  W-ENCLOSURE-CD          PIC  XXX.
   226     05  FILLER                  PIC  X.
   227     05  W-AUTO-CLOSE-IND        PIC  X.
   228     05  FILLER                  PIC  X.
   229     05  W-LETTER-TO-BENE        PIC  X.
   230     05  FILLER                  PIC  X.
   231     05  W-LETTER-TO-ACCT        PIC  X.
   232     05  FILLER                  PIC  X.
   233     05  W-LETTER-TYPE           PIC  X.
   234     05  FILLER                  PIC  X.
   235     05  W-PRINT-CERTIFICATE     PIC  X.
   236     05  FILLER                  PIC  X.
   237     05  W-REFUND-REQUIRED       PIC  X.
   238     05  FILLER                  PIC  X.
   239     05  W-ONBASE-CODE           PIC  XX.
   240     05  FILLER                  PIC  X.
   241     05  W-ACCT-SUMM             PIC  X.
   242     05  FILLER                  PIC  X.
   243     05  W-CSO-SUMM              PIC  X.
   244     05  FILLER                  PIC  X(31).
   245 01  WS-PASSED-REASON-CODES      PIC X(60)  VALUE SPACES.
   246 01  STANDARD-AREAS.
   247     12  W-ARCH-SUPPRESS         PIC ZZZZZZZ9.
   248     12  W-ARCH-EDIT REDEFINES W-ARCH-SUPPRESS
   249                                 PIC  X(08).
   250     12  W-ARCH-LENGTH           PIC S9(04)  COMP  VALUE +250.
   251     12  QID.
   252         16  QID-TERM        PIC X(4)    VALUE SPACES.
   253         16  FILLER          PIC X(4)    VALUE '631K'.
   254     12  MAP-LENGTH          PIC 9(4)   VALUE 359 BINARY.
   255     12  TIME-MT                 PIC S9(7).
   256     12  TIME-MT-R  REDEFINES TIME-MT.
   257         16  FILLER              PIC X.
   258         16  TIME-LMT            PIC 99V99.
   259         16  FILLER              PIC X(2).
   260     12  GETMAIN-SPACE           PIC X VALUE SPACES.
   261     12  ERENDT-LENGTH           PIC S9(04) VALUE +579 COMP.
   262     12  ERPNDB-LENGTH           PIC 9(04)  VALUE 585 COMP.
   263     12  ERCNOT-LENGTH           PIC S9(04) VALUE +150 COMP.
   264     12  ERNOTE-LENGTH           PIC S9(04) VALUE +825 COMP.
   265     12  ELEOBC-LENGTH           PIC S9(04) VALUE +350 COMP.
   266     12  W-CNTL-KEY.
   267         16  W-CNTL-COMPANY-ID   PIC  X(03).
   268         16  W-CNTL-RECORD-TYPE  PIC  X(01)   VALUE '1'.
   269         16  W-CNTL-GENL.
   270             20  W-CNTL-GEN1     PIC  X(02)   VALUE SPACES.
   271             20  W-CNTL-GEN2.
   272                 24 W-CNTL-GEN3  PIC  X(01)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page   7
* EL6318.cbl
   273                 24 W-CNTL-GEN4  PIC  X(01)   VALUE SPACES.
   274         16  W-CNTL-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
   275     12  WS-ELCERT-KEY.
   276         16  W-CERT-COMPANY-CD   PIC X.
   277         16  W-CERT-CARRIER      PIC X.
   278         16  W-CERT-GROUPING     PIC X(6).
   279         16  W-CERT-STATE        PIC XX.
   280         16  W-CERT-ACCOUNT      PIC X(10).
   281         16  W-CERT-CERT-EFF-DT  PIC XX.
   282         16  W-CERT-CERT-PRIME   PIC X(10).
   283         16  W-CERT-CERT-SFX     PIC X.
   284     12  WS-ELEOBC-KEY.
   285         16  WS-EOBC-COMPANY-CD  PIC X.
   286         16  WS-EOBC-REC-TYPE    PIC X.
   287         16  WS-EOBC-CODE        PIC X(4).
   288         16  FILLER              PIC X(9).
   289     12  WS-ERNOTE-KEY.
   290         16  W-NOTE-COMPANY-CD   PIC X.
   291         16  W-NOTE-CARRIER      PIC X.
   292         16  W-NOTE-GROUPING     PIC X(6).
   293         16  W-NOTE-STATE        PIC XX.
   294         16  W-NOTE-ACCOUNT      PIC X(10).
   295         16  W-NOTE-CERT-EFF-DT  PIC XX.
   296         16  W-NOTE-CERT-PRIME   PIC X(10).
   297         16  W-NOTE-CERT-SFX     PIC X.
   298     12  ELLETR-KEY.
   299         16  LETR-PART-KEY.
   300             20  LETR-COMPANY-CD PIC X.
   301             20  LETR-LETTER-ID  PIC X(4).
   302         16  LETR-FILLER         PIC X(8).
   303         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   304     12  ELLETR-SAVE-PART-KEY    PIC X(5).
   305     12  ERPNDB2-KEY.
   306         16  PNDB2-COMPANY-CD    PIC X.
   307         16  PNDB2-CARRIER       PIC X.
   308         16  PNDB2-GROUPING      PIC X(6).
   309         16  PNDB2-STATE         PIC XX.
   310         16  PNDB2-ACCOUNT       PIC X(10).
   311         16  PNDB2-CERT-EFF-DT   PIC XX.
   312         16  PNDB2-CERT-PRIME    PIC X(10).
   313         16  PNDB2-CERT-SFX      PIC X.
   314         16  PNDB2-CHG-SEQ-NO    PIC 9(4) BINARY.
   315         16  PNDB2-RECORD-TYPE   PIC X.
   316     12  ERPNDB-KEY.
   317         16  PNDB-COMPANY-CD     PIC X.
   318         16  PNDB-BATCH-NO       PIC X(6).
   319         16  PNDB-BATCH-SEQ-NO   PIC 9(4) BINARY.
   320         16  PNDB-CHG-SEQ-NO     PIC 9(4) BINARY.
   321     12  ERENDT-KEY.
   322         16  ENDT-COMPANY-CD       PIC X.
   323         16  ENDT-CARRIER          PIC X.
   324         16  ENDT-GROUPING         PIC X(6).
   325         16  ENDT-STATE            PIC XX.
   326         16  ENDT-ACCOUNT          PIC X(10).
   327         16  ENDT-CERT-EFF-DT      PIC XX.
   328         16  ENDT-CERT-PRIME       PIC X(10).
   329         16  ENDT-CERT-SFX         PIC X.
   330         16  ENDT-RECORD-TYPE      PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page   8
* EL6318.cbl
   331         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   332     12  ELCRTO-KEY.
   333         16  CRTO-COMPANY-CD     PIC X.
   334         16  CRTO-CARRIER        PIC X.
   335         16  CRTO-GROUPING       PIC X(6).
   336         16  CRTO-STATE          PIC XX.
   337         16  CRTO-ACCOUNT        PIC X(10).
   338         16  CRTO-CERT-EFF-DT    PIC XX.
   339         16  CRTO-CERT-PRIME     PIC X(10).
   340         16  CRTO-CERT-SFX       PIC X.
   341         16  CRTO-RECORD-TYPE    PIC X.
   342         16  CRTO-SEQ-NO         PIC 9(4) BINARY.
   343     12  WS-ERMAIL-KEY.
   344         16  MAIL-COMPANY-CD     PIC X.
   345         16  MAIL-CARRIER        PIC X.
   346         16  MAIL-GROUPING       PIC X(6).
   347         16  MAIL-STATE          PIC XX.
   348         16  MAIL-ACCOUNT        PIC X(10).
   349         16  MAIL-CERT-EFF-DT    PIC XX.
   350         16  MAIL-CERT-PRIME     PIC X(10).
   351         16  MAIL-CERT-SFX       PIC X.
   352     12  WS-LF-CANC-DT           PIC XX   VALUE LOW-VALUES.
   353     12  WS-AH-CANC-DT           PIC XX   VALUE LOW-VALUES.
   354     12  WS-CURRENT-DT.
   355         16  FILLER              PIC X(6)    VALUE SPACES.
   356         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   357     12  WS-CURRENT-BIN-DT       PIC XX    VALUE LOW-VALUES.
   358     12  WS-ISS-CAN-SW           PIC X     VALUE LOW-VALUES.
   359         88  CANCEL-REC            VALUE 'C'.
   360         88  ISSUE-REC             VALUE 'I'.
   361     12  WS-WORK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
   362     12  WS-HOLD-ACCT-KEY        PIC X(26) VALUE LOW-VALUES.
   363     12  ELCNTL-KEY.
   364         16  CNTL-COMP-ID        PIC X(3)  VALUE SPACES.
   365         16  CNTL-REC-TYPE       PIC X     VALUE SPACES.
   366         16  CNTL-ACCESS.
   367             20  CNTL-STATE      PIC XX    VALUE SPACES.
   368             20  FILLER          PIC X     VALUE SPACES.
   369             20  CNTL-CARRIER    PIC X     VALUE SPACES.
   370         16  CNTL-SEQ            PIC S9(4) VALUE +0 COMP.
   371     12  WS-ERACCT-KEY.
   372         16  ACCT-COMPANY-CD     PIC X.
   373         16  ACCT-CARRIER        PIC X.
   374         16  ACCT-GROUPING       PIC X(6).
   375         16  ACCT-STATE          PIC XX.
   376         16  ACCT-ACCOUNT        PIC X(10).
   377         16  ACCT-EXP-DATE       PIC XX    VALUE SPACES.
   378         16  FILLER              PIC X(4)  VALUE LOW-VALUES.
   379     12  ERACCT-SAVE-KEY         PIC X(20) VALUE SPACES.
   380     12  WS-ELCERT-FILE-ID       PIC X(8) VALUE 'ELCERT'.
   381     12  WS-ELCNTL-FILE-ID       PIC X(8) VALUE 'ELCNTL'.
   382     12  WS-ERNOTE-FILE-ID       PIC X(8) VALUE 'ERNOTE'.
   383     12  WS-ELCRTO-FILE-ID       PIC X(8) VALUE 'ELCRTO'.
   384     12  WS-ERENDT-FILE-ID       PIC X(8) VALUE 'ERENDT'.
   385     12  WS-ERPNDB2-FILE-ID      PIC X(8) VALUE 'ERPNDB2'.
   386     12  WS-ERPNDB-FILE-ID       PIC X(8) VALUE 'ERPNDB'.
   387     12  WS-ERACCT2-FILE-ID      PIC X(8) VALUE 'ERACCT2'.
   388     12  WS-ERCNOT-FILE-ID       PIC X(8) VALUE 'ERCNOT'.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page   9
* EL6318.cbl
   389     12  WS-ELEOBC-FILE-ID       PIC X(8) VALUE 'ELEOBC'.
   390     12  WS-RESPONSE             PIC S9(8)   COMP.
   391         88  RESP-NORMAL                  VALUE +00.
   392         88  RESP-NOTFND                  VALUE +13.
   393         88  RESP-DUPREC                  VALUE +14.
   394         88  RESP-DUPKEY                  VALUE +15.
   395         88  RESP-NOTOPEN                 VALUE +19.
   396         88  RESP-ENDFILE                 VALUE +20.
   397     12  MAP-NAME            PIC X(8)    VALUE 'EL631K'.
   398     12  MAPSET-NAME         PIC X(8)    VALUE 'EL6318S'.
   399     12  SCREEN-NUMBER       PIC X(4)    VALUE '631K'.
   400     12  TRANS-ID            PIC X(4)    VALUE 'EXBE'.
   401     12  THIS-PGM            PIC X(8)    VALUE 'EL6318'.
   402     12  PGM-NAME            PIC X(8).
   403     12  TIME-IN             PIC S9(7).
   404     12  TIME-OUT-R  REDEFINES TIME-IN.
   405         16  FILLER          PIC X.
   406         16  TIME-OUT        PIC 99V99.
   407         16  FILLER          PIC X(2).
   408     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   409     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   410     12  XCTL-626            PIC X(8)    VALUE 'EL626'.
   411     12  XCTL-6311           PIC X(8)    VALUE 'EL6311'.
   412     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   413     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   414     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   415     12  WS-PHONE.
   416         16  WS-PH1              PIC XXX.
   417         16  WS-PH2              PIC XXX.
   418         16  WS-PH3              PIC XXXX.
   419     12  WS-PHONE-NUM REDEFINES WS-PHONE PIC 9(10).
   420     12  WS-DEV-RT               PIC S9V9(6) COMP-3.
   421
   422     12  WS-BILLING-NOTE.
   423         16  WS-BN-NOTE          PIC X(25).
   424         16  WS-BN-LTRID         PIC X(4).
   425         16  FILLER              PIC X(3).
   426         16  WS-BN-DATE          PIC X(8).
   427         16  FILLER              PIC X(3).
   428         16  WS-BN-USERID        PIC X(4).
   429         16  FILLER              PIC X(30).
   430     12  WS-MANUAL-BILL-NOTE REDEFINES WS-BILLING-NOTE.
   431         16  WS-MAN-BN-NOTE      PIC X(63).
   432         16  FILLER              PIC X(14).
   433     12  WS-LEN                  PIC S9(5) COMP-3 VALUE +0.
   434
   435     12  WS-SAVE-REASON-CODE-IND PIC X(26).
   436
   437 01  NEW-ELCRTO-REC.
   438     12  NEW-ELCRTO-KEY.
   439         16  NCRTO-COMPANY-CD      PIC X.
   440         16  NCRTO-CARRIER         PIC X.
   441         16  NCRTO-GROUPING        PIC X(6).
   442         16  NCRTO-STATE           PIC XX.
   443         16  NCRTO-ACCOUNT         PIC X(10).
   444         16  NCRTO-CERT-EFF-DT     PIC XX.
   445         16  NCRTO-CERT-PRIME      PIC X(10).
   446         16  NCRTO-CERT-SFX        PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  10
* EL6318.cbl
   447         16  NCRTO-RECORD-TYPE     PIC X.
   448         16  NCRTO-SEQ-NO          PIC 9(4) BINARY.
   449     12  NEW-ORIG-REC.
   450         16  NCRTO-INS-LAST-NAME   PIC X(15).
   451         16  NCRTO-INS-FIRST-NAME  PIC X(10).
   452         16  NCRTO-INS-MIDDLE-INIT PIC X.
   453         16  NCRTO-INS-AGE         PIC S999     COMP-3.
   454         16  NCRTO-JNT-LAST-NAME   PIC X(15).
   455         16  NCRTO-JNT-FIRST-NAME  PIC X(10).
   456         16  NCRTO-JNT-MIDDLE-INIT PIC X.
   457         16  NCRTO-JNT-AGE         PIC S999     COMP-3.
   458         16  NCRTO-LF-BENCD        PIC XX.
   459         16  NCRTO-LF-TERM         PIC S999      COMP-3.
   460         16  NCRTO-LF-BEN-AMT      PIC S9(9)V99  COMP-3.
   461         16  NCRTO-LF-PRM-AMT      PIC S9(7)V99  COMP-3.
   462         16  NCRTO-LF-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
   463         16  NCRTO-LF-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
   464         16  NCRTO-LF-EXP-DT       PIC XX.
   465         16  NCRTO-LF-COMM-PCT     PIC SV9(5)    COMP-3.
   466         16  NCRTO-LF-CANCEL-DT    PIC XX.
   467         16  NCRTO-LF-CANCEL-AMT   PIC S9(7)V99  COMP-3.
   468         16  NCRTO-LF-ITD-CANCEL-AMT PIC S9(7)V99 COMP-3.
   469         16  NCRTO-AH-BENCD        PIC XX.
   470         16  NCRTO-AH-TERM         PIC S999      COMP-3.
   471         16  NCRTO-AH-BEN-AMT      PIC S9(9)V99  COMP-3.
   472         16  NCRTO-AH-PRM-AMT      PIC S9(7)V99  COMP-3.
   473         16  NCRTO-AH-EXP-DT       PIC XX.
   474         16  NCRTO-AH-COMM-PCT     PIC SV9(5)    COMP-3.
   475         16  NCRTO-AH-CP           PIC 99.
   476         16  NCRTO-AH-CANCEL-DT    PIC XX.
   477         16  NCRTO-AH-CANCEL-AMT   PIC S9(7)V99  COMP-3.
   478         16  NCRTO-AH-ITD-CANCEL-AMT PIC S9(7)V99 COMP-3.
   479         16  NCRTO-CRED-BENE-NAME  PIC X(25).
   480         16  NCRTO-1ST-PMT-DT      PIC XX.
   481         16  FILLER                PIC X(239).
   482
   483 01  CERT-NOTE-ENTRIES.
   484     12  CERT-NT OCCURS 300 TIMES INDEXED BY TB-INDX TB-INDX1.
   485         16  CERT-NT-TEXT                PIC X(63).
   486         16  CERT-NT-LAST-MAINT-BY       PIC XXXX.
   487         16  CERT-NT-LAST-MAINT-DT       PIC XX.
   488         16  CERT-NT-LAST-MAINT-HHMMSS   PIC S9(7) COMP-3.
   489
   490 01  ERCNOT-AREA.
   491     12  ERCNOT-KEY-LENGTH       PIC S9(4)   COMP VALUE +36.
   492     12  ERCNOT-START-LENGTH     PIC S9(4)   COMP VALUE +34.
   493     12  ERCNOT-KEY.
   494         16  ERCNOT-PARTIAL-KEY.
   495             20 ERCNOT-COMPANY-CD    PIC X.
   496             20 ERCNOT-CARRIER       PIC X.
   497             20 ERCNOT-GROUPING      PIC X(06).
   498             20 ERCNOT-STATE         PIC XX.
   499             20 ERCNOT-ACCOUNT       PIC X(10).
   500             20 ERCNOT-EFF-DT        PIC XX.
   501             20 ERCNOT-CERT-NO.
   502                25 ERCNOT-CERT-PRIME PIC X(10).
   503                25 ERCNOT-CERT-SFX   PIC X.
   504             20 ERCNOT-REC-TYP       PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  11
* EL6318.cbl
   505         16 ERCNOT-SEQ           PIC S9(4) COMP.
   506     12  SV-PARTIAL-KEY.
   507         20 SV-COMPANY-CD            PIC X.
   508         20 SV-CARRIER               PIC X.
   509         20 SV-GROUPING              PIC X(06).
   510         20 SV-STATE                 PIC XX.
   511         20 SV-ACCOUNT               PIC X(10).
   512         20 SV-EFF-DT                PIC XX.
   513         20 SV-CERT-NO.
   514            25 SV-CERT-PRIME         PIC X(10).
   515            25 SV-CERT-SFX           PIC X(1).
   516         20 SV-REC-TYP               PIC X.
   517 01  ERROR-MESSAGES.
   518     12  ER-0000                 PIC X(4)  VALUE '0000'.
   519     12  ER-0004                 PIC X(4)  VALUE '0004'.
   520     12  ER-0008                 PIC X(4)  VALUE '0008'.
   521     12  ER-0023                 PIC X(4)  VALUE '0023'.
   522     12  ER-0029                 PIC X(4)  VALUE '0029'.
   523     12  ER-0068                 PIC X(4)  VALUE '0068'.
   524     12  ER-0132                 PIC X(4)  VALUE '0132'.
   525     12  ER-0142                 PIC X(4)  VALUE '0142'.
   526     12  ER-0148                 PIC X(4)  VALUE '0148'.
   527     12  ER-0215                 PIC X(4)  VALUE '0215'.
   528     12  ER-0280                 PIC X(4)  VALUE '0280'.
   529     12  ER-0348                 PIC X(4)  VALUE '0348'.
   530     12  ER-0419                 PIC X(4)  VALUE '0419'.
   531     12  ER-0715                 PIC X(4)  VALUE '0715'.
   532     12  ER-0894                 PIC X(4)  VALUE '0894'.
   533     12  ER-1101                 PIC X(4)  VALUE '1101'.
   534     12  ER-1236                 PIC X(4)  VALUE '1236'.
   535     12  ER-1778                 PIC X(4)  VALUE '1778'.
   536     12  ER-1818                 PIC X(4)  VALUE '1818'.
   537     12  ER-1820                 PIC X(4)  VALUE '1820'.
   538     12  ER-1821                 PIC X(4)  VALUE '1821'.
   539     12  ER-2056                 PIC X(4)  VALUE '2056'.
   540     12  ER-2079                 PIC X(4)  VALUE '2079'.
   541     12  ER-2208                 PIC X(4)  VALUE '2208'.
   542     12  ER-2209                 PIC X(4)  VALUE '2209'.
   543     12  ER-2237                 PIC X(4)  VALUE '2237'.
   544     12  ER-2238                 PIC X(4)  VALUE '2238'.
   545     12  ER-2253                 PIC X(4)  VALUE '2253'.
   546     12  ER-2619                 PIC X(4)  VALUE '2619'.
   547     12  ER-2651                 PIC X(4)  VALUE '2651'.
   548     12  ER-2784                 PIC X(4)  VALUE '2784'.
   549     12  ER-2785                 PIC X(4)  VALUE '2785'.
   550     12  ER-2786                 PIC X(4)  VALUE '2786'.
   551     12  ER-2791                 PIC X(4)  VALUE '2791'.
   552     12  ER-2845                 PIC X(4)  VALUE '2845'.
   553     12  ER-2848                 PIC X(4)  VALUE '2848'.
   554     12  ER-2851                 PIC X(4)  VALUE '2851'.
   555     12  ER-3830                 PIC X(4)  VALUE '3830'.
   556     12  ER-3833                 PIC X(4)  VALUE '3833'.
   557     12  ER-7345                 PIC X(4)  VALUE '7345'.
   558     12  ER-7638                 PIC X(4)  VALUE '7638'.
   559     12  ER-8888                 PIC X(4)  VALUE '8888'.
   560     12  ER-9999                 PIC X(4)  VALUE '9999'.
   561*    COPY ELCDATE.
   562******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  12
* EL6318.cbl
   563*                                                                *
   564*                                                                *
   565*                            ELCDATE.                            *
   566*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   567*                            VMOD=2.003
   568*                                                                *
   569*                                                                *
   570*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   571*                 LENGTH = 200                                   *
   572******************************************************************
   573
   574 01  DATE-CONVERSION-DATA.
   575     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   576     12  DC-OPTION-CODE                PIC X.
   577         88  BIN-TO-GREG                VALUE ' '.
   578         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   579         88  EDIT-GREG-TO-BIN           VALUE '2'.
   580         88  YMD-GREG-TO-BIN            VALUE '3'.
   581         88  MDY-GREG-TO-BIN            VALUE '4'.
   582         88  JULIAN-TO-BIN              VALUE '5'.
   583         88  BIN-PLUS-ELAPSED           VALUE '6'.
   584         88  FIND-CENTURY               VALUE '7'.
   585         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   586         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   587         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   588         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   589         88  JULIAN-TO-BIN-3            VALUE 'C'.
   590         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   591         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   592         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   593         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   594         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   595         88  CHECK-LEAP-YEAR            VALUE 'H'.
   596         88  BIN-3-TO-GREG              VALUE 'I'.
   597         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   598         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   599         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   600         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   601         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   602         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   603         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   604         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   605         88  THREE-CHARACTER-BIN
   606                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   607         88  GREGORIAN-TO-BIN
   608                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   609         88  BIN-TO-GREGORIAN
   610                  VALUES ' ' '1' 'I' '8' 'G'.
   611         88  JULIAN-TO-BINARY
   612                  VALUES '5' 'C' 'E' 'F'.
   613     12  DC-ERROR-CODE                 PIC X.
   614         88  NO-CONVERSION-ERROR        VALUE ' '.
   615         88  DATE-CONVERSION-ERROR
   616                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   617         88  DATE-IS-ZERO               VALUE '1'.
   618         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   619         88  DATE-IS-INVALID            VALUE '3'.
   620         88  DATE1-GREATER-DATE2        VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  13
* EL6318.cbl
   621         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   622         88  DATE-INVALID-OPTION        VALUE '9'.
   623         88  INVALID-CENTURY            VALUE 'A'.
   624         88  ONLY-CENTURY               VALUE 'B'.
   625         88  ONLY-LEAP-YEAR             VALUE 'C'.
   626         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   627     12  DC-END-OF-MONTH               PIC X.
   628         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   629     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   630         88  USE-NORMAL-PROCESS         VALUE ' '.
   631         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   632         88  ADJUST-UP-100-YRS          VALUE '2'.
   633     12  FILLER                        PIC X.
   634     12  DC-CONVERSION-DATES.
   635         16  DC-BIN-DATE-1             PIC XX.
   636         16  DC-BIN-DATE-2             PIC XX.
   637         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   638         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   639                       DC-GREG-DATE-1-EDIT.
   640             20  DC-EDIT1-MONTH        PIC 99.
   641             20  SLASH1-1              PIC X.
   642             20  DC-EDIT1-DAY          PIC 99.
   643             20  SLASH1-2              PIC X.
   644             20  DC-EDIT1-YEAR         PIC 99.
   645         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   646         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   647                     DC-GREG-DATE-2-EDIT.
   648             20  DC-EDIT2-MONTH        PIC 99.
   649             20  SLASH2-1              PIC X.
   650             20  DC-EDIT2-DAY          PIC 99.
   651             20  SLASH2-2              PIC X.
   652             20  DC-EDIT2-YEAR         PIC 99.
   653         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   654         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   655                     DC-GREG-DATE-1-YMD.
   656             20  DC-YMD-YEAR           PIC 99.
   657             20  DC-YMD-MONTH          PIC 99.
   658             20  DC-YMD-DAY            PIC 99.
   659         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   660         16  DC-GREG-DATE-1-MDY-R REDEFINES
   661                      DC-GREG-DATE-1-MDY.
   662             20  DC-MDY-MONTH          PIC 99.
   663             20  DC-MDY-DAY            PIC 99.
   664             20  DC-MDY-YEAR           PIC 99.
   665         16  DC-GREG-DATE-1-ALPHA.
   666             20  DC-ALPHA-MONTH        PIC X(10).
   667             20  DC-ALPHA-DAY          PIC 99.
   668             20  FILLER                PIC XX.
   669             20  DC-ALPHA-CENTURY.
   670                 24 DC-ALPHA-CEN-N     PIC 99.
   671             20  DC-ALPHA-YEAR         PIC 99.
   672         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   673         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   674         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   675         16  DC-JULIAN-DATE            PIC 9(05).
   676         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   677                                       PIC 9(05).
   678         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  14
* EL6318.cbl
   679             20  DC-JULIAN-YEAR        PIC 99.
   680             20  DC-JULIAN-DAYS        PIC 999.
   681         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   682         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   683         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   684     12  DATE-CONVERSION-VARIBLES.
   685         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   686         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   687             20  FILLER                PIC 9(3).
   688             20  HOLD-CEN-1-CCYY.
   689                 24  HOLD-CEN-1-CC     PIC 99.
   690                 24  HOLD-CEN-1-YY     PIC 99.
   691             20  HOLD-CEN-1-MO         PIC 99.
   692             20  HOLD-CEN-1-DA         PIC 99.
   693         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   694             20  HOLD-CEN-1-R-MO       PIC 99.
   695             20  HOLD-CEN-1-R-DA       PIC 99.
   696             20  HOLD-CEN-1-R-CCYY.
   697                 24  HOLD-CEN-1-R-CC   PIC 99.
   698                 24  HOLD-CEN-1-R-YY   PIC 99.
   699             20  FILLER                PIC 9(3).
   700         16  HOLD-CENTURY-1-X.
   701             20  FILLER                PIC X(3)  VALUE SPACES.
   702             20  HOLD-CEN-1-X-CCYY.
   703                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   704                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   705             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   706             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   707         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   708             20  HOLD-CEN-1-R-X-MO     PIC XX.
   709             20  HOLD-CEN-1-R-X-DA     PIC XX.
   710             20  HOLD-CEN-1-R-X-CCYY.
   711                 24  HOLD-CEN-1-R-X-CC PIC XX.
   712                 24  HOLD-CEN-1-R-X-YY PIC XX.
   713             20  FILLER                PIC XXX.
   714         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   715         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   716         16  DC-JULIAN-DATE-1          PIC 9(07).
   717         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   718             20  DC-JULIAN-1-CCYY.
   719                 24  DC-JULIAN-1-CC    PIC 99.
   720                 24  DC-JULIAN-1-YR    PIC 99.
   721             20  DC-JULIAN-DA-1        PIC 999.
   722         16  DC-JULIAN-DATE-2          PIC 9(07).
   723         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   724             20  DC-JULIAN-2-CCYY.
   725                 24  DC-JULIAN-2-CC    PIC 99.
   726                 24  DC-JULIAN-2-YR    PIC 99.
   727             20  DC-JULIAN-DA-2        PIC 999.
   728         16  DC-GREG-DATE-A-EDIT.
   729             20  DC-EDITA-MONTH        PIC 99.
   730             20  SLASHA-1              PIC X VALUE '/'.
   731             20  DC-EDITA-DAY          PIC 99.
   732             20  SLASHA-2              PIC X VALUE '/'.
   733             20  DC-EDITA-CCYY.
   734                 24  DC-EDITA-CENT     PIC 99.
   735                 24  DC-EDITA-YEAR     PIC 99.
   736         16  DC-GREG-DATE-B-EDIT.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  15
* EL6318.cbl
   737             20  DC-EDITB-MONTH        PIC 99.
   738             20  SLASHB-1              PIC X VALUE '/'.
   739             20  DC-EDITB-DAY          PIC 99.
   740             20  SLASHB-2              PIC X VALUE '/'.
   741             20  DC-EDITB-CCYY.
   742                 24  DC-EDITB-CENT     PIC 99.
   743                 24  DC-EDITB-YEAR     PIC 99.
   744         16  DC-GREG-DATE-CYMD         PIC 9(08).
   745         16  DC-GREG-DATE-CYMD-R REDEFINES
   746                              DC-GREG-DATE-CYMD.
   747             20  DC-CYMD-CEN           PIC 99.
   748             20  DC-CYMD-YEAR          PIC 99.
   749             20  DC-CYMD-MONTH         PIC 99.
   750             20  DC-CYMD-DAY           PIC 99.
   751         16  DC-GREG-DATE-MDCY         PIC 9(08).
   752         16  DC-GREG-DATE-MDCY-R REDEFINES
   753                              DC-GREG-DATE-MDCY.
   754             20  DC-MDCY-MONTH         PIC 99.
   755             20  DC-MDCY-DAY           PIC 99.
   756             20  DC-MDCY-CEN           PIC 99.
   757             20  DC-MDCY-YEAR          PIC 99.
   758    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   759        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   760    12  DC-EL310-DATE                  PIC X(21).
   761    12  FILLER                         PIC X(28).
   762*    COPY ELCTEXT.
   763******************************************************************
   764*                                                                *
   765*                                                                *
   766*                            ELCTEXT.                            *
   767*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   768*                            VMOD=2.008                          *
   769*                                                                *
   770*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
   771*                                     FORM LETTERS,              *
   772*                                     CERT FORM DISPLAY.
   773*                                                                *
   774*   FILE TYPE = VSAM,KSDS                                        *
   775*   RECORD SIZE = 100   RECFORM = FIXED                          *
   776*                                                                *
   777*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
   778*       ALTERNATE INDEX = NONE                                   *
   779*                                                                *
   780*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
   781*       ALTERNATE INDEX = NONE                                   *
   782*                                                                *
   783*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
   784*       ALTERNATE INDEX = NONE                                   *
   785*                                                                *
   786*   LOG = NO                                                     *
   787*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   788******************************************************************
   789 01  TEXT-FILES.
   790     12  TEXT-FILE-ID                PIC XX.
   791         88  FORMS-FILE-TEXT            VALUE 'TF'.
   792         88  LETTER-FILE-TEXT           VALUE 'TL'.
   793         88  HELP-FILE-TEXT             VALUE 'TH'.
   794
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  16
* EL6318.cbl
   795     12  TX-CONTROL-PRIMARY.
   796         16  TX-COMPANY-CD           PIC X.
   797             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
   798         16  TX-ACCESS-CD-GENL       PIC X(12).
   799
   800         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   801             20  TX-LETTER-NO        PIC X(4).
   802             20  FILLER              PIC X(8).
   803
   804         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   805             20  TX-FORM-NO          PIC X(12).
   806
   807         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   808             20  TX-HELP-TYPE        PIC X.
   809                 88  HELP-FOR-GENERAL   VALUE ' '.
   810                 88  HELP-BY-SCREEN     VALUE 'S'.
   811                 88  HELP-BY-ERROR      VALUE 'E'.
   812             20  TX-SCREEN-OR-ERROR  PIC X(4).
   813                 88  GENERAL-INFO-HELP  VALUE '0000'.
   814             20  TX-HELP-FOR-COMPANY  PIC XXX.
   815                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
   816             20  FILLER              PIC X(4).
   817
   818         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
   819
   820     12  TX-PROCESS-CONTROL          PIC XX.
   821         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
   822
   823     12  TX-TEXT-LINE                PIC X(70).
   824
   825     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
   826         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
   827         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
   828         88  TX-VALID-FORM-SQUEEZE-VALUE
   829                                        VALUE 'Y' ' '.
   830
   831     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
   832         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
   833         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
   834         88  TX-DO-NOT-ADJUST           VALUE 'N'.
   835         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
   836         88  TX-NEW-PARAGRAPH           VALUE 'P'.
   837         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
   838         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
   839                                              'K' 'N' ' '
   840                                              'Z'.
   841
   842     12  TX-ARCHIVE-SW               PIC X.
   843         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
   844         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
   845         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
   846
   847     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
   848     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
   849
   850     12  TX-BSR-CODE                 PIC X.
   851         88  TX-BSR-LETTER              VALUE 'B'.
   852         88  TX-NON-BSR-LETTER          VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  17
* EL6318.cbl
   853
   854     12  FILLER                      PIC X.
   855*****************************************************************
   856*    COPY ELCLOGOF.
   857******************************************************************
   858*                                                                *
   859*                                                                *
   860*                            ELCLOGOF.                           *
   861*                            VMOD=2.001                          *
   862*                                                                *
   863*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   864*                                                                *
   865******************************************************************
   866 01  CLASIC-LOGOFF.
   867     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   868     12  LOGOFF-TEXT.
   869         16  FILLER          PIC X(5)    VALUE SPACES.
   870         16  LOGOFF-MSG.
   871             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   872             20  FILLER      PIC X       VALUE SPACES.
   873             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   874         16  FILLER          PIC X(80)
   875           VALUE '* YOU ARE NOW LOGGED OFF'.
   876         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   877         16  FILLER          PIC X       VALUE QUOTE.
   878         16  LOGOFF-SYS-MSG  PIC X(17)
   879           VALUE 'S CLAS-IC SYSTEM '.
   880     12  TEXT-MESSAGES.
   881         16  UNACCESS-MSG    PIC X(29)
   882             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   883         16  PGMIDERR-MSG    PIC X(17)
   884             VALUE 'PROGRAM NOT FOUND'.
   885*    COPY ELCATTR.
   886******************************************************************
   887*                                                                *
   888*                            ELCATTR.                            *
   889*                            VMOD=2.001                          *
   890*                                                                *
   891*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   892*                                                                *
   893*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   894*                                                                *
   895*                   POS 1   P=PROTECTED                          *
   896*                           U=UNPROTECTED                        *
   897*                           S=ASKIP                              *
   898*                   POS 2   A=ALPHA/NUMERIC                      *
   899*                           N=NUMERIC                            *
   900*                   POS 3   N=NORMAL                             *
   901*                           B=BRIGHT                             *
   902*                           D=DARK                               *
   903*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   904*                           OF=MODIFIED DATA TAG OFF             *
   905*                                                                *
   906*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   907******************************************************************
   908 01  ATTRIBUTE-LIST.
   909     12  AL-PABOF            PIC X       VALUE 'Y'.
   910     12  AL-PABON            PIC X       VALUE 'Z'.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  18
* EL6318.cbl
   911     12  AL-PADOF            PIC X       VALUE '%'.
   912     12  AL-PADON            PIC X       VALUE '_'.
   913     12  AL-PANOF            PIC X       VALUE '-'.
   914     12  AL-PANON            PIC X       VALUE '/'.
   915     12  AL-SABOF            PIC X       VALUE '8'.
   916     12  AL-SABON            PIC X       VALUE '9'.
   917     12  AL-SADOF            PIC X       VALUE '@'.
   918     12  AL-SADON            PIC X       VALUE QUOTE.
   919     12  AL-SANOF            PIC X       VALUE '0'.
   920     12  AL-SANON            PIC X       VALUE '1'.
   921     12  AL-UABOF            PIC X       VALUE 'H'.
   922     12  AL-UABON            PIC X       VALUE 'I'.
   923     12  AL-UADOF            PIC X       VALUE '<'.
   924     12  AL-UADON            PIC X       VALUE '('.
   925     12  AL-UANOF            PIC X       VALUE ' '.
   926     12  AL-UANON            PIC X       VALUE 'A'.
   927     12  AL-UNBOF            PIC X       VALUE 'Q'.
   928     12  AL-UNBON            PIC X       VALUE 'R'.
   929     12  AL-UNDOF            PIC X       VALUE '*'.
   930     12  AL-UNDON            PIC X       VALUE ')'.
   931     12  AL-UNNOF            PIC X       VALUE '&'.
   932     12  AL-UNNON            PIC X       VALUE 'J'.
   933*    COPY ELCEMIB.
   934******************************************************************
   935*                                                                *
   936*                                                                *
   937*                            ELCEMIB.                            *
   938*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   939*                            VMOD=2.005                          *
   940*                                                                *
   941*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   942*                                                                *
   943******************************************************************
   944 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   945     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   946     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   947     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   948     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   949     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   950     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   951     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   952     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   953     12  EMI-SWITCH1             PIC X        VALUE '1'.
   954         88  EMI-NO-ERRORS                    VALUE '1'.
   955         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   956         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   957     12  EMI-SWITCH2             PIC X        VALUE '1'.
   958         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   959     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   960         88  EMI-AREA1-EMPTY                  VALUE '1'.
   961         88  EMI-AREA1-FULL                   VALUE '2'.
   962     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   963         88  EMI-AREA2-EMPTY                  VALUE '1'.
   964         88  EMI-AREA2-FULL                   VALUE '2'.
   965     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   966         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   967         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   968         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  19
* EL6318.cbl
   969         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   970         88  EMI-BYPASS-FATALS                VALUE 'X'.
   971     12  EMI-ERROR-LINES.
   972         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   973         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   974         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   975         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   976             20  EMI-ERR-CODES OCCURS 10 TIMES.
   977                 24  EMI-ERR-NUM         PIC X(4).
   978                 24  EMI-FILLER          PIC X.
   979                 24  EMI-SEV             PIC X.
   980                 24  FILLER              PIC X.
   981             20  FILLER                  PIC X(02).
   982     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   983         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   984             20  EMI-ERROR-NUMBER    PIC X(4).
   985             20  EMI-FILL            PIC X.
   986             20  EMI-SEVERITY        PIC X.
   987             20  FILLER              PIC X.
   988             20  EMI-ERROR-TEXT.
   989                 24  EMI-TEXT-VARIABLE   PIC X(10).
   990                 24  FILLER          PIC X(55).
   991     12  EMI-SEVERITY-SAVE           PIC X.
   992         88  EMI-NOTE                    VALUE 'N'.
   993         88  EMI-WARNING                 VALUE 'W'.
   994         88  EMI-FORCABLE                VALUE 'F'.
   995         88  EMI-FATAL                   VALUE 'X'.
   996     12  EMI-MESSAGE-FLAG            PIC X.
   997         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   998         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   999     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1000     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1001         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1002         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1003         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1004     12  FILLER                      PIC X(137)  VALUE SPACES.
  1005     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1006     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1007     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1008     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1009*    COPY ELCINTF.
  1010******************************************************************
  1011*                                                                *
  1012*                                                                *
  1013*                            ELCINTF.                            *
  1014*                            VMOD=2.017                          *
  1015*                                                                *
  1016*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1017*                                                                *
  1018*       LENGTH = 1024                                            *
  1019*                                                                *
  1020******************************************************************
  1021*                   C H A N G E   L O G
  1022*
  1023* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1024*-----------------------------------------------------------------
  1025*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1026* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  20
* EL6318.cbl
  1027*-----------------------------------------------------------------
  1028* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1029******************************************************************
  1030 01  PROGRAM-INTERFACE-BLOCK.
  1031     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1032     12  PI-CALLING-PROGRAM              PIC X(8).
  1033     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1034     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1035     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1036     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1037     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1038     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1039     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1040     12  PI-COMPANY-ID                   PIC XXX.
  1041     12  PI-COMPANY-CD                   PIC X.
  1042
  1043     12  PI-COMPANY-PASSWORD             PIC X(8).
  1044
  1045     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1046
  1047     12  PI-CONTROL-IN-PROGRESS.
  1048         16  PI-CARRIER                  PIC X.
  1049         16  PI-GROUPING                 PIC X(6).
  1050         16  PI-STATE                    PIC XX.
  1051         16  PI-ACCOUNT                  PIC X(10).
  1052         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1053                                         PIC X(10).
  1054         16  PI-CLAIM-CERT-GRP.
  1055             20  PI-CLAIM-NO             PIC X(7).
  1056             20  PI-CERT-NO.
  1057                 25  PI-CERT-PRIME       PIC X(10).
  1058                 25  PI-CERT-SFX         PIC X.
  1059             20  PI-CERT-EFF-DT          PIC XX.
  1060         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1061             20  PI-PLAN-CODE            PIC X(2).
  1062             20  PI-REVISION-NUMBER      PIC X(3).
  1063             20  PI-PLAN-EFF-DT          PIC X(2).
  1064             20  PI-PLAN-EXP-DT          PIC X(2).
  1065             20  FILLER                  PIC X(11).
  1066         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1067             20  PI-OE-REFERENCE-1.
  1068                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1069                 25  PI-OE-REF-1-SUFF    PIC XX.
  1070
  1071     12  PI-SESSION-IN-PROGRESS          PIC X.
  1072         88  CLAIM-SESSION                   VALUE '1'.
  1073         88  CREDIT-SESSION                  VALUE '2'.
  1074         88  WARRANTY-SESSION                VALUE '3'.
  1075         88  MORTGAGE-SESSION                VALUE '4'.
  1076         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1077
  1078
  1079*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1080
  1081     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1082     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1083
  1084     12  PI-CREDIT-USER                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  21
* EL6318.cbl
  1085         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1086         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1087
  1088     12  PI-CLAIM-USER                   PIC X.
  1089         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1090         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1091
  1092     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1093         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1094         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1095         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1096         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1097         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1098
  1099     12  PI-PROCESSOR-ID                 PIC X(4).
  1100
  1101     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1102
  1103     12  PI-MEMBER-CAPTION               PIC X(10).
  1104
  1105     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1106         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1107
  1108     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1109     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1110     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1111     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1112
  1113     12  PI-AH-OVERRIDE-L1               PIC X.
  1114     12  PI-AH-OVERRIDE-L2               PIC XX.
  1115     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1116     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1117
  1118     12  PI-NEW-SYSTEM                   PIC X(2).
  1119
  1120     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1121     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1122         88  PI-USES-PAID-TO                 VALUE '1'.
  1123     12  PI-CRDTCRD-SYSTEM.
  1124         16  PI-CRDTCRD-USER             PIC X.
  1125             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1126             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1127         16  PI-CC-MONTH-END-DT          PIC XX.
  1128     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1129
  1130     12  PI-OE-REFERENCE-2.
  1131         16  PI-OE-REF-2-PRIME           PIC X(10).
  1132         16  PI-OE-REF-2-SUFF            PIC X.
  1133
  1134     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1135
  1136     12  PI-LANGUAGE-TYPE                PIC X.
  1137             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1138             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1139             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1140
  1141     12  PI-POLICY-LINKAGE-IND           PIC X.
  1142         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  22
* EL6318.cbl
  1143         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1144                                                   LOW-VALUES.
  1145
  1146     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1147     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1148         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1149         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1150
  1151     12  PI-PROCESSOR-CSR-IND            PIC X.
  1152         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1153         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1154
  1155     12  FILLER                          PIC X(3).
  1156
  1157     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1158
  1159     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1160         PI-SYSTEM-LEVEL.
  1161
  1162         16  PI-ENTRY-CODES.
  1163             20  PI-ENTRY-CD-1           PIC X.
  1164             20  PI-ENTRY-CD-2           PIC X.
  1165
  1166         16  PI-RETURN-CODES.
  1167             20  PI-RETURN-CD-1          PIC X.
  1168             20  PI-RETURN-CD-2          PIC X.
  1169
  1170         16  PI-UPDATE-STATUS-SAVE.
  1171             20  PI-UPDATE-BY            PIC X(4).
  1172             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1173
  1174         16  PI-LOWER-CASE-LETTERS       PIC X.
  1175             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1176
  1177*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1178*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1179*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1180
  1181         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1182             88  ST-ACCNT-CNTL               VALUE ' '.
  1183             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1184             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1185             88  ACCNT-CNTL                  VALUE '3'.
  1186             88  CARR-ACCNT-CNTL             VALUE '4'.
  1187
  1188         16  PI-PROCESSOR-CAP-LIST.
  1189             20  PI-SYSTEM-CONTROLS.
  1190                24 PI-SYSTEM-DISPLAY     PIC X.
  1191                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1192                24 PI-SYSTEM-MODIFY      PIC X.
  1193                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1194             20  FILLER                  PIC XX.
  1195             20  PI-DISPLAY-CAP          PIC X.
  1196                 88  DISPLAY-CAP             VALUE 'Y'.
  1197             20  PI-MODIFY-CAP           PIC X.
  1198                 88  MODIFY-CAP              VALUE 'Y'.
  1199             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1200                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  23
* EL6318.cbl
  1201             20  PI-FORCE-CAP            PIC X.
  1202                 88  FORCE-CAP               VALUE 'Y'.
  1203
  1204         16  PI-PROGRAM-CONTROLS.
  1205             20  PI-PGM-PRINT-OPT        PIC X.
  1206             20  PI-PGM-FORMAT-OPT       PIC X.
  1207             20  PI-PGM-PROCESS-OPT      PIC X.
  1208             20  PI-PGM-TOTALS-OPT       PIC X.
  1209
  1210         16  PI-HELP-INTERFACE.
  1211             20  PI-LAST-ERROR-NO        PIC X(4).
  1212             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1213
  1214         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1215             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1216
  1217         16  PI-CR-CONTROL-IN-PROGRESS.
  1218             20  PI-CR-CARRIER           PIC X.
  1219             20  PI-CR-GROUPING          PIC X(6).
  1220             20  PI-CR-STATE             PIC XX.
  1221             20  PI-CR-ACCOUNT           PIC X(10).
  1222             20  PI-CR-FIN-RESP          PIC X(10).
  1223             20  PI-CR-TYPE              PIC X.
  1224
  1225         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1226
  1227         16  PI-CR-MONTH-END-DT          PIC XX.
  1228
  1229         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1230             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1231             88  PI-ZERO-CARRIER             VALUE '1'.
  1232             88  PI-ZERO-GROUPING            VALUE '2'.
  1233             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1234
  1235         16  PI-CARRIER-SECURITY         PIC X.
  1236             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1237
  1238         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1239             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1240             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1241
  1242         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1243             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1244                                         INDEXED BY PI-ACCESS-NDX
  1245                                         PIC X.
  1246
  1247         16  PI-GA-BILLING-CONTROL       PIC X.
  1248             88  PI-GA-BILLING               VALUE '1'.
  1249
  1250         16  PI-MAIL-PROCESSING          PIC X.
  1251             88  PI-MAIL-YES                 VALUE 'Y'.
  1252
  1253         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1254
  1255         16  PI-AR-SYSTEM.
  1256             20  PI-AR-PROCESSING-CNTL   PIC X.
  1257                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1258             20  PI-AR-SUMMARY-CODE      PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  24
* EL6318.cbl
  1259             20  PI-AR-MONTH-END-DT      PIC XX.
  1260
  1261         16  PI-MP-SYSTEM.
  1262             20  PI-MORTGAGE-USER            PIC X.
  1263                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1264                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1265             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1266                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1267                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1268                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1269                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1270                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1271             20  PI-MP-MONTH-END-DT          PIC XX.
  1272             20  PI-MP-REFERENCE-NO.
  1273                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1274                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1275
  1276         16  PI-LABEL-CONTROL            PIC X(01).
  1277             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1278             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1279
  1280         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1281             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1282
  1283         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1284             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1285             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1286
  1287         16  FILLER                      PIC X(14).
  1288
  1289     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1290******************************************************************
  1291     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  1292        16  PI-ISS-CAN-SW           PIC X.
  1293        16  PI-ERENDT-KEY.
  1294            20  PI-ENDT-COMPANY-CD  PIC X.
  1295            20  PI-ENDT-CARRIER     PIC X.
  1296            20  PI-ENDT-GROUPING    PIC X(6).
  1297            20  PI-ENDT-STATE       PIC XX.
  1298            20  PI-ENDT-ACCOUNT     PIC X(10).
  1299            20  PI-ENDT-CERT-EFF-DT PIC XX.
  1300            20  PI-ENDT-CERT-PRIME  PIC X(10).
  1301            20  PI-ENDT-CERT-SFX    PIC X.
  1302            20  PI-ENDT-RECORD-TYPE PIC X.
  1303            20  PI-ENDT-SEQ-NO      PIC 9(4) BINARY.
  1304        16  PI-ELCRTO-KEY.
  1305            20  PI-CRTO-COMPANY-CD  PIC X.
  1306            20  PI-CRTO-CARRIER     PIC X.
  1307            20  PI-CRTO-GROUPING    PIC X(6).
  1308            20  PI-CRTO-STATE       PIC XX.
  1309            20  PI-CRTO-ACCOUNT     PIC X(10).
  1310            20  PI-CRTO-CERT-EFF-DT PIC XX.
  1311            20  PI-CRTO-CERT-PRIME  PIC X(10).
  1312            20  PI-CRTO-CERT-SFX    PIC X.
  1313            20  PI-CRTO-RECORD-TYPE PIC X.
  1314            20  PI-CRTO-SEQ-NO      PIC 9(4) BINARY.
  1315        16  PI-ERPNDB-KEY           PIC X(11).
  1316        16  PI-DOCUMENT-PROCESSED   PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  25
* EL6318.cbl
  1317            88  PI-VERI-PROCESSED      VALUE 'V'.
  1318            88  PI-ENDO-PROCESSED      VALUE 'G'.
  1319        16  PI-PREV-ERENDT-KEY      PIC X(36).
  1320        16  PI-RES-REF-CLM-TYPE     PIC X.
  1321        16  PI-CLM-REFORM-IND       PIC X.
  1322            88  PI-CLAIM-REFORMATION   VALUE 'Y'.
  1323        16  PI-CLEAR-ERROR-SW       PIC X.
  1324            88  PI-CLEAR-ERROR         VALUE 'Y'.
  1325        16  PI-PRINT-CERTIFICATE    PIC X.
  1326        16  PI-ENTERED.
  1327            20  PI-PRTSW-ENTERED    PIC X.
  1328            20  PI-SIGREQ-ENTERED   PIC X.
  1329            20  PI-MONEY-ENTERED    PIC X.
  1330            20  PI-LTRID-ENTERED    PIC X(4).
  1331            20  PI-VOUCHER-ENTERED  PIC X.
  1332            20  PI-HLTHAPP-ENTERED  PIC X.
  1333            20  PI-PAYEE-ENTERED    PIC X(10).
  1334            20  PI-CERTID-ENTERED   PIC X(5).
  1335            20  PI-REASONS-ENTERED  PIC X(84).
  1336            20  PI-CERTNT1-ENTERED  PIC X(63).
  1337            20  PI-CERTNT2-ENTERED  PIC X(63).
  1338        16  PI-FINALIZED-IND        PIC X.
  1339        16  PI-CERTNT3-ENTERED      PIC X(63).
  1340        16  PI-CERTNT4-ENTERED      PIC X(63).
  1341        16  PI-BILLNT1-ENTERED      PIC X(63).
  1342        16  PI-BILLNT2-ENTERED      PIC X(63).
  1343        16  PI-REASON-CODE-IND      PIC X(26).
  1344        16  FILLER                  PIC X(2).
  1345    12  FILLER                      PIC X(276).
  1346*    COPY ELCAID.
  1347******************************************************************
  1348*                                                                *
  1349*                            ELCAID.                             *
  1350*                            VMOD=2.001                          *
  1351*                                                                *
  1352*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1353*                                                                *
  1354*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1355*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1356******************************************************************
  1357
  1358 01  DFHAID.
  1359   02  DFHNULL   PIC  X  VALUE  ' '.
  1360   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1361   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1362   02  DFHPEN    PIC  X  VALUE  '='.
  1363   02  DFHOPID   PIC  X  VALUE  'W'.
  1364   02  DFHPA1    PIC  X  VALUE  '%'.
  1365   02  DFHPA2    PIC  X  VALUE  '>'.
  1366   02  DFHPA3    PIC  X  VALUE  ','.
  1367   02  DFHPF1    PIC  X  VALUE  '1'.
  1368   02  DFHPF2    PIC  X  VALUE  '2'.
  1369   02  DFHPF3    PIC  X  VALUE  '3'.
  1370   02  DFHPF4    PIC  X  VALUE  '4'.
  1371   02  DFHPF5    PIC  X  VALUE  '5'.
  1372   02  DFHPF6    PIC  X  VALUE  '6'.
  1373   02  DFHPF7    PIC  X  VALUE  '7'.
  1374   02  DFHPF8    PIC  X  VALUE  '8'.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  26
* EL6318.cbl
  1375   02  DFHPF9    PIC  X  VALUE  '9'.
  1376   02  DFHPF10   PIC  X  VALUE  ':'.
  1377   02  DFHPF11   PIC  X  VALUE  '#'.
  1378   02  DFHPF12   PIC  X  VALUE  '@'.
  1379   02  DFHPF13   PIC  X  VALUE  'A'.
  1380   02  DFHPF14   PIC  X  VALUE  'B'.
  1381   02  DFHPF15   PIC  X  VALUE  'C'.
  1382   02  DFHPF16   PIC  X  VALUE  'D'.
  1383   02  DFHPF17   PIC  X  VALUE  'E'.
  1384   02  DFHPF18   PIC  X  VALUE  'F'.
  1385   02  DFHPF19   PIC  X  VALUE  'G'.
  1386   02  DFHPF20   PIC  X  VALUE  'H'.
  1387   02  DFHPF21   PIC  X  VALUE  'I'.
  1388*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1389   02  DFHPF22   PIC  X  VALUE  '['.
  1390   02  DFHPF23   PIC  X  VALUE  '.'.
  1391   02  DFHPF24   PIC  X  VALUE  '<'.
  1392   02  DFHMSRE   PIC  X  VALUE  'X'.
  1393   02  DFHSTRF   PIC  X  VALUE  'h'.
  1394   02  DFHTRIG   PIC  X  VALUE  '"'.
  1395 01  FILLER    REDEFINES DFHAID.
  1396     12  FILLER              PIC X(8).
  1397     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  1398     12  FILLER              PIC X(3).
  1399*   COPY EL6318S.
  1400 01  EL631KI.
  1401     05  FILLER            PIC  X(0012).
  1402*    -------------------------------
  1403     05  DATEL PIC S9(0004) COMP.
  1404     05  DATEF PIC  X(0001).
  1405     05  FILLER REDEFINES DATEF.
  1406         10  DATEA PIC  X(0001).
  1407     05  DATEI PIC  X(0008).
  1408*    -------------------------------
  1409     05  TIMEL PIC S9(0004) COMP.
  1410     05  TIMEF PIC  X(0001).
  1411     05  FILLER REDEFINES TIMEF.
  1412         10  TIMEA PIC  X(0001).
  1413     05  TIMEI PIC  X(0005).
  1414*    -------------------------------
  1415     05  PROCIDL PIC S9(0004) COMP.
  1416     05  PROCIDF PIC  X(0001).
  1417     05  FILLER REDEFINES PROCIDF.
  1418         10  PROCIDA PIC  X(0001).
  1419     05  PROCIDI PIC  X(0004).
  1420*    -------------------------------
  1421     05  HOSTL PIC S9(0004) COMP.
  1422     05  HOSTF PIC  X(0001).
  1423     05  FILLER REDEFINES HOSTF.
  1424         10  HOSTA PIC  X(0001).
  1425     05  HOSTI PIC  X(0009).
  1426*    -------------------------------
  1427     05  SYSL PIC S9(0004) COMP.
  1428     05  SYSF PIC  X(0001).
  1429     05  FILLER REDEFINES SYSF.
  1430         10  SYSA PIC  X(0001).
  1431     05  SYSI PIC  X(0005).
  1432*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  27
* EL6318.cbl
  1433     05  COMPANYL PIC S9(0004) COMP.
  1434     05  COMPANYF PIC  X(0001).
  1435     05  FILLER REDEFINES COMPANYF.
  1436         10  COMPANYA PIC  X(0001).
  1437     05  COMPANYI PIC  X(0003).
  1438*    -------------------------------
  1439     05  DATASORL PIC S9(0004) COMP.
  1440     05  DATASORF PIC  X(0001).
  1441     05  FILLER REDEFINES DATASORF.
  1442         10  DATASORA PIC  X(0001).
  1443     05  DATASORI PIC  X(0001).
  1444*    -------------------------------
  1445     05  BATCHNOL PIC S9(0004) COMP.
  1446     05  BATCHNOF PIC  X(0001).
  1447     05  FILLER REDEFINES BATCHNOF.
  1448         10  BATCHNOA PIC  X(0001).
  1449     05  BATCHNOI PIC  X(0006).
  1450*    -------------------------------
  1451     05  BSEQNOL PIC S9(0004) COMP.
  1452     05  BSEQNOF PIC  X(0001).
  1453     05  FILLER REDEFINES BSEQNOF.
  1454         10  BSEQNOA PIC  X(0001).
  1455     05  BSEQNOI PIC  X(0008).
  1456*    -------------------------------
  1457     05  ARCHNOL PIC S9(0004) COMP.
  1458     05  ARCHNOF PIC  X(0001).
  1459     05  FILLER REDEFINES ARCHNOF.
  1460         10  ARCHNOA PIC  X(0001).
  1461     05  ARCHNOI PIC  X(0008).
  1462*    -------------------------------
  1463     05  PRTSWL PIC S9(0004) COMP.
  1464     05  PRTSWF PIC  X(0001).
  1465     05  FILLER REDEFINES PRTSWF.
  1466         10  PRTSWA PIC  X(0001).
  1467     05  PRTSWI PIC  X(0001).
  1468*    -------------------------------
  1469     05  CARRL PIC S9(0004) COMP.
  1470     05  CARRF PIC  X(0001).
  1471     05  FILLER REDEFINES CARRF.
  1472         10  CARRA PIC  X(0001).
  1473     05  CARRI PIC  X(0001).
  1474*    -------------------------------
  1475     05  GROUPL PIC S9(0004) COMP.
  1476     05  GROUPF PIC  X(0001).
  1477     05  FILLER REDEFINES GROUPF.
  1478         10  GROUPA PIC  X(0001).
  1479     05  GROUPI PIC  X(0006).
  1480*    -------------------------------
  1481     05  STATEL PIC S9(0004) COMP.
  1482     05  STATEF PIC  X(0001).
  1483     05  FILLER REDEFINES STATEF.
  1484         10  STATEA PIC  X(0001).
  1485     05  STATEI PIC  X(0002).
  1486*    -------------------------------
  1487     05  ACCTL PIC S9(0004) COMP.
  1488     05  ACCTF PIC  X(0001).
  1489     05  FILLER REDEFINES ACCTF.
  1490         10  ACCTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  28
* EL6318.cbl
  1491     05  ACCTI PIC  X(0010).
  1492*    -------------------------------
  1493     05  EFFDTL PIC S9(0004) COMP.
  1494     05  EFFDTF PIC  X(0001).
  1495     05  FILLER REDEFINES EFFDTF.
  1496         10  EFFDTA PIC  X(0001).
  1497     05  EFFDTI PIC  X(0008).
  1498*    -------------------------------
  1499     05  CERTNOL PIC S9(0004) COMP.
  1500     05  CERTNOF PIC  X(0001).
  1501     05  FILLER REDEFINES CERTNOF.
  1502         10  CERTNOA PIC  X(0001).
  1503     05  CERTNOI PIC  X(0010).
  1504*    -------------------------------
  1505     05  CRTSFXL PIC S9(0004) COMP.
  1506     05  CRTSFXF PIC  X(0001).
  1507     05  FILLER REDEFINES CRTSFXF.
  1508         10  CRTSFXA PIC  X(0001).
  1509     05  CRTSFXI PIC  X(0001).
  1510*    -------------------------------
  1511     05  SEQNOL PIC S9(0004) COMP.
  1512     05  SEQNOF PIC  X(0001).
  1513     05  FILLER REDEFINES SEQNOF.
  1514         10  SEQNOA PIC  X(0001).
  1515     05  SEQNOI PIC  X(0006).
  1516*    -------------------------------
  1517     05  SIGREQL PIC S9(0004) COMP.
  1518     05  SIGREQF PIC  X(0001).
  1519     05  FILLER REDEFINES SIGREQF.
  1520         10  SIGREQA PIC  X(0001).
  1521     05  SIGREQI PIC  X(0001).
  1522*    -------------------------------
  1523     05  LTRIDL PIC S9(0004) COMP.
  1524     05  LTRIDF PIC  X(0001).
  1525     05  FILLER REDEFINES LTRIDF.
  1526         10  LTRIDA PIC  X(0001).
  1527     05  LTRIDI PIC  X(0004).
  1528*    -------------------------------
  1529     05  HLTHAPPL PIC S9(0004) COMP.
  1530     05  HLTHAPPF PIC  X(0001).
  1531     05  FILLER REDEFINES HLTHAPPF.
  1532         10  HLTHAPPA PIC  X(0001).
  1533     05  HLTHAPPI PIC  X(0001).
  1534*    -------------------------------
  1535     05  VOUCHL PIC S9(0004) COMP.
  1536     05  VOUCHF PIC  X(0001).
  1537     05  FILLER REDEFINES VOUCHF.
  1538         10  VOUCHA PIC  X(0001).
  1539     05  VOUCHI PIC  X(0001).
  1540*    -------------------------------
  1541     05  PAYEEL PIC S9(0004) COMP.
  1542     05  PAYEEF PIC  X(0001).
  1543     05  FILLER REDEFINES PAYEEF.
  1544         10  PAYEEA PIC  X(0001).
  1545     05  PAYEEI PIC  X(0010).
  1546*    -------------------------------
  1547     05  CERTIDL PIC S9(0004) COMP.
  1548     05  CERTIDF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  29
* EL6318.cbl
  1549     05  FILLER REDEFINES CERTIDF.
  1550         10  CERTIDA PIC  X(0001).
  1551     05  CERTIDI PIC  X(0005).
  1552*    -------------------------------
  1553     05  RCD01L PIC S9(0004) COMP.
  1554     05  RCD01F PIC  X(0001).
  1555     05  FILLER REDEFINES RCD01F.
  1556         10  RCD01A PIC  X(0001).
  1557     05  RCD01I PIC  X(0004).
  1558*    -------------------------------
  1559     05  RCD02L PIC S9(0004) COMP.
  1560     05  RCD02F PIC  X(0001).
  1561     05  FILLER REDEFINES RCD02F.
  1562         10  RCD02A PIC  X(0001).
  1563     05  RCD02I PIC  X(0004).
  1564*    -------------------------------
  1565     05  RCD03L PIC S9(0004) COMP.
  1566     05  RCD03F PIC  X(0001).
  1567     05  FILLER REDEFINES RCD03F.
  1568         10  RCD03A PIC  X(0001).
  1569     05  RCD03I PIC  X(0004).
  1570*    -------------------------------
  1571     05  RCD04L PIC S9(0004) COMP.
  1572     05  RCD04F PIC  X(0001).
  1573     05  FILLER REDEFINES RCD04F.
  1574         10  RCD04A PIC  X(0001).
  1575     05  RCD04I PIC  X(0004).
  1576*    -------------------------------
  1577     05  RCD05L PIC S9(0004) COMP.
  1578     05  RCD05F PIC  X(0001).
  1579     05  FILLER REDEFINES RCD05F.
  1580         10  RCD05A PIC  X(0001).
  1581     05  RCD05I PIC  X(0004).
  1582*    -------------------------------
  1583     05  RCD06L PIC S9(0004) COMP.
  1584     05  RCD06F PIC  X(0001).
  1585     05  FILLER REDEFINES RCD06F.
  1586         10  RCD06A PIC  X(0001).
  1587     05  RCD06I PIC  X(0004).
  1588*    -------------------------------
  1589     05  RCD07L PIC S9(0004) COMP.
  1590     05  RCD07F PIC  X(0001).
  1591     05  FILLER REDEFINES RCD07F.
  1592         10  RCD07A PIC  X(0001).
  1593     05  RCD07I PIC  X(0004).
  1594*    -------------------------------
  1595     05  RCD08L PIC S9(0004) COMP.
  1596     05  RCD08F PIC  X(0001).
  1597     05  FILLER REDEFINES RCD08F.
  1598         10  RCD08A PIC  X(0001).
  1599     05  RCD08I PIC  X(0004).
  1600*    -------------------------------
  1601     05  RCD09L PIC S9(0004) COMP.
  1602     05  RCD09F PIC  X(0001).
  1603     05  FILLER REDEFINES RCD09F.
  1604         10  RCD09A PIC  X(0001).
  1605     05  RCD09I PIC  X(0004).
  1606*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  30
* EL6318.cbl
  1607     05  RCD10L PIC S9(0004) COMP.
  1608     05  RCD10F PIC  X(0001).
  1609     05  FILLER REDEFINES RCD10F.
  1610         10  RCD10A PIC  X(0001).
  1611     05  RCD10I PIC  X(0004).
  1612*    -------------------------------
  1613     05  RCD11L PIC S9(0004) COMP.
  1614     05  RCD11F PIC  X(0001).
  1615     05  FILLER REDEFINES RCD11F.
  1616         10  RCD11A PIC  X(0001).
  1617     05  RCD11I PIC  X(0004).
  1618*    -------------------------------
  1619     05  RCD12L PIC S9(0004) COMP.
  1620     05  RCD12F PIC  X(0001).
  1621     05  FILLER REDEFINES RCD12F.
  1622         10  RCD12A PIC  X(0001).
  1623     05  RCD12I PIC  X(0004).
  1624*    -------------------------------
  1625     05  CRTNT1L PIC S9(0004) COMP.
  1626     05  CRTNT1F PIC  X(0001).
  1627     05  FILLER REDEFINES CRTNT1F.
  1628         10  CRTNT1A PIC  X(0001).
  1629     05  CRTNT1I PIC  X(0063).
  1630*    -------------------------------
  1631     05  CRTNT2L PIC S9(0004) COMP.
  1632     05  CRTNT2F PIC  X(0001).
  1633     05  FILLER REDEFINES CRTNT2F.
  1634         10  CRTNT2A PIC  X(0001).
  1635     05  CRTNT2I PIC  X(0063).
  1636*    -------------------------------
  1637     05  CRTNT3L PIC S9(0004) COMP.
  1638     05  CRTNT3F PIC  X(0001).
  1639     05  FILLER REDEFINES CRTNT3F.
  1640         10  CRTNT3A PIC  X(0001).
  1641     05  CRTNT3I PIC  X(0063).
  1642*    -------------------------------
  1643     05  CRTNT4L PIC S9(0004) COMP.
  1644     05  CRTNT4F PIC  X(0001).
  1645     05  FILLER REDEFINES CRTNT4F.
  1646         10  CRTNT4A PIC  X(0001).
  1647     05  CRTNT4I PIC  X(0063).
  1648*    -------------------------------
  1649     05  BILNT1L PIC S9(0004) COMP.
  1650     05  BILNT1F PIC  X(0001).
  1651     05  FILLER REDEFINES BILNT1F.
  1652         10  BILNT1A PIC  X(0001).
  1653     05  BILNT1I PIC  X(0063).
  1654*    -------------------------------
  1655     05  BILNT2L PIC S9(0004) COMP.
  1656     05  BILNT2F PIC  X(0001).
  1657     05  FILLER REDEFINES BILNT2F.
  1658         10  BILNT2A PIC  X(0001).
  1659     05  BILNT2I PIC  X(0063).
  1660*    -------------------------------
  1661     05  ERRMSG1L PIC S9(0004) COMP.
  1662     05  ERRMSG1F PIC  X(0001).
  1663     05  FILLER REDEFINES ERRMSG1F.
  1664         10  ERRMSG1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  31
* EL6318.cbl
  1665     05  ERRMSG1I PIC  X(0075).
  1666*    -------------------------------
  1667     05  ERRMSG2L PIC S9(0004) COMP.
  1668     05  ERRMSG2F PIC  X(0001).
  1669     05  FILLER REDEFINES ERRMSG2F.
  1670         10  ERRMSG2A PIC  X(0001).
  1671     05  ERRMSG2I PIC  X(0075).
  1672*    -------------------------------
  1673     05  PFENTRL PIC S9(0004) COMP.
  1674     05  PFENTRF PIC  X(0001).
  1675     05  FILLER REDEFINES PFENTRF.
  1676         10  PFENTRA PIC  X(0001).
  1677     05  PFENTRI PIC  9(2).
  1678 01  EL631KO REDEFINES EL631KI.
  1679     05  FILLER            PIC  X(0012).
  1680*    -------------------------------
  1681     05  FILLER            PIC  X(0003).
  1682     05  DATEO PIC  X(0008).
  1683*    -------------------------------
  1684     05  FILLER            PIC  X(0003).
  1685     05  TIMEO PIC  99.99.
  1686*    -------------------------------
  1687     05  FILLER            PIC  X(0003).
  1688     05  PROCIDO PIC  X(0004).
  1689*    -------------------------------
  1690     05  FILLER            PIC  X(0003).
  1691     05  HOSTO PIC  X(0009).
  1692*    -------------------------------
  1693     05  FILLER            PIC  X(0003).
  1694     05  SYSO PIC  X(0005).
  1695*    -------------------------------
  1696     05  FILLER            PIC  X(0003).
  1697     05  COMPANYO PIC  X(0003).
  1698*    -------------------------------
  1699     05  FILLER            PIC  X(0003).
  1700     05  DATASORO PIC  X(0001).
  1701*    -------------------------------
  1702     05  FILLER            PIC  X(0003).
  1703     05  BATCHNOO PIC  X(0006).
  1704*    -------------------------------
  1705     05  FILLER            PIC  X(0003).
  1706     05  BSEQNOO PIC  X(0008).
  1707*    -------------------------------
  1708     05  FILLER            PIC  X(0003).
  1709     05  ARCHNOO PIC  X(0008).
  1710*    -------------------------------
  1711     05  FILLER            PIC  X(0003).
  1712     05  PRTSWO PIC  X(0001).
  1713*    -------------------------------
  1714     05  FILLER            PIC  X(0003).
  1715     05  CARRO PIC  X(0001).
  1716*    -------------------------------
  1717     05  FILLER            PIC  X(0003).
  1718     05  GROUPO PIC  X(0006).
  1719*    -------------------------------
  1720     05  FILLER            PIC  X(0003).
  1721     05  STATEO PIC  X(0002).
  1722*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  32
* EL6318.cbl
  1723     05  FILLER            PIC  X(0003).
  1724     05  ACCTO PIC  X(0010).
  1725*    -------------------------------
  1726     05  FILLER            PIC  X(0003).
  1727     05  EFFDTO PIC  X(0008).
  1728*    -------------------------------
  1729     05  FILLER            PIC  X(0003).
  1730     05  CERTNOO PIC  X(0010).
  1731*    -------------------------------
  1732     05  FILLER            PIC  X(0003).
  1733     05  CRTSFXO PIC  X(0001).
  1734*    -------------------------------
  1735     05  FILLER            PIC  X(0003).
  1736     05  SEQNOO PIC  999999.
  1737*    -------------------------------
  1738     05  FILLER            PIC  X(0003).
  1739     05  SIGREQO PIC  X(0001).
  1740*    -------------------------------
  1741     05  FILLER            PIC  X(0003).
  1742     05  LTRIDO PIC  X(0004).
  1743*    -------------------------------
  1744     05  FILLER            PIC  X(0003).
  1745     05  HLTHAPPO PIC  X(0001).
  1746*    -------------------------------
  1747     05  FILLER            PIC  X(0003).
  1748     05  VOUCHO PIC  X(0001).
  1749*    -------------------------------
  1750     05  FILLER            PIC  X(0003).
  1751     05  PAYEEO PIC  X(0010).
  1752*    -------------------------------
  1753     05  FILLER            PIC  X(0003).
  1754     05  CERTIDO PIC  X(0005).
  1755*    -------------------------------
  1756     05  FILLER            PIC  X(0003).
  1757     05  RCD01O PIC  X(0004).
  1758*    -------------------------------
  1759     05  FILLER            PIC  X(0003).
  1760     05  RCD02O PIC  X(0004).
  1761*    -------------------------------
  1762     05  FILLER            PIC  X(0003).
  1763     05  RCD03O PIC  X(0004).
  1764*    -------------------------------
  1765     05  FILLER            PIC  X(0003).
  1766     05  RCD04O PIC  X(0004).
  1767*    -------------------------------
  1768     05  FILLER            PIC  X(0003).
  1769     05  RCD05O PIC  X(0004).
  1770*    -------------------------------
  1771     05  FILLER            PIC  X(0003).
  1772     05  RCD06O PIC  X(0004).
  1773*    -------------------------------
  1774     05  FILLER            PIC  X(0003).
  1775     05  RCD07O PIC  X(0004).
  1776*    -------------------------------
  1777     05  FILLER            PIC  X(0003).
  1778     05  RCD08O PIC  X(0004).
  1779*    -------------------------------
  1780     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  33
* EL6318.cbl
  1781     05  RCD09O PIC  X(0004).
  1782*    -------------------------------
  1783     05  FILLER            PIC  X(0003).
  1784     05  RCD10O PIC  X(0004).
  1785*    -------------------------------
  1786     05  FILLER            PIC  X(0003).
  1787     05  RCD11O PIC  X(0004).
  1788*    -------------------------------
  1789     05  FILLER            PIC  X(0003).
  1790     05  RCD12O PIC  X(0004).
  1791*    -------------------------------
  1792     05  FILLER            PIC  X(0003).
  1793     05  CRTNT1O PIC  X(0063).
  1794*    -------------------------------
  1795     05  FILLER            PIC  X(0003).
  1796     05  CRTNT2O PIC  X(0063).
  1797*    -------------------------------
  1798     05  FILLER            PIC  X(0003).
  1799     05  CRTNT3O PIC  X(0063).
  1800*    -------------------------------
  1801     05  FILLER            PIC  X(0003).
  1802     05  CRTNT4O PIC  X(0063).
  1803*    -------------------------------
  1804     05  FILLER            PIC  X(0003).
  1805     05  BILNT1O PIC  X(0063).
  1806*    -------------------------------
  1807     05  FILLER            PIC  X(0003).
  1808     05  BILNT2O PIC  X(0063).
  1809*    -------------------------------
  1810     05  FILLER            PIC  X(0003).
  1811     05  ERRMSG1O PIC  X(0075).
  1812*    -------------------------------
  1813     05  FILLER            PIC  X(0003).
  1814     05  ERRMSG2O PIC  X(0075).
  1815*    -------------------------------
  1816     05  FILLER            PIC  X(0003).
  1817     05  PFENTRO PIC  X(0002).
  1818*    -------------------------------
  1819 01  FILLER REDEFINES EL631KI.
  1820     12  FILLER             PIC X(211).
  1821     12  REASONCDS.
  1822         16  FILLER OCCURS 12.
  1823           20  REACDL       PIC S9(4) COMP.
  1824           20  REACDA       PIC X.
  1825           20  REACD-IN     PIC X(4).
  1826     12  FILLER             PIC X(293).
  1827****************************************************************
  1828*
  1829* Copyright (c) 2007 by Clerity Solutions, Inc.
  1830* All rights reserved.
  1831*
  1832****************************************************************
  1833 01  DFHEIV.
  1834   02  DFHEIV0               PIC X(35).
  1835   02  DFHEIV1               PIC X(08).
  1836   02  DFHEIV2               PIC X(08).
  1837   02  DFHEIV3               PIC X(08).
  1838   02  DFHEIV4               PIC X(06).
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  34
* EL6318.cbl
  1839   02  DFHEIV5               PIC X(04).
  1840   02  DFHEIV6               PIC X(04).
  1841   02  DFHEIV7               PIC X(02).
  1842   02  DFHEIV8               PIC X(02).
  1843   02  DFHEIV9               PIC X(01).
  1844   02  DFHEIV10              PIC S9(7) COMP-3.
  1845   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1846   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1847   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1848   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1849   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1850   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1851   02  DFHEIV17              PIC X(04).
  1852   02  DFHEIV18              PIC X(04).
  1853   02  DFHEIV19              PIC X(04).
  1854   02  DFHEIV20              USAGE IS POINTER.
  1855   02  DFHEIV21              USAGE IS POINTER.
  1856   02  DFHEIV22              USAGE IS POINTER.
  1857   02  DFHEIV23              USAGE IS POINTER.
  1858   02  DFHEIV24              USAGE IS POINTER.
  1859   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1860   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1861   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1862   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1863   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1864   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1865   02  FILLER                PIC X(02).
  1866   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1867   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1868   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1869   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1870   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1871 LINKAGE  SECTION.
  1872*****************************************************************
  1873*                                                               *
  1874* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1875* All rights reserved.                                          *
  1876*                                                               *
  1877*****************************************************************
  1878 01  dfheiblk.
  1879     02  eibtime          pic s9(7) comp-3.
  1880     02  eibdate          pic s9(7) comp-3.
  1881     02  eibtrnid         pic x(4).
  1882     02  eibtaskn         pic s9(7) comp-3.
  1883     02  eibtrmid         pic x(4).
  1884     02  dfheigdi         pic s9(4) comp.
  1885     02  eibcposn         pic s9(4) comp.
  1886     02  eibcalen         pic s9(4) comp.
  1887     02  eibaid           pic x(1).
  1888     02  eibfiller1       pic x(1).
  1889     02  eibfn            pic x(2).
  1890     02  eibfiller2       pic x(2).
  1891     02  eibrcode         pic x(6).
  1892     02  eibfiller3       pic x(2).
  1893     02  eibds            pic x(8).
  1894     02  eibreqid         pic x(8).
  1895     02  eibrsrce         pic x(8).
  1896     02  eibsync          pic x(1).
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  35
* EL6318.cbl
  1897     02  eibfree          pic x(1).
  1898     02  eibrecv          pic x(1).
  1899     02  eibsend          pic x(1).
  1900     02  eibatt           pic x(1).
  1901     02  eibeoc           pic x(1).
  1902     02  eibfmh           pic x(1).
  1903     02  eibcompl         pic x(1).
  1904     02  eibsig           pic x(1).
  1905     02  eibconf          pic x(1).
  1906     02  eiberr           pic x(1).
  1907     02  eibrldbk         pic x(1).
  1908     02  eiberrcd         pic x(4).
  1909     02  eibsynrb         pic x(1).
  1910     02  eibnodat         pic x(1).
  1911     02  eibfiller5       pic x(2).
  1912     02  eibresp          pic 9(09) comp.
  1913     02  eibresp2         pic 9(09) comp.
  1914     02  dfheigdj         pic s9(4) comp.
  1915     02  dfheigdk         pic s9(4) comp.
  1916 01  DFHCOMMAREA                 PIC X(1300).
  1917 01  var  pic x(30).
  1918*                                COPY ERCACCT.
  1919******************************************************************
  1920*                                                                *
  1921*                                                                *
  1922*                            ERCACCT                             *
  1923*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1924*                            VMOD=2.031                          *
  1925*                                                                *
  1926*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1927*                                                                *
  1928*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1929*   VSAM ACCOUNT MASTER FILES.                                   *
  1930*                                                                *
  1931*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1932*                                                                *
  1933*   FILE TYPE = VSAM,KSDS                                        *
  1934*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1935*                                                                *
  1936*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1937*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1938*                                                                *
  1939*   LOG = NO                                                     *
  1940*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1941*                                                                *
  1942*                                                                *
  1943******************************************************************
  1944*                   C H A N G E   L O G
  1945*
  1946* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1947*-----------------------------------------------------------------
  1948*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1949* EFFECTIVE    NUMBER
  1950*-----------------------------------------------------------------
  1951* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1952* 092705    2005050300006  PEMA  ADD SPP LEASES
  1953* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1954* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  36
* EL6318.cbl
  1955* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1956* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1957* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1958******************************************************************
  1959
  1960 01  ACCOUNT-MASTER.
  1961     12  AM-RECORD-ID                      PIC XX.
  1962         88  VALID-AM-ID                      VALUE 'AM'.
  1963
  1964     12  AM-CONTROL-PRIMARY.
  1965         16  AM-COMPANY-CD                 PIC X.
  1966         16  AM-MSTR-CNTRL.
  1967             20  AM-CONTROL-A.
  1968                 24  AM-CARRIER            PIC X.
  1969                 24  AM-GROUPING.
  1970                     28 AM-GROUPING-PREFIX PIC XXX.
  1971                     28 AM-GROUPING-PRIME  PIC XXX.
  1972                 24  AM-STATE              PIC XX.
  1973                 24  AM-ACCOUNT.
  1974                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1975                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1976             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1977                                           PIC X(19).
  1978             20  AM-CNTRL-B.
  1979                 24  AM-EXPIRATION-DT      PIC XX.
  1980                 24  FILLER                PIC X(4).
  1981             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1982                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1983
  1984     12  AM-CONTROL-BY-VAR-GRP.
  1985         16  AM-COMPANY-CD-A1              PIC X.
  1986         16  AM-VG-CARRIER                 PIC X.
  1987         16  AM-VG-GROUPING                PIC X(6).
  1988         16  AM-VG-STATE                   PIC XX.
  1989         16  AM-VG-ACCOUNT                 PIC X(10).
  1990         16  AM-VG-DATE.
  1991             20  AM-VG-EXPIRATION-DT       PIC XX.
  1992             20  FILLER                    PIC X(4).
  1993         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1994                                           PIC 9(11)      COMP-3.
  1995     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1996         16  FILLER                        PIC X(10).
  1997         16  AM-VG-KEY3.
  1998             20  AM-VG3-ACCOUNT            PIC X(10).
  1999             20  AM-VG3-EXP-DT             PIC XX.
  2000         16  FILLER                        PIC X(4).
  2001     12  AM-MAINT-INFORMATION.
  2002         16  AM-LAST-MAINT-DT              PIC XX.
  2003         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2004         16  AM-LAST-MAINT-USER            PIC X(4).
  2005         16  FILLER                        PIC XX.
  2006
  2007     12  AM-EFFECTIVE-DT                   PIC XX.
  2008     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2009
  2010     12  AM-PREV-DATES  COMP-3.
  2011         16  AM-PREV-EXP-DT                PIC 9(11).
  2012         16  AM-PREV-EFF-DT                PIC 9(11).
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  37
* EL6318.cbl
  2013
  2014     12  AM-REPORT-CODE-1                  PIC X(10).
  2015     12  AM-REPORT-CODE-2                  PIC X(10).
  2016
  2017     12  AM-CITY-CODE                      PIC X(4).
  2018     12  AM-COUNTY-PARISH                  PIC X(6).
  2019
  2020     12  AM-NAME                           PIC X(30).
  2021     12  AM-PERSON                         PIC X(30).
  2022     12  AM-ADDRS                          PIC X(30).
  2023     12  AM-CITY.
  2024         16  AM-ADDR-CITY                  PIC X(28).
  2025         16  AM-ADDR-STATE                 PIC XX.
  2026     12  AM-ZIP.
  2027         16  AM-ZIP-PRIME.
  2028             20  AM-ZIP-PRI-1ST            PIC X.
  2029                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2030             20  FILLER                    PIC X(4).
  2031         16  AM-ZIP-PLUS4                  PIC X(4).
  2032     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2033         16  AM-CAN-POSTAL-1               PIC XXX.
  2034         16  AM-CAN-POSTAL-2               PIC XXX.
  2035         16  FILLER                        PIC XXX.
  2036     12  AM-TEL-NO.
  2037         16  AM-AREA-CODE                  PIC 999.
  2038         16  AM-TEL-PRE                    PIC 999.
  2039         16  AM-TEL-NBR                    PIC 9(4).
  2040     12  AM-TEL-LOC                        PIC X.
  2041         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2042         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2043
  2044     12  AM-COMM-STRUCTURE.
  2045         16  AM-DEFN-1.
  2046             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2047                 24  AM-AGT.
  2048                     28  AM-AGT-PREFIX     PIC X(4).
  2049                     28  AM-AGT-PRIME      PIC X(6).
  2050                 24  AM-COM-TYP            PIC X.
  2051                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2052                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2053                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2054                 24  AM-RECALC-LV-INDIC    PIC X.
  2055                 24  AM-RETRO-LV-INDIC     PIC X.
  2056                 24  AM-GL-CODES           PIC X.
  2057                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2058                 24  FILLER                PIC X(01).
  2059         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2060             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2061                 24  FILLER                PIC X(11).
  2062                 24  AM-L-COMA             PIC XXX.
  2063                 24  AM-J-COMA             PIC XXX.
  2064                 24  AM-A-COMA             PIC XXX.
  2065                 24  FILLER                PIC X(6).
  2066
  2067     12  AM-COMM-CHANGE-STATUS             PIC X.
  2068         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2069
  2070     12  AM-CSR-CODE                       PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  38
* EL6318.cbl
  2071
  2072     12  AM-BILLING-STATUS                 PIC X.
  2073         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2074         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2075     12  AM-AUTO-REFUND-SW                 PIC X.
  2076         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2077         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2078     12  AM-GPCD                           PIC 99.
  2079     12  AM-IG                             PIC X.
  2080         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2081         88  AM-HAS-GROUP                     VALUE '2'.
  2082     12  AM-STATUS                         PIC X.
  2083         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2084         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2085         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2086         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2087         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2088         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2089     12  AM-REMIT-TO                       PIC 99.
  2090     12  AM-ID-NO                          PIC X(11).
  2091
  2092     12  AM-CAL-TABLE                      PIC XX.
  2093     12  AM-LF-DEVIATION                   PIC XXX.
  2094     12  AM-AH-DEVIATION                   PIC XXX.
  2095     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2096     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2097     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2098     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2099     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2100     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2101
  2102     12  AM-USER-FIELDS.
  2103         16  AM-FLD-1                      PIC XX.
  2104         16  AM-FLD-2                      PIC XX.
  2105         16  AM-FLD-3                      PIC XX.
  2106         16  AM-FLD-4                      PIC XX.
  2107         16  AM-FLD-5                      PIC XX.
  2108
  2109     12  AM-1ST-PROD-DATE.
  2110         16  AM-1ST-PROD-YR                PIC XX.
  2111         16  AM-1ST-PROD-MO                PIC XX.
  2112         16  AM-1ST-PROD-DA                PIC XX.
  2113     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2114     12  AM-CERTS-PURGED-DATE.
  2115         16  AM-PUR-YR                     PIC XX.
  2116         16  AM-PUR-MO                     PIC XX.
  2117         16  AM-PUR-DA                     PIC XX.
  2118     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2119     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2120     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2121     12  AM-INACTIVE-DATE.
  2122         16  AM-INA-MO                     PIC 99.
  2123         16  AM-INA-DA                     PIC 99.
  2124         16  AM-INA-YR                     PIC 99.
  2125     12  AM-AR-HI-CERT-DATE                PIC XX.
  2126
  2127     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2128     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  39
* EL6318.cbl
  2129
  2130     12  AM-OB-PAYMENT-MODE                PIC X.
  2131         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2132         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2133         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2134         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2135
  2136     12  AM-AH-ONLY-INDICATOR              PIC X.
  2137         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2138         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2139
  2140     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2141
  2142     12  AM-OVER-SHORT.
  2143         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2144         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2145
  2146     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2147     12  AM-DCC-CLP-STATE                  PIC XX.
  2148
  2149     12  AM-RECALC-COMM                    PIC X.
  2150     12  AM-RECALC-REIN                    PIC X.
  2151
  2152     12  AM-REI-TABLE                      PIC XXX.
  2153     12  AM-REI-ET-LF                      PIC X.
  2154     12  AM-REI-ET-AH                      PIC X.
  2155     12  AM-REI-PE-LF                      PIC X.
  2156     12  AM-REI-PE-AH                      PIC X.
  2157     12  AM-REI-PRT-ST                     PIC X.
  2158     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2159     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2160     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2161     12  AM-REI-GROUP-A                    PIC X(6).
  2162     12  AM-REI-MORT                       PIC X(4).
  2163     12  AM-REI-PRT-OW                     PIC X.
  2164     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2165     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2166     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2167     12  AM-REI-GROUP-B                    PIC X(6).
  2168
  2169     12  AM-TRUST-TYPE                     PIC X(2).
  2170
  2171     12  AM-EMPLOYER-STMT-USED             PIC X.
  2172     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2173
  2174     12  AM-STD-AH-TYPE                    PIC XX.
  2175     12  AM-EARN-METHODS.
  2176         16  AM-EARN-METHOD-R              PIC X.
  2177             88 AM-REF-RL-R78                 VALUE 'R'.
  2178             88 AM-REF-RL-PR                  VALUE 'P'.
  2179             88 AM-REF-RL-MEAN                VALUE 'M'.
  2180             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2181         16  AM-EARN-METHOD-L              PIC X.
  2182             88 AM-REF-LL-R78                 VALUE 'R'.
  2183             88 AM-REF-LL-PR                  VALUE 'P'.
  2184             88 AM-REF-LL-MEAN                VALUE 'M'.
  2185             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2186         16  AM-EARN-METHOD-A              PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  40
* EL6318.cbl
  2187             88 AM-REF-AH-R78                 VALUE 'R'.
  2188             88 AM-REF-AH-PR                  VALUE 'P'.
  2189             88 AM-REF-AH-MEAN                VALUE 'M'.
  2190             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2191             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2192             88 AM-REF-AH-NET                 VALUE 'N'.
  2193
  2194     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2195     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2196     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2197
  2198     12  AM-RET-Y-N                        PIC X.
  2199     12  AM-RET-P-E                        PIC X.
  2200     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2201     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2202     12  AM-RET-GRP                        PIC X(6).
  2203     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2204         16  AM-POOL-PRIME                 PIC XXX.
  2205         16  AM-POOL-SUB                   PIC XXX.
  2206     12  AM-RETRO-EARNINGS.
  2207         16  AM-RET-EARN-R                 PIC X.
  2208         16  AM-RET-EARN-L                 PIC X.
  2209         16  AM-RET-EARN-A                 PIC X.
  2210     12  AM-RET-ST-TAX-USE                 PIC X.
  2211         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2212         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2213     12  AM-RETRO-BEG-EARNINGS.
  2214         16  AM-RET-BEG-EARN-R             PIC X.
  2215         16  AM-RET-BEG-EARN-L             PIC X.
  2216         16  AM-RET-BEG-EARN-A             PIC X.
  2217     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2218     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2219
  2220     12  AM-USER-SELECT-OPTIONS.
  2221         16  AM-USER-SELECT-1              PIC X(10).
  2222         16  AM-USER-SELECT-2              PIC X(10).
  2223         16  AM-USER-SELECT-3              PIC X(10).
  2224         16  AM-USER-SELECT-4              PIC X(10).
  2225         16  AM-USER-SELECT-5              PIC X(10).
  2226
  2227     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2228
  2229     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2230
  2231     12  AM-RPT045A-SWITCH                 PIC X.
  2232         88  RPT045A-OFF                   VALUE 'N'.
  2233
  2234     12  AM-INSURANCE-LIMITS.
  2235         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2236         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2237
  2238     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2239         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2240
  2241     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2242         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2243         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2244
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  41
* EL6318.cbl
  2245     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2246
  2247     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2248     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2249     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2250     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2251     12  AM-DCC-UEF-STATE                  PIC XX.
  2252     12  FILLER                            PIC XXX.
  2253     12  AM-REPORT-CODE-3                  PIC X(10).
  2254*    12  FILLER                            PIC X(22).
  2255
  2256     12  AM-RESERVE-DATE.
  2257         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2258         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2259         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2260
  2261     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2262     12  AM-NOTIFICATION-TYPES.
  2263         16  AM-NOTIF-OF-LETTERS           PIC X.
  2264         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2265         16  AM-NOTIF-OF-REPORTS           PIC X.
  2266         16  AM-NOTIF-OF-STATUS            PIC X.
  2267
  2268     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2269         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2270         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2271         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2272         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2273
  2274     12  AM-BENEFIT-CONTROLS.
  2275         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2276             20  AM-BENEFIT-CODE           PIC XX.
  2277             20  AM-BENEFIT-TYPE           PIC X.
  2278             20  AM-BENEFIT-REVISION       PIC XXX.
  2279             20  AM-BENEFIT-REM-TERM       PIC X.
  2280             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2281             20  FILLER                    PIC XX.
  2282         16  FILLER                        PIC X(80).
  2283
  2284     12  AM-TRANSFER-DATA.
  2285         16  AM-TRANSFERRED-FROM.
  2286             20  AM-TRNFROM-CARRIER        PIC X.
  2287             20  AM-TRNFROM-GROUPING.
  2288                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2289                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2290             20  AM-TRNFROM-STATE          PIC XX.
  2291             20  AM-TRNFROM-ACCOUNT.
  2292                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2293                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2294             20  AM-TRNFROM-DTE            PIC XX.
  2295         16  AM-TRANSFERRED-TO.
  2296             20  AM-TRNTO-CARRIER          PIC X.
  2297             20  AM-TRNTO-GROUPING.
  2298                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2299                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2300             20  AM-TRNTO-STATE            PIC XX.
  2301             20  AM-TRNTO-ACCOUNT.
  2302                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  42
* EL6318.cbl
  2303                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2304             20  AM-TRNTO-DTE              PIC XX.
  2305         16  FILLER                        PIC X(10).
  2306
  2307     12  AM-SAVED-REMIT-TO                 PIC 99.
  2308
  2309     12  AM-COMM-STRUCTURE-SAVED.
  2310         16  AM-DEFN-1-SAVED.
  2311             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2312                 24  AM-AGT-SV             PIC X(10).
  2313                 24  AM-COM-TYP-SV         PIC X.
  2314                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2315                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2316                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2317                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2318                 24  FILLER                PIC X.
  2319                 24  AM-GL-CODES-SV        PIC X.
  2320                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2321                 24  FILLER                PIC X.
  2322         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2323             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2324                 24  FILLER                PIC X(11).
  2325                 24  AM-L-COMA-SV          PIC XXX.
  2326                 24  AM-J-COMA-SV          PIC XXX.
  2327                 24  AM-A-COMA-SV          PIC XXX.
  2328                 24  FILLER                PIC X(6).
  2329
  2330     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2331         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2332            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2333            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2334            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2335
  2336     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2337     12  FILLER                            PIC X(120).
  2338
  2339     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2340         16  AM-CONTROL-NAME               PIC X(30).
  2341         16  AM-EXECUTIVE-ONE.
  2342             20  AM-EXEC1-NAME             PIC X(15).
  2343             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2344                                                          COMP-3.
  2345             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2346                                                          COMP-3.
  2347         16  AM-EXECUTIVE-TWO.
  2348             20  AM-EXEC2-NAME             PIC X(15).
  2349             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2350                                                          COMP-3.
  2351             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2352                                                          COMP-3.
  2353
  2354     12  AM-RETRO-ADDITIONAL-DATA.
  2355         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2356         16  AM-RETRO-PREM-P-E             PIC X.
  2357         16  AM-RETRO-CLMS-P-I             PIC X.
  2358         16  AM-RETRO-RET-BRACKET-LF.
  2359             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2360                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  43
* EL6318.cbl
  2361                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2362             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2363                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2364                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2365             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2366                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2367                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2368         16  AM-RETRO-RET-BRACKET-AH.
  2369             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2370                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2371                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2372                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2373             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2374                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2375                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2376             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2377                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2378                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2379
  2380     12  AM-COMMENTS.
  2381         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2382
  2383     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2384         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2385         16  AM-FLI-BILLING-CODE           PIC X.
  2386         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2387         16  AM-FLI-UNITED-IDENT           PIC X.
  2388         16  AM-FLI-INTEREST-LOST-DATA.
  2389             20  AM-FLI-BANK-NO            PIC X(5).
  2390             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2391             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2392             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2393         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2394             20  AM-FLI-AGT                PIC X(9).
  2395             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2396             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2397         16  FILLER                        PIC X(102).
  2398
  2399     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2400         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2401             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2402             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2403             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2404             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2405             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2406         16  FILLER                          PIC X(10).
  2407******************************************************************
  2408*                                COPY ELCCNTL.
  2409******************************************************************
  2410*                                                                *
  2411*                                                                *
  2412*                            ELCCNTL.                            *
  2413*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2414*                            VMOD=2.059                          *
  2415*                                                                *
  2416*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2417*                                                                *
  2418*   FILE TYPE = VSAM,KSDS                                        *
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  44
* EL6318.cbl
  2419*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2420*                                                                *
  2421*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2422*       ALTERNATE INDEX = NONE                                   *
  2423*                                                                *
  2424*   LOG = YES                                                    *
  2425*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2426******************************************************************
  2427*                   C H A N G E   L O G
  2428*
  2429* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2430*-----------------------------------------------------------------
  2431*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2432* EFFECTIVE    NUMBER
  2433*-----------------------------------------------------------------
  2434* 082503                   PEMA  ADD BENEFIT GROUP
  2435* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2436* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2437* 092705    2005050300006  PEMA  ADD SPP LEASES
  2438* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2439* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2440* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2441* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2442* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2443* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2444******************************************************************
  2445*
  2446 01  CONTROL-FILE.
  2447     12  CF-RECORD-ID                       PIC XX.
  2448         88  VALID-CF-ID                        VALUE 'CF'.
  2449
  2450     12  CF-CONTROL-PRIMARY.
  2451         16  CF-COMPANY-ID                  PIC XXX.
  2452         16  CF-RECORD-TYPE                 PIC X.
  2453             88  CF-COMPANY-MASTER              VALUE '1'.
  2454             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2455             88  CF-STATE-MASTER                VALUE '3'.
  2456             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2457             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2458             88  CF-CARRIER-MASTER              VALUE '6'.
  2459             88  CF-MORTALITY-MASTER            VALUE '7'.
  2460             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2461             88  CF-TERMINAL-MASTER             VALUE '9'.
  2462             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2463             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2464             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2465             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2466             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2467             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2468             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2469             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2470             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2471         16  CF-ACCESS-CD-GENL              PIC X(4).
  2472         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2473             20  CF-PROCESSOR               PIC X(4).
  2474         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2475             20  CF-STATE-CODE              PIC XX.
  2476             20  FILLER                     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  45
* EL6318.cbl
  2477         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2478             20  FILLER                     PIC XX.
  2479             20  CF-HI-BEN-IN-REC           PIC XX.
  2480         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2481             20  FILLER                     PIC XXX.
  2482             20  CF-CARRIER-CNTL            PIC X.
  2483         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2484             20  FILLER                     PIC XX.
  2485             20  CF-HI-TYPE-IN-REC          PIC 99.
  2486         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2487             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2488                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2489             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2490             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2491         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2492             20  FILLER                     PIC X.
  2493             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2494         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2495             20  FILLER                     PIC XX.
  2496             20  CF-MORTGAGE-PLAN           PIC XX.
  2497         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2498
  2499     12  CF-LAST-MAINT-DT                   PIC XX.
  2500     12  CF-LAST-MAINT-BY                   PIC X(4).
  2501     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2502
  2503     12  CF-RECORD-BODY                     PIC X(728).
  2504
  2505
  2506****************************************************************
  2507*             COMPANY MASTER RECORD                            *
  2508****************************************************************
  2509
  2510     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2511         16  CF-COMPANY-ADDRESS.
  2512             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2513             20  CF-CL-IN-CARE-OF           PIC X(30).
  2514             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2515             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2516             20  CF-CL-CITY-STATE           PIC X(30).
  2517             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2518             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2519         16  CF-COMPANY-CD                  PIC X.
  2520         16  CF-COMPANY-PASSWORD            PIC X(8).
  2521         16  CF-SECURITY-OPTION             PIC X.
  2522             88  ALL-SECURITY                   VALUE '1'.
  2523             88  COMPANY-VERIFY                 VALUE '2'.
  2524             88  PROCESSOR-VERIFY               VALUE '3'.
  2525             88  NO-SECURITY                    VALUE '4'.
  2526             88  ALL-BUT-TERM                   VALUE '5'.
  2527         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2528             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2529         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2530             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2531         16  CF-INFORCE-LOCATION            PIC X.
  2532             88  CERTS-ARE-ONLINE               VALUE '1'.
  2533             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2534             88  NO-CERTS-AVAILABLE             VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  46
* EL6318.cbl
  2535         16  CF-LOWER-CASE-LETTERS          PIC X.
  2536         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2537             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2538             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2539             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2540             88  CF-ACCNT-CNTL                  VALUE '3'.
  2541             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2542
  2543         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2544         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2545
  2546         16  CF-LGX-CREDIT-USER             PIC X.
  2547             88  CO-IS-NOT-USER                 VALUE 'N'.
  2548             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2549
  2550         16 CF-CREDIT-CALC-CODES.
  2551             20  CF-CR-REM-TERM-CALC PIC X.
  2552               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2553               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2554               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2555               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2556               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2557               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2558               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2559             20  CF-CR-R78-METHOD           PIC X.
  2560               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2561               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2562
  2563         16  CF-CLAIM-CONTROL-COUNTS.
  2564             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2565                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2566
  2567             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2568                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2569
  2570             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2571                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2572
  2573             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2574                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2575
  2576         16  CF-CURRENT-MONTH-END           PIC XX.
  2577
  2578         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2579             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2580             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2581             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2582             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2583                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2584                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2585             20  CF-CO-PREM-REJECT-SW       PIC X.
  2586                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2587                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2588             20  CF-CO-REF-REJECT-SW        PIC X.
  2589                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2590                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2591
  2592         16  CF-CO-REPORTING-DT             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  47
* EL6318.cbl
  2593         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2594         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2595           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2596           88  CF-CO-MONTH-END                  VALUE '1'.
  2597
  2598         16  CF-LGX-CLAIM-USER              PIC X.
  2599             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2600             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2601
  2602         16  CF-CREDIT-EDIT-CONTROLS.
  2603             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2604             20  CF-MIN-AGE                 PIC 99.
  2605             20  CF-DEFAULT-AGE             PIC 99.
  2606             20  CF-MIN-TERM                PIC S999      COMP-3.
  2607             20  CF-MAX-TERM                PIC S999      COMP-3.
  2608             20  CF-DEFAULT-SEX             PIC X.
  2609             20  CF-JOINT-AGE-INPUT         PIC X.
  2610                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2611             20  CF-BIRTH-DATE-INPUT        PIC X.
  2612                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2613             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2614                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2615                 88  CF-ZERO-CARRIER            VALUE '1'.
  2616                 88  CF-ZERO-GROUPING           VALUE '2'.
  2617                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2618             20  CF-EDIT-SW                 PIC X.
  2619                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2620             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2621             20  CF-CR-PR-METHOD            PIC X.
  2622               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2623               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2624             20  FILLER                     PIC X.
  2625
  2626         16  CF-CREDIT-MISC-CONTROLS.
  2627             20  CF-REIN-TABLE-SW           PIC X.
  2628                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2629             20  CF-COMP-TABLE-SW           PIC X.
  2630                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2631             20  CF-EXPERIENCE-RETENTION-AGE
  2632                                            PIC S9        COMP-3.
  2633             20  CF-CONVERSION-DT           PIC XX.
  2634             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2635             20  CF-RUN-FREQUENCY-SW        PIC X.
  2636                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2637                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2638
  2639             20  CF-CR-CHECK-NO-CONTROL.
  2640                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2641                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2642                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2643                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2644                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2645                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2646
  2647                 24  CF-CR-CHECK-COUNT       REDEFINES
  2648                     CF-CR-CHECK-COUNTER      PIC X(4).
  2649
  2650                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  48
* EL6318.cbl
  2651                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2652
  2653                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2654                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2655                 24  CF-MAIL-PROCESSING       PIC X.
  2656                     88  MAIL-PROCESSING          VALUE 'Y'.
  2657
  2658         16  CF-MISC-SYSTEM-CONTROL.
  2659             20  CF-SYSTEM-C                 PIC X.
  2660                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2661             20  CF-SYSTEM-D                 PIC X.
  2662                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2663             20  CF-SOC-SEC-NO-SW            PIC X.
  2664                 88  SOC-SEC-NO-USED             VALUE '1'.
  2665             20  CF-MEMBER-NO-SW             PIC X.
  2666                 88  MEMBER-NO-USED              VALUE '1'.
  2667             20  CF-TAX-ID-NUMBER            PIC X(11).
  2668             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2669             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2670                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2671                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2672                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2673                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2674             20  CF-SYSTEM-E                 PIC X.
  2675                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2676
  2677         16  CF-LGX-LIFE-USER               PIC X.
  2678             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2679             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2680
  2681         16  CF-CR-MONTH-END-DT             PIC XX.
  2682
  2683         16  CF-FILE-MAINT-DATES.
  2684             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2685                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2686             20  CF-LAST-BATCH       REDEFINES
  2687                 CF-LAST-BATCH-NO               PIC X(4).
  2688             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2689             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2690             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2691             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2692             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2693             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2694             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2695             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2696             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2697             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2698
  2699         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2700         16  FILLER                         PIC X.
  2701
  2702         16  CF-ALT-MORT-CODE               PIC X(4).
  2703         16  CF-MEMBER-CAPTION              PIC X(10).
  2704
  2705         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2706             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2707             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2708             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  49
* EL6318.cbl
  2709             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2710             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2711
  2712         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2713
  2714         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2715         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2716         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2717         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2718
  2719         16  CF-AH-OVERRIDE-L1              PIC X.
  2720         16  CF-AH-OVERRIDE-L2              PIC XX.
  2721         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2722         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2723
  2724         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2725         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2726
  2727         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2728         16  CF-AR-LAST-EL860-DT            PIC XX.
  2729         16  CF-MP-MONTH-END-DT             PIC XX.
  2730
  2731         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2732         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2733             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2734
  2735         16  CF-AR-MONTH-END-DT             PIC XX.
  2736
  2737         16  CF-CRDTCRD-USER                PIC X.
  2738             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2739             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2740
  2741         16  CF-CC-MONTH-END-DT             PIC XX.
  2742
  2743         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2744
  2745         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2746             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2747             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2748             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2749         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2750         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2751         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2752         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2753             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2754             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2755         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2756         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2757         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2758             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2759         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2760
  2761         16  CF-CL-ZIP-CODE.
  2762             20  CF-CL-ZIP-PRIME.
  2763                 24  CF-CL-ZIP-1ST          PIC X.
  2764                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2765                 24  FILLER                 PIC X(4).
  2766             20  CF-CL-ZIP-PLUS4            PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  50
* EL6318.cbl
  2767         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2768             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2769             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2770             20  FILLER                     PIC XXX.
  2771
  2772         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2773         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2774         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2775         16  CF-CO-OPTION-START-DATE        PIC XX.
  2776         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2777           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2778                                                      '3' '4'.
  2779           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2780           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2781           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2782           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2783           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2784           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2785
  2786         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2787
  2788         16  CF-PAYMENT-APPROVAL-LEVELS.
  2789             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2790             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2791             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2792             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2793             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2794             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2795
  2796         16  CF-END-USER-REPORTING-USER     PIC X.
  2797             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2798             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2799
  2800         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2801             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2802             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2803
  2804         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2805
  2806         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2807         16  FILLER                         PIC X.
  2808
  2809         16  CF-CREDIT-ARCHIVE-CNTL.
  2810             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2811             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2812             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2813
  2814         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2815
  2816         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2817             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2818             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2819
  2820         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2821             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2822             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2823
  2824         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  51
* EL6318.cbl
  2825
  2826         16  CF-CO-ACH-ID-CODE              PIC  X.
  2827             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2828             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2829             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2830         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2831         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2832         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2833         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2834         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2835         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2836         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2837         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2838         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2839                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2840         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2841                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2842
  2843         16  CF-CO-OVER-SHORT.
  2844             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2845             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2846
  2847*         16  FILLER                         PIC X(102).
  2848         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2849             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2850             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2851
  2852         16  CF-AH-APPROVAL-DAYS.
  2853             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2854             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2855             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2856             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2857
  2858         16  FILLER                         PIC X(82).
  2859****************************************************************
  2860*             PROCESSOR/USER RECORD                            *
  2861****************************************************************
  2862
  2863     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2864         16  CF-PROCESSOR-NAME              PIC X(30).
  2865         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2866         16  CF-PROCESSOR-TITLE             PIC X(26).
  2867         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2868                 88  MESSAGE-YES                VALUE 'Y'.
  2869                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2870
  2871*****************************************************
  2872****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2873****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2874****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2875****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2876*****************************************************
  2877
  2878         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2879             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2880             20  CF-APPLICATION-FORCE       PIC X.
  2881             20  CF-INDIVIDUAL-APP.
  2882                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  52
* EL6318.cbl
  2883                     28  CF-BROWSE-APP      PIC X.
  2884                     28  CF-UPDATE-APP      PIC X.
  2885
  2886         16  CF-CURRENT-TERM-ON             PIC X(4).
  2887         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2888             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2889             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2890             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2891             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2892             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2893             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2894             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2895         16  CF-PROCESSOR-CARRIER           PIC X.
  2896             88  NO-CARRIER-SECURITY            VALUE ' '.
  2897         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2898             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2899         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2900             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2901         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2902             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2903
  2904         16  CF-PROC-SYS-ACCESS-SW.
  2905             20  CF-PROC-CREDIT-CLAIMS-SW.
  2906                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2907                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2908                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2909                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2910             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2911                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2912                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2913             20  CF-PROC-LIFE-GNRLDGR-SW.
  2914                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2915                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2916                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2917                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2918             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2919                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2920                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2921         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2922             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2923             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2924         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2925
  2926         16  CF-APPROVAL-LEVEL                  PIC X.
  2927             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2928             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2929             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2930             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2931
  2932         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2933
  2934         16  CF-LANGUAGE-TYPE                   PIC X.
  2935             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2936             88  CF-LANG-IS-FR                      VALUE 'F'.
  2937
  2938         16  CF-CSR-IND                         PIC X.
  2939         16  FILLER                             PIC X(239).
  2940
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  53
* EL6318.cbl
  2941****************************************************************
  2942*             PROCESSOR/REMINDERS RECORD                       *
  2943****************************************************************
  2944
  2945     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2946         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2947             20  CF-START-REMIND-DT         PIC XX.
  2948             20  CF-END-REMIND-DT           PIC XX.
  2949             20  CF-REMINDER-TEXT           PIC X(50).
  2950         16  FILLER                         PIC X(296).
  2951
  2952
  2953****************************************************************
  2954*             STATE MASTER RECORD                              *
  2955****************************************************************
  2956
  2957     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2958         16  CF-STATE-ABBREVIATION          PIC XX.
  2959         16  CF-STATE-NAME                  PIC X(25).
  2960         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2961         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2962             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2963             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2964             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2965             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2966                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2967                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2968             20  CF-ST-PREM-REJECT-SW       PIC X.
  2969                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2970                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2971             20  CF-ST-REF-REJECT-SW        PIC X.
  2972                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2973                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2974         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2975         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2976         16  CF-ST-REFUND-RULES.
  2977             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2978             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2979             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2980         16  CF-ST-FST-PMT-EXTENSION.
  2981             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2982             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2983                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2984                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2985                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2986                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2987         16  CF-ST-STATE-CALL.
  2988             20  CF-ST-CALL-UNEARNED        PIC X.
  2989             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2990             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2991         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2992             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2993             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2994         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2995         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2996         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2997         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2998         16  CF-ST-SPLIT-PAYMENT            PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  54
* EL6318.cbl
  2999         16  FILLER                         PIC X.
  3000         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3001             20  CF-ST-BENEFIT-CD           PIC XX.
  3002             20  CF-ST-BENEFIT-KIND         PIC X.
  3003                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3004                 88  CF-ST-AH-KIND              VALUE 'A'.
  3005             20  CF-ST-REM-TERM-CALC        PIC X.
  3006                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3007                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3008                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3009                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3010                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3011                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3012                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3013                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3014
  3015             20  CF-ST-REFUND-CALC          PIC X.
  3016                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3017                 88  ST-REFD-BY-R78             VALUE '1'.
  3018                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3019                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3020                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3021                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3022                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3023                 88  ST-REFD-UTAH               VALUE '7'.
  3024                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3025                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3026                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3027
  3028             20  CF-ST-EARNING-CALC         PIC X.
  3029                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3030                 88  ST-EARN-BY-R78             VALUE '1'.
  3031                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3032                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3033                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3034                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3035                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3036                 88  ST-EARN-MEAN               VALUE '8'.
  3037                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3038
  3039             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3040                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3041                 88  ST-OVRD-BY-R78             VALUE '1'.
  3042                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3043                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3044                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3045                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3046                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3047                 88  ST-OVRD-MEAN               VALUE '8'.
  3048                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3049             20  FILLER                     PIC X.
  3050
  3051         16  CF-ST-COMMISSION-CAPS.
  3052             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3053             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3054             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3055             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3056         16  CF-COMM-CAP-LIMIT-TO           PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  55
* EL6318.cbl
  3057                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3058
  3059         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3060
  3061         16  CF-ST-STATUTORY-INTEREST.
  3062             20  CF-ST-STAT-DATE-FROM       PIC X.
  3063                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3064                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3065             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3066             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3067             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3068             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3069             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3070
  3071         16  CF-ST-OVER-SHORT.
  3072             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3073             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3074
  3075         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3076
  3077         16  CF-ST-RT-CALC                  PIC X.
  3078
  3079         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3080         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3081         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3082         16  CF-ST-RF-LR-CALC               PIC X.
  3083         16  CF-ST-RF-LL-CALC               PIC X.
  3084         16  CF-ST-RF-LN-CALC               PIC X.
  3085         16  CF-ST-RF-AH-CALC               PIC X.
  3086         16  CF-ST-RF-CP-CALC               PIC X.
  3087*        16  FILLER                         PIC X(206).
  3088*CIDMOD         16  FILLER                         PIC X(192).
  3089         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3090             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3091         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3092         16  CF-ST-VFY-2ND-BENE             PIC X.
  3093         16  FILLER                         PIC X(186).
  3094
  3095****************************************************************
  3096*             BENEFIT MASTER RECORD                            *
  3097****************************************************************
  3098
  3099     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3100         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3101             20  CF-BENEFIT-CODE            PIC XX.
  3102             20  CF-BENEFIT-NUMERIC  REDEFINES
  3103                 CF-BENEFIT-CODE            PIC XX.
  3104             20  CF-BENEFIT-ALPHA           PIC XXX.
  3105             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3106             20  CF-BENEFIT-COMMENT         PIC X(10).
  3107
  3108             20  CF-LF-COVERAGE-TYPE        PIC X.
  3109                 88  CF-REDUCING                VALUE 'R'.
  3110                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3111
  3112             20  CF-SPECIAL-CALC-CD         PIC X.
  3113                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3114                 88  CF-NP-0-MO-INT             VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  56
* EL6318.cbl
  3115                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3116                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3117                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3118                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3119                 88  CF-FARM-PLAN               VALUE 'F'.
  3120                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3121                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3122                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3123                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3124                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3125                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3126                 88  CF-PRUDENTIAL              VALUE 'P'.
  3127                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3128                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3129                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3130                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3131                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3132                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3133
  3134             20  CF-JOINT-INDICATOR         PIC X.
  3135                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3136
  3137*            20  FILLER                     PIC X(12).
  3138             20  FILLER                     PIC X(11).
  3139             20  CF-BENEFIT-CATEGORY        PIC X.
  3140             20  CF-LOAN-TYPE               PIC X(8).
  3141
  3142             20  CF-CO-REM-TERM-CALC        PIC X.
  3143                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3144                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3145                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3146                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3147                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3148
  3149             20  CF-CO-EARNINGS-CALC        PIC X.
  3150                 88  CO-EARN-BY-R78             VALUE '1'.
  3151                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3152                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3153                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3154                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3155                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3156                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3157                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3158
  3159             20  CF-CO-REFUND-CALC          PIC X.
  3160                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3161                 88  CO-REFD-BY-R78             VALUE '1'.
  3162                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3163                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3164                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3165                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3166                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3167                 88  CO-REFD-MEAN               VALUE '8'.
  3168                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3169                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3170                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3171
  3172             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  57
* EL6318.cbl
  3173                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3174                 88  CO-OVRD-BY-R78             VALUE '1'.
  3175                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3176                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3177                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3178                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3179                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3180                 88  CO-OVRD-MEAN               VALUE '8'.
  3181                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3182
  3183             20  CF-CO-BEN-I-G-CD           PIC X.
  3184                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3185                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3186                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3187
  3188         16  FILLER                         PIC X(304).
  3189
  3190
  3191****************************************************************
  3192*             CARRIER MASTER RECORD                            *
  3193****************************************************************
  3194
  3195     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3196         16  CF-ADDRESS-DATA.
  3197             20  CF-MAIL-TO-NAME            PIC X(30).
  3198             20  CF-IN-CARE-OF              PIC X(30).
  3199             20  CF-ADDRESS-LINE-1          PIC X(30).
  3200             20  CF-ADDRESS-LINE-2          PIC X(30).
  3201             20  CF-CITY-STATE              PIC X(30).
  3202             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3203             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3204
  3205         16  CF-CLAIM-NO-CONTROL.
  3206             20  CF-CLAIM-NO-METHOD         PIC X.
  3207                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3208                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3209                 88  CLAIM-NO-SEQ               VALUE '3'.
  3210                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3211             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3212                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3213                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3214                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3215
  3216         16  CF-CHECK-NO-CONTROL.
  3217             20  CF-CHECK-NO-METHOD         PIC X.
  3218                 88  CHECK-NO-MANUAL            VALUE '1'.
  3219                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3220                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3221                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3222             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3223                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3224
  3225         16  CF-DOMICILE-STATE              PIC XX.
  3226
  3227         16  CF-EXPENSE-CONTROLS.
  3228             20  CF-EXPENSE-METHOD          PIC X.
  3229                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3230                 88  DOLLARS-PER-PMT            VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  58
* EL6318.cbl
  3231                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3232                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3233             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3234             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3235
  3236         16  CF-CORRESPONDENCE-CONTROL.
  3237             20  CF-LETTER-RESEND-OPT       PIC X.
  3238                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3239                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3240             20  FILLER                     PIC X(4).
  3241
  3242         16  CF-RESERVE-CONTROLS.
  3243             20  CF-MANUAL-SW               PIC X.
  3244                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3245             20  CF-FUTURE-SW               PIC X.
  3246                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3247             20  CF-PTC-SW                  PIC X.
  3248                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3249             20  CF-IBNR-SW                 PIC X.
  3250                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3251             20  CF-PTC-LF-SW               PIC X.
  3252                 88  CF-LF-PTC-USED             VALUE '1'.
  3253             20  CF-CDT-ACCESS-METHOD       PIC X.
  3254                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3255                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3256                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3257             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3258
  3259         16  CF-CLAIM-CALC-METHOD           PIC X.
  3260             88  360-PLUS-MONTHS                VALUE '1'.
  3261             88  365-PLUS-MONTHS                VALUE '2'.
  3262             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3263             88  360-DAILY                      VALUE '4'.
  3264             88  365-DAILY                      VALUE '5'.
  3265
  3266         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3267         16  FILLER                         PIC X(11).
  3268
  3269         16  CF-LIMIT-AMOUNTS.
  3270             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3271             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3272             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3273             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3274             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3275             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3276             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3277             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3278             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3279             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3280
  3281         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3282         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3283         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3284
  3285         16  CF-ZIP-CODE.
  3286             20  CF-ZIP-PRIME.
  3287                 24  CF-ZIP-1ST             PIC X.
  3288                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  59
* EL6318.cbl
  3289                 24  FILLER                 PIC X(4).
  3290             20  CF-ZIP-PLUS4               PIC X(4).
  3291         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3292             20  CF-CAN-POSTAL-1            PIC XXX.
  3293             20  CF-CAN-POSTAL-2            PIC XXX.
  3294             20  FILLER                     PIC XXX.
  3295
  3296         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3297         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3298         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3299
  3300         16  CF-RATING-SWITCH               PIC X.
  3301             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3302             88  CF-NO-RATING                   VALUE 'N'.
  3303
  3304         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3305
  3306         16  CF-CARRIER-OVER-SHORT.
  3307             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3308             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3309
  3310         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3311         16  CF-SECPAY-SWITCH               PIC X.
  3312             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3313             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3314         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3315         16  FILLER                         PIC X(448).
  3316*        16  FILLER                         PIC X(452).
  3317
  3318
  3319****************************************************************
  3320*             MORTALITY MASTER RECORD                          *
  3321****************************************************************
  3322
  3323     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3324         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3325                                INDEXED BY CF-MORT-NDX.
  3326             20  CF-MORT-TABLE              PIC X(5).
  3327             20  CF-MORT-TABLE-TYPE         PIC X.
  3328                 88  CF-MORT-JOINT              VALUE 'J'.
  3329                 88  CF-MORT-SINGLE             VALUE 'S'.
  3330                 88  CF-MORT-COMBINED           VALUE 'C'.
  3331                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3332                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3333             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3334             20  CF-MORT-AGE-METHOD         PIC XX.
  3335                 88  CF-AGE-LAST                VALUE 'AL'.
  3336                 88  CF-AGE-NEAR                VALUE 'AN'.
  3337             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3338             20  CF-MORT-ADJUSTMENT-DIRECTION
  3339                                            PIC X.
  3340                 88  CF-MINUS                   VALUE '-'.
  3341                 88  CF-PLUS                    VALUE '+'.
  3342             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3343             20  CF-MORT-JOINT-CODE         PIC X.
  3344                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3345             20  CF-MORT-PC-Q               PIC X.
  3346                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  60
* EL6318.cbl
  3347             20  CF-MORT-TABLE-CODE         PIC X(4).
  3348             20  CF-MORT-COMMENTS           PIC X(15).
  3349             20  FILLER                     PIC X(14).
  3350
  3351         16  FILLER                         PIC X(251).
  3352
  3353
  3354****************************************************************
  3355*             BUSSINESS TYPE MASTER RECORD                     *
  3356****************************************************************
  3357
  3358     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3359* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3360* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3361* AND RECORD 05 IS TYPES 81-99
  3362         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3363             20  CF-BUSINESS-TITLE          PIC  X(19).
  3364             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3365                                            PIC S9V9(4) COMP-3.
  3366             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3367             20  FILLER                     PIC  X.
  3368         16  FILLER                         PIC  X(248).
  3369
  3370
  3371****************************************************************
  3372*             TERMINAL MASTER RECORD                           *
  3373****************************************************************
  3374
  3375     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3376
  3377         16  CF-COMPANY-TERMINALS.
  3378             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3379                                  PIC X(4).
  3380         16  FILLER               PIC X(248).
  3381
  3382
  3383****************************************************************
  3384*             LIFE EDIT MASTER RECORD                          *
  3385****************************************************************
  3386
  3387     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3388         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3389             20  CF-LIFE-CODE-IN            PIC XX.
  3390             20  CF-LIFE-CODE-OUT           PIC XX.
  3391         16  FILLER                         PIC X(248).
  3392
  3393
  3394****************************************************************
  3395*             AH EDIT MASTER RECORD                            *
  3396****************************************************************
  3397
  3398     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3399         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3400             20  CF-AH-CODE-IN              PIC XXX.
  3401             20  CF-AH-CODE-OUT             PIC XX.
  3402         16  FILLER                         PIC X(248).
  3403
  3404
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  61
* EL6318.cbl
  3405****************************************************************
  3406*             CREDIBILITY TABLES                               *
  3407****************************************************************
  3408
  3409     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3410         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3411                             INDEXED BY CF-CRDB-NDX.
  3412             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3413             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3414             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3415         16  FILLER                         PIC  X(332).
  3416
  3417
  3418****************************************************************
  3419*             REPORT CUSTOMIZATION RECORD                      *
  3420****************************************************************
  3421
  3422     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3423         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3424             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3425             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3426             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3427**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3428****       A T-TRANSFER.                                   ****
  3429             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3430
  3431         16  FILLER                         PIC XX.
  3432
  3433         16  CF-CARRIER-CNTL-OPT.
  3434             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3435                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3436                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3437             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3438                                            PIC X.
  3439         16  CF-GROUP-CNTL-OPT.
  3440             20  CF-GROUP-OPT-SEQ           PIC 9.
  3441                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3442                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3443             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3444                                            PIC X(6).
  3445         16  CF-STATE-CNTL-OPT.
  3446             20  CF-STATE-OPT-SEQ           PIC 9.
  3447                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3448                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3449             20  CF-STATE-SELECT OCCURS 3 TIMES
  3450                                            PIC XX.
  3451         16  CF-ACCOUNT-CNTL-OPT.
  3452             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3453                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3454                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3455             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3456                                            PIC X(10).
  3457         16  CF-BUS-TYP-CNTL-OPT.
  3458             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3459                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3460                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3461             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3462                                            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  62
* EL6318.cbl
  3463         16  CF-LF-TYP-CNTL-OPT.
  3464             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3465                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3466                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3467             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3468                                            PIC XX.
  3469         16  CF-AH-TYP-CNTL-OPT.
  3470             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3471                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3472                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3473             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3474                                            PIC XX.
  3475         16  CF-REPTCD1-CNTL-OPT.
  3476             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3477                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3478                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3479             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3480                                            PIC X(10).
  3481         16  CF-REPTCD2-CNTL-OPT.
  3482             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3483                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3484                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3485             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3486                                            PIC X(10).
  3487         16  CF-USER1-CNTL-OPT.
  3488             20  CF-USER1-OPT-SEQ           PIC 9.
  3489                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3490                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3491             20  CF-USER1-SELECT OCCURS 3 TIMES
  3492                                            PIC X(10).
  3493         16  CF-USER2-CNTL-OPT.
  3494             20  CF-USER2-OPT-SEQ           PIC 9.
  3495                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3496                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3497             20  CF-USER2-SELECT OCCURS 3 TIMES
  3498                                            PIC X(10).
  3499         16  CF-USER3-CNTL-OPT.
  3500             20  CF-USER3-OPT-SEQ           PIC 9.
  3501                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3502                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3503             20  CF-USER3-SELECT OCCURS 3 TIMES
  3504                                            PIC X(10).
  3505         16  CF-USER4-CNTL-OPT.
  3506             20  CF-USER4-OPT-SEQ           PIC 9.
  3507                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3508                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3509             20  CF-USER4-SELECT OCCURS 3 TIMES
  3510                                            PIC X(10).
  3511         16  CF-USER5-CNTL-OPT.
  3512             20  CF-USER5-OPT-SEQ           PIC 9.
  3513                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3514                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3515             20  CF-USER5-SELECT OCCURS 3 TIMES
  3516                                            PIC X(10).
  3517         16  CF-REINS-CNTL-OPT.
  3518             20  CF-REINS-OPT-SEQ           PIC 9.
  3519                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3520                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  63
* EL6318.cbl
  3521             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3522                 24  CF-REINS-PRIME         PIC XXX.
  3523                 24  CF-REINS-SUB           PIC XXX.
  3524
  3525         16  CF-AGENT-CNTL-OPT.
  3526             20  CF-AGENT-OPT-SEQ           PIC 9.
  3527                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3528                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3529             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3530                                            PIC X(10).
  3531
  3532         16  FILLER                         PIC X(43).
  3533
  3534         16  CF-LOSS-RATIO-SELECT.
  3535             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3536             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3537         16  CF-ENTRY-DATE-SELECT.
  3538             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3539             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3540         16  CF-EFFECTIVE-DATE-SELECT.
  3541             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3542             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3543
  3544         16  CF-EXCEPTION-LIST-IND          PIC X.
  3545             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3546
  3547         16  FILLER                         PIC X(318).
  3548
  3549****************************************************************
  3550*                  EXCEPTION REPORTING RECORD                  *
  3551****************************************************************
  3552
  3553     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3554         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3555             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3556
  3557         16  CF-COMBINED-LIFE-AH-OPT.
  3558             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3559             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3560             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3561             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3562
  3563         16  CF-LIFE-OPT.
  3564             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3565             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3566             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3567             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3568             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3569             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3570             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3571             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3572             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3573             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3574
  3575         16  CF-AH-OPT.
  3576             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3577             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3578             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  64
* EL6318.cbl
  3579             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3580             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3581             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3582             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3583             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3584             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3585             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3586
  3587         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3588             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3589             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3590             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3591
  3592         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3593
  3594         16  FILLER                         PIC X(673).
  3595
  3596
  3597****************************************************************
  3598*             MORTGAGE SYSTEM PLAN RECORD                      *
  3599****************************************************************
  3600
  3601     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3602         16  CF-PLAN-TYPE                   PIC X.
  3603             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3604             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3605             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3606         16  CF-PLAN-ABBREV                 PIC XXX.
  3607         16  CF-PLAN-DESCRIPT               PIC X(10).
  3608         16  CF-PLAN-NOTES                  PIC X(20).
  3609         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3610         16  CF-PLAN-UNDERWRITING.
  3611             20  CF-PLAN-TERM-DATA.
  3612                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3613                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3614             20  CF-PLAN-AGE-DATA.
  3615                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3616                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3617                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3618             20  CF-PLAN-BENEFIT-DATA.
  3619                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3620                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3621                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3622                                            PIC S9(7)V99  COMP-3.
  3623         16  CF-PLAN-POLICY-FORMS.
  3624             20  CF-POLICY-FORM             PIC X(12).
  3625             20  CF-MASTER-APPLICATION      PIC X(12).
  3626             20  CF-MASTER-POLICY           PIC X(12).
  3627         16  CF-PLAN-RATING.
  3628             20  CF-RATE-CODE               PIC X(5).
  3629             20  CF-SEX-RATING              PIC X.
  3630                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3631                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3632             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3633             20  CF-SUB-STD-TYPE            PIC X.
  3634                 88  CF-PCT-OF-PREM            VALUE '1'.
  3635                 88  CF-PCT-OF-BENE            VALUE '2'.
  3636         16  CF-PLAN-PREM-TOLERANCES.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  65
* EL6318.cbl
  3637             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3638             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3639         16  CF-PLAN-PYMT-TOLERANCES.
  3640             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3641             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3642         16  CF-PLAN-MISC-DATA.
  3643             20  FILLER                     PIC X.
  3644             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3645             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3646         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3647         16  CF-PLAN-IND-GRP                PIC X.
  3648             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3649                                                     '1'.
  3650             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3651                                                     '2'.
  3652         16  CF-MIB-SEARCH-SW               PIC X.
  3653             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3654             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3655             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3656             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3657         16  CF-ALPHA-SEARCH-SW             PIC X.
  3658             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3659             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3660             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3661             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3662             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3663             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3664             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3665             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3666             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3667             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3668                                                     'A' 'B' 'C'
  3669                                                     'X' 'Y' 'Z'.
  3670         16  CF-EFF-DT-RULE-SW              PIC X.
  3671             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3672             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3673             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3674             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3675             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3676         16  FILLER                         PIC X(4).
  3677         16  CF-HEALTH-QUESTIONS            PIC X.
  3678             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3679         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3680         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3681         16  CF-PLAN-SNGL-JNT               PIC X.
  3682             88  CF-COMBINED-PLAN              VALUE 'C'.
  3683             88  CF-JNT-PLAN                   VALUE 'J'.
  3684             88  CF-SNGL-PLAN                  VALUE 'S'.
  3685         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3686         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3687         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3688         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3689         16  CF-RERATE-CNTL                 PIC  X.
  3690             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3691             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3692             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3693             88  CF-AUTO-RECALC                 VALUE '4'.
  3694         16  CF-BENEFIT-TYPE                PIC  X.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  66
* EL6318.cbl
  3695             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3696             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3697         16  CF-POLICY-FEE                  PIC S999V99
  3698                                                    COMP-3.
  3699         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3700         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3701         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3702         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3703         16  FILLER                         PIC  X(32).
  3704         16  CF-TERMINATION-FORM            PIC  X(04).
  3705         16  FILLER                         PIC  X(08).
  3706         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3707                                                       COMP-3.
  3708         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3709         16  CF-ISSUE-LETTER                PIC  X(4).
  3710         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3711         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3712             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3713             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3714         16  CF-MP-REFUND-CALC              PIC X.
  3715             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3716             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3717             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3718             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3719             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3720             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3721             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3722             88  CF-MP-REFD-MEAN                VALUE '8'.
  3723         16  CF-ALT-RATE-CODE               PIC  X(5).
  3724
  3725
  3726         16  FILLER                         PIC X(498).
  3727****************************************************************
  3728*             MORTGAGE COMPANY MASTER RECORD                   *
  3729****************************************************************
  3730
  3731     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3732         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3733         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3734             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3735             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3736             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3737             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3738             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3739
  3740         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3741         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3742         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3743         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3744         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3745
  3746         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3747             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3748         16  CF-MP-RECON-USE-IND            PIC X(1).
  3749             88  CF-MP-USE-RECON             VALUE 'Y'.
  3750         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3751             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3752         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  67
* EL6318.cbl
  3753             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3754             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3755         16  FILLER                         PIC X(1).
  3756         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3757             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3758         16  CF-MORTG-MIB-VERSION           PIC X.
  3759             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3760             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3761             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3762         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3763             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3764                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3765             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3766                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3767             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3768                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3769             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3770                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3771             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3772                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3773             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3774                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3775         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3776         16  FILLER                         PIC X(7).
  3777         16  CF-MORTG-DESTINATION-SYMBOL.
  3778             20  CF-MORTG-MIB-COMM          PIC X(5).
  3779             20  CF-MORTG-MIB-TERM          PIC X(5).
  3780         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3781             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3782         16  FILLER                         PIC X(03).
  3783         16  CF-MP-CHECK-NO-CONTROL.
  3784             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3785                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3786                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3787                                                ' ' LOW-VALUES.
  3788                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3789                                               VALUE '3'.
  3790         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3791         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3792         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3793             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3794                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3795             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3796                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3797             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3798                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3799             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3800                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3801             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3802                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3803             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3804                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3805         16  CF-MORTG-BILLING-AREA.
  3806             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3807                                            PIC X.
  3808         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3809         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3810         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  68
* EL6318.cbl
  3811         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3812             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3813             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3814         16  FILLER                         PIC X.
  3815         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3816             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3817             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3818         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3819         16  FILLER                         PIC X(8).
  3820         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3821         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3822         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3823         16  CF-ACH-COMPANY-ID.
  3824             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3825                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3826                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3827                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3828             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3829         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3830             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3831         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3832             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3833             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3834         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3835         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3836         16  FILLER                         PIC X(536).
  3837
  3838****************************************************************
  3839*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3840****************************************************************
  3841
  3842     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3843         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3844             20  CF-FEMALE-HEIGHT.
  3845                 24  CF-FEMALE-FT           PIC 99.
  3846                 24  CF-FEMALE-IN           PIC 99.
  3847             20  CF-FEMALE-MIN-WT           PIC 999.
  3848             20  CF-FEMALE-MAX-WT           PIC 999.
  3849         16  FILLER                         PIC X(428).
  3850
  3851     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3852         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3853             20  CF-MALE-HEIGHT.
  3854                 24  CF-MALE-FT             PIC 99.
  3855                 24  CF-MALE-IN             PIC 99.
  3856             20  CF-MALE-MIN-WT             PIC 999.
  3857             20  CF-MALE-MAX-WT             PIC 999.
  3858         16  FILLER                         PIC X(428).
  3859******************************************************************
  3860*             AUTOMATIC ACTIVITY RECORD                          *
  3861******************************************************************
  3862     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3863         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3864             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3865             20  CF-SYS-LETTER-ID           PIC X(04).
  3866             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3867             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3868             20  CF-SYS-RESET-SW            PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  69
* EL6318.cbl
  3869             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3870             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3871
  3872         16  FILLER                         PIC X(50).
  3873
  3874         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3875             20  CF-USER-ACTIVE-SW          PIC X(01).
  3876             20  CF-USER-LETTER-ID          PIC X(04).
  3877             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3878             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3879             20  CF-USER-RESET-SW           PIC X(01).
  3880             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3881             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3882             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3883
  3884         16  FILLER                         PIC X(246).
  3885*                                COPY ERCPNDB.
  3886******************************************************************
  3887*                                                                *
  3888*                                                                *
  3889*                            ERCPNDB.                            *
  3890*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3891*                            VMOD=2.025                          *
  3892*                                                                *
  3893*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3894*                                                                *
  3895******************************************************************
  3896*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3897*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3898******************************************************************
  3899*                                                                *
  3900*                                                                *
  3901*   FILE TYPE = VSAM,KSDS                                        *
  3902*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3903*                                                                *
  3904*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3905*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3906*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3907*                                                 RKP=13,LEN=36  *
  3908*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3909*                                      AND CHG-SEQ.)             *
  3910*                                                RKP=49,LEN=11   *
  3911*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3912*                                      AND CHG-SEQ.)             *
  3913*                                                RKP=60,LEN=15   *
  3914*                                                                *
  3915*   LOG = NO                                                     *
  3916*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3917******************************************************************
  3918******************************************************************
  3919*                   C H A N G E   L O G
  3920*
  3921* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3922*-----------------------------------------------------------------
  3923*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3924* EFFECTIVE    NUMBER
  3925*-----------------------------------------------------------------
  3926* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  70
* EL6318.cbl
  3927* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3928* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3929* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3930* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3931* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3932* 032306                   PEMA  ADD BOW LOAN NUMBER
  3933* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  3934* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3935* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3936* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3937* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3938* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3939* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3940* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3941******************************************************************
  3942
  3943 01  PENDING-BUSINESS.
  3944     12  PB-RECORD-ID                     PIC XX.
  3945         88  VALID-PB-ID                        VALUE 'PB'.
  3946
  3947     12  PB-CONTROL-PRIMARY.
  3948         16  PB-COMPANY-CD                PIC X.
  3949         16  PB-ENTRY-BATCH               PIC X(6).
  3950         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3951         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3952
  3953     12  PB-CONTROL-BY-ACCOUNT.
  3954         16  PB-COMPANY-CD-A1             PIC X.
  3955         16  PB-CARRIER                   PIC X.
  3956         16  PB-GROUPING.
  3957             20  PB-GROUPING-PREFIX       PIC XXX.
  3958             20  PB-GROUPING-PRIME        PIC XXX.
  3959         16  PB-STATE                     PIC XX.
  3960         16  PB-ACCOUNT.
  3961             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3962             20  PB-ACCOUNT-PRIME         PIC X(6).
  3963         16  PB-CERT-EFF-DT               PIC XX.
  3964         16  PB-CERT-NO.
  3965             20  PB-CERT-PRIME            PIC X(10).
  3966             20  PB-CERT-SFX              PIC X.
  3967         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3968
  3969         16  PB-RECORD-TYPE               PIC X.
  3970             88  PB-MAILING-DATA                VALUE '0'.
  3971             88  PB-ISSUE                       VALUE '1'.
  3972             88  PB-CANCELLATION                VALUE '2'.
  3973             88  PB-BATCH-TRAILER               VALUE '9'.
  3974
  3975     12  PB-CONTROL-BY-ORIG-BATCH.
  3976         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3977         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3978         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3979         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3980
  3981     12  PB-CONTROL-BY-CSR.
  3982         16  PB-CSR-COMPANY-CD            PIC X.
  3983         16  PB-CSR-ID                    PIC X(4).
  3984         16  PB-CSR-ENTRY-BATCH           PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  71
* EL6318.cbl
  3985         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3986         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3987******************************************************************
  3988*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3989******************************************************************
  3990
  3991     12  PB-LAST-MAINT-DT                 PIC XX.
  3992     12  PB-LAST-MAINT-BY                 PIC X(4).
  3993     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3994
  3995     12  PB-RECORD-BODY                   PIC X(375).
  3996
  3997     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3998         16  PB-CERT-ORIGIN               PIC X.
  3999             88  CLASIC-CREATED-CERT         VALUE '1'.
  4000         16  PB-I-NAME.
  4001             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4002             20  PB-I-INSURED-FIRST-NAME.
  4003                 24  PB-I-INSURED-1ST-INIT PIC X.
  4004                 24  FILLER                PIC X(9).
  4005             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4006         16  PB-I-AGE                     PIC S99   COMP-3.
  4007         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4008         16  PB-I-BIRTHDAY                PIC XX.
  4009         16  PB-I-INSURED-SEX             PIC X.
  4010             88  PB-SEX-MALE     VALUE 'M'.
  4011             88  PB-SEX-FEMALE   VALUE 'F'.
  4012
  4013         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4014         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4015         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4016         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4017         16  PB-I-SKIP-CODE               PIC X.
  4018             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4019             88  PB-SKIP-JULY              VALUE '1'.
  4020             88  PB-SKIP-AUGUST            VALUE '2'.
  4021             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4022             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4023             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4024             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4025             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4026             88  PB-SKIP-JUNE              VALUE '8'.
  4027             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4028             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4029             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4030         16  PB-I-TERM-TYPE               PIC X.
  4031             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4032             88  PB-PAID-WEEKLY            VALUE 'W'.
  4033             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4034             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4035             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4036         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4037         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4038         16  PB-I-DATA-ENTRY-SW           PIC X.
  4039             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4040             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4041             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4042             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  72
* EL6318.cbl
  4043         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4044         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4045*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4046         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4047         16  FILLER                       PIC X.
  4048
  4049         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4050             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4051             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4052                                                   '90' THRU '99'.
  4053         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4054                                          PIC XX.
  4055         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4056         16  PB-I-AMOUNT-FINANCED REDEFINES
  4057                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4058         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4059         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4060                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4061         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4062         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4063         16  PB-I-CLP-AMOUNT REDEFINES
  4064                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4065         16  PB-I-LF-CALC-FLAG            PIC X.
  4066             88 PB-COMP-LF-PREM               VALUE '?'.
  4067         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4068         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4069         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4070         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4071         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4072         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4073         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4074         16  PB-I-LF-ABBR                 PIC XXX.
  4075         16  PB-I-LF-INPUT-CD             PIC XX.
  4076
  4077         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4078             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4079             88  PB-INVALID-AH               VALUE '  ' '00'
  4080                                                   '90' THRU '99'.
  4081         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4082         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4083         16  PB-I-AH-CALC-FLAG            PIC X.
  4084             88 PB-COMP-AH-PREM                  VALUE '?'.
  4085         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4086         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4087         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4088         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4089         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4090         16  PB-I-AH-ABBR                 PIC XXX.
  4091         16  PB-I-AH-INPUT-CD             PIC XXX.
  4092
  4093         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4094         16  PB-I-REIN-TABLE              PIC XXX.
  4095         16  PB-I-BUSINESS-TYPE           PIC 99.
  4096         16  PB-I-INDV-GRP-CD             PIC X.
  4097         16  PB-I-MORT-CODE.
  4098             20  PB-I-TABLE               PIC X.
  4099             20  PB-I-INTEREST            PIC XX.
  4100             20  PB-I-MORT-TYP            PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  73
* EL6318.cbl
  4101         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4102         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4103         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4104         16  PB-I-INDV-GRP-OVRD           PIC X.
  4105         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4106         16  PB-I-SIG-SW                  PIC X.
  4107             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4108         16  PB-I-RATE-CLASS              PIC XX.
  4109         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4110         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4111         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4112         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4113         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4114         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4115         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4116         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4117         16  PB-I-OB-FLAG                 PIC X.
  4118             88  PB-I-OB                      VALUE 'B'.
  4119             88  PB-I-SUMMARY                 VALUE 'Z'.
  4120         16  PB-I-ENTRY-STATUS            PIC X.
  4121             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4122                                              'M' '5' '9' '2'.
  4123             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4124             88  PB-I-POLICY-PENDING          VALUE '2'.
  4125             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4126             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4127             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4128             88  PB-I-REIN-ONLY               VALUE '9'.
  4129             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4130             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4131             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4132             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4133         16  PB-I-INT-CODE                PIC X.
  4134             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4135             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4136         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4137         16  PB-I-SOC-SEC-NO              PIC X(11).
  4138         16  PB-I-MEMBER-NO               PIC X(12).
  4139         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4140*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4141         16  PB-I-OLD-LOF                 PIC XXX.
  4142         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4143         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4144         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4145         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4146         16  PB-I-LIFE-INDICATOR          PIC X.
  4147             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4148         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4149         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4150                                          PIC S9(5)V99    COMP-3.
  4151         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4152             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4153             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4154         16  PB-I-1ST-PMT-DT              PIC XX.
  4155         16  PB-I-JOINT-INSURED.
  4156             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4157             20 PB-I-JOINT-FIRST-NAME.
  4158                24  PB-I-JOINT-FIRST-INIT PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  74
* EL6318.cbl
  4159                24  FILLER                PIC X(9).
  4160             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4161*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4162         16  PB-I-BENEFICIARY-NAME.
  4163             20  PB-I-BANK-NUMBER         PIC X(10).
  4164             20  FILLER                   PIC X(15).
  4165         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4166         16  PB-I-REFERENCE               PIC X(12).
  4167         16  FILLER REDEFINES PB-I-REFERENCE.
  4168             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4169             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4170             20  PB-I-CLP-STATE           PIC XX.
  4171         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4172             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4173             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4174             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4175         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4176         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4177         16  PB-I-RESIDENT-STATE          PIC XX.
  4178         16  PB-I-RATE-CODE               PIC X(4).
  4179         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4180         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4181         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4182         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4183         16  PB-I-BANK-NOCHRGB            PIC 99.
  4184         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4185         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4186
  4187     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4188         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4189             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4190         16  PB-C-CANCEL-ORIGIN           PIC X.
  4191             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4192         16  PB-C-LF-CANCEL-DT            PIC XX.
  4193         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4194         16  PB-C-LF-CALC-REQ             PIC X.
  4195             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4196         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4197         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4198         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4199             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4200         16  PB-C-AH-CANCEL-DT            PIC XX.
  4201         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4202         16  PB-C-AH-CALC-REQ             PIC X.
  4203             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4204         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4205         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4206         16  PB-C-LAST-NAME               PIC X(15).
  4207         16  PB-C-REFUND-SW               PIC X.
  4208             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4209             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4210         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4211         16  PB-C-PAYEE-CODE              PIC X(6).
  4212         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4213         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4214         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4215         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4216         16  PB-C-REFERENCE               PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  75
* EL6318.cbl
  4217         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4218         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4219         16  PB-C-POST-CARD-IND           PIC X.
  4220         16  PB-C-CANCEL-REASON           PIC X.
  4221         16  PB-C-REF-INTERFACE-SW        PIC X.
  4222         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4223         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4224         16  FILLER                       PIC X(01).
  4225*        16  FILLER                       PIC X(18).
  4226         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4227*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4228         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4229         16  PB-CANCELED-CERT-DATA.
  4230             20  PB-CI-INSURED-NAME.
  4231                 24  PB-CI-LAST-NAME      PIC X(15).
  4232                 24  PB-CI-INITIALS       PIC XX.
  4233             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4234             20  PB-CI-INSURED-SEX        PIC X.
  4235             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4236             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4237             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4238             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4239             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4240             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4241             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4242             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4243             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4244             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4245             20  PB-CI-RATE-CLASS         PIC XX.
  4246             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4247             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4248             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4249             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4250             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4251             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4252             20  PB-CI-LF-ABBR            PIC X(3).
  4253             20  PB-CI-AH-ABBR            PIC X(3).
  4254             20  PB-CI-OB-FLAG            PIC X.
  4255                 88  PB-CI-OB                VALUE 'B'.
  4256             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4257                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4258                                           'M' '4' '5' '9' '2'.
  4259                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4260                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4261                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4262                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4263                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4264                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4265                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4266                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4267                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4268                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4269                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4270                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4271             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4272                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4273                                           'M' '4' '5' '9' '2'.
  4274                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  76
* EL6318.cbl
  4275                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4276                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4277                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4278                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4279                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4280                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4281                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4282                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4283                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4284                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4285                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4286             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4287             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4288             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4289             20  PB-CI-MEMBER-NO          PIC X(12).
  4290             20  PB-CI-INT-CODE           PIC X.
  4291                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4292                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4293             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4294             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4295             20  PB-CI-COMP-EXCP-SW       PIC X.
  4296                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4297                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4298             20  PB-CI-ENTRY-STATUS       PIC X.
  4299             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4300             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4301             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4302             20  PB-CI-DEATH-DT           PIC XX.
  4303             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4304             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4305             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4306             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4307             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4308             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4309             20  PB-CI-ENTRY-DT              PIC XX.
  4310             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4311             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4312             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4313             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4314             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4315             20  PB-CI-OLD-LOF               PIC XXX.
  4316*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4317             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4318             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4319             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4320             20  PB-CI-INDV-GRP-CD           PIC X.
  4321             20  PB-CI-BENEFICIARY-NAME.
  4322                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4323                 24  FILLER                  PIC X(15).
  4324             20  PB-CI-NOTE-SW               PIC X.
  4325             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4326             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4327             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4328             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4329             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4330             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4331             20  PB-CI-FIRST-NAME            PIC X(10).
  4332             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  77
* EL6318.cbl
  4333
  4334         16  FILLER                       PIC X(13).
  4335*032306  16  FILLER                       PIC X(27).
  4336*        16  FILLER                       PIC X(46).
  4337
  4338     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4339         16  FILLER                       PIC X(10).
  4340         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4341         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4342         16  PB-M-INSURED-MID-INIT        PIC X.
  4343         16  PB-M-INSURED-AGE             PIC 99.
  4344         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4345         16  PB-M-INSURED-SEX             PIC X.
  4346         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4347         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4348         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4349         16  PB-M-INSURED-CITY-STATE.
  4350             20  PB-M-INSURED-CITY        PIC X(28).
  4351             20  PB-M-INSURED-STATE       PIC XX.
  4352         16  PB-M-INSURED-ZIP-CODE.
  4353             20  PB-M-INSURED-ZIP-PRIME.
  4354                 24  PB-M-INSURED-ZIP-1   PIC X.
  4355                     88  PB-M-CANADIAN-POST-CODE
  4356                                             VALUE 'A' THRU 'Z'.
  4357                 24  FILLER               PIC X(4).
  4358             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4359         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4360                                        PB-M-INSURED-ZIP-CODE.
  4361             20  PM-M-INS-CAN-POST1       PIC XXX.
  4362             20  PM-M-INS-CAN-POST2       PIC XXX.
  4363             20  FILLER                   PIC XXX.
  4364         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4365         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4366         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4367         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4368         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4369         16  PB-M-CRED-BENE-CITYST.
  4370             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4371             20  PB-M-CRED-BENE-STATE     PIC XX.
  4372         16  FILLER                       PIC X(92).
  4373
  4374     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4375         16  FILLER                       PIC X(10).
  4376         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4377         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4378         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4379         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4380         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4381         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4382         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4383         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4384         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4385         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4386         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4387         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4388         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4389         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4390         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  78
* EL6318.cbl
  4391         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4392         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4393         16  PB-ACCOUNT-NAME              PIC X(30).
  4394         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4395         16  PB-REFERENCE                 PIC X(12).
  4396         16  PB-B-RECEIVED-DT             PIC XX.
  4397         16  FILLER                       PIC X(234).
  4398
  4399     12  PB-RECORD-STATUS.
  4400         16  PB-CREDIT-SELECT-DT          PIC XX.
  4401         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4402         16  PB-BILLED-DT                 PIC XX.
  4403         16  PB-BILLING-STATUS            PIC X.
  4404             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4405             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4406             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4407         16  PB-RECORD-BILL               PIC X.
  4408             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4409             88  PB-RECORD-RETURNED           VALUE 'R'.
  4410             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4411             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4412             88  PB-OVERRIDE-AH               VALUE 'A'.
  4413             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4414         16  PB-BATCH-ENTRY               PIC X.
  4415             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4416             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4417             88  PB-REISSUED-CERT             VALUE 'E'.
  4418             88  PB-MONTHLY-CERT              VALUE 'M'.
  4419             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4420             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4421             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4422         16  PB-FORCE-CODE                PIC X.
  4423             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4424             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4425             88  PB-CANCEL-FORCE              VALUE '8'.
  4426             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4427             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4428             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4429             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4430             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4431             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4432             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4433         16  PB-FATAL-FLAG                PIC X.
  4434             88  PB-FATAL-ERRORS              VALUE 'X'.
  4435         16  PB-FORCE-ER-CD               PIC X.
  4436             88  PB-FORCE-ERRORS              VALUE 'F'.
  4437             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4438         16  PB-WARN-ER-CD                PIC X.
  4439             88  PB-WARNING-ERRORS            VALUE 'W'.
  4440         16  FILLER                       PIC X.
  4441         16  PB-OUT-BAL-CD                PIC X.
  4442             88  PB-OUT-OF-BAL                VALUE 'O'.
  4443         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4444         16  PB-AH-OVERRIDE-L1            PIC X.
  4445         16  PB-INPUT-DT                  PIC XX.
  4446         16  PB-INPUT-BY                  PIC X(4).
  4447         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4448         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  79
* EL6318.cbl
  4449         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4450         16  PB-LF-EARNING-METHOD         PIC X.
  4451         16  PB-AH-EARNING-METHOD         PIC X.
  4452         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4453         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4454         16  PB-REIN-CD                   PIC XXX.
  4455         16  PB-LF-REFUND-TYPE            PIC X.
  4456         16  PB-AH-REFUND-TYPE            PIC X.
  4457         16  PB-ACCT-EFF-DT               PIC XX.
  4458         16  PB-ACCT-EXP-DT               PIC XX.
  4459         16  PB-COMPANY-ID                PIC X(3).
  4460         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4461         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4462         16  PB-SV-CARRIER                PIC X.
  4463         16  PB-SV-GROUPING               PIC X(6).
  4464         16  PB-SV-STATE                  PIC XX.
  4465         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4466         16  PB-GA-BILLING-INFO.
  4467             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4468                                          PIC XX.
  4469         16  PB-SV-REMIT-TO  REDEFINES
  4470             PB-GA-BILLING-INFO           PIC X(10).
  4471         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4472         16  PB-I-LOAN-OFFICER            PIC X(5).
  4473         16  PB-I-VIN                     PIC X(17).
  4474
  4475         16  FILLER                       PIC X(04).
  4476         16  IMNET-BYPASS-SW              PIC X.
  4477
  4478******************************************************************
  4479*                COMMON EDIT ERRORS                              *
  4480******************************************************************
  4481
  4482     12  PB-COMMON-ERRORS.
  4483         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4484                                           PIC S9(4)     COMP.
  4485
  4486******************************************************************
  4487*                                COPY ELCCERT.
  4488******************************************************************
  4489*                                                                *
  4490*                            ELCCERT.                            *
  4491*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4492*                            VMOD=2.013                          *
  4493*                                                                *
  4494*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4495*                                                                *
  4496*   FILE TYPE = VSAM,KSDS                                        *
  4497*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4498*                                                                *
  4499*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4500*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4501*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4502*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4503*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4504*                                                                *
  4505*   LOG = YES                                                    *
  4506*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  80
* EL6318.cbl
  4507******************************************************************
  4508*                   C H A N G E   L O G
  4509*
  4510* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4511*-----------------------------------------------------------------
  4512*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4513* EFFECTIVE    NUMBER
  4514*-----------------------------------------------------------------
  4515* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4516* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4517* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4518* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4519* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4520* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4521* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4522* 032612  CR2011110200001  PEMA  AHL CHANGES
  4523******************************************************************
  4524
  4525 01  CERTIFICATE-MASTER.
  4526     12  CM-RECORD-ID                      PIC XX.
  4527         88  VALID-CM-ID                      VALUE 'CM'.
  4528
  4529     12  CM-CONTROL-PRIMARY.
  4530         16  CM-COMPANY-CD                 PIC X.
  4531         16  CM-CARRIER                    PIC X.
  4532         16  CM-GROUPING.
  4533             20  CM-GROUPING-PREFIX        PIC X(3).
  4534             20  CM-GROUPING-PRIME         PIC X(3).
  4535         16  CM-STATE                      PIC XX.
  4536         16  CM-ACCOUNT.
  4537             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4538             20  CM-ACCOUNT-PRIME          PIC X(6).
  4539         16  CM-CERT-EFF-DT                PIC XX.
  4540         16  CM-CERT-NO.
  4541             20  CM-CERT-PRIME             PIC X(10).
  4542             20  CM-CERT-SFX               PIC X.
  4543
  4544     12  CM-CONTROL-BY-NAME.
  4545         16  CM-COMPANY-CD-A1              PIC X.
  4546         16  CM-INSURED-LAST-NAME          PIC X(15).
  4547         16  CM-INSURED-INITIALS.
  4548             20  CM-INSURED-INITIAL1       PIC X.
  4549             20  CM-INSURED-INITIAL2       PIC X.
  4550
  4551     12  CM-CONTROL-BY-SSN.
  4552         16  CM-COMPANY-CD-A2              PIC X.
  4553         16  CM-SOC-SEC-NO.
  4554             20  CM-SSN-STATE              PIC XX.
  4555             20  CM-SSN-ACCOUNT            PIC X(6).
  4556             20  CM-SSN-LN3.
  4557                 25  CM-INSURED-INITIALS-A2.
  4558                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4559                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4560                 25 CM-PART-LAST-NAME-A2         PIC X.
  4561
  4562     12  CM-CONTROL-BY-CERT-NO.
  4563         16  CM-COMPANY-CD-A4              PIC X.
  4564         16  CM-CERT-NO-A4                 PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  81
* EL6318.cbl
  4565
  4566     12  CM-CONTROL-BY-MEMB.
  4567         16  CM-COMPANY-CD-A5              PIC X.
  4568         16  CM-MEMBER-NO.
  4569             20  CM-MEMB-STATE             PIC XX.
  4570             20  CM-MEMB-ACCOUNT           PIC X(6).
  4571             20  CM-MEMB-LN4.
  4572                 25  CM-INSURED-INITIALS-A5.
  4573                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4574                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4575                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4576
  4577     12  CM-INSURED-PROFILE-DATA.
  4578         16  CM-INSURED-FIRST-NAME.
  4579             20  CM-INSURED-1ST-INIT       PIC X.
  4580             20  FILLER                    PIC X(9).
  4581         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4582         16  CM-INSURED-SEX                PIC X.
  4583             88  CM-SEX-MALE                  VALUE 'M'.
  4584             88  CM-SEX-FEMAL                 VALUE 'F'.
  4585         16  CM-INSURED-JOINT-AGE          PIC 99.
  4586         16  CM-JOINT-INSURED-NAME.
  4587             20  CM-JT-LAST-NAME           PIC X(15).
  4588             20  CM-JT-FIRST-NAME.
  4589                 24  CM-JT-1ST-INIT        PIC X.
  4590                 24  FILLER                PIC X(9).
  4591             20  CM-JT-INITIAL             PIC X.
  4592
  4593     12  CM-LIFE-DATA.
  4594         16  CM-LF-BENEFIT-CD              PIC XX.
  4595         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4596         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4597         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4598         16  CM-LF-DEV-CODE                PIC XXX.
  4599         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4600         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4601         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4602         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4603         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4604         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4605         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4606         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4607         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4608         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4609         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4610         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4611         16  FILLER                        PIC XX.
  4612
  4613     12  CM-AH-DATA.
  4614         16  CM-AH-BENEFIT-CD              PIC XX.
  4615         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4616         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4617         16  CM-AH-DEV-CODE                PIC XXX.
  4618         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4619         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4620         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4621         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4622         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  82
* EL6318.cbl
  4623         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4624         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4625         16  CM-AH-PAID-THRU-DT            PIC XX.
  4626             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4627         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4628         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4629         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4630         16  FILLER                        PIC X.
  4631
  4632     12  CM-LOAN-INFORMATION.
  4633         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4634         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4635                                           PIC S9(5)V99  COMP-3.
  4636         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4637         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4638         16  CM-PAY-FREQUENCY              PIC S99.
  4639         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4640         16  CM-RATE-CLASS                 PIC XX.
  4641         16  CM-BENEFICIARY                PIC X(25).
  4642         16  CM-POLICY-FORM-NO             PIC X(12).
  4643         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4644         16  CM-LAST-ADD-ON-DT             PIC XX.
  4645         16  CM-DEDUCTIBLE-AMOUNTS.
  4646             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4647             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4648         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4649             20  CM-RESIDENT-STATE         PIC XX.
  4650             20  CM-RATE-CODE              PIC X(4).
  4651             20  FILLER                    PIC XX.
  4652         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4653             20  CM-LOAN-OFFICER           PIC X(5).
  4654             20  FILLER                    PIC XXX.
  4655         16  CM-CSR-CODE                   PIC XXX.
  4656         16  CM-UNDERWRITING-CODE          PIC X.
  4657             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4658         16  CM-POST-CARD-IND              PIC X.
  4659         16  CM-NH-INTERFACE-SW            PIC X.
  4660         16  CM-PREMIUM-TYPE               PIC X.
  4661             88  CM-SING-PRM                  VALUE '1'.
  4662             88  CM-O-B-COVERAGE              VALUE '2'.
  4663             88  CM-OPEN-END                  VALUE '3'.
  4664         16  CM-IND-GRP-TYPE               PIC X.
  4665             88  CM-INDIVIDUAL                VALUE 'I'.
  4666             88  CM-GROUP                     VALUE 'G'.
  4667         16  CM-SKIP-CODE                  PIC X.
  4668             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4669             88  SKIP-JULY                    VALUE '1'.
  4670             88  SKIP-AUGUST                  VALUE '2'.
  4671             88  SKIP-SEPTEMBER               VALUE '3'.
  4672             88  SKIP-JULY-AUG                VALUE '4'.
  4673             88  SKIP-AUG-SEPT                VALUE '5'.
  4674             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4675             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4676             88  SKIP-JUNE                    VALUE '8'.
  4677             88  SKIP-JUNE-JULY               VALUE '9'.
  4678             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4679             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4680         16  CM-PAYMENT-MODE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  83
* EL6318.cbl
  4681             88  PAY-MONTHLY                  VALUE SPACE.
  4682             88  PAY-WEEKLY                   VALUE '1'.
  4683             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4684             88  PAY-BI-WEEKLY                VALUE '3'.
  4685             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4686         16  CM-LOAN-NUMBER                PIC X(8).
  4687         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4688         16  CM-OLD-LOF                    PIC XXX.
  4689*        16  CM-LOAN-OFFICER               PIC XXX.
  4690         16  CM-REIN-TABLE                 PIC XXX.
  4691         16  CM-SPECIAL-REIN-CODE          PIC X.
  4692         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4693         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4694         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4695
  4696     12  CM-STATUS-DATA.
  4697         16  CM-ENTRY-STATUS               PIC X.
  4698         16  CM-ENTRY-DT                   PIC XX.
  4699
  4700         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4701         16  CM-LF-CANCEL-DT               PIC XX.
  4702         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4703
  4704         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4705         16  CM-LF-DEATH-DT                PIC XX.
  4706         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4707
  4708         16  CM-LF-CURRENT-STATUS          PIC X.
  4709             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4710                                                'M' '4' '5' '9'.
  4711             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4712             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4713             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4714             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4715             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4716             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4717             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4718             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4719             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4720             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4721             88  CM-LF-DECLINED               VALUE 'D'.
  4722             88  CM-LF-VOIDED                 VALUE 'V'.
  4723
  4724         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4725         16  CM-AH-CANCEL-DT               PIC XX.
  4726         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4727
  4728         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4729         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4730         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4731
  4732         16  CM-AH-CURRENT-STATUS          PIC X.
  4733             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4734                                                'M' '4' '5' '9'.
  4735             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4736             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4737             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4738             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  84
* EL6318.cbl
  4739             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4740             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4741             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4742             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4743             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4744             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4745             88  CM-AH-DECLINED               VALUE 'D'.
  4746             88  CM-AH-VOIDED                 VALUE 'V'.
  4747
  4748         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4749             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4750             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4751             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4752         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4753
  4754         16  CM-ENTRY-BATCH                PIC X(6).
  4755         16  CM-LF-EXIT-BATCH              PIC X(6).
  4756         16  CM-AH-EXIT-BATCH              PIC X(6).
  4757         16  CM-LAST-MONTH-END             PIC XX.
  4758
  4759     12  CM-NOTE-SW                        PIC X.
  4760         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4761         88  CERT-NOTES-PRESENT               VALUE '1'.
  4762         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4763         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4764         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4765         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4766         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4767         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4768     12  CM-COMP-EXCP-SW                   PIC X.
  4769         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4770         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4771     12  CM-INSURED-ADDRESS-SW             PIC X.
  4772         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4773         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4774
  4775*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4776     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4777     12  FILLER                            PIC X.
  4778
  4779*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4780     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4781     12  FILLER                            PIC X.
  4782*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4783     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4784
  4785     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4786         88  CERT-ADDED-BATCH                 VALUE ' '.
  4787         88  CERT-ADDED-ONLINE                VALUE '1'.
  4788         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4789         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4790         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4791     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4792         88  CERT-AS-LOADED                   VALUE ' '.
  4793         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4794         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4795         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4796         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  85
* EL6318.cbl
  4797         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4798         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4799         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4800
  4801     12  CM-ACCOUNT-COMM-PCTS.
  4802         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4803         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4804
  4805     12  CM-USER-FIELD                     PIC X.
  4806     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4807     12  CM-CLP-STATE                      PIC XX.
  4808     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4809     12  CM-USER-RESERVED                  PIC XXX.
  4810     12  FILLER REDEFINES CM-USER-RESERVED.
  4811         16  CM-AH-CLASS-CD                PIC XX.
  4812         16  F                             PIC X.
  4813******************************************************************
  4814*                                COPY ELCCRTO.
  4815******************************************************************
  4816*                                                                *
  4817*                            ELCCRTO.                            *
  4818*                                                                *
  4819*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  4820*                                                                *
  4821*   FILE TYPE = VSAM,KSDS                                        *
  4822*   RECORD SIZE = 524  RECFORM = FIXED                           *
  4823*                                                                *
  4824*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  4825*                                                                *
  4826*   LOG = YES                                                    *
  4827*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4828******************************************************************
  4829*                   C H A N G E   L O G
  4830*
  4831* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4832*-----------------------------------------------------------------
  4833*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4834* EFFECTIVE    NUMBER
  4835*-----------------------------------------------------------------
  4836* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  4837* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  4838* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  4839******************************************************************
  4840 01  ORIGINAL-CERTIFICATE.
  4841     12  OC-RECORD-ID                      PIC XX.
  4842         88  VALID-OC-ID                      VALUE 'OC'.
  4843     12  OC-CONTROL-PRIMARY.
  4844         16  OC-COMPANY-CD                 PIC X.
  4845         16  OC-CARRIER                    PIC X.
  4846         16  OC-GROUPING                   PIC X(6).
  4847         16  OC-STATE                      PIC XX.
  4848         16  OC-ACCOUNT                    PIC X(10).
  4849         16  OC-CERT-EFF-DT                PIC XX.
  4850         16  OC-CERT-NO.
  4851             20  OC-CERT-PRIME             PIC X(10).
  4852             20  OC-CERT-SFX               PIC X.
  4853         16  OC-RECORD-TYPE                PIC X.
  4854         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  86
* EL6318.cbl
  4855     12  OC-LAST-MAINT-DT                  PIC XX.
  4856     12  OC-LAST-MAINT-BY                  PIC X(4).
  4857     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  4858     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  4859     12  FILLER                            PIC X(49).
  4860     12  OC-ORIG-REC.
  4861         16  OC-INS-LAST-NAME              PIC X(15).
  4862         16  OC-INS-FIRST-NAME             PIC X(10).
  4863         16  OC-INS-MIDDLE-INIT            PIC X.
  4864         16  OC-INS-AGE                    PIC S999     COMP-3.
  4865         16  OC-JNT-LAST-NAME              PIC X(15).
  4866         16  OC-JNT-FIRST-NAME             PIC X(10).
  4867         16  OC-JNT-MIDDLE-INIT            PIC X.
  4868         16  OC-JNT-AGE                    PIC S999     COMP-3.
  4869         16  OC-LF-BENCD                   PIC XX.
  4870         16  OC-LF-TERM                    PIC S999      COMP-3.
  4871         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4872         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4873         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  4874         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  4875         16  OC-LF-EXP-DT                  PIC XX.
  4876         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  4877         16  OC-LF-CANCEL-DT               PIC XX.
  4878         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4879         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4880         16  OC-AH-BENCD                   PIC XX.
  4881         16  OC-AH-TERM                    PIC S999      COMP-3.
  4882         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4883         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4884         16  OC-AH-EXP-DT                  PIC XX.
  4885         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4886         16  OC-AH-CP                      PIC 99.
  4887         16  OC-AH-CANCEL-DT               PIC XX.
  4888         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4889         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4890         16  OC-CRED-BENE-NAME             PIC X(25).
  4891         16  OC-1ST-PMT-DT                 PIC XX.
  4892         16  FILLER                        PIC X(215).
  4893
  4894     12  FILLER                            PIC X(50).
  4895******************************************************************
  4896*                                COPY ERCENDT.
  4897******************************************************************
  4898*                                                                *
  4899*                                                                *
  4900*                            ERCENDT.                            *
  4901*                            VMOD=2.001                          *
  4902*                                                                *
  4903*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  4904*                                                                *
  4905*   FILE TYPE = VSAM,KSDS                                        *
  4906*   RECORD SIZE = 579  RECFORM = FIXED                           *
  4907*                                                                *
  4908*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  4909*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  4910*                                                                *
  4911*   LOG = NO                                                     *
  4912*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  87
* EL6318.cbl
  4913******************************************************************
  4914*-----------------------------------------------------------------
  4915*                   C H A N G E   L O G
  4916*
  4917* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4918*-----------------------------------------------------------------
  4919*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4920* EFFECTIVE    NUMBER
  4921*-----------------------------------------------------------------
  4922* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  4923*                                WITH OPEN CLAIMS
  4924* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  4925* 110612    2012101700002  AJRA  ADD NEW FIELDS
  4926*-----------------------------------------------------------------
  4927 01  ENDORSEMENT-RECORD.
  4928     12  EN-RECORD-ID                PIC XX.
  4929         88  VALID-EN-ID                VALUE 'EN'.
  4930     12  EN-CONTROL-PRIMARY.
  4931         16  EN-COMPANY-CD           PIC X.
  4932         16  EN-CARRIER              PIC X.
  4933         16  EN-GROUPING             PIC X(6).
  4934         16  EN-STATE                PIC XX.
  4935         16  EN-ACCOUNT              PIC X(10).
  4936         16  EN-CERT-EFF-DT          PIC XX.
  4937         16  EN-CERT-NO.
  4938             20  EN-CERT-PRIME       PIC X(10).
  4939             20  EN-CERT-SFX         PIC X.
  4940         16  EN-REC-TYPE             PIC X.
  4941             88  EN-ISSUE               VALUE 'I'.
  4942             88  EN-CANCELLATION        VALUE 'C'.
  4943         16  EN-SEQ-NO               PIC 9(04) BINARY.
  4944     12  EN-CONTROL-BY-ARCH-NO.
  4945         16  EN-COMPANY-CD-A1              PIC X.
  4946         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  4947     12  EN-LAST-MAINT-DT            PIC XX.
  4948     12  EN-LAST-MAINT-BY            PIC X(4).
  4949     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  4950     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  4951     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  4952         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  4953         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  4954         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  4955         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  4956         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  4957         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  4958         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  4959         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  4960         16  EN-LF-ORIG-BENCD        PIC XX.
  4961         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  4962         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  4963         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  4964         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  4965         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  4966         16  EN-LF-ORIG-EXP-DT       PIC XX.
  4967*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  4968         16  EN-ORIG-CRED-BENE       PIC X(25).
  4969         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  4970         16  FILLER                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  88
* EL6318.cbl
  4971         16  EN-AH-ORIG-BENCD        PIC XX.
  4972         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  4973         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  4974         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  4975         16  EN-AH-ORIG-EXP-DT       PIC XX.
  4976*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  4977*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  4978         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  4979         16  F                       PIC X(09).
  4980         16  EN-AH-ORIG-CP           PIC 99.
  4981         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  4982         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  4983         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  4984         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  4985         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  4986         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  4987         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  4988         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  4989         16  EN-LF-NEW-BENCD         PIC XX.
  4990         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  4991         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  4992         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  4993         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  4994         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  4995         16  EN-LF-NEW-EXP-DT        PIC XX.
  4996         16  EN-NEW-CRED-BENE        PIC X(25).
  4997         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  4998         16  FILLER                  PIC X.
  4999         16  EN-AH-NEW-BENCD         PIC XX.
  5000         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  5001         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  5002         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  5003         16  EN-AH-NEW-EXP-DT        PIC XX.
  5004*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  5005*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  5006*        16  F                       PIC X(12).
  5007         16  EN-AH-NEW-CP            PIC 99.
  5008         16  EN-SIG-SW               PIC X.
  5009         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  5010         16  FILLER                  PIC X(37).
  5011     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  5012         16  EN-LF-ORIG-REF-DT       PIC XX.
  5013         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  5014         16  EN-AH-ORIG-REF-DT       PIC XX.
  5015         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  5016         16  EN-LF-NEW-REF-DT        PIC XX.
  5017         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  5018         16  EN-AH-NEW-REF-DT        PIC XX.
  5019         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  5020         16  EN-FLAG-CERT            PIC X.
  5021         16  EN-INS-LAST-NAME        PIC X(15).
  5022         16  EN-INS-FIRST-NAME       PIC X(10).
  5023         16  EN-INS-MIDDLE-INIT      PIC X.
  5024         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  5025         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  5026         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  5027         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  5028         16  FILLER                  PIC X(262).
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  89
* EL6318.cbl
  5029     12  EN-MONEY-SW             PIC X.
  5030     12  EN-HEALTH-APP           PIC X.
  5031     12  EN-VOUCHER-SW           PIC X.
  5032     12  EN-PAYEE                PIC X(14).
  5033     12  EN-INPUT-DT             PIC XX.
  5034     12  EN-PROCESS-DT           PIC XX.
  5035     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  5036     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  5037     12  EN-REASON-CODES.
  5038         16  F OCCURS 12.
  5039             20  EN-REASON-CODE  PIC X(4).
  5040     12  EN-TEMPLATE-USED        PIC X(8).
  5041     12  EN-DOCU-TYPE            PIC X.
  5042         88  EN-VERI-DOCU          VALUE 'V'.
  5043         88  EN-GCE-DOCU           VALUE 'G'.
  5044         88  EN-CANC-DOCU          VALUE 'C'.
  5045     12  EN-COMMENTS1            PIC X(13).
  5046     12  EN-COMMENTS2            PIC X(70).
  5047     12  EN-COMM-CHGBK           PIC X.
  5048         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  5049         88  EN-CHG-ACCT           VALUE 'Y'.
  5050     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  5051     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  5052     12  EN-BATCH-NUMBER         PIC X(6).
  5053     12  EN-ACCT-SUMM            PIC X.
  5054     12  EN-CSO-SUMM             PIC X.
  5055     12  FILLER                  PIC X(13).
  5056******************************************************************
  5057*                                COPY ERCNOTE.
  5058******************************************************************
  5059*                                                                *
  5060*                                                                *
  5061*                            ERCNOTE                             *
  5062*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5063*                            VMOD=2.003                          *
  5064*                                                                *
  5065*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  5066*                                                                *
  5067*        FILE TYPE= VSAM,KSDS                                    *
  5068*        RECORD SIZE = 825    RECFORM = FIXED                    *
  5069*                                                                *
  5070*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  5071*                                                                *
  5072*        LOG = YES                                               *
  5073*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5074*                                                                *
  5075******************************************************************
  5076*                   C H A N G E   L O G
  5077*
  5078* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5079*-----------------------------------------------------------------
  5080*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5081* EFFECTIVE    NUMBER
  5082*-----------------------------------------------------------------
  5083* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  5084*                                FILE WILL CONTAIN BILLING NOTES O
  5085******************************************************************
  5086
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  90
* EL6318.cbl
  5087 01  CERTIFICATE-NOTE.
  5088     12  CN-RECORD-ID                PIC  XX.
  5089         88  VALID-CN-ID                  VALUE 'CN'.
  5090
  5091     12  CN-CONTROL-PRIMARY.
  5092         16  CN-COMPANY-CD           PIC X.
  5093         16  CN-CARRIER              PIC X.
  5094         16  CN-GROUPING.
  5095             20 CN-GROUPING-PREFIX   PIC XXX.
  5096             20 CN-GROUPING-PRIME    PIC XXX.
  5097         16  CN-STATE                PIC XX.
  5098         16  CN-ACCOUNT.
  5099             20 CN-ACCOUNT-PREFIX    PIC X(4).
  5100             20 CN-ACCOUNT-PRIME     PIC X(6).
  5101         16  CN-CERT-EFF-DT          PIC XX.
  5102         16  CN-CERT-NO.
  5103             20  CN-CERT-PRIME       PIC X(10).
  5104             20  CN-CERT-SFX         PIC X.
  5105
  5106     12  CN-BILLING-START-LINE-NO    PIC 99.
  5107     12  CN-BILLING-END-LINE-NO      PIC 99.
  5108
  5109     12  CN-LINES.
  5110         16  CN-LINE OCCURS 10       PIC X(77).
  5111
  5112     12  CN-LAST-MAINT-DT            PIC XX.
  5113     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5114     12  CN-LAST-MAINT-USER          PIC X(4).
  5115     12  FILLER                      PIC X(6).
  5116******************************************************************
  5117*                                COPY ERCMAIL.
  5118******************************************************************
  5119*                                                                *
  5120*                                                                *
  5121*                            ERCMAIL                             *
  5122*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5123*                            VMOD=2.003                          *
  5124*                                                                *
  5125*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5126*                                                                *
  5127*   FILE TYPE = VSAM,KSDS                                        *
  5128*   RECORD SIZE = 374   RECFORM = FIX                            *
  5129*                                                                *
  5130*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5131*   ALTERNATE PATH    = NOT USED                                 *
  5132*                                                                *
  5133*   LOG = YES                                                    *
  5134*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5135******************************************************************
  5136*                   C H A N G E   L O G
  5137*
  5138* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5139*-----------------------------------------------------------------
  5140*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5141* EFFECTIVE    NUMBER
  5142*-----------------------------------------------------------------
  5143* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5144* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  91
* EL6318.cbl
  5145* 111108                   PEMA  ADD CRED BENE ADDR2
  5146******************************************************************
  5147
  5148 01  MAILING-DATA.
  5149     12  MA-RECORD-ID                      PIC XX.
  5150         88  VALID-MA-ID                       VALUE 'MA'.
  5151
  5152     12  MA-CONTROL-PRIMARY.
  5153         16  MA-COMPANY-CD                 PIC X.
  5154         16  MA-CARRIER                    PIC X.
  5155         16  MA-GROUPING.
  5156             20  MA-GROUPING-PREFIX        PIC XXX.
  5157             20  MA-GROUPING-PRIME         PIC XXX.
  5158         16  MA-STATE                      PIC XX.
  5159         16  MA-ACCOUNT.
  5160             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5161             20  MA-ACCOUNT-PRIME          PIC X(6).
  5162         16  MA-CERT-EFF-DT                PIC XX.
  5163         16  MA-CERT-NO.
  5164             20  MA-CERT-PRIME             PIC X(10).
  5165             20  MA-CERT-SFX               PIC X.
  5166
  5167     12  FILLER                            PIC XX.
  5168
  5169     12  MA-ACCESS-CONTROL.
  5170         16  MA-SOURCE-SYSTEM              PIC XX.
  5171             88  MA-FROM-CREDIT                VALUE 'CR'.
  5172             88  MA-FROM-VSI                   VALUE 'VS'.
  5173             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5174             88  MA-FROM-OTHER                 VALUE 'OT'.
  5175         16  MA-RECORD-ADD-DT              PIC XX.
  5176         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5177         16  MA-LAST-MAINT-DT              PIC XX.
  5178         16  MA-LAST-MAINT-BY              PIC XXXX.
  5179         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5180
  5181     12  MA-PROFILE-INFO.
  5182         16  MA-QUALIFY-CODE-1             PIC XX.
  5183         16  MA-QUALIFY-CODE-2             PIC XX.
  5184         16  MA-QUALIFY-CODE-3             PIC XX.
  5185         16  MA-QUALIFY-CODE-4             PIC XX.
  5186         16  MA-QUALIFY-CODE-5             PIC XX.
  5187
  5188         16  MA-INSURED-LAST-NAME          PIC X(15).
  5189         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5190         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5191         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5192         16  MA-INSURED-BIRTH-DT           PIC XX.
  5193         16  MA-INSURED-SEX                PIC X.
  5194             88  MA-SEX-MALE                   VALUE 'M'.
  5195             88  MA-SEX-FEMALE                 VALUE 'F'.
  5196         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5197
  5198         16  MA-ADDRESS-CORRECTED          PIC X.
  5199         16  MA-JOINT-BIRTH-DT             PIC XX.
  5200*        16  FILLER                        PIC X(12).
  5201
  5202         16  MA-ADDRESS-LINE-1             PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  92
* EL6318.cbl
  5203         16  MA-ADDRESS-LINE-2             PIC X(30).
  5204         16  MA-CITY-STATE.
  5205             20  MA-CITY                   PIC X(28).
  5206             20  MA-ADDR-STATE             PIC XX.
  5207         16  MA-ZIP.
  5208             20  MA-ZIP-CODE.
  5209                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5210                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5211                 24  FILLER                PIC X(4).
  5212             20  MA-ZIP-PLUS4              PIC X(4).
  5213         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5214             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5215             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5216             20  FILLER                    PIC X(3).
  5217
  5218         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5219
  5220         16  FILLER                        PIC XXX.
  5221*        16  FILLER                        PIC X(10).
  5222
  5223     12  MA-CRED-BENE-INFO.
  5224         16  MA-CRED-BENE-NAME                 PIC X(25).
  5225         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5226         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5227         16  MA-CRED-BENE-CTYST.
  5228             20  MA-CRED-BENE-CITY             PIC X(28).
  5229             20  MA-CRED-BENE-STATE            PIC XX.
  5230         16  MA-CRED-BENE-ZIP.
  5231             20  MA-CB-ZIP-CODE.
  5232                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5233                     88  MA-CB-CANADIAN-POST-CODE
  5234                                           VALUE 'A' THRU 'Z'.
  5235                 24  FILLER                    PIC X(4).
  5236             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5237         16  MA-CB-CANADIAN-POSTAL-CODE
  5238                            REDEFINES MA-CRED-BENE-ZIP.
  5239             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5240             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5241             20  FILLER                        PIC X(3).
  5242     12  MA-POST-CARD-MAIL-DATA.
  5243         16  MA-MAIL-DATA OCCURS 7.
  5244             20  MA-MAIL-TYPE              PIC X.
  5245                 88  MA-12MO-MAILING           VALUE '1'.
  5246                 88  MA-EXP-MAILING            VALUE '2'.
  5247             20  MA-MAIL-STATUS            PIC X.
  5248                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5249                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5250                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5251             20  MA-MAIL-DATE              PIC XX.
  5252     12  FILLER                            PIC XX.
  5253     12  FILLER                            PIC XX.
  5254*    12  FILLER                            PIC X(30).
  5255******************************************************************
  5256*                                COPY ERCARCH.
  5257******************************************************************
  5258*                                                                *
  5259*                            ERCARCH.                            *
  5260*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  93
* EL6318.cbl
  5261*                            VMOD=2.002                          *
  5262*                                                                *
  5263*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  5264*                                                                *
  5265*   FILE TYPE = VSAM,KSDS                                        *
  5266*   RECORD SIZE = 250  RECFORM = FIXED                           *
  5267*                                                                *
  5268*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  5269*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  5270*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  5271*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  5272*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  5273*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  5274*                                                                *
  5275*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5276******************************************************************
  5277*                   C H A N G E   L O G
  5278*
  5279* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5280*-----------------------------------------------------------------
  5281*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5282* EFFECTIVE    NUMBER
  5283*-----------------------------------------------------------------
  5284* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  5285* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  5286* 110612    2012101700002  AJRA  ADD NEW FIELDS
  5287******************************************************************
  5288 01  LETTER-ARCHIVE.
  5289     12  LA-RECORD-ID                PIC  X(02).
  5290         88  LA-VALID-ID                VALUE 'LA'.
  5291
  5292     12  LA-CONTROL-PRIMARY.
  5293         16  LA-COMPANY-CD           PIC  X(01).
  5294         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  5295
  5296     12  LA-CONTROL-BY-CERT-RESP.
  5297         16  LA-COMPANY-CD-A2        PIC  X(01).
  5298         16  LA-CERT-NO-A2.
  5299             20  LA-CERT-PRIME-A2    PIC  X(10).
  5300             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  5301         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  5302             20  LA-RESP-PERSON-A2   PIC  X(10).
  5303             20  LA-TYPE-A2          PIC  X(01).
  5304         16  LA-CARRIER-A2           PIC  X(01).
  5305         16  LA-GROUPING-A2          PIC  X(06).
  5306         16  LA-STATE-A2             PIC  X(02).
  5307         16  LA-ACCOUNT-A2           PIC  X(10).
  5308         16  LA-EFFECT-DATE-A2       PIC  X(02).
  5309         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  5310
  5311     12  LA-CONTROL-BY-FORM.
  5312         16  LA-COMPANY-CD-A3        PIC  X(01).
  5313         16  LA-FORM-A3              PIC  X(04).
  5314         16  LA-CARRIER-A3           PIC  X(01).
  5315         16  LA-GROUPING-A3          PIC  X(06).
  5316         16  LA-STATE-A3             PIC  X(02).
  5317         16  LA-ACCOUNT-A3           PIC  X(10).
  5318         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  94
* EL6318.cbl
  5319
  5320     12  LA-CONTROL-BY-PROCESSOR.
  5321         16  LA-COMPANY-CD-A4        PIC  X(01).
  5322         16  LA-PROCESSOR-CD         PIC  X(04).
  5323         16  LA-CARRIER-A4           PIC  X(01).
  5324         16  LA-GROUPING-A4          PIC  X(06).
  5325         16  LA-STATE-A4             PIC  X(02).
  5326         16  LA-ACCOUNT-A4           PIC  X(10).
  5327         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  5328
  5329     12  LA-CONTROL-BY-KEY-FIELDS.
  5330         16  LA-COMPANY-CD-A5        PIC  X(01).
  5331         16  LA-CARRIER-A5           PIC  X(01).
  5332         16  LA-GROUPING-A5          PIC  X(06).
  5333         16  LA-STATE-A5             PIC  X(02).
  5334         16  LA-ACCOUNT-A5           PIC  X(10).
  5335         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  5336
  5337     12  LA-CONTROL-BY-GROUP-CODE.
  5338         16  LA-COMPANY-CD-A6        PIC  X(01).
  5339         16  LA-ENTRY-A6.
  5340             20  LA-FILLER           PIC  X(02).
  5341             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  5342         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  5343
  5344     12  FILLER                      PIC  X(09).
  5345
  5346     12  LA-HEADER-RECORD.
  5347         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  5348         16  LA-CREATION-DATE        PIC  X(02).
  5349         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  5350         16  LA-FINAL-ACT-DATE       REDEFINES
  5351               LA-FOLLOW-UP-DATE     PIC  X(02).
  5352         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  5353         16  LA-NO-OF-COPIES         PIC S9(01).
  5354         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  5355         16  LA-REPLY-DATE           PIC  X(02).
  5356         16  LA-RESEND-DATES.
  5357             20  LA-RESEND-DATE      PIC  X(02).
  5358             20  LA-SENT-DATE        PIC  X(02).
  5359             20  FILLER              PIC  X(08).
  5360         16  LA-SOURCE-INFORMATION.
  5361             20  LA-DATA-SOURCE      PIC  X(01).
  5362             20  LA-ADDR-SOURCE      PIC  X(01).
  5363         16  LA-STATUS               PIC  X(01).
  5364             88  LA-STATUS-ACTIVE         VALUE 'A'.
  5365             88  LA-STATUS-COMPLETED      VALUE 'C'.
  5366             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  5367             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  5368             88  LA-STATUS-PURGED         VALUE 'P'.
  5369             88  LA-STATUS-VOIDED         VALUE 'V'.
  5370         16  LA-LAST-RESENT-PRINT-DATE
  5371                                     PIC  X(02).
  5372         16  LA-PRINT-RESTRICTION    PIC  X(01).
  5373             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  5374                                          VALUE 'C'.
  5375             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  5376                                          VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  95
* EL6318.cbl
  5377             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  5378                                          VALUE 'P'.
  5379         16  LA-PURGED-DATE          PIC  X(02).
  5380         16  LA-VOIDED-DATE          PIC  X(02).
  5381         16  LA-RESEND-LETR          PIC  X(4).
  5382         16  FILLER                  PIC  X(08).
  5383*        16  LA-RESEND-LETR-2        PIC  X(4).
  5384*        16  LA-RESEND-LETR-3        PIC  X(4).
  5385*        16  FILLER                  PIC  X(59).
  5386         16  LA-ARCHIVE-STATUS       PIC  X.
  5387             88  LA-TEMP                VALUE 'T'.
  5388             88  LA-QWS                 VALUE 'Q'.
  5389             88  LA-BATCH               VALUE 'B'.
  5390         16  LA-FINAL-ACT-IND        PIC  X(1).
  5391         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  5392         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  5393         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  5394                                     PIC X(4).
  5395         16  FILLER                  PIC  X(42).
  5396*        16  FILLER                  PIC  X(71).
  5397         16  LA-LAST-MAINT-DATE      PIC  X(2).
  5398         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  5399         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  5400                                     PIC  X(4).
  5401         16  LA-LAST-UPDATED-BY      PIC  X(4).
  5402
  5403******************************************************************
  5404*                                COPY ERCCNOT.
  5405******************************************************************
  5406*                                                                *
  5407*                            ERCCNOT                             *
  5408*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5409*                            VMOD=2.003                          *
  5410*                                                                *
  5411*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  5412*                                                                *
  5413*        FILE TYPE= VSAM,KSDS                                    *
  5414*        RECORD SIZE = 150    RECFORM = FIXED                    *
  5415*                                                                *
  5416*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  5417*                                                                *
  5418*        LOG = YES                                               *
  5419*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5420*                                                                *
  5421******************************************************************
  5422*                   C H A N G E   L O G
  5423*
  5424* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5425*-----------------------------------------------------------------
  5426*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5427* EFFECTIVE    NUMBER
  5428*-----------------------------------------------------------------
  5429* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  5430******************************************************************
  5431
  5432 01  CERT-NOTE-FILE.
  5433     12  CZ-RECORD-ID                PIC  XX.
  5434         88  VALID-CZ-ID                  VALUE 'CZ'.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  96
* EL6318.cbl
  5435
  5436     12  CZ-CONTROL-PRIMARY.
  5437         16  CZ-COMPANY-CD           PIC X.
  5438         16  CZ-CARRIER              PIC X.
  5439         16  CZ-GROUPING.
  5440             20 CZ-GROUPING-PREFIX   PIC XXX.
  5441             20 CZ-GROUPING-PRIME    PIC XXX.
  5442         16  CZ-STATE                PIC XX.
  5443         16  CZ-ACCOUNT.
  5444             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  5445             20 CZ-ACCOUNT-PRIME     PIC X(6).
  5446         16  CZ-CERT-EFF-DT          PIC XX.
  5447         16  CZ-CERT-NO.
  5448             20  CZ-CERT-PRIME       PIC X(10).
  5449             20  CZ-CERT-SFX         PIC X.
  5450         16  CZ-RECORD-TYPE          PIC X.
  5451             88  CERT-NOTE           VALUE '1'.
  5452             88  CLAIM-CERT-NOTE     VALUE '2'.
  5453         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  5454
  5455     12  CZ-LAST-MAINT-DT            PIC XX.
  5456     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5457     12  CZ-LAST-MAINT-USER          PIC X(4).
  5458
  5459     12  CZ-NOTE-INFORMATION.
  5460         16  CZ-NOTE                 PIC X(63).
  5461         16  FILLER                  PIC X(39).
  5462******************************************************************
  5463*                                COPY ELCEOBC.
  5464******************************************************************
  5465*                                                                *
  5466*                                                                *
  5467*                            ELCEOBC                             *
  5468*                            VMOD=2.001                          *
  5469*                                                                *
  5470*   CLAIM SYSTEM EOB CODE TABLE                                  *
  5471*                                                                *
  5472*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5473*   VSAM EOB CODE TABLE                                          *
  5474*                                                                *
  5475*   FILE DESCRIPTION = EOB CODE TABLE                            *
  5476*                                                                *
  5477*   FILE TYPE = VSAM,KSDS                                        *
  5478*   RECORD SIZE = 350   RECFORM = FIX                            *
  5479*                                                                *
  5480*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
  5481*                                                                *
  5482*   LOG = NO                                                     *
  5483*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5484*                                                                *
  5485*                                                                *
  5486******************************************************************
  5487*                   C H A N G E   L O G
  5488*
  5489* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5490*-----------------------------------------------------------------
  5491*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5492* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  97
* EL6318.cbl
  5493*-----------------------------------------------------------------
  5494* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  5495* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
  5496******************************************************************
  5497 01  EOB-CODES.
  5498     12  EO-RECORD-ID                      PIC XX.
  5499         88  VALID-DN-ID                      VALUE 'EO'.
  5500     12  EO-CONTROL-PRIMARY.
  5501         16  EO-COMPANY-CD                 PIC X.
  5502         16  EO-RECORD-TYPE                PIC X.
  5503             88  EO-EOB-RECS                  VALUE '1'.
  5504             88  EO-VERIF-RECS                VALUE '2'.
  5505             88  EO-GCE-RECS                  VALUE '3'.
  5506         16  EO-EOB-CODE                   PIC X(4).
  5507         16  FILLER                        PIC X(9).
  5508     12  EO-MAINT-INFORMATION.
  5509         16  EO-LAST-MAINT-DT              PIC XX.
  5510         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5511         16  EO-LAST-MAINT-USER            PIC X(4).
  5512         16  FILLER                        PIC XX.
  5513     12  EO-DESCRIPTION                    PIC X(275).
  5514     12  FILLER                            PIC X(46).
  5515******************************************************************
  5516 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR
  5517                          ACCOUNT-MASTER CONTROL-FILE
  5518                          PENDING-BUSINESS CERTIFICATE-MASTER
  5519                          ORIGINAL-CERTIFICATE
  5520                          ENDORSEMENT-RECORD CERTIFICATE-NOTE
  5521                          MAILING-DATA LETTER-ARCHIVE
  5522                          CERT-NOTE-FILE EOB-CODES.
  5523 0000-DFHEXIT SECTION.
  5524     MOVE '9#                    $   ' TO DFHEIV0.
  5525     MOVE 'EL6318' TO DFHEIV1.
  5526     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5527     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK
  5528     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  5529     MOVE '5'                    TO DC-OPTION-CODE
  5530     PERFORM 9700-DATE-LINK
  5531     MOVE DC-GREG-DATE-1-EDIT    TO WS-CURRENT-DT
  5532     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT
  5533     MOVE EIBTRMID               TO QID-TERM
  5534     MOVE 2                      TO EMI-NUMBER-OF-LINES
  5535     IF EIBCALEN = 0
  5536        GO TO 8800-UNAUTHORIZED-ACCESS
  5537     END-IF
  5538     MOVE FUNCTION LENGTH(EL631KI) TO MAP-LENGTH
  5539     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5540        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5541           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5542           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5543           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5544           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5545           MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5546           MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5547           MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5548           MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5549           MOVE LOW-VALUES           TO EL631KI
  5550           MOVE 'Y'                  TO PI-CLEAR-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  98
* EL6318.cbl
  5551           GO TO 0350-BUILD-INIT-MAP
  5552        END-IF
  5553     END-IF
  5554     IF PI-CALLING-PROGRAM = 'EL614'
  5555        MOVE PI-PROGRAM-WORK-AREA (1:60)
  5556                                 TO WS-PASSED-REASON-CODES
  5557        DISPLAY ' COMING BACK FROM 614 ' WS-PASSED-REASON-CODES
  5558        IF WS-PASSED-REASON-CODES NOT = SPACES
  5559           MOVE 'Y'                TO WS-SET-CODES-MDT
  5560        ELSE
  5561           MOVE 'N'                TO WS-SET-CODES-MDT
  5562        END-IF
  5563        PERFORM 0600-RECOVER-TEMP-STORAGE
  5564                                 THRU 0600-EXIT
  5565        GO TO 0350-BUILD-INIT-MAP
  5566     END-IF
  5567     IF EIBAID = DFHCLEAR
  5568        IF PI-CLEAR-ERROR
  5569           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5570           MOVE ER-3833           TO EMI-ERROR
  5571           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5572           GO TO 0350-BUILD-INIT-MAP
  5573        ELSE
  5574           GO TO 9400-CLEAR
  5575        END-IF
  5576     END-IF
  5577     .
  5578 0200-RECEIVE.
  5579     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5580        MOVE ER-0008             TO EMI-ERROR
  5581        PERFORM 9900-ERROR-FORMAT
  5582                                 THRU 9900-EXIT
  5583        MOVE -1                  TO PFENTRL
  5584        GO TO 8100-SEND-INITIAL-MAP
  5585     END-IF
  5586
  5587* EXEC CICS RECEIVE
  5588*        MAP      (MAP-NAME)
  5589*        MAPSET   (MAPSET-NAME)
  5590*        INTO     (EL631KI)
  5591*    END-EXEC
  5592     MOVE LENGTH OF
  5593      EL631KI
  5594       TO DFHEIV11
  5595*    MOVE '8"T I  L              ''   #00005582' TO DFHEIV0
  5596     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5597     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5598     MOVE X'2020233030303035353832' TO DFHEIV0(25:11)
  5599     CALL 'kxdfhei1' USING DFHEIV0,
  5600           MAP-NAME,
  5601           EL631KI,
  5602           DFHEIV11,
  5603           MAPSET-NAME,
  5604           DFHEIV99,
  5605           DFHEIV99
  5606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5607     IF PFENTRL = 0
  5608         GO TO 0300-CHECK-PFKEYS
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page  99
* EL6318.cbl
  5609     END-IF
  5610     IF EIBAID NOT = DFHENTER
  5611         MOVE ER-0004            TO EMI-ERROR
  5612         GO TO 0320-INPUT-ERROR
  5613     END-IF
  5614     IF (PFENTRI NUMERIC) AND (PFENTRI > 0 AND < 25)
  5615        MOVE PF-VALUES (PFENTRI) TO EIBAID
  5616     ELSE
  5617        MOVE ER-0029            TO EMI-ERROR
  5618        GO TO 0320-INPUT-ERROR
  5619     END-IF
  5620     .
  5621 0300-CHECK-PFKEYS.
  5622     IF EIBAID = DFHPF3
  5623        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5624        PERFORM 0500-CREATE-TEMP-STORAGE THRU 0500-EXIT
  5625        MOVE 'EL614'             TO PGM-NAME
  5626        MOVE PI-REASON-CODE-IND  TO WS-SAVE-REASON-CODE-IND
  5627        MOVE SPACES              TO PI-PROGRAM-WORK-AREA
  5628        move +1                  to s2
  5629        perform varying s1 from +1 by +1 until s1 > +12
  5630           if reacd-in (s1) not = spaces and low-values
  5631              move reacd-in (s1)    to pi-program-work-area (s2:4)
  5632              add +5 to s2
  5633           end-if
  5634        END-perform
  5635        MOVE WS-SAVE-REASON-CODE-IND TO PI-REASON-CODE-IND
  5636        DISPLAY ' GOING TO 614 ' PI-PROGRAM-WORK-AREA (1:60)
  5637        GO TO 9300-XCTL
  5638     END-IF
  5639     IF EIBAID = DFHPF4 OR DFHPF8
  5640        GO TO 0360-FINALIZE
  5641     END-IF
  5642     IF EIBAID = DFHPF23
  5643        IF PI-CLEAR-ERROR
  5644           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5645           MOVE ER-3833           TO EMI-ERROR
  5646           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5647           GO TO 0350-BUILD-INIT-MAP
  5648        ELSE
  5649           GO TO 8810-PF23
  5650        END-IF
  5651     END-IF
  5652     IF EIBAID = DFHPF24
  5653        IF PI-CLEAR-ERROR
  5654           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5655           MOVE ER-3833           TO EMI-ERROR
  5656           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5657           GO TO 0350-BUILD-INIT-MAP
  5658        ELSE
  5659           GO TO 9200-RETURN-MAIN-MENU
  5660        END-IF
  5661     END-IF
  5662     IF EIBAID = DFHPF12
  5663        GO TO 9500-PF12
  5664     END-IF
  5665     IF EIBAID = DFHENTER
  5666        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 100
* EL6318.cbl
  5667        GO TO 0325-EDIT-SCREEN
  5668     END-IF
  5669     MOVE ER-0029                TO EMI-ERROR
  5670     .
  5671 0320-INPUT-ERROR.
  5672     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5673     MOVE AL-UNBON               TO PFENTRA
  5674     MOVE -1                     TO PFENTRL
  5675     GO TO 8200-SEND-DATAONLY
  5676     .
  5677 0325-EDIT-SCREEN.
  5678     IF PRTSWL > ZEROS
  5679       IF PRTSWI = 'Y' OR 'N' OR 'P' OR ' '
  5680*          MOVE AL-UANON       TO PRTSWA
  5681*          IF PRTSWI = ' '
  5682*             MOVE 'N'         TO PRTSWI
  5683              MOVE 'P'         TO PRTSWI
  5684*          END-IF
  5685*          MOVE PRTSWI         TO PI-PRTSW-ENTERED
  5686        END-IF
  5687     END-IF
  5688     IF (SIGREQL > ZEROS)
  5689        AND (SIGREQI = 'Y' OR 'N' OR ' ')
  5690        MOVE AL-UANON         TO SIGREQA
  5691        IF SIGREQI = ' '
  5692           MOVE 'N'           TO SIGREQI
  5693        END-IF
  5694        MOVE SIGREQI          TO PI-SIGREQ-ENTERED
  5695     ELSE
  5696        MOVE ER-2651          TO EMI-ERROR
  5697        MOVE -1               TO SIGREQL
  5698        MOVE AL-UABON         TO SIGREQA
  5699        PERFORM 9900-ERROR-FORMAT
  5700                                 THRU 9900-EXIT
  5701     END-IF
  5702     IF LTRIDL > ZEROS
  5703        AND LTRIDI > SPACES
  5704        MOVE PI-COMPANY-CD       TO LETR-COMPANY-CD
  5705        MOVE LTRIDI              TO LETR-LETTER-ID
  5706                                    PI-LTRID-ENTERED
  5707        MOVE LETR-PART-KEY       TO ELLETR-SAVE-PART-KEY
  5708        MOVE SPACES              TO LETR-FILLER
  5709        MOVE 0                   TO LETR-SEQ-NO
  5710        PERFORM 0326-GET-Z-RECORD THRU 0326-EXIT
  5711     ELSE
  5712        MOVE ER-1236          TO EMI-ERROR
  5713        MOVE -1               TO LTRIDL
  5714        MOVE AL-UABON         TO LTRIDA
  5715        PERFORM 9900-ERROR-FORMAT
  5716                                 THRU 9900-EXIT
  5717     END-IF
  5718
  5719     IF W-PROMPT-LETTER EQUAL 'Y'
  5720         MOVE ER-0894            TO EMI-ERROR
  5721         MOVE -1                 TO LTRIDL
  5722         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5723     END-IF
  5724     IF VOUCHL > ZEROS
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 101
* EL6318.cbl
  5725        IF VOUCHI = 'Y' OR 'N'
  5726           MOVE AL-UANON         TO VOUCHA
  5727           MOVE VOUCHI           TO PI-VOUCHER-ENTERED
  5728        ELSE
  5729           MOVE ER-9999          TO EMI-ERROR
  5730           MOVE -1               TO VOUCHL
  5731           MOVE AL-UABON         TO VOUCHA
  5732           PERFORM 9900-ERROR-FORMAT
  5733                                 THRU 9900-EXIT
  5734        END-IF
  5735     END-IF
  5736     IF HLTHAPPL > ZEROS
  5737        IF HLTHAPPI = 'Y' OR 'N'
  5738           MOVE AL-UANON         TO HLTHAPPA
  5739           MOVE HLTHAPPI         TO PI-HLTHAPP-ENTERED
  5740        ELSE
  5741           MOVE ER-9999          TO EMI-ERROR
  5742           MOVE -1               TO HLTHAPPL
  5743           MOVE AL-UABON         TO HLTHAPPA
  5744           PERFORM 9900-ERROR-FORMAT
  5745                                 THRU 9900-EXIT
  5746        END-IF
  5747     END-IF
  5748     IF PAYEEL > ZEROS
  5749        IF PAYEEI > SPACES
  5750           MOVE AL-UANON         TO PAYEEA
  5751           MOVE PAYEEI           TO PI-PAYEE-ENTERED
  5752        ELSE
  5753           MOVE ER-9999          TO EMI-ERROR
  5754           MOVE -1               TO PAYEEL
  5755           MOVE AL-UABON         TO PAYEEA
  5756           PERFORM 9900-ERROR-FORMAT
  5757                                 THRU 9900-EXIT
  5758        END-IF
  5759     END-IF
  5760     IF CERTIDL > ZEROS
  5761         IF CERTIDI NUMERIC
  5762            MOVE AL-UANON      TO CERTIDA
  5763            MOVE CERTIDI       TO PI-CERTID-ENTERED
  5764         ELSE
  5765            MOVE ER-1778       TO EMI-ERROR
  5766            MOVE -1            TO CERTIDL
  5767            MOVE AL-UABON      TO CERTIDA
  5768            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5769        END-IF
  5770     ELSE
  5771        IF PI-PRINT-CERTIFICATE = 'Y'
  5772            MOVE ER-0715       TO EMI-ERROR
  5773            MOVE -1            TO CERTIDL
  5774            MOVE AL-UABON      TO CERTIDA
  5775            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5776        END-IF
  5777     END-IF
  5778     SET REASONS-NOT-FOUND TO TRUE
  5779     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  5780        IF REACDL (S1) = +4 OR
  5781          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  5782              MOVE AL-SANON     TO REACDA (S1)
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 102
* EL6318.cbl
  5783              SET REASONS-FOUND TO TRUE
  5784        END-IF
  5785     END-PERFORM
  5786
  5787     IF REASONS-NOT-FOUND
  5788        MOVE ER-1820             TO EMI-ERROR
  5789        MOVE -1                  TO PFENTRL
  5790        PERFORM 9900-ERROR-FORMAT
  5791                                 THRU 9900-EXIT
  5792     ELSE
  5793        MOVE REASONCDS           TO PI-REASONS-ENTERED
  5794     END-IF
  5795
  5796     IF CRTNT1L > ZEROS
  5797        IF CRTNT1I > SPACES
  5798           MOVE CRTNT1I          TO PI-CERTNT1-ENTERED
  5799        END-IF
  5800     END-IF
  5801
  5802     IF CRTNT2L > ZEROS
  5803        IF CRTNT2I > SPACES
  5804           MOVE CRTNT2I          TO PI-CERTNT2-ENTERED
  5805        END-IF
  5806     END-IF
  5807
  5808     IF CRTNT3L > ZEROS
  5809        IF CRTNT3I > SPACES
  5810           MOVE CRTNT3I          TO PI-CERTNT3-ENTERED
  5811        END-IF
  5812     END-IF
  5813
  5814     IF CRTNT4L > ZEROS
  5815        IF CRTNT4I > SPACES
  5816           MOVE CRTNT4I          TO PI-CERTNT4-ENTERED
  5817        END-IF
  5818     END-IF
  5819
  5820     IF BILNT1L > ZEROS
  5821        IF BILNT1I > SPACES
  5822           MOVE BILNT1I          TO PI-BILLNT1-ENTERED
  5823        END-IF
  5824     END-IF
  5825
  5826     IF BILNT2L > ZEROS
  5827        IF BILNT2I > SPACES
  5828           MOVE BILNT2I          TO PI-BILLNT2-ENTERED
  5829        END-IF
  5830     END-IF
  5831
  5832     .
  5833 0325-EXIT.
  5834     EXIT.
  5835
  5836 0326-GET-Z-RECORD.
  5837
  5838     MOVE SPACES  TO W-Z-CONTROL-DATA
  5839
  5840
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 103
* EL6318.cbl
  5841* EXEC CICS STARTBR
  5842*         DATASET    ('ELLETR')
  5843*         RIDFLD     (ELLETR-KEY)
  5844*         GTEQ
  5845*         RESP      (WS-RESPONSE)
  5846*    END-EXEC.
  5847     MOVE 'ELLETR' TO DFHEIV1
  5848     MOVE 0
  5849       TO DFHEIV11
  5850*    MOVE '&,         G          &  N#00005820' TO DFHEIV0
  5851     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5852     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5853     MOVE X'204E233030303035383230' TO DFHEIV0(25:11)
  5854     CALL 'kxdfhei1' USING DFHEIV0,
  5855           DFHEIV1,
  5856           ELLETR-KEY,
  5857           DFHEIV99,
  5858           DFHEIV11,
  5859           DFHEIV99
  5860     MOVE EIBRESP  TO WS-RESPONSE
  5861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5862
  5863     IF NOT RESP-NORMAL
  5864         MOVE ER-1236          TO EMI-ERROR
  5865         MOVE -1               TO LTRIDL
  5866         MOVE AL-UABON         TO LTRIDA
  5867         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5868         GO TO 0326-ENDBR
  5869     END-IF.
  5870
  5871 0326-READNEXT.
  5872
  5873
  5874* EXEC CICS READNEXT
  5875*        DATASET   ('ELLETR')
  5876*        INTO      (TEXT-FILES)
  5877*        RIDFLD    (ELLETR-KEY)
  5878*        RESP      (WS-RESPONSE)
  5879*    END-EXEC
  5880     MOVE LENGTH OF
  5881      TEXT-FILES
  5882       TO DFHEIV12
  5883     MOVE 'ELLETR' TO DFHEIV1
  5884     MOVE 0
  5885       TO DFHEIV11
  5886*    MOVE '&.IL                  )  N#00005836' TO DFHEIV0
  5887     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5888     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5889     MOVE X'204E233030303035383336' TO DFHEIV0(25:11)
  5890     CALL 'kxdfhei1' USING DFHEIV0,
  5891           DFHEIV1,
  5892           TEXT-FILES,
  5893           DFHEIV12,
  5894           ELLETR-KEY,
  5895           DFHEIV99,
  5896           DFHEIV11,
  5897           DFHEIV99,
  5898           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 104
* EL6318.cbl
  5899     MOVE EIBRESP  TO WS-RESPONSE
  5900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5901     IF RESP-NORMAL
  5902        IF TX-CONTROL-PRIMARY(1:5) NOT = ELLETR-SAVE-PART-KEY
  5903           MOVE ER-1236          TO EMI-ERROR
  5904           MOVE -1               TO LTRIDL
  5905           MOVE AL-UABON         TO LTRIDA
  5906           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5907           GO TO 0326-ENDBR
  5908        END-IF
  5909
  5910        MOVE AL-UANON         TO LTRIDA
  5911        IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  5912           MOVE TX-TEXT-LINE  TO W-Z-CONTROL-DATA
  5913        ELSE
  5914           GO TO 0326-READNEXT
  5915        END-IF
  5916     ELSE
  5917        MOVE ER-1236          TO EMI-ERROR
  5918        MOVE -1               TO LTRIDL
  5919        MOVE AL-UABON         TO LTRIDA
  5920        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5921        GO TO 0326-ENDBR
  5922     END-IF.
  5923
  5924     MOVE W-PRINT-CERTIFICATE TO PI-PRINT-CERTIFICATE.
  5925
  5926 0326-ENDBR.
  5927
  5928
  5929* EXEC CICS ENDBR
  5930*        DATASET     ('ELLETR')
  5931*    END-EXEC.
  5932     MOVE 'ELLETR' TO DFHEIV1
  5933     MOVE 0
  5934       TO DFHEIV11
  5935*    MOVE '&2                    $   #00005869' TO DFHEIV0
  5936     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5937     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5938     MOVE X'2020233030303035383639' TO DFHEIV0(25:11)
  5939     CALL 'kxdfhei1' USING DFHEIV0,
  5940           DFHEIV1,
  5941           DFHEIV11,
  5942           DFHEIV99
  5943     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5944
  5945
  5946 0326-EXIT.
  5947      EXIT.
  5948 0330-CHECK-ERRORS.
  5949     IF EMI-NO-ERRORS
  5950        GO TO 0350-BUILD-INIT-MAP
  5951     ELSE
  5952        GO TO 8200-SEND-DATAONLY
  5953     END-IF
  5954     .
  5955 0330-EXIT.
  5956     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 105
* EL6318.cbl
  5957 0350-BUILD-INIT-MAP.
  5958     MOVE PI-CRTO-CARRIER        TO CARRO
  5959     MOVE PI-CRTO-GROUPING       TO GROUPO
  5960     MOVE PI-CRTO-STATE          TO STATEO
  5961     MOVE PI-CRTO-ACCOUNT        TO ACCTO
  5962     MOVE PI-CRTO-CERT-PRIME     TO CERTNOO
  5963     MOVE PI-CRTO-CERT-SFX       TO CRTSFXO
  5964     MOVE PI-CRTO-SEQ-NO         TO SEQNOO
  5965     MOVE PI-CRTO-CERT-EFF-DT    TO DC-BIN-DATE-1
  5966     MOVE ' '                    TO DC-OPTION-CODE
  5967     PERFORM 9700-DATE-LINK
  5968     IF NO-CONVERSION-ERROR
  5969        MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
  5970     END-IF
  5971*     IF PI-PRTSW-ENTERED > SPACES
  5972*        MOVE PI-PRTSW-ENTERED    TO PRTSWI
  5973*        MOVE AL-UANON            TO PRTSWA
  5974*        MOVE +1                  TO PRTSWL
  5975*     END-IF
  5976
  5977     IF PI-SIGREQ-ENTERED > SPACES
  5978        MOVE PI-SIGREQ-ENTERED   TO SIGREQI
  5979        MOVE AL-UANON            TO SIGREQA
  5980        MOVE +1                  TO SIGREQL
  5981     ELSE
  5982        IF PI-CLAIM-REFORMATION
  5983            MOVE 'Y'             TO SIGREQI
  5984            MOVE AL-UANON        TO SIGREQA
  5985            MOVE +1              TO SIGREQL
  5986        END-IF
  5987     END-IF
  5988
  5989     IF PI-LTRID-ENTERED > SPACES
  5990        MOVE PI-LTRID-ENTERED    TO LTRIDI
  5991        MOVE AL-UANON            TO LTRIDA
  5992        MOVE +4                  TO LTRIDL
  5993     ELSE
  5994        IF PI-CLAIM-REFORMATION
  5995            MOVE 'CLRF'          TO LTRIDI
  5996            MOVE AL-UANON        TO LTRIDA
  5997            MOVE +4              TO LTRIDL
  5998        END-IF
  5999     END-IF
  6000
  6001     IF PI-VOUCHER-ENTERED > SPACES
  6002        MOVE PI-VOUCHER-ENTERED  TO VOUCHI
  6003        MOVE AL-UANON            TO VOUCHA
  6004        MOVE +1                  TO VOUCHL
  6005     END-IF
  6006
  6007     IF PI-HLTHAPP-ENTERED > SPACES
  6008        MOVE PI-HLTHAPP-ENTERED  TO HLTHAPPI
  6009        MOVE AL-UANON            TO HLTHAPPA
  6010        MOVE +1                  TO HLTHAPPL
  6011     END-IF
  6012
  6013     IF PI-PAYEE-ENTERED > SPACES
  6014        MOVE PI-PAYEE-ENTERED    TO PAYEEI
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 106
* EL6318.cbl
  6015        MOVE AL-UANON            TO PAYEEA
  6016        MOVE +10                 TO PAYEEL
  6017     END-IF
  6018
  6019     IF PI-CERTID-ENTERED > SPACES
  6020        MOVE PI-CERTID-ENTERED   TO CERTIDI
  6021        MOVE AL-UANON            TO CERTIDA
  6022        MOVE +5                  TO CERTIDL
  6023     END-IF
  6024
  6025     SET REASONS-NOT-FOUND TO TRUE
  6026     MOVE PI-REASONS-ENTERED     TO REASONCDS
  6027     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6028        IF REACDL (S1) = +4 OR
  6029          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  6030              MOVE AL-SANON      TO REACDA (S1)
  6031              MOVE +4            TO REACDL (S1)
  6032              SET REASONS-FOUND  TO TRUE
  6033        END-IF
  6034     END-PERFORM
  6035
  6036     IF REASONS-NOT-FOUND
  6037         IF PI-CLAIM-REFORMATION
  6038            MOVE 'CRNA'          TO REACD-IN (1)
  6039            MOVE AL-SANON        TO REACDA (1)
  6040            MOVE +4              TO REACDL (1)
  6041            SET REASONS-FOUND    TO TRUE
  6042        END-IF
  6043     END-IF
  6044
  6045     IF PI-CERTNT1-ENTERED > SPACES
  6046        MOVE PI-CERTNT1-ENTERED  TO CRTNT1I
  6047        MOVE AL-UANON            TO CRTNT1A
  6048        MOVE +63                 TO CRTNT1L
  6049     END-IF
  6050
  6051     IF PI-CERTNT2-ENTERED > SPACES
  6052        MOVE PI-CERTNT2-ENTERED  TO CRTNT2I
  6053        MOVE AL-UANON            TO CRTNT2A
  6054        MOVE +63                 TO CRTNT2L
  6055     END-IF
  6056
  6057     IF PI-CERTNT3-ENTERED > SPACES
  6058        MOVE PI-CERTNT3-ENTERED  TO CRTNT3I
  6059        MOVE AL-UANON            TO CRTNT3A
  6060        MOVE +63                 TO CRTNT3L
  6061     END-IF
  6062
  6063     IF PI-CERTNT4-ENTERED > SPACES
  6064        MOVE PI-CERTNT4-ENTERED  TO CRTNT4I
  6065        MOVE AL-UANON            TO CRTNT4A
  6066        MOVE +63                 TO CRTNT4L
  6067     END-IF
  6068
  6069     IF PI-BILLNT1-ENTERED > SPACES
  6070        MOVE PI-BILLNT1-ENTERED  TO BILNT1I
  6071        MOVE AL-UANON            TO BILNT1A
  6072        MOVE +63                 TO BILNT1L
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 107
* EL6318.cbl
  6073     END-IF
  6074
  6075     IF PI-BILLNT2-ENTERED > SPACES
  6076        MOVE PI-BILLNT2-ENTERED  TO BILNT2I
  6077        MOVE AL-UANON            TO BILNT2A
  6078        MOVE +63                 TO BILNT2L
  6079     END-IF
  6080
  6081     GO TO 8100-SEND-INITIAL-MAP
  6082     .
  6083 0360-FINALIZE.
  6084     display ' made it to 0360 '
  6085     set P to address of KIXSYS
  6086     CALL "getenv" using by value P returning var-ptr
  6087     if var-ptr = null then
  6088        display ' kixsys not set '
  6089     else
  6090        set address of var to var-ptr
  6091        move 0 to env-var-len
  6092        inspect var tallying env-var-len
  6093          for characters before X'00'
  6094*       DISPLAY '  KIXSYS = ' var (1:env-var-len)
  6095        unstring var (1:env-var-len) delimited by '/'
  6096           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  6097              WS-KIX-SYS
  6098        end-unstring
  6099*       DISPLAY ' WS KIX SYS ' WS-KIXSYS
  6100*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  6101     end-if
  6102     set P to address of KIXHOST
  6103     CALL "getenv" using by value P returning var-ptr
  6104     if var-ptr = null then
  6105        display ' kixhost not set '
  6106     else
  6107        set address of var to var-ptr
  6108        move 0 to env-var-len
  6109        inspect var tallying env-var-len
  6110          for characters before X'00'
  6111*       DISPLAY '  KIXHOST = ' var (1:env-var-len)
  6112        MOVE var(1:env-var-len)  to ws-kixhost
  6113        DISPLAY ' WS KIX HOST ' WS-KIXhost
  6114     end-if
  6115     PERFORM 0325-EDIT-SCREEN    THRU 0325-EXIT
  6116     IF NOT EMI-NO-ERRORS
  6117       AND EIBAID = DFHPF4
  6118        GO TO 8200-SEND-DATAONLY
  6119     END-IF
  6120     MOVE LOW-VALUES             TO NEW-ELCRTO-REC
  6121     MOVE PI-ELCRTO-KEY          TO ELCRTO-KEY
  6122                                    NEW-ELCRTO-KEY
  6123     SUBTRACT +1               FROM NCRTO-SEQ-NO
  6124     PERFORM 0362-READ-ELCRTO    THRU 0362-EXIT
  6125     IF RESP-NORMAL
  6126        AND (PI-ELCRTO-KEY = OC-CONTROL-PRIMARY)
  6127        DISPLAY ' RESP NORMAL AND = '
  6128        PERFORM 0400-ADD-ERENDT  THRU 0400-EXIT
  6129*       PERFORM 1000-BUILD-ERARCH THRU 1000-EXIT
  6130        PERFORM 1100-CALL-NS-BUS-LOGIC
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 108
* EL6318.cbl
  6131                                 THRU 1100-EXIT
  6132        IF BL-OK
  6133           CONTINUE
  6134        ELSE
  6135           MOVE ER-8888          TO EMI-ERROR-NUMBER (1)
  6136           MOVE BL-MESSAGE       TO EMI-ERROR-TEXT (1)
  6137           MOVE -1               TO SIGREQL
  6138        END-IF
  6139     ELSE
  6140        MOVE ER-9999             TO EMI-ERROR
  6141        PERFORM 9900-ERROR-FORMAT
  6142                                 THRU 9900-EXIT
  6143        MOVE -1                  TO SIGREQL
  6144        GO TO 8100-SEND-INITIAL-MAP
  6145     END-IF
  6146     MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
  6147                                 TO SYSO
  6148     MOVE WS-KIXHOST             TO HOSTO
  6149     MOVE PI-COMPANY-ID          TO COMPANYO
  6150     MOVE '4'                    TO DATASORO
  6151     MOVE BL-BATCH-NO            TO BATCHNOO
  6152     MOVE BL-BATCH-SEQ           TO BSEQNOO
  6153     MOVE BL-ARCHIVE-NO          TO ARCHNOO
  6154     MOVE PI-PROCESSOR-ID        TO PROCIDO
  6155*    MOVE 'N'                    TO PRTSWO
  6156*    MOVE -1                     TO PRTSWL
  6157*    MOVE AL-UANON               TO PRTSWA
  6158     MOVE -1                     TO SIGREQL
  6159     MOVE AL-UANON               TO SIGREQA
  6160     IF EIBAID = DFHPF4
  6161        MOVE SPACES              TO PI-CLEAR-ERROR-SW
  6162        MOVE ER-0280             TO EMI-ERROR
  6163        PERFORM 9900-ERROR-FORMAT
  6164                                 THRU 9900-EXIT
  6165        MOVE BL-ARCHIVE-NO       TO W-ARCH-SUPPRESS
  6166        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  6167        MOVE 'Y'                 TO PI-FINALIZED-IND
  6168        GO TO 9400-CLEAR
  6169     ELSE
  6170        MOVE ER-1818             TO EMI-ERROR
  6171        PERFORM 9900-ERROR-FORMAT
  6172                                 THRU 9900-EXIT
  6173     END-IF
  6174     GO TO 0350-BUILD-INIT-MAP
  6175     .
  6176 0360-EXIT.
  6177     EXIT.
  6178 0362-READ-ELCRTO.
  6179     display ' made it to 0362 '
  6180
  6181* EXEC CICS READ
  6182*        DATASET   (WS-ELCRTO-FILE-ID)
  6183*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  6184*        RIDFLD    (ELCRTO-KEY)
  6185*        RESP      (WS-RESPONSE)
  6186*    END-EXEC
  6187*    MOVE '&"S        E          (  N#00006107' TO DFHEIV0
  6188     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 109
* EL6318.cbl
  6189     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6190     MOVE X'204E233030303036313037' TO DFHEIV0(25:11)
  6191     CALL 'kxdfhei1' USING DFHEIV0,
  6192           WS-ELCRTO-FILE-ID,
  6193           DFHEIV20,
  6194           DFHEIV99,
  6195           ELCRTO-KEY,
  6196           DFHEIV99,
  6197           DFHEIV99,
  6198           DFHEIV99
  6199     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  6200         DFHEIV20
  6201     MOVE EIBRESP  TO WS-RESPONSE
  6202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6203     .
  6204 0362-EXIT.
  6205     EXIT.
  6206 0363-READ-ELCRTO-UPD.
  6207     display ' made it to 0363 '
  6208
  6209* EXEC CICS READ
  6210*        DATASET   (WS-ELCRTO-FILE-ID)
  6211*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  6212*        RIDFLD    (ELCRTO-KEY)
  6213*        UPDATE
  6214*        RESP      (WS-RESPONSE)
  6215*    END-EXEC
  6216*    MOVE '&"S        EU         (  N#00006118' TO DFHEIV0
  6217     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6218     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6219     MOVE X'204E233030303036313138' TO DFHEIV0(25:11)
  6220     CALL 'kxdfhei1' USING DFHEIV0,
  6221           WS-ELCRTO-FILE-ID,
  6222           DFHEIV20,
  6223           DFHEIV99,
  6224           ELCRTO-KEY,
  6225           DFHEIV99,
  6226           DFHEIV99,
  6227           DFHEIV99
  6228     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  6229         DFHEIV20
  6230     MOVE EIBRESP  TO WS-RESPONSE
  6231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6232     .
  6233 0363-EXIT.
  6234     EXIT.
  6235 0365-READ-ERENDT.
  6236
  6237* EXEC CICS READ
  6238*        DATASET   (WS-ERENDT-FILE-ID)
  6239*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
  6240*        RIDFLD    (ERENDT-KEY)
  6241*        RESP      (WS-RESPONSE)
  6242*    END-EXEC
  6243*    MOVE '&"S        E          (  N#00006129' TO DFHEIV0
  6244     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6245     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6246     MOVE X'204E233030303036313239' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 110
* EL6318.cbl
  6247     CALL 'kxdfhei1' USING DFHEIV0,
  6248           WS-ERENDT-FILE-ID,
  6249           DFHEIV20,
  6250           DFHEIV99,
  6251           ERENDT-KEY,
  6252           DFHEIV99,
  6253           DFHEIV99,
  6254           DFHEIV99
  6255     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6256         DFHEIV20
  6257     MOVE EIBRESP  TO WS-RESPONSE
  6258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6259     .
  6260 0365-EXIT.
  6261     EXIT.
  6262 0400-ADD-ERENDT.
  6263     PERFORM 1500-GET-ARCH-NO    THRU 1500-EXIT
  6264     display ' made it to 0400 '
  6265
  6266* EXEC CICS GETMAIN
  6267*         SET      (ADDRESS OF ENDORSEMENT-RECORD)
  6268*         LENGTH   (ERENDT-LENGTH)
  6269*         INITIMG  (GETMAIN-SPACE)
  6270*    END-EXEC
  6271*    MOVE ',"IL                  $   #00006141' TO DFHEIV0
  6272     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6273     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6274     MOVE X'2020233030303036313431' TO DFHEIV0(25:11)
  6275     CALL 'kxdfhei1' USING DFHEIV0,
  6276           DFHEIV20,
  6277           ERENDT-LENGTH,
  6278           GETMAIN-SPACE
  6279     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6280         DFHEIV20
  6281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6282     PERFORM 0410-INIT-ERENDT    THRU 0410-EXIT
  6283     MOVE PI-PROCESSOR-ID        TO EN-LAST-MAINT-BY
  6284     MOVE EIBTIME                TO EN-LAST-MAINT-HHMMSS
  6285     MOVE WS-CURRENT-BIN-DT      TO EN-LAST-MAINT-DT
  6286                                    EN-INPUT-DT
  6287                                    EN-PROCESS-DT
  6288
  6289     MOVE OC-INS-FIRST-NAME    TO EN-INS-ORIG-FIRST-NAME
  6290     MOVE OC-INS-MIDDLE-INIT   TO EN-INS-ORIG-MIDDLE-INIT
  6291     MOVE OC-INS-LAST-NAME     TO EN-INS-ORIG-LAST-NAME
  6292     MOVE OC-INS-AGE           TO EN-INS-ORIG-AGE
  6293     MOVE OC-JNT-FIRST-NAME    TO EN-JNT-ORIG-FIRST-NAME
  6294     MOVE OC-JNT-MIDDLE-INIT   TO EN-JNT-ORIG-MIDDLE-INIT
  6295     MOVE OC-JNT-LAST-NAME     TO EN-JNT-ORIG-LAST-NAME
  6296     MOVE OC-JNT-AGE           TO EN-JNT-ORIG-AGE
  6297     MOVE OC-LF-BENCD          TO EN-LF-ORIG-BENCD
  6298     IF OC-LF-BENCD NOT = '00' AND '  '
  6299        MOVE OC-LF-BEN-AMT       TO EN-LF-ORIG-BEN-AMT
  6300        MOVE OC-LF-PRM-AMT       TO EN-LF-ORIG-PRM-AMT
  6301        MOVE OC-LF-ALT-BEN-AMT   TO EN-LF-ORIG-ALT-BEN-AMT
  6302        MOVE OC-LF-ALT-PRM-AMT   TO EN-LF-ORIG-ALT-PRM-AMT
  6303        MOVE OC-LF-TERM          TO EN-LF-ORIG-TERM
  6304        MOVE OC-LF-EXP-DT        TO EN-LF-ORIG-EXP-DT
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 111
* EL6318.cbl
  6305        MOVE OC-LF-COMM-PCT      TO EN-LF-ORIG-COMM-PCT
  6306     END-IF
  6307     MOVE OC-AH-BENCD          TO EN-AH-ORIG-BENCD
  6308     IF OC-AH-BENCD NOT = '00' AND '  '
  6309        MOVE OC-AH-BEN-AMT       TO EN-AH-ORIG-BEN-AMT
  6310        MOVE OC-AH-PRM-AMT       TO EN-AH-ORIG-PRM-AMT
  6311        MOVE OC-AH-TERM          TO EN-AH-ORIG-TERM
  6312        MOVE OC-AH-EXP-DT        TO EN-AH-ORIG-EXP-DT
  6313        MOVE OC-AH-CP            TO EN-AH-ORIG-CP
  6314        MOVE OC-AH-COMM-PCT      TO EN-AH-ORIG-COMM-PCT
  6315     END-IF
  6316     MOVE OC-CRED-BENE-NAME      TO EN-ORIG-CRED-BENE
  6317
  6318* EXEC CICS GETMAIN
  6319*         SET      (ADDRESS OF PENDING-BUSINESS)
  6320*         LENGTH   (ERPNDB-LENGTH)
  6321*         INITIMG  (GETMAIN-SPACE)
  6322*    END-EXEC
  6323*    MOVE ',"IL                  $   #00006181' TO DFHEIV0
  6324     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6325     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6326     MOVE X'2020233030303036313831' TO DFHEIV0(25:11)
  6327     CALL 'kxdfhei1' USING DFHEIV0,
  6328           DFHEIV20,
  6329           ERPNDB-LENGTH,
  6330           GETMAIN-SPACE
  6331     SET ADDRESS OF PENDING-BUSINESS TO
  6332         DFHEIV20
  6333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6334     DISPLAY ' JUST DID GETMAIN ON ERPNDB '
  6335     MOVE PI-ERPNDB-KEY          TO ERPNDB-KEY
  6336
  6337* EXEC CICS READ
  6338*        DATASET   (WS-ERPNDB-FILE-ID)
  6339*        INTO      (PENDING-BUSINESS)
  6340*        RIDFLD    (ERPNDB-KEY)
  6341*        RESP      (WS-RESPONSE)
  6342*    END-EXEC
  6343     MOVE LENGTH OF
  6344      PENDING-BUSINESS
  6345       TO DFHEIV11
  6346*    MOVE '&"IL       E          (  N#00006188' TO DFHEIV0
  6347     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6348     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6349     MOVE X'204E233030303036313838' TO DFHEIV0(25:11)
  6350     CALL 'kxdfhei1' USING DFHEIV0,
  6351           WS-ERPNDB-FILE-ID,
  6352           PENDING-BUSINESS,
  6353           DFHEIV11,
  6354           ERPNDB-KEY,
  6355           DFHEIV99,
  6356           DFHEIV99,
  6357           DFHEIV99
  6358     MOVE EIBRESP  TO WS-RESPONSE
  6359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6360     IF NOT RESP-NORMAL
  6361        GO TO 0400-EXIT
  6362     END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 112
* EL6318.cbl
  6363*    set found-pndb to true
  6364     display ' good read on erpndb '
  6365     MOVE PB-I-INSURED-FIRST-NAME  TO EN-INS-NEW-FIRST-NAME
  6366                                      NCRTO-INS-FIRST-NAME
  6367     MOVE PB-I-INSURED-MIDDLE-INIT TO EN-INS-NEW-MIDDLE-INIT
  6368                                      NCRTO-INS-MIDDLE-INIT
  6369     MOVE PB-I-INSURED-LAST-NAME   TO EN-INS-NEW-LAST-NAME
  6370                                      NCRTO-INS-LAST-NAME
  6371     MOVE PB-I-AGE                 TO EN-INS-NEW-AGE
  6372                                      NCRTO-INS-AGE
  6373     MOVE PB-I-JOINT-FIRST-NAME    TO EN-JNT-NEW-FIRST-NAME
  6374                                      NCRTO-JNT-FIRST-NAME
  6375     MOVE PB-I-JOINT-MIDDLE-INIT   TO EN-JNT-NEW-MIDDLE-INIT
  6376                                      NCRTO-JNT-MIDDLE-INIT
  6377     MOVE PB-I-JOINT-LAST-NAME     TO EN-JNT-NEW-LAST-NAME
  6378                                      NCRTO-JNT-LAST-NAME
  6379     MOVE PB-I-JOINT-AGE           TO EN-JNT-NEW-AGE
  6380                                      NCRTO-JNT-AGE
  6381     MOVE PB-I-LF-BENEFIT-CD       TO EN-LF-NEW-BENCD
  6382                                      NCRTO-LF-BENCD
  6383     IF PB-I-LF-BENEFIT-CD NOT = '00' AND '  '
  6384        MOVE PB-I-LF-BENEFIT-AMT   TO EN-LF-NEW-BEN-AMT
  6385                                      NCRTO-LF-BEN-AMT
  6386        MOVE PB-I-LF-PREMIUM-AMT   TO EN-LF-NEW-PRM-AMT
  6387                                      NCRTO-LF-PRM-AMT
  6388        MOVE PB-I-LF-ALT-BENEFIT-AMT TO EN-LF-NEW-ALT-BEN-AMT
  6389                                      NCRTO-LF-ALT-BEN-AMT
  6390        MOVE PB-I-LF-ALT-PREMIUM-AMT TO EN-LF-NEW-ALT-PRM-AMT
  6391                                      NCRTO-LF-ALT-PRM-AMT
  6392        MOVE PB-I-LF-TERM          TO EN-LF-NEW-TERM
  6393                                      NCRTO-LF-TERM
  6394        MOVE PB-I-LF-EXPIRE-DT     TO EN-LF-NEW-EXP-DT
  6395                                      NCRTO-LF-EXP-DT
  6396        IF PB-I-JOINT-COMMISSION > +0
  6397           MOVE PB-I-JOINT-COMMISSION
  6398                                   TO EN-LF-NEW-COMM-PCT
  6399                                      NCRTO-LF-COMM-PCT
  6400        ELSE
  6401           MOVE PB-I-LIFE-COMMISSION
  6402                                   TO EN-LF-NEW-COMM-PCT
  6403                                      NCRTO-LF-COMM-PCT
  6404        END-IF
  6405     END-IF
  6406     MOVE PB-I-AH-BENEFIT-CD       TO EN-AH-NEW-BENCD
  6407                                      NCRTO-AH-BENCD
  6408     IF PB-I-AH-BENEFIT-CD NOT = '00' AND '  '
  6409        MOVE PB-I-AH-BENEFIT-AMT   TO EN-AH-NEW-BEN-AMT
  6410                                      NCRTO-AH-BEN-AMT
  6411        MOVE PB-I-AH-PREMIUM-AMT   TO EN-AH-NEW-PRM-AMT
  6412                                      NCRTO-AH-PRM-AMT
  6413        MOVE PB-I-AH-TERM          TO EN-AH-NEW-TERM
  6414                                      NCRTO-AH-TERM
  6415        MOVE PB-I-AH-EXPIRE-DT     TO EN-AH-NEW-EXP-DT
  6416                                      NCRTO-AH-EXP-DT
  6417        MOVE PB-I-AH-CRIT-PER      TO EN-AH-NEW-CP
  6418                                      NCRTO-AH-CP
  6419        MOVE PB-I-AH-COMMISSION    TO EN-AH-NEW-COMM-PCT
  6420                                      NCRTO-AH-COMM-PCT
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 113
* EL6318.cbl
  6421     END-IF
  6422     MOVE PB-I-1ST-PMT-DT          TO NCRTO-1ST-PMT-DT
  6423     MOVE PB-ENTRY-BATCH           TO EN-BATCH-NUMBER
  6424     MOVE W-ACCT-SUMM              TO EN-ACCT-SUMM
  6425     MOVE W-CSO-SUMM               TO EN-CSO-SUMM
  6426*     PERFORM 0450-GET-ERACCT     THRU 0450-EXIT
  6427     MOVE 'Y'                    TO EN-COMM-CHGBK
  6428
  6429     COMPUTE WS-DUE-BORROWER = (EN-LF-ORIG-PRM-AMT
  6430        + EN-LF-ORIG-ALT-PRM-AMT + EN-AH-ORIG-PRM-AMT) -
  6431        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT +
  6432        EN-AH-NEW-PRM-AMT)
  6433     COMPUTE EN-ACCT-PORTION ROUNDED =
  6434        (((EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT) -
  6435        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT))
  6436        * EN-LF-NEW-COMM-PCT)
  6437                       +
  6438        ((EN-AH-ORIG-PRM-AMT - EN-AH-NEW-PRM-AMT)
  6439        * EN-AH-NEW-COMM-PCT)
  6440     COMPUTE EN-CSO-PORTION = WS-DUE-BORROWER -
  6441        EN-ACCT-PORTION
  6442     move pb-control-by-account (1:33)
  6443                                 to ws-ermail-key
  6444
  6445* EXEC CICS READ
  6446*        DATASET   ('ERMAIL')
  6447*        SET       (ADDRESS OF MAILING-DATA)
  6448*        RIDFLD    (WS-ERMAIL-KEY)
  6449*        RESP      (WS-RESPONSE)
  6450*    END-EXEC
  6451     MOVE 'ERMAIL' TO DFHEIV1
  6452*    MOVE '&"S        E          (  N#00006278' TO DFHEIV0
  6453     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6454     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6455     MOVE X'204E233030303036323738' TO DFHEIV0(25:11)
  6456     CALL 'kxdfhei1' USING DFHEIV0,
  6457           DFHEIV1,
  6458           DFHEIV20,
  6459           DFHEIV99,
  6460           WS-ERMAIL-KEY,
  6461           DFHEIV99,
  6462           DFHEIV99,
  6463           DFHEIV99
  6464     SET ADDRESS OF MAILING-DATA TO
  6465         DFHEIV20
  6466     MOVE EIBRESP  TO WS-RESPONSE
  6467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6468     IF RESP-NORMAL
  6469        DISPLAY ' FOUND ERMAIL '
  6470        MOVE MA-CRED-BENE-NAME   TO EN-NEW-CRED-BENE
  6471                                    NCRTO-CRED-BENE-NAME
  6472     ELSE
  6473        DISPLAY ' ERMAIL READ ' WS-RESPONSE
  6474     END-IF
  6475     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6476        IF REACD-IN (S1) NOT = LOW-VALUES
  6477           MOVE REACD-IN (S1)    TO EN-REASON-CODE (S1)
  6478        END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 114
* EL6318.cbl
  6479     END-PERFORM
  6480     MOVE LTRIDI                 TO EN-TEMPLATE-USED
  6481     MOVE 'G'                    TO EN-DOCU-TYPE
  6482     MOVE 'Y'                    TO EN-MONEY-SW
  6483     MOVE SIGREQI                TO EN-SIG-SW
  6484     MOVE VOUCHI                 TO EN-VOUCHER-SW
  6485     MOVE PAYEEI                 TO EN-PAYEE
  6486     MOVE HLTHAPPI               TO EN-HEALTH-APP
  6487     DISPLAY ' 0400 EXIT '
  6488     PERFORM 0430-WRITE-ERENDT   THRU 0430-EXIT
  6489     .
  6490 0400-EXIT.
  6491     EXIT.
  6492 0410-INIT-ERENDT.
  6493     display ' made it to 0410 '
  6494     MOVE OC-CONTROL-PRIMARY     TO ERENDT-KEY
  6495     MOVE ZEROS                  TO ENDT-SEQ-NO
  6496
  6497* EXEC CICS READ
  6498*        DATASET    (WS-ERENDT-FILE-ID)
  6499*        RIDFLD     (ERENDT-KEY)
  6500*        INTO       (ENDORSEMENT-RECORD)
  6501*        RESP       (WS-RESPONSE)
  6502*        GTEQ
  6503*    END-EXEC
  6504     MOVE LENGTH OF
  6505      ENDORSEMENT-RECORD
  6506       TO DFHEIV11
  6507*    MOVE '&"IL       G          (  N#00006312' TO DFHEIV0
  6508     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  6509     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6510     MOVE X'204E233030303036333132' TO DFHEIV0(25:11)
  6511     CALL 'kxdfhei1' USING DFHEIV0,
  6512           WS-ERENDT-FILE-ID,
  6513           ENDORSEMENT-RECORD,
  6514           DFHEIV11,
  6515           ERENDT-KEY,
  6516           DFHEIV99,
  6517           DFHEIV99,
  6518           DFHEIV99
  6519     MOVE EIBRESP  TO WS-RESPONSE
  6520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6521     IF RESP-NORMAL
  6522        AND (EN-CONTROL-PRIMARY (1:34) =
  6523           OC-CONTROL-PRIMARY (1:34))
  6524        COMPUTE WS-SEQ-NO = EN-SEQ-NO - +1
  6525     ELSE
  6526        MOVE +4096               TO WS-SEQ-NO
  6527     END-IF
  6528     MOVE 'EN'                   TO ENDORSEMENT-RECORD
  6529     MOVE OC-CONTROL-PRIMARY     TO EN-CONTROL-PRIMARY
  6530     MOVE EN-COMPANY-CD          TO EN-COMPANY-CD-A1
  6531     MOVE WS-SEQ-NO              TO EN-SEQ-NO
  6532     INITIALIZE EN-ISSUE-RECORD
  6533     MOVE LOW-VALUES             TO EN-LF-ORIG-EXP-DT
  6534                                    EN-AH-ORIG-EXP-DT
  6535                                    EN-LF-NEW-EXP-DT
  6536                                    EN-AH-NEW-EXP-DT
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 115
* EL6318.cbl
  6537                                    EN-PROCESS-DT
  6538     .
  6539 0410-EXIT.
  6540     EXIT.
  6541 0420-UPDATE-ELCRTO.
  6542     PERFORM 0363-READ-ELCRTO-UPD THRU 0363-EXIT
  6543     IF RESP-NORMAL
  6544        MOVE WS-CURRENT-BIN-DT   TO OC-ENDORSEMENT-PROCESSED-DT
  6545                                    OC-LAST-MAINT-DT
  6546        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
  6547        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
  6548
  6549* EXEC CICS REWRITE
  6550*          FROM     (ORIGINAL-CERTIFICATE)
  6551*          DATASET  ('ELCRTO')
  6552*       END-EXEC
  6553     MOVE LENGTH OF
  6554      ORIGINAL-CERTIFICATE
  6555       TO DFHEIV11
  6556     MOVE 'ELCRTO' TO DFHEIV1
  6557*    MOVE '&& L                  %   #00006346' TO DFHEIV0
  6558     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6559     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6560     MOVE X'2020233030303036333436' TO DFHEIV0(25:11)
  6561     CALL 'kxdfhei1' USING DFHEIV0,
  6562           DFHEIV1,
  6563           ORIGINAL-CERTIFICATE,
  6564           DFHEIV11,
  6565           DFHEIV99
  6566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6567     END-IF
  6568     .
  6569 0420-EXIT.
  6570     EXIT.
  6571
  6572 0425-ADD-NEW-ELCRTO.
  6573     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
  6574     MOVE 'OC'                   TO OC-RECORD-ID
  6575     MOVE NEW-ELCRTO-KEY         TO OC-CONTROL-PRIMARY
  6576     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
  6577     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  6578     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
  6579     MOVE NCRTO-INS-FIRST-NAME   TO OC-INS-FIRST-NAME
  6580     MOVE NCRTO-INS-MIDDLE-INIT  TO OC-INS-MIDDLE-INIT
  6581     MOVE NCRTO-INS-LAST-NAME    TO OC-INS-LAST-NAME
  6582     MOVE NCRTO-INS-AGE          TO OC-INS-AGE
  6583     MOVE NCRTO-JNT-FIRST-NAME   TO OC-JNT-FIRST-NAME
  6584     MOVE NCRTO-JNT-MIDDLE-INIT  TO OC-JNT-MIDDLE-INIT
  6585     MOVE NCRTO-JNT-LAST-NAME    TO OC-JNT-LAST-NAME
  6586     MOVE NCRTO-JNT-AGE          TO OC-JNT-AGE
  6587     MOVE NCRTO-LF-BENCD         TO OC-LF-BENCD
  6588     MOVE NCRTO-LF-BEN-AMT       TO OC-LF-BEN-AMT
  6589     MOVE NCRTO-LF-PRM-AMT       TO OC-LF-PRM-AMT
  6590     MOVE NCRTO-LF-ALT-BEN-AMT   TO OC-LF-ALT-BEN-AMT
  6591     MOVE NCRTO-LF-ALT-PRM-AMT   TO OC-LF-ALT-PRM-AMT
  6592     MOVE NCRTO-LF-TERM          TO OC-LF-TERM
  6593     MOVE NCRTO-LF-EXP-DT        TO OC-LF-EXP-DT
  6594     MOVE NCRTO-LF-COMM-PCT      TO OC-LF-COMM-PCT
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 116
* EL6318.cbl
  6595     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
  6596     MOVE +0                     TO OC-LF-CANCEL-AMT
  6597                                    OC-LF-ITD-CANCEL-AMT
  6598     MOVE NCRTO-AH-BENCD         TO OC-AH-BENCD
  6599     MOVE NCRTO-AH-BEN-AMT       TO OC-AH-BEN-AMT
  6600     MOVE NCRTO-AH-PRM-AMT       TO OC-AH-PRM-AMT
  6601     MOVE NCRTO-AH-TERM          TO OC-AH-TERM
  6602     MOVE NCRTO-AH-EXP-DT        TO OC-AH-EXP-DT
  6603     MOVE NCRTO-AH-CP            TO OC-AH-CP
  6604     MOVE NCRTO-AH-COMM-PCT      TO OC-AH-COMM-PCT
  6605     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
  6606     MOVE +0                     TO OC-AH-CANCEL-AMT
  6607                                    OC-AH-ITD-CANCEL-AMT
  6608     MOVE NCRTO-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
  6609     MOVE NCRTO-1ST-PMT-DT       TO OC-1ST-PMT-DT
  6610     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
  6611     .
  6612 0425-WRITE-ELCRTO.
  6613
  6614
  6615* EXEC CICS WRITE
  6616*       DATASET   ('ELCRTO')
  6617*       FROM      (ORIGINAL-CERTIFICATE)
  6618*       RIDFLD    (OC-CONTROL-PRIMARY)
  6619*       RESP      (WS-RESPONSE)
  6620*    END-EXEC
  6621     MOVE LENGTH OF
  6622      ORIGINAL-CERTIFICATE
  6623       TO DFHEIV11
  6624     MOVE 'ELCRTO' TO DFHEIV1
  6625*    MOVE '&$ L                  ''  N#00006397' TO DFHEIV0
  6626     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6627     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6628     MOVE X'204E233030303036333937' TO DFHEIV0(25:11)
  6629     CALL 'kxdfhei1' USING DFHEIV0,
  6630           DFHEIV1,
  6631           ORIGINAL-CERTIFICATE,
  6632           DFHEIV11,
  6633           OC-CONTROL-PRIMARY,
  6634           DFHEIV99,
  6635           DFHEIV99
  6636     MOVE EIBRESP  TO WS-RESPONSE
  6637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6638
  6639     display ' just wrote new crto ' ws-response
  6640     IF RESP-DUPKEY
  6641        SUBTRACT +1              FROM OC-KEY-SEQ-NO
  6642        GO TO 0425-WRITE-ELCRTO
  6643     ELSE
  6644        IF NOT RESP-NORMAL
  6645           MOVE -1               TO SIGREQL
  6646           MOVE ER-3830          TO EMI-ERROR
  6647           PERFORM 9900-ERROR-FORMAT
  6648                                 THRU 9900-EXIT
  6649        ELSE
  6650           MOVE OC-CONTROL-PRIMARY TO PI-ELCRTO-KEY
  6651        END-IF
  6652     END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 117
* EL6318.cbl
  6653
  6654     .
  6655 0425-EXIT.
  6656     EXIT.
  6657
  6658 0426-ADD-CERT-NOTES.
  6659
  6660     MOVE LOW-VALUES TO CERT-NOTE-ENTRIES
  6661     SET TB-INDX TO 1
  6662
  6663     IF PI-CERTNT1-ENTERED > SPACES
  6664         MOVE PI-CERTNT1-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6665         MOVE PI-PROCESSOR-ID    TO
  6666                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6667         MOVE EIBTIME            TO
  6668                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6669         MOVE WS-CURRENT-BIN-DT  TO
  6670                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6671         SET TB-INDX UP BY +1
  6672     END-IF
  6673
  6674     IF PI-CERTNT2-ENTERED > SPACES
  6675         MOVE PI-CERTNT2-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6676         MOVE PI-PROCESSOR-ID    TO
  6677                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6678         MOVE EIBTIME            TO
  6679                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6680         MOVE WS-CURRENT-BIN-DT  TO
  6681                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6682         SET TB-INDX UP BY +1
  6683     END-IF
  6684
  6685     IF PI-CERTNT3-ENTERED > SPACES
  6686         MOVE PI-CERTNT3-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6687         MOVE PI-PROCESSOR-ID    TO
  6688                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6689         MOVE EIBTIME            TO
  6690                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6691         MOVE WS-CURRENT-BIN-DT  TO
  6692                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6693         SET TB-INDX UP BY +1
  6694     END-IF
  6695
  6696     IF PI-CERTNT4-ENTERED > SPACES
  6697         MOVE PI-CERTNT4-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6698         MOVE PI-PROCESSOR-ID    TO
  6699                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6700         MOVE EIBTIME            TO
  6701                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6702         MOVE WS-CURRENT-BIN-DT  TO
  6703                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6704         SET TB-INDX UP BY +1
  6705     END-IF
  6706
  6707     IF CERT-NOTE-ENTRIES > SPACES
  6708         PERFORM 0427-LOAD-CURRENT-CERT-NOTES THRU 0427-EXIT
  6709         PERFORM 1700-WRITE-CERT-NOTE THRU 1799-EXIT
  6710     END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 118
* EL6318.cbl
  6711
  6712     IF PI-BILLNT1-ENTERED > SPACES
  6713         MOVE SPACES             TO WS-MANUAL-BILL-NOTE
  6714         MOVE PI-BILLNT1-ENTERED TO WS-MAN-BN-NOTE
  6715         MOVE +63 TO WS-LEN
  6716         PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  6717     END-IF
  6718
  6719     IF PI-BILLNT2-ENTERED > SPACES
  6720         MOVE SPACES             TO WS-MANUAL-BILL-NOTE
  6721         MOVE PI-BILLNT2-ENTERED TO WS-MAN-BN-NOTE
  6722         MOVE +63 TO WS-LEN
  6723         PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  6724     END-IF
  6725
  6726     .
  6727 0426-EXIT.
  6728     EXIT.
  6729
  6730 0427-LOAD-CURRENT-CERT-NOTES.
  6731
  6732     MOVE PI-CRTO-COMPANY-CD  TO ERCNOT-COMPANY-CD
  6733     MOVE PI-CRTO-CARRIER     TO ERCNOT-CARRIER
  6734     MOVE PI-CRTO-GROUPING    TO ERCNOT-GROUPING
  6735     MOVE PI-CRTO-STATE       TO ERCNOT-STATE
  6736     MOVE PI-CRTO-ACCOUNT     TO ERCNOT-ACCOUNT
  6737     MOVE PI-CRTO-CERT-EFF-DT TO ERCNOT-EFF-DT
  6738     MOVE PI-CRTO-CERT-PRIME  TO ERCNOT-CERT-PRIME
  6739     MOVE PI-CRTO-CERT-SFX    TO ERCNOT-CERT-SFX
  6740     MOVE '1'                 TO ERCNOT-REC-TYP
  6741     MOVE +0                  TO ERCNOT-SEQ
  6742     MOVE ERCNOT-PARTIAL-KEY  TO SV-PARTIAL-KEY
  6743
  6744
  6745* EXEC CICS STARTBR
  6746*         DATASET(WS-ERCNOT-FILE-ID)
  6747*         RIDFLD(ERCNOT-KEY)
  6748*         KEYLENGTH(ERCNOT-START-LENGTH)
  6749*         RESP      (WS-RESPONSE)
  6750*         GENERIC
  6751*         GTEQ
  6752*    END-EXEC.
  6753     MOVE 0
  6754       TO DFHEIV11
  6755*    MOVE '&,   KG    G          &  N#00006509' TO DFHEIV0
  6756     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  6757     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6758     MOVE X'204E233030303036353039' TO DFHEIV0(25:11)
  6759     CALL 'kxdfhei1' USING DFHEIV0,
  6760           WS-ERCNOT-FILE-ID,
  6761           ERCNOT-KEY,
  6762           ERCNOT-START-LENGTH,
  6763           DFHEIV11,
  6764           DFHEIV99
  6765     MOVE EIBRESP  TO WS-RESPONSE
  6766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6767
  6768
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 119
* EL6318.cbl
  6769     IF NOT RESP-NORMAL
  6770        GO TO 0427-ENDBR
  6771     END-IF.
  6772
  6773 0427-LOOP.
  6774
  6775* EXEC CICS READNEXT
  6776*         SET(ADDRESS OF CERT-NOTE-FILE)
  6777*         DATASET(WS-ERCNOT-FILE-ID)
  6778*         RIDFLD(ERCNOT-KEY)
  6779*    END-EXEC.
  6780     MOVE 0
  6781       TO DFHEIV11
  6782*    MOVE '&.S                   )   #00006523' TO DFHEIV0
  6783     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6784     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6785     MOVE X'2020233030303036353233' TO DFHEIV0(25:11)
  6786     CALL 'kxdfhei1' USING DFHEIV0,
  6787           WS-ERCNOT-FILE-ID,
  6788           DFHEIV20,
  6789           DFHEIV99,
  6790           ERCNOT-KEY,
  6791           DFHEIV99,
  6792           DFHEIV11,
  6793           DFHEIV99,
  6794           DFHEIV99
  6795     SET ADDRESS OF CERT-NOTE-FILE TO
  6796         DFHEIV20
  6797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6798
  6799
  6800     IF CZ-COMPANY-CD NOT = PI-CRTO-COMPANY-CD
  6801         GO TO 0427-ENDBR
  6802     END-IF.
  6803
  6804     IF (CZ-CARRIER = SV-CARRIER)
  6805        AND (CZ-GROUPING = SV-GROUPING)
  6806        AND (CZ-STATE = SV-STATE)
  6807        AND (CZ-ACCOUNT = SV-ACCOUNT)
  6808        AND (CZ-CERT-EFF-DT = SV-EFF-DT)
  6809        AND (CZ-CERT-NO = SV-CERT-NO)
  6810        AND (CZ-RECORD-TYPE = '1')
  6811          MOVE CZ-NOTE TO CERT-NT-TEXT (TB-INDX)
  6812          MOVE CZ-LAST-MAINT-USER TO
  6813                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6814          MOVE CZ-LAST-MAINT-DT TO
  6815                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6816          MOVE CZ-LAST-MAINT-HHMMSS TO
  6817                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6818          SET TB-INDX UP BY 1
  6819          GO TO 0427-LOOP
  6820     END-IF.
  6821
  6822 0427-ENDBR.
  6823
  6824
  6825* EXEC CICS ENDBR
  6826*         DATASET(WS-ERCNOT-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 120
* EL6318.cbl
  6827*    END-EXEC.
  6828     MOVE 0
  6829       TO DFHEIV11
  6830*    MOVE '&2                    $   #00006553' TO DFHEIV0
  6831     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6832     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6833     MOVE X'2020233030303036353533' TO DFHEIV0(25:11)
  6834     CALL 'kxdfhei1' USING DFHEIV0,
  6835           WS-ERCNOT-FILE-ID,
  6836           DFHEIV11,
  6837           DFHEIV99
  6838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6839
  6840
  6841     .
  6842 0427-EXIT.
  6843     EXIT.
  6844
  6845 0430-WRITE-ERENDT.
  6846     DISPLAY ' NO ERRORS, ABOUT TO WRITE ERENDT '
  6847     MOVE EN-CONTROL-PRIMARY     TO PI-ERENDT-KEY
  6848     MOVE W-ARCH-NUMBER          TO EN-ARCHIVE-NO
  6849
  6850* EXEC CICS WRITE
  6851*         DATASET   (WS-ERENDT-FILE-ID)
  6852*         FROM      (ENDORSEMENT-RECORD)
  6853*         RIDFLD    (EN-CONTROL-PRIMARY)
  6854*         RESP      (WS-RESPONSE)
  6855*    END-EXEC
  6856     MOVE LENGTH OF
  6857      ENDORSEMENT-RECORD
  6858       TO DFHEIV11
  6859*    MOVE '&$ L                  ''  N#00006565' TO DFHEIV0
  6860     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6861     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6862     MOVE X'204E233030303036353635' TO DFHEIV0(25:11)
  6863     CALL 'kxdfhei1' USING DFHEIV0,
  6864           WS-ERENDT-FILE-ID,
  6865           ENDORSEMENT-RECORD,
  6866           DFHEIV11,
  6867           EN-CONTROL-PRIMARY,
  6868           DFHEIV99,
  6869           DFHEIV99
  6870     MOVE EIBRESP  TO WS-RESPONSE
  6871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6872     IF RESP-NORMAL
  6873        MOVE 'G'                 TO PI-DOCUMENT-PROCESSED
  6874        display ' good write erendt '
  6875        IF EIBAID = DFHPF4
  6876           PERFORM 0420-UPDATE-ELCRTO THRU 0420-EXIT
  6877           PERFORM 0425-ADD-NEW-ELCRTO THRU 0425-EXIT
  6878           PERFORM 0426-ADD-CERT-NOTES THRU 0426-EXIT
  6879           PERFORM 0440-ADD-BILLING-NOTE THRU 0440-EXIT
  6880        END-IF
  6881     ELSE
  6882        DISPLAY ' NOT A GOOD WRITE ERENDT ' WS-RESPONSE
  6883        MOVE -1                  TO SIGREQL
  6884        MOVE ER-0132             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 121
* EL6318.cbl
  6885        MOVE AL-UABON            TO SIGREQA
  6886        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6887     END-IF
  6888     .
  6889 0430-EXIT.
  6890     EXIT.
  6891
  6892
  6893 0440-ADD-BILLING-NOTE.
  6894
  6895* EXEC CICS GETMAIN
  6896*         SET      (ADDRESS OF EOB-CODES)
  6897*         LENGTH   (ELEOBC-LENGTH)
  6898*         INITIMG  (GETMAIN-SPACE)
  6899*    END-EXEC
  6900*    MOVE ',"IL                  $   #00006593' TO DFHEIV0
  6901     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6902     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6903     MOVE X'2020233030303036353933' TO DFHEIV0(25:11)
  6904     CALL 'kxdfhei1' USING DFHEIV0,
  6905           DFHEIV20,
  6906           ELEOBC-LENGTH,
  6907           GETMAIN-SPACE
  6908     SET ADDRESS OF EOB-CODES TO
  6909         DFHEIV20
  6910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6911
  6912     MOVE LOW-VALUES             TO WS-ELEOBC-KEY
  6913     MOVE PI-COMPANY-CD          TO WS-EOBC-COMPANY-CD
  6914     MOVE '5'                    TO WS-EOBC-REC-TYPE
  6915
  6916
  6917* EXEC CICS STARTBR
  6918*        DATASET   ('ELEOBC')
  6919*        RIDFLD    (WS-ELEOBC-KEY)
  6920*        GTEQ
  6921*        RESP      (WS-RESPONSE)
  6922*    END-EXEC
  6923     MOVE 'ELEOBC' TO DFHEIV1
  6924     MOVE 0
  6925       TO DFHEIV11
  6926*    MOVE '&,         G          &  N#00006603' TO DFHEIV0
  6927     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6928     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6929     MOVE X'204E233030303036363033' TO DFHEIV0(25:11)
  6930     CALL 'kxdfhei1' USING DFHEIV0,
  6931           DFHEIV1,
  6932           WS-ELEOBC-KEY,
  6933           DFHEIV99,
  6934           DFHEIV11,
  6935           DFHEIV99
  6936     MOVE EIBRESP  TO WS-RESPONSE
  6937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6938
  6939     IF NOT RESP-NORMAL
  6940        GO TO 0440-EXIT
  6941     END-IF
  6942      .
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 122
* EL6318.cbl
  6943 0440-READNEXT-ELEOBC.
  6944
  6945
  6946* EXEC CICS READNEXT
  6947*       INTO    (EOB-CODES)
  6948*       DATASET ('ELEOBC')
  6949*       RIDFLD  (WS-ELEOBC-KEY)
  6950*       RESP    (WS-RESPONSE)
  6951*    END-EXEC
  6952     MOVE LENGTH OF
  6953      EOB-CODES
  6954       TO DFHEIV12
  6955     MOVE 'ELEOBC' TO DFHEIV1
  6956     MOVE 0
  6957       TO DFHEIV11
  6958*    MOVE '&.IL                  )  N#00006616' TO DFHEIV0
  6959     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6960     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6961     MOVE X'204E233030303036363136' TO DFHEIV0(25:11)
  6962     CALL 'kxdfhei1' USING DFHEIV0,
  6963           DFHEIV1,
  6964           EOB-CODES,
  6965           DFHEIV12,
  6966           WS-ELEOBC-KEY,
  6967           DFHEIV99,
  6968           DFHEIV11,
  6969           DFHEIV99,
  6970           DFHEIV99
  6971     MOVE EIBRESP  TO WS-RESPONSE
  6972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6973
  6974     IF RESP-NORMAL
  6975         IF EO-RECORD-TYPE NOT = '5'
  6976             GO TO 0440-EXIT
  6977         END-IF
  6978     ELSE
  6979         GO TO 0440-EXIT
  6980     END-IF
  6981
  6982     IF EO-RECORD-TYPE = '5' AND
  6983        EO-EOB-CODE = PI-LTRID-ENTERED
  6984           CONTINUE
  6985     ELSE
  6986         GO TO 0440-READNEXT-ELEOBC
  6987     END-IF
  6988
  6989     MOVE SPACES TO WS-BILLING-NOTE
  6990     MOVE EO-DESCRIPTION TO WS-BN-NOTE
  6991     MOVE PI-LTRID-ENTERED TO WS-BN-LTRID
  6992     MOVE WS-CURRENT-DT TO WS-BN-DATE
  6993     MOVE PI-PROCESSOR-ID TO WS-BN-USERID
  6994     MOVE +25 TO WS-LEN
  6995
  6996     PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  6997     .
  6998 0440-EXIT.
  6999     EXIT.
  7000
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 123
* EL6318.cbl
  7001 0441-UPDATE-BILLING-NOTE.
  7002
  7003* EXEC CICS GETMAIN
  7004*         SET      (ADDRESS OF CERTIFICATE-NOTE)
  7005*         LENGTH   (ERNOTE-LENGTH)
  7006*         INITIMG  (GETMAIN-SPACE)
  7007*    END-EXEC
  7008*    MOVE ',"IL                  $   #00006651' TO DFHEIV0
  7009     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7010     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7011     MOVE X'2020233030303036363531' TO DFHEIV0(25:11)
  7012     CALL 'kxdfhei1' USING DFHEIV0,
  7013           DFHEIV20,
  7014           ERNOTE-LENGTH,
  7015           GETMAIN-SPACE
  7016     SET ADDRESS OF CERTIFICATE-NOTE TO
  7017         DFHEIV20
  7018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7019
  7020     MOVE PI-ERENDT-KEY (1:33) TO WS-ERNOTE-KEY
  7021
  7022
  7023* EXEC CICS READ
  7024*       DATASET    (WS-ERNOTE-FILE-ID)
  7025*       RIDFLD     (WS-ERNOTE-KEY)
  7026*       INTO       (CERTIFICATE-NOTE)
  7027*       RESP       (WS-RESPONSE)
  7028*       UPDATE
  7029*    END-EXEC
  7030     MOVE LENGTH OF
  7031      CERTIFICATE-NOTE
  7032       TO DFHEIV11
  7033*    MOVE '&"IL       EU         (  N#00006659' TO DFHEIV0
  7034     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7035     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7036     MOVE X'204E233030303036363539' TO DFHEIV0(25:11)
  7037     CALL 'kxdfhei1' USING DFHEIV0,
  7038           WS-ERNOTE-FILE-ID,
  7039           CERTIFICATE-NOTE,
  7040           DFHEIV11,
  7041           WS-ERNOTE-KEY,
  7042           DFHEIV99,
  7043           DFHEIV99,
  7044           DFHEIV99
  7045     MOVE EIBRESP  TO WS-RESPONSE
  7046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7047
  7048     IF RESP-NORMAL
  7049       IF CN-BILLING-START-LINE-NO NOT NUMERIC
  7050          MOVE ZEROS            TO CN-BILLING-START-LINE-NO
  7051       END-IF
  7052       IF CN-BILLING-END-LINE-NO NOT NUMERIC
  7053          MOVE ZEROS            TO CN-BILLING-END-LINE-NO
  7054       END-IF
  7055       PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  7056           (NOTE-SUB > +10) OR
  7057           (CN-LINE (NOTE-SUB) (1:WS-LEN) =
  7058                             WS-BILLING-NOTE (1:WS-LEN))
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 124
* EL6318.cbl
  7059       END-PERFORM
  7060       IF CN-LINE (NOTE-SUB) (1:WS-LEN) =
  7061                              WS-BILLING-NOTE (1:WS-LEN)
  7062
  7063* EXEC CICS UNLOCK
  7064*           DATASET    (WS-ERNOTE-FILE-ID)
  7065*        END-EXEC
  7066*    MOVE '&*                    #   #00006681' TO DFHEIV0
  7067     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7068     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7069     MOVE X'2020233030303036363831' TO DFHEIV0(25:11)
  7070     CALL 'kxdfhei1' USING DFHEIV0,
  7071           WS-ERNOTE-FILE-ID,
  7072           DFHEIV99
  7073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7074       ELSE
  7075         PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  7076           (NOTE-SUB > +10) OR
  7077           (CN-LINE (NOTE-SUB) = SPACES OR LOW-VALUES)
  7078         END-PERFORM
  7079         IF (NOTE-SUB < +11)
  7080           IF NOTE-SUB >= CN-BILLING-START-LINE-NO AND
  7081              NOTE-SUB <= CN-BILLING-END-LINE-NO
  7082                MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  7083           ELSE
  7084             IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
  7085              (NOTE-SUB = (CN-BILLING-END-LINE-NO + +1))
  7086                MOVE WS-BILLING-NOTE   TO CN-LINE (NOTE-SUB)
  7087                MOVE NOTE-SUB     TO CN-BILLING-END-LINE-NO
  7088             ELSE
  7089               IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
  7090                  (NOTE-SUB = (CN-BILLING-START-LINE-NO - +1))
  7091                     MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  7092                     MOVE NOTE-SUB  TO CN-BILLING-START-LINE-NO
  7093               ELSE
  7094                 IF (CN-BILLING-END-LINE-NO = ZEROS)
  7095                   MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB)
  7096                   MOVE NOTE-SUB    TO CN-BILLING-END-LINE-NO
  7097                                       CN-BILLING-START-LINE-NO
  7098                 ELSE
  7099                    PERFORM 0442-SQUEEZE-IT-IN THRU 0442-EXIT
  7100                 END-IF
  7101               END-IF
  7102             END-IF
  7103           END-IF
  7104           MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  7105           MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  7106           MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  7107
  7108* EXEC CICS REWRITE
  7109*             DATASET    (WS-ERNOTE-FILE-ID)
  7110*             FROM       (CERTIFICATE-NOTE)
  7111*             RESP       (WS-RESPONSE)
  7112*          END-EXEC
  7113     MOVE LENGTH OF
  7114      CERTIFICATE-NOTE
  7115       TO DFHEIV11
  7116*    MOVE '&& L                  %  N#00006717' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 125
* EL6318.cbl
  7117     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7118     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7119     MOVE X'204E233030303036373137' TO DFHEIV0(25:11)
  7120     CALL 'kxdfhei1' USING DFHEIV0,
  7121           WS-ERNOTE-FILE-ID,
  7122           CERTIFICATE-NOTE,
  7123           DFHEIV11,
  7124           DFHEIV99
  7125     MOVE EIBRESP  TO WS-RESPONSE
  7126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7127           PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  7128         END-IF
  7129       END-IF
  7130     ELSE
  7131        MOVE SPACES              TO CERTIFICATE-NOTE
  7132        MOVE 'CN'                TO CN-RECORD-ID
  7133        MOVE PI-ERENDT-KEY (1:33) TO CN-CONTROL-PRIMARY
  7134                                     WS-ERNOTE-KEY
  7135        MOVE 01                  TO CN-BILLING-START-LINE-NO
  7136                                    CN-BILLING-END-LINE-NO
  7137        MOVE WS-BILLING-NOTE     TO CN-LINE (01)
  7138        MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  7139        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  7140        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  7141
  7142* EXEC CICS WRITE
  7143*          DATASET    (WS-ERNOTE-FILE-ID)
  7144*          FROM       (CERTIFICATE-NOTE)
  7145*          RIDFLD     (WS-ERNOTE-KEY)
  7146*          RESP       (WS-RESPONSE)
  7147*       END-EXEC
  7148     MOVE LENGTH OF
  7149      CERTIFICATE-NOTE
  7150       TO DFHEIV11
  7151*    MOVE '&$ L                  ''  N#00006736' TO DFHEIV0
  7152     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7153     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7154     MOVE X'204E233030303036373336' TO DFHEIV0(25:11)
  7155     CALL 'kxdfhei1' USING DFHEIV0,
  7156           WS-ERNOTE-FILE-ID,
  7157           CERTIFICATE-NOTE,
  7158           DFHEIV11,
  7159           WS-ERNOTE-KEY,
  7160           DFHEIV99,
  7161           DFHEIV99
  7162     MOVE EIBRESP  TO WS-RESPONSE
  7163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7164
  7165        PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  7166     END-IF
  7167
  7168     .
  7169 0441-EXIT.
  7170     EXIT.
  7171
  7172
  7173 0442-SQUEEZE-IT-IN.
  7174
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 126
* EL6318.cbl
  7175     IF NOTE-SUB < CN-BILLING-START-LINE-NO
  7176        PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
  7177           NOTE-SUB = +10
  7178           MOVE CN-LINE (NOTE-SUB + 1) TO CN-LINE (NOTE-SUB)
  7179           IF (NOTE-SUB + 1) = (CN-BILLING-START-LINE-NO - 1)
  7180             MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB + 1)
  7181             COMPUTE CN-BILLING-START-LINE-NO = NOTE-SUB + 1
  7182             MOVE +9 TO NOTE-SUB
  7183           END-IF
  7184        END-PERFORM
  7185     ELSE
  7186        IF NOTE-SUB > CN-BILLING-END-LINE-NO
  7187           PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY -1
  7188             UNTIL NOTE-SUB = +1
  7189             MOVE CN-LINE (NOTE-SUB - 1) TO CN-LINE (NOTE-SUB)
  7190             IF (NOTE-SUB - 1) = (CN-BILLING-END-LINE-NO + 1)
  7191                MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB - 1)
  7192                COMPUTE CN-BILLING-END-LINE-NO = NOTE-SUB - 1
  7193                MOVE +2          TO NOTE-SUB
  7194             END-IF
  7195           END-PERFORM
  7196        END-IF
  7197     END-IF
  7198
  7199     .
  7200 0442-EXIT.
  7201     EXIT.
  7202
  7203 0445-CERTIFICATE-UPDATE.
  7204    display 'billing note written, updating cert'
  7205     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  7206     IF RESP-NORMAL
  7207        EVALUATE CM-NOTE-SW
  7208           WHEN '2'
  7209           WHEN '3'
  7210           WHEN '6'
  7211           WHEN '7'
  7212              SET NO-CERT-RW     TO TRUE
  7213           WHEN ' '
  7214              MOVE '2'           TO CM-NOTE-SW
  7215           WHEN '1'
  7216              MOVE '3'           TO CM-NOTE-SW
  7217           WHEN '4'
  7218              MOVE '6'           TO CM-NOTE-SW
  7219           WHEN '5'
  7220              MOVE '7'           TO CM-NOTE-SW
  7221        END-EVALUATE
  7222     END-IF
  7223     IF NOT NO-CERT-RW
  7224        PERFORM 1810-REWRITE-ELCERT
  7225                                 THRU 1810-EXIT
  7226     ELSE
  7227
  7228* EXEC CICS UNLOCK
  7229*          DATASET    (WS-ELCERT-FILE-ID)
  7230*       END-EXEC
  7231*    MOVE '&*                    #   #00006805' TO DFHEIV0
  7232     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 127
* EL6318.cbl
  7233     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7234     MOVE X'2020233030303036383035' TO DFHEIV0(25:11)
  7235     CALL 'kxdfhei1' USING DFHEIV0,
  7236           WS-ELCERT-FILE-ID,
  7237           DFHEIV99
  7238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7239     END-IF
  7240
  7241     .
  7242 0445-EXIT.
  7243     EXIT.
  7244
  7245 0450-GET-ERACCT.
  7246     MOVE ' '                    TO WS-ERACCT-SW
  7247     MOVE ZEROS                  TO WS-CHGBACK
  7248                                    WS-CSO-PORTION
  7249                                    WS-ACCT-PORTION
  7250                                    WS-DIFF
  7251     PERFORM 0460-STARTBR-ERACCT THRU 0460-EXIT
  7252     IF RESP-NORMAL
  7253        PERFORM 0470-READNEXT-ERACCT
  7254                                 THRU 0470-EXIT
  7255     END-IF
  7256     IF RESP-NORMAL
  7257        IF AM-CONTROL-PRIMARY (1:20) = EN-CONTROL-PRIMARY (1:20)
  7258           IF EN-CERT-EFF-DT < AM-EXPIRATION-DT
  7259              AND >= AM-EFFECTIVE-DT
  7260              SET ACCT-FOUND TO TRUE
  7261           ELSE
  7262              PERFORM 0470-READNEXT-ERACCT
  7263                                 THRU 0470-EXIT
  7264              IF RESP-NORMAL
  7265                 IF AM-CONTROL-PRIMARY (1:20)
  7266                    = EN-CONTROL-PRIMARY (1:20)
  7267                    IF EN-CERT-EFF-DT < AM-EXPIRATION-DT
  7268                       AND >= AM-EFFECTIVE-DT
  7269                       SET ACCT-FOUND TO TRUE
  7270                    END-IF
  7271                 END-IF
  7272              END-IF
  7273           END-IF
  7274        END-IF
  7275     END-IF
  7276     IF ACCT-FOUND
  7277        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  7278           (AM-COM-TYP (S1) = 'C' OR 'D')
  7279           OR (S1 > +10)
  7280        END-PERFORM
  7281        IF S1 < +11
  7282           MOVE AM-COMM-CHARGEBACK (S1)
  7283                                 TO WS-CHGBACK
  7284        END-IF
  7285     END-IF
  7286    .
  7287 0450-EXIT.
  7288     EXIT.
  7289 0460-STARTBR-ERACCT.
  7290     MOVE LOW-VALUES             TO WS-ERACCT-KEY
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 128
* EL6318.cbl
  7291     MOVE EN-CONTROL-PRIMARY     TO WS-ERACCT-KEY (1:22)
  7292     MOVE WS-ERACCT-KEY          TO WS-SAVE-ERACCT-KEY
  7293
  7294* EXEC CICS STARTBR
  7295*        DATASET   ('ERACCT')
  7296*        RIDFLD    (WS-ERACCT-KEY)
  7297*        GTEQ
  7298*        RESP      (WS-RESPONSE)
  7299*    END-EXEC
  7300     MOVE 'ERACCT' TO DFHEIV1
  7301     MOVE 0
  7302       TO DFHEIV11
  7303*    MOVE '&,         G          &  N#00006862' TO DFHEIV0
  7304     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7305     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7306     MOVE X'204E233030303036383632' TO DFHEIV0(25:11)
  7307     CALL 'kxdfhei1' USING DFHEIV0,
  7308           DFHEIV1,
  7309           WS-ERACCT-KEY,
  7310           DFHEIV99,
  7311           DFHEIV11,
  7312           DFHEIV99
  7313     MOVE EIBRESP  TO WS-RESPONSE
  7314     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7315     .
  7316 0460-EXIT.
  7317     EXIT.
  7318 0470-READNEXT-ERACCT.
  7319
  7320* EXEC CICS READNEXT
  7321*       INTO    (ACCOUNT-MASTER)
  7322*       DATASET ('ERACCT')
  7323*       RIDFLD  (WS-ERACCT-KEY)
  7324*       RESP    (WS-RESPONSE)
  7325*    END-EXEC
  7326     MOVE LENGTH OF
  7327      ACCOUNT-MASTER
  7328       TO DFHEIV12
  7329     MOVE 'ERACCT' TO DFHEIV1
  7330     MOVE 0
  7331       TO DFHEIV11
  7332*    MOVE '&.IL                  )  N#00006872' TO DFHEIV0
  7333     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  7334     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7335     MOVE X'204E233030303036383732' TO DFHEIV0(25:11)
  7336     CALL 'kxdfhei1' USING DFHEIV0,
  7337           DFHEIV1,
  7338           ACCOUNT-MASTER,
  7339           DFHEIV12,
  7340           WS-ERACCT-KEY,
  7341           DFHEIV99,
  7342           DFHEIV11,
  7343           DFHEIV99,
  7344           DFHEIV99
  7345     MOVE EIBRESP  TO WS-RESPONSE
  7346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7347     .
  7348 0470-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 129
* EL6318.cbl
  7349     EXIT.
  7350 0500-CREATE-TEMP-STORAGE.
  7351     display ' about to write pi ' program-interface-block
  7352
  7353* EXEC CICS WRITEQ TS
  7354*        QUEUE (QID)
  7355*        FROM  (PROGRAM-INTERFACE-BLOCK)
  7356*        LENGTH(PI-COMM-LENGTH)
  7357*    END-EXEC
  7358*    MOVE '*"                    ''   #00006883' TO DFHEIV0
  7359     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7360     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7361     MOVE X'2020233030303036383833' TO DFHEIV0(25:11)
  7362     CALL 'kxdfhei1' USING DFHEIV0,
  7363           QID,
  7364           PROGRAM-INTERFACE-BLOCK,
  7365           PI-COMM-LENGTH,
  7366           DFHEIV99,
  7367           DFHEIV99,
  7368           DFHEIV99
  7369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7370     display ' about to write map ' el631ki
  7371
  7372* EXEC CICS WRITEQ TS
  7373*        QUEUE (QID)
  7374*        FROM  (EL631KI)
  7375*        LENGTH(MAP-LENGTH)
  7376*    END-EXEC.
  7377*    MOVE '*"                    ''   #00006889' TO DFHEIV0
  7378     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7379     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7380     MOVE X'2020233030303036383839' TO DFHEIV0(25:11)
  7381     CALL 'kxdfhei1' USING DFHEIV0,
  7382           QID,
  7383           EL631KI,
  7384           MAP-LENGTH,
  7385           DFHEIV99,
  7386           DFHEIV99,
  7387           DFHEIV99
  7388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7389
  7390 0500-EXIT.
  7391      EXIT.
  7392 0600-RECOVER-TEMP-STORAGE.
  7393     display ' about to recover pi '
  7394
  7395* EXEC CICS READQ TS
  7396*        QUEUE (QID)
  7397*        INTO  (PROGRAM-INTERFACE-BLOCK)
  7398*        LENGTH(PI-COMM-LENGTH)
  7399*    END-EXEC
  7400*    MOVE '*$I    L              ''   #00006898' TO DFHEIV0
  7401     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7402     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7403     MOVE X'2020233030303036383938' TO DFHEIV0(25:11)
  7404     CALL 'kxdfhei1' USING DFHEIV0,
  7405           QID,
  7406           PROGRAM-INTERFACE-BLOCK,
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 130
* EL6318.cbl
  7407           PI-COMM-LENGTH,
  7408           DFHEIV99,
  7409           DFHEIV99,
  7410           DFHEIV99
  7411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7412     display ' pi ' pi-program-work-area
  7413     display ' about to recover map '
  7414
  7415* EXEC CICS READQ TS
  7416*        QUEUE (QID)
  7417*        INTO  (EL631KI)
  7418*        LENGTH(MAP-LENGTH)
  7419*    END-EXEC
  7420*    MOVE '*$I    L              ''   #00006905' TO DFHEIV0
  7421     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7422     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7423     MOVE X'2020233030303036393035' TO DFHEIV0(25:11)
  7424     CALL 'kxdfhei1' USING DFHEIV0,
  7425           QID,
  7426           EL631KI,
  7427           MAP-LENGTH,
  7428           DFHEIV99,
  7429           DFHEIV99,
  7430           DFHEIV99
  7431     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7432     display ' map ' el631ki
  7433     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  7434     MOVE AL-UANON            TO SIGREQA
  7435     MOVE AL-UANON            TO LTRIDA
  7436     MOVE AL-UANON            TO VOUCHA
  7437     MOVE AL-UANON            TO HLTHAPPA
  7438     MOVE AL-UANON            TO PAYEEA
  7439     IF WS-SET-CODES-MDT = 'Y'
  7440        move +1                  to s2
  7441        perform varying s1 from +1 by +5 until s1 > +60
  7442           MOVE WS-PASSED-REASON-CODES (s1:4)
  7443                                 TO reacd-in (s2)
  7444           IF REACD-IN (S2) NOT EQUAL SPACES AND LOW-VALUES
  7445               MOVE AL-SANON     TO REACDA (S2)
  7446               MOVE +4           TO REACDL (S2)
  7447           END-IF
  7448           add +1                to s2
  7449        end-perform
  7450        MOVE REASONCDS       TO PI-REASONS-ENTERED
  7451     END-IF
  7452     IF CERTIDI > SPACES
  7453         MOVE AL-UANON       TO CERTIDA
  7454     END-IF
  7455
  7456     IF CRTNT1I > SPACES
  7457         MOVE AL-UANON       TO CRTNT1A
  7458     END-IF
  7459
  7460     IF CRTNT2I > SPACES
  7461         MOVE AL-UANON       TO CRTNT2A
  7462     END-IF
  7463
  7464     IF CRTNT3I > SPACES
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 131
* EL6318.cbl
  7465         MOVE AL-UANON       TO CRTNT3A
  7466     END-IF
  7467
  7468     IF CRTNT4I > SPACES
  7469         MOVE AL-UANON       TO CRTNT4A
  7470     END-IF
  7471
  7472     IF BILNT1I > SPACES
  7473         MOVE AL-UANON       TO BILNT1A
  7474     END-IF
  7475
  7476     IF BILNT2I > SPACES
  7477         MOVE AL-UANON       TO BILNT2A
  7478     END-IF
  7479     .
  7480 0600-EXIT.
  7481      EXIT.
  7482 0800-DELETE-TS.
  7483
  7484* EXEC CICS DELETEQ TS
  7485*        QUEUE(QID)
  7486*    END-EXEC
  7487*    MOVE '*&                    #   #00006961' TO DFHEIV0
  7488     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7489     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7490     MOVE X'2020233030303036393631' TO DFHEIV0(25:11)
  7491     CALL 'kxdfhei1' USING DFHEIV0,
  7492           QID,
  7493           DFHEIV99
  7494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7495     .
  7496 0800-EXIT.
  7497      EXIT.
  7498 1000-BUILD-ERARCH.
  7499     display ' made it to 1000 '
  7500     MOVE SPACES                 TO W-CNTL-KEY
  7501     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID
  7502     MOVE '1'                    TO W-CNTL-RECORD-TYPE
  7503     MOVE ZEROS                  TO W-CNTL-SEQ-NO
  7504
  7505* EXEC CICS READ
  7506*         DATASET    (WS-ELCNTL-FILE-ID)
  7507*         SET        (ADDRESS OF CONTROL-FILE)
  7508*         RIDFLD     (W-CNTL-KEY)
  7509*         UPDATE
  7510*         RESP       (WS-RESPONSE)
  7511*    END-EXEC
  7512*    MOVE '&"S        EU         (  N#00006973' TO DFHEIV0
  7513     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7514     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7515     MOVE X'204E233030303036393733' TO DFHEIV0(25:11)
  7516     CALL 'kxdfhei1' USING DFHEIV0,
  7517           WS-ELCNTL-FILE-ID,
  7518           DFHEIV20,
  7519           DFHEIV99,
  7520           W-CNTL-KEY,
  7521           DFHEIV99,
  7522           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 132
* EL6318.cbl
  7523           DFHEIV99
  7524     SET ADDRESS OF CONTROL-FILE TO
  7525         DFHEIV20
  7526     MOVE EIBRESP  TO WS-RESPONSE
  7527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7528     IF RESP-NORMAL
  7529        display ' good read elcntl '
  7530        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
  7531           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  7532        END-IF
  7533        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
  7534        MOVE CF-CREDIT-LAST-ARCH-NUM
  7535                                 TO W-ARCH-NUMBER
  7536
  7537* EXEC CICS REWRITE
  7538*          FROM      (CONTROL-FILE)
  7539*          DATASET   (WS-ELCNTL-FILE-ID)
  7540*       END-EXEC
  7541     MOVE LENGTH OF
  7542      CONTROL-FILE
  7543       TO DFHEIV11
  7544*    MOVE '&& L                  %   #00006988' TO DFHEIV0
  7545     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7546     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7547     MOVE X'2020233030303036393838' TO DFHEIV0(25:11)
  7548     CALL 'kxdfhei1' USING DFHEIV0,
  7549           WS-ELCNTL-FILE-ID,
  7550           CONTROL-FILE,
  7551           DFHEIV11,
  7552           DFHEIV99
  7553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7554     END-IF
  7555
  7556* EXEC CICS GETMAIN
  7557*       SET      (ADDRESS OF LETTER-ARCHIVE)
  7558*       LENGTH   (W-ARCH-LENGTH)
  7559*    END-EXEC
  7560*    MOVE '," L                  $   #00006993' TO DFHEIV0
  7561     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  7562     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7563     MOVE X'2020233030303036393933' TO DFHEIV0(25:11)
  7564     CALL 'kxdfhei1' USING DFHEIV0,
  7565           DFHEIV20,
  7566           W-ARCH-LENGTH,
  7567           DFHEIV99
  7568     SET ADDRESS OF LETTER-ARCHIVE TO
  7569         DFHEIV20
  7570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7571     MOVE 'LA'                   TO LETTER-ARCHIVE
  7572     MOVE W-ARCH-NUMBER          TO LA-ARCHIVE-NO
  7573                                    LA-ARCHIVE-NO-A2
  7574                                    LA-ARCHIVE-NO-A3
  7575                                    LA-ARCHIVE-NO-A4
  7576                                    LA-ARCHIVE-NO-A5
  7577                                    LA-ARCHIVE-NO-A6
  7578     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
  7579                                    LA-COMPANY-CD-A2
  7580                                    LA-COMPANY-CD-A3
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 133
* EL6318.cbl
  7581                                    LA-COMPANY-CD-A4
  7582                                    LA-COMPANY-CD-A5
  7583                                    LA-COMPANY-CD-A6
  7584     MOVE PB-CARRIER             TO LA-CARRIER-A2
  7585                                    LA-CARRIER-A3
  7586                                    LA-CARRIER-A4
  7587                                    LA-CARRIER-A5
  7588     MOVE Pb-cert-eff-dt         TO LA-EFFECT-DATE-A2
  7589     MOVE PB-GROUPING            TO LA-GROUPING-A2
  7590                                    LA-GROUPING-A3
  7591                                    LA-GROUPING-A4
  7592                                    LA-GROUPING-A5
  7593     MOVE PB-ACCOUNT             TO LA-ACCOUNT-A2
  7594                                    LA-ACCOUNT-A3
  7595                                    LA-ACCOUNT-A4
  7596                                    LA-ACCOUNT-A5
  7597     MOVE PB-STATE               TO LA-STATE-A2
  7598                                    LA-STATE-A3
  7599                                    LA-STATE-A4
  7600                                    LA-STATE-A5
  7601     MOVE PB-CERT-PRIME          TO LA-CERT-PRIME-A2
  7602     MOVE PB-CERT-SFX            TO LA-CERT-SUFFIX-A2
  7603     MOVE PB-ENTRY-BATCH         TO LA-ENTRY-A6
  7604     MOVE PI-PROCESSOR-ID        TO LA-PROCESSOR-CD
  7605     MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
  7606                                    LA-INITIAL-PRINT-DATE
  7607                                    LA-SENT-DATE
  7608                                    LA-REPLY-DATE
  7609                                    LA-RESEND-DATE
  7610                                    LA-FOLLOW-UP-DATE
  7611     MOVE 'A'                    TO LA-STATUS
  7612     MOVE W-NUMBER-OF-COPIES     TO LA-NO-OF-COPIES
  7613     MOVE W-AUTO-CLOSE-IND       TO LA-FINAL-ACT-IND
  7614     MOVE LTRIDI                 TO LA-FORM-A3
  7615     MOVE '4'                    TO LA-DATA-SOURCE
  7616     MOVE WS-CURRENT-BIN-DT      TO LA-CREATION-DATE
  7617     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES
  7618                                    LA-NO-OF-TEXT-RECORDS
  7619
  7620* EXEC CICS WRITE
  7621*         DATASET   ('ERARCH')
  7622*         FROM      (LETTER-ARCHIVE)
  7623*         RIDFLD    (LA-CONTROL-PRIMARY)
  7624*         RESP      (WS-RESPONSE)
  7625*    END-EXEC
  7626     MOVE LENGTH OF
  7627      LETTER-ARCHIVE
  7628       TO DFHEIV11
  7629     MOVE 'ERARCH' TO DFHEIV1
  7630*    MOVE '&$ L                  ''  N#00007045' TO DFHEIV0
  7631     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7632     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7633     MOVE X'204E233030303037303435' TO DFHEIV0(25:11)
  7634     CALL 'kxdfhei1' USING DFHEIV0,
  7635           DFHEIV1,
  7636           LETTER-ARCHIVE,
  7637           DFHEIV11,
  7638           LA-CONTROL-PRIMARY,
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 134
* EL6318.cbl
  7639           DFHEIV99,
  7640           DFHEIV99
  7641     MOVE EIBRESP  TO WS-RESPONSE
  7642     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7643     IF RESP-NORMAL
  7644        display ' good write erarch '
  7645        MOVE ER-0280             TO EMI-ERROR
  7646        MOVE -1                  TO SIGREQL
  7647        PERFORM 9900-ERROR-FORMAT
  7648                                 THRU 9900-EXIT
  7649        MOVE W-ARCH-NUMBER       TO W-ARCH-SUPPRESS
  7650        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  7651     ELSE
  7652        MOVE ER-7345             TO EMI-ERROR
  7653        MOVE -1                  TO SIGREQL
  7654        PERFORM 9900-ERROR-FORMAT
  7655                                 THRU 9900-EXIT
  7656     END-IF
  7657     .
  7658 1000-EXIT.
  7659     EXIT.
  7660 1100-CALL-NS-BUS-LOGIC.
  7661     DISPLAY ' MADE IT TO 1100 '
  7662     MOVE SPACES                 TO BL-INPUT
  7663     MOVE W-ARCH-NUMBER          TO BL-ARCHIVE-NO
  7664     MOVE '4'                    TO BL-DATA-SRCE
  7665     MOVE PB-CARRIER             TO BL-CARRIER
  7666     MOVE PB-GROUPING            TO BL-GROUP
  7667     MOVE PB-STATE               TO BL-STATE
  7668     MOVE PB-ACCOUNT             TO BL-ACCOUNT
  7669     IF PB-CERT-EFF-DT NOT = LOW-VALUES
  7670        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
  7671        MOVE ' '                 TO DC-OPTION-CODE
  7672        PERFORM 9700-date-link
  7673        IF NO-CONVERSION-ERROR
  7674           MOVE DC-GREG-DATE-B-EDIT
  7675                                 TO BL-EFF-DT
  7676        END-IF
  7677     END-IF
  7678     MOVE PB-CERT-NO             TO BL-CERT-NO
  7679     MOVE PB-ENTRY-BATCH         TO BL-BATCH-NO
  7680     MOVE PB-BATCH-SEQ-NO        TO BL-BATCH-SEQ
  7681     MOVE SPACES                 TO BL-RESP-NO
  7682     MOVE LTRIDI                 TO BL-LETTER-ID
  7683     MOVE W-NUMBER-OF-COPIES     TO BL-NO-OF-COPIES
  7684     MOVE PI-PROCESSOR-ID        TO BL-PROC-ID
  7685*    MOVE 'ALWA'                 TO BL-PROC-ID
  7686     MOVE PI-COMPANY-ID          TO BL-COMP-ID
  7687*    MOVE IFF-PRINT-NOW-SW       TO BL-PRINT-NOW-SW
  7688*    MOVE IFF-ENC-CD             TO BL-ENC-CD
  7689     IF EIBAID = DFHPF4
  7690        MOVE 'B'                 TO BL-WRITE-ERARCH
  7691     ELSE
  7692        MOVE 'T'                 TO BL-WRITE-ERARCH
  7693     END-IF
  7694     MOVE CERTIDI                TO BL-CERT-FORM-ID
  7695     MOVE W-ARCH-NUMBER          TO BL-ENDT-ARCH-NO
  7696     MOVE 'ISS ENDT'             TO BL-SOURCE-SCREEN
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 135
* EL6318.cbl
  7697     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  7698        IF REACD-IN (S1) NOT = LOW-VALUES
  7699           MOVE REACD-IN (S1)    TO BL-REASON-CODE (S1)
  7700        END-IF
  7701     END-PERFORM
  7702    DISPLAY ' ABOUT TO LINK TO NSRASBL '
  7703*****************************************
  7704* Invoke the LETTER business logic
  7705*****************************************
  7706
  7707* exec cics link
  7708*       program('NSRASBL')
  7709*       commarea(srch-commarea)
  7710*    end-exec.
  7711     MOVE LENGTH OF
  7712      srch-commarea
  7713       TO DFHEIV11
  7714     MOVE 'NSRASBL' TO DFHEIV1
  7715*    MOVE '."C                   (   #00007114' TO DFHEIV0
  7716     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7717     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7718     MOVE X'2020233030303037313134' TO DFHEIV0(25:11)
  7719     CALL 'kxdfhei1' USING DFHEIV0,
  7720           DFHEIV1,
  7721           srch-commarea,
  7722           DFHEIV11,
  7723           DFHEIV99,
  7724           DFHEIV99,
  7725           DFHEIV99,
  7726           DFHEIV99
  7727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7728
  7729     DISPLAY ' MADE IT BACK FROM NSRASBL ' BL-STATUS ' '
  7730        BL-MESSAGE
  7731     .
  7732 1100-EXIT.
  7733     EXIT.
  7734 1500-GET-ARCH-NO.
  7735     display ' made it to 1500 '
  7736     MOVE SPACES                 TO ELCNTL-KEY
  7737     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  7738     MOVE '1'                    TO CNTL-REC-TYPE
  7739     MOVE ZEROS                  TO CNTL-SEQ
  7740
  7741* EXEC CICS READ
  7742*         DATASET    (WS-ELCNTL-FILE-ID)
  7743*         SET        (ADDRESS OF CONTROL-FILE)
  7744*         RIDFLD     (ELCNTL-KEY)
  7745*         UPDATE
  7746*         RESP       (WS-RESPONSE)
  7747*    END-EXEC
  7748*    MOVE '&"S        EU         (  N#00007129' TO DFHEIV0
  7749     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7750     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7751     MOVE X'204E233030303037313239' TO DFHEIV0(25:11)
  7752     CALL 'kxdfhei1' USING DFHEIV0,
  7753           WS-ELCNTL-FILE-ID,
  7754           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 136
* EL6318.cbl
  7755           DFHEIV99,
  7756           ELCNTL-KEY,
  7757           DFHEIV99,
  7758           DFHEIV99,
  7759           DFHEIV99
  7760     SET ADDRESS OF CONTROL-FILE TO
  7761         DFHEIV20
  7762     MOVE EIBRESP  TO WS-RESPONSE
  7763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7764     IF RESP-NORMAL
  7765        display ' good read elcntl '
  7766        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
  7767           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  7768        END-IF
  7769        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
  7770        MOVE CF-CREDIT-LAST-ARCH-NUM
  7771                                 TO W-ARCH-NUMBER
  7772        display ' new arch number ' w-arch-number
  7773
  7774* EXEC CICS REWRITE
  7775*          FROM      (CONTROL-FILE)
  7776*          DATASET   (WS-ELCNTL-FILE-ID)
  7777*       END-EXEC
  7778     MOVE LENGTH OF
  7779      CONTROL-FILE
  7780       TO DFHEIV11
  7781*    MOVE '&& L                  %   #00007145' TO DFHEIV0
  7782     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7783     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7784     MOVE X'2020233030303037313435' TO DFHEIV0(25:11)
  7785     CALL 'kxdfhei1' USING DFHEIV0,
  7786           WS-ELCNTL-FILE-ID,
  7787           CONTROL-FILE,
  7788           DFHEIV11,
  7789           DFHEIV99
  7790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7791     END-IF
  7792     .
  7793 1500-EXIT.
  7794     EXIT.
  7795
  7796
  7797 1700-WRITE-CERT-NOTE      SECTION.
  7798
  7799     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY.
  7800     MOVE ZERO           TO ERCNOT-SEQ.
  7801     SET TB-INDX         DOWN BY 1.
  7802     SET TB-INDX1        TO TB-INDX.
  7803
  7804****DELETE CURRENT CERT NOTES
  7805 1700-LOOP.
  7806
  7807* EXEC CICS READ
  7808*        DATASET (WS-ERCNOT-FILE-ID)
  7809*        RIDFLD  (ERCNOT-KEY)
  7810*        SET     (ADDRESS OF CERT-NOTE-FILE)
  7811*        RESP    (WS-RESPONSE)
  7812*        GTEQ
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 137
* EL6318.cbl
  7813*    END-EXEC.
  7814*    MOVE '&"S        G          (  N#00007164' TO DFHEIV0
  7815     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7816     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7817     MOVE X'204E233030303037313634' TO DFHEIV0(25:11)
  7818     CALL 'kxdfhei1' USING DFHEIV0,
  7819           WS-ERCNOT-FILE-ID,
  7820           DFHEIV20,
  7821           DFHEIV99,
  7822           ERCNOT-KEY,
  7823           DFHEIV99,
  7824           DFHEIV99,
  7825           DFHEIV99
  7826     SET ADDRESS OF CERT-NOTE-FILE TO
  7827         DFHEIV20
  7828     MOVE EIBRESP  TO WS-RESPONSE
  7829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7830
  7831
  7832     IF NOT RESP-NORMAL
  7833        GO TO 1700-ENDDEL
  7834     END-IF
  7835
  7836     MOVE CZ-CONTROL-PRIMARY     TO ERCNOT-KEY.
  7837
  7838     IF ERCNOT-PARTIAL-KEY NOT = SV-PARTIAL-KEY
  7839         GO TO 1700-ENDDEL
  7840     END-IF.
  7841
  7842
  7843* EXEC CICS DELETE
  7844*        DATASET (WS-ERCNOT-FILE-ID)
  7845*        RIDFLD  (ERCNOT-KEY)
  7846*    END-EXEC.
  7847*    MOVE '&(  R                 &   #00007182' TO DFHEIV0
  7848     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  7849     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7850     MOVE X'2020233030303037313832' TO DFHEIV0(25:11)
  7851     CALL 'kxdfhei1' USING DFHEIV0,
  7852           WS-ERCNOT-FILE-ID,
  7853           ERCNOT-KEY,
  7854           DFHEIV99,
  7855           DFHEIV99,
  7856           DFHEIV99
  7857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7858
  7859
  7860     GO TO 1700-LOOP.
  7861
  7862 1700-ENDDEL.
  7863
  7864
  7865* EXEC CICS GETMAIN
  7866*         LENGTH(ERCNOT-LENGTH)
  7867*         SET(ADDRESS OF CERT-NOTE-FILE)
  7868*         INITIMG(GETMAIN-SPACE)
  7869*    END-EXEC.
  7870*    MOVE ',"IL                  $   #00007191' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 138
* EL6318.cbl
  7871     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7872     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7873     MOVE X'2020233030303037313931' TO DFHEIV0(25:11)
  7874     CALL 'kxdfhei1' USING DFHEIV0,
  7875           DFHEIV20,
  7876           ERCNOT-LENGTH,
  7877           GETMAIN-SPACE
  7878     SET ADDRESS OF CERT-NOTE-FILE TO
  7879         DFHEIV20
  7880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7881
  7882
  7883     SET TB-INDX TO 1.
  7884     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY
  7885     MOVE +0             TO ERCNOT-SEQ
  7886
  7887     PERFORM VARYING TB-INDX FROM 1 BY 1
  7888             UNTIL TB-INDX > TB-INDX1
  7889        MOVE SPACES                 TO  CERT-NOTE-FILE
  7890        ADD 1                       TO  ERCNOT-SEQ
  7891        MOVE ERCNOT-KEY             TO  CZ-CONTROL-PRIMARY
  7892        MOVE  'CZ'                  TO  CZ-RECORD-ID
  7893        MOVE CERT-NT-TEXT (TB-INDX) TO  CZ-NOTE
  7894        MOVE CERT-NT-LAST-MAINT-BY (TB-INDX)
  7895                                    TO  CZ-LAST-MAINT-USER
  7896        MOVE CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7897                                    TO  CZ-LAST-MAINT-HHMMSS
  7898        MOVE CERT-NT-LAST-MAINT-DT (TB-INDX)
  7899                                    TO  CZ-LAST-MAINT-DT
  7900
  7901
  7902* EXEC CICS WRITE
  7903*            DATASET(WS-ERCNOT-FILE-ID)
  7904*            FROM(CERT-NOTE-FILE)
  7905*            RIDFLD(ERCNOT-KEY)
  7906*       END-EXEC
  7907     MOVE LENGTH OF
  7908      CERT-NOTE-FILE
  7909       TO DFHEIV11
  7910*    MOVE '&$ L                  ''   #00007215' TO DFHEIV0
  7911     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7912     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7913     MOVE X'2020233030303037323135' TO DFHEIV0(25:11)
  7914     CALL 'kxdfhei1' USING DFHEIV0,
  7915           WS-ERCNOT-FILE-ID,
  7916           CERT-NOTE-FILE,
  7917           DFHEIV11,
  7918           ERCNOT-KEY,
  7919           DFHEIV99,
  7920           DFHEIV99
  7921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7922     END-PERFORM
  7923
  7924     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  7925     IF RESP-NORMAL
  7926        EVALUATE CM-NOTE-SW
  7927           WHEN '1'
  7928           WHEN '3'
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 139
* EL6318.cbl
  7929           WHEN '5'
  7930           WHEN '7'
  7931              SET NO-CERT-RW     TO TRUE
  7932           WHEN ' '
  7933              MOVE '1'           TO CM-NOTE-SW
  7934           WHEN '2'
  7935              MOVE '3'           TO CM-NOTE-SW
  7936           WHEN '4'
  7937              MOVE '5'           TO CM-NOTE-SW
  7938           WHEN '6'
  7939              MOVE '7'           TO CM-NOTE-SW
  7940        END-EVALUATE
  7941     END-IF
  7942     IF NOT NO-CERT-RW
  7943        PERFORM 1810-REWRITE-ELCERT
  7944                                 THRU 1810-EXIT
  7945     ELSE
  7946
  7947* EXEC CICS UNLOCK
  7948*          DATASET    (WS-ELCERT-FILE-ID)
  7949*       END-EXEC
  7950*    MOVE '&*                    #   #00007244' TO DFHEIV0
  7951     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7952     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7953     MOVE X'2020233030303037323434' TO DFHEIV0(25:11)
  7954     CALL 'kxdfhei1' USING DFHEIV0,
  7955           WS-ELCERT-FILE-ID,
  7956           DFHEIV99
  7957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7958     END-IF
  7959
  7960     .
  7961 1799-EXIT.
  7962     EXIT.
  7963
  7964 1800-READ-ELCERT-UPDATE.
  7965
  7966     MOVE PI-COMPANY-CD          TO  W-CERT-COMPANY-CD.
  7967     MOVE PI-CRTO-CARRIER        TO  W-CERT-CARRIER.
  7968     MOVE PI-CRTO-GROUPING       TO  W-CERT-GROUPING.
  7969     MOVE PI-CRTO-STATE          TO  W-CERT-STATE.
  7970     MOVE PI-CRTO-ACCOUNT        TO  W-CERT-ACCOUNT.
  7971     MOVE PI-CRTO-CERT-EFF-DT    TO  W-CERT-CERT-EFF-DT.
  7972     MOVE PI-CRTO-CERT-PRIME     TO  W-CERT-CERT-PRIME.
  7973     MOVE PI-CRTO-CERT-SFX       TO  W-CERT-CERT-SFX.
  7974
  7975
  7976* EXEC CICS READ
  7977*        UPDATE
  7978*        DATASET  (WS-ELCERT-FILE-ID)
  7979*        RIDFLD   (WS-ELCERT-KEY)
  7980*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  7981*        RESP     (WS-RESPONSE)
  7982*    END-EXEC
  7983*    MOVE '&"S        EU         (  N#00007264' TO DFHEIV0
  7984     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7985     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7986     MOVE X'204E233030303037323634' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 140
* EL6318.cbl
  7987     CALL 'kxdfhei1' USING DFHEIV0,
  7988           WS-ELCERT-FILE-ID,
  7989           DFHEIV20,
  7990           DFHEIV99,
  7991           WS-ELCERT-KEY,
  7992           DFHEIV99,
  7993           DFHEIV99,
  7994           DFHEIV99
  7995     SET ADDRESS OF CERTIFICATE-MASTER TO
  7996         DFHEIV20
  7997     MOVE EIBRESP  TO WS-RESPONSE
  7998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7999
  8000     .
  8001 1800-EXIT.
  8002     EXIT.
  8003
  8004 1810-REWRITE-ELCERT.
  8005
  8006
  8007* EXEC CICS REWRITE
  8008*        FROM     (CERTIFICATE-MASTER)
  8009*        DATASET  (WS-ELCERT-FILE-ID)
  8010*        RESP     (WS-RESPONSE)
  8011*    END-EXEC.
  8012     MOVE LENGTH OF
  8013      CERTIFICATE-MASTER
  8014       TO DFHEIV11
  8015*    MOVE '&& L                  %  N#00007278' TO DFHEIV0
  8016     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8017     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8018     MOVE X'204E233030303037323738' TO DFHEIV0(25:11)
  8019     CALL 'kxdfhei1' USING DFHEIV0,
  8020           WS-ELCERT-FILE-ID,
  8021           CERTIFICATE-MASTER,
  8022           DFHEIV11,
  8023           DFHEIV99
  8024     MOVE EIBRESP  TO WS-RESPONSE
  8025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8026
  8027
  8028     .
  8029 1810-EXIT.
  8030     EXIT.
  8031
  8032 8100-SEND-INITIAL-MAP.
  8033     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8034     MOVE '5'                    TO DC-OPTION-CODE.
  8035     PERFORM 9700-DATE-LINK.
  8036     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  8037     MOVE EIBTIME                TO TIME-IN.
  8038     MOVE TIME-OUT               TO TIMEO.
  8039     MOVE -1                     TO SIGREQL
  8040     IF PI-PROCESSOR-IS-CSR-SUPER
  8041        perform varying s1 from +1 by +1 until
  8042           s1 > +12
  8043           MOVE AL-UANON            TO reacda (s1)
  8044        end-perform
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 141
* EL6318.cbl
  8045     END-IF
  8046     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  8047     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O.
  8048
  8049* EXEC CICS SEND
  8050*        MAP      (MAP-NAME)
  8051*        MAPSET   (MAPSET-NAME)
  8052*        FROM     (EL631KO)
  8053*        ERASE
  8054*        CURSOR
  8055*    END-EXEC.
  8056     MOVE LENGTH OF
  8057      EL631KO
  8058       TO DFHEIV12
  8059     MOVE -1
  8060       TO DFHEIV11
  8061*    MOVE '8$     CT  E    H L F ,   #00007304' TO DFHEIV0
  8062     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  8063     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8064     MOVE X'2020233030303037333034' TO DFHEIV0(25:11)
  8065     CALL 'kxdfhei1' USING DFHEIV0,
  8066           MAP-NAME,
  8067           EL631KO,
  8068           DFHEIV12,
  8069           MAPSET-NAME,
  8070           DFHEIV99,
  8071           DFHEIV99,
  8072           DFHEIV99,
  8073           DFHEIV11,
  8074           DFHEIV99,
  8075           DFHEIV99,
  8076           DFHEIV99
  8077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8078
  8079     GO TO 9100-RETURN-TRAN.
  8080 8200-SEND-DATAONLY.
  8081     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8082     MOVE '5'                    TO DC-OPTION-CODE.
  8083     PERFORM 9700-DATE-LINK.
  8084     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  8085     MOVE EIBTIME                TO TIME-IN.
  8086     MOVE TIME-OUT               TO TIMEO.
  8087     MOVE -1                     TO PFENTRL
  8088     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O
  8089     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O
  8090
  8091* EXEC CICS SEND
  8092*        MAP      (MAP-NAME)
  8093*        MAPSET   (MAPSET-NAME)
  8094*        FROM     (EL631KO)
  8095*        DATAONLY
  8096*        ERASEAUP
  8097*        CURSOR
  8098*    END-EXEC.
  8099     MOVE LENGTH OF
  8100      EL631KO
  8101       TO DFHEIV12
  8102     MOVE -1
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 142
* EL6318.cbl
  8103       TO DFHEIV11
  8104*    MOVE '8$D    CT  A    H L F ,   #00007322' TO DFHEIV0
  8105     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  8106     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8107     MOVE X'2020233030303037333232' TO DFHEIV0(25:11)
  8108     CALL 'kxdfhei1' USING DFHEIV0,
  8109           MAP-NAME,
  8110           EL631KO,
  8111           DFHEIV12,
  8112           MAPSET-NAME,
  8113           DFHEIV99,
  8114           DFHEIV99,
  8115           DFHEIV99,
  8116           DFHEIV11,
  8117           DFHEIV99,
  8118           DFHEIV99,
  8119           DFHEIV99
  8120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8121
  8122     GO TO 9100-RETURN-TRAN.
  8123 8300-SEND-TEXT.
  8124
  8125* EXEC CICS SEND TEXT
  8126*        FROM     (LOGOFF-TEXT)
  8127*        LENGTH   (LOGOFF-LENGTH)
  8128*        ERASE
  8129*        FREEKB
  8130*    END-EXEC.
  8131*    MOVE '8&      T  E F  H   F -   #00007332' TO DFHEIV0
  8132     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  8133     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  8134     MOVE X'2020233030303037333332' TO DFHEIV0(25:11)
  8135     CALL 'kxdfhei1' USING DFHEIV0,
  8136           LOGOFF-TEXT,
  8137           LOGOFF-LENGTH,
  8138           DFHEIV99,
  8139           DFHEIV99,
  8140           DFHEIV99,
  8141           DFHEIV99,
  8142           DFHEIV99,
  8143           DFHEIV99,
  8144           DFHEIV99,
  8145           DFHEIV99,
  8146           DFHEIV99,
  8147           DFHEIV99
  8148     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8149
  8150
  8151* EXEC CICS RETURN
  8152*    END-EXEC.
  8153*    MOVE '.(                    ''   #00007338' TO DFHEIV0
  8154     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8155     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8156     MOVE X'2020233030303037333338' TO DFHEIV0(25:11)
  8157     CALL 'kxdfhei1' USING DFHEIV0,
  8158           DFHEIV99,
  8159           DFHEIV99,
  8160           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 143
* EL6318.cbl
  8161           DFHEIV99,
  8162           DFHEIV99,
  8163           DFHEIV99
  8164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8165
  8166 8800-UNAUTHORIZED-ACCESS.
  8167     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  8168     GO TO 8300-SEND-TEXT.
  8169 8810-PF23.
  8170     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  8171     MOVE XCTL-005               TO PGM-NAME.
  8172     GO TO 9300-XCTL.
  8173 9000-RETURN-CICS.
  8174
  8175* EXEC CICS RETURN
  8176*    END-EXEC.
  8177*    MOVE '.(                    ''   #00007348' TO DFHEIV0
  8178     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8179     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8180     MOVE X'2020233030303037333438' TO DFHEIV0(25:11)
  8181     CALL 'kxdfhei1' USING DFHEIV0,
  8182           DFHEIV99,
  8183           DFHEIV99,
  8184           DFHEIV99,
  8185           DFHEIV99,
  8186           DFHEIV99,
  8187           DFHEIV99
  8188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8189
  8190 9100-RETURN-TRAN.
  8191     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  8192     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
  8193
  8194* EXEC CICS RETURN
  8195*        TRANSID    (TRANS-ID)
  8196*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8197*        LENGTH     (PI-COMM-LENGTH)
  8198*    END-EXEC.
  8199*    MOVE '.(CT                  ''   #00007353' TO DFHEIV0
  8200     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  8201     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8202     MOVE X'2020233030303037333533' TO DFHEIV0(25:11)
  8203     CALL 'kxdfhei1' USING DFHEIV0,
  8204           TRANS-ID,
  8205           PROGRAM-INTERFACE-BLOCK,
  8206           PI-COMM-LENGTH,
  8207           DFHEIV99,
  8208           DFHEIV99,
  8209           DFHEIV99
  8210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8211
  8212 9200-RETURN-MAIN-MENU.
  8213     MOVE XCTL-626               TO PGM-NAME.
  8214     GO TO 9300-XCTL.
  8215 9300-XCTL.
  8216
  8217* EXEC CICS XCTL
  8218*        PROGRAM    (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 144
* EL6318.cbl
  8219*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8220*        LENGTH     (PI-COMM-LENGTH)
  8221*    END-EXEC.
  8222*    MOVE '.$C                   %   #00007362' TO DFHEIV0
  8223     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8224     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8225     MOVE X'2020233030303037333632' TO DFHEIV0(25:11)
  8226     CALL 'kxdfhei1' USING DFHEIV0,
  8227           PGM-NAME,
  8228           PROGRAM-INTERFACE-BLOCK,
  8229           PI-COMM-LENGTH,
  8230           DFHEIV99
  8231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8232
  8233 9400-CLEAR.
  8234     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  8235
  8236* EXEC CICS XCTL
  8237*        PROGRAM    (PGM-NAME)
  8238*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8239*        LENGTH     (PI-COMM-LENGTH)
  8240*    END-EXEC.
  8241*    MOVE '.$C                   %   #00007369' TO DFHEIV0
  8242     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8243     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8244     MOVE X'2020233030303037333639' TO DFHEIV0(25:11)
  8245     CALL 'kxdfhei1' USING DFHEIV0,
  8246           PGM-NAME,
  8247           PROGRAM-INTERFACE-BLOCK,
  8248           PI-COMM-LENGTH,
  8249           DFHEIV99
  8250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8251
  8252 9500-PF12.
  8253     MOVE XCTL-010               TO PGM-NAME.
  8254     GO TO 9300-XCTL.
  8255 9600-PGMID-ERROR.
  8256
  8257* EXEC CICS HANDLE CONDITION
  8258*        PGMIDERR    (8300-SEND-TEXT)
  8259*    END-EXEC.
  8260*    MOVE '"$L                   ! " #00007378' TO DFHEIV0
  8261     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  8262     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8263     MOVE X'2220233030303037333738' TO DFHEIV0(25:11)
  8264     CALL 'kxdfhei1' USING DFHEIV0
  8265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8266
  8267     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  8268     MOVE ' '                    TO PI-ENTRY-CD-1.
  8269     MOVE XCTL-005               TO PGM-NAME.
  8270     MOVE PGM-NAME               TO LOGOFF-PGM.
  8271     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  8272     GO TO 9300-XCTL.
  8273 9700-DATE-LINK.
  8274     MOVE LINK-ELDATCV           TO PGM-NAME.
  8275
  8276* EXEC CICS LINK
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 145
* EL6318.cbl
  8277*        PROGRAM    (PGM-NAME)
  8278*        COMMAREA   (DATE-CONVERSION-DATA)
  8279*        LENGTH     (DC-COMM-LENGTH)
  8280*    END-EXEC.
  8281*    MOVE '."C                   (   #00007389' TO DFHEIV0
  8282     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8283     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8284     MOVE X'2020233030303037333839' TO DFHEIV0(25:11)
  8285     CALL 'kxdfhei1' USING DFHEIV0,
  8286           PGM-NAME,
  8287           DATE-CONVERSION-DATA,
  8288           DC-COMM-LENGTH,
  8289           DFHEIV99,
  8290           DFHEIV99,
  8291           DFHEIV99,
  8292           DFHEIV99
  8293     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8294
  8295 9900-ERROR-FORMAT.
  8296     IF NOT EMI-ERRORS-COMPLETE
  8297        MOVE LINK-001            TO PGM-NAME
  8298
  8299* EXEC CICS LINK
  8300*           PROGRAM    (PGM-NAME)
  8301*           COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  8302*           LENGTH     (EMI-COMM-LENGTH)
  8303*       END-EXEC
  8304*    MOVE '."C                   (   #00007397' TO DFHEIV0
  8305     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8306     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8307     MOVE X'2020233030303037333937' TO DFHEIV0(25:11)
  8308     CALL 'kxdfhei1' USING DFHEIV0,
  8309           PGM-NAME,
  8310           ERROR-MESSAGE-INTERFACE-BLOCK,
  8311           EMI-COMM-LENGTH,
  8312           DFHEIV99,
  8313           DFHEIV99,
  8314           DFHEIV99,
  8315           DFHEIV99
  8316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8317     END-IF
  8318     .
  8319 9900-EXIT.
  8320     EXIT.
  8321 9990-ABEND.
  8322     MOVE LINK-004               TO PGM-NAME.
  8323     MOVE DFHEIBLK               TO EMI-LINE1.
  8324
  8325* EXEC CICS LINK
  8326*        PROGRAM   (PGM-NAME)
  8327*        COMMAREA  (EMI-LINE1)
  8328*        LENGTH    (72)
  8329*    END-EXEC.
  8330     MOVE 72
  8331       TO DFHEIV11
  8332*    MOVE '."C                   (   #00007409' TO DFHEIV0
  8333     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8334     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 146
* EL6318.cbl
  8335     MOVE X'2020233030303037343039' TO DFHEIV0(25:11)
  8336     CALL 'kxdfhei1' USING DFHEIV0,
  8337           PGM-NAME,
  8338           EMI-LINE1,
  8339           DFHEIV11,
  8340           DFHEIV99,
  8341           DFHEIV99,
  8342           DFHEIV99,
  8343           DFHEIV99
  8344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8345
  8346     GO TO 8200-SEND-DATAONLY.
  8347
  8348* GOBACK.
  8349     MOVE '9%                    "   ' TO DFHEIV0
  8350     MOVE 'EL6318' TO DFHEIV1
  8351     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8352     GOBACK.
  8353 9995-SECURITY-VIOLATION.
  8354*                            COPY ELCSCTP.
  8355******************************************************************
  8356*                                                                *
  8357*                            ELCSCTP                             *
  8358*                            VMOD=2.001                          *
  8359*                                                                *
  8360*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  8361******************************************************************
  8362
  8363
  8364     MOVE EIBDATE          TO SM-JUL-DATE.
  8365     MOVE EIBTRMID         TO SM-TERMID.
  8366     MOVE THIS-PGM         TO SM-PGM.
  8367     MOVE EIBTIME          TO TIME-IN.
  8368     MOVE TIME-OUT         TO SM-TIME.
  8369     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  8370
  8371
  8372* EXEC CICS LINK
  8373*         PROGRAM  ('EL003')
  8374*         COMMAREA (SECURITY-MESSAGE)
  8375*         LENGTH   (80)
  8376*    END-EXEC.
  8377     MOVE 'EL003' TO DFHEIV1
  8378     MOVE 80
  8379       TO DFHEIV11
  8380*    MOVE '."C                   (   #00007434' TO DFHEIV0
  8381     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8382     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8383     MOVE X'2020233030303037343334' TO DFHEIV0(25:11)
  8384     CALL 'kxdfhei1' USING DFHEIV0,
  8385           DFHEIV1,
  8386           SECURITY-MESSAGE,
  8387           DFHEIV11,
  8388           DFHEIV99,
  8389           DFHEIV99,
  8390           DFHEIV99,
  8391           DFHEIV99
  8392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 27-Dec-12 08:04 Page 147
* EL6318.cbl
  8393
  8394
  8395******************************************************************
  8396
  8397 9995-EXIT.
  8398     EXIT.
  8399
  8400 9999-DFHBACK SECTION.
  8401     MOVE '9%                    "   ' TO DFHEIV0
  8402     MOVE 'EL6318' TO DFHEIV1
  8403     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8404     GOBACK.
  8405 9999-DFHEXIT.
  8406     IF DFHEIGDJ EQUAL 0001
  8407         NEXT SENTENCE
  8408     ELSE IF DFHEIGDJ EQUAL 2
  8409         GO TO 8300-SEND-TEXT
  8410         DEPENDING ON DFHEIGDI.
  8411     MOVE '9%                    "   ' TO DFHEIV0
  8412     MOVE 'EL6318' TO DFHEIV1
  8413     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8414     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       34756     Code:       19218
