* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page   1
* EL6318.cbl
* Options: int("EL6318.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6318.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6318.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6318.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                 EL6318.
     3*
     4*AUTHOR.        PABLO
     5*               OMAHA, NEBRASKA
     6*DATE-COMPILED.
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CNETRAL STATES  *
    10*            *   HEALTH AND LIFE                                 *
    11*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    12*            *   OF CSO.        IS EXPRESSLY PROHIBITED WITHOUT  *
    13*            *   THE PRIOR WRITTEN PERMISSION OF CENTRAL STATES. *
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page   2
* EL6318.cbl
    14*            *                                                   *
    15*            *****************************************************
    16*-----------------------------------------------------------------
    17*                   C H A N G E   L O G
    18*
    19* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    20*-----------------------------------------------------------------
    21*  CHANGE  CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    22* EFFECTIVE    NUMBER
    23*-----------------------------------------------------------------
    24*          2011022800001  PEMA  NEW PROGRAM
    25* 012412   2011022800001  AJRA  NAPERSOFT
    26* 060612   2011022800001  AJRA  NAPERSOFT
    27* 062712   2011022800001  AJRA  REDEFINE ORIG DATA
    28* 072312   2011022800001  AJRA  NAPERSOFT MISC
    29* 102212   2012101700002  AJRA  SCREEN ID
    30* 103012   2012101700002  AJRA  ADD CERT NOTES TO TOP OF LIST
    31* 110612   2012101700002  AJRA  ADD NEW FIELDS
    32* 112612   2012101700002  AJRA  CHECK FOR PROMPT LETTER
    33* 121012   2012101700002  AJRA  HIGHLIGHT REASON CODES
    34* 121112   2012101700002  AJRA  CHANGE PF1, PF2 TO PF3, PF4
    35* 121212   2012101700002  AJRA  CHG LAST 2 CERT NOTES TO BILLING N
    36* 121712   2012101700002  AJRA  ADD DEFAULT AGE FLAG
    37* 122712   2012122700001  AJRA  FIX CERT PRINT FLAG
    38* 011413 IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    39* 091913   2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
    40* 120313   2013090300001  AJRA  NAPERSOFT PHASE 2
    41* 121713   2013090300001  AJRA  ADD ENCLOSURE CODE TO SCREEN
    42*-----------------------------------------------------------------
    43*REMARKS.
    44*        TRANSACTION - EXBE - GENERAL CHANGE ENDORSEMENT
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page   3
* EL6318.cbl
    46 ENVIRONMENT DIVISION.
    47 DATA DIVISION.
    48 WORKING-STORAGE SECTION.
    49 01  DFH-START PIC X(04).
    50 77  FILLER  PIC X(32)  VALUE '********************************'.
    51 77  FILLER  PIC X(32)  VALUE '*    EL6318 WORKING STORAGE    *'.
    52 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.001 ************'.
    53 77  NOTE-SUB PIC S9(5) COMP-3 VALUE +0.
    54 77  WS-SEQ-NO                   PIC 9(4) BINARY.
    55 77  WS-SET-CODES-MDT            PIC X  VALUE SPACES.
    56 77  s1                          pic s999 comp-3 value +0.
    57 77  s2                          pic s999 comp-3 value +0.
    58 77  W-ARCH-NUMBER               PIC S9(08)      COMP value +0.
    59 77  WS-ERACCT-SW                PIC X  VALUE ' '.
    60     88  ACCT-FOUND                 VALUE 'Y'.
    61 77  WS-CHGBACK                 PIC 99  VALUE ZEROS.
    62 77  WS-CSO-PORTION              PIC S9(5)V99 COMP-3 VALUE +0.
    63 77  WS-ACCT-PORTION             PIC S9(5)V99 COMP-3 VALUE +0.
    64 77  WS-DIFF                     PIC 99 VALUE ZEROS.
    65 77  WS-SAVE-ERACCT-KEY          PIC X(20)  VALUE SPACES.
    66 77  WS-DUE-BORROWER             PIC S9(7)V99 COMP-3 VALUE +0.
    67 77  WS-REASON-SW                PIC X  VALUE ' '.
    68     88  REASONS-FOUND                  VALUE 'Y'.
    69     88  REASONS-NOT-FOUND              VALUE 'N'.
    70 77  WS-CERT-UPDATE-SW           PIC X  VALUE ' '.
    71     88  NO-CERT-RW                 VALUE 'N'.
    72     88  CERT-RW                    VALUE 'Y'.
    73 01  P pointer.
    74 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    75 01  KIXHOST             pic x(9) value Z"HOSTNAME".
    76 01  var-ptr pointer.
    77 01  env-var-len                 pic 9(4)  binary.
    78 01  rc                          pic 9(9)  binary.
    79 01  WS-KIXHOST                  PIC X(10).
    80 01  WS-KIXSYS.
    81     05  WS-KIX-FIL1             PIC X(10).
    82     05  WS-KIX-APPS             PIC X(10).
    83     05  WS-KIX-ENV              PIC X(10).
    84     05  WS-KIX-MYENV            PIC X(10).
    85     05  WS-KIX-SYS              PIC X(10).
    86*                                COPY ELCSCTM.
    87******************************************************************
    88*                                                                *
    89*                                                                *
    90*                            ELCSCTM                             *
    91*                            VMOD=2.001                          *
    92*                                                                *
    93*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    94*                                                                *
    95******************************************************************
    96 01  SECURITY-MESSAGE.
    97     12  FILLER                          PIC X(30)
    98            VALUE '** LOGIC SECURITY VIOLATION -'.
    99     12  SM-READ                         PIC X(6).
   100     12  FILLER                          PIC X(5)
   101            VALUE ' PGM='.
   102     12  SM-PGM                          PIC X(6).
   103     12  FILLER                          PIC X(5)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page   4
* EL6318.cbl
   104            VALUE ' OPR='.
   105     12  SM-PROCESSOR-ID                 PIC X(4).
   106     12  FILLER                          PIC X(6)
   107            VALUE ' TERM='.
   108     12  SM-TERMID                       PIC X(4).
   109     12  FILLER                          PIC XX   VALUE SPACE.
   110     12  SM-JUL-DATE                     PIC 9(5).
   111     12  FILLER                          PIC X    VALUE SPACE.
   112     12  SM-TIME                         PIC 99.99.
   113
   114*                                COPY ELCSCRTY.
   115******************************************************************
   116*                                                                *
   117*                                                                *
   118*                            ELCSCRTY                            *
   119*                            VMOD=2.001                          *
   120*                                                                *
   121*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   122*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   123*        SAVED IN PI-SECURITY-ADDRESS.                           *
   124*                                                                *
   125******************************************************************
   126 01  SECURITY-CONTROL.
   127     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   128     12  FILLER                       PIC XX    VALUE 'SC'.
   129     12  SC-CREDIT-CODES.
   130         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   131             20  SC-CREDIT-DISPLAY    PIC X.
   132             20  SC-CREDIT-UPDATE     PIC X.
   133     12  SC-CLAIMS-CODES.
   134         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   135             20  SC-CLAIMS-DISPLAY    PIC X.
   136             20  SC-CLAIMS-UPDATE     PIC X.
   137 01 srch-commarea.
   138*                                copy ELCADLTRSPI.
   139******************************************************************
   140*                   C H A N G E   L O G
   141*
   142* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   143*-----------------------------------------------------------------
   144*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   145* EFFECTIVE    NUMBER
   146*-----------------------------------------------------------------
   147* 060611    2011022800001  PEMA  NEW COPYBOOK
   148* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   149* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   150******************************************************************
   151****************************************
   152*  commarea for NaperSoft On Demand Admin services letters
   153*  (business logic input & output)
   154****************************************
   155     03  BL-INPUT.
   156         05  BL-DATA-SRCE        PIC X.
   157         05  BL-LETTER-ID        PIC XXXX.
   158         05  BL-CARRIER          PIC X.
   159         05  BL-GROUP            PIC X(6).
   160         05  BL-STATE            PIC XX.
   161         05  BL-ACCOUNT          PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page   5
* EL6318.cbl
   162         05  BL-EFF-DT           PIC X(10).
   163         05  BL-CERT-NO          PIC X(11).
   164         05  BL-BATCH-NO         PIC X(6).
   165         05  BL-BATCH-SEQ        PIC 9(8).
   166         05  BL-RESP-NO          PIC X(10).
   167         05  BL-NO-OF-COPIES     PIC 99.
   168         05  BL-PROC-ID          PIC XXXX.
   169         05  BL-COMP-ID          PIC XXX.
   170         05  BL-PRINT-NOW-SW     PIC X.
   171         05  BL-ENC-CD           PIC XXX.
   172         05  BL-RESEND-DT        PIC X(10).
   173         05  BL-FOLLOW-UP-DT     PIC X(10).
   174         05  BL-ARCHIVE-NO       PIC 9(8).
   175         05  BL-FUNC             PIC X(8).
   176         05  BL-COMMENTS         PIC X(100).
   177         05  FILLER REDEFINES BL-COMMENTS.
   178             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   179             10  BL-LETTER-TO-ACCT PIC X.
   180             10  BL-LETTER-TO-BENE PIC X.
   181             10  BL-WRITE-ERARCH   PIC X.
   182                 88  ERARCH-QWS      VALUE 'Q'.
   183                 88  ERARCH-BATCH    VALUE 'B'.
   184                 88  ERARCH-TEMP     VALUE 'T'.
   185             10  BL-PROCESS-TYPE PIC X(07).
   186             10  BL-CERT-FORM-ID PIC X(05).
   187             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   188             10  BL-SOURCE-SCREEN PIC X(8).
   189             10  FILLER          PIC X(25).
   190     03  BL-OUTPUT.
   191         05  BL-STATUS                   PIC X.
   192             88  BL-OK                      VALUE "P".
   193             88  BL-FAIL                  VALUE "F".
   194         05  BL-MESSAGE          PIC X(50).
   195     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   196     03  FILLER                  PIC X(31).
   197
   198*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   199*                                COPY ELCZREC.
   200******************************************************************
   201*                                                                *
   202*                                                                *
   203*                            ELCZREC.                            *
   204*                                                                *
   205*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   206*                                                                *
   207******************************************************************
   208*-----------------------------------------------------------------
   209*                   C H A N G E   L O G
   210*
   211* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   212*-----------------------------------------------------------------
   213*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   214* EFFECTIVE    NUMBER
   215*-----------------------------------------------------------------
   216* 122011    2011022800001  AJRA  NEW FILE
   217* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   218* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   219* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page   6
* EL6318.cbl
   220* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   221*-----------------------------------------------------------------
   222 01  W-Z-CONTROL-DATA.
   223     05  W-NUMBER-OF-COPIES      PIC  9.
   224     05  FILLER                  PIC  X.
   225     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   226     05  FILLER                  PIC  X.
   227     05  W-DAYS-TO-RESEND        PIC  999.
   228     05  FILLER                  PIC  X.
   229     05  W-FORM-TO-RESEND        PIC  X(4).
   230     05  W-ADD-BAR-CODE          PIC  X.
   231     05  W-PROMPT-LETTER         PIC  X.
   232     05  W-HAS-RETURN-ENV        PIC  X.
   233     05  W-ENCLOSURE-CD          PIC  XXX.
   234     05  W-SIG-FLAG-DEFAULT      PIC  X.
   235     05  W-AUTO-CLOSE-IND        PIC  X.
   236     05  FILLER                  PIC  X.
   237     05  W-LETTER-TO-BENE        PIC  X.
   238     05  FILLER                  PIC  X.
   239     05  W-LETTER-TO-ACCT        PIC  X.
   240     05  FILLER                  PIC  X.
   241     05  W-LETTER-TYPE           PIC  X.
   242     05  FILLER                  PIC  X.
   243     05  W-PRINT-CERTIFICATE     PIC  X.
   244     05  FILLER                  PIC  X.
   245     05  W-REFUND-REQUIRED       PIC  X.
   246     05  FILLER                  PIC  X.
   247     05  W-ONBASE-CODE           PIC  XX.
   248     05  FILLER                  PIC  X.
   249     05  W-ACCT-SUMM             PIC  X.
   250     05  FILLER                  PIC  X.
   251     05  W-CSO-SUMM              PIC  X.
   252     05  FILLER                  PIC  X.
   253     05  W-REASONS-REQUIRED      PIC  X.
   254     05  FILLER                  PIC  X(29).
   255 01  WS-PASSED-REASON-CODES      PIC X(60)  VALUE SPACES.
   256 01  STANDARD-AREAS.
   257     12  W-ARCH-SUPPRESS         PIC ZZZZZZZ9.
   258     12  W-ARCH-EDIT REDEFINES W-ARCH-SUPPRESS
   259                                 PIC  X(08).
   260     12  W-ARCH-LENGTH           PIC S9(04)  COMP  VALUE +250.
   261     12  QID.
   262         16  QID-TERM        PIC X(4)    VALUE SPACES.
   263         16  FILLER          PIC X(4)    VALUE '631K'.
   264     12  MAP-LENGTH          PIC 9(4)   VALUE 359 BINARY.
   265     12  TIME-MT                 PIC S9(7).
   266     12  TIME-MT-R  REDEFINES TIME-MT.
   267         16  FILLER              PIC X.
   268         16  TIME-LMT            PIC 99V99.
   269         16  FILLER              PIC X(2).
   270     12  GETMAIN-SPACE           PIC X VALUE SPACES.
   271     12  ERENDT-LENGTH           PIC S9(04) VALUE +579 COMP.
   272     12  ERPNDB-LENGTH           PIC 9(04)  VALUE 585 COMP.
   273     12  ERCNOT-LENGTH           PIC S9(04) VALUE +150 COMP.
   274     12  ERNOTE-LENGTH           PIC S9(04) VALUE +825 COMP.
   275     12  ELEOBC-LENGTH           PIC S9(04) VALUE +350 COMP.
   276     12  ELCRTT-LENGTH           PIC S9(4) COMP VALUE +552.
   277     12  ELENCC-LENGTH           PIC S9(04) VALUE +400 COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page   7
* EL6318.cbl
   278     12  W-CNTL-KEY.
   279         16  W-CNTL-COMPANY-ID   PIC  X(03).
   280         16  W-CNTL-RECORD-TYPE  PIC  X(01)   VALUE '1'.
   281         16  W-CNTL-GENL.
   282             20  W-CNTL-GEN1     PIC  X(02)   VALUE SPACES.
   283             20  W-CNTL-GEN2.
   284                 24 W-CNTL-GEN3  PIC  X(01)   VALUE SPACES.
   285                 24 W-CNTL-GEN4  PIC  X(01)   VALUE SPACES.
   286         16  W-CNTL-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
   287     12  WS-ELCERT-KEY.
   288         16  W-CERT-COMPANY-CD   PIC X.
   289         16  W-CERT-CARRIER      PIC X.
   290         16  W-CERT-GROUPING     PIC X(6).
   291         16  W-CERT-STATE        PIC XX.
   292         16  W-CERT-ACCOUNT      PIC X(10).
   293         16  W-CERT-CERT-EFF-DT  PIC XX.
   294         16  W-CERT-CERT-PRIME   PIC X(10).
   295         16  W-CERT-CERT-SFX     PIC X.
   296     12  WS-ELEOBC-KEY.
   297         16  WS-EOBC-COMPANY-CD  PIC X.
   298         16  WS-EOBC-REC-TYPE    PIC X.
   299         16  WS-EOBC-CODE        PIC X(4).
   300         16  FILLER              PIC X(9).
   301     12  WS-ERNOTE-KEY.
   302         16  W-NOTE-COMPANY-CD   PIC X.
   303         16  W-NOTE-CARRIER      PIC X.
   304         16  W-NOTE-GROUPING     PIC X(6).
   305         16  W-NOTE-STATE        PIC XX.
   306         16  W-NOTE-ACCOUNT      PIC X(10).
   307         16  W-NOTE-CERT-EFF-DT  PIC XX.
   308         16  W-NOTE-CERT-PRIME   PIC X(10).
   309         16  W-NOTE-CERT-SFX     PIC X.
   310     12  ELLETR-KEY.
   311         16  LETR-PART-KEY.
   312             20  LETR-COMPANY-CD PIC X.
   313             20  LETR-LETTER-ID  PIC X(4).
   314         16  LETR-FILLER         PIC X(8).
   315         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   316     12  ELLETR-SAVE-PART-KEY    PIC X(5).
   317     12  ERPNDB2-KEY.
   318         16  PNDB2-COMPANY-CD    PIC X.
   319         16  PNDB2-CARRIER       PIC X.
   320         16  PNDB2-GROUPING      PIC X(6).
   321         16  PNDB2-STATE         PIC XX.
   322         16  PNDB2-ACCOUNT       PIC X(10).
   323         16  PNDB2-CERT-EFF-DT   PIC XX.
   324         16  PNDB2-CERT-PRIME    PIC X(10).
   325         16  PNDB2-CERT-SFX      PIC X.
   326         16  PNDB2-CHG-SEQ-NO    PIC 9(4) BINARY.
   327         16  PNDB2-RECORD-TYPE   PIC X.
   328     12  ERPNDB-KEY.
   329         16  PNDB-COMPANY-CD     PIC X.
   330         16  PNDB-BATCH-NO       PIC X(6).
   331         16  PNDB-BATCH-SEQ-NO   PIC 9(4) BINARY.
   332         16  PNDB-CHG-SEQ-NO     PIC 9(4) BINARY.
   333     12  ERENDT-KEY.
   334         16  ENDT-COMPANY-CD       PIC X.
   335         16  ENDT-CARRIER          PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page   8
* EL6318.cbl
   336         16  ENDT-GROUPING         PIC X(6).
   337         16  ENDT-STATE            PIC XX.
   338         16  ENDT-ACCOUNT          PIC X(10).
   339         16  ENDT-CERT-EFF-DT      PIC XX.
   340         16  ENDT-CERT-PRIME       PIC X(10).
   341         16  ENDT-CERT-SFX         PIC X.
   342         16  ENDT-RECORD-TYPE      PIC X.
   343         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   344     12  ELCRTO-KEY.
   345         16  CRTO-COMPANY-CD     PIC X.
   346         16  CRTO-CARRIER        PIC X.
   347         16  CRTO-GROUPING       PIC X(6).
   348         16  CRTO-STATE          PIC XX.
   349         16  CRTO-ACCOUNT        PIC X(10).
   350         16  CRTO-CERT-EFF-DT    PIC XX.
   351         16  CRTO-CERT-PRIME     PIC X(10).
   352         16  CRTO-CERT-SFX       PIC X.
   353         16  CRTO-RECORD-TYPE    PIC X.
   354         16  CRTO-SEQ-NO         PIC 9(4) BINARY.
   355     12  WS-ELCRTT-KEY.
   356         16  WS-ELCRTT-PRIMARY   PIC X(33).
   357         16  WS-ELCRTT-REC-TYPE  PIC X(1).
   358     12  WS-ERMAIL-KEY.
   359         16  MAIL-COMPANY-CD     PIC X.
   360         16  MAIL-CARRIER        PIC X.
   361         16  MAIL-GROUPING       PIC X(6).
   362         16  MAIL-STATE          PIC XX.
   363         16  MAIL-ACCOUNT        PIC X(10).
   364         16  MAIL-CERT-EFF-DT    PIC XX.
   365         16  MAIL-CERT-PRIME     PIC X(10).
   366         16  MAIL-CERT-SFX       PIC X.
   367
   368     12  WS-ELENCC-KEY.
   369         16  WS-ENCC-COMPANY-CD  PIC X.
   370         16  WS-ENCC-REC-TYPE    PIC X.
   371         16  WS-ENCC-ENC-CODE    PIC X(5).
   372         16  FILLER              PIC X(09).
   373
   374     12  WS-LF-CANC-DT           PIC XX   VALUE LOW-VALUES.
   375     12  WS-AH-CANC-DT           PIC XX   VALUE LOW-VALUES.
   376     12  WS-CURRENT-DT.
   377         16  FILLER              PIC X(6)    VALUE SPACES.
   378         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   379     12  WS-CURRENT-BIN-DT       PIC XX    VALUE LOW-VALUES.
   380     12  WS-ISS-CAN-SW           PIC X     VALUE LOW-VALUES.
   381         88  CANCEL-REC            VALUE 'C'.
   382         88  ISSUE-REC             VALUE 'I'.
   383     12  WS-WORK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
   384     12  WS-HOLD-ACCT-KEY        PIC X(26) VALUE LOW-VALUES.
   385     12  ELCNTL-KEY.
   386         16  CNTL-COMP-ID        PIC X(3)  VALUE SPACES.
   387         16  CNTL-REC-TYPE       PIC X     VALUE SPACES.
   388         16  CNTL-ACCESS.
   389             20  CNTL-STATE      PIC XX    VALUE SPACES.
   390             20  FILLER          PIC X     VALUE SPACES.
   391             20  CNTL-CARRIER    PIC X     VALUE SPACES.
   392         16  CNTL-SEQ            PIC S9(4) VALUE +0 COMP.
   393     12  WS-ERACCT-KEY.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page   9
* EL6318.cbl
   394         16  ACCT-COMPANY-CD     PIC X.
   395         16  ACCT-CARRIER        PIC X.
   396         16  ACCT-GROUPING       PIC X(6).
   397         16  ACCT-STATE          PIC XX.
   398         16  ACCT-ACCOUNT        PIC X(10).
   399         16  ACCT-EXP-DATE       PIC XX    VALUE SPACES.
   400         16  FILLER              PIC X(4)  VALUE LOW-VALUES.
   401     12  ERACCT-SAVE-KEY         PIC X(20) VALUE SPACES.
   402     12  WS-ELCERT-FILE-ID       PIC X(8) VALUE 'ELCERT'.
   403     12  WS-ELCNTL-FILE-ID       PIC X(8) VALUE 'ELCNTL'.
   404     12  WS-ERNOTE-FILE-ID       PIC X(8) VALUE 'ERNOTE'.
   405     12  WS-ELCRTO-FILE-ID       PIC X(8) VALUE 'ELCRTO'.
   406     12  WS-ERENDT-FILE-ID       PIC X(8) VALUE 'ERENDT'.
   407     12  WS-ERPNDB2-FILE-ID      PIC X(8) VALUE 'ERPNDB2'.
   408     12  WS-ERPNDB-FILE-ID       PIC X(8) VALUE 'ERPNDB'.
   409     12  WS-ERACCT2-FILE-ID      PIC X(8) VALUE 'ERACCT2'.
   410     12  WS-ERCNOT-FILE-ID       PIC X(8) VALUE 'ERCNOT'.
   411     12  WS-ELEOBC-FILE-ID       PIC X(8) VALUE 'ELEOBC'.
   412     12  WS-ELCRTT-FILE-ID       PIC X(8) VALUE 'ELCRTT'.
   413     12  WS-ELENCC-FILE-ID       PIC X(8) VALUE 'ELENCC'.
   414     12  WS-RESPONSE             PIC S9(8)   COMP.
   415         88  RESP-NORMAL                  VALUE +00.
   416         88  RESP-NOTFND                  VALUE +13.
   417         88  RESP-DUPREC                  VALUE +14.
   418         88  RESP-DUPKEY                  VALUE +15.
   419         88  RESP-NOTOPEN                 VALUE +19.
   420         88  RESP-ENDFILE                 VALUE +20.
   421     12  MAP-NAME            PIC X(8)    VALUE 'EL631K'.
   422     12  MAPSET-NAME         PIC X(8)    VALUE 'EL6318S'.
   423     12  SCREEN-NUMBER       PIC X(4)    VALUE '631K'.
   424     12  TRANS-ID            PIC X(4)    VALUE 'EXBE'.
   425     12  THIS-PGM            PIC X(8)    VALUE 'EL6318'.
   426     12  PGM-NAME            PIC X(8).
   427     12  TIME-IN             PIC S9(7).
   428     12  TIME-OUT-R  REDEFINES TIME-IN.
   429         16  FILLER          PIC X.
   430         16  TIME-OUT        PIC 99V99.
   431         16  FILLER          PIC X(2).
   432     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   433     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   434     12  XCTL-626            PIC X(8)    VALUE 'EL626'.
   435     12  XCTL-6311           PIC X(8)    VALUE 'EL6311'.
   436     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   437     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   438     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   439     12  WS-PHONE.
   440         16  WS-PH1              PIC XXX.
   441         16  WS-PH2              PIC XXX.
   442         16  WS-PH3              PIC XXXX.
   443     12  WS-PHONE-NUM REDEFINES WS-PHONE PIC 9(10).
   444     12  WS-DEV-RT               PIC S9V9(6) COMP-3.
   445
   446     12  WS-BILLING-NOTE.
   447         16  WS-BN-NOTE          PIC X(25).
   448         16  WS-BN-LTRID         PIC X(4).
   449         16  FILLER              PIC X(3).
   450         16  WS-BN-DATE          PIC X(8).
   451         16  FILLER              PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  10
* EL6318.cbl
   452         16  WS-BN-USERID        PIC X(4).
   453         16  FILLER              PIC X(30).
   454     12  WS-MANUAL-BILL-NOTE REDEFINES WS-BILLING-NOTE.
   455         16  WS-MAN-BN-NOTE      PIC X(63).
   456         16  FILLER              PIC X(14).
   457     12  WS-LEN                  PIC S9(5) COMP-3 VALUE +0.
   458
   459     12  WS-SAVE-REASON-CODE-IND PIC X(26).
   460
   461 01  NEW-ELCRTO-REC.
   462     12  NEW-ELCRTO-KEY.
   463         16  NCRTO-COMPANY-CD      PIC X.
   464         16  NCRTO-CARRIER         PIC X.
   465         16  NCRTO-GROUPING        PIC X(6).
   466         16  NCRTO-STATE           PIC XX.
   467         16  NCRTO-ACCOUNT         PIC X(10).
   468         16  NCRTO-CERT-EFF-DT     PIC XX.
   469         16  NCRTO-CERT-PRIME      PIC X(10).
   470         16  NCRTO-CERT-SFX        PIC X.
   471         16  NCRTO-RECORD-TYPE     PIC X.
   472         16  NCRTO-SEQ-NO          PIC 9(4) BINARY.
   473     12  NEW-ORIG-REC.
   474         16  NCRTO-INS-LAST-NAME   PIC X(15).
   475         16  NCRTO-INS-FIRST-NAME  PIC X(10).
   476         16  NCRTO-INS-MIDDLE-INIT PIC X.
   477         16  NCRTO-INS-AGE         PIC S999     COMP-3.
   478         16  NCRTO-JNT-LAST-NAME   PIC X(15).
   479         16  NCRTO-JNT-FIRST-NAME  PIC X(10).
   480         16  NCRTO-JNT-MIDDLE-INIT PIC X.
   481         16  NCRTO-JNT-AGE         PIC S999     COMP-3.
   482         16  NCRTO-LF-BENCD        PIC XX.
   483         16  NCRTO-LF-TERM         PIC S999      COMP-3.
   484         16  NCRTO-LF-BEN-AMT      PIC S9(9)V99  COMP-3.
   485         16  NCRTO-LF-PRM-AMT      PIC S9(7)V99  COMP-3.
   486         16  NCRTO-LF-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
   487         16  NCRTO-LF-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
   488         16  NCRTO-LF-EXP-DT       PIC XX.
   489         16  NCRTO-LF-COMM-PCT     PIC SV9(5)    COMP-3.
   490         16  NCRTO-LF-CANCEL-DT    PIC XX.
   491         16  NCRTO-LF-CANCEL-AMT   PIC S9(7)V99  COMP-3.
   492         16  NCRTO-LF-ITD-CANCEL-AMT PIC S9(7)V99 COMP-3.
   493         16  NCRTO-AH-BENCD        PIC XX.
   494         16  NCRTO-AH-TERM         PIC S999      COMP-3.
   495         16  NCRTO-AH-BEN-AMT      PIC S9(9)V99  COMP-3.
   496         16  NCRTO-AH-PRM-AMT      PIC S9(7)V99  COMP-3.
   497         16  NCRTO-AH-EXP-DT       PIC XX.
   498         16  NCRTO-AH-COMM-PCT     PIC SV9(5)    COMP-3.
   499         16  NCRTO-AH-CP           PIC 99.
   500         16  NCRTO-AH-CANCEL-DT    PIC XX.
   501         16  NCRTO-AH-CANCEL-AMT   PIC S9(7)V99  COMP-3.
   502         16  NCRTO-AH-ITD-CANCEL-AMT PIC S9(7)V99 COMP-3.
   503         16  NCRTO-CRED-BENE-NAME  PIC X(25).
   504         16  NCRTO-1ST-PMT-DT      PIC XX.
   505         16  NCRTO-INS-AGE-DEFAULT-FLAG PIC X.
   506         16  NCRTO-JNT-AGE-DEFAULT-FLAG PIC X.
   507         16  NCRTO-ISSUE-TRAN-IND  PIC X.
   508         16  NCRTO-CANCEL-TRAN-IND PIC X.
   509         16  FILLER                PIC X(235).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  11
* EL6318.cbl
   510
   511 01  CERT-NOTE-ENTRIES.
   512     12  CERT-NT OCCURS 300 TIMES INDEXED BY TB-INDX TB-INDX1.
   513         16  CERT-NT-TEXT                PIC X(63).
   514         16  CERT-NT-LAST-MAINT-BY       PIC XXXX.
   515         16  CERT-NT-LAST-MAINT-DT       PIC XX.
   516         16  CERT-NT-LAST-MAINT-HHMMSS   PIC S9(7) COMP-3.
   517
   518 01  ERCNOT-AREA.
   519     12  ERCNOT-KEY-LENGTH       PIC S9(4)   COMP VALUE +36.
   520     12  ERCNOT-START-LENGTH     PIC S9(4)   COMP VALUE +34.
   521     12  ERCNOT-KEY.
   522         16  ERCNOT-PARTIAL-KEY.
   523             20 ERCNOT-COMPANY-CD    PIC X.
   524             20 ERCNOT-CARRIER       PIC X.
   525             20 ERCNOT-GROUPING      PIC X(06).
   526             20 ERCNOT-STATE         PIC XX.
   527             20 ERCNOT-ACCOUNT       PIC X(10).
   528             20 ERCNOT-EFF-DT        PIC XX.
   529             20 ERCNOT-CERT-NO.
   530                25 ERCNOT-CERT-PRIME PIC X(10).
   531                25 ERCNOT-CERT-SFX   PIC X.
   532             20 ERCNOT-REC-TYP       PIC X.
   533         16 ERCNOT-SEQ           PIC S9(4) COMP.
   534     12  SV-PARTIAL-KEY.
   535         20 SV-COMPANY-CD            PIC X.
   536         20 SV-CARRIER               PIC X.
   537         20 SV-GROUPING              PIC X(06).
   538         20 SV-STATE                 PIC XX.
   539         20 SV-ACCOUNT               PIC X(10).
   540         20 SV-EFF-DT                PIC XX.
   541         20 SV-CERT-NO.
   542            25 SV-CERT-PRIME         PIC X(10).
   543            25 SV-CERT-SFX           PIC X(1).
   544         20 SV-REC-TYP               PIC X.
   545 01  ERROR-MESSAGES.
   546     12  ER-0000                 PIC X(4)  VALUE '0000'.
   547     12  ER-0004                 PIC X(4)  VALUE '0004'.
   548     12  ER-0008                 PIC X(4)  VALUE '0008'.
   549     12  ER-0023                 PIC X(4)  VALUE '0023'.
   550     12  ER-0029                 PIC X(4)  VALUE '0029'.
   551     12  ER-0068                 PIC X(4)  VALUE '0068'.
   552     12  ER-0132                 PIC X(4)  VALUE '0132'.
   553     12  ER-0142                 PIC X(4)  VALUE '0142'.
   554     12  ER-0148                 PIC X(4)  VALUE '0148'.
   555     12  ER-0215                 PIC X(4)  VALUE '0215'.
   556     12  ER-0280                 PIC X(4)  VALUE '0280'.
   557     12  ER-0348                 PIC X(4)  VALUE '0348'.
   558     12  ER-0419                 PIC X(4)  VALUE '0419'.
   559     12  ER-0715                 PIC X(4)  VALUE '0715'.
   560     12  ER-0894                 PIC X(4)  VALUE '0894'.
   561     12  ER-1101                 PIC X(4)  VALUE '1101'.
   562     12  ER-1236                 PIC X(4)  VALUE '1236'.
   563     12  ER-1560                 PIC X(4)  VALUE '1560'.
   564     12  ER-1664                 PIC X(4)  VALUE '1664'.
   565     12  ER-1778                 PIC X(4)  VALUE '1778'.
   566     12  ER-1818                 PIC X(4)  VALUE '1818'.
   567     12  ER-1820                 PIC X(4)  VALUE '1820'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  12
* EL6318.cbl
   568     12  ER-1821                 PIC X(4)  VALUE '1821'.
   569     12  ER-2056                 PIC X(4)  VALUE '2056'.
   570     12  ER-2079                 PIC X(4)  VALUE '2079'.
   571     12  ER-2208                 PIC X(4)  VALUE '2208'.
   572     12  ER-2209                 PIC X(4)  VALUE '2209'.
   573     12  ER-2237                 PIC X(4)  VALUE '2237'.
   574     12  ER-2238                 PIC X(4)  VALUE '2238'.
   575     12  ER-2253                 PIC X(4)  VALUE '2253'.
   576     12  ER-2619                 PIC X(4)  VALUE '2619'.
   577     12  ER-2651                 PIC X(4)  VALUE '2651'.
   578     12  ER-2784                 PIC X(4)  VALUE '2784'.
   579     12  ER-2785                 PIC X(4)  VALUE '2785'.
   580     12  ER-2786                 PIC X(4)  VALUE '2786'.
   581     12  ER-2791                 PIC X(4)  VALUE '2791'.
   582     12  ER-2845                 PIC X(4)  VALUE '2845'.
   583     12  ER-2848                 PIC X(4)  VALUE '2848'.
   584     12  ER-2851                 PIC X(4)  VALUE '2851'.
   585     12  ER-3830                 PIC X(4)  VALUE '3830'.
   586     12  ER-3833                 PIC X(4)  VALUE '3833'.
   587     12  ER-7345                 PIC X(4)  VALUE '7345'.
   588     12  ER-7638                 PIC X(4)  VALUE '7638'.
   589     12  ER-8888                 PIC X(4)  VALUE '8888'.
   590     12  ER-9999                 PIC X(4)  VALUE '9999'.
   591*    COPY ELCDATE.
   592******************************************************************
   593*                                                                *
   594*                                                                *
   595*                            ELCDATE.                            *
   596*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   597*                            VMOD=2.003
   598*                                                                *
   599*                                                                *
   600*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   601*                 LENGTH = 200                                   *
   602******************************************************************
   603
   604 01  DATE-CONVERSION-DATA.
   605     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   606     12  DC-OPTION-CODE                PIC X.
   607         88  BIN-TO-GREG                VALUE ' '.
   608         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   609         88  EDIT-GREG-TO-BIN           VALUE '2'.
   610         88  YMD-GREG-TO-BIN            VALUE '3'.
   611         88  MDY-GREG-TO-BIN            VALUE '4'.
   612         88  JULIAN-TO-BIN              VALUE '5'.
   613         88  BIN-PLUS-ELAPSED           VALUE '6'.
   614         88  FIND-CENTURY               VALUE '7'.
   615         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   616         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   617         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   618         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   619         88  JULIAN-TO-BIN-3            VALUE 'C'.
   620         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   621         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   622         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   623         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   624         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   625         88  CHECK-LEAP-YEAR            VALUE 'H'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  13
* EL6318.cbl
   626         88  BIN-3-TO-GREG              VALUE 'I'.
   627         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   628         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   629         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   630         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   631         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   632         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   633         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   634         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   635         88  THREE-CHARACTER-BIN
   636                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   637         88  GREGORIAN-TO-BIN
   638                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   639         88  BIN-TO-GREGORIAN
   640                  VALUES ' ' '1' 'I' '8' 'G'.
   641         88  JULIAN-TO-BINARY
   642                  VALUES '5' 'C' 'E' 'F'.
   643     12  DC-ERROR-CODE                 PIC X.
   644         88  NO-CONVERSION-ERROR        VALUE ' '.
   645         88  DATE-CONVERSION-ERROR
   646                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   647         88  DATE-IS-ZERO               VALUE '1'.
   648         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   649         88  DATE-IS-INVALID            VALUE '3'.
   650         88  DATE1-GREATER-DATE2        VALUE '4'.
   651         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   652         88  DATE-INVALID-OPTION        VALUE '9'.
   653         88  INVALID-CENTURY            VALUE 'A'.
   654         88  ONLY-CENTURY               VALUE 'B'.
   655         88  ONLY-LEAP-YEAR             VALUE 'C'.
   656         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   657     12  DC-END-OF-MONTH               PIC X.
   658         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   659     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   660         88  USE-NORMAL-PROCESS         VALUE ' '.
   661         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   662         88  ADJUST-UP-100-YRS          VALUE '2'.
   663     12  FILLER                        PIC X.
   664     12  DC-CONVERSION-DATES.
   665         16  DC-BIN-DATE-1             PIC XX.
   666         16  DC-BIN-DATE-2             PIC XX.
   667         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   668         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   669                       DC-GREG-DATE-1-EDIT.
   670             20  DC-EDIT1-MONTH        PIC 99.
   671             20  SLASH1-1              PIC X.
   672             20  DC-EDIT1-DAY          PIC 99.
   673             20  SLASH1-2              PIC X.
   674             20  DC-EDIT1-YEAR         PIC 99.
   675         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   676         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   677                     DC-GREG-DATE-2-EDIT.
   678             20  DC-EDIT2-MONTH        PIC 99.
   679             20  SLASH2-1              PIC X.
   680             20  DC-EDIT2-DAY          PIC 99.
   681             20  SLASH2-2              PIC X.
   682             20  DC-EDIT2-YEAR         PIC 99.
   683         16  DC-GREG-DATE-1-YMD        PIC 9(06).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  14
* EL6318.cbl
   684         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   685                     DC-GREG-DATE-1-YMD.
   686             20  DC-YMD-YEAR           PIC 99.
   687             20  DC-YMD-MONTH          PIC 99.
   688             20  DC-YMD-DAY            PIC 99.
   689         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   690         16  DC-GREG-DATE-1-MDY-R REDEFINES
   691                      DC-GREG-DATE-1-MDY.
   692             20  DC-MDY-MONTH          PIC 99.
   693             20  DC-MDY-DAY            PIC 99.
   694             20  DC-MDY-YEAR           PIC 99.
   695         16  DC-GREG-DATE-1-ALPHA.
   696             20  DC-ALPHA-MONTH        PIC X(10).
   697             20  DC-ALPHA-DAY          PIC 99.
   698             20  FILLER                PIC XX.
   699             20  DC-ALPHA-CENTURY.
   700                 24 DC-ALPHA-CEN-N     PIC 99.
   701             20  DC-ALPHA-YEAR         PIC 99.
   702         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   703         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   704         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   705         16  DC-JULIAN-DATE            PIC 9(05).
   706         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   707                                       PIC 9(05).
   708         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   709             20  DC-JULIAN-YEAR        PIC 99.
   710             20  DC-JULIAN-DAYS        PIC 999.
   711         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   712         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   713         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   714     12  DATE-CONVERSION-VARIBLES.
   715         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   716         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   717             20  FILLER                PIC 9(3).
   718             20  HOLD-CEN-1-CCYY.
   719                 24  HOLD-CEN-1-CC     PIC 99.
   720                 24  HOLD-CEN-1-YY     PIC 99.
   721             20  HOLD-CEN-1-MO         PIC 99.
   722             20  HOLD-CEN-1-DA         PIC 99.
   723         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   724             20  HOLD-CEN-1-R-MO       PIC 99.
   725             20  HOLD-CEN-1-R-DA       PIC 99.
   726             20  HOLD-CEN-1-R-CCYY.
   727                 24  HOLD-CEN-1-R-CC   PIC 99.
   728                 24  HOLD-CEN-1-R-YY   PIC 99.
   729             20  FILLER                PIC 9(3).
   730         16  HOLD-CENTURY-1-X.
   731             20  FILLER                PIC X(3)  VALUE SPACES.
   732             20  HOLD-CEN-1-X-CCYY.
   733                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   734                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   735             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   736             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   737         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   738             20  HOLD-CEN-1-R-X-MO     PIC XX.
   739             20  HOLD-CEN-1-R-X-DA     PIC XX.
   740             20  HOLD-CEN-1-R-X-CCYY.
   741                 24  HOLD-CEN-1-R-X-CC PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  15
* EL6318.cbl
   742                 24  HOLD-CEN-1-R-X-YY PIC XX.
   743             20  FILLER                PIC XXX.
   744         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   745         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   746         16  DC-JULIAN-DATE-1          PIC 9(07).
   747         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   748             20  DC-JULIAN-1-CCYY.
   749                 24  DC-JULIAN-1-CC    PIC 99.
   750                 24  DC-JULIAN-1-YR    PIC 99.
   751             20  DC-JULIAN-DA-1        PIC 999.
   752         16  DC-JULIAN-DATE-2          PIC 9(07).
   753         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   754             20  DC-JULIAN-2-CCYY.
   755                 24  DC-JULIAN-2-CC    PIC 99.
   756                 24  DC-JULIAN-2-YR    PIC 99.
   757             20  DC-JULIAN-DA-2        PIC 999.
   758         16  DC-GREG-DATE-A-EDIT.
   759             20  DC-EDITA-MONTH        PIC 99.
   760             20  SLASHA-1              PIC X VALUE '/'.
   761             20  DC-EDITA-DAY          PIC 99.
   762             20  SLASHA-2              PIC X VALUE '/'.
   763             20  DC-EDITA-CCYY.
   764                 24  DC-EDITA-CENT     PIC 99.
   765                 24  DC-EDITA-YEAR     PIC 99.
   766         16  DC-GREG-DATE-B-EDIT.
   767             20  DC-EDITB-MONTH        PIC 99.
   768             20  SLASHB-1              PIC X VALUE '/'.
   769             20  DC-EDITB-DAY          PIC 99.
   770             20  SLASHB-2              PIC X VALUE '/'.
   771             20  DC-EDITB-CCYY.
   772                 24  DC-EDITB-CENT     PIC 99.
   773                 24  DC-EDITB-YEAR     PIC 99.
   774         16  DC-GREG-DATE-CYMD         PIC 9(08).
   775         16  DC-GREG-DATE-CYMD-R REDEFINES
   776                              DC-GREG-DATE-CYMD.
   777             20  DC-CYMD-CEN           PIC 99.
   778             20  DC-CYMD-YEAR          PIC 99.
   779             20  DC-CYMD-MONTH         PIC 99.
   780             20  DC-CYMD-DAY           PIC 99.
   781         16  DC-GREG-DATE-MDCY         PIC 9(08).
   782         16  DC-GREG-DATE-MDCY-R REDEFINES
   783                              DC-GREG-DATE-MDCY.
   784             20  DC-MDCY-MONTH         PIC 99.
   785             20  DC-MDCY-DAY           PIC 99.
   786             20  DC-MDCY-CEN           PIC 99.
   787             20  DC-MDCY-YEAR          PIC 99.
   788    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   789        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   790    12  DC-EL310-DATE                  PIC X(21).
   791    12  FILLER                         PIC X(28).
   792*    COPY ELCTEXT.
   793******************************************************************
   794*                                                                *
   795*                                                                *
   796*                            ELCTEXT.                            *
   797*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   798*                            VMOD=2.008                          *
   799*                                                                *
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  16
* EL6318.cbl
   800*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
   801*                                     FORM LETTERS,              *
   802*                                     CERT FORM DISPLAY.
   803*                                                                *
   804*   FILE TYPE = VSAM,KSDS                                        *
   805*   RECORD SIZE = 100   RECFORM = FIXED                          *
   806*                                                                *
   807*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
   808*       ALTERNATE INDEX = NONE                                   *
   809*                                                                *
   810*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
   811*       ALTERNATE INDEX = NONE                                   *
   812*                                                                *
   813*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
   814*       ALTERNATE INDEX = NONE                                   *
   815*                                                                *
   816*   LOG = NO                                                     *
   817*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   818******************************************************************
   819 01  TEXT-FILES.
   820     12  TEXT-FILE-ID                PIC XX.
   821         88  FORMS-FILE-TEXT            VALUE 'TF'.
   822         88  LETTER-FILE-TEXT           VALUE 'TL'.
   823         88  HELP-FILE-TEXT             VALUE 'TH'.
   824
   825     12  TX-CONTROL-PRIMARY.
   826         16  TX-COMPANY-CD           PIC X.
   827             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
   828         16  TX-ACCESS-CD-GENL       PIC X(12).
   829
   830         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   831             20  TX-LETTER-NO        PIC X(4).
   832             20  FILLER              PIC X(8).
   833
   834         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   835             20  TX-FORM-NO          PIC X(12).
   836
   837         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   838             20  TX-HELP-TYPE        PIC X.
   839                 88  HELP-FOR-GENERAL   VALUE ' '.
   840                 88  HELP-BY-SCREEN     VALUE 'S'.
   841                 88  HELP-BY-ERROR      VALUE 'E'.
   842             20  TX-SCREEN-OR-ERROR  PIC X(4).
   843                 88  GENERAL-INFO-HELP  VALUE '0000'.
   844             20  TX-HELP-FOR-COMPANY  PIC XXX.
   845                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
   846             20  FILLER              PIC X(4).
   847
   848         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
   849
   850     12  TX-PROCESS-CONTROL          PIC XX.
   851         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
   852
   853     12  TX-TEXT-LINE                PIC X(70).
   854
   855     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
   856         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
   857         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  17
* EL6318.cbl
   858         88  TX-VALID-FORM-SQUEEZE-VALUE
   859                                        VALUE 'Y' ' '.
   860
   861     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
   862         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
   863         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
   864         88  TX-DO-NOT-ADJUST           VALUE 'N'.
   865         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
   866         88  TX-NEW-PARAGRAPH           VALUE 'P'.
   867         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
   868         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
   869                                              'K' 'N' ' '
   870                                              'Z'.
   871
   872     12  TX-ARCHIVE-SW               PIC X.
   873         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
   874         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
   875         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
   876
   877     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
   878     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
   879
   880     12  TX-BSR-CODE                 PIC X.
   881         88  TX-BSR-LETTER              VALUE 'B'.
   882         88  TX-NON-BSR-LETTER          VALUE ' '.
   883
   884     12  FILLER                      PIC X.
   885*****************************************************************
   886*    COPY ELCLOGOF.
   887******************************************************************
   888*                                                                *
   889*                                                                *
   890*                            ELCLOGOF.                           *
   891*                            VMOD=2.001                          *
   892*                                                                *
   893*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   894*                                                                *
   895******************************************************************
   896 01  CLASIC-LOGOFF.
   897     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   898     12  LOGOFF-TEXT.
   899         16  FILLER          PIC X(5)    VALUE SPACES.
   900         16  LOGOFF-MSG.
   901             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   902             20  FILLER      PIC X       VALUE SPACES.
   903             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   904         16  FILLER          PIC X(80)
   905           VALUE '* YOU ARE NOW LOGGED OFF'.
   906         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   907         16  FILLER          PIC X       VALUE QUOTE.
   908         16  LOGOFF-SYS-MSG  PIC X(17)
   909           VALUE 'S CLAS-IC SYSTEM '.
   910     12  TEXT-MESSAGES.
   911         16  UNACCESS-MSG    PIC X(29)
   912             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   913         16  PGMIDERR-MSG    PIC X(17)
   914             VALUE 'PROGRAM NOT FOUND'.
   915*    COPY ELCATTR.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  18
* EL6318.cbl
   916******************************************************************
   917*                                                                *
   918*                            ELCATTR.                            *
   919*                            VMOD=2.001                          *
   920*                                                                *
   921*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   922*                                                                *
   923*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   924*                                                                *
   925*                   POS 1   P=PROTECTED                          *
   926*                           U=UNPROTECTED                        *
   927*                           S=ASKIP                              *
   928*                   POS 2   A=ALPHA/NUMERIC                      *
   929*                           N=NUMERIC                            *
   930*                   POS 3   N=NORMAL                             *
   931*                           B=BRIGHT                             *
   932*                           D=DARK                               *
   933*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   934*                           OF=MODIFIED DATA TAG OFF             *
   935*                                                                *
   936*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   937******************************************************************
   938 01  ATTRIBUTE-LIST.
   939     12  AL-PABOF            PIC X       VALUE 'Y'.
   940     12  AL-PABON            PIC X       VALUE 'Z'.
   941     12  AL-PADOF            PIC X       VALUE '%'.
   942     12  AL-PADON            PIC X       VALUE '_'.
   943     12  AL-PANOF            PIC X       VALUE '-'.
   944     12  AL-PANON            PIC X       VALUE '/'.
   945     12  AL-SABOF            PIC X       VALUE '8'.
   946     12  AL-SABON            PIC X       VALUE '9'.
   947     12  AL-SADOF            PIC X       VALUE '@'.
   948     12  AL-SADON            PIC X       VALUE QUOTE.
   949     12  AL-SANOF            PIC X       VALUE '0'.
   950     12  AL-SANON            PIC X       VALUE '1'.
   951     12  AL-UABOF            PIC X       VALUE 'H'.
   952     12  AL-UABON            PIC X       VALUE 'I'.
   953     12  AL-UADOF            PIC X       VALUE '<'.
   954     12  AL-UADON            PIC X       VALUE '('.
   955     12  AL-UANOF            PIC X       VALUE ' '.
   956     12  AL-UANON            PIC X       VALUE 'A'.
   957     12  AL-UNBOF            PIC X       VALUE 'Q'.
   958     12  AL-UNBON            PIC X       VALUE 'R'.
   959     12  AL-UNDOF            PIC X       VALUE '*'.
   960     12  AL-UNDON            PIC X       VALUE ')'.
   961     12  AL-UNNOF            PIC X       VALUE '&'.
   962     12  AL-UNNON            PIC X       VALUE 'J'.
   963*    COPY ELCEMIB.
   964******************************************************************
   965*                                                                *
   966*                                                                *
   967*                            ELCEMIB.                            *
   968*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   969*                            VMOD=2.005                          *
   970*                                                                *
   971*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   972*                                                                *
   973******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  19
* EL6318.cbl
   974 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   975     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   976     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   977     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   978     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   979     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   980     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   981     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   982     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   983     12  EMI-SWITCH1             PIC X        VALUE '1'.
   984         88  EMI-NO-ERRORS                    VALUE '1'.
   985         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   986         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   987     12  EMI-SWITCH2             PIC X        VALUE '1'.
   988         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   989     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   990         88  EMI-AREA1-EMPTY                  VALUE '1'.
   991         88  EMI-AREA1-FULL                   VALUE '2'.
   992     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   993         88  EMI-AREA2-EMPTY                  VALUE '1'.
   994         88  EMI-AREA2-FULL                   VALUE '2'.
   995     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   996         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   997         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   998         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   999         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1000         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1001     12  EMI-ERROR-LINES.
  1002         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1003         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1004         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1005         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1006             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1007                 24  EMI-ERR-NUM         PIC X(4).
  1008                 24  EMI-FILLER          PIC X.
  1009                 24  EMI-SEV             PIC X.
  1010                 24  FILLER              PIC X.
  1011             20  FILLER                  PIC X(02).
  1012     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1013         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1014             20  EMI-ERROR-NUMBER    PIC X(4).
  1015             20  EMI-FILL            PIC X.
  1016             20  EMI-SEVERITY        PIC X.
  1017             20  FILLER              PIC X.
  1018             20  EMI-ERROR-TEXT.
  1019                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1020                 24  FILLER          PIC X(55).
  1021     12  EMI-SEVERITY-SAVE           PIC X.
  1022         88  EMI-NOTE                    VALUE 'N'.
  1023         88  EMI-WARNING                 VALUE 'W'.
  1024         88  EMI-FORCABLE                VALUE 'F'.
  1025         88  EMI-FATAL                   VALUE 'X'.
  1026     12  EMI-MESSAGE-FLAG            PIC X.
  1027         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1028         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1029     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1030     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1031         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  20
* EL6318.cbl
  1032         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1033         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1034     12  emi-claim-no                pic x(7).
  1035     12  emi-claim-type              pic x(6).
  1036     12  FILLER                      PIC X(124)  VALUE SPACES.
  1037     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1038     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1039     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1040     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1041*    COPY ELCINTF.
  1042******************************************************************
  1043*                                                                *
  1044*                                                                *
  1045*                            ELCINTF.                            *
  1046*                            VMOD=2.017                          *
  1047*                                                                *
  1048*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1049*                                                                *
  1050*       LENGTH = 1024                                            *
  1051*                                                                *
  1052******************************************************************
  1053*                   C H A N G E   L O G
  1054*
  1055* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1056*-----------------------------------------------------------------
  1057*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1058* EFFECTIVE    NUMBER
  1059*-----------------------------------------------------------------
  1060* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1061******************************************************************
  1062 01  PROGRAM-INTERFACE-BLOCK.
  1063     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1064     12  PI-CALLING-PROGRAM              PIC X(8).
  1065     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1066     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1067     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1068     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1069     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1070     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1071     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1072     12  PI-COMPANY-ID                   PIC XXX.
  1073     12  PI-COMPANY-CD                   PIC X.
  1074
  1075     12  PI-COMPANY-PASSWORD             PIC X(8).
  1076
  1077     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1078
  1079     12  PI-CONTROL-IN-PROGRESS.
  1080         16  PI-CARRIER                  PIC X.
  1081         16  PI-GROUPING                 PIC X(6).
  1082         16  PI-STATE                    PIC XX.
  1083         16  PI-ACCOUNT                  PIC X(10).
  1084         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1085                                         PIC X(10).
  1086         16  PI-CLAIM-CERT-GRP.
  1087             20  PI-CLAIM-NO             PIC X(7).
  1088             20  PI-CERT-NO.
  1089                 25  PI-CERT-PRIME       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  21
* EL6318.cbl
  1090                 25  PI-CERT-SFX         PIC X.
  1091             20  PI-CERT-EFF-DT          PIC XX.
  1092         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1093             20  PI-PLAN-CODE            PIC X(2).
  1094             20  PI-REVISION-NUMBER      PIC X(3).
  1095             20  PI-PLAN-EFF-DT          PIC X(2).
  1096             20  PI-PLAN-EXP-DT          PIC X(2).
  1097             20  FILLER                  PIC X(11).
  1098         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1099             20  PI-OE-REFERENCE-1.
  1100                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1101                 25  PI-OE-REF-1-SUFF    PIC XX.
  1102
  1103     12  PI-SESSION-IN-PROGRESS          PIC X.
  1104         88  CLAIM-SESSION                   VALUE '1'.
  1105         88  CREDIT-SESSION                  VALUE '2'.
  1106         88  WARRANTY-SESSION                VALUE '3'.
  1107         88  MORTGAGE-SESSION                VALUE '4'.
  1108         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1109
  1110
  1111*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1112
  1113     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1114     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1115
  1116     12  PI-CREDIT-USER                  PIC X.
  1117         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1118         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1119
  1120     12  PI-CLAIM-USER                   PIC X.
  1121         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1122         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1123
  1124     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1125         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1126         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1127         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1128         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1129         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1130
  1131     12  PI-PROCESSOR-ID                 PIC X(4).
  1132
  1133     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1134
  1135     12  PI-MEMBER-CAPTION               PIC X(10).
  1136
  1137     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1138         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1139
  1140     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1141     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1142     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1143     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1144
  1145     12  PI-AH-OVERRIDE-L1               PIC X.
  1146     12  PI-AH-OVERRIDE-L2               PIC XX.
  1147     12  PI-AH-OVERRIDE-L6               PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  22
* EL6318.cbl
  1148     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1149
  1150     12  PI-NEW-SYSTEM                   PIC X(2).
  1151
  1152     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1153     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1154         88  PI-USES-PAID-TO                 VALUE '1'.
  1155     12  PI-CRDTCRD-SYSTEM.
  1156         16  PI-CRDTCRD-USER             PIC X.
  1157             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1158             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1159         16  PI-CC-MONTH-END-DT          PIC XX.
  1160     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1161
  1162     12  PI-OE-REFERENCE-2.
  1163         16  PI-OE-REF-2-PRIME           PIC X(10).
  1164         16  PI-OE-REF-2-SUFF            PIC X.
  1165
  1166     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1167
  1168     12  PI-LANGUAGE-TYPE                PIC X.
  1169             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1170             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1171             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1172
  1173     12  PI-POLICY-LINKAGE-IND           PIC X.
  1174         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1175         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1176                                                   LOW-VALUES.
  1177
  1178     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1179     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1180         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1181         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1182
  1183     12  PI-PROCESSOR-CSR-IND            PIC X.
  1184         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1185         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1186
  1187     12  FILLER                          PIC X(3).
  1188
  1189     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1190
  1191     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1192         PI-SYSTEM-LEVEL.
  1193
  1194         16  PI-ENTRY-CODES.
  1195             20  PI-ENTRY-CD-1           PIC X.
  1196             20  PI-ENTRY-CD-2           PIC X.
  1197
  1198         16  PI-RETURN-CODES.
  1199             20  PI-RETURN-CD-1          PIC X.
  1200             20  PI-RETURN-CD-2          PIC X.
  1201
  1202         16  PI-UPDATE-STATUS-SAVE.
  1203             20  PI-UPDATE-BY            PIC X(4).
  1204             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1205
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  23
* EL6318.cbl
  1206         16  PI-LOWER-CASE-LETTERS       PIC X.
  1207             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1208
  1209*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1210*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1211*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1212
  1213         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1214             88  ST-ACCNT-CNTL               VALUE ' '.
  1215             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1216             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1217             88  ACCNT-CNTL                  VALUE '3'.
  1218             88  CARR-ACCNT-CNTL             VALUE '4'.
  1219
  1220         16  PI-PROCESSOR-CAP-LIST.
  1221             20  PI-SYSTEM-CONTROLS.
  1222                24 PI-SYSTEM-DISPLAY     PIC X.
  1223                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1224                24 PI-SYSTEM-MODIFY      PIC X.
  1225                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1226             20  FILLER                  PIC XX.
  1227             20  PI-DISPLAY-CAP          PIC X.
  1228                 88  DISPLAY-CAP             VALUE 'Y'.
  1229             20  PI-MODIFY-CAP           PIC X.
  1230                 88  MODIFY-CAP              VALUE 'Y'.
  1231             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1232                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1233             20  PI-FORCE-CAP            PIC X.
  1234                 88  FORCE-CAP               VALUE 'Y'.
  1235
  1236         16  PI-PROGRAM-CONTROLS.
  1237             20  PI-PGM-PRINT-OPT        PIC X.
  1238             20  PI-PGM-FORMAT-OPT       PIC X.
  1239             20  PI-PGM-PROCESS-OPT      PIC X.
  1240             20  PI-PGM-TOTALS-OPT       PIC X.
  1241
  1242         16  PI-HELP-INTERFACE.
  1243             20  PI-LAST-ERROR-NO        PIC X(4).
  1244             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1245
  1246         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1247             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1248
  1249         16  PI-CR-CONTROL-IN-PROGRESS.
  1250             20  PI-CR-CARRIER           PIC X.
  1251             20  PI-CR-GROUPING          PIC X(6).
  1252             20  PI-CR-STATE             PIC XX.
  1253             20  PI-CR-ACCOUNT           PIC X(10).
  1254             20  PI-CR-FIN-RESP          PIC X(10).
  1255             20  PI-CR-TYPE              PIC X.
  1256
  1257         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1258
  1259         16  PI-CR-MONTH-END-DT          PIC XX.
  1260
  1261         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1262             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1263             88  PI-ZERO-CARRIER             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  24
* EL6318.cbl
  1264             88  PI-ZERO-GROUPING            VALUE '2'.
  1265             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1266
  1267         16  PI-CARRIER-SECURITY         PIC X.
  1268             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1269
  1270         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1271             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1272             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1273
  1274         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1275             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1276                                         INDEXED BY PI-ACCESS-NDX
  1277                                         PIC X.
  1278
  1279         16  PI-GA-BILLING-CONTROL       PIC X.
  1280             88  PI-GA-BILLING               VALUE '1'.
  1281
  1282         16  PI-MAIL-PROCESSING          PIC X.
  1283             88  PI-MAIL-YES                 VALUE 'Y'.
  1284
  1285         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1286
  1287         16  PI-AR-SYSTEM.
  1288             20  PI-AR-PROCESSING-CNTL   PIC X.
  1289                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1290             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1291             20  PI-AR-MONTH-END-DT      PIC XX.
  1292
  1293         16  PI-MP-SYSTEM.
  1294             20  PI-MORTGAGE-USER            PIC X.
  1295                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1296                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1297             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1298                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1299                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1300                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1301                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1302                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1303             20  PI-MP-MONTH-END-DT          PIC XX.
  1304             20  PI-MP-REFERENCE-NO.
  1305                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1306                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1307
  1308         16  PI-LABEL-CONTROL            PIC X(01).
  1309             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1310             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1311
  1312         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1313             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1314
  1315         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1316             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1317             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1318
  1319         16  FILLER                      PIC X(14).
  1320
  1321     12  PI-PROGRAM-WORK-AREA            PIC X(640).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  25
* EL6318.cbl
  1322******************************************************************
  1323     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  1324        16  PI-ISS-CAN-SW           PIC X.
  1325        16  PI-ERENDT-KEY.
  1326            20  PI-ENDT-COMPANY-CD  PIC X.
  1327            20  PI-ENDT-CARRIER     PIC X.
  1328            20  PI-ENDT-GROUPING    PIC X(6).
  1329            20  PI-ENDT-STATE       PIC XX.
  1330            20  PI-ENDT-ACCOUNT     PIC X(10).
  1331            20  PI-ENDT-CERT-EFF-DT PIC XX.
  1332            20  PI-ENDT-CERT-PRIME  PIC X(10).
  1333            20  PI-ENDT-CERT-SFX    PIC X.
  1334            20  PI-ENDT-RECORD-TYPE PIC X.
  1335            20  PI-ENDT-SEQ-NO      PIC 9(4) BINARY.
  1336        16  PI-ELCRTO-KEY.
  1337            20  PI-CRTO-COMPANY-CD  PIC X.
  1338            20  PI-CRTO-CARRIER     PIC X.
  1339            20  PI-CRTO-GROUPING    PIC X(6).
  1340            20  PI-CRTO-STATE       PIC XX.
  1341            20  PI-CRTO-ACCOUNT     PIC X(10).
  1342            20  PI-CRTO-CERT-EFF-DT PIC XX.
  1343            20  PI-CRTO-CERT-PRIME  PIC X(10).
  1344            20  PI-CRTO-CERT-SFX    PIC X.
  1345            20  PI-CRTO-RECORD-TYPE PIC X.
  1346            20  PI-CRTO-SEQ-NO      PIC 9(4) BINARY.
  1347        16  PI-ERPNDB-KEY           PIC X(11).
  1348        16  PI-DOCUMENT-PROCESSED   PIC X.
  1349            88  PI-VERI-PROCESSED      VALUE 'V'.
  1350            88  PI-ENDO-PROCESSED      VALUE 'G'.
  1351        16  PI-PREV-ERENDT-KEY      PIC X(36).
  1352        16  PI-RES-REF-CLM-TYPE     PIC X.
  1353        16  PI-CLM-REFORM-IND       PIC X.
  1354            88  PI-CLAIM-REFORMATION   VALUE 'Y'.
  1355        16  PI-CLEAR-ERROR-SW       PIC X.
  1356            88  PI-CLEAR-ERROR         VALUE 'Y'.
  1357        16  PI-PRINT-CERTIFICATE    PIC X.
  1358        16  PI-ENTERED.
  1359            20  PI-PRTSW-ENTERED    PIC X.
  1360            20  PI-SIGREQ-ENTERED   PIC X.
  1361            20  PI-LTRID-ENTERED    PIC X(4).
  1362            20  PI-VOUCHER-ENTERED  PIC X.
  1363            20  PI-HLTHAPP-ENTERED  PIC X.
  1364            20  PI-PAYEE-ENTERED    PIC X(10).
  1365            20  PI-CERTID-ENTERED   PIC X(5).
  1366            20  PI-REASONS-ENTERED  PIC X(84).
  1367            20  PI-CERTNT1-ENTERED  PIC X(63).
  1368            20  PI-CERTNT2-ENTERED  PIC X(63).
  1369        16  PI-FINALIZED-IND        PIC X.
  1370        16  PI-CERTNT3-ENTERED      PIC X(63).
  1371        16  PI-CERTNT4-ENTERED      PIC X(63).
  1372        16  PI-BILLNT1-ENTERED      PIC X(63).
  1373        16  PI-BILLNT2-ENTERED      PIC X(63).
  1374        16  PI-REASON-CODE-IND      PIC X(26).
  1375        16  PI-ENCCODE              PIC X(3).
  1376     12  FILLER                     PIC X(276).
  1377*    COPY ELCAID.
  1378******************************************************************
  1379*                                                                *
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  26
* EL6318.cbl
  1380*                            ELCAID.                             *
  1381*                            VMOD=2.001                          *
  1382*                                                                *
  1383*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1384*                                                                *
  1385*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1386*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1387******************************************************************
  1388
  1389 01  DFHAID.
  1390   02  DFHNULL   PIC  X  VALUE  ' '.
  1391   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1392   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1393   02  DFHPEN    PIC  X  VALUE  '='.
  1394   02  DFHOPID   PIC  X  VALUE  'W'.
  1395   02  DFHPA1    PIC  X  VALUE  '%'.
  1396   02  DFHPA2    PIC  X  VALUE  '>'.
  1397   02  DFHPA3    PIC  X  VALUE  ','.
  1398   02  DFHPF1    PIC  X  VALUE  '1'.
  1399   02  DFHPF2    PIC  X  VALUE  '2'.
  1400   02  DFHPF3    PIC  X  VALUE  '3'.
  1401   02  DFHPF4    PIC  X  VALUE  '4'.
  1402   02  DFHPF5    PIC  X  VALUE  '5'.
  1403   02  DFHPF6    PIC  X  VALUE  '6'.
  1404   02  DFHPF7    PIC  X  VALUE  '7'.
  1405   02  DFHPF8    PIC  X  VALUE  '8'.
  1406   02  DFHPF9    PIC  X  VALUE  '9'.
  1407   02  DFHPF10   PIC  X  VALUE  ':'.
  1408   02  DFHPF11   PIC  X  VALUE  '#'.
  1409   02  DFHPF12   PIC  X  VALUE  '@'.
  1410   02  DFHPF13   PIC  X  VALUE  'A'.
  1411   02  DFHPF14   PIC  X  VALUE  'B'.
  1412   02  DFHPF15   PIC  X  VALUE  'C'.
  1413   02  DFHPF16   PIC  X  VALUE  'D'.
  1414   02  DFHPF17   PIC  X  VALUE  'E'.
  1415   02  DFHPF18   PIC  X  VALUE  'F'.
  1416   02  DFHPF19   PIC  X  VALUE  'G'.
  1417   02  DFHPF20   PIC  X  VALUE  'H'.
  1418   02  DFHPF21   PIC  X  VALUE  'I'.
  1419*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1420   02  DFHPF22   PIC  X  VALUE  '['.
  1421   02  DFHPF23   PIC  X  VALUE  '.'.
  1422   02  DFHPF24   PIC  X  VALUE  '<'.
  1423   02  DFHMSRE   PIC  X  VALUE  'X'.
  1424   02  DFHSTRF   PIC  X  VALUE  'h'.
  1425   02  DFHTRIG   PIC  X  VALUE  '"'.
  1426 01  FILLER    REDEFINES DFHAID.
  1427     12  FILLER              PIC X(8).
  1428     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  1429     12  FILLER              PIC X(3).
  1430*   COPY EL6318S.
  1431 01  EL631KI.
  1432     05  FILLER            PIC  X(0012).
  1433*    -------------------------------
  1434     05  DATEL PIC S9(0004) COMP.
  1435     05  DATEF PIC  X(0001).
  1436     05  FILLER REDEFINES DATEF.
  1437         10  DATEA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  27
* EL6318.cbl
  1438     05  DATEI PIC  X(0008).
  1439*    -------------------------------
  1440     05  TIMEL PIC S9(0004) COMP.
  1441     05  TIMEF PIC  X(0001).
  1442     05  FILLER REDEFINES TIMEF.
  1443         10  TIMEA PIC  X(0001).
  1444     05  TIMEI PIC  X(0005).
  1445*    -------------------------------
  1446     05  PROCIDL PIC S9(0004) COMP.
  1447     05  PROCIDF PIC  X(0001).
  1448     05  FILLER REDEFINES PROCIDF.
  1449         10  PROCIDA PIC  X(0001).
  1450     05  PROCIDI PIC  X(0004).
  1451*    -------------------------------
  1452     05  HOSTL PIC S9(0004) COMP.
  1453     05  HOSTF PIC  X(0001).
  1454     05  FILLER REDEFINES HOSTF.
  1455         10  HOSTA PIC  X(0001).
  1456     05  HOSTI PIC  X(0009).
  1457*    -------------------------------
  1458     05  SYSL PIC S9(0004) COMP.
  1459     05  SYSF PIC  X(0001).
  1460     05  FILLER REDEFINES SYSF.
  1461         10  SYSA PIC  X(0001).
  1462     05  SYSI PIC  X(0005).
  1463*    -------------------------------
  1464     05  COMPANYL PIC S9(0004) COMP.
  1465     05  COMPANYF PIC  X(0001).
  1466     05  FILLER REDEFINES COMPANYF.
  1467         10  COMPANYA PIC  X(0001).
  1468     05  COMPANYI PIC  X(0003).
  1469*    -------------------------------
  1470     05  DATASORL PIC S9(0004) COMP.
  1471     05  DATASORF PIC  X(0001).
  1472     05  FILLER REDEFINES DATASORF.
  1473         10  DATASORA PIC  X(0001).
  1474     05  DATASORI PIC  X(0001).
  1475*    -------------------------------
  1476     05  BATCHNOL PIC S9(0004) COMP.
  1477     05  BATCHNOF PIC  X(0001).
  1478     05  FILLER REDEFINES BATCHNOF.
  1479         10  BATCHNOA PIC  X(0001).
  1480     05  BATCHNOI PIC  X(0006).
  1481*    -------------------------------
  1482     05  BSEQNOL PIC S9(0004) COMP.
  1483     05  BSEQNOF PIC  X(0001).
  1484     05  FILLER REDEFINES BSEQNOF.
  1485         10  BSEQNOA PIC  X(0001).
  1486     05  BSEQNOI PIC  X(0008).
  1487*    -------------------------------
  1488     05  ARCHNOL PIC S9(0004) COMP.
  1489     05  ARCHNOF PIC  X(0001).
  1490     05  FILLER REDEFINES ARCHNOF.
  1491         10  ARCHNOA PIC  X(0001).
  1492     05  ARCHNOI PIC  X(0008).
  1493*    -------------------------------
  1494     05  PRTSWL PIC S9(0004) COMP.
  1495     05  PRTSWF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  28
* EL6318.cbl
  1496     05  FILLER REDEFINES PRTSWF.
  1497         10  PRTSWA PIC  X(0001).
  1498     05  PRTSWI PIC  X(0001).
  1499*    -------------------------------
  1500     05  CARRL PIC S9(0004) COMP.
  1501     05  CARRF PIC  X(0001).
  1502     05  FILLER REDEFINES CARRF.
  1503         10  CARRA PIC  X(0001).
  1504     05  CARRI PIC  X(0001).
  1505*    -------------------------------
  1506     05  GROUPL PIC S9(0004) COMP.
  1507     05  GROUPF PIC  X(0001).
  1508     05  FILLER REDEFINES GROUPF.
  1509         10  GROUPA PIC  X(0001).
  1510     05  GROUPI PIC  X(0006).
  1511*    -------------------------------
  1512     05  STATEL PIC S9(0004) COMP.
  1513     05  STATEF PIC  X(0001).
  1514     05  FILLER REDEFINES STATEF.
  1515         10  STATEA PIC  X(0001).
  1516     05  STATEI PIC  X(0002).
  1517*    -------------------------------
  1518     05  ACCTL PIC S9(0004) COMP.
  1519     05  ACCTF PIC  X(0001).
  1520     05  FILLER REDEFINES ACCTF.
  1521         10  ACCTA PIC  X(0001).
  1522     05  ACCTI PIC  X(0010).
  1523*    -------------------------------
  1524     05  EFFDTL PIC S9(0004) COMP.
  1525     05  EFFDTF PIC  X(0001).
  1526     05  FILLER REDEFINES EFFDTF.
  1527         10  EFFDTA PIC  X(0001).
  1528     05  EFFDTI PIC  X(0008).
  1529*    -------------------------------
  1530     05  CERTNOL PIC S9(0004) COMP.
  1531     05  CERTNOF PIC  X(0001).
  1532     05  FILLER REDEFINES CERTNOF.
  1533         10  CERTNOA PIC  X(0001).
  1534     05  CERTNOI PIC  X(0010).
  1535*    -------------------------------
  1536     05  CRTSFXL PIC S9(0004) COMP.
  1537     05  CRTSFXF PIC  X(0001).
  1538     05  FILLER REDEFINES CRTSFXF.
  1539         10  CRTSFXA PIC  X(0001).
  1540     05  CRTSFXI PIC  X(0001).
  1541*    -------------------------------
  1542     05  SEQNOL PIC S9(0004) COMP.
  1543     05  SEQNOF PIC  X(0001).
  1544     05  FILLER REDEFINES SEQNOF.
  1545         10  SEQNOA PIC  X(0001).
  1546     05  SEQNOI PIC  X(0006).
  1547*    -------------------------------
  1548     05  SIGREQL PIC S9(0004) COMP.
  1549     05  SIGREQF PIC  X(0001).
  1550     05  FILLER REDEFINES SIGREQF.
  1551         10  SIGREQA PIC  X(0001).
  1552     05  SIGREQI PIC  X(0001).
  1553*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  29
* EL6318.cbl
  1554     05  LTRIDL PIC S9(0004) COMP.
  1555     05  LTRIDF PIC  X(0001).
  1556     05  FILLER REDEFINES LTRIDF.
  1557         10  LTRIDA PIC  X(0001).
  1558     05  LTRIDI PIC  X(0004).
  1559*    -------------------------------
  1560     05  HLTHAPPL PIC S9(0004) COMP.
  1561     05  HLTHAPPF PIC  X(0001).
  1562     05  FILLER REDEFINES HLTHAPPF.
  1563         10  HLTHAPPA PIC  X(0001).
  1564     05  HLTHAPPI PIC  X(0001).
  1565*    -------------------------------
  1566     05  VOUCHL PIC S9(0004) COMP.
  1567     05  VOUCHF PIC  X(0001).
  1568     05  FILLER REDEFINES VOUCHF.
  1569         10  VOUCHA PIC  X(0001).
  1570     05  VOUCHI PIC  X(0001).
  1571*    -------------------------------
  1572     05  PAYEEL PIC S9(0004) COMP.
  1573     05  PAYEEF PIC  X(0001).
  1574     05  FILLER REDEFINES PAYEEF.
  1575         10  PAYEEA PIC  X(0001).
  1576     05  PAYEEI PIC  X(0010).
  1577*    -------------------------------
  1578     05  CERTIDL PIC S9(0004) COMP.
  1579     05  CERTIDF PIC  X(0001).
  1580     05  FILLER REDEFINES CERTIDF.
  1581         10  CERTIDA PIC  X(0001).
  1582     05  CERTIDI PIC  X(0005).
  1583*    -------------------------------
  1584     05  ENCCODEL PIC S9(0004) COMP.
  1585     05  ENCCODEF PIC  X(0001).
  1586     05  FILLER REDEFINES ENCCODEF.
  1587         10  ENCCODEA PIC  X(0001).
  1588     05  ENCCODEI PIC  X(0003).
  1589*    -------------------------------
  1590     05  RCD01L PIC S9(0004) COMP.
  1591     05  RCD01F PIC  X(0001).
  1592     05  FILLER REDEFINES RCD01F.
  1593         10  RCD01A PIC  X(0001).
  1594     05  RCD01I PIC  X(0004).
  1595*    -------------------------------
  1596     05  RCD02L PIC S9(0004) COMP.
  1597     05  RCD02F PIC  X(0001).
  1598     05  FILLER REDEFINES RCD02F.
  1599         10  RCD02A PIC  X(0001).
  1600     05  RCD02I PIC  X(0004).
  1601*    -------------------------------
  1602     05  RCD03L PIC S9(0004) COMP.
  1603     05  RCD03F PIC  X(0001).
  1604     05  FILLER REDEFINES RCD03F.
  1605         10  RCD03A PIC  X(0001).
  1606     05  RCD03I PIC  X(0004).
  1607*    -------------------------------
  1608     05  RCD04L PIC S9(0004) COMP.
  1609     05  RCD04F PIC  X(0001).
  1610     05  FILLER REDEFINES RCD04F.
  1611         10  RCD04A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  30
* EL6318.cbl
  1612     05  RCD04I PIC  X(0004).
  1613*    -------------------------------
  1614     05  RCD05L PIC S9(0004) COMP.
  1615     05  RCD05F PIC  X(0001).
  1616     05  FILLER REDEFINES RCD05F.
  1617         10  RCD05A PIC  X(0001).
  1618     05  RCD05I PIC  X(0004).
  1619*    -------------------------------
  1620     05  RCD06L PIC S9(0004) COMP.
  1621     05  RCD06F PIC  X(0001).
  1622     05  FILLER REDEFINES RCD06F.
  1623         10  RCD06A PIC  X(0001).
  1624     05  RCD06I PIC  X(0004).
  1625*    -------------------------------
  1626     05  RCD07L PIC S9(0004) COMP.
  1627     05  RCD07F PIC  X(0001).
  1628     05  FILLER REDEFINES RCD07F.
  1629         10  RCD07A PIC  X(0001).
  1630     05  RCD07I PIC  X(0004).
  1631*    -------------------------------
  1632     05  RCD08L PIC S9(0004) COMP.
  1633     05  RCD08F PIC  X(0001).
  1634     05  FILLER REDEFINES RCD08F.
  1635         10  RCD08A PIC  X(0001).
  1636     05  RCD08I PIC  X(0004).
  1637*    -------------------------------
  1638     05  RCD09L PIC S9(0004) COMP.
  1639     05  RCD09F PIC  X(0001).
  1640     05  FILLER REDEFINES RCD09F.
  1641         10  RCD09A PIC  X(0001).
  1642     05  RCD09I PIC  X(0004).
  1643*    -------------------------------
  1644     05  RCD10L PIC S9(0004) COMP.
  1645     05  RCD10F PIC  X(0001).
  1646     05  FILLER REDEFINES RCD10F.
  1647         10  RCD10A PIC  X(0001).
  1648     05  RCD10I PIC  X(0004).
  1649*    -------------------------------
  1650     05  RCD11L PIC S9(0004) COMP.
  1651     05  RCD11F PIC  X(0001).
  1652     05  FILLER REDEFINES RCD11F.
  1653         10  RCD11A PIC  X(0001).
  1654     05  RCD11I PIC  X(0004).
  1655*    -------------------------------
  1656     05  RCD12L PIC S9(0004) COMP.
  1657     05  RCD12F PIC  X(0001).
  1658     05  FILLER REDEFINES RCD12F.
  1659         10  RCD12A PIC  X(0001).
  1660     05  RCD12I PIC  X(0004).
  1661*    -------------------------------
  1662     05  CRTNT1L PIC S9(0004) COMP.
  1663     05  CRTNT1F PIC  X(0001).
  1664     05  FILLER REDEFINES CRTNT1F.
  1665         10  CRTNT1A PIC  X(0001).
  1666     05  CRTNT1I PIC  X(0063).
  1667*    -------------------------------
  1668     05  CRTNT2L PIC S9(0004) COMP.
  1669     05  CRTNT2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  31
* EL6318.cbl
  1670     05  FILLER REDEFINES CRTNT2F.
  1671         10  CRTNT2A PIC  X(0001).
  1672     05  CRTNT2I PIC  X(0063).
  1673*    -------------------------------
  1674     05  CRTNT3L PIC S9(0004) COMP.
  1675     05  CRTNT3F PIC  X(0001).
  1676     05  FILLER REDEFINES CRTNT3F.
  1677         10  CRTNT3A PIC  X(0001).
  1678     05  CRTNT3I PIC  X(0063).
  1679*    -------------------------------
  1680     05  CRTNT4L PIC S9(0004) COMP.
  1681     05  CRTNT4F PIC  X(0001).
  1682     05  FILLER REDEFINES CRTNT4F.
  1683         10  CRTNT4A PIC  X(0001).
  1684     05  CRTNT4I PIC  X(0063).
  1685*    -------------------------------
  1686     05  BILNT1L PIC S9(0004) COMP.
  1687     05  BILNT1F PIC  X(0001).
  1688     05  FILLER REDEFINES BILNT1F.
  1689         10  BILNT1A PIC  X(0001).
  1690     05  BILNT1I PIC  X(0063).
  1691*    -------------------------------
  1692     05  BILNT2L PIC S9(0004) COMP.
  1693     05  BILNT2F PIC  X(0001).
  1694     05  FILLER REDEFINES BILNT2F.
  1695         10  BILNT2A PIC  X(0001).
  1696     05  BILNT2I PIC  X(0063).
  1697*    -------------------------------
  1698     05  ERRMSG1L PIC S9(0004) COMP.
  1699     05  ERRMSG1F PIC  X(0001).
  1700     05  FILLER REDEFINES ERRMSG1F.
  1701         10  ERRMSG1A PIC  X(0001).
  1702     05  ERRMSG1I PIC  X(0075).
  1703*    -------------------------------
  1704     05  ERRMSG2L PIC S9(0004) COMP.
  1705     05  ERRMSG2F PIC  X(0001).
  1706     05  FILLER REDEFINES ERRMSG2F.
  1707         10  ERRMSG2A PIC  X(0001).
  1708     05  ERRMSG2I PIC  X(0075).
  1709*    -------------------------------
  1710     05  PFENTRL PIC S9(0004) COMP.
  1711     05  PFENTRF PIC  X(0001).
  1712     05  FILLER REDEFINES PFENTRF.
  1713         10  PFENTRA PIC  X(0001).
  1714     05  PFENTRI PIC  9(2).
  1715 01  EL631KO REDEFINES EL631KI.
  1716     05  FILLER            PIC  X(0012).
  1717*    -------------------------------
  1718     05  FILLER            PIC  X(0003).
  1719     05  DATEO PIC  X(0008).
  1720*    -------------------------------
  1721     05  FILLER            PIC  X(0003).
  1722     05  TIMEO PIC  99.99.
  1723*    -------------------------------
  1724     05  FILLER            PIC  X(0003).
  1725     05  PROCIDO PIC  X(0004).
  1726*    -------------------------------
  1727     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  32
* EL6318.cbl
  1728     05  HOSTO PIC  X(0009).
  1729*    -------------------------------
  1730     05  FILLER            PIC  X(0003).
  1731     05  SYSO PIC  X(0005).
  1732*    -------------------------------
  1733     05  FILLER            PIC  X(0003).
  1734     05  COMPANYO PIC  X(0003).
  1735*    -------------------------------
  1736     05  FILLER            PIC  X(0003).
  1737     05  DATASORO PIC  X(0001).
  1738*    -------------------------------
  1739     05  FILLER            PIC  X(0003).
  1740     05  BATCHNOO PIC  X(0006).
  1741*    -------------------------------
  1742     05  FILLER            PIC  X(0003).
  1743     05  BSEQNOO PIC  X(0008).
  1744*    -------------------------------
  1745     05  FILLER            PIC  X(0003).
  1746     05  ARCHNOO PIC  X(0008).
  1747*    -------------------------------
  1748     05  FILLER            PIC  X(0003).
  1749     05  PRTSWO PIC  X(0001).
  1750*    -------------------------------
  1751     05  FILLER            PIC  X(0003).
  1752     05  CARRO PIC  X(0001).
  1753*    -------------------------------
  1754     05  FILLER            PIC  X(0003).
  1755     05  GROUPO PIC  X(0006).
  1756*    -------------------------------
  1757     05  FILLER            PIC  X(0003).
  1758     05  STATEO PIC  X(0002).
  1759*    -------------------------------
  1760     05  FILLER            PIC  X(0003).
  1761     05  ACCTO PIC  X(0010).
  1762*    -------------------------------
  1763     05  FILLER            PIC  X(0003).
  1764     05  EFFDTO PIC  X(0008).
  1765*    -------------------------------
  1766     05  FILLER            PIC  X(0003).
  1767     05  CERTNOO PIC  X(0010).
  1768*    -------------------------------
  1769     05  FILLER            PIC  X(0003).
  1770     05  CRTSFXO PIC  X(0001).
  1771*    -------------------------------
  1772     05  FILLER            PIC  X(0003).
  1773     05  SEQNOO PIC  999999.
  1774*    -------------------------------
  1775     05  FILLER            PIC  X(0003).
  1776     05  SIGREQO PIC  X(0001).
  1777*    -------------------------------
  1778     05  FILLER            PIC  X(0003).
  1779     05  LTRIDO PIC  X(0004).
  1780*    -------------------------------
  1781     05  FILLER            PIC  X(0003).
  1782     05  HLTHAPPO PIC  X(0001).
  1783*    -------------------------------
  1784     05  FILLER            PIC  X(0003).
  1785     05  VOUCHO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  33
* EL6318.cbl
  1786*    -------------------------------
  1787     05  FILLER            PIC  X(0003).
  1788     05  PAYEEO PIC  X(0010).
  1789*    -------------------------------
  1790     05  FILLER            PIC  X(0003).
  1791     05  CERTIDO PIC  X(0005).
  1792*    -------------------------------
  1793     05  FILLER            PIC  X(0003).
  1794     05  ENCCODEO PIC  X(0003).
  1795*    -------------------------------
  1796     05  FILLER            PIC  X(0003).
  1797     05  RCD01O PIC  X(0004).
  1798*    -------------------------------
  1799     05  FILLER            PIC  X(0003).
  1800     05  RCD02O PIC  X(0004).
  1801*    -------------------------------
  1802     05  FILLER            PIC  X(0003).
  1803     05  RCD03O PIC  X(0004).
  1804*    -------------------------------
  1805     05  FILLER            PIC  X(0003).
  1806     05  RCD04O PIC  X(0004).
  1807*    -------------------------------
  1808     05  FILLER            PIC  X(0003).
  1809     05  RCD05O PIC  X(0004).
  1810*    -------------------------------
  1811     05  FILLER            PIC  X(0003).
  1812     05  RCD06O PIC  X(0004).
  1813*    -------------------------------
  1814     05  FILLER            PIC  X(0003).
  1815     05  RCD07O PIC  X(0004).
  1816*    -------------------------------
  1817     05  FILLER            PIC  X(0003).
  1818     05  RCD08O PIC  X(0004).
  1819*    -------------------------------
  1820     05  FILLER            PIC  X(0003).
  1821     05  RCD09O PIC  X(0004).
  1822*    -------------------------------
  1823     05  FILLER            PIC  X(0003).
  1824     05  RCD10O PIC  X(0004).
  1825*    -------------------------------
  1826     05  FILLER            PIC  X(0003).
  1827     05  RCD11O PIC  X(0004).
  1828*    -------------------------------
  1829     05  FILLER            PIC  X(0003).
  1830     05  RCD12O PIC  X(0004).
  1831*    -------------------------------
  1832     05  FILLER            PIC  X(0003).
  1833     05  CRTNT1O PIC  X(0063).
  1834*    -------------------------------
  1835     05  FILLER            PIC  X(0003).
  1836     05  CRTNT2O PIC  X(0063).
  1837*    -------------------------------
  1838     05  FILLER            PIC  X(0003).
  1839     05  CRTNT3O PIC  X(0063).
  1840*    -------------------------------
  1841     05  FILLER            PIC  X(0003).
  1842     05  CRTNT4O PIC  X(0063).
  1843*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  34
* EL6318.cbl
  1844     05  FILLER            PIC  X(0003).
  1845     05  BILNT1O PIC  X(0063).
  1846*    -------------------------------
  1847     05  FILLER            PIC  X(0003).
  1848     05  BILNT2O PIC  X(0063).
  1849*    -------------------------------
  1850     05  FILLER            PIC  X(0003).
  1851     05  ERRMSG1O PIC  X(0075).
  1852*    -------------------------------
  1853     05  FILLER            PIC  X(0003).
  1854     05  ERRMSG2O PIC  X(0075).
  1855*    -------------------------------
  1856     05  FILLER            PIC  X(0003).
  1857     05  PFENTRO PIC  X(0002).
  1858*    -------------------------------
  1859 01  FILLER REDEFINES EL631KI.
  1860     12  FILLER             PIC X(217).
  1861     12  REASONCDS.
  1862         16  FILLER OCCURS 12.
  1863           20  REACDL       PIC S9(4) COMP.
  1864           20  REACDA       PIC X.
  1865           20  REACD-IN     PIC X(4).
  1866     12  FILLER             PIC X(557).
  1867****************************************************************
  1868*
  1869* Copyright (c) 2007 by Clerity Solutions, Inc.
  1870* All rights reserved.
  1871*
  1872****************************************************************
  1873 01  DFHEIV.
  1874   02  DFHEIV0               PIC X(35).
  1875   02  DFHEIV1               PIC X(08).
  1876   02  DFHEIV2               PIC X(08).
  1877   02  DFHEIV3               PIC X(08).
  1878   02  DFHEIV4               PIC X(06).
  1879   02  DFHEIV5               PIC X(04).
  1880   02  DFHEIV6               PIC X(04).
  1881   02  DFHEIV7               PIC X(02).
  1882   02  DFHEIV8               PIC X(02).
  1883   02  DFHEIV9               PIC X(01).
  1884   02  DFHEIV10              PIC S9(7) COMP-3.
  1885   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1886   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1887   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1888   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1889   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1890   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1891   02  DFHEIV17              PIC X(04).
  1892   02  DFHEIV18              PIC X(04).
  1893   02  DFHEIV19              PIC X(04).
  1894   02  DFHEIV20              USAGE IS POINTER.
  1895   02  DFHEIV21              USAGE IS POINTER.
  1896   02  DFHEIV22              USAGE IS POINTER.
  1897   02  DFHEIV23              USAGE IS POINTER.
  1898   02  DFHEIV24              USAGE IS POINTER.
  1899   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1900   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1901   02  DFHEIV27              PIC S9(9) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  35
* EL6318.cbl
  1902   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1903   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1904   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1905   02  FILLER                PIC X(02).
  1906   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1907   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1908   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1909   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1910   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1911 LINKAGE  SECTION.
  1912*****************************************************************
  1913*                                                               *
  1914* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1915* All rights reserved.                                          *
  1916*                                                               *
  1917*****************************************************************
  1918 01  dfheiblk.
  1919     02  eibtime          pic s9(7) comp-3.
  1920     02  eibdate          pic s9(7) comp-3.
  1921     02  eibtrnid         pic x(4).
  1922     02  eibtaskn         pic s9(7) comp-3.
  1923     02  eibtrmid         pic x(4).
  1924     02  dfheigdi         pic s9(4) comp.
  1925     02  eibcposn         pic s9(4) comp.
  1926     02  eibcalen         pic s9(4) comp.
  1927     02  eibaid           pic x(1).
  1928     02  eibfiller1       pic x(1).
  1929     02  eibfn            pic x(2).
  1930     02  eibfiller2       pic x(2).
  1931     02  eibrcode         pic x(6).
  1932     02  eibfiller3       pic x(2).
  1933     02  eibds            pic x(8).
  1934     02  eibreqid         pic x(8).
  1935     02  eibrsrce         pic x(8).
  1936     02  eibsync          pic x(1).
  1937     02  eibfree          pic x(1).
  1938     02  eibrecv          pic x(1).
  1939     02  eibsend          pic x(1).
  1940     02  eibatt           pic x(1).
  1941     02  eibeoc           pic x(1).
  1942     02  eibfmh           pic x(1).
  1943     02  eibcompl         pic x(1).
  1944     02  eibsig           pic x(1).
  1945     02  eibconf          pic x(1).
  1946     02  eiberr           pic x(1).
  1947     02  eibrldbk         pic x(1).
  1948     02  eiberrcd         pic x(4).
  1949     02  eibsynrb         pic x(1).
  1950     02  eibnodat         pic x(1).
  1951     02  eibfiller5       pic x(2).
  1952     02  eibresp          pic 9(09) comp.
  1953     02  eibresp2         pic 9(09) comp.
  1954     02  dfheigdj         pic s9(4) comp.
  1955     02  dfheigdk         pic s9(4) comp.
  1956 01  DFHCOMMAREA                 PIC X(1300).
  1957 01  var  pic x(30).
  1958*                                COPY ERCACCT.
  1959******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  36
* EL6318.cbl
  1960*                                                                *
  1961*                                                                *
  1962*                            ERCACCT                             *
  1963*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1964*                            VMOD=2.031                          *
  1965*                                                                *
  1966*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1967*                                                                *
  1968*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1969*   VSAM ACCOUNT MASTER FILES.                                   *
  1970*                                                                *
  1971*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1972*                                                                *
  1973*   FILE TYPE = VSAM,KSDS                                        *
  1974*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1975*                                                                *
  1976*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1977*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1978*                                                                *
  1979*   LOG = NO                                                     *
  1980*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1981*                                                                *
  1982*                                                                *
  1983******************************************************************
  1984*                   C H A N G E   L O G
  1985*
  1986* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1987*-----------------------------------------------------------------
  1988*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1989* EFFECTIVE    NUMBER
  1990*-----------------------------------------------------------------
  1991* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1992* 092705    2005050300006  PEMA  ADD SPP LEASES
  1993* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1994* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1995* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1996* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1997* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1998******************************************************************
  1999
  2000 01  ACCOUNT-MASTER.
  2001     12  AM-RECORD-ID                      PIC XX.
  2002         88  VALID-AM-ID                      VALUE 'AM'.
  2003
  2004     12  AM-CONTROL-PRIMARY.
  2005         16  AM-COMPANY-CD                 PIC X.
  2006         16  AM-MSTR-CNTRL.
  2007             20  AM-CONTROL-A.
  2008                 24  AM-CARRIER            PIC X.
  2009                 24  AM-GROUPING.
  2010                     28 AM-GROUPING-PREFIX PIC XXX.
  2011                     28 AM-GROUPING-PRIME  PIC XXX.
  2012                 24  AM-STATE              PIC XX.
  2013                 24  AM-ACCOUNT.
  2014                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2015                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2016             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2017                                           PIC X(19).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  37
* EL6318.cbl
  2018             20  AM-CNTRL-B.
  2019                 24  AM-EXPIRATION-DT      PIC XX.
  2020                 24  FILLER                PIC X(4).
  2021             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2022                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2023
  2024     12  AM-CONTROL-BY-VAR-GRP.
  2025         16  AM-COMPANY-CD-A1              PIC X.
  2026         16  AM-VG-CARRIER                 PIC X.
  2027         16  AM-VG-GROUPING                PIC X(6).
  2028         16  AM-VG-STATE                   PIC XX.
  2029         16  AM-VG-ACCOUNT                 PIC X(10).
  2030         16  AM-VG-DATE.
  2031             20  AM-VG-EXPIRATION-DT       PIC XX.
  2032             20  FILLER                    PIC X(4).
  2033         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2034                                           PIC 9(11)      COMP-3.
  2035     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2036         16  FILLER                        PIC X(10).
  2037         16  AM-VG-KEY3.
  2038             20  AM-VG3-ACCOUNT            PIC X(10).
  2039             20  AM-VG3-EXP-DT             PIC XX.
  2040         16  FILLER                        PIC X(4).
  2041     12  AM-MAINT-INFORMATION.
  2042         16  AM-LAST-MAINT-DT              PIC XX.
  2043         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2044         16  AM-LAST-MAINT-USER            PIC X(4).
  2045         16  FILLER                        PIC XX.
  2046
  2047     12  AM-EFFECTIVE-DT                   PIC XX.
  2048     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2049
  2050     12  AM-PREV-DATES  COMP-3.
  2051         16  AM-PREV-EXP-DT                PIC 9(11).
  2052         16  AM-PREV-EFF-DT                PIC 9(11).
  2053
  2054     12  AM-REPORT-CODE-1                  PIC X(10).
  2055     12  AM-REPORT-CODE-2                  PIC X(10).
  2056
  2057     12  AM-CITY-CODE                      PIC X(4).
  2058     12  AM-COUNTY-PARISH                  PIC X(6).
  2059
  2060     12  AM-NAME                           PIC X(30).
  2061     12  AM-PERSON                         PIC X(30).
  2062     12  AM-ADDRS                          PIC X(30).
  2063     12  AM-CITY.
  2064         16  AM-ADDR-CITY                  PIC X(28).
  2065         16  AM-ADDR-STATE                 PIC XX.
  2066     12  AM-ZIP.
  2067         16  AM-ZIP-PRIME.
  2068             20  AM-ZIP-PRI-1ST            PIC X.
  2069                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2070             20  FILLER                    PIC X(4).
  2071         16  AM-ZIP-PLUS4                  PIC X(4).
  2072     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2073         16  AM-CAN-POSTAL-1               PIC XXX.
  2074         16  AM-CAN-POSTAL-2               PIC XXX.
  2075         16  FILLER                        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  38
* EL6318.cbl
  2076     12  AM-TEL-NO.
  2077         16  AM-AREA-CODE                  PIC 999.
  2078         16  AM-TEL-PRE                    PIC 999.
  2079         16  AM-TEL-NBR                    PIC 9(4).
  2080     12  AM-TEL-LOC                        PIC X.
  2081         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2082         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2083
  2084     12  AM-COMM-STRUCTURE.
  2085         16  AM-DEFN-1.
  2086             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2087                 24  AM-AGT.
  2088                     28  AM-AGT-PREFIX     PIC X(4).
  2089                     28  AM-AGT-PRIME      PIC X(6).
  2090                 24  AM-COM-TYP            PIC X.
  2091                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2092                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2093                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2094                 24  AM-RECALC-LV-INDIC    PIC X.
  2095                 24  AM-RETRO-LV-INDIC     PIC X.
  2096                 24  AM-GL-CODES           PIC X.
  2097                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2098                 24  FILLER                PIC X(01).
  2099         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2100             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2101                 24  FILLER                PIC X(11).
  2102                 24  AM-L-COMA             PIC XXX.
  2103                 24  AM-J-COMA             PIC XXX.
  2104                 24  AM-A-COMA             PIC XXX.
  2105                 24  FILLER                PIC X(6).
  2106
  2107     12  AM-COMM-CHANGE-STATUS             PIC X.
  2108         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2109
  2110     12  AM-CSR-CODE                       PIC X(4).
  2111
  2112     12  AM-BILLING-STATUS                 PIC X.
  2113         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2114         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2115     12  AM-AUTO-REFUND-SW                 PIC X.
  2116         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2117         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2118     12  AM-GPCD                           PIC 99.
  2119     12  AM-IG                             PIC X.
  2120         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2121         88  AM-HAS-GROUP                     VALUE '2'.
  2122     12  AM-STATUS                         PIC X.
  2123         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2124         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2125         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2126         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2127         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2128         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2129     12  AM-REMIT-TO                       PIC 99.
  2130     12  AM-ID-NO                          PIC X(11).
  2131
  2132     12  AM-CAL-TABLE                      PIC XX.
  2133     12  AM-LF-DEVIATION                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  39
* EL6318.cbl
  2134     12  AM-AH-DEVIATION                   PIC XXX.
  2135     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2136     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2137     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2138     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2139     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2140     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2141
  2142     12  AM-USER-FIELDS.
  2143         16  AM-FLD-1                      PIC XX.
  2144         16  AM-FLD-2                      PIC XX.
  2145         16  AM-FLD-3                      PIC XX.
  2146         16  AM-FLD-4                      PIC XX.
  2147         16  AM-FLD-5                      PIC XX.
  2148
  2149     12  AM-1ST-PROD-DATE.
  2150         16  AM-1ST-PROD-YR                PIC XX.
  2151         16  AM-1ST-PROD-MO                PIC XX.
  2152         16  AM-1ST-PROD-DA                PIC XX.
  2153     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2154     12  AM-CERTS-PURGED-DATE.
  2155         16  AM-PUR-YR                     PIC XX.
  2156         16  AM-PUR-MO                     PIC XX.
  2157         16  AM-PUR-DA                     PIC XX.
  2158     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2159     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2160     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2161     12  AM-INACTIVE-DATE.
  2162         16  AM-INA-MO                     PIC 99.
  2163         16  AM-INA-DA                     PIC 99.
  2164         16  AM-INA-YR                     PIC 99.
  2165     12  AM-AR-HI-CERT-DATE                PIC XX.
  2166
  2167     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2168     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2169
  2170     12  AM-OB-PAYMENT-MODE                PIC X.
  2171         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2172         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2173         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2174         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2175
  2176     12  AM-AH-ONLY-INDICATOR              PIC X.
  2177         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2178         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2179
  2180     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2181
  2182     12  AM-OVER-SHORT.
  2183         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2184         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2185
  2186     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2187     12  AM-DCC-CLP-STATE                  PIC XX.
  2188
  2189     12  AM-RECALC-COMM                    PIC X.
  2190     12  AM-RECALC-REIN                    PIC X.
  2191
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  40
* EL6318.cbl
  2192     12  AM-REI-TABLE                      PIC XXX.
  2193     12  AM-REI-ET-LF                      PIC X.
  2194     12  AM-REI-ET-AH                      PIC X.
  2195     12  AM-REI-PE-LF                      PIC X.
  2196     12  AM-REI-PE-AH                      PIC X.
  2197     12  AM-REI-PRT-ST                     PIC X.
  2198     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2199     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2200     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2201     12  AM-REI-GROUP-A                    PIC X(6).
  2202     12  AM-REI-MORT                       PIC X(4).
  2203     12  AM-REI-PRT-OW                     PIC X.
  2204     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2205     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2206     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2207     12  AM-REI-GROUP-B                    PIC X(6).
  2208
  2209     12  AM-TRUST-TYPE                     PIC X(2).
  2210
  2211     12  AM-EMPLOYER-STMT-USED             PIC X.
  2212     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2213
  2214     12  AM-STD-AH-TYPE                    PIC XX.
  2215     12  AM-EARN-METHODS.
  2216         16  AM-EARN-METHOD-R              PIC X.
  2217             88 AM-REF-RL-R78                 VALUE 'R'.
  2218             88 AM-REF-RL-PR                  VALUE 'P'.
  2219             88 AM-REF-RL-MEAN                VALUE 'M'.
  2220             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2221         16  AM-EARN-METHOD-L              PIC X.
  2222             88 AM-REF-LL-R78                 VALUE 'R'.
  2223             88 AM-REF-LL-PR                  VALUE 'P'.
  2224             88 AM-REF-LL-MEAN                VALUE 'M'.
  2225             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2226         16  AM-EARN-METHOD-A              PIC X.
  2227             88 AM-REF-AH-R78                 VALUE 'R'.
  2228             88 AM-REF-AH-PR                  VALUE 'P'.
  2229             88 AM-REF-AH-MEAN                VALUE 'M'.
  2230             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2231             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2232             88 AM-REF-AH-NET                 VALUE 'N'.
  2233
  2234     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2235     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2236     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2237
  2238     12  AM-RET-Y-N                        PIC X.
  2239     12  AM-RET-P-E                        PIC X.
  2240     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2241     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2242     12  AM-RET-GRP                        PIC X(6).
  2243     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2244         16  AM-POOL-PRIME                 PIC XXX.
  2245         16  AM-POOL-SUB                   PIC XXX.
  2246     12  AM-RETRO-EARNINGS.
  2247         16  AM-RET-EARN-R                 PIC X.
  2248         16  AM-RET-EARN-L                 PIC X.
  2249         16  AM-RET-EARN-A                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  41
* EL6318.cbl
  2250     12  AM-RET-ST-TAX-USE                 PIC X.
  2251         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2252         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2253     12  AM-RETRO-BEG-EARNINGS.
  2254         16  AM-RET-BEG-EARN-R             PIC X.
  2255         16  AM-RET-BEG-EARN-L             PIC X.
  2256         16  AM-RET-BEG-EARN-A             PIC X.
  2257     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2258     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2259
  2260     12  AM-USER-SELECT-OPTIONS.
  2261         16  AM-USER-SELECT-1              PIC X(10).
  2262         16  AM-USER-SELECT-2              PIC X(10).
  2263         16  AM-USER-SELECT-3              PIC X(10).
  2264         16  AM-USER-SELECT-4              PIC X(10).
  2265         16  AM-USER-SELECT-5              PIC X(10).
  2266
  2267     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2268
  2269     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2270
  2271     12  AM-RPT045A-SWITCH                 PIC X.
  2272         88  RPT045A-OFF                   VALUE 'N'.
  2273
  2274     12  AM-INSURANCE-LIMITS.
  2275         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2276         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2277
  2278     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2279         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2280
  2281     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2282         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2283         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2284
  2285     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2286
  2287     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2288     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2289     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2290     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2291     12  AM-DCC-UEF-STATE                  PIC XX.
  2292     12  FILLER                            PIC XXX.
  2293     12  AM-REPORT-CODE-3                  PIC X(10).
  2294*    12  FILLER                            PIC X(22).
  2295
  2296     12  AM-RESERVE-DATE.
  2297         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2298         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2299         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2300
  2301     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2302     12  AM-NOTIFICATION-TYPES.
  2303         16  AM-NOTIF-OF-LETTERS           PIC X.
  2304         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2305         16  AM-NOTIF-OF-REPORTS           PIC X.
  2306         16  AM-NOTIF-OF-STATUS            PIC X.
  2307
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  42
* EL6318.cbl
  2308     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2309         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2310         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2311         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2312         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2313
  2314     12  AM-BENEFIT-CONTROLS.
  2315         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2316             20  AM-BENEFIT-CODE           PIC XX.
  2317             20  AM-BENEFIT-TYPE           PIC X.
  2318             20  AM-BENEFIT-REVISION       PIC XXX.
  2319             20  AM-BENEFIT-REM-TERM       PIC X.
  2320             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2321             20  FILLER                    PIC XX.
  2322         16  FILLER                        PIC X(80).
  2323
  2324     12  AM-TRANSFER-DATA.
  2325         16  AM-TRANSFERRED-FROM.
  2326             20  AM-TRNFROM-CARRIER        PIC X.
  2327             20  AM-TRNFROM-GROUPING.
  2328                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2329                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2330             20  AM-TRNFROM-STATE          PIC XX.
  2331             20  AM-TRNFROM-ACCOUNT.
  2332                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2333                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2334             20  AM-TRNFROM-DTE            PIC XX.
  2335         16  AM-TRANSFERRED-TO.
  2336             20  AM-TRNTO-CARRIER          PIC X.
  2337             20  AM-TRNTO-GROUPING.
  2338                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2339                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2340             20  AM-TRNTO-STATE            PIC XX.
  2341             20  AM-TRNTO-ACCOUNT.
  2342                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2343                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2344             20  AM-TRNTO-DTE              PIC XX.
  2345         16  FILLER                        PIC X(10).
  2346
  2347     12  AM-SAVED-REMIT-TO                 PIC 99.
  2348
  2349     12  AM-COMM-STRUCTURE-SAVED.
  2350         16  AM-DEFN-1-SAVED.
  2351             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2352                 24  AM-AGT-SV             PIC X(10).
  2353                 24  AM-COM-TYP-SV         PIC X.
  2354                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2355                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2356                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2357                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2358                 24  FILLER                PIC X.
  2359                 24  AM-GL-CODES-SV        PIC X.
  2360                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2361                 24  FILLER                PIC X.
  2362         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2363             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2364                 24  FILLER                PIC X(11).
  2365                 24  AM-L-COMA-SV          PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  43
* EL6318.cbl
  2366                 24  AM-J-COMA-SV          PIC XXX.
  2367                 24  AM-A-COMA-SV          PIC XXX.
  2368                 24  FILLER                PIC X(6).
  2369
  2370     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2371         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2372            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2373            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2374            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2375
  2376     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2377     12  FILLER                            PIC X(120).
  2378
  2379     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2380         16  AM-CONTROL-NAME               PIC X(30).
  2381         16  AM-EXECUTIVE-ONE.
  2382             20  AM-EXEC1-NAME             PIC X(15).
  2383             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2384                                                          COMP-3.
  2385             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2386                                                          COMP-3.
  2387         16  AM-EXECUTIVE-TWO.
  2388             20  AM-EXEC2-NAME             PIC X(15).
  2389             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2390                                                          COMP-3.
  2391             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2392                                                          COMP-3.
  2393
  2394     12  AM-RETRO-ADDITIONAL-DATA.
  2395         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2396         16  AM-RETRO-PREM-P-E             PIC X.
  2397         16  AM-RETRO-CLMS-P-I             PIC X.
  2398         16  AM-RETRO-RET-BRACKET-LF.
  2399             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2400                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2401                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2402             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2403                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2404                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2405             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2406                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2407                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2408         16  AM-RETRO-RET-BRACKET-AH.
  2409             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2410                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2411                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2412                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2413             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2414                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2415                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2416             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2417                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2418                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2419
  2420     12  AM-COMMENTS.
  2421         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2422
  2423     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  44
* EL6318.cbl
  2424         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2425         16  AM-FLI-BILLING-CODE           PIC X.
  2426         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2427         16  AM-FLI-UNITED-IDENT           PIC X.
  2428         16  AM-FLI-INTEREST-LOST-DATA.
  2429             20  AM-FLI-BANK-NO            PIC X(5).
  2430             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2431             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2432             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2433         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2434             20  AM-FLI-AGT                PIC X(9).
  2435             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2436             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2437         16  FILLER                        PIC X(102).
  2438
  2439     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2440         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2441             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2442             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2443             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2444             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2445             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2446         16  FILLER                          PIC X(10).
  2447******************************************************************
  2448*                                COPY ELCCNTL.
  2449******************************************************************
  2450*                                                                *
  2451*                                                                *
  2452*                            ELCCNTL.                            *
  2453*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2454*                            VMOD=2.059                          *
  2455*                                                                *
  2456*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2457*                                                                *
  2458*   FILE TYPE = VSAM,KSDS                                        *
  2459*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2460*                                                                *
  2461*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2462*       ALTERNATE INDEX = NONE                                   *
  2463*                                                                *
  2464*   LOG = YES                                                    *
  2465*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2466******************************************************************
  2467*                   C H A N G E   L O G
  2468*
  2469* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2470*-----------------------------------------------------------------
  2471*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2472* EFFECTIVE    NUMBER
  2473*-----------------------------------------------------------------
  2474* 082503                   PEMA  ADD BENEFIT GROUP
  2475* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2476* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2477* 092705    2005050300006  PEMA  ADD SPP LEASES
  2478* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2479* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2480* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2481* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  45
* EL6318.cbl
  2482* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2483* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2484* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2485* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2486* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2487******************************************************************
  2488*
  2489 01  CONTROL-FILE.
  2490     12  CF-RECORD-ID                       PIC XX.
  2491         88  VALID-CF-ID                        VALUE 'CF'.
  2492
  2493     12  CF-CONTROL-PRIMARY.
  2494         16  CF-COMPANY-ID                  PIC XXX.
  2495         16  CF-RECORD-TYPE                 PIC X.
  2496             88  CF-COMPANY-MASTER              VALUE '1'.
  2497             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2498             88  CF-STATE-MASTER                VALUE '3'.
  2499             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2500             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2501             88  CF-CARRIER-MASTER              VALUE '6'.
  2502             88  CF-MORTALITY-MASTER            VALUE '7'.
  2503             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2504             88  CF-TERMINAL-MASTER             VALUE '9'.
  2505             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2506             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2507             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2508             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2509             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2510             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2511             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2512             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2513             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2514         16  CF-ACCESS-CD-GENL              PIC X(4).
  2515         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2516             20  CF-PROCESSOR               PIC X(4).
  2517         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2518             20  CF-STATE-CODE              PIC XX.
  2519             20  FILLER                     PIC XX.
  2520         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2521             20  FILLER                     PIC XX.
  2522             20  CF-HI-BEN-IN-REC           PIC XX.
  2523         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2524             20  FILLER                     PIC XXX.
  2525             20  CF-CARRIER-CNTL            PIC X.
  2526         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2527             20  FILLER                     PIC XX.
  2528             20  CF-HI-TYPE-IN-REC          PIC 99.
  2529         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2530             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2531                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2532             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2533             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2534         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2535             20  FILLER                     PIC X.
  2536             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2537         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2538             20  FILLER                     PIC XX.
  2539             20  CF-MORTGAGE-PLAN           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  46
* EL6318.cbl
  2540         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2541
  2542     12  CF-LAST-MAINT-DT                   PIC XX.
  2543     12  CF-LAST-MAINT-BY                   PIC X(4).
  2544     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2545
  2546     12  CF-RECORD-BODY                     PIC X(728).
  2547
  2548
  2549****************************************************************
  2550*             COMPANY MASTER RECORD                            *
  2551****************************************************************
  2552
  2553     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2554         16  CF-COMPANY-ADDRESS.
  2555             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2556             20  CF-CL-IN-CARE-OF           PIC X(30).
  2557             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2558             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2559             20  CF-CL-CITY-STATE           PIC X(30).
  2560             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2561             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2562         16  CF-COMPANY-CD                  PIC X.
  2563         16  CF-COMPANY-PASSWORD            PIC X(8).
  2564         16  CF-SECURITY-OPTION             PIC X.
  2565             88  ALL-SECURITY                   VALUE '1'.
  2566             88  COMPANY-VERIFY                 VALUE '2'.
  2567             88  PROCESSOR-VERIFY               VALUE '3'.
  2568             88  NO-SECURITY                    VALUE '4'.
  2569             88  ALL-BUT-TERM                   VALUE '5'.
  2570         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2571             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2572         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2573             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2574         16  CF-INFORCE-LOCATION            PIC X.
  2575             88  CERTS-ARE-ONLINE               VALUE '1'.
  2576             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2577             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2578         16  CF-LOWER-CASE-LETTERS          PIC X.
  2579         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2580             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2581             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2582             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2583             88  CF-ACCNT-CNTL                  VALUE '3'.
  2584             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2585
  2586         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2587         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2588
  2589         16  CF-LGX-CREDIT-USER             PIC X.
  2590             88  CO-IS-NOT-USER                 VALUE 'N'.
  2591             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2592
  2593         16 CF-CREDIT-CALC-CODES.
  2594             20  CF-CR-REM-TERM-CALC PIC X.
  2595               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2596               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2597               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  47
* EL6318.cbl
  2598               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2599               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2600               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2601               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2602             20  CF-CR-R78-METHOD           PIC X.
  2603               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2604               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2605
  2606         16  CF-CLAIM-CONTROL-COUNTS.
  2607             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2608                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2609
  2610             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2611                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2612
  2613             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2614                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2615
  2616             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2617                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2618
  2619         16  CF-CURRENT-MONTH-END           PIC XX.
  2620
  2621         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2622             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2623             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2624             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2625             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2626                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2627                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2628             20  CF-CO-PREM-REJECT-SW       PIC X.
  2629                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2630                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2631             20  CF-CO-REF-REJECT-SW        PIC X.
  2632                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2633                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2634
  2635         16  CF-CO-REPORTING-DT             PIC XX.
  2636         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2637         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2638           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2639           88  CF-CO-MONTH-END                  VALUE '1'.
  2640
  2641         16  CF-LGX-CLAIM-USER              PIC X.
  2642             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2643             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2644
  2645         16  CF-CREDIT-EDIT-CONTROLS.
  2646             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2647             20  CF-MIN-AGE                 PIC 99.
  2648             20  CF-DEFAULT-AGE             PIC 99.
  2649             20  CF-MIN-TERM                PIC S999      COMP-3.
  2650             20  CF-MAX-TERM                PIC S999      COMP-3.
  2651             20  CF-DEFAULT-SEX             PIC X.
  2652             20  CF-JOINT-AGE-INPUT         PIC X.
  2653                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2654             20  CF-BIRTH-DATE-INPUT        PIC X.
  2655                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  48
* EL6318.cbl
  2656             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2657                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2658                 88  CF-ZERO-CARRIER            VALUE '1'.
  2659                 88  CF-ZERO-GROUPING           VALUE '2'.
  2660                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2661             20  CF-EDIT-SW                 PIC X.
  2662                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2663             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2664             20  CF-CR-PR-METHOD            PIC X.
  2665               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2666               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2667             20  FILLER                     PIC X.
  2668
  2669         16  CF-CREDIT-MISC-CONTROLS.
  2670             20  CF-REIN-TABLE-SW           PIC X.
  2671                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2672             20  CF-COMP-TABLE-SW           PIC X.
  2673                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2674             20  CF-EXPERIENCE-RETENTION-AGE
  2675                                            PIC S9        COMP-3.
  2676             20  CF-CONVERSION-DT           PIC XX.
  2677             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2678             20  CF-RUN-FREQUENCY-SW        PIC X.
  2679                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2680                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2681
  2682             20  CF-CR-CHECK-NO-CONTROL.
  2683                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2684                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2685                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2686                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2687                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2688                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2689
  2690                 24  CF-CR-CHECK-COUNT       REDEFINES
  2691                     CF-CR-CHECK-COUNTER      PIC X(4).
  2692
  2693                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2694                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2695
  2696                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2697                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2698                 24  CF-MAIL-PROCESSING       PIC X.
  2699                     88  MAIL-PROCESSING          VALUE 'Y'.
  2700
  2701         16  CF-MISC-SYSTEM-CONTROL.
  2702             20  CF-SYSTEM-C                 PIC X.
  2703                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2704             20  CF-SYSTEM-D                 PIC X.
  2705                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2706             20  CF-SOC-SEC-NO-SW            PIC X.
  2707                 88  SOC-SEC-NO-USED             VALUE '1'.
  2708             20  CF-MEMBER-NO-SW             PIC X.
  2709                 88  MEMBER-NO-USED              VALUE '1'.
  2710             20  CF-TAX-ID-NUMBER            PIC X(11).
  2711             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2712             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2713                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  49
* EL6318.cbl
  2714                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2715                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2716                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2717             20  CF-SYSTEM-E                 PIC X.
  2718                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2719
  2720         16  CF-LGX-LIFE-USER               PIC X.
  2721             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2722             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2723
  2724         16  CF-CR-MONTH-END-DT             PIC XX.
  2725
  2726         16  CF-FILE-MAINT-DATES.
  2727             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2728                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2729             20  CF-LAST-BATCH       REDEFINES
  2730                 CF-LAST-BATCH-NO               PIC X(4).
  2731             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2732             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2733             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2734             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2735             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2736             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2737             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2738             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2739             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2740             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2741
  2742         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2743         16  FILLER                         PIC X.
  2744
  2745         16  CF-ALT-MORT-CODE               PIC X(4).
  2746         16  CF-MEMBER-CAPTION              PIC X(10).
  2747
  2748         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2749             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2750             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2751             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2752             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2753             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2754
  2755         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2756
  2757         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2758         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2759         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2760         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2761
  2762         16  CF-AH-OVERRIDE-L1              PIC X.
  2763         16  CF-AH-OVERRIDE-L2              PIC XX.
  2764         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2765         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2766
  2767         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2768         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2769
  2770         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2771         16  CF-AR-LAST-EL860-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  50
* EL6318.cbl
  2772         16  CF-MP-MONTH-END-DT             PIC XX.
  2773
  2774         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2775         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2776             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2777
  2778         16  CF-AR-MONTH-END-DT             PIC XX.
  2779
  2780         16  CF-CRDTCRD-USER                PIC X.
  2781             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2782             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2783
  2784         16  CF-CC-MONTH-END-DT             PIC XX.
  2785
  2786         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2787
  2788         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2789             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2790             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2791             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2792         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2793         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2794         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2795         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2796             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2797             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2798         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2799         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2800         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2801             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2802         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2803
  2804         16  CF-CL-ZIP-CODE.
  2805             20  CF-CL-ZIP-PRIME.
  2806                 24  CF-CL-ZIP-1ST          PIC X.
  2807                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2808                 24  FILLER                 PIC X(4).
  2809             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2810         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2811             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2812             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2813             20  FILLER                     PIC XXX.
  2814
  2815         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2816         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2817         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2818         16  CF-CO-OPTION-START-DATE        PIC XX.
  2819         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2820           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2821                                                      '3' '4'.
  2822           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2823           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2824           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2825           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2826           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2827           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2828
  2829         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  51
* EL6318.cbl
  2830
  2831         16  CF-PAYMENT-APPROVAL-LEVELS.
  2832             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2833             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2834             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2835             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2836             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2837             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2838
  2839         16  CF-END-USER-REPORTING-USER     PIC X.
  2840             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2841             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2842
  2843         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2844             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2845             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2846
  2847         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2848
  2849         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2850         16  FILLER                         PIC X.
  2851
  2852         16  CF-CREDIT-ARCHIVE-CNTL.
  2853             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2854             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2855             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2856
  2857         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2858
  2859         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2860             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2861             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2862
  2863         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2864             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2865             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2866
  2867         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2868
  2869         16  CF-CO-ACH-ID-CODE              PIC  X.
  2870             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2871             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2872             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2873         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2874         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2875         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2876         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2877         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2878         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2879         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2880         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2881         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2882                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2883         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2884                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2885
  2886         16  CF-CO-OVER-SHORT.
  2887             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  52
* EL6318.cbl
  2888             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2889
  2890*         16  FILLER                         PIC X(102).
  2891         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2892             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2893             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2894
  2895         16  CF-AH-APPROVAL-DAYS.
  2896             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2897             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2898             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2899             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2900
  2901         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2902
  2903         16  CF-APPROV-LEV-5.
  2904             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2905             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2906             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2907
  2908         16  FILLER                         PIC X(68).
  2909****************************************************************
  2910*             PROCESSOR/USER RECORD                            *
  2911****************************************************************
  2912
  2913     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2914         16  CF-PROCESSOR-NAME              PIC X(30).
  2915         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2916         16  CF-PROCESSOR-TITLE             PIC X(26).
  2917         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2918                 88  MESSAGE-YES                VALUE 'Y'.
  2919                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2920
  2921*****************************************************
  2922****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2923****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2924****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2925****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2926*****************************************************
  2927
  2928         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2929             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2930             20  CF-APPLICATION-FORCE       PIC X.
  2931             20  CF-INDIVIDUAL-APP.
  2932                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2933                     28  CF-BROWSE-APP      PIC X.
  2934                     28  CF-UPDATE-APP      PIC X.
  2935
  2936         16  CF-CURRENT-TERM-ON             PIC X(4).
  2937         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2938             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2939             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2940             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2941             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2942             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2943             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2944             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2945         16  CF-PROCESSOR-CARRIER           PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  53
* EL6318.cbl
  2946             88  NO-CARRIER-SECURITY            VALUE ' '.
  2947         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2948             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2949         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2950             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2951         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2952             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2953
  2954         16  CF-PROC-SYS-ACCESS-SW.
  2955             20  CF-PROC-CREDIT-CLAIMS-SW.
  2956                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2957                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2958                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2959                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2960             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2961                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2962                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2963             20  CF-PROC-LIFE-GNRLDGR-SW.
  2964                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2965                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2966                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2967                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2968             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2969                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2970                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2971         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2972             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2973             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2974         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2975
  2976         16  CF-APPROVAL-LEVEL                  PIC X.
  2977             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2978             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2979             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2980             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2981             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2982
  2983         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2984
  2985         16  CF-LANGUAGE-TYPE                   PIC X.
  2986             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2987             88  CF-LANG-IS-FR                      VALUE 'F'.
  2988
  2989         16  CF-CSR-IND                         PIC X.
  2990         16  FILLER                             PIC X(239).
  2991
  2992****************************************************************
  2993*             PROCESSOR/REMINDERS RECORD                       *
  2994****************************************************************
  2995
  2996     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2997         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2998             20  CF-START-REMIND-DT         PIC XX.
  2999             20  CF-END-REMIND-DT           PIC XX.
  3000             20  CF-REMINDER-TEXT           PIC X(50).
  3001         16  FILLER                         PIC X(296).
  3002
  3003
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  54
* EL6318.cbl
  3004****************************************************************
  3005*             STATE MASTER RECORD                              *
  3006****************************************************************
  3007
  3008     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3009         16  CF-STATE-ABBREVIATION          PIC XX.
  3010         16  CF-STATE-NAME                  PIC X(25).
  3011         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3012         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3013             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3014             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3015             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3016             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3017                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3018                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3019             20  CF-ST-PREM-REJECT-SW       PIC X.
  3020                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3021                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3022             20  CF-ST-REF-REJECT-SW        PIC X.
  3023                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3024                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3025         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3026         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3027         16  CF-ST-REFUND-RULES.
  3028             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3029             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3030             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3031         16  CF-ST-FST-PMT-EXTENSION.
  3032             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3033             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3034                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3035                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3036                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3037                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3038         16  CF-ST-STATE-CALL.
  3039             20  CF-ST-CALL-UNEARNED        PIC X.
  3040             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3041             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3042         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3043             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3044             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3045         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3046         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3047         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3048         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3049         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3050         16  FILLER                         PIC X.
  3051         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3052             20  CF-ST-BENEFIT-CD           PIC XX.
  3053             20  CF-ST-BENEFIT-KIND         PIC X.
  3054                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3055                 88  CF-ST-AH-KIND              VALUE 'A'.
  3056             20  CF-ST-REM-TERM-CALC        PIC X.
  3057                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3058                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3059                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3060                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3061                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  55
* EL6318.cbl
  3062                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3063                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3064                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3065
  3066             20  CF-ST-REFUND-CALC          PIC X.
  3067                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3068                 88  ST-REFD-BY-R78             VALUE '1'.
  3069                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3070                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3071                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3072                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3073                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3074                 88  ST-REFD-UTAH               VALUE '7'.
  3075                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3076                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3077                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3078
  3079             20  CF-ST-EARNING-CALC         PIC X.
  3080                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3081                 88  ST-EARN-BY-R78             VALUE '1'.
  3082                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3083                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3084                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3085                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3086                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3087                 88  ST-EARN-MEAN               VALUE '8'.
  3088                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3089
  3090             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3091                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3092                 88  ST-OVRD-BY-R78             VALUE '1'.
  3093                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3094                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3095                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3096                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3097                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3098                 88  ST-OVRD-MEAN               VALUE '8'.
  3099                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3100             20  FILLER                     PIC X.
  3101
  3102         16  CF-ST-COMMISSION-CAPS.
  3103             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3104             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3105             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3106             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3107         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3108                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3109
  3110         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3111
  3112         16  CF-ST-STATUTORY-INTEREST.
  3113             20  CF-ST-STAT-DATE-FROM       PIC X.
  3114                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3115                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3116             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3117             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3118             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3119             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  56
* EL6318.cbl
  3120             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3121
  3122         16  CF-ST-OVER-SHORT.
  3123             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3124             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3125
  3126         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3127
  3128         16  CF-ST-RT-CALC                  PIC X.
  3129
  3130         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3131         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3132         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3133         16  CF-ST-RF-LR-CALC               PIC X.
  3134         16  CF-ST-RF-LL-CALC               PIC X.
  3135         16  CF-ST-RF-LN-CALC               PIC X.
  3136         16  CF-ST-RF-AH-CALC               PIC X.
  3137         16  CF-ST-RF-CP-CALC               PIC X.
  3138*        16  FILLER                         PIC X(206).
  3139*CIDMOD         16  FILLER                         PIC X(192).
  3140         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3141             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3142         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3143         16  CF-ST-VFY-2ND-BENE             PIC X.
  3144         16  CF-ST-CAUSAL-STATE             PIC X.
  3145         16  FILLER                         PIC X(185).
  3146
  3147****************************************************************
  3148*             BENEFIT MASTER RECORD                            *
  3149****************************************************************
  3150
  3151     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3152         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3153             20  CF-BENEFIT-CODE            PIC XX.
  3154             20  CF-BENEFIT-NUMERIC  REDEFINES
  3155                 CF-BENEFIT-CODE            PIC XX.
  3156             20  CF-BENEFIT-ALPHA           PIC XXX.
  3157             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3158             20  CF-BENEFIT-COMMENT         PIC X(10).
  3159
  3160             20  CF-LF-COVERAGE-TYPE        PIC X.
  3161                 88  CF-REDUCING                VALUE 'R'.
  3162                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3163
  3164             20  CF-SPECIAL-CALC-CD         PIC X.
  3165                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3166                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3167                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3168                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3169                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3170                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3171                 88  CF-FARM-PLAN               VALUE 'F'.
  3172                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3173                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3174                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3175                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3176                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3177                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  57
* EL6318.cbl
  3178                 88  CF-PRUDENTIAL              VALUE 'P'.
  3179                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3180                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3181                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3182                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3183                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3184                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3185
  3186             20  CF-JOINT-INDICATOR         PIC X.
  3187                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3188
  3189*            20  FILLER                     PIC X(12).
  3190             20  FILLER                     PIC X(11).
  3191             20  CF-BENEFIT-CATEGORY        PIC X.
  3192             20  CF-LOAN-TYPE               PIC X(8).
  3193
  3194             20  CF-CO-REM-TERM-CALC        PIC X.
  3195                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3196                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3197                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3198                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3199                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3200
  3201             20  CF-CO-EARNINGS-CALC        PIC X.
  3202                 88  CO-EARN-BY-R78             VALUE '1'.
  3203                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3204                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3205                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3206                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3207                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3208                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3209                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3210
  3211             20  CF-CO-REFUND-CALC          PIC X.
  3212                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3213                 88  CO-REFD-BY-R78             VALUE '1'.
  3214                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3215                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3216                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3217                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3218                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3219                 88  CO-REFD-MEAN               VALUE '8'.
  3220                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3221                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3222                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3223
  3224             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3225                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3226                 88  CO-OVRD-BY-R78             VALUE '1'.
  3227                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3228                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3229                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3230                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3231                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3232                 88  CO-OVRD-MEAN               VALUE '8'.
  3233                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3234
  3235             20  CF-CO-BEN-I-G-CD           PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  58
* EL6318.cbl
  3236                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3237                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3238                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3239
  3240         16  FILLER                         PIC X(304).
  3241
  3242
  3243****************************************************************
  3244*             CARRIER MASTER RECORD                            *
  3245****************************************************************
  3246
  3247     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3248         16  CF-ADDRESS-DATA.
  3249             20  CF-MAIL-TO-NAME            PIC X(30).
  3250             20  CF-IN-CARE-OF              PIC X(30).
  3251             20  CF-ADDRESS-LINE-1          PIC X(30).
  3252             20  CF-ADDRESS-LINE-2          PIC X(30).
  3253             20  CF-CITY-STATE              PIC X(30).
  3254             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3255             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3256
  3257         16  CF-CLAIM-NO-CONTROL.
  3258             20  CF-CLAIM-NO-METHOD         PIC X.
  3259                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3260                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3261                 88  CLAIM-NO-SEQ               VALUE '3'.
  3262                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3263             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3264                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3265                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3266                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3267
  3268         16  CF-CHECK-NO-CONTROL.
  3269             20  CF-CHECK-NO-METHOD         PIC X.
  3270                 88  CHECK-NO-MANUAL            VALUE '1'.
  3271                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3272                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3273                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3274             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3275                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3276
  3277         16  CF-DOMICILE-STATE              PIC XX.
  3278
  3279         16  CF-EXPENSE-CONTROLS.
  3280             20  CF-EXPENSE-METHOD          PIC X.
  3281                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3282                 88  DOLLARS-PER-PMT            VALUE '2'.
  3283                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3284                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3285             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3286             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3287
  3288         16  CF-CORRESPONDENCE-CONTROL.
  3289             20  CF-LETTER-RESEND-OPT       PIC X.
  3290                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3291                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3292             20  FILLER                     PIC X(4).
  3293
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  59
* EL6318.cbl
  3294         16  CF-RESERVE-CONTROLS.
  3295             20  CF-MANUAL-SW               PIC X.
  3296                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3297             20  CF-FUTURE-SW               PIC X.
  3298                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3299             20  CF-PTC-SW                  PIC X.
  3300                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3301             20  CF-IBNR-SW                 PIC X.
  3302                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3303             20  CF-PTC-LF-SW               PIC X.
  3304                 88  CF-LF-PTC-USED             VALUE '1'.
  3305             20  CF-CDT-ACCESS-METHOD       PIC X.
  3306                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3307                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3308                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3309             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3310
  3311         16  CF-CLAIM-CALC-METHOD           PIC X.
  3312             88  360-PLUS-MONTHS                VALUE '1'.
  3313             88  365-PLUS-MONTHS                VALUE '2'.
  3314             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3315             88  360-DAILY                      VALUE '4'.
  3316             88  365-DAILY                      VALUE '5'.
  3317
  3318         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3319         16  FILLER                         PIC X(11).
  3320
  3321         16  CF-LIMIT-AMOUNTS.
  3322             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3323             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3324             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3325             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3326             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3327             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3328             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3329             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3330             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3331             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3332
  3333         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3334         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3335         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3336
  3337         16  CF-ZIP-CODE.
  3338             20  CF-ZIP-PRIME.
  3339                 24  CF-ZIP-1ST             PIC X.
  3340                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3341                 24  FILLER                 PIC X(4).
  3342             20  CF-ZIP-PLUS4               PIC X(4).
  3343         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3344             20  CF-CAN-POSTAL-1            PIC XXX.
  3345             20  CF-CAN-POSTAL-2            PIC XXX.
  3346             20  FILLER                     PIC XXX.
  3347
  3348         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3349         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3350         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3351
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  60
* EL6318.cbl
  3352         16  CF-RATING-SWITCH               PIC X.
  3353             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3354             88  CF-NO-RATING                   VALUE 'N'.
  3355
  3356         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3357
  3358         16  CF-CARRIER-OVER-SHORT.
  3359             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3360             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3361
  3362         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3363         16  CF-SECPAY-SWITCH               PIC X.
  3364             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3365             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3366         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3367         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3368         16  FILLER                         PIC X(444).
  3369*        16  FILLER                         PIC X(452).
  3370
  3371
  3372****************************************************************
  3373*             MORTALITY MASTER RECORD                          *
  3374****************************************************************
  3375
  3376     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3377         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3378                                INDEXED BY CF-MORT-NDX.
  3379             20  CF-MORT-TABLE              PIC X(5).
  3380             20  CF-MORT-TABLE-TYPE         PIC X.
  3381                 88  CF-MORT-JOINT              VALUE 'J'.
  3382                 88  CF-MORT-SINGLE             VALUE 'S'.
  3383                 88  CF-MORT-COMBINED           VALUE 'C'.
  3384                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3385                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3386             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3387             20  CF-MORT-AGE-METHOD         PIC XX.
  3388                 88  CF-AGE-LAST                VALUE 'AL'.
  3389                 88  CF-AGE-NEAR                VALUE 'AN'.
  3390             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3391             20  CF-MORT-ADJUSTMENT-DIRECTION
  3392                                            PIC X.
  3393                 88  CF-MINUS                   VALUE '-'.
  3394                 88  CF-PLUS                    VALUE '+'.
  3395             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3396             20  CF-MORT-JOINT-CODE         PIC X.
  3397                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3398             20  CF-MORT-PC-Q               PIC X.
  3399                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3400             20  CF-MORT-TABLE-CODE         PIC X(4).
  3401             20  CF-MORT-COMMENTS           PIC X(15).
  3402             20  FILLER                     PIC X(14).
  3403
  3404         16  FILLER                         PIC X(251).
  3405
  3406
  3407****************************************************************
  3408*             BUSSINESS TYPE MASTER RECORD                     *
  3409****************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  61
* EL6318.cbl
  3410
  3411     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3412* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3413* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3414* AND RECORD 05 IS TYPES 81-99
  3415         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3416             20  CF-BUSINESS-TITLE          PIC  X(19).
  3417             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3418                                            PIC S9V9(4) COMP-3.
  3419             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3420             20  FILLER                     PIC  X.
  3421         16  FILLER                         PIC  X(248).
  3422
  3423
  3424****************************************************************
  3425*             TERMINAL MASTER RECORD                           *
  3426****************************************************************
  3427
  3428     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3429
  3430         16  CF-COMPANY-TERMINALS.
  3431             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3432                                  PIC X(4).
  3433         16  FILLER               PIC X(248).
  3434
  3435
  3436****************************************************************
  3437*             LIFE EDIT MASTER RECORD                          *
  3438****************************************************************
  3439
  3440     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3441         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3442             20  CF-LIFE-CODE-IN            PIC XX.
  3443             20  CF-LIFE-CODE-OUT           PIC XX.
  3444         16  FILLER                         PIC X(248).
  3445
  3446
  3447****************************************************************
  3448*             AH EDIT MASTER RECORD                            *
  3449****************************************************************
  3450
  3451     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3452         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3453             20  CF-AH-CODE-IN              PIC XXX.
  3454             20  CF-AH-CODE-OUT             PIC XX.
  3455         16  FILLER                         PIC X(248).
  3456
  3457
  3458****************************************************************
  3459*             CREDIBILITY TABLES                               *
  3460****************************************************************
  3461
  3462     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3463         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3464                             INDEXED BY CF-CRDB-NDX.
  3465             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3466             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3467             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  62
* EL6318.cbl
  3468         16  FILLER                         PIC  X(332).
  3469
  3470
  3471****************************************************************
  3472*             REPORT CUSTOMIZATION RECORD                      *
  3473****************************************************************
  3474
  3475     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3476         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3477             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3478             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3479             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3480**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3481****       A T-TRANSFER.                                   ****
  3482             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3483
  3484         16  FILLER                         PIC XX.
  3485
  3486         16  CF-CARRIER-CNTL-OPT.
  3487             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3488                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3489                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3490             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3491                                            PIC X.
  3492         16  CF-GROUP-CNTL-OPT.
  3493             20  CF-GROUP-OPT-SEQ           PIC 9.
  3494                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3495                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3496             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3497                                            PIC X(6).
  3498         16  CF-STATE-CNTL-OPT.
  3499             20  CF-STATE-OPT-SEQ           PIC 9.
  3500                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3501                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3502             20  CF-STATE-SELECT OCCURS 3 TIMES
  3503                                            PIC XX.
  3504         16  CF-ACCOUNT-CNTL-OPT.
  3505             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3506                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3507                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3508             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3509                                            PIC X(10).
  3510         16  CF-BUS-TYP-CNTL-OPT.
  3511             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3512                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3513                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3514             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3515                                            PIC XX.
  3516         16  CF-LF-TYP-CNTL-OPT.
  3517             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3518                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3519                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3520             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3521                                            PIC XX.
  3522         16  CF-AH-TYP-CNTL-OPT.
  3523             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3524                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3525                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  63
* EL6318.cbl
  3526             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3527                                            PIC XX.
  3528         16  CF-REPTCD1-CNTL-OPT.
  3529             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3530                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3531                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3532             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3533                                            PIC X(10).
  3534         16  CF-REPTCD2-CNTL-OPT.
  3535             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3536                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3537                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3538             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3539                                            PIC X(10).
  3540         16  CF-USER1-CNTL-OPT.
  3541             20  CF-USER1-OPT-SEQ           PIC 9.
  3542                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3543                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3544             20  CF-USER1-SELECT OCCURS 3 TIMES
  3545                                            PIC X(10).
  3546         16  CF-USER2-CNTL-OPT.
  3547             20  CF-USER2-OPT-SEQ           PIC 9.
  3548                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3549                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3550             20  CF-USER2-SELECT OCCURS 3 TIMES
  3551                                            PIC X(10).
  3552         16  CF-USER3-CNTL-OPT.
  3553             20  CF-USER3-OPT-SEQ           PIC 9.
  3554                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3555                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3556             20  CF-USER3-SELECT OCCURS 3 TIMES
  3557                                            PIC X(10).
  3558         16  CF-USER4-CNTL-OPT.
  3559             20  CF-USER4-OPT-SEQ           PIC 9.
  3560                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3561                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3562             20  CF-USER4-SELECT OCCURS 3 TIMES
  3563                                            PIC X(10).
  3564         16  CF-USER5-CNTL-OPT.
  3565             20  CF-USER5-OPT-SEQ           PIC 9.
  3566                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3567                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3568             20  CF-USER5-SELECT OCCURS 3 TIMES
  3569                                            PIC X(10).
  3570         16  CF-REINS-CNTL-OPT.
  3571             20  CF-REINS-OPT-SEQ           PIC 9.
  3572                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3573                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3574             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3575                 24  CF-REINS-PRIME         PIC XXX.
  3576                 24  CF-REINS-SUB           PIC XXX.
  3577
  3578         16  CF-AGENT-CNTL-OPT.
  3579             20  CF-AGENT-OPT-SEQ           PIC 9.
  3580                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3581                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3582             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3583                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  64
* EL6318.cbl
  3584
  3585         16  FILLER                         PIC X(43).
  3586
  3587         16  CF-LOSS-RATIO-SELECT.
  3588             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3589             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3590         16  CF-ENTRY-DATE-SELECT.
  3591             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3592             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3593         16  CF-EFFECTIVE-DATE-SELECT.
  3594             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3595             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3596
  3597         16  CF-EXCEPTION-LIST-IND          PIC X.
  3598             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3599
  3600         16  FILLER                         PIC X(318).
  3601
  3602****************************************************************
  3603*                  EXCEPTION REPORTING RECORD                  *
  3604****************************************************************
  3605
  3606     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3607         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3608             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3609
  3610         16  CF-COMBINED-LIFE-AH-OPT.
  3611             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3612             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3613             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3614             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3615
  3616         16  CF-LIFE-OPT.
  3617             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3618             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3619             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3620             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3621             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3622             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3623             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3624             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3625             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3626             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3627
  3628         16  CF-AH-OPT.
  3629             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3630             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3631             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3632             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3633             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3634             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3635             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3636             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3637             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3638             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3639
  3640         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3641             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  65
* EL6318.cbl
  3642             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3643             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3644
  3645         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3646
  3647         16  FILLER                         PIC X(673).
  3648
  3649
  3650****************************************************************
  3651*             MORTGAGE SYSTEM PLAN RECORD                      *
  3652****************************************************************
  3653
  3654     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3655         16  CF-PLAN-TYPE                   PIC X.
  3656             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3657             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3658             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3659         16  CF-PLAN-ABBREV                 PIC XXX.
  3660         16  CF-PLAN-DESCRIPT               PIC X(10).
  3661         16  CF-PLAN-NOTES                  PIC X(20).
  3662         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3663         16  CF-PLAN-UNDERWRITING.
  3664             20  CF-PLAN-TERM-DATA.
  3665                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3666                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3667             20  CF-PLAN-AGE-DATA.
  3668                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3669                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3670                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3671             20  CF-PLAN-BENEFIT-DATA.
  3672                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3673                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3674                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3675                                            PIC S9(7)V99  COMP-3.
  3676         16  CF-PLAN-POLICY-FORMS.
  3677             20  CF-POLICY-FORM             PIC X(12).
  3678             20  CF-MASTER-APPLICATION      PIC X(12).
  3679             20  CF-MASTER-POLICY           PIC X(12).
  3680         16  CF-PLAN-RATING.
  3681             20  CF-RATE-CODE               PIC X(5).
  3682             20  CF-SEX-RATING              PIC X.
  3683                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3684                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3685             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3686             20  CF-SUB-STD-TYPE            PIC X.
  3687                 88  CF-PCT-OF-PREM            VALUE '1'.
  3688                 88  CF-PCT-OF-BENE            VALUE '2'.
  3689         16  CF-PLAN-PREM-TOLERANCES.
  3690             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3691             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3692         16  CF-PLAN-PYMT-TOLERANCES.
  3693             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3694             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3695         16  CF-PLAN-MISC-DATA.
  3696             20  FILLER                     PIC X.
  3697             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3698             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3699         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  66
* EL6318.cbl
  3700         16  CF-PLAN-IND-GRP                PIC X.
  3701             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3702                                                     '1'.
  3703             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3704                                                     '2'.
  3705         16  CF-MIB-SEARCH-SW               PIC X.
  3706             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3707             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3708             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3709             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3710         16  CF-ALPHA-SEARCH-SW             PIC X.
  3711             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3712             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3713             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3714             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3715             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3716             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3717             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3718             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3719             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3720             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3721                                                     'A' 'B' 'C'
  3722                                                     'X' 'Y' 'Z'.
  3723         16  CF-EFF-DT-RULE-SW              PIC X.
  3724             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3725             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3726             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3727             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3728             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3729         16  FILLER                         PIC X(4).
  3730         16  CF-HEALTH-QUESTIONS            PIC X.
  3731             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3732         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3733         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3734         16  CF-PLAN-SNGL-JNT               PIC X.
  3735             88  CF-COMBINED-PLAN              VALUE 'C'.
  3736             88  CF-JNT-PLAN                   VALUE 'J'.
  3737             88  CF-SNGL-PLAN                  VALUE 'S'.
  3738         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3739         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3740         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3741         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3742         16  CF-RERATE-CNTL                 PIC  X.
  3743             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3744             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3745             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3746             88  CF-AUTO-RECALC                 VALUE '4'.
  3747         16  CF-BENEFIT-TYPE                PIC  X.
  3748             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3749             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3750         16  CF-POLICY-FEE                  PIC S999V99
  3751                                                    COMP-3.
  3752         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3753         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3754         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3755         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3756         16  FILLER                         PIC  X(32).
  3757         16  CF-TERMINATION-FORM            PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  67
* EL6318.cbl
  3758         16  FILLER                         PIC  X(08).
  3759         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3760                                                       COMP-3.
  3761         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3762         16  CF-ISSUE-LETTER                PIC  X(4).
  3763         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3764         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3765             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3766             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3767         16  CF-MP-REFUND-CALC              PIC X.
  3768             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3769             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3770             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3771             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3772             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3773             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3774             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3775             88  CF-MP-REFD-MEAN                VALUE '8'.
  3776         16  CF-ALT-RATE-CODE               PIC  X(5).
  3777
  3778
  3779         16  FILLER                         PIC X(498).
  3780****************************************************************
  3781*             MORTGAGE COMPANY MASTER RECORD                   *
  3782****************************************************************
  3783
  3784     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3785         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3786         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3787             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3788             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3789             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3790             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3791             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3792
  3793         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3794         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3795         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3796         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3797         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3798
  3799         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3800             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3801         16  CF-MP-RECON-USE-IND            PIC X(1).
  3802             88  CF-MP-USE-RECON             VALUE 'Y'.
  3803         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3804             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3805         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3806             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3807             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3808         16  FILLER                         PIC X(1).
  3809         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3810             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3811         16  CF-MORTG-MIB-VERSION           PIC X.
  3812             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3813             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3814             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3815         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  68
* EL6318.cbl
  3816             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3817                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3818             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3819                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3820             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3821                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3822             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3823                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3824             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3825                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3826             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3827                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3828         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3829         16  FILLER                         PIC X(7).
  3830         16  CF-MORTG-DESTINATION-SYMBOL.
  3831             20  CF-MORTG-MIB-COMM          PIC X(5).
  3832             20  CF-MORTG-MIB-TERM          PIC X(5).
  3833         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3834             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3835         16  FILLER                         PIC X(03).
  3836         16  CF-MP-CHECK-NO-CONTROL.
  3837             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3838                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3839                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3840                                                ' ' LOW-VALUES.
  3841                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3842                                               VALUE '3'.
  3843         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3844         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3845         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3846             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3847                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3848             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3849                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3850             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3851                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3852             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3853                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3854             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3855                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3856             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3857                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3858         16  CF-MORTG-BILLING-AREA.
  3859             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3860                                            PIC X.
  3861         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3862         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3863         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3864         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3865             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3866             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3867         16  FILLER                         PIC X.
  3868         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3869             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3870             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3871         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3872         16  FILLER                         PIC X(8).
  3873         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  69
* EL6318.cbl
  3874         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3875         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3876         16  CF-ACH-COMPANY-ID.
  3877             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3878                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3879                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3880                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3881             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3882         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3883             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3884         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3885             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3886             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3887         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3888         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3889         16  FILLER                         PIC X(536).
  3890
  3891****************************************************************
  3892*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3893****************************************************************
  3894
  3895     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3896         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3897             20  CF-FEMALE-HEIGHT.
  3898                 24  CF-FEMALE-FT           PIC 99.
  3899                 24  CF-FEMALE-IN           PIC 99.
  3900             20  CF-FEMALE-MIN-WT           PIC 999.
  3901             20  CF-FEMALE-MAX-WT           PIC 999.
  3902         16  FILLER                         PIC X(428).
  3903
  3904     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3905         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3906             20  CF-MALE-HEIGHT.
  3907                 24  CF-MALE-FT             PIC 99.
  3908                 24  CF-MALE-IN             PIC 99.
  3909             20  CF-MALE-MIN-WT             PIC 999.
  3910             20  CF-MALE-MAX-WT             PIC 999.
  3911         16  FILLER                         PIC X(428).
  3912******************************************************************
  3913*             AUTOMATIC ACTIVITY RECORD                          *
  3914******************************************************************
  3915     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3916         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3917             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3918             20  CF-SYS-LETTER-ID           PIC X(04).
  3919             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3920             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3921             20  CF-SYS-RESET-SW            PIC X(01).
  3922             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3923             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3924
  3925         16  FILLER                         PIC X(50).
  3926
  3927         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3928             20  CF-USER-ACTIVE-SW          PIC X(01).
  3929             20  CF-USER-LETTER-ID          PIC X(04).
  3930             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3931             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  70
* EL6318.cbl
  3932             20  CF-USER-RESET-SW           PIC X(01).
  3933             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3934             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3935             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3936
  3937         16  FILLER                         PIC X(246).
  3938*                                COPY ERCPNDB.
  3939******************************************************************
  3940*                                                                *
  3941*                                                                *
  3942*                            ERCPNDB.                            *
  3943*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3944*                            VMOD=2.025                          *
  3945*                                                                *
  3946*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3947*                                                                *
  3948******************************************************************
  3949*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3950*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3951******************************************************************
  3952*                                                                *
  3953*                                                                *
  3954*   FILE TYPE = VSAM,KSDS                                        *
  3955*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3956*                                                                *
  3957*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3958*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3959*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3960*                                                 RKP=13,LEN=36  *
  3961*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3962*                                      AND CHG-SEQ.)             *
  3963*                                                RKP=49,LEN=11   *
  3964*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3965*                                      AND CHG-SEQ.)             *
  3966*                                                RKP=60,LEN=15   *
  3967*                                                                *
  3968*   LOG = NO                                                     *
  3969*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3970******************************************************************
  3971******************************************************************
  3972*                   C H A N G E   L O G
  3973*
  3974* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3975*-----------------------------------------------------------------
  3976*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3977* EFFECTIVE    NUMBER
  3978*-----------------------------------------------------------------
  3979* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3980* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3981* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3982* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3983* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3984* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3985* 032306                   PEMA  ADD BOW LOAN NUMBER
  3986* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  3987* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3988* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3989* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  71
* EL6318.cbl
  3990* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3991* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3992* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3993* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3994******************************************************************
  3995
  3996 01  PENDING-BUSINESS.
  3997     12  PB-RECORD-ID                     PIC XX.
  3998         88  VALID-PB-ID                        VALUE 'PB'.
  3999
  4000     12  PB-CONTROL-PRIMARY.
  4001         16  PB-COMPANY-CD                PIC X.
  4002         16  PB-ENTRY-BATCH               PIC X(6).
  4003         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4004         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4005
  4006     12  PB-CONTROL-BY-ACCOUNT.
  4007         16  PB-COMPANY-CD-A1             PIC X.
  4008         16  PB-CARRIER                   PIC X.
  4009         16  PB-GROUPING.
  4010             20  PB-GROUPING-PREFIX       PIC XXX.
  4011             20  PB-GROUPING-PRIME        PIC XXX.
  4012         16  PB-STATE                     PIC XX.
  4013         16  PB-ACCOUNT.
  4014             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4015             20  PB-ACCOUNT-PRIME         PIC X(6).
  4016         16  PB-CERT-EFF-DT               PIC XX.
  4017         16  PB-CERT-NO.
  4018             20  PB-CERT-PRIME            PIC X(10).
  4019             20  PB-CERT-SFX              PIC X.
  4020         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4021
  4022         16  PB-RECORD-TYPE               PIC X.
  4023             88  PB-MAILING-DATA                VALUE '0'.
  4024             88  PB-ISSUE                       VALUE '1'.
  4025             88  PB-CANCELLATION                VALUE '2'.
  4026             88  PB-BATCH-TRAILER               VALUE '9'.
  4027
  4028     12  PB-CONTROL-BY-ORIG-BATCH.
  4029         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4030         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4031         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4032         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4033
  4034     12  PB-CONTROL-BY-CSR.
  4035         16  PB-CSR-COMPANY-CD            PIC X.
  4036         16  PB-CSR-ID                    PIC X(4).
  4037         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4038         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4039         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4040******************************************************************
  4041*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4042******************************************************************
  4043
  4044     12  PB-LAST-MAINT-DT                 PIC XX.
  4045     12  PB-LAST-MAINT-BY                 PIC X(4).
  4046     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4047
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  72
* EL6318.cbl
  4048     12  PB-RECORD-BODY                   PIC X(375).
  4049
  4050     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4051         16  PB-CERT-ORIGIN               PIC X.
  4052             88  CLASIC-CREATED-CERT         VALUE '1'.
  4053         16  PB-I-NAME.
  4054             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4055             20  PB-I-INSURED-FIRST-NAME.
  4056                 24  PB-I-INSURED-1ST-INIT PIC X.
  4057                 24  FILLER                PIC X(9).
  4058             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4059         16  PB-I-AGE                     PIC S99   COMP-3.
  4060         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4061         16  PB-I-BIRTHDAY                PIC XX.
  4062         16  PB-I-INSURED-SEX             PIC X.
  4063             88  PB-SEX-MALE     VALUE 'M'.
  4064             88  PB-SEX-FEMALE   VALUE 'F'.
  4065
  4066         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4067         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4068         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4069         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4070         16  PB-I-SKIP-CODE               PIC X.
  4071             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4072             88  PB-SKIP-JULY              VALUE '1'.
  4073             88  PB-SKIP-AUGUST            VALUE '2'.
  4074             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4075             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4076             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4077             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4078             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4079             88  PB-SKIP-JUNE              VALUE '8'.
  4080             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4081             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4082             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4083         16  PB-I-TERM-TYPE               PIC X.
  4084             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4085             88  PB-PAID-WEEKLY            VALUE 'W'.
  4086             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4087             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4088             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4089         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4090         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4091         16  PB-I-DATA-ENTRY-SW           PIC X.
  4092             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4093             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4094             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4095             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4096         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4097         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4098*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4099         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4100         16  FILLER                       PIC X.
  4101
  4102         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4103             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4104             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4105                                                   '90' THRU '99'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  73
* EL6318.cbl
  4106         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4107                                          PIC XX.
  4108         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4109         16  PB-I-AMOUNT-FINANCED REDEFINES
  4110                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4111         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4112         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4113                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4114         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4115         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4116         16  PB-I-CLP-AMOUNT REDEFINES
  4117                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4118         16  PB-I-LF-CALC-FLAG            PIC X.
  4119             88 PB-COMP-LF-PREM               VALUE '?'.
  4120         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4121         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4122         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4123         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4124         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4125         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4126         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4127         16  PB-I-LF-ABBR                 PIC XXX.
  4128         16  PB-I-LF-INPUT-CD             PIC XX.
  4129
  4130         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4131             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4132             88  PB-INVALID-AH               VALUE '  ' '00'
  4133                                                   '90' THRU '99'.
  4134         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4135         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4136         16  PB-I-AH-CALC-FLAG            PIC X.
  4137             88 PB-COMP-AH-PREM                  VALUE '?'.
  4138         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4139         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4140         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4141         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4142         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4143         16  PB-I-AH-ABBR                 PIC XXX.
  4144         16  PB-I-AH-INPUT-CD             PIC XXX.
  4145
  4146         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4147         16  PB-I-REIN-TABLE              PIC XXX.
  4148         16  PB-I-BUSINESS-TYPE           PIC 99.
  4149         16  PB-I-INDV-GRP-CD             PIC X.
  4150         16  PB-I-MORT-CODE.
  4151             20  PB-I-TABLE               PIC X.
  4152             20  PB-I-INTEREST            PIC XX.
  4153             20  PB-I-MORT-TYP            PIC X.
  4154         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4155         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4156         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4157         16  PB-I-INDV-GRP-OVRD           PIC X.
  4158         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4159         16  PB-I-SIG-SW                  PIC X.
  4160             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4161         16  PB-I-RATE-CLASS              PIC XX.
  4162         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4163         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  74
* EL6318.cbl
  4164         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4165         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4166         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4167         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4168         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4169         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4170         16  PB-I-OB-FLAG                 PIC X.
  4171             88  PB-I-OB                      VALUE 'B'.
  4172             88  PB-I-SUMMARY                 VALUE 'Z'.
  4173         16  PB-I-ENTRY-STATUS            PIC X.
  4174             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4175                                              'M' '5' '9' '2'.
  4176             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4177             88  PB-I-POLICY-PENDING          VALUE '2'.
  4178             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4179             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4180             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4181             88  PB-I-REIN-ONLY               VALUE '9'.
  4182             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4183             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4184             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4185             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4186         16  PB-I-INT-CODE                PIC X.
  4187             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4188             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4189         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4190         16  PB-I-SOC-SEC-NO              PIC X(11).
  4191         16  PB-I-MEMBER-NO               PIC X(12).
  4192         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4193*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4194         16  PB-I-OLD-LOF                 PIC XXX.
  4195         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4196         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4197         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4198         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4199         16  PB-I-LIFE-INDICATOR          PIC X.
  4200             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4201         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4202         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4203                                          PIC S9(5)V99    COMP-3.
  4204         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4205             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4206             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4207         16  PB-I-1ST-PMT-DT              PIC XX.
  4208         16  PB-I-JOINT-INSURED.
  4209             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4210             20 PB-I-JOINT-FIRST-NAME.
  4211                24  PB-I-JOINT-FIRST-INIT PIC X.
  4212                24  FILLER                PIC X(9).
  4213             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4214*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4215         16  PB-I-BENEFICIARY-NAME.
  4216             20  PB-I-BANK-NUMBER         PIC X(10).
  4217             20  FILLER                   PIC X(15).
  4218         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4219         16  PB-I-REFERENCE               PIC X(12).
  4220         16  FILLER REDEFINES PB-I-REFERENCE.
  4221             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  75
* EL6318.cbl
  4222             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4223             20  PB-I-CLP-STATE           PIC XX.
  4224         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4225             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4226             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4227             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4228         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4229         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4230         16  PB-I-RESIDENT-STATE          PIC XX.
  4231         16  PB-I-RATE-CODE               PIC X(4).
  4232         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4233         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4234         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4235         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4236         16  PB-I-BANK-NOCHRGB            PIC 99.
  4237         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4238         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4239
  4240     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4241         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4242             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4243         16  PB-C-CANCEL-ORIGIN           PIC X.
  4244             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4245         16  PB-C-LF-CANCEL-DT            PIC XX.
  4246         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4247         16  PB-C-LF-CALC-REQ             PIC X.
  4248             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4249         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4250         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4251         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4252             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4253         16  PB-C-AH-CANCEL-DT            PIC XX.
  4254         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4255         16  PB-C-AH-CALC-REQ             PIC X.
  4256             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4257         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4258         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4259         16  PB-C-LAST-NAME               PIC X(15).
  4260         16  PB-C-REFUND-SW               PIC X.
  4261             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4262             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4263         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4264         16  PB-C-PAYEE-CODE              PIC X(6).
  4265         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4266         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4267         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4268         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4269         16  PB-C-REFERENCE               PIC X(12).
  4270         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4271         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4272         16  PB-C-POST-CARD-IND           PIC X.
  4273         16  PB-C-CANCEL-REASON           PIC X.
  4274         16  PB-C-REF-INTERFACE-SW        PIC X.
  4275         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4276         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4277         16  FILLER                       PIC X(01).
  4278*        16  FILLER                       PIC X(18).
  4279         16  PB-C-POLICY-FORM-NO          PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  76
* EL6318.cbl
  4280*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4281         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4282         16  PB-CANCELED-CERT-DATA.
  4283             20  PB-CI-INSURED-NAME.
  4284                 24  PB-CI-LAST-NAME      PIC X(15).
  4285                 24  PB-CI-INITIALS       PIC XX.
  4286             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4287             20  PB-CI-INSURED-SEX        PIC X.
  4288             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4289             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4290             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4291             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4292             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4293             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4294             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4295             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4296             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4297             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4298             20  PB-CI-RATE-CLASS         PIC XX.
  4299             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4300             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4301             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4302             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4303             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4304             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4305             20  PB-CI-LF-ABBR            PIC X(3).
  4306             20  PB-CI-AH-ABBR            PIC X(3).
  4307             20  PB-CI-OB-FLAG            PIC X.
  4308                 88  PB-CI-OB                VALUE 'B'.
  4309             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4310                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4311                                           'M' '4' '5' '9' '2'.
  4312                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4313                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4314                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4315                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4316                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4317                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4318                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4319                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4320                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4321                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4322                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4323                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4324             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4325                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4326                                           'M' '4' '5' '9' '2'.
  4327                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4328                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4329                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4330                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4331                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4332                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4333                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4334                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4335                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4336                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4337                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  77
* EL6318.cbl
  4338                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4339             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4340             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4341             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4342             20  PB-CI-MEMBER-NO          PIC X(12).
  4343             20  PB-CI-INT-CODE           PIC X.
  4344                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4345                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4346             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4347             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4348             20  PB-CI-COMP-EXCP-SW       PIC X.
  4349                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4350                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4351             20  PB-CI-ENTRY-STATUS       PIC X.
  4352             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4353             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4354             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4355             20  PB-CI-DEATH-DT           PIC XX.
  4356             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4357             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4358             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4359             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4360             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4361             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4362             20  PB-CI-ENTRY-DT              PIC XX.
  4363             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4364             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4365             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4366             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4367             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4368             20  PB-CI-OLD-LOF               PIC XXX.
  4369*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4370             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4371             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4372             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4373             20  PB-CI-INDV-GRP-CD           PIC X.
  4374             20  PB-CI-BENEFICIARY-NAME.
  4375                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4376                 24  FILLER                  PIC X(15).
  4377             20  PB-CI-NOTE-SW               PIC X.
  4378             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4379             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4380             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4381             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4382             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4383             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4384             20  PB-CI-FIRST-NAME            PIC X(10).
  4385             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4386
  4387         16  FILLER                       PIC X(13).
  4388*032306  16  FILLER                       PIC X(27).
  4389*        16  FILLER                       PIC X(46).
  4390
  4391     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4392         16  FILLER                       PIC X(10).
  4393         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4394         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4395         16  PB-M-INSURED-MID-INIT        PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  78
* EL6318.cbl
  4396         16  PB-M-INSURED-AGE             PIC 99.
  4397         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4398         16  PB-M-INSURED-SEX             PIC X.
  4399         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4400         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4401         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4402         16  PB-M-INSURED-CITY-STATE.
  4403             20  PB-M-INSURED-CITY        PIC X(28).
  4404             20  PB-M-INSURED-STATE       PIC XX.
  4405         16  PB-M-INSURED-ZIP-CODE.
  4406             20  PB-M-INSURED-ZIP-PRIME.
  4407                 24  PB-M-INSURED-ZIP-1   PIC X.
  4408                     88  PB-M-CANADIAN-POST-CODE
  4409                                             VALUE 'A' THRU 'Z'.
  4410                 24  FILLER               PIC X(4).
  4411             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4412         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4413                                        PB-M-INSURED-ZIP-CODE.
  4414             20  PM-M-INS-CAN-POST1       PIC XXX.
  4415             20  PM-M-INS-CAN-POST2       PIC XXX.
  4416             20  FILLER                   PIC XXX.
  4417         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4418         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4419         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4420         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4421         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4422         16  PB-M-CRED-BENE-CITYST.
  4423             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4424             20  PB-M-CRED-BENE-STATE     PIC XX.
  4425         16  FILLER                       PIC X(92).
  4426
  4427     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4428         16  FILLER                       PIC X(10).
  4429         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4430         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4431         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4432         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4433         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4434         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4435         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4436         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4437         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4438         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4439         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4440         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4441         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4442         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4443         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4444         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4445         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4446         16  PB-ACCOUNT-NAME              PIC X(30).
  4447         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4448         16  PB-REFERENCE                 PIC X(12).
  4449         16  PB-B-RECEIVED-DT             PIC XX.
  4450         16  FILLER                       PIC X(234).
  4451
  4452     12  PB-RECORD-STATUS.
  4453         16  PB-CREDIT-SELECT-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  79
* EL6318.cbl
  4454         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4455         16  PB-BILLED-DT                 PIC XX.
  4456         16  PB-BILLING-STATUS            PIC X.
  4457             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4458             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4459             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4460         16  PB-RECORD-BILL               PIC X.
  4461             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4462             88  PB-RECORD-RETURNED           VALUE 'R'.
  4463             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4464             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4465             88  PB-OVERRIDE-AH               VALUE 'A'.
  4466             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4467         16  PB-BATCH-ENTRY               PIC X.
  4468             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4469             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4470             88  PB-REISSUED-CERT             VALUE 'E'.
  4471             88  PB-MONTHLY-CERT              VALUE 'M'.
  4472             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4473             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4474             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4475         16  PB-FORCE-CODE                PIC X.
  4476             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4477             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4478             88  PB-CANCEL-FORCE              VALUE '8'.
  4479             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4480             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4481             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4482             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4483             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4484             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4485             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4486         16  PB-FATAL-FLAG                PIC X.
  4487             88  PB-FATAL-ERRORS              VALUE 'X'.
  4488         16  PB-FORCE-ER-CD               PIC X.
  4489             88  PB-FORCE-ERRORS              VALUE 'F'.
  4490             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4491         16  PB-WARN-ER-CD                PIC X.
  4492             88  PB-WARNING-ERRORS            VALUE 'W'.
  4493         16  FILLER                       PIC X.
  4494         16  PB-OUT-BAL-CD                PIC X.
  4495             88  PB-OUT-OF-BAL                VALUE 'O'.
  4496         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4497         16  PB-AH-OVERRIDE-L1            PIC X.
  4498         16  PB-INPUT-DT                  PIC XX.
  4499         16  PB-INPUT-BY                  PIC X(4).
  4500         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4501         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4502         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4503         16  PB-LF-EARNING-METHOD         PIC X.
  4504         16  PB-AH-EARNING-METHOD         PIC X.
  4505         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4506         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4507         16  PB-REIN-CD                   PIC XXX.
  4508         16  PB-LF-REFUND-TYPE            PIC X.
  4509         16  PB-AH-REFUND-TYPE            PIC X.
  4510         16  PB-ACCT-EFF-DT               PIC XX.
  4511         16  PB-ACCT-EXP-DT               PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  80
* EL6318.cbl
  4512         16  PB-COMPANY-ID                PIC X(3).
  4513         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4514         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4515         16  PB-SV-CARRIER                PIC X.
  4516         16  PB-SV-GROUPING               PIC X(6).
  4517         16  PB-SV-STATE                  PIC XX.
  4518         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4519         16  PB-GA-BILLING-INFO.
  4520             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4521                                          PIC XX.
  4522         16  PB-SV-REMIT-TO  REDEFINES
  4523             PB-GA-BILLING-INFO           PIC X(10).
  4524         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4525         16  PB-I-LOAN-OFFICER            PIC X(5).
  4526         16  PB-I-VIN                     PIC X(17).
  4527
  4528         16  FILLER                       PIC X(04).
  4529         16  IMNET-BYPASS-SW              PIC X.
  4530
  4531******************************************************************
  4532*                COMMON EDIT ERRORS                              *
  4533******************************************************************
  4534
  4535     12  PB-COMMON-ERRORS.
  4536         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4537                                           PIC S9(4)     COMP.
  4538
  4539******************************************************************
  4540*                                COPY ELCCERT.
  4541******************************************************************
  4542*                                                                *
  4543*                            ELCCERT.                            *
  4544*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4545*                            VMOD=2.013                          *
  4546*                                                                *
  4547*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4548*                                                                *
  4549*   FILE TYPE = VSAM,KSDS                                        *
  4550*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4551*                                                                *
  4552*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4553*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4554*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4555*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4556*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4557*                                                                *
  4558*   LOG = YES                                                    *
  4559*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4560******************************************************************
  4561*                   C H A N G E   L O G
  4562*
  4563* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4564*-----------------------------------------------------------------
  4565*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4566* EFFECTIVE    NUMBER
  4567*-----------------------------------------------------------------
  4568* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4569* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  81
* EL6318.cbl
  4570* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4571* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4572* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4573* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4574* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4575* 032612  CR2011110200001  PEMA  AHL CHANGES
  4576******************************************************************
  4577
  4578 01  CERTIFICATE-MASTER.
  4579     12  CM-RECORD-ID                      PIC XX.
  4580         88  VALID-CM-ID                      VALUE 'CM'.
  4581
  4582     12  CM-CONTROL-PRIMARY.
  4583         16  CM-COMPANY-CD                 PIC X.
  4584         16  CM-CARRIER                    PIC X.
  4585         16  CM-GROUPING.
  4586             20  CM-GROUPING-PREFIX        PIC X(3).
  4587             20  CM-GROUPING-PRIME         PIC X(3).
  4588         16  CM-STATE                      PIC XX.
  4589         16  CM-ACCOUNT.
  4590             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4591             20  CM-ACCOUNT-PRIME          PIC X(6).
  4592         16  CM-CERT-EFF-DT                PIC XX.
  4593         16  CM-CERT-NO.
  4594             20  CM-CERT-PRIME             PIC X(10).
  4595             20  CM-CERT-SFX               PIC X.
  4596
  4597     12  CM-CONTROL-BY-NAME.
  4598         16  CM-COMPANY-CD-A1              PIC X.
  4599         16  CM-INSURED-LAST-NAME          PIC X(15).
  4600         16  CM-INSURED-INITIALS.
  4601             20  CM-INSURED-INITIAL1       PIC X.
  4602             20  CM-INSURED-INITIAL2       PIC X.
  4603
  4604     12  CM-CONTROL-BY-SSN.
  4605         16  CM-COMPANY-CD-A2              PIC X.
  4606         16  CM-SOC-SEC-NO.
  4607             20  CM-SSN-STATE              PIC XX.
  4608             20  CM-SSN-ACCOUNT            PIC X(6).
  4609             20  CM-SSN-LN3.
  4610                 25  CM-INSURED-INITIALS-A2.
  4611                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4612                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4613                 25 CM-PART-LAST-NAME-A2         PIC X.
  4614
  4615     12  CM-CONTROL-BY-CERT-NO.
  4616         16  CM-COMPANY-CD-A4              PIC X.
  4617         16  CM-CERT-NO-A4                 PIC X(11).
  4618
  4619     12  CM-CONTROL-BY-MEMB.
  4620         16  CM-COMPANY-CD-A5              PIC X.
  4621         16  CM-MEMBER-NO.
  4622             20  CM-MEMB-STATE             PIC XX.
  4623             20  CM-MEMB-ACCOUNT           PIC X(6).
  4624             20  CM-MEMB-LN4.
  4625                 25  CM-INSURED-INITIALS-A5.
  4626                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4627                     30 CM-INSURED-INITIAL2-A5   PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  82
* EL6318.cbl
  4628                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4629
  4630     12  CM-INSURED-PROFILE-DATA.
  4631         16  CM-INSURED-FIRST-NAME.
  4632             20  CM-INSURED-1ST-INIT       PIC X.
  4633             20  FILLER                    PIC X(9).
  4634         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4635         16  CM-INSURED-SEX                PIC X.
  4636             88  CM-SEX-MALE                  VALUE 'M'.
  4637             88  CM-SEX-FEMAL                 VALUE 'F'.
  4638         16  CM-INSURED-JOINT-AGE          PIC 99.
  4639         16  CM-JOINT-INSURED-NAME.
  4640             20  CM-JT-LAST-NAME           PIC X(15).
  4641             20  CM-JT-FIRST-NAME.
  4642                 24  CM-JT-1ST-INIT        PIC X.
  4643                 24  FILLER                PIC X(9).
  4644             20  CM-JT-INITIAL             PIC X.
  4645
  4646     12  CM-LIFE-DATA.
  4647         16  CM-LF-BENEFIT-CD              PIC XX.
  4648         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4649         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4650         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4651         16  CM-LF-DEV-CODE                PIC XXX.
  4652         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4653         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4654         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4655         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4656         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4657         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4658         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4659         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4660         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4661         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4662         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4663         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4664         16  FILLER                        PIC XX.
  4665
  4666     12  CM-AH-DATA.
  4667         16  CM-AH-BENEFIT-CD              PIC XX.
  4668         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4669         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4670         16  CM-AH-DEV-CODE                PIC XXX.
  4671         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4672         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4673         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4674         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4675         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4676         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4677         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4678         16  CM-AH-PAID-THRU-DT            PIC XX.
  4679             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4680         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4681         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4682         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4683         16  FILLER                        PIC X.
  4684
  4685     12  CM-LOAN-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  83
* EL6318.cbl
  4686         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4687         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4688                                           PIC S9(5)V99  COMP-3.
  4689         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4690         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4691         16  CM-PAY-FREQUENCY              PIC S99.
  4692         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4693         16  CM-RATE-CLASS                 PIC XX.
  4694         16  CM-BENEFICIARY                PIC X(25).
  4695         16  CM-POLICY-FORM-NO             PIC X(12).
  4696         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4697         16  CM-LAST-ADD-ON-DT             PIC XX.
  4698         16  CM-DEDUCTIBLE-AMOUNTS.
  4699             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4700             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4701         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4702             20  CM-RESIDENT-STATE         PIC XX.
  4703             20  CM-RATE-CODE              PIC X(4).
  4704             20  FILLER                    PIC XX.
  4705         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4706             20  CM-LOAN-OFFICER           PIC X(5).
  4707             20  FILLER                    PIC XXX.
  4708         16  CM-CSR-CODE                   PIC XXX.
  4709         16  CM-UNDERWRITING-CODE          PIC X.
  4710             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4711         16  CM-POST-CARD-IND              PIC X.
  4712         16  CM-NH-INTERFACE-SW            PIC X.
  4713         16  CM-PREMIUM-TYPE               PIC X.
  4714             88  CM-SING-PRM                  VALUE '1'.
  4715             88  CM-O-B-COVERAGE              VALUE '2'.
  4716             88  CM-OPEN-END                  VALUE '3'.
  4717         16  CM-IND-GRP-TYPE               PIC X.
  4718             88  CM-INDIVIDUAL                VALUE 'I'.
  4719             88  CM-GROUP                     VALUE 'G'.
  4720         16  CM-SKIP-CODE                  PIC X.
  4721             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4722             88  SKIP-JULY                    VALUE '1'.
  4723             88  SKIP-AUGUST                  VALUE '2'.
  4724             88  SKIP-SEPTEMBER               VALUE '3'.
  4725             88  SKIP-JULY-AUG                VALUE '4'.
  4726             88  SKIP-AUG-SEPT                VALUE '5'.
  4727             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4728             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4729             88  SKIP-JUNE                    VALUE '8'.
  4730             88  SKIP-JUNE-JULY               VALUE '9'.
  4731             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4732             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4733         16  CM-PAYMENT-MODE               PIC X.
  4734             88  PAY-MONTHLY                  VALUE SPACE.
  4735             88  PAY-WEEKLY                   VALUE '1'.
  4736             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4737             88  PAY-BI-WEEKLY                VALUE '3'.
  4738             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4739         16  CM-LOAN-NUMBER                PIC X(8).
  4740         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4741         16  CM-OLD-LOF                    PIC XXX.
  4742*        16  CM-LOAN-OFFICER               PIC XXX.
  4743         16  CM-REIN-TABLE                 PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  84
* EL6318.cbl
  4744         16  CM-SPECIAL-REIN-CODE          PIC X.
  4745         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4746         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4747         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4748
  4749     12  CM-STATUS-DATA.
  4750         16  CM-ENTRY-STATUS               PIC X.
  4751         16  CM-ENTRY-DT                   PIC XX.
  4752
  4753         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4754         16  CM-LF-CANCEL-DT               PIC XX.
  4755         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4756
  4757         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4758         16  CM-LF-DEATH-DT                PIC XX.
  4759         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4760
  4761         16  CM-LF-CURRENT-STATUS          PIC X.
  4762             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4763                                                'M' '4' '5' '9'.
  4764             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4765             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4766             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4767             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4768             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4769             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4770             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4771             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4772             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4773             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4774             88  CM-LF-DECLINED               VALUE 'D'.
  4775             88  CM-LF-VOIDED                 VALUE 'V'.
  4776
  4777         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4778         16  CM-AH-CANCEL-DT               PIC XX.
  4779         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4780
  4781         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4782         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4783         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4784
  4785         16  CM-AH-CURRENT-STATUS          PIC X.
  4786             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4787                                                'M' '4' '5' '9'.
  4788             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4789             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4790             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4791             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4792             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4793             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4794             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4795             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4796             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4797             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4798             88  CM-AH-DECLINED               VALUE 'D'.
  4799             88  CM-AH-VOIDED                 VALUE 'V'.
  4800
  4801         16  CM-CLAIM-INTERFACE-SW         PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  85
* EL6318.cbl
  4802             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4803             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4804             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4805         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4806
  4807         16  CM-ENTRY-BATCH                PIC X(6).
  4808         16  CM-LF-EXIT-BATCH              PIC X(6).
  4809         16  CM-AH-EXIT-BATCH              PIC X(6).
  4810         16  CM-LAST-MONTH-END             PIC XX.
  4811
  4812     12  CM-NOTE-SW                        PIC X.
  4813         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4814         88  CERT-NOTES-PRESENT               VALUE '1'.
  4815         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4816         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4817         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4818         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4819         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4820         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4821     12  CM-COMP-EXCP-SW                   PIC X.
  4822         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4823         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4824     12  CM-INSURED-ADDRESS-SW             PIC X.
  4825         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4826         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4827
  4828*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4829     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4830     12  FILLER                            PIC X.
  4831
  4832*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4833     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4834     12  FILLER                            PIC X.
  4835*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4836     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4837
  4838     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4839         88  CERT-ADDED-BATCH                 VALUE ' '.
  4840         88  CERT-ADDED-ONLINE                VALUE '1'.
  4841         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4842         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4843         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4844     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4845         88  CERT-AS-LOADED                   VALUE ' '.
  4846         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4847         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4848         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4849         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4850         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4851         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4852         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4853
  4854     12  CM-ACCOUNT-COMM-PCTS.
  4855         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4856         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4857
  4858     12  CM-USER-FIELD                     PIC X.
  4859     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  86
* EL6318.cbl
  4860     12  CM-CLP-STATE                      PIC XX.
  4861     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4862     12  CM-USER-RESERVED                  PIC XXX.
  4863     12  FILLER REDEFINES CM-USER-RESERVED.
  4864         16  CM-AH-CLASS-CD                PIC XX.
  4865         16  F                             PIC X.
  4866******************************************************************
  4867*                                COPY ELCCRTO.
  4868******************************************************************
  4869*                                                                *
  4870*                            ELCCRTO.                            *
  4871*                                                                *
  4872*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  4873*                                                                *
  4874*   FILE TYPE = VSAM,KSDS                                        *
  4875*   RECORD SIZE = 524  RECFORM = FIXED                           *
  4876*                                                                *
  4877*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  4878*                                                                *
  4879*   LOG = YES                                                    *
  4880*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4881******************************************************************
  4882*                   C H A N G E   L O G
  4883*
  4884* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4885*-----------------------------------------------------------------
  4886*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4887* EFFECTIVE    NUMBER
  4888*-----------------------------------------------------------------
  4889* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  4890* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  4891* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  4892* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  4893* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  4894******************************************************************
  4895 01  ORIGINAL-CERTIFICATE.
  4896     12  OC-RECORD-ID                      PIC XX.
  4897         88  VALID-OC-ID                      VALUE 'OC'.
  4898     12  OC-CONTROL-PRIMARY.
  4899         16  OC-COMPANY-CD                 PIC X.
  4900         16  OC-CARRIER                    PIC X.
  4901         16  OC-GROUPING                   PIC X(6).
  4902         16  OC-STATE                      PIC XX.
  4903         16  OC-ACCOUNT                    PIC X(10).
  4904         16  OC-CERT-EFF-DT                PIC XX.
  4905         16  OC-CERT-NO.
  4906             20  OC-CERT-PRIME             PIC X(10).
  4907             20  OC-CERT-SFX               PIC X.
  4908         16  OC-RECORD-TYPE                PIC X.
  4909         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  4910     12  OC-LAST-MAINT-DT                  PIC XX.
  4911     12  OC-LAST-MAINT-BY                  PIC X(4).
  4912     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  4913     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  4914     12  FILLER                            PIC X(49).
  4915     12  OC-ORIG-REC.
  4916         16  OC-INS-LAST-NAME              PIC X(15).
  4917         16  OC-INS-FIRST-NAME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  87
* EL6318.cbl
  4918         16  OC-INS-MIDDLE-INIT            PIC X.
  4919         16  OC-INS-AGE                    PIC S999     COMP-3.
  4920         16  OC-JNT-LAST-NAME              PIC X(15).
  4921         16  OC-JNT-FIRST-NAME             PIC X(10).
  4922         16  OC-JNT-MIDDLE-INIT            PIC X.
  4923         16  OC-JNT-AGE                    PIC S999     COMP-3.
  4924         16  OC-LF-BENCD                   PIC XX.
  4925         16  OC-LF-TERM                    PIC S999      COMP-3.
  4926         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4927         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4928         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  4929         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  4930         16  OC-LF-EXP-DT                  PIC XX.
  4931         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  4932         16  OC-LF-CANCEL-DT               PIC XX.
  4933         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4934         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4935         16  OC-AH-BENCD                   PIC XX.
  4936         16  OC-AH-TERM                    PIC S999      COMP-3.
  4937         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4938         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4939         16  OC-AH-EXP-DT                  PIC XX.
  4940         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4941         16  OC-AH-CP                      PIC 99.
  4942         16  OC-AH-CANCEL-DT               PIC XX.
  4943         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4944         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4945         16  OC-CRED-BENE-NAME             PIC X(25).
  4946         16  OC-1ST-PMT-DT                 PIC XX.
  4947         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  4948         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  4949         16  OC-ISSUE-TRAN-IND             PIC X.
  4950         16  OC-CANCEL-TRAN-IND            PIC X.
  4951         16  FILLER                        PIC X(211).
  4952
  4953     12  FILLER                            PIC X(50).
  4954******************************************************************
  4955*                                COPY ERCENDT.
  4956******************************************************************
  4957*                                                                *
  4958*                                                                *
  4959*                            ERCENDT.                            *
  4960*                            VMOD=2.001                          *
  4961*                                                                *
  4962*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  4963*                                                                *
  4964*   FILE TYPE = VSAM,KSDS                                        *
  4965*   RECORD SIZE = 579  RECFORM = FIXED                           *
  4966*                                                                *
  4967*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  4968*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  4969*                                                                *
  4970*   LOG = NO                                                     *
  4971*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4972******************************************************************
  4973*-----------------------------------------------------------------
  4974*                   C H A N G E   L O G
  4975*
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  88
* EL6318.cbl
  4976* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4977*-----------------------------------------------------------------
  4978*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4979* EFFECTIVE    NUMBER
  4980*-----------------------------------------------------------------
  4981* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  4982*                                WITH OPEN CLAIMS
  4983* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  4984* 110612    2012101700002  AJRA  ADD NEW FIELDS
  4985* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  4986*-----------------------------------------------------------------
  4987 01  ENDORSEMENT-RECORD.
  4988     12  EN-RECORD-ID                PIC XX.
  4989         88  VALID-EN-ID                VALUE 'EN'.
  4990     12  EN-CONTROL-PRIMARY.
  4991         16  EN-COMPANY-CD           PIC X.
  4992         16  EN-CARRIER              PIC X.
  4993         16  EN-GROUPING             PIC X(6).
  4994         16  EN-STATE                PIC XX.
  4995         16  EN-ACCOUNT              PIC X(10).
  4996         16  EN-CERT-EFF-DT          PIC XX.
  4997         16  EN-CERT-NO.
  4998             20  EN-CERT-PRIME       PIC X(10).
  4999             20  EN-CERT-SFX         PIC X.
  5000         16  EN-REC-TYPE             PIC X.
  5001             88  EN-ISSUE               VALUE 'I'.
  5002             88  EN-CANCELLATION        VALUE 'C'.
  5003         16  EN-SEQ-NO               PIC 9(04) BINARY.
  5004     12  EN-CONTROL-BY-ARCH-NO.
  5005         16  EN-COMPANY-CD-A1              PIC X.
  5006         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  5007     12  EN-LAST-MAINT-DT            PIC XX.
  5008     12  EN-LAST-MAINT-BY            PIC X(4).
  5009     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  5010     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  5011     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  5012         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  5013         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  5014         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  5015         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  5016         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  5017         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  5018         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  5019         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  5020         16  EN-LF-ORIG-BENCD        PIC XX.
  5021         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  5022         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  5023         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  5024         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  5025         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  5026         16  EN-LF-ORIG-EXP-DT       PIC XX.
  5027*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  5028         16  EN-ORIG-CRED-BENE       PIC X(25).
  5029         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  5030         16  FILLER                  PIC X.
  5031         16  EN-AH-ORIG-BENCD        PIC XX.
  5032         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  5033         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  89
* EL6318.cbl
  5034         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  5035         16  EN-AH-ORIG-EXP-DT       PIC XX.
  5036*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  5037*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  5038         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  5039         16  F                       PIC X(09).
  5040         16  EN-AH-ORIG-CP           PIC 99.
  5041         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  5042         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  5043         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  5044         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  5045         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  5046         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  5047         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  5048         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  5049         16  EN-LF-NEW-BENCD         PIC XX.
  5050         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  5051         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  5052         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  5053         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  5054         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  5055         16  EN-LF-NEW-EXP-DT        PIC XX.
  5056         16  EN-NEW-CRED-BENE        PIC X(25).
  5057         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  5058         16  FILLER                  PIC X.
  5059         16  EN-AH-NEW-BENCD         PIC XX.
  5060         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  5061         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  5062         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  5063         16  EN-AH-NEW-EXP-DT        PIC XX.
  5064*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  5065*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  5066*        16  F                       PIC X(12).
  5067         16  EN-AH-NEW-CP            PIC 99.
  5068         16  EN-SIG-SW               PIC X.
  5069         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  5070         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  5071         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  5072         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  5073         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  5074         16  FILLER                  PIC X(33).
  5075     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  5076         16  EN-LF-ORIG-REF-DT       PIC XX.
  5077         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  5078         16  EN-AH-ORIG-REF-DT       PIC XX.
  5079         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  5080         16  EN-LF-NEW-REF-DT        PIC XX.
  5081         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  5082         16  EN-AH-NEW-REF-DT        PIC XX.
  5083         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  5084         16  EN-FLAG-CERT            PIC X.
  5085         16  EN-INS-LAST-NAME        PIC X(15).
  5086         16  EN-INS-FIRST-NAME       PIC X(10).
  5087         16  EN-INS-MIDDLE-INIT      PIC X.
  5088         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  5089         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  5090         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  5091         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  90
* EL6318.cbl
  5092         16  FILLER                  PIC X(262).
  5093     12  EN-MONEY-SW             PIC X.
  5094     12  EN-HEALTH-APP           PIC X.
  5095     12  EN-VOUCHER-SW           PIC X.
  5096     12  EN-PAYEE                PIC X(14).
  5097     12  EN-INPUT-DT             PIC XX.
  5098     12  EN-PROCESS-DT           PIC XX.
  5099     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  5100     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  5101     12  EN-REASON-CODES.
  5102         16  F OCCURS 12.
  5103             20  EN-REASON-CODE  PIC X(4).
  5104     12  EN-TEMPLATE-USED        PIC X(8).
  5105     12  EN-DOCU-TYPE            PIC X.
  5106         88  EN-VERI-DOCU          VALUE 'V'.
  5107         88  EN-GCE-DOCU           VALUE 'G'.
  5108         88  EN-CANC-DOCU          VALUE 'C'.
  5109     12  EN-COMMENTS1            PIC X(13).
  5110     12  EN-COMMENTS2            PIC X(70).
  5111     12  EN-COMM-CHGBK           PIC X.
  5112         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  5113         88  EN-CHG-ACCT           VALUE 'Y'.
  5114     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  5115     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  5116     12  EN-BATCH-NUMBER         PIC X(6).
  5117     12  EN-ACCT-SUMM            PIC X.
  5118     12  EN-CSO-SUMM             PIC X.
  5119     12  FILLER                  PIC X(13).
  5120******************************************************************
  5121*                                COPY ERCNOTE.
  5122******************************************************************
  5123*                                                                *
  5124*                                                                *
  5125*                            ERCNOTE                             *
  5126*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5127*                            VMOD=2.003                          *
  5128*                                                                *
  5129*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  5130*                                                                *
  5131*        FILE TYPE= VSAM,KSDS                                    *
  5132*        RECORD SIZE = 825    RECFORM = FIXED                    *
  5133*                                                                *
  5134*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  5135*                                                                *
  5136*        LOG = YES                                               *
  5137*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5138*                                                                *
  5139******************************************************************
  5140*                   C H A N G E   L O G
  5141*
  5142* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5143*-----------------------------------------------------------------
  5144*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5145* EFFECTIVE    NUMBER
  5146*-----------------------------------------------------------------
  5147* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  5148*                                FILE WILL CONTAIN BILLING NOTES O
  5149******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  91
* EL6318.cbl
  5150
  5151 01  CERTIFICATE-NOTE.
  5152     12  CN-RECORD-ID                PIC  XX.
  5153         88  VALID-CN-ID                  VALUE 'CN'.
  5154
  5155     12  CN-CONTROL-PRIMARY.
  5156         16  CN-COMPANY-CD           PIC X.
  5157         16  CN-CARRIER              PIC X.
  5158         16  CN-GROUPING.
  5159             20 CN-GROUPING-PREFIX   PIC XXX.
  5160             20 CN-GROUPING-PRIME    PIC XXX.
  5161         16  CN-STATE                PIC XX.
  5162         16  CN-ACCOUNT.
  5163             20 CN-ACCOUNT-PREFIX    PIC X(4).
  5164             20 CN-ACCOUNT-PRIME     PIC X(6).
  5165         16  CN-CERT-EFF-DT          PIC XX.
  5166         16  CN-CERT-NO.
  5167             20  CN-CERT-PRIME       PIC X(10).
  5168             20  CN-CERT-SFX         PIC X.
  5169
  5170     12  CN-BILLING-START-LINE-NO    PIC 99.
  5171     12  CN-BILLING-END-LINE-NO      PIC 99.
  5172
  5173     12  CN-LINES.
  5174         16  CN-LINE OCCURS 10       PIC X(77).
  5175
  5176     12  CN-LAST-MAINT-DT            PIC XX.
  5177     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5178     12  CN-LAST-MAINT-USER          PIC X(4).
  5179     12  FILLER                      PIC X(6).
  5180******************************************************************
  5181*                                COPY ERCMAIL.
  5182******************************************************************
  5183*                                                                *
  5184*                                                                *
  5185*                            ERCMAIL                             *
  5186*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5187*                            VMOD=2.003                          *
  5188*                                                                *
  5189*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5190*                                                                *
  5191*   FILE TYPE = VSAM,KSDS                                        *
  5192*   RECORD SIZE = 374   RECFORM = FIX                            *
  5193*                                                                *
  5194*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5195*   ALTERNATE PATH    = NOT USED                                 *
  5196*                                                                *
  5197*   LOG = YES                                                    *
  5198*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5199******************************************************************
  5200*                   C H A N G E   L O G
  5201*
  5202* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5203*-----------------------------------------------------------------
  5204*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5205* EFFECTIVE    NUMBER
  5206*-----------------------------------------------------------------
  5207* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  92
* EL6318.cbl
  5208* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5209* 111108                   PEMA  ADD CRED BENE ADDR2
  5210******************************************************************
  5211
  5212 01  MAILING-DATA.
  5213     12  MA-RECORD-ID                      PIC XX.
  5214         88  VALID-MA-ID                       VALUE 'MA'.
  5215
  5216     12  MA-CONTROL-PRIMARY.
  5217         16  MA-COMPANY-CD                 PIC X.
  5218         16  MA-CARRIER                    PIC X.
  5219         16  MA-GROUPING.
  5220             20  MA-GROUPING-PREFIX        PIC XXX.
  5221             20  MA-GROUPING-PRIME         PIC XXX.
  5222         16  MA-STATE                      PIC XX.
  5223         16  MA-ACCOUNT.
  5224             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5225             20  MA-ACCOUNT-PRIME          PIC X(6).
  5226         16  MA-CERT-EFF-DT                PIC XX.
  5227         16  MA-CERT-NO.
  5228             20  MA-CERT-PRIME             PIC X(10).
  5229             20  MA-CERT-SFX               PIC X.
  5230
  5231     12  FILLER                            PIC XX.
  5232
  5233     12  MA-ACCESS-CONTROL.
  5234         16  MA-SOURCE-SYSTEM              PIC XX.
  5235             88  MA-FROM-CREDIT                VALUE 'CR'.
  5236             88  MA-FROM-VSI                   VALUE 'VS'.
  5237             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5238             88  MA-FROM-OTHER                 VALUE 'OT'.
  5239         16  MA-RECORD-ADD-DT              PIC XX.
  5240         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5241         16  MA-LAST-MAINT-DT              PIC XX.
  5242         16  MA-LAST-MAINT-BY              PIC XXXX.
  5243         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5244
  5245     12  MA-PROFILE-INFO.
  5246         16  MA-QUALIFY-CODE-1             PIC XX.
  5247         16  MA-QUALIFY-CODE-2             PIC XX.
  5248         16  MA-QUALIFY-CODE-3             PIC XX.
  5249         16  MA-QUALIFY-CODE-4             PIC XX.
  5250         16  MA-QUALIFY-CODE-5             PIC XX.
  5251
  5252         16  MA-INSURED-LAST-NAME          PIC X(15).
  5253         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5254         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5255         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5256         16  MA-INSURED-BIRTH-DT           PIC XX.
  5257         16  MA-INSURED-SEX                PIC X.
  5258             88  MA-SEX-MALE                   VALUE 'M'.
  5259             88  MA-SEX-FEMALE                 VALUE 'F'.
  5260         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5261
  5262         16  MA-ADDRESS-CORRECTED          PIC X.
  5263         16  MA-JOINT-BIRTH-DT             PIC XX.
  5264*        16  FILLER                        PIC X(12).
  5265
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  93
* EL6318.cbl
  5266         16  MA-ADDRESS-LINE-1             PIC X(30).
  5267         16  MA-ADDRESS-LINE-2             PIC X(30).
  5268         16  MA-CITY-STATE.
  5269             20  MA-CITY                   PIC X(28).
  5270             20  MA-ADDR-STATE             PIC XX.
  5271         16  MA-ZIP.
  5272             20  MA-ZIP-CODE.
  5273                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5274                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5275                 24  FILLER                PIC X(4).
  5276             20  MA-ZIP-PLUS4              PIC X(4).
  5277         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5278             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5279             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5280             20  FILLER                    PIC X(3).
  5281
  5282         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5283
  5284         16  FILLER                        PIC XXX.
  5285*        16  FILLER                        PIC X(10).
  5286
  5287     12  MA-CRED-BENE-INFO.
  5288         16  MA-CRED-BENE-NAME                 PIC X(25).
  5289         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5290         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5291         16  MA-CRED-BENE-CTYST.
  5292             20  MA-CRED-BENE-CITY             PIC X(28).
  5293             20  MA-CRED-BENE-STATE            PIC XX.
  5294         16  MA-CRED-BENE-ZIP.
  5295             20  MA-CB-ZIP-CODE.
  5296                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5297                     88  MA-CB-CANADIAN-POST-CODE
  5298                                           VALUE 'A' THRU 'Z'.
  5299                 24  FILLER                    PIC X(4).
  5300             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5301         16  MA-CB-CANADIAN-POSTAL-CODE
  5302                            REDEFINES MA-CRED-BENE-ZIP.
  5303             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5304             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5305             20  FILLER                        PIC X(3).
  5306     12  MA-POST-CARD-MAIL-DATA.
  5307         16  MA-MAIL-DATA OCCURS 7.
  5308             20  MA-MAIL-TYPE              PIC X.
  5309                 88  MA-12MO-MAILING           VALUE '1'.
  5310                 88  MA-EXP-MAILING            VALUE '2'.
  5311             20  MA-MAIL-STATUS            PIC X.
  5312                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5313                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5314                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5315             20  MA-MAIL-DATE              PIC XX.
  5316     12  FILLER                            PIC XX.
  5317     12  FILLER                            PIC XX.
  5318*    12  FILLER                            PIC X(30).
  5319******************************************************************
  5320*                                COPY ERCARCH.
  5321******************************************************************
  5322*                                                                *
  5323*                            ERCARCH.                            *
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  94
* EL6318.cbl
  5324*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5325*                            VMOD=2.002                          *
  5326*                                                                *
  5327*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  5328*                                                                *
  5329*   FILE TYPE = VSAM,KSDS                                        *
  5330*   RECORD SIZE = 250  RECFORM = FIXED                           *
  5331*                                                                *
  5332*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  5333*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  5334*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  5335*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  5336*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  5337*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  5338*                                                                *
  5339*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5340******************************************************************
  5341*                   C H A N G E   L O G
  5342*
  5343* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5344*-----------------------------------------------------------------
  5345*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5346* EFFECTIVE    NUMBER
  5347*-----------------------------------------------------------------
  5348* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  5349* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  5350* 110612    2012101700002  AJRA  ADD NEW FIELDS
  5351******************************************************************
  5352 01  LETTER-ARCHIVE.
  5353     12  LA-RECORD-ID                PIC  X(02).
  5354         88  LA-VALID-ID                VALUE 'LA'.
  5355
  5356     12  LA-CONTROL-PRIMARY.
  5357         16  LA-COMPANY-CD           PIC  X(01).
  5358         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  5359
  5360     12  LA-CONTROL-BY-CERT-RESP.
  5361         16  LA-COMPANY-CD-A2        PIC  X(01).
  5362         16  LA-CERT-NO-A2.
  5363             20  LA-CERT-PRIME-A2    PIC  X(10).
  5364             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  5365         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  5366             20  LA-RESP-PERSON-A2   PIC  X(10).
  5367             20  LA-TYPE-A2          PIC  X(01).
  5368         16  LA-CARRIER-A2           PIC  X(01).
  5369         16  LA-GROUPING-A2          PIC  X(06).
  5370         16  LA-STATE-A2             PIC  X(02).
  5371         16  LA-ACCOUNT-A2           PIC  X(10).
  5372         16  LA-EFFECT-DATE-A2       PIC  X(02).
  5373         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  5374
  5375     12  LA-CONTROL-BY-FORM.
  5376         16  LA-COMPANY-CD-A3        PIC  X(01).
  5377         16  LA-FORM-A3              PIC  X(04).
  5378         16  LA-CARRIER-A3           PIC  X(01).
  5379         16  LA-GROUPING-A3          PIC  X(06).
  5380         16  LA-STATE-A3             PIC  X(02).
  5381         16  LA-ACCOUNT-A3           PIC  X(10).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  95
* EL6318.cbl
  5382         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  5383
  5384     12  LA-CONTROL-BY-PROCESSOR.
  5385         16  LA-COMPANY-CD-A4        PIC  X(01).
  5386         16  LA-PROCESSOR-CD         PIC  X(04).
  5387         16  LA-CARRIER-A4           PIC  X(01).
  5388         16  LA-GROUPING-A4          PIC  X(06).
  5389         16  LA-STATE-A4             PIC  X(02).
  5390         16  LA-ACCOUNT-A4           PIC  X(10).
  5391         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  5392
  5393     12  LA-CONTROL-BY-KEY-FIELDS.
  5394         16  LA-COMPANY-CD-A5        PIC  X(01).
  5395         16  LA-CARRIER-A5           PIC  X(01).
  5396         16  LA-GROUPING-A5          PIC  X(06).
  5397         16  LA-STATE-A5             PIC  X(02).
  5398         16  LA-ACCOUNT-A5           PIC  X(10).
  5399         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  5400
  5401     12  LA-CONTROL-BY-GROUP-CODE.
  5402         16  LA-COMPANY-CD-A6        PIC  X(01).
  5403         16  LA-ENTRY-A6.
  5404             20  LA-FILLER           PIC  X(02).
  5405             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  5406         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  5407
  5408     12  FILLER                      PIC  X(09).
  5409
  5410     12  LA-HEADER-RECORD.
  5411         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  5412         16  LA-CREATION-DATE        PIC  X(02).
  5413         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  5414         16  LA-FINAL-ACT-DATE       REDEFINES
  5415               LA-FOLLOW-UP-DATE     PIC  X(02).
  5416         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  5417         16  LA-NO-OF-COPIES         PIC S9(01).
  5418         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  5419         16  LA-REPLY-DATE           PIC  X(02).
  5420         16  LA-RESEND-DATES.
  5421             20  LA-RESEND-DATE      PIC  X(02).
  5422             20  LA-SENT-DATE        PIC  X(02).
  5423             20  FILLER              PIC  X(08).
  5424         16  LA-SOURCE-INFORMATION.
  5425             20  LA-DATA-SOURCE      PIC  X(01).
  5426             20  LA-ADDR-SOURCE      PIC  X(01).
  5427         16  LA-STATUS               PIC  X(01).
  5428             88  LA-STATUS-ACTIVE         VALUE 'A'.
  5429             88  LA-STATUS-COMPLETED      VALUE 'C'.
  5430             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  5431             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  5432             88  LA-STATUS-PURGED         VALUE 'P'.
  5433             88  LA-STATUS-VOIDED         VALUE 'V'.
  5434         16  LA-LAST-RESENT-PRINT-DATE
  5435                                     PIC  X(02).
  5436         16  LA-PRINT-RESTRICTION    PIC  X(01).
  5437             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  5438                                          VALUE 'C'.
  5439             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  96
* EL6318.cbl
  5440                                          VALUE 'F'.
  5441             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  5442                                          VALUE 'P'.
  5443         16  LA-PURGED-DATE          PIC  X(02).
  5444         16  LA-VOIDED-DATE          PIC  X(02).
  5445         16  LA-RESEND-LETR          PIC  X(4).
  5446         16  FILLER                  PIC  X(08).
  5447*        16  LA-RESEND-LETR-2        PIC  X(4).
  5448*        16  LA-RESEND-LETR-3        PIC  X(4).
  5449*        16  FILLER                  PIC  X(59).
  5450         16  LA-ARCHIVE-STATUS       PIC  X.
  5451             88  LA-TEMP                VALUE 'T'.
  5452             88  LA-QWS                 VALUE 'Q'.
  5453             88  LA-BATCH               VALUE 'B'.
  5454         16  LA-FINAL-ACT-IND        PIC  X(1).
  5455         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  5456         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  5457         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  5458                                     PIC X(4).
  5459         16  FILLER                  PIC  X(42).
  5460*        16  FILLER                  PIC  X(71).
  5461         16  LA-LAST-MAINT-DATE      PIC  X(2).
  5462         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  5463         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  5464                                     PIC  X(4).
  5465         16  LA-LAST-UPDATED-BY      PIC  X(4).
  5466
  5467******************************************************************
  5468*                                COPY ERCCNOT.
  5469******************************************************************
  5470*                                                                *
  5471*                            ERCCNOT                             *
  5472*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5473*                            VMOD=2.003                          *
  5474*                                                                *
  5475*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  5476*                                                                *
  5477*        FILE TYPE= VSAM,KSDS                                    *
  5478*        RECORD SIZE = 150    RECFORM = FIXED                    *
  5479*                                                                *
  5480*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  5481*                                                                *
  5482*        LOG = YES                                               *
  5483*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5484*                                                                *
  5485******************************************************************
  5486*                   C H A N G E   L O G
  5487*
  5488* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5489*-----------------------------------------------------------------
  5490*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5491* EFFECTIVE    NUMBER
  5492*-----------------------------------------------------------------
  5493* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  5494******************************************************************
  5495
  5496 01  CERT-NOTE-FILE.
  5497     12  CZ-RECORD-ID                PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  97
* EL6318.cbl
  5498         88  VALID-CZ-ID                  VALUE 'CZ'.
  5499
  5500     12  CZ-CONTROL-PRIMARY.
  5501         16  CZ-COMPANY-CD           PIC X.
  5502         16  CZ-CARRIER              PIC X.
  5503         16  CZ-GROUPING.
  5504             20 CZ-GROUPING-PREFIX   PIC XXX.
  5505             20 CZ-GROUPING-PRIME    PIC XXX.
  5506         16  CZ-STATE                PIC XX.
  5507         16  CZ-ACCOUNT.
  5508             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  5509             20 CZ-ACCOUNT-PRIME     PIC X(6).
  5510         16  CZ-CERT-EFF-DT          PIC XX.
  5511         16  CZ-CERT-NO.
  5512             20  CZ-CERT-PRIME       PIC X(10).
  5513             20  CZ-CERT-SFX         PIC X.
  5514         16  CZ-RECORD-TYPE          PIC X.
  5515             88  CERT-NOTE           VALUE '1'.
  5516             88  CLAIM-CERT-NOTE     VALUE '2'.
  5517         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  5518
  5519     12  CZ-LAST-MAINT-DT            PIC XX.
  5520     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5521     12  CZ-LAST-MAINT-USER          PIC X(4).
  5522
  5523     12  CZ-NOTE-INFORMATION.
  5524         16  CZ-NOTE                 PIC X(63).
  5525         16  FILLER                  PIC X(39).
  5526******************************************************************
  5527*                                COPY ELCEOBC.
  5528******************************************************************
  5529*                                                                *
  5530*                                                                *
  5531*                            ELCEOBC                             *
  5532*                            VMOD=2.001                          *
  5533*                                                                *
  5534*   CLAIM SYSTEM EOB CODE TABLE                                  *
  5535*                                                                *
  5536*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5537*   VSAM EOB CODE TABLE                                          *
  5538*                                                                *
  5539*   FILE DESCRIPTION = EOB CODE TABLE                            *
  5540*                                                                *
  5541*   FILE TYPE = VSAM,KSDS                                        *
  5542*   RECORD SIZE = 350   RECFORM = FIX                            *
  5543*                                                                *
  5544*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
  5545*                                                                *
  5546*   LOG = NO                                                     *
  5547*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5548*                                                                *
  5549*                                                                *
  5550******************************************************************
  5551*                   C H A N G E   L O G
  5552*
  5553* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5554*-----------------------------------------------------------------
  5555*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  98
* EL6318.cbl
  5556* EFFECTIVE    NUMBER
  5557*-----------------------------------------------------------------
  5558* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  5559* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
  5560* 091913    2013090300001  AJRA  ADDITIONAL RECORD TYPES
  5561******************************************************************
  5562 01  EOB-CODES.
  5563     12  EO-RECORD-ID                      PIC XX.
  5564         88  VALID-DN-ID                      VALUE 'EO'.
  5565     12  EO-CONTROL-PRIMARY.
  5566         16  EO-COMPANY-CD                 PIC X.
  5567         16  EO-RECORD-TYPE                PIC X.
  5568             88  EO-EOB-RECS                  VALUE '1'.
  5569             88  EO-VERIF-RECS                VALUE '2'.
  5570             88  EO-GCE-RECS                  VALUE '3'.
  5571             88  EO-CANC-RECS                 VALUE '4'.
  5572             88  EO-BILL-NOTE-RECS            VALUE '5'.
  5573         16  EO-EOB-CODE                   PIC X(4).
  5574         16  FILLER                        PIC X(9).
  5575     12  EO-MAINT-INFORMATION.
  5576         16  EO-LAST-MAINT-DT              PIC XX.
  5577         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5578         16  EO-LAST-MAINT-USER            PIC X(4).
  5579         16  FILLER                        PIC XX.
  5580     12  EO-DESCRIPTION                    PIC X(275).
  5581     12  FILLER                            PIC X(46).
  5582******************************************************************
  5583*                                COPY ELCCRTT.
  5584******************************************************************
  5585*                                                                *
  5586*                            ELCCRTT.                            *
  5587*                                                                *
  5588*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  5589*                                                                *
  5590*   FILE TYPE = VSAM,KSDS                                        *
  5591*   RECORD SIZE = 552  RECFORM = FIXED                           *
  5592*                                                                *
  5593*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  5594*                                                                *
  5595*   LOG = YES                                                    *
  5596*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5597******************************************************************
  5598*                   C H A N G E   L O G
  5599*
  5600* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5601*-----------------------------------------------------------------
  5602*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5603* EFFECTIVE    NUMBER
  5604*-----------------------------------------------------------------
  5605* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  5606* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  5607* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  5608* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5609* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5610******************************************************************
  5611
  5612 01  CERTIFICATE-TRAILERS.
  5613     12  CS-RECORD-ID                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  99
* EL6318.cbl
  5614         88  VALID-CS-ID                      VALUE 'CS'.
  5615
  5616     12  CS-CONTROL-PRIMARY.
  5617         16  CS-COMPANY-CD                 PIC X.
  5618         16  CS-CARRIER                    PIC X.
  5619         16  CS-GROUPING                   PIC X(6).
  5620         16  CS-STATE                      PIC XX.
  5621         16  CS-ACCOUNT                    PIC X(10).
  5622         16  CS-CERT-EFF-DT                PIC XX.
  5623         16  CS-CERT-NO.
  5624             20  CS-CERT-PRIME             PIC X(10).
  5625             20  CS-CERT-SFX               PIC X.
  5626         16  CS-TRAILER-TYPE               PIC X.
  5627             88  COMM-TRLR           VALUE 'A'.
  5628             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  5629             88  CERT-DATA-TRLR      VALUE 'C'.
  5630
  5631     12  CS-DATA-AREA                      PIC X(516).
  5632
  5633     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5634         16  CS-BANK-COMMISSION-AREA.
  5635             20  CS-BANK-COMMS       OCCURS 10.
  5636                 24  CS-AGT                PIC X(10).
  5637                 24  CS-COM-TYP            PIC X.
  5638                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5639                 24  CS-RECALC-LV-INDIC    PIC X.
  5640                 24  FILLER                PIC X(10).
  5641         16  FILLER                        PIC X(256).
  5642
  5643     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  5644****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  5645****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  5646         16  CS-MB-CLAIM-DATA OCCURS 2.
  5647             20  FILLER OCCURS 10.
  5648                 24  CS-CLAIM-TYPE         PIC X.
  5649                     88  CS-AH-CLM           VALUE 'A'.
  5650                     88  CS-IU-CLM           VALUE 'I'.
  5651                     88  CS-GP-CLM           VALUE 'G'.
  5652                     88  CS-LF-CLM           VALUE 'L'.
  5653                     88  CS-PR-CLM           VALUE 'P'.
  5654                 24  CS-BANK               PIC S999 COMP-3.
  5655                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  5656                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  5657                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  5658         16  FILLER                        PIC X(216).
  5659     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5660         16  CS-VIN-NUMBER                 PIC X(17).
  5661         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5662         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5663         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5664         16  FILLER                        PIC X(496).
  5665******************************************************************
  5666*                                COPY ELCENCC.
  5667******************************************************************
  5668*                                                                *
  5669*                                                                *
  5670*                            ELCENCC                             *
  5671*                            VMOD=2.001                          *
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 100
* EL6318.cbl
  5672*                                                                *
  5673*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  5674*                                                                *
  5675*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  5676*   A NAPERSOFT DOCUMENT                                         *
  5677*                                                                *
  5678*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  5679*                                                                *
  5680*   FILE TYPE = VSAM,KSDS                                        *
  5681*   RECORD SIZE = 400   RECFORM = FIX                            *
  5682*                                                                *
  5683*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  5684*                                                                *
  5685*   LOG = NO                                                     *
  5686*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5687*                                                                *
  5688*                                                                *
  5689******************************************************************
  5690*                   C H A N G E   L O G
  5691*
  5692* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5693*-----------------------------------------------------------------
  5694*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5695* EFFECTIVE    NUMBER
  5696*-----------------------------------------------------------------
  5697* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  5698******************************************************************
  5699 01  ENCLOSURE-CODES.
  5700     12  NC-RECORD-ID                      PIC XX.
  5701         88  VALID-NC-ID                      VALUE 'NC'.
  5702     12  NC-CONTROL-PRIMARY.
  5703         16  NC-COMPANY-CD                 PIC X.
  5704         16  NC-REC-TYPE                   PIC X.
  5705             88  NC-CLAIMS                   VALUE '1'.
  5706             88  NC-ADMIN                    VALUE '2'.
  5707         16  NC-ENC-CODE                   PIC X(5).
  5708         16  FILLER                        PIC X(09).
  5709     12  NC-MAINT-INFORMATION.
  5710         16  NC-LAST-MAINT-DT              PIC XX.
  5711         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5712         16  NC-LAST-MAINT-USER            PIC X(4).
  5713         16  FILLER                        PIC XX.
  5714     12  NC-OUTPUT-STACK                   PIC XXX.
  5715     12  NC-ENCLOSURE-LINE                 PIC X(100).
  5716     12  NC-ATTACHMENTS                    PIC X(100).
  5717     12  NC-FUTURE                         PIC X(50).
  5718     12  FILLER                            PIC X(117).
  5719******************************************************************
  5720 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR
  5721                          ACCOUNT-MASTER CONTROL-FILE
  5722                          PENDING-BUSINESS CERTIFICATE-MASTER
  5723                          ORIGINAL-CERTIFICATE
  5724                          ENDORSEMENT-RECORD CERTIFICATE-NOTE
  5725                          MAILING-DATA LETTER-ARCHIVE
  5726                          CERT-NOTE-FILE EOB-CODES
  5727                          CERTIFICATE-TRAILERS ENCLOSURE-CODES.
  5728 0000-DFHEXIT SECTION.
  5729     MOVE '9#                    $   ' TO DFHEIV0.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 101
* EL6318.cbl
  5730     MOVE 'EL6318' TO DFHEIV1.
  5731     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5732     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK
  5733     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  5734     MOVE '5'                    TO DC-OPTION-CODE
  5735     PERFORM 9700-DATE-LINK
  5736     MOVE DC-GREG-DATE-1-EDIT    TO WS-CURRENT-DT
  5737     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT
  5738     MOVE EIBTRMID               TO QID-TERM
  5739     MOVE 2                      TO EMI-NUMBER-OF-LINES
  5740     IF EIBCALEN = 0
  5741        GO TO 8800-UNAUTHORIZED-ACCESS
  5742     END-IF
  5743     MOVE FUNCTION LENGTH(EL631KI) TO MAP-LENGTH
  5744     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5745        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5746           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5747           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5748           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5749           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5750           MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5751           MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5752           MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5753           MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5754           MOVE LOW-VALUES           TO EL631KI
  5755           MOVE 'Y'                  TO PI-CLEAR-ERROR-SW
  5756           GO TO 0350-BUILD-INIT-MAP
  5757        END-IF
  5758     END-IF
  5759     IF PI-CALLING-PROGRAM = 'EL614'
  5760        MOVE PI-PROGRAM-WORK-AREA (1:60)
  5761                                 TO WS-PASSED-REASON-CODES
  5762        DISPLAY ' COMING BACK FROM 614 ' WS-PASSED-REASON-CODES
  5763        IF WS-PASSED-REASON-CODES NOT = SPACES
  5764           MOVE 'Y'                TO WS-SET-CODES-MDT
  5765        ELSE
  5766           MOVE 'N'                TO WS-SET-CODES-MDT
  5767        END-IF
  5768        PERFORM 0600-RECOVER-TEMP-STORAGE
  5769                                 THRU 0600-EXIT
  5770        GO TO 0350-BUILD-INIT-MAP
  5771     END-IF
  5772     IF EIBAID = DFHCLEAR
  5773        IF PI-CLEAR-ERROR
  5774           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5775           MOVE ER-3833           TO EMI-ERROR
  5776           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5777           GO TO 0350-BUILD-INIT-MAP
  5778        ELSE
  5779           GO TO 9400-CLEAR
  5780        END-IF
  5781     END-IF
  5782     .
  5783 0200-RECEIVE.
  5784     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5785        MOVE ER-0008             TO EMI-ERROR
  5786        PERFORM 9900-ERROR-FORMAT
  5787                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 102
* EL6318.cbl
  5788        MOVE -1                  TO PFENTRL
  5789        GO TO 8100-SEND-INITIAL-MAP
  5790     END-IF
  5791
  5792* EXEC CICS RECEIVE
  5793*        MAP      (MAP-NAME)
  5794*        MAPSET   (MAPSET-NAME)
  5795*        INTO     (EL631KI)
  5796*    END-EXEC
  5797     MOVE LENGTH OF
  5798      EL631KI
  5799       TO DFHEIV11
  5800*    MOVE '8"T I  L              ''   #00005787' TO DFHEIV0
  5801     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5802     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5803     MOVE X'2020233030303035373837' TO DFHEIV0(25:11)
  5804     CALL 'kxdfhei1' USING DFHEIV0,
  5805           MAP-NAME,
  5806           EL631KI,
  5807           DFHEIV11,
  5808           MAPSET-NAME,
  5809           DFHEIV99,
  5810           DFHEIV99
  5811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5812     IF PFENTRL = 0
  5813         GO TO 0300-CHECK-PFKEYS
  5814     END-IF
  5815     IF EIBAID NOT = DFHENTER
  5816         MOVE ER-0004            TO EMI-ERROR
  5817         GO TO 0320-INPUT-ERROR
  5818     END-IF
  5819     IF (PFENTRI NUMERIC) AND (PFENTRI > 0 AND < 25)
  5820        MOVE PF-VALUES (PFENTRI) TO EIBAID
  5821     ELSE
  5822        MOVE ER-0029            TO EMI-ERROR
  5823        GO TO 0320-INPUT-ERROR
  5824     END-IF
  5825     .
  5826 0300-CHECK-PFKEYS.
  5827     IF EIBAID = DFHPF3
  5828        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5829        PERFORM 0500-CREATE-TEMP-STORAGE THRU 0500-EXIT
  5830        MOVE 'EL614'             TO PGM-NAME
  5831        MOVE PI-REASON-CODE-IND  TO WS-SAVE-REASON-CODE-IND
  5832        MOVE SPACES              TO PI-PROGRAM-WORK-AREA
  5833        move +1                  to s2
  5834        perform varying s1 from +1 by +1 until s1 > +12
  5835           if reacd-in (s1) not = spaces and low-values
  5836              move reacd-in (s1)    to pi-program-work-area (s2:4)
  5837              add +5 to s2
  5838           end-if
  5839        END-perform
  5840        MOVE WS-SAVE-REASON-CODE-IND TO PI-REASON-CODE-IND
  5841        DISPLAY ' GOING TO 614 ' PI-PROGRAM-WORK-AREA (1:60)
  5842        GO TO 9300-XCTL
  5843     END-IF
  5844     IF EIBAID = DFHPF4 OR DFHPF8
  5845        GO TO 0360-FINALIZE
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 103
* EL6318.cbl
  5846     END-IF
  5847     IF EIBAID = DFHPF23
  5848        IF PI-CLEAR-ERROR
  5849           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5850           MOVE ER-3833           TO EMI-ERROR
  5851           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5852           GO TO 0350-BUILD-INIT-MAP
  5853        ELSE
  5854           GO TO 8810-PF23
  5855        END-IF
  5856     END-IF
  5857     IF EIBAID = DFHPF24
  5858        IF PI-CLEAR-ERROR
  5859           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5860           MOVE ER-3833           TO EMI-ERROR
  5861           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5862           GO TO 0350-BUILD-INIT-MAP
  5863        ELSE
  5864           GO TO 9200-RETURN-MAIN-MENU
  5865        END-IF
  5866     END-IF
  5867     IF EIBAID = DFHPF12
  5868        GO TO 9500-PF12
  5869     END-IF
  5870     IF EIBAID = DFHENTER
  5871        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5872        PERFORM 0325-EDIT-SCREEN THRU 0325-EXIT
  5873        GO TO 0330-CHECK-ERRORS
  5874     END-IF
  5875     MOVE ER-0029                TO EMI-ERROR
  5876     .
  5877 0320-INPUT-ERROR.
  5878     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5879     MOVE AL-UNBON               TO PFENTRA
  5880     MOVE -1                     TO PFENTRL
  5881     GO TO 8200-SEND-DATAONLY
  5882     .
  5883 0325-EDIT-SCREEN.
  5884     IF PRTSWL > ZEROS
  5885       IF PRTSWI = 'Y' OR 'N' OR 'P' OR ' '
  5886*          MOVE AL-UANON       TO PRTSWA
  5887*          IF PRTSWI = ' '
  5888*             MOVE 'N'         TO PRTSWI
  5889              MOVE 'P'         TO PRTSWI
  5890*          END-IF
  5891*          MOVE PRTSWI         TO PI-PRTSW-ENTERED
  5892        END-IF
  5893     END-IF
  5894     IF LTRIDL > ZEROS
  5895        AND LTRIDI > SPACES
  5896        MOVE PI-COMPANY-CD       TO LETR-COMPANY-CD
  5897        MOVE LTRIDI              TO LETR-LETTER-ID
  5898                                    PI-LTRID-ENTERED
  5899        MOVE LETR-PART-KEY       TO ELLETR-SAVE-PART-KEY
  5900        MOVE SPACES              TO LETR-FILLER
  5901        MOVE 0                   TO LETR-SEQ-NO
  5902        PERFORM 0326-GET-Z-RECORD THRU 0326-EXIT
  5903     ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 104
* EL6318.cbl
  5904        MOVE ER-1236          TO EMI-ERROR
  5905        MOVE -1               TO LTRIDL
  5906        MOVE AL-UABON         TO LTRIDA
  5907        PERFORM 9900-ERROR-FORMAT
  5908                                 THRU 9900-EXIT
  5909     END-IF
  5910
  5911     IF W-SIG-FLAG-DEFAULT > ' '
  5912        IF (SIGREQL > ZERO AND SIGREQI <> W-SIG-FLAG-DEFAULT)
  5913             MOVE W-SIG-FLAG-DEFAULT TO SIGREQI
  5914             MOVE +1 TO SIGREQL
  5915             MOVE ER-1664     TO EMI-ERROR
  5916             MOVE AL-UABON    TO SIGREQA
  5917             PERFORM 9900-ERROR-FORMAT
  5918                                 THRU 9900-EXIT
  5919        ELSE
  5920             MOVE W-SIG-FLAG-DEFAULT TO SIGREQI
  5921             MOVE +1 TO SIGREQL
  5922             MOVE AL-UANON    TO SIGREQA
  5923        END-IF
  5924     END-IF
  5925
  5926     IF (SIGREQL > ZEROS)
  5927        AND (SIGREQI = 'Y' OR 'N' OR ' ')
  5928        MOVE AL-UANON         TO SIGREQA
  5929        IF SIGREQI = ' '
  5930           MOVE 'N'           TO SIGREQI
  5931        END-IF
  5932        MOVE SIGREQI          TO PI-SIGREQ-ENTERED
  5933     ELSE
  5934        MOVE ER-2651          TO EMI-ERROR
  5935        MOVE -1               TO SIGREQL
  5936        MOVE AL-UABON         TO SIGREQA
  5937        PERFORM 9900-ERROR-FORMAT
  5938                                 THRU 9900-EXIT
  5939     END-IF
  5940
  5941     IF W-PROMPT-LETTER EQUAL 'Y'
  5942         MOVE ER-0894            TO EMI-ERROR
  5943         MOVE -1                 TO LTRIDL
  5944         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5945     END-IF
  5946     IF VOUCHL > ZEROS
  5947        IF VOUCHI = 'Y' OR 'N'
  5948           MOVE AL-UANON         TO VOUCHA
  5949           MOVE VOUCHI           TO PI-VOUCHER-ENTERED
  5950        ELSE
  5951           MOVE ER-9999          TO EMI-ERROR
  5952           MOVE -1               TO VOUCHL
  5953           MOVE AL-UABON         TO VOUCHA
  5954           PERFORM 9900-ERROR-FORMAT
  5955                                 THRU 9900-EXIT
  5956        END-IF
  5957     END-IF
  5958     IF HLTHAPPL > ZEROS
  5959        IF HLTHAPPI = 'Y' OR 'N'
  5960           MOVE AL-UANON         TO HLTHAPPA
  5961           MOVE HLTHAPPI         TO PI-HLTHAPP-ENTERED
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 105
* EL6318.cbl
  5962        ELSE
  5963           MOVE ER-9999          TO EMI-ERROR
  5964           MOVE -1               TO HLTHAPPL
  5965           MOVE AL-UABON         TO HLTHAPPA
  5966           PERFORM 9900-ERROR-FORMAT
  5967                                 THRU 9900-EXIT
  5968        END-IF
  5969     END-IF
  5970     IF PAYEEL > ZEROS
  5971        IF PAYEEI > SPACES
  5972           MOVE AL-UANON         TO PAYEEA
  5973           MOVE PAYEEI           TO PI-PAYEE-ENTERED
  5974        ELSE
  5975           MOVE ER-9999          TO EMI-ERROR
  5976           MOVE -1               TO PAYEEL
  5977           MOVE AL-UABON         TO PAYEEA
  5978           PERFORM 9900-ERROR-FORMAT
  5979                                 THRU 9900-EXIT
  5980        END-IF
  5981     END-IF
  5982     IF CERTIDL > ZEROS
  5983         IF CERTIDI NUMERIC
  5984            MOVE AL-UANON      TO CERTIDA
  5985            MOVE CERTIDI       TO PI-CERTID-ENTERED
  5986         ELSE
  5987            MOVE ER-1778       TO EMI-ERROR
  5988            MOVE -1            TO CERTIDL
  5989            MOVE AL-UABON      TO CERTIDA
  5990            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5991        END-IF
  5992     ELSE
  5993        IF PI-PRINT-CERTIFICATE = 'Y'
  5994            MOVE ER-0715       TO EMI-ERROR
  5995            MOVE -1            TO CERTIDL
  5996            MOVE AL-UABON      TO CERTIDA
  5997            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5998        END-IF
  5999     END-IF
  6000
  6001     IF ENCCODEL > ZEROS
  6002        MOVE FUNCTION UPPER-CASE(ENCCODEI) TO ENCCODEI
  6003                                              PI-ENCCODE
  6004        MOVE SPACES             TO WS-ELENCC-KEY
  6005        MOVE PI-COMPANY-CD      TO WS-ENCC-COMPANY-CD
  6006        MOVE '2'                TO WS-ENCC-REC-TYPE
  6007        MOVE ENCCODEI           TO WS-ENCC-ENC-CODE
  6008
  6009
  6010* EXEC CICS READ
  6011*           DATASET    (WS-ELENCC-FILE-ID)
  6012*           SET        (ADDRESS OF ENCLOSURE-CODES)
  6013*           RIDFLD     (WS-ELENCC-KEY)
  6014*           RESP       (WS-RESPONSE)
  6015*       END-EXEC
  6016*    MOVE '&"S        E          (  N#00005989' TO DFHEIV0
  6017     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6018     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6019     MOVE X'204E233030303035393839' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 106
* EL6318.cbl
  6020     CALL 'kxdfhei1' USING DFHEIV0,
  6021           WS-ELENCC-FILE-ID,
  6022           DFHEIV20,
  6023           DFHEIV99,
  6024           WS-ELENCC-KEY,
  6025           DFHEIV99,
  6026           DFHEIV99,
  6027           DFHEIV99
  6028     SET ADDRESS OF ENCLOSURE-CODES TO
  6029         DFHEIV20
  6030     MOVE EIBRESP  TO WS-RESPONSE
  6031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6032
  6033        IF RESP-NORMAL
  6034           MOVE ENCCODEI         TO PI-ENCCODE
  6035                                    W-ENCLOSURE-CD
  6036           MOVE AL-UANON         TO ENCCODEA
  6037        ELSE
  6038           MOVE ER-1560          TO EMI-ERROR
  6039           MOVE -1               TO ENCCODEL
  6040           MOVE AL-UABON         TO ENCCODEA
  6041           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6042        END-IF
  6043     END-IF
  6044
  6045     SET REASONS-NOT-FOUND TO TRUE
  6046     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6047        IF REACDL (S1) = +4 OR
  6048          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  6049              MOVE AL-SANON     TO REACDA (S1)
  6050              SET REASONS-FOUND TO TRUE
  6051        END-IF
  6052     END-PERFORM
  6053
  6054     IF REASONS-NOT-FOUND
  6055        MOVE ER-1820             TO EMI-ERROR
  6056        MOVE -1                  TO PFENTRL
  6057        PERFORM 9900-ERROR-FORMAT
  6058                                 THRU 9900-EXIT
  6059     ELSE
  6060        MOVE REASONCDS           TO PI-REASONS-ENTERED
  6061     END-IF
  6062
  6063     IF CRTNT1L > ZEROS
  6064        IF CRTNT1I > SPACES
  6065           MOVE CRTNT1I          TO PI-CERTNT1-ENTERED
  6066        END-IF
  6067     END-IF
  6068
  6069     IF CRTNT2L > ZEROS
  6070        IF CRTNT2I > SPACES
  6071           MOVE CRTNT2I          TO PI-CERTNT2-ENTERED
  6072        END-IF
  6073     END-IF
  6074
  6075     IF CRTNT3L > ZEROS
  6076        IF CRTNT3I > SPACES
  6077           MOVE CRTNT3I          TO PI-CERTNT3-ENTERED
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 107
* EL6318.cbl
  6078        END-IF
  6079     END-IF
  6080
  6081     IF CRTNT4L > ZEROS
  6082        IF CRTNT4I > SPACES
  6083           MOVE CRTNT4I          TO PI-CERTNT4-ENTERED
  6084        END-IF
  6085     END-IF
  6086
  6087     IF BILNT1L > ZEROS
  6088        IF BILNT1I > SPACES
  6089           MOVE BILNT1I          TO PI-BILLNT1-ENTERED
  6090        END-IF
  6091     END-IF
  6092
  6093     IF BILNT2L > ZEROS
  6094        IF BILNT2I > SPACES
  6095           MOVE BILNT2I          TO PI-BILLNT2-ENTERED
  6096        END-IF
  6097     END-IF
  6098
  6099     .
  6100 0325-EXIT.
  6101     EXIT.
  6102
  6103 0326-GET-Z-RECORD.
  6104
  6105     MOVE SPACES  TO W-Z-CONTROL-DATA
  6106
  6107
  6108* EXEC CICS STARTBR
  6109*         DATASET    ('ELLETR')
  6110*         RIDFLD     (ELLETR-KEY)
  6111*         GTEQ
  6112*         RESP      (WS-RESPONSE)
  6113*    END-EXEC.
  6114     MOVE 'ELLETR' TO DFHEIV1
  6115     MOVE 0
  6116       TO DFHEIV11
  6117*    MOVE '&,         G          &  N#00006070' TO DFHEIV0
  6118     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6119     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6120     MOVE X'204E233030303036303730' TO DFHEIV0(25:11)
  6121     CALL 'kxdfhei1' USING DFHEIV0,
  6122           DFHEIV1,
  6123           ELLETR-KEY,
  6124           DFHEIV99,
  6125           DFHEIV11,
  6126           DFHEIV99
  6127     MOVE EIBRESP  TO WS-RESPONSE
  6128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6129
  6130     IF NOT RESP-NORMAL
  6131         MOVE ER-1236          TO EMI-ERROR
  6132         MOVE -1               TO LTRIDL
  6133         MOVE AL-UABON         TO LTRIDA
  6134         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6135         GO TO 0326-ENDBR
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 108
* EL6318.cbl
  6136     END-IF.
  6137
  6138 0326-READNEXT.
  6139
  6140
  6141* EXEC CICS READNEXT
  6142*        DATASET   ('ELLETR')
  6143*        INTO      (TEXT-FILES)
  6144*        RIDFLD    (ELLETR-KEY)
  6145*        RESP      (WS-RESPONSE)
  6146*    END-EXEC
  6147     MOVE LENGTH OF
  6148      TEXT-FILES
  6149       TO DFHEIV12
  6150     MOVE 'ELLETR' TO DFHEIV1
  6151     MOVE 0
  6152       TO DFHEIV11
  6153*    MOVE '&.IL                  )  N#00006086' TO DFHEIV0
  6154     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6155     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6156     MOVE X'204E233030303036303836' TO DFHEIV0(25:11)
  6157     CALL 'kxdfhei1' USING DFHEIV0,
  6158           DFHEIV1,
  6159           TEXT-FILES,
  6160           DFHEIV12,
  6161           ELLETR-KEY,
  6162           DFHEIV99,
  6163           DFHEIV11,
  6164           DFHEIV99,
  6165           DFHEIV99
  6166     MOVE EIBRESP  TO WS-RESPONSE
  6167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6168     IF RESP-NORMAL
  6169        IF TX-CONTROL-PRIMARY(1:5) NOT = ELLETR-SAVE-PART-KEY
  6170           MOVE ER-1236          TO EMI-ERROR
  6171           MOVE -1               TO LTRIDL
  6172           MOVE AL-UABON         TO LTRIDA
  6173           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6174           GO TO 0326-ENDBR
  6175        END-IF
  6176
  6177        MOVE AL-UANON         TO LTRIDA
  6178        IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  6179           MOVE TX-TEXT-LINE  TO W-Z-CONTROL-DATA
  6180        ELSE
  6181           GO TO 0326-READNEXT
  6182        END-IF
  6183     ELSE
  6184        MOVE ER-1236          TO EMI-ERROR
  6185        MOVE -1               TO LTRIDL
  6186        MOVE AL-UABON         TO LTRIDA
  6187        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6188        GO TO 0326-ENDBR
  6189     END-IF.
  6190
  6191     MOVE W-PRINT-CERTIFICATE TO PI-PRINT-CERTIFICATE.
  6192     IF PI-ENCCODE NOT GREATER THAN SPACES
  6193         MOVE W-ENCLOSURE-CD            TO PI-ENCCODE
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 109
* EL6318.cbl
  6194                                           ENCCODEO
  6195         MOVE AL-UANON                  TO ENCCODEA
  6196         MOVE +3                        TO ENCCODEL
  6197     END-IF.
  6198
  6199 0326-ENDBR.
  6200
  6201
  6202* EXEC CICS ENDBR
  6203*        DATASET     ('ELLETR')
  6204*    END-EXEC.
  6205     MOVE 'ELLETR' TO DFHEIV1
  6206     MOVE 0
  6207       TO DFHEIV11
  6208*    MOVE '&2                    $   #00006125' TO DFHEIV0
  6209     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6210     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6211     MOVE X'2020233030303036313235' TO DFHEIV0(25:11)
  6212     CALL 'kxdfhei1' USING DFHEIV0,
  6213           DFHEIV1,
  6214           DFHEIV11,
  6215           DFHEIV99
  6216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6217
  6218
  6219 0326-EXIT.
  6220      EXIT.
  6221 0330-CHECK-ERRORS.
  6222     IF EMI-NO-ERRORS
  6223        GO TO 0350-BUILD-INIT-MAP
  6224     ELSE
  6225        GO TO 8200-SEND-DATAONLY
  6226     END-IF
  6227     .
  6228 0330-EXIT.
  6229     EXIT.
  6230 0350-BUILD-INIT-MAP.
  6231     IF PI-RETURN-TO-PROGRAM = 'EL6314'
  6232        display 'coming from ' PI-RETURN-TO-PROGRAM
  6233        MOVE PI-COMPANY-CD          TO CRTO-COMPANY-CD
  6234        MOVE PI-CARRIER             TO CRTO-CARRIER
  6235        MOVE PI-GROUPING            TO CRTO-GROUPING
  6236        MOVE PI-STATE               TO CRTO-STATE
  6237        MOVE PI-ACCOUNT             TO CRTO-ACCOUNT
  6238        MOVE PI-CERT-PRIME          TO CRTO-CERT-PRIME
  6239        MOVE PI-CERT-SFX            TO CRTO-CERT-SFX
  6240        MOVE PI-CERT-EFF-DT         TO CRTO-CERT-EFF-DT
  6241        MOVE 'I'                    TO CRTO-RECORD-TYPE
  6242        MOVE ZEROS                  TO CRTO-SEQ-NO
  6243        MOVE ELCRTO-KEY             TO PI-ELCRTO-KEY
  6244                                       PI-ERENDT-KEY
  6245     END-IF
  6246     MOVE PI-CRTO-CARRIER        TO CARRO
  6247     MOVE PI-CRTO-GROUPING       TO GROUPO
  6248     MOVE PI-CRTO-STATE          TO STATEO
  6249     MOVE PI-CRTO-ACCOUNT        TO ACCTO
  6250     MOVE PI-CRTO-CERT-PRIME     TO CERTNOO
  6251     MOVE PI-CRTO-CERT-SFX       TO CRTSFXO
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 110
* EL6318.cbl
  6252     MOVE PI-CRTO-SEQ-NO         TO SEQNOO
  6253     MOVE PI-CRTO-CERT-EFF-DT    TO DC-BIN-DATE-1
  6254     MOVE ' '                    TO DC-OPTION-CODE
  6255     PERFORM 9700-DATE-LINK
  6256     IF NO-CONVERSION-ERROR
  6257        MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
  6258     END-IF
  6259*     IF PI-PRTSW-ENTERED > SPACES
  6260*        MOVE PI-PRTSW-ENTERED    TO PRTSWI
  6261*        MOVE AL-UANON            TO PRTSWA
  6262*        MOVE +1                  TO PRTSWL
  6263*     END-IF
  6264
  6265     IF PI-SIGREQ-ENTERED > SPACES
  6266        MOVE PI-SIGREQ-ENTERED   TO SIGREQI
  6267        MOVE AL-UANON            TO SIGREQA
  6268        MOVE +1                  TO SIGREQL
  6269     ELSE
  6270        IF PI-CLAIM-REFORMATION
  6271            MOVE 'Y'             TO SIGREQI
  6272            MOVE AL-UANON        TO SIGREQA
  6273            MOVE +1              TO SIGREQL
  6274        END-IF
  6275     END-IF
  6276
  6277     IF PI-LTRID-ENTERED > SPACES
  6278        MOVE PI-LTRID-ENTERED    TO LTRIDI
  6279        MOVE AL-UANON            TO LTRIDA
  6280        MOVE +4                  TO LTRIDL
  6281     ELSE
  6282        IF PI-CLAIM-REFORMATION
  6283            MOVE 'CLRF'          TO LTRIDI
  6284            MOVE AL-UANON        TO LTRIDA
  6285            MOVE +4              TO LTRIDL
  6286        END-IF
  6287     END-IF
  6288
  6289     IF PI-VOUCHER-ENTERED > SPACES
  6290        MOVE PI-VOUCHER-ENTERED  TO VOUCHI
  6291        MOVE AL-UANON            TO VOUCHA
  6292        MOVE +1                  TO VOUCHL
  6293     END-IF
  6294
  6295     IF PI-HLTHAPP-ENTERED > SPACES
  6296        MOVE PI-HLTHAPP-ENTERED  TO HLTHAPPI
  6297        MOVE AL-UANON            TO HLTHAPPA
  6298        MOVE +1                  TO HLTHAPPL
  6299     END-IF
  6300
  6301     IF PI-PAYEE-ENTERED > SPACES
  6302        MOVE PI-PAYEE-ENTERED    TO PAYEEI
  6303        MOVE AL-UANON            TO PAYEEA
  6304        MOVE +10                 TO PAYEEL
  6305     END-IF
  6306
  6307     IF PI-CERTID-ENTERED > SPACES
  6308        MOVE PI-CERTID-ENTERED   TO CERTIDI
  6309        MOVE AL-UANON            TO CERTIDA
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 111
* EL6318.cbl
  6310        MOVE +5                  TO CERTIDL
  6311     END-IF
  6312
  6313     IF PI-ENCCODE > SPACES
  6314        MOVE PI-ENCCODE          TO ENCCODEI
  6315        MOVE AL-UANON            TO ENCCODEA
  6316        MOVE +3                  TO ENCCODEL
  6317     END-IF
  6318
  6319     SET REASONS-NOT-FOUND TO TRUE
  6320     MOVE PI-REASONS-ENTERED     TO REASONCDS
  6321     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6322        IF REACDL (S1) = +4 OR
  6323          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  6324              MOVE AL-SANON      TO REACDA (S1)
  6325              MOVE +4            TO REACDL (S1)
  6326              SET REASONS-FOUND  TO TRUE
  6327        END-IF
  6328     END-PERFORM
  6329
  6330     IF REASONS-NOT-FOUND
  6331         IF PI-CLAIM-REFORMATION
  6332            MOVE 'CRNA'          TO REACD-IN (1)
  6333            MOVE AL-SANON        TO REACDA (1)
  6334            MOVE +4              TO REACDL (1)
  6335            SET REASONS-FOUND    TO TRUE
  6336        END-IF
  6337     END-IF
  6338
  6339     IF PI-CERTNT1-ENTERED > SPACES
  6340        MOVE PI-CERTNT1-ENTERED  TO CRTNT1I
  6341        MOVE AL-UANON            TO CRTNT1A
  6342        MOVE +63                 TO CRTNT1L
  6343     END-IF
  6344
  6345     IF PI-CERTNT2-ENTERED > SPACES
  6346        MOVE PI-CERTNT2-ENTERED  TO CRTNT2I
  6347        MOVE AL-UANON            TO CRTNT2A
  6348        MOVE +63                 TO CRTNT2L
  6349     END-IF
  6350
  6351     IF PI-CERTNT3-ENTERED > SPACES
  6352        MOVE PI-CERTNT3-ENTERED  TO CRTNT3I
  6353        MOVE AL-UANON            TO CRTNT3A
  6354        MOVE +63                 TO CRTNT3L
  6355     END-IF
  6356
  6357     IF PI-CERTNT4-ENTERED > SPACES
  6358        MOVE PI-CERTNT4-ENTERED  TO CRTNT4I
  6359        MOVE AL-UANON            TO CRTNT4A
  6360        MOVE +63                 TO CRTNT4L
  6361     END-IF
  6362
  6363     IF PI-BILLNT1-ENTERED > SPACES
  6364        MOVE PI-BILLNT1-ENTERED  TO BILNT1I
  6365        MOVE AL-UANON            TO BILNT1A
  6366        MOVE +63                 TO BILNT1L
  6367     END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 112
* EL6318.cbl
  6368
  6369     IF PI-BILLNT2-ENTERED > SPACES
  6370        MOVE PI-BILLNT2-ENTERED  TO BILNT2I
  6371        MOVE AL-UANON            TO BILNT2A
  6372        MOVE +63                 TO BILNT2L
  6373     END-IF
  6374
  6375     GO TO 8100-SEND-INITIAL-MAP
  6376     .
  6377 0360-FINALIZE.
  6378     display ' made it to 0360 ' pi-elcrto-key
  6379     set P to address of KIXSYS
  6380     CALL "getenv" using by value P returning var-ptr
  6381     if var-ptr = null then
  6382        display ' kixsys not set '
  6383     else
  6384        set address of var to var-ptr
  6385        move 0 to env-var-len
  6386        inspect var tallying env-var-len
  6387          for characters before X'00'
  6388*       DISPLAY '  KIXSYS = ' var (1:env-var-len)
  6389        unstring var (1:env-var-len) delimited by '/'
  6390           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  6391              WS-KIX-SYS
  6392        end-unstring
  6393*       DISPLAY ' WS KIX SYS ' WS-KIXSYS
  6394*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  6395     end-if
  6396     set P to address of KIXHOST
  6397     CALL "getenv" using by value P returning var-ptr
  6398     if var-ptr = null then
  6399        display ' kixhost not set '
  6400     else
  6401        set address of var to var-ptr
  6402        move 0 to env-var-len
  6403        inspect var tallying env-var-len
  6404          for characters before X'00'
  6405*       DISPLAY '  KIXHOST = ' var (1:env-var-len)
  6406        MOVE var(1:env-var-len)  to ws-kixhost
  6407        DISPLAY ' WS KIX HOST ' WS-KIXhost
  6408     end-if
  6409     PERFORM 0325-EDIT-SCREEN    THRU 0325-EXIT
  6410     IF NOT EMI-NO-ERRORS
  6411       AND EIBAID = DFHPF4
  6412        GO TO 8200-SEND-DATAONLY
  6413     END-IF
  6414     MOVE LOW-VALUES             TO NEW-ELCRTO-REC
  6415     MOVE PI-ELCRTO-KEY          TO ELCRTO-KEY
  6416                                    NEW-ELCRTO-KEY
  6417     SUBTRACT +1               FROM NCRTO-SEQ-NO
  6418     PERFORM 0362-READ-ELCRTO    THRU 0362-EXIT
  6419     display 'read elcrto resp = ' ws-response
  6420     IF RESP-NORMAL
  6421       AND (PI-ELCRTO-KEY (1:33) = OC-CONTROL-PRIMARY (1:33))
  6422        DISPLAY ' RESP NORMAL AND = '
  6423        MOVE OC-KEY-SEQ-NO       TO CRTO-SEQ-NO
  6424                                    PI-CRTO-SEQ-NO
  6425        MOVE LOW-VALUES          TO NEW-ELCRTO-REC
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 113
* EL6318.cbl
  6426        MOVE PI-ELCRTO-KEY       TO NEW-ELCRTO-KEY
  6427        SUBTRACT +1              FROM NCRTO-SEQ-NO
  6428        PERFORM 0400-ADD-ERENDT  THRU 0400-EXIT
  6429*       PERFORM 1000-BUILD-ERARCH THRU 1000-EXIT
  6430        PERFORM 1100-CALL-NS-BUS-LOGIC
  6431                                 THRU 1100-EXIT
  6432        IF BL-OK
  6433           CONTINUE
  6434        ELSE
  6435           MOVE ER-8888          TO EMI-ERROR-NUMBER (1)
  6436           MOVE BL-MESSAGE       TO EMI-ERROR-TEXT (1)
  6437           MOVE -1               TO SIGREQL
  6438        END-IF
  6439     ELSE
  6440        MOVE ER-9999             TO EMI-ERROR
  6441        PERFORM 9900-ERROR-FORMAT
  6442                                 THRU 9900-EXIT
  6443        MOVE -1                  TO SIGREQL
  6444        GO TO 8100-SEND-INITIAL-MAP
  6445     END-IF
  6446     MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
  6447                                 TO SYSO
  6448     MOVE WS-KIXHOST             TO HOSTO
  6449     MOVE PI-COMPANY-ID          TO COMPANYO
  6450     IF PI-RETURN-TO-PROGRAM = 'EL6314'
  6451         MOVE '2'                TO DATASORO
  6452     ELSE
  6453         MOVE '4'                TO DATASORO
  6454     END-IF
  6455     MOVE BL-BATCH-NO            TO BATCHNOO
  6456     MOVE BL-BATCH-SEQ           TO BSEQNOO
  6457     MOVE BL-ARCHIVE-NO          TO ARCHNOO
  6458     MOVE PI-PROCESSOR-ID        TO PROCIDO
  6459*    MOVE 'N'                    TO PRTSWO
  6460*    MOVE -1                     TO PRTSWL
  6461*    MOVE AL-UANON               TO PRTSWA
  6462     MOVE -1                     TO SIGREQL
  6463     MOVE AL-UANON               TO SIGREQA
  6464     IF EIBAID = DFHPF4
  6465        MOVE SPACES              TO PI-CLEAR-ERROR-SW
  6466        MOVE ER-0280             TO EMI-ERROR
  6467        PERFORM 9900-ERROR-FORMAT
  6468                                 THRU 9900-EXIT
  6469        MOVE BL-ARCHIVE-NO       TO W-ARCH-SUPPRESS
  6470        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  6471        MOVE 'Y'                 TO PI-FINALIZED-IND
  6472        GO TO 9400-CLEAR
  6473     ELSE
  6474        MOVE ER-1818             TO EMI-ERROR
  6475        PERFORM 9900-ERROR-FORMAT
  6476                                 THRU 9900-EXIT
  6477     END-IF
  6478     GO TO 0350-BUILD-INIT-MAP
  6479     .
  6480 0360-EXIT.
  6481     EXIT.
  6482 0362-READ-ELCRTO.
  6483     display ' made it to 0362 '
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 114
* EL6318.cbl
  6484
  6485* EXEC CICS READ
  6486*        DATASET   (WS-ELCRTO-FILE-ID)
  6487*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  6488*        RIDFLD    (ELCRTO-KEY)
  6489*        GTEQ
  6490*        RESP      (WS-RESPONSE)
  6491*    END-EXEC
  6492*    MOVE '&"S        G          (  N#00006394' TO DFHEIV0
  6493     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  6494     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6495     MOVE X'204E233030303036333934' TO DFHEIV0(25:11)
  6496     CALL 'kxdfhei1' USING DFHEIV0,
  6497           WS-ELCRTO-FILE-ID,
  6498           DFHEIV20,
  6499           DFHEIV99,
  6500           ELCRTO-KEY,
  6501           DFHEIV99,
  6502           DFHEIV99,
  6503           DFHEIV99
  6504     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  6505         DFHEIV20
  6506     MOVE EIBRESP  TO WS-RESPONSE
  6507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6508     .
  6509 0362-EXIT.
  6510     EXIT.
  6511 0363-READ-ELCRTO-UPD.
  6512     display ' made it to 0363 '
  6513
  6514* EXEC CICS READ
  6515*        DATASET   (WS-ELCRTO-FILE-ID)
  6516*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  6517*        RIDFLD    (ELCRTO-KEY)
  6518*        UPDATE
  6519*        RESP      (WS-RESPONSE)
  6520*    END-EXEC
  6521*    MOVE '&"S        EU         (  N#00006406' TO DFHEIV0
  6522     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6523     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6524     MOVE X'204E233030303036343036' TO DFHEIV0(25:11)
  6525     CALL 'kxdfhei1' USING DFHEIV0,
  6526           WS-ELCRTO-FILE-ID,
  6527           DFHEIV20,
  6528           DFHEIV99,
  6529           ELCRTO-KEY,
  6530           DFHEIV99,
  6531           DFHEIV99,
  6532           DFHEIV99
  6533     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  6534         DFHEIV20
  6535     MOVE EIBRESP  TO WS-RESPONSE
  6536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6537     .
  6538 0363-EXIT.
  6539     EXIT.
  6540 0365-READ-ERENDT.
  6541
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 115
* EL6318.cbl
  6542* EXEC CICS READ
  6543*        DATASET   (WS-ERENDT-FILE-ID)
  6544*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
  6545*        RIDFLD    (ERENDT-KEY)
  6546*        RESP      (WS-RESPONSE)
  6547*    END-EXEC
  6548*    MOVE '&"S        E          (  N#00006417' TO DFHEIV0
  6549     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6550     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6551     MOVE X'204E233030303036343137' TO DFHEIV0(25:11)
  6552     CALL 'kxdfhei1' USING DFHEIV0,
  6553           WS-ERENDT-FILE-ID,
  6554           DFHEIV20,
  6555           DFHEIV99,
  6556           ERENDT-KEY,
  6557           DFHEIV99,
  6558           DFHEIV99,
  6559           DFHEIV99
  6560     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6561         DFHEIV20
  6562     MOVE EIBRESP  TO WS-RESPONSE
  6563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6564     .
  6565 0365-EXIT.
  6566     EXIT.
  6567 0400-ADD-ERENDT.
  6568     PERFORM 1500-GET-ARCH-NO    THRU 1500-EXIT
  6569     display ' made it to 0400 '
  6570
  6571* EXEC CICS GETMAIN
  6572*         SET      (ADDRESS OF ENDORSEMENT-RECORD)
  6573*         LENGTH   (ERENDT-LENGTH)
  6574*         INITIMG  (GETMAIN-SPACE)
  6575*    END-EXEC
  6576*    MOVE ',"IL                  $   #00006429' TO DFHEIV0
  6577     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6578     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6579     MOVE X'2020233030303036343239' TO DFHEIV0(25:11)
  6580     CALL 'kxdfhei1' USING DFHEIV0,
  6581           DFHEIV20,
  6582           ERENDT-LENGTH,
  6583           GETMAIN-SPACE
  6584     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6585         DFHEIV20
  6586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6587     PERFORM 0410-INIT-ERENDT    THRU 0410-EXIT
  6588     MOVE PI-PROCESSOR-ID        TO EN-LAST-MAINT-BY
  6589     MOVE EIBTIME                TO EN-LAST-MAINT-HHMMSS
  6590     MOVE WS-CURRENT-BIN-DT      TO EN-LAST-MAINT-DT
  6591                                    EN-INPUT-DT
  6592                                    EN-PROCESS-DT
  6593
  6594     MOVE OC-INS-FIRST-NAME    TO EN-INS-ORIG-FIRST-NAME
  6595     MOVE OC-INS-MIDDLE-INIT   TO EN-INS-ORIG-MIDDLE-INIT
  6596     MOVE OC-INS-LAST-NAME     TO EN-INS-ORIG-LAST-NAME
  6597     MOVE OC-INS-AGE           TO EN-INS-ORIG-AGE
  6598     MOVE OC-INS-AGE-DEFAULT-FLAG TO EN-INS-ORIG-AGE-DEF-FLAG
  6599     MOVE OC-JNT-FIRST-NAME    TO EN-JNT-ORIG-FIRST-NAME
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 116
* EL6318.cbl
  6600     MOVE OC-JNT-MIDDLE-INIT   TO EN-JNT-ORIG-MIDDLE-INIT
  6601     MOVE OC-JNT-LAST-NAME     TO EN-JNT-ORIG-LAST-NAME
  6602     MOVE OC-JNT-AGE           TO EN-JNT-ORIG-AGE
  6603     MOVE OC-JNT-AGE-DEFAULT-FLAG TO EN-JNT-ORIG-AGE-DEF-FLAG
  6604     MOVE OC-LF-BENCD          TO EN-LF-ORIG-BENCD
  6605     IF OC-LF-BENCD NOT = '00' AND '  '
  6606        MOVE OC-LF-BEN-AMT       TO EN-LF-ORIG-BEN-AMT
  6607        MOVE OC-LF-PRM-AMT       TO EN-LF-ORIG-PRM-AMT
  6608        MOVE OC-LF-ALT-BEN-AMT   TO EN-LF-ORIG-ALT-BEN-AMT
  6609        MOVE OC-LF-ALT-PRM-AMT   TO EN-LF-ORIG-ALT-PRM-AMT
  6610        MOVE OC-LF-TERM          TO EN-LF-ORIG-TERM
  6611        MOVE OC-LF-EXP-DT        TO EN-LF-ORIG-EXP-DT
  6612        MOVE OC-LF-COMM-PCT      TO EN-LF-ORIG-COMM-PCT
  6613     END-IF
  6614     MOVE OC-AH-BENCD          TO EN-AH-ORIG-BENCD
  6615     IF OC-AH-BENCD NOT = '00' AND '  '
  6616        MOVE OC-AH-BEN-AMT       TO EN-AH-ORIG-BEN-AMT
  6617        MOVE OC-AH-PRM-AMT       TO EN-AH-ORIG-PRM-AMT
  6618        MOVE OC-AH-TERM          TO EN-AH-ORIG-TERM
  6619        MOVE OC-AH-EXP-DT        TO EN-AH-ORIG-EXP-DT
  6620        MOVE OC-AH-CP            TO EN-AH-ORIG-CP
  6621        MOVE OC-AH-COMM-PCT      TO EN-AH-ORIG-COMM-PCT
  6622     END-IF
  6623     MOVE OC-CRED-BENE-NAME      TO EN-ORIG-CRED-BENE
  6624
  6625     IF PI-RETURN-TO-PROGRAM EQUAL 'EL6314'
  6626         DISPLAY 'USING CERT FOR NEW'
  6627
  6628         MOVE PI-COMPANY-CD       TO  W-CERT-COMPANY-CD
  6629         MOVE PI-CRTO-CARRIER     TO  W-CERT-CARRIER
  6630         MOVE PI-CRTO-GROUPING    TO  W-CERT-GROUPING
  6631         MOVE PI-CRTO-STATE       TO  W-CERT-STATE
  6632         MOVE PI-CRTO-ACCOUNT     TO  W-CERT-ACCOUNT
  6633         MOVE PI-CRTO-CERT-EFF-DT TO  W-CERT-CERT-EFF-DT
  6634         MOVE PI-CRTO-CERT-PRIME  TO  W-CERT-CERT-PRIME
  6635         MOVE PI-CRTO-CERT-SFX    TO  W-CERT-CERT-SFX
  6636
  6637
  6638* EXEC CICS READ
  6639*            DATASET  (WS-ELCERT-FILE-ID)
  6640*            RIDFLD   (WS-ELCERT-KEY)
  6641*            SET      (ADDRESS OF CERTIFICATE-MASTER)
  6642*            RESP     (WS-RESPONSE)
  6643*        END-EXEC
  6644*    MOVE '&"S        E          (  N#00006484' TO DFHEIV0
  6645     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6646     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6647     MOVE X'204E233030303036343834' TO DFHEIV0(25:11)
  6648     CALL 'kxdfhei1' USING DFHEIV0,
  6649           WS-ELCERT-FILE-ID,
  6650           DFHEIV20,
  6651           DFHEIV99,
  6652           WS-ELCERT-KEY,
  6653           DFHEIV99,
  6654           DFHEIV99,
  6655           DFHEIV99
  6656     SET ADDRESS OF CERTIFICATE-MASTER TO
  6657         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 117
* EL6318.cbl
  6658     MOVE EIBRESP  TO WS-RESPONSE
  6659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6660         IF NOT RESP-NORMAL
  6661            GO TO 0400-EXIT
  6662         END-IF
  6663
  6664         MOVE CM-INSURED-FIRST-NAME TO EN-INS-NEW-FIRST-NAME
  6665                                       NCRTO-INS-FIRST-NAME
  6666         MOVE CM-INSURED-INITIAL2   TO EN-INS-NEW-MIDDLE-INIT
  6667                                       NCRTO-INS-MIDDLE-INIT
  6668         MOVE CM-INSURED-LAST-NAME  TO EN-INS-NEW-LAST-NAME
  6669                                       NCRTO-INS-LAST-NAME
  6670         MOVE CM-INSURED-ISSUE-AGE  TO EN-INS-NEW-AGE
  6671                                       NCRTO-INS-AGE
  6672         MOVE CM-JT-FIRST-NAME      TO EN-JNT-NEW-FIRST-NAME
  6673                                       NCRTO-JNT-FIRST-NAME
  6674         MOVE CM-JT-INITIAL         TO EN-JNT-NEW-MIDDLE-INIT
  6675                                       NCRTO-JNT-MIDDLE-INIT
  6676         MOVE CM-JT-LAST-NAME       TO EN-JNT-NEW-LAST-NAME
  6677                                       NCRTO-JNT-LAST-NAME
  6678         MOVE CM-INSURED-JOINT-AGE  TO EN-JNT-NEW-AGE
  6679                                       NCRTO-JNT-AGE
  6680
  6681         MOVE CM-LF-BENEFIT-CD      TO EN-LF-NEW-BENCD
  6682                                       NCRTO-LF-BENCD
  6683         IF CM-LF-BENEFIT-CD NOT = '00' AND '  '
  6684            MOVE CM-LF-BENEFIT-AMT  TO EN-LF-NEW-BEN-AMT
  6685                                       NCRTO-LF-BEN-AMT
  6686            MOVE CM-LF-PREMIUM-AMT  TO EN-LF-NEW-PRM-AMT
  6687                                       NCRTO-LF-PRM-AMT
  6688            MOVE CM-LF-ALT-BENEFIT-AMT TO EN-LF-NEW-ALT-BEN-AMT
  6689                                       NCRTO-LF-ALT-BEN-AMT
  6690            MOVE CM-LF-ALT-PREMIUM-AMT TO EN-LF-NEW-ALT-PRM-AMT
  6691                                       NCRTO-LF-ALT-PRM-AMT
  6692            MOVE CM-LF-ORIG-TERM    TO EN-LF-NEW-TERM
  6693                                       NCRTO-LF-TERM
  6694            MOVE CM-LF-LOAN-EXPIRE-DT TO EN-LF-NEW-EXP-DT
  6695                                       NCRTO-LF-EXP-DT
  6696            MOVE CM-LIFE-COMM-PCT   TO EN-LF-NEW-COMM-PCT
  6697                                       NCRTO-LF-COMM-PCT
  6698         END-IF
  6699
  6700         MOVE CM-AH-BENEFIT-CD      TO EN-AH-NEW-BENCD
  6701                                       NCRTO-AH-BENCD
  6702         IF CM-AH-BENEFIT-CD NOT = '00' AND '  '
  6703            MOVE CM-AH-BENEFIT-AMT  TO EN-AH-NEW-BEN-AMT
  6704                                       NCRTO-AH-BEN-AMT
  6705            MOVE CM-AH-PREMIUM-AMT  TO EN-AH-NEW-PRM-AMT
  6706                                       NCRTO-AH-PRM-AMT
  6707            MOVE CM-AH-ORIG-TERM    TO EN-AH-NEW-TERM
  6708                                       NCRTO-AH-TERM
  6709            MOVE CM-AH-LOAN-EXPIRE-DT TO EN-AH-NEW-EXP-DT
  6710                                       NCRTO-AH-EXP-DT
  6711            MOVE CM-AH-CRITICAL-PERIOD TO EN-AH-NEW-CP
  6712                                       NCRTO-AH-CP
  6713            MOVE CM-AH-COMM-PCT     TO EN-AH-NEW-COMM-PCT
  6714                                       NCRTO-AH-COMM-PCT
  6715         END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 118
* EL6318.cbl
  6716
  6717         MOVE CM-LOAN-1ST-PMT-DT    TO NCRTO-1ST-PMT-DT
  6718         MOVE CM-ENTRY-BATCH        TO EN-BATCH-NUMBER
  6719
  6720         GO TO 0400-CONTINUE
  6721     END-IF.
  6722
  6723
  6724* EXEC CICS GETMAIN
  6725*         SET      (ADDRESS OF PENDING-BUSINESS)
  6726*         LENGTH   (ERPNDB-LENGTH)
  6727*         INITIMG  (GETMAIN-SPACE)
  6728*    END-EXEC
  6729*    MOVE ',"IL                  $   #00006553' TO DFHEIV0
  6730     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6731     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6732     MOVE X'2020233030303036353533' TO DFHEIV0(25:11)
  6733     CALL 'kxdfhei1' USING DFHEIV0,
  6734           DFHEIV20,
  6735           ERPNDB-LENGTH,
  6736           GETMAIN-SPACE
  6737     SET ADDRESS OF PENDING-BUSINESS TO
  6738         DFHEIV20
  6739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6740     DISPLAY ' JUST DID GETMAIN ON ERPNDB '
  6741     MOVE PI-ERPNDB-KEY          TO ERPNDB-KEY
  6742
  6743* EXEC CICS READ
  6744*        DATASET   (WS-ERPNDB-FILE-ID)
  6745*        INTO      (PENDING-BUSINESS)
  6746*        RIDFLD    (ERPNDB-KEY)
  6747*        RESP      (WS-RESPONSE)
  6748*    END-EXEC
  6749     MOVE LENGTH OF
  6750      PENDING-BUSINESS
  6751       TO DFHEIV11
  6752*    MOVE '&"IL       E          (  N#00006560' TO DFHEIV0
  6753     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6754     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6755     MOVE X'204E233030303036353630' TO DFHEIV0(25:11)
  6756     CALL 'kxdfhei1' USING DFHEIV0,
  6757           WS-ERPNDB-FILE-ID,
  6758           PENDING-BUSINESS,
  6759           DFHEIV11,
  6760           ERPNDB-KEY,
  6761           DFHEIV99,
  6762           DFHEIV99,
  6763           DFHEIV99
  6764     MOVE EIBRESP  TO WS-RESPONSE
  6765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6766     IF NOT RESP-NORMAL
  6767        GO TO 0400-EXIT
  6768     END-IF
  6769*    set found-pndb to true
  6770     display ' good read on erpndb '
  6771     MOVE PB-I-INSURED-FIRST-NAME  TO EN-INS-NEW-FIRST-NAME
  6772                                      NCRTO-INS-FIRST-NAME
  6773     MOVE PB-I-INSURED-MIDDLE-INIT TO EN-INS-NEW-MIDDLE-INIT
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 119
* EL6318.cbl
  6774                                      NCRTO-INS-MIDDLE-INIT
  6775     MOVE PB-I-INSURED-LAST-NAME   TO EN-INS-NEW-LAST-NAME
  6776                                      NCRTO-INS-LAST-NAME
  6777     MOVE PB-I-AGE                 TO EN-INS-NEW-AGE
  6778                                      NCRTO-INS-AGE
  6779     MOVE PB-I-JOINT-FIRST-NAME    TO EN-JNT-NEW-FIRST-NAME
  6780                                      NCRTO-JNT-FIRST-NAME
  6781     MOVE PB-I-JOINT-MIDDLE-INIT   TO EN-JNT-NEW-MIDDLE-INIT
  6782                                      NCRTO-JNT-MIDDLE-INIT
  6783     MOVE PB-I-JOINT-LAST-NAME     TO EN-JNT-NEW-LAST-NAME
  6784                                      NCRTO-JNT-LAST-NAME
  6785     MOVE PB-I-JOINT-AGE           TO EN-JNT-NEW-AGE
  6786                                      NCRTO-JNT-AGE
  6787     MOVE PB-I-LF-BENEFIT-CD       TO EN-LF-NEW-BENCD
  6788                                      NCRTO-LF-BENCD
  6789     IF PB-I-LF-BENEFIT-CD NOT = '00' AND '  '
  6790        MOVE PB-I-LF-BENEFIT-AMT   TO EN-LF-NEW-BEN-AMT
  6791                                      NCRTO-LF-BEN-AMT
  6792        MOVE PB-I-LF-PREMIUM-AMT   TO EN-LF-NEW-PRM-AMT
  6793                                      NCRTO-LF-PRM-AMT
  6794        MOVE PB-I-LF-ALT-BENEFIT-AMT TO EN-LF-NEW-ALT-BEN-AMT
  6795                                      NCRTO-LF-ALT-BEN-AMT
  6796        MOVE PB-I-LF-ALT-PREMIUM-AMT TO EN-LF-NEW-ALT-PRM-AMT
  6797                                      NCRTO-LF-ALT-PRM-AMT
  6798        MOVE PB-I-LF-TERM          TO EN-LF-NEW-TERM
  6799                                      NCRTO-LF-TERM
  6800        MOVE PB-I-LF-EXPIRE-DT     TO EN-LF-NEW-EXP-DT
  6801                                      NCRTO-LF-EXP-DT
  6802        IF PB-I-JOINT-COMMISSION > +0
  6803           MOVE PB-I-JOINT-COMMISSION
  6804                                   TO EN-LF-NEW-COMM-PCT
  6805                                      NCRTO-LF-COMM-PCT
  6806        ELSE
  6807           MOVE PB-I-LIFE-COMMISSION
  6808                                   TO EN-LF-NEW-COMM-PCT
  6809                                      NCRTO-LF-COMM-PCT
  6810        END-IF
  6811     END-IF
  6812     MOVE PB-I-AH-BENEFIT-CD       TO EN-AH-NEW-BENCD
  6813                                      NCRTO-AH-BENCD
  6814     IF PB-I-AH-BENEFIT-CD NOT = '00' AND '  '
  6815        MOVE PB-I-AH-BENEFIT-AMT   TO EN-AH-NEW-BEN-AMT
  6816                                      NCRTO-AH-BEN-AMT
  6817        MOVE PB-I-AH-PREMIUM-AMT   TO EN-AH-NEW-PRM-AMT
  6818                                      NCRTO-AH-PRM-AMT
  6819        MOVE PB-I-AH-TERM          TO EN-AH-NEW-TERM
  6820                                      NCRTO-AH-TERM
  6821        MOVE PB-I-AH-EXPIRE-DT     TO EN-AH-NEW-EXP-DT
  6822                                      NCRTO-AH-EXP-DT
  6823        MOVE PB-I-AH-CRIT-PER      TO EN-AH-NEW-CP
  6824                                      NCRTO-AH-CP
  6825        MOVE PB-I-AH-COMMISSION    TO EN-AH-NEW-COMM-PCT
  6826                                      NCRTO-AH-COMM-PCT
  6827     END-IF
  6828     MOVE PB-I-1ST-PMT-DT          TO NCRTO-1ST-PMT-DT
  6829     MOVE PB-ENTRY-BATCH           TO EN-BATCH-NUMBER
  6830     .
  6831 0400-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 120
* EL6318.cbl
  6832
  6833     MOVE W-ACCT-SUMM              TO EN-ACCT-SUMM
  6834     MOVE W-CSO-SUMM               TO EN-CSO-SUMM
  6835*     PERFORM 0450-GET-ERACCT     THRU 0450-EXIT
  6836     MOVE 'Y'                    TO EN-COMM-CHGBK
  6837
  6838     COMPUTE WS-DUE-BORROWER = (EN-LF-ORIG-PRM-AMT
  6839        + EN-LF-ORIG-ALT-PRM-AMT + EN-AH-ORIG-PRM-AMT) -
  6840        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT +
  6841        EN-AH-NEW-PRM-AMT)
  6842     COMPUTE EN-ACCT-PORTION ROUNDED =
  6843        (((EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT) -
  6844        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT))
  6845        * EN-LF-NEW-COMM-PCT)
  6846                       +
  6847        ((EN-AH-ORIG-PRM-AMT - EN-AH-NEW-PRM-AMT)
  6848        * EN-AH-NEW-COMM-PCT)
  6849     COMPUTE EN-CSO-PORTION = WS-DUE-BORROWER -
  6850        EN-ACCT-PORTION
  6851     IF PI-RETURN-TO-PROGRAM = 'EL6314'
  6852         MOVE CM-CONTROL-PRIMARY TO WS-ERMAIL-KEY
  6853     ELSE
  6854     move pb-control-by-account (1:33)
  6855                                 to ws-ermail-key
  6856     END-IF
  6857
  6858
  6859* EXEC CICS READ
  6860*        DATASET   ('ERMAIL')
  6861*        SET       (ADDRESS OF MAILING-DATA)
  6862*        RIDFLD    (WS-ERMAIL-KEY)
  6863*        RESP      (WS-RESPONSE)
  6864*    END-EXEC
  6865     MOVE 'ERMAIL' TO DFHEIV1
  6866*    MOVE '&"S        E          (  N#00006658' TO DFHEIV0
  6867     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6868     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6869     MOVE X'204E233030303036363538' TO DFHEIV0(25:11)
  6870     CALL 'kxdfhei1' USING DFHEIV0,
  6871           DFHEIV1,
  6872           DFHEIV20,
  6873           DFHEIV99,
  6874           WS-ERMAIL-KEY,
  6875           DFHEIV99,
  6876           DFHEIV99,
  6877           DFHEIV99
  6878     SET ADDRESS OF MAILING-DATA TO
  6879         DFHEIV20
  6880     MOVE EIBRESP  TO WS-RESPONSE
  6881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6882     IF RESP-NORMAL
  6883        DISPLAY ' FOUND ERMAIL '
  6884        MOVE MA-CRED-BENE-NAME   TO EN-NEW-CRED-BENE
  6885                                    NCRTO-CRED-BENE-NAME
  6886     ELSE
  6887        DISPLAY ' ERMAIL READ ' WS-RESPONSE
  6888     END-IF
  6889
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 121
* EL6318.cbl
  6890     IF PI-RETURN-TO-PROGRAM = 'EL6314'
  6891         MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
  6892     ELSE
  6893     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
  6894     END-IF
  6895
  6896     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
  6897
  6898
  6899* EXEC CICS READ
  6900*         DATASET  (WS-ELCRTT-FILE-ID)
  6901*         RIDFLD   (WS-ELCRTT-KEY)
  6902*         SET      (ADDRESS OF CERTIFICATE-TRAILERS)
  6903*         RESP     (WS-RESPONSE)
  6904*    END-EXEC
  6905*    MOVE '&"S        E          (  N#00006680' TO DFHEIV0
  6906     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6907     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6908     MOVE X'204E233030303036363830' TO DFHEIV0(25:11)
  6909     CALL 'kxdfhei1' USING DFHEIV0,
  6910           WS-ELCRTT-FILE-ID,
  6911           DFHEIV20,
  6912           DFHEIV99,
  6913           WS-ELCRTT-KEY,
  6914           DFHEIV99,
  6915           DFHEIV99,
  6916           DFHEIV99
  6917     SET ADDRESS OF CERTIFICATE-TRAILERS TO
  6918         DFHEIV20
  6919     MOVE EIBRESP  TO WS-RESPONSE
  6920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6921
  6922     IF RESP-NORMAL
  6923        MOVE CS-INS-AGE-DEFAULT-FLAG TO EN-INS-NEW-AGE-DEF-FLAG
  6924                                     NCRTO-INS-AGE-DEFAULT-FLAG
  6925        MOVE CS-JNT-AGE-DEFAULT-FLAG TO EN-JNT-NEW-AGE-DEF-FLAG
  6926                                     NCRTO-JNT-AGE-DEFAULT-FLAG
  6927     END-IF.
  6928     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6929        IF REACD-IN (S1) NOT = LOW-VALUES
  6930           MOVE REACD-IN (S1)    TO EN-REASON-CODE (S1)
  6931        END-IF
  6932     END-PERFORM
  6933     MOVE LTRIDI                 TO EN-TEMPLATE-USED
  6934     MOVE 'G'                    TO EN-DOCU-TYPE
  6935     MOVE 'Y'                    TO EN-MONEY-SW
  6936     MOVE SIGREQI                TO EN-SIG-SW
  6937     MOVE VOUCHI                 TO EN-VOUCHER-SW
  6938     MOVE PAYEEI                 TO EN-PAYEE
  6939     MOVE HLTHAPPI               TO EN-HEALTH-APP
  6940     DISPLAY ' 0400 EXIT '
  6941     PERFORM 0430-WRITE-ERENDT   THRU 0430-EXIT
  6942     .
  6943 0400-EXIT.
  6944     EXIT.
  6945 0410-INIT-ERENDT.
  6946     display ' made it to 0410 '
  6947     MOVE OC-CONTROL-PRIMARY     TO ERENDT-KEY
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 122
* EL6318.cbl
  6948     MOVE ZEROS                  TO ENDT-SEQ-NO
  6949
  6950* EXEC CICS READ
  6951*        DATASET    (WS-ERENDT-FILE-ID)
  6952*        RIDFLD     (ERENDT-KEY)
  6953*        INTO       (ENDORSEMENT-RECORD)
  6954*        RESP       (WS-RESPONSE)
  6955*        GTEQ
  6956*    END-EXEC
  6957     MOVE LENGTH OF
  6958      ENDORSEMENT-RECORD
  6959       TO DFHEIV11
  6960*    MOVE '&"IL       G          (  N#00006714' TO DFHEIV0
  6961     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  6962     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6963     MOVE X'204E233030303036373134' TO DFHEIV0(25:11)
  6964     CALL 'kxdfhei1' USING DFHEIV0,
  6965           WS-ERENDT-FILE-ID,
  6966           ENDORSEMENT-RECORD,
  6967           DFHEIV11,
  6968           ERENDT-KEY,
  6969           DFHEIV99,
  6970           DFHEIV99,
  6971           DFHEIV99
  6972     MOVE EIBRESP  TO WS-RESPONSE
  6973     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6974     IF RESP-NORMAL
  6975        AND (EN-CONTROL-PRIMARY (1:34) =
  6976           OC-CONTROL-PRIMARY (1:34))
  6977        COMPUTE WS-SEQ-NO = EN-SEQ-NO - +1
  6978     ELSE
  6979        MOVE +4096               TO WS-SEQ-NO
  6980     END-IF
  6981     MOVE 'EN'                   TO ENDORSEMENT-RECORD
  6982     MOVE OC-CONTROL-PRIMARY     TO EN-CONTROL-PRIMARY
  6983     MOVE EN-COMPANY-CD          TO EN-COMPANY-CD-A1
  6984     MOVE WS-SEQ-NO              TO EN-SEQ-NO
  6985     INITIALIZE EN-ISSUE-RECORD
  6986     MOVE LOW-VALUES             TO EN-LF-ORIG-EXP-DT
  6987                                    EN-AH-ORIG-EXP-DT
  6988                                    EN-LF-NEW-EXP-DT
  6989                                    EN-AH-NEW-EXP-DT
  6990                                    EN-PROCESS-DT
  6991     .
  6992 0410-EXIT.
  6993     EXIT.
  6994 0420-UPDATE-ELCRTO.
  6995     PERFORM 0363-READ-ELCRTO-UPD THRU 0363-EXIT
  6996     IF RESP-NORMAL
  6997        MOVE WS-CURRENT-BIN-DT   TO OC-ENDORSEMENT-PROCESSED-DT
  6998                                    OC-LAST-MAINT-DT
  6999        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
  7000        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
  7001
  7002* EXEC CICS REWRITE
  7003*          FROM     (ORIGINAL-CERTIFICATE)
  7004*          DATASET  ('ELCRTO')
  7005*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 123
* EL6318.cbl
  7006     MOVE LENGTH OF
  7007      ORIGINAL-CERTIFICATE
  7008       TO DFHEIV11
  7009     MOVE 'ELCRTO' TO DFHEIV1
  7010*    MOVE '&& L                  %   #00006748' TO DFHEIV0
  7011     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7012     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7013     MOVE X'2020233030303036373438' TO DFHEIV0(25:11)
  7014     CALL 'kxdfhei1' USING DFHEIV0,
  7015           DFHEIV1,
  7016           ORIGINAL-CERTIFICATE,
  7017           DFHEIV11,
  7018           DFHEIV99
  7019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7020     END-IF
  7021     .
  7022 0420-EXIT.
  7023     EXIT.
  7024
  7025 0425-ADD-NEW-ELCRTO.
  7026     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
  7027     MOVE 'OC'                   TO OC-RECORD-ID
  7028     MOVE NEW-ELCRTO-KEY         TO OC-CONTROL-PRIMARY
  7029     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
  7030     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  7031     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
  7032     MOVE NCRTO-INS-FIRST-NAME   TO OC-INS-FIRST-NAME
  7033     MOVE NCRTO-INS-MIDDLE-INIT  TO OC-INS-MIDDLE-INIT
  7034     MOVE NCRTO-INS-LAST-NAME    TO OC-INS-LAST-NAME
  7035     MOVE NCRTO-INS-AGE          TO OC-INS-AGE
  7036     MOVE NCRTO-JNT-FIRST-NAME   TO OC-JNT-FIRST-NAME
  7037     MOVE NCRTO-JNT-MIDDLE-INIT  TO OC-JNT-MIDDLE-INIT
  7038     MOVE NCRTO-JNT-LAST-NAME    TO OC-JNT-LAST-NAME
  7039     MOVE NCRTO-JNT-AGE          TO OC-JNT-AGE
  7040     MOVE NCRTO-LF-BENCD         TO OC-LF-BENCD
  7041     MOVE NCRTO-LF-BEN-AMT       TO OC-LF-BEN-AMT
  7042     MOVE NCRTO-LF-PRM-AMT       TO OC-LF-PRM-AMT
  7043     MOVE NCRTO-LF-ALT-BEN-AMT   TO OC-LF-ALT-BEN-AMT
  7044     MOVE NCRTO-LF-ALT-PRM-AMT   TO OC-LF-ALT-PRM-AMT
  7045     MOVE NCRTO-LF-TERM          TO OC-LF-TERM
  7046     MOVE NCRTO-LF-EXP-DT        TO OC-LF-EXP-DT
  7047     MOVE NCRTO-LF-COMM-PCT      TO OC-LF-COMM-PCT
  7048     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
  7049     MOVE +0                     TO OC-LF-CANCEL-AMT
  7050                                    OC-LF-ITD-CANCEL-AMT
  7051     MOVE NCRTO-AH-BENCD         TO OC-AH-BENCD
  7052     MOVE NCRTO-AH-BEN-AMT       TO OC-AH-BEN-AMT
  7053     MOVE NCRTO-AH-PRM-AMT       TO OC-AH-PRM-AMT
  7054     MOVE NCRTO-AH-TERM          TO OC-AH-TERM
  7055     MOVE NCRTO-AH-EXP-DT        TO OC-AH-EXP-DT
  7056     MOVE NCRTO-AH-CP            TO OC-AH-CP
  7057     MOVE NCRTO-AH-COMM-PCT      TO OC-AH-COMM-PCT
  7058     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
  7059     MOVE +0                     TO OC-AH-CANCEL-AMT
  7060                                    OC-AH-ITD-CANCEL-AMT
  7061     MOVE NCRTO-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
  7062     MOVE NCRTO-1ST-PMT-DT       TO OC-1ST-PMT-DT
  7063     MOVE NCRTO-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 124
* EL6318.cbl
  7064     MOVE NCRTO-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
  7065     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
  7066     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
  7067     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
  7068     .
  7069 0425-WRITE-ELCRTO.
  7070
  7071
  7072* EXEC CICS WRITE
  7073*       DATASET   ('ELCRTO')
  7074*       FROM      (ORIGINAL-CERTIFICATE)
  7075*       RIDFLD    (OC-CONTROL-PRIMARY)
  7076*       RESP      (WS-RESPONSE)
  7077*    END-EXEC
  7078     MOVE LENGTH OF
  7079      ORIGINAL-CERTIFICATE
  7080       TO DFHEIV11
  7081     MOVE 'ELCRTO' TO DFHEIV1
  7082*    MOVE '&$ L                  ''  N#00006803' TO DFHEIV0
  7083     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7084     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7085     MOVE X'204E233030303036383033' TO DFHEIV0(25:11)
  7086     CALL 'kxdfhei1' USING DFHEIV0,
  7087           DFHEIV1,
  7088           ORIGINAL-CERTIFICATE,
  7089           DFHEIV11,
  7090           OC-CONTROL-PRIMARY,
  7091           DFHEIV99,
  7092           DFHEIV99
  7093     MOVE EIBRESP  TO WS-RESPONSE
  7094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7095
  7096     display ' just wrote new crto ' ws-response
  7097     IF RESP-DUPKEY
  7098        SUBTRACT +1              FROM OC-KEY-SEQ-NO
  7099        GO TO 0425-WRITE-ELCRTO
  7100     ELSE
  7101        IF NOT RESP-NORMAL
  7102           MOVE -1               TO SIGREQL
  7103           MOVE ER-3830          TO EMI-ERROR
  7104           PERFORM 9900-ERROR-FORMAT
  7105                                 THRU 9900-EXIT
  7106        ELSE
  7107           MOVE OC-CONTROL-PRIMARY TO PI-ELCRTO-KEY
  7108        END-IF
  7109     END-IF
  7110
  7111     .
  7112 0425-EXIT.
  7113     EXIT.
  7114
  7115 0426-ADD-CERT-NOTES.
  7116
  7117     MOVE LOW-VALUES TO CERT-NOTE-ENTRIES
  7118     SET TB-INDX TO 1
  7119
  7120     IF PI-CERTNT1-ENTERED > SPACES
  7121         MOVE PI-CERTNT1-ENTERED TO CERT-NT-TEXT (TB-INDX)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 125
* EL6318.cbl
  7122         MOVE PI-PROCESSOR-ID    TO
  7123                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  7124         MOVE EIBTIME            TO
  7125                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7126         MOVE WS-CURRENT-BIN-DT  TO
  7127                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  7128         SET TB-INDX UP BY +1
  7129     END-IF
  7130
  7131     IF PI-CERTNT2-ENTERED > SPACES
  7132         MOVE PI-CERTNT2-ENTERED TO CERT-NT-TEXT (TB-INDX)
  7133         MOVE PI-PROCESSOR-ID    TO
  7134                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  7135         MOVE EIBTIME            TO
  7136                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7137         MOVE WS-CURRENT-BIN-DT  TO
  7138                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  7139         SET TB-INDX UP BY +1
  7140     END-IF
  7141
  7142     IF PI-CERTNT3-ENTERED > SPACES
  7143         MOVE PI-CERTNT3-ENTERED TO CERT-NT-TEXT (TB-INDX)
  7144         MOVE PI-PROCESSOR-ID    TO
  7145                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  7146         MOVE EIBTIME            TO
  7147                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7148         MOVE WS-CURRENT-BIN-DT  TO
  7149                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  7150         SET TB-INDX UP BY +1
  7151     END-IF
  7152
  7153     IF PI-CERTNT4-ENTERED > SPACES
  7154         MOVE PI-CERTNT4-ENTERED TO CERT-NT-TEXT (TB-INDX)
  7155         MOVE PI-PROCESSOR-ID    TO
  7156                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  7157         MOVE EIBTIME            TO
  7158                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7159         MOVE WS-CURRENT-BIN-DT  TO
  7160                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  7161         SET TB-INDX UP BY +1
  7162     END-IF
  7163
  7164     IF CERT-NOTE-ENTRIES > SPACES
  7165         PERFORM 0427-LOAD-CURRENT-CERT-NOTES THRU 0427-EXIT
  7166         PERFORM 1700-WRITE-CERT-NOTE THRU 1799-EXIT
  7167     END-IF
  7168
  7169     IF PI-BILLNT1-ENTERED > SPACES
  7170         MOVE SPACES             TO WS-MANUAL-BILL-NOTE
  7171         MOVE PI-BILLNT1-ENTERED TO WS-MAN-BN-NOTE
  7172         MOVE +63 TO WS-LEN
  7173         PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  7174     END-IF
  7175
  7176     IF PI-BILLNT2-ENTERED > SPACES
  7177         MOVE SPACES             TO WS-MANUAL-BILL-NOTE
  7178         MOVE PI-BILLNT2-ENTERED TO WS-MAN-BN-NOTE
  7179         MOVE +63 TO WS-LEN
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 126
* EL6318.cbl
  7180         PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  7181     END-IF
  7182
  7183     .
  7184 0426-EXIT.
  7185     EXIT.
  7186
  7187 0427-LOAD-CURRENT-CERT-NOTES.
  7188
  7189     MOVE PI-CRTO-COMPANY-CD  TO ERCNOT-COMPANY-CD
  7190     MOVE PI-CRTO-CARRIER     TO ERCNOT-CARRIER
  7191     MOVE PI-CRTO-GROUPING    TO ERCNOT-GROUPING
  7192     MOVE PI-CRTO-STATE       TO ERCNOT-STATE
  7193     MOVE PI-CRTO-ACCOUNT     TO ERCNOT-ACCOUNT
  7194     MOVE PI-CRTO-CERT-EFF-DT TO ERCNOT-EFF-DT
  7195     MOVE PI-CRTO-CERT-PRIME  TO ERCNOT-CERT-PRIME
  7196     MOVE PI-CRTO-CERT-SFX    TO ERCNOT-CERT-SFX
  7197     MOVE '1'                 TO ERCNOT-REC-TYP
  7198     MOVE +0                  TO ERCNOT-SEQ
  7199     MOVE ERCNOT-PARTIAL-KEY  TO SV-PARTIAL-KEY
  7200
  7201
  7202* EXEC CICS STARTBR
  7203*         DATASET(WS-ERCNOT-FILE-ID)
  7204*         RIDFLD(ERCNOT-KEY)
  7205*         KEYLENGTH(ERCNOT-START-LENGTH)
  7206*         RESP      (WS-RESPONSE)
  7207*         GENERIC
  7208*         GTEQ
  7209*    END-EXEC.
  7210     MOVE 0
  7211       TO DFHEIV11
  7212*    MOVE '&,   KG    G          &  N#00006915' TO DFHEIV0
  7213     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  7214     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7215     MOVE X'204E233030303036393135' TO DFHEIV0(25:11)
  7216     CALL 'kxdfhei1' USING DFHEIV0,
  7217           WS-ERCNOT-FILE-ID,
  7218           ERCNOT-KEY,
  7219           ERCNOT-START-LENGTH,
  7220           DFHEIV11,
  7221           DFHEIV99
  7222     MOVE EIBRESP  TO WS-RESPONSE
  7223     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7224
  7225
  7226     IF NOT RESP-NORMAL
  7227        GO TO 0427-ENDBR
  7228     END-IF.
  7229
  7230 0427-LOOP.
  7231
  7232* EXEC CICS READNEXT
  7233*         SET(ADDRESS OF CERT-NOTE-FILE)
  7234*         DATASET(WS-ERCNOT-FILE-ID)
  7235*         RIDFLD(ERCNOT-KEY)
  7236*    END-EXEC.
  7237     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 127
* EL6318.cbl
  7238       TO DFHEIV11
  7239*    MOVE '&.S                   )   #00006929' TO DFHEIV0
  7240     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7241     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7242     MOVE X'2020233030303036393239' TO DFHEIV0(25:11)
  7243     CALL 'kxdfhei1' USING DFHEIV0,
  7244           WS-ERCNOT-FILE-ID,
  7245           DFHEIV20,
  7246           DFHEIV99,
  7247           ERCNOT-KEY,
  7248           DFHEIV99,
  7249           DFHEIV11,
  7250           DFHEIV99,
  7251           DFHEIV99
  7252     SET ADDRESS OF CERT-NOTE-FILE TO
  7253         DFHEIV20
  7254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7255
  7256
  7257     IF CZ-COMPANY-CD NOT = PI-CRTO-COMPANY-CD
  7258         GO TO 0427-ENDBR
  7259     END-IF.
  7260
  7261     IF (CZ-CARRIER = SV-CARRIER)
  7262        AND (CZ-GROUPING = SV-GROUPING)
  7263        AND (CZ-STATE = SV-STATE)
  7264        AND (CZ-ACCOUNT = SV-ACCOUNT)
  7265        AND (CZ-CERT-EFF-DT = SV-EFF-DT)
  7266        AND (CZ-CERT-NO = SV-CERT-NO)
  7267        AND (CZ-RECORD-TYPE = '1')
  7268          MOVE CZ-NOTE TO CERT-NT-TEXT (TB-INDX)
  7269          MOVE CZ-LAST-MAINT-USER TO
  7270                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  7271          MOVE CZ-LAST-MAINT-DT TO
  7272                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  7273          MOVE CZ-LAST-MAINT-HHMMSS TO
  7274                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7275          SET TB-INDX UP BY 1
  7276          GO TO 0427-LOOP
  7277     END-IF.
  7278
  7279 0427-ENDBR.
  7280
  7281
  7282* EXEC CICS ENDBR
  7283*         DATASET(WS-ERCNOT-FILE-ID)
  7284*    END-EXEC.
  7285     MOVE 0
  7286       TO DFHEIV11
  7287*    MOVE '&2                    $   #00006959' TO DFHEIV0
  7288     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7289     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7290     MOVE X'2020233030303036393539' TO DFHEIV0(25:11)
  7291     CALL 'kxdfhei1' USING DFHEIV0,
  7292           WS-ERCNOT-FILE-ID,
  7293           DFHEIV11,
  7294           DFHEIV99
  7295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 128
* EL6318.cbl
  7296
  7297
  7298     .
  7299 0427-EXIT.
  7300     EXIT.
  7301
  7302 0430-WRITE-ERENDT.
  7303     DISPLAY ' NO ERRORS, ABOUT TO WRITE ERENDT '
  7304     MOVE EN-CONTROL-PRIMARY     TO PI-ERENDT-KEY
  7305     MOVE W-ARCH-NUMBER          TO EN-ARCHIVE-NO
  7306
  7307* EXEC CICS WRITE
  7308*         DATASET   (WS-ERENDT-FILE-ID)
  7309*         FROM      (ENDORSEMENT-RECORD)
  7310*         RIDFLD    (EN-CONTROL-PRIMARY)
  7311*         RESP      (WS-RESPONSE)
  7312*    END-EXEC
  7313     MOVE LENGTH OF
  7314      ENDORSEMENT-RECORD
  7315       TO DFHEIV11
  7316*    MOVE '&$ L                  ''  N#00006971' TO DFHEIV0
  7317     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7318     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7319     MOVE X'204E233030303036393731' TO DFHEIV0(25:11)
  7320     CALL 'kxdfhei1' USING DFHEIV0,
  7321           WS-ERENDT-FILE-ID,
  7322           ENDORSEMENT-RECORD,
  7323           DFHEIV11,
  7324           EN-CONTROL-PRIMARY,
  7325           DFHEIV99,
  7326           DFHEIV99
  7327     MOVE EIBRESP  TO WS-RESPONSE
  7328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7329     IF RESP-NORMAL
  7330        MOVE 'G'                 TO PI-DOCUMENT-PROCESSED
  7331        display ' good write erendt '
  7332        IF EIBAID = DFHPF4
  7333           PERFORM 0420-UPDATE-ELCRTO THRU 0420-EXIT
  7334           PERFORM 0425-ADD-NEW-ELCRTO THRU 0425-EXIT
  7335           PERFORM 0426-ADD-CERT-NOTES THRU 0426-EXIT
  7336           PERFORM 0440-ADD-BILLING-NOTE THRU 0440-EXIT
  7337        END-IF
  7338     ELSE
  7339        DISPLAY ' NOT A GOOD WRITE ERENDT ' WS-RESPONSE
  7340        MOVE -1                  TO SIGREQL
  7341        MOVE ER-0132             TO EMI-ERROR
  7342        MOVE AL-UABON            TO SIGREQA
  7343        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7344     END-IF
  7345     .
  7346 0430-EXIT.
  7347     EXIT.
  7348
  7349
  7350 0440-ADD-BILLING-NOTE.
  7351
  7352* EXEC CICS GETMAIN
  7353*         SET      (ADDRESS OF EOB-CODES)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 129
* EL6318.cbl
  7354*         LENGTH   (ELEOBC-LENGTH)
  7355*         INITIMG  (GETMAIN-SPACE)
  7356*    END-EXEC
  7357*    MOVE ',"IL                  $   #00006999' TO DFHEIV0
  7358     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7359     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7360     MOVE X'2020233030303036393939' TO DFHEIV0(25:11)
  7361     CALL 'kxdfhei1' USING DFHEIV0,
  7362           DFHEIV20,
  7363           ELEOBC-LENGTH,
  7364           GETMAIN-SPACE
  7365     SET ADDRESS OF EOB-CODES TO
  7366         DFHEIV20
  7367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7368
  7369     MOVE LOW-VALUES             TO WS-ELEOBC-KEY
  7370     MOVE PI-COMPANY-CD          TO WS-EOBC-COMPANY-CD
  7371     MOVE '5'                    TO WS-EOBC-REC-TYPE
  7372
  7373
  7374* EXEC CICS STARTBR
  7375*        DATASET   ('ELEOBC')
  7376*        RIDFLD    (WS-ELEOBC-KEY)
  7377*        GTEQ
  7378*        RESP      (WS-RESPONSE)
  7379*    END-EXEC
  7380     MOVE 'ELEOBC' TO DFHEIV1
  7381     MOVE 0
  7382       TO DFHEIV11
  7383*    MOVE '&,         G          &  N#00007009' TO DFHEIV0
  7384     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7385     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7386     MOVE X'204E233030303037303039' TO DFHEIV0(25:11)
  7387     CALL 'kxdfhei1' USING DFHEIV0,
  7388           DFHEIV1,
  7389           WS-ELEOBC-KEY,
  7390           DFHEIV99,
  7391           DFHEIV11,
  7392           DFHEIV99
  7393     MOVE EIBRESP  TO WS-RESPONSE
  7394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7395
  7396     IF NOT RESP-NORMAL
  7397        GO TO 0440-EXIT
  7398     END-IF
  7399      .
  7400 0440-READNEXT-ELEOBC.
  7401
  7402
  7403* EXEC CICS READNEXT
  7404*       INTO    (EOB-CODES)
  7405*       DATASET ('ELEOBC')
  7406*       RIDFLD  (WS-ELEOBC-KEY)
  7407*       RESP    (WS-RESPONSE)
  7408*    END-EXEC
  7409     MOVE LENGTH OF
  7410      EOB-CODES
  7411       TO DFHEIV12
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 130
* EL6318.cbl
  7412     MOVE 'ELEOBC' TO DFHEIV1
  7413     MOVE 0
  7414       TO DFHEIV11
  7415*    MOVE '&.IL                  )  N#00007022' TO DFHEIV0
  7416     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  7417     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7418     MOVE X'204E233030303037303232' TO DFHEIV0(25:11)
  7419     CALL 'kxdfhei1' USING DFHEIV0,
  7420           DFHEIV1,
  7421           EOB-CODES,
  7422           DFHEIV12,
  7423           WS-ELEOBC-KEY,
  7424           DFHEIV99,
  7425           DFHEIV11,
  7426           DFHEIV99,
  7427           DFHEIV99
  7428     MOVE EIBRESP  TO WS-RESPONSE
  7429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7430
  7431     IF RESP-NORMAL
  7432         IF EO-RECORD-TYPE NOT = '5'
  7433             GO TO 0440-EXIT
  7434         END-IF
  7435     ELSE
  7436         GO TO 0440-EXIT
  7437     END-IF
  7438
  7439     IF EO-RECORD-TYPE = '5' AND
  7440        EO-EOB-CODE = PI-LTRID-ENTERED
  7441           CONTINUE
  7442     ELSE
  7443         GO TO 0440-READNEXT-ELEOBC
  7444     END-IF
  7445
  7446     MOVE SPACES TO WS-BILLING-NOTE
  7447     MOVE EO-DESCRIPTION TO WS-BN-NOTE
  7448     MOVE PI-LTRID-ENTERED TO WS-BN-LTRID
  7449     MOVE WS-CURRENT-DT TO WS-BN-DATE
  7450     MOVE PI-PROCESSOR-ID TO WS-BN-USERID
  7451     MOVE +25 TO WS-LEN
  7452
  7453     PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  7454     .
  7455 0440-EXIT.
  7456     EXIT.
  7457
  7458 0441-UPDATE-BILLING-NOTE.
  7459
  7460* EXEC CICS GETMAIN
  7461*         SET      (ADDRESS OF CERTIFICATE-NOTE)
  7462*         LENGTH   (ERNOTE-LENGTH)
  7463*         INITIMG  (GETMAIN-SPACE)
  7464*    END-EXEC
  7465*    MOVE ',"IL                  $   #00007057' TO DFHEIV0
  7466     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7467     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7468     MOVE X'2020233030303037303537' TO DFHEIV0(25:11)
  7469     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 131
* EL6318.cbl
  7470           DFHEIV20,
  7471           ERNOTE-LENGTH,
  7472           GETMAIN-SPACE
  7473     SET ADDRESS OF CERTIFICATE-NOTE TO
  7474         DFHEIV20
  7475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7476
  7477     MOVE PI-ERENDT-KEY (1:33) TO WS-ERNOTE-KEY
  7478
  7479
  7480* EXEC CICS READ
  7481*       DATASET    (WS-ERNOTE-FILE-ID)
  7482*       RIDFLD     (WS-ERNOTE-KEY)
  7483*       INTO       (CERTIFICATE-NOTE)
  7484*       RESP       (WS-RESPONSE)
  7485*       UPDATE
  7486*    END-EXEC
  7487     MOVE LENGTH OF
  7488      CERTIFICATE-NOTE
  7489       TO DFHEIV11
  7490*    MOVE '&"IL       EU         (  N#00007065' TO DFHEIV0
  7491     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7492     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7493     MOVE X'204E233030303037303635' TO DFHEIV0(25:11)
  7494     CALL 'kxdfhei1' USING DFHEIV0,
  7495           WS-ERNOTE-FILE-ID,
  7496           CERTIFICATE-NOTE,
  7497           DFHEIV11,
  7498           WS-ERNOTE-KEY,
  7499           DFHEIV99,
  7500           DFHEIV99,
  7501           DFHEIV99
  7502     MOVE EIBRESP  TO WS-RESPONSE
  7503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7504
  7505     IF RESP-NORMAL
  7506       IF CN-BILLING-START-LINE-NO NOT NUMERIC
  7507          MOVE ZEROS            TO CN-BILLING-START-LINE-NO
  7508       END-IF
  7509       IF CN-BILLING-END-LINE-NO NOT NUMERIC
  7510          MOVE ZEROS            TO CN-BILLING-END-LINE-NO
  7511       END-IF
  7512       PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  7513           (NOTE-SUB > +10) OR
  7514           (CN-LINE (NOTE-SUB) (1:WS-LEN) =
  7515                             WS-BILLING-NOTE (1:WS-LEN))
  7516       END-PERFORM
  7517       IF CN-LINE (NOTE-SUB) (1:WS-LEN) =
  7518                              WS-BILLING-NOTE (1:WS-LEN)
  7519
  7520* EXEC CICS UNLOCK
  7521*           DATASET    (WS-ERNOTE-FILE-ID)
  7522*        END-EXEC
  7523*    MOVE '&*                    #   #00007087' TO DFHEIV0
  7524     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7525     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7526     MOVE X'2020233030303037303837' TO DFHEIV0(25:11)
  7527     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 132
* EL6318.cbl
  7528           WS-ERNOTE-FILE-ID,
  7529           DFHEIV99
  7530     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7531       ELSE
  7532         PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  7533           (NOTE-SUB > +10) OR
  7534           (CN-LINE (NOTE-SUB) = SPACES OR LOW-VALUES)
  7535         END-PERFORM
  7536         IF (NOTE-SUB < +11)
  7537           IF NOTE-SUB >= CN-BILLING-START-LINE-NO AND
  7538              NOTE-SUB <= CN-BILLING-END-LINE-NO
  7539                MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  7540           ELSE
  7541             IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
  7542              (NOTE-SUB = (CN-BILLING-END-LINE-NO + +1))
  7543                MOVE WS-BILLING-NOTE   TO CN-LINE (NOTE-SUB)
  7544                MOVE NOTE-SUB     TO CN-BILLING-END-LINE-NO
  7545             ELSE
  7546               IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
  7547                  (NOTE-SUB = (CN-BILLING-START-LINE-NO - +1))
  7548                     MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  7549                     MOVE NOTE-SUB  TO CN-BILLING-START-LINE-NO
  7550               ELSE
  7551                 IF (CN-BILLING-END-LINE-NO = ZEROS)
  7552                   MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB)
  7553                   MOVE NOTE-SUB    TO CN-BILLING-END-LINE-NO
  7554                                       CN-BILLING-START-LINE-NO
  7555                 ELSE
  7556                    PERFORM 0442-SQUEEZE-IT-IN THRU 0442-EXIT
  7557                 END-IF
  7558               END-IF
  7559             END-IF
  7560           END-IF
  7561           MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  7562           MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  7563           MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  7564
  7565* EXEC CICS REWRITE
  7566*             DATASET    (WS-ERNOTE-FILE-ID)
  7567*             FROM       (CERTIFICATE-NOTE)
  7568*             RESP       (WS-RESPONSE)
  7569*          END-EXEC
  7570     MOVE LENGTH OF
  7571      CERTIFICATE-NOTE
  7572       TO DFHEIV11
  7573*    MOVE '&& L                  %  N#00007123' TO DFHEIV0
  7574     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7575     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7576     MOVE X'204E233030303037313233' TO DFHEIV0(25:11)
  7577     CALL 'kxdfhei1' USING DFHEIV0,
  7578           WS-ERNOTE-FILE-ID,
  7579           CERTIFICATE-NOTE,
  7580           DFHEIV11,
  7581           DFHEIV99
  7582     MOVE EIBRESP  TO WS-RESPONSE
  7583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7584           PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  7585         END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 133
* EL6318.cbl
  7586       END-IF
  7587     ELSE
  7588        MOVE SPACES              TO CERTIFICATE-NOTE
  7589        MOVE 'CN'                TO CN-RECORD-ID
  7590        MOVE PI-ERENDT-KEY (1:33) TO CN-CONTROL-PRIMARY
  7591                                     WS-ERNOTE-KEY
  7592        MOVE 01                  TO CN-BILLING-START-LINE-NO
  7593                                    CN-BILLING-END-LINE-NO
  7594        MOVE WS-BILLING-NOTE     TO CN-LINE (01)
  7595        MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  7596        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  7597        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  7598
  7599* EXEC CICS WRITE
  7600*          DATASET    (WS-ERNOTE-FILE-ID)
  7601*          FROM       (CERTIFICATE-NOTE)
  7602*          RIDFLD     (WS-ERNOTE-KEY)
  7603*          RESP       (WS-RESPONSE)
  7604*       END-EXEC
  7605     MOVE LENGTH OF
  7606      CERTIFICATE-NOTE
  7607       TO DFHEIV11
  7608*    MOVE '&$ L                  ''  N#00007142' TO DFHEIV0
  7609     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7610     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7611     MOVE X'204E233030303037313432' TO DFHEIV0(25:11)
  7612     CALL 'kxdfhei1' USING DFHEIV0,
  7613           WS-ERNOTE-FILE-ID,
  7614           CERTIFICATE-NOTE,
  7615           DFHEIV11,
  7616           WS-ERNOTE-KEY,
  7617           DFHEIV99,
  7618           DFHEIV99
  7619     MOVE EIBRESP  TO WS-RESPONSE
  7620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7621
  7622        PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  7623     END-IF
  7624
  7625     .
  7626 0441-EXIT.
  7627     EXIT.
  7628
  7629
  7630 0442-SQUEEZE-IT-IN.
  7631
  7632     IF NOTE-SUB < CN-BILLING-START-LINE-NO
  7633        PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
  7634           NOTE-SUB = +10
  7635           MOVE CN-LINE (NOTE-SUB + 1) TO CN-LINE (NOTE-SUB)
  7636           IF (NOTE-SUB + 1) = (CN-BILLING-START-LINE-NO - 1)
  7637             MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB + 1)
  7638             COMPUTE CN-BILLING-START-LINE-NO = NOTE-SUB + 1
  7639             MOVE +9 TO NOTE-SUB
  7640           END-IF
  7641        END-PERFORM
  7642     ELSE
  7643        IF NOTE-SUB > CN-BILLING-END-LINE-NO
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 134
* EL6318.cbl
  7644           PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY -1
  7645             UNTIL NOTE-SUB = +1
  7646             MOVE CN-LINE (NOTE-SUB - 1) TO CN-LINE (NOTE-SUB)
  7647             IF (NOTE-SUB - 1) = (CN-BILLING-END-LINE-NO + 1)
  7648                MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB - 1)
  7649                COMPUTE CN-BILLING-END-LINE-NO = NOTE-SUB - 1
  7650                MOVE +2          TO NOTE-SUB
  7651             END-IF
  7652           END-PERFORM
  7653        END-IF
  7654     END-IF
  7655
  7656     .
  7657 0442-EXIT.
  7658     EXIT.
  7659
  7660 0445-CERTIFICATE-UPDATE.
  7661    display 'billing note written, updating cert'
  7662     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  7663     IF RESP-NORMAL
  7664        EVALUATE CM-NOTE-SW
  7665           WHEN '2'
  7666           WHEN '3'
  7667           WHEN '6'
  7668           WHEN '7'
  7669              SET NO-CERT-RW     TO TRUE
  7670           WHEN ' '
  7671              MOVE '2'           TO CM-NOTE-SW
  7672           WHEN '1'
  7673              MOVE '3'           TO CM-NOTE-SW
  7674           WHEN '4'
  7675              MOVE '6'           TO CM-NOTE-SW
  7676           WHEN '5'
  7677              MOVE '7'           TO CM-NOTE-SW
  7678        END-EVALUATE
  7679     END-IF
  7680     IF NOT NO-CERT-RW
  7681        PERFORM 1810-REWRITE-ELCERT
  7682                                 THRU 1810-EXIT
  7683     ELSE
  7684
  7685* EXEC CICS UNLOCK
  7686*          DATASET    (WS-ELCERT-FILE-ID)
  7687*       END-EXEC
  7688*    MOVE '&*                    #   #00007211' TO DFHEIV0
  7689     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7690     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7691     MOVE X'2020233030303037323131' TO DFHEIV0(25:11)
  7692     CALL 'kxdfhei1' USING DFHEIV0,
  7693           WS-ELCERT-FILE-ID,
  7694           DFHEIV99
  7695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7696     END-IF
  7697
  7698     .
  7699 0445-EXIT.
  7700     EXIT.
  7701
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 135
* EL6318.cbl
  7702 0450-GET-ERACCT.
  7703     MOVE ' '                    TO WS-ERACCT-SW
  7704     MOVE ZEROS                  TO WS-CHGBACK
  7705                                    WS-CSO-PORTION
  7706                                    WS-ACCT-PORTION
  7707                                    WS-DIFF
  7708     PERFORM 0460-STARTBR-ERACCT THRU 0460-EXIT
  7709     IF RESP-NORMAL
  7710        PERFORM 0470-READNEXT-ERACCT
  7711                                 THRU 0470-EXIT
  7712     END-IF
  7713     IF RESP-NORMAL
  7714        IF AM-CONTROL-PRIMARY (1:20) = EN-CONTROL-PRIMARY (1:20)
  7715           IF EN-CERT-EFF-DT < AM-EXPIRATION-DT
  7716              AND >= AM-EFFECTIVE-DT
  7717              SET ACCT-FOUND TO TRUE
  7718           ELSE
  7719              PERFORM 0470-READNEXT-ERACCT
  7720                                 THRU 0470-EXIT
  7721              IF RESP-NORMAL
  7722                 IF AM-CONTROL-PRIMARY (1:20)
  7723                    = EN-CONTROL-PRIMARY (1:20)
  7724                    IF EN-CERT-EFF-DT < AM-EXPIRATION-DT
  7725                       AND >= AM-EFFECTIVE-DT
  7726                       SET ACCT-FOUND TO TRUE
  7727                    END-IF
  7728                 END-IF
  7729              END-IF
  7730           END-IF
  7731        END-IF
  7732     END-IF
  7733     IF ACCT-FOUND
  7734        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  7735           (AM-COM-TYP (S1) = 'C' OR 'D')
  7736           OR (S1 > +10)
  7737        END-PERFORM
  7738        IF S1 < +11
  7739           MOVE AM-COMM-CHARGEBACK (S1)
  7740                                 TO WS-CHGBACK
  7741        END-IF
  7742     END-IF
  7743    .
  7744 0450-EXIT.
  7745     EXIT.
  7746 0460-STARTBR-ERACCT.
  7747     MOVE LOW-VALUES             TO WS-ERACCT-KEY
  7748     MOVE EN-CONTROL-PRIMARY     TO WS-ERACCT-KEY (1:22)
  7749     MOVE WS-ERACCT-KEY          TO WS-SAVE-ERACCT-KEY
  7750
  7751* EXEC CICS STARTBR
  7752*        DATASET   ('ERACCT')
  7753*        RIDFLD    (WS-ERACCT-KEY)
  7754*        GTEQ
  7755*        RESP      (WS-RESPONSE)
  7756*    END-EXEC
  7757     MOVE 'ERACCT' TO DFHEIV1
  7758     MOVE 0
  7759       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 136
* EL6318.cbl
  7760*    MOVE '&,         G          &  N#00007268' TO DFHEIV0
  7761     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7762     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7763     MOVE X'204E233030303037323638' TO DFHEIV0(25:11)
  7764     CALL 'kxdfhei1' USING DFHEIV0,
  7765           DFHEIV1,
  7766           WS-ERACCT-KEY,
  7767           DFHEIV99,
  7768           DFHEIV11,
  7769           DFHEIV99
  7770     MOVE EIBRESP  TO WS-RESPONSE
  7771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7772     .
  7773 0460-EXIT.
  7774     EXIT.
  7775 0470-READNEXT-ERACCT.
  7776
  7777* EXEC CICS READNEXT
  7778*       INTO    (ACCOUNT-MASTER)
  7779*       DATASET ('ERACCT')
  7780*       RIDFLD  (WS-ERACCT-KEY)
  7781*       RESP    (WS-RESPONSE)
  7782*    END-EXEC
  7783     MOVE LENGTH OF
  7784      ACCOUNT-MASTER
  7785       TO DFHEIV12
  7786     MOVE 'ERACCT' TO DFHEIV1
  7787     MOVE 0
  7788       TO DFHEIV11
  7789*    MOVE '&.IL                  )  N#00007278' TO DFHEIV0
  7790     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  7791     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7792     MOVE X'204E233030303037323738' TO DFHEIV0(25:11)
  7793     CALL 'kxdfhei1' USING DFHEIV0,
  7794           DFHEIV1,
  7795           ACCOUNT-MASTER,
  7796           DFHEIV12,
  7797           WS-ERACCT-KEY,
  7798           DFHEIV99,
  7799           DFHEIV11,
  7800           DFHEIV99,
  7801           DFHEIV99
  7802     MOVE EIBRESP  TO WS-RESPONSE
  7803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7804     .
  7805 0470-EXIT.
  7806     EXIT.
  7807 0500-CREATE-TEMP-STORAGE.
  7808     display ' about to write pi ' program-interface-block
  7809
  7810* EXEC CICS WRITEQ TS
  7811*        QUEUE (QID)
  7812*        FROM  (PROGRAM-INTERFACE-BLOCK)
  7813*        LENGTH(PI-COMM-LENGTH)
  7814*    END-EXEC
  7815*    MOVE '*"                    ''   #00007289' TO DFHEIV0
  7816     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7817     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 137
* EL6318.cbl
  7818     MOVE X'2020233030303037323839' TO DFHEIV0(25:11)
  7819     CALL 'kxdfhei1' USING DFHEIV0,
  7820           QID,
  7821           PROGRAM-INTERFACE-BLOCK,
  7822           PI-COMM-LENGTH,
  7823           DFHEIV99,
  7824           DFHEIV99,
  7825           DFHEIV99
  7826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7827     display ' about to write map ' el631ki
  7828
  7829* EXEC CICS WRITEQ TS
  7830*        QUEUE (QID)
  7831*        FROM  (EL631KI)
  7832*        LENGTH(MAP-LENGTH)
  7833*    END-EXEC.
  7834*    MOVE '*"                    ''   #00007295' TO DFHEIV0
  7835     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7836     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7837     MOVE X'2020233030303037323935' TO DFHEIV0(25:11)
  7838     CALL 'kxdfhei1' USING DFHEIV0,
  7839           QID,
  7840           EL631KI,
  7841           MAP-LENGTH,
  7842           DFHEIV99,
  7843           DFHEIV99,
  7844           DFHEIV99
  7845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7846
  7847 0500-EXIT.
  7848      EXIT.
  7849 0600-RECOVER-TEMP-STORAGE.
  7850     display ' about to recover pi '
  7851
  7852* EXEC CICS READQ TS
  7853*        QUEUE (QID)
  7854*        INTO  (PROGRAM-INTERFACE-BLOCK)
  7855*        LENGTH(PI-COMM-LENGTH)
  7856*    END-EXEC
  7857*    MOVE '*$I    L              ''   #00007304' TO DFHEIV0
  7858     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7859     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7860     MOVE X'2020233030303037333034' TO DFHEIV0(25:11)
  7861     CALL 'kxdfhei1' USING DFHEIV0,
  7862           QID,
  7863           PROGRAM-INTERFACE-BLOCK,
  7864           PI-COMM-LENGTH,
  7865           DFHEIV99,
  7866           DFHEIV99,
  7867           DFHEIV99
  7868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7869     display ' pi ' pi-program-work-area
  7870     display ' about to recover map '
  7871
  7872* EXEC CICS READQ TS
  7873*        QUEUE (QID)
  7874*        INTO  (EL631KI)
  7875*        LENGTH(MAP-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 138
* EL6318.cbl
  7876*    END-EXEC
  7877*    MOVE '*$I    L              ''   #00007311' TO DFHEIV0
  7878     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7879     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7880     MOVE X'2020233030303037333131' TO DFHEIV0(25:11)
  7881     CALL 'kxdfhei1' USING DFHEIV0,
  7882           QID,
  7883           EL631KI,
  7884           MAP-LENGTH,
  7885           DFHEIV99,
  7886           DFHEIV99,
  7887           DFHEIV99
  7888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7889     display ' map ' el631ki
  7890     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  7891     MOVE AL-UANON            TO SIGREQA
  7892     MOVE AL-UANON            TO LTRIDA
  7893     MOVE AL-UANON            TO VOUCHA
  7894     MOVE AL-UANON            TO HLTHAPPA
  7895     MOVE AL-UANON            TO PAYEEA
  7896     IF WS-SET-CODES-MDT = 'Y'
  7897        move +1                  to s2
  7898        perform varying s1 from +1 by +5 until s1 > +60
  7899           MOVE WS-PASSED-REASON-CODES (s1:4)
  7900                                 TO reacd-in (s2)
  7901           IF REACD-IN (S2) NOT EQUAL SPACES AND LOW-VALUES
  7902               MOVE AL-SANON     TO REACDA (S2)
  7903               MOVE +4           TO REACDL (S2)
  7904           END-IF
  7905           add +1                to s2
  7906        end-perform
  7907        MOVE REASONCDS       TO PI-REASONS-ENTERED
  7908     END-IF
  7909     IF CERTIDI > SPACES
  7910         MOVE AL-UANON       TO CERTIDA
  7911     END-IF
  7912
  7913     IF ENCCODEI > SPACES
  7914         MOVE AL-UANON       TO ENCCODEA
  7915     END-IF
  7916
  7917     IF CRTNT1I > SPACES
  7918         MOVE AL-UANON       TO CRTNT1A
  7919     END-IF
  7920
  7921     IF CRTNT2I > SPACES
  7922         MOVE AL-UANON       TO CRTNT2A
  7923     END-IF
  7924
  7925     IF CRTNT3I > SPACES
  7926         MOVE AL-UANON       TO CRTNT3A
  7927     END-IF
  7928
  7929     IF CRTNT4I > SPACES
  7930         MOVE AL-UANON       TO CRTNT4A
  7931     END-IF
  7932
  7933     IF BILNT1I > SPACES
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 139
* EL6318.cbl
  7934         MOVE AL-UANON       TO BILNT1A
  7935     END-IF
  7936
  7937     IF BILNT2I > SPACES
  7938         MOVE AL-UANON       TO BILNT2A
  7939     END-IF
  7940     .
  7941 0600-EXIT.
  7942      EXIT.
  7943 0800-DELETE-TS.
  7944
  7945* EXEC CICS DELETEQ TS
  7946*        QUEUE(QID)
  7947*    END-EXEC
  7948*    MOVE '*&                    #   #00007371' TO DFHEIV0
  7949     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7950     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7951     MOVE X'2020233030303037333731' TO DFHEIV0(25:11)
  7952     CALL 'kxdfhei1' USING DFHEIV0,
  7953           QID,
  7954           DFHEIV99
  7955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7956     .
  7957 0800-EXIT.
  7958      EXIT.
  7959 1000-BUILD-ERARCH.
  7960     display ' made it to 1000 '
  7961     MOVE SPACES                 TO W-CNTL-KEY
  7962     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID
  7963     MOVE '1'                    TO W-CNTL-RECORD-TYPE
  7964     MOVE ZEROS                  TO W-CNTL-SEQ-NO
  7965
  7966* EXEC CICS READ
  7967*         DATASET    (WS-ELCNTL-FILE-ID)
  7968*         SET        (ADDRESS OF CONTROL-FILE)
  7969*         RIDFLD     (W-CNTL-KEY)
  7970*         UPDATE
  7971*         RESP       (WS-RESPONSE)
  7972*    END-EXEC
  7973*    MOVE '&"S        EU         (  N#00007383' TO DFHEIV0
  7974     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7975     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7976     MOVE X'204E233030303037333833' TO DFHEIV0(25:11)
  7977     CALL 'kxdfhei1' USING DFHEIV0,
  7978           WS-ELCNTL-FILE-ID,
  7979           DFHEIV20,
  7980           DFHEIV99,
  7981           W-CNTL-KEY,
  7982           DFHEIV99,
  7983           DFHEIV99,
  7984           DFHEIV99
  7985     SET ADDRESS OF CONTROL-FILE TO
  7986         DFHEIV20
  7987     MOVE EIBRESP  TO WS-RESPONSE
  7988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7989     IF RESP-NORMAL
  7990        display ' good read elcntl '
  7991        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 140
* EL6318.cbl
  7992           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  7993        END-IF
  7994        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
  7995        MOVE CF-CREDIT-LAST-ARCH-NUM
  7996                                 TO W-ARCH-NUMBER
  7997
  7998* EXEC CICS REWRITE
  7999*          FROM      (CONTROL-FILE)
  8000*          DATASET   (WS-ELCNTL-FILE-ID)
  8001*       END-EXEC
  8002     MOVE LENGTH OF
  8003      CONTROL-FILE
  8004       TO DFHEIV11
  8005*    MOVE '&& L                  %   #00007398' TO DFHEIV0
  8006     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8007     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8008     MOVE X'2020233030303037333938' TO DFHEIV0(25:11)
  8009     CALL 'kxdfhei1' USING DFHEIV0,
  8010           WS-ELCNTL-FILE-ID,
  8011           CONTROL-FILE,
  8012           DFHEIV11,
  8013           DFHEIV99
  8014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8015     END-IF
  8016
  8017* EXEC CICS GETMAIN
  8018*       SET      (ADDRESS OF LETTER-ARCHIVE)
  8019*       LENGTH   (W-ARCH-LENGTH)
  8020*    END-EXEC
  8021*    MOVE '," L                  $   #00007403' TO DFHEIV0
  8022     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  8023     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8024     MOVE X'2020233030303037343033' TO DFHEIV0(25:11)
  8025     CALL 'kxdfhei1' USING DFHEIV0,
  8026           DFHEIV20,
  8027           W-ARCH-LENGTH,
  8028           DFHEIV99
  8029     SET ADDRESS OF LETTER-ARCHIVE TO
  8030         DFHEIV20
  8031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8032     MOVE 'LA'                   TO LETTER-ARCHIVE
  8033     MOVE W-ARCH-NUMBER          TO LA-ARCHIVE-NO
  8034                                    LA-ARCHIVE-NO-A2
  8035                                    LA-ARCHIVE-NO-A3
  8036                                    LA-ARCHIVE-NO-A4
  8037                                    LA-ARCHIVE-NO-A5
  8038                                    LA-ARCHIVE-NO-A6
  8039     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
  8040                                    LA-COMPANY-CD-A2
  8041                                    LA-COMPANY-CD-A3
  8042                                    LA-COMPANY-CD-A4
  8043                                    LA-COMPANY-CD-A5
  8044                                    LA-COMPANY-CD-A6
  8045     MOVE PB-CARRIER             TO LA-CARRIER-A2
  8046                                    LA-CARRIER-A3
  8047                                    LA-CARRIER-A4
  8048                                    LA-CARRIER-A5
  8049     MOVE Pb-cert-eff-dt         TO LA-EFFECT-DATE-A2
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 141
* EL6318.cbl
  8050     MOVE PB-GROUPING            TO LA-GROUPING-A2
  8051                                    LA-GROUPING-A3
  8052                                    LA-GROUPING-A4
  8053                                    LA-GROUPING-A5
  8054     MOVE PB-ACCOUNT             TO LA-ACCOUNT-A2
  8055                                    LA-ACCOUNT-A3
  8056                                    LA-ACCOUNT-A4
  8057                                    LA-ACCOUNT-A5
  8058     MOVE PB-STATE               TO LA-STATE-A2
  8059                                    LA-STATE-A3
  8060                                    LA-STATE-A4
  8061                                    LA-STATE-A5
  8062     MOVE PB-CERT-PRIME          TO LA-CERT-PRIME-A2
  8063     MOVE PB-CERT-SFX            TO LA-CERT-SUFFIX-A2
  8064     MOVE PB-ENTRY-BATCH         TO LA-ENTRY-A6
  8065     MOVE PI-PROCESSOR-ID        TO LA-PROCESSOR-CD
  8066     MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
  8067                                    LA-INITIAL-PRINT-DATE
  8068                                    LA-SENT-DATE
  8069                                    LA-REPLY-DATE
  8070                                    LA-RESEND-DATE
  8071                                    LA-FOLLOW-UP-DATE
  8072     MOVE 'A'                    TO LA-STATUS
  8073     MOVE W-NUMBER-OF-COPIES     TO LA-NO-OF-COPIES
  8074     MOVE W-AUTO-CLOSE-IND       TO LA-FINAL-ACT-IND
  8075     MOVE LTRIDI                 TO LA-FORM-A3
  8076     MOVE '4'                    TO LA-DATA-SOURCE
  8077     MOVE WS-CURRENT-BIN-DT      TO LA-CREATION-DATE
  8078     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES
  8079                                    LA-NO-OF-TEXT-RECORDS
  8080
  8081* EXEC CICS WRITE
  8082*         DATASET   ('ERARCH')
  8083*         FROM      (LETTER-ARCHIVE)
  8084*         RIDFLD    (LA-CONTROL-PRIMARY)
  8085*         RESP      (WS-RESPONSE)
  8086*    END-EXEC
  8087     MOVE LENGTH OF
  8088      LETTER-ARCHIVE
  8089       TO DFHEIV11
  8090     MOVE 'ERARCH' TO DFHEIV1
  8091*    MOVE '&$ L                  ''  N#00007455' TO DFHEIV0
  8092     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8093     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8094     MOVE X'204E233030303037343535' TO DFHEIV0(25:11)
  8095     CALL 'kxdfhei1' USING DFHEIV0,
  8096           DFHEIV1,
  8097           LETTER-ARCHIVE,
  8098           DFHEIV11,
  8099           LA-CONTROL-PRIMARY,
  8100           DFHEIV99,
  8101           DFHEIV99
  8102     MOVE EIBRESP  TO WS-RESPONSE
  8103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8104     IF RESP-NORMAL
  8105        display ' good write erarch '
  8106        MOVE ER-0280             TO EMI-ERROR
  8107        MOVE -1                  TO SIGREQL
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 142
* EL6318.cbl
  8108        PERFORM 9900-ERROR-FORMAT
  8109                                 THRU 9900-EXIT
  8110        MOVE W-ARCH-NUMBER       TO W-ARCH-SUPPRESS
  8111        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  8112     ELSE
  8113        MOVE ER-7345             TO EMI-ERROR
  8114        MOVE -1                  TO SIGREQL
  8115        PERFORM 9900-ERROR-FORMAT
  8116                                 THRU 9900-EXIT
  8117     END-IF
  8118     .
  8119 1000-EXIT.
  8120     EXIT.
  8121 1100-CALL-NS-BUS-LOGIC.
  8122     DISPLAY ' MADE IT TO 1100 '
  8123     MOVE SPACES                 TO BL-INPUT
  8124     MOVE W-ARCH-NUMBER          TO BL-ARCHIVE-NO
  8125     IF PI-RETURN-TO-PROGRAM EQUAL 'EL6314'
  8126         MOVE '2'                TO BL-DATA-SRCE
  8127         MOVE SPACES             TO BL-BATCH-NO
  8128         MOVE ZEROS              TO BL-BATCH-SEQ
  8129     ELSE
  8130         MOVE '4'                TO BL-DATA-SRCE
  8131         MOVE PB-ENTRY-BATCH     TO BL-BATCH-NO
  8132         MOVE PB-BATCH-SEQ-NO    TO BL-BATCH-SEQ
  8133     END-IF
  8134     MOVE PI-CARRIER             TO BL-CARRIER
  8135     MOVE PI-GROUPING            TO BL-GROUP
  8136     MOVE PI-STATE               TO BL-STATE
  8137     MOVE PI-ACCOUNT             TO BL-ACCOUNT
  8138     IF PI-CERT-EFF-DT NOT = LOW-VALUES
  8139        MOVE PI-CERT-EFF-DT      TO DC-BIN-DATE-1
  8140        MOVE ' '                 TO DC-OPTION-CODE
  8141        PERFORM 9700-date-link
  8142        IF NO-CONVERSION-ERROR
  8143           MOVE DC-GREG-DATE-B-EDIT
  8144                                 TO BL-EFF-DT
  8145        END-IF
  8146     END-IF
  8147     MOVE PI-CERT-NO             TO BL-CERT-NO
  8148     MOVE SPACES                 TO BL-RESP-NO
  8149     MOVE LTRIDI                 TO BL-LETTER-ID
  8150     MOVE W-NUMBER-OF-COPIES     TO BL-NO-OF-COPIES
  8151     MOVE PI-PROCESSOR-ID        TO BL-PROC-ID
  8152*    MOVE 'ALWA'                 TO BL-PROC-ID
  8153     MOVE PI-COMPANY-ID          TO BL-COMP-ID
  8154*    MOVE IFF-PRINT-NOW-SW       TO BL-PRINT-NOW-SW
  8155*    MOVE IFF-ENC-CD             TO BL-ENC-CD
  8156     MOVE PI-ENCCODE             TO BL-ENC-CD
  8157     IF EIBAID = DFHPF4
  8158        MOVE 'B'                 TO BL-WRITE-ERARCH
  8159     ELSE
  8160        MOVE 'T'                 TO BL-WRITE-ERARCH
  8161     END-IF
  8162     MOVE CERTIDI                TO BL-CERT-FORM-ID
  8163     MOVE W-ARCH-NUMBER          TO BL-ENDT-ARCH-NO
  8164     MOVE 'ISS ENDT'             TO BL-SOURCE-SCREEN
  8165     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 143
* EL6318.cbl
  8166        IF REACD-IN (S1) NOT = LOW-VALUES
  8167           MOVE REACD-IN (S1)    TO BL-REASON-CODE (S1)
  8168        END-IF
  8169     END-PERFORM
  8170    DISPLAY ' ABOUT TO LINK TO NSRASBL '
  8171*****************************************
  8172* Invoke the LETTER business logic
  8173*****************************************
  8174
  8175* exec cics link
  8176*       program('NSRASBL')
  8177*       commarea(srch-commarea)
  8178*    end-exec.
  8179     MOVE LENGTH OF
  8180      srch-commarea
  8181       TO DFHEIV11
  8182     MOVE 'NSRASBL' TO DFHEIV1
  8183*    MOVE '."C                   (   #00007531' TO DFHEIV0
  8184     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8185     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8186     MOVE X'2020233030303037353331' TO DFHEIV0(25:11)
  8187     CALL 'kxdfhei1' USING DFHEIV0,
  8188           DFHEIV1,
  8189           srch-commarea,
  8190           DFHEIV11,
  8191           DFHEIV99,
  8192           DFHEIV99,
  8193           DFHEIV99,
  8194           DFHEIV99
  8195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8196
  8197     DISPLAY ' MADE IT BACK FROM NSRASBL ' BL-STATUS ' '
  8198        BL-MESSAGE
  8199     .
  8200 1100-EXIT.
  8201     EXIT.
  8202 1500-GET-ARCH-NO.
  8203     display ' made it to 1500 '
  8204     MOVE SPACES                 TO ELCNTL-KEY
  8205     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  8206     MOVE '1'                    TO CNTL-REC-TYPE
  8207     MOVE ZEROS                  TO CNTL-SEQ
  8208
  8209* EXEC CICS READ
  8210*         DATASET    (WS-ELCNTL-FILE-ID)
  8211*         SET        (ADDRESS OF CONTROL-FILE)
  8212*         RIDFLD     (ELCNTL-KEY)
  8213*         UPDATE
  8214*         RESP       (WS-RESPONSE)
  8215*    END-EXEC
  8216*    MOVE '&"S        EU         (  N#00007546' TO DFHEIV0
  8217     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8218     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8219     MOVE X'204E233030303037353436' TO DFHEIV0(25:11)
  8220     CALL 'kxdfhei1' USING DFHEIV0,
  8221           WS-ELCNTL-FILE-ID,
  8222           DFHEIV20,
  8223           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 144
* EL6318.cbl
  8224           ELCNTL-KEY,
  8225           DFHEIV99,
  8226           DFHEIV99,
  8227           DFHEIV99
  8228     SET ADDRESS OF CONTROL-FILE TO
  8229         DFHEIV20
  8230     MOVE EIBRESP  TO WS-RESPONSE
  8231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8232     IF RESP-NORMAL
  8233        display ' good read elcntl '
  8234        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
  8235           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  8236        END-IF
  8237        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
  8238        MOVE CF-CREDIT-LAST-ARCH-NUM
  8239                                 TO W-ARCH-NUMBER
  8240        display ' new arch number ' w-arch-number
  8241
  8242* EXEC CICS REWRITE
  8243*          FROM      (CONTROL-FILE)
  8244*          DATASET   (WS-ELCNTL-FILE-ID)
  8245*       END-EXEC
  8246     MOVE LENGTH OF
  8247      CONTROL-FILE
  8248       TO DFHEIV11
  8249*    MOVE '&& L                  %   #00007562' TO DFHEIV0
  8250     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8251     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8252     MOVE X'2020233030303037353632' TO DFHEIV0(25:11)
  8253     CALL 'kxdfhei1' USING DFHEIV0,
  8254           WS-ELCNTL-FILE-ID,
  8255           CONTROL-FILE,
  8256           DFHEIV11,
  8257           DFHEIV99
  8258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8259     END-IF
  8260     .
  8261 1500-EXIT.
  8262     EXIT.
  8263
  8264
  8265 1700-WRITE-CERT-NOTE      SECTION.
  8266
  8267     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY.
  8268     MOVE ZERO           TO ERCNOT-SEQ.
  8269     SET TB-INDX         DOWN BY 1.
  8270     SET TB-INDX1        TO TB-INDX.
  8271
  8272****DELETE CURRENT CERT NOTES
  8273 1700-LOOP.
  8274
  8275* EXEC CICS READ
  8276*        DATASET (WS-ERCNOT-FILE-ID)
  8277*        RIDFLD  (ERCNOT-KEY)
  8278*        SET     (ADDRESS OF CERT-NOTE-FILE)
  8279*        RESP    (WS-RESPONSE)
  8280*        GTEQ
  8281*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 145
* EL6318.cbl
  8282*    MOVE '&"S        G          (  N#00007581' TO DFHEIV0
  8283     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8284     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8285     MOVE X'204E233030303037353831' TO DFHEIV0(25:11)
  8286     CALL 'kxdfhei1' USING DFHEIV0,
  8287           WS-ERCNOT-FILE-ID,
  8288           DFHEIV20,
  8289           DFHEIV99,
  8290           ERCNOT-KEY,
  8291           DFHEIV99,
  8292           DFHEIV99,
  8293           DFHEIV99
  8294     SET ADDRESS OF CERT-NOTE-FILE TO
  8295         DFHEIV20
  8296     MOVE EIBRESP  TO WS-RESPONSE
  8297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8298
  8299
  8300     IF NOT RESP-NORMAL
  8301        GO TO 1700-ENDDEL
  8302     END-IF
  8303
  8304     MOVE CZ-CONTROL-PRIMARY     TO ERCNOT-KEY.
  8305
  8306     IF ERCNOT-PARTIAL-KEY NOT = SV-PARTIAL-KEY
  8307         GO TO 1700-ENDDEL
  8308     END-IF.
  8309
  8310
  8311* EXEC CICS DELETE
  8312*        DATASET (WS-ERCNOT-FILE-ID)
  8313*        RIDFLD  (ERCNOT-KEY)
  8314*    END-EXEC.
  8315*    MOVE '&(  R                 &   #00007599' TO DFHEIV0
  8316     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  8317     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8318     MOVE X'2020233030303037353939' TO DFHEIV0(25:11)
  8319     CALL 'kxdfhei1' USING DFHEIV0,
  8320           WS-ERCNOT-FILE-ID,
  8321           ERCNOT-KEY,
  8322           DFHEIV99,
  8323           DFHEIV99,
  8324           DFHEIV99
  8325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8326
  8327
  8328     GO TO 1700-LOOP.
  8329
  8330 1700-ENDDEL.
  8331
  8332
  8333* EXEC CICS GETMAIN
  8334*         LENGTH(ERCNOT-LENGTH)
  8335*         SET(ADDRESS OF CERT-NOTE-FILE)
  8336*         INITIMG(GETMAIN-SPACE)
  8337*    END-EXEC.
  8338*    MOVE ',"IL                  $   #00007608' TO DFHEIV0
  8339     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 146
* EL6318.cbl
  8340     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8341     MOVE X'2020233030303037363038' TO DFHEIV0(25:11)
  8342     CALL 'kxdfhei1' USING DFHEIV0,
  8343           DFHEIV20,
  8344           ERCNOT-LENGTH,
  8345           GETMAIN-SPACE
  8346     SET ADDRESS OF CERT-NOTE-FILE TO
  8347         DFHEIV20
  8348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8349
  8350
  8351     SET TB-INDX TO 1.
  8352     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY
  8353     MOVE +0             TO ERCNOT-SEQ
  8354
  8355     PERFORM VARYING TB-INDX FROM 1 BY 1
  8356             UNTIL TB-INDX > TB-INDX1
  8357        MOVE SPACES                 TO  CERT-NOTE-FILE
  8358        ADD 1                       TO  ERCNOT-SEQ
  8359        MOVE ERCNOT-KEY             TO  CZ-CONTROL-PRIMARY
  8360        MOVE  'CZ'                  TO  CZ-RECORD-ID
  8361        MOVE CERT-NT-TEXT (TB-INDX) TO  CZ-NOTE
  8362        MOVE CERT-NT-LAST-MAINT-BY (TB-INDX)
  8363                                    TO  CZ-LAST-MAINT-USER
  8364        MOVE CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  8365                                    TO  CZ-LAST-MAINT-HHMMSS
  8366        MOVE CERT-NT-LAST-MAINT-DT (TB-INDX)
  8367                                    TO  CZ-LAST-MAINT-DT
  8368
  8369
  8370* EXEC CICS WRITE
  8371*            DATASET(WS-ERCNOT-FILE-ID)
  8372*            FROM(CERT-NOTE-FILE)
  8373*            RIDFLD(ERCNOT-KEY)
  8374*       END-EXEC
  8375     MOVE LENGTH OF
  8376      CERT-NOTE-FILE
  8377       TO DFHEIV11
  8378*    MOVE '&$ L                  ''   #00007632' TO DFHEIV0
  8379     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8380     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8381     MOVE X'2020233030303037363332' TO DFHEIV0(25:11)
  8382     CALL 'kxdfhei1' USING DFHEIV0,
  8383           WS-ERCNOT-FILE-ID,
  8384           CERT-NOTE-FILE,
  8385           DFHEIV11,
  8386           ERCNOT-KEY,
  8387           DFHEIV99,
  8388           DFHEIV99
  8389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8390     END-PERFORM
  8391
  8392     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  8393     IF RESP-NORMAL
  8394        EVALUATE CM-NOTE-SW
  8395           WHEN '1'
  8396           WHEN '3'
  8397           WHEN '5'
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 147
* EL6318.cbl
  8398           WHEN '7'
  8399              SET NO-CERT-RW     TO TRUE
  8400           WHEN ' '
  8401              MOVE '1'           TO CM-NOTE-SW
  8402           WHEN '2'
  8403              MOVE '3'           TO CM-NOTE-SW
  8404           WHEN '4'
  8405              MOVE '5'           TO CM-NOTE-SW
  8406           WHEN '6'
  8407              MOVE '7'           TO CM-NOTE-SW
  8408        END-EVALUATE
  8409     END-IF
  8410     IF NOT NO-CERT-RW
  8411        PERFORM 1810-REWRITE-ELCERT
  8412                                 THRU 1810-EXIT
  8413     ELSE
  8414
  8415* EXEC CICS UNLOCK
  8416*          DATASET    (WS-ELCERT-FILE-ID)
  8417*       END-EXEC
  8418*    MOVE '&*                    #   #00007661' TO DFHEIV0
  8419     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  8420     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8421     MOVE X'2020233030303037363631' TO DFHEIV0(25:11)
  8422     CALL 'kxdfhei1' USING DFHEIV0,
  8423           WS-ELCERT-FILE-ID,
  8424           DFHEIV99
  8425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8426     END-IF
  8427
  8428     .
  8429 1799-EXIT.
  8430     EXIT.
  8431
  8432 1800-READ-ELCERT-UPDATE.
  8433
  8434     MOVE PI-COMPANY-CD          TO  W-CERT-COMPANY-CD.
  8435     MOVE PI-CRTO-CARRIER        TO  W-CERT-CARRIER.
  8436     MOVE PI-CRTO-GROUPING       TO  W-CERT-GROUPING.
  8437     MOVE PI-CRTO-STATE          TO  W-CERT-STATE.
  8438     MOVE PI-CRTO-ACCOUNT        TO  W-CERT-ACCOUNT.
  8439     MOVE PI-CRTO-CERT-EFF-DT    TO  W-CERT-CERT-EFF-DT.
  8440     MOVE PI-CRTO-CERT-PRIME     TO  W-CERT-CERT-PRIME.
  8441     MOVE PI-CRTO-CERT-SFX       TO  W-CERT-CERT-SFX.
  8442
  8443
  8444* EXEC CICS READ
  8445*        UPDATE
  8446*        DATASET  (WS-ELCERT-FILE-ID)
  8447*        RIDFLD   (WS-ELCERT-KEY)
  8448*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8449*        RESP     (WS-RESPONSE)
  8450*    END-EXEC
  8451*    MOVE '&"S        EU         (  N#00007681' TO DFHEIV0
  8452     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8453     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8454     MOVE X'204E233030303037363831' TO DFHEIV0(25:11)
  8455     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 148
* EL6318.cbl
  8456           WS-ELCERT-FILE-ID,
  8457           DFHEIV20,
  8458           DFHEIV99,
  8459           WS-ELCERT-KEY,
  8460           DFHEIV99,
  8461           DFHEIV99,
  8462           DFHEIV99
  8463     SET ADDRESS OF CERTIFICATE-MASTER TO
  8464         DFHEIV20
  8465     MOVE EIBRESP  TO WS-RESPONSE
  8466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8467
  8468     .
  8469 1800-EXIT.
  8470     EXIT.
  8471
  8472 1810-REWRITE-ELCERT.
  8473
  8474
  8475* EXEC CICS REWRITE
  8476*        FROM     (CERTIFICATE-MASTER)
  8477*        DATASET  (WS-ELCERT-FILE-ID)
  8478*        RESP     (WS-RESPONSE)
  8479*    END-EXEC.
  8480     MOVE LENGTH OF
  8481      CERTIFICATE-MASTER
  8482       TO DFHEIV11
  8483*    MOVE '&& L                  %  N#00007695' TO DFHEIV0
  8484     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8485     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8486     MOVE X'204E233030303037363935' TO DFHEIV0(25:11)
  8487     CALL 'kxdfhei1' USING DFHEIV0,
  8488           WS-ELCERT-FILE-ID,
  8489           CERTIFICATE-MASTER,
  8490           DFHEIV11,
  8491           DFHEIV99
  8492     MOVE EIBRESP  TO WS-RESPONSE
  8493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8494
  8495
  8496     .
  8497 1810-EXIT.
  8498     EXIT.
  8499
  8500 8100-SEND-INITIAL-MAP.
  8501     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8502     MOVE '5'                    TO DC-OPTION-CODE.
  8503     PERFORM 9700-DATE-LINK.
  8504     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  8505     MOVE EIBTIME                TO TIME-IN.
  8506     MOVE TIME-OUT               TO TIMEO.
  8507     MOVE -1                     TO SIGREQL
  8508     IF PI-PROCESSOR-IS-CSR-SUPER
  8509        perform varying s1 from +1 by +1 until
  8510           s1 > +12
  8511           MOVE AL-UANON            TO reacda (s1)
  8512        end-perform
  8513     END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 149
* EL6318.cbl
  8514     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  8515     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O.
  8516
  8517* EXEC CICS SEND
  8518*        MAP      (MAP-NAME)
  8519*        MAPSET   (MAPSET-NAME)
  8520*        FROM     (EL631KO)
  8521*        ERASE
  8522*        CURSOR
  8523*    END-EXEC.
  8524     MOVE LENGTH OF
  8525      EL631KO
  8526       TO DFHEIV12
  8527     MOVE -1
  8528       TO DFHEIV11
  8529*    MOVE '8$     CT  E    H L F ,   #00007721' TO DFHEIV0
  8530     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  8531     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8532     MOVE X'2020233030303037373231' TO DFHEIV0(25:11)
  8533     CALL 'kxdfhei1' USING DFHEIV0,
  8534           MAP-NAME,
  8535           EL631KO,
  8536           DFHEIV12,
  8537           MAPSET-NAME,
  8538           DFHEIV99,
  8539           DFHEIV99,
  8540           DFHEIV99,
  8541           DFHEIV11,
  8542           DFHEIV99,
  8543           DFHEIV99,
  8544           DFHEIV99
  8545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8546
  8547     GO TO 9100-RETURN-TRAN.
  8548 8200-SEND-DATAONLY.
  8549     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8550     MOVE '5'                    TO DC-OPTION-CODE.
  8551     PERFORM 9700-DATE-LINK.
  8552     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  8553     MOVE EIBTIME                TO TIME-IN.
  8554     MOVE TIME-OUT               TO TIMEO.
  8555     MOVE -1                     TO PFENTRL
  8556     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O
  8557     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O
  8558
  8559* EXEC CICS SEND
  8560*        MAP      (MAP-NAME)
  8561*        MAPSET   (MAPSET-NAME)
  8562*        FROM     (EL631KO)
  8563*        DATAONLY
  8564*        ERASEAUP
  8565*        CURSOR
  8566*    END-EXEC.
  8567     MOVE LENGTH OF
  8568      EL631KO
  8569       TO DFHEIV12
  8570     MOVE -1
  8571       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 150
* EL6318.cbl
  8572*    MOVE '8$D    CT  A    H L F ,   #00007739' TO DFHEIV0
  8573     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  8574     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8575     MOVE X'2020233030303037373339' TO DFHEIV0(25:11)
  8576     CALL 'kxdfhei1' USING DFHEIV0,
  8577           MAP-NAME,
  8578           EL631KO,
  8579           DFHEIV12,
  8580           MAPSET-NAME,
  8581           DFHEIV99,
  8582           DFHEIV99,
  8583           DFHEIV99,
  8584           DFHEIV11,
  8585           DFHEIV99,
  8586           DFHEIV99,
  8587           DFHEIV99
  8588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8589
  8590     GO TO 9100-RETURN-TRAN.
  8591 8300-SEND-TEXT.
  8592
  8593* EXEC CICS SEND TEXT
  8594*        FROM     (LOGOFF-TEXT)
  8595*        LENGTH   (LOGOFF-LENGTH)
  8596*        ERASE
  8597*        FREEKB
  8598*    END-EXEC.
  8599*    MOVE '8&      T  E F  H   F -   #00007749' TO DFHEIV0
  8600     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  8601     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  8602     MOVE X'2020233030303037373439' TO DFHEIV0(25:11)
  8603     CALL 'kxdfhei1' USING DFHEIV0,
  8604           LOGOFF-TEXT,
  8605           LOGOFF-LENGTH,
  8606           DFHEIV99,
  8607           DFHEIV99,
  8608           DFHEIV99,
  8609           DFHEIV99,
  8610           DFHEIV99,
  8611           DFHEIV99,
  8612           DFHEIV99,
  8613           DFHEIV99,
  8614           DFHEIV99,
  8615           DFHEIV99
  8616     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8617
  8618
  8619* EXEC CICS RETURN
  8620*    END-EXEC.
  8621*    MOVE '.(                    ''   #00007755' TO DFHEIV0
  8622     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8623     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8624     MOVE X'2020233030303037373535' TO DFHEIV0(25:11)
  8625     CALL 'kxdfhei1' USING DFHEIV0,
  8626           DFHEIV99,
  8627           DFHEIV99,
  8628           DFHEIV99,
  8629           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 151
* EL6318.cbl
  8630           DFHEIV99,
  8631           DFHEIV99
  8632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8633
  8634 8800-UNAUTHORIZED-ACCESS.
  8635     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  8636     GO TO 8300-SEND-TEXT.
  8637 8810-PF23.
  8638     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  8639     MOVE XCTL-005               TO PGM-NAME.
  8640     GO TO 9300-XCTL.
  8641 9000-RETURN-CICS.
  8642
  8643* EXEC CICS RETURN
  8644*    END-EXEC.
  8645*    MOVE '.(                    ''   #00007765' TO DFHEIV0
  8646     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8647     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8648     MOVE X'2020233030303037373635' TO DFHEIV0(25:11)
  8649     CALL 'kxdfhei1' USING DFHEIV0,
  8650           DFHEIV99,
  8651           DFHEIV99,
  8652           DFHEIV99,
  8653           DFHEIV99,
  8654           DFHEIV99,
  8655           DFHEIV99
  8656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8657
  8658 9100-RETURN-TRAN.
  8659     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  8660     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
  8661
  8662* EXEC CICS RETURN
  8663*        TRANSID    (TRANS-ID)
  8664*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8665*        LENGTH     (PI-COMM-LENGTH)
  8666*    END-EXEC.
  8667*    MOVE '.(CT                  ''   #00007770' TO DFHEIV0
  8668     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  8669     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8670     MOVE X'2020233030303037373730' TO DFHEIV0(25:11)
  8671     CALL 'kxdfhei1' USING DFHEIV0,
  8672           TRANS-ID,
  8673           PROGRAM-INTERFACE-BLOCK,
  8674           PI-COMM-LENGTH,
  8675           DFHEIV99,
  8676           DFHEIV99,
  8677           DFHEIV99
  8678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8679
  8680 9200-RETURN-MAIN-MENU.
  8681     MOVE XCTL-626               TO PGM-NAME.
  8682     GO TO 9300-XCTL.
  8683 9300-XCTL.
  8684
  8685* EXEC CICS XCTL
  8686*        PROGRAM    (PGM-NAME)
  8687*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 152
* EL6318.cbl
  8688*        LENGTH     (PI-COMM-LENGTH)
  8689*    END-EXEC.
  8690*    MOVE '.$C                   %   #00007779' TO DFHEIV0
  8691     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8692     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8693     MOVE X'2020233030303037373739' TO DFHEIV0(25:11)
  8694     CALL 'kxdfhei1' USING DFHEIV0,
  8695           PGM-NAME,
  8696           PROGRAM-INTERFACE-BLOCK,
  8697           PI-COMM-LENGTH,
  8698           DFHEIV99
  8699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8700
  8701 9400-CLEAR.
  8702     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  8703
  8704* EXEC CICS XCTL
  8705*        PROGRAM    (PGM-NAME)
  8706*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8707*        LENGTH     (PI-COMM-LENGTH)
  8708*    END-EXEC.
  8709*    MOVE '.$C                   %   #00007786' TO DFHEIV0
  8710     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8711     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8712     MOVE X'2020233030303037373836' TO DFHEIV0(25:11)
  8713     CALL 'kxdfhei1' USING DFHEIV0,
  8714           PGM-NAME,
  8715           PROGRAM-INTERFACE-BLOCK,
  8716           PI-COMM-LENGTH,
  8717           DFHEIV99
  8718     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8719
  8720 9500-PF12.
  8721     MOVE XCTL-010               TO PGM-NAME.
  8722     GO TO 9300-XCTL.
  8723 9600-PGMID-ERROR.
  8724
  8725* EXEC CICS HANDLE CONDITION
  8726*        PGMIDERR    (8300-SEND-TEXT)
  8727*    END-EXEC.
  8728*    MOVE '"$L                   ! " #00007795' TO DFHEIV0
  8729     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  8730     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8731     MOVE X'2220233030303037373935' TO DFHEIV0(25:11)
  8732     CALL 'kxdfhei1' USING DFHEIV0
  8733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8734
  8735     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  8736     MOVE ' '                    TO PI-ENTRY-CD-1.
  8737     MOVE XCTL-005               TO PGM-NAME.
  8738     MOVE PGM-NAME               TO LOGOFF-PGM.
  8739     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  8740     GO TO 9300-XCTL.
  8741 9700-DATE-LINK.
  8742     MOVE LINK-ELDATCV           TO PGM-NAME.
  8743
  8744* EXEC CICS LINK
  8745*        PROGRAM    (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 153
* EL6318.cbl
  8746*        COMMAREA   (DATE-CONVERSION-DATA)
  8747*        LENGTH     (DC-COMM-LENGTH)
  8748*    END-EXEC.
  8749*    MOVE '."C                   (   #00007806' TO DFHEIV0
  8750     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8751     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8752     MOVE X'2020233030303037383036' TO DFHEIV0(25:11)
  8753     CALL 'kxdfhei1' USING DFHEIV0,
  8754           PGM-NAME,
  8755           DATE-CONVERSION-DATA,
  8756           DC-COMM-LENGTH,
  8757           DFHEIV99,
  8758           DFHEIV99,
  8759           DFHEIV99,
  8760           DFHEIV99
  8761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8762
  8763 9900-ERROR-FORMAT.
  8764     IF NOT EMI-ERRORS-COMPLETE
  8765        MOVE LINK-001            TO PGM-NAME
  8766
  8767* EXEC CICS LINK
  8768*           PROGRAM    (PGM-NAME)
  8769*           COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  8770*           LENGTH     (EMI-COMM-LENGTH)
  8771*       END-EXEC
  8772*    MOVE '."C                   (   #00007814' TO DFHEIV0
  8773     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8774     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8775     MOVE X'2020233030303037383134' TO DFHEIV0(25:11)
  8776     CALL 'kxdfhei1' USING DFHEIV0,
  8777           PGM-NAME,
  8778           ERROR-MESSAGE-INTERFACE-BLOCK,
  8779           EMI-COMM-LENGTH,
  8780           DFHEIV99,
  8781           DFHEIV99,
  8782           DFHEIV99,
  8783           DFHEIV99
  8784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8785     END-IF
  8786     .
  8787 9900-EXIT.
  8788     EXIT.
  8789 9990-ABEND.
  8790     MOVE LINK-004               TO PGM-NAME.
  8791     MOVE DFHEIBLK               TO EMI-LINE1.
  8792
  8793* EXEC CICS LINK
  8794*        PROGRAM   (PGM-NAME)
  8795*        COMMAREA  (EMI-LINE1)
  8796*        LENGTH    (72)
  8797*    END-EXEC.
  8798     MOVE 72
  8799       TO DFHEIV11
  8800*    MOVE '."C                   (   #00007826' TO DFHEIV0
  8801     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8802     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8803     MOVE X'2020233030303037383236' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 154
* EL6318.cbl
  8804     CALL 'kxdfhei1' USING DFHEIV0,
  8805           PGM-NAME,
  8806           EMI-LINE1,
  8807           DFHEIV11,
  8808           DFHEIV99,
  8809           DFHEIV99,
  8810           DFHEIV99,
  8811           DFHEIV99
  8812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8813
  8814     GO TO 8200-SEND-DATAONLY.
  8815
  8816* GOBACK.
  8817     MOVE '9%                    "   ' TO DFHEIV0
  8818     MOVE 'EL6318' TO DFHEIV1
  8819     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8820     GOBACK.
  8821 9995-SECURITY-VIOLATION.
  8822*                            COPY ELCSCTP.
  8823******************************************************************
  8824*                                                                *
  8825*                            ELCSCTP                             *
  8826*                            VMOD=2.001                          *
  8827*                                                                *
  8828*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  8829******************************************************************
  8830
  8831
  8832     MOVE EIBDATE          TO SM-JUL-DATE.
  8833     MOVE EIBTRMID         TO SM-TERMID.
  8834     MOVE THIS-PGM         TO SM-PGM.
  8835     MOVE EIBTIME          TO TIME-IN.
  8836     MOVE TIME-OUT         TO SM-TIME.
  8837     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  8838
  8839
  8840* EXEC CICS LINK
  8841*         PROGRAM  ('EL003')
  8842*         COMMAREA (SECURITY-MESSAGE)
  8843*         LENGTH   (80)
  8844*    END-EXEC.
  8845     MOVE 'EL003' TO DFHEIV1
  8846     MOVE 80
  8847       TO DFHEIV11
  8848*    MOVE '."C                   (   #00007851' TO DFHEIV0
  8849     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8850     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8851     MOVE X'2020233030303037383531' TO DFHEIV0(25:11)
  8852     CALL 'kxdfhei1' USING DFHEIV0,
  8853           DFHEIV1,
  8854           SECURITY-MESSAGE,
  8855           DFHEIV11,
  8856           DFHEIV99,
  8857           DFHEIV99,
  8858           DFHEIV99,
  8859           DFHEIV99
  8860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8861
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 155
* EL6318.cbl
  8862
  8863******************************************************************
  8864
  8865 9995-EXIT.
  8866     EXIT.
  8867
  8868 9999-DFHBACK SECTION.
  8869     MOVE '9%                    "   ' TO DFHEIV0
  8870     MOVE 'EL6318' TO DFHEIV1
  8871     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8872     GOBACK.
  8873 9999-DFHEXIT.
  8874     IF DFHEIGDJ EQUAL 0001
  8875         NEXT SENTENCE
  8876     ELSE IF DFHEIGDJ EQUAL 2
  8877         GO TO 8300-SEND-TEXT
  8878         DEPENDING ON DFHEIGDI.
  8879     MOVE '9%                    "   ' TO DFHEIV0
  8880     MOVE 'EL6318' TO DFHEIV1
  8881     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8882     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       34852     Code:       21014
