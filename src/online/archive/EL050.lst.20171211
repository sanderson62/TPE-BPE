* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    48* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    49* 051914  CR2014043000002  TANA  CHANGE EDIT FOR CANCEL DATE
    50* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    51* 091114  IR2014091000001  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
    52*                                CERT #, ADD 2898 FORCIBLE ERROR
    53* 072215  IR2015031000002  PEMA  CHG EDIT FOR ERROR 2889
    54* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    55* 013017  CR2016053100001  PEMA  ACH PROCESSING
    56* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
    57******************************************************************
    58 ENVIRONMENT DIVISION.
    59
    60 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page   3
* EL050.cbl
    62 WORKING-STORAGE SECTION.
    63 01  DFH-START PIC X(04).
    64
    65 77  FILLER   PIC X(32) VALUE '********************************'.
    66 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    67 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    68
    69 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    70 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    71                                   USAGE POINTER.
    72 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    73 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    74 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    75                                   USAGE IS POINTER.
    76 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    77 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    78                                   USAGE IS POINTER.
    79 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    80 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    81                                   USAGE IS POINTER.
    82
    83 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    84 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    85                                   USAGE IS POINTER.
    86
    87*    COPY ELC50WS.
    88*****************************************************************
    89*                                                               *
    90*                            ELC50WS.                           *
    91*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    92*                            VMOD=2.061.                        *
    93*                                                               *
    94*   THIS IS THE WORKING STORAGE FOR EL050                       *
    95*                                   EL517                       *
    96*****************************************************************
    97******************************************************************
    98*                   C H A N G E   L O G
    99*
   100* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   101*-----------------------------------------------------------------
   102*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   103* EFFECTIVE    NUMBER
   104*-----------------------------------------------------------------
   105* 123102                   PEMA  ADD DCC PROCESSING
   106* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
   107* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
   108* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
   109* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   110* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   111* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   112* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   113* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   114* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   115* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   116* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   117* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   118* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   119* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page   4
* EL050.cbl
   120* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   121* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   122* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   123* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   124* 030309  CR2009021700001  PEMA  ADD ER-2883
   125* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   126* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   127* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   128* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   129* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   130* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   131* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   132* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   133* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   134* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   135* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   136* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   137* 061412  CR2011022800001  AJRA  NAPERSOFT
   138* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   139* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   140* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   141* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   142* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   143* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   144* 040914  IR2014040900001  AJRA  ADD ERROR 2896
   145* 051914  CR2014043000002  TANA  ADD CAUSAL STATE AND ERROR 2897
   146* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   147* 091114  IR2014091000001  TANA  ADD ERROR 2898
   148* 121815  CR2015121700006  PEMA  ADD ERROR 3827
   149* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
   150* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
   151* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
   152* 100617  CR2017062000003  PEMA  Inforce state comm cap
   153*-----------------------------------------------------------------
   154
   155 01  WORK-AREAS.
   156
   157*****************************************************************
   158*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   159*****************************************************************
   160
   161     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   162     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   163     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   164     12  WS-NAME-EDIT-WORK-AREA.
   165         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   166         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   167             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   168         16  WS-WORK-NAME.
   169             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   170             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   171             20  FILLER           PIC X(10)     VALUE SPACES.
   172         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   173             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   174
   175*****************************************************************
   176*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   177*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page   5
* EL050.cbl
   178
   179     12  WS-ERRESC-KEY.
   180         16 WS-ERRESC-SEARCH-KEY.
   181             20  WS-ERRESC-COMPANY-CD PIC  X.
   182             20  WS-ERRESC-CARRIER    PIC  X.
   183             20  WS-ERRESC-GROUP      PIC X(6).
   184             20  WS-ERRESC-STATE      PIC XX.
   185             20  WS-ERRESC-ACCOUNT    PIC X(10).
   186         16 WS-ERRESC-RESIDUAL-KEY.
   187             20  WS-ERRESC-AGENT      PIC X(10).
   188             20  WS-ERRESC-RES-STATE  PIC XX.
   189             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   190*                                          YYYYMMDD
   191     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   192     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   193
   194*RESIDENT STATE TAX MASTER(ERRESS)
   195*
   196     12  WS-ERRESS-KEY.
   197         16  WS-ERRESS-COMPANY-CD      PIC  X.
   198         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   199         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   200         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   201*                                          YYYYMMDD
   202
   203     12  WS-CONTRACT-DATE              PIC 9(8).
   204*                                          YYYYMMDD
   205     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   206     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   207         16 WS-YEAR-YY                 PIC   9999.
   208         16 FILLER                     PIC 9(4).
   209*                                          YYYYMMDD
   210     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   211     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   212     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   213     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   214
   215     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   216         88  DPRB-1ST-TIME                      VALUE ' '.
   217
   218*****************************************************************
   219*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   220*****************************************************************
   221
   222     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   223     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   224     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   225     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   226     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   227     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   228     12  WS-ST-CAUSAL-STATE      PIC X          VALUE SPACES.
   229     12  ws-st-agent-sig-edit    pic x          value spaces.
   230     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   231     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   232     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   233     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   234         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   235         88 NO-AH-COVERAGE           VALUE '  ' '00'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page   6
* EL050.cbl
   236     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   237         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   238         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   239     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   240
   241     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   242     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   243
   244     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   245     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   246     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   247     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   248     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   249     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   250     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   251     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   252     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   253     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   254     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   255     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   256     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   257     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   258     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   259     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   260     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   261     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   262     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   263     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   264     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   265     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   266     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   267     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   268     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   269     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   270     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   271     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   272     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   273     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   274     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   275     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   276     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   277     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   278     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   279     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   280     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   281     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   282     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   283     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   284     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   285     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   286     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   287     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   288     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   289     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   290     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   291     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   292     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   293     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page   7
* EL050.cbl
   294     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   295     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   296     12  WS-2671-SW               PIC X         VALUE SPACE.
   297     12  WS-2672-SW               PIC X         VALUE SPACE.
   298     12  ws-9813-sw               pic x         value spaces.
   299     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   300         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   301     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   302         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   303     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   304
   305     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   306         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   307         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   308         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   309         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   310
   311     12  WS-CREDIT-EDIT-CONTROLS.
   312         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   313         16  WS-MIN-AGE           PIC 99                VALUE  0.
   314         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   315         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   316         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   317         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   318
   319     12  ws-vehicle-odometer     pic s9(7) comp-3 value +0.
   320     12  WS-AGE-FIELDS.
   321         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   322         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   323         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   324         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   325
   326     12  WS-SAVE-ALLOWABLE-BENEFIT.
   327         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   328         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   329         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   330         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   331         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   332         16  FILLER                      PIC XX.
   333
   334     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   335     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   336     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   337     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   338     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   339     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   340     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   341     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   342     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   343     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   344
   345     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   346     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   347     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   348     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   349     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   350     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   351     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page   8
* EL050.cbl
   352     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   353         88  WS-REDUCING              VALUE 'R'.
   354         88  WS-LEVEL                 VALUE 'L' 'P'.
   355     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   356
   357     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   358     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   359     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   360     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   361     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   362     12  ws-ah-max-bens           pic 99        value zeros.
   363     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   364     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   365     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   366     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   367
   368     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   369     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   370     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   371     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   372     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   373     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   374     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   375     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   376     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   377     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   378     12  WS-ACCT-SIG-SW.
   379         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   380         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   381     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   382     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   383     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   384     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   385     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   386     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   387     12  ws-cred-union-fees       pic s9(5)v99  comp-3 value +0.
   388     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   389     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   390     12  WS-INITIALS.
   391         16  WS-INIT-1            PIC X         VALUE SPACES.
   392         16  WS-INIT-2            PIC X         VALUE SPACES.
   393
   394     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   395     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   396     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   397     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   398     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   399*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   400     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   401     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   402     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   403     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   404     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   405     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   406     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   407     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   408     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   409     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page   9
* EL050.cbl
   410     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   411     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   412     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   413     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   414     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   415     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   416     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   417     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   418     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   419     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   420     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   421     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   422******** FLA
   423     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   424     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   425     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   426     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   427     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   428********
   429     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   430     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   431     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   432     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   433     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   434     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   435     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   436     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   437     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   438     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   439
   440     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   441         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   442                                         '0' THRU '9'.
   443
   444     12  NUMBER-OF-MONTHS.
   445         16  SK-MO OCCURS 12 TIMES PIC X.
   446
   447     12  WS-WORK-DATE.
   448         16  WS-YEAR            PIC 99    VALUE 00.
   449         16  WS-MONTH           PIC 99    VALUE 00.
   450         16  WS-DAY             PIC 99    VALUE 00.
   451
   452     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   453     12  WS-WORK-CRIT-DEV       REDEFINES
   454         WS-WORK-LF-CRIT-PER    PIC X(03).
   455
   456     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   457     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   458
   459     12  WS-WORK-DATE-FROM.
   460         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   461         16  FILLER             PIC X  VALUE SPACE.
   462         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   463         16  FILLER             PIC X         VALUE SPACE.
   464         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   465
   466     12  WS-WORK-DATE-THRU.
   467         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  10
* EL050.cbl
   468         16  FILLER             PIC X         VALUE SPACE.
   469         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   470         16  FILLER             PIC X         VALUE SPACE.
   471         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   472
   473     12  WS-LF-INPUT-CD.
   474         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   475         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   476
   477     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   478     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   479         16  WS-AH-INPUT-CD-1   PIC X.
   480         16  WS-AH-INPUT-CD-2-3 PIC XX.
   481
   482     12  WS-SWITCHES.
   483         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   484         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   485             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   486         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   487             88  BANK-ACCT-FOUND          VALUE 'Y'.
   488         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   489             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   490         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   491             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   492         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   493             88  COMP-MASTER-FOUND        VALUE 'Y'.
   494         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   495             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   496         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   497             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   498         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   499             88  STAT-MASTER-FOUND        VALUE 'Y'.
   500         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   501             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   502         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   503             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   504         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   505             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   506         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   507             88  FORM-MASTER-FOUND        VALUE 'Y'.
   508         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   509             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   510         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   511             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   512         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   513             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   514         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   515             88  NO-BENEFIT-FOUND         VALUE 'N'.
   516         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   517             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   518         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   519             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   520         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   521             88  AH-BENEFIT-FOUND         VALUE ' '.
   522             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   523         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   524             88  LF-BENEFIT-FOUND         VALUE ' '.
   525             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  11
* EL050.cbl
   526         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   527             88  NO-STATE-RECORD          VALUE '1'.
   528         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   529             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   530         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   531             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   532         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   533             88  CERT-WAS-FOUND           VALUE ' '.
   534             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   535         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   536             88  BROWSE-STARTED           VALUE 'Y'.
   537         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   538             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   539         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   540             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   541         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   542             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   543         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   544             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   545         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   546             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   547         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   548             88  APP-CERT-USED            VALUE 'Y' 'A'.
   549         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   550             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   551             88  FIRST-TIME-THROUGH       VALUE '1'.
   552             88  CTBL-NOT-FOUND           VALUE '2'.
   553
   554         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   555             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   556
   557         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   558             88  DLO-ERROR-FOUND          VALUE 'Y'.
   559
   560********FLA
   561     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   562     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   563********
   564     12  RC-SW-1                  PIC X           VALUE '0'.
   565     12  RC-SW-2                  PIC X           VALUE '0'.
   566     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   567     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   568     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   569     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   570     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   571     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   572     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   573     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   574     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   575     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   576     12  LIT-SPACES               PIC X           VALUE SPACES.
   577     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   578     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   579     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   580     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   581     12  erpndm-unlock-sw         pic x           value spaces.
   582         88  need-to-unlock-erpndm  value 'Y'.
   583     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  12
* EL050.cbl
   584     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   585     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   586         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   587         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   588     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   589         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   590
   591 01  WS-EXTRA-PERIODS-BY-STATE.
   592     12  WS-INT-PERIODS          PIC 9.
   593     12  WS-EXTRA-PMTS           PIC 9.
   594 01  ws-net-only-state           pic x value 'N'.
   595 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   596     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   597     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   598 01  WS-CRI-SSN-WORK-AREA.
   599     05  WS-CRI-SOC-SEC-NO.
   600         10  WS-SS-REPT-CD       PIC X(5).
   601         10  WS-SS-LAST-NAME     PIC X(5).
   602         10  WS-SS-INITIAL       PIC X.
   603
   604     05  WS-CRI-REPORT-CODE.
   605         10  FILLER              PIC X(5).
   606         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   607
   608     05  WS-CRI-LAST-NAME.
   609         10  WS-CRI-NAME-MOVE    PIC X(5).
   610         10  FILLER              PIC X(10).
   611
   612 01  ws-state-commission-caps.
   613     05  ws-sl-wk-rate           pic sv9(5) comp-3 value zeros.
   614     05  ws-jl-wk-rate           pic sv9(5) comp-3 value zeros.
   615     05  ws-sa-wk-rate           pic sv9(5) comp-3 value zeros.
   616     05  ws-ja-wk-rate           pic sv9(5) comp-3 value zeros.
   617     05  ws-ga-sl-wk-rate        pic sv9(5) comp-3 value zeros.
   618     05  ws-ga-jl-wk-rate        pic sv9(5) comp-3 value zeros.
   619     05  ws-ga-sa-wk-rate        pic sv9(5) comp-3 value zeros.
   620     05  ws-ga-ja-wk-rate        pic sv9(5) comp-3 value zeros.
   621     05  ws-tot-sl-wk-rate       pic sv9(5) comp-3 value zeros.
   622     05  ws-tot-jl-wk-rate       pic sv9(5) comp-3 value zeros.
   623     05  ws-tot-sa-wk-rate       pic sv9(5) comp-3 value zeros.
   624     05  ws-tot-ja-wk-rate       pic sv9(5) comp-3 value zeros.
   625     05  ws-st-cap-limit-to      pic x.
   626     05  ws-st-comm-cap-sl       pic s9v9(4) comp-3.
   627     05  ws-st-comm-cap-jl       pic s9v9(4) comp-3.
   628     05  ws-st-comm-cap-sa       pic s9v9(4) comp-3.
   629     05  ws-st-comm-cap-ja       pic s9v9(4) comp-3.
   630     05  ws-st-ga-comm-cap-sl    pic s9v9(4) comp-3.
   631     05  ws-st-ga-comm-cap-jl    pic s9v9(4) comp-3.
   632     05  ws-st-ga-comm-cap-sa    pic s9v9(4) comp-3.
   633     05  ws-st-ga-comm-cap-ja    pic s9v9(4) comp-3.
   634     05  ws-st-tot-comm-cap-sl   pic s9v9(4) comp-3.
   635     05  ws-st-tot-comm-cap-jl   pic s9v9(4) comp-3.
   636     05  ws-st-tot-comm-cap-sa   pic s9v9(4) comp-3.
   637     05  ws-st-tot-comm-cap-ja   pic s9v9(4) comp-3.
   638 01  WS-NUM-TABLE                PIC X(26)  VALUE
   639     '12345678012345070923456789'.
   640 01  FILLER REDEFINES WS-NUM-TABLE.
   641     05  WS-NUM OCCURS 26        PIC 9.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  13
* EL050.cbl
   642 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   643 01  V1                          PIC S999 COMP-3.
   644 01  V2                          PIC S999 COMP-3.
   645 01  V3                          PIC S999 COMP-3.
   646 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   647 01  FILLER REDEFINES WS-WORK-VIN.
   648     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   649 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   650 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   651 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   652 01  WS-HEX-WORK.
   653     05  FILLER                  PIC X  VALUE LOW-VALUES.
   654     05  WS-HEX-BYTE             PIC X.
   655 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   656 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   657 01  WS-WORK-HIN-ROW-B.
   658     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   659
   660 01  ws-benefit-cd-chg-sw      pic x value spaces.
   661     88  benefit-code-chg           value 'Y'.
   662 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   663 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   664     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   665 01  WS-ROW-D-TABLE.
   666     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   667
   668 01  WS-HIN-TABLE-B.
   669     05  F                       PIC XX VALUE 'A2'.
   670     05  F                       PIC XX VALUE 'B3'.
   671     05  F                       PIC XX VALUE 'C4'.
   672     05  F                       PIC XX VALUE 'D5'.
   673     05  F                       PIC XX VALUE 'E6'.
   674     05  F                       PIC XX VALUE 'F7'.
   675     05  F                       PIC XX VALUE 'G8'.
   676     05  F                       PIC XX VALUE 'H9'.
   677     05  F                       PIC XX VALUE 'I1'.
   678     05  F                       PIC XX VALUE 'J2'.
   679     05  F                       PIC XX VALUE 'K3'.
   680     05  F                       PIC XX VALUE 'L4'.
   681     05  F                       PIC XX VALUE 'M5'.
   682     05  F                       PIC XX VALUE 'N6'.
   683     05  F                       PIC XX VALUE 'O0'.
   684     05  F                       PIC XX VALUE 'P7'.
   685     05  F                       PIC XX VALUE 'Q0'.
   686     05  F                       PIC XX VALUE 'R8'.
   687     05  F                       PIC XX VALUE 'S9'.
   688     05  F                       PIC XX VALUE 'T2'.
   689     05  F                       PIC XX VALUE 'U3'.
   690     05  F                       PIC XX VALUE 'V4'.
   691     05  F                       PIC XX VALUE 'W5'.
   692     05  F                       PIC XX VALUE 'X6'.
   693     05  F                       PIC XX VALUE 'Y7'.
   694     05  F                       PIC XX VALUE 'Z8'.
   695 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   696     05  WS-VAL-IN               PIC X.
   697     05  WS-VAL-OUT              PIC 9.
   698 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   699 01  WS-COMPARE-BINARY-DATES.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  14
* EL050.cbl
   700     05  WS-971231                PIC XX VALUE X'92FF'.
   701     05  WS-931231                PIC XX VALUE X'8CFF'.
   702     05  WS-791231                PIC XX VALUE X'77FF'.
   703     05  WS-771001                PIC XX VALUE X'74A1'.
   704     05  WS-820301                PIC XX VALUE X'7B41'.
   705     05  WS-831031                PIC XX VALUE X'7DBF'.
   706     05  WS-831231                PIC XX VALUE X'7DFF'.
   707     05  WS-810831                PIC XX VALUE X'7A7F'.
   708     05  WS-830901                PIC XX VALUE X'7D81'.
   709
   710 01  FILE-ACCESS-IDS.
   711     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   712     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   713     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   714     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   715     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   716     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   717     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   718     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   719     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   720     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   721     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   722     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   723     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   724     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   725     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   726     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   727     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   728 01  DD-IU-SW                    PIC X   VALUE ' '.
   729     88  DD-IU-PRESENT                 VALUE 'Y'.
   730
   731 01  ACCESS-KEYS.
   732     12  ELMSTR-KEY.
   733         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   734         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   735     12  W-CLAIM-KEY.
   736         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   737         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   738
   739     12  ELCNTL-KEY.
   740         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   741         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   742         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   743         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   744
   745     12  ELCERT-KEY.
   746         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   747         16  CERT-CARRIER         PIC X       VALUE SPACE.
   748         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   749         16  CERT-STATE           PIC XX      VALUE SPACES.
   750         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   751         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   752         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   753
   754     12  ELCERT2-KEY.
   755         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   756         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   757
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  15
* EL050.cbl
   758     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   759
   760     12  ELCERT-SAVE.
   761         16  FILLER                      PIC XX    VALUE SPACES.
   762
   763         16  WCS-CONTROL-PRIMARY.
   764             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   765             20  WCS-CARRIER             PIC X     VALUE SPACE.
   766             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   767             20  WCS-STATE               PIC XX    VALUE SPACES.
   768             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   769             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   770             20  WCS-CERT-NO.
   771                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   772                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   773
   774         16  CS-CONTROL-BY-NAME.
   775             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   776             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   777             20  CS-INSURED-INITIALS.
   778                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   779                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   780
   781         16  CS-CONTROL-BY-SSN.
   782             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   783             20  CS-SOC-SEC-NO.
   784                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   785                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   786                 24  CS-SSN-LN3.
   787                     28 CS-INSURED-INITIALS-A2   PIC XX
   788                                     VALUE SPACES.
   789                     28 CS-PART-LAST-NAME-A2     PIC X
   790                                     VALUE SPACE.
   791
   792         16  CS-CONTROL-BY-CERT-NO.
   793             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   794             20  CS-CERT-NO-A4           PIC X(11)
   795                                     VALUE SPACES.
   796
   797         16  CS-CONTROL-BY-MEMB.
   798             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   799             20  CS-MEMBER-NO.
   800                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   801                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   802                 24  CS-MEMB-LN4.
   803                     28 CS-INSURED-INITIALS-A5   PIC XX
   804                                      VALUE SPACES.
   805                     28 CS-PART-LAST-NAME-A5     PIC XX
   806                                      VALUE SPACES.
   807
   808         16  FILLER              PIC X(360) VALUE SPACES.
   809
   810     12  ERACCT-KEY.
   811         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   812         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   813         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   814         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   815         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  16
* EL050.cbl
   816         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   817
   818     12  ERCOMP-KEY.
   819         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   820         16  COMP-CARRIER         PIC X     VALUE SPACES.
   821         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   822         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   823         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   824         16  COMP-TYPE            PIC X     VALUE SPACES.
   825
   826     12  ERLOFC-KEY.
   827         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   828         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   829         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   830         16  LOFC-STATE           PIC XX    VALUE SPACES.
   831         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   832         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   833
   834     12  WS-ELCRTT-KEY.
   835         16  WS-ELCRTT-PRIMARY       PIC X(33).
   836         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   837
   838     12  ERBXRF-KEY.
   839         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   840         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   841         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   842         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   843
   844     12  ERAGTC-KEY.
   845         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   846         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   847         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   848         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   849         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   850         16  AGTC-TYPE            PIC X     VALUE SPACES.
   851
   852     12  ERPLAN-KEY.
   853         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   854         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   855         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   856         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   857         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   858         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   859         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   860         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   861
   862     12  ERFORM-KEY.
   863         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   864         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   865         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   866         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   867
   868     12  ERREIN-KEY.
   869         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   870         16  REIN-TYPE            PIC X     VALUE SPACES.
   871         16  REIN-TABLE-CO.
   872             20  REIN-CODE-1      PIC X     VALUE SPACE.
   873             20  REIN-CODE-2      PIC X     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  17
* EL050.cbl
   874             20  REIN-CODE-3      PIC X     VALUE SPACE.
   875         16  FILLER               PIC X(3)  VALUE SPACES.
   876
   877     12  ERCTBL-KEY.
   878         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   879         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   880         16  CTBL-CNTRL-2.
   881             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   882             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   883
   884     12  ELCRTO-KEY.
   885         16  ELCRTO-COMPANY-CD       PIC X.
   886         16  ELCRTO-CARRIER          PIC X.
   887         16  ELCRTO-GROUPING         PIC X(6).
   888         16  ELCRTO-STATE            PIC XX.
   889         16  ELCRTO-ACCOUNT          PIC X(10).
   890         16  ELCRTO-CERT-EFF-DT      PIC XX.
   891         16  ELCRTO-CERT-NO.
   892             20  ELCRTO-CERT-PRIME   PIC X(10).
   893             20  ELCRTO-CERT-SFX     PIC X.
   894         16  ELCRTO-RECORD-TYPE      PIC X.
   895         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   896
   897
   898     12  WS-ACCESS.
   899         16  FILLER               PIC XX    VALUE SPACES.
   900         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   901
   902     12  WS-CARR-ACCESS.
   903         16  FILLER               PIC X(3)  VALUE SPACES.
   904         16  WS-CARR              PIC X     VALUE SPACE.
   905*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   906*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   907     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   908         88  WS-DMD-LF-RATING   VALUE 'Y'.
   909         88  WS-DMD-AH-RATING   VALUE 'Y'.
   910         88  WS-DMD-NO-RATING   VALUE 'N'.
   911
   912     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   913         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   914                                         'NJ' 'NL'
   915                                         'PJ' 'PL'
   916                                         'SJ' 'SL'.
   917     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   918         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   919                                         'NI' 'NJ' 'NL' 'NU'
   920                                         'PJ' 'PL' 'PI' 'PU'
   921                                         'SI' 'SJ' 'SL' 'SU'
   922                                         'MX' 'MY' 'MZ'.
   923 01  ERPDEF-KEY-SAVE             PIC X(18).
   924 01  ERPDEF-KEY.
   925     12  ERPDEF-COMPANY-CD       PIC X.
   926     12  ERPDEF-STATE            PIC XX.
   927     12  ERPDEF-PROD-CD          PIC XXX.
   928     12  F                       PIC X(7).
   929     12  ERPDEF-BEN-TYPE         PIC X.
   930     12  ERPDEF-BEN-CODE         PIC XX.
   931     12  ERPDEF-EXP-DT           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  18
* EL050.cbl
   932
   933 01  ELSTAT-KEY-SAVE             PIC X(20).
   934 01  ELSTAT-KEY.
   935     12  ELSTAT-COMPANY-ID       PIC XXX.
   936     12  ELSTAT-CARRIER          PIC X.
   937     12  ELSTAT-GROUP            PIC X(6).
   938     12  ELSTAT-STATE            PIC XX.
   939     12  ELSTAT-EXP-DT           PIC 9(8).
   940 01  WS-ERROR-VALUES.
   941     12  ER-1570                     PIC S9(4)   VALUE +1570.
   942     12  ER-1571                     PIC S9(4)   VALUE +1571.
   943     12  er-1572                     pic s9(4)   value +1572.
   944     12  er-1573                     pic s9(4)   value +1573.
   945     12  er-1574                     pic s9(4)   value +1574.
   946     12  ER-1575                     PIC S9(4)   VALUE +1575.
   947     12  er-1576                     pic s9(4)   value +1576.
   948     12  er-1583                     pic s9(4)   value +1583.
   949     12  er-1743                     pic s9(4)   value +1743.
   950     12  er-1744                     pic s9(4)   value +1744.
   951     12  er-1745                     pic s9(4)   value +1745.
   952     12  er-1746                     pic s9(4)   value +1746.
   953     12  er-1747                     pic s9(4)   value +1747.
   954     12  er-1748                     pic s9(4)   value +1748.
   955     12  ER-1891                     PIC S9(4)   VALUE +1891.
   956     12  ER-1892                     PIC S9(4)   VALUE +1892.
   957     12  ER-1893                     PIC S9(4)   VALUE +1893.
   958     12  ER-1894                     PIC S9(4)   VALUE +1894.
   959     12  ER-1895                     PIC S9(4)   VALUE +1895.
   960     12  ER-1896                     PIC S9(4)   VALUE +1896.
   961     12  ER-1897                     PIC S9(4)   VALUE +1897.
   962     12  ER-1898                     PIC S9(4)   VALUE +1898.
   963     12  ER-1899                     PIC S9(4)   VALUE +1899.
   964     12  ER-1900                     PIC S9(4)   VALUE +1900.
   965     12  ER-1901                     PIC S9(4)   VALUE +1901.
   966     12  ER-1902                     PIC S9(4)   VALUE +1902.
   967     12  ER-1903                     PIC S9(4)   VALUE +1903.
   968     12  ER-1904                     PIC S9(4)   VALUE +1904.
   969     12  ER-1905                     PIC S9(4)   VALUE +1905.
   970     12  ER-1906                     PIC S9(4)   VALUE +1906.
   971     12  ER-1907                     PIC S9(4)   VALUE +1907.
   972     12  ER-1909                     PIC S9(4)   VALUE +1909.
   973     12  ER-1910                     PIC S9(4)   VALUE +1910.
   974     12  ER-1911                     PIC S9(4)   VALUE +1911.
   975     12  ER-1912                     PIC S9(4)   VALUE +1912.
   976     12  ER-1913                     PIC S9(4)   VALUE +1913.
   977     12  ER-1914                     PIC S9(4)   VALUE +1914.
   978     12  ER-1915                     PIC S9(4)   VALUE +1915.
   979     12  ER-1916                     PIC S9(4)   VALUE +1916.
   980     12  ER-1917                     PIC S9(4)   VALUE +1917.
   981     12  ER-1918                     PIC S9(4)   VALUE +1918.
   982     12  ER-1919                     PIC S9(4)   VALUE +1919.
   983     12  ER-1920                     PIC S9(4)   VALUE +1920.
   984     12  ER-1921                     PIC S9(4)   VALUE +1921.
   985     12  ER-1922                     PIC S9(4)   VALUE +1922.
   986     12  ER-1923                     PIC S9(4)   VALUE +1923.
   987     12  ER-1924                     PIC S9(4)   VALUE +1924.
   988     12  ER-1925                     PIC S9(4)   VALUE +1925.
   989     12  ER-1926                     PIC S9(4)   VALUE +1926.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  19
* EL050.cbl
   990     12  ER-1927                     PIC S9(4)   VALUE +1927.
   991     12  ER-1955                     PIC s9(4)   VALUE +1955.
   992     12  ER-1956                     PIC s9(4)   VALUE +1956.
   993     12  ER-1957                     PIC s9(4)   VALUE +1957.
   994     12  ER-1958                     PIC s9(4)   VALUE +1958.
   995     12  ER-1959                     PIC s9(4)   VALUE +1959.
   996     12  ER-1960                     PIC s9(4)   VALUE +1960.
   997     12  ER-1961                     PIC s9(4)   VALUE +1961.
   998     12  ER-1962                     PIC s9(4)   VALUE +1962.
   999     12  ER-1963                     PIC s9(4)   VALUE +1963.
  1000     12  ER-2393                     PIC S9(4)   VALUE +2393.
  1001     12  ER-2600                     PIC S9(4)   VALUE +2600.
  1002     12  ER-2601                     PIC S9(4)   VALUE +2601.
  1003     12  ER-2602                     PIC S9(4)   VALUE +2602.
  1004     12  ER-2603                     PIC S9(4)   VALUE +2603.
  1005     12  ER-2604                     PIC S9(4)   VALUE +2604.
  1006     12  ER-2605                     PIC S9(4)   VALUE +2605.
  1007     12  ER-2606                     PIC S9(4)   VALUE +2606.
  1008     12  ER-2607                     PIC S9(4)   VALUE +2607.
  1009     12  ER-2608                     PIC S9(4)   VALUE +2608.
  1010     12  ER-2609                     PIC S9(4)   VALUE +2609.
  1011     12  ER-2610                     PIC S9(4)   VALUE +2610.
  1012     12  ER-2611                     PIC S9(4)   VALUE +2611.
  1013     12  ER-2612                     PIC S9(4)   VALUE +2612.
  1014     12  ER-2613                     PIC S9(4)   VALUE +2613.
  1015     12  ER-2614                     PIC S9(4)   VALUE +2614.
  1016     12  ER-2615                     PIC S9(4)   VALUE +2615.
  1017     12  ER-2616                     PIC S9(4)   VALUE +2616.
  1018     12  ER-2617                     PIC S9(4)   VALUE +2617.
  1019     12  ER-2618                     PIC S9(4)   VALUE +2618.
  1020     12  ER-2619                     PIC S9(4)   VALUE +2619.
  1021     12  ER-2620                     PIC S9(4)   VALUE +2620.
  1022     12  ER-2621                     PIC S9(4)   VALUE +2621.
  1023     12  ER-2622                     PIC S9(4)   VALUE +2622.
  1024     12  ER-2623                     PIC S9(4)   VALUE +2623.
  1025     12  ER-2624                     PIC S9(4)   VALUE +2624.
  1026     12  ER-2625                     PIC S9(4)   VALUE +2625.
  1027     12  ER-2626                     PIC S9(4)   VALUE +2626.
  1028     12  ER-2627                     PIC S9(4)   VALUE +2627.
  1029     12  ER-2628                     PIC S9(4)   VALUE +2628.
  1030     12  ER-2629                     PIC S9(4)   VALUE +2629.
  1031     12  ER-2630                     PIC S9(4)   VALUE +2630.
  1032     12  ER-2631                     PIC S9(4)   VALUE +2631.
  1033     12  ER-2632                     PIC S9(4)   VALUE +2632.
  1034     12  ER-2633                     PIC S9(4)   VALUE +2633.
  1035     12  ER-2634                     PIC S9(4)   VALUE +2634.
  1036     12  ER-2635                     PIC S9(4)   VALUE +2635.
  1037     12  ER-2636                     PIC S9(4)   VALUE +2636.
  1038     12  ER-2637                     PIC S9(4)   VALUE +2637.
  1039     12  ER-2638                     PIC S9(4)   VALUE +2638.
  1040     12  ER-2639                     PIC S9(4)   VALUE +2639.
  1041     12  ER-2640                     PIC S9(4)   VALUE +2640.
  1042     12  ER-2641                     PIC S9(4)   VALUE +2641.
  1043     12  ER-2642                     PIC S9(4)   VALUE +2642.
  1044     12  ER-2643                     PIC S9(4)   VALUE +2643.
  1045     12  ER-2644                     PIC S9(4)   VALUE +2644.
  1046     12  ER-2645                     PIC S9(4)   VALUE +2645.
  1047     12  ER-2646                     PIC S9(4)   VALUE +2646.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  20
* EL050.cbl
  1048     12  ER-2647                     PIC S9(4)   VALUE +2647.
  1049     12  ER-2648                     PIC S9(4)   VALUE +2648.
  1050     12  ER-2649                     PIC S9(4)   VALUE +2649.
  1051     12  ER-2650                     PIC S9(4)   VALUE +2650.
  1052     12  ER-2651                     PIC S9(4)   VALUE +2651.
  1053     12  ER-2652                     PIC S9(4)   VALUE +2652.
  1054     12  ER-2653                     PIC S9(4)   VALUE +2653.
  1055     12  ER-2654                     PIC S9(4)   VALUE +2654.
  1056     12  ER-2655                     PIC S9(4)   VALUE +2655.
  1057     12  ER-2656                     PIC S9(4)   VALUE +2656.
  1058     12  ER-2657                     PIC S9(4)   VALUE +2657.
  1059     12  ER-2658                     PIC S9(4)   VALUE +2658.
  1060     12  ER-2659                     PIC S9(4)   VALUE +2659.
  1061     12  ER-2660                     PIC S9(4)   VALUE +2660.
  1062     12  ER-2661                     PIC S9(4)   VALUE +2661.
  1063     12  ER-2662                     PIC S9(4)   VALUE +2662.
  1064     12  ER-2663                     PIC S9(4)   VALUE +2663.
  1065     12  ER-2664                     PIC S9(4)   VALUE +2664.
  1066     12  ER-2665                     PIC S9(4)   VALUE +2665.
  1067     12  ER-2666                     PIC S9(4)   VALUE +2666.
  1068     12  ER-2667                     PIC S9(4)   VALUE +2667.
  1069     12  ER-2668                     PIC S9(4)   VALUE +2668.
  1070     12  ER-2669                     PIC S9(4)   VALUE +2669.
  1071     12  ER-2670                     PIC S9(4)   VALUE +2670.
  1072     12  ER-2671                     PIC S9(4)   VALUE +2671.
  1073     12  ER-2672                     PIC S9(4)   VALUE +2672.
  1074     12  ER-2673                     PIC S9(4)   VALUE +2673.
  1075     12  ER-2674                     PIC S9(4)   VALUE +2674.
  1076     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1077     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1078     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1079     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1080     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1081     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1082     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1083     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1084     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1085     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1086     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1087     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1088     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1089     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1090     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1091     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1092     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1093     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1094     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1095     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1096     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1097     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1098     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1099     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1100     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1101     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1102     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1103     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1104     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1105     12  ER-2704                     PIC S9(4)   VALUE +2704.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  21
* EL050.cbl
  1106     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1107     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1108     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1109     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1110     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1111     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1112     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1113     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1114     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1115     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1116     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1117     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1118     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1119     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1120     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1121     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1122     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1123     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1124     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1125     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1126     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1127     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1128     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1129     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1130     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1131     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1132     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1133     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1134     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1135     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1136     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1137     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1138     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1139     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1140     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1141     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1142     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1143     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1144     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1145     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1146     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1147     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1148     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1149     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1150     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1151     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1152     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1153     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1154     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1155     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1156     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1157     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1158     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1159     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1160     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1161     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1162     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1163     12  ER-2772                     PIC S9(4)   VALUE +2772.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  22
* EL050.cbl
  1164     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1165     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1166     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1167     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1168     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1169     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1170     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1171     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1172     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1173     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1174     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1175     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1176     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1177     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1178     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1179     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1180     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1181     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1182     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1183     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1184     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1185     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1186     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1187     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1188     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1189     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1190     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1191     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1192     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1193     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1194     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1195     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1196     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1197     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1198     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1199     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1200     12  ER-2896                     PIC S9(4)   VALUE +2896.
  1201     12  ER-2897                     PIC S9(4)   VALUE +2897.
  1202     12  ER-2898                     PIC S9(4)   VALUE +2898.
  1203     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1204     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1205     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1206     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1207     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1208     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1209     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1210     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1211     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1212     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1213     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1214     12  ER-3059                     PIC S9(4)   VALUE +3059.
  1215     12  ER-3060                     PIC S9(4)   VALUE +3060.
  1216     12  ER-3061                     PIC S9(4)   VALUE +3061.
  1217     12  ER-3062                     PIC S9(4)   VALUE +3062.
  1218     12  ER-3063                     PIC S9(4)   VALUE +3063.
  1219     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1220     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1221     12  ER-3782                     PIC S9(4)   VALUE +3782.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  23
* EL050.cbl
  1222     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1223     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1224     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1225     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1226     12  ER-3827                     PIC S9(4)   VALUE +3827.
  1227     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1228     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1229     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1230     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1231     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1232     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1233     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1234     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1235     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1236     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1237     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1238     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1239     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1240     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1241     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1242     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1243     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1244     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1245     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1246     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1247     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1248     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1249     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1250     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1251     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1252     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1253     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1254     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1255     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1256     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1257     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1258     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1259     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1260     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1261     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1262     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1263     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1264     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1265     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1266     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1267     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1268     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1269     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1270     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1271     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1272     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1273     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1274     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1275     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1276     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1277     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1278     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1279     12  ER-8094                     PIC S9(4)   VALUE +8094.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  24
* EL050.cbl
  1280     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1281     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1282     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1283     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1284     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1285     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1286     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1287     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1288     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1289     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1290     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1291     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1292     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1293     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1294     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1295     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1296     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1297     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1298     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1299     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1300     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1301     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1302     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1303     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1304     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1305     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1306     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1307     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1308     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1309     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1310     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1311     12  ER-9813                     PIC S9(4)   VALUE +9813.
  1312     12  er-9823                     pic s9(4)   value +9823.
  1313     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1314******************************************************************
  1315***************   END OF ELC50WS     ****************************
  1316******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  25
* EL050.cbl
  1319 01  WORKING-STORAGE-WORK-AREAS.
  1320     12  WS-RESPONSE             PIC S9(8)  COMP.
  1321         88  WS-RESP-NORMAL           VALUE +00.
  1322         88  WS-RESP-ERROR            VALUE +01.
  1323         88  WS-RESP-NOTFND           VALUE +13.
  1324         88  WS-RESP-DUPREC           VALUE +14.
  1325         88  WS-RESP-ENDFILE          VALUE +20.
  1326     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1327     12  WORK-AREAS.
  1328         16  WK-CONV-GREG.
  1329             24  WCG-CENT             PIC XX.
  1330             24  WCG-REST             PIC X(4).
  1331         16  WORK-GREGORIAN-DATE.
  1332             24  WK-GREG-CENT         PIC XX.
  1333             24  WK-GREG-DATE-YYMMDD.
  1334                 28  WK-GREG-YYMM     PIC X(4).
  1335                 28  WK-GREG-DD       PIC XX.
  1336
  1337         16  WORK-SELECT-DATE.
  1338             24  WK-SELECT-CENT            PIC XX.
  1339             24  WK-SELECT-DATE-YYMMDD.
  1340                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1341                 28  FILLER                PIC XX.
  1342
  1343         16  WK-FORM-NO.
  1344             24  WK-FORM-BANK-ID       PIC X(5).
  1345             24  WK-FORM-UNDRWRTR      PIC X(1).
  1346             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1347
  1348         16  WK-MEMBER-NO.
  1349             24  WK-MEMBER-1-6        PIC X(6).
  1350             24  WK-MEMBER-7-12       PIC X(6).
  1351
  1352         16  WK-FULL-CERT-NO.
  1353             24  WK-CERT-POS-1-2      PIC X(2).
  1354             24  WK-CERT-POS-3        PIC X(1).
  1355             24  WK-CERT-POS-4        PIC X(1).
  1356             24  WK-CERT-POS-5-6      PIC X(2).
  1357             24  WK-CERT-POS-7        PIC X(1).
  1358             24  WK-CERT-POS-8-11     PIC X(4).
  1359
  1360         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1361             88  VALID-RATE-CODE        VALUE 'Y'.
  1362             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1363
  1364         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1365         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1366         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1367         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1368         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1369         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1370         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1371         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1372         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1373         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1374
  1375* DLO001
  1376 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  26
* EL050.cbl
  1377     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1378     12  DMPF-RETURN-CODE          PIC XX.
  1379         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1380         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1381         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1382         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1383         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1384         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1385
  1386* DLO002
  1387 01  WS-DLO-INTERNAL-POLICY-FORM.
  1388     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1389     12  DIPF-RETURN-CODE          PIC XX.
  1390         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1391         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1392         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1393         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1394         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1395         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1396
  1397* DLO003
  1398 01  WS-DLO-VALID-BANK-ID.
  1399     12  DVBI-BANK-ID              PIC X(5).
  1400     12  DVBI-BANK-ID-TYPE         PIC X.
  1401         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1402         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1403         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1404         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1405         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1406     12  DVBI-RETURN-CODE          PIC XX.
  1407         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1408         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1409         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1410         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1411         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1412         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1413         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1414         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1415         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1416
  1417* DLO007
  1418 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1419     12  DCUA-RES-STATE            PIC XX.
  1420     12  DCUA-BEN-TYPE             PIC XX.
  1421     12  DCUA-SYS-IDENT            PIC X.
  1422         88  DCUA-CLAIM                        VALUE 'C'.
  1423         88  DCUA-PREMIUM                      VALUE 'P'.
  1424     12  DCUA-COVERAGE-RULE        PIC X.
  1425     12  DCUA-CLIENT-ID            PIC X(10).
  1426     12  DCUA-EFF-DATE             PIC X(8).
  1427     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1428     12  DCUA-RETURN-CODE          PIC XX.
  1429         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1430     12  DCUA-CERT-NUMBER          PIC X(11).
  1431     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1432     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1433
  1434* DLO011
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  27
* EL050.cbl
  1435 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1436     12  DPRB-RATE-CODE            PIC X(4).
  1437     12  DPRB-COVERAGE-CATEG       PIC X.
  1438     12  DPRB-RETURN-CODE          PIC XX.
  1439         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1440         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1441         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1442         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1443         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1444         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1445         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1446         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1447         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1448     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1449     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1450     12  DPRB-BEN-TYPE             PIC XX.
  1451
  1452* DLO017
  1453 01  WS-DLO-VALID-RATE-CODE.
  1454     12  DVRC-RATE-CODE            PIC X(4).
  1455     12  DVRC-RETURN-CODE          PIC XX.
  1456         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1457         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1458         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1459         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1460         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1461         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1462
  1463* DLO019
  1464 01  WS-DLO-ORIG-COV-CAT.
  1465     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1466     12  DOCC-RETURN-CODE          PIC XX.
  1467     12  DOCC-ORIG-COV-CAT         PIC X.
  1468     12  DOCC-UNDERWITER           PIC XX.
  1469     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1470     12  DOCC-FILLER               PIC X(6).
  1471
  1472* DLO021
  1473 01  WS-DLO-VALID-LOAN-OFFICER.
  1474     12  DVLO-LOAN-OFFICER.
  1475         16  DVLO-BILL-TYPE        PIC X.
  1476         16  DVLO-BILL-SOURCE      PIC X.
  1477         16  DVLO-BATCH-TYPE       PIC X.
  1478     12  DVLO-RETURN-CODE          PIC XX.
  1479         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1480         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1481         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1482         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1483         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1484         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1485
  1486* DLO022
  1487 01  WS-DLO-VALID-STATE-CODE.
  1488     12  DVSC-STATE-CODE           PIC XX.
  1489     12  DVSC-RETURN-CODE          PIC XX.
  1490         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1491
  1492* DLO023
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  28
* EL050.cbl
  1493 01  WS-DLO-VALID-CODE-VALUES.
  1494     12  DVCV-SYSTEM-ID            PIC XX.
  1495         88  DVCV-CLAIMS                       VALUE 'CL'.
  1496         88  DVCV-CREDIT                       VALUE 'CR'.
  1497     12  DVCV-RECORD-TYPE          PIC XX.
  1498         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1499         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1500         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1501         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1502         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1503         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1504         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1505         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1506     12  DVCV-RECORD-KEY           PIC X(6).
  1507     12  DVCV-RETURN-CODE          PIC XX.
  1508         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1509         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1510         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1511         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1512         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1513         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1514         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1515     12  DVCV-CODE-DESC            PIC X(60).
  1516     12  DVCV-GEN-DESC-1           PIC X(20).
  1517     12  DVCV-GEN-DESC-2           PIC X(20).
  1518     12  DVCV-GEN-DESC-3           PIC X(20).
  1519
  1520 01  hldi-pass-area-len          pic s9(4) comp value +214.
  1521 01  hldi-pass-area.
  1522     03  PA-VIN                  PIC X(17).
  1523     03  PA-ErrorCode            PIC X(10).
  1524     03  PA-ErrorDesc            PIC X(30).
  1525     03  PA-ModelYear            PIC 9(7).
  1526     03  PA-MakeName             PIC X(50).
  1527     03  PA-ModelName            PIC X(50).
  1528     03  PA-SeriesName           PIC X(50).
  1529 01  zipcd-pass-area-len         pic s9(4) comp value +67.
  1530 01  zipcd-pass-area.
  1531     03  PA-zip                  PIC X(5).
  1532     03  PA-ErrorCode-zip        PIC X(10).
  1533     03  PA-city                 PIC x(50).
  1534     03  PA-state                PIC Xx.
  1535****  this is for aggregate report.
  1536****  Length is erpndb + 100 of passed-key-area
  1537 01  ws-passed-key-length        pic s9(4) comp value +587.
  1538 01  ws-pass-to-pemaggo.
  1539     05  ws-passed-erpndb        pic x(585).
  1540     05  ws-exceed-limit-yn      pic x.
  1541     05  ws-has-claim-yn         pic x.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  29
* EL050.cbl
  1543*    COPY ERCBXRF.
  1544******************************************************************
  1545*                                                                *
  1546*                                                                *
  1547*                            ERCBXRF                             *
  1548*                                                                *
  1549*   ONLINE CREDIT SYSTEM                                         *
  1550*                                                                *
  1551*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1552*                                                                *
  1553*   FILE TYPE = VSAM,KSDS                                        *
  1554*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1555*                                                                *
  1556*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1557*       ALTERNATE PATH = NONE                                    *
  1558*                                                                *
  1559*   LOG = NO                                                     *
  1560*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1561*                                                                *
  1562******************************************************************
  1563
  1564 01  BANK-CROSS-REFERENCE.
  1565     12  BK-RECORD-ID                PIC XX.
  1566         88  VALID-BK-ID             VALUE 'BK'.
  1567
  1568     12  BK-CONTROL-PRIMARY.
  1569         16  BK-COMPANY-CD           PIC X.
  1570         16  BK-CARRIER              PIC X.
  1571         16  BK-GROUPING             PIC X(6).
  1572         16  BK-BANK-NO              PIC X(10).
  1573
  1574     12  BK-MAINT-INFORMATION.
  1575         16  BK-LAST-MAINT-DT        PIC XX.
  1576         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1577         16  BK-LAST-MAINT-USER      PIC X(4).
  1578         16  FILLER                  PIC X(9).
  1579
  1580     12  FILLER                      PIC X(37).
  1581
  1582     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1583
  1584     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1585                            DEPENDING ON BK-BANK-POINTER-CNT.
  1586         16  BK-AM-ACCOUNT           PIC X(10).
  1587         16  BK-AM-EXP-DT            PIC XX.
  1588         16  BK-AM-EFF-DT            PIC XX.
  1589         16  BK-AM-STATE             PIC XX.
  1590         16  FILLER                  PIC X(20).
  1591
  1592******************************************************************
  1593
  1594*    COPY ERCCOMP.
  1595******************************************************************
  1596*                                                                *
  1597*                                                                *
  1598*                            ERCCOMP                             *
  1599*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1600*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  30
* EL050.cbl
  1601*                                                                *
  1602*   ONLINE CREDIT SYSTEM                                         *
  1603*                                                                *
  1604*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1605*                                                                *
  1606*   FILE TYPE = VSAM,KSDS                                        *
  1607*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1608*                                                                *
  1609*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1610*       ALTERNATE PATH = NONE                                    *
  1611*                                                                *
  1612*   LOG = NO                                                     *
  1613*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1614*                                                                *
  1615******************************************************************
  1616*                   C H A N G E   L O G
  1617*
  1618* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1619*-----------------------------------------------------------------
  1620*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1621* EFFECTIVE    NUMBER
  1622*-----------------------------------------------------------------
  1623* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1624* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1625* 092205    2005050300006  PEMA  ADD LEASE FEE
  1626* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1627* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1628* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1629* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1630* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1631* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1632******************************************************************
  1633
  1634 01  COMPENSATION-MASTER.
  1635     12  CO-RECORD-ID                          PIC XX.
  1636         88  VALID-CO-ID                          VALUE 'CO'.
  1637
  1638     12  CO-CONTROL-PRIMARY.
  1639         16  CO-COMPANY-CD                     PIC X.
  1640         16  CO-CONTROL.
  1641             20  CO-CTL-1.
  1642                 24  CO-CARR-GROUP.
  1643                     28  CO-CARRIER            PIC X.
  1644                     28  CO-GROUPING.
  1645                         32  CO-GROUP-PREFIX   PIC XXX.
  1646                         32  CO-GROUP-PRIME    PIC XXX.
  1647                 24  CO-RESP-NO.
  1648                     28  CO-RESP-PREFIX        PIC X(4).
  1649                     28  CO-RESP-PRIME         PIC X(6).
  1650             20  CO-CTL-2.
  1651                 24  CO-ACCOUNT.
  1652                     28  CO-ACCT-PREFIX        PIC X(4).
  1653                     28  CO-ACCT-PRIME         PIC X(6).
  1654         16  CO-TYPE                           PIC X.
  1655             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1656             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1657             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1658
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  31
* EL050.cbl
  1659     12  CO-MAINT-INFORMATION.
  1660         16  CO-LAST-MAINT-DT                  PIC XX.
  1661         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1662         16  CO-LAST-MAINT-USER                PIC X(4).
  1663     12  FILLER                                PIC XX.
  1664     12  CO-STMT-TYPE                          PIC XXX.
  1665     12  CO-COMP-TYPE                          PIC X.
  1666         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1667     12  CO-STMT-OWNER                         PIC X(4).
  1668     12  CO-BALANCE-CONTROL                    PIC X.
  1669         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1670         88  CO-NO-BALANCE                        VALUE 'N'.
  1671
  1672     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1673         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1674         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1675         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1676
  1677     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1678         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1679         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1680
  1681     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1682     12  CO-GA-DIRECT-DEP                      PIC X.
  1683     12  CO-FUTURE-SPACE                       PIC X.
  1684         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1685
  1686     12  CO-ACCT-NAME                          PIC X(30).
  1687     12  CO-MAIL-NAME                          PIC X(30).
  1688     12  CO-ADDR-1                             PIC X(30).
  1689     12  CO-ADDR-2                             PIC X(30).
  1690     12  CO-ADDR-3.
  1691         16  CO-ADDR-CITY                      PIC X(27).
  1692         16  CO-ADDR-STATE                     PIC XX.
  1693     12  CO-CSO-1099                           PIC X.
  1694     12  CO-ZIP.
  1695         16  CO-ZIP-PRIME.
  1696             20  CO-ZIP-PRI-1ST                PIC X.
  1697                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1698             20  FILLER                        PIC X(4).
  1699         16  CO-ZIP-PLUS4                      PIC X(4).
  1700     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1701         16  CO-CAN-POSTAL-1                   PIC XXX.
  1702         16  CO-CAN-POSTAL-2                   PIC XXX.
  1703         16  FILLER                            PIC XXX.
  1704     12  CO-SOC-SEC                            PIC X(13).
  1705     12  CO-TELEPHONE.
  1706         16  CO-AREA-CODE                      PIC XXX.
  1707         16  CO-PREFIX                         PIC XXX.
  1708         16  CO-PHONE                          PIC X(4).
  1709
  1710     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1711
  1712     12  CO-AR-BAL-LEVEL                       PIC X.
  1713         88  CO-AR-REF-LVL                        VALUE '1'.
  1714         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1715         88  CO-AR-BILL-LVL                       VALUE '2'.
  1716         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  32
* EL050.cbl
  1717         88  CO-AR-FR-LVL                         VALUE '4'.
  1718
  1719     12  CO-AR-NORMAL-PRINT                    PIC X.
  1720         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1721         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1722
  1723     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1724
  1725     12  CO-AR-REPORTING                       PIC X.
  1726         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1727         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1728
  1729     12  CO-AR-PULL-CHECK                      PIC X.
  1730         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1731         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1732
  1733     12  CO-AR-BALANCE-PRINT                   PIC X.
  1734         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1735
  1736     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1737         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1738         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1739         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1740
  1741     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1742
  1743     12  CO-USER-CODE                          PIC X.
  1744     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1745
  1746******************************************************************
  1747*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1748*    THE LAST MONTH END RUN.
  1749******************************************************************
  1750
  1751     12  CO-LAST-ACTIVITY-DATE.
  1752         16  CO-ACT-YEAR                       PIC 99.
  1753         16  CO-ACT-MONTH                      PIC 99.
  1754         16  CO-ACT-DAY                        PIC 99.
  1755
  1756     12  CO-LAST-STMT-DT.
  1757         16  CO-LAST-STMT-YEAR                 PIC 99.
  1758         16  CO-LAST-STMT-MONTH                PIC 99.
  1759         16  CO-LAST-STMT-DAY                  PIC 99.
  1760
  1761     12  CO-MO-END-TOTALS.
  1762         16  CO-MONTHLY-TOTALS.
  1763             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1764             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1765             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1766             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1767             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1768
  1769         16  CO-AGING-TOTALS.
  1770             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1771             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1772             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1773             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1774
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  33
* EL050.cbl
  1775         16  CO-YTD-TOTALS.
  1776             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1777             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1778
  1779         16  CO-OVER-UNDER-TOTALS.
  1780             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1781             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1782
  1783     12  CO-MISCELLANEOUS-TOTALS.
  1784         16  CO-FICA-TOTALS.
  1785             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1786             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1787
  1788         16  CO-CLAIM-TOTALS.
  1789             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1790             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1791
  1792******************************************************************
  1793*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1794*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1795******************************************************************
  1796
  1797     12  CO-CURRENT-TOTALS.
  1798         16  CO-CURRENT-LAST-STMT-DT.
  1799             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1800             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1801             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1802
  1803         16  CO-CURRENT-MONTHLY-TOTALS.
  1804             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1805             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1806             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1807             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1808             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1809
  1810         16  CO-CURRENT-AGING-TOTALS.
  1811             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1812             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1813             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1814             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1815
  1816         16  CO-CURRENT-YTD-TOTALS.
  1817             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1818             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1819
  1820     12  CO-PAID-COMM-TOTALS.
  1821         16  CO-YTD-PAID-COMMS.
  1822             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1823             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1824
  1825     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1826         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1827         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1828
  1829     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1830         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1831         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1832         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  34
* EL050.cbl
  1833         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1834         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1835         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1836         88  CO-FINAL-LETTER                  VALUE 'F'.
  1837         88  CO-RECONCILING                   VALUE 'R'.
  1838         88  CO-PHONE-CALL                    VALUE 'P'.
  1839         88  CO-LEGAL                         VALUE 'L'.
  1840         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1841         88  CO-WRITE-OFF                     VALUE 'W'.
  1842         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1843
  1844     12  CO-CSR-CODE                       PIC X(4).
  1845
  1846     12  CO-GA-STATUS-INFO.
  1847         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1848         16  CO-GA-TERMINATION-DT          PIC XX.
  1849         16  CO-GA-STATUS-CODE             PIC X.
  1850             88  CO-GA-ACTIVE                 VALUE 'A'.
  1851             88  CO-GA-INACTIVE               VALUE 'I'.
  1852             88  CO-GA-PENDING                VALUE 'P'.
  1853         16  CO-GA-COMMENTS.
  1854             20  CO-GA-COMMENT-1           PIC X(40).
  1855             20  CO-GA-COMMENT-2           PIC X(40).
  1856             20  CO-GA-COMMENT-3           PIC X(40).
  1857             20  CO-GA-COMMENT-4           PIC X(40).
  1858
  1859     12  CO-RPTCD2                         PIC X(10).
  1860     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1861         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1862         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1863
  1864     12  CO-TYPE-AGENT                     PIC X(01).
  1865         88  CO-CORPORATION                   VALUE 'C'.
  1866         88  CO-PARTNERSHIP                   VALUE 'P'.
  1867         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1868         88  CO-TRUST                         VALUE 'T'.
  1869         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1870
  1871     12  CO-FAXNO.
  1872         16  CO-FAX-AREA-CODE                  PIC XXX.
  1873         16  CO-FAX-PREFIX                     PIC XXX.
  1874         16  CO-FAX-PHONE                      PIC X(4).
  1875
  1876     12  CO-BANK-INFORMATION.
  1877         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1878         16  CO-BANK-TRANSIT-NON REDEFINES
  1879             CO-BANK-TRANSIT-NO                PIC 9(8).
  1880
  1881         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1882     12  CO-MISC-DEDUCT-INFO REDEFINES
  1883                  CO-BANK-INFORMATION.
  1884         16  CO-MD-GL-ACCT                     PIC X(10).
  1885         16  CO-MD-DIV                         PIC XX.
  1886         16  CO-MD-CENTER                      PIC X(4).
  1887         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1888         16  CO-CREATE-AP-CHECK                PIC X.
  1889         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1890         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  35
* EL050.cbl
  1891     12  CO-ACH-STATUS                         PIC X.
  1892         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1893         88  CO-ACH-PENDING                        VALUE 'P'.
  1894
  1895     12  CO-BILL-SW                            PIC X.
  1896     12  CO-CONTROL-NAME                       PIC X(30).
  1897     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1898     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1899     12  CO-CLP-STATE                          PIC XX.
  1900     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1901     12  CO-SPP-REFUND-EDIT                    PIC X.
  1902
  1903******************************************************************
  1904
  1905*    COPY ERCAGTC.
  1906******************************************************************
  1907*                                                                *
  1908*                                                                *
  1909*                            ERCAGTC                             *
  1910*                            VMOD=2.001                          *
  1911*                                                                *
  1912*   ONLINE CREDIT SYSTEM                                         *
  1913*                                                                *
  1914*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1915*                                                                *
  1916*   FILE TYPE = VSAM,KSDS                                        *
  1917*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1918*                                                                *
  1919*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1920*       ALTERNATE PATH = NONE                                    *
  1921*                                                                *
  1922*   LOG = NO                                                     *
  1923*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1924*                                                                *
  1925******************************************************************
  1926*                   C H A N G E   L O G
  1927*
  1928* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1929*-----------------------------------------------------------------
  1930*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1931* EFFECTIVE    NUMBER
  1932*-----------------------------------------------------------------
  1933* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1934* 111004                         NEW FILE AND COPYBOOK
  1935* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1936******************************************************************
  1937 01  AGENT-COMMISSIONS.
  1938     12  AG-RECORD-ID                          PIC XX.
  1939         88  VALID-CO-ID                          VALUE 'AG'.
  1940     12  AG-CONTROL-PRIMARY.
  1941         16  AG-COMPANY-CD                     PIC X.
  1942         16  AG-CONTROL.
  1943             20  AG-CTL-1.
  1944                 24  AG-CARR-GROUP.
  1945                     28  AG-CARRIER            PIC X.
  1946                     28  AG-GROUPING           PIC X(6).
  1947                 24  AG-BANK                   PIC X(10).
  1948             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  36
* EL050.cbl
  1949                 24  AG-EXP-DT                 PIC XX.
  1950         16  AG-TYPE                           PIC X.
  1951             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1952             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1953     12  AG-MAINT-INFORMATION.
  1954         16  AG-LAST-MAINT-DT                  PIC XX.
  1955         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1956         16  AG-LAST-MAINT-USER                PIC X(4).
  1957         16  FILLER                            PIC X(10).
  1958     12  AG-EFF-DT                             PIC XX.
  1959     12  AG-COMM-STRUCTURE.
  1960         16  AG-AGT-COMMS OCCURS 10.
  1961             20  AG-AGT                PIC X(10).
  1962             20  AG-COM-TYP            PIC X.
  1963             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1964             20  AG-RECALC-LV-INDIC    PIC X.
  1965             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1966             20  AG-LRCALC-LV-INDIC    PIC X.
  1967             20  FILLER                PIC X(05).
  1968     12  FILLER                  PIC X(145).
  1969******************************************************************
  1970*    COPY ERCRESS.
  1971******************************************************************
  1972*                                                                *
  1973*                            ERCRESS                             *
  1974*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1975*                            VMOD=2.002                          *
  1976*                                                                *
  1977*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1978*                                                                *
  1979*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1980*   VSAM RESIDENT STATE TAX MASTER                              *
  1981*                                                                *
  1982*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1983*                                                                *
  1984*   FILE TYPE = VSAM,KSDS                                        *
  1985*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1986*                                                                *
  1987*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1988*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1989*                                                                *
  1990*   LOG = NO                                                     *
  1991*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1992*                                                                *
  1993*                                                                *
  1994******************************************************************
  1995
  1996 01  RESIDENT-STATE-TAX-MASTER.
  1997
  1998     10  ERRESS-PRIMARY-KEY.
  1999         15  RES-COMPANY-CD        PIC X.
  2000         15  RES-RESIDENT-STATE    PIC XX.
  2001         15  RES-COVERAGE-CATEGORY PIC X.
  2002         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  2003*                                      YYYYMMDD
  2004*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  2005
  2006     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  37
* EL050.cbl
  2007
  2008         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  2009         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  2010         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  2011         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  2012
  2013     10 RES-RECALC-SW              PIC   X.
  2014         88 RECALC                VALUE 'Y'.
  2015         88 NO-RECALC             VALUE 'N'.
  2016     10  RES-MAINT-BY              PIC X(4).
  2017     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  2018     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  2019*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  38
* EL050.cbl
  2021*    COPY ERCRESC.
  2022******************************************************************
  2023*                                                                *
  2024*                            ERCRESC                             *
  2025*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2026*                            VMOD=2.003                          *
  2027*                                                                *
  2028*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  2029*                                                                *
  2030*   FILE TYPE = VSAM,KSDS                                        *
  2031*   RECORD SIZE = 103 RECFORM = FIXED                            *
  2032*                                                                *
  2033*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  2034*       ALTERNATE PATH1 = NONE                                   *
  2035*                                                                *
  2036*   LOG = NO                                                     *
  2037*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2038*                                                                *
  2039******************************************************************
  2040
  2041 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  2042
  2043     10  ERRESC-RECORD-KEY.
  2044         15  RESC-COMPANY-CD           PIC   X.
  2045         15  RESC-CARRIER              PIC   X.
  2046         15  RESC-GROUP                PIC   X(6).
  2047         15  RESC-STATE                PIC   XX.
  2048         15  RESC-ACCOUNT              PIC   X(10).
  2049         15  RESC-AGENT                PIC   X(10).
  2050         15  RESC-RESIDENT-STATE       PIC   XX.
  2051         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  2052*                                           YYYYMMDD
  2053     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  2054
  2055     10  RESC-COMM-RECORD-DATA.
  2056         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  2057             20 RESC-COVERAGE-CAT      PIC    X.
  2058             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  2059             20 RESC-COMMISSION-TAB REDEFINES
  2060                RESC-COMMISSION-PER    PIC  XXX.
  2061
  2062     10  RESC-MAINT-BY                 PIC X(4).
  2063     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  2064     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  2065*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  39
* EL050.cbl
  2067*    COPY ERCPLAN.
  2068******************************************************************
  2069*                                                                *
  2070*                                                                *
  2071*                            ERCPLAN                             *
  2072*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2073*                            VMOD=2.003                          *
  2074*                                                                *
  2075*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  2076*                                                                *
  2077*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  2078*   PLAN MASTER                                                  *
  2079*                                                                *
  2080*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  2081*                                                                *
  2082*   FILE TYPE = VSAM,KSDS                                        *
  2083*   RECORD SIZE = 420   RECFORM = FIX                            *
  2084*                                                                *
  2085*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  2086*       ALTERNATE PATH1 = N/A                                    *
  2087*                                                                *
  2088*   LOG = NO                                                     *
  2089*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2090*                                                                *
  2091*                                                                *
  2092******************************************************************
  2093
  2094 01  PLAN-MASTER.
  2095     12  PL-RECORD-ID                      PIC XX.
  2096         88  VALID-PL-ID                      VALUE 'PL'.
  2097
  2098     12  PL-CONTROL-PRIMARY.
  2099         16  PL-COMPANY-CD                 PIC X.
  2100         16  PL-MSTR-CNTRL.
  2101             20  PL-CONTROL-A.
  2102                 24  PL-CARRIER            PIC X.
  2103                 24  PL-GROUPING           PIC X(6).
  2104                 24  PL-STATE              PIC XX.
  2105                 24  PL-ACCOUNT            PIC X(10).
  2106             20  PL-BENEFIT-TYPE           PIC X.
  2107             20  PL-BENEFIT-CODE           PIC XX.
  2108             20  PL-REVISION-NO            PIC X(3).
  2109
  2110     12  PL-CONTROL-BY-VAR-GRP.
  2111         16  PL-COMPANY-CD-A1              PIC X.
  2112         16  PL-VG-CARRIER                 PIC X.
  2113         16  PL-VG-GROUPING                PIC X(6).
  2114         16  PL-VG-STATE                   PIC XX.
  2115         16  PL-VG-ACCOUNT                 PIC X(10).
  2116         16  PL-BENEFIT-TYPE-A1            PIC X.
  2117         16  PL-BENEFIT-CODE-A1            PIC XX.
  2118         16  PL-REVISION-NO-A1             PIC 999.
  2119
  2120     12  PL-MAINT-INFORMATION.
  2121         16  PL-LAST-MAINT-DT              PIC XX.
  2122         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2123         16  PL-LAST-MAINT-USER            PIC X(4).
  2124         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  40
* EL050.cbl
  2125
  2126     12  PL-LIABILITY-LIMITS.
  2127         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2128         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2129             20  PL-LM-AGE                 PIC S99        COMP-3.
  2130             20  PL-LM-DUR                 PIC S999       COMP-3.
  2131             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2132             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2133
  2134     12  FILLER                            PIC X(30).
  2135
  2136     12  PL-GL-ACCOUNT-NOS.
  2137         16  PL-PREMIUM-GL                 PIC X(8).
  2138         16  PL-COMM-GL                    PIC X(8).
  2139         16  PL-CLAIM-GL                   PIC X(8).
  2140     12  FILLER                            PIC X(24).
  2141     12  PL-TOLERANCES.
  2142         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2143         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2144         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2145         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2146         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2147         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2148     12  PL-OVER-SHORT.
  2149         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2150         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2151     12  FILLER                            PIC X(24).
  2152     12  PLAN-MISC.
  2153         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2154         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2155         16  PL-IG                         PIC X.
  2156         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2157         16  PL-POLICY-FORM                PIC X(12).
  2158         16  PL-EDIT-FOR-FORM              PIC X(01).
  2159         16  PL-DEV-CODE                   PIC XXX.
  2160         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2161         16  PL-CALC-METHOD                PIC X.
  2162         16  PL-BENEFIT-GROUP              PIC X(05).
  2163         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2164
  2165         16  FILLER                        PIC X(99).
  2166******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  41
* EL050.cbl
  2168*    COPY ELCCERT.
  2169******************************************************************
  2170*                                                                *
  2171*                            ELCCERT.                            *
  2172*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2173*                            VMOD=2.013                          *
  2174*                                                                *
  2175*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2176*                                                                *
  2177*   FILE TYPE = VSAM,KSDS                                        *
  2178*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2179*                                                                *
  2180*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2181*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2182*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2183*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2184*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2185*                                                                *
  2186*   LOG = YES                                                    *
  2187*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2188******************************************************************
  2189*                   C H A N G E   L O G
  2190*
  2191* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2192*-----------------------------------------------------------------
  2193*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2194* EFFECTIVE    NUMBER
  2195*-----------------------------------------------------------------
  2196* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2197* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2198* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2199* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2200* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2201* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2202* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2203* 032612  CR2011110200001  PEMA  AHL CHANGES
  2204* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2205* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2206******************************************************************
  2207
  2208 01  CERTIFICATE-MASTER.
  2209     12  CM-RECORD-ID                      PIC XX.
  2210         88  VALID-CM-ID                      VALUE 'CM'.
  2211
  2212     12  CM-CONTROL-PRIMARY.
  2213         16  CM-COMPANY-CD                 PIC X.
  2214         16  CM-CARRIER                    PIC X.
  2215         16  CM-GROUPING.
  2216             20  CM-GROUPING-PREFIX        PIC X(3).
  2217             20  CM-GROUPING-PRIME         PIC X(3).
  2218         16  CM-STATE                      PIC XX.
  2219         16  CM-ACCOUNT.
  2220             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2221             20  CM-ACCOUNT-PRIME          PIC X(6).
  2222         16  CM-CERT-EFF-DT                PIC XX.
  2223         16  CM-CERT-NO.
  2224             20  CM-CERT-PRIME             PIC X(10).
  2225             20  CM-CERT-SFX               PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  42
* EL050.cbl
  2226
  2227     12  CM-CONTROL-BY-NAME.
  2228         16  CM-COMPANY-CD-A1              PIC X.
  2229         16  CM-INSURED-LAST-NAME          PIC X(15).
  2230         16  CM-INSURED-INITIALS.
  2231             20  CM-INSURED-INITIAL1       PIC X.
  2232             20  CM-INSURED-INITIAL2       PIC X.
  2233
  2234     12  CM-CONTROL-BY-SSN.
  2235         16  CM-COMPANY-CD-A2              PIC X.
  2236         16  CM-SOC-SEC-NO.
  2237             20  CM-SSN-STATE              PIC XX.
  2238             20  CM-SSN-ACCOUNT            PIC X(6).
  2239             20  CM-SSN-LN3.
  2240                 25  CM-INSURED-INITIALS-A2.
  2241                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2242                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2243                 25 CM-PART-LAST-NAME-A2         PIC X.
  2244
  2245     12  CM-CONTROL-BY-CERT-NO.
  2246         16  CM-COMPANY-CD-A4              PIC X.
  2247         16  CM-CERT-NO-A4                 PIC X(11).
  2248
  2249     12  CM-CONTROL-BY-MEMB.
  2250         16  CM-COMPANY-CD-A5              PIC X.
  2251         16  CM-MEMBER-NO.
  2252             20  CM-MEMB-STATE             PIC XX.
  2253             20  CM-MEMB-ACCOUNT           PIC X(6).
  2254             20  CM-MEMB-LN4.
  2255                 25  CM-INSURED-INITIALS-A5.
  2256                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2257                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2258                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2259
  2260     12  CM-INSURED-PROFILE-DATA.
  2261         16  CM-INSURED-FIRST-NAME.
  2262             20  CM-INSURED-1ST-INIT       PIC X.
  2263             20  FILLER                    PIC X(9).
  2264         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2265         16  CM-INSURED-SEX                PIC X.
  2266             88  CM-SEX-MALE                  VALUE 'M'.
  2267             88  CM-SEX-FEMAL                 VALUE 'F'.
  2268         16  CM-INSURED-JOINT-AGE          PIC 99.
  2269         16  CM-JOINT-INSURED-NAME.
  2270             20  CM-JT-LAST-NAME           PIC X(15).
  2271             20  CM-JT-FIRST-NAME.
  2272                 24  CM-JT-1ST-INIT        PIC X.
  2273                 24  FILLER                PIC X(9).
  2274             20  CM-JT-INITIAL             PIC X.
  2275
  2276     12  CM-LIFE-DATA.
  2277         16  CM-LF-BENEFIT-CD              PIC XX.
  2278         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2279         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2280         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2281         16  CM-LF-DEV-CODE                PIC XXX.
  2282         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2283         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  43
* EL050.cbl
  2284         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2285         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2286         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2287         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2288         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2289         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2290         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2291         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2292         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2293         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2294         16  cm-temp-epiq                  pic xx.
  2295             88  EPIQ-CLASS                  value 'EQ'.
  2296*        16  FILLER                        PIC XX.
  2297
  2298     12  CM-AH-DATA.
  2299         16  CM-AH-BENEFIT-CD              PIC XX.
  2300         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2301         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2302         16  CM-AH-DEV-CODE                PIC XXX.
  2303         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2304         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2305         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2306         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2307         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2308         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2309         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2310         16  CM-AH-PAID-THRU-DT            PIC XX.
  2311             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2312         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2313         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  2314         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2315         16  FILLER                        PIC X.
  2316
  2317     12  CM-LOAN-INFORMATION.
  2318         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2319         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2320                                           PIC S9(5)V99  COMP-3.
  2321         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2322         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2323         16  CM-PAY-FREQUENCY              PIC S99.
  2324         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2325         16  CM-RATE-CLASS                 PIC XX.
  2326         16  CM-BENEFICIARY                PIC X(25).
  2327         16  CM-POLICY-FORM-NO             PIC X(12).
  2328         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2329         16  CM-LAST-ADD-ON-DT             PIC XX.
  2330         16  CM-DEDUCTIBLE-AMOUNTS.
  2331             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2332             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2333         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2334             20  CM-RESIDENT-STATE         PIC XX.
  2335             20  CM-RATE-CODE              PIC X(4).
  2336             20  FILLER                    PIC XX.
  2337         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2338             20  CM-LOAN-OFFICER           PIC X(5).
  2339             20  FILLER                    PIC XXX.
  2340         16  CM-CSR-CODE                   PIC XXX.
  2341         16  CM-UNDERWRITING-CODE          PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  44
* EL050.cbl
  2342             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2343         16  CM-POST-CARD-IND              PIC X.
  2344         16  CM-NH-INTERFACE-SW            PIC X.
  2345         16  CM-PREMIUM-TYPE               PIC X.
  2346             88  CM-SING-PRM                  VALUE '1'.
  2347             88  CM-O-B-COVERAGE              VALUE '2'.
  2348             88  CM-OPEN-END                  VALUE '3'.
  2349         16  CM-IND-GRP-TYPE               PIC X.
  2350             88  CM-INDIVIDUAL                VALUE 'I'.
  2351             88  CM-GROUP                     VALUE 'G'.
  2352         16  CM-SKIP-CODE                  PIC X.
  2353             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2354             88  SKIP-JULY                    VALUE '1'.
  2355             88  SKIP-AUGUST                  VALUE '2'.
  2356             88  SKIP-SEPTEMBER               VALUE '3'.
  2357             88  SKIP-JULY-AUG                VALUE '4'.
  2358             88  SKIP-AUG-SEPT                VALUE '5'.
  2359             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2360             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2361             88  SKIP-JUNE                    VALUE '8'.
  2362             88  SKIP-JUNE-JULY               VALUE '9'.
  2363             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2364             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2365         16  CM-PAYMENT-MODE               PIC X.
  2366             88  PAY-MONTHLY                  VALUE SPACE.
  2367             88  PAY-WEEKLY                   VALUE '1'.
  2368             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2369             88  PAY-BI-WEEKLY                VALUE '3'.
  2370             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2371         16  CM-LOAN-NUMBER                PIC X(8).
  2372         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2373         16  CM-OLD-LOF                    PIC XXX.
  2374*        16  CM-LOAN-OFFICER               PIC XXX.
  2375         16  CM-REIN-TABLE                 PIC XXX.
  2376         16  CM-SPECIAL-REIN-CODE          PIC X.
  2377         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2378         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2379         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2380
  2381     12  CM-STATUS-DATA.
  2382         16  CM-ENTRY-STATUS               PIC X.
  2383         16  CM-ENTRY-DT                   PIC XX.
  2384
  2385         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2386         16  CM-LF-CANCEL-DT               PIC XX.
  2387         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2388
  2389         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2390         16  CM-LF-DEATH-DT                PIC XX.
  2391         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2392
  2393         16  CM-LF-CURRENT-STATUS          PIC X.
  2394             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2395                                                'M' '4' '5' '9'.
  2396             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2397             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2398             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2399             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  45
* EL050.cbl
  2400             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2401             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2402             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2403             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2404             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2405             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2406             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2407             88  CM-LF-DECLINED               VALUE 'D'.
  2408             88  CM-LF-VOIDED                 VALUE 'V'.
  2409
  2410         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2411         16  CM-AH-CANCEL-DT               PIC XX.
  2412         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2413
  2414         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2415         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2416         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2417
  2418         16  CM-AH-CURRENT-STATUS          PIC X.
  2419             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2420                                                'M' '4' '5' '9'.
  2421             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2422             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2423             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2424             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2425             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2426             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2427             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2428             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2429             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2430             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2431             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2432             88  CM-AH-DECLINED               VALUE 'D'.
  2433             88  CM-AH-VOIDED                 VALUE 'V'.
  2434
  2435         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2436             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2437             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2438             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2439         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2440
  2441         16  CM-ENTRY-BATCH                PIC X(6).
  2442         16  CM-LF-EXIT-BATCH              PIC X(6).
  2443         16  CM-AH-EXIT-BATCH              PIC X(6).
  2444         16  CM-LAST-MONTH-END             PIC XX.
  2445
  2446     12  CM-NOTE-SW                        PIC X.
  2447         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2448         88  CERT-NOTES-PRESENT               VALUE '1'.
  2449         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2450         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2451         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2452         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2453         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2454         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2455     12  CM-COMP-EXCP-SW                   PIC X.
  2456         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2457         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  46
* EL050.cbl
  2458     12  CM-INSURED-ADDRESS-SW             PIC X.
  2459         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2460         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2461
  2462*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2463     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2464     12  FILLER                            PIC X.
  2465
  2466*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2467     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2468     12  FILLER                            PIC X.
  2469*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2470     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2471
  2472     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2473         88  CERT-ADDED-BATCH                 VALUE ' '.
  2474         88  CERT-ADDED-ONLINE                VALUE '1'.
  2475         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2476         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2477         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2478     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2479         88  CERT-AS-LOADED                   VALUE ' '.
  2480         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2481         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2482         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2483         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2484         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2485         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2486         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2487
  2488     12  CM-ACCOUNT-COMM-PCTS.
  2489         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2490         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2491
  2492     12  CM-USER-FIELD                     PIC X.
  2493     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2494     12  CM-CLP-STATE                      PIC XX.
  2495     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2496     12  CM-USER-RESERVED                  PIC XXX.
  2497     12  FILLER REDEFINES CM-USER-RESERVED.
  2498         16  CM-AH-CLASS-CD                PIC XX.
  2499         16  F                             PIC X.
  2500******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  47
* EL050.cbl
  2502*    COPY ERCMAIL.
  2503******************************************************************
  2504*                                                                *
  2505*                                                                *
  2506*                            ERCMAIL                             *
  2507*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2508*                            VMOD=2.003                          *
  2509*                                                                *
  2510*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2511*                                                                *
  2512*   FILE TYPE = VSAM,KSDS                                        *
  2513*   RECORD SIZE = 374   RECFORM = FIX                            *
  2514*                                                                *
  2515*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2516*   ALTERNATE PATH    = NOT USED                                 *
  2517*                                                                *
  2518*   LOG = YES                                                    *
  2519*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2520******************************************************************
  2521*                   C H A N G E   L O G
  2522*
  2523* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2524*-----------------------------------------------------------------
  2525*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2526* EFFECTIVE    NUMBER
  2527*-----------------------------------------------------------------
  2528* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2529* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2530* 111108                   PEMA  ADD CRED BENE ADDR2
  2531******************************************************************
  2532
  2533 01  MAILING-DATA.
  2534     12  MA-RECORD-ID                      PIC XX.
  2535         88  VALID-MA-ID                       VALUE 'MA'.
  2536
  2537     12  MA-CONTROL-PRIMARY.
  2538         16  MA-COMPANY-CD                 PIC X.
  2539         16  MA-CARRIER                    PIC X.
  2540         16  MA-GROUPING.
  2541             20  MA-GROUPING-PREFIX        PIC XXX.
  2542             20  MA-GROUPING-PRIME         PIC XXX.
  2543         16  MA-STATE                      PIC XX.
  2544         16  MA-ACCOUNT.
  2545             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2546             20  MA-ACCOUNT-PRIME          PIC X(6).
  2547         16  MA-CERT-EFF-DT                PIC XX.
  2548         16  MA-CERT-NO.
  2549             20  MA-CERT-PRIME             PIC X(10).
  2550             20  MA-CERT-SFX               PIC X.
  2551
  2552     12  FILLER                            PIC XX.
  2553
  2554     12  MA-ACCESS-CONTROL.
  2555         16  MA-SOURCE-SYSTEM              PIC XX.
  2556             88  MA-FROM-CREDIT                VALUE 'CR'.
  2557             88  MA-FROM-VSI                   VALUE 'VS'.
  2558             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2559             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  48
* EL050.cbl
  2560         16  MA-RECORD-ADD-DT              PIC XX.
  2561         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2562         16  MA-LAST-MAINT-DT              PIC XX.
  2563         16  MA-LAST-MAINT-BY              PIC XXXX.
  2564         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2565
  2566     12  MA-PROFILE-INFO.
  2567         16  MA-QUALIFY-CODE-1             PIC XX.
  2568         16  MA-QUALIFY-CODE-2             PIC XX.
  2569         16  MA-QUALIFY-CODE-3             PIC XX.
  2570         16  MA-QUALIFY-CODE-4             PIC XX.
  2571         16  MA-QUALIFY-CODE-5             PIC XX.
  2572
  2573         16  MA-INSURED-LAST-NAME          PIC X(15).
  2574         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2575         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2576         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2577         16  MA-INSURED-BIRTH-DT           PIC XX.
  2578         16  MA-INSURED-SEX                PIC X.
  2579             88  MA-SEX-MALE                   VALUE 'M'.
  2580             88  MA-SEX-FEMALE                 VALUE 'F'.
  2581         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2582
  2583         16  MA-ADDRESS-CORRECTED          PIC X.
  2584         16  MA-JOINT-BIRTH-DT             PIC XX.
  2585*        16  FILLER                        PIC X(12).
  2586
  2587         16  MA-ADDRESS-LINE-1             PIC X(30).
  2588         16  MA-ADDRESS-LINE-2             PIC X(30).
  2589         16  MA-CITY-STATE.
  2590             20  MA-CITY                   PIC X(28).
  2591             20  MA-ADDR-STATE             PIC XX.
  2592         16  MA-ZIP.
  2593             20  MA-ZIP-CODE.
  2594                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2595                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2596                 24  FILLER                PIC X(4).
  2597             20  MA-ZIP-PLUS4              PIC X(4).
  2598         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2599             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2600             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2601             20  FILLER                    PIC X(3).
  2602
  2603         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2604
  2605         16  FILLER                        PIC XXX.
  2606*        16  FILLER                        PIC X(10).
  2607
  2608     12  MA-CRED-BENE-INFO.
  2609         16  MA-CRED-BENE-NAME                 PIC X(25).
  2610         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2611         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2612         16  MA-CRED-BENE-CTYST.
  2613             20  MA-CRED-BENE-CITY             PIC X(28).
  2614             20  MA-CRED-BENE-STATE            PIC XX.
  2615         16  MA-CRED-BENE-ZIP.
  2616             20  MA-CB-ZIP-CODE.
  2617                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  49
* EL050.cbl
  2618                     88  MA-CB-CANADIAN-POST-CODE
  2619                                           VALUE 'A' THRU 'Z'.
  2620                 24  FILLER                    PIC X(4).
  2621             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2622         16  MA-CB-CANADIAN-POSTAL-CODE
  2623                            REDEFINES MA-CRED-BENE-ZIP.
  2624             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2625             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2626             20  FILLER                        PIC X(3).
  2627     12  MA-POST-CARD-MAIL-DATA.
  2628         16  MA-MAIL-DATA OCCURS 7.
  2629             20  MA-MAIL-TYPE              PIC X.
  2630                 88  MA-12MO-MAILING           VALUE '1'.
  2631                 88  MA-EXP-MAILING            VALUE '2'.
  2632             20  MA-MAIL-STATUS            PIC X.
  2633                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2634                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2635                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2636             20  MA-MAIL-DATE              PIC XX.
  2637     12  FILLER                            PIC XX.
  2638     12  FILLER                            PIC XX.
  2639*    12  FILLER                            PIC X(30).
  2640******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  50
* EL050.cbl
  2642*    COPY ERCPNDM.
  2643******************************************************************
  2644*                                                                *
  2645*                                                                *
  2646*                            ERCPNDM                             *
  2647*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2648*                            VMOD=2.003                          *
  2649*                                                                *
  2650*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2651*                                                                *
  2652*   FILE TYPE = VSAM,KSDS                                        *
  2653*   RECORD SIZE = 374   RECFORM = FIX                            *
  2654*                                                                *
  2655*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2656*   ALTERNATE PATH    = NOT USED                                 *
  2657*                                                                *
  2658*   LOG = YES                                                    *
  2659*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2660******************************************************************
  2661*                   C H A N G E   L O G
  2662*
  2663* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2664*-----------------------------------------------------------------
  2665*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2666* EFFECTIVE    NUMBER
  2667*-----------------------------------------------------------------
  2668* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2669* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2670* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2671* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  2672******************************************************************
  2673
  2674 01  PENDING-MAILING-DATA.
  2675     12  PM-RECORD-ID                      PIC XX.
  2676         88  VALID-MA-ID                       VALUE 'PM'.
  2677
  2678     12  PM-CONTROL-PRIMARY.
  2679         16  PM-COMPANY-CD                 PIC X.
  2680         16  PM-ENTRY-BATCH                PIC X(6).
  2681         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2682         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2683
  2684     12  FILLER                            PIC X(14).
  2685
  2686     12  PM-ACCESS-CONTROL.
  2687         16  PM-SOURCE-SYSTEM              PIC XX.
  2688             88  PM-FROM-CREDIT                VALUE 'CR'.
  2689             88  PM-FROM-VSI                   VALUE 'VS'.
  2690             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2691             88  PM-FROM-OTHER                 VALUE 'OT'.
  2692         16  PM-RECORD-ADD-DT              PIC XX.
  2693         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2694         16  PM-LAST-MAINT-DT              PIC XX.
  2695         16  PM-LAST-MAINT-BY              PIC XXXX.
  2696         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2697
  2698     12  PM-PROFILE-INFO.
  2699         16  PM-QUALIFY-CODE-1             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  51
* EL050.cbl
  2700         16  PM-QUALIFY-CODE-2             PIC XX.
  2701         16  PM-QUALIFY-CODE-3             PIC XX.
  2702         16  PM-QUALIFY-CODE-4             PIC XX.
  2703         16  PM-QUALIFY-CODE-5             PIC XX.
  2704
  2705         16  PM-INSURED-LAST-NAME          PIC X(15).
  2706         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2707         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2708         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2709         16  PM-INSURED-BIRTH-DT           PIC XX.
  2710         16  PM-INSURED-SEX                PIC X.
  2711             88  PM-SEX-MALE                   VALUE 'M'.
  2712             88  PM-SEX-FEMALE                 VALUE 'F'.
  2713         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2714
  2715         16  PM-ADDRESS-CORRECTED          PIC X.
  2716         16  PM-JOINT-BIRTH-DT             PIC XX.
  2717*        16  FILLER                        PIC X(12).
  2718
  2719         16  PM-ADDRESS-LINE-1             PIC X(30).
  2720         16  PM-ADDRESS-LINE-2             PIC X(30).
  2721         16  PM-CITY-STATE.
  2722             20  PM-CITY                   PIC X(28).
  2723             20  PM-STATE                  PIC XX.
  2724         16  PM-ZIP.
  2725             20  PM-ZIP-CODE.
  2726                 24  PM-ZIP-1              PIC X.
  2727                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2728                 24  FILLER                PIC X(4).
  2729             20  PM-ZIP-PLUS4              PIC X(4).
  2730         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2731             20  PM-CAN-POST1              PIC XXX.
  2732             20  PM-CAN-POST2              PIC XXX.
  2733             20  FILLER                    PIC XXX.
  2734
  2735         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2736         16  pm-city-st-zip-verified       pic x.
  2737         16  FILLER                        PIC XX.
  2738
  2739     12  PM-CRED-BENE-INFO.
  2740         16  PM-CRED-BENE-NAME             PIC X(25).
  2741         16  PM-CRED-BENE-ADDR             PIC X(30).
  2742         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2743         16  PM-CRED-BENE-CTYST.
  2744             20  PM-CRED-BENE-CITY         PIC X(28).
  2745             20  PM-CRED-BENE-STATE        PIC XX.
  2746         16  PM-CRED-BENE-ZIP.
  2747             20  PM-CB-ZIP-CODE.
  2748                 24  PM-CB-ZIP-1           PIC X.
  2749                     88  PM-CB-CANADIAN-POST-CODE
  2750                                  VALUE 'A' THRU 'Z'.
  2751                 24  FILLER                PIC X(4).
  2752             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2753         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2754             20  PM-CB-CAN-POST1           PIC XXX.
  2755             20  PM-CB-CAN-POST2           PIC XXX.
  2756             20  FILLER                    PIC XXX.
  2757     12  PM-POST-CARD-MAIL-DATA.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  52
* EL050.cbl
  2758         16  PM-MAIL-DATA OCCURS 7.
  2759             20  PM-MAIL-TYPE              PIC X.
  2760                 88  PM-12MO-MAILING           VALUE '1'.
  2761                 88  PM-EXP-MAILING            VALUE '2'.
  2762             20  PM-MAIL-STATUS            PIC X.
  2763                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2764                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2765                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2766             20  PM-MAIL-DATE              PIC XX.
  2767     12  FILLER                            PIC XX.
  2768     12  FILLER                            PIC X(12).
  2769*    12  FILLER                            PIC X(30).
  2770
  2771******************************************************************
  2772*                                COPY ERCLOFC.
  2773******************************************************************
  2774*                                                                *
  2775*                                                                *
  2776*                            ERCLOFC                             *
  2777*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2778*                            VMOD=2.003                          *
  2779*                                                                *
  2780*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2781*                                                                *
  2782*   FILE TYPE = VSAM,KSDS                                        *
  2783*   RECORD SIZE = 670   RECFORM = FIX                            *
  2784*                                                                *
  2785*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2786*                                                                *
  2787*   LOG = YES                                                    *
  2788*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2789*                                                                *
  2790******************************************************************
  2791
  2792 01  LOAN-OFFICER-MASTER.
  2793     12  LO-RECORD-ID                PIC XX.
  2794         88  VALID-LO-ID                VALUE 'LO'.
  2795
  2796     12  LO-CONTROL-PRIMARY.
  2797         16  LO-COMPANY-CD           PIC X.
  2798         16  LO-CARRIER              PIC X.
  2799         16  LO-GROUPING.
  2800             20  LO-GROUPING-PREFIX  PIC XXX.
  2801             20  LO-GROUPING-PRIME   PIC XXX.
  2802         16  LO-STATE                PIC XX.
  2803         16  LO-ACCOUNT.
  2804             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2805             20  LO-ACCOUNT-PRIME    PIC X(6).
  2806         16  LO-OFFICER-CODE         PIC X(5).
  2807
  2808     12  LO-OFFICER-NAME             PIC X(30).
  2809
  2810     12  LO-LAST-MAINT-DT            PIC XX.
  2811     12  LO-LAST-USER                PIC X(4).
  2812     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2813
  2814     12  LO-COMP-CONTROL             PIC X.
  2815             88  LO-SHOW-COMP           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  53
* EL050.cbl
  2816             88  LO-SUPPRESS-COMP       VALUE 'N'.
  2817     12  LO-DETAIL-CONTROL           PIC X.
  2818             88  LO-PRINT-DETAIL        VALUE 'D'.
  2819             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2820
  2821     12  LO-SV-CARRIER               PIC X.
  2822     12  LO-SV-GROUPING              PIC X(6).
  2823     12  LO-SV-STATE                 PIC XX.
  2824
  2825     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2826     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2827
  2828     12  LO-OFFICER-INFO.
  2829         16  FILLER OCCURS 12 TIMES.
  2830             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2831             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2832             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2833             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2834             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2835             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2836             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2837             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2838     12  FILLER                      PIC X(198).
  2839******************************************************************
  2840*                                COPY ERCPDEF.
  2841******************************************************************
  2842*                                                                *
  2843*                                                                *
  2844*                            ERCPDEF.                            *
  2845*                                                                *
  2846*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2847*                                                                *
  2848*    FILE TYPE = VSAM,KSDS                                       *
  2849*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2850*                                                                *
  2851*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2852*                                                                *
  2853*    LOG = YES                                                   *
  2854*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2855******************************************************************
  2856*                   C H A N G E   L O G
  2857*
  2858* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2859*-----------------------------------------------------------------
  2860*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2861* EFFECTIVE    NUMBER
  2862*-----------------------------------------------------------------
  2863* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2864* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2865* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  2866******************************************************************
  2867 01  PRODUCT-MASTER.
  2868    12  PD-RECORD-ID                 PIC X(02).
  2869        88  VALID-PD-ID                  VALUE 'PD'.
  2870    12  PD-CONTROL-PRIMARY.
  2871        16  PD-COMPANY-CD            PIC X.
  2872        16  PD-STATE                 PIC XX.
  2873        16  PD-PRODUCT-CD            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  54
* EL050.cbl
  2874        16  PD-FILLER                PIC X(7).
  2875        16  PD-BEN-TYPE              PIC X.
  2876        16  PD-BEN-CODE              PIC XX.
  2877        16  PD-PROD-EXP-DT           PIC XX.
  2878    12  FILLER                       PIC X(50).
  2879    12  PD-PRODUCT-DATA OCCURS 8.
  2880        16  PD-PROD-CODE             PIC X.
  2881            88  PD-PROD-LIFE           VALUE 'L'.
  2882            88  PD-PROD-PROP           VALUE 'P'.
  2883            88  PD-PROD-AH             VALUE 'A'.
  2884            88  PD-PROD-IU             VALUE 'I'.
  2885            88  PD-PROD-GAP            VALUE 'G'.
  2886            88  PD-PROD-FAML           VALUE 'F'.
  2887        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2888        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2889        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2890        16  PD-MAX-TERM              PIC S999        COMP-3.
  2891        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2892        16  FILLER                   PIC X.
  2893        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2894        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2895        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2896        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2897        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2898        16  PD-REC-CRIT-PERIOD       PIC 99.
  2899        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2900            20  PD-RECURRING-YN      PIC X.
  2901            20  FILLER               PIC X.
  2902        16  PD-RTW-MOS               PIC 99.
  2903        16  PD-MAX-EXTENSION         PIC 99.
  2904        16  pd-ben-pct               pic sv999 comp-3.
  2905*       16  FILLER                   PIC XX.
  2906    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2907    12  PD-TERM-LIMITS OCCURS 15.
  2908        16  PD-LOW-TERM              PIC S999        COMP-3.
  2909        16  PD-HI-TERM               PIC S999        COMP-3.
  2910*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2911    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2912        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2913        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2914    12  PD-EARN-FACTORS.
  2915        16  FILLER OCCURS 15.
  2916            20  FILLER OCCURS 15.
  2917                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2918    12  PD-PRODUCT-DESC              PIC X(80).
  2919    12  PD-TRUNCATED                 PIC X.
  2920    12  FILLER                       PIC X(59).
  2921    12  PD-MAINT-INFORMATION.
  2922        16  PD-LAST-MAINT-DT         PIC X(02).
  2923        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2924        16  PD-LAST-MAINT-BY         PIC X(04).
  2925*                                COPY ELCSTATE.
  2926******************************************************************
  2927*                                                                *
  2928*                                                                *
  2929*                            ELCSTATE.                           *
  2930*                                                                *
  2931*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  55
* EL050.cbl
  2932*                                                                *
  2933*   FILE TYPE = VSAM,KSDS                                        *
  2934*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2935*                                                                *
  2936*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2937*       ALTERNATE INDEX = NONE                                   *
  2938*                                                                *
  2939*   LOG = YES                                                    *
  2940*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2941******************************************************************
  2942*                   C H A N G E   L O G
  2943*
  2944* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2945*-----------------------------------------------------------------
  2946*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2947* EFFECTIVE    NUMBER
  2948*-----------------------------------------------------------------
  2949* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  2950******************************************************************
  2951*
  2952 01  STATE-FILE.
  2953     12  SF-RECORD-ID                       PIC XX.
  2954         88  VALID-CF-ID                        VALUE 'SF'.
  2955     12  SF-CONTROL-PRIMARY.
  2956         16  SF-COMPANY-ID                  PIC XXX.
  2957         16  SF-CARRIER-CODE                PIC X.
  2958         16  SF-GROUPING                    PIC X(6).
  2959         16  SF-STATE-CODE                  PIC XX.
  2960         16  SF-EXPIRE-DATE                 PIC 9(8).
  2961****************************************************************
  2962*             STATE CONTROLS
  2963****************************************************************
  2964     12  SF-LAST-MAINT-DT                   PIC XX.
  2965     12  SF-LAST-MAINT-BY                   PIC X(4).
  2966     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2967     12  SF-STATE-RT-CONTROLS.
  2968         16  SF-ST-RT-CALC                  PIC X.
  2969     12  SF-ST-TAX-CONTROLS.
  2970         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2971         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2972         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2973     12  SF-ST-REFUND-OPTIONS.
  2974         16  SF-ST-RF-LR-CALC               PIC X.
  2975         16  SF-ST-RF-LL-CALC               PIC X.
  2976         16  SF-ST-RF-LN-CALC               PIC X.
  2977         16  SF-ST-RF-AH-CALC               PIC X.
  2978         16  SF-ST-RF-CP-CALC               PIC X.
  2979     12  SF-ST-UNEARN-PREM-OPTIONS.
  2980         16  SF-ST-LUEP-R78                 PIC X.
  2981         16  SF-ST-LUEP-PRO                 PIC X.
  2982         16  SF-ST-LUEP-ST                  PIC X.
  2983         16  SF-ST-LUEP-DOM                 PIC X.
  2984         16  SF-ST-AUEP-R78                 PIC X.
  2985         16  SF-ST-AUEP-PRO                 PIC X.
  2986         16  SF-ST-AUEP-ST                  PIC X.
  2987         16  SF-ST-AUEP-DOM                 PIC X.
  2988         16  SF-ST-CUEP-R78                 PIC X.
  2989         16  SF-ST-CUEP-PRO                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  56
* EL050.cbl
  2990         16  SF-ST-CUEP-ST                  PIC X.
  2991         16  SF-ST-CUEP-DOM                 PIC X.
  2992     12  SF-ST-EARN-PREM-OPTIONS.
  2993         16  SF-ST-LEP-R78                  PIC X.
  2994         16  SF-ST-LEP-PRO                  PIC X.
  2995         16  SF-ST-LEP-ST                   PIC X.
  2996         16  SF-ST-LEP-DOM                  PIC X.
  2997         16  SF-ST-AEP-R78                  PIC X.
  2998         16  SF-ST-AEP-PRO                  PIC X.
  2999         16  SF-ST-AEP-ST                   PIC X.
  3000         16  SF-ST-AEP-DOM                  PIC X.
  3001         16  SF-ST-CEP-R78                  PIC X.
  3002         16  SF-ST-CEP-PRO                  PIC X.
  3003         16  SF-ST-CEP-ST                   PIC X.
  3004         16  SF-ST-CEP-DOM                  PIC X.
  3005     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  57
* EL050.cbl
  3007*    COPY ELCCRTT.
  3008******************************************************************
  3009*                                                                *
  3010*                            ELCCRTT.                            *
  3011*                                                                *
  3012*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3013*                                                                *
  3014*   FILE TYPE = VSAM,KSDS                                        *
  3015*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3016*                                                                *
  3017*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3018*                                                                *
  3019*   LOG = YES                                                    *
  3020*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3021******************************************************************
  3022*                   C H A N G E   L O G
  3023*
  3024* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3025*-----------------------------------------------------------------
  3026*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3027* EFFECTIVE    NUMBER
  3028*-----------------------------------------------------------------
  3029* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3030* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3031* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3032* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3033* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3034* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3035* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3036* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  3037* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  3038******************************************************************
  3039
  3040 01  CERTIFICATE-TRAILERS.
  3041     12  CS-RECORD-ID                      PIC XX.
  3042         88  VALID-CS-ID                      VALUE 'CS'.
  3043
  3044     12  CS-CONTROL-PRIMARY.
  3045         16  CS-COMPANY-CD                 PIC X.
  3046         16  CS-CARRIER                    PIC X.
  3047         16  CS-GROUPING                   PIC X(6).
  3048         16  CS-STATE                      PIC XX.
  3049         16  CS-ACCOUNT                    PIC X(10).
  3050         16  CS-CERT-EFF-DT                PIC XX.
  3051         16  CS-CERT-NO.
  3052             20  CS-CERT-PRIME             PIC X(10).
  3053             20  CS-CERT-SFX               PIC X.
  3054         16  CS-TRAILER-TYPE               PIC X.
  3055             88  COMM-TRLR           VALUE 'A'.
  3056             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3057             88  CERT-DATA-TRLR      VALUE 'C'.
  3058
  3059     12  CS-DATA-AREA                      PIC X(516).
  3060
  3061     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  3062         16  CS-BANK-COMMISSION-AREA.
  3063             20  CS-BANK-COMMS       OCCURS 10.
  3064                 24  CS-AGT                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  58
* EL050.cbl
  3065                 24  CS-COM-TYP            PIC X.
  3066                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3067                 24  CS-RECALC-LV-INDIC    PIC X.
  3068                 24  FILLER                PIC X(10).
  3069         16  FILLER                        PIC X(256).
  3070
  3071     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3072****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3073         16  CS-MB-CLAIM-DATA OCCURS 24.
  3074             20  CS-CLAIM-NO               PIC X(7).
  3075             20  CS-CLAIM-TYPE             PIC X.
  3076                 88  CS-AH-CLM               VALUE 'A'.
  3077                 88  CS-IU-CLM               VALUE 'I'.
  3078                 88  CS-GP-CLM               VALUE 'G'.
  3079                 88  CS-LF-CLM               VALUE 'L'.
  3080                 88  CS-PR-CLM               VALUE 'P'.
  3081                 88  CS-FL-CLM               VALUE 'F'.
  3082             20  CS-INSURED-TYPE           PIC X.
  3083                 88  CS-PRIM-INSURED          VALUE 'P'.
  3084                 88  CS-CO-BORROWER           VALUE 'C'.
  3085             20  CS-BENEFIT-PERIOD         PIC 99.
  3086             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3087             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3088             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3089         16  FILLER                        PIC X(12).
  3090     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3091         16  CS-VIN-NUMBER                 PIC X(17).
  3092         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3093         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3094         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3095         16  cs-agent-name.
  3096             20  cs-agent-fname            pic x(20).
  3097             20  cs-agent-mi               pic x.
  3098             20  cs-agent-lname            pic x(25).
  3099         16  cs-license-no                 pic x(15).
  3100         16  cs-npn-number                 pic x(10).
  3101         16  cs-agent-edit-status          pic x.
  3102             88  cs-ae-refer-to-manager      value 'M'.
  3103             88  cs-ae-cover-sheet           value 'C'.
  3104             88  cs-ae-sig-form              value 'S'.
  3105             88  cs-ae-verified              value 'V'.
  3106             88  cs-unidentified-signature   value 'U'.
  3107             88  cs-cert-returned            value 'R'.
  3108             88  cs-accept-no-commission     value 'N'.
  3109         16  cs-year                       pic 9999.
  3110         16  cs-make                       pic x(20).
  3111         16  cs-model                      pic x(20).
  3112         16  cs-future                     pic x(20).
  3113         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3114         16  FILLER                        PIC X(356). *> was 420
  3115*        16  FILLER                        PIC X(496).
  3116*    COPY ELCCRTO.
  3117******************************************************************
  3118*                                                                *
  3119*                            ELCCRTO.                            *
  3120*                                                                *
  3121*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  3122*                                                                *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  59
* EL050.cbl
  3123*   FILE TYPE = VSAM,KSDS                                        *
  3124*   RECORD SIZE = 524  RECFORM = FIXED                           *
  3125*                                                                *
  3126*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  3127*                                                                *
  3128*   LOG = YES                                                    *
  3129*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3130******************************************************************
  3131*                   C H A N G E   L O G
  3132*
  3133* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3134*-----------------------------------------------------------------
  3135*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3136* EFFECTIVE    NUMBER
  3137*-----------------------------------------------------------------
  3138* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  3139* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  3140* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  3141* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3142* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  3143******************************************************************
  3144 01  ORIGINAL-CERTIFICATE.
  3145     12  OC-RECORD-ID                      PIC XX.
  3146         88  VALID-OC-ID                      VALUE 'OC'.
  3147     12  OC-CONTROL-PRIMARY.
  3148         16  OC-COMPANY-CD                 PIC X.
  3149         16  OC-CARRIER                    PIC X.
  3150         16  OC-GROUPING                   PIC X(6).
  3151         16  OC-STATE                      PIC XX.
  3152         16  OC-ACCOUNT                    PIC X(10).
  3153         16  OC-CERT-EFF-DT                PIC XX.
  3154         16  OC-CERT-NO.
  3155             20  OC-CERT-PRIME             PIC X(10).
  3156             20  OC-CERT-SFX               PIC X.
  3157         16  OC-RECORD-TYPE                PIC X.
  3158         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3159     12  OC-LAST-MAINT-DT                  PIC XX.
  3160     12  OC-LAST-MAINT-BY                  PIC X(4).
  3161     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3162     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3163     12  FILLER                            PIC X(49).
  3164     12  OC-ORIG-REC.
  3165         16  OC-INS-LAST-NAME              PIC X(15).
  3166         16  OC-INS-FIRST-NAME             PIC X(10).
  3167         16  OC-INS-MIDDLE-INIT            PIC X.
  3168         16  OC-INS-AGE                    PIC S999     COMP-3.
  3169         16  OC-JNT-LAST-NAME              PIC X(15).
  3170         16  OC-JNT-FIRST-NAME             PIC X(10).
  3171         16  OC-JNT-MIDDLE-INIT            PIC X.
  3172         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3173         16  OC-LF-BENCD                   PIC XX.
  3174         16  OC-LF-TERM                    PIC S999      COMP-3.
  3175         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3176         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3177         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3178         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3179         16  OC-LF-EXP-DT                  PIC XX.
  3180         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  60
* EL050.cbl
  3181         16  OC-LF-CANCEL-DT               PIC XX.
  3182         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3183         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3184         16  OC-AH-BENCD                   PIC XX.
  3185         16  OC-AH-TERM                    PIC S999      COMP-3.
  3186         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3187         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3188         16  OC-AH-EXP-DT                  PIC XX.
  3189         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3190         16  OC-AH-CP                      PIC 99.
  3191         16  OC-AH-CANCEL-DT               PIC XX.
  3192         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3193         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3194         16  OC-CRED-BENE-NAME             PIC X(25).
  3195         16  OC-1ST-PMT-DT                 PIC XX.
  3196         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3197         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3198         16  OC-ISSUE-TRAN-IND             PIC X.
  3199         16  OC-CANCEL-TRAN-IND            PIC X.
  3200         16  FILLER                        PIC X(211).
  3201
  3202     12  FILLER                            PIC X(50).
  3203******************************************************************
  3204
  3205*    COPY ELCDATE.
  3206******************************************************************
  3207*                                                                *
  3208*                                                                *
  3209*                            ELCDATE.                            *
  3210*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3211*                            VMOD=2.003
  3212*                                                                *
  3213*                                                                *
  3214*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3215*                 LENGTH = 200                                   *
  3216******************************************************************
  3217
  3218 01  DATE-CONVERSION-DATA.
  3219     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3220     12  DC-OPTION-CODE                PIC X.
  3221         88  BIN-TO-GREG                VALUE ' '.
  3222         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3223         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3224         88  YMD-GREG-TO-BIN            VALUE '3'.
  3225         88  MDY-GREG-TO-BIN            VALUE '4'.
  3226         88  JULIAN-TO-BIN              VALUE '5'.
  3227         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3228         88  FIND-CENTURY               VALUE '7'.
  3229         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3230         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3231         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3232         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3233         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3234         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3235         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3236         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3237         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3238         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  61
* EL050.cbl
  3239         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3240         88  BIN-3-TO-GREG              VALUE 'I'.
  3241         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3242         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3243         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3244         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3245         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3246         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3247         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3248         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3249         88  THREE-CHARACTER-BIN
  3250                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3251         88  GREGORIAN-TO-BIN
  3252                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3253         88  BIN-TO-GREGORIAN
  3254                  VALUES ' ' '1' 'I' '8' 'G'.
  3255         88  JULIAN-TO-BINARY
  3256                  VALUES '5' 'C' 'E' 'F'.
  3257     12  DC-ERROR-CODE                 PIC X.
  3258         88  NO-CONVERSION-ERROR        VALUE ' '.
  3259         88  DATE-CONVERSION-ERROR
  3260                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3261         88  DATE-IS-ZERO               VALUE '1'.
  3262         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3263         88  DATE-IS-INVALID            VALUE '3'.
  3264         88  DATE1-GREATER-DATE2        VALUE '4'.
  3265         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3266         88  DATE-INVALID-OPTION        VALUE '9'.
  3267         88  INVALID-CENTURY            VALUE 'A'.
  3268         88  ONLY-CENTURY               VALUE 'B'.
  3269         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3270         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3271     12  DC-END-OF-MONTH               PIC X.
  3272         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3273     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3274         88  USE-NORMAL-PROCESS         VALUE ' '.
  3275         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3276         88  ADJUST-UP-100-YRS          VALUE '2'.
  3277     12  FILLER                        PIC X.
  3278     12  DC-CONVERSION-DATES.
  3279         16  DC-BIN-DATE-1             PIC XX.
  3280         16  DC-BIN-DATE-2             PIC XX.
  3281         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3282         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3283                       DC-GREG-DATE-1-EDIT.
  3284             20  DC-EDIT1-MONTH        PIC 99.
  3285             20  SLASH1-1              PIC X.
  3286             20  DC-EDIT1-DAY          PIC 99.
  3287             20  SLASH1-2              PIC X.
  3288             20  DC-EDIT1-YEAR         PIC 99.
  3289         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3290         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3291                     DC-GREG-DATE-2-EDIT.
  3292             20  DC-EDIT2-MONTH        PIC 99.
  3293             20  SLASH2-1              PIC X.
  3294             20  DC-EDIT2-DAY          PIC 99.
  3295             20  SLASH2-2              PIC X.
  3296             20  DC-EDIT2-YEAR         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  62
* EL050.cbl
  3297         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3298         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3299                     DC-GREG-DATE-1-YMD.
  3300             20  DC-YMD-YEAR           PIC 99.
  3301             20  DC-YMD-MONTH          PIC 99.
  3302             20  DC-YMD-DAY            PIC 99.
  3303         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3304         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3305                      DC-GREG-DATE-1-MDY.
  3306             20  DC-MDY-MONTH          PIC 99.
  3307             20  DC-MDY-DAY            PIC 99.
  3308             20  DC-MDY-YEAR           PIC 99.
  3309         16  DC-GREG-DATE-1-ALPHA.
  3310             20  DC-ALPHA-MONTH        PIC X(10).
  3311             20  DC-ALPHA-DAY          PIC 99.
  3312             20  FILLER                PIC XX.
  3313             20  DC-ALPHA-CENTURY.
  3314                 24 DC-ALPHA-CEN-N     PIC 99.
  3315             20  DC-ALPHA-YEAR         PIC 99.
  3316         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3317         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3318         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3319         16  DC-JULIAN-DATE            PIC 9(05).
  3320         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3321                                       PIC 9(05).
  3322         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3323             20  DC-JULIAN-YEAR        PIC 99.
  3324             20  DC-JULIAN-DAYS        PIC 999.
  3325         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3326         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3327         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3328     12  DATE-CONVERSION-VARIBLES.
  3329         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3330         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3331             20  FILLER                PIC 9(3).
  3332             20  HOLD-CEN-1-CCYY.
  3333                 24  HOLD-CEN-1-CC     PIC 99.
  3334                 24  HOLD-CEN-1-YY     PIC 99.
  3335             20  HOLD-CEN-1-MO         PIC 99.
  3336             20  HOLD-CEN-1-DA         PIC 99.
  3337         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3338             20  HOLD-CEN-1-R-MO       PIC 99.
  3339             20  HOLD-CEN-1-R-DA       PIC 99.
  3340             20  HOLD-CEN-1-R-CCYY.
  3341                 24  HOLD-CEN-1-R-CC   PIC 99.
  3342                 24  HOLD-CEN-1-R-YY   PIC 99.
  3343             20  FILLER                PIC 9(3).
  3344         16  HOLD-CENTURY-1-X.
  3345             20  FILLER                PIC X(3)  VALUE SPACES.
  3346             20  HOLD-CEN-1-X-CCYY.
  3347                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3348                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3349             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3350             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3351         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3352             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3353             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3354             20  HOLD-CEN-1-R-X-CCYY.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  63
* EL050.cbl
  3355                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3356                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3357             20  FILLER                PIC XXX.
  3358         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3359         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3360         16  DC-JULIAN-DATE-1          PIC 9(07).
  3361         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3362             20  DC-JULIAN-1-CCYY.
  3363                 24  DC-JULIAN-1-CC    PIC 99.
  3364                 24  DC-JULIAN-1-YR    PIC 99.
  3365             20  DC-JULIAN-DA-1        PIC 999.
  3366         16  DC-JULIAN-DATE-2          PIC 9(07).
  3367         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3368             20  DC-JULIAN-2-CCYY.
  3369                 24  DC-JULIAN-2-CC    PIC 99.
  3370                 24  DC-JULIAN-2-YR    PIC 99.
  3371             20  DC-JULIAN-DA-2        PIC 999.
  3372         16  DC-GREG-DATE-A-EDIT.
  3373             20  DC-EDITA-MONTH        PIC 99.
  3374             20  SLASHA-1              PIC X VALUE '/'.
  3375             20  DC-EDITA-DAY          PIC 99.
  3376             20  SLASHA-2              PIC X VALUE '/'.
  3377             20  DC-EDITA-CCYY.
  3378                 24  DC-EDITA-CENT     PIC 99.
  3379                 24  DC-EDITA-YEAR     PIC 99.
  3380         16  DC-GREG-DATE-B-EDIT.
  3381             20  DC-EDITB-MONTH        PIC 99.
  3382             20  SLASHB-1              PIC X VALUE '/'.
  3383             20  DC-EDITB-DAY          PIC 99.
  3384             20  SLASHB-2              PIC X VALUE '/'.
  3385             20  DC-EDITB-CCYY.
  3386                 24  DC-EDITB-CENT     PIC 99.
  3387                 24  DC-EDITB-YEAR     PIC 99.
  3388         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3389         16  DC-GREG-DATE-CYMD-R REDEFINES
  3390                              DC-GREG-DATE-CYMD.
  3391             20  DC-CYMD-CEN           PIC 99.
  3392             20  DC-CYMD-YEAR          PIC 99.
  3393             20  DC-CYMD-MONTH         PIC 99.
  3394             20  DC-CYMD-DAY           PIC 99.
  3395         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3396         16  DC-GREG-DATE-MDCY-R REDEFINES
  3397                              DC-GREG-DATE-MDCY.
  3398             20  DC-MDCY-MONTH         PIC 99.
  3399             20  DC-MDCY-DAY           PIC 99.
  3400             20  DC-MDCY-CEN           PIC 99.
  3401             20  DC-MDCY-YEAR          PIC 99.
  3402    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3403        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3404    12  DC-EL310-DATE                  PIC X(21).
  3405    12  FILLER                         PIC X(28).
  3406
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  64
* EL050.cbl
  3408*    COPY ELCCALC.
  3409******************************************************************
  3410*                                                                *
  3411*                           ELCCALC.                            *
  3412*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3413*                            VMOD=2.025                          *
  3414*                                                                *
  3415*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3416*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3417*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3418*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3419*                                                                *
  3420*  PASSED TO ELRTRM                                              *
  3421*  -----------------                                             *
  3422*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3423*  ORIGINAL TERM                                                 *
  3424*  BEGINNING DATE                                                *
  3425*  ENDING DATE                                                   *
  3426*  COMPANY I.D.                                                  *
  3427*  ACCOUNT MASTER USER FIELD                                     *
  3428*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3429*  FREE LOOK DAYS                                                *
  3430*                                                                *
  3431*  RETURNED FROM ELRTRM                                          *
  3432*  ---------------------                                         *
  3433*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3434*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3435*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3436*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3437*----------------------------------------------------------------*
  3438*  PASSED TO ELRAMT                                              *
  3439*  ----------------                                              *
  3440*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3441*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3442*  ORIGINAL AMOUNT                                               *
  3443*  ALTERNATE BENEFIT (BALLON)                                    *
  3444*  A.P.R. - NET PAY ONLY                                         *
  3445*  METHOD
  3446*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3447*  COMPANY I.D.                                                  *
  3448*  BENEFIT TYPE                                                  *
  3449*                                                                *
  3450*  RETURNED FROM ELRAMT                                          *
  3451*  --------------------                                          *
  3452*  REMAINING AMOUNT 1 - CURRENT                                  *
  3453*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3454*  REMAINING AMOUNT FACTOR
  3455*----------------------------------------------------------------*
  3456*  PASSED TO ELRESV                                              *
  3457*  -----------------                                             *
  3458*  CERTIFICATE EFFECTIVE DATE                                    *
  3459*  VALUATION DATE                                                *
  3460*  PAID THRU DATE                                                *
  3461*  BENEFIT                                                       *
  3462*  INCURRED DATE                                                 *
  3463*  REPORTED DATE                                                 *
  3464*  ISSUE AGE                                                     *
  3465*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  65
* EL050.cbl
  3466*  CDT PERCENT                                                   *
  3467*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3468* *CLAIM TYPE (LIFE, A/H)                                        *
  3469* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3470* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3471*                                                                *
  3472*  RETURNED FROM ELRESV                                          *
  3473*  --------------------                                          *
  3474*  CDT TABLE USED                                                *
  3475*  CDT FACTOR USED                                               *
  3476*  PAY TO CURRENT RESERVE                                        *
  3477*  I.B.N.R. - A/H ONLY                                           *
  3478*  FUTURE (ACCRUED) AH ONLY                                      *
  3479*----------------------------------------------------------------*
  3480*  PASSED TO ELRATE                                              *
  3481*  ----------------                                              *
  3482*  CERT ISSUE DATE                                               *
  3483*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3484*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3485*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3486*  STATE CODE (CLIENT DEFINED)                                   *
  3487*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3488*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3489*  DEVIATION CODE                                                *
  3490*  ISSUE AGE                                                     *
  3491*  ORIGINAL BENEFIT AMOUNT                                       *
  3492*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3493*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3494*  BENEFIT KIND (LIFE OR A/H)                                    *
  3495*  A.P.R.                                                        *
  3496*  METHOD
  3497*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3498*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3499*  COMPANY I.D. (3 CHARACTER)                                    *
  3500*  BENEFIT CODE                                                  *
  3501*  BENEFIT OVERRIDE CODE                                         *
  3502*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3503*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3504*  JOINT INDICATOR (CSL ONLY)                                    *
  3505*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3506*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3507*                                                                *
  3508*  RETURNED FROM ELRATE                                          *
  3509*  --------------------                                          *
  3510*  CALCULATED PREMIUM                                            *
  3511*  PREMIUM RATE                                                  *
  3512*  MORTALITY CODE                                                *
  3513*  MAX ATTAINED AGE                                              *
  3514*  MAX AGE                                                       *
  3515*  MAX TERM                                                      *
  3516*  MAX MONTHLY BENEFIT                                           *
  3517*  MAX TOTAL BENIFIT                                             *
  3518*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3519*----------------------------------------------------------------*
  3520*  PASSED TO ELRFND                                              *
  3521*  ----------------                                              *
  3522*  CERT ISSUE DATE                                               *
  3523*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  66
* EL050.cbl
  3524*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3525*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3526*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3527*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3528*  STATE CODE (CLIENT DEFINED)                                   *
  3529*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3530*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3531*  DEVIATION CODE                                                *
  3532*  ISSUE AGE                                                     *
  3533*  ORIGINAL BENEFIT AMOUNT                                       *
  3534*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3535*  PROCESS TYPE (CANCEL)                                         *
  3536*  BENEFIT KIND (LIFE OR A/H)                                    *
  3537*  A.P.R.                                                        *
  3538*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3539*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3540*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3541*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3542*  COMPANY I.D. (3 CHARACTER)                                    *
  3543*  BENEFIT CODE                                                  *
  3544*  BENEFIT OVERRIDE CODE                                         *
  3545*                                                                *
  3546*  RETURNED FROM ELRFND                                          *
  3547*  --------------------                                          *
  3548*  CALCULATED REFUND                                             *
  3549*----------------------------------------------------------------*
  3550*  PASSED TO ELEARN                                              *
  3551*  ----------------                                              *
  3552*  CERT ISSUE DATE                                               *
  3553*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3554*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3555*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3556*  STATE CODE (CLIENT DEFINED)                                   *
  3557*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3558*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3559*  DEVIATION CODE                                                *
  3560*  ISSUE AGE                                                     *
  3561*  ORIGINAL BENEFIT AMOUNT                                       *
  3562*  BENEFIT KIND (LIFE OR A/H)                                    *
  3563*  A.P.R.                                                        *
  3564*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3565*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3566*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3567*  COMPANY I.D. (3 CHARACTER)                                    *
  3568*  BENEFIT CODE                                                  *
  3569*  BENEFIT OVERRIDE CODE                                         *
  3570*                                                                *
  3571*  RETURNED FROM ELEARN                                          *
  3572*  --------------------                                          *
  3573*  INDICATED  EARNINGS                                           *
  3574*----------------------------------------------------------------*
  3575*                 LENGTH = 450                                   *
  3576*                                                                *
  3577******************************************************************
  3578******************************************************************
  3579*                   C H A N G E   L O G
  3580*
  3581* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  67
* EL050.cbl
  3582*-----------------------------------------------------------------
  3583*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3584* EFFECTIVE    NUMBER
  3585*-----------------------------------------------------------------
  3586* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3587* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3588* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3589* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3590* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3591* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3592* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3593* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3594* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3595* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3596* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3597******************************************************************
  3598
  3599 01  CALCULATION-PASS-AREA.
  3600     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3601                                     COMP.
  3602
  3603     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3604       88  NO-CP-ERROR                             VALUE ZERO.
  3605       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3606                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3607       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3608       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3609       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3610       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3611       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3612       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3613       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3614       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3615       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3616       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3617       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3618       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3619       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3620       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3621       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3622       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3623       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3624
  3625     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3626       88  NO-CP-ERROR-2                           VALUE ZERO.
  3627***********************  INPUT AREAS ****************************
  3628
  3629     12  CP-CALCULATION-AREA.
  3630         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3631         16  CP-CERT-EFF-DT        PIC XX.
  3632         16  CP-VALUATION-DT       PIC XX.
  3633         16  CP-PAID-THRU-DT       PIC XX.
  3634         16  CP-BENEFIT-TYPE       PIC X.
  3635           88  CP-AH                               VALUE 'A' 'D'
  3636                                                   'I' 'U'.
  3637           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3638           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3639         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  68
* EL050.cbl
  3640         16  CP-REPORTED-DT        PIC XX.
  3641         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3642         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3643         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3644                                     COMP-3.
  3645         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3646                                     COMP-3.
  3647         16  CP-CDT-METHOD         PIC X.
  3648           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3649           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3650           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3651         16  CP-CLAIM-TYPE         PIC X.
  3652           88  CP-AH-CLAIM                         VALUE 'A'.
  3653           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3654         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3655                                     COMP-3.
  3656         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3657                                     COMP-3.
  3658         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3659                                     COMP-3.
  3660         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3661                                     COMP-3.
  3662         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3663                                     COMP-3.
  3664         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3665                                     COMP-3.
  3666         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3667                                     COMP-3.
  3668         16  CP-REM-TERM-METHOD    PIC X.
  3669           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3670           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3671           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3672           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3673           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3674           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3675           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3676         16  CP-EARNING-METHOD     PIC X.
  3677           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3678           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3679           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3680           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3681           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3682           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3683           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3684           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3685           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3686           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3687           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3688           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3689           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3690           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3691         16  CP-PROCESS-TYPE       PIC X.
  3692           88  CP-CLAIM                            VALUE '1'.
  3693           88  CP-CANCEL                           VALUE '2'.
  3694           88  CP-ISSUE                            VALUE '3'.
  3695         16  CP-SPECIAL-CALC-CD    PIC X.
  3696           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3697           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  69
* EL050.cbl
  3698           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3699           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3700           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3701           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3702           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3703           88  CP-FARM-PLAN                    VALUE 'F'.
  3704           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3705           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3706           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3707           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3708           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3709           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3710           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3711           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3712           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3713           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3714                                                     'W' 'X'.
  3715           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3716           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3717           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3718           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3719           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3720           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3721           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3722           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3723           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3724           88  CP-CSL-METH-1                   VALUE '5'.
  3725           88  CP-CSL-METH-2                   VALUE '6'.
  3726           88  CP-CSL-METH-3                   VALUE '7'.
  3727           88  CP-CSL-METH-4                   VALUE '8'.
  3728
  3729         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3730                                     COMP-3.
  3731         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3732         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3733         16  CP-STATE              PIC XX          VALUE SPACE.
  3734         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3735         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3736           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3737               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3738         16  CP-R78-OPTION         PIC X.
  3739           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3740           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3741
  3742         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3743         16  CP-IBNR-RESERVE-SW    PIC X.
  3744         16  CP-CLAIM-STATUS       PIC X.
  3745         16  CP-RATE-FILE          PIC X.
  3746         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3747                                     COMP-3.
  3748
  3749         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3750         16  CP-AH-OVERRIDE-CODE   PIC X.
  3751
  3752         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3753                                     COMP-3.
  3754         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3755                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  70
* EL050.cbl
  3756         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3757                                     COMP-3.
  3758         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3759                                     COMP-3.
  3760         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3761                                     COMP-3.
  3762         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3763                                  PIC S9(7)V99 COMP-3.
  3764
  3765         16  CP-PAID-FROM-DATE     PIC X(02).
  3766         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3767         16  CP-EXT-DAYS-CALC      PIC X.
  3768           88  CP-EXT-NO-CHG                   VALUE ' '.
  3769           88  CP-EXT-CHG-LF                   VALUE '1'.
  3770           88  CP-EXT-CHG-AH                   VALUE '2'.
  3771           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3772         16  CP-DOMICILE-STATE     PIC XX.
  3773         16  CP-CARRIER            PIC X.
  3774         16  CP-REIN-FLAG          PIC X.
  3775         16  CP-REM-TRM-CALC-OPTION PIC X.
  3776           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3777                      '2' '3' '4' '5'.
  3778           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3779           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3780           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3781           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3782           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3783           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3784           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3785           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3786         16  CP-SIG-SWITCH         PIC X.
  3787         16  CP-RATING-METHOD      PIC X.
  3788           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3789           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3790           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3791           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3792           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3793           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3794           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3795           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3796           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3797         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3798                                     COMP-3.
  3799         16  CP-BEN-CATEGORY       PIC X.
  3800         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3801         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3802                                   PIC S99V9(5) COMP-3.
  3803         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3804         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3805                                   PIC S99V9(5) COMP-3.
  3806         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3807         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3808         16  CP-EXPIRE-DT          PIC XX.
  3809         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3810         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3811         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3812         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3813         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  71
* EL050.cbl
  3814             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3815             88  CP-CALC-CLP              VALUE 'C'.
  3816         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3817         16  CP-CANCEL-REASON      PIC X.
  3818         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3819         16  CP-PMT-MODE           PIC X.
  3820         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3821         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3822         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3823         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3824         16  FILLER                PIC X.
  3825
  3826***************    OUTPUT FROM ELRESV   ************************
  3827
  3828         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3829
  3830         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3831                                     COMP-3.
  3832         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3833                                     COMP-3.
  3834         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3835                                     COMP-3.
  3836         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3837                                     COMP-3.
  3838         16  FILLER                PIC X(09).
  3839***************    OUTPUT FROM ELRTRM   *************************
  3840
  3841         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3842                                     COMP-3.
  3843         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3844                                     COMP-3.
  3845         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3846                                     COMP-3.
  3847         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3848                                     COMP-3.
  3849         16  FILLER                PIC X(12).
  3850
  3851***************    OUTPUT FROM ELRAMT   *************************
  3852
  3853         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3854                                     COMP-3.
  3855         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3856                                     COMP-3.
  3857         16  FILLER                PIC X(12).
  3858
  3859***************    OUTPUT FROM ELRATE   *************************
  3860
  3861         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3862                                     COMP-3.
  3863         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3864                                     COMP-3.
  3865         16  CP-MORTALITY-CODE     PIC X(4).
  3866         16  CP-RATE-EDIT-FLAG     PIC X.
  3867             88  CP-RATES-NEED-APR                  VALUE '1'.
  3868         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3869                                     COMP-3.
  3870         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3871         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  72
* EL050.cbl
  3872         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3873                                   PIC S9(7)V99 COMP-3.
  3874         16  FILLER                PIC X(07).
  3875
  3876***************    OUTPUT FROM ELRFND   *************************
  3877
  3878         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3879                                     COMP-3.
  3880         16  CP-REFUND-TYPE-USED   PIC X.
  3881           88  CP-R-AS-R78                         VALUE '1'.
  3882           88  CP-R-AS-PRORATA                     VALUE '2'.
  3883           88  CP-R-AS-CALIF                       VALUE '3'.
  3884           88  CP-R-AS-TEXAS                       VALUE '4'.
  3885           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3886           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3887           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3888           88  CP-R-AS-MEAN                        VALUE '8'.
  3889           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3890           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3891           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3892           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3893           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3894           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3895         16  FILLER                PIC X(12).
  3896
  3897***************    OUTPUT FROM ELEARN   *************************
  3898
  3899         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3900                                     COMP-3.
  3901         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3902                                     COMP-3.
  3903         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3904                                     COMP-3.
  3905         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3906                                     COMP-3.
  3907         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3908                                     COMP-3.
  3909         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3910                                     COMP-3.
  3911         16  CP-EARNING-TYPE-USED  PIC X.
  3912           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3913           88  CP-E-AS-R78                         VALUE '1'.
  3914           88  CP-E-AS-PRORATA                     VALUE '2'.
  3915           88  CP-E-AS-TEXAS                       VALUE '4'.
  3916           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3917           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3918           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3919           88  CP-E-AS-MEAN                        VALUE '8'.
  3920           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3921         16  FILLER                PIC X(12).
  3922
  3923***************    OUTPUT FROM ELPMNT   *************************
  3924
  3925         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3926                                     COMP-3.
  3927         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3928                                     COMP-3.
  3929         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  73
* EL050.cbl
  3930
  3931***************   MISC WORK AREAS    *****************************
  3932         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3933                                     COMP-3.
  3934         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3935                                     COMP-3.
  3936         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3937                                     COMP-3.
  3938         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3939                                     COMP-3.
  3940         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3941                                     COMP-3.
  3942         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3943                                     COMP-3.
  3944         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3945             88  OPEN-RATE-FILE                   VALUE 'O'.
  3946             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3947             88  IO-ERROR                         VALUE 'E'.
  3948
  3949         16  CP-FIRST-PAY-DATE     PIC XX.
  3950
  3951         16  CP-JOINT-INDICATOR    PIC X.
  3952
  3953         16  CP-RESERVE-REMAINING-TERM
  3954                                   PIC S9(4)V9    VALUE ZERO
  3955                                     COMP-3.
  3956
  3957         16  CP-INSURED-BIRTH-DT   PIC XX.
  3958
  3959         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3960                                     COMP-3.
  3961
  3962         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3963                                     COMP-3.
  3964
  3965         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3966                                     COMP-3.
  3967
  3968         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3969                                     COMP-3.
  3970
  3971         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3972                                     COMP-3.
  3973
  3974         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3975                                     COMP-3.
  3976
  3977         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3978                                     COMP-3.
  3979
  3980         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3981             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3982
  3983         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3984                                     COMP-3.
  3985         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3986                                     COMP-3.
  3987         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  74
* EL050.cbl
  3988         16  cp-extra-periods      pic 9 value zeros.
  3989         16  cp-net-only-state     pic x value spaces.
  3990         16  FILLER                PIC X(13).
  3991******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  75
* EL050.cbl
  3993******************************************************************
  3994*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3995*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3996*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3997*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3998*** MODIFICATION.                                              ***
  3999*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  4000*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  4001******************************************************************
  4002*    COPY ERCPNDB.
  4003******************************************************************
  4004*                                                                *
  4005*                                                                *
  4006*                            ERCPNDB.                            *
  4007*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4008*                            VMOD=2.025                          *
  4009*                                                                *
  4010*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4011*                                                                *
  4012******************************************************************
  4013*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4014*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4015******************************************************************
  4016*                                                                *
  4017*                                                                *
  4018*   FILE TYPE = VSAM,KSDS                                        *
  4019*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4020*                                                                *
  4021*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4022*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4023*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4024*                                                 RKP=13,LEN=36  *
  4025*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4026*                                      AND CHG-SEQ.)             *
  4027*                                                RKP=49,LEN=11   *
  4028*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4029*                                      AND CHG-SEQ.)             *
  4030*                                                RKP=60,LEN=15   *
  4031*                                                                *
  4032*   LOG = NO                                                     *
  4033*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4034******************************************************************
  4035******************************************************************
  4036*                   C H A N G E   L O G
  4037*
  4038* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4039*-----------------------------------------------------------------
  4040*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4041* EFFECTIVE    NUMBER
  4042*-----------------------------------------------------------------
  4043* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4044* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4045* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4046* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4047* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4048* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4049* 032306                   PEMA  ADD BOW LOAN NUMBER
  4050* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  76
* EL050.cbl
  4051* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4052* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4053* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4054* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4055* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4056* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4057* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4058* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4059* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4060* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  4061******************************************************************
  4062
  4063 01  PENDING-BUSINESS.
  4064     12  PB-RECORD-ID                     PIC XX.
  4065         88  VALID-PB-ID                        VALUE 'PB'.
  4066
  4067     12  PB-CONTROL-PRIMARY.
  4068         16  PB-COMPANY-CD                PIC X.
  4069         16  PB-ENTRY-BATCH               PIC X(6).
  4070         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4071         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4072
  4073     12  PB-CONTROL-BY-ACCOUNT.
  4074         16  PB-COMPANY-CD-A1             PIC X.
  4075         16  PB-CARRIER                   PIC X.
  4076         16  PB-GROUPING.
  4077             20  PB-GROUPING-PREFIX       PIC XXX.
  4078             20  PB-GROUPING-PRIME        PIC XXX.
  4079         16  PB-STATE                     PIC XX.
  4080         16  PB-ACCOUNT.
  4081             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4082             20  PB-ACCOUNT-PRIME         PIC X(6).
  4083         16  PB-CERT-EFF-DT               PIC XX.
  4084         16  PB-CERT-NO.
  4085             20  PB-CERT-PRIME            PIC X(10).
  4086             20  PB-CERT-SFX              PIC X.
  4087         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4088
  4089         16  PB-RECORD-TYPE               PIC X.
  4090             88  PB-MAILING-DATA                VALUE '0'.
  4091             88  PB-ISSUE                       VALUE '1'.
  4092             88  PB-CANCELLATION                VALUE '2'.
  4093             88  PB-BATCH-TRAILER               VALUE '9'.
  4094
  4095     12  PB-CONTROL-BY-ORIG-BATCH.
  4096         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4097         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4098         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4099         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4100
  4101     12  PB-CONTROL-BY-CSR.
  4102         16  PB-CSR-COMPANY-CD            PIC X.
  4103         16  PB-CSR-ID                    PIC X(4).
  4104         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4105         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4106         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4107******************************************************************
  4108*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  77
* EL050.cbl
  4109******************************************************************
  4110
  4111     12  PB-LAST-MAINT-DT                 PIC XX.
  4112     12  PB-LAST-MAINT-BY                 PIC X(4).
  4113     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4114
  4115     12  PB-RECORD-BODY                   PIC X(375).
  4116
  4117     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4118         16  PB-CERT-ORIGIN               PIC X.
  4119             88  CLASIC-CREATED-CERT         VALUE '1'.
  4120         16  PB-I-NAME.
  4121             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4122             20  PB-I-INSURED-FIRST-NAME.
  4123                 24  PB-I-INSURED-1ST-INIT PIC X.
  4124                 24  FILLER                PIC X(9).
  4125             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4126         16  PB-I-AGE                     PIC S99   COMP-3.
  4127         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4128         16  PB-I-BIRTHDAY                PIC XX.
  4129         16  PB-I-INSURED-SEX             PIC X.
  4130             88  PB-SEX-MALE     VALUE 'M'.
  4131             88  PB-SEX-FEMALE   VALUE 'F'.
  4132
  4133         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4134         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4135         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4136         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4137         16  PB-I-SKIP-CODE               PIC X.
  4138             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4139             88  PB-SKIP-JULY              VALUE '1'.
  4140             88  PB-SKIP-AUGUST            VALUE '2'.
  4141             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4142             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4143             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4144             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4145             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4146             88  PB-SKIP-JUNE              VALUE '8'.
  4147             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4148             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4149             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4150         16  PB-I-TERM-TYPE               PIC X.
  4151             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4152             88  PB-PAID-WEEKLY            VALUE 'W'.
  4153             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4154             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4155             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4156         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4157         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4158         16  PB-I-DATA-ENTRY-SW           PIC X.
  4159             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4160             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4161             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4162             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4163         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4164         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4165*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4166         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  78
* EL050.cbl
  4167         16  FILLER                       PIC X.
  4168
  4169         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4170             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4171             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4172                                                   '90' THRU '99'.
  4173         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4174                                          PIC XX.
  4175         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4176         16  PB-I-AMOUNT-FINANCED REDEFINES
  4177                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4178         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4179         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4180                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4181         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4182         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4183         16  PB-I-CLP-AMOUNT REDEFINES
  4184                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4185         16  PB-I-LF-CALC-FLAG            PIC X.
  4186             88 PB-COMP-LF-PREM               VALUE '?'.
  4187         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4188         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4189         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4190         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4191         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4192         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4193         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4194         16  PB-I-LF-ABBR                 PIC XXX.
  4195         16  PB-I-LF-INPUT-CD             PIC XX.
  4196
  4197         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4198             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4199             88  PB-INVALID-AH               VALUE '  ' '00'
  4200                                                   '90' THRU '99'.
  4201         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4202         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4203         16  PB-I-AH-CALC-FLAG            PIC X.
  4204             88 PB-COMP-AH-PREM                  VALUE '?'.
  4205         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4206         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4207         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  4208         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4209         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4210         16  PB-I-AH-ABBR                 PIC XXX.
  4211         16  PB-I-AH-INPUT-CD             PIC XXX.
  4212
  4213         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4214         16  PB-I-REIN-TABLE              PIC XXX.
  4215         16  PB-I-BUSINESS-TYPE           PIC 99.
  4216         16  PB-I-INDV-GRP-CD             PIC X.
  4217         16  PB-I-MORT-CODE.
  4218             20  PB-I-TABLE               PIC X.
  4219             20  PB-I-INTEREST            PIC XX.
  4220             20  PB-I-MORT-TYP            PIC X.
  4221         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4222         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4223         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4224         16  PB-I-INDV-GRP-OVRD           PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  79
* EL050.cbl
  4225         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4226         16  PB-I-SIG-SW                  PIC X.
  4227             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4228         16  PB-I-RATE-CLASS              PIC XX.
  4229         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4230         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4231         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4232         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4233         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4234         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4235         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4236         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4237         16  PB-I-OB-FLAG                 PIC X.
  4238             88  PB-I-OB                      VALUE 'B'.
  4239             88  PB-I-SUMMARY                 VALUE 'Z'.
  4240         16  PB-I-ENTRY-STATUS            PIC X.
  4241             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4242                                              'M' '5' '9' '2'.
  4243             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4244             88  PB-I-POLICY-PENDING          VALUE '2'.
  4245             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4246             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4247             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4248             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4249             88  PB-I-REIN-ONLY               VALUE '9'.
  4250             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4251             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4252             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4253             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4254         16  PB-I-INT-CODE                PIC X.
  4255             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4256             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4257         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4258         16  PB-I-SOC-SEC-NO              PIC X(11).
  4259         16  PB-I-MEMBER-NO               PIC X(12).
  4260         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4261*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4262         16  PB-I-OLD-LOF                 PIC XXX.
  4263         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4264         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4265         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4266         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4267         16  PB-I-LIFE-INDICATOR          PIC X.
  4268             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4269         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4270         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4271                                          PIC S9(5)V99    COMP-3.
  4272         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4273             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4274             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4275         16  PB-I-1ST-PMT-DT              PIC XX.
  4276         16  PB-I-JOINT-INSURED.
  4277             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4278             20 PB-I-JOINT-FIRST-NAME.
  4279                24  PB-I-JOINT-FIRST-INIT PIC X.
  4280                24  FILLER                PIC X(9).
  4281             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4282*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  80
* EL050.cbl
  4283         16  PB-I-BENEFICIARY-NAME.
  4284             20  PB-I-BANK-NUMBER         PIC X(10).
  4285             20  FILLER                   PIC X(15).
  4286         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4287         16  PB-I-REFERENCE               PIC X(12).
  4288         16  FILLER REDEFINES PB-I-REFERENCE.
  4289             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4290             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4291             20  PB-I-CLP-STATE           PIC XX.
  4292         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4293             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4294             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4295             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4296         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4297         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4298         16  PB-I-RESIDENT-STATE          PIC XX.
  4299         16  PB-I-RATE-CODE               PIC X(4).
  4300         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4301         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4302         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4303         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4304         16  PB-I-BANK-NOCHRGB            PIC 99.
  4305         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4306         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4307
  4308     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4309         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4310             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4311         16  PB-C-CANCEL-ORIGIN           PIC X.
  4312             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4313         16  PB-C-LF-CANCEL-DT            PIC XX.
  4314         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4315         16  PB-C-LF-CALC-REQ             PIC X.
  4316             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4317         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4318         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4319         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4320             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4321         16  PB-C-AH-CANCEL-DT            PIC XX.
  4322         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4323         16  PB-C-AH-CALC-REQ             PIC X.
  4324             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4325         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4326         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4327         16  PB-C-LAST-NAME               PIC X(15).
  4328         16  PB-C-REFUND-SW               PIC X.
  4329             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4330             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4331         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4332         16  PB-C-PAYEE-CODE              PIC X(6).
  4333         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4334         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4335         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4336         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4337         16  PB-C-REFERENCE               PIC X(12).
  4338         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4339         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4340         16  PB-C-POST-CARD-IND           PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  81
* EL050.cbl
  4341         16  PB-C-CANCEL-REASON           PIC X.
  4342         16  PB-C-REF-INTERFACE-SW        PIC X.
  4343         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4344         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4345         16  FILLER                       PIC X(01).
  4346*        16  FILLER                       PIC X(18).
  4347         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4348*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4349         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4350         16  PB-CANCELED-CERT-DATA.
  4351             20  PB-CI-INSURED-NAME.
  4352                 24  PB-CI-LAST-NAME      PIC X(15).
  4353                 24  PB-CI-INITIALS       PIC XX.
  4354             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4355             20  PB-CI-INSURED-SEX        PIC X.
  4356             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4357             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4358             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4359             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4360             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4361             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4362             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4363             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4364             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4365             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4366             20  PB-CI-RATE-CLASS         PIC XX.
  4367             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4368             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4369             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4370             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4371             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4372             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4373             20  PB-CI-LF-ABBR            PIC X(3).
  4374             20  PB-CI-AH-ABBR            PIC X(3).
  4375             20  PB-CI-OB-FLAG            PIC X.
  4376                 88  PB-CI-OB                VALUE 'B'.
  4377             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4378                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4379                                           'M' '4' '5' '9' '2'.
  4380                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4381                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4382                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4383                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4384                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4385                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4386                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4387                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4388                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4389                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4390                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4391                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4392                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4393             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4394                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4395                                           'M' '4' '5' '9' '2'.
  4396                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4397                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4398                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  82
* EL050.cbl
  4399                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4400                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4401                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4402                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4403                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4404                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4405                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4406                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4407                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4408                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4409             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4410             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4411             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4412             20  PB-CI-MEMBER-NO          PIC X(12).
  4413             20  PB-CI-INT-CODE           PIC X.
  4414                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4415                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4416             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4417             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4418             20  PB-CI-COMP-EXCP-SW       PIC X.
  4419                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4420                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4421             20  PB-CI-ENTRY-STATUS       PIC X.
  4422             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4423             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4424             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4425             20  PB-CI-DEATH-DT           PIC XX.
  4426             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4427             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4428             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4429             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4430             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4431             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4432             20  PB-CI-ENTRY-DT              PIC XX.
  4433             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4434             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4435             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4436             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4437             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4438             20  PB-CI-OLD-LOF               PIC XXX.
  4439*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4440             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4441             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4442             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4443             20  PB-CI-INDV-GRP-CD           PIC X.
  4444             20  PB-CI-BENEFICIARY-NAME.
  4445                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4446                 24  FILLER                  PIC X(15).
  4447             20  PB-CI-NOTE-SW               PIC X.
  4448             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4449             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4450             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4451             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4452             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4453             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4454             20  PB-CI-FIRST-NAME            PIC X(10).
  4455             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4456
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  83
* EL050.cbl
  4457         16  FILLER                       PIC X(13).
  4458*032306  16  FILLER                       PIC X(27).
  4459*        16  FILLER                       PIC X(46).
  4460
  4461     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4462         16  FILLER                       PIC X(10).
  4463         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4464         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4465         16  PB-M-INSURED-MID-INIT        PIC X.
  4466         16  PB-M-INSURED-AGE             PIC 99.
  4467         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4468         16  PB-M-INSURED-SEX             PIC X.
  4469         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4470         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4471         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4472         16  PB-M-INSURED-CITY-STATE.
  4473             20  PB-M-INSURED-CITY        PIC X(28).
  4474             20  PB-M-INSURED-STATE       PIC XX.
  4475         16  PB-M-INSURED-ZIP-CODE.
  4476             20  PB-M-INSURED-ZIP-PRIME.
  4477                 24  PB-M-INSURED-ZIP-1   PIC X.
  4478                     88  PB-M-CANADIAN-POST-CODE
  4479                                             VALUE 'A' THRU 'Z'.
  4480                 24  FILLER               PIC X(4).
  4481             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4482         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4483                                        PB-M-INSURED-ZIP-CODE.
  4484             20  PM-M-INS-CAN-POST1       PIC XXX.
  4485             20  PM-M-INS-CAN-POST2       PIC XXX.
  4486             20  FILLER                   PIC XXX.
  4487         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4488         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4489         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4490         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4491         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4492         16  PB-M-CRED-BENE-CITYST.
  4493             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4494             20  PB-M-CRED-BENE-STATE     PIC XX.
  4495         16  FILLER                       PIC X(92).
  4496
  4497     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4498         16  FILLER                       PIC X(10).
  4499         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4500         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4501         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4502         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4503         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4504         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4505         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4506         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4507         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4508         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4509         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4510         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4511         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4512         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4513         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4514         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  84
* EL050.cbl
  4515         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4516         16  PB-ACCOUNT-NAME              PIC X(30).
  4517         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4518         16  PB-REFERENCE                 PIC X(12).
  4519         16  PB-B-RECEIVED-DT             PIC XX.
  4520         16  FILLER                       PIC X(234).
  4521
  4522     12  PB-RECORD-STATUS.
  4523         16  PB-CREDIT-SELECT-DT          PIC XX.
  4524         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4525         16  PB-BILLED-DT                 PIC XX.
  4526         16  PB-BILLING-STATUS            PIC X.
  4527             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4528             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4529             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4530         16  PB-RECORD-BILL               PIC X.
  4531             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4532             88  PB-RECORD-RETURNED           VALUE 'R'.
  4533             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4534             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4535             88  PB-OVERRIDE-AH               VALUE 'A'.
  4536             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4537         16  PB-BATCH-ENTRY               PIC X.
  4538             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4539             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4540             88  PB-REISSUED-CERT             VALUE 'E'.
  4541             88  PB-CASH-CERT                 VALUE 'C'.
  4542             88  PB-MONTHLY-CERT              VALUE 'M'.
  4543             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4544             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4545             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4546         16  PB-FORCE-CODE                PIC X.
  4547             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4548             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4549             88  PB-CANCEL-FORCE              VALUE '8'.
  4550             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4551             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4552             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4553             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4554             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4555             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4556             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  4557             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4558         16  PB-FATAL-FLAG                PIC X.
  4559             88  PB-FATAL-ERRORS              VALUE 'X'.
  4560         16  PB-FORCE-ER-CD               PIC X.
  4561             88  PB-FORCE-ERRORS              VALUE 'F'.
  4562             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4563         16  PB-WARN-ER-CD                PIC X.
  4564             88  PB-WARNING-ERRORS            VALUE 'W'.
  4565         16  FILLER                       PIC X.
  4566         16  PB-OUT-BAL-CD                PIC X.
  4567             88  PB-OUT-OF-BAL                VALUE 'O'.
  4568         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4569         16  PB-AH-OVERRIDE-L1            PIC X.
  4570         16  PB-INPUT-DT                  PIC XX.
  4571         16  PB-INPUT-BY                  PIC X(4).
  4572         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  85
* EL050.cbl
  4573         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4574         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4575         16  PB-LF-EARNING-METHOD         PIC X.
  4576         16  PB-AH-EARNING-METHOD         PIC X.
  4577         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4578         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4579         16  PB-REIN-CD                   PIC XXX.
  4580         16  PB-LF-REFUND-TYPE            PIC X.
  4581         16  PB-AH-REFUND-TYPE            PIC X.
  4582         16  PB-ACCT-EFF-DT               PIC XX.
  4583         16  PB-ACCT-EXP-DT               PIC XX.
  4584         16  PB-COMPANY-ID                PIC X(3).
  4585         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4586         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4587         16  PB-SV-CARRIER                PIC X.
  4588         16  PB-SV-GROUPING               PIC X(6).
  4589         16  PB-SV-STATE                  PIC XX.
  4590         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4591         16  PB-GA-BILLING-INFO.
  4592             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4593                                          PIC XX.
  4594         16  PB-SV-REMIT-TO  REDEFINES
  4595             PB-GA-BILLING-INFO           PIC X(10).
  4596         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4597         16  PB-I-LOAN-OFFICER            PIC X(5).
  4598         16  PB-I-VIN                     PIC X(17).
  4599
  4600         16  FILLER                       PIC X(04).
  4601         16  IMNET-BYPASS-SW              PIC X.
  4602
  4603******************************************************************
  4604*                COMMON EDIT ERRORS                              *
  4605******************************************************************
  4606
  4607     12  PB-COMMON-ERRORS.
  4608         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4609                                           PIC S9(4)     COMP.
  4610
  4611******************************************************************
  4612
  4613* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4614*    COPY ELC50W1.
  4615******************************************************************
  4616*                                                                *
  4617*                                                                *
  4618*                             ELC50W1                            *
  4619*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4620*                            VMOD=2.004                          *
  4621*                                                                *
  4622*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4623*                                                                *
  4624*                                                                *
  4625******************************************************************
  4626
  4627     12  WK-WORK-AREA.
  4628         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4629         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4630         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  86
* EL050.cbl
  4631         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4632         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4633         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4634         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4635         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4636         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4637         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4638         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  4639         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4640         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4641         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4642         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4643         16  WK-CREDIT-EDIT-CONTROLS.
  4644             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4645             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4646             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4647             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4648             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4649             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4650         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4651         16  WK-SAVE-REIN-DATA.
  4652             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4653             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4654             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4655         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4656             88  ENTRY-FROM-EL6311       VALUE '6'.
  4657         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4658         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4659     12  WK-RECORD-ADDRESSES.
  4660         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4661         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4662         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4663         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4664         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4665         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4666         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4667         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4668     12  WK-OVER-SHORT-AREA.
  4669         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4670         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4671         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4672             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4673         16  FILLER                   PIC X(5) VALUE SPACES.
  4674
  4675*    COPY ELCEDITC.
  4676******************************************************************
  4677*                                                                *
  4678*                                                                *
  4679*                            ELCEDITC                            *
  4680*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4681*                            VMOD=2.012                          *
  4682*                                                                *
  4683*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4684*                     EL6313, EL050 AND EL517.                   *
  4685*                                                                *
  4686******************************************************************
  4687******************************************************************
  4688*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  87
* EL050.cbl
  4689*
  4690* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4691*-----------------------------------------------------------------
  4692*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4693* EFFECTIVE    NUMBER
  4694*-----------------------------------------------------------------
  4695* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4696******************************************************************
  4697
  4698     12  EDIT-CRITERIA-DATA.
  4699         16  EC-CO-MONTH-END-DT       PIC XX.
  4700         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4701         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4702         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4703         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4704         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4705         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4706         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4707         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4708         16  EC-CO-REM-TERM-CALC      PIC X.
  4709               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4710               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4711               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4712               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4713
  4714         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4715               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4716               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4717               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4718               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4719               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4720               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4721               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4722               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4723               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4724               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4725
  4726         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4727               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4728               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4729               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4730               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4731               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4732               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4733               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4734               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4735
  4736         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4737                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4738                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4739
  4740         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4741                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4742                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4743                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4744                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4745                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4746                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  88
* EL050.cbl
  4747                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4748                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4749
  4750         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4751               88  EC-BR-REDUCING                   VALUE 'R'.
  4752               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4753
  4754         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  4755         16  EC-BR-LF-DESC             PIC X(10).
  4756         16  EC-BR-AH-DESC             PIC X(10).
  4757         16  EC-BR-LF-COMMENT          PIC X(10).
  4758         16  EC-BR-AH-COMMENT          PIC X(10).
  4759
  4760         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4761               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4762               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4763               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4764               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4765
  4766         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4767               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4768               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4769               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4770               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4771
  4772         16  EC-BR-LF-REFUND-CALC      PIC X.
  4773                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4774                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4775                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4776                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4777                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4778                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4779                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4780
  4781         16  EC-BR-AH-REFUND-CALC      PIC X.
  4782                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4783                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4784                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4785                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4786                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4787                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4788                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4789                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4790
  4791         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4792                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4793                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4794                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4795
  4796         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4797                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4798                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4799                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4800
  4801         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4802         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4803         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4804         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  89
* EL050.cbl
  4805
  4806         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4807         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4808                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4809                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4810                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4811                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4812
  4813         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4814               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4815               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4816               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4817               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4818               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4819
  4820         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4821               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4822               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4823               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4824               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4825               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4826
  4827         16  EC-ST-LF-REFUND-CALC      PIC X.
  4828                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4829                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4830                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4831                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4832                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4833                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4834                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4835                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4836
  4837         16  EC-ST-AH-REFUND-CALC      PIC X.
  4838                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4839                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4840                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4841                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4842                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4843                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4844                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4845                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4846
  4847         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4848         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4849         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4850         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4851         16  EC-AM-EXPIRATION-DT       PIC XX.
  4852         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4853         16  EC-AM-CLASS-CD            PIC XX.
  4854         16  EC-AM-LF-DEVIATION        PIC XXX.
  4855         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4856         16  EC-AM-AH-DEVIATION        PIC XXX.
  4857         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4858         16  EC-AM-PHONE-NO            PIC X(10).
  4859
  4860         16  EC-AM-LF-REFUND-CALC      PIC X.
  4861                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4862                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  90
* EL050.cbl
  4863                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4864                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4865                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4866                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4867                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4868
  4869         16  EC-AM-AH-REFUND-CALC      PIC X.
  4870                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  4871                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4872                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4873                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4874                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4875                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4876                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4877
  4878         16  EC-AM-BEN-I-G-CD          PIC X.
  4879                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4880                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4881                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4882
  4883         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4884         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4885         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4886         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4887         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4888         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4889         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4890         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4891         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4892
  4893         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4894         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4895         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4896         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4897         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4898         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4899         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4900         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4901         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4902         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4903         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4904         16  EC-RT-LF-NSP-ST           PIC XX.
  4905         16  EC-RT-AH-NSP-ST           PIC XX.
  4906         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4907         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4908
  4909         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4910             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4911                                             'M' '5' '9' '2'.
  4912             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4913             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4914             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4915             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4916             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4917             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4918             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4919             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4920             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  91
* EL050.cbl
  4921             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4922
  4923         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4924             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4925                                             'M' '5' '9' '2'.
  4926             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4927             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4928             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  4929             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4930             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4931             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4932             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4933             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4934             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4935             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4936
  4937         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4938         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4939         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4940         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4941         16  EC-CM-DEATH-DT            PIC XX.
  4942
  4943*DMD CUSTOM CODING FIELDS BELOW
  4944*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4945         16  EC-BR-DMD-RATING-SW       PIC X.
  4946                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4947                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4948                 88  NO-DMD-RATING               VALUE 'N'.
  4949
  4950         16  EC-NEW-CERT               PIC X(11).
  4951         16  EC-NEW-STATE              PIC XX.
  4952         16  FILLER                    PIC X.
  4953*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4954         16  OVER-SHORT-EDIT-FIELDS.
  4955             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4956             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4957             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4958             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4959             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4960             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4961             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4962             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4963             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4964         16  FILLER                    PIC X(71).
  4965******************************************************************
  4966
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  92
* EL050.cbl
  4968*    COPY ELCDIFRD.
  4969******************************************************************
  4970*                                                                *
  4971*                                                                *
  4972*                            ELCDIFRD.                           *
  4973*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4974*                            VMOD=2.004                          *
  4975*                                                                *
  4976*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4977*                                                                *
  4978******************************************************************
  4979*
  4980  01  WS-DIFFERENCE-CALCULATION.
  4981        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4982        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4983        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4984        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4985        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4986        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4987        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4988        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4989        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4990        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4991        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4992
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  93
* EL050.cbl
  4994****************************************************************
  4995*
  4996* Copyright (c) 2007-2013 Dell Inc.
  4997* All rights reserved.
  4998*
  4999****************************************************************
  5000 01  DFHEIV.
  5001   02  DFHEIV0               PIC X(35).
  5002   02  DFHEIV1               PIC X(08).
  5003   02  DFHEIV2               PIC X(08).
  5004   02  DFHEIV3               PIC X(08).
  5005   02  DFHEIV4               PIC X(06).
  5006   02  DFHEIV5               PIC X(04).
  5007   02  DFHEIV6               PIC X(04).
  5008   02  DFHEIV7               PIC X(02).
  5009   02  DFHEIV8               PIC X(02).
  5010   02  DFHEIV9               PIC X(01).
  5011   02  DFHEIV10              PIC S9(7) COMP-3.
  5012   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5013   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5014   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5015   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5016   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5017   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5018   02  DFHEIV17              PIC X(04).
  5019   02  DFHEIV18              PIC X(04).
  5020   02  DFHEIV19              PIC X(04).
  5021   02  DFHEIV20              USAGE IS POINTER.
  5022   02  DFHEIV21              USAGE IS POINTER.
  5023   02  DFHEIV22              USAGE IS POINTER.
  5024   02  DFHEIV23              USAGE IS POINTER.
  5025   02  DFHEIV24              USAGE IS POINTER.
  5026   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5027   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5028   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5029   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5030   02  DFHEIV29              PIC S9(9) COMP SYNC.
  5031   02  DFHEIV30              PIC S9(9) COMP SYNC.
  5032   02  DFHEIV31              PIC S9(9) COMP SYNC.
  5033   02  DFHEIV32              PIC S9(4) COMP SYNC.
  5034   02  DFHEIV33              PIC S9(4) COMP SYNC.
  5035   02  DFHEIV34              PIC S9(4) COMP SYNC.
  5036   02  DFHEIV35              PIC S9(4) COMP SYNC.
  5037   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5038   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5039   02  FILLER                PIC X(02).
  5040   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5041   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5042   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5043   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5044   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5045   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  5046   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  5047 LINKAGE  SECTION.
  5048*****************************************************************
  5049*                                                               *
  5050* Copyright (c) 2007-2013 Dell Inc.                             *
  5051* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  94
* EL050.cbl
  5052*                                                               *
  5053*****************************************************************
  5054 01  dfheiblk.
  5055     02  eibtime          pic s9(7) comp-3.
  5056     02  eibdate          pic s9(7) comp-3.
  5057     02  eibtrnid         pic x(4).
  5058     02  eibtaskn         pic s9(7) comp-3.
  5059     02  eibtrmid         pic x(4).
  5060     02  dfheigdi         pic s9(4) comp.
  5061     02  eibcposn         pic s9(4) comp.
  5062     02  eibcalen         pic s9(4) comp.
  5063     02  eibaid           pic x(1).
  5064     02  eibfiller1       pic x(1).
  5065     02  eibfn            pic x(2).
  5066     02  eibfiller2       pic x(2).
  5067     02  eibrcode         pic x(6).
  5068     02  eibfiller3       pic x(2).
  5069     02  eibds            pic x(8).
  5070     02  eibreqid         pic x(8).
  5071     02  eibrsrce         pic x(8).
  5072     02  eibsync          pic x(1).
  5073     02  eibfree          pic x(1).
  5074     02  eibrecv          pic x(1).
  5075     02  eibsend          pic x(1).
  5076     02  eibatt           pic x(1).
  5077     02  eibeoc           pic x(1).
  5078     02  eibfmh           pic x(1).
  5079     02  eibcompl         pic x(1).
  5080     02  eibsig           pic x(1).
  5081     02  eibconf          pic x(1).
  5082     02  eiberr           pic x(1).
  5083     02  eibrldbk         pic x(1).
  5084     02  eiberrcd         pic x(4).
  5085     02  eibsynrb         pic x(1).
  5086     02  eibnodat         pic x(1).
  5087     02  eibfiller5       pic x(2).
  5088     02  eibresp          pic s9(8) comp.
  5089     02  eibresp2         pic s9(8) comp.
  5090     02  dfheigdj         pic s9(4) comp.
  5091     02  dfheigdk         pic s9(4) comp.
  5092
  5093 01  DFHCOMMAREA                   PIC X(1036).
  5094
  5095*01 PARMLIST .
  5096*    02  FILLER                    PIC S9(8)   COMP.
  5097*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  5098*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  5099*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  5100*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  5101*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  5102*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  5103*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  5104
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  95
* EL050.cbl
  5106*    COPY ELCCNTL.
  5107******************************************************************
  5108*                                                                *
  5109*                                                                *
  5110*                            ELCCNTL.                            *
  5111*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5112*                            VMOD=2.059                          *
  5113*                                                                *
  5114*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  5115*                                                                *
  5116*   FILE TYPE = VSAM,KSDS                                        *
  5117*   RECORD SIZE = 750  RECFORM = FIXED                           *
  5118*                                                                *
  5119*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  5120*       ALTERNATE INDEX = NONE                                   *
  5121*                                                                *
  5122*   LOG = YES                                                    *
  5123*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5124******************************************************************
  5125*                   C H A N G E   L O G
  5126*
  5127* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5128*-----------------------------------------------------------------
  5129*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5130* EFFECTIVE    NUMBER
  5131*-----------------------------------------------------------------
  5132* 082503                   PEMA  ADD BENEFIT GROUP
  5133* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5134* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5135* 092705    2005050300006  PEMA  ADD SPP LEASES
  5136* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5137* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5138* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5139* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5140* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5141* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5142* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  5143* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  5144* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  5145* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5146* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  5147******************************************************************
  5148*
  5149 01  CONTROL-FILE.
  5150     12  CF-RECORD-ID                       PIC XX.
  5151         88  VALID-CF-ID                        VALUE 'CF'.
  5152
  5153     12  CF-CONTROL-PRIMARY.
  5154         16  CF-COMPANY-ID                  PIC XXX.
  5155         16  CF-RECORD-TYPE                 PIC X.
  5156             88  CF-COMPANY-MASTER              VALUE '1'.
  5157             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5158             88  CF-STATE-MASTER                VALUE '3'.
  5159             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5160             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5161             88  CF-CARRIER-MASTER              VALUE '6'.
  5162             88  CF-MORTALITY-MASTER            VALUE '7'.
  5163             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  96
* EL050.cbl
  5164             88  CF-TERMINAL-MASTER             VALUE '9'.
  5165             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5166             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5167             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5168             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5169             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5170             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5171             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5172             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5173             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5174         16  CF-ACCESS-CD-GENL              PIC X(4).
  5175         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5176             20  CF-PROCESSOR               PIC X(4).
  5177         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5178             20  CF-STATE-CODE              PIC XX.
  5179             20  FILLER                     PIC XX.
  5180         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5181             20  FILLER                     PIC XX.
  5182             20  CF-HI-BEN-IN-REC           PIC XX.
  5183         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5184             20  FILLER                     PIC XXX.
  5185             20  CF-CARRIER-CNTL            PIC X.
  5186         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5187             20  FILLER                     PIC XX.
  5188             20  CF-HI-TYPE-IN-REC          PIC 99.
  5189         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5190             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5191                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5192             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5193             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5194         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5195             20  FILLER                     PIC X.
  5196             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5197         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5198             20  FILLER                     PIC XX.
  5199             20  CF-MORTGAGE-PLAN           PIC XX.
  5200         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5201
  5202     12  CF-LAST-MAINT-DT                   PIC XX.
  5203     12  CF-LAST-MAINT-BY                   PIC X(4).
  5204     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5205
  5206     12  CF-RECORD-BODY                     PIC X(728).
  5207
  5208
  5209****************************************************************
  5210*             COMPANY MASTER RECORD                            *
  5211****************************************************************
  5212
  5213     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5214         16  CF-COMPANY-ADDRESS.
  5215             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5216             20  CF-CL-IN-CARE-OF           PIC X(30).
  5217             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5218             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5219             20  CF-CL-CITY-STATE           PIC X(30).
  5220             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5221             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  97
* EL050.cbl
  5222         16  CF-COMPANY-CD                  PIC X.
  5223         16  CF-COMPANY-PASSWORD            PIC X(8).
  5224         16  CF-SECURITY-OPTION             PIC X.
  5225             88  ALL-SECURITY                   VALUE '1'.
  5226             88  COMPANY-VERIFY                 VALUE '2'.
  5227             88  PROCESSOR-VERIFY               VALUE '3'.
  5228             88  NO-SECURITY                    VALUE '4'.
  5229             88  ALL-BUT-TERM                   VALUE '5'.
  5230         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5231             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5232         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5233             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5234         16  CF-INFORCE-LOCATION            PIC X.
  5235             88  CERTS-ARE-ONLINE               VALUE '1'.
  5236             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5237             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5238         16  CF-LOWER-CASE-LETTERS          PIC X.
  5239         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5240             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5241             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5242             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5243             88  CF-ACCNT-CNTL                  VALUE '3'.
  5244             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5245
  5246         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5247         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5248
  5249         16  CF-LGX-CREDIT-USER             PIC X.
  5250             88  CO-IS-NOT-USER                 VALUE 'N'.
  5251             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5252
  5253         16 CF-CREDIT-CALC-CODES.
  5254             20  CF-CR-REM-TERM-CALC PIC X.
  5255               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5256               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5257               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5258               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5259               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5260               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5261               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5262             20  CF-CR-R78-METHOD           PIC X.
  5263               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5264               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5265
  5266         16  CF-CLAIM-CONTROL-COUNTS.
  5267             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5268                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5269
  5270             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5271                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5272
  5273             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5274                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5275
  5276             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5277                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5278
  5279         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  98
* EL050.cbl
  5280
  5281         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5282             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5283             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5284             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5285             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5286                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5287                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5288             20  CF-CO-PREM-REJECT-SW       PIC X.
  5289                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5290                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5291             20  CF-CO-REF-REJECT-SW        PIC X.
  5292                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5293                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5294
  5295         16  CF-CO-REPORTING-DT             PIC XX.
  5296         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5297         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5298           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5299           88  CF-CO-MONTH-END                  VALUE '1'.
  5300
  5301         16  CF-LGX-CLAIM-USER              PIC X.
  5302             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5303             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5304
  5305         16  CF-CREDIT-EDIT-CONTROLS.
  5306             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5307             20  CF-MIN-AGE                 PIC 99.
  5308             20  CF-DEFAULT-AGE             PIC 99.
  5309             20  CF-MIN-TERM                PIC S999      COMP-3.
  5310             20  CF-MAX-TERM                PIC S999      COMP-3.
  5311             20  CF-DEFAULT-SEX             PIC X.
  5312             20  CF-JOINT-AGE-INPUT         PIC X.
  5313                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5314             20  CF-BIRTH-DATE-INPUT        PIC X.
  5315                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5316             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5317                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5318                 88  CF-ZERO-CARRIER            VALUE '1'.
  5319                 88  CF-ZERO-GROUPING           VALUE '2'.
  5320                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5321             20  CF-EDIT-SW                 PIC X.
  5322                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5323             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5324             20  CF-CR-PR-METHOD            PIC X.
  5325               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5326               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5327             20  FILLER                     PIC X.
  5328
  5329         16  CF-CREDIT-MISC-CONTROLS.
  5330             20  CF-REIN-TABLE-SW           PIC X.
  5331                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5332             20  CF-COMP-TABLE-SW           PIC X.
  5333                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5334             20  CF-EXPERIENCE-RETENTION-AGE
  5335                                            PIC S9        COMP-3.
  5336             20  CF-CONVERSION-DT           PIC XX.
  5337             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page  99
* EL050.cbl
  5338             20  CF-RUN-FREQUENCY-SW        PIC X.
  5339                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5340                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5341
  5342             20  CF-CR-CHECK-NO-CONTROL.
  5343                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5344                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5345                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5346                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5347                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5348                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5349
  5350                 24  CF-CR-CHECK-COUNT       REDEFINES
  5351                     CF-CR-CHECK-COUNTER      PIC X(4).
  5352
  5353                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5354                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5355
  5356                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5357                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5358                 24  CF-MAIL-PROCESSING       PIC X.
  5359                     88  MAIL-PROCESSING          VALUE 'Y'.
  5360
  5361         16  CF-MISC-SYSTEM-CONTROL.
  5362             20  CF-SYSTEM-C                 PIC X.
  5363                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5364             20  CF-SYSTEM-D                 PIC X.
  5365                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5366             20  CF-SOC-SEC-NO-SW            PIC X.
  5367                 88  SOC-SEC-NO-USED             VALUE '1'.
  5368             20  CF-MEMBER-NO-SW             PIC X.
  5369                 88  MEMBER-NO-USED              VALUE '1'.
  5370             20  CF-TAX-ID-NUMBER            PIC X(11).
  5371             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5372             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5373                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5374                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5375                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5376                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5377             20  CF-SYSTEM-E                 PIC X.
  5378                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5379
  5380         16  CF-LGX-LIFE-USER               PIC X.
  5381             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5382             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5383
  5384         16  CF-CR-MONTH-END-DT             PIC XX.
  5385
  5386         16  CF-FILE-MAINT-DATES.
  5387             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5388                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5389             20  CF-LAST-BATCH       REDEFINES
  5390                 CF-LAST-BATCH-NO               PIC X(4).
  5391             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5392             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5393             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5394             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5395             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 100
* EL050.cbl
  5396             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5397             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5398             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5399             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5400             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5401
  5402         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5403         16  FILLER                         PIC X.
  5404
  5405         16  CF-ALT-MORT-CODE               PIC X(4).
  5406         16  CF-MEMBER-CAPTION              PIC X(10).
  5407
  5408         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5409             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5410             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5411             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5412             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5413             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5414
  5415         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5416
  5417         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5418         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5419         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5420         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5421
  5422         16  CF-AH-OVERRIDE-L1              PIC X.
  5423         16  CF-AH-OVERRIDE-L2              PIC XX.
  5424         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5425         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5426
  5427         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5428         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5429
  5430         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5431         16  CF-AR-LAST-EL860-DT            PIC XX.
  5432         16  CF-MP-MONTH-END-DT             PIC XX.
  5433
  5434         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5435         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5436             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5437
  5438         16  CF-AR-MONTH-END-DT             PIC XX.
  5439
  5440         16  CF-CRDTCRD-USER                PIC X.
  5441             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5442             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5443
  5444         16  CF-CC-MONTH-END-DT             PIC XX.
  5445
  5446         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5447
  5448         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5449             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5450             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5451             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5452         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5453         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 101
* EL050.cbl
  5454         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5455         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5456             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5457             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5458         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5459         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5460         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5461             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5462         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5463
  5464         16  CF-CL-ZIP-CODE.
  5465             20  CF-CL-ZIP-PRIME.
  5466                 24  CF-CL-ZIP-1ST          PIC X.
  5467                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5468                 24  FILLER                 PIC X(4).
  5469             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5470         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5471             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5472             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5473             20  FILLER                     PIC XXX.
  5474
  5475         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5476         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5477         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5478         16  CF-CO-OPTION-START-DATE        PIC XX.
  5479         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5480           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5481                                                      '3' '4'.
  5482           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5483           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5484           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5485           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5486           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5487           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5488
  5489         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5490
  5491         16  CF-PAYMENT-APPROVAL-LEVELS.
  5492             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5493             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5494             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5495             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5496             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5497             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5498
  5499         16  CF-END-USER-REPORTING-USER     PIC X.
  5500             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5501             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5502
  5503         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5504             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5505             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5506
  5507         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5508
  5509         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5510         16  FILLER                         PIC X.
  5511
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 102
* EL050.cbl
  5512         16  CF-CREDIT-ARCHIVE-CNTL.
  5513             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5514             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5515             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5516
  5517         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5518
  5519         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5520             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5521             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5522
  5523         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5524             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5525             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5526
  5527         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5528
  5529         16  CF-CO-ACH-ID-CODE              PIC  X.
  5530             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5531             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5532             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5533         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5534         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5535         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5536         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5537         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5538         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5539         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5540         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5541         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5542                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5543         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5544                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5545
  5546         16  CF-CO-OVER-SHORT.
  5547             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5548             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5549
  5550*         16  FILLER                         PIC X(102).
  5551         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5552             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5553             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5554
  5555         16  CF-AH-APPROVAL-DAYS.
  5556             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5557             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5558             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5559             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5560
  5561         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5562
  5563         16  CF-APPROV-LEV-5.
  5564             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5565             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5566             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5567
  5568         16  FILLER                         PIC X(68).
  5569****************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 103
* EL050.cbl
  5570*             PROCESSOR/USER RECORD                            *
  5571****************************************************************
  5572
  5573     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5574         16  CF-PROCESSOR-NAME              PIC X(30).
  5575         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5576         16  CF-PROCESSOR-TITLE             PIC X(26).
  5577         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5578                 88  MESSAGE-YES                VALUE 'Y'.
  5579                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5580
  5581*****************************************************
  5582****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5583****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5584****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5585****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5586*****************************************************
  5587
  5588         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5589             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5590             20  CF-APPLICATION-FORCE       PIC X.
  5591             20  CF-INDIVIDUAL-APP.
  5592                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5593                     28  CF-BROWSE-APP      PIC X.
  5594                     28  CF-UPDATE-APP      PIC X.
  5595
  5596         16  CF-CURRENT-TERM-ON             PIC X(4).
  5597         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5598             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5599             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5600             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5601             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5602             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5603             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5604             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5605         16  CF-PROCESSOR-CARRIER           PIC X.
  5606             88  NO-CARRIER-SECURITY            VALUE ' '.
  5607         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5608             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5609         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5610             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5611         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5612             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5613
  5614         16  CF-PROC-SYS-ACCESS-SW.
  5615             20  CF-PROC-CREDIT-CLAIMS-SW.
  5616                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5617                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5618                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5619                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5620             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5621                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5622                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5623             20  CF-PROC-LIFE-GNRLDGR-SW.
  5624                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5625                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5626                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5627                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 104
* EL050.cbl
  5628             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5629                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5630                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5631         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5632             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5633             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5634         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5635
  5636         16  CF-APPROVAL-LEVEL                  PIC X.
  5637             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5638             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5639             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5640             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5641             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5642
  5643         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5644
  5645         16  CF-LANGUAGE-TYPE                   PIC X.
  5646             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5647             88  CF-LANG-IS-FR                      VALUE 'F'.
  5648
  5649         16  CF-CSR-IND                         PIC X.
  5650         16  FILLER                             PIC X(239).
  5651
  5652****************************************************************
  5653*             PROCESSOR/REMINDERS RECORD                       *
  5654****************************************************************
  5655
  5656     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5657         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5658             20  CF-START-REMIND-DT         PIC XX.
  5659             20  CF-END-REMIND-DT           PIC XX.
  5660             20  CF-REMINDER-TEXT           PIC X(50).
  5661         16  FILLER                         PIC X(296).
  5662
  5663
  5664****************************************************************
  5665*             STATE MASTER RECORD                              *
  5666****************************************************************
  5667
  5668     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5669         16  CF-STATE-ABBREVIATION          PIC XX.
  5670         16  CF-STATE-NAME                  PIC X(25).
  5671         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5672         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5673             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5674             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5675             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5676             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5677                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5678                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5679             20  CF-ST-PREM-REJECT-SW       PIC X.
  5680                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5681                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5682             20  CF-ST-REF-REJECT-SW        PIC X.
  5683                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5684                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5685         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 105
* EL050.cbl
  5686         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5687         16  CF-ST-REFUND-RULES.
  5688             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5689             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5690             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5691         16  CF-ST-FST-PMT-EXTENSION.
  5692             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5693             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5694                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5695                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5696                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5697                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5698         16  CF-ST-STATE-CALL.
  5699             20  CF-ST-CALL-UNEARNED        PIC X.
  5700             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5701             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5702         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5703             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5704             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5705         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5706         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5707         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5708         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5709         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5710         16  FILLER                         PIC X.
  5711         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5712             20  CF-ST-BENEFIT-CD           PIC XX.
  5713             20  CF-ST-BENEFIT-KIND         PIC X.
  5714                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5715                 88  CF-ST-AH-KIND              VALUE 'A'.
  5716             20  CF-ST-REM-TERM-CALC        PIC X.
  5717                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5718                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5719                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5720                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5721                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5722                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5723                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5724                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5725
  5726             20  CF-ST-REFUND-CALC          PIC X.
  5727                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5728                 88  ST-REFD-BY-R78             VALUE '1'.
  5729                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5730                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5731                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5732                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5733                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5734                 88  ST-REFD-UTAH               VALUE '7'.
  5735                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5736                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5737                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5738
  5739             20  CF-ST-EARNING-CALC         PIC X.
  5740                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5741                 88  ST-EARN-BY-R78             VALUE '1'.
  5742                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5743                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 106
* EL050.cbl
  5744                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5745                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5746                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5747                 88  ST-EARN-MEAN               VALUE '8'.
  5748                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5749
  5750             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5751                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5752                 88  ST-OVRD-BY-R78             VALUE '1'.
  5753                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5754                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5755                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5756                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5757                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5758                 88  ST-OVRD-MEAN               VALUE '8'.
  5759                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5760             20  cf-st-extra-periods        pic 9.
  5761*            20  FILLER                     PIC X.
  5762
  5763         16  CF-ST-COMMISSION-CAPS.
  5764             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5765             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5766             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5767             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5768         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5769                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5770                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  5771                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  5772
  5773         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5774
  5775         16  CF-ST-STATUTORY-INTEREST.
  5776             20  CF-ST-STAT-DATE-FROM       PIC X.
  5777                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5778                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5779             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5780             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5781             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5782             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5783             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5784
  5785         16  CF-ST-OVER-SHORT.
  5786             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5787             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5788
  5789         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5790
  5791         16  CF-ST-RT-CALC                  PIC X.
  5792
  5793         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5794         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5795         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5796         16  CF-ST-RF-LR-CALC               PIC X.
  5797         16  CF-ST-RF-LL-CALC               PIC X.
  5798         16  CF-ST-RF-LN-CALC               PIC X.
  5799         16  CF-ST-RF-AH-CALC               PIC X.
  5800         16  CF-ST-RF-CP-CALC               PIC X.
  5801*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 107
* EL050.cbl
  5802*CIDMOD         16  FILLER                         PIC X(192).
  5803         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5804             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5805         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5806         16  CF-ST-VFY-2ND-BENE             PIC X.
  5807         16  CF-ST-CAUSAL-STATE             PIC X.
  5808         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5809         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  5810         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5811             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5812         16  CF-ST-NET-ONLY-STATE           PIC X.
  5813             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5814         16  cf-commission-cap-required     pic x.
  5815         16  CF-ST-GA-COMMISSION-CAPS.
  5816             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  5817             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  5818             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  5819             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  5820         16  CF-ST-TOT-COMMISSION-CAPS.
  5821             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  5822             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  5823             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  5824             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  5825         16  FILLER                         PIC X(156).
  5826
  5827****************************************************************
  5828*             BENEFIT MASTER RECORD                            *
  5829****************************************************************
  5830
  5831     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5832         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5833             20  CF-BENEFIT-CODE            PIC XX.
  5834             20  CF-BENEFIT-NUMERIC  REDEFINES
  5835                 CF-BENEFIT-CODE            PIC XX.
  5836             20  CF-BENEFIT-ALPHA           PIC XXX.
  5837             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5838             20  CF-BENEFIT-COMMENT         PIC X(10).
  5839
  5840             20  CF-LF-COVERAGE-TYPE        PIC X.
  5841                 88  CF-REDUCING                VALUE 'R'.
  5842                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5843
  5844             20  CF-SPECIAL-CALC-CD         PIC X.
  5845                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5846                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5847                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5848                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5849                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5850                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5851                 88  CF-FARM-PLAN               VALUE 'F'.
  5852                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5853                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5854                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5855                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5856                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5857                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5858                 88  CF-PRUDENTIAL              VALUE 'P'.
  5859                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 108
* EL050.cbl
  5860                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5861                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5862                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5863                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5864                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5865
  5866             20  CF-JOINT-INDICATOR         PIC X.
  5867                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5868
  5869*            20  FILLER                     PIC X(12).
  5870             20  cf-maximum-benefits        pic s999 comp-3.
  5871             20  FILLER                     PIC X(09).
  5872             20  CF-BENEFIT-CATEGORY        PIC X.
  5873             20  CF-LOAN-TYPE               PIC X(8).
  5874
  5875             20  CF-CO-REM-TERM-CALC        PIC X.
  5876                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5877                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5878                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5879                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5880                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5881
  5882             20  CF-CO-EARNINGS-CALC        PIC X.
  5883                 88  CO-EARN-BY-R78             VALUE '1'.
  5884                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5885                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5886                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5887                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5888                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5889                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5890                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5891
  5892             20  CF-CO-REFUND-CALC          PIC X.
  5893                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5894                 88  CO-REFD-BY-R78             VALUE '1'.
  5895                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5896                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5897                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5898                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5899                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5900                 88  CO-REFD-MEAN               VALUE '8'.
  5901                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5902                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5903                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5904
  5905             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5906                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5907                 88  CO-OVRD-BY-R78             VALUE '1'.
  5908                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5909                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5910                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5911                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5912                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5913                 88  CO-OVRD-MEAN               VALUE '8'.
  5914                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5915
  5916             20  CF-CO-BEN-I-G-CD           PIC X.
  5917                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 109
* EL050.cbl
  5918                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5919                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5920
  5921         16  FILLER                         PIC X(304).
  5922
  5923
  5924****************************************************************
  5925*             CARRIER MASTER RECORD                            *
  5926****************************************************************
  5927
  5928     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5929         16  CF-ADDRESS-DATA.
  5930             20  CF-MAIL-TO-NAME            PIC X(30).
  5931             20  CF-IN-CARE-OF              PIC X(30).
  5932             20  CF-ADDRESS-LINE-1          PIC X(30).
  5933             20  CF-ADDRESS-LINE-2          PIC X(30).
  5934             20  CF-CITY-STATE              PIC X(30).
  5935             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5936             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5937
  5938         16  CF-CLAIM-NO-CONTROL.
  5939             20  CF-CLAIM-NO-METHOD         PIC X.
  5940                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5941                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5942                 88  CLAIM-NO-SEQ               VALUE '3'.
  5943                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5944             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5945                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5946                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5947                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5948
  5949         16  CF-CHECK-NO-CONTROL.
  5950             20  CF-CHECK-NO-METHOD         PIC X.
  5951                 88  CHECK-NO-MANUAL            VALUE '1'.
  5952                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5953                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5954                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5955             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5956                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5957
  5958         16  CF-DOMICILE-STATE              PIC XX.
  5959
  5960         16  CF-EXPENSE-CONTROLS.
  5961             20  CF-EXPENSE-METHOD          PIC X.
  5962                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5963                 88  DOLLARS-PER-PMT            VALUE '2'.
  5964                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5965                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5966             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5967             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5968
  5969         16  CF-CORRESPONDENCE-CONTROL.
  5970             20  CF-LETTER-RESEND-OPT       PIC X.
  5971                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5972                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5973             20  FILLER                     PIC X(4).
  5974
  5975         16  CF-RESERVE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 110
* EL050.cbl
  5976             20  CF-MANUAL-SW               PIC X.
  5977                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5978             20  CF-FUTURE-SW               PIC X.
  5979                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5980             20  CF-PTC-SW                  PIC X.
  5981                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5982             20  CF-IBNR-SW                 PIC X.
  5983                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5984             20  CF-PTC-LF-SW               PIC X.
  5985                 88  CF-LF-PTC-USED             VALUE '1'.
  5986             20  CF-CDT-ACCESS-METHOD       PIC X.
  5987                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5988                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5989                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5990             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5991
  5992         16  CF-CLAIM-CALC-METHOD           PIC X.
  5993             88  360-PLUS-MONTHS                VALUE '1'.
  5994             88  365-PLUS-MONTHS                VALUE '2'.
  5995             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5996             88  360-DAILY                      VALUE '4'.
  5997             88  365-DAILY                      VALUE '5'.
  5998
  5999         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  6000         16  FILLER                         PIC X(11).
  6001
  6002         16  CF-LIMIT-AMOUNTS.
  6003             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  6004             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  6005             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  6006             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  6007             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  6008             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  6009             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  6010             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  6011             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  6012             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  6013
  6014         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  6015         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  6016         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  6017
  6018         16  CF-ZIP-CODE.
  6019             20  CF-ZIP-PRIME.
  6020                 24  CF-ZIP-1ST             PIC X.
  6021                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6022                 24  FILLER                 PIC X(4).
  6023             20  CF-ZIP-PLUS4               PIC X(4).
  6024         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  6025             20  CF-CAN-POSTAL-1            PIC XXX.
  6026             20  CF-CAN-POSTAL-2            PIC XXX.
  6027             20  FILLER                     PIC XXX.
  6028
  6029         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  6030         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  6031         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  6032
  6033         16  CF-RATING-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 111
* EL050.cbl
  6034             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  6035             88  CF-NO-RATING                   VALUE 'N'.
  6036
  6037         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  6038
  6039         16  CF-CARRIER-OVER-SHORT.
  6040             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  6041             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  6042
  6043         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  6044         16  CF-SECPAY-SWITCH               PIC X.
  6045             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  6046             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  6047         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  6048         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  6049         16  FILLER                         PIC X(444).
  6050*        16  FILLER                         PIC X(452).
  6051
  6052
  6053****************************************************************
  6054*             MORTALITY MASTER RECORD                          *
  6055****************************************************************
  6056
  6057     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6058         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  6059                                INDEXED BY CF-MORT-NDX.
  6060             20  CF-MORT-TABLE              PIC X(5).
  6061             20  CF-MORT-TABLE-TYPE         PIC X.
  6062                 88  CF-MORT-JOINT              VALUE 'J'.
  6063                 88  CF-MORT-SINGLE             VALUE 'S'.
  6064                 88  CF-MORT-COMBINED           VALUE 'C'.
  6065                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  6066                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  6067             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  6068             20  CF-MORT-AGE-METHOD         PIC XX.
  6069                 88  CF-AGE-LAST                VALUE 'AL'.
  6070                 88  CF-AGE-NEAR                VALUE 'AN'.
  6071             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  6072             20  CF-MORT-ADJUSTMENT-DIRECTION
  6073                                            PIC X.
  6074                 88  CF-MINUS                   VALUE '-'.
  6075                 88  CF-PLUS                    VALUE '+'.
  6076             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  6077             20  CF-MORT-JOINT-CODE         PIC X.
  6078                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  6079             20  CF-MORT-PC-Q               PIC X.
  6080                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  6081             20  CF-MORT-TABLE-CODE         PIC X(4).
  6082             20  CF-MORT-COMMENTS           PIC X(15).
  6083             20  FILLER                     PIC X(14).
  6084
  6085         16  FILLER                         PIC X(251).
  6086
  6087
  6088****************************************************************
  6089*             BUSSINESS TYPE MASTER RECORD                     *
  6090****************************************************************
  6091
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 112
* EL050.cbl
  6092     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6093* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  6094* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  6095* AND RECORD 05 IS TYPES 81-99
  6096         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  6097             20  CF-BUSINESS-TITLE          PIC  X(19).
  6098             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  6099                                            PIC S9V9(4) COMP-3.
  6100             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  6101             20  FILLER                     PIC  X.
  6102         16  FILLER                         PIC  X(248).
  6103
  6104
  6105****************************************************************
  6106*             TERMINAL MASTER RECORD                           *
  6107****************************************************************
  6108
  6109     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6110
  6111         16  CF-COMPANY-TERMINALS.
  6112             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  6113                                  PIC X(4).
  6114         16  FILLER               PIC X(248).
  6115
  6116
  6117****************************************************************
  6118*             LIFE EDIT MASTER RECORD                          *
  6119****************************************************************
  6120
  6121     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6122         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  6123             20  CF-LIFE-CODE-IN            PIC XX.
  6124             20  CF-LIFE-CODE-OUT           PIC XX.
  6125         16  FILLER                         PIC X(248).
  6126
  6127
  6128****************************************************************
  6129*             AH EDIT MASTER RECORD                            *
  6130****************************************************************
  6131
  6132     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6133         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  6134             20  CF-AH-CODE-IN              PIC XXX.
  6135             20  CF-AH-CODE-OUT             PIC XX.
  6136         16  FILLER                         PIC X(248).
  6137
  6138
  6139****************************************************************
  6140*             CREDIBILITY TABLES                               *
  6141****************************************************************
  6142
  6143     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6144         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  6145                             INDEXED BY CF-CRDB-NDX.
  6146             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  6147             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  6148             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  6149         16  FILLER                         PIC  X(332).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 113
* EL050.cbl
  6150
  6151
  6152****************************************************************
  6153*             REPORT CUSTOMIZATION RECORD                      *
  6154****************************************************************
  6155
  6156     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6157         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6158             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6159             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6160             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6161**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6162****       A T-TRANSFER.                                   ****
  6163             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  6164
  6165         16  FILLER                         PIC XX.
  6166
  6167         16  CF-CARRIER-CNTL-OPT.
  6168             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6169                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6170                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  6171             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6172                                            PIC X.
  6173         16  CF-GROUP-CNTL-OPT.
  6174             20  CF-GROUP-OPT-SEQ           PIC 9.
  6175                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6176                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6177             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6178                                            PIC X(6).
  6179         16  CF-STATE-CNTL-OPT.
  6180             20  CF-STATE-OPT-SEQ           PIC 9.
  6181                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6182                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6183             20  CF-STATE-SELECT OCCURS 3 TIMES
  6184                                            PIC XX.
  6185         16  CF-ACCOUNT-CNTL-OPT.
  6186             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6187                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6188                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6189             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6190                                            PIC X(10).
  6191         16  CF-BUS-TYP-CNTL-OPT.
  6192             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6193                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6194                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6195             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6196                                            PIC XX.
  6197         16  CF-LF-TYP-CNTL-OPT.
  6198             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6199                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6200                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6201             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6202                                            PIC XX.
  6203         16  CF-AH-TYP-CNTL-OPT.
  6204             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6205                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6206                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6207             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 114
* EL050.cbl
  6208                                            PIC XX.
  6209         16  CF-REPTCD1-CNTL-OPT.
  6210             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6211                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6212                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6213             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6214                                            PIC X(10).
  6215         16  CF-REPTCD2-CNTL-OPT.
  6216             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6217                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6218                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6219             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6220                                            PIC X(10).
  6221         16  CF-USER1-CNTL-OPT.
  6222             20  CF-USER1-OPT-SEQ           PIC 9.
  6223                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6224                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6225             20  CF-USER1-SELECT OCCURS 3 TIMES
  6226                                            PIC X(10).
  6227         16  CF-USER2-CNTL-OPT.
  6228             20  CF-USER2-OPT-SEQ           PIC 9.
  6229                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6230                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6231             20  CF-USER2-SELECT OCCURS 3 TIMES
  6232                                            PIC X(10).
  6233         16  CF-USER3-CNTL-OPT.
  6234             20  CF-USER3-OPT-SEQ           PIC 9.
  6235                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6236                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6237             20  CF-USER3-SELECT OCCURS 3 TIMES
  6238                                            PIC X(10).
  6239         16  CF-USER4-CNTL-OPT.
  6240             20  CF-USER4-OPT-SEQ           PIC 9.
  6241                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6242                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6243             20  CF-USER4-SELECT OCCURS 3 TIMES
  6244                                            PIC X(10).
  6245         16  CF-USER5-CNTL-OPT.
  6246             20  CF-USER5-OPT-SEQ           PIC 9.
  6247                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6248                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6249             20  CF-USER5-SELECT OCCURS 3 TIMES
  6250                                            PIC X(10).
  6251         16  CF-REINS-CNTL-OPT.
  6252             20  CF-REINS-OPT-SEQ           PIC 9.
  6253                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6254                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6255             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6256                 24  CF-REINS-PRIME         PIC XXX.
  6257                 24  CF-REINS-SUB           PIC XXX.
  6258
  6259         16  CF-AGENT-CNTL-OPT.
  6260             20  CF-AGENT-OPT-SEQ           PIC 9.
  6261                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6262                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6263             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6264                                            PIC X(10).
  6265
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 115
* EL050.cbl
  6266         16  FILLER                         PIC X(43).
  6267
  6268         16  CF-LOSS-RATIO-SELECT.
  6269             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6270             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6271         16  CF-ENTRY-DATE-SELECT.
  6272             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6273             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6274         16  CF-EFFECTIVE-DATE-SELECT.
  6275             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6276             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6277
  6278         16  CF-EXCEPTION-LIST-IND          PIC X.
  6279             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6280
  6281         16  FILLER                         PIC X(318).
  6282
  6283****************************************************************
  6284*                  EXCEPTION REPORTING RECORD                  *
  6285****************************************************************
  6286
  6287     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6288         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6289             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6290
  6291         16  CF-COMBINED-LIFE-AH-OPT.
  6292             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6293             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6294             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6295             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6296
  6297         16  CF-LIFE-OPT.
  6298             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6299             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6300             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6301             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6302             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6303             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6304             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6305             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6306             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6307             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6308
  6309         16  CF-AH-OPT.
  6310             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6311             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6312             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6313             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6314             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6315             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6316             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6317             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6318             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6319             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6320
  6321         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6322             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6323             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 116
* EL050.cbl
  6324             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6325
  6326         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6327
  6328         16  FILLER                         PIC X(673).
  6329
  6330
  6331****************************************************************
  6332*             MORTGAGE SYSTEM PLAN RECORD                      *
  6333****************************************************************
  6334
  6335     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6336         16  CF-PLAN-TYPE                   PIC X.
  6337             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6338             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6339             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6340         16  CF-PLAN-ABBREV                 PIC XXX.
  6341         16  CF-PLAN-DESCRIPT               PIC X(10).
  6342         16  CF-PLAN-NOTES                  PIC X(20).
  6343         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6344         16  CF-PLAN-UNDERWRITING.
  6345             20  CF-PLAN-TERM-DATA.
  6346                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6347                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6348             20  CF-PLAN-AGE-DATA.
  6349                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6350                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6351                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6352             20  CF-PLAN-BENEFIT-DATA.
  6353                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6354                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6355                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6356                                            PIC S9(7)V99  COMP-3.
  6357         16  CF-PLAN-POLICY-FORMS.
  6358             20  CF-POLICY-FORM             PIC X(12).
  6359             20  CF-MASTER-APPLICATION      PIC X(12).
  6360             20  CF-MASTER-POLICY           PIC X(12).
  6361         16  CF-PLAN-RATING.
  6362             20  CF-RATE-CODE               PIC X(5).
  6363             20  CF-SEX-RATING              PIC X.
  6364                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6365                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6366             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6367             20  CF-SUB-STD-TYPE            PIC X.
  6368                 88  CF-PCT-OF-PREM            VALUE '1'.
  6369                 88  CF-PCT-OF-BENE            VALUE '2'.
  6370         16  CF-PLAN-PREM-TOLERANCES.
  6371             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6372             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6373         16  CF-PLAN-PYMT-TOLERANCES.
  6374             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6375             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6376         16  CF-PLAN-MISC-DATA.
  6377             20  FILLER                     PIC X.
  6378             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6379             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6380         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6381         16  CF-PLAN-IND-GRP                PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 117
* EL050.cbl
  6382             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6383                                                     '1'.
  6384             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6385                                                     '2'.
  6386         16  CF-MIB-SEARCH-SW               PIC X.
  6387             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6388             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6389             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6390             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6391         16  CF-ALPHA-SEARCH-SW             PIC X.
  6392             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6393             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6394             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6395             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6396             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6397             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6398             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6399             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6400             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6401             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6402                                                     'A' 'B' 'C'
  6403                                                     'X' 'Y' 'Z'.
  6404         16  CF-EFF-DT-RULE-SW              PIC X.
  6405             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6406             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6407             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6408             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6409             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6410         16  FILLER                         PIC X(4).
  6411         16  CF-HEALTH-QUESTIONS            PIC X.
  6412             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6413         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6414         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6415         16  CF-PLAN-SNGL-JNT               PIC X.
  6416             88  CF-COMBINED-PLAN              VALUE 'C'.
  6417             88  CF-JNT-PLAN                   VALUE 'J'.
  6418             88  CF-SNGL-PLAN                  VALUE 'S'.
  6419         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6420         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6421         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6422         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6423         16  CF-RERATE-CNTL                 PIC  X.
  6424             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6425             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6426             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6427             88  CF-AUTO-RECALC                 VALUE '4'.
  6428         16  CF-BENEFIT-TYPE                PIC  X.
  6429             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6430             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6431         16  CF-POLICY-FEE                  PIC S999V99
  6432                                                    COMP-3.
  6433         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6434         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6435         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6436         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6437         16  FILLER                         PIC  X(32).
  6438         16  CF-TERMINATION-FORM            PIC  X(04).
  6439         16  FILLER                         PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 118
* EL050.cbl
  6440         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6441                                                       COMP-3.
  6442         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6443         16  CF-ISSUE-LETTER                PIC  X(4).
  6444         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6445         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6446             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6447             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6448         16  CF-MP-REFUND-CALC              PIC X.
  6449             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6450             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6451             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6452             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6453             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6454             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6455             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6456             88  CF-MP-REFD-MEAN                VALUE '8'.
  6457         16  CF-ALT-RATE-CODE               PIC  X(5).
  6458
  6459
  6460         16  FILLER                         PIC X(498).
  6461****************************************************************
  6462*             MORTGAGE COMPANY MASTER RECORD                   *
  6463****************************************************************
  6464
  6465     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6466         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6467         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6468             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6469             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6470             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6471             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6472             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6473
  6474         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6475         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6476         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6477         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6478         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6479
  6480         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6481             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6482         16  CF-MP-RECON-USE-IND            PIC X(1).
  6483             88  CF-MP-USE-RECON             VALUE 'Y'.
  6484         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6485             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6486         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6487             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6488             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6489         16  FILLER                         PIC X(1).
  6490         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6491             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6492         16  CF-MORTG-MIB-VERSION           PIC X.
  6493             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6494             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6495             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6496         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6497             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 119
* EL050.cbl
  6498                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6499             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6500                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6501             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6502                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6503             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6504                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6505             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6506                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6507             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6508                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6509         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6510         16  FILLER                         PIC X(7).
  6511         16  CF-MORTG-DESTINATION-SYMBOL.
  6512             20  CF-MORTG-MIB-COMM          PIC X(5).
  6513             20  CF-MORTG-MIB-TERM          PIC X(5).
  6514         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6515             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6516         16  FILLER                         PIC X(03).
  6517         16  CF-MP-CHECK-NO-CONTROL.
  6518             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6519                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6520                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6521                                                ' ' LOW-VALUES.
  6522                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6523                                               VALUE '3'.
  6524         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6525         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6526         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6527             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6528                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6529             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6530                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6531             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6532                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6533             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6534                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6535             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6536                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6537             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6538                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6539         16  CF-MORTG-BILLING-AREA.
  6540             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6541                                            PIC X.
  6542         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6543         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6544         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6545         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6546             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6547             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6548         16  FILLER                         PIC X.
  6549         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6550             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6551             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6552         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6553         16  FILLER                         PIC X(8).
  6554         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6555         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 120
* EL050.cbl
  6556         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6557         16  CF-ACH-COMPANY-ID.
  6558             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6559                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6560                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6561                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6562             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6563         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6564             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6565         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6566             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6567             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6568         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6569         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6570         16  FILLER                         PIC X(536).
  6571
  6572****************************************************************
  6573*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6574****************************************************************
  6575
  6576     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6577         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6578             20  CF-FEMALE-HEIGHT.
  6579                 24  CF-FEMALE-FT           PIC 99.
  6580                 24  CF-FEMALE-IN           PIC 99.
  6581             20  CF-FEMALE-MIN-WT           PIC 999.
  6582             20  CF-FEMALE-MAX-WT           PIC 999.
  6583         16  FILLER                         PIC X(428).
  6584
  6585     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6586         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6587             20  CF-MALE-HEIGHT.
  6588                 24  CF-MALE-FT             PIC 99.
  6589                 24  CF-MALE-IN             PIC 99.
  6590             20  CF-MALE-MIN-WT             PIC 999.
  6591             20  CF-MALE-MAX-WT             PIC 999.
  6592         16  FILLER                         PIC X(428).
  6593******************************************************************
  6594*             AUTOMATIC ACTIVITY RECORD                          *
  6595******************************************************************
  6596     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6597         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6598             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6599             20  CF-SYS-LETTER-ID           PIC X(04).
  6600             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6601             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6602             20  CF-SYS-RESET-SW            PIC X(01).
  6603             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6604             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6605
  6606         16  FILLER                         PIC X(50).
  6607
  6608         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6609             20  CF-USER-ACTIVE-SW          PIC X(01).
  6610             20  CF-USER-LETTER-ID          PIC X(04).
  6611             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6612             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6613             20  CF-USER-RESET-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 121
* EL050.cbl
  6614             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6615             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6616             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6617
  6618         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 122
* EL050.cbl
  6620*    COPY ERCACCT.
  6621******************************************************************
  6622*                                                                *
  6623*                                                                *
  6624*                            ERCACCT                             *
  6625*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6626*                            VMOD=2.031                          *
  6627*                                                                *
  6628*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6629*                                                                *
  6630*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6631*   VSAM ACCOUNT MASTER FILES.                                   *
  6632*                                                                *
  6633*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6634*                                                                *
  6635*   FILE TYPE = VSAM,KSDS                                        *
  6636*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6637*                                                                *
  6638*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6639*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6640*                                                                *
  6641*   LOG = NO                                                     *
  6642*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6643*                                                                *
  6644*                                                                *
  6645******************************************************************
  6646*                   C H A N G E   L O G
  6647*
  6648* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6649*-----------------------------------------------------------------
  6650*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6651* EFFECTIVE    NUMBER
  6652*-----------------------------------------------------------------
  6653* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6654* 092705    2005050300006  PEMA  ADD SPP LEASES
  6655* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6656* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6657* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6658* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6659* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6660* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6661******************************************************************
  6662
  6663 01  ACCOUNT-MASTER.
  6664     12  AM-RECORD-ID                      PIC XX.
  6665         88  VALID-AM-ID                      VALUE 'AM'.
  6666
  6667     12  AM-CONTROL-PRIMARY.
  6668         16  AM-COMPANY-CD                 PIC X.
  6669         16  AM-MSTR-CNTRL.
  6670             20  AM-CONTROL-A.
  6671                 24  AM-CARRIER            PIC X.
  6672                 24  AM-GROUPING.
  6673                     28 AM-GROUPING-PREFIX PIC XXX.
  6674                     28 AM-GROUPING-PRIME  PIC XXX.
  6675                 24  AM-STATE              PIC XX.
  6676                 24  AM-ACCOUNT.
  6677                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 123
* EL050.cbl
  6678                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6679             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6680                                           PIC X(19).
  6681             20  AM-CNTRL-B.
  6682                 24  AM-EXPIRATION-DT      PIC XX.
  6683                 24  FILLER                PIC X(4).
  6684             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6685                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6686
  6687     12  AM-CONTROL-BY-VAR-GRP.
  6688         16  AM-COMPANY-CD-A1              PIC X.
  6689         16  AM-VG-CARRIER                 PIC X.
  6690         16  AM-VG-GROUPING                PIC X(6).
  6691         16  AM-VG-STATE                   PIC XX.
  6692         16  AM-VG-ACCOUNT                 PIC X(10).
  6693         16  AM-VG-DATE.
  6694             20  AM-VG-EXPIRATION-DT       PIC XX.
  6695             20  FILLER                    PIC X(4).
  6696         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6697                                           PIC 9(11)      COMP-3.
  6698     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6699         16  FILLER                        PIC X(10).
  6700         16  AM-VG-KEY3.
  6701             20  AM-VG3-ACCOUNT            PIC X(10).
  6702             20  AM-VG3-EXP-DT             PIC XX.
  6703         16  FILLER                        PIC X(4).
  6704     12  AM-MAINT-INFORMATION.
  6705         16  AM-LAST-MAINT-DT              PIC XX.
  6706         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6707         16  AM-LAST-MAINT-USER            PIC X(4).
  6708         16  FILLER                        PIC XX.
  6709
  6710     12  AM-EFFECTIVE-DT                   PIC XX.
  6711     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6712
  6713     12  AM-PREV-DATES  COMP-3.
  6714         16  AM-PREV-EXP-DT                PIC 9(11).
  6715         16  AM-PREV-EFF-DT                PIC 9(11).
  6716
  6717     12  AM-REPORT-CODE-1                  PIC X(10).
  6718     12  AM-REPORT-CODE-2                  PIC X(10).
  6719
  6720     12  AM-CITY-CODE                      PIC X(4).
  6721     12  AM-COUNTY-PARISH                  PIC X(6).
  6722
  6723     12  AM-NAME                           PIC X(30).
  6724     12  AM-PERSON                         PIC X(30).
  6725     12  AM-ADDRS                          PIC X(30).
  6726     12  AM-CITY.
  6727         16  AM-ADDR-CITY                  PIC X(28).
  6728         16  AM-ADDR-STATE                 PIC XX.
  6729     12  AM-ZIP.
  6730         16  AM-ZIP-PRIME.
  6731             20  AM-ZIP-PRI-1ST            PIC X.
  6732                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6733             20  FILLER                    PIC X(4).
  6734         16  AM-ZIP-PLUS4                  PIC X(4).
  6735     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 124
* EL050.cbl
  6736         16  AM-CAN-POSTAL-1               PIC XXX.
  6737         16  AM-CAN-POSTAL-2               PIC XXX.
  6738         16  FILLER                        PIC XXX.
  6739     12  AM-TEL-NO.
  6740         16  AM-AREA-CODE                  PIC 999.
  6741         16  AM-TEL-PRE                    PIC 999.
  6742         16  AM-TEL-NBR                    PIC 9(4).
  6743     12  AM-TEL-LOC                        PIC X.
  6744         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6745         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6746
  6747     12  AM-COMM-STRUCTURE.
  6748         16  AM-DEFN-1.
  6749             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6750                 24  AM-AGT.
  6751                     28  AM-AGT-PREFIX     PIC X(4).
  6752                     28  AM-AGT-PRIME      PIC X(6).
  6753                 24  AM-COM-TYP            PIC X.
  6754                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6755                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6756                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6757                 24  AM-RECALC-LV-INDIC    PIC X.
  6758                 24  AM-RETRO-LV-INDIC     PIC X.
  6759                 24  AM-GL-CODES           PIC X.
  6760                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6761                 24  FILLER                PIC X(01).
  6762         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6763             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6764                 24  FILLER                PIC X(11).
  6765                 24  AM-L-COMA             PIC XXX.
  6766                 24  AM-J-COMA             PIC XXX.
  6767                 24  AM-A-COMA             PIC XXX.
  6768                 24  FILLER                PIC X(6).
  6769
  6770     12  AM-COMM-CHANGE-STATUS             PIC X.
  6771         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6772
  6773     12  AM-CSR-CODE                       PIC X(4).
  6774
  6775     12  AM-BILLING-STATUS                 PIC X.
  6776         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6777         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6778     12  AM-AUTO-REFUND-SW                 PIC X.
  6779         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6780         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6781     12  AM-GPCD                           PIC 99.
  6782     12  AM-IG                             PIC X.
  6783         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6784         88  AM-HAS-GROUP                     VALUE '2'.
  6785     12  AM-STATUS                         PIC X.
  6786         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6787         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6788         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6789         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6790         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6791         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6792         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6793         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 125
* EL050.cbl
  6794         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6795         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6796     12  AM-REMIT-TO                       PIC 99.
  6797     12  AM-ID-NO                          PIC X(11).
  6798
  6799     12  AM-CAL-TABLE                      PIC XX.
  6800     12  AM-LF-DEVIATION                   PIC XXX.
  6801     12  AM-AH-DEVIATION                   PIC XXX.
  6802     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6803     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6804     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6805     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6806     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6807     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6808
  6809     12  AM-USER-FIELDS.
  6810         16  AM-FLD-1                      PIC XX.
  6811         16  AM-FLD-2                      PIC XX.
  6812         16  AM-FLD-3                      PIC XX.
  6813         16  AM-FLD-4                      PIC XX.
  6814         16  AM-FLD-5                      PIC XX.
  6815
  6816     12  AM-1ST-PROD-DATE.
  6817         16  AM-1ST-PROD-YR                PIC XX.
  6818         16  AM-1ST-PROD-MO                PIC XX.
  6819         16  AM-1ST-PROD-DA                PIC XX.
  6820     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6821     12  AM-CERTS-PURGED-DATE.
  6822         16  AM-PUR-YR                     PIC XX.
  6823         16  AM-PUR-MO                     PIC XX.
  6824         16  AM-PUR-DA                     PIC XX.
  6825     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6826     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6827     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6828     12  AM-INACTIVE-DATE.
  6829         16  AM-INA-MO                     PIC 99.
  6830         16  AM-INA-DA                     PIC 99.
  6831         16  AM-INA-YR                     PIC 99.
  6832     12  AM-AR-HI-CERT-DATE                PIC XX.
  6833
  6834     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6835     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6836
  6837     12  AM-OB-PAYMENT-MODE                PIC X.
  6838         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6839         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6840         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6841         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6842
  6843     12  AM-AH-ONLY-INDICATOR              PIC X.
  6844         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6845         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6846
  6847     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6848
  6849     12  AM-OVER-SHORT.
  6850         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6851         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 126
* EL050.cbl
  6852
  6853     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6854     12  AM-DCC-CLP-STATE                  PIC XX.
  6855
  6856     12  AM-RECALC-COMM                    PIC X.
  6857     12  AM-RECALC-REIN                    PIC X.
  6858
  6859     12  AM-REI-TABLE                      PIC XXX.
  6860     12  AM-REI-ET-LF                      PIC X.
  6861     12  AM-REI-ET-AH                      PIC X.
  6862     12  AM-REI-PE-LF                      PIC X.
  6863     12  AM-REI-PE-AH                      PIC X.
  6864     12  AM-REI-PRT-ST                     PIC X.
  6865     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6866     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6867     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6868     12  AM-REI-GROUP-A                    PIC X(6).
  6869     12  AM-REI-MORT                       PIC X(4).
  6870     12  AM-REI-PRT-OW                     PIC X.
  6871     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6872     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6873     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6874     12  AM-REI-GROUP-B                    PIC X(6).
  6875
  6876     12  AM-TRUST-TYPE                     PIC X(2).
  6877
  6878     12  AM-EMPLOYER-STMT-USED             PIC X.
  6879     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6880
  6881     12  AM-STD-AH-TYPE                    PIC XX.
  6882     12  AM-EARN-METHODS.
  6883         16  AM-EARN-METHOD-R              PIC X.
  6884             88 AM-REF-RL-R78                 VALUE 'R'.
  6885             88 AM-REF-RL-PR                  VALUE 'P'.
  6886             88 AM-REF-RL-MEAN                VALUE 'M'.
  6887             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6888         16  AM-EARN-METHOD-L              PIC X.
  6889             88 AM-REF-LL-R78                 VALUE 'R'.
  6890             88 AM-REF-LL-PR                  VALUE 'P'.
  6891             88 AM-REF-LL-MEAN                VALUE 'M'.
  6892             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6893         16  AM-EARN-METHOD-A              PIC X.
  6894             88 AM-REF-AH-R78                 VALUE 'R'.
  6895             88 AM-REF-AH-PR                  VALUE 'P'.
  6896             88 AM-REF-AH-MEAN                VALUE 'M'.
  6897             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6898             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6899             88 AM-REF-AH-NET                 VALUE 'N'.
  6900
  6901     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6902     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6903     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6904
  6905     12  AM-RET-Y-N                        PIC X.
  6906     12  AM-RET-P-E                        PIC X.
  6907     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6908     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6909     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 127
* EL050.cbl
  6910     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6911         16  AM-POOL-PRIME                 PIC XXX.
  6912         16  AM-POOL-SUB                   PIC XXX.
  6913     12  AM-RETRO-EARNINGS.
  6914         16  AM-RET-EARN-R                 PIC X.
  6915         16  AM-RET-EARN-L                 PIC X.
  6916         16  AM-RET-EARN-A                 PIC X.
  6917     12  AM-RET-ST-TAX-USE                 PIC X.
  6918         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6919         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6920     12  AM-RETRO-BEG-EARNINGS.
  6921         16  AM-RET-BEG-EARN-R             PIC X.
  6922         16  AM-RET-BEG-EARN-L             PIC X.
  6923         16  AM-RET-BEG-EARN-A             PIC X.
  6924     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6925     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6926
  6927     12  AM-USER-SELECT-OPTIONS.
  6928         16  AM-USER-SELECT-1              PIC X(10).
  6929         16  AM-USER-SELECT-2              PIC X(10).
  6930         16  AM-USER-SELECT-3              PIC X(10).
  6931         16  AM-USER-SELECT-4              PIC X(10).
  6932         16  AM-USER-SELECT-5              PIC X(10).
  6933
  6934     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6935
  6936     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6937
  6938     12  AM-RPT045A-SWITCH                 PIC X.
  6939         88  RPT045A-OFF                   VALUE 'N'.
  6940
  6941     12  AM-INSURANCE-LIMITS.
  6942         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6943         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6944
  6945     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6946         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6947
  6948     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6949         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6950         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6951
  6952     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6953
  6954     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6955     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6956     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6957     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6958     12  AM-DCC-UEF-STATE                  PIC XX.
  6959     12  FILLER                            PIC XXX.
  6960     12  AM-REPORT-CODE-3                  PIC X(10).
  6961*    12  FILLER                            PIC X(22).
  6962
  6963     12  AM-RESERVE-DATE.
  6964         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6965         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6966         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6967
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 128
* EL050.cbl
  6968     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6969     12  AM-NOTIFICATION-TYPES.
  6970         16  AM-NOTIF-OF-LETTERS           PIC X.
  6971         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6972         16  AM-NOTIF-OF-REPORTS           PIC X.
  6973         16  AM-NOTIF-OF-STATUS            PIC X.
  6974
  6975     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6976         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6977         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6978         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6979         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6980
  6981     12  AM-BENEFIT-CONTROLS.
  6982         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6983             20  AM-BENEFIT-CODE           PIC XX.
  6984             20  AM-BENEFIT-TYPE           PIC X.
  6985             20  AM-BENEFIT-REVISION       PIC XXX.
  6986             20  AM-BENEFIT-REM-TERM       PIC X.
  6987             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6988             20  FILLER                    PIC XX.
  6989         16  FILLER                        PIC X(80).
  6990
  6991     12  AM-TRANSFER-DATA.
  6992         16  AM-TRANSFERRED-FROM.
  6993             20  AM-TRNFROM-CARRIER        PIC X.
  6994             20  AM-TRNFROM-GROUPING.
  6995                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6996                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6997             20  AM-TRNFROM-STATE          PIC XX.
  6998             20  AM-TRNFROM-ACCOUNT.
  6999                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  7000                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  7001             20  AM-TRNFROM-DTE            PIC XX.
  7002         16  AM-TRANSFERRED-TO.
  7003             20  AM-TRNTO-CARRIER          PIC X.
  7004             20  AM-TRNTO-GROUPING.
  7005                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  7006                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  7007             20  AM-TRNTO-STATE            PIC XX.
  7008             20  AM-TRNTO-ACCOUNT.
  7009                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  7010                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  7011             20  AM-TRNTO-DTE              PIC XX.
  7012         16  FILLER                        PIC X(10).
  7013
  7014     12  AM-SAVED-REMIT-TO                 PIC 99.
  7015
  7016     12  AM-COMM-STRUCTURE-SAVED.
  7017         16  AM-DEFN-1-SAVED.
  7018             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  7019                 24  AM-AGT-SV             PIC X(10).
  7020                 24  AM-COM-TYP-SV         PIC X.
  7021                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  7022                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  7023                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  7024                 24  AM-RECALC-LV-INDIC-SV PIC X.
  7025                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 129
* EL050.cbl
  7026                 24  AM-GL-CODES-SV        PIC X.
  7027                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  7028                 24  FILLER                PIC X.
  7029         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  7030             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  7031                 24  FILLER                PIC X(11).
  7032                 24  AM-L-COMA-SV          PIC XXX.
  7033                 24  AM-J-COMA-SV          PIC XXX.
  7034                 24  AM-A-COMA-SV          PIC XXX.
  7035                 24  FILLER                PIC X(6).
  7036
  7037     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  7038         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  7039            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  7040            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  7041            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  7042
  7043     12  AM-ORIG-DEALER-NO                 PIC X(10).
  7044     12  FILLER                            PIC X(120).
  7045
  7046     12  AM-ACCOUNT-EXECUTIVE-DATA.
  7047         16  AM-CONTROL-NAME               PIC X(30).
  7048         16  AM-EXECUTIVE-ONE.
  7049             20  AM-EXEC1-NAME             PIC X(15).
  7050             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  7051                                                          COMP-3.
  7052             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  7053                                                          COMP-3.
  7054         16  AM-EXECUTIVE-TWO.
  7055             20  AM-EXEC2-NAME             PIC X(15).
  7056             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  7057                                                          COMP-3.
  7058             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  7059                                                          COMP-3.
  7060
  7061     12  AM-RETRO-ADDITIONAL-DATA.
  7062         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  7063         16  AM-RETRO-PREM-P-E             PIC X.
  7064         16  AM-RETRO-CLMS-P-I             PIC X.
  7065         16  AM-RETRO-RET-BRACKET-LF.
  7066             20  AM-RETRO-RET-METHOD-LF    PIC X.
  7067                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  7068                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  7069             20  AM-RETRO-RET-BASIS-LF     PIC X.
  7070                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  7071                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  7072             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  7073                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  7074                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  7075         16  AM-RETRO-RET-BRACKET-AH.
  7076             20  AM-RETRO-RET-METHOD-AH    PIC X.
  7077                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  7078                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  7079                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  7080             20  AM-RETRO-RET-BASIS-AH     PIC X.
  7081                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  7082                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  7083             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 130
* EL050.cbl
  7084                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  7085                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  7086
  7087     12  AM-COMMENTS.
  7088         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  7089
  7090     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  7091         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  7092         16  AM-FLI-BILLING-CODE           PIC X.
  7093         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  7094         16  AM-FLI-UNITED-IDENT           PIC X.
  7095         16  AM-FLI-INTEREST-LOST-DATA.
  7096             20  AM-FLI-BANK-NO            PIC X(5).
  7097             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  7098             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  7099             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  7100         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  7101             20  AM-FLI-AGT                PIC X(9).
  7102             20  AM-FLI-AGT-COMM-ACC       PIC X.
  7103             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  7104         16  FILLER                        PIC X(102).
  7105
  7106     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  7107         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  7108             20  AM-BENEFIT-DMD-CODE         PIC XX.
  7109             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7110             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7111             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7112             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7113         16  FILLER                          PIC X(10).
  7114******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 131
* EL050.cbl
  7116*    COPY ERCREIN.
  7117******************************************************************
  7118*                                                                *
  7119*                            ERCREIN                             *
  7120*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7121*                            VMOD=2.010                          *
  7122*                                                                *
  7123*   ONLINE CREDIT SYSTEM                                         *
  7124*                                                                *
  7125*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  7126*                                                                *
  7127*   FILE TYPE = VSAM,KSDS                                        *
  7128*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  7129*                                                                *
  7130*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  7131*       ALTERNATE PATH = NONE                                    *
  7132*                                                                *
  7133*   LOG = NO                                                     *
  7134*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7135*                                                                *
  7136******************************************************************
  7137*                   C H A N G E   L O G
  7138*
  7139* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7140*-----------------------------------------------------------------
  7141*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7142* EFFECTIVE    NUMBER
  7143*-----------------------------------------------------------------
  7144* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  7145* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  7146******************************************************************
  7147 01  REINSURANCE-RECORD.
  7148     12  RE-RECORD-ID                      PIC XX.
  7149         88  VALID-RE-ID                      VALUE 'RE'.
  7150
  7151     12  RE-CONTROL-PRIMARY.
  7152         16  RE-COMPANY-CD                 PIC X.
  7153         16  RE-KEY.
  7154             20  RE-CODE                   PIC X.
  7155                 88  RE-TABLE-RECORD          VALUE 'A'.
  7156                 88  RE-COMPANY-RECORD        VALUE 'B'.
  7157             20  RE-TABLE                  PIC XXX.
  7158             20  FILLER                    PIC XXX.
  7159         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  7160             20  FILLER                    PIC X.
  7161             20  RE-COMPANY.
  7162                 24  RE-COMP-PRIME         PIC XXX.
  7163                 24  RE-COMP-SUB           PIC XXX.
  7164
  7165     12  RE-MAINT-INFORMATION.
  7166         16  RE-LAST-MAINT-DT              PIC XX.
  7167         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7168         16  RE-LAST-MAINT-USER            PIC X(4).
  7169         16  FILLER                        PIC X(10).
  7170
  7171     12  RE-TABLE-DATA.
  7172         16  RE-100-COMP                   PIC 99.
  7173
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 132
* EL050.cbl
  7174         16  RE-COMP-INFO    OCCURS 30 TIMES.
  7175             20  RE-REI-COMP-NO.
  7176                 24  RE-REI-COMP           PIC XXX.
  7177                 24  RE-REI-COMP-SUB       PIC XXX.
  7178             20  RE-LF-QC                  PIC X.
  7179             20  RE-AH-QC                  PIC X.
  7180             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  7181             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  7182             20  RE-LFAGE-LO               PIC 99.
  7183             20  RE-LFAGE-HI               PIC 99.
  7184             20  RE-AHAGE-LO               PIC 99.
  7185             20  RE-AHAGE-HI               PIC 99.
  7186             20  RE-LFTRM-LO               PIC S999       COMP-3.
  7187             20  RE-LFTRM-HI               PIC S999       COMP-3.
  7188             20  RE-AHTRM-LO               PIC S999       COMP-3.
  7189             20  RE-AHTRM-HI               PIC S999       COMP-3.
  7190             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  7191             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  7192             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  7193             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  7194             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  7195             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  7196             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  7197             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  7198             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  7199             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  7200             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  7201             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  7202             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  7203             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  7204             20  RE-LF-BEN-CODE            PIC X.
  7205             20  RE-AH-BEN-CODE            PIC X.
  7206             20  RE-INTERACTIVE            PIC X.
  7207             20  RE-REMAINING              PIC X.
  7208             20  RE-LF-RUNOFF-SW           PIC X.
  7209             20  RE-AH-RUNOFF-SW           PIC X.
  7210             20  FILLER                    PIC X(19).
  7211
  7212         16  RE-COMP-INFO-END              PIC X(6).
  7213         16  RE-NSP-ST-CD-LF               PIC XX.
  7214         16  RE-NSP-ST-CD-AH               PIC XX.
  7215         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7216             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7217
  7218         16  FILLER                        PIC X(27).
  7219
  7220     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7221         16  RE-NAME                       PIC X(30).
  7222         16  RE-LF-PE                      PIC X.
  7223         16  RE-AH-PE                      PIC X.
  7224         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7225         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7226         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7227         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7228         16  RE-PRT-ST                     PIC X.
  7229         16  RE-PRT-OW                     PIC X.
  7230         16  RE-MORT-CODE                  PIC X(4).
  7231         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 133
* EL050.cbl
  7232         16  RE-ZERO-LF-FEE                PIC X.
  7233         16  RE-ZERO-AH-FEE                PIC X.
  7234         16  RE-CEDE-NAME                  PIC X(30).
  7235         16  RE-LF-COMM                    PIC X.
  7236         16  RE-AH-COMM                    PIC X.
  7237         16  RE-LF-TAX                     PIC X.
  7238         16  RE-AH-TAX                     PIC X.
  7239         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7240         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7241         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7242
  7243         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7244             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7245
  7246         16  RE-LF-CEDING-FEE-BRACKETS.
  7247             20  RE-LF-FEE-METHOD          PIC X.
  7248                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7249                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7250                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7251                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7252             20  RE-LF-FEE-BASIS           PIC X.
  7253                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7254                 88  RE-LF-NET-CEDED               VALUE '2'.
  7255                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7256                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7257                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7258                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7259                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7260                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7261             20  FILLER                    PIC XXX.
  7262             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7263                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7264                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7265
  7266         16  RE-AH-CEDING-FEE-BRACKETS.
  7267             20  RE-AH-FEE-METHOD          PIC X.
  7268                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7269                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7270                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7271                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7272             20  RE-AH-FEE-BASIS           PIC X.
  7273                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7274                 88  RE-AH-NET-CEDED               VALUE '2'.
  7275                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7276                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7277                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7278                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7279                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7280                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7281             20  FILLER                    PIC XXX.
  7282             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7283                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7284                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7285
  7286         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7287
  7288         16  RE-OLD-CEDING-STMT            PIC X.
  7289
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 134
* EL050.cbl
  7290         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7291         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7292         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7293         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7294         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7295         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7296         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7297         16  RE-MORT-SW                    PIC X.
  7298         16  RE-CEDING-TYPE-FLAG           PIC X.
  7299             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7300             88  RE-CEDED                          VALUE 'C'.
  7301             88  RE-ASSUMED                        VALUE 'A'.
  7302             88  RE-PHANTOM                        VALUE 'P'.
  7303
  7304         16  RE-CEDING-STMT-OPT-A          PIC X.
  7305             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7306         16  RE-CEDING-STMT-OPT-B          PIC X.
  7307             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7308         16  RE-CEDING-STMT-OPT-C          PIC X.
  7309             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7310         16  RE-CEDING-STMT-OPT-D          PIC X.
  7311             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7312         16  RE-CEDING-STMT-OPT-E          PIC X.
  7313             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7314
  7315         16  RE-PRT-CRSV                   PIC X.
  7316
  7317         16  RE-GL-CENTER                  PIC X(4).
  7318
  7319         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7320
  7321         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7322
  7323         16  RE-EARN-STOP-CODE             PIC X.
  7324             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7325             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7326
  7327         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7328             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7329
  7330         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7331         16  FILLER                        PIC X(2281).
  7332
  7333         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7334
  7335******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 135
* EL050.cbl
  7337*    COPY ERCCTBL.
  7338******************************************************************
  7339*                                                                *
  7340*                                                                *
  7341*                            ERCCTBL                             *
  7342*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7343*                            VMOD=2.003
  7344*                                                                *
  7345*   ONLINE CREDIT SYSTEM                                         *
  7346*                                                                *
  7347*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7348*                                                                *
  7349*   FILE TYPE = VSAM,KSDS                                        *
  7350*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7351*                                                                *
  7352*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7353*       ALTERNATE PATH = NONE                                    *
  7354*                                                                *
  7355*   LOG = NO                                                     *
  7356*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7357*                                                                *
  7358*                                                                *
  7359******************************************************************
  7360
  7361 01  COMM-TABLE-RECORD.
  7362     12  CT-RECORD-ID                      PIC XX.
  7363         88  VALID-CT-ID                      VALUE 'CT'.
  7364
  7365     12  CT-CONTROL-PRIMARY.
  7366         16  CT-COMPANY-CD                 PIC X.
  7367         16  CT-TABLE                      PIC XXX.
  7368         16  CT-CNTRL-2.
  7369             20  CT-BEN-TYPE               PIC X.
  7370             20  CT-BEN-CODE               PIC XX.
  7371
  7372     12  CT-MAINT-INFORMATION.
  7373         16  CT-LAST-MAINT-DT              PIC XX.
  7374         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7375         16  CT-LAST-MAINT-USER            PIC X(4).
  7376         16  FILLER                        PIC X(31).
  7377
  7378     12  CT-LIMITS.
  7379         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7380
  7381         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7382
  7383         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7384
  7385     12  CT-RATES.
  7386         16  CT-RTX          OCCURS 27 TIMES.
  7387             20  CT-RT                     PIC SV9(5)     COMP-3.
  7388             20  CT-RT-R   REDEFINES
  7389                 CT-RT                     PIC XXX.
  7390
  7391     12  FILLER                            PIC  X(42).
  7392
  7393******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 136
* EL050.cbl
  7395*    COPY ERCFORM.
  7396******************************************************************
  7397*                                                                *
  7398*                                                                *
  7399*                            ERCFORM.                            *
  7400*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7401*                            VMOD=2.003                          *
  7402*                                                                *
  7403*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7404*                                                                *
  7405*    FILE TYPE = VSAM,KSDS                                       *
  7406*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7407*                                                                *
  7408*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7409*                                                                *
  7410*    LOG = YES                                                   *
  7411*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7412******************************************************************
  7413 01  FORM-MASTER.
  7414    12  FO-RECORD-ID                 PIC X(02).
  7415        88  VALID-FO-ID                  VALUE 'FO'.
  7416
  7417    12  FO-CONTROL-PRIMARY.
  7418        16  FO-COMPANY-CD            PIC X(01).
  7419        16  FO-STATE                 PIC X(02).
  7420        16  FO-FORM-ID               PIC X(12).
  7421        16  FO-FORM-EXP-DT           PIC X(02).
  7422
  7423    12  FO-POLICY-FORM-DATA.
  7424        16  FO-IND-GRP-CD            PIC X(01).
  7425        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7426        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7427        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7428        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7429        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7430        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7431        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7432        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7433        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7434        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7435        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7436        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7437        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7438        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7439        16  FO-APP-CERT-USE-CD       PIC X(01).
  7440
  7441    12  FILLER                       PIC X(29).
  7442
  7443    12  FO-FORM-PLAN-TABLE.
  7444        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7445            20  FO-PLAN-TYPE         PIC X(01).
  7446            20  FO-PLAN-ID           PIC X(02).
  7447            20  FO-PLAN-TERM         PIC 9(03).
  7448            20  FO-PLAN-REFUND-METHOD
  7449                                     PIC X.
  7450
  7451    12  FILLER                       PIC X(30).
  7452
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 137
* EL050.cbl
  7453    12  FO-COMMENTS-AREA.
  7454        16  FO-COMMENT-LINE-1        PIC X(78).
  7455
  7456    12  FILLER                       PIC X(20).
  7457
  7458    12  FO-MAINT-INFORMATION.
  7459        16  FO-LAST-MAINT-DT         PIC X(02).
  7460        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7461        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 138
* EL050.cbl
  7463*    COPY ELCMSTR.
  7464******************************************************************
  7465*                                                                *
  7466*                            ELCMSTR.                            *
  7467*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7468*                            VMOD=2.012                          *
  7469*                                                                *
  7470*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7471*                                                                *
  7472*   FILE TYPE = VSAM,KSDS                                        *
  7473*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7474*                                                                *
  7475*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7476*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7477*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7478*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7479*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7480*                                                 RKP=75,LEN=21  *
  7481*                                                                *
  7482*   **** NOTE ****                                               *
  7483*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7484*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7485*                                                                *
  7486*   LOG = YES                                                    *
  7487*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7488******************************************************************
  7489*                   C H A N G E   L O G
  7490*
  7491* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7492*-----------------------------------------------------------------
  7493*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7494* EFFECTIVE    NUMBER
  7495*-----------------------------------------------------------------
  7496* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7497* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7498* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7499* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7500* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7501* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  7502******************************************************************
  7503 01  CLAIM-MASTER.
  7504     12  CL-RECORD-ID                PIC XX.
  7505         88  VALID-CL-ID         VALUE 'CL'.
  7506
  7507     12  CL-CONTROL-PRIMARY.
  7508         16  CL-COMPANY-CD           PIC X.
  7509         16  CL-CARRIER              PIC X.
  7510         16  CL-CLAIM-NO             PIC X(7).
  7511         16  CL-CERT-NO.
  7512             20  CL-CERT-PRIME       PIC X(10).
  7513             20  CL-CERT-SFX         PIC X.
  7514
  7515     12  CL-CONTROL-BY-NAME.
  7516         16  CL-COMPANY-CD-A1        PIC X.
  7517         16  CL-INSURED-LAST-NAME    PIC X(15).
  7518         16  CL-INSURED-NAME.
  7519             20  CL-INSURED-1ST-NAME PIC X(12).
  7520             20  CL-INSURED-MID-INIT PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 139
* EL050.cbl
  7521
  7522     12  CL-CONTROL-BY-SSN.
  7523         16  CL-COMPANY-CD-A2        PIC X.
  7524         16  CL-SOC-SEC-NO.
  7525             20  CL-SSN-STATE        PIC XX.
  7526             20  CL-SSN-ACCOUNT      PIC X(6).
  7527             20  CL-SSN-LN3          PIC X(3).
  7528
  7529     12  CL-CONTROL-BY-CERT-NO.
  7530         16  CL-COMPANY-CD-A4        PIC X.
  7531         16  CL-CERT-NO-A4.
  7532             20  CL-CERT-A4-PRIME    PIC X(10).
  7533             20  CL-CERT-A4-SFX      PIC X.
  7534
  7535     12  CL-CONTROL-BY-CCN.
  7536         16  CL-COMPANY-CD-A5        PIC X.
  7537         16  CL-CCN-A5.
  7538             20  CL-CCN.
  7539                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7540                 24  CL-CCN-PRIME-A5 PIC X(12).
  7541             20  CL-CCN-FILLER-A5    PIC X(4).
  7542
  7543     12  CL-INSURED-PROFILE-DATA.
  7544         16  CL-INSURED-BIRTH-DT     PIC XX.
  7545         16  CL-INSURED-SEX-CD       PIC X.
  7546             88  INSURED-IS-MALE        VALUE 'M'.
  7547             88  INSURED-IS-FEMALE      VALUE 'F'.
  7548             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7549         16  CL-INSURED-OCC-CD       PIC X(6).
  7550         16  FILLER                  PIC X(5).
  7551
  7552     12  CL-PROCESSING-INFO.
  7553         16  CL-PROCESSOR-ID         PIC X(4).
  7554         16  CL-CLAIM-STATUS         PIC X.
  7555             88  CLAIM-IS-OPEN          VALUE 'O'.
  7556             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7557         16  CL-CLAIM-TYPE           PIC X.
  7558*            88  AH-CLAIM               VALUE 'A'.
  7559*            88  LIFE-CLAIM             VALUE 'L'.
  7560*            88  PROPERTY-CLAIM         VALUE 'P'.
  7561*            88  IUI-CLAIM              VALUE 'I'.
  7562*            88  GAP-CLAIM              VALUE 'G'.
  7563*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7564         16  CL-CLAIM-PREM-TYPE      PIC X.
  7565             88  SINGLE-PREMIUM         VALUE '1'.
  7566             88  O-B-COVERAGE           VALUE '2'.
  7567             88  OPEN-END-COVERAGE      VALUE '3'.
  7568         16  CL-INCURRED-DT          PIC XX.
  7569         16  CL-REPORTED-DT          PIC XX.
  7570         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7571         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7572         16  CL-LAST-PMT-DT          PIC XX.
  7573         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7574         16  CL-PAID-THRU-DT         PIC XX.
  7575         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7576         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7577         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7578         16  CL-PMT-CALC-METHOD      PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 140
* EL050.cbl
  7579             88  CL-360-DAY-YR          VALUE '1'.
  7580             88  CL-365-DAY-YR          VALUE '2'.
  7581             88  CL-FULL-MONTHS         VALUE '3'.
  7582         16  CL-CAUSE-CD             PIC X(6).
  7583
  7584         16  CL-PRIME-CERT-NO.
  7585             20  CL-PRIME-CERT-PRIME PIC X(10).
  7586             20  CL-PRIME-CERT-SFX   PIC X.
  7587
  7588         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7589             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7590             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7591
  7592         16  CL-MICROFILM-NO         PIC X(10).
  7593         16  FILLER REDEFINES CL-MICROFILM-NO.
  7594             20  CL-BENEFIT-PERIOD   PIC 99.
  7595             20  FILLER              PIC X(8).
  7596         16  CL-PROG-FORM-TYPE       PIC X.
  7597         16  CL-LAST-ADD-ON-DT       PIC XX.
  7598
  7599         16  CL-LAST-REOPEN-DT       PIC XX.
  7600         16  CL-LAST-CLOSE-DT        PIC XX.
  7601         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7602             88  FINAL-PAID             VALUE '1'.
  7603             88  CLAIM-DENIED           VALUE '2'.
  7604             88  AUTO-CLOSE             VALUE '3'.
  7605             88  MANUAL-CLOSE           VALUE '4'.
  7606             88  BENEFITS-CHANGED       VALUE 'C'.
  7607             88  SETUP-ERRORS           VALUE 'E'.
  7608         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7609         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7610         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7611             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7612         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7613         16  FILLER                  PIC X.
  7614
  7615     12  CL-CERTIFICATE-DATA.
  7616         16  CL-CERT-ORIGIN          PIC X.
  7617             88  CERT-WAS-ONLINE        VALUE '1'.
  7618             88  CERT-WAS-CREATED       VALUE '2'.
  7619             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7620         16  CL-CERT-KEY-DATA.
  7621             20  CL-CERT-CARRIER     PIC X.
  7622             20  CL-CERT-GROUPING    PIC X(6).
  7623             20  CL-CERT-STATE       PIC XX.
  7624             20  CL-CERT-ACCOUNT.
  7625                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7626                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7627             20  CL-CERT-EFF-DT      PIC XX.
  7628
  7629     12  CL-STATUS-CONTROLS.
  7630         16  CL-PRIORITY-CD          PIC X.
  7631             88  CONFIDENTIAL-DATA      VALUE '8'.
  7632             88  HIGHEST-PRIORITY       VALUE '9'.
  7633         16  CL-SUPV-ATTN-CD         PIC X.
  7634             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7635             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7636         16  CL-PURGED-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 141
* EL050.cbl
  7637         16  CL-RESTORED-DT          PIC XX.
  7638         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7639         16  CL-NEXT-RESEND-DT       PIC XX.
  7640         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7641         16  CL-CRITICAL-PERIOD      PIC 99.
  7642*        16  FILLER                  PIC XX.
  7643         16  CL-LAST-MAINT-DT        PIC XX.
  7644         16  CL-LAST-MAINT-USER      PIC X(4).
  7645         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7646         16  CL-LAST-MAINT-TYPE      PIC X.
  7647             88  CLAIM-SET-UP           VALUE ' '.
  7648             88  PAYMENT-MADE           VALUE '1'.
  7649             88  LETTER-SENT            VALUE '2'.
  7650             88  MASTER-WAS-ALTERED     VALUE '3'.
  7651             88  MASTER-WAS-RESTORED    VALUE '4'.
  7652             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7653             88  FILE-CONVERTED         VALUE '6'.
  7654             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7655             88  ERROR-CORRECTION       VALUE 'E'.
  7656         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7657         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7658         16  CL-BENEFICIARY          PIC X(10).
  7659         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7660         16  CL-DENIAL-TYPE          PIC X.
  7661             88  CL-TYPE-DENIAL          VALUE '1'.
  7662             88  CL-TYPE-RESCISSION      VALUE '2'.
  7663             88  CL-TYPE-REFORMATION     VALUE '3'.
  7664             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7665             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7666         16  CL-NO-OF-EXTENSIONS     PIC 99.
  7667         16  filler                  pic x(3).
  7668*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7669*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7670*        16  CL-RTW-DT               PIC XX.
  7671
  7672     12  CL-TRAILER-CONTROLS.
  7673         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7674             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7675             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7676             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7677         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7678         16  FILLER                  PIC XX.
  7679         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7680         16  CL-ADDRESS-TRAILER-CNT.
  7681             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7682                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7683             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7684                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7685             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7686                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7687             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7688                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7689             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7690                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7691             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7692                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7693             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7694                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 142
* EL050.cbl
  7695
  7696     12  CL-CV-REFERENCE-NO.
  7697         16  CL-CV-REFNO-PRIME       PIC X(18).
  7698         16  CL-CV-REFNO-SFX         PIC XX.
  7699
  7700     12  CL-FILE-LOCATION            PIC X(4).
  7701
  7702     12  CL-PROCESS-ERRORS.
  7703         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7704             88  NO-FATAL-ERRORS        VALUE ZERO.
  7705         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7706             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7707
  7708     12  CL-PRODUCT-CD               PIC X.
  7709
  7710     12  CL-CURRENT-KEY-DATA.
  7711         16  CL-CURRENT-CARRIER      PIC X.
  7712         16  CL-CURRENT-GROUPING     PIC X(6).
  7713         16  CL-CURRENT-STATE        PIC XX.
  7714         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7715
  7716     12  CL-ASSOCIATES               PIC X.
  7717         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7718         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7719         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7720         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7721
  7722     12  CL-ACTIVITY-CODE            PIC 99.
  7723     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7724     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7725
  7726     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7727     12  CL-LAG-REPORT-CODE          PIC 9.
  7728     12  CL-LOAN-TYPE                PIC XX.
  7729     12  CL-LEGAL-STATE              PIC XX.
  7730
  7731     12  CL-YESNOSW                  PIC X.
  7732     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7733         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7734         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7735         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7736     12  cl-insured-type             pic x.
  7737         88  cl-claim-on-primary         value 'P'.
  7738         88  cl-claim-on-co-borrower     value 'C'.
  7739     12  cl-benefit-expiration-dt    PIC XX.
  7740
  7741 01  PLAN-RECORDS.
  7742     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7743     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7744
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 143
* EL050.cbl
  7746 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7747                          ACCOUNT-MASTER REINSURANCE-RECORD
  7748                          COMM-TABLE-RECORD FORM-MASTER
  7749                          CLAIM-MASTER PLAN-RECORDS.
  7750 0000-DFHEXIT SECTION.
  7751     MOVE '9#                    $   ' TO DFHEIV0.
  7752     MOVE 'EL050' TO DFHEIV1.
  7753     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7754
  7755     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7756
  7757
  7758* EXEC CICS  HANDLE CONDITION
  7759*           ERROR    (9300-ABEND)
  7760*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7761*    END-EXEC.
  7762*    MOVE '"$.J                  ! " #00007753' TO DFHEIV0
  7763     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7764     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7765     MOVE X'2220233030303037373533' TO DFHEIV0(25:11)
  7766     CALL 'kxdfhei1' USING DFHEIV0
  7767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7768
  7769
  7770 0000-COPY-PROCEDURE-DIV.
  7771*                          COPY ELC50PD.
  7772******************************************************************
  7773*                                                                *
  7774*                            ELC50PD                             *
  7775*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7776*                            VMOD=2.188                          *
  7777*                                                                *
  7778******************************************************************
  7779*                   C H A N G E   L O G
  7780*
  7781* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7782*-----------------------------------------------------------------
  7783*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7784* EFFECTIVE    NUMBER
  7785*-----------------------------------------------------------------
  7786* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7787* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7788* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7789*                             2709 AND 2718
  7790* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7791* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7792* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7793* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7794* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7795*                                IS OPEN OR CNC DT < PD THRU
  7796* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7797* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7798* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7799* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7800* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7801* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7802* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7803* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 144
* EL050.cbl
  7804* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7805* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7806* 020906                   PEMA  EXPAND LOAN OFFICER
  7807* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7808* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7809* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7810* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7811* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7812* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7813* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7814* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7815* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7816* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7817* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7818* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7819* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7820* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7821* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7822* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7823* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7824* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7825* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7826* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7827* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7828* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7829* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7830* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7831* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7832*                                UPDATE VIN ON CERT TRAILER
  7833* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7834* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7835* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7836* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7837* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7838* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7839* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7840* 040610  IR2010030800001  PEMA  INIT Alternate BENEFIT
  7841* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7842* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7843* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7844* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7845* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7846* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7847* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7848* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7849* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7850* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7851* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7852* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7853* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7854* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7855* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7856* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7857* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7858* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7859* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7860* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7861* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 145
* EL050.cbl
  7862* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7863* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7864* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7865* 032912  CR2011110200001  PEMA  AHL CHANGES
  7866* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7867* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7868* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7869* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7870* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7871* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7872* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7873* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7874* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7875* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7876* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7877* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7878* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7879* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7880* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7881* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7882* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7883* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7884* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7885* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7886* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
  7887* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7888* 052114  IR2014042900002  PEMA  CORRECT CANCEL EDIT ON VOIDS
  7889* 051914  CR2014043000002  TANA  ADD CAUSAL STATE
  7890* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  7891* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  7892* 100114  IR2014100100003  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
  7893*                                CERT #, ADD 2898 FORCIBLE ERROR
  7894* 100214  IR2014100100002  PEMA  CHG WAY CAR7 CLP IS CALCED
  7895* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  7896* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
  7897* 121815  CR2015121700006  PEMA  ADD HANDLING FOR FOREIGN VINS
  7898* 010416  CR2015082600001  PEMA  ADD CID and DCC TO MON CODE
  7899* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  7900* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
  7901* 021916  CR2014010900001  TANA  ADD ACCT STATUS D,L,R,P
  7902* 032516  IR2016032100002  PEMA  Correct tolerance for DCC.
  7903* 041816  CR2009093000001  PEMA  enhance car, st lvl prem taxes
  7904* 052516  IR2016052400001  PEMA  Correct malformed IF stmt.
  7905* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
  7906* 052317  IR2017052300001  PEMA  Correct malformed conditional stm
  7907* 062717  IR2017061900003  PEMA  Fix 0% APR on refunds
  7908* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  7909* 100617  CR2017062000003  PEMA  New comm cap edits
  7910******************************************************************
  7911************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7912******************************************************************
  7913
  7914     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7915
  7916     MOVE SPACES                 TO PB-FATAL-FLAG
  7917                                    PB-FORCE-ER-CD
  7918                                    PB-WARN-ER-CD
  7919                                    PB-OUT-BAL-CD.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 146
* EL050.cbl
  7920
  7921     MOVE SPACE                  TO WS-IG-OVRD-AH
  7922                                    WS-IG-OVRD-LF
  7923                                    WS-IG-OVRD-AM
  7924                                    WS-IG-OVRD
  7925                                    WS-IG-OVRD-AH-PL
  7926                                    WS-IG-OVRD-LF-PL
  7927                                    WS-IG-OVRD-AH-BEN
  7928                                    WS-IG-OVRD-LF-BEN.
  7929
  7930******************************************************************
  7931*************       INITIALIZE COMMON ERRORS       ***************
  7932******************************************************************
  7933
  7934     MOVE +0                     TO PB-NO-OF-ERRORS.
  7935     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7936
  7937******************************************************************
  7938
  7939     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7940     SET JULIAN-TO-BIN           TO TRUE.
  7941*    MOVE 5                      TO DC-OPTION-CODE.
  7942     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7943     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7944
  7945     MOVE ZERO                   TO  SUB4.
  7946
  7947 0040-INITIALIZE-GA-BILL-DT.
  7948
  7949     ADD +1                      TO  SUB4.
  7950
  7951     IF  SUB4 GREATER THAN +5
  7952         GO TO 0050-CHECK-CNTL-FOUND.
  7953
  7954     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7955         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7956
  7957     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7958
  7959 0050-CHECK-CNTL-FOUND.
  7960
  7961     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7962        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7963                                         WS-AH-REM-TERM-CALC
  7964                                         EC-CO-REM-TERM-CALC
  7965        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7966        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7967        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7968                                         WS-TOL-AH-CLAIM
  7969        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7970                                         WS-TOL-AH-PREM
  7971                                         EC-CO-TOL-PREM
  7972        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7973                                         WS-TOL-AH-REFUND
  7974                                         EC-CO-TOL-REFUND
  7975        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7976                                         WS-AH-REFUND-OVS-AMT
  7977                                         EC-CO-OVR-SHT-AMT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 147
* EL050.cbl
  7978        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7979                                         WS-TOL-AH-PREM-PCT
  7980                                         EC-CO-TOL-PREM-PCT
  7981        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7982                                         WS-TOL-AH-REFUND-PCT
  7983                                         EC-CO-TOL-REFUND-PCT
  7984        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7985                                         WS-AH-REFUND-OVS-PCT
  7986                                         EC-CO-OVR-SHT-PCT
  7987        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7988        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7989        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7990        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7991        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7992        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7993        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7994        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7995        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7996        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7997        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7998        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7999                                         EC-CO-MONTH-END-DT
  8000        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  8001          GO TO 0100-READ-ACCT.
  8002
  8003     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8004     MOVE SPACES                 TO CNTL-ACCESS.
  8005     MOVE '1'                    TO CNTL-REC-TYPE.
  8006     MOVE +0                     TO CNTL-SEQ-NO.
  8007
  8008     MOVE '1' TO RC-SW-1.
  8009     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  8010     IF NOT CF-COMPANY-MASTER
  8011         MOVE ZEROS             TO WK-CO-TOL-PREM
  8012                                   WK-CO-TOL-CLAIM
  8013                                   WK-CO-TOL-REFUND
  8014                                   WK-REFUND-OVS-AMT
  8015                                   WK-REFUND-OVS-PCT
  8016                                   WK-CO-TOL-PREM-PCT
  8017                                   WK-CO-TOL-REFUND-PCT
  8018                                   WK-DEFAULT-APR
  8019                                   WK-CO-MAX-CAP
  8020        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  8021                                   WK-CR-R78-METHOD
  8022                                   WK-CO-REF-REJECT-SW
  8023                                   WK-CO-PREM-REJECT-SW
  8024                                   WK-REM-TRM-CALC-OPTION
  8025                                   WK-BIRTH-DATE-INPUT
  8026                                   WK-JOINT-AGE-INPUT
  8027        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  8028        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  8029        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  8030        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  8031          GO TO 0099-COMPANY-NOT-FOUND.
  8032
  8033     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  8034        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  8035     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 148
* EL050.cbl
  8036        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  8037     IF CF-CO-TOL-CAP NOT NUMERIC
  8038        MOVE +0                    TO CF-CO-TOL-CAP.
  8039     IF CF-DEFAULT-APR NOT NUMERIC
  8040        MOVE +0                    TO CF-DEFAULT-APR.
  8041
  8042     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  8043     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  8044     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  8045     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  8046     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  8047     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  8048     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  8049     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  8050     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  8051     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  8052     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  8053     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  8054
  8055     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  8056          CF-CO-OVR-SHT-AMT > +0
  8057        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  8058
  8059     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  8060          CF-CO-OVR-SHT-PCT > +0
  8061        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  8062
  8063     IF CF-VALID-REM-TRM-OPTION
  8064         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  8065     ELSE
  8066         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  8067
  8068     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  8069     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  8070     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  8071     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  8072
  8073     GO TO 0050-CHECK-CNTL-FOUND.
  8074
  8075 0099-COMPANY-NOT-FOUND.
  8076
  8077     MOVE ER-2616                TO WS-ERROR.
  8078     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8079
  8080 0100-READ-ACCT.
  8081
  8082     MOVE SPACES                 TO DATE-RANGE-SW.
  8083
  8084     IF WK-ACCT-ADDR = ZEROS
  8085        GO TO 0102-ACCT-GETMAIN.
  8086
  8087     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  8088     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  8089     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8090
  8091     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8092        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8093        GO TO 0105-READ-ACCT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 149
* EL050.cbl
  8094     END-IF
  8095
  8096     IF PB-CARRIER NOT = SPACES
  8097        IF PB-CARRIER NOT = AM-VG-CARRIER
  8098           GO TO 0105-READ-ACCT.
  8099
  8100     IF PB-STATE NOT = SPACES
  8101        IF PB-STATE NOT = AM-VG-STATE
  8102           GO TO 0105-READ-ACCT.
  8103
  8104     IF PB-GROUPING NOT = SPACES
  8105        IF PB-GROUPING NOT = AM-VG-GROUPING
  8106           GO TO 0105-READ-ACCT.
  8107
  8108     MOVE 'X'                 TO DATE-RANGE-SW.
  8109
  8110     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8111        MOVE 'X'                 TO DATE-RANGE-SW
  8112        GO TO 0105-READ-ACCT.
  8113
  8114     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8115        GO TO 0105-READ-ACCT.
  8116
  8117     GO TO 0180-ACCOUNT-FOUND.
  8118
  8119 0102-ACCT-GETMAIN.
  8120     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  8121     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  8122
  8123 0105-READ-ACCT.
  8124     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  8125     MOVE PB-CARRIER             TO ACCT-CARRIER.
  8126     MOVE PB-GROUPING            TO ACCT-GROUPING.
  8127     MOVE PB-STATE               TO ACCT-STATE.
  8128     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  8129     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  8130
  8131     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  8132
  8133     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  8134
  8135 0110-FIND-ACCT-TOLERANCES-LOOP.
  8136     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  8137
  8138     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8139        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8140        GO TO 0199-ACCT-NOT-FOUND
  8141     END-IF
  8142     IF PB-CARRIER NOT = SPACES
  8143        IF PB-CARRIER NOT = AM-VG-CARRIER
  8144           GO TO 0199-ACCT-NOT-FOUND.
  8145
  8146     IF PB-STATE NOT = SPACES
  8147        IF PB-STATE NOT = AM-VG-STATE
  8148           GO TO 0199-ACCT-NOT-FOUND.
  8149
  8150     IF PB-GROUPING NOT = SPACES
  8151        IF PB-GROUPING NOT = AM-VG-GROUPING
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 150
* EL050.cbl
  8152           GO TO 0199-ACCT-NOT-FOUND.
  8153
  8154     MOVE 'X'                    TO DATE-RANGE-SW.
  8155
  8156     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8157        MOVE 'X'                 TO DATE-RANGE-SW
  8158        GO TO 0199-ACCT-NOT-FOUND.
  8159
  8160     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8161        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  8162
  8163 0180-ACCOUNT-FOUND.
  8164     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  8165     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  8166     MOVE AM-STATE               TO PB-SV-STATE.
  8167     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  8168
  8169     IF AM-CANCEL-FEE  NOT NUMERIC
  8170        MOVE ZEROS TO AM-CANCEL-FEE.
  8171
  8172     IF AM-MAX-MON-BEN NOT NUMERIC
  8173        MOVE ZEROS TO AM-MAX-MON-BEN.
  8174
  8175     IF AM-MAX-TOT-BEN NOT NUMERIC
  8176        MOVE ZEROS TO AM-MAX-TOT-BEN.
  8177
  8178     IF AM-CLP-TOL-PCT NOT NUMERIC
  8179        MOVE +0                  TO AM-CLP-TOL-PCT
  8180     END-IF
  8181     IF AM-SPP-LEASE-COMM NOT NUMERIC
  8182        MOVE +0                  TO AM-SPP-LEASE-COMM
  8183     END-IF
  8184     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8185        MOVE ER-2611             TO   WS-ERROR
  8186        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8187
  8188     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8189        MOVE ER-2621             TO   WS-ERROR
  8190        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8191
  8192     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  8193        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  8194        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  8195        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  8196         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  8197
  8198     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  8199     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  8200     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  8201     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  8202     IF AM-CLP-TOL-PCT NOT = ZEROS
  8203        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  8204     END-IF
  8205     IF AM-SPP-LEASE-COMM NOT = ZEROS
  8206        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  8207     END-IF
  8208*    IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8209*       MOVE +0                  TO WS-ACCT-ADDL-CLP
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 151
* EL050.cbl
  8210*                                   WS-ADMIN-FEES
  8211*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  8212*          (SUB5 > +10)
  8213*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8214*             AND (AM-A-COM (SUB5) NUMERIC)
  8215*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8216*                + (AM-A-COM (SUB5) * 1000)
  8217*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8218*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8219*                + (AM-A-COM (SUB5) * 1000)
  8220*             END-IF
  8221*             IF AM-COM-TYP (SUB5) = 'N'
  8222*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8223*                + (AM-A-COM (SUB5) * 1000)
  8224*             END-IF
  8225*          END-IF
  8226*       END-PERFORM
  8227*    END-IF
  8228     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  8229        AND (PB-ISSUE)
  8230        MOVE +0                  TO WS-ACCT-ADDL-CLP
  8231                                    ws-cred-union-fees
  8232        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8233           (SUB5 > +10)
  8234           MOVE +0 TO WS-WK-RATE
  8235           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N' OR
  8236                                   'O' OR 'S')
  8237              IF (AM-A-COM (SUB5) NUMERIC)
  8238                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8239                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8240              ELSE
  8241                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8242                 IF PB-ISSUE
  8243                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8244                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8245                 ELSE
  8246                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8247                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8248                 END-IF
  8249                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8250                 MOVE ZEROS             TO WS-SUB1
  8251                                           WS-COMMISSION
  8252                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8253                 MOVE '0530'               TO CTBL-SW
  8254                 MOVE ' '                  TO WS-CTBL-READ-SW
  8255                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8256                 IF FIRST-TIME-THROUGH
  8257                    MOVE 'AA'              TO CTBL-BEN-CODE
  8258                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8259                 END-IF
  8260                 IF CTBL-TABLE-FOUND
  8261                    IF PB-ISSUE
  8262                       COMPUTE WS-COMM-CK-AMT =
  8263                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8264                    ELSE
  8265                       COMPUTE WS-COMM-CK-AMT =
  8266                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8267                    END-IF
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 152
* EL050.cbl
  8268                    PERFORM 8800-GET-COMP-RATE
  8269                              THRU 8800-EXIT
  8270                 END-IF
  8271              END-IF
  8272              if am-com-typ (sub5) = 'O' or 'S'
  8273                 compute ws-cred-union-fees rounded =
  8274                    ws-cred-union-fees +
  8275                    (pb-i-ah-premium-amt * ws-wk-rate)
  8276              else
  8277                 COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8278                + (WS-WK-RATE * 1000)
  8279              end-if
  8280           END-IF
  8281        END-PERFORM
  8282     END-IF
  8283     IF PB-COMPANY-ID EQUAL 'CRI'
  8284         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8285
  8286     IF PB-COMPANY-ID EQUAL 'NCL'
  8287         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8288     END-IF
  8289
  8290     GO TO 0200-READ-CERT.
  8291
  8292 0199-ACCT-NOT-FOUND.
  8293
  8294     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8295
  8296     IF DATE-RANGE-SW NOT = SPACES
  8297        MOVE ER-2601             TO WS-ERROR
  8298        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8299     ELSE
  8300        MOVE ER-2619             TO WS-ERROR
  8301        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8302
  8303     GO TO 9990-RETURN.
  8304
  8305 0200-READ-CERT.
  8306
  8307     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8308     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8309     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8310     MOVE PB-SV-STATE            TO CERT-STATE.
  8311     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8312     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8313     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8314
  8315     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8316
  8317     IF CERT-WAS-NOT-FOUND
  8318        GO TO 0299-CERT-NOT-FOUND.
  8319
  8320     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8321        MOVE ER-2759             TO WS-ERROR
  8322        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8323        GO TO 0298-UNLOCK-RETURN.
  8324
  8325     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 153
* EL050.cbl
  8326         MOVE ER-2758            TO WS-ERROR
  8327         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8328         GO TO 0298-UNLOCK-RETURN.
  8329
  8330     IF PB-ISSUE
  8331        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8332           IF CERT-WAS-CREATED-FOR-CLAIM
  8333              NEXT SENTENCE
  8334            ELSE
  8335              MOVE ER-2626       TO WS-ERROR
  8336              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8337              GO TO 0298-UNLOCK-RETURN.
  8338
  8339     IF NOT PB-CANCELLATION
  8340        GO TO 0300-CONTINUE-EDIT.
  8341
  8342     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8343     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8344     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8345     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8346     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8347     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8348
  8349     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8350     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8351     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8352     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8353     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8354     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8355     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8356     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8357     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8358
  8359     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8360     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8361     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8362     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8363     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8364     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8365     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8366
  8367     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8368     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8369
  8370     MOVE CM-CREDIT-INTERFACE-SW-1
  8371                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8372     MOVE CM-CREDIT-INTERFACE-SW-2
  8373                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8374
  8375     IF CM-O-B-COVERAGE
  8376         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8377
  8378     IF CM-LIVES NOT NUMERIC
  8379         MOVE ZERO                TO CM-LIVES.
  8380
  8381     IF CM-BILLED NOT NUMERIC
  8382         MOVE ZERO                TO CM-BILLED.
  8383
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 154
* EL050.cbl
  8384     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8385         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8386         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8387         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8388         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8389         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8390         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8391         MOVE CM-LIVES             TO PB-CI-LIVES
  8392*The next line causes a problem with my change  I dont think it is
  8393*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8394
  8395     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8396     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8397     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8398     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8399     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8400     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8401
  8402     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8403     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8404     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8405     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8406
  8407     IF CM-LIFE-COMM-PCT NUMERIC
  8408         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8409     ELSE
  8410         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8411
  8412     IF CM-AH-COMM-PCT NUMERIC
  8413         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8414     ELSE
  8415         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8416
  8417     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8418
  8419     IF CM-LOAN-APR       NOT NUMERIC
  8420           MOVE ZERO               TO CM-LOAN-APR.
  8421
  8422     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8423           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8424
  8425     IF CM-LOAN-TERM      NOT NUMERIC
  8426           MOVE ZERO               TO CM-LOAN-TERM.
  8427
  8428     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8429           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8430
  8431     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8432           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8433
  8434     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8435     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8436     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8437     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8438     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8439     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8440     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8441     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 155
* EL050.cbl
  8442     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8443     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8444     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8445     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8446
  8447     IF CM-STATE = CM-SSN-STATE
  8448         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8449
  8450     IF CM-STATE NOT = CM-MEMB-STATE
  8451         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8452
  8453     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8454
  8455     IF PB-COMPANY-ID = 'CVL' OR 'DCC' or 'VPP'
  8456        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8457        IF CM-ADDL-CLP NOT NUMERIC
  8458           MOVE +0               TO CM-ADDL-CLP
  8459        END-IF
  8460        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8461        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8462           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8463        END-IF
  8464     END-IF
  8465     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8466        MOVE +0                  TO WS-ADMIN-FEES
  8467                                    WS-CSO-ADMIN-FEE
  8468                                    WS-COMM-AND-MFEE
  8469                                    WS-1ST-YR-ALLOW
  8470        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8471           (SUB5 > +10)
  8472           MOVE +0 TO WS-WK-RATE
  8473           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8474              IF (AM-A-COM (SUB5) NUMERIC)
  8475                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8476                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8477              ELSE
  8478                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8479                 IF PB-ISSUE
  8480                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8481                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8482                 ELSE
  8483                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8484                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8485                 END-IF
  8486                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8487                 MOVE ZEROS             TO WS-SUB1
  8488                                           WS-COMMISSION
  8489                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8490                 MOVE '0530'               TO CTBL-SW
  8491                 MOVE ' '                  TO WS-CTBL-READ-SW
  8492                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8493                 IF FIRST-TIME-THROUGH
  8494                    MOVE 'AA'              TO CTBL-BEN-CODE
  8495                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8496                 END-IF
  8497                 IF CTBL-TABLE-FOUND
  8498                    IF PB-ISSUE
  8499                       COMPUTE WS-COMM-CK-AMT =
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 156
* EL050.cbl
  8500                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8501                    ELSE
  8502                       COMPUTE WS-COMM-CK-AMT =
  8503                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8504                    END-IF
  8505                    PERFORM 8800-GET-COMP-RATE
  8506                              THRU 8800-EXIT
  8507                 END-IF
  8508              END-IF
  8509              IF AM-COM-TYP (SUB5) = 'I'
  8510                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8511                   + (WS-WK-RATE * 1000)
  8512              END-IF
  8513              IF AM-COM-TYP (SUB5) = 'N'
  8514                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8515                   + (WS-WK-RATE * 1000)
  8516              END-IF
  8517              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8518                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8519                   + (WS-WK-RATE * 1000)
  8520              END-IF
  8521              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8522                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8523                   + (WS-WK-RATE * 1000)
  8524              END-IF
  8525           END-IF
  8526        END-PERFORM
  8527     END-IF
  8528     GO TO 0300-CONTINUE-EDIT.
  8529
  8530 0298-UNLOCK-RETURN.
  8531      PERFORM 9250-UNLOCK-RETURN
  8532      GO TO 9990-RETURN.
  8533
  8534 0299-CERT-NOT-FOUND.
  8535
  8536     MOVE '1'                     TO CERT-STATUS-SW.
  8537
  8538     IF PB-COMPANY-ID = 'UCL'
  8539         IF WS-ERROR = ER-2799
  8540             GO TO 3000-CONTINUE-EDIT.
  8541
  8542     IF NOT PB-CANCELLATION
  8543         GO TO 0300-CONTINUE-EDIT.
  8544
  8545     MOVE ER-2726                  TO  WS-ERROR.
  8546     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8547     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8548     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8549                                    PB-CI-LF-TERM
  8550                                    PB-C-LF-REM-TERM
  8551                                    PB-CI-AH-TERM
  8552                                    PB-C-AH-REM-TERM
  8553                                    PB-CI-LF-BENEFIT-CD
  8554                                    PB-CI-LF-BENEFIT-AMT
  8555                                    PB-CI-LF-ALT-BENEFIT-AMT
  8556                                    PB-CI-LF-PREMIUM-AMT
  8557                                    PB-CI-LF-ALT-PREMIUM-AMT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 157
* EL050.cbl
  8558                                    PB-CI-AH-BENEFIT-CD
  8559                                    PB-CI-AH-BENEFIT-AMT
  8560                                    PB-CI-AH-PREMIUM-AMT
  8561                                    PB-CI-PAY-FREQUENCY
  8562                                    PB-CI-LOAN-APR
  8563                                    PB-CI-LOAN-TERM
  8564                                    PB-CI-LIFE-COMMISSION
  8565                                    PB-CI-AH-COMMISSION
  8566                                    PB-CI-CURR-SEQ
  8567                                    PB-CI-AH-CANCEL-AMT
  8568                                    PB-CI-LF-CANCEL-AMT
  8569                                    PB-CI-RATE-DEV-PCT-LF
  8570                                    PB-CI-RATE-DEV-PCT-AH
  8571                                    PB-CI-EXTENTION-DAYS
  8572                                    PB-CI-TERM-IN-DAYS
  8573                                    PB-CI-LIVES
  8574                                    PB-CI-LF-CRIT-PER
  8575                                    PB-CI-AH-CRIT-PER
  8576                                    PB-CI-ADDL-CLP
  8577                                    PB-CI-DDF-IU-RATE-UP.
  8578
  8579     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8580                                    PB-CI-AH-SETTLEMENT-DT
  8581                                    PB-CI-DEATH-DT
  8582                                    PB-CI-LF-PRIOR-CANCEL-DT
  8583                                    PB-CI-AH-PRIOR-CANCEL-DT
  8584                                    PB-CI-ENTRY-DT
  8585                                    PB-CI-LF-EXPIRE-DT
  8586                                    PB-CI-AH-EXPIRE-DT
  8587                                    PB-CI-LOAN-1ST-PMT-DT.
  8588
  8589     IF ACCOUNT-MAST-FOUND
  8590        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8591        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8592
  8593
  8594 0300-CONTINUE-EDIT.
  8595
  8596     IF PB-ISSUE
  8597        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8598            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8599
  8600     IF PB-ISSUE
  8601        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8602            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8603
  8604     IF PB-ISSUE
  8605       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8606          (AM-NO-AH-ONLY)
  8607           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8608               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8609                   MOVE ER-2679 TO WS-ERROR
  8610                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8611
  8612     IF PB-ISSUE
  8613        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8614        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8615        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 158
* EL050.cbl
  8616     ELSE
  8617        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8618        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8619        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8620
  8621     MOVE 'N'                    TO PLAN-MASTER-SW
  8622                                    PLAN-MASTER-LIFE-SW
  8623                                    FORM-MASTER-SW
  8624                                    WS-APP-CERT-SW.
  8625
  8626     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8627                                    WS-PL-TOL-LF-REFUND
  8628                                    WS-PL-REF-OVS-AMT
  8629                                    WS-PL-TOL-LF-PREM-PCT
  8630                                    WS-PL-TOL-LF-REFUND-PCT
  8631                                    WS-PL-REF-OVS-PCT
  8632                                    WS-PL-TOL-LF-CLAIM.
  8633
  8634     IF PB-COMPANY-ID = 'NCL'
  8635       IF PB-ISSUE
  8636         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8637             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8638             IF FORM-MASTER-FOUND
  8639                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8640
  8641     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8642        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8643
  8644********************** MON CODE **********************
  8645     IF PB-COMPANY-ID = 'MON'
  8646     IF PB-ISSUE
  8647     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8648        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8649             PB-I-LOAN-APR = ZERO)
  8650               MOVE 14.0         TO PB-I-LOAN-APR.
  8651******************************************************
  8652
  8653     IF PB-COMPANY-ID = 'NCL'
  8654       IF PB-ISSUE
  8655           IF FORM-MASTER-FOUND
  8656             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8657                AM-DISMBR-COVERAGE
  8658                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8659                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8660                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8661                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8662                                           PB-I-LIFE-BENEFIT-CD.
  8663
  8664     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8665
  8666     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8667         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8668         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8669         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8670         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8671         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8672           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8673             GO TO 0301-LIFE-BENEFIT-SEARCH
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 159
* EL050.cbl
  8674         ELSE
  8675             NEXT SENTENCE
  8676     ELSE
  8677         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8678
  8679     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8680     MOVE '4'                    TO CNTL-REC-TYPE.
  8681     MOVE +0                     TO CNTL-SEQ-NO.
  8682     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8683
  8684     MOVE '1' TO RC-SW-2.
  8685     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8686
  8687     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8688        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8689         GO TO 0305-BENEFIT-NOT-FOUND.
  8690
  8691     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8692
  8693 0301-LIFE-BENEFIT-SEARCH.
  8694
  8695     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8696
  8697     IF NO-BENEFIT-FOUND
  8698        GO TO 0305-BENEFIT-NOT-FOUND.
  8699
  8700     IF WS-BEN-CD = '99'
  8701        GO TO 0305-BENEFIT-NOT-FOUND.
  8702
  8703     IF PB-COMPANY-ID = 'NCL'
  8704         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8705             GO TO 0304-LIFE-BENEFIT-FOUND.
  8706
  8707     MOVE +1                     TO SUB5.
  8708     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8709
  8710* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8711* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8712     IF PB-COMPANY-ID = 'DMD'
  8713         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8714
  8715 0302-EDIT-ACCT-LF-BENEFITS.
  8716
  8717     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8718        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8719           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8720                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8721           GO TO 03XX-GET-LIFE-ERPLAN.
  8722
  8723     IF SUB5 LESS THAN +20
  8724        ADD +1                   TO SUB5
  8725        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8726
  8727     MOVE +1                     TO SUB5.
  8728
  8729     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8730        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8731
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 160
* EL050.cbl
  8732 0303-EDIT-DMD-EXTRA-BENEFITS.
  8733
  8734     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8735        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8736           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8737                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8738           GO TO 03XX-GET-LIFE-ERPLAN.
  8739
  8740     IF SUB5 LESS THAN +30
  8741        ADD +1                   TO SUB5
  8742        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8743
  8744     MOVE +1                     TO SUB5.
  8745
  8746 03XX-EDIT-FOR-NINETY-LF.
  8747
  8748***************************************************************
  8749*                                                             *
  8750*    NINETY BENEFIT PLAN TYPES:                               *
  8751*                                                             *
  8752*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8753*      92 = ALL GROUP REDUCING BENEFITS                       *
  8754*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8755*      94 = ALL GROUP LEVEL BENEFITS                          *
  8756*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8757*           BENEFIT CONTROLS.                                 *
  8758*      99 = ALL BENEFITS                                      *
  8759*                                                             *
  8760***************************************************************
  8761
  8762     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8763                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8764
  8765     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8766       AND
  8767        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8768        GO TO 03XX-GET-LIFE-ERPLAN.
  8769
  8770     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8771       AND
  8772        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8773        IF CF-REDUCING (SUB3)
  8774           IF (PB-I-INDV-GRP-OVRD = 'I')
  8775              OR
  8776           ((AM-IG = '1') AND
  8777           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8778              OR
  8779           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8780           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8781           (AM-IG NOT = '2'))
  8782              GO TO 03XX-GET-LIFE-ERPLAN.
  8783
  8784     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8785       AND
  8786        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8787        IF CF-REDUCING (SUB3)
  8788           IF (PB-I-INDV-GRP-OVRD = 'G')
  8789              OR
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 161
* EL050.cbl
  8790           ((AM-IG = '2') AND
  8791           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8792              OR
  8793           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8794           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8795           (AM-IG NOT = '1'))
  8796              GO TO 03XX-GET-LIFE-ERPLAN.
  8797
  8798     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8799       AND
  8800        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8801        IF CF-LEVEL    (SUB3)
  8802           IF (PB-I-INDV-GRP-OVRD = 'I')
  8803              OR
  8804           ((AM-IG = '1') AND
  8805           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8806              OR
  8807           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8808           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8809            (AM-IG NOT = '2'))
  8810              GO TO 03XX-GET-LIFE-ERPLAN.
  8811
  8812     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8813       AND
  8814        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8815        IF CF-LEVEL    (SUB3)
  8816           IF (PB-I-INDV-GRP-OVRD = 'G')
  8817              OR
  8818           ((AM-IG = '2') AND
  8819           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8820              OR
  8821           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8822           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8823           (AM-IG NOT = '1'))
  8824              GO TO 03XX-GET-LIFE-ERPLAN.
  8825
  8826     IF SUB5 LESS THAN +20
  8827        ADD +1                   TO SUB5
  8828        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8829
  8830     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8831
  8832     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8833        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8834
  8835     MOVE +1                     TO SUB5.
  8836
  8837 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8838
  8839     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8840                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8841
  8842     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8843       AND
  8844        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8845        GO TO 03XX-GET-LIFE-ERPLAN.
  8846
  8847     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 162
* EL050.cbl
  8848       AND
  8849        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8850        IF CF-REDUCING (SUB3)
  8851           IF (PB-I-INDV-GRP-OVRD = 'I')
  8852              OR
  8853           ((AM-IG = '1') AND
  8854           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8855              OR
  8856           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8857           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8858           (AM-IG NOT = '2'))
  8859              GO TO 03XX-GET-LIFE-ERPLAN.
  8860
  8861     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8862       AND
  8863        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8864        IF CF-REDUCING (SUB3)
  8865           IF (PB-I-INDV-GRP-OVRD = 'G')
  8866              OR
  8867           ((AM-IG = '2') AND
  8868           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8869              OR
  8870           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8871           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8872           (AM-IG NOT = '1'))
  8873              GO TO 03XX-GET-LIFE-ERPLAN.
  8874
  8875     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8876       AND
  8877        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8878        IF CF-LEVEL    (SUB3)
  8879           IF (PB-I-INDV-GRP-OVRD = 'I')
  8880              OR
  8881           ((AM-IG = '1') AND
  8882           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8883              OR
  8884           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8885           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8886            (AM-IG NOT = '2'))
  8887              GO TO 03XX-GET-LIFE-ERPLAN.
  8888
  8889     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8890       AND
  8891        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8892        IF CF-LEVEL    (SUB3)
  8893           IF (PB-I-INDV-GRP-OVRD = 'G')
  8894              OR
  8895           ((AM-IG = '2') AND
  8896           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8897              OR
  8898           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8899           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8900           (AM-IG NOT = '1'))
  8901              GO TO 03XX-GET-LIFE-ERPLAN.
  8902
  8903     IF SUB5 LESS THAN +30
  8904        ADD +1                   TO SUB5
  8905        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 163
* EL050.cbl
  8906
  8907     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8908
  8909 03XX-EDIT-FOR-NINETY-LF-CONT.
  8910
  8911     MOVE +99                    TO SUB5.
  8912
  8913     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8914        IF PB-ISSUE
  8915           MOVE ER-1924          TO  WS-ERROR
  8916           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8917
  8918     GO TO 0304-LIFE-BENEFIT-FOUND.
  8919
  8920 03XX-GET-LIFE-ERPLAN.
  8921
  8922     IF WK-PLAN-ADDR EQUAL +0
  8923        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8924
  8925     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8926     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8927     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8928     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8929     MOVE 'Y'                    TO PLAN-MASTER-SW
  8930                                    PLAN-MASTER-LIFE-SW.
  8931     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8932
  8933 03XX-ERPLAN-LIFE-GETMAIN.
  8934
  8935     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8936     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8937
  8938 03XX-ERPLAN-LIFE-READ.
  8939
  8940     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8941     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8942     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8943     MOVE PB-SV-STATE            TO PLAN-STATE.
  8944     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8945     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8946     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8947     MOVE WS-SAVE-BENEFIT-REVISION
  8948                                 TO PLAN-REVISION-NO.
  8949
  8950     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8951     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8952
  8953     IF PB-COMPANY-ID = 'NCL'
  8954       IF NOT LF-PLAN-MASTER-FOUND
  8955         IF NOT PB-POLICY-IS-DECLINED  AND
  8956            NOT PB-POLICY-IS-VOIDED
  8957             MOVE  ER-1921         TO  WS-ERROR
  8958             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8959             GO TO 0304-LIFE-BENEFIT-FOUND.
  8960
  8961     IF NOT LF-PLAN-MASTER-FOUND
  8962        GO TO 0304-LIFE-BENEFIT-FOUND.
  8963
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 164
* EL050.cbl
  8964 XXXX-CHECK-LF-PLAN-KEY.
  8965
  8966     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8967        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8968        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8969        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8970        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8971        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8972        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8973        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8974        MOVE 'N'                 TO PLAN-MASTER-SW
  8975          GO TO 03XX-ERPLAN-LIFE-READ.
  8976
  8977     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8978
  8979     IF  PB-CANCELLATION
  8980         GO TO  0303-LF-ACCT-BEN-FOUND.
  8981
  8982     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8983        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8984           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8985           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8986              MOVE ER-2644             TO WS-ERROR
  8987              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8988           ELSE
  8989              NEXT SENTENCE
  8990        ELSE
  8991           IF PB-COMPANY-ID NOT = 'NCL'
  8992              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8993                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8994
  8995 0303-LF-ACCT-BEN-FOUND.
  8996
  8997     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8998
  8999     IF PL-DEV-CODE NOT = SPACES
  9000        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  9001
  9002     IF PL-DEV-PCT NUMERIC AND
  9003        PL-DEV-PCT NOT = ZEROS
  9004        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  9005
  9006     IF PL-TOL-PREM-AMT GREATER THAN +0
  9007        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  9008
  9009     IF PL-TOL-REF-AMT GREATER THAN +0
  9010        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  9011
  9012     IF PL-TOL-PREM-PCT GREATER THAN +0
  9013        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  9014
  9015     IF PL-TOL-REF-PCT GREATER THAN +0
  9016        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  9017
  9018     IF PL-TOL-CLM-AMT GREATER THAN +0
  9019        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  9020
  9021     IF PL-OVER-SHORT-AMT NUMERIC  AND
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 165
* EL050.cbl
  9022                          PL-OVER-SHORT-AMT > +0
  9023        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  9024
  9025     IF PL-OVER-SHORT-PCT NUMERIC  AND
  9026                          PL-OVER-SHORT-PCT > +0
  9027        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  9028
  9029     IF PL-SALES-TAX NUMERIC AND
  9030                          PL-SALES-TAX > +0
  9031         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  9032
  9033     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9034        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  9035                                    WS-IG-OVRD-AM.
  9036
  9037 0304-LIFE-BENEFIT-FOUND.
  9038
  9039     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  9040
  9041     IF PB-ISSUE
  9042        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  9043     ELSE
  9044        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  9045
  9046     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  9047     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  9048     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  9049     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  9050     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  9051                                         WS-LF-REFUND-CALC.
  9052     if (ws-lf-earnings-calc = '5')
  9053        and (pb-i-loan-apr = zeros)
  9054        and (benefit-code-chg)
  9055        move +99.9999 to pb-i-loan-apr
  9056     end-if
  9057
  9058     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9059        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  9060
  9061     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9062        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  9063     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  9064
  9065     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  9066     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  9067     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  9068     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  9069     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  9070     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  9071
  9072     IF PB-COMPANY-ID = 'NCL'  AND
  9073        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9074         NEXT SENTENCE
  9075     ELSE
  9076         IF SUB5 NOT GREATER THAN +20
  9077            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  9078               MOVE WS-SAVE-BENEFIT-REM-TERM
  9079                                      TO WS-AM-LF-BENE-REM-TERM
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 166
* EL050.cbl
  9080                                         EC-BR-LF-REM-TERM-CALC.
  9081
  9082     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  9083     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  9084
  9085     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  9086
  9087 0305-BENEFIT-NOT-FOUND.
  9088
  9089     MOVE '1'                    TO LF-BENEFIT-ERROR.
  9090     MOVE ER-2604                TO WS-ERROR.
  9091     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9092
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 167
* EL050.cbl
  9094
  9095 0310-FIND-AH-BENEFIT-RECORD.
  9096
  9097     MOVE 'N'                    TO PLAN-MASTER-SW
  9098                                    PLAN-MASTER-AH-SW.
  9099
  9100     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  9101                                    WS-PL-TOL-AH-REFUND
  9102                                    WS-AH-PL-REF-OVS-AMT
  9103                                    WS-PL-TOL-AH-PREM-PCT
  9104                                    WS-PL-TOL-AH-REFUND-PCT
  9105                                    WS-AH-PL-REF-OVS-PCT
  9106                                    WS-PL-TOL-AH-CLAIM.
  9107     MOVE ' '                    TO WS-AH-DCC-TRUNC
  9108
  9109
  9110     if pb-issue
  9111        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  9112           MOVE SPACES              TO PB-I-AH-INPUT-CD
  9113        end-if
  9114        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  9115           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  9116           GO TO 0399-BENEFIT-NOT-FOUND
  9117        end-if
  9118     end-if
  9119
  9120     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  9121        GO TO 0400-FIND-CARRIER.
  9122
  9123     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9124
  9125     IF WK-AH-BEN-ADDR NOT = ZEROS
  9126         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  9127         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9128         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9129         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  9130           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  9131             GO TO 0311-AH-BENEFIT-SEARCH
  9132         ELSE
  9133             NEXT SENTENCE
  9134     ELSE
  9135         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9136
  9137     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9138     MOVE '5'                    TO CNTL-REC-TYPE.
  9139     MOVE +0                     TO CNTL-SEQ-NO.
  9140     MOVE WS-ACCESS              TO CNTL-ACCESS.
  9141
  9142     MOVE '2' TO RC-SW-2.
  9143     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9144
  9145     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  9146        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  9147          GO TO 0399-BENEFIT-NOT-FOUND.
  9148
  9149     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  9150
  9151 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 168
* EL050.cbl
  9152
  9153     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9154
  9155     IF NO-BENEFIT-FOUND
  9156         GO TO 0399-BENEFIT-NOT-FOUND.
  9157
  9158     IF WS-BEN-CD = '99'
  9159        GO TO 0399-BENEFIT-NOT-FOUND.
  9160
  9161     IF PB-COMPANY-ID  =  'NCL'
  9162         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9163             GO TO 0314-A-H-BENEFIT-FOUND.
  9164
  9165     MOVE +1                     TO SUB5.
  9166     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9167
  9168* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  9169* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  9170     IF PB-COMPANY-ID = 'DMD'
  9171         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  9172
  9173 0312-EDIT-ACCT-AH-BENEFITS.
  9174
  9175     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9176        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  9177           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9178                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9179           GO TO 03XX-GET-AH-ERPLAN.
  9180
  9181     IF SUB5 LESS THAN +20
  9182        ADD +1                   TO SUB5
  9183        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  9184
  9185     MOVE +1                     TO SUB5.
  9186
  9187     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9188        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9189
  9190 0313-EDIT-DMD-EXTRA-BENEFITS.
  9191
  9192     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9193        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  9194           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9195                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9196           GO TO 03XX-GET-AH-ERPLAN.
  9197
  9198     IF SUB5 LESS THAN +30
  9199        ADD +1                   TO SUB5
  9200        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  9201
  9202     MOVE +1                     TO SUB5.
  9203
  9204 03XX-EDIT-FOR-NINETY-AH.
  9205
  9206***************************************************************
  9207*                                                             *
  9208*    NINETY BENEFIT PLAN TYPES:                               *
  9209*                                                             *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 169
* EL050.cbl
  9210*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9211*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9212*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9213*           BENEFIT CONTROLS.                                 *
  9214*      99 = ALL BENEFITS.                                     *
  9215*                                                             *
  9216***************************************************************
  9217
  9218     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9219                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9220
  9221     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  9222       AND
  9223        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9224        GO TO 03XX-GET-AH-ERPLAN.
  9225
  9226     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  9227       AND
  9228        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9229           IF (PB-I-INDV-GRP-OVRD = 'I')
  9230              OR
  9231           ((AM-IG = '1') AND
  9232           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9233              OR
  9234           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9235           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9236           (AM-IG NOT = '2'))
  9237              GO TO 03XX-GET-AH-ERPLAN.
  9238
  9239     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  9240       AND
  9241        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9242           IF (PB-I-INDV-GRP-OVRD = 'G')
  9243              OR
  9244           ((AM-IG = '2') AND
  9245           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9246              OR
  9247           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9248           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9249           (AM-IG NOT = '1'))
  9250              GO TO 03XX-GET-AH-ERPLAN.
  9251
  9252     IF SUB5 LESS THAN +20
  9253        ADD +1                   TO SUB5
  9254        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9255
  9256     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9257        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9258
  9259     MOVE +1                    TO SUB5.
  9260
  9261 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9262
  9263     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9264                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9265
  9266     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9267       AND
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 170
* EL050.cbl
  9268        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9269        GO TO 03XX-GET-AH-ERPLAN.
  9270
  9271     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9272       AND
  9273        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9274           IF (PB-I-INDV-GRP-OVRD = 'I')
  9275              OR
  9276           ((AM-IG = '1') AND
  9277           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9278              OR
  9279           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9280           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9281           (AM-IG NOT = '2'))
  9282              GO TO 03XX-GET-AH-ERPLAN.
  9283
  9284     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9285       AND
  9286        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9287           IF (PB-I-INDV-GRP-OVRD = 'G')
  9288              OR
  9289           ((AM-IG = '2') AND
  9290           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9291              OR
  9292           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9293           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9294           (AM-IG NOT = '1'))
  9295              GO TO 03XX-GET-AH-ERPLAN.
  9296
  9297     IF SUB5 LESS THAN +30
  9298        ADD +1                   TO SUB5
  9299        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9300
  9301 03XX-EDIT-FOR-NINETY-AH-CONT.
  9302
  9303     MOVE +99                    TO SUB5.
  9304
  9305     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9306
  9307     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9308        IF PB-ISSUE
  9309           MOVE ER-1925          TO  WS-ERROR
  9310           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9311
  9312     GO TO 0314-A-H-BENEFIT-FOUND.
  9313
  9314 03XX-GET-AH-ERPLAN.
  9315
  9316     IF WK-PLAN-ADDR EQUAL +0
  9317         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9318
  9319     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9320     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9321     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9322     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9323     MOVE 'Y'                    TO PLAN-MASTER-SW
  9324                                    PLAN-MASTER-AH-SW.
  9325*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 171
* EL050.cbl
  9326     GO TO 03XX-ERPLAN-AH-READ.
  9327
  9328 03XX-ERPLAN-AH-GETMAIN.
  9329
  9330     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9331     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9332
  9333 03XX-ERPLAN-AH-READ.
  9334
  9335     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9336     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9337     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9338     MOVE PB-SV-STATE            TO PLAN-STATE.
  9339     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9340     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9341     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9342     MOVE WS-SAVE-BENEFIT-REVISION
  9343                                 TO PLAN-REVISION-NO.
  9344
  9345     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9346     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9347
  9348     IF PB-COMPANY-ID = 'NCL'
  9349       IF NOT AH-PLAN-MASTER-FOUND
  9350         IF NOT PB-POLICY-IS-DECLINED  AND
  9351            NOT PB-POLICY-IS-VOIDED
  9352             MOVE  ER-1922         TO  WS-ERROR
  9353             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9354             GO TO 0314-A-H-BENEFIT-FOUND.
  9355
  9356     IF NOT AH-PLAN-MASTER-FOUND
  9357        GO TO 0314-A-H-BENEFIT-FOUND.
  9358
  9359 XXXX-CHECK-AH-PLAN-KEY.
  9360
  9361     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9362        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9363        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9364        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9365        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9366        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9367        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9368        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9369        MOVE 'N'                 TO PLAN-MASTER-SW
  9370          GO TO 03XX-ERPLAN-AH-READ.
  9371
  9372     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9373
  9374     IF  PB-CANCELLATION
  9375         GO TO  0313-AH-ACCT-BEN-FOUND.
  9376
  9377     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9378       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9379          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9380          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9381             MOVE ER-2644             TO WS-ERROR
  9382             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9383          ELSE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 172
* EL050.cbl
  9384             NEXT SENTENCE
  9385       ELSE
  9386          IF PB-COMPANY-ID NOT = 'NCL'
  9387             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9388                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9389
  9390 0313-AH-ACCT-BEN-FOUND.
  9391
  9392     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9393
  9394     IF PL-DEV-CODE NOT = SPACES
  9395        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9396
  9397     IF PL-DEV-PCT NUMERIC AND
  9398        PL-DEV-PCT NOT = ZEROS
  9399        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9400
  9401     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9402        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9403
  9404     IF PL-TOL-REF-AMT NOT EQUAL +0
  9405        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9406
  9407     IF PL-TOL-PREM-PCT GREATER THAN +0
  9408        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9409
  9410     IF PL-TOL-REF-PCT GREATER THAN +0
  9411        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9412
  9413     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9414        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9415
  9416     IF PL-OVER-SHORT-AMT NUMERIC AND
  9417                          PL-OVER-SHORT-AMT > +0
  9418        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9419
  9420     IF PL-OVER-SHORT-PCT NUMERIC AND
  9421                          PL-OVER-SHORT-PCT > +0
  9422        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9423
  9424     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9425        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9426        IF WS-IG-OVRD-AM EQUAL SPACES
  9427            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9428
  9429 0314-A-H-BENEFIT-FOUND.
  9430
  9431     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9432
  9433     IF PB-ISSUE
  9434        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9435       ELSE
  9436        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9437
  9438     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD
  9439     if cf-maximum-benefits (sub3) numeric
  9440        move cf-maximum-benefits (sub3)
  9441                                 to ws-ah-max-bens
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 173
* EL050.cbl
  9442     else
  9443        move zeros               to ws-ah-max-bens
  9444     end-if
  9445     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9446     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9447     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
  9448                                         WS-AH-REFUND-CALC.
  9449
  9450     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9451        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9452
  9453     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9454        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9455     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9456
  9457     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9458     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9459     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9460     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9461     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9462     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9463
  9464     IF PB-COMPANY-ID = 'NCL'  AND
  9465        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9466         NEXT SENTENCE
  9467     ELSE
  9468         IF SUB5 NOT GREATER THAN +20
  9469            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9470                MOVE WS-SAVE-BENEFIT-REM-TERM
  9471                                      TO WS-AM-AH-BENE-REM-TERM
  9472                                         EC-BR-AH-REM-TERM-CALC.
  9473
  9474     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9475     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9476
  9477     GO TO 0400-FIND-CARRIER.
  9478
  9479 0399-BENEFIT-NOT-FOUND.
  9480
  9481     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9482     MOVE ER-2605                TO WS-ERROR.
  9483     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9484
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 174
* EL050.cbl
  9486
  9487 0400-FIND-CARRIER.
  9488
  9489     MOVE PB-SV-CARRIER          TO WS-CARR.
  9490
  9491     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9492     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9493     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9494     MOVE '6'                    TO CNTL-REC-TYPE.
  9495
  9496*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9497     MOVE SPACE                  TO WS-DMD-RATING-SW
  9498                                    EC-BR-DMD-RATING-SW.
  9499
  9500     MOVE '2'                    TO RC-SW-1.
  9501     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9502
  9503     IF NOT CF-CARRIER-MASTER
  9504        GO TO 0400-CARRIER-NOT-FOUND.
  9505
  9506 0400-BUILD-CARR-TOL.
  9507
  9508     IF CF-CR-TOL-PREM NUMERIC AND
  9509        CF-CR-TOL-PREM GREATER THAN +0
  9510        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9511                                    WS-TOL-AH-PREM.
  9512
  9513     IF CF-CR-TOL-REFUND NUMERIC AND
  9514        CF-CR-TOL-REFUND GREATER THAN +0
  9515        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9516                                    WS-TOL-AH-REFUND.
  9517
  9518     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9519        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9520        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9521                                    WS-AH-REFUND-OVS-AMT.
  9522
  9523     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9524        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9525        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9526                                    WS-AH-REFUND-OVS-PCT.
  9527
  9528     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9529        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9530        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9531                                    WS-TOL-AH-PREM-PCT.
  9532
  9533     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9534        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9535        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9536                                     WS-TOL-AH-REFUND-PCT.
  9537
  9538     IF CF-COMPANY-ID EQUAL 'DMD'
  9539         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9540                                    EC-BR-DMD-RATING-SW.
  9541
  9542     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9543     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 175
* EL050.cbl
  9544        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9545     END-IF
  9546     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9547        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9548     END-IF
  9549     IF WS-TOL-CLP-PCT = ZEROS
  9550        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9551     END-IF
  9552
  9553     IF WS-SPP-LEASE-COMM = ZEROS
  9554        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9555     END-IF
  9556     GO TO 0400-FIND-ERPDEF.
  9557
  9558 0400-CARRIER-NOT-FOUND.
  9559
  9560     MOVE ER-2602                TO WS-ERROR.
  9561     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9562
  9563 0400-FIND-ERPDEF.
  9564*    IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  9565     IF (PB-COMPANY-ID = 'DCC')
  9566        AND (AM-DCC-PRODUCT-CODE <> spaces)
  9567        CONTINUE
  9568     ELSE
  9569        GO TO 0400-FIND-ERCOMP
  9570     END-IF
  9571     MOVE ' '                    TO PDEF-MASTER-SW
  9572     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9573     MOVE PB-STATE               TO ERPDEF-STATE
  9574     IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
  9575        MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
  9576     END-IF
  9577     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9578     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9579     IF PB-ISSUE
  9580        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9581     ELSE
  9582        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9583     END-IF
  9584     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9585     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9586     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9587     IF PDEF-MASTER-FOUND
  9588        MOVE 'N'                 TO PDEF-MASTER-SW
  9589        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9590        IF PDEF-MASTER-FOUND
  9591           IF (ERPDEF-KEY-SAVE (1:16) =
  9592                        PD-CONTROL-PRIMARY (1:16))
  9593              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9594              CONTINUE
  9595           ELSE
  9596              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9597              IF (ERPDEF-KEY-SAVE (1:16) =
  9598                        PD-CONTROL-PRIMARY (1:16))
  9599                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9600                 CONTINUE
  9601              ELSE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 176
* EL050.cbl
  9602                 MOVE 'N'        TO PDEF-MASTER-SW
  9603              END-IF
  9604           END-IF
  9605        END-IF
  9606        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9607     END-IF
  9608     IF PDEF-MASTER-FOUND
  9609        IF PD-TRUNCATED = 'Y'
  9610           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9611        END-IF
  9612     END-IF
  9613     .
  9614 0400-FIND-ERCOMP.
  9615     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9616        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9617           (WS-SUB1 > +10)
  9618           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9619                 OR 'A' OR 'N'
  9620              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9621              MOVE PB-CARRIER    TO COMP-CARRIER
  9622              MOVE PB-GROUPING   TO COMP-GROUPING
  9623              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9624              MOVE AM-AGT (WS-SUB1)
  9625                                 TO COMP-FIN-RESP
  9626              MOVE 'G'           TO COMP-TYPE
  9627              PERFORM 8582-READ-COMPENSATION-MASTER
  9628                                 THRU 8582-EXIT
  9629              IF COMP-MASTER-FOUND
  9630                 IF CO-GA-INACTIVE
  9631                    MOVE ER-2763 TO WS-ERROR
  9632                    PERFORM 9900-ERROR-FORMAT
  9633                                 THRU 9900-EXIT
  9634                    MOVE +11     TO WS-SUB1
  9635                 END-IF
  9636                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9637                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9638                    MOVE ER-2788 TO WS-ERROR
  9639                    PERFORM 9900-ERROR-FORMAT
  9640                                 THRU 9900-EXIT
  9641                    MOVE +11     TO WS-SUB1
  9642                 END-IF
  9643              END-IF
  9644           END-IF
  9645        END-PERFORM
  9646     END-IF
  9647     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9648        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9649           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9650                                    WS-CLP-STATE
  9651        ELSE
  9652           MOVE SPACES           TO PB-I-CLP-STATE
  9653                                    WS-CLP-STATE
  9654        END-IF
  9655     END-IF
  9656
  9657     IF (PB-COMPANY-ID = 'DCC')
  9658        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9659        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 177
* EL050.cbl
  9660        CONTINUE
  9661     ELSE
  9662        GO TO 0400-FIND-STATE-RECORD
  9663     END-IF
  9664     MOVE SPACES                 TO WS-CLP-STATE
  9665     MOVE +0                     TO WS-BANK-FEE
  9666                                    WS-BANK-LFEE
  9667                                    WS-BANK-NOCHRGB
  9668
  9669     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9670     IF (PB-ISSUE)
  9671        AND (PB-I-BANK-NUMBER NOT =
  9672            SPACES AND ZEROS AND LOW-VALUES)
  9673        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9674     ELSE
  9675        IF (PB-CANCELLATION)
  9676           AND (PB-CI-BANK-NUMBER NOT =
  9677                SPACES AND ZEROS AND LOW-VALUES)
  9678           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9679        END-IF
  9680     END-IF
  9681     IF COMP-FIN-RESP NOT = LOW-VALUES
  9682        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9683        MOVE PB-CARRIER          TO COMP-CARRIER
  9684        MOVE PB-GROUPING         TO COMP-GROUPING
  9685        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9686        MOVE 'B'                 TO COMP-TYPE
  9687        PERFORM 8582-READ-COMPENSATION-MASTER
  9688                                 THRU 8582-EXIT
  9689        IF COMP-MASTER-FOUND
  9690           IF CO-MAX-BANK-FEE NOT NUMERIC
  9691              MOVE +0            TO CO-MAX-BANK-FEE
  9692           END-IF
  9693           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9694              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9695           END-IF
  9696           IF CO-GA-INACTIVE
  9697              MOVE ER-2763       TO WS-ERROR
  9698              PERFORM 9900-ERROR-FORMAT
  9699                                 THRU 9900-EXIT
  9700           END-IF
  9701           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9702              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9703              MOVE ER-2788 TO WS-ERROR
  9704              PERFORM 9900-ERROR-FORMAT
  9705                                 THRU 9900-EXIT
  9706              MOVE +11     TO WS-SUB1
  9707           END-IF
  9708           IF WS-AH-BEN-CATEGORY = 'G'
  9709              MOVE CO-MAX-BANK-FEE
  9710                                 TO WS-BANK-FEE
  9711                                    PB-I-BANK-FEE
  9712           ELSE
  9713              MOVE CO-MAX-BANK-FEE-LEASE
  9714                                 TO WS-BANK-LFEE
  9715                                    PB-I-BANK-FEE
  9716           END-IF
  9717           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 178
* EL050.cbl
  9718              AND (WS-AH-REFUND-CALC = 'G'))
  9719                        OR
  9720              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9721              AND (WS-AH-REFUND-CALC NOT = 'G'))
  9722              CONTINUE
  9723           ELSE
  9724              MOVE ER-2789 TO WS-ERROR
  9725              PERFORM 9900-ERROR-FORMAT
  9726                                 THRU 9900-EXIT
  9727           END-IF
  9728           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9729                                    PB-I-CLP-STATE
  9730           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9731           MOVE CO-CARRIER       TO BXRF-CARRIER
  9732           MOVE CO-GROUPING      TO BXRF-GROUPING
  9733           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9734           MOVE BXRF-MAX-REC-LENGTH
  9735                                 TO BXRF-REC-LENGTH
  9736           PERFORM 8584-READ-BANK-CROSS-REF
  9737                                 THRU 8584-EXIT
  9738           IF BXRF-MASTER-FOUND
  9739              MOVE ' '           TO BANK-ACCT-SW
  9740              MOVE BK-BANK-POINTER-CNT
  9741                                 TO BK-BANK-POINTER-CNT
  9742              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9743                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9744                 OR (BANK-ACCT-FOUND)
  9745                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9746                    AND (BK-AM-EXP-DT (WS-SUB1)
  9747                                 > PB-CERT-EFF-DT)
  9748                    AND (BK-AM-EFF-DT (WS-SUB1)
  9749                                 NOT > PB-CERT-EFF-DT)
  9750                    SET BANK-ACCT-FOUND TO TRUE
  9751                 END-IF
  9752              END-PERFORM
  9753              IF NOT BANK-ACCT-FOUND
  9754                 MOVE ZEROS      TO WS-BANK-FEE
  9755                                    WS-BANK-LFEE
  9756                 MOVE ER-2869    TO WS-ERROR
  9757                 PERFORM 9900-ERROR-FORMAT
  9758                                 THRU 9900-EXIT
  9759              ELSE
  9760                 PERFORM 5000-PROCESS-REPS
  9761                                 THRU 5000-EXIT
  9762                 IF AGENT-MASTER-FOUND
  9763                    MOVE +0      TO WS-BANK-FEE
  9764                                    WS-BANK-LFEE
  9765*                   MOVE AG-SPP-FEES (1)
  9766*                                TO PB-I-BANK-FEE
  9767*                                   WS-BANK-FEE
  9768                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9769                       (WS-SUB1 > +10)
  9770                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9771                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9772                       END-IF
  9773                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9774                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9775                       END-IF
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 179
* EL050.cbl
  9776                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9777                          AG-SPP-FEES (WS-SUB1)
  9778                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9779                          AG-SPP-LFEES (WS-SUB1)
  9780                    END-PERFORM
  9781                    IF WS-AH-BEN-CATEGORY = 'G'
  9782                       MOVE WS-BANK-FEE
  9783                                 TO PB-I-BANK-FEE
  9784                    ELSE
  9785                       MOVE WS-BANK-LFEE
  9786                                 TO PB-I-BANK-FEE
  9787                    END-IF
  9788                 END-IF
  9789              END-IF
  9790           END-IF
  9791        ELSE
  9792           MOVE ER-2879          TO WS-ERROR
  9793           PERFORM 9900-ERROR-FORMAT
  9794                                 THRU 9900-EXIT
  9795        END-IF
  9796     ELSE
  9797        MOVE ER-2879             TO WS-ERROR
  9798        PERFORM 9900-ERROR-FORMAT
  9799                                 THRU 9900-EXIT
  9800     END-IF
  9801     IF WS-AH-BEN-CATEGORY = 'G'
  9802        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9803        + WS-BANK-FEE
  9804     ELSE
  9805        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9806        + WS-BANK-LFEE
  9807     END-IF
  9808     .
  9809 0400-FIND-STATE-RECORD.
  9810
  9811     IF WK-STATE-ADDR NOT = ZEROS
  9812         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9813         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9814         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9815         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9816         IF PB-SV-STATE = CF-STATE-CODE
  9817             GO TO 0405-CONTINUE-EDIT
  9818         ELSE
  9819             NEXT SENTENCE
  9820     ELSE
  9821         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9822
  9823     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9824     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9825     MOVE '3'                    TO CNTL-REC-TYPE.
  9826     MOVE +0                     TO CNTL-SEQ-NO.
  9827
  9828     MOVE '3'                    TO RC-SW-2.
  9829     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9830
  9831     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9832        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9833        PB-SV-STATE   NOT = CF-STATE-CODE)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 180
* EL050.cbl
  9834        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9835                                    WS-TOL-AH-CLAIM
  9836                                    WS-MINIMUM-REFUND
  9837                                    WS-TOL-LF-PREM
  9838                                    WS-TOL-AH-PREM
  9839                                    WS-TOL-LF-REFUND
  9840                                    WS-TOL-AH-REFUND
  9841                                    EC-ST-TOL-PREM-PCT
  9842                                    WS-TOL-LF-PREM-PCT
  9843                                    WS-TOL-AH-PREM-PCT
  9844                                    EC-ST-TOL-REFUND-PCT
  9845                                    WS-TOL-LF-REFUND-PCT
  9846                                    WS-TOL-AH-REFUND-PCT
  9847                                    EC-ST-TOL-PREM
  9848                                    EC-ST-TOL-REFUND
  9849                                    EC-ST-FST-PMT-DAYS-MAX
  9850                                    WS-FREE-LOOK-PERIOD
  9851                                    WS-ST-LF-PREM-TAX
  9852                                    WS-ST-AH-PREM-TAX-I
  9853                                    WS-ST-AH-PREM-TAX-G
  9854                                    WS-BANK-FEE
  9855                                    WS-BANK-LFEE
  9856                                    WS-TOL-CLP-PCT
  9857                                    WS-SPP-LEASE-COMM
  9858                                    WS-INT-PERIODS
  9859                                    WS-EXTRA-PMTS
  9860        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9861                                    EC-ST-FST-PMT-DAYS-CHG
  9862                                    WS-LF-REM-TERM-CALC
  9863                                    WS-LF-REFUND-CALC
  9864                                    EC-ST-LF-REM-TERM-CALC
  9865                                    EC-ST-LF-REFUND-CALC
  9866                                    WS-AH-REM-TERM-CALC
  9867                                    WS-AH-REFUND-CALC
  9868                                    WS-LF-BEN-CATEGORY
  9869                                    WS-AH-BEN-CATEGORY
  9870                                    WS-CLP-STATE
  9871                                    WS-ST-REFUND-CLAIM-FLAG
  9872                                    WS-ST-CAUSAL-STATE
  9873                                    ws-st-agent-sig-edit
  9874                                    EC-ST-AH-REM-TERM-CALC
  9875                                    EC-ST-AH-REFUND-CALC
  9876          GO TO 0499-STATE-NOT-FOUND.
  9877
  9878     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9879
  9880 0405-CONTINUE-EDIT.
  9881
  9882     if pb-company-id = 'AHL'
  9883        continue
  9884     else
  9885        IF PB-CERT-PRIME NOT NUMERIC
  9886           MOVE ER-2722          TO WS-ERROR
  9887           PERFORM 9900-ERROR-FORMAT
  9888                                 THRU 9900-EXIT
  9889        end-if
  9890     END-IF
  9891*    IF PB-COMPANY-ID = 'CID' OR 'DCC' or 'VPP'
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 181
* EL050.cbl
  9892*       MOVE +0                  TO SUB3
  9893*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9894*       IF SUB3 > +0
  9895*          MOVE ER-2722          TO WS-ERROR
  9896*          PERFORM 9900-ERROR-FORMAT
  9897*                                THRU 9900-EXIT
  9898*       END-IF
  9899*    END-IF
  9900*    IF PB-COMPANY-ID = 'CID' OR 'DCC' or 'VPP'
  9901*       IF PB-CERT-PRIME NOT NUMERIC
  9902*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9903*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9904*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9905*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9906*
  9907*          MOVE ER-2722          TO WS-ERROR
  9908*          PERFORM 9900-ERROR-FORMAT
  9909*                                THRU 9900-EXIT
  9910*       END-IF
  9911*    END-IF
  9912
  9913     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9914
  9915     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9916        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9917                                    WS-TOL-AH-CLAIM.
  9918
  9919     IF CF-ST-REFUND-MIN NOT NUMERIC
  9920        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9921
  9922     IF CF-ST-REFUND-MIN NOT = ZEROS
  9923        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9924
  9925     IF CF-ST-TOL-PREM  NOT = ZEROS
  9926        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9927                                    WS-TOL-AH-PREM
  9928        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9929
  9930     IF CF-ST-TOL-REFUND NOT = ZEROS
  9931        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9932                                    WS-TOL-AH-REFUND
  9933        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9934
  9935     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9936        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9937        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9938                                    WS-AH-REFUND-OVS-AMT
  9939                                    EC-ST-OVR-SHT-AMT.
  9940
  9941     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9942        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9943        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9944                                    WS-TOL-LF-PREM-PCT
  9945                                    WS-TOL-AH-PREM-PCT.
  9946
  9947     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9948        CF-ST-TOL-REF-PCT GREATER THAN +0
  9949        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 182
* EL050.cbl
  9950                                    WS-TOL-LF-REFUND-PCT
  9951                                    WS-TOL-AH-REFUND-PCT.
  9952
  9953     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9954        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9955        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9956                                    WS-AH-REFUND-OVS-PCT
  9957                                    EC-ST-OVR-SHT-PCT.
  9958
  9959     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9960     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9961
  9962     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9963          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9964
  9965     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9966     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9967     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9968
  9969     IF CF-ST-LF-PREM-TAX NUMERIC
  9970        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9971     END-IF
  9972     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9973        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9974     END-IF
  9975     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9976        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9977     END-IF
  9978
  9979     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9980         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9981     END-IF.
  9982
  9983     IF CF-ST-CAUSAL-STATE > SPACES
  9984         MOVE CF-ST-CAUSAL-STATE TO WS-ST-CAUSAL-STATE
  9985     END-IF.
  9986     if cf-st-extra-interest-periods not numeric
  9987        move zeros               to cf-st-extra-interest-periods
  9988     end-if
  9989     if cf-st-extra-payments not numeric
  9990        move zeros               to cf-st-extra-payments
  9991     end-if
  9992
  9993     move cf-st-extra-interest-periods
  9994                                 to ws-int-periods
  9995     move cf-st-extra-payments   to ws-extra-pmts
  9996     move cf-st-agent-sig-edit   to ws-st-agent-sig-edit
  9997     move cf-st-net-only-state   to ws-net-only-state
  9998     if cf-st-comm-cap-sl not numeric
  9999        move zeros               to cf-st-comm-cap-sl
 10000     end-if
 10001     if cf-st-comm-cap-jl not numeric
 10002        move zeros               to cf-st-comm-cap-jl
 10003     end-if
 10004     if cf-st-comm-cap-sa not numeric
 10005        move zeros               to cf-st-comm-cap-sa
 10006     end-if
 10007     if cf-st-comm-cap-ja not numeric
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 183
* EL050.cbl
 10008        move zeros               to cf-st-comm-cap-ja
 10009     end-if
 10010     if cf-st-ga-comm-cap-sl not numeric
 10011        move zeros               to cf-st-ga-comm-cap-sl
 10012     end-if
 10013     if cf-st-ga-comm-cap-jl not numeric
 10014        move zeros               to cf-st-ga-comm-cap-jl
 10015     end-if
 10016     if cf-st-ga-comm-cap-sa not numeric
 10017        move zeros               to cf-st-ga-comm-cap-sa
 10018     end-if
 10019     if cf-st-ga-comm-cap-ja not numeric
 10020        move zeros               to cf-st-ga-comm-cap-ja
 10021     end-if
 10022
 10023     if cf-st-tot-comm-cap-sl not numeric
 10024        move zeros               to cf-st-tot-comm-cap-sl
 10025     end-if
 10026     if cf-st-tot-comm-cap-jl not numeric
 10027        move zeros               to cf-st-tot-comm-cap-jl
 10028     end-if
 10029     if cf-st-tot-comm-cap-sa not numeric
 10030        move zeros               to cf-st-tot-comm-cap-sa
 10031     end-if
 10032     if cf-st-tot-comm-cap-ja not numeric
 10033        move zeros               to cf-st-tot-comm-cap-ja
 10034     end-if
 10035
 10036     move cf-comm-cap-limit-to   to ws-st-cap-limit-to
 10037     move cf-st-comm-cap-sl      to ws-st-comm-cap-sl
 10038     move cf-st-comm-cap-jl      to ws-st-comm-cap-jl
 10039     move cf-st-comm-cap-sa      to ws-st-comm-cap-sa
 10040     move cf-st-comm-cap-ja      to ws-st-comm-cap-ja
 10041     move cf-st-ga-comm-cap-sl   to ws-st-ga-comm-cap-sl
 10042     move cf-st-ga-comm-cap-jl   to ws-st-ga-comm-cap-jl
 10043     move cf-st-ga-comm-cap-sa   to ws-st-ga-comm-cap-sa
 10044     move cf-st-ga-comm-cap-ja   to ws-st-ga-comm-cap-ja
 10045     move cf-st-tot-comm-cap-sl  to ws-st-tot-comm-cap-sl
 10046     move cf-st-tot-comm-cap-jl  to ws-st-tot-comm-cap-jl
 10047     move cf-st-tot-comm-cap-sa  to ws-st-tot-comm-cap-sa
 10048     move cf-st-tot-comm-cap-ja  to ws-st-tot-comm-cap-ja
 10049     IF WS-LF-BENEFIT-CD = ZEROS
 10050        GO TO 0410-CHECK-AH.
 10051
 10052     IF CF-ST-RT-CALC NOT = SPACES
 10053        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 10054                                    EC-ST-LF-REM-TERM-CALC
 10055     END-IF
 10056
 10057     IF WS-LF-COVERAGE-TYPE = 'R'
 10058        IF WS-LF-EARNINGS-CALC = '5'
 10059           IF CF-ST-RF-LN-CALC > '0'
 10060              MOVE CF-ST-RF-LN-CALC
 10061                                 TO WS-LF-REFUND-CALC
 10062                                    EC-ST-LF-REFUND-CALC
 10063           END-IF
 10064        ELSE
 10065           IF CF-ST-RF-LR-CALC > '0'
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 184
* EL050.cbl
 10066              MOVE CF-ST-RF-LR-CALC
 10067                                 TO WS-LF-REFUND-CALC
 10068                                    EC-ST-LF-REFUND-CALC
 10069           END-IF
 10070        END-IF
 10071     ELSE
 10072        IF CF-ST-RF-LL-CALC > '0'
 10073           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
 10074                                    EC-ST-LF-REFUND-CALC
 10075        END-IF
 10076     END-IF
 10077
 10078     IF CF-ST-RT-CALC NOT = SPACES
 10079        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 10080                                    EC-ST-LF-REM-TERM-CALC
 10081     END-IF
 10082
 10083     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
 10084     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
 10085
 10086     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
 10087
 10088     IF NO-BENEFIT-FOUND
 10089        GO TO 0410-CHECK-AH.
 10090
 10091     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
 10092        MOVE CF-ST-REM-TERM-CALC  (SUB3)
 10093                                 TO EC-ST-LF-REM-TERM-CALC
 10094                                    WS-LF-REM-TERM-CALC
 10095     END-IF
 10096
 10097     IF CF-ST-REFUND-CALC (SUB3) > '0'
 10098        MOVE CF-ST-REFUND-CALC (SUB3)
 10099                                 TO WS-LF-REFUND-CALC
 10100                                    EC-ST-LF-REFUND-CALC
 10101     END-IF
 10102*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
 10103     if cf-st-extra-periods (sub3) not numeric
 10104        move zeros               to cf-st-extra-periods (sub3)
 10105     end-if
 10106     if cf-st-extra-periods (sub3) > zeros
 10107        if ws-lf-ben-category = 'P'
 10108           move cf-st-extra-periods (sub3)
 10109                                 to ws-extra-pmts
 10110        else
 10111           if ws-lf-ben-category = 'I'
 10112              move cf-st-extra-periods (sub3)
 10113                                 to ws-int-periods
 10114           end-if
 10115        end-if
 10116     end-if
 10117     .
 10118 0410-CHECK-AH.
 10119
 10120     IF WS-AH-BENEFIT-CD = ZEROS
 10121        GO TO 0500-SET-ACCOUNT.
 10122
 10123     IF CF-ST-RT-CALC NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 185
* EL050.cbl
 10124        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
 10125                                    EC-ST-AH-REM-TERM-CALC
 10126     END-IF
 10127
 10128     IF WS-AH-SPECIAL-CALC-CD = 'C'
 10129        IF CF-ST-RF-CP-CALC > '0'
 10130           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
 10131                                    EC-ST-AH-REFUND-CALC
 10132        END-IF
 10133     ELSE
 10134        IF CF-ST-RF-AH-CALC > '0'
 10135           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
 10136                                    EC-ST-AH-REFUND-CALC
 10137        END-IF
 10138     END-IF
 10139     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
 10140     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
 10141
 10142     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
 10143
 10144     IF NO-BENEFIT-FOUND
 10145        GO TO 0500-SET-ACCOUNT.
 10146
 10147     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
 10148        MOVE CF-ST-REM-TERM-CALC (SUB3)
 10149                                 TO WS-AH-REM-TERM-CALC
 10150                                    EC-ST-AH-REM-TERM-CALC
 10151     END-IF
 10152
 10153     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
 10154        MOVE CF-ST-REFUND-CALC (SUB3)
 10155                                 TO WS-AH-REFUND-CALC
 10156                                    EC-ST-AH-REFUND-CALC
 10157     END-IF
 10158
 10159*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
 10160
 10161     GO TO 0500-SET-ACCOUNT.
 10162
 10163 0499-STATE-NOT-FOUND.
 10164
 10165     MOVE ER-2603                TO WS-ERROR.
 10166     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10167
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 186
* EL050.cbl
 10169
 10170 0500-SET-ACCOUNT.
 10171*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
 10172     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10173        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
 10174        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 10175        MOVE WS-CLP-STATE        TO CNTL-ACCESS
 10176        MOVE '3'                 TO CNTL-REC-TYPE
 10177        MOVE +0                  TO CNTL-SEQ-NO
 10178
 10179        MOVE '3'                 TO RC-SW-2
 10180        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 10181
 10182        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 10183           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
 10184           WS-CLP-STATE  NOT = CF-STATE-CODE)
 10185           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
 10186                                    WS-ST-AH-PREM-TAX-I
 10187                                    WS-ST-AH-PREM-TAX-G
 10188        ELSE
 10189           IF CF-ST-LF-PREM-TAX NUMERIC
 10190              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10191           END-IF
 10192           IF CF-ST-AH-PREM-TAX-I NUMERIC
 10193              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10194           END-IF
 10195           IF CF-ST-AH-PREM-TAX-G NUMERIC
 10196              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10197           END-IF
 10198        END-IF
 10199        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
 10200     END-IF
 10201*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
 10202*  FOR DCC ONLY
 10203     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 10204
 10205        MOVE ' '                 TO STAT-MASTER-SW
 10206        MOVE PB-COMPANY-ID       TO ELSTAT-COMPANY-ID
 10207        MOVE PB-CARRIER          TO ELSTAT-CARRIER
 10208        MOVE PB-GROUPING         TO ELSTAT-GROUP
 10209        MOVE PB-STATE            TO ELSTAT-STATE
 10210        IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10211           MOVE WS-CLP-STATE     TO ELSTAT-STATE
 10212        END-IF
 10213
 10214        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 10215        SET BIN-TO-GREG          TO TRUE
 10216        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10217        MOVE DC-GREG-DATE-CYMD   TO ELSTAT-EXP-DT
 10218        MOVE ELSTAT-KEY          TO ELSTAT-KEY-SAVE
 10219
 10220        PERFORM 8750-START-ELSTAT THRU 8750-EXIT
 10221        IF STAT-MASTER-FOUND
 10222           MOVE 'N'              TO STAT-MASTER-SW
 10223           PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10224           IF STAT-MASTER-FOUND
 10225              IF (ELSTAT-KEY-SAVE (1:12) =
 10226                           SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 187
* EL050.cbl
 10227                 IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10228                    MOVE 'F'        TO STAT-MASTER-SW
 10229                 ELSE
 10230                    PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10231                    IF (STAT-MASTER-FOUND)
 10232                       AND (ELSTAT-KEY-SAVE (1:12) =
 10233                           SF-CONTROL-PRIMARY (1:12))
 10234                       AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10235                       MOVE 'F'     TO STAT-MASTER-SW
 10236                    END-IF
 10237                 END-IF
 10238              END-IF
 10239           END-IF
 10240        END-IF
 10241
 10242        IF STAT-MASTER-SW = 'F'
 10243           IF (SF-ST-LF-PREM-TAX NUMERIC)
 10244              and (sf-st-lf-prem-tax > zeros)
 10245              MOVE SF-ST-LF-PREM-TAX
 10246                                 TO WS-ST-LF-PREM-TAX
 10247           END-IF
 10248           IF (SF-ST-AH-PREM-TAX-I NUMERIC)
 10249              and (sf-st-ah-prem-tax-i > zeros)
 10250              MOVE SF-ST-AH-PREM-TAX-I
 10251                                 TO WS-ST-AH-PREM-TAX-I
 10252           END-IF
 10253           IF (SF-ST-AH-PREM-TAX-G NUMERIC)
 10254              and (sf-st-ah-prem-tax-g > zeros)
 10255              MOVE SF-ST-AH-PREM-TAX-G
 10256                                 TO WS-ST-AH-PREM-TAX-G
 10257           END-IF
 10258        END-IF
 10259     END-IF
 10260     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10261        AND (PB-ISSUE)
 10262        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10263        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 10264        AND (AM-GPCD = 06)
 10265        MOVE 'Y'                 TO WS-GOOD-HIN
 10266        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10267           MOVE PB-I-VIN         TO WS-WORK-VIN
 10268           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10269              (V1 > 16)
 10270              IF WS-WORK-VIN (V1:1) NUMERIC
 10271                 MOVE WS-WORK-VIN-N (V1)
 10272                                 TO WS-ROW-B-VAL (V1)
 10273              ELSE
 10274                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 10275                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 10276                    OR (V2 > 26)
 10277                 END-PERFORM
 10278                 IF V2 < 27
 10279                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 10280                 ELSE
 10281                    MOVE 'N'     TO WS-GOOD-HIN
 10282                 END-IF
 10283              END-IF
 10284              COMPUTE WS-ROW-D-VAL (V1) =
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 188
* EL050.cbl
 10285                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 10286              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
 10287                 WS-ROW-D-VAL (V1)
 10288           END-PERFORM
 10289           MOVE ZEROS            TO WS-VIN-REMAINDER
 10290           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 10291             REMAINDER WS-VIN-REMAINDER
 10292           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 10293              CONTINUE
 10294           ELSE
 10295              MOVE 'N'           TO WS-GOOD-HIN
 10296           END-IF
 10297        ELSE
 10298           MOVE 'N'              TO WS-GOOD-HIN
 10299        END-IF
 10300        IF WS-GOOD-HIN NOT = 'Y'
 10301           MOVE ER-3826           TO WS-ERROR
 10302           PERFORM 9900-ERROR-FORMAT
 10303                                 THRU 9900-EXIT
 10304        END-IF
 10305     END-IF
 10306     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10307        AND (PB-ISSUE)
 10308        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10309        AND (AM-GPCD NOT = 06)
 10310        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10311           perform 3400-edit-vin thru 3400-exit
 10312        ELSE
 10313          MOVE ER-3826           TO WS-ERROR
 10314          PERFORM 9900-ERROR-FORMAT
 10315                                 THRU 9900-EXIT
 10316        END-IF
 10317     END-IF
 10318     if (pb-company-id = 'CID')
 10319        and (pb-issue)
 10320        and (pb-i-vin not = spaces and low-values and zeros)
 10321        perform 3400-edit-vin    thru 3400-exit
 10322     end-if
 10323******************************************************************
 10324******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10325******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10326******* METHODS.
 10327******************************************************************
 10328     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10329        IF PB-CANCELLATION
 10330           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10331              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10332                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10333                IF FORM-MASTER-FOUND
 10334                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10335******************************************************************
 10336
 10337     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10338     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10339
 10340     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10341     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10342     MOVE AM-STATUS              TO WS-ACCT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 189
* EL050.cbl
 10343     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10344
 10345
 10346     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10347     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
 10348     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10349
 10350     IF AM-LF-OB-RATE NOT NUMERIC
 10351         MOVE ZERO               TO AM-LF-OB-RATE.
 10352
 10353     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10354         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10355
 10356     IF AM-AH-OB-RATE NOT NUMERIC
 10357         MOVE ZERO               TO AM-AH-OB-RATE.
 10358
 10359     IF WS-LF-JOINT-INDICATOR = 'J'
 10360         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10361     ELSE
 10362         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10363
 10364     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10365
 10366     IF WS-IG-OVRD-AM  EQUAL SPACE
 10367         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10368
 10369     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10370         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10371                                       WS-IG-OVRD
 10372     ELSE
 10373         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10374             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10375                                       WS-IG-OVRD
 10376         ELSE
 10377             MOVE AM-IG             TO WS-IG-OVRD-AH
 10378                                       WS-IG-OVRD.
 10379
 10380     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10381         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10382                                       WS-IG-OVRD
 10383     ELSE
 10384         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10385             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10386                                       WS-IG-OVRD
 10387         ELSE
 10388             MOVE AM-IG             TO WS-IG-OVRD-LF
 10389                                       WS-IG-OVRD.
 10390
 10391     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10392     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10393     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10394     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10395*     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10396     INSPECT WS-ACCT-STATUS CONVERTING '9876543210'
 10397                                              TO 'PRLDSFCTIA'.
 10398
 10399     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10400     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 190
* EL050.cbl
 10401     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10402     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10403
 10404     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10405     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10406     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10407     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10408     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10409     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10410     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10411
 10412     IF WS-ACCT-AH-DEV-PCT > +0
 10413        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10414     ELSE
 10415        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10416
 10417     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10418        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10419     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10420        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10421
 10422        IF AM-EARN-METHOD-L = 'S'
 10423            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10424                                        WS-LF-REFUND-CALC.
 10425
 10426        IF AM-EARN-METHOD-R = 'S'
 10427            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10428                                        WS-LF-REFUND-CALC.
 10429
 10430     IF WS-LF-COVERAGE-TYPE = 'R'
 10431         IF AM-EARN-METHOD-R = 'R'
 10432            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10433                                    WS-LF-REFUND-CALC.
 10434     IF WS-LF-COVERAGE-TYPE = 'R'
 10435         IF AM-EARN-METHOD-R = 'P'
 10436            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10437                                    WS-LF-REFUND-CALC.
 10438     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10439         IF AM-EARN-METHOD-L = 'R'
 10440            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10441                                    WS-LF-REFUND-CALC.
 10442     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10443         IF AM-EARN-METHOD-L = 'P'
 10444            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10445                                    WS-LF-REFUND-CALC.
 10446     IF WS-LF-COVERAGE-TYPE = 'R'
 10447         IF AM-EARN-METHOD-R = 'A'
 10448            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10449                                    WS-LF-REFUND-CALC.
 10450     IF WS-LF-COVERAGE-TYPE = 'R'
 10451         IF AM-EARN-METHOD-R = 'M'
 10452            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10453                                    WS-LF-REFUND-CALC.
 10454     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10455         IF AM-EARN-METHOD-L = 'A'
 10456            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10457                                    WS-LF-REFUND-CALC.
 10458     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 191
* EL050.cbl
 10459         IF AM-EARN-METHOD-L = 'M'
 10460            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10461                                    WS-LF-REFUND-CALC.
 10462
 10463     IF AM-EARN-METHOD-A = 'R'
 10464        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10465                                    WS-AH-REFUND-CALC.
 10466     IF AM-EARN-METHOD-A = 'P'
 10467        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10468                                    WS-AH-REFUND-CALC.
 10469     IF AM-EARN-METHOD-A = 'C'
 10470        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10471                                    WS-AH-REFUND-CALC.
 10472     IF AM-EARN-METHOD-A = 'A'
 10473        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10474                                    WS-AH-REFUND-CALC.
 10475     IF AM-EARN-METHOD-A = 'M'
 10476        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10477                                    WS-AH-REFUND-CALC.
 10478     IF AM-EARN-METHOD-A = 'N'
 10479        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10480                                    WS-AH-REFUND-CALC.
 10481     IF AM-EARN-METHOD-A = 'S'
 10482        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10483                                    WS-AH-REFUND-CALC.
 10484
 10485     IF AM-TOL-PREM NOT = ZEROS
 10486        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10487                                    WS-TOL-AH-PREM.
 10488
 10489     IF AM-OVR-SHT-AMT NUMERIC AND
 10490                  AM-OVR-SHT-AMT > 0
 10491        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10492                                    EC-AM-LF-OVR-SHT-AMT
 10493                                    WS-AH-REFUND-OVS-AMT
 10494                                    EC-AM-AH-OVR-SHT-AMT.
 10495
 10496     IF AM-OVR-SHT-PCT NUMERIC AND
 10497                    AM-OVR-SHT-PCT > 0
 10498        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10499                                    EC-AM-LF-OVR-SHT-PCT
 10500                                    WS-AH-REFUND-OVS-PCT
 10501                                    EC-AM-AH-OVR-SHT-PCT.
 10502
 10503     IF AM-TOL-REF-PCT NUMERIC AND
 10504                  AM-TOL-REF-PCT > 0
 10505        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10506                                    WS-TOL-AH-REFUND-PCT.
 10507
 10508     IF AM-TOL-REF  NOT = ZEROS  AND
 10509                  AM-TOL-REF NUMERIC
 10510        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10511                                    EC-AM-LF-TOL-REFUND
 10512                                    WS-TOL-AH-REFUND
 10513                                    EC-AM-AH-TOL-REFUND.
 10514
 10515     IF AM-TOL-CLM  NOT = ZEROS
 10516        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 192
* EL050.cbl
 10517                                    WS-TOL-AH-CLAIM.
 10518
 10519     IF AM-CLP-TOL-PCT NOT NUMERIC
 10520        MOVE +0                  TO AM-CLP-TOL-PCT
 10521     END-IF
 10522
 10523     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10524        MOVE +0                  TO AM-SPP-LEASE-COMM
 10525     END-IF
 10526     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10527        MOVE WS-PL-TOL-LF-PREM-PCT
 10528                                 TO WS-TOL-LF-PREM-PCT.
 10529
 10530     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10531        MOVE WS-PL-TOL-AH-PREM-PCT
 10532                                 TO WS-TOL-AH-PREM-PCT.
 10533
 10534     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10535        MOVE WS-PL-TOL-LF-REFUND-PCT
 10536                                 TO WS-TOL-LF-REFUND-PCT.
 10537
 10538     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10539        MOVE WS-PL-TOL-AH-REFUND-PCT
 10540                                 TO WS-TOL-AH-REFUND-PCT.
 10541
 10542     IF WS-PL-REF-OVS-AMT > +0
 10543        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10544
 10545     IF WS-PL-REF-OVS-PCT > +0
 10546        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10547
 10548     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10549        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10550     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10551        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10552     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10553        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10554     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10555        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10556     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10557        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10558     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10559        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10560
 10561     IF WS-AH-PL-REF-OVS-AMT > +0
 10562        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10563
 10564     IF WS-AH-PL-REF-OVS-PCT > +0
 10565        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10566
 10567     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10568     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10569
 10570     IF PB-CANCELLATION
 10571        GO TO 3000-CONTINUE-EDIT.
 10572
 10573     MOVE +1 TO SUB1.
 10574     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 193
* EL050.cbl
 10575     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10576
 10577     IF CF-COMPANY-ID = 'DMD'
 10578       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10579         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10580        ELSE
 10581         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10582
 10583  0525-FIND-ACCT-COMM.
 10584     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10585        NEXT SENTENCE
 10586      ELSE
 10587         ADD +1 TO SUB1
 10588         IF SUB1 LESS +11
 10589            GO TO 0525-FIND-ACCT-COMM
 10590          ELSE
 10591             GO TO 0550-st-comm-cap-check.
 10592
 10593     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10594     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10595                                    PB-I-LIFE-COMMISSION.
 10596***  IF PB-COMPANY-ID = 'CRI'
 10597     IF PB-PREM-ACCTNG-ONLY
 10598         GO TO 0550-st-comm-cap-check.
 10599
 10600     MOVE '0530' TO CTBL-SW.
 10601     MOVE ' '    TO WS-CTBL-READ-SW.
 10602
 10603
 10604 0530-GET-AH-COMP.
 10605     IF NO-AH-COVERAGE  OR
 10606        NO-AH-BENEFIT-MATCH
 10607           GO TO 0540-NEXT-READ-STEP.
 10608
 10609     IF AM-A-COM (SUB1) NUMERIC
 10610        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10611         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10612         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10613         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10614         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10615     ELSE
 10616          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10617          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10618          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10619          MOVE ZEROS             TO WS-SUB1
 10620                                    WS-COMMISSION
 10621          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10622          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10623          IF WS-COMMISSION > ZEROS
 10624             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10625             GO TO 0540-NEXT-READ-STEP
 10626          END-IF
 10627          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10628          IF CTBL-TABLE-FOUND
 10629             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10630                                        PB-I-AH-TERM
 10631             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10632             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 194
* EL050.cbl
 10633             GO TO 0540-NEXT-READ-STEP
 10634          ELSE
 10635             IF FIRST-TIME-THROUGH
 10636                 GO TO 0530-GET-AH-COMP
 10637             ELSE
 10638                 MOVE ER-2609                TO WS-ERROR
 10639                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10640
 10641 0540-NEXT-READ-STEP.
 10642     MOVE '0540' TO CTBL-SW.
 10643     MOVE ' '    TO WS-CTBL-READ-SW.
 10644
 10645 0540-GET-LF-COMP.
 10646     IF NO-LIFE-COVERAGE  OR
 10647        NO-LF-BENEFIT-MATCH
 10648           GO TO 0550-st-comm-cap-check.
 10649
 10650     IF WS-LF-JOINT-INDICATOR = 'J'
 10651        IF AM-J-COM (SUB1) NUMERIC
 10652           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10653           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10654           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10655           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10656           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10657        ELSE
 10658           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10659           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10660           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10661           MOVE ZEROS                TO WS-SUB1
 10662                                        WS-COMMISSION
 10663           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10664           IF WS-COMMISSION > ZEROS
 10665              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10666              GO TO 0550-st-comm-cap-check
 10667           END-IF
 10668           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10669           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10670           IF CTBL-TABLE-FOUND
 10671              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10672              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10673              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10674              GO TO 0550-st-comm-cap-check
 10675           ELSE
 10676              IF FIRST-TIME-THROUGH
 10677                  GO TO 0540-GET-LF-COMP
 10678              ELSE
 10679                  MOVE ER-2609                TO WS-ERROR
 10680                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10681                  GO TO 0550-st-comm-cap-check.
 10682
 10683     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10684        IF AM-L-COM (SUB1) NUMERIC
 10685           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10686           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10687           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10688           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10689           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10690        ELSE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 195
* EL050.cbl
 10691           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10692           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10693           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10694           MOVE ZEROS                TO WS-SUB1
 10695                                        WS-COMMISSION
 10696           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10697           IF WS-COMMISSION IS GREATER THAN ZEROS
 10698              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10699              GO TO 0550-st-comm-cap-check
 10700           END-IF
 10701           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10702           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10703           IF CTBL-TABLE-FOUND
 10704              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10705              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10706              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10707              GO TO 0550-st-comm-cap-check
 10708           ELSE
 10709              IF FIRST-TIME-THROUGH
 10710                  GO TO 0540-GET-LF-COMP
 10711              ELSE
 10712                  MOVE ER-2609                TO WS-ERROR
 10713                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10714
 10715 0550-st-comm-cap-check.
 10716
 10717     perform varying sub5 from +1 by +1 until
 10718        (sub5 > +10)
 10719        move +0                  to ws-wk-rate
 10720        if (am-gl-codes (sub5) <> 'Y')
 10721           and (am-com-typ(sub5) = 'C' or 'D' or 'O' or 'P')
 10722           if pb-i-lf-benefit-cd <> '  ' and '00'
 10723              move zeros         to ws-wk-rate
 10724              if (am-l-com (sub5) numeric)
 10725                 and (am-l-coma (sub5) (3:1) not = 'L' and 'M')
 10726                 move am-l-com(sub5)
 10727                                 to ws-wk-rate
 10728              else
 10729                 move pb-company-cd to ctbl-company-cd
 10730                 move pb-i-lf-benefit-cd
 10731                                 to ctbl-ben-code
 10732                 move pb-i-lf-term  to ws-work-term
 10733                 move pb-life-override-l1
 10734                                 to ctbl-ben-type
 10735                 move zeros      to ws-sub1
 10736                                    ws-commission
 10737                 move am-l-coma (sub5)
 10738                                 to ctbl-table
 10739                 move '0540'     to ctbl-sw
 10740                 perform 0552-get-it
 10741                                 thru 0552-exit
 10742              end-if
 10743              compute ws-tot-sl-wk-rate =
 10744                 ws-tot-sl-wk-rate + ws-wk-rate
 10745              if am-com-typ(sub5) = 'C' or 'D'
 10746                 compute ws-sl-wk-rate =
 10747                    ws-sl-wk-rate + ws-wk-rate
 10748              else
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 196
* EL050.cbl
 10749                 if am-com-typ(sub5) = 'O' or 'P'
 10750                    compute ws-ga-sl-wk-rate =
 10751                       ws-ga-sl-wk-rate + ws-wk-rate
 10752                 end-if
 10753              end-if
 10754
 10755              move zeros         to ws-wk-rate
 10756              if (am-j-com (sub5) numeric)
 10757                 and (am-j-coma (sub5) (3:1) not = 'L' and 'M')
 10758                 move am-j-com(sub5)
 10759                                 to ws-wk-rate
 10760              else
 10761                 move pb-company-cd to ctbl-company-cd
 10762                 move pb-i-lf-benefit-cd
 10763                                 to ctbl-ben-code
 10764                 move pb-i-lf-term  to ws-work-term
 10765                 move pb-life-override-l1
 10766                                 to ctbl-ben-type
 10767                 move zeros      to ws-sub1
 10768                                    ws-commission
 10769                 move am-j-coma (sub5)
 10770                                 to ctbl-table
 10771                 move '0540'     to ctbl-sw
 10772                 perform 0552-get-it
 10773                                 thru 0552-exit
 10774              end-if
 10775              compute ws-tot-jl-wk-rate =
 10776                 ws-tot-jl-wk-rate + ws-wk-rate
 10777              if am-com-typ(sub5) = 'C' or 'D'
 10778                 compute ws-jl-wk-rate =
 10779                    ws-jl-wk-rate + ws-wk-rate
 10780              else
 10781                 if am-com-typ(sub5) = 'O' or 'P'
 10782                    compute ws-ga-jl-wk-rate =
 10783                       ws-ga-jl-wk-rate + ws-wk-rate
 10784                 end-if
 10785              end-if
 10786           end-if
 10787           move zeros            to ws-wk-rate
 10788
 10789           if pb-i-ah-benefit-cd <> '  ' and '00'
 10790              if (am-a-com (sub5) numeric)
 10791                 and (am-a-coma (sub5) (3:1) not = 'L' and 'M')
 10792                 move am-a-com(sub5)
 10793                                 to ws-wk-rate
 10794              else
 10795                 move pb-company-cd to ctbl-company-cd
 10796                 move pb-i-ah-benefit-cd
 10797                                 to ctbl-ben-code
 10798                 move pb-i-ah-term  to ws-work-term
 10799                 move pb-ah-override-l1
 10800                                 to ctbl-ben-type
 10801                 move zeros      to ws-sub1
 10802                                    ws-commission
 10803                 move am-a-coma (sub5)
 10804                                 to ctbl-table
 10805                 move '0530'     to ctbl-sw
 10806                 perform 0552-get-it
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 197
* EL050.cbl
 10807                                 thru 0552-exit
 10808              end-if
 10809              compute ws-tot-sa-wk-rate =
 10810                 ws-tot-sa-wk-rate + ws-wk-rate
 10811              if am-com-typ(sub5) = 'C' or 'D'
 10812                 compute ws-sa-wk-rate =
 10813                    ws-sa-wk-rate + ws-wk-rate
 10814              else
 10815                 if am-com-typ(sub5) = 'O' or 'P'
 10816                    compute ws-ga-sa-wk-rate =
 10817                       ws-ga-sa-wk-rate + ws-wk-rate
 10818                 end-if
 10819              end-if
 10820           end-if
 10821        end-if
 10822     end-perform
 10823
 10824     go to 0550-continue
 10825
 10826     .
 10827 0552-get-it.
 10828
 10829     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD
 10830     MOVE ZEROS                  TO WS-SUB1
 10831                                    WS-COMMISSION
 10832     MOVE ' '                    TO WS-CTBL-READ-SW
 10833     PERFORM 8300-READ-CTBL-TABLE
 10834                                 THRU 8300-EXIT
 10835     IF FIRST-TIME-THROUGH
 10836        MOVE 'AA'                TO CTBL-BEN-CODE
 10837        PERFORM 8300-READ-CTBL-TABLE
 10838                                 THRU 8300-EXIT
 10839     END-IF
 10840     IF CTBL-TABLE-FOUND
 10841        if pb-life-override-l1 = ctbl-ben-type
 10842           move pb-i-lf-benefit-amt
 10843                                 to WS-COMM-CK-AMT
 10844        else
 10845           compute ws-comm-ck-amt =
 10846              pb-I-ah-benefit-amt * pb-i-ah-term
 10847        end-if
 10848        PERFORM 8800-GET-COMP-RATE
 10849                                 THRU 8800-EXIT
 10850     else
 10851        move zeros               to ws-wk-rate
 10852     END-IF
 10853
 10854     .
 10855 0552-exit.
 10856     exit.
 10857
 10858 0550-continue.
 10859
 10860     if ws-lf-joint-indicator = 'J'
 10861        if (ws-jl-wk-rate > ws-st-comm-cap-jl)
 10862           and (ws-st-comm-cap-jl <> zeros)
 10863           MOVE ER-1956          TO WS-ERROR
 10864           PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 198
* EL050.cbl
 10865                                 THRU 9900-EXIT
 10866        end-if
 10867        if (ws-ga-jl-wk-rate > ws-st-ga-comm-cap-jl)
 10868           and (ws-st-ga-comm-cap-jl <> zeros)
 10869           MOVE ER-1959          TO WS-ERROR
 10870           PERFORM 9900-ERROR-FORMAT
 10871                                 THRU 9900-EXIT
 10872        end-if
 10873        if (ws-tot-jl-wk-rate > ws-st-tot-comm-cap-jl)
 10874           and (ws-st-tot-comm-cap-jl <> zeros)
 10875           MOVE ER-1962          TO WS-ERROR
 10876           PERFORM 9900-ERROR-FORMAT
 10877                                 THRU 9900-EXIT
 10878        end-if
 10879     else
 10880        if (ws-sl-wk-rate > ws-st-comm-cap-sl)
 10881           and (ws-st-comm-cap-sl <> zeros)
 10882           MOVE ER-1955          TO WS-ERROR
 10883           PERFORM 9900-ERROR-FORMAT
 10884                                 THRU 9900-EXIT
 10885        end-if
 10886        if (ws-ga-sl-wk-rate > ws-st-ga-comm-cap-sl)
 10887           and (ws-st-ga-comm-cap-sl <> zeros)
 10888           MOVE ER-1958          TO WS-ERROR
 10889           PERFORM 9900-ERROR-FORMAT
 10890                                 THRU 9900-EXIT
 10891        end-if
 10892        if (ws-tot-sl-wk-rate > ws-st-tot-comm-cap-sl)
 10893           and (ws-st-tot-comm-cap-sl <> zeros)
 10894           MOVE ER-1961          TO WS-ERROR
 10895           PERFORM 9900-ERROR-FORMAT
 10896                                 THRU 9900-EXIT
 10897        end-if
 10898
 10899     if ws-ah-joint-indicator = 'J'
 10900        if (ws-sa-wk-rate > ws-st-comm-cap-ja)
 10901           and (ws-st-comm-cap-ja <> zeros)
 10902           MOVE ER-1957          TO WS-ERROR
 10903           PERFORM 9900-ERROR-FORMAT
 10904                                 THRU 9900-EXIT
 10905        end-if
 10906        if (ws-ga-sa-wk-rate > ws-st-ga-comm-cap-ja)
 10907           and (ws-st-ga-comm-cap-ja <> zeros)
 10908           MOVE ER-1960          TO WS-ERROR
 10909           PERFORM 9900-ERROR-FORMAT
 10910                                 THRU 9900-EXIT
 10911        end-if
 10912        if (ws-tot-sa-wk-rate > ws-st-tot-comm-cap-ja)
 10913           and (ws-st-tot-comm-cap-ja <> zeros)
 10914           MOVE ER-1963          TO WS-ERROR
 10915           PERFORM 9900-ERROR-FORMAT
 10916                                 THRU 9900-EXIT
 10917        end-if
 10918     else
 10919        if (ws-sa-wk-rate > ws-st-comm-cap-sa)
 10920           and (ws-st-comm-cap-sa <> zeros)
 10921           MOVE ER-1957          TO WS-ERROR
 10922           PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 199
* EL050.cbl
 10923                                 THRU 9900-EXIT
 10924        end-if
 10925        if (ws-ga-sa-wk-rate > ws-st-ga-comm-cap-sa)
 10926           and (ws-st-ga-comm-cap-sa <> zeros)
 10927           MOVE ER-1960          TO WS-ERROR
 10928           PERFORM 9900-ERROR-FORMAT
 10929                                 THRU 9900-EXIT
 10930        end-if
 10931        if (ws-tot-sa-wk-rate > ws-st-tot-comm-cap-sa)
 10932           and (ws-st-tot-comm-cap-sa <> zeros)
 10933           MOVE ER-1963          TO WS-ERROR
 10934           PERFORM 9900-ERROR-FORMAT
 10935                                 THRU 9900-EXIT
 10936        end-if
 10937     end-if
 10938     .
 10939 0560-EDIT-CONTINUE.
 10940     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10941                                    WS-AH-PMF-COMM
 10942*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10943*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10944     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10945        (SUB1 > +10)
 10946        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10947           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10948           MOVE '0530'           TO CTBL-SW
 10949           MOVE ' '              TO WS-CTBL-READ-SW
 10950           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10951           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10952           MOVE '0540'           TO CTBL-SW
 10953           MOVE ' '              TO WS-CTBL-READ-SW
 10954           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10955        END-IF
 10956     END-PERFORM
 10957     GO TO 0564-EDIT-CONTINUE
 10958     .
 10959 0561-CHECK-AH.
 10960     IF (NO-AH-COVERAGE)
 10961        OR (NO-AH-BENEFIT-MATCH)
 10962        CONTINUE
 10963     ELSE
 10964        IF (AM-A-COM (SUB1) NUMERIC)
 10965           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10966           IF (AM-COM-TYP (SUB1) = 'A')
 10967              AND (WS-AH-PMF-COMM = ZEROS)
 10968              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10969           END-IF
 10970           CONTINUE
 10971        ELSE
 10972           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10973           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10974           MOVE PB-AH-OVERRIDE-L1
 10975                                 TO CTBL-BEN-TYPE
 10976           MOVE ZEROS            TO WS-SUB1
 10977                                    WS-COMMISSION
 10978           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10979           PERFORM 8300-READ-CTBL-TABLE
 10980                                 THRU 8300-EXIT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 200
* EL050.cbl
 10981           IF CTBL-TABLE-FOUND
 10982              IF (AM-COM-TYP (SUB1) = 'A')
 10983                 AND (WS-AH-PMF-COMM = ZEROS)
 10984                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10985                                        PB-I-AH-TERM
 10986                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10987                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10988              END-IF
 10989              CONTINUE
 10990           ELSE
 10991              IF FIRST-TIME-THROUGH
 10992                 GO TO 0561-CHECK-AH
 10993              ELSE
 10994                 MOVE ER-2609    TO WS-ERROR
 10995                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10996              END-IF
 10997           END-IF
 10998        END-IF
 10999     END-IF
 11000     .
 11001 0561-EXIT.
 11002     EXIT.
 11003 0563-CHECK-LF.
 11004     IF (NO-LIFE-COVERAGE)
 11005        OR (NO-LF-BENEFIT-MATCH)
 11006        CONTINUE
 11007     ELSE
 11008        IF WS-LF-JOINT-INDICATOR = 'J'
 11009           IF AM-J-COM (SUB1) NUMERIC
 11010              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11011              IF (AM-COM-TYP (SUB1) = 'A')
 11012                 AND (WS-LF-PMF-COMM = ZEROS)
 11013                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 11014              END-IF
 11015              CONTINUE
 11016           ELSE
 11017              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 11018              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 11019              MOVE PB-LIFE-OVERRIDE-L1
 11020                                 TO CTBL-BEN-TYPE
 11021              MOVE ZEROS         TO WS-SUB1
 11022                                    WS-COMMISSION
 11023              MOVE AM-J-COMA (SUB1)
 11024                                 TO CTBL-TABLE
 11025              PERFORM 8300-READ-CTBL-TABLE
 11026                                 THRU 8300-EXIT
 11027              IF CTBL-TABLE-FOUND
 11028                 IF (AM-COM-TYP (SUB1) = 'A')
 11029                    AND (WS-LF-PMF-COMM = ZEROS)
 11030                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 11031                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 11032                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 11033                 END-IF
 11034                 CONTINUE
 11035              ELSE
 11036                 IF FIRST-TIME-THROUGH
 11037                    GO TO 0563-CHECK-LF
 11038                 ELSE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 201
* EL050.cbl
 11039                    MOVE ER-2609 TO WS-ERROR
 11040                    PERFORM 9900-ERROR-FORMAT
 11041                                 THRU 9900-EXIT
 11042*                   GO TO 0560-EDIT-CONTINUE
 11043                 END-IF
 11044              END-IF
 11045           END-IF
 11046        ELSE
 11047           IF AM-L-COM (SUB1) NUMERIC
 11048              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11049              IF (AM-COM-TYP (SUB1) = 'A')
 11050                 AND (WS-LF-PMF-COMM = ZEROS)
 11051                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 11052              END-IF
 11053              CONTINUE
 11054           ELSE
 11055              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 11056              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 11057              MOVE PB-LIFE-OVERRIDE-L1
 11058                                 TO CTBL-BEN-TYPE
 11059              MOVE ZEROS         TO WS-SUB1
 11060                                    WS-COMMISSION
 11061              MOVE AM-L-COMA (SUB1)
 11062                                 TO CTBL-TABLE
 11063              PERFORM 8300-READ-CTBL-TABLE
 11064                                 THRU 8300-EXIT
 11065              IF CTBL-TABLE-FOUND
 11066                 CONTINUE
 11067              ELSE
 11068                 IF FIRST-TIME-THROUGH
 11069                    GO TO 0563-CHECK-LF
 11070                 ELSE
 11071                    MOVE ER-2609 TO WS-ERROR
 11072                    PERFORM 9900-ERROR-FORMAT
 11073                                 THRU 9900-EXIT
 11074                 END-IF
 11075              END-IF
 11076           END-IF
 11077        END-IF
 11078     END-IF
 11079     .
 11080 0563-EXIT.
 11081     EXIT.
 11082 0564-EDIT-CONTINUE.
 11083
 11084     IF  PB-COMPANY-ID EQUAL 'DMD'
 11085         IF PB-I-NUM-BILLED EQUAL ZEROS
 11086            MOVE ER-8148       TO WS-ERROR
 11087            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11088
 11089*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 11090*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11091*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 11092*         SET ELAPSED-BETWEEN-BIN TO TRUE
 11093*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11094*         IF NO-CONVERSION-ERROR
 11095*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 11096*         ELSE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 202
* EL050.cbl
 11097*             IF PB-COMPANY-ID EQUAL 'HAN'
 11098*                 MOVE ZEROS     TO PB-I-AGE.
 11099     IF PB-I-BIRTHDAY > LOW-VALUES
 11100        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 11101        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11102        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11103        PERFORM 8500-DATE-CONVERT
 11104                                 THRU 8500-EXIT
 11105        IF NO-CONVERSION-ERROR
 11106           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 11107           IF PB-I-AGE > ZEROS
 11108              IF WS-WORK-AGE NOT = PB-I-AGE
 11109                 MOVE ER-9501    TO WS-ERROR
 11110                 PERFORM 9900-ERROR-FORMAT
 11111                                 THRU 9900-EXIT
 11112              END-IF
 11113           ELSE
 11114              MOVE WS-WORK-AGE   TO PB-I-AGE
 11115           END-IF
 11116        END-IF
 11117     END-IF
 11118     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 11119                                   WS-INS-AGE-SET
 11120     IF PB-I-AGE = ZEROS
 11121        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 11122           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11123                                   WS-INS-AGE-SET
 11124           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 11125
 11126     MOVE PB-I-AGE              TO WS-EDIT-AGE
 11127                                   WS-AH-EDIT-AGE.
 11128
 11129     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 11130        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 11131        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11132        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11133        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11134        IF NO-CONVERSION-ERROR
 11135           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 11136           IF PB-I-JOINT-AGE > 0
 11137              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 11138                 MOVE ER-9503    TO WS-ERROR
 11139                 PERFORM 9900-ERROR-FORMAT
 11140                                 THRU 9900-EXIT
 11141              END-IF
 11142           ELSE
 11143              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 11144           END-IF
 11145        ELSE
 11146           MOVE ZEROS            TO PB-I-JOINT-AGE
 11147        END-IF
 11148     END-IF
 11149     IF PB-I-JOINT-AGE NOT NUMERIC
 11150        MOVE ZERO               TO PB-I-JOINT-AGE.
 11151
 11152     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 11153                                   WS-JNT-AGE-SET
 11154     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL' or 'VPP'
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 203
* EL050.cbl
 11155        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 11156           (WS-AH-JOINT-INDICATOR = 'J')
 11157           IF PB-I-JOINT-AGE = ZEROS
 11158               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 11159                                          WS-JNT-AGE-SET
 11160               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 11161           END-IF
 11162        END-IF
 11163     END-IF
 11164
 11165     MOVE ' ' TO PB-I-LIFE-INDICATOR
 11166     IF WS-LF-JOINT-INDICATOR = 'J'
 11167        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 11168        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 11169            IF  PB-I-JOINT-AGE = ZERO
 11170                MOVE ER-2686       TO WS-ERROR
 11171                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11172            ELSE
 11173                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 11174                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 11175                    IF PB-COMPANY-ID NOT = 'LBL'
 11176                        MOVE ER-2685    TO WS-ERROR
 11177                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11178
 11179     IF WS-AH-JOINT-INDICATOR = 'J'
 11180        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 11181            IF  PB-I-JOINT-AGE = ZERO
 11182                MOVE ER-2686       TO WS-ERROR
 11183                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11184            ELSE
 11185                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 11186                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 11187                                           WS-EDIT-AGE
 11188                    IF PB-COMPANY-ID NOT = 'LBL'
 11189                        MOVE ER-2685    TO WS-ERROR
 11190                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11191
 11192******************************************************************
 11193*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 11194******************************************************************
 11195
 11196     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 11197        (WS-AH-SPECIAL-CALC-CD = 'O')
 11198        NEXT SENTENCE
 11199     ELSE
 11200        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 11201          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 11202           (WS-LF-JOINT-INDICATOR = 'J'  OR
 11203            WS-AH-JOINT-INDICATOR = 'J')  AND
 11204           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 11205            MOVE ER-2627             TO WS-ERROR
 11206            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11207
 11208     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 11209        (WS-AH-SPECIAL-CALC-CD = 'O')
 11210         NEXT SENTENCE
 11211     ELSE
 11212         IF WS-LF-JOINT-INDICATOR = 'J'  OR
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 204
* EL050.cbl
 11213            WS-AH-JOINT-INDICATOR = 'J'
 11214             IF PB-I-JOINT-INSURED = SPACES
 11215                 IF PB-COMPANY-ID NOT = 'JAL'
 11216                     MOVE ER-2696    TO WS-ERROR
 11217                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11218
 11219     IF PB-COMPANY-ID NOT = 'BOA'
 11220        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 11221           (WS-AH-JOINT-INDICATOR NOT = 'J')
 11222           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 11223               PB-I-JOINT-INSURED NOT = SPACES)
 11224                MOVE ER-2691         TO WS-ERROR
 11225                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11226
 11227     IF PB-COMPANY-ID = 'BOA'
 11228        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 11229           (WS-AH-JOINT-INDICATOR NOT = 'J')
 11230            IF PB-I-JOINT-AGE NOT = ZEROS
 11231                MOVE ER-2691         TO WS-ERROR
 11232                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11233
 11234     IF PB-COMPANY-ID = 'CRI'
 11235        IF PB-I-SIG-SW = 'J'
 11236           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 11237              WS-AH-JOINT-INDICATOR NOT = 'J'
 11238              MOVE ER-2675       TO WS-ERROR
 11239              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11240
 11241     IF PB-COMPANY-ID = 'CRI'
 11242        IF PB-I-SIG-SW = 'S'
 11243           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 11244              WS-AH-JOINT-INDICATOR = 'J'
 11245              MOVE ER-2676       TO WS-ERROR
 11246              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11247
 11248     IF PB-COMPANY-ID = 'CVL'
 11249         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 11250            (WS-LF-JOINT-INDICATOR NOT = 'J')
 11251              MOVE ER-2783           TO WS-ERROR
 11252              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11253     IF (WS-LF-JOINT-INDICATOR = 'J')
 11254        AND (WS-AH-JOINT-INDICATOR = 'J')
 11255        AND (PB-I-LF-TERM > 120)
 11256        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 11257        MOVE ER-2783             TO WS-ERROR
 11258        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11259     END-IF
 11260     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 11261
 11262     IF PB-I-INDV-GRP-OVRD = 'I'
 11263        MOVE ER-2666             TO WS-ERROR
 11264        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11265        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 11266
 11267     IF PB-I-INDV-GRP-OVRD = 'G'
 11268        MOVE ER-2666             TO WS-ERROR
 11269        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11270        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 205
* EL050.cbl
 11271
 11272     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 11273        NEXT SENTENCE
 11274     ELSE
 11275        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 11276
 11277     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 11278        IF WS-ERROR = ER-2666
 11279           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11280           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 11281
 11282     IF PB-COMPANY-ID = 'CID'
 11283        IF PB-STATE = 'UT' OR 'MO'
 11284           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 11285                 OR '76' OR '77')
 11286                      OR
 11287               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 11288                   OR '41' OR '42' OR '63' OR '64' OR '65'
 11289                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 11290                   OR '2K' OR '2L'))
 11291              AND PB-I-INDV-GRP-CD = 'I'
 11292              MOVE ER-2721             TO WS-ERROR
 11293              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11294           END-IF
 11295        END-IF
 11296     END-IF
 11297
 11298     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 11299     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 11300        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 11301     ELSE
 11302        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 11303     END-IF
 11304
 11305*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 11306*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 11307     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 11308                                    ACCOUNT-AH-CK-SW.
 11309
 11310     IF PB-REISSUED-CERT       OR
 11311        PB-REIN-ONLY-CERT      OR
 11312        PB-POLICY-IS-DECLINED  OR
 11313        PB-POLICY-IS-VOIDED
 11314*       OR PB-MONTHLY-CERT
 11315         GO TO 3000-CONTINUE-EDIT.
 11316
 11317     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11318        IF WS-EDIT-AGE           > +65
 11319           MOVE ER-2709          TO WS-ERROR
 11320           PERFORM 9900-ERROR-FORMAT
 11321                                 THRU 9900-EXIT
 11322        ELSE
 11323           IF WS-EDIT-AGE        > +55
 11324              MOVE ER-2718       TO WS-ERROR
 11325              PERFORM 9900-ERROR-FORMAT
 11326                                 THRU 9900-EXIT
 11327           END-IF
 11328        END-IF
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 206
* EL050.cbl
 11329     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 11330        IF WS-EDIT-AGE           > +65
 11331           MOVE ER-2709          TO WS-ERROR
 11332           PERFORM 9900-ERROR-FORMAT
 11333                                 THRU 9900-EXIT
 11334        END-IF
 11335     END-IF
 11336     .
 11337
 11338 0565-LIFE-PLAN-LIMIT-EDITS.
 11339
 11340     IF NOT LF-PLAN-MASTER-FOUND
 11341        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 11342                                    EC-AM-LF-MAX-TOT-BEN
 11343        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11344
 11345     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 11346
 11347     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11348         IF PL-LM-AGE (1) = ZEROS
 11349             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11350
 11351     IF NO-LF-BENEFIT-MATCH          OR
 11352        WS-LF-BENEFIT-CD = ZEROS     OR
 11353        WS-LF-SPECIAL-CALC-CD = 'M'
 11354        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11355
 11356     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 11357     MOVE +1                     TO SUB2.
 11358
 11359     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11360        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11361           MOVE +5   TO SUB2
 11362           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11363              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11364              (PL-LM-AGE (SUB2) EQUAL +0)
 11365              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 11366              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11367
 11368     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 11369
 11370     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 11371                               + PB-I-LF-ALT-BENEFIT-AMT.
 11372
 11373 0568-CHECK-LIFE-ATT-AGE.
 11374
 11375     IF PL-ATT-AGE NUMERIC AND
 11376        PL-ATT-AGE > +0
 11377        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11378     END-IF
 11379*    IF PL-ATT-AGE NUMERIC AND
 11380*       PL-ATT-AGE > +0
 11381*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11382*       IF PB-I-BIRTHDAY > LOW-VALUES
 11383*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11384*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 11385*          MOVE ZERO             TO DC-ELAPSED-DAYS
 11386*          SET BIN-PLUS-ELAPSED  TO TRUE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 207
* EL050.cbl
 11387*          PERFORM 8500-DATE-CONVERT
 11388*                                THRU 8500-EXIT
 11389*          IF NO-CONVERSION-ERROR
 11390*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 11391*             MOVE ER-2669       TO WS-ERROR
 11392*             PERFORM 9900-ERROR-FORMAT
 11393*                                THRU 9900-EXIT
 11394*          END-IF
 11395*       ELSE
 11396*          IF WS-ATT-AGE >= PL-ATT-AGE
 11397*             MOVE ER-2669       TO WS-ERROR
 11398*             PERFORM 9900-ERROR-FORMAT
 11399*                                THRU 9900-EXIT
 11400*          END-IF
 11401*       END-IF
 11402*    END-IF
 11403     .
 11404 0570-CHECK-LIFE-LIMITS.
 11405
 11406     IF PB-COMPANY-ID EQUAL 'CRI'
 11407        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11408           IF SUB2 GREATER THAN +4
 11409              MOVE ER-2637 TO WS-ERROR
 11410              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11411              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11412
 11413     IF PB-COMPANY-ID  =  'NCL'
 11414        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11415            SUB2 GREATER THAN +8
 11416             MOVE 'U'         TO PB-BATCH-ENTRY
 11417             MOVE ER-2637     TO WS-ERROR
 11418             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11419             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11420
 11421     IF SUB2 > +8
 11422        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11423           AND (PB-I-SIG-SW = 'Y')
 11424           CONTINUE
 11425        ELSE
 11426           MOVE ER-2637          TO WS-ERROR
 11427           PERFORM 9900-ERROR-FORMAT
 11428                                 THRU 9900-EXIT
 11429        END-IF
 11430        GO TO 0580-AH-PLAN-LIMIT-EDITS
 11431     END-IF
 11432     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 11433     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 11434     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 11435
 11436     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11437        ADD +1  TO SUB2
 11438        GO TO 0570-CHECK-LIFE-LIMITS.
 11439
 11440     IF PB-COMPANY-ID = 'NCL'
 11441         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 11442
 11443     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 11444        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 208
* EL050.cbl
 11445        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11446           AND (PB-I-SIG-SW = 'Y')
 11447           CONTINUE
 11448        ELSE
 11449           MOVE ER-2637          TO WS-ERROR
 11450           PERFORM 9900-ERROR-FORMAT
 11451                                 THRU 9900-EXIT
 11452        END-IF
 11453     END-IF
 11454     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11455
 11456
 11457 0570-CHECK-NCL-LIFE-LIMITS.
 11458
 11459     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 11460        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
 11461         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11462
 11463     IF APP-CERT-USED
 11464         IF SUB2  LESS THAN  +5
 11465             MOVE +5          TO SUB2
 11466             GO TO 0570-CHECK-LIFE-LIMITS.
 11467
 11468     MOVE ER-2637             TO WS-ERROR.
 11469     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11470
 11471     MOVE 'U'                 TO PB-BATCH-ENTRY.
 11472
 11473 0575-CHECK-NCL-SIG-SWITCH.
 11474
 11475     IF NOT APP-CERT-USED
 11476         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11477
 11478     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11479        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11480        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11481        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11482         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11483
 11484     IF SUB2 GREATER THAN +4
 11485         IF PL-LM-AGE (5) = ZEROS  AND
 11486            PL-LM-AGE (6) = ZEROS  AND
 11487            PL-LM-AGE (7) = ZEROS  AND
 11488            PL-LM-AGE (8) = ZEROS
 11489             MOVE  ER-1927        TO WS-ERROR
 11490             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11491             GO TO 0580-AH-PLAN-LIMIT-EDITS
 11492         ELSE
 11493             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11494                 MOVE  ER-1920    TO WS-ERROR
 11495                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11496
 11497     IF PB-I-SIG-SW  = 'Y'
 11498       IF NOT PB-I-POLICY-ACCEPTED  AND
 11499          NOT PB-I-POLICY-DECLINED
 11500           MOVE 'U'               TO PB-BATCH-ENTRY
 11501           MOVE  ER-1926          TO WS-ERROR
 11502           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 209
* EL050.cbl
 11503
 11504
 11505 0580-AH-PLAN-LIMIT-EDITS.
 11506
 11507     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11508        IF PB-I-AH-BENEFIT-AMT > +1250
 11509           MOVE ER-2702          TO WS-ERROR
 11510           PERFORM 9900-ERROR-FORMAT
 11511                                 THRU 9900-EXIT
 11512        END-IF
 11513     END-IF
 11514
 11515     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 11516        AND (PB-MONTHLY-CERT)
 11517        IF PB-I-AH-BENEFIT-AMT > +3000
 11518           MOVE ER-2881          TO WS-ERROR
 11519           PERFORM 9900-ERROR-FORMAT
 11520                                 THRU 9900-EXIT
 11521        END-IF
 11522     END-IF
 11523     IF NOT AH-PLAN-MASTER-FOUND
 11524        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 11525        GO TO 3000-CONTINUE-EDIT.
 11526
 11527     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 11528
 11529     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11530         IF PL-LM-AGE (1) = ZEROS
 11531             GO TO 3000-CONTINUE-EDIT.
 11532
 11533     IF NO-AH-BENEFIT-MATCH          OR
 11534        WS-AH-BENEFIT-CD = ZEROS     OR
 11535        WS-AH-SPECIAL-CALC-CD = 'M'
 11536        GO TO 3000-CONTINUE-EDIT.
 11537
 11538     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11539     MOVE +1                     TO SUB2.
 11540
 11541     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11542        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11543           MOVE +5 TO SUB2
 11544           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11545              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11546              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11547              (PL-LM-AGE (SUB2) EQUAL +0)
 11548              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 11549              GO TO 3000-CONTINUE-EDIT.
 11550
 11551     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11552
 11553 0590-CHECK-AH-ATT-AGE.
 11554
 11555     IF PL-ATT-AGE NUMERIC AND
 11556        PL-ATT-AGE GREATER THAN +0
 11557        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11558     END-IF
 11559*       IF WS-ATT-AGE >= PL-ATT-AGE
 11560*          MOVE ER-3054          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 210
* EL050.cbl
 11561*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11562     .
 11563 0597-CHECK-AH-LIMITS.
 11564
 11565     IF PB-COMPANY-ID EQUAL 'CRI'
 11566        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11567           IF SUB2 GREATER THAN +4
 11568              MOVE ER-2638       TO WS-ERROR
 11569              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11570              GO TO 3000-CONTINUE-EDIT.
 11571
 11572     IF PB-COMPANY-ID  =  'NCL'
 11573        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11574            SUB2 GREATER THAN +8
 11575             MOVE 'U'            TO PB-BATCH-ENTRY
 11576             MOVE ER-2638        TO WS-ERROR
 11577             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11578             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11579
 11580     IF SUB2 > +8
 11581        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11582           AND (PB-I-SIG-SW = 'Y')
 11583           CONTINUE
 11584        ELSE
 11585           MOVE ER-2638          TO WS-ERROR
 11586           PERFORM 9900-ERROR-FORMAT
 11587                                 THRU 9900-EXIT
 11588        END-IF
 11589        GO TO 3000-CONTINUE-EDIT
 11590     END-IF
 11591
 11592     IF PB-COMPANY-ID = 'CRI'
 11593        IF WS-ERROR = ER-2638
 11594           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11595
 11596     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11597     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11598     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11599     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11600
 11601     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11602        ADD +1                   TO SUB2
 11603        GO TO 0597-CHECK-AH-LIMITS.
 11604
 11605     IF PB-COMPANY-ID = 'NCL'
 11606         GO TO 0597-CHECK-NCL-AH-LIMITS.
 11607
 11608     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11609        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11610        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11611                                 > PL-LM-AMT (SUB2))
 11612        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11613           AND (PB-I-SIG-SW = 'Y')
 11614           CONTINUE
 11615        ELSE
 11616           MOVE ER-2638          TO WS-ERROR
 11617           PERFORM 9900-ERROR-FORMAT
 11618                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 211
* EL050.cbl
 11619        END-IF
 11620     END-IF
 11621
 11622     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11623         IF  WS-ERROR    EQUAL    ER-2638
 11624             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11625                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11626                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11627                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11628                MOVE  ER-1910    TO  WS-ERROR
 11629                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11630
 11631     IF PB-COMPANY-ID = 'CRI'
 11632        IF WS-ERROR = ER-2638
 11633            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11634            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11635            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11636
 11637     GO TO 3000-CONTINUE-EDIT.
 11638
 11639 0597-CHECK-NCL-AH-LIMITS.
 11640
 11641     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11642        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11643        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11644                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11645         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11646
 11647     IF APP-CERT-USED
 11648         IF SUB2  LESS THAN  +5
 11649             MOVE +5             TO SUB2
 11650             GO TO 0597-CHECK-AH-LIMITS.
 11651
 11652     MOVE ER-2638                TO WS-ERROR.
 11653     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11654
 11655     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11656
 11657 0599-CHECK-NCL-SIG-SWITCH.
 11658
 11659     IF NOT APP-CERT-USED
 11660         GO TO 3000-CONTINUE-EDIT.
 11661
 11662     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11663        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11664        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11665        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11666         GO TO 3000-CONTINUE-EDIT.
 11667
 11668     IF SUB2 GREATER THAN +4
 11669         IF PL-LM-AGE (5) = ZEROS  AND
 11670            PL-LM-AGE (6) = ZEROS  AND
 11671            PL-LM-AGE (7) = ZEROS  AND
 11672            PL-LM-AGE (8) = ZEROS
 11673             MOVE  ER-1927        TO WS-ERROR
 11674             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11675             GO TO 3000-CONTINUE-EDIT
 11676         ELSE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 212
* EL050.cbl
 11677             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11678                 MOVE  ER-1920    TO WS-ERROR
 11679                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11680
 11681     IF PB-I-SIG-SW  = 'Y'
 11682       IF NOT PB-I-POLICY-ACCEPTED  AND
 11683          NOT PB-I-POLICY-DECLINED
 11684           MOVE 'U'               TO PB-BATCH-ENTRY
 11685           MOVE  ER-1926          TO WS-ERROR
 11686           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11687
 11688******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 213
* EL050.cbl
 11690
 11691 3000-CONTINUE-EDIT.
 11692
 11693     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11694     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11695     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11696     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11697     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11698
 11699     IF BROWSE-STARTED
 11700        PERFORM 9990-RETURN THRU 9990-EXIT
 11701        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11702
 11703     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11704        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11705        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11706        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11707*       MOVE 1                   TO DC-OPTION-CODE
 11708        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11709        IF DATE-CONVERSION-ERROR
 11710           MOVE ER-2622          TO WS-ERROR
 11711           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11712        ELSE
 11713           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11714              MOVE ER-2623       TO WS-ERROR
 11715              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11716           ELSE
 11717              MOVE ER-2622       TO WS-ERROR
 11718              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11719
 11720     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11721     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11722     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11723*    MOVE 1                      TO DC-OPTION-CODE.
 11724     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11725     IF DATE-CONVERSION-ERROR
 11726        GO TO 3005-EDIT-CONTINUE
 11727     ELSE
 11728        IF DC-ELAPSED-DAYS GREATER +180
 11729           MOVE ER-2613          TO WS-ERROR
 11730           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11731        ELSE
 11732           IF DC-ELAPSED-DAYS GREATER +90
 11733              MOVE ER-2612       TO WS-ERROR
 11734              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11735           ELSE
 11736             IF DC-ELAPSED-DAYS GREATER +60
 11737                MOVE ER-2614     TO WS-ERROR
 11738                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11739
 11740 3005-EDIT-CONTINUE.
 11741
 11742     IF PB-CANCELLATION
 11743         GO TO 3700-EDIT-CANCEL.
 11744
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 214
* EL050.cbl
 11746******************************************************************
 11747*                  E D I T   I S S U E                           *
 11748******************************************************************
 11749
 11750 3020-EDIT-ISSUE.
 11751
 11752      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11753      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11754      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11755      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11756      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11757
 11758     IF PB-ISSUE-FORCE
 11759        OR PB-ISSUE-DATE-FORCED
 11760        OR PB-FORCE-OFF
 11761        OR PB-OVERCHARGE-FORCE
 11762        or pb-exceeded-limit-forced
 11763        CONTINUE
 11764     ELSE
 11765        MOVE ER-2670             TO WS-ERROR
 11766        PERFORM 9900-ERROR-FORMAT
 11767                                 THRU 9900-EXIT
 11768     END-IF
 11769     .
 11770 3022-SET-POLICY-STATUS.
 11771
 11772     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11773
 11774     IF (PB-REISSUED-CERT)
 11775             OR
 11776        ((PB-COMPANY-ID NOT = 'DCC' and 'VPP')
 11777         AND (PB-MONTHLY-CERT))
 11778         MOVE '5'                TO PB-I-ENTRY-STATUS
 11779         MOVE 'E'                TO PB-BATCH-ENTRY
 11780     END-IF
 11781
 11782     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 11783        IF PB-MONTHLY-CERT
 11784           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11785        END-IF
 11786        IF PB-CASH-CERT
 11787           MOVE 'C'              TO PB-I-ENTRY-STATUS
 11788        END-IF
 11789     END-IF
 11790     IF PB-POLICY-IS-DECLINED
 11791         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11792     IF PB-POLICY-IS-VOIDED
 11793         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11794     IF PB-NEEDS-UNDERWRITING
 11795         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11796     IF PB-REIN-ONLY-CERT
 11797         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11798     IF PB-PREM-ACCTNG-ONLY
 11799         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11800
 11801     MOVE SPACE                  TO PB-I-OB-FLAG.
 11802
 11803     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 215
* EL050.cbl
 11804         MOVE ER-2665            TO WS-ERROR
 11805         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11806         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11807
 11808     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11809        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11810           MOVE 'Z'             TO PB-I-OB-FLAG.
 11811
 11812     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11813        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11814           MOVE 'Z'             TO PB-I-OB-FLAG.
 11815
 11816     IF ACCOUNT-MAST-FOUND
 11817         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11818         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11819         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11820         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11821         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11822         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11823         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11824     END-IF
 11825
 11826     IF ACCOUNT-MAST-FOUND
 11827        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11828         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11829
 11830     IF (ACCOUNT-MAST-FOUND)
 11831*        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11832        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S' OR 'D' OR 'P')
 11833        IF PB-REISSUED-CERT
 11834           CONTINUE
 11835        ELSE
 11836           MOVE ER-2608          TO WS-ERROR
 11837           PERFORM 9900-ERROR-FORMAT
 11838                                 THRU 9900-EXIT
 11839         END-IF
 11840     END-IF
 11841
 11842     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11843        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11844        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11845
 11846**********   DMD CUSTOM CODE FOLLOWS  **********
 11847 3024-EDIT-DMD-FIELDS.
 11848     IF PB-COMPANY-ID NOT = 'DMD'
 11849        GO TO 3025-EDIT-REINSURANCE.
 11850
 11851*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11852*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11853*** ERROR IF THEY ARE NOT EQUAL.
 11854
 11855     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11856     SET BIN-TO-GREG               TO TRUE.
 11857     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11858     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11859**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11860
 11861     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 216
* EL050.cbl
 11862     SET BIN-TO-GREG               TO TRUE.
 11863     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11864     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11865**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11866
 11867     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11868        MOVE ER-8116               TO WS-ERROR
 11869        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11870
 11871     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11872
 11873     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11874                                      WK-FULL-CERT-NO.
 11875     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11876
 11877     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11878
 11879     IF PB-VALID-LIFE
 11880        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11881     ELSE
 11882        IF PB-VALID-AH
 11883          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11884
 11885
 11886     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11887     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11888     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11889                                      DCUA-UNDRWRTR-CODE
 11890                                      DCUA-UNDRWRTR-GROUP-CODE
 11891                                      DCUA-RETURN-CODE.
 11892
 11893****************************************************************
 11894*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11895***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11896***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11897***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11898***   TO THIS RECORD.                                        ***
 11899****************************************************************
 11900     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11901     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11902     IF DCUA-SUCCESSFUL-PROCESS
 11903        GO TO 3024-EDIT-DL7-CONT.
 11904
 11905     IF DCUA-RETURN-CODE EQUAL '01'
 11906        MOVE ER-8110               TO WS-ERROR
 11907        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11908        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11909        GO TO 3024-EDIT-DL7-CONT.
 11910
 11911     IF DCUA-RETURN-CODE EQUAL '02'
 11912        MOVE ER-8111               TO WS-ERROR
 11913        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11914        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11915        GO TO 3024-EDIT-DL7-CONT.
 11916
 11917     IF DCUA-RETURN-CODE EQUAL '03'
 11918        MOVE ER-8074               TO WS-ERROR
 11919        MOVE 'Y'                   TO WS-DLO-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 217
* EL050.cbl
 11920        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11921        GO TO 3024-EDIT-DL7-CONT.
 11922
 11923     IF DCUA-RETURN-CODE EQUAL '04'
 11924        MOVE ER-8075               TO WS-ERROR
 11925        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11926        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11927        GO TO 3024-EDIT-DL7-CONT.
 11928
 11929     IF DCUA-RETURN-CODE EQUAL '05'
 11930        MOVE ER-8076               TO WS-ERROR
 11931        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11932        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11933        GO TO 3024-EDIT-DL7-CONT.
 11934
 11935     IF DCUA-RETURN-CODE EQUAL '06'
 11936        MOVE ER-8077               TO WS-ERROR
 11937        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11938        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11939        GO TO 3024-EDIT-DL7-CONT.
 11940
 11941     IF DCUA-RETURN-CODE EQUAL '07'
 11942        MOVE ER-8078               TO WS-ERROR
 11943        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11944        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11945        GO TO 3024-EDIT-DL7-CONT.
 11946
 11947     IF DCUA-RETURN-CODE EQUAL 'E1'
 11948        MOVE ER-8079               TO WS-ERROR
 11949        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11950        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11951        GO TO 3024-EDIT-DL7-CONT.
 11952
 11953     IF DCUA-RETURN-CODE EQUAL 'E2'
 11954        MOVE ER-8080               TO WS-ERROR
 11955        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11956        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11957        GO TO 3024-EDIT-DL7-CONT.
 11958
 11959     IF DCUA-RETURN-CODE EQUAL 'E3'
 11960        MOVE ER-8098               TO WS-ERROR
 11961        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11962        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11963        GO TO 3024-EDIT-DL7-CONT.
 11964
 11965     IF DCUA-RETURN-CODE EQUAL 'C1'
 11966        MOVE ER-8099               TO WS-ERROR
 11967        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11968        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11969        GO TO 3024-EDIT-DL7-CONT.
 11970
 11971     IF DCUA-RETURN-CODE EQUAL 'U1'
 11972        MOVE ER-8109               TO WS-ERROR
 11973        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11974        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11975        GO TO 3024-EDIT-DL7-CONT.
 11976
 11977     IF DCUA-RETURN-CODE EQUAL 'N1'
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 218
* EL050.cbl
 11978        MOVE ER-8112               TO WS-ERROR
 11979        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11980        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11981        GO TO 3024-EDIT-DL7-CONT.
 11982
 11983     IF DCUA-RETURN-CODE EQUAL 'N2'
 11984        MOVE ER-8113               TO WS-ERROR
 11985        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11986        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11987        GO TO 3024-EDIT-DL7-CONT.
 11988
 11989     IF DCUA-RETURN-CODE EQUAL 'N3'
 11990        MOVE ER-8114               TO WS-ERROR
 11991        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11992        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11993        GO TO 3024-EDIT-DL7-CONT.
 11994
 11995     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11996     MOVE ER-8097                  TO WS-ERROR.
 11997     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11998     GO TO 3024-EDIT-DL7-CONT.
 11999
 12000 3024-EDIT-DL7-CONT.
 12001
 12002     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 12003     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 12004     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 12005        NEXT SENTENCE
 12006     ELSE
 12007        MOVE ER-9263               TO WS-ERROR
 12008        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12009
 12010******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 12011******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 12012     IF DCUA-CERT-NUMBER = PB-CERT-NO
 12013        NEXT SENTENCE
 12014     ELSE
 12015        MOVE ER-8039               TO WS-ERROR
 12016        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12017
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 219
* EL050.cbl
 12019****************************************************************
 12020*** VALIDATE STATE  : DLO022                                 ***
 12021****************************************************************
 12022     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 12023     MOVE SPACES                   TO DVSC-RETURN-CODE.
 12024
 12025     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 12026     IF DVSC-SUCCESSFUL-EDIT
 12027        GO TO 3024-EDIT-DL22-CONT.
 12028
 12029     IF DVSC-RETURN-CODE EQUAL '01'
 12030        MOVE ER-8300               TO WS-ERROR
 12031        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12032        GO TO 3024-EDIT-DL22-CONT.
 12033
 12034     IF DVSC-RETURN-CODE EQUAL '02'
 12035        MOVE ER-8301               TO WS-ERROR
 12036        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12037        GO TO 3024-EDIT-DL22-CONT.
 12038
 12039     IF DVSC-RETURN-CODE EQUAL '03'
 12040        MOVE ER-8302               TO WS-ERROR
 12041        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12042        GO TO 3024-EDIT-DL22-CONT.
 12043
 12044     IF DVSC-RETURN-CODE EQUAL 'N1'
 12045        MOVE ER-8304               TO WS-ERROR
 12046        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12047        GO TO 3024-EDIT-DL22-CONT.
 12048
 12049     MOVE ER-8303                  TO WS-ERROR
 12050     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12051
 12052 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 220
* EL050.cbl
 12054****************************************************************
 12055*** VALIDATE LOAN OFFICER : DLO021                           ***
 12056****************************************************************
 12057
 12058     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 12059     MOVE SPACES                    TO DVLO-RETURN-CODE.
 12060     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 12061     IF DVLO-SUCCESSFUL-EDIT
 12062        GO TO 3024-EDIT-DL21-CONT.
 12063
 12064     IF DVLO-RETURN-CODE EQUAL '01'
 12065        MOVE ER-8081               TO WS-ERROR
 12066        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12067        GO TO 3024-EDIT-DL21-CONT.
 12068
 12069     IF DVLO-RETURN-CODE EQUAL '02'
 12070        MOVE ER-8082               TO WS-ERROR
 12071        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12072        GO TO 3024-EDIT-DL21-CONT.
 12073
 12074     IF DVLO-RETURN-CODE EQUAL '03'
 12075        MOVE ER-8083               TO WS-ERROR
 12076        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12077        GO TO 3024-EDIT-DL21-CONT.
 12078
 12079     IF DVLO-RETURN-CODE EQUAL '04'
 12080        MOVE ER-8084               TO WS-ERROR
 12081        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12082        GO TO 3024-EDIT-DL21-CONT.
 12083
 12084     IF DVLO-RETURN-CODE EQUAL '05'
 12085        MOVE ER-8085               TO WS-ERROR
 12086        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12087        GO TO 3024-EDIT-DL21-CONT.
 12088
 12089     MOVE ER-7825                  TO WS-ERROR
 12090     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12091     GO TO 3024-EDIT-DL21-CONT.
 12092
 12093 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 221
* EL050.cbl
 12095
 12096****************************************************************
 12097*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 12098****************************************************************
 12099
 12100     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 12101     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 12102     MOVE SPACES                 TO DIPF-RETURN-CODE.
 12103     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 12104     IF DIPF-SUCCESSFUL-EDIT
 12105        GO TO 3024-EDIT-DL02-CONT.
 12106
 12107     IF DIPF-RETURN-CODE EQUAL '01'
 12108        MOVE ER-8086               TO WS-ERROR
 12109        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12110        GO TO 3024-EDIT-DL02-CONT.
 12111
 12112     IF DIPF-RETURN-CODE EQUAL '02'
 12113        MOVE ER-8087               TO WS-ERROR
 12114        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12115        GO TO 3024-EDIT-DL02-CONT.
 12116
 12117     IF DIPF-RETURN-CODE EQUAL '03'
 12118        MOVE ER-8088               TO WS-ERROR
 12119        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12120        GO TO 3024-EDIT-DL02-CONT.
 12121
 12122     MOVE ER-8095                  TO WS-ERROR
 12123     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12124     GO TO 3024-EDIT-DL02-CONT.
 12125
 12126 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 222
* EL050.cbl
 12128
 12129****************************************************************
 12130*** VALIDATE BANK ID : DLO003                                ***
 12131****************************************************************
 12132
 12133     MOVE WK-GREG-CENT           TO WCG-CENT.
 12134     MOVE WK-GREG-YYMM           TO WCG-REST.
 12135     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 12136        MOVE ER-8040               TO WS-ERROR
 12137        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12138
 12139     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 12140     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 12141     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 12142     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 12143     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 12144     IF DVBI-SUCCESSFUL-EDIT
 12145        GO TO 3024-EDIT-DL03-CONT.
 12146
 12147     IF DVBI-RETURN-CODE EQUAL '01'
 12148        MOVE ER-8089               TO WS-ERROR
 12149        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12150        GO TO 3024-EDIT-DL03-CONT.
 12151
 12152     IF DVBI-RETURN-CODE EQUAL '02'
 12153        MOVE ER-8090               TO WS-ERROR
 12154        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12155        GO TO 3024-EDIT-DL03-CONT.
 12156
 12157     IF DVBI-RETURN-CODE EQUAL '03'
 12158        MOVE ER-8091               TO WS-ERROR
 12159        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12160        GO TO 3024-EDIT-DL03-CONT.
 12161
 12162     IF DVBI-RETURN-CODE EQUAL '04'
 12163        MOVE ER-8092               TO WS-ERROR
 12164        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12165        GO TO 3024-EDIT-DL03-CONT.
 12166
 12167     IF DVBI-RETURN-CODE EQUAL '05'
 12168        MOVE ER-8093               TO WS-ERROR
 12169        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12170        GO TO 3024-EDIT-DL03-CONT.
 12171
 12172     IF DVBI-RETURN-CODE EQUAL '06'
 12173        MOVE ER-8094               TO WS-ERROR
 12174        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12175        GO TO 3024-EDIT-DL03-CONT.
 12176
 12177     MOVE ER-8096                  TO WS-ERROR
 12178     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12179     GO TO 3024-EDIT-DL03-CONT.
 12180
 12181 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 223
* EL050.cbl
 12183
 12184     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 12185        NEXT SENTENCE
 12186     ELSE
 12187        MOVE ER-8042               TO WS-ERROR
 12188        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12189
 12190     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 12191     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 12192     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 12193
 12194     IF DMPF-RETURN-CODE = '01'
 12195        MOVE ER-8067               TO WS-ERROR
 12196        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12197        GO TO 3024-EDIT-DL01-CONT.
 12198
 12199     IF DMPF-RETURN-CODE = '02'
 12200        MOVE ER-8068               TO WS-ERROR
 12201        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12202        GO TO 3024-EDIT-DL01-CONT.
 12203
 12204     IF DMPF-RETURN-CODE = '03'
 12205        MOVE ER-8069               TO WS-ERROR
 12206        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12207        GO TO 3024-EDIT-DL01-CONT.
 12208
 12209     IF DMPF-RETURN-CODE = 'E1'
 12210        MOVE ER-8070               TO WS-ERROR
 12211        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12212        GO TO 3024-EDIT-DL01-CONT.
 12213
 12214     IF DMPF-RETURN-CODE = 'N1'
 12215        MOVE ER-8071               TO WS-ERROR
 12216        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12217        GO TO 3024-EDIT-DL01-CONT.
 12218
 12219     IF DMPF-RETURN-CODE NOT = 'OK'
 12220        MOVE ER-8072               TO WS-ERROR
 12221        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12222
 12223 3024-EDIT-DL01-CONT.
 12224******************************************************************
 12225***  VALIDATES RATE CODES : DLO017                             ***
 12226******************************************************************
 12227
 12228      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 12229      MOVE SPACES                   TO DVRC-RETURN-CODE.
 12230      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 12231      IF DVRC-SUCCESSFUL-EDIT
 12232        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 12233        GO TO 3024-CHECK-VALID-RATE.
 12234
 12235      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 12236
 12237      IF DVRC-RETURN-CODE EQUAL '01'
 12238         MOVE ER-7817                   TO WS-ERROR
 12239         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12240         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 224
* EL050.cbl
 12241
 12242      IF DVRC-RETURN-CODE EQUAL '02'
 12243         MOVE ER-7818                   TO WS-ERROR
 12244         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12245         GO TO 3025-EDIT-REINSURANCE.
 12246
 12247      IF DVRC-RETURN-CODE EQUAL '03'
 12248         MOVE ER-7819                   TO WS-ERROR
 12249         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12250         GO TO 3025-EDIT-REINSURANCE.
 12251
 12252       MOVE ER-7820                     TO WS-ERROR.
 12253       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 12254       GO TO 3025-EDIT-REINSURANCE.
 12255
 12256******************************************************************
 12257***  GET PREMIUM RATES : DLO011                                ***
 12258******************************************************************
 12259
 12260 3024-CHECK-VALID-RATE.
 12261
 12262     IF VALID-RATE-CODE
 12263        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 12264        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 12265        MOVE SPACES                TO DPRB-RETURN-CODE
 12266        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 12267     ELSE
 12268         GO TO 3025-EDIT-REINSURANCE.
 12269
 12270      IF DPRB-SUCCESSFUL-PROCESS
 12271         IF PB-VALID-LIFE
 12272             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 12273             GO TO 3025-EDIT-REINSURANCE
 12274         ELSE
 12275             IF PB-VALID-AH
 12276                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 12277                 GO TO 3025-EDIT-REINSURANCE.
 12278
 12279      IF DPRB-RETURN-CODE EQUAL '01'
 12280         MOVE ER-7812                   TO WS-ERROR
 12281         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12282         GO TO 3025-EDIT-REINSURANCE.
 12283
 12284      IF DPRB-RETURN-CODE EQUAL '02'
 12285         MOVE ER-7813                   TO WS-ERROR
 12286         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12287         GO TO 3025-EDIT-REINSURANCE.
 12288
 12289      IF DPRB-RETURN-CODE EQUAL '03'
 12290         MOVE ER-7814                   TO WS-ERROR
 12291         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12292         GO TO 3025-EDIT-REINSURANCE.
 12293
 12294      IF DPRB-RETURN-CODE EQUAL '04'
 12295         IF NOT DPRB-1ST-TIME
 12296            MOVE ER-7815                   TO WS-ERROR
 12297            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12298            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 225
* EL050.cbl
 12299          ELSE
 12300         IF PB-VALID-LIFE
 12301            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 12302          ELSE
 12303            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 12304         END-IF
 12305         MOVE SPACES                TO DOCC-RETURN-CODE
 12306         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 12307         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 12308         IF DOCC-RETURN-CODE = 'OK'
 12309             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 12310             GO TO 3024-CHECK-VALID-RATE
 12311           ELSE
 12312             MOVE ER-7823               TO WS-ERROR
 12313             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 12314             GO TO 3025-EDIT-REINSURANCE.
 12315
 12316       MOVE ER-7816                     TO WS-ERROR.
 12317       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 12318       GO TO 3025-EDIT-REINSURANCE.
 12319
 12320**********   DMD CUSTOM CODE ABOVE    **********
 12321
 12322 3025-EDIT-REINSURANCE.
 12323     IF PB-I-SPECIAL-REIN-CODE = SPACE
 12324         GO TO 3027-EDIT-CONTINUE.
 12325
 12326     MOVE LOW-VALUES               TO ERREIN-KEY.
 12327     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 12328     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 12329                                      REIN-CODE-2
 12330                                      REIN-CODE-3.
 12331     MOVE 'A'                      TO REIN-TYPE.
 12332
 12333     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 12334
 12335     MOVE '3026' TO REIN-SW.
 12336     MOVE ' '                   TO WS-REIN-READ-SW.
 12337
 12338     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 12339     IF REIN-TABLE-NOT-FOUND
 12340         GO TO 3026-NO-SPEC-TABLE.
 12341
 12342     MOVE RE-TABLE              TO WK-REIN-TABLE.
 12343     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12344                                   WS-NSP-ST-CD-LF.
 12345     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12346                                   WS-NSP-ST-CD-AH.
 12347
 12348     GO TO 3040-EDIT-CONTINUE.
 12349
 12350 3026-NO-SPEC-TABLE.
 12351
 12352     MOVE ER-2664                TO WS-ERROR.
 12353     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12354     GO TO 3040-EDIT-CONTINUE.
 12355
 12356 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 226
* EL050.cbl
 12357
 12358     IF PB-I-REIN-TABLE = SPACES
 12359       GO TO 3040-EDIT-CONTINUE.
 12360
 12361     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 12362          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 12363          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 12364           GO TO 3040-EDIT-CONTINUE.
 12365
 12366     MOVE LOW-VALUES            TO ERREIN-KEY.
 12367     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 12368     MOVE 'A'                   TO REIN-TYPE.
 12369     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 12370
 12371     MOVE '3028'                TO REIN-SW.
 12372     MOVE ' '                   TO WS-REIN-READ-SW.
 12373
 12374     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 12375     IF REIN-TABLE-NOT-FOUND
 12376         GO TO 3028-NO-REIN-TABLE.
 12377
 12378     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 12379     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12380                                   WS-NSP-ST-CD-LF.
 12381     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12382                                   WS-NSP-ST-CD-AH.
 12383
 12384     GO TO 3040-EDIT-CONTINUE.
 12385
 12386 3028-NO-REIN-TABLE.
 12387
 12388     MOVE ER-2615                TO WS-ERROR.
 12389     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12390     GO TO 3040-EDIT-CONTINUE.
 12391
 12392 3040-EDIT-CONTINUE.
 12393
 12394     IF PB-I-LF-PREM-CALC NOT NUMERIC
 12395         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 12396
 12397     IF PB-I-AH-PREM-CALC NOT NUMERIC
 12398         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 12399
 12400     IF (NOT PB-REISSUED-CERT)
 12401        AND (NOT PB-MONTHLY-CERT)
 12402        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 12403            MOVE '001'           TO PB-I-LF-TERM
 12404            MOVE 'M'             TO PB-I-INSURED-SEX.
 12405
 12406     IF (NOT PB-REISSUED-CERT)
 12407        AND (NOT PB-MONTHLY-CERT)
 12408        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 12409            MOVE '001'           TO PB-I-AH-TERM
 12410            MOVE 'M'             TO PB-I-INSURED-SEX.
 12411
 12412 3040-EDIT-1ST-PMT-DT.
 12413     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 12414     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 227
* EL050.cbl
 12415         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 12416
 12417******************************************************************
 12418*                                                                *
 12419*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 12420*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 12421*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 12422*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 12423*                                                                *
 12424******************************************************************
 12425
 12426     IF PB-EFF-DT-PROCESSING
 12427        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12428                                    PB-I-LF-EXPIRE-DT
 12429                                    PB-I-AH-EXPIRE-DT
 12430        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12431        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12432        MOVE ZERO                TO DC-ELAPSED-DAYS
 12433        MOVE +1                  TO DC-ELAPSED-MONTHS
 12434        SET BIN-PLUS-ELAPSED     TO TRUE
 12435*       MOVE 6                   TO DC-OPTION-CODE
 12436        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12437        IF NO-CONVERSION-ERROR
 12438           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12439
 12440******************************************************************
 12441*                                                                *
 12442*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 12443*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 12444*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12445*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 12446*                                                                *
 12447******************************************************************
 12448
 12449     IF PB-EXT-DAYS-PROCESSING
 12450          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 12451                                         PB-I-LF-EXPIRE-DT
 12452                                         PB-I-AH-EXPIRE-DT
 12453          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 12454          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12455          MOVE +1                     TO DC-ELAPSED-MONTHS
 12456          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 12457          SET BIN-PLUS-ELAPSED        TO TRUE
 12458*         MOVE 6                      TO DC-OPTION-CODE
 12459          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12460          IF NO-CONVERSION-ERROR
 12461             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 12462
 12463******************************************************************
 12464*                                                                *
 12465*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 12466*        BASED ON THE OLDEST EXPIRE DATE.                        *
 12467*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12468*        (EXPIRE DATE - (TERM -1))  *  -1.
 12469*                                                                *
 12470******************************************************************
 12471
 12472     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 228
* EL050.cbl
 12473        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 12474           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 12475              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12476              MOVE PB-I-AH-TERM      TO WS-TERM
 12477           ELSE
 12478              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12479              MOVE PB-I-LF-TERM      TO WS-TERM
 12480        ELSE
 12481           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 12482              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12483              MOVE PB-I-LF-TERM      TO WS-TERM
 12484           ELSE
 12485              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12486              MOVE PB-I-AH-TERM      TO WS-TERM.
 12487
 12488     IF PB-EXPIRE-DT-PROCESSING
 12489        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12490        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12491        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 12492        MOVE ZERO                TO DC-ELAPSED-DAYS
 12493                                    DC-ODD-DAYS-OVER
 12494          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 12495          SET BIN-PLUS-ELAPSED    TO TRUE
 12496*         MOVE 6                  TO DC-OPTION-CODE
 12497          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12498          IF NO-CONVERSION-ERROR
 12499             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12500
 12501******************************************************************
 12502*                                                                *
 12503*            1ST PAYMENT DATE PROCESSING                         *
 12504*                                                                *
 12505******************************************************************
 12506
 12507     IF PB-1ST-PMT-DT-PROCESSING
 12508        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 12509                                    PB-I-AH-EXPIRE-DT
 12510        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 12511
 12512     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 12513         NEXT SENTENCE
 12514     ELSE
 12515         MOVE ER-2680                 TO WS-ERROR
 12516         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12517         GO TO 3060-ORIG-TERM-CHECK.
 12518
 12519     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12520     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 12521     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12522*    MOVE 1                      TO DC-OPTION-CODE.
 12523     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 12524                                    DC-ELAPSED-DAYS
 12525                                    DC-ODD-DAYS-OVER.
 12526
 12527     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12528
 12529     IF DATE-CONVERSION-ERROR
 12530        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 229
* EL050.cbl
 12531
 12532     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 12533     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 12534        AND (WS-LF-COVERAGE-TYPE = 'L')
 12535        IF (DC-ELAPSED-MONTHS > 1)
 12536                      OR
 12537           ((DC-ELAPSED-MONTHS = 1)
 12538           AND (DC-ODD-DAYS-OVER > 0))
 12539           MOVE ER-2882          TO WS-ERROR
 12540           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12541        END-IF
 12542     END-IF
 12543     if dc-elapsed-months > 0
 12544        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12545        + dc-odd-days-over
 12546     end-if
 12547     IF PB-EXT-DAYS-PROCESSING
 12548        CONTINUE
 12549     ELSE
 12550        IF DC-ELAPSED-MONTHS = +0
 12551           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12552        ELSE
 12553           IF (WS-LF-EARNINGS-CALC = '4')
 12554              AND (DC-ELAPSED-MONTHS > ZERO)
 12555              AND (DC-ELAPSED-DAYS > ZERO)
 12556              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12557           ELSE
 12558              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12559                                 THRU 6499-EXIT
 12560              MOVE WS-ODD-DAYS-OVER
 12561                                 TO PB-I-EXTENTION-DAYS
 12562           END-IF
 12563        END-IF
 12564     END-IF
 12565******************************************************************
 12566*                                                                *
 12567*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12568*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12569*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12570*            AND ANY ODD DAYS.                                   *
 12571*                                                                *
 12572******************************************************************
 12573
 12574     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12575                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12576     IF WS-LF-EARNINGS-CALC NOT = '4'
 12577        IF DC-ELAPSED-DAYS > ZEROS
 12578           MOVE ER-2681          TO WS-ERROR
 12579           PERFORM 9900-ERROR-FORMAT
 12580                                 THRU 9900-EXIT
 12581        END-IF
 12582     END-IF
 12583
 12584     IF WS-LF-EARNINGS-CALC NOT = '4'
 12585        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12586           MOVE ER-2681          TO WS-ERROR
 12587           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12588
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 230
* EL050.cbl
 12589     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12590        (PB-I-LF-TERM NOT = ZERO) AND
 12591         NOT NO-LIFE-COVERAGE
 12592          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12593          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12594          IF WS-LF-EARNINGS-CALC = '4'
 12595             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12596             PB-I-PAY-FREQUENCY
 12597          END-IF
 12598          MOVE ZERO              TO DC-ELAPSED-DAYS
 12599                                    DC-ODD-DAYS-OVER
 12600          MOVE 1                 TO DC-END-OF-MONTH
 12601          SET BIN-PLUS-ELAPSED        TO TRUE
 12602*         MOVE 6                 TO DC-OPTION-CODE
 12603          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12604          IF NO-CONVERSION-ERROR
 12605             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12606             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12607                (WS-LF-SPECIAL-CALC-CD = 'L')
 12608                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12609                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12610                  MOVE +1             TO DC-ELAPSED-MONTHS
 12611                  SET BIN-PLUS-ELAPSED  TO TRUE
 12612*                 MOVE 6              TO DC-OPTION-CODE
 12613                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12614                  IF NO-CONVERSION-ERROR
 12615                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12616
 12617* okay, i had to move the new att age edit down here because the
 12618* expiration date could get recalculated and i need the exp date
 12619     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12620        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12621        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12622        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12623           AND ZEROS
 12624           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12625           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12626           SET ELAPSED-BETWEEN-BIN TO TRUE
 12627           PERFORM 8500-DATE-CONVERT
 12628                                 THRU 8500-EXIT
 12629           IF NO-CONVERSION-ERROR
 12630              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12631                 MOVE ER-2669       TO WS-ERROR
 12632*                PERFORM 9900-ERROR-FORMAT
 12633*                                THRU 9900-EXIT
 12634              END-IF
 12635           END-IF
 12636        ELSE
 12637           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12638           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12639              MOVE ER-2669       TO WS-ERROR
 12640*             PERFORM 9900-ERROR-FORMAT
 12641*                                THRU 9900-EXIT
 12642           ELSE
 12643              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12644                 MOVE ER-1570    TO WS-ERROR
 12645                 PERFORM 9900-ERROR-FORMAT
 12646                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 231
* EL050.cbl
 12647              END-IF
 12648           END-IF
 12649        END-IF
 12650        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12651           AND ZEROS
 12652           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12653           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12654           SET ELAPSED-BETWEEN-BIN TO TRUE
 12655           PERFORM 8500-DATE-CONVERT
 12656                                 THRU 8500-EXIT
 12657           IF NO-CONVERSION-ERROR
 12658              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12659                 MOVE ER-2669       TO WS-ERROR
 12660*                PERFORM 9900-ERROR-FORMAT
 12661*                                THRU 9900-EXIT
 12662              END-IF
 12663           END-IF
 12664        ELSE
 12665           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12666             (PB-I-LF-TERM / 12)
 12667           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12668              MOVE ER-2669       TO WS-ERROR
 12669*             PERFORM 9900-ERROR-FORMAT
 12670*                                THRU 9900-EXIT
 12671           ELSE
 12672              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12673                 MOVE ER-1571    TO WS-ERROR
 12674                 PERFORM 9900-ERROR-FORMAT
 12675                                 THRU 9900-EXIT
 12676              END-IF
 12677           END-IF
 12678        END-IF
 12679        IF WS-ERROR = ER-2669
 12680           PERFORM 9900-ERROR-FORMAT
 12681                                 THRU 9900-EXIT
 12682        END-IF
 12683     END-IF
 12684     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12685        (PB-I-AH-TERM NOT = ZERO) AND
 12686         NOT NO-AH-COVERAGE
 12687          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12688             AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 12689             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12690             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12691          ELSE
 12692             IF WS-LF-EARNINGS-CALC = '4'
 12693                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12694                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12695                PB-I-PAY-FREQUENCY
 12696             ELSE
 12697                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12698                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12699             END-IF
 12700          END-IF
 12701          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12702                                         DC-ODD-DAYS-OVER
 12703          MOVE 1                      TO DC-END-OF-MONTH
 12704          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 232
* EL050.cbl
 12705*         MOVE 6                      TO DC-OPTION-CODE
 12706          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12707          IF NO-CONVERSION-ERROR
 12708             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12709     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12710        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12711        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12712        IF PB-I-BIRTHDAY > LOW-VALUES
 12713           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12714           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12715           SET ELAPSED-BETWEEN-BIN TO TRUE
 12716           PERFORM 8500-DATE-CONVERT
 12717                                 THRU 8500-EXIT
 12718           IF NO-CONVERSION-ERROR
 12719              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12720                 MOVE ER-3054       TO WS-ERROR
 12721*                PERFORM 9900-ERROR-FORMAT
 12722*                                THRU 9900-EXIT
 12723              END-IF
 12724           END-IF
 12725        ELSE
 12726           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12727           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12728              MOVE ER-3054       TO WS-ERROR
 12729*             PERFORM 9900-ERROR-FORMAT
 12730*                                THRU 9900-EXIT
 12731           END-IF
 12732        END-IF
 12733        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12734           AND ZEROS
 12735           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12736           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12737           SET ELAPSED-BETWEEN-BIN TO TRUE
 12738           PERFORM 8500-DATE-CONVERT
 12739                                 THRU 8500-EXIT
 12740           IF NO-CONVERSION-ERROR
 12741              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12742                 MOVE ER-3054       TO WS-ERROR
 12743*                PERFORM 9900-ERROR-FORMAT
 12744*                                THRU 9900-EXIT
 12745              END-IF
 12746           END-IF
 12747        ELSE
 12748           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12749             (PB-I-AH-TERM / 12)
 12750           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12751              MOVE ER-3054       TO WS-ERROR
 12752*             PERFORM 9900-ERROR-FORMAT
 12753*                                THRU 9900-EXIT
 12754           END-IF
 12755        END-IF
 12756        IF WS-ERROR = ER-3054
 12757           PERFORM 9900-ERROR-FORMAT
 12758                                 THRU 9900-EXIT
 12759        END-IF
 12760     END-IF
 12761     MOVE SPACE                       TO DC-END-OF-MONTH.
 12762
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 233
* EL050.cbl
 12763     IF PB-COMPANY-ID = 'NCB'
 12764        GO TO 3040-EDIT-EXTENSION-DAYS.
 12765
 12766     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12767       AND
 12768        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12769        NEXT SENTENCE
 12770     ELSE
 12771        GO TO 3040-EDIT-EXTENSION-DAYS.
 12772
 12773     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12774        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12775        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12776     ELSE
 12777        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12778        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12779
 12780     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12781*    MOVE '1'      TO DC-OPTION-CODE
 12782     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12783     IF (NO-CONVERSION-ERROR)
 12784        AND (DC-ELAPSED-MONTHS > +1)
 12785        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12786        MOVE ER-2668   TO WS-ERROR
 12787        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12788
 12789 3040-EDIT-EXTENSION-DAYS.
 12790
 12791     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12792        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12793         GO TO 3050-EDIT-TERM-IN-DAYS
 12794     ELSE
 12795         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12796
 12797     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12798         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12799     ELSE
 12800        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12801           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12802           MOVE ER-2681         TO WS-ERROR
 12803           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12804
 12805     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12806        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12807        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12808         GO TO 3060-ORIG-TERM-CHECK.
 12809
 12810     GO TO 3060-ORIG-TERM-CHECK.
 12811
 12812 3050-EDIT-TERM-IN-DAYS.
 12813
 12814     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12815
 12816     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12817         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12818     ELSE
 12819         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12820            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 234
* EL050.cbl
 12821            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12822
 12823     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12824                                       REMAINDER WS-WORK-TERM.
 12825     IF WS-WORK-TERM GREATER THAN ZERO
 12826         ADD +1 TO PB-I-LF-TERM.
 12827
 12828     IF NOT NO-AH-COVERAGE
 12829         MOVE ER-2684            TO WS-ERROR
 12830         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12831
 12832
 12833 3060-ORIG-TERM-CHECK.
 12834
 12835******************************************************************
 12836*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12837******************************************************************
 12838
 12839     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12840        NEXT SENTENCE
 12841     ELSE
 12842        IF NOT NO-LIFE-COVERAGE
 12843           IF PB-I-LF-TERM NUMERIC
 12844              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12845              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12846              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12847                  NEXT SENTENCE
 12848           ELSE
 12849              MOVE ER-2647       TO WS-ERROR
 12850              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12851
 12852     IF NOT NO-AH-COVERAGE
 12853         IF PB-I-AH-TERM NUMERIC
 12854            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12855            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12856            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12857             NEXT SENTENCE
 12858          ELSE
 12859              MOVE ER-2658       TO WS-ERROR
 12860              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12861
 12862     IF PB-COMPANY-ID = 'NCB'
 12863        GO TO 3070-LOAN-TERM-CHECK.
 12864
 12865     IF POLICY-HAS-AH
 12866       AND
 12867        POLICY-HAS-LIFE
 12868       AND
 12869        PB-I-LF-TERM NUMERIC
 12870       AND
 12871        PB-I-AH-TERM NUMERIC
 12872        NEXT SENTENCE
 12873     ELSE
 12874        GO TO 3070-LOAN-TERM-CHECK.
 12875
 12876     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12877     IF WS-TEX-FACT-2 LESS THAN +0
 12878        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 235
* EL050.cbl
 12879
 12880     IF WS-TEX-FACT-2 GREATER THAN +1
 12881        MOVE ER-2668             TO WS-ERROR
 12882        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12883
 12884 3070-LOAN-TERM-CHECK.
 12885
 12886     IF (WS-LF-BENEFIT-CD = ZERO)
 12887         OR (NO-LF-BENEFIT-MATCH)
 12888            GO TO 3125-EDIT-PMT-FREQ.
 12889*    IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 12890*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12891*          AND 'V' AND 'W' AND 'X'
 12892*          GO TO 3125-EDIT-PMT-FREQ
 12893*       END-IF
 12894*    ELSE
 12895*       IF WS-AH-DCC-TRUNC = 'T'
 12896*          CONTINUE
 12897*       ELSE
 12898*          GO TO 3125-EDIT-PMT-FREQ
 12899*       END-IF
 12900*    END-IF
 12901     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12902                    OR
 12903        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 12904        AND (WS-AH-DCC-TRUNC = 'T'))
 12905        CONTINUE
 12906     ELSE
 12907        GO TO 3125-EDIT-PMT-FREQ
 12908     END-IF
 12909     IF PB-I-LOAN-TERM NOT NUMERIC
 12910         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12911
 12912     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12913        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12914*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12915        PB-I-LOAN-TERM NOT GREATER THAN +360
 12916         NEXT SENTENCE
 12917     ELSE
 12918         MOVE ER-2648            TO WS-ERROR
 12919         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12920
 12921     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12922        MOVE ER-3058             TO WS-ERROR
 12923        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12924     end-if
 12925
 12926     IF WS-STATE-ABBREVIATION = 'NC'
 12927        IF PB-I-LOAN-TERM > +59
 12928           CONTINUE
 12929        ELSE
 12930           MOVE ER-2792          TO WS-ERROR
 12931           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12932        END-IF
 12933     END-IF
 12934
 12935     .
 12936 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 236
* EL050.cbl
 12937     IF (WS-LF-BENEFIT-CD = ZERO)
 12938         OR (NO-LF-BENEFIT-MATCH)
 12939            GO TO 3127-EDIT-LOAN-OFFICER.
 12940     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12941                    OR
 12942        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 12943        AND (WS-AH-DCC-TRUNC = 'T'))
 12944                    OR
 12945         (PB-COMPANY-ID = 'AHL')
 12946        CONTINUE
 12947     ELSE
 12948        IF (PB-I-LOAN-TERM > ZEROS)
 12949           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12950           MOVE ER-1575          TO WS-ERROR
 12951           PERFORM 9900-ERROR-FORMAT
 12952                                 THRU 9900-EXIT
 12953        END-IF
 12954     END-IF
 12955     IF WS-LF-EARNINGS-CALC NOT = '4'
 12956         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12957            MOVE ER-2653         TO WS-ERROR
 12958            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12959            GO TO 3127-EDIT-LOAN-OFFICER
 12960         ELSE
 12961            GO TO 3127-EDIT-LOAN-OFFICER.
 12962
 12963     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12964         MOVE ER-2655            TO WS-ERROR
 12965         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12966         GO TO 3127-EDIT-LOAN-OFFICER.
 12967
 12968     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12969         MOVE ER-2654            TO WS-ERROR
 12970         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12971         GO TO 3127-EDIT-LOAN-OFFICER.
 12972
 12973     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12974         GIVING WS-TEX-FACT-2
 12975             REMAINDER WS-TEX-FACT-3.
 12976
 12977*    IF WS-TEX-FACT-3 NOT = ZERO
 12978*       MOVE ER-2654             TO WS-ERROR
 12979*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12980
 12981
 12982 3127-EDIT-LOAN-OFFICER.
 12983
 12984     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12985        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12986           MOVE ER-2690          TO WS-ERROR
 12987           PERFORM 9900-ERROR-FORMAT
 12988                                 THRU 9900-EXIT
 12989        ELSE
 12990           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12991           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12992           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12993           MOVE PB-SV-STATE      TO LOFC-STATE
 12994           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 237
* EL050.cbl
 12995           MOVE PB-I-LOAN-OFFICER
 12996                                 TO LOFC-CODE
 12997           PERFORM 8586-READ-LOAN-OFFICER
 12998                                 THRU 8586-EXIT
 12999           IF (NOT LOFC-MASTER-FOUND)
 13000              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 13001              MOVE ER-3006       TO WS-ERROR
 13002              PERFORM 9900-ERROR-FORMAT
 13003                                 THRU 9900-EXIT
 13004           END-IF
 13005        END-IF
 13006     END-IF
 13007     .
 13008 3129-EDIT-APR.
 13009
 13010     IF (WS-LF-BENEFIT-CD = ZERO)
 13011        OR (NO-LF-BENEFIT-MATCH)
 13012        IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 13013           GO TO 3130-EDIT-AGE
 13014*       ELSE
 13015*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 13016*             GO TO 3130-EDIT-AGE
 13017*          END-IF
 13018        END-IF
 13019     END-IF
 13020
 13021     IF (WS-STATE-ABBREVIATION = 'OH')
 13022         AND (PB-I-RATE-CLASS NOT = 'L ')
 13023         AND (PB-I-LF-TERM GREATER THAN 60)
 13024         AND (PB-CERT-EFF-DT GREATER WS-831031)
 13025         GO TO 3129-APR-CONT.
 13026
 13027     IF (WS-STATE-ABBREVIATION = 'RI')
 13028         AND (PB-I-LF-TERM GREATER THAN 60)
 13029         AND (PB-CERT-EFF-DT GREATER WS-831231)
 13030         GO TO 3129-APR-CONT.
 13031
 13032     IF (WS-STATE-ABBREVIATION = 'UT')
 13033         AND (PB-I-LF-TERM GREATER THAN 62)
 13034         AND (PB-CERT-EFF-DT GREATER WS-810831)
 13035         AND (PB-CERT-EFF-DT LESS WS-830901)
 13036         GO TO 3129-APR-CONT.
 13037
 13038     IF PB-COMPANY-ID = 'LAP'
 13039        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 13040           IF PB-I-LOAN-APR GREATER THAN ZEROS
 13041              MOVE ER-2656         TO WS-ERROR
 13042              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13043              GO TO 3130-EDIT-AGE.
 13044
 13045     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 13046        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 13047        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 13048        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13049        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 13050        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 13051         GO TO 3130-EDIT-AGE.
 13052
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 238
* EL050.cbl
 13053 3129-APR-CONT.
 13054     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 13055         (WS-LF-SPECIAL-CALC-CD = 'M'))
 13056         GO TO 3130-EDIT-AGE.
 13057
 13058     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 13059         WS-AH-BENEFIT-CD (1:1) = 'S')
 13060        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 13061        AND (PB-I-LOAN-APR = ZERO)
 13062        MOVE ER-2657             TO WS-ERROR
 13063        PERFORM 9900-ERROR-FORMAT
 13064                                 THRU 9900-EXIT
 13065        GO TO 3130-EDIT-AGE
 13066     END-IF
 13067*    IF PB-I-LOAN-APR = ZERO
 13068*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 13069*    END-IF
 13070
 13071     if pb-i-loan-apr = +99.9999
 13072        move er-2656             to ws-error
 13073        PERFORM 9900-ERROR-FORMAT
 13074                                 THRU 9900-EXIT
 13075        GO TO 3130-EDIT-AGE
 13076     end-if
 13077*    IF PB-I-LOAN-APR = ZERO
 13078*       MOVE ER-2656             TO WS-ERROR
 13079*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13080*       GO TO 3130-EDIT-AGE.
 13081
 13082*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 13083     if pb-i-loan-apr not = +99.9999
 13084        IF PB-I-LOAN-APR > +30.000
 13085           MOVE ER-2657          TO WS-ERROR
 13086           PERFORM 9900-ERROR-FORMAT
 13087                                 THRU 9900-EXIT
 13088        end-if
 13089     end-if
 13090     .
 13091 3130-EDIT-AGE.
 13092
 13093******************************************************************
 13094*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 13095******************************************************************
 13096
 13097     IF NOT NO-LIFE-COVERAGE
 13098        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13099           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 13100               MOVE ER-2628             TO WS-ERROR
 13101               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13102
 13103     IF NOT NO-AH-COVERAGE
 13104        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13105           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 13106               MOVE ER-2628         TO WS-ERROR
 13107               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13108
 13109 3133-SEX-CODE.
 13110     IF PB-I-INSURED-SEX = SPACE OR ZERO
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 239
* EL050.cbl
 13111         IF WS-DEFAULT-SEX = 'M'
 13112             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 13113          ELSE
 13114             IF WS-DEFAULT-SEX = 'F'
 13115             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 13116
 13117     IF PB-I-INSURED-SEX = '1'
 13118         MOVE 'M' TO PB-I-INSURED-SEX.
 13119
 13120     IF PB-I-INSURED-SEX = '2'
 13121         MOVE 'F' TO PB-I-INSURED-SEX.
 13122
 13123 3134-SIG-SW-EDIT.
 13124     IF PB-I-SIG-SW = SPACE
 13125         MOVE 'N'                TO  PB-I-SIG-SW.
 13126
 13127     IF PB-COMPANY-ID = 'NCL'
 13128         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 13129             NEXT SENTENCE
 13130         ELSE
 13131             MOVE ER-1923        TO  WS-ERROR
 13132             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13133     ELSE
 13134     IF PB-COMPANY-ID = 'CRI'
 13135         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 13136             NEXT SENTENCE
 13137         ELSE
 13138             MOVE ER-2606        TO  WS-ERROR
 13139             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13140     ELSE
 13141     IF PB-COMPANY-ID = 'TMS'
 13142         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 13143             NEXT SENTENCE
 13144         ELSE
 13145             MOVE ER-2689        TO  WS-ERROR
 13146             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13147     ELSE
 13148         IF PB-I-SIG-SW = 'Y' OR 'N'
 13149             NEXT SENTENCE
 13150         ELSE
 13151             MOVE ER-2651        TO  WS-ERROR
 13152             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13153
 13154     IF PB-COMPANY-ID = 'FLA'
 13155         IF (WS-EDIT-AGE GREATER 54  OR
 13156             WS-AH-EDIT-AGE GREATER 54)  AND
 13157            PB-I-SIG-SW = 'N'
 13158            MOVE ER-2651         TO  WS-ERROR
 13159            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13160
 13161 3135-NAME-EDIT.
 13162
 13163     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 13164        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 13165        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 13166           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 13167                                 TO PB-I-JOINT-FIRST-NAME
 13168        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 240
* EL050.cbl
 13169     END-IF
 13170     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 13171        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 13172        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 13173           MOVE PB-I-JOINT-LAST-NAME (2:14)
 13174                                 TO PB-I-JOINT-LAST-NAME
 13175        END-PERFORM
 13176     END-IF
 13177     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 13178        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 13179        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 13180           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 13181                                 TO PB-I-INSURED-FIRST-NAME
 13182        END-PERFORM
 13183     END-IF
 13184     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 13185        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 13186        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 13187           MOVE PB-I-INSURED-LAST-NAME (2:14)
 13188                                 TO PB-I-INSURED-LAST-NAME
 13189        END-PERFORM
 13190     END-IF
 13191     IF PB-I-INSURED-LAST-NAME = SPACES
 13192       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 13193       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 13194           MOVE ER-2660    TO WS-ERROR
 13195           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13196
 13197 3136-EDIT-SEX.
 13198
 13199******************************************************************
 13200*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 13201******************************************************************
 13202
 13203     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 13204        (WS-AH-SPECIAL-CALC-CD = 'O')
 13205        NEXT SENTENCE
 13206     ELSE
 13207        IF PB-I-INSURED-SEX = 'M' OR 'F'
 13208           NEXT SENTENCE
 13209        ELSE
 13210           MOVE ER-2629            TO WS-ERROR
 13211           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13212
 13213 3137-EDIT-EFF-DATE.
 13214
 13215     IF PB-REISSUED-CERT       OR
 13216        PB-POLICY-IS-DECLINED  OR
 13217        PB-POLICY-IS-VOIDED
 13218         GO TO 3139-EDIT-COVERAGE-CODES.
 13219
 13220     MOVE SPACE                  TO WS-2671-SW
 13221                                    WS-2672-SW.
 13222
 13223     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 13224         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 13225             MOVE ER-2703        TO WS-ERROR
 13226             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 241
* EL050.cbl
 13227             GO TO 3139-EDIT-COVERAGE-CODES.
 13228
 13229     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 13230         GO TO 3139-EDIT-COVERAGE-CODES.
 13231
 13232     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13233     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 13234*    MOVE '1'                    TO DC-OPTION-CODE.
 13235     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 13236     MOVE +0                     TO DC-ELAPSED-MONTHS
 13237                                    DC-ELAPSED-DAYS.
 13238     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13239
 13240     IF DATE-CONVERSION-ERROR
 13241         GO TO 3139-EDIT-COVERAGE-CODES.
 13242
 13243     IF DC-ELAPSED-DAYS GREATER +180
 13244         MOVE ER-2672            TO WS-ERROR
 13245         MOVE 'Y'                TO WS-2672-SW
 13246         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13247     END-IF
 13248
 13249     IF WS-ERROR = ER-2671  AND
 13250        PB-COMPANY-ID  = 'LBL'
 13251        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13252        MOVE SPACE               TO WS-2671-SW
 13253        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 13254
 13255     IF PB-ISSUE-DATE-FORCED  AND
 13256      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 13257         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 13258         MOVE ER-2673            TO WS-ERROR
 13259         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13260         MOVE SPACE              TO WS-2671-SW
 13261                                    WS-2672-SW.
 13262
 13263     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 13264         IF PB-ISSUE-DATE-FORCED
 13265             MOVE ER-2600          TO  WS-ERROR
 13266             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13267         ELSE
 13268             MOVE ER-2692          TO  WS-ERROR
 13269             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13270
 13271
 13272 3139-EDIT-COVERAGE-CODES.
 13273
 13274     if pb-company-id not = 'AHL'
 13275        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 13276           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 13277           MOVE ER-2787          TO WS-ERROR
 13278           PERFORM 9900-ERROR-FORMAT
 13279                                 THRU 9900-EXIT
 13280        END-IF
 13281     end-if
 13282     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13283        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 13284                                 > 250000.00
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 242
* EL050.cbl
 13285           MOVE ER-2719          TO WS-ERROR
 13286           PERFORM 9900-ERROR-FORMAT
 13287                                 THRU 9900-EXIT
 13288        END-IF
 13289     END-IF
 13290
 13291     IF PB-POLICY-IS-DECLINED  OR
 13292        PB-POLICY-IS-VOIDED
 13293         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13294
 13295     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 13296        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 13297         MOVE ER-2630                TO WS-ERROR
 13298         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13299
 13300     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 13301        PB-I-LF-BENEFIT-AMT = ZERO  AND
 13302        PB-I-LF-PREMIUM-AMT = ZERO
 13303         GO TO 3140-CHECK-AH-FOR-ZERO.
 13304
 13305     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 13306        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 13307        PB-I-LF-PREMIUM-AMT NOT = ZERO
 13308         GO TO 3140-CHECK-AH-FOR-ZERO.
 13309
 13310     IF (PB-I-LF-BENEFIT-CD = ZERO)
 13311        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13312        MOVE ER-2631             TO WS-ERROR
 13313        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13314     END-IF
 13315
 13316
 13317******************************************************************
 13318*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13319******************************************************************
 13320
 13321     IF WS-LF-SPECIAL-CALC-CD = 'O'
 13322        NEXT SENTENCE
 13323     ELSE
 13324        IF PB-I-LF-BENEFIT-AMT = ZERO
 13325           MOVE ER-2632             TO WS-ERROR
 13326           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13327
 13328
 13329******************************************************************
 13330*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13331******************************************************************
 13332
 13333     IF WS-LF-SPECIAL-CALC-CD = 'O'
 13334        CONTINUE
 13335     ELSE
 13336        IF PB-I-LF-PREMIUM-AMT = ZERO
 13337           IF (NOT PB-COMP-LF-PREM)
 13338              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13339              and (ws-lf-ben-category not = 'C')
 13340              MOVE ER-2633       TO WS-ERROR
 13341              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13342           END-IF
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 243
* EL050.cbl
 13343        END-IF
 13344     END-IF
 13345     .
 13346 3140-CHECK-AH-FOR-ZERO.
 13347
 13348     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 13349        PB-I-AH-BENEFIT-AMT = ZERO  AND
 13350        PB-I-AH-PREMIUM-AMT = ZERO
 13351         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13352
 13353     IF PB-COMPANY-ID = 'CSL'  AND
 13354        PB-I-AH-BENEFIT-CD = ZERO  AND
 13355        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 13356        PB-I-AH-PREMIUM-AMT = ZERO
 13357         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13358
 13359     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 13360        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 13361        PB-I-AH-PREMIUM-AMT NOT = ZERO
 13362         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13363
 13364     IF PB-I-AH-BENEFIT-CD = ZERO
 13365         MOVE ER-2634            TO WS-ERROR
 13366         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13367
 13368******************************************************************
 13369*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13370******************************************************************
 13371
 13372     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13373        NEXT SENTENCE
 13374     ELSE
 13375        IF PB-I-AH-BENEFIT-AMT = ZERO
 13376           MOVE ER-2635             TO WS-ERROR
 13377           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13378
 13379******************************************************************
 13380*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13381******************************************************************
 13382
 13383     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13384        NEXT SENTENCE
 13385     ELSE
 13386        IF PB-I-AH-PREMIUM-AMT = ZERO
 13387            IF NOT PB-COMP-AH-PREM
 13388                MOVE ER-2636    TO WS-ERROR
 13389                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13390
 13391
 13392 3140-EDIT-MAX-AMT-SIZES.
 13393* CUSTOM CODE FOR CLIENT    'DMD'
 13394     MOVE ZEROS                   TO WS-RES-STATE-TAX
 13395                                     WS-RES-MUNI-TAX
 13396                                     PB-I-STATE-TAX
 13397                                     PB-I-MUNI-TAX.
 13398
 13399     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 13400
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 244
* EL050.cbl
 13401     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 13402        GO TO 3150-RATE-OUTSTAND-BAL.
 13403
 13404     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 13405        GO TO 3150-RATE-OUTSTAND-BAL.
 13406
 13407     IF WS-LF-EARNINGS-CALC EQUAL '5'
 13408        GO TO 3150-RATE-OUTSTAND-BAL.
 13409
 13410     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 13411                             OR 'RIC')
 13412        GO TO 3150-RATE-OUTSTAND-BAL.
 13413
 13414     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 13415        IF PB-I-LOAN-APR GREATER THAN ZEROS
 13416            GO TO 3150-RATE-OUTSTAND-BAL
 13417        ELSE
 13418           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 13419               GO TO 3150-RATE-OUTSTAND-BAL.
 13420
 13421     IF NOT PB-NO-MONTHS-SKIPPED
 13422        GO TO 3150-RATE-OUTSTAND-BAL.
 13423
 13424     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 13425        GO TO 3150-RATE-OUTSTAND-BAL.
 13426
 13427     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 13428        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 13429           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 13430             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 13431           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 13432           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 13433              MOVE ER-2693     TO WS-ERROR
 13434              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13435              GO TO 3150-RATE-OUTSTAND-BAL
 13436           ELSE
 13437              GO TO 3150-RATE-OUTSTAND-BAL.
 13438
 13439 3150-RATE-OUTSTAND-BAL.
 13440
 13441* DMD RATING TEST
 13442     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13443         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13444         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13445         MOVE ER-2687                 TO WS-ERROR
 13446         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13447         MOVE 'B'                     TO PB-I-OB-FLAG
 13448         GO TO 3260-EDIT-CONTINUE.
 13449
 13450     IF  PB-COMPANY-ID   EQUAL    'CRI'
 13451         IF  WS-ERROR    EQUAL    ER-2693
 13452             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 13453                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13454                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13455                 MOVE  +0            TO  WS-ERROR.
 13456
 13457     IF  PB-COMPANY-ID   EQUAL    'CDL'
 13458         IF  WS-ERROR    EQUAL    ER-2693
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 245
* EL050.cbl
 13459             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 13460                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13461                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13462                 MOVE  +0            TO  WS-ERROR.
 13463
 13464     IF PLAN-MASTER-AH-SW = 'Y'
 13465        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13466            IF  WS-ERROR    EQUAL    ER-2693
 13467              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13468                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13469                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13470                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13471                 MOVE  ER-1910           TO  WS-ERROR
 13472                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13473
 13474     IF PLAN-MASTER-AH-SW = 'Y'
 13475        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13476            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13477               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13478               MOVE  ER-1910           TO  WS-ERROR
 13479               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13480
 13481     IF PLAN-MASTER-AH-SW = 'Y'
 13482        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13483            IF  WS-ERROR    EQUAL    ER-2693
 13484                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 13485                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13486                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13487                 MOVE  +0       TO  WS-ERROR.
 13488
 13489     IF WS-ERROR = ER-2693
 13490        IF PB-COMPANY-ID = 'JAL' AND
 13491           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 13492           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13493           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13494
 13495     IF WS-ERROR = ER-2693
 13496        IF PB-COMPANY-ID = 'NCL'  AND
 13497           PB-I-AH-BENEFIT-CD = 'OA'
 13498           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13499           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13500
 13501     IF WS-ERROR = ER-2693
 13502        IF PB-COMPANY-ID = 'CNL' AND
 13503           PB-I-LF-BENEFIT-CD = '71' OR '72'
 13504           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13505           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13506
 13507     IF WS-ERROR = ER-2693
 13508        IF PB-COMPANY-ID = 'HER'
 13509           IF WS-LEVEL
 13510              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13511              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13512
 13513     IF ((LF-BENEFIT-FOUND) AND
 13514         (NOT NO-LIFE-COVERAGE)  AND
 13515         (WS-LF-SPECIAL-CALC-CD = 'O'))
 13516       OR   ((AH-BENEFIT-FOUND) AND
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 246
* EL050.cbl
 13517             (NOT NO-AH-COVERAGE)    AND
 13518             (WS-AH-SPECIAL-CALC-CD = 'O'))
 13519         NEXT SENTENCE
 13520     ELSE
 13521         GO TO 3215-EDIT-RATES.
 13522
 13523     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13524        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13525           MOVE ER-2674          TO WS-ERROR
 13526           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13527           GO TO 3215-EDIT-RATES.
 13528
 13529     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13530        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13531           MOVE ER-2674          TO WS-ERROR
 13532           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13533           GO TO 3215-EDIT-RATES.
 13534
 13535     MOVE 'B'                    TO PB-I-OB-FLAG.
 13536
 13537     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13538         NEXT SENTENCE
 13539     ELSE
 13540         IF NOT NO-LIFE-COVERAGE
 13541             IF WS-ACCT-LF-OB-RT = ZERO
 13542                MOVE ER-2641    TO WS-ERROR
 13543                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13544
 13545     IF PB-COMPANY-ID = 'CRI'
 13546       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13547         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13548         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13549         IF WS-ERROR = ER-2675
 13550            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13551            MOVE ER-2687              TO WS-ERROR
 13552            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13553         ELSE
 13554            MOVE ER-2687              TO WS-ERROR
 13555            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13556
 13557
 13558     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13559         NEXT SENTENCE
 13560     ELSE
 13561       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13562            NEXT SENTENCE
 13563       ELSE
 13564         IF NOT NO-AH-COVERAGE
 13565             IF WS-ACCT-AH-OB-RT = ZERO
 13566                MOVE ER-2642    TO WS-ERROR
 13567                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13568
 13569     IF PB-COMPANY-ID = 'CRI'
 13570       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13571         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13572         IF WS-ERROR = ER-2676
 13573            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13574            MOVE ER-2687              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 247
* EL050.cbl
 13575            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13576         ELSE
 13577            MOVE ER-2687              TO WS-ERROR
 13578            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13579
 13580     IF PB-COMPANY-ID NOT = 'GIC'
 13581         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13582            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13583     ELSE
 13584         IF PB-I-LF-PREM-CALC = ZEROS
 13585             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13586                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13587
 13588     IF PB-COMPANY-ID NOT = 'GIC'
 13589         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13590            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13591     ELSE
 13592         IF PB-I-AH-PREM-CALC = ZEROS
 13593             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13594                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13595
 13596     MOVE ZEROS TO PB-I-MORT-CODE.
 13597
 13598     GO TO 3260-EDIT-CONTINUE.
 13599
 13600
 13601 3215-EDIT-RATES.
 13602     IF ACCOUNT-MAST-FOUND
 13603         NEXT SENTENCE
 13604     ELSE
 13605         GO TO 3999-END-EDIT.
 13606
 13607 3220-CHECK-LF-RATES.
 13608
 13609     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13610        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13611        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13612        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13613           AND (NOT WS-LF-CASH))
 13614                           OR
 13615           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13616           AND (NOT WS-AH-CASH)))
 13617                       AND
 13618           (PB-I-ENTRY-STATUS NOT = '5')
 13619           MOVE 'M'              TO PB-BATCH-ENTRY
 13620                                    PB-I-ENTRY-STATUS
 13621        END-IF
 13622     END-IF
 13623     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13624                                    PB-I-AH-PREM-CALC
 13625                                    PB-I-LF-ALT-PREM-CALC
 13626                                    PB-I-LF-ALT-RATE
 13627                                    PB-I-LF-REI-RATE
 13628                                    PB-I-LF-ALT-REI-RATE
 13629                                    PB-I-AH-REI-RATE
 13630                                    PB-I-TOT-FEES-CALC.
 13631
 13632     IF PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 248
* EL050.cbl
 13633        NEXT SENTENCE
 13634     ELSE
 13635        MOVE ZEROS               TO PB-I-LF-RATE
 13636                                    PB-I-AH-RATE.
 13637
 13638     IF PB-I-TOT-FEES NOT NUMERIC
 13639        MOVE ZEROS               TO PB-I-TOT-FEES
 13640     END-IF
 13641     IF PB-I-LIVES NOT NUMERIC
 13642         MOVE ZERO               TO PB-I-LIVES.
 13643
 13644     IF PB-I-NUM-BILLED NOT NUMERIC
 13645         MOVE ZERO               TO PB-I-NUM-BILLED.
 13646
 13647     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13648        MOVE +0                  TO PB-I-LF-PREM-TAX
 13649     END-IF
 13650
 13651     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13652        MOVE +0                  TO PB-I-AH-PREM-TAX
 13653     END-IF
 13654
 13655     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13656        PB-I-PAY-FREQUENCY = ZEROS
 13657            MOVE 12 TO CP-PAY-FREQUENCY
 13658     ELSE
 13659            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13660
 13661     IF PB-I-STATE-TAX NOT NUMERIC
 13662         MOVE ZEROS               TO PB-I-STATE-TAX.
 13663
 13664     IF PB-I-MUNI-TAX NOT NUMERIC
 13665         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13666
 13667     MOVE SPACES                 TO CP-BEN-CATEGORY
 13668     IF PB-COMPANY-ID  = 'CSL'  AND
 13669        PB-I-LF-TERM NOT = ZERO
 13670        COMPUTE WS-PAYMENT-AMT =
 13671             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13672        COMPUTE WS-CSL-AMT1 =
 13673             PB-I-LF-TERM * AM-MAX-MON-BEN
 13674        COMPUTE WS-CSL-AMT2 =
 13675             WS-PAYMENT-AMT * PB-I-LF-TERM
 13676        IF CP-PAY-FREQUENCY NOT = 12
 13677           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13678           MOVE '8' TO WS-CSL-CALC-CD
 13679        ELSE
 13680           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13681              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13682               AM-MAX-TOT-BEN
 13683               MOVE '6' TO WS-CSL-CALC-CD
 13684           ELSE
 13685              IF (WS-CSL-AMT1  GREATER THAN
 13686                 AM-MAX-TOT-BEN) AND
 13687                 (WS-CSL-AMT2  GREATER THAN
 13688                 AM-MAX-TOT-BEN)
 13689                 MOVE '7' TO WS-CSL-CALC-CD
 13690              ELSE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 249
* EL050.cbl
 13691                 MOVE '5' TO WS-CSL-CALC-CD.
 13692
 13693     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13694         NEXT SENTENCE
 13695     ELSE
 13696         GO TO 3300-CHECK-AH-RATES.
 13697
 13698*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13699
 13700     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13701        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13702              OR
 13703           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13704           MOVE ER-2618          TO WS-ERROR
 13705           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13706           GO TO 3300-CHECK-AH-RATES.
 13707
 13708     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13709           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13710                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13711
 13712     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13713         MOVE ER-2687             TO WS-ERROR
 13714         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13715         MOVE 'Z000'              TO PB-I-MORT-CODE
 13716         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13717         GO TO 3300-CHECK-AH-RATES.
 13718
 13719     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13720        IF PB-I-LIVES = ZERO
 13721           MOVE ER-2688          TO WS-ERROR
 13722           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13723
 13724     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13725
 13726     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13727     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13728     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13729     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13730     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13731     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13732     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13733     MOVE '3'                    TO CP-PROCESS-TYPE.
 13734     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13735     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13736
 13737******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13738     IF PB-COMPANY-ID EQUAL 'CDL'
 13739         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13740            CP-EARN-AS-NET-PAY)
 13741             IF PB-CERT-EFF-DT GREATER  WS-931231
 13742                 MOVE '1'        TO CP-EARNING-METHOD.
 13743*******
 13744
 13745     MOVE PB-SV-STATE            TO CP-STATE.
 13746     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13747     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13748     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 250
* EL050.cbl
 13749     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13750     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13751                                    CP-RATING-BENEFIT-AMT.
 13752     IF CP-STATE-STD-ABBRV = 'OR'
 13753         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13754                                         PB-I-LF-ALT-BENEFIT-AMT.
 13755     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13756     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13757     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13758     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13759     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13760     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13761     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13762     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13763     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13764                                    CP-REMAINING-TERM
 13765                                    CP-LOAN-TERM.
 13766
 13767     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13768         NEXT SENTENCE
 13769     ELSE
 13770         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13771             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13772                                           PB-I-LF-PREMIUM-AMT.
 13773
 13774     IF PB-COMPANY-ID EQUAL 'CSL'
 13775        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13776           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13777                                         PB-I-LF-PREMIUM-AMT.
 13778
 13779     IF PB-COMPANY-ID EQUAL 'NCB'
 13780         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13781            CP-EARN-AS-NET-PAY
 13782             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13783                 PB-I-LF-PREMIUM-AMT.
 13784
 13785     IF (CP-TRUNCATED-LIFE)
 13786        or ((pb-company-id = 'AHL')
 13787           and (pb-i-loan-term > pb-i-lf-term))
 13788        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13789
 13790     IF PB-COMPANY-ID EQUAL 'CRI'
 13791        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13792
 13793     IF CP-TERM-IS-DAYS
 13794         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13795     ELSE
 13796         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13797     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13798        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13799        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13800        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13801        IF WS-LF-BEN-CATEGORY = 'D'
 13802           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13803           MOVE PB-I-LIFE-COMMISSION
 13804                                 TO CP-DCC-ACT-COMM
 13805           MOVE WS-LF-BEN-CATEGORY
 13806                                 TO CP-BEN-CATEGORY
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 251
* EL050.cbl
 13807        END-IF
 13808        IF (CP-BENEFIT-CD (1:1) = 'P')
 13809           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13810           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13811           add pb-i-ah-premium-amt to cp-original-premium
 13812        END-IF
 13813     END-IF
 13814     IF PB-COMPANY-ID = 'CSL'
 13815         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13816         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13817         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13818
 13819     IF PB-COMPANY-ID = 'CSL'
 13820        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13821
 13822     IF (CP-SPECIAL-CALC-CD = 'H')
 13823        OR (PB-COMPANY-ID = 'DCC' or 'VPP')
 13824         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13825                                    TO CP-ALTERNATE-BENEFIT
 13826         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13827     if (pb-company-id = 'CID')
 13828        and (ws-lf-earnings-calc = '4')
 13829        and (cp-state-std-abbrv = 'MN' OR 'WA')
 13830        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13831        move pb-i-term-type      to cp-pmt-mode
 13832        move pb-i-no-of-payments to cp-no-of-pmts
 13833     end-if
 13834     move ws-net-only-state      to cp-net-only-state
 13835     IF (PB-COMPANY-ID = 'CID')
 13836        AND (WS-LF-EARNINGS-CALC = 'B')
 13837        AND (CP-STATE-STD-ABBRV = 'MN')
 13838        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13839                                 TO CP-ALTERNATE-BENEFIT
 13840        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13841     END-IF
 13842     IF (PB-COMPANY-ID = 'CID')
 13843        AND (WS-LF-EARNINGS-CALC = 'B')
 13844        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13845                                 TO CP-ALTERNATE-BENEFIT
 13846        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13847        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13848*       compute cp-original-benefit = pb-i-lf-benefit-amt -
 13849*         pb-i-lf-alt-premium-amt
 13850        MOVE WS-LF-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13851        IF WS-LF-BEN-CATEGORY = 'P'
 13852           MOVE WS-EXTRA-PMTS    TO CP-EXTRA-PERIODS
 13853        ELSE
 13854           IF WS-LF-BEN-CATEGORY = 'I'
 13855              MOVE WS-INT-PERIODS TO CP-EXTRA-PERIODS
 13856           END-IF
 13857        END-IF
 13858     END-IF
 13859     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13860     MOVE 'R'                   TO CP-RATE-FILE.
 13861     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13862
 13863     IF CP-ERROR-RATE-NOT-FOUND
 13864        MOVE ER-2641            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 252
* EL050.cbl
 13865        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13866        GO TO 3300-CHECK-AH-RATES.
 13867
 13868     IF PB-COMPANY-ID EQUAL 'CRI'
 13869        IF CP-ERROR-NO-LIMITS-CRI
 13870           IF NOT ACCOUNT-LIFE-CHECKED
 13871              MOVE ER-2607      TO WS-ERROR
 13872              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13873
 13874******************************************************************
 13875*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13876*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13877******************************************************************
 13878
 13879* CALC LIFE AGE AT EXPIRATION.
 13880
 13881     COMPUTE WS-AGE-AT-EXPIRE =
 13882          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13883
 13884*    IF PB-STATE = 'CO' OR 'UT'
 13885*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13886*        MOVE 'F'            TO PB-FATAL-FLAG
 13887*        MOVE ER-2709        TO WS-ERROR
 13888*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13889*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13890
 13891*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13892*        MOVE 'X'            TO PB-FATAL-FLAG
 13893*        MOVE ER-2718        TO WS-ERROR
 13894*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13895*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13896
 13897* CALC A & H AGE AT EXPIRATION.
 13898
 13899     COMPUTE WS-AGE-AT-EXPIRE =
 13900          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13901
 13902*    IF PB-STATE = 'CO' OR 'UT'
 13903*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13904*        MOVE 'F'            TO PB-FATAL-FLAG
 13905*        MOVE ER-2709        TO WS-ERROR
 13906*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13907*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13908
 13909*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13910*        MOVE 'X'            TO PB-FATAL-FLAG
 13911*        MOVE ER-2718        TO WS-ERROR
 13912*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13913*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13914
 13915     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13916        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13917
 13918     IF (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13919        and (not pb-monthly-cert)
 13920        GO TO 3221-CHECK-ERROR-RATE-OPEN
 13921     end-if
 13922
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 253
* EL050.cbl
 13923     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13924        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13925
 13926     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13927         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13928         MOVE ER-2639        TO WS-ERROR
 13929         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13930
 13931
 13932******************************************************************
 13933*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13934******************************************************************
 13935
 13936 PREMIUM-EDITING-IS-BYPASSED.
 13937     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13938        AND (CP-R-MAX-ATT-AGE > +0)
 13939        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13940        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13941           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13942           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13943           MOVE '1'              TO DC-OPTION-CODE
 13944           PERFORM 8500-DATE-CONVERT
 13945                                 THRU 8500-EXIT
 13946           IF NO-CONVERSION-ERROR
 13947              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13948                 MOVE ER-2661       TO WS-ERROR
 13949*                PERFORM 9900-ERROR-FORMAT
 13950*                                THRU 9900-EXIT
 13951              END-IF
 13952           END-IF
 13953        ELSE
 13954           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13955           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13956              MOVE ER-2661       TO WS-ERROR
 13957*             PERFORM 9900-ERROR-FORMAT
 13958*                                THRU 9900-EXIT
 13959           ELSE
 13960              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13961                 MOVE ER-1570    TO WS-ERROR
 13962                 PERFORM 9900-ERROR-FORMAT
 13963                                 THRU 9900-EXIT
 13964              END-IF
 13965           END-IF
 13966        END-IF
 13967        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13968           MOVE PB-I-JOINT-BIRTHDAY
 13969                                 TO DC-BIN-DATE-1
 13970           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13971           MOVE '1'              TO DC-OPTION-CODE
 13972           PERFORM 8500-DATE-CONVERT
 13973                                 THRU 8500-EXIT
 13974           IF NO-CONVERSION-ERROR
 13975              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13976                 MOVE ER-2661       TO WS-ERROR
 13977*                PERFORM 9900-ERROR-FORMAT
 13978*                                THRU 9900-EXIT
 13979              END-IF
 13980           ELSE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 254
* EL050.cbl
 13981              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13982           END-IF
 13983        ELSE
 13984           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13985             (PB-I-LF-TERM / 12)
 13986           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13987              MOVE ER-2661       TO WS-ERROR
 13988*             PERFORM 9900-ERROR-FORMAT
 13989*                                THRU 9900-EXIT
 13990           ELSE
 13991              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13992                 MOVE ER-1571    TO WS-ERROR
 13993                 PERFORM 9900-ERROR-FORMAT
 13994                                 THRU 9900-EXIT
 13995              END-IF
 13996           END-IF
 13997        END-IF
 13998        IF WS-ERROR = ER-2661
 13999           PERFORM 9900-ERROR-FORMAT
 14000                                 THRU 9900-EXIT
 14001        END-IF
 14002     END-IF
 14003*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14004*       MOVE ER-2661             TO WS-ERROR
 14005*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14006
 14007     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14008        MOVE ER-2662             TO WS-ERROR
 14009        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14010
 14011     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14012        MOVE ER-2677             TO WS-ERROR
 14013        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14014
 14015     IF CP-ERROR-LOAN-TERM
 14016        MOVE ER-2648             TO WS-ERROR
 14017        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14018
 14019 3221-CHECK-ERROR-RATE-OPEN.
 14020
 14021     IF CP-ERROR-RATE-FILE-NOTOPEN
 14022         GO TO 3990-FILES-NOT-OPEN.
 14023
 14024     IF PB-COMPANY-ID NOT = 'DMD'
 14025        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 14026     END-IF
 14027     .
 14028 3221-CONTINUE.
 14029     MOVE ZEROS                  TO WS-DCC-LF-RATE
 14030                                    WS-DCC-AH-RATE
 14031     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14032        IF WS-LF-BEN-CATEGORY = 'D'
 14033           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 14034              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14035        END-IF
 14036     END-IF
 14037     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 14038*   X'A4FF' = 12/31/2009
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 255
* EL050.cbl
 14039     IF (PB-COMPANY-ID = 'CID')
 14040        AND (WS-LF-EARNINGS-CALC = 'B')
 14041        AND (CP-STATE-STD-ABBRV = 'MN')
 14042        AND (PB-CERT-EFF-DT > X'A4FF')
 14043        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 14044     END-IF
 14045     MOVE ZEROS                  TO PB-I-LF-POLICY-FEE.
 14046
 14047     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 14048     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14049        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14050        AND (PB-I-POLICY-IS-MONTHLY)
 14051        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 14052        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 14053     END-IF
 14054     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 14055     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 14056     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 14057     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 14058     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14059        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 14060        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14061        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 14062        MOVE ER-2786             TO WS-ERROR
 14063        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14064     END-IF
 14065
 14066     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 14067
 14068******************************************************************
 14069*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 14070******************************************************************
 14071     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 14072        and ((not pb-monthly-cert)
 14073        or (ws-lf-ben-category = 'C'))
 14074        GO TO 3225-CHECK-ALT-LIFE-RATE.
 14075
 14076     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14077        GO TO 3225-CHECK-ALT-LIFE-RATE
 14078     ELSE
 14079       IF PB-I-LF-RATE = ZERO
 14080          MOVE ER-2641          TO WS-ERROR
 14081          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14082
 14083 3225-CHECK-ALT-LIFE-RATE.
 14084
 14085     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 14086        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 14087        (CP-SPECIAL-CALC-CD EQUAL 'H')
 14088         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 14089
 14090     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 14091         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 14092             AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
 14093                   OR
 14094              (PB-I-LF-ALT-PREMIUM-AMT > +0
 14095              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 14096              AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 256
* EL050.cbl
 14097             MOVE ER-2720        TO  WS-ERROR
 14098             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14099             GO TO 3225-RATING-CONT
 14100         ELSE
 14101             GO TO 3225-RATING-CONT.
 14102     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 14103        AND (AM-GPCD = 01 OR 06 OR 15)
 14104        MOVE ER-2798             TO WS-ERROR
 14105        PERFORM 9900-ERROR-FORMAT
 14106                                 THRU 9900-EXIT
 14107*       GO TO 3225-RATING-CONT
 14108     END-IF
 14109     if (pb-company-id = 'CID')
 14110        and (ws-lf-earnings-calc = 'B')
 14111        and (ws-lf-ben-category = 'P' or 'I')
 14112        and (ws-net-only-state = 'Y')
 14113        move cp-lf-balloon-prem  to pb-i-lf-alt-prem-calc
 14114        display ' balloon prem ' pb-i-lf-alt-prem-calc
 14115        go to 3225-rating-cont
 14116     end-if
 14117     IF (PB-COMPANY-ID = 'CID')
 14118        AND (WS-LF-EARNINGS-CALC = 'B')
 14119        AND (CP-STATE-STD-ABBRV = 'MN')
 14120        AND (PB-CERT-EFF-DT > X'A4FF')
 14121        GO TO 3225-RATING-CONT
 14122     END-IF
 14123     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14124        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14125           AND (PB-I-POLICY-IS-MONTHLY)
 14126           GO TO 3225-RATING-CONT
 14127        END-IF
 14128     END-IF
 14129
 14130     IF PB-COMPANY-ID EQUAL 'WDS' AND
 14131        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 14132        CP-EARN-AS-REG-BALLOON
 14133        NEXT SENTENCE
 14134     ELSE
 14135        MOVE '2'                 TO CP-EARNING-METHOD.
 14136
 14137 3225-SET-ALT-LIFE-RATE-LOOKUP.
 14138
 14139     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14140
 14141     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 14142        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 14143        (CP-SPECIAL-CALC-CD EQUAL 'H')
 14144         NEXT SENTENCE
 14145     ELSE
 14146         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 14147
 14148     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14149     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14150     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14151                                     CP-RATING-BENEFIT-AMT.
 14152     IF CP-STATE-STD-ABBRV = 'OR'
 14153         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14154                                         PB-I-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 257
* EL050.cbl
 14155     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14156        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14157     END-IF
 14158     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14159     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14160     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14161                                    CP-REMAINING-TERM
 14162                                    CP-LOAN-TERM.
 14163     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14164        ADD +1                   TO CP-ORIGINAL-TERM
 14165                                    CP-REMAINING-TERM
 14166                                    CP-LOAN-TERM.
 14167
 14168     MOVE 'R'                   TO CP-RATE-FILE.
 14169     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14170
 14171     IF CP-ERROR-RATE-NOT-FOUND
 14172         MOVE ER-2641            TO WS-ERROR
 14173         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14174         GO TO 3300-CHECK-AH-RATES.
 14175
 14176     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 14177     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 14178
 14179     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 14180         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 14181
 14182     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 14183                               + PB-I-LF-ALT-BENEFIT-AMT.
 14184
 14185     IF ACCOUNT-LIFE-CHECKED  OR
 14186        PB-POLICY-IS-VOIDED   OR
 14187        ((WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 14188        and (not pb-monthly-cert))
 14189        GO TO 3225-CONTINUE.
 14190
 14191     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14192        GO TO 3225-CONTINUE.
 14193
 14194     IF WS-LF-BENEFIT-AMT  GREATER THAN
 14195                             EC-RT-LF-MAX-TOT-BEN
 14196        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 14197        MOVE ER-2639       TO WS-ERROR
 14198        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14199
 14200 3225-CONTINUE.
 14201     IF PB-I-LF-ALT-RATE = ZERO
 14202         MOVE ER-2659            TO WS-ERROR
 14203         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14204
 14205     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 14206        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 14207        MOVE ER-2698             TO WS-ERROR
 14208        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14209
 14210 3225-RATING-CONT.
 14211
 14212     IF (WS-LF-SPECIAL-CALC-CD = 'E')
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 258
* EL050.cbl
 14213        and (not pb-monthly-cert)
 14214         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 14215         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 14216         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14217            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14218            CONTINUE
 14219         ELSE
 14220            MOVE ER-2687         TO WS-ERROR
 14221            PERFORM 9900-ERROR-FORMAT
 14222                                 THRU 9900-EXIT
 14223         END-IF
 14224         GO TO 3290-EDIT-LF-REIN-RATE
 14225     END-IF
 14226
 14227* DMD RATING TEST
 14228     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14229         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 14230         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 14231         MOVE ER-2687                 TO WS-ERROR
 14232         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14233         GO TO 3290-EDIT-LF-REIN-RATE.
 14234
 14235 3230-CLIENT-MORT-CD-SPECIALS.
 14236
 14237     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 14238     SET BIN-TO-GREG          TO TRUE.
 14239*    MOVE ' '                 TO DC-OPTION-CODE.
 14240     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14241     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 14242
 14243 C-POS-3230-MORT-CD.
 14244     IF PB-COMPANY-ID = 'POS' AND
 14245        PB-SV-CARRIER = '2'
 14246         NEXT SENTENCE
 14247     ELSE
 14248         GO TO C-POS-3240-MORT-CD.
 14249
 14250     IF PB-SV-GROUPING = '030'
 14251        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 14252         MOVE '2350' TO PB-I-MORT-CODE
 14253      ELSE
 14254         MOVE '3300' TO PB-I-MORT-CODE.
 14255
 14256
 14257 C-POS-3240-MORT-CD.
 14258     IF PB-COMPANY-ID = 'POS' AND
 14259        PB-SV-CARRIER = '1'
 14260         NEXT SENTENCE
 14261     ELSE
 14262         GO TO 3230-CONTINUE.
 14263
 14264     IF PB-SV-STATE = '45' OR '47'
 14265        OR PB-CERT-EFF-DT LESS THAN WS-771001
 14266         MOVE '5200' TO PB-I-MORT-CODE
 14267     ELSE
 14268         MOVE '8300' TO PB-I-MORT-CODE.
 14269
 14270 3230-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 259
* EL050.cbl
 14271
 14272     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 14273        GO TO 3240-CONTINUE
 14274     END-IF
 14275
 14276     IF PB-CERT-EFF-DT > WS-971231
 14277        GO TO 3240-CONTINUE
 14278     END-IF
 14279
 14280     IF LF-BENEFIT-FOUND AND
 14281        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 14282         MOVE 'F250'       TO PB-I-MORT-CODE
 14283     ELSE
 14284         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 14285             MOVE '7250'   TO PB-I-MORT-CODE
 14286         ELSE
 14287             MOVE '4251'   TO PB-I-MORT-CODE
 14288         END-IF
 14289     END-IF
 14290
 14291     .
 14292 3240-CONTINUE.
 14293
 14294     IF PB-COMPANY-ID NOT = 'GNL'
 14295         GO TO 3256-CONTINUE.
 14296
 14297     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 14298         MOVE 'A300' TO PB-I-MORT-CODE
 14299     ELSE
 14300         MOVE '8350' TO PB-I-MORT-CODE.
 14301
 14302 3256-CONTINUE.
 14303     IF PB-COMPANY-ID NOT = 'ABL'
 14304         GO TO 3260-EDIT-CONTINUE.
 14305
 14306     IF PB-I-LF-TERM GREATER THAN 59
 14307         MOVE 'F550' TO PB-I-MORT-CODE
 14308     ELSE
 14309         MOVE 'E550' TO PB-I-MORT-CODE.
 14310
 14311 3260-EDIT-CONTINUE.
 14312     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 14313
 14314 3290-EDIT-LF-REIN-RATE.
 14315     IF LF-REIN-NSP-NOT-USED
 14316         GO TO 3290-RATING-CONT.
 14317
 14318     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14319        GO TO 3290-RATING-CONT.
 14320     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 14321     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14322     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 14323     MOVE '3'                   TO CP-PROCESS-TYPE.
 14324     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14325
 14326******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 14327     IF PB-COMPANY-ID EQUAL 'CDL'
 14328         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 260
* EL050.cbl
 14329            CP-EARN-AS-NET-PAY)
 14330             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 14331*            MOVE SPACE          TO DC-OPTION-CODE
 14332             SET BIN-TO-GREG     TO TRUE
 14333             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 14334***  Y2K PROJ 7744
 14335             IF DC-GREG-DATE-CYMD GREATER 19931231
 14336                 MOVE '1'        TO CP-EARNING-METHOD.
 14337***  Y2K PROJ 7744
 14338*******
 14339
 14340     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14341     MOVE PB-SV-STATE           TO CP-STATE.
 14342     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 14343     MOVE ZERO                  TO CP-DEVIATION-CODE
 14344                                   CP-RATE-DEV-PCT.
 14345     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 14346     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 14347                                   CP-RATING-BENEFIT-AMT.
 14348
 14349************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 14350     IF PB-COMPANY-ID EQUAL 'NCB'
 14351         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 14352            CP-EARN-AS-NET-PAY
 14353             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14354                 PB-I-LF-PREMIUM-AMT.
 14355************
 14356
 14357     IF CP-STATE-STD-ABBRV = 'OR'
 14358         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14359                                         PB-I-LF-ALT-BENEFIT-AMT.
 14360     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 14361     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 14362     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 14363     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 14364     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 14365     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 14366     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 14367     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 14368                                   CP-REMAINING-TERM
 14369                                   CP-LOAN-TERM.
 14370     IF CP-TRUNCATED-LIFE
 14371        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 14372
 14373     IF CP-TERM-IS-DAYS
 14374         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 14375     ELSE
 14376         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14377
 14378     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14379        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14380     END-IF
 14381     IF PB-COMPANY-ID NOT = 'TIC'
 14382          MOVE ZERO          TO CP-CLASS-CODE.
 14383
 14384     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 14385
 14386     MOVE 'R'                   TO CP-RATE-FILE.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 261
* EL050.cbl
 14387     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14388
 14389     IF CP-ERROR-RATE-NOT-FOUND
 14390        IF PB-I-OB
 14391           MOVE ER-2625      TO WS-ERROR
 14392           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14393           GO TO 3299-EDIT-CONTINUE
 14394        ELSE
 14395           MOVE ER-2643      TO WS-ERROR
 14396           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14397           GO TO 3299-EDIT-CONTINUE.
 14398
 14399     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 14400
 14401     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 14402     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 14403
 14404     IF PB-I-LF-REI-RATE = ZERO
 14405         MOVE ER-2643        TO WS-ERROR
 14406         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14407
 14408 3290-CHECK-ALT-REIN-RATE.
 14409
 14410     IF WS-LF-EARNINGS-CALC NOT = 'B'
 14411        GO TO 3290-RATING-CONT.
 14412
 14413     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14414     MOVE '2'                    TO CP-EARNING-METHOD.
 14415     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 14416     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14417     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14418     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14419                                     CP-RATING-BENEFIT-AMT.
 14420     IF CP-STATE-STD-ABBRV = 'OR'
 14421         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14422                                         PB-I-LF-ALT-BENEFIT-AMT.
 14423     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14424        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14425     END-IF
 14426     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14427     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14428     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14429                                    CP-REMAINING-TERM
 14430                                    CP-LOAN-TERM.
 14431     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14432        ADD +1                   TO CP-ORIGINAL-TERM
 14433                                    CP-REMAINING-TERM
 14434                                    CP-LOAN-TERM.
 14435
 14436     MOVE 'R'                   TO CP-RATE-FILE.
 14437     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14438
 14439     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 14440
 14441     IF PB-I-LF-ALT-REI-RATE = ZERO
 14442         MOVE ER-2643            TO WS-ERROR
 14443         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14444
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 262
* EL050.cbl
 14445 3290-RATING-CONT.
 14446
 14447     IF PB-I-OB
 14448*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14449        GO TO 3300-CHECK-AH-RATES.
 14450
 14451 3299-EDIT-CONTINUE.
 14452
 14453     IF  PB-I-MORT-CODE GREATER THAN SPACES
 14454         NEXT SENTENCE
 14455     ELSE
 14456         MOVE ER-2620           TO WS-ERROR
 14457         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14458
 14459 3300-CHECK-AH-RATES.
 14460     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 14461         NEXT SENTENCE
 14462     ELSE
 14463         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14464
 14465     IF ((WS-AH-SPECIAL-CALC-CD = 'E')
 14466        and (not pb-monthly-cert))
 14467                  or
 14468        ((CF-COMPANY-ID = 'DMD') AND
 14469                (NO-DMD-RATING))
 14470         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14471            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14472            CONTINUE
 14473         ELSE
 14474            MOVE ER-2687         TO WS-ERROR
 14475            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14476         END-IF
 14477         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14478         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 14479     END-IF
 14480
 14481     IF PB-I-OB
 14482        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14483
 14484     IF WS-AH-SPECIAL-CALC-CD = 'M'
 14485         MOVE ER-2687             TO WS-ERROR
 14486         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14487         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14488         GO TO 3999-END-EDIT.
 14489
 14490*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 14491     if pb-company-id = 'AHL'
 14492        go to 3300-skip-crit-per
 14493     end-if
 14494     if (pb-i-ah-crit-per not = zeros)
 14495        and (ws-ah-special-calc-cd not = 'C')
 14496        MOVE ER-1572             TO WS-ERROR
 14497        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14498        go to 3300-skip-crit-per
 14499     END-IF
 14500     if (pb-company-id = 'DCC' or 'VPP')
 14501        and (am-dcc-product-code not = spaces)
 14502        go to 3300-skip-crit-per
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 263
* EL050.cbl
 14503     end-if
 14504     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 14505        IF PB-I-AH-CRIT-PER = ZERO
 14506           move ws-ah-max-bens   to pb-i-ah-crit-per
 14507*          MOVE ER-2618       TO WS-ERROR
 14508*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14509*          GO TO 3999-END-EDIT
 14510        END-IF
 14511     END-IF
 14512     if (ws-ah-special-calc-cd = 'C')
 14513        and (pb-i-ah-crit-per <> ws-ah-max-bens)
 14514        MOVE ER-1576             TO WS-ERROR
 14515        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14516     end-if
 14517
 14518     .
 14519 3300-skip-crit-per.
 14520     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14521     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14522     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14523     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14524     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14525     MOVE PB-SV-STATE            TO CP-STATE.
 14526     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14527     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 14528     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 14529*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14530     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14531     MOVE '3'                    TO CP-PROCESS-TYPE.
 14532     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14533     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14534                                    CP-RATING-BENEFIT-AMT.
 14535     IF PB-COMPANY-ID = 'CID'
 14536               OR
 14537        CP-STATE-STD-ABBRV = 'OR'
 14538         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14539                                         PB-I-AH-TERM.
 14540     IF PB-COMPANY-ID = 'DCC' or 'VPP' OR 'CID'
 14541        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 14542           AND (PB-I-POLICY-IS-MONTHLY)
 14543           MOVE PB-I-LF-BENEFIT-AMT
 14544                                 TO CP-NET-BENEFIT-AMT
 14545           move pb-i-ah-premium-amt to cp-original-premium
 14546           add pb-i-lf-premium-amt to cp-original-premium
 14547        END-IF
 14548     END-IF
 14549     MOVE SPACES                 TO CP-BEN-CATEGORY
 14550     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14551        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 14552        EVALUATE TRUE
 14553           WHEN (WS-AH-BEN-CATEGORY = 'G')
 14554              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14555              MOVE PB-I-LF-BENEFIT-AMT
 14556                                 TO CP-RATING-BENEFIT-AMT
 14557              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 14558           WHEN WS-AH-BEN-CATEGORY = 'G'
 14559              MOVE PB-I-UNPAID-CASH-PRICE
 14560                                 TO CP-RATING-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 264
* EL050.cbl
 14561           WHEN WS-AH-BEN-CATEGORY = 'D'
 14562              MOVE WS-AH-PMF-COMM
 14563                                 TO CP-DCC-PMF-COMM
 14564              MOVE PB-I-AH-COMMISSION
 14565                                 TO CP-DCC-ACT-COMM
 14566        END-EVALUATE
 14567     END-IF
 14568     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14569     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14570     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14571     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14572     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14573     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 14574     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14575                                    CP-REMAINING-TERM
 14576                                    WS-WORK-TERM.
 14577     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 14578
 14579     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14580     SET BIN-TO-GREG             TO TRUE.
 14581*    MOVE ' '                    TO DC-OPTION-CODE.
 14582     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14583     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 14584
 14585     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 14586     IF NOT VALID-SKIP-CODE
 14587         MOVE ER-2683            TO WS-ERROR
 14588         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14589         GO TO 3320-RATE-CONTINUE.
 14590
 14591     IF PB-NO-MONTHS-SKIPPED
 14592         GO TO 3320-RATE-CONTINUE.
 14593
 14594     MOVE SPACE TO NUMBER-OF-MONTHS.
 14595
 14596     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14597         MOVE 'S'                TO SK-MO (6).
 14598     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14599         MOVE 'S'                TO SK-MO (7).
 14600     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14601         MOVE 'S'                TO SK-MO (8).
 14602     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14603         MOVE 'S'                TO SK-MO (9).
 14604     IF PB-I-SKIP-CODE = 'A'
 14605         MOVE 'S'                TO SK-MO (10).
 14606
 14607     MOVE 1                      TO SUB2.
 14608     MOVE PB-I-AH-TERM           TO SUB3.
 14609     MOVE WS-MONTH               TO SUB1.
 14610     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14611     GO TO 3320-RATE-CONTINUE.
 14612
 14613 3310-GET-SKIP-MO.
 14614     IF SUB1 = 13
 14615         MOVE 1                  TO SUB1.
 14616
 14617     IF SK-MO (SUB1) = 'S'
 14618         SUBTRACT 1 FROM WS-WORK-TERM.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 265
* EL050.cbl
 14619
 14620     ADD 1 TO SUB2
 14621              SUB1.
 14622
 14623 3320-RATE-CONTINUE.
 14624
 14625     IF WS-WORK-TERM = ZERO
 14626         MOVE 1                  TO WS-WORK-TERM.
 14627
 14628     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14629                                    CP-LOAN-TERM.
 14630
 14631     IF PB-COMPANY-ID EQUAL 'DMD'
 14632         NEXT SENTENCE
 14633     ELSE
 14634         MOVE ZERO               TO PB-I-AH-RATE
 14635                                    PB-I-AH-REI-RATE.
 14636
 14637
 14638     IF PB-COMPANY-ID EQUAL 'CRI'
 14639        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14640
 14641     IF PB-COMPANY-ID = 'CSL'
 14642         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14643         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14644         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14645         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14646
 14647     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14648        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14649           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14650              PB-I-RATE-DEV-PCT-LF
 14651        END-IF
 14652        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14653                                 TO CP-ALTERNATE-BENEFIT
 14654        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14655        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14656        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14657     END-IF
 14658*    if ws-clp-state not = spaces
 14659*       move ws-clp-state to cp-state
 14660*    end-if
 14661     IF (PB-COMPANY-ID = 'CID')
 14662        AND (WS-LF-EARNINGS-CALC = 'B')
 14663        AND (CP-STATE-STD-ABBRV = 'MN')
 14664        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14665     ELSE
 14666        MOVE ' '                 TO CP-AH-BALLOON-SW
 14667     END-IF
 14668     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14669     MOVE 'R'                   TO CP-RATE-FILE.
 14670     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14671
 14672     IF (CP-ERROR-RATE-NOT-FOUND)
 14673        and (not pb-monthly-cert)
 14674        IF PB-I-OB
 14675           MOVE ER-2624          TO WS-ERROR
 14676           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 266
* EL050.cbl
 14677           GO TO 3340-CALCULATE-PREMIUM-AMT
 14678        ELSE
 14679          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14680              NEXT SENTENCE
 14681          ELSE
 14682           MOVE ER-2642          TO WS-ERROR
 14683           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14684           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14685
 14686     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14687        CP-ERROR-DIV-BY-ZERO
 14688           MOVE ER-3782          TO WS-ERROR
 14689           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14690
 14691     IF PB-COMPANY-ID EQUAL 'CRI'
 14692        IF CP-ERROR-NO-LIMITS-CRI
 14693           IF NOT ACCOUNT-AH-CHECKED
 14694              MOVE ER-2607          TO WS-ERROR
 14695              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14696
 14697     IF ACCOUNT-AH-CHECKED
 14698        NEXT SENTENCE
 14699     ELSE
 14700       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14701          MOVE ER-2640           TO WS-ERROR
 14702          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14703
 14704     IF PB-COMPANY-ID = 'CRI'
 14705         IF WS-ERROR = ER-2640
 14706             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14707     IF ACCOUNT-AH-CHECKED
 14708        CONTINUE
 14709     ELSE
 14710        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14711           AND (CP-R-MAX-ATT-AGE > +0)
 14712           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14713           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14714              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14715              MOVE PB-I-AH-EXPIRE-DT
 14716                                 TO DC-BIN-DATE-2
 14717              MOVE '1'           TO DC-OPTION-CODE
 14718              PERFORM 8500-DATE-CONVERT
 14719                                 THRU 8500-EXIT
 14720              IF NO-CONVERSION-ERROR
 14721                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14722                    MOVE ER-2661       TO WS-ERROR
 14723*                   PERFORM 9900-ERROR-FORMAT
 14724*                                THRU 9900-EXIT
 14725                 END-IF
 14726              END-IF
 14727           ELSE
 14728              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14729              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14730                 MOVE ER-2661    TO WS-ERROR
 14731*                PERFORM 9900-ERROR-FORMAT
 14732*                                THRU 9900-EXIT
 14733              ELSE
 14734                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 267
* EL050.cbl
 14735                    MOVE ER-1570 TO WS-ERROR
 14736                    PERFORM 9900-ERROR-FORMAT
 14737                                 THRU 9900-EXIT
 14738                 END-IF
 14739              END-IF
 14740           END-IF
 14741           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14742              MOVE PB-I-JOINT-BIRTHDAY
 14743                                    TO DC-BIN-DATE-1
 14744              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14745              MOVE '1'              TO DC-OPTION-CODE
 14746              PERFORM 8500-DATE-CONVERT
 14747                                    THRU 8500-EXIT
 14748              IF NO-CONVERSION-ERROR
 14749                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14750                    MOVE ER-2661       TO WS-ERROR
 14751*                   PERFORM 9900-ERROR-FORMAT
 14752*                                   THRU 9900-EXIT
 14753                 END-IF
 14754              END-IF
 14755           ELSE
 14756              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14757                (PB-I-AH-TERM / 12)
 14758              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14759                 MOVE ER-2661       TO WS-ERROR
 14760*                PERFORM 9900-ERROR-FORMAT
 14761*                                   THRU 9900-EXIT
 14762              ELSE
 14763                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14764                    MOVE ER-1571 TO WS-ERROR
 14765                    PERFORM 9900-ERROR-FORMAT
 14766                                 THRU 9900-EXIT
 14767                 END-IF
 14768              END-IF
 14769           END-IF
 14770           IF WS-ERROR = ER-2661
 14771              PERFORM 9900-ERROR-FORMAT
 14772                                    THRU 9900-EXIT
 14773           END-IF
 14774        END-IF
 14775     END-IF
 14776*    IF ACCOUNT-AH-CHECKED
 14777*       NEXT SENTENCE
 14778*    ELSE
 14779*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14780*          MOVE ER-2661          TO WS-ERROR
 14781*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14782
 14783     IF ACCOUNT-AH-CHECKED
 14784        NEXT SENTENCE
 14785     ELSE
 14786        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14787           MOVE ER-2663          TO WS-ERROR
 14788           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14789
 14790     IF ACCOUNT-AH-CHECKED OR
 14791        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14792         PB-POLICY-IS-VOIDED
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 268
* EL050.cbl
 14793        NEXT SENTENCE
 14794     ELSE
 14795        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 14796           MOVE ER-2667            TO WS-ERROR
 14797           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14798
 14799     IF PB-COMPANY-ID = 'CRI'
 14800         IF WS-ERROR = ER-2667
 14801             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14802
 14803     IF ACCOUNT-AH-CHECKED
 14804        NEXT SENTENCE
 14805     ELSE
 14806        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14807           MOVE ER-2678            TO WS-ERROR
 14808           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14809
 14810     IF CP-ERROR-RATE-FILE-NOTOPEN
 14811         GO TO 3990-FILES-NOT-OPEN.
 14812
 14813 3321-CONTINUE.
 14814     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14815     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14816     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14817*    IF (PB-COMPANY-ID = 'DCC')
 14818        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14819        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14820                                    PB-I-LF-ALT-PREM-CALC
 14821        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14822        IF WS-AH-BEN-CATEGORY = 'G'
 14823           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14824           + PB-I-ADDL-CLP)
 14825           * (1 + WS-TOL-CLP-PCT)
 14826*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14827        ELSE
 14828           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14829           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14830*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14831        END-IF
 14832        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14833                                 TO PB-I-AH-PREM-CALC
 14834        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14835           MOVE ER-8152          TO WS-ERROR
 14836           PERFORM 9900-ERROR-FORMAT
 14837                                 THRU 9900-EXIT
 14838        ELSE
 14839           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14840                 PB-I-ADDL-CLP)
 14841              MOVE ER-8148       TO WS-ERROR
 14842              PERFORM 9900-ERROR-FORMAT
 14843                                 THRU 9900-EXIT
 14844           END-IF
 14845        END-IF
 14846     END-IF
 14847     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14848        AND (PB-I-POLICY-IS-MONTHLY)
 14849        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14850        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 269
* EL050.cbl
 14851        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14852           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14853        END-IF
 14854     END-IF
 14855     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14856        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14857        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14858        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14859        MOVE ER-2786             TO WS-ERROR
 14860        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14861     END-IF
 14862     MOVE +0                     TO PB-I-AH-CLP
 14863     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14864        evaluate true
 14865           when WS-AH-BEN-CATEGORY = 'D'
 14866              COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT
 14867                * (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14868           when WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14869              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14870           when WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14871              compute ws-cred-union-fees rounded =
 14872                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14873                    pb-i-ah-commission)
 14874              COMPUTE PB-I-AH-CLP =
 14875                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14876        end-evaluate
 14877     END-IF
 14878     MOVE CP-CANCEL-FEE          TO PB-I-CANCEL-FEE
 14879
 14880     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14881         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14882
 14883     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14884         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14885
 14886     if (ws-ah-special-calc-cd = 'E')
 14887        and (pb-monthly-cert)
 14888        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14889     end-if
 14890     IF PB-COMPANY-ID = 'CRI'
 14891         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14892            PB-I-PAYMENT-AMOUNT = ZERO
 14893             NEXT SENTENCE
 14894         ELSE
 14895             COMPUTE PB-I-AH-PREM-CALC =
 14896                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14897                 (CP-PREMIUM-RATE / 100)
 14898             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14899                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14900                                             PB-I-RATE-DEV-PCT-AH.
 14901
 14902     IF (PB-I-AH-RATE  = ZERO)
 14903        and (not pb-monthly-cert)
 14904       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14905           NEXT SENTENCE
 14906       ELSE
 14907         MOVE ER-2642            TO WS-ERROR
 14908         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 270
* EL050.cbl
 14909
 14910     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14911     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14912     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14913     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14914     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14915     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14916
 14917     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14918        AND (WS-AH-BEN-CATEGORY = 'G')
 14919        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14920        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14921        IF CP-DEVIATION-CODE NOT = '000'
 14922           MOVE '000'            TO CP-DEVIATION-CODE
 14923           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14924           IF NO-CP-ERROR
 14925              COMPUTE PB-I-DDF-IU-RATE-UP =
 14926              PB-I-AH-CLP - CP-CALC-PREMIUM
 14927           ELSE
 14928              MOVE ER-3057        TO WS-ERROR
 14929              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14930           END-IF
 14931        END-IF
 14932     END-IF
 14933     .
 14934 3335-EDIT-AH-REIN-NSP-RATE.
 14935     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14936        if WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14937              compute ws-cred-union-fees rounded =
 14938                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14939                    pb-i-ah-commission)
 14940              COMPUTE PB-I-AH-CLP =
 14941                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14942        end-if
 14943     END-IF
 14944     IF AH-REIN-NSP-NOT-USED
 14945         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14946
 14947     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14948     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14949         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14950     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14951     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14952     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14953     MOVE PB-SV-STATE            TO CP-STATE.
 14954     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14955     MOVE ZERO                   TO CP-DEVIATION-CODE
 14956                                    CP-RATE-DEV-PCT.
 14957*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14958     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14959     MOVE '3'                    TO CP-PROCESS-TYPE.
 14960     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14961     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14962                                    CP-RATING-BENEFIT-AMT.
 14963     IF CP-STATE-STD-ABBRV = 'OR'
 14964         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14965                                         PB-I-AH-TERM.
 14966     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 271
* EL050.cbl
 14967     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14968     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14969     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14970     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14971     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14972                                    CP-REMAINING-TERM
 14973                                    WS-WORK-TERM.
 14974     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14975     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14976        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14977     END-IF
 14978     IF  PB-COMPANY-ID = 'TIC'
 14979         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14980            MOVE ZERO TO CP-CLASS-CODE.
 14981
 14982     IF PB-COMPANY-ID NOT = 'TIC'
 14983          MOVE ZERO          TO CP-CLASS-CODE.
 14984
 14985     MOVE ZERO               TO CP-DEVIATION-CODE.
 14986
 14987     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14988
 14989     MOVE ZERO               TO PB-I-AH-REI-RATE.
 14990
 14991     MOVE 'R'                   TO CP-RATE-FILE.
 14992     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14993
 14994     IF CP-ERROR-RATE-NOT-FOUND
 14995         MOVE ER-2645        TO WS-ERROR
 14996         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14997         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14998
 14999     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 15000
 15001     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 15002     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 15003
 15004     IF PB-I-AH-REI-RATE = ZERO
 15005         MOVE ER-2645        TO WS-ERROR
 15006         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15007
 15008
 15009 3340-CALCULATE-PREMIUM-AMT.
 15010
 15011     IF PB-COMPANY-ID = 'NCL'
 15012         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 15013             WS-AH-SPECIAL-CALC-CD = 'O')
 15014             GO TO 3999-END-EDIT.
 15015
 15016     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 15017                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 15018                        'TMS' OR 'GTL' OR 'CID' OR 'DCC' or 'VPP'
 15019                         OR 'AHL'
 15020         NEXT SENTENCE
 15021     ELSE
 15022         IF WS-STATE-ABBREVIATION = 'CT'
 15023             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 15024                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 272
* EL050.cbl
 15025                 COMPUTE PB-I-LF-PREM-CALC =
 15026                                     PB-I-LF-PREM-CALC * .90
 15027                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 15028                                     PB-I-LF-ALT-PREM-CALC * .90
 15029                 COMPUTE PB-I-AH-PREM-CALC =
 15030                                     PB-I-AH-PREM-CALC * .90.
 15031
 15032     IF PB-COMP-LF-PREM
 15033        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 15034        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 15035
 15036     IF PB-COMP-AH-PREM
 15037        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 15038
 15039 3340-CHECK-DCC-TOT-FEES.
 15040     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 15041        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 15042        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 15043        AND (PB-I-POLICY-IS-MONTHLY)
 15044        CONTINUE
 15045     ELSE
 15046        GO TO 3340-EDIT-LF-AH-TOL
 15047     END-IF
 15048     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 15049     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 15050     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 15051        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 15052           PB-I-RATE-DEV-PCT-LF
 15053     END-IF
 15054     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 15055        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 15056           PB-I-RATE-DEV-PCT-AH
 15057     END-IF
 15058     MOVE 'N'                    TO CP-BEN-CATEGORY
 15059     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15060
 15061     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 15062     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 15063     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 15064     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15065     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 15066     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15067     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15068     MOVE '3'                    TO CP-PROCESS-TYPE.
 15069     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15070     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 15071
 15072     MOVE PB-SV-STATE            TO CP-STATE.
 15073     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 15074     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 15075     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 15076     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 15077     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 15078                                    CP-RATING-BENEFIT-AMT.
 15079     IF CP-STATE-STD-ABBRV = 'OR'
 15080         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 15081                                         PB-I-LF-ALT-BENEFIT-AMT.
 15082     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 273
* EL050.cbl
 15083     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 15084     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 15085     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15086     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15087     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15088     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 15089     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 15090     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 15091                                    CP-REMAINING-TERM
 15092                                    CP-LOAN-TERM.
 15093     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 15094        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 15095           PB-I-LF-PREMIUM-AMT
 15096     end-if
 15097
 15098     IF CP-TRUNCATED-LIFE
 15099        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 15100
 15101     IF CP-TERM-IS-DAYS
 15102         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 15103     ELSE
 15104         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15105
 15106     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15107     IF CP-SPECIAL-CALC-CD = 'H'
 15108         MOVE PB-I-LF-ALT-BENEFIT-AMT
 15109                                    TO CP-ALTERNATE-BENEFIT
 15110         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 15111     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 15112     MOVE 'R'                    TO CP-RATE-FILE
 15113     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 15114     IF NOT CP-ERROR-RATE-NOT-FOUND
 15115        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 15116        IF (CP-DCC-LF-RATE NOT = ZEROS)
 15117           AND (CP-BENEFIT-CD (1:1) = 'S')
 15118           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 15119                                    PB-I-LF-PREMIUM-AMT
 15120        END-IF
 15121     ELSE
 15122        MOVE +0                  TO PB-I-TOT-FEES-CALC
 15123     END-IF
 15124     .
 15125 3340-EDIT-LF-AH-TOL.
 15126
 15127***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 15128***    UNSIGN-WRK2    =    AH   DIFFERENCE
 15129***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 15130***
 15131     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 15132         PB-I-AH-PREMIUM-AMT
 15133          GIVING WS-CALC-WORK.
 15134
 15135     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 15136        AND WS-CALC-WORK NOT = ZERO
 15137         MOVE ER-2649            TO WS-ERROR
 15138         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15139
 15140     SUBTRACT PB-I-LF-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 274
* EL050.cbl
 15141             FROM PB-I-LF-PREMIUM-AMT
 15142                 GIVING WS-UNSIGN-WRK1.
 15143
 15144     SUBTRACT PB-I-LF-ALT-PREM-CALC
 15145             FROM PB-I-LF-ALT-PREMIUM-AMT
 15146                 GIVING WS-UNSIGN-WRK4.
 15147
 15148     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 15149                                + WS-UNSIGN-WRK4.
 15150
 15151     SUBTRACT PB-I-AH-PREM-CALC
 15152             FROM PB-I-AH-PREMIUM-AMT
 15153                 GIVING WS-UNSIGN-WRK2.
 15154
 15155******************************************************************
 15156*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 15157******************************************************************
 15158
 15159     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 15160         MOVE ZERO TO WS-UNSIGN-WRK1.
 15161
 15162     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 15163         MOVE ZERO TO WS-UNSIGN-WRK2.
 15164
 15165     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 15166             GIVING WS-UNSIGN-WRK3.
 15167
 15168 3342-CONTINUE.
 15169
 15170     IF (PB-I-LF-RATE = ZERO  AND
 15171         PB-I-AH-RATE = ZERO)
 15172         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 15173            WS-AH-SPECIAL-CALC-CD = 'O'
 15174              NEXT SENTENCE
 15175         ELSE
 15176             GO TO 3345-EDIT-CONTINUE.
 15177
 15178     IF  PB-RECORD-BILL   =  'B' OR  'L'
 15179         NEXT SENTENCE
 15180     ELSE
 15181     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 15182        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 15183           IF (PB-REISSUED-CERT         OR
 15184               PB-POLICY-IS-DECLINED    OR
 15185               PB-POLICY-IS-VOIDED)
 15186              NEXT SENTENCE
 15187           ELSE
 15188              IF WS-PREM-REJECT-SW = SPACE
 15189                 MOVE ER-2652    TO WS-ERROR
 15190                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15191                 GO TO 3344-CHECK-AH
 15192              ELSE
 15193                 MOVE ER-2650    TO WS-ERROR
 15194                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15195                 GO TO 3344-CHECK-AH.
 15196
 15197***
 15198***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 275
* EL050.cbl
 15199***
 15200
 15201     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 15202         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 15203            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 15204             (1 + WS-TOL-LF-PREM-PCT)
 15205         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 15206            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 15207             (1 - WS-TOL-LF-PREM-PCT)
 15208     ELSE
 15209         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 15210         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 15211
 15212***
 15213***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 15214***
 15215
 15216     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 15217         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 15218          WS-TOL-LF-PREM.
 15219
 15220     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 15221         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 15222          WS-TOL-LF-PREM.
 15223
 15224     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 15225        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 15226
 15227     IF PB-REISSUED-CERT
 15228        or PB-POLICY-IS-DECLINED
 15229        or PB-POLICY-IS-VOIDED
 15230        continue
 15231     ELSE
 15232        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15233              > WS-TOL-LF-HIGH-PREM-AMT)
 15234           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15235              < WS-TOL-LF-LOW-PREM-AMT))
 15236                      or
 15237           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15238              > WS-TOL-LF-HIGH-PREM-PCT)
 15239           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15240              < WS-TOL-LF-LOW-PREM-PCT))
 15241           IF WS-PREM-REJECT-SW = SPACE
 15242              MOVE ER-2652       TO WS-ERROR
 15243              PERFORM 9900-ERROR-FORMAT
 15244                                 THRU 9900-EXIT
 15245           ELSE
 15246              MOVE ER-2650       TO WS-ERROR
 15247              PERFORM 9900-ERROR-FORMAT
 15248                                 THRU 9900-EXIT
 15249           end-if
 15250        end-if
 15251     end-if
 15252
 15253*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 15254*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 15255*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15256*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 276
* EL050.cbl
 15257
 15258     IF WS-ERROR  =  ER-2650  OR  ER-2652
 15259        IF (PB-RECORD-BILL   =  'B' OR  'L')
 15260                      OR
 15261           ((PB-COMPANY-ID = 'DCC' or 'VPP')
 15262           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 15263           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15264           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 15265        END-IF
 15266     END-IF
 15267
 15268     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15269        IF WS-COMP-MAX-CAP GREATER THAN +0
 15270           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 15271              IF (PB-REISSUED-CERT         OR
 15272                  PB-POLICY-IS-DECLINED    OR
 15273                  PB-POLICY-IS-VOIDED)
 15274                 NEXT SENTENCE
 15275              ELSE
 15276                  MOVE ER-2646   TO  WS-ERROR
 15277                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15278
 15279 3344-CVL-TOLERANCE-CHECK.
 15280
 15281      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 15282          GO TO 3344-CHECK-AH.
 15283
 15284      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 15285          GO TO 3344-CHECK-AH.
 15286
 15287      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 15288                                     WS-UNSIGN-WRK6.
 15289
 15290      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 15291          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 15292                                 + PB-I-LF-PREMIUM-AMT
 15293                                 - PB-I-LF-PREM-CALC.
 15294
 15295      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 15296          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 15297                                 + PB-I-LF-ALT-PREMIUM-AMT
 15298                                 - PB-I-LF-ALT-PREM-CALC.
 15299
 15300      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 15301          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 15302              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 15303                 MOVE ER-2652    TO  WS-ERROR
 15304                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15305              ELSE
 15306                 MOVE ER-2650    TO  WS-ERROR
 15307                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15308
 15309      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 15310          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 15311              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 15312                 MOVE ER-2652    TO  WS-ERROR
 15313                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15314              ELSE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 277
* EL050.cbl
 15315                 MOVE ER-2650    TO  WS-ERROR
 15316                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15317
 15318 3344-CHECK-AH.
 15319
 15320****************************************************************
 15321***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 15322***
 15323
 15324     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 15325         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 15326             (1 + WS-TOL-AH-PREM-PCT)
 15327         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 15328             (1 - WS-TOL-AH-PREM-PCT)
 15329     ELSE
 15330         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 15331         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 15332
 15333***
 15334***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 15335***
 15336
 15337     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 15338         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 15339
 15340     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 15341         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 15342
 15343     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 15344        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 15345
 15346     IF (PB-REISSUED-CERT)
 15347        OR (PB-POLICY-IS-DECLINED)
 15348        OR (PB-POLICY-IS-VOIDED)
 15349        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 15350        CONTINUE
 15351     ELSE
 15352        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 15353              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 15354                          or
 15355           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 15356              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 15357           IF WS-PREM-REJECT-SW = SPACE
 15358              MOVE ER-3052       TO WS-ERROR
 15359              PERFORM 9900-ERROR-FORMAT
 15360                                 THRU 9900-EXIT
 15361           ELSE
 15362              MOVE ER-3050       TO WS-ERROR
 15363              PERFORM 9900-ERROR-FORMAT
 15364                                 THRU 9900-EXIT
 15365           END-IF
 15366        END-IF
 15367     END-IF
 15368     if (pb-company-id = 'DCC' or 'VPP')
 15369        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 15370        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 15371        and (pb-i-policy-is-monthly)
 15372        compute ws-tol-ah-high-prem-amt =
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 278
* EL050.cbl
 15373           pb-i-tot-fees-calc + ws-tol-ah-prem
 15374        compute ws-tol-ah-low-prem-amt =
 15375           pb-i-tot-fees-calc - ws-tol-ah-prem
 15376        if ws-tol-ah-prem-pct > zeros
 15377           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 15378              (1 + ws-tol-ah-prem-pct)
 15379           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 15380              (1 - ws-tol-ah-prem-pct)
 15381        else
 15382           move +9999999.99      to ws-tol-ah-high-prem-pct
 15383           move +0               to ws-tol-ah-low-prem-pct
 15384        end-if
 15385        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 15386            or
 15387           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 15388                          or
 15389           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 15390           or
 15391           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 15392            move er-3049         to ws-error
 15393           perform 9900-error-format
 15394                                 thru 9900-exit
 15395
 15396        end-if
 15397     end-if
 15398     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 15399         IF  PB-RECORD-BILL   =  'B' OR 'A'
 15400             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15401             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 15402
 15403     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15404        IF WS-COMP-MAX-CAP GREATER THAN +0
 15405           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 15406              IF (PB-REISSUED-CERT         OR
 15407                  PB-POLICY-IS-DECLINED    OR
 15408                  PB-POLICY-IS-VOIDED)
 15409                 NEXT SENTENCE
 15410              ELSE
 15411                  MOVE ER-2646   TO  WS-ERROR
 15412                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15413
 15414     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 15415        (WS-COMP-MAX-CAP EQUAL +0)
 15416           GO TO 3345-EDIT-CONTINUE.
 15417
 15418     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 15419        GREATER THAN WS-COMP-MAX-CAP
 15420           MOVE ER-2646          TO  WS-ERROR
 15421           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15422
 15423 3345-EDIT-CONTINUE.
 15424
 15425*    IF PB-COMPANY-ID    EQUAL    'NCL'
 15426*       IF PB-ENTRY-BATCH   NUMERIC
 15427*          IF PB-ISSUE
 15428*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 15429*          ELSE
 15430*              IF PB-CANCELLATION
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 279
* EL050.cbl
 15431*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 15432
 15433*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15434*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 15435*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 15436*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 15437*        ELSE
 15438*            MOVE  ER-1909            TO  WS-ERROR
 15439*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15440
 15441     IF PB-I-POLICY-ACCEPTED
 15442        IF PB-POLICY-IS-DECLINED  OR
 15443           PB-REISSUED-CERT  OR
 15444           PB-REIN-ONLY-CERT  OR
 15445           PB-POLICY-IS-VOIDED
 15446            MOVE  ER-1891         TO  WS-ERROR
 15447            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15448        ELSE
 15449            MOVE SPACE            TO  PB-BATCH-ENTRY
 15450            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 15451
 15452     IF PB-I-POLICY-DECLINED
 15453        IF PB-REISSUED-CERT  OR
 15454           PB-REIN-ONLY-CERT  OR
 15455           PB-POLICY-IS-VOIDED
 15456            MOVE  ER-1906         TO  WS-ERROR
 15457            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15458        ELSE
 15459            MOVE  'D'             TO  PB-BATCH-ENTRY
 15460                                      PB-I-ENTRY-STATUS.
 15461
 15462     IF PB-I-NEEDS-UNDERWRITING
 15463        IF PB-POLICY-IS-DECLINED OR
 15464           PB-REISSUED-CERT  OR
 15465           PB-REIN-ONLY-CERT  OR
 15466           PB-POLICY-IS-VOIDED
 15467            MOVE  ER-1907         TO  WS-ERROR
 15468            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15469        ELSE
 15470            MOVE 'U'              TO  PB-BATCH-ENTRY
 15471                                      PB-I-ENTRY-STATUS.
 15472
 15473     IF PB-NEEDS-UNDERWRITING
 15474        MOVE  ER-1901             TO  WS-ERROR
 15475        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15476     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15477        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 15478        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 15479        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15480           AND (NOT WS-LF-CASH))
 15481                           OR
 15482           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15483           AND (NOT WS-AH-CASH)))
 15484                       AND
 15485           (PB-I-ENTRY-STATUS NOT = '5')
 15486           MOVE 'M'              TO PB-BATCH-ENTRY
 15487                                    PB-I-ENTRY-STATUS
 15488        END-IF
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 280
* EL050.cbl
 15489     END-IF
 15490     move pending-business       to ws-passed-erpndb
 15491     move ' '                    to ws-exceed-limit-yn
 15492     perform 7780-call-agg       thru 7780-exit
 15493*    display ' el050 exceed ' ws-exceed-limit-yn
 15494     if ws-exceed-limit-yn = 'Y'
 15495        MOVE  ER-9813            TO WS-ERROR
 15496        move 'Y'                 to ws-9813-sw
 15497        PERFORM  9900-ERROR-FORMAT
 15498                                 THRU 9900-EXIT
 15499     end-if
 15500     if (PB-EXCEEDED-LIMIT-FORCED)
 15501        and (ws-9813-sw = 'Y')
 15502        subtract +1 from PB-NO-OF-ERRORS
 15503        move er-9823             to ws-error
 15504        PERFORM  9900-ERROR-FORMAT
 15505                                 THRU 9900-EXIT
 15506     end-if
 15507     IF  PB-COMPANY-ID NOT = 'NCL'
 15508         GO TO 3999-END-EDIT.
 15509
 15510     IF PB-REISSUED-CERT  OR
 15511        PB-POLICY-IS-DECLINED  OR
 15512        PB-POLICY-IS-VOIDED  OR
 15513        PB-I-OB
 15514         GO TO 3999-END-EDIT.
 15515
 15516     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 15517         MOVE  ER-2644            TO  WS-ERROR
 15518         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15519         GO TO 3999-END-EDIT.
 15520
 15521     MOVE 'N'                     TO  FORM-MASTER-SW.
 15522     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 15523
 15524     IF NOT FORM-MASTER-FOUND
 15525         GO TO 3999-END-EDIT.
 15526
 15527     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 15528                                      FORM-MASTER-AH-SW.
 15529
 15530     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15531         MOVE  +1                 TO SUB6
 15532         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 15533
 15534     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15535         MOVE  +1                 TO SUB6
 15536         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 15537
 15538     IF LF-FORM-MASTER-FOUND  OR
 15539        AH-FORM-MASTER-FOUND
 15540         GO TO 3360-CHECK-FORM-LIMITS
 15541     ELSE
 15542         GO TO 3999-END-EDIT.
 15543
 15544******************************************************************
 15545*                  3350-GET-ERFORM                               *
 15546*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 281
* EL050.cbl
 15547*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 15548******************************************************************
 15549
 15550 3350-GET-ERFORM.
 15551
 15552     IF  WK-FORM-ADDR      EQUAL    ZEROS
 15553         GO TO  3350-ERFORM-GETMAIN.
 15554
 15555     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 15556     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 15557     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 15558     MOVE 'Y'                     TO FORM-MASTER-SW.
 15559
 15560     IF PB-CANCELLATION
 15561         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15562            PB-SV-STATE          EQUAL   FO-STATE       AND
 15563            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15564              GO TO 3350-EXIT
 15565         ELSE
 15566             NEXT SENTENCE
 15567     ELSE
 15568         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15569            PB-SV-STATE          EQUAL   FO-STATE       AND
 15570            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15571              GO TO 3350-EXIT.
 15572
 15573 3350-ERFORM-GETMAIN.
 15574
 15575     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 15576     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 15577
 15578 3350-ERFORM-READ.
 15579
 15580     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 15581     MOVE  PB-SV-STATE            TO  FORM-STATE.
 15582     IF PB-CANCELLATION
 15583         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 15584     ELSE
 15585         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 15586     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 15587
 15588     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 15589
 15590     IF FORM-MASTER-FOUND
 15591       IF PB-CANCELLATION
 15592          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15593             PB-SV-STATE          EQUAL   FO-STATE       AND
 15594             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15595              GO  TO 3350-EXIT
 15596          ELSE
 15597              NEXT SENTENCE
 15598       ELSE
 15599          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15600             PB-SV-STATE          EQUAL   FO-STATE       AND
 15601             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15602              GO  TO 3350-EXIT.
 15603
 15604     MOVE  'N'                    TO  FORM-MASTER-SW.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 282
* EL050.cbl
 15605     MOVE  ER-1895                TO  WS-ERROR.
 15606     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15607
 15608 3350-EXIT.
 15609      EXIT.
 15610
 15611******************************************************************
 15612*                  3355-EDIT-FORM-LF-BENEFITS                    *
 15613*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 15614*   VALID FOR THE POLICY FORM USED.                              *
 15615******************************************************************
 15616
 15617 3355-EDIT-FORM-LF-BENEFITS.
 15618
 15619     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15620        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15621         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 15622         GO TO   3355-EXIT.
 15623
 15624     IF  SUB6    LESS THAN   +40
 15625         ADD  +1      TO  SUB6
 15626         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 15627
 15628     MOVE  ER-1896         TO  WS-ERROR.
 15629     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15630
 15631 3355-EXIT.
 15632      EXIT.
 15633
 15634******************************************************************
 15635*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15636*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15637*   VALID FOR THE POLICY FORM USED.                              *
 15638******************************************************************
 15639
 15640 3356-EDIT-FORM-AH-BENEFITS.
 15641
 15642     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15643        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15644         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 15645         GO TO  3356-EXIT.
 15646
 15647      IF  SUB6    LESS THAN     +40
 15648          ADD  +1      TO  SUB6
 15649          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15650
 15651     MOVE  ER-1897         TO  WS-ERROR.
 15652     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15653
 15654 3356-EXIT.
 15655      EXIT.
 15656
 15657******************************************************************
 15658*                  3357-BENEFIT-SEARCH                           *
 15659*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15660*   CANCELLATIONS ONLY.                                          *
 15661******************************************************************
 15662 3357-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 283
* EL050.cbl
 15663     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15664         MOVE +1                          TO SUB6
 15665         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15666
 15667     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15668         MOVE +1                          TO SUB6
 15669         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15670
 15671 3357-EXIT.
 15672     EXIT.
 15673
 15674******************************************************************
 15675*                  3358-BENEFIT-LIFE-SEARCH                      *
 15676*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15677*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15678*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15679******************************************************************
 15680 3358-BENEFIT-LIFE-SEARCH.
 15681     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15682       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15683         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15684           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15685              IF FO-PLAN-REFUND-METHOD (SUB6)
 15686                     IS GREATER THAN SPACES
 15687                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15688                                          WS-LF-REFUND-CALC
 15689                 GO TO 3358-EXIT.
 15690
 15691     IF SUB6 LESS THAN +40
 15692         ADD +1                 TO SUB6
 15693         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15694
 15695 3358-EXIT.
 15696     EXIT.
 15697******************************************************************
 15698*                  3359-BENEFIT-AH-SEARCH                        *
 15699*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15700*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15701*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15702******************************************************************
 15703 3359-BENEFIT-AH-SEARCH.
 15704     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15705       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15706         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15707           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15708              IF FO-PLAN-REFUND-METHOD (SUB6)
 15709                      IS GREATER THAN SPACES
 15710                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15711                                          WS-AH-REFUND-CALC
 15712                 GO TO 3359-EXIT.
 15713
 15714     IF SUB6 LESS THAN +40
 15715         ADD +1                 TO SUB6
 15716         GO TO 3359-BENEFIT-AH-SEARCH.
 15717
 15718 3359-EXIT.
 15719     EXIT.
 15720
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 284
* EL050.cbl
 15721******************************************************************
 15722*                  3360-CHECK-FORM-LIMITS                        *
 15723*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15724*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15725******************************************************************
 15726
 15727 3360-CHECK-FORM-LIMITS.
 15728
 15729     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15730         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15731
 15732     IF NOT LF-FORM-MASTER-FOUND
 15733         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15734
 15735 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15736
 15737     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15738       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15739        WS-LF-JOINT-INDICATOR = 'J'  AND
 15740        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15741         IF PB-COMPANY-ID = 'NCL'
 15742            MOVE  ER-1911          TO  WS-ERROR
 15743            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15744         ELSE
 15745            MOVE  ER-1892          TO  WS-ERROR
 15746            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15747
 15748 3360-CHECK-FORM-LF-ATT-AGE.
 15749
 15750     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15751
 15752     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15753         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15754         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15755            IF PB-COMPANY-ID = 'NCL'
 15756                MOVE  ER-1913      TO  WS-ERROR
 15757                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15758            ELSE
 15759                MOVE  ER-1894      TO  WS-ERROR
 15760                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15761
 15762 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15763
 15764     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15765         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15766         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15767            IF PB-COMPANY-ID = 'NCL'
 15768                MOVE  ER-1914      TO  WS-ERROR
 15769                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15770            ELSE
 15771                MOVE  ER-1899      TO  WS-ERROR
 15772                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15773
 15774 3360-CHECK-FORM-LF-TERM-BAMT.
 15775
 15776     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15777         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15778         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 285
* EL050.cbl
 15779           IF  PB-COMPANY-ID = 'NCL'
 15780               MOVE  ER-1916       TO  WS-ERROR
 15781               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15782           ELSE
 15783               MOVE  ER-1902       TO  WS-ERROR
 15784               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15785
 15786     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15787                                    PB-I-LF-ALT-BENEFIT-AMT.
 15788
 15789     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15790         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15791         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15792             IF  PB-COMPANY-ID = 'NCL'
 15793                 MOVE  ER-1918     TO  WS-ERROR
 15794                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15795             ELSE
 15796                 MOVE  ER-1904     TO  WS-ERROR
 15797                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15798
 15799******************************************************************
 15800*                  3360-CHECK-FORM-AH-LIMITS                     *
 15801*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15802*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15803******************************************************************
 15804
 15805 3360-CHECK-FORM-AH-LIMITS.
 15806
 15807     IF NOT AH-FORM-MASTER-FOUND
 15808         GO TO 3999-END-EDIT.
 15809
 15810 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15811
 15812     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15813       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15814        WS-AH-JOINT-INDICATOR = 'J'  AND
 15815        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15816         IF PB-COMPANY-ID = 'NCL'
 15817            MOVE  ER-1912          TO  WS-ERROR
 15818            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15819         ELSE
 15820            MOVE  ER-1893          TO  WS-ERROR
 15821            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15822
 15823 3360-CHECK-FORM-AH-ATT-AGE.
 15824
 15825     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15826
 15827     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15828         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15829         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15830            IF PB-COMPANY-ID = 'NCL'
 15831                MOVE  ER-1913      TO  WS-ERROR
 15832                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15833            ELSE
 15834                MOVE  ER-1894      TO  WS-ERROR
 15835                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15836
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 286
* EL050.cbl
 15837 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15838
 15839     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15840         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15841         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15842            IF PB-COMPANY-ID = 'NCL'
 15843                MOVE  ER-1915      TO  WS-ERROR
 15844                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15845            ELSE
 15846                MOVE  ER-1900      TO  WS-ERROR
 15847                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15848
 15849 3360-CHECK-FORM-AH-TERM-BAMT.
 15850
 15851     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15852         FO-AH-MAX-TERM    GREATER THAN  +0
 15853         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15854             IF  PB-COMPANY-ID = 'NCL'
 15855                 MOVE  ER-1917     TO  WS-ERROR
 15856                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15857             ELSE
 15858                  MOVE  ER-1903    TO  WS-ERROR
 15859                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15860
 15861     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15862         FO-MAX-AH-AMT    GREATER THAN  +0
 15863         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15864             IF  PB-COMPANY-ID = 'NCL'
 15865                 MOVE  ER-1919     TO  WS-ERROR
 15866                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15867             ELSE
 15868                 MOVE  ER-1905     TO  WS-ERROR
 15869                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15870
 15871     GO TO 3999-END-EDIT.
 15872
 15873******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 287
* EL050.cbl
 15875 3400-edit-vin.
 15876
 15877     move spaces                 to hldi-pass-area
 15878     MOVE PB-I-VIN               TO WS-WORK-VIN
 15879     MOVE +8                     TO V2
 15880     MOVE ZEROS                  TO WS-VIN-TOTAL
 15881     PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15882      (V1 > 17)
 15883        IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 15884           MOVE ER-3825          TO WS-ERROR
 15885           PERFORM 9900-ERROR-FORMAT
 15886                                 THRU 9900-EXIT
 15887        ELSE
 15888           IF V1 = 8
 15889              MOVE 10            TO V2
 15890           END-IF
 15891           IF V1 = 9
 15892              MOVE 0             TO V2
 15893           END-IF
 15894           IF V1 = 10
 15895              MOVE 9             TO V2
 15896           END-IF
 15897           IF WS-WORK-VIN (V1:1) NUMERIC
 15898              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15899               + (WS-WORK-VIN-N (V1) * V2)
 15900           ELSE
 15901              MOVE WS-WORK-VIN (V1:1)
 15902                            TO WS-HEX-BYTE
 15903              COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 15904              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15905               + (WS-NUM (V3) * V2)
 15906           END-IF
 15907           COMPUTE V2 = V2 - 1
 15908        END-IF
 15909     END-PERFORM
 15910     MOVE ZEROS                  TO WS-VIN-REMAINDER
 15911     DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 15912        REMAINDER WS-VIN-REMAINDER
 15913     IF ((WS-WORK-VIN (9:1) = 'X')
 15914        AND (WS-VIN-REMAINDER = 10))
 15915                OR
 15916        (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 15917        if pb-company-id = 'VPP'
 15918           perform 3410-check-with-hldi
 15919                                 thru 3410-exit
 15920        end-if
 15921     ELSE
 15922        IF WS-WORK-VIN (1:1) > 0 AND < 6
 15923           MOVE ER-3826          TO WS-ERROR
 15924           PERFORM 9900-ERROR-FORMAT
 15925                                 THRU 9900-EXIT
 15926        ELSE
 15927           MOVE ER-3827          TO WS-ERROR
 15928           PERFORM 9900-ERROR-FORMAT
 15929                                 THRU 9900-EXIT
 15930        END-IF
 15931     END-IF
 15932
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 288
* EL050.cbl
 15933     .
 15934 3400-exit.
 15935     exit.
 15936 3410-check-with-hldi.
 15937     move spaces                 to hldi-pass-area
 15938     move pb-i-vin               to pa-vin
 15939     perform 7785-call-hldi      thru 7785-exit
 15940*    display 'PA-VIN        ' PA-VIN
 15941*    display 'PA-ErrorCode  ' PA-ErrorCode
 15942*    display 'PA-ErrorDesc  ' PA-ErrorDesc
 15943*    display 'PA-ModelYear  ' PA-ModelYear
 15944*    display 'PA-MakeName   ' PA-MakeName
 15945*    display 'PA-ModelName  ' PA-ModelName
 15946*    display 'PA-SeriesName ' PA-SeriesName
 15947     if pa-errorcode (1:1) not = '0'
 15948        move spaces              to hldi-pass-area
 15949        move pb-i-vin            to pa-vin
 15950*       move pa-errordesc        to pa-seriesname
 15951*       perform 7786-call-hldim  thru 7786-exit
 15952*       display 'PA-VIN        ' PA-VIN
 15953*       display 'PA-ErrorCode  ' PA-ErrorCode
 15954*       display 'PA-ErrorDesc  ' PA-ErrorDesc
 15955*       display 'PA-ModelYear  ' PA-ModelYear
 15956*       display 'PA-MakeName   ' PA-MakeName
 15957*       display 'PA-ModelName  ' PA-ModelName
 15958*       display 'PA-SeriesName ' PA-SeriesName
 15959     end-if
 15960     .
 15961 3410-exit.
 15962     exit.
 15963******************************************************************
 15964*                  E D I T   C A N C E L                         *
 15965******************************************************************
 15966
 15967 3700-EDIT-CANCEL.
 15968     IF PB-COMPANY-ID = 'DMD'
 15969         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15970                                         WS-RES-MUNI-TAX
 15971                                         PB-CI-STATE-TAX
 15972                                         PB-CI-MUNI-TAX
 15973         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15974
 15975*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15976*       IF PB-ENTRY-BATCH  NUMERIC
 15977*          IF PB-CANCELLATION
 15978*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15979*          ELSE
 15980*             IF PB-ISSUE
 15981*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15982
 15983     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15984        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15985     END-IF
 15986*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15987*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15988
 15989     IF CM-ENTRY-STATUS = 'V'
 15990        MOVE ER-2780             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 289
* EL050.cbl
 15991        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15992        GO TO 3999-END-EDIT.
 15993
 15994     IF CM-ENTRY-STATUS = 'D'
 15995        MOVE ER-2781             TO WS-ERROR
 15996        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15997        GO TO 3999-END-EDIT.
 15998
 15999     IF CM-ENTRY-STATUS = 'U'
 16000        MOVE ER-2782             TO WS-ERROR
 16001        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16002
 16003***************************************************************
 16004*                                                             *
 16005*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 16006*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 16007*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 16008*   OF ANOTHER COVERAGE.                                      *
 16009*                                                             *
 16010***************************************************************
 16011
 16012     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 16013                                    PB-C-AH-CANCEL-VOID-SW.
 16014
 16015     IF PB-C-LF-CANCEL-AMT = ZERO
 16016        NEXT SENTENCE
 16017     ELSE
 16018        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16019           AND
 16020           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16021               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 16022               MOVE ER-2745           TO WS-ERROR
 16023               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16024
 16025     IF PB-C-AH-CANCEL-AMT = ZERO
 16026        NEXT SENTENCE
 16027     ELSE
 16028        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16029           AND
 16030           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 16031               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 16032               MOVE ER-2745           TO WS-ERROR
 16033               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16034
 16035     IF WS-LF-EARNINGS-CALC = '4'
 16036        MOVE '4'                   TO WS-LF-REFUND-CALC.
 16037
 16038     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 16039     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 16040     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 16041     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 16042     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 16043     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 16044
 16045     MOVE ZERO                     TO PB-C-LF-REF-CALC
 16046                                      PB-C-AH-REF-CALC.
 16047     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 16048
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 290
* EL050.cbl
 16049******************************************************************
 16050*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 16051*             TO VALIDATE COVERAGE.                              *
 16052******************************************************************
 16053
 16054     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 16055        PB-C-LF-CANCEL-AMT = ZEROS
 16056          MOVE 'N'                 TO WS-LF-CANCEL-SW
 16057      ELSE
 16058          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 16059
 16060     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 16061        PB-C-AH-CANCEL-AMT = ZEROS
 16062          MOVE 'N'                 TO WS-AH-CANCEL-SW
 16063      ELSE
 16064          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 16065
 16066     EVALUATE TRUE
 16067         WHEN PB-CANCEL-FORCE             OR
 16068              PB-CANCEL-DATE-FORCED       OR
 16069              PB-FORCE-OFF
 16070                  IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 16071                     MOVE CM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 16072                  END-IF
 16073         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 16074               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 16075              (PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP')
 16076                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 16077         WHEN OTHER
 16078              IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 16079                 MOVE ER-2794              TO WS-ERROR
 16080              ELSE
 16081                 MOVE ER-2749              TO WS-ERROR
 16082              END-IF
 16083              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16084     END-EVALUATE.
 16085
 16086
 16087*    IF  PB-COMPANY-ID    EQUAL    'HER'
 16088*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 16089*            MOVE  ER-1909            TO  WS-ERROR
 16090*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 16091*        ELSE
 16092*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 16093
 16094     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 16095     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 16096        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 16097     ELSE
 16098        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 16099     END-IF
 16100     .
 16101 3705-EDIT-CANCEL-DT.
 16102
 16103     IF LF-COVERAGE-CANCELLED
 16104        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16105         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 16106         MOVE WS-CURRENT-MONTH-END
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 291
* EL050.cbl
 16107                                 TO DC-BIN-DATE-2
 16108         SET ELAPSED-BETWEEN-BIN TO TRUE
 16109*        MOVE 1                  TO DC-OPTION-CODE
 16110         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16111         IF DATE-CONVERSION-ERROR
 16112            NEXT SENTENCE
 16113          ELSE
 16114             IF DC-ELAPSED-DAYS GREATER +180
 16115                IF PB-CANCEL-DATE-FORCED  OR
 16116                   PB-CANCEL-DATE-FORCED-NO-FEE
 16117                      MOVE ER-2751  TO WS-ERROR
 16118                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16119                 ELSE
 16120                   MOVE ER-2752  TO WS-ERROR
 16121                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16122
 16123     IF AH-COVERAGE-CANCELLED
 16124        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16125         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 16126         MOVE WS-CURRENT-MONTH-END
 16127                                 TO DC-BIN-DATE-2
 16128         SET ELAPSED-BETWEEN-BIN TO TRUE
 16129*        MOVE 1                  TO DC-OPTION-CODE
 16130         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16131         IF DATE-CONVERSION-ERROR
 16132            NEXT SENTENCE
 16133          ELSE
 16134             IF DC-ELAPSED-DAYS GREATER +180
 16135                IF PB-CANCEL-DATE-FORCED OR
 16136                   PB-CANCEL-DATE-FORCED-NO-FEE
 16137                      MOVE ER-2751  TO WS-ERROR
 16138                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16139                 ELSE
 16140                   MOVE ER-2752  TO WS-ERROR
 16141                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16142
 16143     IF WS-ERROR = ER-2752
 16144        AND (PB-COMPANY-ID = 'ABL'
 16145         OR  PB-COMPANY-ID = 'FGL'
 16146         OR  PB-COMPANY-ID = 'IST'
 16147         OR  PB-COMPANY-ID = 'JHL'
 16148         OR  PB-COMPANY-ID = 'LAP'
 16149         OR  PB-COMPANY-ID = 'LBL'
 16150         OR  PB-COMPANY-ID = 'NCB'
 16151         OR  PB-COMPANY-ID = 'NLI'
 16152         OR  PB-COMPANY-ID = 'OFI'
 16153         OR  PB-COMPANY-ID = 'PLI'
 16154         OR  PB-COMPANY-ID = 'TAO'
 16155         OR  PB-COMPANY-ID = 'TIC'
 16156         OR  PB-COMPANY-ID = 'HER'
 16157         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 16158         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 16159            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 16160            MOVE ER-2762     TO WS-ERROR
 16161            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16162
 16163     IF LF-COVERAGE-CANCELLED
 16164        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 292
* EL050.cbl
 16165        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 16166             MOVE ER-2733         TO WS-ERROR
 16167             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16168
 16169     IF AH-COVERAGE-CANCELLED
 16170        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16171        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 16172              MOVE ER-2733        TO WS-ERROR
 16173              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16174
 16175     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 16176        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 16177        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 16178           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 16179            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 16180              IF PB-COMPANY-ID NOT = 'LAP'
 16181               MOVE ER-2704            TO WS-ERROR
 16182               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16183
 16184     IF CERT-WAS-NOT-FOUND
 16185         GO TO 3999-END-EDIT.
 16186
 16187     IF PB-COMPANY-ID EQUAL 'CDC'
 16188        IF LF-COVERAGE-CANCELLED
 16189           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16190            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 16191            MOVE PB-C-LF-CANCEL-DT
 16192                                 TO DC-BIN-DATE-2
 16193            SET ELAPSED-BETWEEN-BIN TO TRUE
 16194*           MOVE 1               TO DC-OPTION-CODE
 16195            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16196            IF DATE-CONVERSION-ERROR
 16197               NEXT SENTENCE
 16198             ELSE
 16199                IF DC-ELAPSED-DAYS GREATER +60
 16200                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 16201
 16202     IF PB-COMPANY-ID EQUAL 'CDC'
 16203        IF AH-COVERAGE-CANCELLED
 16204           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16205            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 16206            MOVE PB-C-AH-CANCEL-DT
 16207                                 TO DC-BIN-DATE-2
 16208            MOVE +0              TO DC-ELAPSED-DAYS
 16209                                    DC-ELAPSED-MONTHS
 16210            SET ELAPSED-BETWEEN-BIN  TO TRUE
 16211*           MOVE 1               TO DC-OPTION-CODE
 16212            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16213            IF DATE-CONVERSION-ERROR
 16214               NEXT SENTENCE
 16215             ELSE
 16216                IF DC-ELAPSED-DAYS GREATER +60
 16217                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 16218
 16219     MOVE +0                     TO DC-ELAPSED-DAYS
 16220                                    DC-ELAPSED-MONTHS.
 16221
 16222     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 293
* EL050.cbl
 16223        (WS-AH-SPECIAL-CALC-CD = 'Z')
 16224          MOVE 'Z'                TO PB-CI-OB-FLAG
 16225          MOVE ER-2767            TO WS-ERROR
 16226          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16227          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16228          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16229          GO TO 3775-OVER-REF-CHK
 16230        ELSE
 16231          MOVE ZEROS              TO PB-CI-LIVES
 16232                                     PB-C-LIVES
 16233          IF PB-CI-OB-FLAG NOT = 'B'
 16234             MOVE SPACE           TO PB-CI-OB-FLAG.
 16235
 16236     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 16237         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 16238     ELSE
 16239         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 16240
 16241     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 16242        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 16243            MOVE ER-2760         TO WS-ERROR
 16244            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16245
 16246     IF LF-COVERAGE-CANCELLED
 16247        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16248         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 16249            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 16250               MOVE ER-2774       TO WS-ERROR
 16251               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16252
 16253     IF AH-COVERAGE-CANCELLED
 16254        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16255         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 16256            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 16257               MOVE ER-2775       TO WS-ERROR
 16258               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16259
 16260     IF LF-COVERAGE-CANCELLED
 16261        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16262         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 16263            MOVE ER-2776         TO WS-ERROR
 16264            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16265
 16266     IF AH-COVERAGE-CANCELLED
 16267        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16268         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 16269            MOVE ER-2777         TO WS-ERROR
 16270            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16271
 16272     IF LF-COVERAGE-CANCELLED
 16273        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16274        if pb-ci-lf-expire-dt = low-values or spaces
 16275           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 16276           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 16277           MOVE PB-CI-EXTENTION-DAYS
 16278                                 TO DC-ELAPSED-DAYS
 16279           SET BIN-PLUS-ELAPSED  TO TRUE
 16280           PERFORM 8500-DATE-CONVERT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 294
* EL050.cbl
 16281                                 THRU 8500-EXIT
 16282           IF DATE-CONVERSION-ERROR
 16283              move low-values    to dc-bin-date-2
 16284           end-if
 16285        else
 16286           move pb-ci-lf-expire-dt
 16287                                 to dc-bin-date-2
 16288        end-if
 16289        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 16290           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16291                             OR  'FIA'
 16292              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 16293           ELSE
 16294              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16295              MOVE ER-2731       TO WS-ERROR
 16296              PERFORM 9900-ERROR-FORMAT
 16297                                 THRU 9900-EXIT
 16298           end-if
 16299        end-if
 16300     end-if
 16301*    IF LF-COVERAGE-CANCELLED
 16302*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16303*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 16304*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 16305*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 16306*        SET BIN-PLUS-ELAPSED      TO TRUE
 16307*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16308*        IF DATE-CONVERSION-ERROR
 16309*           NEXT SENTENCE
 16310*         ELSE
 16311*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 16312*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16313*                            OR  'FIA'
 16314*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 16315*              ELSE
 16316*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16317*               MOVE ER-2731       TO WS-ERROR
 16318*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16319     .
 16320 3705-EDIT-AH-CANCEL-DT.
 16321     IF AH-COVERAGE-CANCELLED
 16322        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16323        if pb-ci-AH-expire-dt = low-values or spaces
 16324           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 16325           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 16326           MOVE PB-CI-EXTENTION-DAYS
 16327                                 TO DC-ELAPSED-DAYS
 16328           SET BIN-PLUS-ELAPSED  TO TRUE
 16329           PERFORM 8500-DATE-CONVERT
 16330                                 THRU 8500-EXIT
 16331           IF DATE-CONVERSION-ERROR
 16332              move low-values    to dc-bin-date-2
 16333           end-if
 16334        else
 16335           move pb-ci-ah-expire-dt
 16336                                 to dc-bin-date-2
 16337        end-if
 16338        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 295
* EL050.cbl
 16339           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16340                             OR  'FIA'
 16341              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 16342           ELSE
 16343              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16344              MOVE ER-2771       TO WS-ERROR
 16345              PERFORM 9900-ERROR-FORMAT
 16346                                 THRU 9900-EXIT
 16347           end-if
 16348        end-if
 16349     end-if
 16350*    IF AH-COVERAGE-CANCELLED
 16351*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16352*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 16353*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 16354*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 16355**       MOVE 6                    TO DC-OPTION-CODE
 16356*        SET BIN-PLUS-ELAPSED      TO TRUE
 16357*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16358*        IF DATE-CONVERSION-ERROR
 16359*           NEXT SENTENCE
 16360*         ELSE
 16361*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 16362*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16363*                             OR 'FIA'
 16364*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 16365*             ELSE
 16366*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16367*              MOVE ER-2771       TO WS-ERROR
 16368*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16369     .
 16370 3705-EDIT-CONTINUED.
 16371
 16372*    IF LF-COVERAGE-CANCELLED
 16373*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16374*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 16375*            MOVE ER-2727         TO WS-ERROR
 16376*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16377*
 16378*    IF AH-COVERAGE-CANCELLED
 16379*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16380*        IF PB-COMPANY-ID = 'ACE'
 16381*           MOVE ER-2727        TO WS-ERROR
 16382*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16383*        ELSE
 16384*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 16385*              MOVE ER-2727     TO WS-ERROR
 16386*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16387
 16388     IF PB-COMPANY-ID = 'ACE'
 16389       IF AH-COVERAGE-CANCELLED
 16390         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16391           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 16392              MOVE ER-2732      TO WS-ERROR
 16393              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16394
 16395     IF PB-COMPANY-ID      EQUAL   'HER'
 16396        IF WS-ERROR        EQUAL   ER-2727
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 296
* EL050.cbl
 16397            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 16398            MOVE  ER-2725          TO  WS-ERROR
 16399            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 16400
 16401     IF PB-C-CLAIM-CREATED-CANCEL
 16402            MOVE ER-2748         TO WS-ERROR
 16403            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16404
 16405     IF PB-C-LAST-NAME NOT = SPACES
 16406         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 16407            MOVE ER-2747         TO WS-ERROR
 16408            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16409
 16410 3710-EDIT-LUMP-SUM-PRIOR.
 16411
 16412     IF AH-COVERAGE-CANCELLED
 16413         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16414             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 16415                MOVE ER-2735    TO WS-ERROR
 16416                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16417
 16418     IF LF-COVERAGE-CANCELLED
 16419         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16420             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 16421                MOVE ER-2735    TO WS-ERROR
 16422                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16423
 16424 3710-EDIT-PRIOR-DEATH.
 16425
 16426*    IF LF-COVERAGE-CANCELLED
 16427*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16428*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16429*           (NOT PB-CI-OB)
 16430*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 16431*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 16432*                   MOVE ER-2732  TO WS-ERROR
 16433*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16434*
 16435*    IF AH-COVERAGE-CANCELLED
 16436*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16437*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16438*           (NOT PB-CI-OB)
 16439*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 16440*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 16441*                   MOVE ER-2732  TO WS-ERROR
 16442*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16443
 16444     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 16445         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 16446            (NOT PB-COMP-LF-CANCEL)
 16447             NEXT SENTENCE
 16448         ELSE
 16449           IF PB-C-LF-CANCEL-VOIDED
 16450              NEXT SENTENCE
 16451           ELSE
 16452              MOVE ER-2753      TO WS-ERROR
 16453              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16454
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 297
* EL050.cbl
 16455     IF CANCEL-FUTURE-DT
 16456         GO TO 3999-END-EDIT.
 16457
 16458 3715-GET-REMAIN-TERM-LF.
 16459
 16460     IF NO-LF-BENEFIT-MATCH  OR
 16461        WS-LF-BENEFIT-CD = ZEROS
 16462        GO TO 3730-GET-AH-REMAIN-TERM.
 16463
 16464     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 16465     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16466     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16467     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 16468     MOVE PB-SV-STATE            TO CP-STATE.
 16469     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16470     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 16471     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16472     MOVE '2'                    TO CP-PROCESS-TYPE.
 16473     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16474     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16475     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16476     IF (PB-COMPANY-ID = 'CID')
 16477        AND (CP-STATE-STD-ABBRV = 'WI')
 16478        MOVE '7'                 TO CP-REM-TERM-METHOD
 16479        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16480     ELSE
 16481        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16482        MOVE WS-REM-TRM-CALC-OPTION
 16483                                 TO CP-REM-TRM-CALC-OPTION
 16484     END-IF
 16485**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 16486     IF (PB-COMPANY-ID = 'CID')
 16487        AND (CP-STATE-STD-ABBRV = 'MO')
 16488        AND (PB-CERT-EFF-DT >= X'9B41')
 16489        AND (PB-CERT-EFF-DT <= X'A2FB')
 16490        MOVE '7'                 TO CP-REM-TERM-METHOD
 16491        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16492     END-IF
 16493     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 16494                                    CP-LOAN-TERM.
 16495     IF CP-TRUNCATED-LIFE
 16496        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 16497
 16498     IF CP-TERM-IS-DAYS
 16499         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 16500     ELSE
 16501         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16502
 16503     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 16504
 16505     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16506
 16507     IF LF-COVERAGE-CANCELLED
 16508        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 16509        NEXT SENTENCE
 16510      ELSE
 16511          GO TO 3730-GET-AH-REMAIN-TERM.
 16512
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 298
* EL050.cbl
 16513 3720-GET-LF-REFUND.
 16514
 16515     IF PB-C-LF-CANCEL-VOIDED
 16516        GO TO 3730-GET-AH-REMAIN-TERM
 16517     end-if
 16518
 16519     IF PB-COMPANY-ID EQUAL 'BOA'
 16520         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16521         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16522         GO TO 3730-GET-AH-REMAIN-TERM.
 16523
 16524     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 16525        (WS-AH-SPECIAL-CALC-CD = 'M')
 16526         MOVE ER-2767            TO WS-ERROR
 16527         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16528         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16529         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16530         GO TO 3780-UPDATE-CANCEL-CERT.
 16531
 16532*    if (ws-lf-earnings-calc = '6')
 16533*       or (pb-c-lf-refund-override = '6')
 16534*       move cp-remaining-term-1 to cp-remaining-term-2
 16535*    end-if
 16536     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 16537
 16538     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 16539     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 16540     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16541     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 16542     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 16543     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 16544     IF PB-COMPANY-ID = 'DCC'
 16545        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16546        IF PDEF-MASTER-FOUND
 16547           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16548              (V1 > +8)
 16549              OR (PD-PROD-CODE (V1) = 'L')
 16550           END-PERFORM
 16551           IF V1 < +9
 16552              MOVE PD-MAX-AMT (V1)
 16553                           TO CP-R-MAX-TOT-BEN
 16554                              EC-AM-LF-MAX-TOT-BEN
 16555           END-IF
 16556        ELSE
 16557        MOVE ' '                 TO PDEF-MASTER-SW
 16558        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16559        MOVE PB-STATE            TO ERPDEF-STATE
 16560        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
 16561           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16562        END-IF
 16563        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16564        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16565        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16566        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16567        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16568        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16569        IF PDEF-MASTER-FOUND
 16570           MOVE 'N'              TO PDEF-MASTER-SW
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 299
* EL050.cbl
 16571           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16572           IF PDEF-MASTER-FOUND
 16573              IF (ERPDEF-KEY-SAVE (1:16) =
 16574                           PD-CONTROL-PRIMARY (1:16))
 16575                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16576                 CONTINUE
 16577              ELSE
 16578                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16579                 IF (ERPDEF-KEY-SAVE (1:16) =
 16580                           PD-CONTROL-PRIMARY (1:16))
 16581                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16582                    CONTINUE
 16583                 ELSE
 16584                    MOVE 'N'     TO PDEF-MASTER-SW
 16585                 END-IF
 16586              END-IF
 16587
 16588              IF PDEF-MASTER-FOUND
 16589                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16590                    (V1 > +8)
 16591                    OR (PD-PROD-CODE (V1) = 'L')
 16592                 END-PERFORM
 16593                 IF V1 < +9
 16594                    MOVE PD-MAX-AMT (V1)
 16595                                 TO CP-R-MAX-TOT-BEN
 16596                                    EC-AM-LF-MAX-TOT-BEN
 16597                 END-IF
 16598              END-IF
 16599           END-IF
 16600           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16601        END-IF
 16602        END-IF
 16603     END-IF
 16604     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 16605
 16606     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 16607
 16608     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16609                                    PB-C-LF-REM-TERM.
 16610
 16611     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 16612     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 16613
 16614     IF PB-COMPANY-ID EQUAL 'FLC'
 16615        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 16616           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 16617           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 16618                    + PB-CI-LF-ALT-PREMIUM-AMT)
 16619                    - CM-LF-ITD-DEATH-AMT
 16620           IF PB-C-LF-REF-CALC LESS THAN +0
 16621              MOVE +0            TO PB-C-LF-REF-CALC
 16622              GO TO 3730-GET-AH-REMAIN-TERM
 16623           ELSE
 16624              GO TO 3730-GET-AH-REMAIN-TERM.
 16625
 16626     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16627                            OR '4' OR '5' OR '6' OR '8'
 16628                            OR '9' OR 'G'
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 300
* EL050.cbl
 16629        MOVE PB-C-LF-REFUND-OVERRIDE
 16630                                 TO CP-EARNING-METHOD.
 16631
 16632     if pb-company-id = 'AHL'
 16633        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 16634        if cp-class-code = spaces
 16635           move zeros            to cp-class-code
 16636        end-if
 16637     ELSE
 16638        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16639     END-IF
 16640*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16641     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 16642     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16643                                    CP-RATING-BENEFIT-AMT.
 16644     IF CP-STATE-STD-ABBRV = 'OR'
 16645         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16646                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16647     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16648     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16649     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16650     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 16651     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 16652     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16653     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16654     IF WS-DEFAULT-APR NOT NUMERIC
 16655         MOVE ZEROS TO WS-DEFAULT-APR.
 16656****   N O T E   ****
 16657*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 16658*      THE OH HARD CODING IN ELCRFNDP
 16659
 16660     IF PB-COMPANY-ID = 'CID'
 16661        IF CP-STATE-STD-ABBRV = 'OH'
 16662           MOVE WS-LF-EARNINGS-CALC
 16663                                 TO CP-EARNING-METHOD
 16664        END-IF
 16665     END-IF
 16666
 16667****   N O T E   ****
 16668
 16669*    IF CP-EARN-AS-NET-PAY
 16670*        IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16671*           IF WS-DEFAULT-APR GREATER THAN ZEROS
 16672*               MOVE WS-DEFAULT-APR
 16673*                                TO  CP-LOAN-APR
 16674*               MOVE ER-3780     TO  WS-ERROR
 16675*               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16676*           ELSE
 16677*               MOVE ER-3781     TO  WS-ERROR
 16678*               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16679*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 16680     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16681
 16682     IF CP-REFUND-TYPE-USED NOT = SPACE
 16683         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 16684
 16685     IF CP-ERROR-RATE-IS-ZERO OR
 16686        CP-ERROR-RATE-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 301
* EL050.cbl
 16687        MOVE ER-2740             TO WS-ERROR
 16688        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16689
 16690     IF CP-ERROR-RATE-FILE-NOTOPEN
 16691        MOVE ER-2617             TO WS-ERROR
 16692        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16693
 16694     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 16695        AND PB-CI-ENTRY-STATUS = 'M'
 16696        MOVE +0                  TO PB-C-LF-REF-CALC
 16697     ELSE
 16698        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 16699     END-IF
 16700
 16701     IF WS-LF-EARNINGS-CALC NOT = 'B'
 16702         GO TO 3730-GET-AH-REMAIN-TERM.
 16703
 16704*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 16705*       ADD +1                   TO PB-C-LF-REM-TERM
 16706*                                   CP-REMAINING-TERM
 16707*                                   CP-ORIGINAL-TERM.
 16708
 16709     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 16710     MOVE '2'                    TO CP-EARNING-METHOD
 16711                                    CP-RATING-METHOD.
 16712     IF PB-COMPANY-ID = 'CID'
 16713        IF (CP-STATE-STD-ABBRV = 'MN')
 16714           AND (PB-CERT-EFF-DT > X'A4FF')
 16715           AND (WS-LF-EARNINGS-CALC = 'B')
 16716           MOVE '5'              TO CP-EARNING-METHOD
 16717           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 16718        END-IF
 16719     END-IF
 16720     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16721                                        CP-REMAINING-BENEFIT
 16722                                        CP-RATING-BENEFIT-AMT.
 16723     IF CP-STATE-STD-ABBRV = 'OR'
 16724         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16725                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16726     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16727     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16728
 16729     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16730
 16731     IF CP-ERROR-RATE-IS-ZERO OR
 16732        CP-ERROR-RATE-NOT-FOUND
 16733        MOVE ER-2740             TO WS-ERROR
 16734        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16735
 16736     IF CP-ERROR-RATE-FILE-NOTOPEN
 16737        MOVE ER-2617             TO WS-ERROR
 16738        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16739
 16740     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16741
 16742******************************************************************
 16743
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 302
* EL050.cbl
 16745 3730-GET-AH-REMAIN-TERM.
 16746     IF NO-AH-BENEFIT-MATCH  OR
 16747        WS-AH-BENEFIT-CD = ZEROS
 16748         GO TO 3770-CHECK-REFUNDS.
 16749
 16750     IF PB-CI-AH-LUMP-SUM-DISAB
 16751         IF  PB-C-AH-CANCEL-AMT = ZERO
 16752            IF NOT PB-COMP-AH-CANCEL
 16753             GO TO 3770-CHECK-REFUNDS.
 16754
 16755     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16756     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16757     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16758     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16759     MOVE PB-SV-STATE            TO CP-STATE.
 16760     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16761     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16762     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16763     MOVE '2'                    TO CP-PROCESS-TYPE.
 16764     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16765     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16766     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16767     IF (PB-COMPANY-ID = 'CID')
 16768        AND (CP-STATE-STD-ABBRV = 'WI')
 16769        MOVE '7'                 TO CP-REM-TERM-METHOD
 16770        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16771     ELSE
 16772        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16773        MOVE WS-REM-TRM-CALC-OPTION
 16774                                 TO CP-REM-TRM-CALC-OPTION
 16775     END-IF
 16776     IF (PB-COMPANY-ID = 'CID')
 16777        AND (CP-STATE-STD-ABBRV = 'MO')
 16778        AND (PB-CERT-EFF-DT >= X'9B41')
 16779        AND (PB-CERT-EFF-DT <= X'A2FB')
 16780        MOVE '7'                 TO CP-REM-TERM-METHOD
 16781        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16782     END-IF
 16783     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16784                                    CP-LOAN-TERM.
 16785     IF NOT CP-TERM-IS-DAYS
 16786         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16787
 16788     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16789
 16790     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16791
 16792     IF AH-COVERAGE-CANCELLED
 16793        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16794        NEXT SENTENCE
 16795      ELSE
 16796         GO TO 3770-CHECK-REFUNDS.
 16797
 16798 3740-GET-AH-REFUND.
 16799
 16800     IF PB-C-AH-CANCEL-VOIDED
 16801        GO TO 3780-UPDATE-CANCEL-CERT
 16802     END-IF
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 303
* EL050.cbl
 16803
 16804     IF PB-COMPANY-ID = 'BOA'
 16805         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16806         GO TO 3770-CHECK-REFUNDS.
 16807
 16808     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16809*    MOVE ' '                    TO DC-OPTION-CODE
 16810     SET BIN-TO-GREG             TO TRUE
 16811     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16812     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16813                                    PB-C-AH-REM-TERM.
 16814     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16815     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16816
 16817     IF PB-COMPANY-ID EQUAL 'FLC'
 16818        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16819           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16820           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16821                    - CM-AH-ITD-AH-PMT)
 16822           IF PB-C-AH-REF-CALC LESS THAN +0
 16823              MOVE +0            TO PB-C-AH-REF-CALC
 16824              GO TO 3770-CHECK-REFUNDS
 16825           ELSE
 16826              GO TO 3770-CHECK-REFUNDS.
 16827
 16828     IF PB-COMPANY-ID = 'DCC'
 16829        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16830            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16831           MOVE 'S'              TO CP-EARNING-METHOD
 16832        END-IF
 16833     END-IF
 16834     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16835                            OR '4' OR '5' OR '6' OR '8'
 16836                            OR '9' OR 'G' OR 'S'
 16837        MOVE PB-C-AH-REFUND-OVERRIDE
 16838                                 TO CP-EARNING-METHOD.
 16839
 16840     if pb-company-id = 'AHL'
 16841        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16842        if cp-class-code = spaces
 16843           move zeros            to cp-class-code
 16844        end-if
 16845     ELSE
 16846        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16847     END-IF
 16848*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16849     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16850     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16851                                    CP-RATING-BENEFIT-AMT.
 16852     IF CP-STATE-STD-ABBRV = 'OR'
 16853         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16854                                         PB-CI-AH-TERM.
 16855     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16856     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16857     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16858     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16859     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16860     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 304
* EL050.cbl
 16861
 16862     IF CP-STATE-STD-ABBRV = 'OH'
 16863        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16864                                AND 'CID' AND 'DCC' and 'VPP'
 16865                                AND 'AHL')
 16866           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16867              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16868              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16869              MOVE '6' TO CP-EARNING-METHOD
 16870           END-IF
 16871        END-IF
 16872        IF PB-COMPANY-ID = 'CID'
 16873           IF NO-LIFE-COVERAGE
 16874              IF CP-CRITICAL-PERIOD
 16875                 MOVE '2'       TO CP-EARNING-METHOD
 16876              ELSE
 16877                 MOVE '6'       TO CP-EARNING-METHOD
 16878              END-IF
 16879           ELSE
 16880              IF WS-LF-COVERAGE-TYPE = 'L'
 16881                 MOVE '2'       TO CP-EARNING-METHOD
 16882              ELSE
 16883                 IF (PB-CI-LF-TERM > +60) OR
 16884                    (WS-LF-EARNINGS-CALC = '5')
 16885                    IF CP-CRITICAL-PERIOD
 16886                       MOVE '2'  TO CP-EARNING-METHOD
 16887                    ELSE
 16888                       MOVE '6'  TO CP-EARNING-METHOD
 16889                    END-IF
 16890                 ELSE
 16891                    MOVE '1'     TO CP-EARNING-METHOD
 16892                 END-IF
 16893              END-IF
 16894           END-IF
 16895        END-IF
 16896     END-IF
 16897
 16898*    IF CP-STATE-STD-ABBRV = 'VA'
 16899*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16900*          IF CP-ORIGINAL-TERM GREATER 61
 16901*             MOVE '6' TO CP-EARNING-METHOD
 16902*          ELSE
 16903*             MOVE '1' TO CP-EARNING-METHOD.
 16904
 16905     IF WS-DEFAULT-APR NOT NUMERIC
 16906         MOVE ZEROS TO WS-DEFAULT-APR.
 16907     IF CP-EARN-AS-NET-PAY
 16908         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16909            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16910                MOVE WS-DEFAULT-APR
 16911                                 TO  CP-LOAN-APR
 16912                MOVE ER-3780     TO  WS-ERROR
 16913                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16914            ELSE
 16915                MOVE ER-3781     TO  WS-ERROR
 16916                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16917     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16918     IF PB-COMPANY-ID = 'DCC'
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 305
* EL050.cbl
 16919        AND CP-CANCEL-REASON = 'R'
 16920        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16921        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16922     END-IF
 16923     IF PB-COMPANY-ID = 'DCC'
 16924        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16925        AND (CP-EARNING-METHOD = 'D')
 16926        AND (CP-CANCEL-REASON NOT = 'R')
 16927        CONTINUE
 16928     ELSE
 16929        GO TO 3750-CONTINUE
 16930     END-IF
 16931     MOVE ' '                    TO DD-IU-SW
 16932     IF NOT PDEF-MASTER-FOUND
 16933        MOVE ' '                 TO PDEF-MASTER-SW
 16934        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16935        MOVE PB-STATE            TO ERPDEF-STATE
 16936        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
 16937           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16938        END-IF
 16939        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16940        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16941        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16942        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16943        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16944        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16945        IF PDEF-MASTER-FOUND
 16946           MOVE 'N'              TO PDEF-MASTER-SW
 16947           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16948           IF PDEF-MASTER-FOUND
 16949              IF (ERPDEF-KEY-SAVE (1:16) =
 16950                           PD-CONTROL-PRIMARY (1:16))
 16951                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16952                 CONTINUE
 16953              ELSE
 16954                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16955                 IF (ERPDEF-KEY-SAVE (1:16) =
 16956                           PD-CONTROL-PRIMARY (1:16))
 16957                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16958                    CONTINUE
 16959                 ELSE
 16960                    MOVE ER-2740 TO WS-ERROR
 16961                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16962                    GO TO 3770-CHECK-REFUNDS
 16963                 END-IF
 16964              END-IF
 16965           END-IF
 16966           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16967        END-IF
 16968     END-IF
 16969     IF PDEF-MASTER-FOUND
 16970        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16971           (V1 > +8)
 16972           OR (PD-PROD-CODE (V1) = 'I')
 16973        END-PERFORM
 16974        IF V1 < +9
 16975           SET DD-IU-PRESENT        TO TRUE
 16976        END-IF
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 306
* EL050.cbl
 16977        IF WS-AH-DCC-TRUNC = 'T'
 16978           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16979        ELSE
 16980           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 16981        END-IF
 16982        EVALUATE TRUE
 16983           WHEN WS-TERM > +168
 16984              MOVE 15               TO V1
 16985           WHEN WS-TERM > +156
 16986              MOVE 14               TO V1
 16987           WHEN WS-TERM > +144
 16988              MOVE 13               TO V1
 16989           WHEN WS-TERM > +132
 16990              MOVE 12               TO V1
 16991           WHEN WS-TERM > +120
 16992              MOVE 11               TO V1
 16993           WHEN WS-TERM > +108
 16994              MOVE 10               TO V1
 16995           WHEN WS-TERM > +96
 16996              MOVE 9                TO V1
 16997           WHEN WS-TERM > +84
 16998              MOVE 8                TO V1
 16999           WHEN WS-TERM > +72
 17000              MOVE 7                TO V1
 17001           WHEN WS-TERM > +60
 17002              MOVE 6                TO V1
 17003           WHEN WS-TERM > +48
 17004              MOVE 5                TO V1
 17005           WHEN WS-TERM > +36
 17006              MOVE 4                TO V1
 17007           WHEN WS-TERM > +24
 17008              MOVE 3                TO V1
 17009           WHEN WS-TERM > +12
 17010              MOVE 2                TO V1
 17011           WHEN OTHER
 17012              MOVE 1                TO V1
 17013        END-EVALUATE
 17014
 17015        EVALUATE TRUE
 17016*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 17017*             < +13)
 17018*             AND (DD-IU-PRESENT)
 17019*             MOVE 2                TO V2
 17020*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 17021*             MOVE 1                TO V2
 17022           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 17023              MOVE 2                TO V2
 17024           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 17025              MOVE 3                TO V2
 17026           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 17027              MOVE 4                TO V2
 17028           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 17029              MOVE 5                TO V2
 17030           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 17031              MOVE 6                TO V2
 17032           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 17033              MOVE 7                TO V2
 17034           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 307
* EL050.cbl
 17035              MOVE 8                TO V2
 17036           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 17037              MOVE 9                TO V2
 17038           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 17039              MOVE 10               TO V2
 17040           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 17041              MOVE 11               TO V2
 17042           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 17043              MOVE 12               TO V2
 17044           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 17045              MOVE 13               TO V2
 17046           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 17047              MOVE 14               TO V2
 17048           WHEN OTHER
 17049              MOVE 15               TO V2
 17050        END-EVALUATE
 17051
 17052        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 17053                                 TO CP-DDF-LO-FACT
 17054        MOVE PD-UEP-FACTOR (V1 V2)
 17055                                 TO CP-DDF-HI-FACT
 17056
 17057        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 17058        MOVE CM-AH-CLP     TO CP-DDF-CLP
 17059        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 17060           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 17061        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 17062        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 17063        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 17064           + PD-1ST-YR-ADMIN-ALLOW
 17065
 17066        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 17067*       IF PI-CLP-YN = 'Y'
 17068*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 17069*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 17070*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 17071*       END-IF
 17072
 17073        IF DD-IU-PRESENT
 17074           MOVE 'I'              TO CP-EARNING-METHOD
 17075        END-IF
 17076        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 17077                                     CP-CLP-RATE-UP
 17078        IF CP-IU-RATE-UP NOT = ZEROS
 17079           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 17080              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 17081           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 17082              / (1 - WS-WORK-FACT)
 17083        END-IF
 17084     END-IF
 17085     .
 17086 3750-CONTINUE.
 17087     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 17088
 17089     IF CP-REFUND-TYPE-USED NOT = SPACE
 17090         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 17091
 17092     IF CP-ERROR-RATE-IS-ZERO OR
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 308
* EL050.cbl
 17093        CP-ERROR-RATE-NOT-FOUND
 17094        MOVE ER-2740             TO WS-ERROR
 17095        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17096
 17097     IF CP-ERROR-RATE-FILE-NOTOPEN
 17098        MOVE ER-2617             TO WS-ERROR
 17099        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17100     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17101        AND (PB-CI-ENTRY-STATUS = 'M')
 17102        MOVE +0                  TO PB-C-AH-REF-CALC
 17103     ELSE
 17104        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 17105     END-IF
 17106     if pb-company-id = 'VPP'
 17107        MOVE cm-ah-clp           to cp-original-premium
 17108        move zeros               to cp-calc-refund
 17109        perform 7600-get-refund  thru 7600-exit
 17110        if pb-c-ah-cancel-amt > pb-ci-cancel-fee
 17111           move cp-calc-refund   to pb-c-ah-rfnd-clp
 17112        else
 17113           move zeros            to pb-c-ah-rfnd-clp
 17114        end-if
 17115        display ' vpp ref clp ' cm-cert-no ' ' cm-ah-clp ' '
 17116           pb-c-ah-rfnd-clp ' ' pb-c-ah-cancel-amt ' '
 17117           pb-ci-cancel-fee
 17118     end-if
 17119     IF PB-COMPANY-ID = 'DCC'
 17120        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 17121        AND (CP-EARNING-METHOD = 'D' OR 'I')
 17122        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 17123        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 17124        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 17125        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 17126        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 17127        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 17128*       if pb-c-cancel-amt < +0
 17129*          compute pb-c-ah-rfnd-clp = pb-c-ah-rfnd-clp * -1
 17130*       end-if
 17131*       DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 17132     END-IF
 17133     .
 17134 3770-CHECK-REFUNDS.
 17135
 17136     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 17137        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17138           MOVE ER-2766          TO WS-ERROR
 17139           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17140           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 17141           IF PB-C-LF-REF-CALC LESS THAN ZERO
 17142              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 17143
 17144     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 17145        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17146           MOVE ER-2766          TO WS-ERROR
 17147           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17148           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 17149           IF PB-C-AH-REF-CALC LESS THAN ZERO
 17150              MOVE ZEROS         TO PB-C-AH-REF-CALC.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 309
* EL050.cbl
 17151
 17152     IF PB-COMP-LF-CANCEL
 17153        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 17154        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 17155           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 17156              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 17157
 17158     IF PB-COMP-AH-CANCEL
 17159        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 17160        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 17161           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 17162              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 17163
 17164     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 17165             GIVING WS-UNSIGN-WRK1
 17166     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 17167             GIVING WS-UNSIGN-WRK2.
 17168
 17169     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17170         MOVE ZERO TO WS-UNSIGN-WRK1.
 17171
 17172     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17173         MOVE ZERO TO WS-UNSIGN-WRK2.
 17174
 17175     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 17176
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 310
* EL050.cbl
 17178
 17179 3772-CONTINUE.
 17180
 17181**********************************
 17182*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 17183*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 17184*** DOUBLES THE TOLERANCE AMOUNT.
 17185***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 17186**********************************
 17187     IF PB-COMPANY-ID = 'MON' or 'CID' or 'DCC' or 'VPP'
 17188     IF WS-UNSIGN-WRK3 >= WS-TOL-LF-REFUND
 17189         IF WS-REF-REJECT-SW = SPACE
 17190             MOVE ER-2754        TO WS-ERROR
 17191             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17192           ELSE
 17193             MOVE ER-2736        TO WS-ERROR
 17194             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17195**********************************
 17196
 17197 3773-CONTINUE.
 17198
 17199     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 17200        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 17201           MOVE ER-2723          TO WS-ERROR
 17202           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17203
 17204     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 17205        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 17206           MOVE ER-2724          TO WS-ERROR
 17207           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17208
 17209     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 17210         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 17211             (1 + WS-LF-REFUND-OVS-PCT)
 17212     ELSE
 17213         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 17214
 17215     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 17216         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 17217             (1 - WS-TOL-LF-REFUND-PCT)
 17218     ELSE
 17219         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 17220
 17221     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17222        AND (PB-CI-ENTRY-STATUS = 'M')
 17223        AND (PB-C-LF-CANCEL-AMT > +0)
 17224        MOVE ER-3843             TO WS-ERROR
 17225        PERFORM 9900-ERROR-FORMAT
 17226                                 THRU 9900-EXIT
 17227     END-IF
 17228     EVALUATE TRUE
 17229        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 17230           CONTINUE
 17231        WHEN PB-C-LF-CANCEL-AMT = +0
 17232                 AND PB-C-LF-REF-CALC > +0
 17233           CONTINUE
 17234        WHEN WS-LF-REFUND-OVS-AMT = 0
 17235                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 311
* EL050.cbl
 17236           CONTINUE
 17237        WHEN OTHER
 17238           IF WS-TOL-LF-REFUND  = +0
 17239              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 17240           END-IF
 17241           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 17242                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 17243                          (PB-C-LF-CANCEL-AMT))
 17244              CONTINUE
 17245           ELSE
 17246              IF WS-LF-REFUND-OVS-AMT = +0
 17247                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 17248              END-IF
 17249              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 17250                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 17251                                       PB-C-LF-CANCEL-AMT)
 17252                 CONTINUE
 17253              ELSE
 17254                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17255                   MOVE ER-2754   TO  WS-ERROR
 17256                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17257                 ELSE
 17258                    MOVE ER-2736   TO  WS-ERROR
 17259                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17260                 END-IF
 17261              END-IF
 17262           END-IF
 17263     END-EVALUATE.
 17264
 17265     EVALUATE TRUE
 17266        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 17267           CONTINUE
 17268        WHEN PB-C-LF-CANCEL-AMT = +0
 17269                 AND PB-C-LF-REF-CALC > +0
 17270           CONTINUE
 17271        WHEN OTHER
 17272           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 17273               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 17274              CONTINUE
 17275           ELSE
 17276              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 17277               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 17278                CONTINUE
 17279              ELSE
 17280                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17281                     MOVE ER-2754   TO  WS-ERROR
 17282                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17283                 ELSE
 17284                     MOVE ER-2736   TO  WS-ERROR
 17285                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17286                 END-IF
 17287              END-IF
 17288           END-IF
 17289     END-EVALUATE.
 17290
 17291     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 17292         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 17293             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 312
* EL050.cbl
 17294     ELSE
 17295         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 17296
 17297     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 17298         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 17299             (1 - WS-TOL-AH-REFUND-PCT)
 17300     ELSE
 17301         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 17302
 17303     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17304        AND (PB-CI-ENTRY-STATUS = 'M')
 17305        AND (PB-C-AH-CANCEL-AMT > +0)
 17306        MOVE ER-3843             TO WS-ERROR
 17307        PERFORM 9900-ERROR-FORMAT
 17308                                 THRU 9900-EXIT
 17309     END-IF
 17310     EVALUATE TRUE
 17311        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 17312           CONTINUE
 17313*       WHEN PB-C-AH-REF-CALC = +0 AND
 17314*                  PB-C-AH-CANCEL-AMT > +0
 17315        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 17316                   PB-C-AH-REF-CALC > +0
 17317           CONTINUE
 17318        WHEN WS-AH-REFUND-OVS-AMT = +0
 17319                AND WS-TOL-AH-REFUND = +0
 17320           CONTINUE
 17321        WHEN OTHER
 17322           IF WS-TOL-AH-REFUND = +0
 17323              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 17324           END-IF
 17325           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 17326               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 17327                                         PB-C-AH-CANCEL-AMT)
 17328              CONTINUE
 17329           ELSE
 17330              IF WS-AH-REFUND-OVS-AMT = +0
 17331                 MOVE +9999999.99 TO
 17332                         WS-AH-REFUND-OVS-AMT
 17333              END-IF
 17334              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 17335                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 17336                                         PB-C-AH-CANCEL-AMT)
 17337                 CONTINUE
 17338              ELSE
 17339                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17340                    MOVE ER-2754   TO  WS-ERROR
 17341                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17342                 ELSE
 17343                    MOVE ER-2736   TO  WS-ERROR
 17344                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17345                 END-IF
 17346              END-IF
 17347           END-IF
 17348     END-EVALUATE.
 17349
 17350     EVALUATE TRUE
 17351        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 313
* EL050.cbl
 17352           CONTINUE
 17353*       WHEN PB-C-AH-REF-CALC > +0 AND
 17354*                  PB-C-AH-CANCEL-AMT = +0
 17355        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 17356                   PB-C-AH-REF-CALC = +0
 17357           CONTINUE
 17358        WHEN OTHER
 17359           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 17360               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 17361              CONTINUE
 17362           ELSE
 17363              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 17364                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 17365                 CONTINUE
 17366              ELSE
 17367                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17368                     MOVE ER-2754   TO  WS-ERROR
 17369                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17370                 ELSE
 17371                     MOVE ER-2736   TO  WS-ERROR
 17372                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17373                 END-IF
 17374              END-IF
 17375           END-IF
 17376     END-EVALUATE.
 17377
 17378     IF (PB-C-LF-CANCEL-AMT = ZERO)
 17379        AND (PB-C-AH-CANCEL-AMT = ZERO)
 17380        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17381           AND  PB-C-LF-REF-CALC < +1.00
 17382           AND  PB-C-AH-REF-CALC < +1.00
 17383           CONTINUE
 17384        ELSE
 17385           IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17386              AND (PB-CI-ENTRY-STATUS = 'M')
 17387              CONTINUE
 17388           ELSE
 17389              MOVE ER-2741       TO WS-ERROR
 17390              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17391           END-IF
 17392        END-IF
 17393     END-IF
 17394
 17395     IF (PB-C-LF-CANCEL-AMT = ZERO
 17396        AND WS-LF-BENEFIT-CD NOT = ZERO
 17397        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 17398        AND PB-C-LF-REF-CALC NOT = ZERO)
 17399        OR
 17400        (PB-C-LF-CANCEL-AMT = ZERO
 17401        AND WS-LF-BENEFIT-CD NOT = ZERO
 17402        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 17403             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17404                AND PB-C-LF-REF-CALC LESS THAN +1.00
 17405                NEXT SENTENCE
 17406             ELSE
 17407                MOVE ER-2739        TO WS-ERROR
 17408                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17409
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 314
* EL050.cbl
 17410     IF (PB-C-AH-CANCEL-AMT = ZERO
 17411        AND WS-AH-BENEFIT-CD NOT = ZERO
 17412        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 17413        AND PB-C-AH-REF-CALC NOT = ZERO)
 17414        OR
 17415        (PB-C-AH-CANCEL-AMT = ZERO
 17416        AND WS-AH-BENEFIT-CD NOT = ZERO
 17417        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 17418             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17419                AND PB-C-AH-REF-CALC LESS THAN +1.00
 17420                NEXT SENTENCE
 17421             ELSE
 17422                MOVE ER-2738        TO WS-ERROR
 17423                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17424
 17425 3775-OVER-REF-CHK.
 17426
 17427     IF PB-CI-ENTRY-STATUS = '5'
 17428        GO TO 3780-UPDATE-CANCEL-CERT.
 17429
 17430     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 17431                              PB-CI-LF-ALT-PREMIUM-AMT.
 17432
 17433     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17434        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17435                                 PB-C-LF-REF-CALC
 17436      ELSE
 17437        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17438                                 PB-C-LF-CANCEL-AMT.
 17439
 17440     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 17441        MOVE ER-2755             TO WS-ERROR
 17442        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17443
 17444     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 17445
 17446     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17447        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17448                                 PB-C-AH-REF-CALC
 17449      ELSE
 17450        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17451                                 PB-C-AH-CANCEL-AMT.
 17452
 17453     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 17454        MOVE ER-2778             TO WS-ERROR
 17455        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17456
 17457     IF PB-CI-OB-FLAG NOT = 'Z'
 17458        NEXT SENTENCE
 17459       ELSE
 17460         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17461            MOVE ER-2757           TO WS-ERROR
 17462            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17463
 17464 3780-UPDATE-CANCEL-CERT.
 17465
 17466     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 17467        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 315
* EL050.cbl
 17468        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17469
 17470     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 17471         MOVE ER-2729              TO WS-ERROR
 17472         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17473
 17474     IF PB-CI-LF-BENEFIT-CD = ZERO
 17475         GO TO 3780-UPDATE-CONT-1.
 17476
 17477     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 17478         GO TO 3780-UPDATE-CONT-1.
 17479
 17480     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17481       AND
 17482        (PB-C-LF-CANCEL-AMT NEGATIVE)
 17483       AND
 17484        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 17485       AND
 17486        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 17487            NEXT SENTENCE
 17488       ELSE
 17489        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17490          AND
 17491***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17492***       AND
 17493           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 17494            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17495               MOVE ER-2730      TO WS-ERROR
 17496               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17497               GO TO 3999-END-EDIT
 17498            ELSE
 17499               GO TO 3999-END-EDIT
 17500        ELSE
 17501            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 17502               MOVE ER-2765           TO WS-ERROR
 17503               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17504               GO TO 3785-CHECK-NH.
 17505*              GO TO 3999-END-EDIT.
 17506
 17507 3780-UPDATE-CONT-1.
 17508     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 17509
 17510     IF PB-CI-AH-BENEFIT-CD = ZERO
 17511         GO TO 3780-UPDATE-CONT-2.
 17512
 17513     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 17514         GO TO 3780-UPDATE-CONT-2.
 17515
 17516     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 17517
 17518     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17519       AND
 17520        (PB-C-AH-CANCEL-AMT NEGATIVE)
 17521       AND
 17522        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 17523       AND
 17524        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 17525            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 316
* EL050.cbl
 17526       ELSE
 17527        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17528          AND
 17529***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17530***       AND
 17531           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 17532           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 17533            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17534               MOVE ER-2773      TO WS-ERROR
 17535               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17536               GO TO 3999-END-EDIT
 17537            ELSE
 17538               GO TO 3999-END-EDIT
 17539            END-IF
 17540           ELSE
 17541             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17542                IF MSTR-CERT-NO = W-CL-CERT-NO
 17543                   MOVE ER-2890 TO WS-ERROR
 17544                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17545                   GO TO 3999-END-EDIT
 17546                ELSE
 17547                   MOVE ER-2898 TO WS-ERROR
 17548                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17549                   GO TO 3999-END-EDIT
 17550                END-IF
 17551             ELSE
 17552                GO TO 3785-CHECK-NH
 17553             END-IF
 17554           END-IF
 17555          ELSE
 17556            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 17557              IF WS-AH-CLAIM-RESCINDED = 'Y'
 17558                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17559                   IF MSTR-CERT-NO = W-CL-CERT-NO
 17560                      MOVE ER-2890 TO WS-ERROR
 17561                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17562                      GO TO 3999-END-EDIT
 17563                   ELSE
 17564                      MOVE ER-2898 TO WS-ERROR
 17565                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17566                      GO TO 3999-END-EDIT
 17567                   END-IF
 17568                ELSE
 17569                   MOVE ER-2765 TO WS-ERROR
 17570                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17571                   GO TO 3785-CHECK-NH
 17572                END-IF
 17573              ELSE
 17574               MOVE ER-2765      TO WS-ERROR
 17575               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17576               GO TO 3785-CHECK-NH.
 17577*              GO TO 3999-END-EDIT.
 17578
 17579 3780-UPDATE-CONT-2.
 17580
 17581     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 17582        AND WS-LF-BENEFIT-CD = ZERO
 17583           MOVE ER-2743           TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 317
* EL050.cbl
 17584           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17585
 17586     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 17587        AND WS-AH-BENEFIT-CD = ZERO
 17588           MOVE ER-2744           TO WS-ERROR
 17589           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17590
 17591     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 17592        (PB-C-AH-CANCEL-AMT NEGATIVE))
 17593        AND
 17594        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 17595         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
 17596           MOVE ER-2746           TO WS-ERROR
 17597           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17598
 17599     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 17600       AND
 17601        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 17602             MOVE ER-2737        TO WS-ERROR
 17603             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17604
 17605     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 17606       AND
 17607        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 17608             MOVE ER-2737        TO WS-ERROR
 17609             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17610
 17611     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 17612         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 17613             OR 'CID' OR 'DCC' or 'VPP' OR 'AHL'
 17614             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 17615         ELSE
 17616             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 17617                 MOVE ER-2768    TO WS-ERROR
 17618                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17619             ELSE
 17620                 MOVE ER-2756    TO WS-ERROR
 17621                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17622
 17623     IF CERT-PEND-ISSUE-RETURNED
 17624        MOVE ER-2772             TO WS-ERROR
 17625        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17626 3785-CHECK-NH.
 17627*    IF PB-STATE NOT = 'NH' and 'TN'
 17628     IF PB-STATE NOT = 'NH'
 17629        GO TO 3999-END-EDIT
 17630     END-IF
 17631
 17632     MOVE ER-2796                TO WS-ERROR
 17633     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 17634     IF (PB-C-REF-INTERFACE-SW = 'Y')
 17635        OR (CM-NH-INTERFACE-SW = 'Y')
 17636        MOVE ER-2793             TO WS-ERROR
 17637        PERFORM 9900-ERROR-FORMAT
 17638                                 THRU 9900-EXIT
 17639     END-IF
 17640     MOVE +0                     TO WS-PAYMENT-AMT
 17641     if pb-state = 'NH'
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 318
* EL050.cbl
 17642        IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR
 17643               PB-C-AH-CANCEL-DT
 17644           GO TO 3999-END-EDIT
 17645        END-IF
 17646     end-if
 17647***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17648***-_-
 17649***-_-   For TN it's only flat cancels
 17650***-_-
 17651***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17652     if pb-state = 'TN'
 17653        if ((pb-c-lf-cancel-dt <> low-values)
 17654           and (pb-c-lf-cancel-dt <> pb-cert-eff-dt))
 17655                      or
 17656           ((pb-c-ah-cancel-dt <> low-values)
 17657           and (pb-c-ah-cancel-dt <> pb-cert-eff-dt))
 17658           GO TO 3999-END-EDIT
 17659        END-IF
 17660     end-if
 17661     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 17662        GO TO 3999-END-EDIT
 17663     END-IF
 17664***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17665***-_-
 17666***-_-   if cancel date within 15 days of effective date, bypass
 17667***-_-
 17668***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17669     IF PB-STATE NOT = 'NH'
 17670        GO TO 3785-CONTINUE
 17671     END-IF
 17672     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 17673     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 17674     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 17675        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 17676     END-IF
 17677     MOVE '1'                    TO DC-OPTION-CODE
 17678     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17679     IF NO-CONVERSION-ERROR
 17680        IF DC-ELAPSED-DAYS < +16
 17681           GO TO 3999-END-EDIT
 17682        END-IF
 17683     END-IF
 17684***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17685***-_-
 17686***-_-   if cancel date within 30 days of current date then
 17687***-_-   bypass else subtract 15 days from period
 17688***-_-
 17689***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17690     MOVE +0                     TO DC-ELAPSED-DAYS
 17691     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 17692     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 17693     MOVE '1'                    TO DC-OPTION-CODE
 17694     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17695     IF NO-CONVERSION-ERROR
 17696        IF DC-ELAPSED-DAYS > +30
 17697           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 17698        ELSE
 17699           GO TO 3999-END-EDIT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 319
* EL050.cbl
 17700        END-IF
 17701     ELSE
 17702        GO TO 3999-END-EDIT
 17703     END-IF
 17704     .
 17705 3785-CONTINUE.
 17706     if pb-state = 'TN'
 17707        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 17708        MOVE PB-INPUT-DT         TO DC-BIN-DATE-2
 17709        MOVE '1'                 TO DC-OPTION-CODE
 17710        PERFORM 8500-DATE-CONVERT
 17711                                 THRU 8500-EXIT
 17712        IF no-CONVERSION-ERROR
 17713           IF DC-ELAPSED-DAYS < +16
 17714              GO TO 3999-END-EDIT
 17715           END-IF
 17716        END-IF
 17717     end-if
 17718***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17719***-_-
 17720***-_-   'NH' is 10%, TN is 3.5%
 17721***-_-
 17722***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17723     if pb-state = 'NH'
 17724        move +1.10               to ws-work-rate
 17725     else
 17726        move +1.035              to ws-work-rate
 17727     end-if
 17728     COMPUTE WS-PAYMENT-AMT ROUNDED =
 17729        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 17730           (ws-work-rate ** (DC-ELAPSED-DAYS / 365) - 1))
 17731     IF WS-PAYMENT-AMT < 600.00
 17732        GO TO 3999-END-EDIT
 17733     END-IF
 17734     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17735
 17736     IF (ERMAIL-FOUND = ' ')
 17737         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 17738         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 17739        GO TO 3999-END-EDIT
 17740     END-IF
 17741     MOVE ER-2795                TO WS-ERROR
 17742     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 17743
 17744     GO TO 3999-END-EDIT.
 17745******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 320
* EL050.cbl
 17747 3990-FILES-NOT-OPEN.
 17748
 17749     MOVE ER-2617                TO WS-ERROR.
 17750     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17751     GO TO 9990-RETURN.
 17752
 17753 3999-END-EDIT.
 17754
 17755     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 17756
 17757     IF PB-CANCELLATION AND CERT-WAS-FOUND
 17758         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 17759         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17760             PERFORM 9250-UNLOCK-RETURN
 17761             GO TO 9990-RETURN
 17762          ELSE
 17763             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17764             GO TO 9990-RETURN.
 17765
 17766     IF PB-CANCELLATION
 17767          GO TO 9990-RETURN.
 17768
 17769     IF CERT-WAS-NOT-FOUND
 17770        MOVE SPACES              TO CERTIFICATE-MASTER.
 17771
 17772     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 17773
 17774     IF CERT-WAS-FOUND
 17775         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17776             PERFORM 9250-UNLOCK-RETURN
 17777          ELSE
 17778            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17779      ELSE
 17780         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 17781
 17782*    if pb-company-id = 'VPP'
 17783*       perform 8150-read-elcrtt thru 8150-exit
 17784*       if ws-vehicle-odometer numeric
 17785*          if ws-vehicle-odometer > 6000
 17786*             move er-1583       to ws-error
 17787*             PERFORM 9900-ERROR-FORMAT
 17788*                                THRU 9900-EXIT
 17789*          end-if
 17790*       end-if
 17791*    end-if
 17792     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 17793        IF ((PB-COMPANY-ID = 'DCC')
 17794           AND (PB-CARRIER = '2' OR '4' OR '6'))
 17795                         or
 17796            (pb-company-id = 'CID' or 'VPP')
 17797            PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 17798        END-IF
 17799     END-IF.
 17800
 17801     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 17802         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 17803     END-IF.
 17804     move ' '                    to ws-ins-age-defaulted
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 321
* EL050.cbl
 17805     perform 8150-read-elcrtt    thru 8150-exit
 17806     if ws-ins-age-defaulted = 'Y'
 17807        move er-1573             to ws-error
 17808        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17809     end-if
 17810
 17811     if ws-jnt-age-defaulted = 'Y'
 17812        move er-1574             to ws-error
 17813        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17814     end-if
 17815***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17816***                                                           ****
 17817***  Set an error if the state requires verification of agent ****
 17818***  and agent hasn't verified yet and the status is not =    ****
 17819***  9,5,d and V and the term for lf or ah > 1 (not OB)       ****
 17820***  and the entry date > 09/01/2015.                         ****
 17821***                                                           ****
 17822***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17823     if (pb-input-dt >= X'AD81')    *> 09/01/2015
 17824        and (pb-i-entry-status not = '5' and 'D' and 'V')
 17825        and (pb-account (9:2) not = 'OB')
 17826        if (ws-st-agent-sig-edit = 'Y')
 17827           and (am-report-code-1 not = 'CONLEY')
 17828           evaluate true
 17829              when cs-agent-edit-status = 'C'
 17830                 move er-1743    to ws-error
 17831                 perform 9900-error-format
 17832                                 thru 9900-exit
 17833              when cs-agent-edit-status = 'S'
 17834                 move er-1744    to ws-error
 17835                 perform 9900-error-format
 17836                                 thru 9900-exit
 17837              when cs-agent-edit-status = 'M'
 17838                 move er-1745    to ws-error
 17839                 perform 9900-error-format
 17840                                 thru 9900-exit
 17841              when cs-agent-edit-status = 'R'
 17842                 move er-1747    to ws-error
 17843                 perform 9900-error-format
 17844                                 thru 9900-exit
 17845              when cs-agent-edit-status = 'N'
 17846                 move er-1748    to ws-error
 17847                 perform 9900-error-format
 17848                                 thru 9900-exit
 17849              when cs-agent-edit-status <> 'V' and 'U' and
 17850                                           'R' and 'N'
 17851                 move er-1746    to ws-error
 17852                 perform 9900-error-format
 17853                                 thru 9900-exit
 17854           end-evaluate
 17855        end-if
 17856     end-if
 17857     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 17858     IF ((PB-COMPANY-ID = 'DCC' or 'VPP')
 17859        AND (WS-NO-SECURE-PAY))
 17860                  OR
 17861        (WS-LF-SPECIAL-CALC-CD = 'O'
 17862        OR WS-AH-SPECIAL-CALC-CD = 'O')
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 322
* EL050.cbl
 17863        SET SKIP-ADDR-EDIT       TO TRUE
 17864     END-IF
 17865     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 17866        AND (NOT SKIP-ADDR-EDIT)
 17867        MOVE ER-2963             TO WS-ERROR
 17868        PERFORM 9900-ERROR-FORMAT
 17869                                 THRU 9900-EXIT
 17870        GO TO 9990-RETURN
 17871     END-IF
 17872     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 17873     IF ERPNDM-FOUND NOT = 'X'
 17874        move 'Y'                 to erpndm-unlock-sw
 17875        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17876           OR (PM-CITY        = SPACES OR LOW-VALUES)
 17877           OR (PM-STATE       = SPACES OR LOW-VALUES)
 17878           OR (PM-ZIP         = SPACES OR LOW-VALUES)
 17879           or (pm-zip-code    = zeros)
 17880           or (pm-zip-code not numeric))
 17881           AND (NOT SKIP-ADDR-EDIT)
 17882           MOVE ER-2694          TO WS-ERROR
 17883           PERFORM 9900-ERROR-FORMAT
 17884                                 THRU 9900-EXIT
 17885        END-IF
 17886        MOVE ' '                 TO STATE-RECORD-ERROR
 17887        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17888        MOVE PM-STATE            TO CNTL-ACCESS
 17889        MOVE '3'                 TO CNTL-REC-TYPE
 17890        MOVE +0                  TO CNTL-SEQ-NO
 17891        MOVE '0'                 TO RC-SW-2
 17892        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17893        IF (NO-STATE-RECORD)
 17894           OR (CF-RECORD-TYPE NOT = '3')
 17895           OR (PM-STATE NOT = CF-STATE-CODE)
 17896           IF (PM-STATE = SPACES)
 17897              AND (SKIP-ADDR-EDIT)
 17898              CONTINUE
 17899           ELSE
 17900              MOVE ER-2963       TO WS-ERROR
 17901              PERFORM 9900-ERROR-FORMAT
 17902                                 THRU 9900-EXIT
 17903           END-IF
 17904        END-IF
 17905        if (ws-error not = er-2963 and er-2694)
 17906           and (pm-city-st-zip-verified = ' ')
 17907           and (pb-company-id = 'CID')
 17908           move spaces           to zipcd-pass-area
 17909           move pm-zip-code      to pa-zip
 17910           move pm-city          to pa-city
 17911           move pm-state         to pa-state
 17912           perform 7790-call-zip-verify
 17913                                 thru 7790-exit
 17914           if pa-errorcode-zip (1:1) = ' '
 17915                    move 'Y'     to pm-city-st-zip-verified
 17916                    PERFORM 8102-REWRITE-ERPNDM
 17917                                 THRU 8102-EXIT
 17918                    move 'N'     to erpndm-unlock-sw
 17919           else
 17920              MOVE ER-3061       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 323
* EL050.cbl
 17921              PERFORM 9900-ERROR-FORMAT
 17922                                 THRU 9900-EXIT
 17923           end-if
 17924        end-if
 17925        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 17926           MOVE ER-2883          TO WS-ERROR
 17927           PERFORM 9900-ERROR-FORMAT
 17928                                 THRU 9900-EXIT
 17929        END-IF
 17930        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 17931           MOVE ' '                 TO STATE-RECORD-ERROR
 17932           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17933           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 17934           MOVE '3'                 TO CNTL-REC-TYPE
 17935           MOVE +0                  TO CNTL-SEQ-NO
 17936           MOVE '0'                 TO RC-SW-2
 17937           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17938           IF NO-STATE-RECORD
 17939              OR (CF-RECORD-TYPE NOT = '3')
 17940              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 17941              MOVE ER-2964          TO WS-ERROR
 17942              PERFORM 9900-ERROR-FORMAT
 17943                                    THRU 9900-EXIT
 17944           END-IF
 17945        END-IF
 17946     ELSE
 17947        IF NOT SKIP-ADDR-EDIT
 17948           MOVE ER-2393          TO WS-ERROR
 17949           PERFORM 9900-ERROR-FORMAT
 17950                                 THRU 9900-EXIT
 17951        END-IF
 17952     END-IF
 17953     if need-to-unlock-erpndm
 17954        perform 8104-unlock-erpndm
 17955                                 thru 8104-exit
 17956     end-if
 17957     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17958
 17959     IF (ERMAIL-FOUND = ' ' AND
 17960        ERPNDM-FOUND = ' ')
 17961        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 17962           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 17963           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 17964          OR
 17965           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 17966          OR
 17967           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 17968           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 17969           GO TO 3999-UNLOCK-ERMAIL.
 17970
 17971     IF ERPNDM-FOUND = 'X'
 17972        GO TO 3999-UNLOCK-ERMAIL.
 17973
 17974     IF PM-INSURED-LAST-NAME      = SPACES
 17975        AND PM-INSURED-FIRST-NAME = SPACES
 17976        AND PM-ADDRESS-LINE-1     = SPACES
 17977        AND PM-ADDRESS-LINE-2     = SPACES
 17978        AND PM-CITY-STATE         = SPACES
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 324
* EL050.cbl
 17979        AND PM-CRED-BENE-NAME     = SPACES
 17980        AND PM-CRED-BENE-ADDR     = SPACES
 17981        AND PM-CRED-BENE-CTYST    = SPACES
 17982        GO TO 3999-UNLOCK-ERMAIL
 17983     END-IF
 17984
 17985     MOVE SPACES                 TO MAILING-DATA.
 17986
 17987     MOVE 'MA'                   TO MA-RECORD-ID.
 17988     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 17989     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 17990     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 17991     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 17992     MOVE PB-SV-STATE            TO MA-STATE.
 17993     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 17994     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 17995
 17996     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 17997     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 17998
 17999     IF ERMAIL-FOUND = ' '
 18000        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 18001     ELSE
 18002        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 18003        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 18004        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 18005
 18006     GO TO 9990-RETURN.
 18007
 18008 3999-UNLOCK-ERMAIL.
 18009     IF ERMAIL-FOUND = ' '
 18010        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 18011
 18012     GO TO 9990-RETURN.
 18013******************************************************************
 18014
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 325
* EL050.cbl
 18016 4000-UPDATE-CANCELLED-CERT.
 18017     IF CERT-WAS-NOT-FOUND
 18018        GO TO 4299-EXIT.
 18019
 18020*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 18021     IF PB-C-NH-INT-ON-REFS > ZEROS
 18022        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 18023     END-IF
 18024     IF PB-C-REF-INTERFACE-SW = 'Y'
 18025        MOVE PB-C-REF-INTERFACE-SW
 18026                                 TO CM-NH-INTERFACE-SW
 18027     END-IF
 18028     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 18029     IF ERMAIL-FOUND = 'X'
 18030        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 18031        OR (MA-CITY        = SPACES OR LOW-VALUES)
 18032        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 18033        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 18034           MOVE ER-2694          TO WS-ERROR
 18035           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18036     END-IF
 18037
 18038     IF PB-C-POST-CARD-IND = 'Y'
 18039        MOVE +8                  TO SUB
 18040*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 18041        IF ERMAIL-FOUND = ' '
 18042           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 18043              (SUB > +7)
 18044              OR (MA-MAIL-STATUS (SUB) = '1')
 18045           END-PERFORM
 18046        END-IF
 18047        IF (SUB > +7)
 18048           OR (ERMAIL-FOUND = 'X')
 18049           MOVE ER-3789          TO WS-ERROR
 18050           PERFORM 9900-ERROR-FORMAT
 18051                                 THRU 9900-EXIT
 18052        END-IF
 18053     ELSE
 18054        MOVE 'N'                 TO PB-C-POST-CARD-IND
 18055     END-IF
 18056
 18057     IF ERMAIL-FOUND = ' '
 18058        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 18059     END-IF.
 18060
 18061     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 18062
 18063     IF PB-CI-OB-FLAG = 'Z'
 18064        GO TO 4150-SUMMARY-CERT-CANCEL.
 18065
 18066     IF PB-C-LF-CANCEL-VOIDED
 18067         PERFORM 4200-REVERSE-LF-CANCEL.
 18068     IF PB-C-AH-CANCEL-VOIDED
 18069         PERFORM 4200-REVERSE-AH-CANCEL.
 18070
 18071 4100-APPLY-LF-CANCEL.
 18072
 18073     MOVE +0                     TO WS-SUB.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 326
* EL050.cbl
 18074
 18075 4100-CHECK-LF-ERRORS.
 18076
 18077     ADD +1                       TO WS-SUB.
 18078
 18079     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 18080        IF LF-COVERAGE-CANCELLED
 18081           GO TO 4100-LF-CANCEL-CONT
 18082        ELSE
 18083           GO TO 4100-UPDATE-LF-COVERAGE.
 18084
 18085     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 18086                                   ER-2729 OR
 18087                                   ER-2730 OR
 18088                                   ER-2731 OR
 18089                                   ER-2732 OR
 18090                                   ER-2737 OR
 18091                                   ER-2740 OR
 18092                                   ER-2743 OR
 18093                                   ER-2749 OR
 18094                                   ER-2750 OR
 18095                                   ER-2755 OR
 18096                                   ER-2757 OR
 18097                                   ER-2760 OR
 18098                                   ER-2772 OR
 18099                                   ER-2774 OR
 18100                                   ER-2776 OR
 18101                                   ER-2794
 18102        GO TO 4100-UPDATE-LF-COVERAGE.
 18103
 18104     GO TO 4100-CHECK-LF-ERRORS.
 18105
 18106 4100-UPDATE-LF-COVERAGE.
 18107
 18108     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 18109     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 18110     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 18111        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 18112     END-IF
 18113     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 18114                                      TO CM-CREDIT-INTERFACE-SW-2.
 18115     IF CM-LF-CANCEL-DT = LOW-VALUE
 18116         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 18117
 18118     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 18119         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 18120                                         CM-LF-STATUS-AT-CANCEL.
 18121
 18122     GO TO 4100-APPLY-AH-CANCEL.
 18123
 18124 4100-LF-CANCEL-CONT.
 18125     IF PB-C-LF-CANCEL-VOIDED
 18126         GO TO 4100-APPLY-AH-CANCEL.
 18127
 18128     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 18129         GO TO 4100-APPLY-AH-CANCEL.
 18130
 18131     IF PB-C-LF-CANCEL-AMT GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 327
* EL050.cbl
 18132        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18133           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 18134        ELSE
 18135           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 18136
 18137     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 18138     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 18139
 18140     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 18141         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 18142
 18143     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 18144        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 18145         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 18146         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 18147
 18148     IF PB-RECORD-RETURNED
 18149        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18150      ELSE
 18151        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 18152
 18153 4100-APPLY-AH-CANCEL.
 18154
 18155     MOVE +0                      TO WS-SUB.
 18156
 18157 4100-CHECK-AH-ERRORS.
 18158
 18159     ADD +1                       TO WS-SUB.
 18160
 18161     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 18162        IF AH-COVERAGE-CANCELLED
 18163           GO TO 4100-AH-CANCEL-CONT
 18164        ELSE
 18165           GO TO 4100-UPDATE-AH-COVERAGE.
 18166
 18167     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 18168                                   ER-2729 OR
 18169                                   ER-2732 OR
 18170                                   ER-2737 OR
 18171                                   ER-2740 OR
 18172                                   ER-2744 OR
 18173                                   ER-2749 OR
 18174                                   ER-2750 OR
 18175                                   ER-2755 OR
 18176                                   ER-2757 OR
 18177                                   ER-2760 OR
 18178                                   ER-2771 OR
 18179                                   ER-2772 OR
 18180                                   ER-2773 OR
 18181                                   ER-2775 OR
 18182                                   ER-2777 OR
 18183                                   ER-2778 OR
 18184                                   ER-2794
 18185        GO TO 4100-UPDATE-AH-COVERAGE.
 18186
 18187     GO TO 4100-CHECK-AH-ERRORS.
 18188
 18189 4100-UPDATE-AH-COVERAGE.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 328
* EL050.cbl
 18190
 18191     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 18192     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 18193     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 18194     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 18195                                      TO CM-CREDIT-INTERFACE-SW-2.
 18196     IF CM-AH-CANCEL-DT = LOW-VALUE
 18197         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 18198
 18199     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 18200         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 18201                                         CM-AH-STATUS-AT-CANCEL.
 18202
 18203     IF LF-COVERAGE-CANCELLED
 18204         IF PB-RECORD-RETURNED
 18205              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 18206          ELSE
 18207              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 18208
 18209     GO TO 4299-EXIT.
 18210
 18211 4100-AH-CANCEL-CONT.
 18212     IF PB-C-AH-CANCEL-VOIDED
 18213         GO TO 4299-EXIT.
 18214
 18215     if cm-credit-interface-sw-2 = ' '
 18216        if pb-fatal-errors or pb-unforced-errors
 18217           move '4'              to cm-credit-interface-sw-2
 18218        else
 18219           move '1'              to cm-credit-interface-sw-2
 18220        end-if
 18221     end-if
 18222     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 18223         GO TO 4299-EXIT.
 18224
 18225     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 18226        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 18227           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 18228        ELSE
 18229           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 18230
 18231     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 18232     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 18233
 18234     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 18235         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 18236
 18237     IF CM-AH-STATUS-AT-CANCEL = SPACE
 18238         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 18239         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 18240
 18241     IF PB-RECORD-RETURNED
 18242        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 18243      ELSE
 18244        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 18245
 18246     GO TO 4299-EXIT.
 18247
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 329
* EL050.cbl
 18248 4150-SUMMARY-CERT-CANCEL.
 18249     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 18250
 18251     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18252        COMPUTE CM-LF-ITD-CANCEL-AMT =
 18253                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 18254     ELSE
 18255        COMPUTE CM-LF-ITD-CANCEL-AMT =
 18256                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 18257
 18258     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 18259        COMPUTE CM-AH-ITD-CANCEL-AMT =
 18260                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 18261     ELSE
 18262        COMPUTE CM-AH-ITD-CANCEL-AMT =
 18263                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 18264
 18265     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 18266        NEXT SENTENCE
 18267     ELSE
 18268        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 18269
 18270     GO TO 4299-EXIT.
 18271
 18272 4200-REVERSE-LF-CANCEL.
 18273     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 18274
 18275     IF CM-LF-CANCEL-APPLIED
 18276        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 18277        MOVE SPACES                TO CM-LF-EXIT-BATCH
 18278        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 18279
 18280     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 18281
 18282     IF PB-RECORD-RETURNED
 18283        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18284       ELSE
 18285        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 18286
 18287 4200-REVERSE-LF-EXIT.
 18288       EXIT.
 18289
 18290 4200-REVERSE-AH-CANCEL.
 18291     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 18292
 18293     IF CM-AH-CANCEL-APPLIED
 18294        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 18295        MOVE SPACES                TO CM-AH-EXIT-BATCH
 18296        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 18297
 18298     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 18299
 18300     IF PB-RECORD-RETURNED
 18301        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18302       ELSE
 18303        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 18304
 18305 4200-REVERSE-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 330
* EL050.cbl
 18306       EXIT.
 18307
 18308 4299-EXIT.
 18309       EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 331
* EL050.cbl
 18311
 18312 4500-UPDATE-NEW-CERT.
 18313     IF CERT-WAS-FOUND
 18314         NEXT SENTENCE
 18315       ELSE
 18316         GO TO 4520-BUILD-NEW-KEY.
 18317
 18318     IF  CLASIC-CREATED-CERT
 18319         GO TO 4999-EXIT.
 18320
 18321     IF  CERT-WAS-CREATED-FOR-CLAIM
 18322         GO TO 4520-BUILD-NEW-KEY.
 18323
 18324     IF CERT-ADDED-BATCH
 18325        IF CM-RECORD-ID = 'CM'
 18326            GO TO 4999-EXIT.
 18327
 18328 4520-BUILD-NEW-KEY.
 18329* BUILD CONTROL PRIMARY
 18330
 18331     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 18332                                       CM-COMPANY-CD-A1
 18333                                       CM-COMPANY-CD-A2
 18334                                       CM-COMPANY-CD-A4
 18335                                       CM-COMPANY-CD-A5.
 18336
 18337     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 18338     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 18339     MOVE PB-SV-STATE               TO CM-STATE.
 18340     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 18341     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 18342     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 18343     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 18344
 18345     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 18346
 18347     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 18348     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 18349     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 18350     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 18351
 18352     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 18353        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 18354
 18355     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 18356         MOVE PB-SV-STATE            TO CM-SSN-STATE
 18357         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 18358         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 18359         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 18360     ELSE
 18361         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 18362
 18363     IF PB-COMPANY-ID   EQUAL  'CRI'
 18364         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 18365         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 18366         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 18367         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 18368         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 332
* EL050.cbl
 18369
 18370     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 18371        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 18372         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 18373
 18374     IF PB-COMPANY-ID  = 'LBL'
 18375        IF PB-I-JOINT-COVERAGE
 18376            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 18377                                           PB-I-MEMBER-NO
 18378            GO TO 4550-CONT-CERT-PROCESS.
 18379
 18380     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 18381        NEXT SENTENCE
 18382     ELSE
 18383        GO TO 4540-BUILD-MEMBER-NO.
 18384
 18385******************************************************************
 18386*                                                                *
 18387*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 18388*    FOR 'MON'.                                                  *
 18389*                                                                *
 18390******************************************************************
 18391
 18392     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 18393     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 18394     MOVE +1                     TO WS-SUB1
 18395                                    WS-SUB2.
 18396
 18397 4530-EDIT-MEMB-NAME.
 18398
 18399     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 18400        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 18401        ADD +1                       TO WS-SUB2.
 18402
 18403     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 18404        ADD +1                       TO WS-SUB1
 18405        GO TO 4530-EDIT-MEMB-NAME.
 18406
 18407     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 18408     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 18409     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 18410*    MOVE SPACE                      TO DC-OPTION-CODE.
 18411     SET  BIN-TO-GREG                TO TRUE.
 18412     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18413     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 18414
 18415     GO TO 4550-CONT-CERT-PROCESS.
 18416
 18417******************************************************************
 18418*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 18419******************************************************************
 18420
 18421 4540-BUILD-MEMBER-NO.
 18422
 18423     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 18424         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 18425         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 18426         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 333
* EL050.cbl
 18427         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 18428     ELSE
 18429         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 18430
 18431     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 18432        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 18433         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 18434
 18435 4550-CONT-CERT-PROCESS.
 18436
 18437*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 18438*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 18439*    ELSE
 18440*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 18441
 18442     IF CERT-WAS-CREATED-FOR-CLAIM
 18443        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 18444        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 18445
 18446     IF CERT-AND-CLAIM-ONLINE
 18447        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 18448        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 18449
 18450     MOVE 'CM'                     TO CM-RECORD-ID.
 18451     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 18452
 18453     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 18454        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 18455        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 18456     ELSE
 18457        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 18458        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 18459
 18460     MOVE ZERO                     TO CM-LOAN-BALANCE.
 18461     MOVE '1'                      TO CM-PREMIUM-TYPE.
 18462     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 18463     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 18464     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 18465     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 18466     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 18467                                      CM-LF-ITD-CANCEL-AMT
 18468                                      CM-LF-ITD-DEATH-AMT
 18469                                      CM-AH-ITD-AH-PMT
 18470                                      CM-AH-ITD-LUMP-PMT
 18471                                      CM-AH-ITD-CANCEL-AMT
 18472                                      CM-LF-NSP-PREMIUM-AMT
 18473                                      CM-AH-NSP-PREMIUM-AMT.
 18474*                                     CM-CLAIM-DEDUCT-WITHHELD
 18475*                                     CM-CANCEL-DEDUCT-WITHHELD.
 18476     if pb-i-loan-apr = +99.9999
 18477        move zeros                 to cm-loan-apr
 18478     else
 18479        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 18480     end-if
 18481     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 18482     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 18483     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 18484     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 334
* EL050.cbl
 18485     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 18486     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 18487     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 18488     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 18489     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 18490     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 18491     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 18492
 18493     IF PB-I-LIVES NOT NUMERIC
 18494         MOVE ZERO                 TO PB-I-LIVES.
 18495
 18496     IF PB-I-NUM-BILLED NOT NUMERIC
 18497         MOVE ZERO                 TO PB-I-NUM-BILLED.
 18498
 18499     MOVE PB-I-LIVES               TO CM-LIVES.
 18500     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 18501
 18502     IF PB-COMPANY-ID EQUAL  'DMD'
 18503         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 18504         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 18505
 18506     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 18507     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 18508     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 18509     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 18510     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 18511     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 18512
 18513     IF PB-I-LF-POLICY-FEE NUMERIC
 18514        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 18515     ELSE
 18516        MOVE +0                    TO CM-LF-POLICY-FEE.
 18517
 18518     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18519        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 18520        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 18521     ELSE
 18522        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 18523
 18524     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 18525     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 18526     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 18527     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 18528     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 18529     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 18530     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 18531     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 18532     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 18533
 18534     IF PB-I-CANCEL-FEE NUMERIC
 18535        MOVE PB-I-CANCEL-FEE     TO CM-CANCEL-FEE
 18536     ELSE
 18537        MOVE +0                  TO CM-CANCEL-FEE
 18538     END-IF
 18539
 18540     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 18541        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 18542     ELSE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 335
* EL050.cbl
 18543        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 18544
 18545     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 18546     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 18547
 18548     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 18549                                      CM-LF-DEATH-EXIT-DT
 18550                                      CM-AH-SETTLEMENT-EXIT-DT.
 18551
 18552*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 18553*                       'TIH' OR 'OFL' OR 'FLA' OR
 18554*                       'TII' OR 'TMS' OR 'CRI' OR
 18555*                       'NCL'
 18556     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 18557
 18558     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 18559         IF WS-LF-SPECIAL-CALC-CD = 'O'
 18560            MOVE '2'                TO CM-PREMIUM-TYPE.
 18561
 18562     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 18563         IF WS-AH-SPECIAL-CALC-CD = 'O'
 18564            MOVE '2'                TO CM-PREMIUM-TYPE.
 18565
 18566     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 18567         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 18568     ELSE
 18569         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 18570         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 18571
 18572     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 18573     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 18574     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 18575     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 18576     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 18577     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 18578     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 18579     MOVE SPACE                     TO CM-PAYMENT-MODE.
 18580
 18581     IF PB-NO-MONTHS-SKIPPED
 18582         MOVE SPACE                 TO CM-SKIP-CODE
 18583     ELSE
 18584         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 18585
 18586     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 18587     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 18588                                       CM-LF-STATUS-AT-CANCEL.
 18589
 18590     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 18591     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 18592                                       CM-AH-STATUS-AT-CANCEL.
 18593
 18594     MOVE '1'                       TO CM-ENTRY-STATUS.
 18595
 18596     IF PB-REISSUED-CERT
 18597        MOVE '5'                    TO CM-ENTRY-STATUS.
 18598
 18599     IF PB-MONTHLY-CERT
 18600        MOVE 'M'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 336
* EL050.cbl
 18601
 18602     IF PB-CASH-CERT
 18603        MOVE 'C'                    TO CM-ENTRY-STATUS.
 18604
 18605     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 18606     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 18607     IF PB-POLICY-IS-DECLINED
 18608        MOVE 'D'                    TO CM-ENTRY-STATUS.
 18609
 18610     IF PB-POLICY-IS-VOIDED
 18611        MOVE 'V'                    TO CM-ENTRY-STATUS.
 18612
 18613     IF PB-NEEDS-UNDERWRITING
 18614        MOVE 'U'                    TO CM-ENTRY-STATUS.
 18615
 18616     IF PB-REIN-ONLY-CERT
 18617        MOVE '9'                    TO CM-ENTRY-STATUS.
 18618
 18619     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 18620         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 18621     ELSE
 18622         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 18623
 18624     IF PB-RECORD-RETURNED
 18625        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 18626      ELSE
 18627        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 18628
 18629     IF PB-I-MAIL-ADDRS-PRESENT
 18630        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 18631
 18632     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 18633                                       CM-ENTRY-DT.
 18634
 18635 4999-EXIT.
 18636     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 337
* EL050.cbl
 18638
 18639 5000-PROCESS-REPS.
 18640     MOVE ' '                    TO AGTC-MASTER-SW
 18641     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 18642     MOVE CO-TYPE                TO AGTC-TYPE
 18643     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 18644     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 18645     IF (AGTC-MASTER-SW NOT = 'N')
 18646        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 18647        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 18648        PERFORM 8583-READ-ERAGTC-NEXT
 18649                                 THRU 8583-EXIT
 18650     END-IF
 18651     IF AGTC-MASTER-SW = 'N'
 18652        CONTINUE
 18653     ELSE
 18654        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 18655           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 18656              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 18657              MOVE 'Y'           TO AGTC-MASTER-SW
 18658           END-IF
 18659        END-IF
 18660     END-IF
 18661     .
 18662 5000-EXIT.
 18663     EXIT.
 18664 6370-EDIT-INPUT-LF-CODE.
 18665     move ' ' to ws-benefit-cd-chg-sw
 18666     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 18667        MOVE +1                  TO SUB
 18668        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 18669        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18670        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18671        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18672        GO TO 6370-SEARCH-LOOP.
 18673
 18674     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18675
 18676     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18677     MOVE SPACES                 TO CNTL-ACCESS.
 18678*    MOVE 'L'                    TO CNTL-REC-TYPE.
 18679     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 18680     MOVE +0                     TO CNTL-SEQ-NO.
 18681     MOVE '4' TO RC-SW-2.
 18682     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18683
 18684     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18685        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18686        GO TO 6370-NO-LF-FOUND.
 18687
 18688     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 18689     MOVE +1                     TO SUB.
 18690
 18691 6370-SEARCH-LOOP.
 18692     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 18693         GO TO 6370-NO-LF-FOUND.
 18694
 18695     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 338
* EL050.cbl
 18696        if (pb-i-lf-benefit-cd not = zeros and spaces)
 18697           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 18698           set benefit-code-chg to true
 18699        end-if
 18700        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 18701        GO TO 6370-HER-NET-PAY-CHECK.
 18702
 18703     ADD 1   TO SUB.
 18704*    IF SUB GREATER 120
 18705     IF SUB GREATER 200
 18706         GO TO 6370-NO-LF-FOUND.
 18707
 18708     GO TO 6370-SEARCH-LOOP.
 18709
 18710 6370-NO-LF-FOUND.
 18711
 18712     if (pb-i-lf-benefit-cd not = zeros and spaces)
 18713        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 18714        set benefit-code-chg to true
 18715     end-if
 18716     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 18717
 18718 6370-HER-NET-PAY-CHECK.
 18719
 18720     IF PB-COMPANY-ID = 'CID'
 18721        IF PB-SV-STATE = 'CA' OR 'MN'
 18722           IF PB-I-LF-BENEFIT-CD = '02'
 18723              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 18724           ELSE
 18725              IF PB-I-LF-BENEFIT-CD = '04'
 18726                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 18727              END-IF
 18728           END-IF
 18729        END-IF
 18730     END-IF
 18731
 18732     IF PB-COMPANY-ID NOT = 'HER'
 18733         GO TO 6370-EXIT.
 18734
 18735     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 18736         GO TO 6370-EXIT.
 18737
 18738     IF PB-I-LF-TERM NOT NUMERIC
 18739         MOVE ZEROS              TO PB-I-LF-TERM.
 18740
 18741     IF PB-I-LOAN-TERM NOT NUMERIC
 18742         MOVE ZEROS              TO PB-I-LOAN-TERM.
 18743
 18744     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 18745         GO TO 6370-EXIT.
 18746
 18747     IF PB-I-LF-BENEFIT-CD = '33'
 18748         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 18749
 18750     IF PB-I-LF-BENEFIT-CD = '34'
 18751         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 18752
 18753 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 339
* EL050.cbl
 18754     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 340
* EL050.cbl
 18756
 18757 6380-EDIT-INPUT-AH-CODE.
 18758     IF WK-AH-EDIT-ADDR NOT = ZEROS
 18759        MOVE +1                  TO SUB
 18760        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 18761        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18762        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18763        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18764        GO TO 6380-SEARCH-LOOP.
 18765
 18766     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18767
 18768     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18769     MOVE SPACES                 TO CNTL-ACCESS.
 18770     MOVE 'A'                    TO CNTL-REC-TYPE.
 18771*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 18772     MOVE +0                     TO CNTL-SEQ-NO.
 18773     MOVE '5' TO RC-SW-2.
 18774     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18775
 18776     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18777        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18778        GO TO 6380-NO-AH-FOUND.
 18779
 18780     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 18781     MOVE +1 TO SUB.
 18782
 18783 6380-SEARCH-LOOP.
 18784     IF CF-AH-CODE-OUT (SUB) = ZEROS
 18785         GO TO 6380-NO-AH-FOUND.
 18786
 18787     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 18788         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 18789         GO TO 6380-CSO-AH-ONLY-CHECKS.
 18790
 18791     ADD 1   TO SUB.
 18792     IF SUB GREATER THAN 96
 18793*    IF SUB GREATER THAN 300
 18794         GO TO 6380-NO-AH-FOUND.
 18795
 18796     GO TO 6380-SEARCH-LOOP.
 18797
 18798 6380-NO-AH-FOUND.
 18799
 18800     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 18801
 18802     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 18803         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 18804     ELSE
 18805         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 18806
 18807 6380-CSO-AH-ONLY-CHECKS.
 18808
 18809     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 18810        NEXT SENTENCE
 18811      ELSE
 18812        GO TO 6380-EXIT.
 18813
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 341
* EL050.cbl
 18814     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 18815         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 18816
 18817
 18818     GO TO 6380-EXIT
 18819     .
 18820 6380-CSO-LIFE-WITH-AH-CHECKS.
 18821
 18822
 18823     .
 18824 6380-EXIT.
 18825     EXIT.
 18826
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 342
* EL050.cbl
 18828
 18829 6400-COMPUTE-EXTENSION-DAYS.
 18830
 18831******************************************************************
 18832*                                                                *
 18833*                   COMPUTE EXTENSION DAYS                       *
 18834*                                                                *
 18835*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 18836*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 18837*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 18838*    THE EXTENSION DAYS.                                         *
 18839*                                                                *
 18840******************************************************************
 18841
 18842     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 18843     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 18844
 18845******************************************************************
 18846*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 18847*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 18848******************************************************************
 18849
 18850     IF DC-ELAPSED-MONTHS GREATER THAN +0
 18851        COMPUTE WS-ODD-DAYS-OVER =
 18852               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 18853     ELSE
 18854        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 18855
 18856     IF WS-ODD-DAYS-OVER = ZEROS
 18857           GO TO 6499-EXIT
 18858     ELSE
 18859        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 18860           IF WS-WDF-MONTH = 02
 18861              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 18862              ADD 2       TO  WS-ODD-DAYS-OVER
 18863              GO TO 6499-EXIT
 18864           ELSE
 18865              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 18866                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 18867                 GO TO 6499-EXIT
 18868               ELSE
 18869                 GO TO 6499-EXIT
 18870        ELSE
 18871           GO TO 6499-EXIT.
 18872
 18873 6412-CHECK-TO-DAY.
 18874
 18875        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 18876           IF WS-WDT-DAY = 28
 18877              ADD 2              TO WS-ODD-DAYS-OVER
 18878           ELSE
 18879              IF WS-WDT-DAY = 29
 18880                 ADD 1           TO WS-ODD-DAYS-OVER
 18881              ELSE
 18882                 NEXT SENTENCE
 18883        ELSE
 18884           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 18885              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 343
* EL050.cbl
 18886
 18887     GO TO 6499-EXIT.
 18888
 18889
 18890 6415-CHECK-LEAP-YEAR.
 18891
 18892     IF DC-DAYS-IN-MONTH = 29
 18893        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 18894
 18895 6415-EXIT.
 18896     EXIT.
 18897
 18898 6499-EXIT.
 18899      EXIT.
 18900
 18901 6500-END.
 18902     EXIT.
 18903
 18904
 18905******************************************************************
 18906************* PROCEDURE DIVISION FOR EL050 ***********************
 18907********************** ELC50PD END *******************************
 18908
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 344
* EL050.cbl
 18910
 18911**START***********************************************************
 18912*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 18913*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 18914******************************************************************
 18915*
 18916 6600-GET-STATE-MUNICIPAL-TAX.
 18917
 18918     IF PB-COMPANY-ID NOT = 'DMD'
 18919         GO TO 6640-EXIT.
 18920
 18921     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 18922     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 18923     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 18924*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 18925*
 18926***  Y2K PROJ 7744
 18927     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18928     SET BIN-TO-GREG          TO TRUE.
 18929     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18930
 18931     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18932
 18933     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 18934     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 18935
 18936
 18937* EXEC CICS HANDLE CONDITION
 18938*        INVREQ    (6610-START-BROWSE)
 18939*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18940*        NOTFND    (6630-END-OF-FILE)
 18941*    END-EXEC.
 18942*    MOVE '"$8JI                 ! # #00018926' TO DFHEIV0
 18943     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 18944     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18945     MOVE X'2320233030303138393236' TO DFHEIV0(25:11)
 18946     CALL 'kxdfhei1' USING DFHEIV0
 18947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18948
 18949
 18950 6610-START-BROWSE.
 18951
 18952
 18953* EXEC CICS HANDLE CONDITION
 18954*        NOTFND    (6630-END-OF-FILE)
 18955*        DISABLED  (6630-ERRESS-PROBLEM)
 18956*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18957*        ENDFILE   (6630-END-OF-FILE)
 18958*    END-EXEC.
 18959*    MOVE '"$IcJ''                ! $ #00018934' TO DFHEIV0
 18960     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18961     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18962     MOVE X'2420233030303138393334' TO DFHEIV0(25:11)
 18963     CALL 'kxdfhei1' USING DFHEIV0
 18964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18965
 18966
 18967
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 345
* EL050.cbl
 18968* EXEC CICS STARTBR
 18969*        DATASET (FILE-ID-ERRESS)
 18970*        RIDFLD  (WS-ERRESS-KEY)
 18971*        GTEQ
 18972*    END-EXEC.
 18973     MOVE 0
 18974       TO DFHEIV11
 18975*    MOVE '&,         G          &   #00018941' TO DFHEIV0
 18976     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18977     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18978     MOVE X'2020233030303138393431' TO DFHEIV0(25:11)
 18979     CALL 'kxdfhei1' USING DFHEIV0,
 18980           FILE-ID-ERRESS,
 18981           WS-ERRESS-KEY,
 18982           DFHEIV99,
 18983           DFHEIV11,
 18984           DFHEIV99
 18985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18986
 18987
 18988 6620-READ-NEXT-ERRESS-MASTER.
 18989
 18990
 18991* EXEC CICS HANDLE CONDITION
 18992*        NOTFND    (6630-END-OF-FILE)
 18993*        ENDFILE   (6630-END-OF-FILE)
 18994*        DISABLED  (6630-ERRESS-PROBLEM)
 18995*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18996*    END-EXEC.
 18997*    MOVE '"$I''cJ                ! % #00018949' TO DFHEIV0
 18998     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 18999     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19000     MOVE X'2520233030303138393439' TO DFHEIV0(25:11)
 19001     CALL 'kxdfhei1' USING DFHEIV0
 19002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19003
 19004
 19005
 19006* EXEC CICS READNEXT
 19007*        DATASET (FILE-ID-ERRESS)
 19008*        INTO    (RESIDENT-STATE-TAX-MASTER)
 19009*        RIDFLD  (WS-ERRESS-KEY)
 19010*    END-EXEC.
 19011     MOVE LENGTH OF
 19012      RESIDENT-STATE-TAX-MASTER
 19013       TO DFHEIV12
 19014     MOVE 0
 19015       TO DFHEIV11
 19016*    MOVE '&.IL                  )   #00018956' TO DFHEIV0
 19017     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19018     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19019     MOVE X'2020233030303138393536' TO DFHEIV0(25:11)
 19020     CALL 'kxdfhei1' USING DFHEIV0,
 19021           FILE-ID-ERRESS,
 19022           RESIDENT-STATE-TAX-MASTER,
 19023           DFHEIV12,
 19024           WS-ERRESS-KEY,
 19025           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 346
* EL050.cbl
 19026           DFHEIV11,
 19027           DFHEIV99,
 19028           DFHEIV99
 19029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19030
 19031
 19032     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 19033
 19034* EXEC CICS ENDBR
 19035*            DATASET (FILE-ID-ERRESS)
 19036*       END-EXEC
 19037     MOVE 0
 19038       TO DFHEIV11
 19039*    MOVE '&2                    $   #00018963' TO DFHEIV0
 19040     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19041     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19042     MOVE X'2020233030303138393633' TO DFHEIV0(25:11)
 19043     CALL 'kxdfhei1' USING DFHEIV0,
 19044           FILE-ID-ERRESS,
 19045           DFHEIV11,
 19046           DFHEIV99
 19047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19048        GO TO 6630-END-OF-FILE.
 19049
 19050     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 19051        NEXT SENTENCE
 19052      ELSE
 19053        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 19054
 19055*IS IT LIFE(1) OR IS IT P&C(2) ?????
 19056*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 19057*
 19058     MOVE +2                     TO WS-SUB1.
 19059
 19060     IF PB-ISSUE
 19061     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 19062        MOVE +1                  TO WS-SUB1.
 19063
 19064     IF PB-CANCELLATION
 19065     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 19066        MOVE +1                  TO WS-SUB1.
 19067*
 19068*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 19069*
 19070***  Y2K PROJ 7744
 19071     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 19072***  Y2K PROJ 7744
 19073
 19074*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 19075* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 19076* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 19077
 19078     ADD 1                    TO WS-YEAR-YY.
 19079
 19080     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 19081         MOVE RES-REN-STATE-TAX (WS-SUB1)
 19082                              TO WS-RES-STATE-TAX
 19083         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 347
* EL050.cbl
 19084                              TO WS-RES-MUNI-TAX
 19085     ELSE
 19086         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 19087                              TO WS-RES-STATE-TAX
 19088         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 19089                              TO WS-RES-MUNI-TAX.
 19090
 19091*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 19092
 19093     IF PB-CANCELLATION
 19094         GO TO 6640-CANCEL-TAX.
 19095
 19096     IF PB-I-LF-PREMIUM-AMT > ZEROS
 19097         COMPUTE PB-I-STATE-TAX ROUNDED =
 19098                                   PB-I-LF-PREMIUM-AMT
 19099                                 * WS-RES-STATE-TAX
 19100         COMPUTE PB-I-MUNI-TAX ROUNDED =
 19101                                   PB-I-LF-PREMIUM-AMT
 19102                                 * WS-RES-MUNI-TAX
 19103     ELSE
 19104     IF PB-I-AH-PREMIUM-AMT > ZEROS
 19105         COMPUTE PB-I-STATE-TAX ROUNDED =
 19106                                   PB-I-AH-PREMIUM-AMT
 19107                                 * WS-RES-STATE-TAX
 19108         COMPUTE PB-I-MUNI-TAX ROUNDED =
 19109                                   PB-I-AH-PREMIUM-AMT
 19110                                 * WS-RES-MUNI-TAX.
 19111
 19112
 19113* EXEC CICS ENDBR
 19114*         DATASET (FILE-ID-ERRESS)
 19115*    END-EXEC.
 19116     MOVE 0
 19117       TO DFHEIV11
 19118*    MOVE '&2                    $   #00019030' TO DFHEIV0
 19119     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19120     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19121     MOVE X'2020233030303139303330' TO DFHEIV0(25:11)
 19122     CALL 'kxdfhei1' USING DFHEIV0,
 19123           FILE-ID-ERRESS,
 19124           DFHEIV11,
 19125           DFHEIV99
 19126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19127
 19128
 19129     GO TO 6640-EXIT.
 19130
 19131 6640-CANCEL-TAX.
 19132     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 19133
 19134     IF PB-C-LF-CANCEL-AMT > ZEROS
 19135         COMPUTE PB-CI-STATE-TAX ROUNDED =
 19136                                   PB-C-LF-CANCEL-AMT
 19137                                 * WS-RES-STATE-TAX
 19138         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 19139                                   PB-C-LF-CANCEL-AMT
 19140                                *  WS-RES-MUNI-TAX
 19141     ELSE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 348
* EL050.cbl
 19142     IF PB-C-AH-CANCEL-AMT > ZEROS
 19143         COMPUTE PB-CI-STATE-TAX ROUNDED =
 19144                                   PB-C-AH-CANCEL-AMT
 19145                                 * WS-RES-STATE-TAX
 19146         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 19147                                   PB-C-AH-CANCEL-AMT
 19148                                *  WS-RES-MUNI-TAX.
 19149
 19150
 19151* EXEC CICS ENDBR
 19152*         DATASET (FILE-ID-ERRESS)
 19153*    END-EXEC.
 19154     MOVE 0
 19155       TO DFHEIV11
 19156*    MOVE '&2                    $   #00019055' TO DFHEIV0
 19157     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19158     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19159     MOVE X'2020233030303139303535' TO DFHEIV0(25:11)
 19160     CALL 'kxdfhei1' USING DFHEIV0,
 19161           FILE-ID-ERRESS,
 19162           DFHEIV11,
 19163           DFHEIV99
 19164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19165
 19166
 19167     GO TO 6640-EXIT.
 19168
 19169 6630-END-OF-FILE.
 19170     MOVE ER-8002              TO WS-ERROR.
 19171     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19172
 19173     GO TO 6640-EXIT.
 19174
 19175 6630-ERRESS-PROBLEM.
 19176     MOVE ER-8044              TO WS-ERROR.
 19177     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19178
 19179 6640-EXIT.
 19180     EXIT.
 19181
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 349
* EL050.cbl
 19183 6650-GET-RES-STATE-COMM.
 19184
 19185     IF PB-COMPANY-ID NOT = 'DMD'
 19186         GO TO 6700-COMM-EXIT.
 19187
 19188     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 19189     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 19190     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 19191     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 19192     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 19193     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 19194     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 19195
 19196*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 19197*
 19198***  Y2K PROJ 7744
 19199     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 19200     SET BIN-TO-GREG          TO TRUE.
 19201     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 19202
 19203     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 19204***  Y2K PROJ 7744
 19205
 19206     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 19207
 19208
 19209* EXEC CICS HANDLE CONDITION
 19210*        INVREQ    (6660-START-BROWSE)
 19211*        DISABLED  (6690-ERRESC-PROBLEM)
 19212*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19213*        NOTFND    (6690-END-OF-FILE)
 19214*    END-EXEC.
 19215*    MOVE '"$8cJI                ! & #00019100' TO DFHEIV0
 19216     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 19217     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19218     MOVE X'2620233030303139313030' TO DFHEIV0(25:11)
 19219     CALL 'kxdfhei1' USING DFHEIV0
 19220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19221
 19222
 19223
 19224* EXEC CICS RESETBR
 19225*        DATASET (FILE-ID-ERRESC)
 19226*        RIDFLD  (WS-ERRESC-KEY)
 19227*    END-EXEC.
 19228     MOVE 0
 19229       TO DFHEIV11
 19230*    MOVE '&4         G          &   #00019107' TO DFHEIV0
 19231     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19232     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19233     MOVE X'2020233030303139313037' TO DFHEIV0(25:11)
 19234     CALL 'kxdfhei1' USING DFHEIV0,
 19235           FILE-ID-ERRESC,
 19236           WS-ERRESC-KEY,
 19237           DFHEIV99,
 19238           DFHEIV11,
 19239           DFHEIV99
 19240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 350
* EL050.cbl
 19241
 19242
 19243 6660-START-BROWSE.
 19244
 19245
 19246* EXEC CICS HANDLE CONDITION
 19247*        NOTFND    (6690-END-OF-FILE)
 19248*        DISABLED  (6690-ERRESC-PROBLEM)
 19249*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19250*        ENDFILE   (6690-END-OF-FILE)
 19251*    END-EXEC.
 19252*    MOVE '"$IcJ''                ! '' #00019114' TO DFHEIV0
 19253     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19254     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19255     MOVE X'2720233030303139313134' TO DFHEIV0(25:11)
 19256     CALL 'kxdfhei1' USING DFHEIV0
 19257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19258
 19259
 19260
 19261* EXEC CICS STARTBR
 19262*        DATASET (FILE-ID-ERRESC)
 19263*        RIDFLD  (WS-ERRESC-KEY)
 19264*        GTEQ
 19265*    END-EXEC.
 19266     MOVE 0
 19267       TO DFHEIV11
 19268*    MOVE '&,         G          &   #00019121' TO DFHEIV0
 19269     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19270     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19271     MOVE X'2020233030303139313231' TO DFHEIV0(25:11)
 19272     CALL 'kxdfhei1' USING DFHEIV0,
 19273           FILE-ID-ERRESC,
 19274           WS-ERRESC-KEY,
 19275           DFHEIV99,
 19276           DFHEIV11,
 19277           DFHEIV99
 19278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19279
 19280
 19281     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 19282
 19283 6670-READ-NEXT-ERRESC-MASTER.
 19284
 19285
 19286* EXEC CICS HANDLE CONDITION
 19287*        NOTFND    (6690-END-OF-FILE)
 19288*        DISABLED  (6690-ERRESC-PROBLEM)
 19289*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19290*        ENDFILE   (6690-END-OF-FILE)
 19291*    END-EXEC.
 19292*    MOVE '"$IcJ''                ! ( #00019131' TO DFHEIV0
 19293     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19294     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19295     MOVE X'2820233030303139313331' TO DFHEIV0(25:11)
 19296     CALL 'kxdfhei1' USING DFHEIV0
 19297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19298
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 351
* EL050.cbl
 19299
 19300
 19301* EXEC CICS READNEXT
 19302*        DATASET (FILE-ID-ERRESC)
 19303*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 19304*        RIDFLD  (ERRESC-RECORD-KEY)
 19305*    END-EXEC.
 19306     MOVE LENGTH OF
 19307      ACCOUNT-RESIDENT-ST-COMMISSION
 19308       TO DFHEIV12
 19309     MOVE 0
 19310       TO DFHEIV11
 19311*    MOVE '&.IL                  )   #00019138' TO DFHEIV0
 19312     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19313     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19314     MOVE X'2020233030303139313338' TO DFHEIV0(25:11)
 19315     CALL 'kxdfhei1' USING DFHEIV0,
 19316           FILE-ID-ERRESC,
 19317           ACCOUNT-RESIDENT-ST-COMMISSION,
 19318           DFHEIV12,
 19319           ERRESC-RECORD-KEY,
 19320           DFHEIV99,
 19321           DFHEIV11,
 19322           DFHEIV99,
 19323           DFHEIV99
 19324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19325
 19326
 19327     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 19328        NEXT SENTENCE
 19329     ELSE
 19330
 19331* EXEC CICS ENDBR
 19332*            DATASET (FILE-ID-ERRESC)
 19333*       END-EXEC
 19334     MOVE 0
 19335       TO DFHEIV11
 19336*    MOVE '&2                    $   #00019147' TO DFHEIV0
 19337     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19338     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19339     MOVE X'2020233030303139313437' TO DFHEIV0(25:11)
 19340     CALL 'kxdfhei1' USING DFHEIV0,
 19341           FILE-ID-ERRESC,
 19342           DFHEIV11,
 19343           DFHEIV99
 19344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19345        GO TO 6690-END-OF-FILE.
 19346
 19347     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 19348
 19349* EXEC CICS ENDBR
 19350*            DATASET (FILE-ID-ERRESC)
 19351*       END-EXEC
 19352     MOVE 0
 19353       TO DFHEIV11
 19354*    MOVE '&2                    $   #00019153' TO DFHEIV0
 19355     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19356     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 352
* EL050.cbl
 19357     MOVE X'2020233030303139313533' TO DFHEIV0(25:11)
 19358     CALL 'kxdfhei1' USING DFHEIV0,
 19359           FILE-ID-ERRESC,
 19360           DFHEIV11,
 19361           DFHEIV99
 19362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19363        GO TO 6690-END-OF-FILE.
 19364
 19365     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 19366        NEXT SENTENCE
 19367      ELSE
 19368        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 19369
 19370* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 19371*
 19372     MOVE ZEROS               TO WS-SUB WS-SUB1.
 19373
 19374     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 19375
 19376     IF WS-SUB1 > ZERO
 19377         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 19378             PERFORM 6680-SET-COMMISSION
 19379         ELSE
 19380             PERFORM 6680-SET-TABLE-CODE.
 19381
 19382
 19383* EXEC CICS ENDBR
 19384*         DATASET (FILE-ID-ERRESC)
 19385*    END-EXEC.
 19386     MOVE 0
 19387       TO DFHEIV11
 19388*    MOVE '&2                    $   #00019175' TO DFHEIV0
 19389     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19390     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19391     MOVE X'2020233030303139313735' TO DFHEIV0(25:11)
 19392     CALL 'kxdfhei1' USING DFHEIV0,
 19393           FILE-ID-ERRESC,
 19394           DFHEIV11,
 19395           DFHEIV99
 19396     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19397
 19398
 19399     GO TO 6700-COMM-EXIT.
 19400
 19401 6680-SET-TABLE-CODE.
 19402     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 19403        MOVE ZEROS             TO WS-SUB1
 19404     ELSE
 19405* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 19406* TO COMPUTE AH COMMISSION.
 19407        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 19408        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 19409        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 19410        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 19411        PERFORM 6680-READ-CTBL-TABLE
 19412        IF WS-CTBL-READ-SW NOT = 'Y'
 19413           MOVE ZEROS          TO WS-SUB1.
 19414
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 353
* EL050.cbl
 19415 6680-READ-CTBL-TABLE.
 19416*
 19417* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 19418* TO COMPUTE LIFE COMMISSION
 19419
 19420     IF CTBL-SW = '0540'
 19421        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 19422        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 19423        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 19424
 19425     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 19426
 19427     IF CTBL-TABLE-FOUND
 19428        IF CTBL-SW = '0530'
 19429             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 19430                                    * PB-I-AH-TERM
 19431             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 19432             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 19433        ELSE
 19434             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 19435             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 19436             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 19437     ELSE
 19438        IF FIRST-TIME-THROUGH
 19439            GO TO 6680-READ-CTBL-TABLE
 19440        ELSE
 19441            MOVE ZEROS         TO WS-SUB1.
 19442
 19443 6680-SET-COMMISSION.
 19444     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 19445           MOVE ZEROS          TO WS-SUB1
 19446       ELSE
 19447           MOVE RESC-COMMISSION-PER (WS-SUB)
 19448                               TO WS-COMMISSION
 19449           IF CTBL-SW = '0530'
 19450               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 19451           ELSE
 19452               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 19453
 19454 6680-SEARCH-CATEGORY.
 19455     ADD +1                   TO WS-SUB.
 19456     IF WS-SUB > +12
 19457         GO TO 6680-EXIT.
 19458
 19459     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 19460          MOVE WS-SUB         TO WS-SUB1
 19461          GO TO 6680-EXIT.
 19462
 19463     GO TO 6680-SEARCH-CATEGORY.
 19464
 19465 6680-EXIT.
 19466     EXIT.
 19467
 19468 6690-END-OF-FILE.
 19469     GO TO 6700-COMM-EXIT.
 19470
 19471 6690-ERRESC-PROBLEM.
 19472      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 354
* EL050.cbl
 19473      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19474
 19475      GO TO 6700-COMM-EXIT.
 19476
 19477 6700-COMM-EXIT.
 19478     EXIT.
 19479
 19480 7000-GET-RATE.
 19481
 19482* EXEC CICS LINK
 19483*        PROGRAM    ('ELRATE')
 19484*        COMMAREA   (CALCULATION-PASS-AREA)
 19485*        LENGTH     (CP-COMM-LENGTH)
 19486*    END-EXEC.
 19487     MOVE 'ELRATE' TO DFHEIV1
 19488*    MOVE '."C                   (   #00019261' TO DFHEIV0
 19489     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19490     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19491     MOVE X'2020233030303139323631' TO DFHEIV0(25:11)
 19492     CALL 'kxdfhei1' USING DFHEIV0,
 19493           DFHEIV1,
 19494           CALCULATION-PASS-AREA,
 19495           CP-COMM-LENGTH,
 19496           DFHEIV99,
 19497           DFHEIV99,
 19498           DFHEIV99,
 19499           DFHEIV99
 19500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19501
 19502
 19503 7000-EXIT.
 19504     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 355
* EL050.cbl
 19506 7100-FIND-BENEFIT-IN-STATE.
 19507     MOVE 'N'                    TO BEN-SEARCH-SW.
 19508
 19509     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 19510         VARYING SUB3 FROM 1 BY 1 UNTIL
 19511            ((SUB3 GREATER 50) OR
 19512              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 19513               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 19514
 19515     IF SUB3 NOT = 51
 19516         MOVE 'Y'                TO BEN-SEARCH-SW.
 19517
 19518     GO TO 7199-EXIT.
 19519
 19520 7100-BENEFIT-DUMMY.
 19521
 19522 7100-DUMMY-EXIT.
 19523     EXIT.
 19524
 19525 7199-EXIT.
 19526     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 356
* EL050.cbl
 19528 7200-FIND-BENEFIT.
 19529     MOVE 'N'                    TO BEN-SEARCH-SW.
 19530
 19531     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 19532         VARYING SUB3 FROM 1 BY 1 UNTIL
 19533            ((SUB3 GREATER 8) OR
 19534            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 19535
 19536     IF SUB3 NOT = 9
 19537         MOVE 'Y'                TO BEN-SEARCH-SW.
 19538
 19539     GO TO 7200-EXIT.
 19540
 19541 7200-BENEFIT-DUMMY.
 19542
 19543 7200-DUMMY-EXIT.
 19544     EXIT.
 19545
 19546 7200-EXIT.
 19547     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 357
* EL050.cbl
 19549 7250-LOOK-FOR-RESCINDED-CLAIM.
 19550     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19551                                    W-CL-COMP-CD.
 19552     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19553                                    W-CL-CERT-NO.
 19554
 19555
 19556* EXEC CICS HANDLE CONDITION
 19557*        NOTFND  (7250-CONTINUE)
 19558*        ENDFILE (7250-CONTINUE)
 19559*    END-EXEC.
 19560*    MOVE '"$I''                  ! ) #00019319' TO DFHEIV0
 19561     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19562     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19563     MOVE X'2920233030303139333139' TO DFHEIV0(25:11)
 19564     CALL 'kxdfhei1' USING DFHEIV0
 19565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19566
 19567
 19568
 19569* EXEC CICS IGNORE CONDITION
 19570*        DUPKEY
 19571*    END-EXEC.
 19572*    MOVE '"*$                   !   #00019324' TO DFHEIV0
 19573     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19574     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19575     MOVE X'2020233030303139333234' TO DFHEIV0(25:11)
 19576     CALL 'kxdfhei1' USING DFHEIV0
 19577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19578
 19579
 19580
 19581* EXEC CICS STARTBR
 19582*        DATASET   (CLMS-ID)
 19583*        RIDFLD    (ELMSTR-KEY)
 19584*        GENERIC   EQUAL
 19585*        KEYLENGTH (ELMSTR-LENGTH)
 19586*    END-EXEC.
 19587     MOVE 0
 19588       TO DFHEIV11
 19589*    MOVE '&,   KG    E          &   #00019328' TO DFHEIV0
 19590     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19591     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19592     MOVE X'2020233030303139333238' TO DFHEIV0(25:11)
 19593     CALL 'kxdfhei1' USING DFHEIV0,
 19594           CLMS-ID,
 19595           ELMSTR-KEY,
 19596           ELMSTR-LENGTH,
 19597           DFHEIV11,
 19598           DFHEIV99
 19599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19600
 19601
 19602     MOVE 'Y'                    TO W-BROWSE-SW.
 19603
 19604 7250-NEXT-CLAIM.
 19605
 19606
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 358
* EL050.cbl
 19607* EXEC CICS READNEXT
 19608*        DATASET   (CLMS-ID)
 19609*        RIDFLD    (ELMSTR-KEY)
 19610*        SET       (ADDRESS OF CLAIM-MASTER)
 19611*    END-EXEC.
 19612     MOVE 0
 19613       TO DFHEIV11
 19614*    MOVE '&.S                   )   #00019339' TO DFHEIV0
 19615     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19616     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19617     MOVE X'2020233030303139333339' TO DFHEIV0(25:11)
 19618     CALL 'kxdfhei1' USING DFHEIV0,
 19619           CLMS-ID,
 19620           DFHEIV20,
 19621           DFHEIV99,
 19622           ELMSTR-KEY,
 19623           DFHEIV99,
 19624           DFHEIV11,
 19625           DFHEIV99,
 19626           DFHEIV99
 19627     SET ADDRESS OF CLAIM-MASTER TO
 19628         DFHEIV20
 19629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19630
 19631
 19632     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19633        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19634         GO TO 7250-CONTINUE
 19635     END-IF.
 19636
 19637     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19638        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19639        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19640        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19641        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19642         GO TO 7250-NEXT-CLAIM
 19643     END-IF.
 19644
 19645     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19646        OR (CL-CLAIM-TYPE = 'I')
 19647        OR (CL-CLAIM-TYPE = 'G')
 19648        OR (CL-CLAIM-TYPE = 'F')
 19649          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19650              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 19651              GO TO 7250-CONTINUE
 19652          END-IF
 19653     END-IF.
 19654
 19655     GO TO 7250-NEXT-CLAIM.
 19656
 19657 7250-CONTINUE.
 19658
 19659     IF W-BROWSE-SW = 'Y'
 19660
 19661* EXEC CICS ENDBR
 19662*            DATASET   (CLMS-ID)
 19663*        END-EXEC
 19664     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 359
* EL050.cbl
 19665       TO DFHEIV11
 19666*    MOVE '&2                    $   #00019373' TO DFHEIV0
 19667     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19668     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19669     MOVE X'2020233030303139333733' TO DFHEIV0(25:11)
 19670     CALL 'kxdfhei1' USING DFHEIV0,
 19671           CLMS-ID,
 19672           DFHEIV11,
 19673           DFHEIV99
 19674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19675         MOVE 'N' TO W-BROWSE-SW
 19676     END-IF.
 19677
 19678 7250-EXIT.
 19679     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 360
* EL050.cbl
 19681 7300-CHECK-FOR-OPEN-CLMS.
 19682
 19683*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 19684*    MOVE SPACES                 TO CNTL-ACCESS.
 19685*    MOVE '1'                    TO CNTL-REC-TYPE.
 19686*    MOVE +0                     TO CNTL-SEQ-NO.
 19687
 19688*    MOVE '3'                    TO RC-SW-1.
 19689*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 19690
 19691*    IF NOT CF-COMPANY-MASTER
 19692*         PERFORM 0099-COMPANY-NOT-FOUND
 19693*         GO TO 7300-EXIT.
 19694
 19695     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19696                                    W-CL-COMP-CD.
 19697     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19698                                    W-CL-CERT-NO.
 19699
 19700
 19701* EXEC CICS HANDLE CONDITION
 19702*        NOTFND  (7300-CONTINUE)
 19703*        ENDFILE (7300-CONTINUE)
 19704*    END-EXEC.
 19705*    MOVE '"$I''                  ! * #00019401' TO DFHEIV0
 19706     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19707     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19708     MOVE X'2A20233030303139343031' TO DFHEIV0(25:11)
 19709     CALL 'kxdfhei1' USING DFHEIV0
 19710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19711
 19712
 19713
 19714* EXEC CICS IGNORE CONDITION
 19715*        DUPKEY
 19716*    END-EXEC.
 19717*    MOVE '"*$                   !   #00019406' TO DFHEIV0
 19718     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19719     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19720     MOVE X'2020233030303139343036' TO DFHEIV0(25:11)
 19721     CALL 'kxdfhei1' USING DFHEIV0
 19722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19723
 19724
 19725
 19726* EXEC CICS STARTBR
 19727*        DATASET   (CLMS-ID)
 19728*        RIDFLD    (ELMSTR-KEY)
 19729*        GENERIC   EQUAL
 19730*        KEYLENGTH (ELMSTR-LENGTH)
 19731*    END-EXEC.
 19732     MOVE 0
 19733       TO DFHEIV11
 19734*    MOVE '&,   KG    E          &   #00019410' TO DFHEIV0
 19735     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19736     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19737     MOVE X'2020233030303139343130' TO DFHEIV0(25:11)
 19738     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 361
* EL050.cbl
 19739           CLMS-ID,
 19740           ELMSTR-KEY,
 19741           ELMSTR-LENGTH,
 19742           DFHEIV11,
 19743           DFHEIV99
 19744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19745
 19746
 19747     MOVE 'Y'                    TO W-BROWSE-SW.
 19748
 19749 7300-NEXT-CLAIM.
 19750
 19751
 19752* EXEC CICS READNEXT
 19753*        DATASET   (CLMS-ID)
 19754*        RIDFLD    (ELMSTR-KEY)
 19755*        SET       (ADDRESS OF CLAIM-MASTER)
 19756*    END-EXEC.
 19757     MOVE 0
 19758       TO DFHEIV11
 19759*    MOVE '&.S                   )   #00019421' TO DFHEIV0
 19760     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19761     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19762     MOVE X'2020233030303139343231' TO DFHEIV0(25:11)
 19763     CALL 'kxdfhei1' USING DFHEIV0,
 19764           CLMS-ID,
 19765           DFHEIV20,
 19766           DFHEIV99,
 19767           ELMSTR-KEY,
 19768           DFHEIV99,
 19769           DFHEIV11,
 19770           DFHEIV99,
 19771           DFHEIV99
 19772     SET ADDRESS OF CLAIM-MASTER TO
 19773         DFHEIV20
 19774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19775
 19776
 19777     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19778        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19779         GO TO 7300-CONTINUE.
 19780
 19781     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19782        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19783        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19784        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19785        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19786         GO TO 7300-NEXT-CLAIM.
 19787
 19788*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 19789     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19790        OR (CL-CLAIM-TYPE = 'I')
 19791        OR (CL-CLAIM-TYPE = 'G')
 19792        OR (CL-CLAIM-TYPE = 'F')
 19793        IF CLAIM-IS-OPEN
 19794           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19795             AND PB-C-AH-CANCEL-DT > SPACES
 19796              MOVE ER-2896        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 362
* EL050.cbl
 19797              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19798           END-IF
 19799           EVALUATE TRUE
 19800             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 19801                 MOVE ER-2884      TO WS-ERROR
 19802             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 19803                 MOVE ER-2887      TO WS-ERROR
 19804             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 19805                 MOVE ER-2886      TO WS-ERROR
 19806             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 19807                 MOVE ER-2888      TO WS-ERROR
 19808             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 19809                 MOVE ER-2885      TO WS-ERROR
 19810             WHEN OTHER
 19811                 MOVE ER-2768      TO WS-ERROR
 19812           END-EVALUATE
 19813           IF PB-C-AH-CANCEL-VOIDED OR
 19814              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19815                NOT AH-COVERAGE-CANCELLED)
 19816               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19817               MOVE ER-2768      TO WS-ERROR
 19818           END-IF
 19819           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19820           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19821              PB-FORCE-CODE NOT EQUAL '8'
 19822               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19823           END-IF
 19824           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 19825           GO TO 7300-NEXT-CLAIM
 19826        ELSE
 19827           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19828*****THIS IS A RESCISSION OR REFORMATION
 19829              IF AH-COVERAGE-CANCELLED
 19830                 IF WS-ST-CAUSAL-STATE = ('A' OR 'B')
 19831                    MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 19832                    MOVE 1                   TO DC-ELAPSED-DAYS
 19833                    MOVE ZERO                TO DC-ELAPSED-MONTHS
 19834                    SET BIN-PLUS-ELAPSED     TO TRUE
 19835                    PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 19836                    IF NO-CONVERSION-ERROR
 19837                       IF NOT (DC-BIN-DATE-2 = PB-C-AH-CANCEL-DT
 19838                        OR PB-C-AH-CANCEL-DT = CL-CERT-EFF-DT)
 19839                          MOVE ER-2897 TO WS-ERROR
 19840                          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19841                          GO TO 7300-NEXT-CLAIM
 19842                       END-IF
 19843                    END-IF
 19844                 ELSE
 19845                   IF PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT
 19846                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19847                         MOVE ER-2890 TO WS-ERROR
 19848                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19849                         GO TO 7300-NEXT-CLAIM
 19850                      ELSE
 19851                         MOVE ER-2898 TO WS-ERROR
 19852                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19853                         GO TO 7300-NEXT-CLAIM
 19854                      END-IF
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 363
* EL050.cbl
 19855                   END-IF
 19856                 END-IF
 19857              END-IF
 19858           ELSE
 19859              IF CL-DENIAL-TYPE = '1'  AND
 19860                 CL-TOTAL-PAID-AMT = 0
 19861                    GO TO 7300-NEXT-CLAIM
 19862              END-IF
 19863              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19864               AND PB-C-AH-CANCEL-DT > SPACES
 19865                 MOVE ER-2756        TO WS-ERROR
 19866                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19867                 GO TO 7300-NEXT-CLAIM
 19868              END-IF
 19869           END-IF
 19870        END-IF
 19871     ELSE
 19872*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 19873        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 19874           IF (CLAIM-IS-OPEN)
 19875              and ((pb-ci-lf-cancel-amt + pb-c-lf-cancel-amt)
 19876                 <> zeros
 19877              or (pb-ci-ah-cancel-amt + pb-c-ah-cancel-amt)
 19878                 <> zeros)
 19879              MOVE ER-2889      TO WS-ERROR
 19880              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19881              GO TO 7300-NEXT-CLAIM
 19882           ELSE
 19883              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19884*****THIS IS A RESCISSION OR REFORMATION or refor to rescission
 19885                 IF (LF-COVERAGE-CANCELLED AND
 19886                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 19887                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19888                         MOVE ER-2890 TO WS-ERROR
 19889                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19890                         GO TO 7300-NEXT-CLAIM
 19891                      ELSE
 19892                         MOVE ER-2898 TO WS-ERROR
 19893                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19894                         GO TO 7300-NEXT-CLAIM
 19895                      END-IF
 19896                 END-IF
 19897              ELSE
 19898                 IF (CL-DENIAL-TYPE = '1')   *> regular denial
 19899                    and (CL-TOTAL-PAID-AMT = 0)
 19900                    GO TO 7300-NEXT-CLAIM
 19901                 END-IF
 19902                 IF (
 19903                      (AH-COVERAGE-CANCELLED)
 19904                      AND (PB-C-AH-CANCEL-DT <> CL-INCURRED-DT)
 19905                      AND (WS-AH-CLAIM-RESCINDED <> 'Y')
 19906                      and (pb-ci-ah-cancel-amt +
 19907                         pb-c-ah-cancel-amt) <> zeros
 19908                    )
 19909                               OR
 19910                    (
 19911                      (LF-COVERAGE-CANCELLED)
 19912                      AND (PB-C-LF-CANCEL-DT <> CL-INCURRED-DT)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 364
* EL050.cbl
 19913                      AND (WS-ST-REFUND-CLAIM-FLAG = '4')
 19914                      and (pb-ci-lf-cancel-amt +
 19915                         pb-c-lf-cancel-amt) <> zeros
 19916                    )
 19917                       MOVE ER-2965 TO WS-ERROR
 19918                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19919                       GO TO 7300-NEXT-CLAIM
 19920                 END-IF
 19921                 IF LF-COVERAGE-CANCELLED
 19922                  IF CL-TOTAL-PAID-AMT > 0
 19923                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 19924                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 19925                        MOVE ER-2891 TO WS-ERROR
 19926                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19927                        GO TO 7300-NEXT-CLAIM
 19928                      END-IF
 19929                    ELSE
 19930****only show this error if cert num matches exactly
 19931                      IF PB-CERT-NO = CL-CERT-NO
 19932                         MOVE ER-2892 TO WS-ERROR
 19933                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19934                         GO TO 7300-NEXT-CLAIM
 19935                      END-IF
 19936                    END-IF
 19937                  END-IF
 19938                 END-IF
 19939              END-IF
 19940           END-IF
 19941        END-IF
 19942     END-IF
 19943
 19944     GO TO 7300-NEXT-CLAIM.
 19945
 19946 7300-CONTINUE.
 19947
 19948     IF W-BROWSE-SW = 'Y'
 19949
 19950* EXEC CICS ENDBR
 19951*            DATASET   (CLMS-ID)
 19952*        END-EXEC.
 19953     MOVE 0
 19954       TO DFHEIV11
 19955*    MOVE '&2                    $   #00019599' TO DFHEIV0
 19956     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19957     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19958     MOVE X'2020233030303139353939' TO DFHEIV0(25:11)
 19959     CALL 'kxdfhei1' USING DFHEIV0,
 19960           CLMS-ID,
 19961           DFHEIV11,
 19962           DFHEIV99
 19963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19964
 19965
 19966 7300-EXIT.
 19967     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 365
* EL050.cbl
 19969
 19970 7400-GET-REMAIN-TERM.
 19971
 19972* EXEC CICS LINK
 19973*        PROGRAM    ('ELRTRM')
 19974*        COMMAREA   (CALCULATION-PASS-AREA)
 19975*        LENGTH     (CP-COMM-LENGTH)
 19976*    END-EXEC.
 19977     MOVE 'ELRTRM' TO DFHEIV1
 19978*    MOVE '."C                   (   #00019608' TO DFHEIV0
 19979     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19980     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19981     MOVE X'2020233030303139363038' TO DFHEIV0(25:11)
 19982     CALL 'kxdfhei1' USING DFHEIV0,
 19983           DFHEIV1,
 19984           CALCULATION-PASS-AREA,
 19985           CP-COMM-LENGTH,
 19986           DFHEIV99,
 19987           DFHEIV99,
 19988           DFHEIV99,
 19989           DFHEIV99
 19990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19991
 19992
 19993 7400-EXIT.
 19994     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 366
* EL050.cbl
 19996
 19997 7500-GET-REMAIN-AMOUNT.
 19998
 19999* EXEC CICS LINK
 20000*        PROGRAM    ('ELRAMT')
 20001*        COMMAREA   (CALCULATION-PASS-AREA)
 20002*        LENGTH     (CP-COMM-LENGTH)
 20003*    END-EXEC.
 20004     MOVE 'ELRAMT' TO DFHEIV1
 20005*    MOVE '."C                   (   #00019619' TO DFHEIV0
 20006     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20007     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20008     MOVE X'2020233030303139363139' TO DFHEIV0(25:11)
 20009     CALL 'kxdfhei1' USING DFHEIV0,
 20010           DFHEIV1,
 20011           CALCULATION-PASS-AREA,
 20012           CP-COMM-LENGTH,
 20013           DFHEIV99,
 20014           DFHEIV99,
 20015           DFHEIV99,
 20016           DFHEIV99
 20017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20018
 20019
 20020 7500-EXIT.
 20021     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 367
* EL050.cbl
 20023
 20024 7600-GET-REFUND.
 20025
 20026* EXEC CICS LINK
 20027*        PROGRAM    ('ELRFND')
 20028*        COMMAREA   (CALCULATION-PASS-AREA)
 20029*        LENGTH     (CP-COMM-LENGTH)
 20030*    END-EXEC.
 20031     MOVE 'ELRFND' TO DFHEIV1
 20032*    MOVE '."C                   (   #00019630' TO DFHEIV0
 20033     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20034     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20035     MOVE X'2020233030303139363330' TO DFHEIV0(25:11)
 20036     CALL 'kxdfhei1' USING DFHEIV0,
 20037           DFHEIV1,
 20038           CALCULATION-PASS-AREA,
 20039           CP-COMM-LENGTH,
 20040           DFHEIV99,
 20041           DFHEIV99,
 20042           DFHEIV99,
 20043           DFHEIV99
 20044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20045
 20046
 20047 7600-EXIT.
 20048     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 368
* EL050.cbl
 20050 7700-CALL-DL1.
 20051
 20052* EXEC CICS LINK
 20053*        PROGRAM    ('DLO001')
 20054*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 20055*        LENGTH     (DLO001-COMM-LENGTH)
 20056*    END-EXEC.
 20057     MOVE 'DLO001' TO DFHEIV1
 20058*    MOVE '."C                   (   #00019640' TO DFHEIV0
 20059     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20060     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20061     MOVE X'2020233030303139363430' TO DFHEIV0(25:11)
 20062     CALL 'kxdfhei1' USING DFHEIV0,
 20063           DFHEIV1,
 20064           WS-DLO-MASTER-POLICY-FORM,
 20065           DLO001-COMM-LENGTH,
 20066           DFHEIV99,
 20067           DFHEIV99,
 20068           DFHEIV99,
 20069           DFHEIV99
 20070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20071
 20072
 20073 7700-EXIT.
 20074     EXIT.
 20075
 20076 7710-CALL-DL2.
 20077
 20078* EXEC CICS LINK
 20079*        PROGRAM    ('DLO002')
 20080*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 20081*        LENGTH     (DLO002-COMM-LENGTH)
 20082*    END-EXEC.
 20083     MOVE 'DLO002' TO DFHEIV1
 20084*    MOVE '."C                   (   #00019650' TO DFHEIV0
 20085     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20086     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20087     MOVE X'2020233030303139363530' TO DFHEIV0(25:11)
 20088     CALL 'kxdfhei1' USING DFHEIV0,
 20089           DFHEIV1,
 20090           WS-DLO-INTERNAL-POLICY-FORM,
 20091           DLO002-COMM-LENGTH,
 20092           DFHEIV99,
 20093           DFHEIV99,
 20094           DFHEIV99,
 20095           DFHEIV99
 20096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20097
 20098
 20099 7710-EXIT.
 20100     EXIT.
 20101
 20102 7720-CALL-DL3.
 20103
 20104* EXEC CICS LINK
 20105*        PROGRAM    ('DLO003')
 20106*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 20107*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 369
* EL050.cbl
 20108*    END-EXEC.
 20109     MOVE 'DLO003' TO DFHEIV1
 20110*    MOVE '."C                   (   #00019660' TO DFHEIV0
 20111     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20112     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20113     MOVE X'2020233030303139363630' TO DFHEIV0(25:11)
 20114     CALL 'kxdfhei1' USING DFHEIV0,
 20115           DFHEIV1,
 20116           WS-DLO-VALID-BANK-ID,
 20117           DLO003-COMM-LENGTH,
 20118           DFHEIV99,
 20119           DFHEIV99,
 20120           DFHEIV99,
 20121           DFHEIV99
 20122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20123
 20124
 20125 7720-EXIT.
 20126     EXIT.
 20127
 20128 7730-CALL-DL7.
 20129
 20130* EXEC CICS LINK
 20131*        PROGRAM    ('DLO007')
 20132*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 20133*        LENGTH     (DLO007-COMM-LENGTH)
 20134*    END-EXEC.
 20135     MOVE 'DLO007' TO DFHEIV1
 20136*    MOVE '."C                   (   #00019670' TO DFHEIV0
 20137     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20138     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20139     MOVE X'2020233030303139363730' TO DFHEIV0(25:11)
 20140     CALL 'kxdfhei1' USING DFHEIV0,
 20141           DFHEIV1,
 20142           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 20143           DLO007-COMM-LENGTH,
 20144           DFHEIV99,
 20145           DFHEIV99,
 20146           DFHEIV99,
 20147           DFHEIV99
 20148     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20149
 20150
 20151 7730-EXIT.
 20152     EXIT.
 20153
 20154 7740-CALL-DL11.
 20155
 20156* EXEC CICS LINK
 20157*        PROGRAM    ('DLO011')
 20158*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 20159*        LENGTH     (DLO011-COMM-LENGTH)
 20160*    END-EXEC.
 20161     MOVE 'DLO011' TO DFHEIV1
 20162*    MOVE '."C                   (   #00019680' TO DFHEIV0
 20163     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20164     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20165     MOVE X'2020233030303139363830' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 370
* EL050.cbl
 20166     CALL 'kxdfhei1' USING DFHEIV0,
 20167           DFHEIV1,
 20168           WS-DLO-PREM-RATES-BEN-TYPE,
 20169           DLO011-COMM-LENGTH,
 20170           DFHEIV99,
 20171           DFHEIV99,
 20172           DFHEIV99,
 20173           DFHEIV99
 20174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20175
 20176
 20177 7740-EXIT.
 20178     EXIT.
 20179
 20180 7750-CALL-DL17.
 20181
 20182* EXEC CICS LINK
 20183*        PROGRAM    ('DLO017')
 20184*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 20185*        LENGTH     (DLO017-COMM-LENGTH)
 20186*    END-EXEC.
 20187     MOVE 'DLO017' TO DFHEIV1
 20188*    MOVE '."C                   (   #00019690' TO DFHEIV0
 20189     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20190     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20191     MOVE X'2020233030303139363930' TO DFHEIV0(25:11)
 20192     CALL 'kxdfhei1' USING DFHEIV0,
 20193           DFHEIV1,
 20194           WS-DLO-VALID-RATE-CODE,
 20195           DLO017-COMM-LENGTH,
 20196           DFHEIV99,
 20197           DFHEIV99,
 20198           DFHEIV99,
 20199           DFHEIV99
 20200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20201
 20202
 20203 7750-EXIT.
 20204     EXIT.
 20205
 20206 7755-CALL-DL19.
 20207
 20208* EXEC CICS LINK
 20209*        PROGRAM    ('DLO019')
 20210*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 20211*        LENGTH     (DLO019-COMM-LENGTH)
 20212*    END-EXEC.
 20213     MOVE 'DLO019' TO DFHEIV1
 20214*    MOVE '."C                   (   #00019700' TO DFHEIV0
 20215     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20216     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20217     MOVE X'2020233030303139373030' TO DFHEIV0(25:11)
 20218     CALL 'kxdfhei1' USING DFHEIV0,
 20219           DFHEIV1,
 20220           WS-DLO-ORIG-COV-CAT,
 20221           DLO019-COMM-LENGTH,
 20222           DFHEIV99,
 20223           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 371
* EL050.cbl
 20224           DFHEIV99,
 20225           DFHEIV99
 20226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20227
 20228
 20229 7755-EXIT.
 20230     EXIT.
 20231
 20232 7760-CALL-DL21.
 20233
 20234* EXEC CICS LINK
 20235*        PROGRAM    ('DLO021')
 20236*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 20237*        LENGTH     (DLO021-COMM-LENGTH)
 20238*    END-EXEC.
 20239     MOVE 'DLO021' TO DFHEIV1
 20240*    MOVE '."C                   (   #00019710' TO DFHEIV0
 20241     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20242     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20243     MOVE X'2020233030303139373130' TO DFHEIV0(25:11)
 20244     CALL 'kxdfhei1' USING DFHEIV0,
 20245           DFHEIV1,
 20246           WS-DLO-VALID-LOAN-OFFICER,
 20247           DLO021-COMM-LENGTH,
 20248           DFHEIV99,
 20249           DFHEIV99,
 20250           DFHEIV99,
 20251           DFHEIV99
 20252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20253
 20254
 20255 7760-EXIT.
 20256     EXIT.
 20257
 20258 7770-CALL-DL22.
 20259
 20260* EXEC CICS LINK
 20261*        PROGRAM    ('DLO022')
 20262*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 20263*        LENGTH     (DLO022-COMM-LENGTH)
 20264*    END-EXEC.
 20265     MOVE 'DLO022' TO DFHEIV1
 20266*    MOVE '."C                   (   #00019720' TO DFHEIV0
 20267     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20268     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20269     MOVE X'2020233030303139373230' TO DFHEIV0(25:11)
 20270     CALL 'kxdfhei1' USING DFHEIV0,
 20271           DFHEIV1,
 20272           WS-DLO-VALID-STATE-CODE,
 20273           DLO022-COMM-LENGTH,
 20274           DFHEIV99,
 20275           DFHEIV99,
 20276           DFHEIV99,
 20277           DFHEIV99
 20278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20279
 20280
 20281 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 372
* EL050.cbl
 20282     EXIT.
 20283
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 373
* EL050.cbl
 20285
 20286 7780-CALL-AGG.
 20287
 20288* EXEC CICS LINK
 20289*        PROGRAM    ('ELAGGO')
 20290*        COMMAREA   (WS-PASS-to-pemaggo)
 20291*        LENGTH     (ws-passed-key-LENGTH)
 20292*    END-EXEC.
 20293     MOVE 'ELAGGO' TO DFHEIV1
 20294*    MOVE '."C                   (   #00019732' TO DFHEIV0
 20295     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20296     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20297     MOVE X'2020233030303139373332' TO DFHEIV0(25:11)
 20298     CALL 'kxdfhei1' USING DFHEIV0,
 20299           DFHEIV1,
 20300           WS-PASS-to-pemaggo,
 20301           ws-passed-key-LENGTH,
 20302           DFHEIV99,
 20303           DFHEIV99,
 20304           DFHEIV99,
 20305           DFHEIV99
 20306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20307
 20308 7780-EXIT.
 20309     EXIT.
 20310 7785-CALL-HLDI.
 20311
 20312* EXEC CICS LINK
 20313*        PROGRAM    ('ELHLDI')
 20314*        COMMAREA   (HLDI-PASS-AREA)
 20315*        LENGTH     (HLDI-PASS-AREA-LEN)
 20316*    END-EXEC.
 20317     MOVE 'ELHLDI' TO DFHEIV1
 20318*    MOVE '."C                   (   #00019740' TO DFHEIV0
 20319     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20320     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20321     MOVE X'2020233030303139373430' TO DFHEIV0(25:11)
 20322     CALL 'kxdfhei1' USING DFHEIV0,
 20323           DFHEIV1,
 20324           HLDI-PASS-AREA,
 20325           HLDI-PASS-AREA-LEN,
 20326           DFHEIV99,
 20327           DFHEIV99,
 20328           DFHEIV99,
 20329           DFHEIV99
 20330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20331
 20332 7785-EXIT.
 20333     EXIT.
 20334 7786-CALL-HLDIM.
 20335
 20336* EXEC CICS LINK
 20337*        PROGRAM    ('ELHLDIM')
 20338*        COMMAREA   (HLDI-PASS-AREA)
 20339*        LENGTH     (HLDI-PASS-AREA-LEN)
 20340*    END-EXEC.
 20341     MOVE 'ELHLDIM' TO DFHEIV1
 20342*    MOVE '."C                   (   #00019748' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 374
* EL050.cbl
 20343     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20344     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20345     MOVE X'2020233030303139373438' TO DFHEIV0(25:11)
 20346     CALL 'kxdfhei1' USING DFHEIV0,
 20347           DFHEIV1,
 20348           HLDI-PASS-AREA,
 20349           HLDI-PASS-AREA-LEN,
 20350           DFHEIV99,
 20351           DFHEIV99,
 20352           DFHEIV99,
 20353           DFHEIV99
 20354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20355
 20356 7786-EXIT.
 20357     EXIT.
 20358 7790-CALL-ZIP-VERIFY.
 20359
 20360
 20361* EXEC CICS LINK
 20362*        PROGRAM    ('WSZIPCD')
 20363*        COMMAREA   (ZIPCD-PASS-AREA)
 20364*        LENGTH     (ZIPCD-PASS-AREA-LEN)
 20365*    END-EXEC.
 20366     MOVE 'WSZIPCD' TO DFHEIV1
 20367*    MOVE '."C                   (   #00019757' TO DFHEIV0
 20368     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20369     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20370     MOVE X'2020233030303139373537' TO DFHEIV0(25:11)
 20371     CALL 'kxdfhei1' USING DFHEIV0,
 20372           DFHEIV1,
 20373           ZIPCD-PASS-AREA,
 20374           ZIPCD-PASS-AREA-LEN,
 20375           DFHEIV99,
 20376           DFHEIV99,
 20377           DFHEIV99,
 20378           DFHEIV99
 20379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20380
 20381
 20382 7790-EXIT.
 20383     EXIT.
 20384 7800-REWRITE-CERT.
 20385******************************************************************
 20386*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 20387*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 20388******************************************************************
 20389
 20390     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 20391        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 20392        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 20393        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 20394
 20395* EXEC CICS REWRITE
 20396*                  DATASET (CERT-ID)
 20397*                  FROM    (CERTIFICATE-MASTER)
 20398*              END-EXEC
 20399     MOVE LENGTH OF
 20400      CERTIFICATE-MASTER
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 375
* EL050.cbl
 20401       TO DFHEIV11
 20402*    MOVE '&& L                  %   #00019775' TO DFHEIV0
 20403     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20404     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20405     MOVE X'2020233030303139373735' TO DFHEIV0(25:11)
 20406     CALL 'kxdfhei1' USING DFHEIV0,
 20407           CERT-ID,
 20408           CERTIFICATE-MASTER,
 20409           DFHEIV11,
 20410           DFHEIV99
 20411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20412        GO TO 7800-EXIT.
 20413
 20414       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 20415       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 20416
 20417 7800-EXIT.
 20418      EXIT.
 20419
 20420 7900-DELETE-CERT.
 20421
 20422* EXEC CICS DELETE
 20423*        DATASET (CERT-ID)
 20424*    END-EXEC.
 20425*    MOVE '&(                    &   #00019788' TO DFHEIV0
 20426     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 20427     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20428     MOVE X'2020233030303139373838' TO DFHEIV0(25:11)
 20429     CALL 'kxdfhei1' USING DFHEIV0,
 20430           CERT-ID,
 20431           DFHEIV99,
 20432           DFHEIV99,
 20433           DFHEIV99,
 20434           DFHEIV99
 20435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20436
 20437
 20438 7900-EXIT.
 20439     EXIT.
 20440
 20441 8000-WRITE-CERT.
 20442
 20443* EXEC CICS HANDLE CONDITION
 20444*        DUPKEY    (8000-FREE-MAIN)
 20445*    END-EXEC.
 20446*    MOVE '"$$                   ! + #00019796' TO DFHEIV0
 20447     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 20448     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20449     MOVE X'2B20233030303139373936' TO DFHEIV0(25:11)
 20450     CALL 'kxdfhei1' USING DFHEIV0
 20451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20452
 20453
 20454
 20455* EXEC CICS WRITE
 20456*        DATASET     (CERT-ID)
 20457*        FROM        (CERTIFICATE-MASTER)
 20458*        RIDFLD      (ELCERT-KEY)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 376
* EL050.cbl
 20459*    END-EXEC.
 20460     MOVE LENGTH OF
 20461      CERTIFICATE-MASTER
 20462       TO DFHEIV11
 20463*    MOVE '&$ L                  ''   #00019800' TO DFHEIV0
 20464     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20465     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20466     MOVE X'2020233030303139383030' TO DFHEIV0(25:11)
 20467     CALL 'kxdfhei1' USING DFHEIV0,
 20468           CERT-ID,
 20469           CERTIFICATE-MASTER,
 20470           DFHEIV11,
 20471           ELCERT-KEY,
 20472           DFHEIV99,
 20473           DFHEIV99
 20474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20475
 20476
 20477 8000-FREE-MAIN.
 20478
 20479 8000-EXIT.
 20480      EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 377
* EL050.cbl
 20482
 20483 8100-READ-ERPNDM.
 20484
 20485* EXEC CICS HANDLE CONDITION
 20486*         NOTFND     (8100-NOTFND)
 20487*         ENDFILE    (8100-NOTFND)
 20488*    END-EXEC.
 20489*    MOVE '"$I''                  ! , #00019813' TO DFHEIV0
 20490     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20491     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20492     MOVE X'2C20233030303139383133' TO DFHEIV0(25:11)
 20493     CALL 'kxdfhei1' USING DFHEIV0
 20494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20495
 20496
 20497     MOVE SPACES                 TO ERPNDM-FOUND.
 20498     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 20499
 20500
 20501* EXEC CICS READ UPDATE
 20502*         DATASET   (FILE-ERPNDM)
 20503*         RIDFLD    (PM-CONTROL-PRIMARY)
 20504*         INTO      (PENDING-MAILING-DATA)
 20505*    END-EXEC.
 20506     MOVE LENGTH OF
 20507      PENDING-MAILING-DATA
 20508       TO DFHEIV11
 20509*    MOVE '&"IL       EU         (   #00019821' TO DFHEIV0
 20510     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20511     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20512     MOVE X'2020233030303139383231' TO DFHEIV0(25:11)
 20513     CALL 'kxdfhei1' USING DFHEIV0,
 20514           FILE-ERPNDM,
 20515           PENDING-MAILING-DATA,
 20516           DFHEIV11,
 20517           PM-CONTROL-PRIMARY,
 20518           DFHEIV99,
 20519           DFHEIV99,
 20520           DFHEIV99
 20521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20522
 20523
 20524     GO TO 8100-EXIT.
 20525
 20526 8100-NOTFND.
 20527
 20528     MOVE 'X'                    TO ERPNDM-FOUND.
 20529     MOVE ER-2694                TO WS-ERROR.
 20530     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20531     MOVE ER-2883                TO WS-ERROR
 20532     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 20533     .
 20534 8100-EXIT.
 20535     EXIT.
 20536 8102-REWRITE-ERPNDM.
 20537
 20538
 20539* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 378
* EL050.cbl
 20540*         DATASET    (FILE-ERPNDM)
 20541*         FROM       (PENDING-MAILING-DATA)
 20542*    END-EXEC
 20543     MOVE LENGTH OF
 20544      PENDING-MAILING-DATA
 20545       TO DFHEIV11
 20546*    MOVE '&& L                  %   #00019841' TO DFHEIV0
 20547     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20548     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20549     MOVE X'2020233030303139383431' TO DFHEIV0(25:11)
 20550     CALL 'kxdfhei1' USING DFHEIV0,
 20551           FILE-ERPNDM,
 20552           PENDING-MAILING-DATA,
 20553           DFHEIV11,
 20554           DFHEIV99
 20555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20556
 20557     .
 20558 8102-EXIT.
 20559     EXIT.
 20560 8104-UNLOCK-ERPNDM.
 20561
 20562
 20563* EXEC CICS UNLOCK
 20564*         DATASET   (FILE-ERPNDM)
 20565*    END-EXEC
 20566*    MOVE '&*                    #   #00019851' TO DFHEIV0
 20567     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20568     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20569     MOVE X'2020233030303139383531' TO DFHEIV0(25:11)
 20570     CALL 'kxdfhei1' USING DFHEIV0,
 20571           FILE-ERPNDM,
 20572           DFHEIV99
 20573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20574
 20575     .
 20576 8104-EXIT.
 20577     EXIT.
 20578 8110-READ-ERMAIL.
 20579
 20580* EXEC CICS HANDLE CONDITION
 20581*         NOTFND     (8110-NOTFND)
 20582*         ENDFILE    (8110-NOTFND)
 20583*    END-EXEC.
 20584*    MOVE '"$I''                  ! - #00019859' TO DFHEIV0
 20585     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20586     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20587     MOVE X'2D20233030303139383539' TO DFHEIV0(25:11)
 20588     CALL 'kxdfhei1' USING DFHEIV0
 20589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20590
 20591
 20592     MOVE SPACES                 TO ERMAIL-FOUND.
 20593     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 20594     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 20595     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 20596     MOVE PB-SV-STATE            TO MA-STATE.
 20597
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 379
* EL050.cbl
 20598
 20599* EXEC CICS READ
 20600*         UPDATE
 20601*         DATASET   (FILE-ERMAIL)
 20602*         RIDFLD    (MA-CONTROL-PRIMARY)
 20603*         INTO      (MAILING-DATA)
 20604*    END-EXEC.
 20605     MOVE LENGTH OF
 20606      MAILING-DATA
 20607       TO DFHEIV11
 20608*    MOVE '&"IL       EU         (   #00019870' TO DFHEIV0
 20609     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20610     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20611     MOVE X'2020233030303139383730' TO DFHEIV0(25:11)
 20612     CALL 'kxdfhei1' USING DFHEIV0,
 20613           FILE-ERMAIL,
 20614           MAILING-DATA,
 20615           DFHEIV11,
 20616           MA-CONTROL-PRIMARY,
 20617           DFHEIV99,
 20618           DFHEIV99,
 20619           DFHEIV99
 20620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20621
 20622
 20623     GO TO 8110-EXIT.
 20624
 20625 8110-NOTFND.
 20626     MOVE 'X'                    TO ERMAIL-FOUND.
 20627
 20628 8110-EXIT.
 20629     EXIT.
 20630
 20631 8120-REWRITE-ERMAIL.
 20632
 20633* EXEC CICS REWRITE
 20634*         DATASET    (FILE-ERMAIL)
 20635*         FROM       (MAILING-DATA)
 20636*    END-EXEC.
 20637     MOVE LENGTH OF
 20638      MAILING-DATA
 20639       TO DFHEIV11
 20640*    MOVE '&& L                  %   #00019886' TO DFHEIV0
 20641     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20642     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20643     MOVE X'2020233030303139383836' TO DFHEIV0(25:11)
 20644     CALL 'kxdfhei1' USING DFHEIV0,
 20645           FILE-ERMAIL,
 20646           MAILING-DATA,
 20647           DFHEIV11,
 20648           DFHEIV99
 20649     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20650
 20651
 20652 8120-EXIT.
 20653     EXIT.
 20654
 20655 8130-WRITE-ERMAIL.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 380
* EL050.cbl
 20656
 20657* EXEC CICS HANDLE CONDITION
 20658*         DUPKEY   (8130-EXIT)
 20659*    END-EXEC.
 20660*    MOVE '"$$                   ! . #00019895' TO DFHEIV0
 20661     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 20662     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20663     MOVE X'2E20233030303139383935' TO DFHEIV0(25:11)
 20664     CALL 'kxdfhei1' USING DFHEIV0
 20665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20666
 20667
 20668
 20669* EXEC CICS WRITE
 20670*         DATASET     (FILE-ERMAIL)
 20671*         RIDFLD      (MA-CONTROL-PRIMARY)
 20672*         FROM        (MAILING-DATA)
 20673*    END-EXEC.
 20674     MOVE LENGTH OF
 20675      MAILING-DATA
 20676       TO DFHEIV11
 20677*    MOVE '&$ L                  ''   #00019899' TO DFHEIV0
 20678     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20679     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20680     MOVE X'2020233030303139383939' TO DFHEIV0(25:11)
 20681     CALL 'kxdfhei1' USING DFHEIV0,
 20682           FILE-ERMAIL,
 20683           MAILING-DATA,
 20684           DFHEIV11,
 20685           MA-CONTROL-PRIMARY,
 20686           DFHEIV99,
 20687           DFHEIV99
 20688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20689
 20690
 20691 8130-EXIT.
 20692     EXIT.
 20693
 20694 8140-UNLOCK-ERMAIL.
 20695
 20696* EXEC CICS UNLOCK
 20697*         DATASET   (FILE-ERMAIL)
 20698*    END-EXEC.
 20699*    MOVE '&*                    #   #00019909' TO DFHEIV0
 20700     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20701     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20702     MOVE X'2020233030303139393039' TO DFHEIV0(25:11)
 20703     CALL 'kxdfhei1' USING DFHEIV0,
 20704           FILE-ERMAIL,
 20705           DFHEIV99
 20706     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20707
 20708
 20709 8140-EXIT.
 20710     EXIT.
 20711
 20712 8150-read-elcrtt.
 20713
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 381
* EL050.cbl
 20714
 20715* EXEC CICS HANDLE CONDITION
 20716*        NOTFND   (8150-exit)
 20717*    END-EXEC
 20718*    MOVE '"$I                   ! / #00019918' TO DFHEIV0
 20719     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20720     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20721     MOVE X'2F20233030303139393138' TO DFHEIV0(25:11)
 20722     CALL 'kxdfhei1' USING DFHEIV0
 20723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20724
 20725     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20726     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20727
 20728
 20729* EXEC CICS READ
 20730*        DATASET  (CRTT-ID)
 20731*        RIDFLD   (WS-ELCRTT-KEY)
 20732*        INTO     (CERTIFICATE-TRAILERS)
 20733*    END-EXEC
 20734     MOVE LENGTH OF
 20735      CERTIFICATE-TRAILERS
 20736       TO DFHEIV11
 20737*    MOVE '&"IL       E          (   #00019925' TO DFHEIV0
 20738     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20739     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20740     MOVE X'2020233030303139393235' TO DFHEIV0(25:11)
 20741     CALL 'kxdfhei1' USING DFHEIV0,
 20742           CRTT-ID,
 20743           CERTIFICATE-TRAILERS,
 20744           DFHEIV11,
 20745           WS-ELCRTT-KEY,
 20746           DFHEIV99,
 20747           DFHEIV99,
 20748           DFHEIV99
 20749     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20750
 20751     move cs-ins-age-default-flag to ws-ins-age-defaulted
 20752     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 20753     move cs-vehicle-odometer    to ws-vehicle-odometer
 20754
 20755     .
 20756 8150-exit.
 20757     exit.
 20758 8180-UPDATE-VIN-NUMBER.
 20759
 20760* EXEC CICS HANDLE CONDITION
 20761*        NOTFND   (8180-NOTFND)
 20762*    END-EXEC.
 20763*    MOVE '"$I                   ! 0 #00019939' TO DFHEIV0
 20764     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20765     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20766     MOVE X'3020233030303139393339' TO DFHEIV0(25:11)
 20767     CALL 'kxdfhei1' USING DFHEIV0
 20768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20769
 20770
 20771     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 382
* EL050.cbl
 20772     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20773
 20774
 20775* EXEC CICS READ
 20776*        UPDATE
 20777*        DATASET  (CRTT-ID)
 20778*        RIDFLD   (WS-ELCRTT-KEY)
 20779*        INTO     (CERTIFICATE-TRAILERS)
 20780*    END-EXEC.
 20781     MOVE LENGTH OF
 20782      CERTIFICATE-TRAILERS
 20783       TO DFHEIV11
 20784*    MOVE '&"IL       EU         (   #00019946' TO DFHEIV0
 20785     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20786     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20787     MOVE X'2020233030303139393436' TO DFHEIV0(25:11)
 20788     CALL 'kxdfhei1' USING DFHEIV0,
 20789           CRTT-ID,
 20790           CERTIFICATE-TRAILERS,
 20791           DFHEIV11,
 20792           WS-ELCRTT-KEY,
 20793           DFHEIV99,
 20794           DFHEIV99,
 20795           DFHEIV99
 20796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20797
 20798
 20799     IF (PB-I-VIN NOT EQUAL CS-VIN-NUMBER)
 20800        or (hldi-pass-area not = spaces)
 20801        move pa-modelyear        to cs-year
 20802        move pa-makename         to cs-make
 20803        move pa-modelname        to cs-model
 20804        move pa-seriesname       to cs-future
 20805        MOVE PB-I-VIN TO CS-VIN-NUMBER
 20806
 20807* EXEC CICS REWRITE
 20808*           DATASET  (CRTT-ID)
 20809*           FROM     (CERTIFICATE-TRAILERS)
 20810*        END-EXEC
 20811     MOVE LENGTH OF
 20812      CERTIFICATE-TRAILERS
 20813       TO DFHEIV11
 20814*    MOVE '&& L                  %   #00019960' TO DFHEIV0
 20815     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20816     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20817     MOVE X'2020233030303139393630' TO DFHEIV0(25:11)
 20818     CALL 'kxdfhei1' USING DFHEIV0,
 20819           CRTT-ID,
 20820           CERTIFICATE-TRAILERS,
 20821           DFHEIV11,
 20822           DFHEIV99
 20823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20824     ELSE
 20825
 20826* EXEC CICS UNLOCK
 20827*          DATASET  (CRTT-ID)
 20828*       END-EXEC
 20829*    MOVE '&*                    #   #00019965' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 383
* EL050.cbl
 20830     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20831     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20832     MOVE X'2020233030303139393635' TO DFHEIV0(25:11)
 20833     CALL 'kxdfhei1' USING DFHEIV0,
 20834           CRTT-ID,
 20835           DFHEIV99
 20836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20837     END-IF.
 20838
 20839     GO TO 8180-EXIT.
 20840
 20841 8180-NOTFND.
 20842
 20843     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20844     MOVE 'CS'         TO CS-RECORD-ID.
 20845     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20846     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20847     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20848     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 20849
 20850* EXEC CICS WRITE
 20851*       DATASET  (CRTT-ID)
 20852*       RIDFLD   (WS-ELCRTT-KEY)
 20853*       FROM     (CERTIFICATE-TRAILERS)
 20854*    END-EXEC.
 20855     MOVE LENGTH OF
 20856      CERTIFICATE-TRAILERS
 20857       TO DFHEIV11
 20858*    MOVE '&$ L                  ''   #00019980' TO DFHEIV0
 20859     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20860     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20861     MOVE X'2020233030303139393830' TO DFHEIV0(25:11)
 20862     CALL 'kxdfhei1' USING DFHEIV0,
 20863           CRTT-ID,
 20864           CERTIFICATE-TRAILERS,
 20865           DFHEIV11,
 20866           WS-ELCRTT-KEY,
 20867           DFHEIV99,
 20868           DFHEIV99
 20869     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20870
 20871
 20872 8180-EXIT.
 20873     EXIT.
 20874
 20875 8190-UPDATE-REFUND-CLAIM-FLAG.
 20876
 20877* EXEC CICS HANDLE CONDITION
 20878*        NOTFND   (8190-NOTFND)
 20879*    END-EXEC.
 20880*    MOVE '"$I                   ! 1 #00019990' TO DFHEIV0
 20881     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20882     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20883     MOVE X'3120233030303139393930' TO DFHEIV0(25:11)
 20884     CALL 'kxdfhei1' USING DFHEIV0
 20885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20886
 20887
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 384
* EL050.cbl
 20888     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20889     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20890
 20891
 20892* EXEC CICS READ
 20893*        UPDATE
 20894*        DATASET  (CRTT-ID)
 20895*        RIDFLD   (WS-ELCRTT-KEY)
 20896*        INTO     (CERTIFICATE-TRAILERS)
 20897*    END-EXEC.
 20898     MOVE LENGTH OF
 20899      CERTIFICATE-TRAILERS
 20900       TO DFHEIV11
 20901*    MOVE '&"IL       EU         (   #00019997' TO DFHEIV0
 20902     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20903     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20904     MOVE X'2020233030303139393937' TO DFHEIV0(25:11)
 20905     CALL 'kxdfhei1' USING DFHEIV0,
 20906           CRTT-ID,
 20907           CERTIFICATE-TRAILERS,
 20908           DFHEIV11,
 20909           WS-ELCRTT-KEY,
 20910           DFHEIV99,
 20911           DFHEIV99,
 20912           DFHEIV99
 20913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20914
 20915
 20916     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20917
 20918* EXEC CICS REWRITE
 20919*       DATASET  (CRTT-ID)
 20920*       FROM     (CERTIFICATE-TRAILERS)
 20921*    END-EXEC.
 20922     MOVE LENGTH OF
 20923      CERTIFICATE-TRAILERS
 20924       TO DFHEIV11
 20925*    MOVE '&& L                  %   #00020005' TO DFHEIV0
 20926     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20927     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20928     MOVE X'2020233030303230303035' TO DFHEIV0(25:11)
 20929     CALL 'kxdfhei1' USING DFHEIV0,
 20930           CRTT-ID,
 20931           CERTIFICATE-TRAILERS,
 20932           DFHEIV11,
 20933           DFHEIV99
 20934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20935
 20936
 20937     GO TO 8190-EXIT.
 20938
 20939 8190-NOTFND.
 20940
 20941     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20942     MOVE 'CS'         TO CS-RECORD-ID.
 20943     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20944     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20945     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 385
* EL050.cbl
 20946     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20947
 20948* EXEC CICS WRITE
 20949*       DATASET  (CRTT-ID)
 20950*       RIDFLD   (WS-ELCRTT-KEY)
 20951*       FROM     (CERTIFICATE-TRAILERS)
 20952*    END-EXEC.
 20953     MOVE LENGTH OF
 20954      CERTIFICATE-TRAILERS
 20955       TO DFHEIV11
 20956*    MOVE '&$ L                  ''   #00020020' TO DFHEIV0
 20957     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20958     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20959     MOVE X'2020233030303230303230' TO DFHEIV0(25:11)
 20960     CALL 'kxdfhei1' USING DFHEIV0,
 20961           CRTT-ID,
 20962           CERTIFICATE-TRAILERS,
 20963           DFHEIV11,
 20964           WS-ELCRTT-KEY,
 20965           DFHEIV99,
 20966           DFHEIV99
 20967     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20968
 20969
 20970 8190-EXIT.
 20971     EXIT.
 20972
 20973 8195-UPDATE-AGE-FLAGS.
 20974
 20975* EXEC CICS HANDLE CONDITION
 20976*        NOTFND   (8195-NOTFND)
 20977*    END-EXEC.
 20978*    MOVE '"$I                   ! 2 #00020030' TO DFHEIV0
 20979     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20980     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20981     MOVE X'3220233030303230303330' TO DFHEIV0(25:11)
 20982     CALL 'kxdfhei1' USING DFHEIV0
 20983     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20984
 20985
 20986     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20987     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20988
 20989
 20990* EXEC CICS READ
 20991*        UPDATE
 20992*        DATASET  (CRTT-ID)
 20993*        RIDFLD   (WS-ELCRTT-KEY)
 20994*        INTO     (CERTIFICATE-TRAILERS)
 20995*    END-EXEC.
 20996     MOVE LENGTH OF
 20997      CERTIFICATE-TRAILERS
 20998       TO DFHEIV11
 20999*    MOVE '&"IL       EU         (   #00020037' TO DFHEIV0
 21000     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21001     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21002     MOVE X'2020233030303230303337' TO DFHEIV0(25:11)
 21003     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 386
* EL050.cbl
 21004           CRTT-ID,
 21005           CERTIFICATE-TRAILERS,
 21006           DFHEIV11,
 21007           WS-ELCRTT-KEY,
 21008           DFHEIV99,
 21009           DFHEIV99,
 21010           DFHEIV99
 21011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21012
 21013
 21014     IF WS-INS-AGE-SET = 'Y'
 21015        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 21016     END-IF
 21017     IF WS-JNT-AGE-SET = 'Y'
 21018        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 21019     END-IF
 21020
 21021
 21022* EXEC CICS REWRITE
 21023*       DATASET  (CRTT-ID)
 21024*       FROM     (CERTIFICATE-TRAILERS)
 21025*    END-EXEC.
 21026     MOVE LENGTH OF
 21027      CERTIFICATE-TRAILERS
 21028       TO DFHEIV11
 21029*    MOVE '&& L                  %   #00020051' TO DFHEIV0
 21030     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21031     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21032     MOVE X'2020233030303230303531' TO DFHEIV0(25:11)
 21033     CALL 'kxdfhei1' USING DFHEIV0,
 21034           CRTT-ID,
 21035           CERTIFICATE-TRAILERS,
 21036           DFHEIV11,
 21037           DFHEIV99
 21038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21039
 21040
 21041     GO TO 8195-EXIT.
 21042
 21043 8195-NOTFND.
 21044
 21045     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 21046     MOVE 'CS'         TO CS-RECORD-ID.
 21047     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 21048     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 21049     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 21050     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 21051     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 21052
 21053* EXEC CICS WRITE
 21054*       DATASET  (CRTT-ID)
 21055*       RIDFLD   (WS-ELCRTT-KEY)
 21056*       FROM     (CERTIFICATE-TRAILERS)
 21057*    END-EXEC.
 21058     MOVE LENGTH OF
 21059      CERTIFICATE-TRAILERS
 21060       TO DFHEIV11
 21061*    MOVE '&$ L                  ''   #00020067' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 387
* EL050.cbl
 21062     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21063     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21064     MOVE X'2020233030303230303637' TO DFHEIV0(25:11)
 21065     CALL 'kxdfhei1' USING DFHEIV0,
 21066           CRTT-ID,
 21067           CERTIFICATE-TRAILERS,
 21068           DFHEIV11,
 21069           WS-ELCRTT-KEY,
 21070           DFHEIV99,
 21071           DFHEIV99
 21072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21073
 21074
 21075 8195-EXIT.
 21076     EXIT.
 21077
 21078 8200-READ-REIN-TABLE.
 21079
 21080* EXEC CICS HANDLE CONDITION
 21081*         NOTFND   (8200-NOTFND)
 21082*    END-EXEC.
 21083*    MOVE '"$I                   ! 3 #00020077' TO DFHEIV0
 21084     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21085     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21086     MOVE X'3320233030303230303737' TO DFHEIV0(25:11)
 21087     CALL 'kxdfhei1' USING DFHEIV0
 21088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21089
 21090
 21091
 21092* EXEC CICS READ
 21093*        DATASET     (REIN-ID)
 21094*        SET         (ADDRESS OF REINSURANCE-RECORD)
 21095*        RIDFLD      (ERREIN-KEY)
 21096*    END-EXEC.
 21097*    MOVE '&"S        E          (   #00020081' TO DFHEIV0
 21098     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21099     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21100     MOVE X'2020233030303230303831' TO DFHEIV0(25:11)
 21101     CALL 'kxdfhei1' USING DFHEIV0,
 21102           REIN-ID,
 21103           DFHEIV20,
 21104           DFHEIV99,
 21105           ERREIN-KEY,
 21106           DFHEIV99,
 21107           DFHEIV99,
 21108           DFHEIV99
 21109     SET ADDRESS OF REINSURANCE-RECORD TO
 21110         DFHEIV20
 21111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21112
 21113
 21114     GO TO 8200-EXIT.
 21115
 21116 8200-NOTFND.
 21117     MOVE 'N'             TO WS-REIN-READ-SW.
 21118
 21119 8200-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 388
* EL050.cbl
 21120      EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 389
* EL050.cbl
 21122
 21123 8300-READ-CTBL-TABLE.
 21124
 21125* EXEC CICS HANDLE CONDITION
 21126*        NOTFND    (8300-NOTFND)
 21127*        DISABLED  (8300-ERRESS-PROBLEM)
 21128*        NOTOPEN   (8300-ERRESS-PROBLEM)
 21129*        ENDFILE   (8300-NOTFND)
 21130*    END-EXEC.
 21131*    MOVE '"$IcJ''                ! 4 #00020097' TO DFHEIV0
 21132     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 21133     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21134     MOVE X'3420233030303230303937' TO DFHEIV0(25:11)
 21135     CALL 'kxdfhei1' USING DFHEIV0
 21136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21137
 21138
 21139
 21140* EXEC CICS READ
 21141*        DATASET     (CTBL-ID)
 21142*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 21143*        RIDFLD      (ERCTBL-KEY)
 21144*    END-EXEC.
 21145*    MOVE '&"S        E          (   #00020104' TO DFHEIV0
 21146     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21147     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21148     MOVE X'2020233030303230313034' TO DFHEIV0(25:11)
 21149     CALL 'kxdfhei1' USING DFHEIV0,
 21150           CTBL-ID,
 21151           DFHEIV20,
 21152           DFHEIV99,
 21153           ERCTBL-KEY,
 21154           DFHEIV99,
 21155           DFHEIV99,
 21156           DFHEIV99
 21157     SET ADDRESS OF COMM-TABLE-RECORD TO
 21158         DFHEIV20
 21159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21160
 21161
 21162     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 21163
 21164     GO TO 8300-EXIT.
 21165
 21166 8300-NOTFND.
 21167
 21168     IF CTBL-SW = '0530'
 21169         MOVE 'AA'                     TO WS-AH-COMP-CD
 21170         MOVE '0550'                   TO CTBL-SW
 21171         MOVE '1'                      TO WS-CTBL-READ-SW
 21172         GO TO 8300-EXIT.
 21173
 21174     IF CTBL-SW = '0540'
 21175         MOVE 'AA'                     TO WS-LF-COMP-CD
 21176         MOVE '0550'                   TO CTBL-SW
 21177         MOVE '1'                      TO WS-CTBL-READ-SW
 21178         GO TO 8300-EXIT.
 21179
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 390
* EL050.cbl
 21180     IF CTBL-SW = '0550'
 21181         MOVE '2'                      TO WS-CTBL-READ-SW
 21182         GO TO 8300-EXIT.
 21183
 21184     GO TO 8300-EXIT.
 21185
 21186 8300-ERRESS-PROBLEM.
 21187
 21188      MOVE ER-8050              TO WS-ERROR.
 21189      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21190
 21191     GO TO 8300-EXIT.
 21192
 21193 8300-EXIT.
 21194      EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 391
* EL050.cbl
 21196
 21197
 21198 8400-GETMAIN-ERFORM.
 21199
 21200
 21201* EXEC CICS   GETMAIN
 21202*        LENGTH  (500)
 21203*        SET     (ADDRESS OF FORM-MASTER)
 21204*    END-EXEC.
 21205     MOVE 500
 21206       TO DFHEIV11
 21207*    MOVE '," L                  $   #00020148' TO DFHEIV0
 21208     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21209     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21210     MOVE X'2020233030303230313438' TO DFHEIV0(25:11)
 21211     CALL 'kxdfhei1' USING DFHEIV0,
 21212           DFHEIV20,
 21213           DFHEIV11,
 21214           DFHEIV99
 21215     SET ADDRESS OF FORM-MASTER TO
 21216         DFHEIV20
 21217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21218
 21219
 21220     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 21221
 21222 8400-EXIT.
 21223      EXIT.
 21224
 21225 8450-READ-FORM-MASTER.
 21226
 21227
 21228* EXEC CICS  HANDLE CONDITION
 21229*        NOTFND   (8450-FORM-NOT-FOUND)
 21230*        ENDFILE  (8450-FORM-NOT-FOUND)
 21231*    END-EXEC.
 21232*    MOVE '"$I''                  ! 5 #00020160' TO DFHEIV0
 21233     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21234     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21235     MOVE X'3520233030303230313630' TO DFHEIV0(25:11)
 21236     CALL 'kxdfhei1' USING DFHEIV0
 21237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21238
 21239
 21240
 21241* EXEC CICS   READ
 21242*        DATASET   (FORM-ID)
 21243*        RIDFLD    (ERFORM-KEY)
 21244*        INTO      (FORM-MASTER)
 21245*        GTEQ
 21246*    END-EXEC.
 21247     MOVE LENGTH OF
 21248      FORM-MASTER
 21249       TO DFHEIV11
 21250*    MOVE '&"IL       G          (   #00020165' TO DFHEIV0
 21251     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21252     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21253     MOVE X'2020233030303230313635' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 392
* EL050.cbl
 21254     CALL 'kxdfhei1' USING DFHEIV0,
 21255           FORM-ID,
 21256           FORM-MASTER,
 21257           DFHEIV11,
 21258           ERFORM-KEY,
 21259           DFHEIV99,
 21260           DFHEIV99,
 21261           DFHEIV99
 21262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21263
 21264
 21265     MOVE  'Y'           TO  FORM-MASTER-SW.
 21266
 21267     GO TO  8450-EXIT.
 21268
 21269 8450-FORM-NOT-FOUND.
 21270
 21271     MOVE  'N'           TO  FORM-MASTER-SW.
 21272
 21273 8450-EXIT.
 21274      EXIT.
 21275
 21276 8500-DATE-CONVERT.
 21277
 21278* EXEC CICS LINK
 21279*        PROGRAM    ('ELDATCV')
 21280*        COMMAREA   (DATE-CONVERSION-DATA)
 21281*        LENGTH     (DC-COMM-LENGTH)
 21282*    END-EXEC.
 21283     MOVE 'ELDATCV' TO DFHEIV1
 21284*    MOVE '."C                   (   #00020184' TO DFHEIV0
 21285     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21286     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21287     MOVE X'2020233030303230313834' TO DFHEIV0(25:11)
 21288     CALL 'kxdfhei1' USING DFHEIV0,
 21289           DFHEIV1,
 21290           DATE-CONVERSION-DATA,
 21291           DC-COMM-LENGTH,
 21292           DFHEIV99,
 21293           DFHEIV99,
 21294           DFHEIV99,
 21295           DFHEIV99
 21296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21297
 21298
 21299 8500-EXIT.
 21300     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 393
* EL050.cbl
 21302
 21303 8555-RELOAD-CONTROL-FILE.
 21304     CONTINUE.
 21305
 21306 8555-EXIT.
 21307     EXIT.
 21308
 21309 8557-GETMAIN-ERPLAN.
 21310
 21311
 21312* EXEC CICS GETMAIN
 21313*        LENGTH    (840)
 21314*        SET       (ADDRESS OF PLAN-RECORDS)
 21315*    END-EXEC.
 21316     MOVE 840
 21317       TO DFHEIV11
 21318*    MOVE '," L                  $   #00020202' TO DFHEIV0
 21319     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21320     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21321     MOVE X'2020233030303230323032' TO DFHEIV0(25:11)
 21322     CALL 'kxdfhei1' USING DFHEIV0,
 21323           DFHEIV20,
 21324           DFHEIV11,
 21325           DFHEIV99
 21326     SET ADDRESS OF PLAN-RECORDS TO
 21327         DFHEIV20
 21328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21329
 21330
 21331     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 21332
 21333 8557-EXIT.
 21334     EXIT.
 21335
 21336 8560-GETMAIN.
 21337
 21338* EXEC CICS GETMAIN
 21339*        LENGTH    (2000)
 21340*        SET       (ADDRESS OF ACCOUNT-MASTER)
 21341*    END-EXEC.
 21342     MOVE 2000
 21343       TO DFHEIV11
 21344*    MOVE '," L                  $   #00020213' TO DFHEIV0
 21345     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21346     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21347     MOVE X'2020233030303230323133' TO DFHEIV0(25:11)
 21348     CALL 'kxdfhei1' USING DFHEIV0,
 21349           DFHEIV20,
 21350           DFHEIV11,
 21351           DFHEIV99
 21352     SET ADDRESS OF ACCOUNT-MASTER TO
 21353         DFHEIV20
 21354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21355
 21356
 21357     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 21358
 21359 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 394
* EL050.cbl
 21360     EXIT.
 21361
 21362 8570-START-ACCOUNT-MASTER.
 21363
 21364* EXEC CICS HANDLE CONDITION
 21365*        NOTFND    (0199-ACCT-NOT-FOUND)
 21366*        ENDFILE   (0199-ACCT-NOT-FOUND)
 21367*    END-EXEC.
 21368*    MOVE '"$I''                  ! 6 #00020224' TO DFHEIV0
 21369     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21370     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21371     MOVE X'3620233030303230323234' TO DFHEIV0(25:11)
 21372     CALL 'kxdfhei1' USING DFHEIV0
 21373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21374
 21375
 21376
 21377* EXEC CICS STARTBR
 21378*        DATASET    (ACCT-ID)
 21379*        RIDFLD     (ERACCT-KEY)
 21380*        GTEQ
 21381*    END-EXEC.
 21382     MOVE 0
 21383       TO DFHEIV11
 21384*    MOVE '&,         G          &   #00020229' TO DFHEIV0
 21385     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21386     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21387     MOVE X'2020233030303230323239' TO DFHEIV0(25:11)
 21388     CALL 'kxdfhei1' USING DFHEIV0,
 21389           ACCT-ID,
 21390           ERACCT-KEY,
 21391           DFHEIV99,
 21392           DFHEIV11,
 21393           DFHEIV99
 21394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21395
 21396
 21397 8570-EXIT.
 21398     EXIT.
 21399
 21400 8580-READ-ACCOUNT-MASTER.
 21401
 21402* EXEC CICS HANDLE CONDITION
 21403*        NOTFND    (0199-ACCT-NOT-FOUND)
 21404*        ENDFILE   (0199-ACCT-NOT-FOUND)
 21405*    END-EXEC.
 21406*    MOVE '"$I''                  ! 7 #00020239' TO DFHEIV0
 21407     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21408     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21409     MOVE X'3720233030303230323339' TO DFHEIV0(25:11)
 21410     CALL 'kxdfhei1' USING DFHEIV0
 21411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21412
 21413
 21414
 21415* EXEC CICS READNEXT
 21416*        DATASET     (ACCT-ID)
 21417*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 395
* EL050.cbl
 21418*        RIDFLD      (ERACCT-KEY)
 21419*    END-EXEC.
 21420     MOVE LENGTH OF
 21421      ACCOUNT-MASTER
 21422       TO DFHEIV12
 21423     MOVE 0
 21424       TO DFHEIV11
 21425*    MOVE '&.IL                  )   #00020244' TO DFHEIV0
 21426     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21427     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21428     MOVE X'2020233030303230323434' TO DFHEIV0(25:11)
 21429     CALL 'kxdfhei1' USING DFHEIV0,
 21430           ACCT-ID,
 21431           ACCOUNT-MASTER,
 21432           DFHEIV12,
 21433           ERACCT-KEY,
 21434           DFHEIV99,
 21435           DFHEIV11,
 21436           DFHEIV99,
 21437           DFHEIV99
 21438     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21439
 21440
 21441 8580-EXIT.
 21442     EXIT.
 21443
 21444 8582-READ-COMPENSATION-MASTER.
 21445
 21446* EXEC CICS HANDLE CONDITION
 21447*        NOTFND    (8582-COMP-NOT-FOUND)
 21448*        ENDFILE   (8582-COMP-NOT-FOUND)
 21449*    END-EXEC.
 21450*    MOVE '"$I''                  ! 8 #00020254' TO DFHEIV0
 21451     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21452     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21453     MOVE X'3820233030303230323534' TO DFHEIV0(25:11)
 21454     CALL 'kxdfhei1' USING DFHEIV0
 21455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21456
 21457
 21458
 21459* EXEC CICS READ
 21460*        DATASET     (COMP-ID)
 21461*        INTO        (COMPENSATION-MASTER)
 21462*        RIDFLD      (ERCOMP-KEY)
 21463*    END-EXEC.
 21464     MOVE LENGTH OF
 21465      COMPENSATION-MASTER
 21466       TO DFHEIV11
 21467*    MOVE '&"IL       E          (   #00020259' TO DFHEIV0
 21468     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21469     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21470     MOVE X'2020233030303230323539' TO DFHEIV0(25:11)
 21471     CALL 'kxdfhei1' USING DFHEIV0,
 21472           COMP-ID,
 21473           COMPENSATION-MASTER,
 21474           DFHEIV11,
 21475           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 396
* EL050.cbl
 21476           DFHEIV99,
 21477           DFHEIV99,
 21478           DFHEIV99
 21479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21480
 21481
 21482     MOVE 'Y'                    TO COMP-MASTER-SW
 21483
 21484     GO TO 8582-EXIT
 21485     .
 21486 8582-COMP-NOT-FOUND.
 21487
 21488     MOVE 'N'                    TO COMP-MASTER-SW.
 21489
 21490 8582-EXIT.
 21491     EXIT.
 21492
 21493 8583-READ-ERAGTC.
 21494
 21495* EXEC CICS HANDLE CONDITION
 21496*        NOTFND    (8583-AGTC-NOT-FOUND)
 21497*        ENDFILE   (8583-AGTC-NOT-FOUND)
 21498*    END-EXEC.
 21499*    MOVE '"$I''                  ! 9 #00020277' TO DFHEIV0
 21500     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21501     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21502     MOVE X'3920233030303230323737' TO DFHEIV0(25:11)
 21503     CALL 'kxdfhei1' USING DFHEIV0
 21504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21505
 21506
 21507
 21508* EXEC CICS STARTBR
 21509*        DATASET    (AGTC-ID)
 21510*        RIDFLD     (ERAGTC-KEY)
 21511*        GTEQ
 21512*    END-EXEC.
 21513     MOVE 0
 21514       TO DFHEIV11
 21515*    MOVE '&,         G          &   #00020282' TO DFHEIV0
 21516     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21517     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21518     MOVE X'2020233030303230323832' TO DFHEIV0(25:11)
 21519     CALL 'kxdfhei1' USING DFHEIV0,
 21520           AGTC-ID,
 21521           ERAGTC-KEY,
 21522           DFHEIV99,
 21523           DFHEIV11,
 21524           DFHEIV99
 21525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21526
 21527
 21528 8583-READ-ERAGTC-NEXT.
 21529
 21530* EXEC CICS READNEXT
 21531*        DATASET     (AGTC-ID)
 21532*        INTO        (AGENT-COMMISSIONS)
 21533*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 397
* EL050.cbl
 21534*    END-EXEC.
 21535     MOVE LENGTH OF
 21536      AGENT-COMMISSIONS
 21537       TO DFHEIV12
 21538     MOVE 0
 21539       TO DFHEIV11
 21540*    MOVE '&.IL                  )   #00020289' TO DFHEIV0
 21541     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21542     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21543     MOVE X'2020233030303230323839' TO DFHEIV0(25:11)
 21544     CALL 'kxdfhei1' USING DFHEIV0,
 21545           AGTC-ID,
 21546           AGENT-COMMISSIONS,
 21547           DFHEIV12,
 21548           ERAGTC-KEY,
 21549           DFHEIV99,
 21550           DFHEIV11,
 21551           DFHEIV99,
 21552           DFHEIV99
 21553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21554
 21555
 21556*    MOVE 'Y'                    TO AGTC-MASTER-SW
 21557
 21558     GO TO 8583-EXIT
 21559     .
 21560 8583-AGTC-NOT-FOUND.
 21561
 21562     MOVE 'N'                    TO AGTC-MASTER-SW.
 21563
 21564 8583-EXIT.
 21565     EXIT.
 21566
 21567 8584-READ-BANK-CROSS-REF.
 21568
 21569* EXEC CICS HANDLE CONDITION
 21570*        NOTFND    (8584-BXRF-NOT-FOUND)
 21571*        ENDFILE   (8584-BXRF-NOT-FOUND)
 21572*    END-EXEC.
 21573*    MOVE '"$I''                  ! : #00020307' TO DFHEIV0
 21574     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21575     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21576     MOVE X'3A20233030303230333037' TO DFHEIV0(25:11)
 21577     CALL 'kxdfhei1' USING DFHEIV0
 21578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21579
 21580
 21581
 21582* EXEC CICS READ
 21583*        DATASET     (BXRF-ID)
 21584*        INTO        (BANK-CROSS-REFERENCE)
 21585*        RIDFLD      (ERBXRF-KEY)
 21586*        LENGTH      (BXRF-REC-LENGTH)
 21587*    END-EXEC.
 21588*    MOVE '&"IL       E          (   #00020312' TO DFHEIV0
 21589     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21590     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21591     MOVE X'2020233030303230333132' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 398
* EL050.cbl
 21592     CALL 'kxdfhei1' USING DFHEIV0,
 21593           BXRF-ID,
 21594           BANK-CROSS-REFERENCE,
 21595           BXRF-REC-LENGTH,
 21596           ERBXRF-KEY,
 21597           DFHEIV99,
 21598           DFHEIV99,
 21599           DFHEIV99
 21600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21601
 21602
 21603     MOVE 'Y'                    TO BXRF-MASTER-SW
 21604
 21605     GO TO 8584-EXIT
 21606     .
 21607 8584-BXRF-NOT-FOUND.
 21608
 21609     MOVE 'N'                    TO BXRF-MASTER-SW.
 21610
 21611 8584-EXIT.
 21612     EXIT.
 21613
 21614 8585-READ-PLAN-MASTER.
 21615
 21616
 21617* EXEC CICS HANDLE CONDITION
 21618*        NOTFND    (8585-PLAN-NOT-FOUND)
 21619*        ENDFILE   (8585-PLAN-NOT-FOUND)
 21620*    END-EXEC.
 21621*    MOVE '"$I''                  ! ; #00020332' TO DFHEIV0
 21622     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21623     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21624     MOVE X'3B20233030303230333332' TO DFHEIV0(25:11)
 21625     CALL 'kxdfhei1' USING DFHEIV0
 21626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21627
 21628
 21629
 21630* EXEC CICS READ
 21631*        DATASET     (PLAN-ID)
 21632*        INTO        (PLAN-MASTER)
 21633*        RIDFLD      (ERPLAN-KEY)
 21634*    END-EXEC.
 21635     MOVE LENGTH OF
 21636      PLAN-MASTER
 21637       TO DFHEIV11
 21638*    MOVE '&"IL       E          (   #00020337' TO DFHEIV0
 21639     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21640     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21641     MOVE X'2020233030303230333337' TO DFHEIV0(25:11)
 21642     CALL 'kxdfhei1' USING DFHEIV0,
 21643           PLAN-ID,
 21644           PLAN-MASTER,
 21645           DFHEIV11,
 21646           ERPLAN-KEY,
 21647           DFHEIV99,
 21648           DFHEIV99,
 21649           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 399
* EL050.cbl
 21650     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21651
 21652
 21653     MOVE 'Y'                    TO PLAN-MASTER-SW.
 21654
 21655     GO TO 8585-EXIT.
 21656
 21657 8585-PLAN-NOT-FOUND.
 21658
 21659     MOVE 'N'                    TO PLAN-MASTER-SW.
 21660
 21661 8585-EXIT.
 21662     EXIT.
 21663
 21664 8586-READ-LOAN-OFFICER.
 21665
 21666* EXEC CICS READ
 21667*        DATASET     (LOFC-ID)
 21668*        INTO        (LOAN-OFFICER-MASTER)
 21669*        RIDFLD      (ERLOFC-KEY)
 21670*        RESP        (WS-RESPONSE)
 21671*    END-EXEC
 21672     MOVE LENGTH OF
 21673      LOAN-OFFICER-MASTER
 21674       TO DFHEIV11
 21675*    MOVE '&"IL       E          (  N#00020355' TO DFHEIV0
 21676     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21677     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21678     MOVE X'204E233030303230333535' TO DFHEIV0(25:11)
 21679     CALL 'kxdfhei1' USING DFHEIV0,
 21680           LOFC-ID,
 21681           LOAN-OFFICER-MASTER,
 21682           DFHEIV11,
 21683           ERLOFC-KEY,
 21684           DFHEIV99,
 21685           DFHEIV99,
 21686           DFHEIV99
 21687     MOVE EIBRESP  TO WS-RESPONSE
 21688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21689
 21690     IF WS-RESP-NORMAL
 21691        MOVE 'Y'                 TO LOFC-MASTER-SW
 21692     ELSE
 21693        MOVE 'N'                 TO LOFC-MASTER-SW
 21694     END-IF
 21695     .
 21696 8586-EXIT.
 21697     EXIT.
 21698 8587-START-ERPDEF.
 21699
 21700* EXEC CICS STARTBR
 21701*       DATASET   (PDEF-ID)
 21702*       RIDFLD    (ERPDEF-KEY)
 21703*       GTEQ
 21704*       RESP      (WS-RESPONSE)
 21705*    END-EXEC
 21706     MOVE 0
 21707       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 400
* EL050.cbl
 21708*    MOVE '&,         G          &  N#00020371' TO DFHEIV0
 21709     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21710     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21711     MOVE X'204E233030303230333731' TO DFHEIV0(25:11)
 21712     CALL 'kxdfhei1' USING DFHEIV0,
 21713           PDEF-ID,
 21714           ERPDEF-KEY,
 21715           DFHEIV99,
 21716           DFHEIV11,
 21717           DFHEIV99
 21718     MOVE EIBRESP  TO WS-RESPONSE
 21719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21720     IF WS-RESP-NORMAL
 21721        MOVE 'Y'                 TO PDEF-MASTER-SW
 21722     ELSE
 21723        MOVE 'N'                 TO PDEF-MASTER-SW
 21724     END-IF
 21725     .
 21726 8587-EXIT.
 21727     EXIT.
 21728 8588-READ-ERPDEF.
 21729
 21730* EXEC CICS READNEXT
 21731*       DATASET   (PDEF-ID)
 21732*       RIDFLD    (ERPDEF-KEY)
 21733*       INTO      (PRODUCT-MASTER)
 21734*       RESP      (WS-RESPONSE)
 21735*    END-EXEC
 21736     MOVE LENGTH OF
 21737      PRODUCT-MASTER
 21738       TO DFHEIV12
 21739     MOVE 0
 21740       TO DFHEIV11
 21741*    MOVE '&.IL                  )  N#00020386' TO DFHEIV0
 21742     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21743     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21744     MOVE X'204E233030303230333836' TO DFHEIV0(25:11)
 21745     CALL 'kxdfhei1' USING DFHEIV0,
 21746           PDEF-ID,
 21747           PRODUCT-MASTER,
 21748           DFHEIV12,
 21749           ERPDEF-KEY,
 21750           DFHEIV99,
 21751           DFHEIV11,
 21752           DFHEIV99,
 21753           DFHEIV99
 21754     MOVE EIBRESP  TO WS-RESPONSE
 21755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21756     IF WS-RESP-NORMAL
 21757        MOVE 'Y'                 TO PDEF-MASTER-SW
 21758     ELSE
 21759        MOVE 'N'                 TO PDEF-MASTER-SW
 21760     END-IF
 21761     .
 21762 8588-EXIT.
 21763     EXIT.
 21764 8589-ENDBR-ERPDEF.
 21765
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 401
* EL050.cbl
 21766* EXEC CICS ENDBR
 21767*       DATASET   (PDEF-ID)
 21768*    END-EXEC
 21769     MOVE 0
 21770       TO DFHEIV11
 21771*    MOVE '&2                    $   #00020401' TO DFHEIV0
 21772     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21773     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21774     MOVE X'2020233030303230343031' TO DFHEIV0(25:11)
 21775     CALL 'kxdfhei1' USING DFHEIV0,
 21776           PDEF-ID,
 21777           DFHEIV11,
 21778           DFHEIV99
 21779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21780     .
 21781 8589-EXIT.
 21782     EXIT.
 21783 8590-READ-CERT-MASTER.
 21784     IF PB-COMPANY-ID = 'UCL'
 21785         GO TO 8690-READ-CERT-MASTER-UCL.
 21786
 21787
 21788* EXEC CICS HANDLE CONDITION
 21789*         NOTFND    (0299-CERT-NOT-FOUND)
 21790*    END-EXEC.
 21791*    MOVE '"$I                   ! < #00020411' TO DFHEIV0
 21792     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21793     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21794     MOVE X'3C20233030303230343131' TO DFHEIV0(25:11)
 21795     CALL 'kxdfhei1' USING DFHEIV0
 21796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21797
 21798
 21799
 21800* EXEC CICS READ
 21801*        DATASET     (CERT-ID)
 21802*        INTO        (CERTIFICATE-MASTER)
 21803*        RIDFLD      (ELCERT-KEY)
 21804*        UPDATE
 21805*    END-EXEC.
 21806     MOVE LENGTH OF
 21807      CERTIFICATE-MASTER
 21808       TO DFHEIV11
 21809*    MOVE '&"IL       EU         (   #00020415' TO DFHEIV0
 21810     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21811     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21812     MOVE X'2020233030303230343135' TO DFHEIV0(25:11)
 21813     CALL 'kxdfhei1' USING DFHEIV0,
 21814           CERT-ID,
 21815           CERTIFICATE-MASTER,
 21816           DFHEIV11,
 21817           ELCERT-KEY,
 21818           DFHEIV99,
 21819           DFHEIV99,
 21820           DFHEIV99
 21821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21822
 21823
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 402
* EL050.cbl
 21824 8590-EXIT.
 21825     EXIT.
 21826
 21827 8690-READ-CERT-MASTER-UCL.
 21828
 21829* EXEC CICS HANDLE CONDITION
 21830*         NOTFND    (8700-READ-CERT-MASTER)
 21831*    END-EXEC.
 21832*    MOVE '"$I                   ! = #00020426' TO DFHEIV0
 21833     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21834     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21835     MOVE X'3D20233030303230343236' TO DFHEIV0(25:11)
 21836     CALL 'kxdfhei1' USING DFHEIV0
 21837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21838
 21839
 21840 8690-READ-CERT-CONT.
 21841
 21842* EXEC CICS READ
 21843*        DATASET     (CERT-ID)
 21844*        INTO        (CERTIFICATE-MASTER)
 21845*        RIDFLD      (ELCERT-KEY)
 21846*        UPDATE
 21847*    END-EXEC.
 21848     MOVE LENGTH OF
 21849      CERTIFICATE-MASTER
 21850       TO DFHEIV11
 21851*    MOVE '&"IL       EU         (   #00020431' TO DFHEIV0
 21852     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21853     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21854     MOVE X'2020233030303230343331' TO DFHEIV0(25:11)
 21855     CALL 'kxdfhei1' USING DFHEIV0,
 21856           CERT-ID,
 21857           CERTIFICATE-MASTER,
 21858           DFHEIV11,
 21859           ELCERT-KEY,
 21860           DFHEIV99,
 21861           DFHEIV99,
 21862           DFHEIV99
 21863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21864
 21865
 21866     GO TO 8590-EXIT.
 21867
 21868 8700-READ-CERT-MASTER.
 21869     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 21870     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 21871
 21872* EXEC CICS HANDLE CONDITION
 21873*         DUPKEY    (8720-COMP-ACCOUNTS)
 21874*         ENDFILE   (8730-END-BROWSE)
 21875*         NOTFND    (8740-NOT-FOUND)
 21876*    END-EXEC.
 21877*    MOVE '"$$''I                 ! > #00020443' TO DFHEIV0
 21878     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 21879     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21880     MOVE X'3E20233030303230343433' TO DFHEIV0(25:11)
 21881     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 403
* EL050.cbl
 21882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21883
 21884
 21885
 21886* EXEC CICS STARTBR
 21887*        DATASET     ('ELCERT5')
 21888*        RIDFLD      (ELCERT2-KEY)
 21889*        EQUAL
 21890*    END-EXEC.
 21891     MOVE 'ELCERT5' TO DFHEIV1
 21892     MOVE 0
 21893       TO DFHEIV11
 21894*    MOVE '&,         E          &   #00020449' TO DFHEIV0
 21895     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 21896     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21897     MOVE X'2020233030303230343439' TO DFHEIV0(25:11)
 21898     CALL 'kxdfhei1' USING DFHEIV0,
 21899           DFHEIV1,
 21900           ELCERT2-KEY,
 21901           DFHEIV99,
 21902           DFHEIV11,
 21903           DFHEIV99
 21904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21905
 21906
 21907 8710-READ-NEXT.
 21908
 21909* EXEC CICS READNEXT
 21910*        DATASET     ('ELCERT5')
 21911*        INTO        (CERTIFICATE-MASTER)
 21912*        RIDFLD      (ELCERT2-KEY)
 21913*    END-EXEC.
 21914     MOVE LENGTH OF
 21915      CERTIFICATE-MASTER
 21916       TO DFHEIV12
 21917     MOVE 'ELCERT5' TO DFHEIV1
 21918     MOVE 0
 21919       TO DFHEIV11
 21920*    MOVE '&.IL                  )   #00020456' TO DFHEIV0
 21921     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21922     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21923     MOVE X'2020233030303230343536' TO DFHEIV0(25:11)
 21924     CALL 'kxdfhei1' USING DFHEIV0,
 21925           DFHEIV1,
 21926           CERTIFICATE-MASTER,
 21927           DFHEIV12,
 21928           ELCERT2-KEY,
 21929           DFHEIV99,
 21930           DFHEIV11,
 21931           DFHEIV99,
 21932           DFHEIV99
 21933     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21934
 21935
 21936 8720-COMP-ACCOUNTS.
 21937
 21938* EXEC CICS ENTER
 21939*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 404
* EL050.cbl
 21940*         FROM (PB-C-LAST-NAME)
 21941*    END-EXEC.
 21942     MOVE 001
 21943       TO DFHEIV11
 21944*    MOVE ':$F                   %   #00020463' TO DFHEIV0
 21945     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21946     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21947     MOVE X'2020233030303230343633' TO DFHEIV0(25:11)
 21948     CALL 'kxdfhei1' USING DFHEIV0,
 21949           DFHEIV11,
 21950           PB-C-LAST-NAME,
 21951           DFHEIV99,
 21952           DFHEIV99
 21953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21954
 21955
 21956
 21957* EXEC CICS ENTER
 21958*         TRACEID (002)
 21959*         FROM (CM-INSURED-LAST-NAME)
 21960*    END-EXEC.
 21961     MOVE 002
 21962       TO DFHEIV11
 21963*    MOVE ':$F                   %   #00020468' TO DFHEIV0
 21964     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21965     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21966     MOVE X'2020233030303230343638' TO DFHEIV0(25:11)
 21967     CALL 'kxdfhei1' USING DFHEIV0,
 21968           DFHEIV11,
 21969           CM-INSURED-LAST-NAME,
 21970           DFHEIV99,
 21971           DFHEIV99
 21972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21973
 21974
 21975     IF PB-CERT-NO NOT = CM-CERT-NO
 21976         GO TO 8730-END-BROWSE.
 21977
 21978     IF PB-ACCOUNT = CM-ACCOUNT
 21979         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 21980             MOVE ER-2799        TO WS-ERROR
 21981             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21982             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 21983             GO TO 8730-END-BROWSE.
 21984
 21985     GO TO 8710-READ-NEXT.
 21986
 21987 8730-END-BROWSE.
 21988
 21989* EXEC CICS ENDBR
 21990*         DATASET    ('ELCERT5')
 21991*    END-EXEC.
 21992     MOVE 'ELCERT5' TO DFHEIV1
 21993     MOVE 0
 21994       TO DFHEIV11
 21995*    MOVE '&2                    $   #00020486' TO DFHEIV0
 21996     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21997     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 405
* EL050.cbl
 21998     MOVE X'2020233030303230343836' TO DFHEIV0(25:11)
 21999     CALL 'kxdfhei1' USING DFHEIV0,
 22000           DFHEIV1,
 22001           DFHEIV11,
 22002           DFHEIV99
 22003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22004
 22005
 22006 8740-NOT-FOUND.
 22007     GO TO 0299-CERT-NOT-FOUND.
 22008
 22009 8750-START-ELSTAT.
 22010
 22011* EXEC CICS STARTBR
 22012*       DATASET   (STAT-ID)
 22013*       RIDFLD    (ELSTAT-KEY)
 22014*       GTEQ
 22015*       RESP      (WS-RESPONSE)
 22016*    END-EXEC
 22017     MOVE 0
 22018       TO DFHEIV11
 22019*    MOVE '&,         G          &  N#00020494' TO DFHEIV0
 22020     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 22021     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 22022     MOVE X'204E233030303230343934' TO DFHEIV0(25:11)
 22023     CALL 'kxdfhei1' USING DFHEIV0,
 22024           STAT-ID,
 22025           ELSTAT-KEY,
 22026           DFHEIV99,
 22027           DFHEIV11,
 22028           DFHEIV99
 22029     MOVE EIBRESP  TO WS-RESPONSE
 22030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22031     IF WS-RESP-NORMAL
 22032        MOVE 'Y'                 TO STAT-MASTER-SW
 22033     ELSE
 22034        MOVE 'N'                 TO STAT-MASTER-SW
 22035     END-IF
 22036     .
 22037 8750-EXIT.
 22038     EXIT.
 22039 8752-READ-ELSTAT.
 22040
 22041* EXEC CICS READNEXT
 22042*       DATASET   (STAT-ID)
 22043*       RIDFLD    (ELSTAT-KEY)
 22044*       INTO      (STATE-FILE)
 22045*       RESP      (WS-RESPONSE)
 22046*    END-EXEC
 22047     MOVE LENGTH OF
 22048      STATE-FILE
 22049       TO DFHEIV12
 22050     MOVE 0
 22051       TO DFHEIV11
 22052*    MOVE '&.IL                  )  N#00020509' TO DFHEIV0
 22053     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 22054     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22055     MOVE X'204E233030303230353039' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 406
* EL050.cbl
 22056     CALL 'kxdfhei1' USING DFHEIV0,
 22057           STAT-ID,
 22058           STATE-FILE,
 22059           DFHEIV12,
 22060           ELSTAT-KEY,
 22061           DFHEIV99,
 22062           DFHEIV11,
 22063           DFHEIV99,
 22064           DFHEIV99
 22065     MOVE EIBRESP  TO WS-RESPONSE
 22066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22067     IF WS-RESP-NORMAL
 22068        MOVE 'Y'                 TO STAT-MASTER-SW
 22069     ELSE
 22070        MOVE 'N'                 TO STAT-MASTER-SW
 22071     END-IF
 22072     .
 22073 8752-EXIT.
 22074     EXIT.
 22075 8800-GET-COMP-RATE.
 22076     MOVE +1 TO IB.
 22077     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 22078         ADD +9 TO IB
 22079         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 22080             ADD +9 TO IB
 22081             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 22082                MOVE ZEROS       TO WS-WK-RATE
 22083                GO TO 8800-EXIT.
 22084
 22085     IF PB-I-AGE GREATER CT-AGE (1)
 22086         ADD +3 TO IB
 22087         IF PB-I-AGE GREATER CT-AGE (2)
 22088             ADD +3 TO IB
 22089             IF PB-I-AGE GREATER CT-AGE (3)
 22090                MOVE ZEROS       TO WS-WK-RATE
 22091                GO TO 8800-EXIT.
 22092
 22093     IF WS-WORK-TERM GREATER CT-TRM (1)
 22094         ADD +1 TO IB
 22095         IF WS-WORK-TERM GREATER CT-TRM (2)
 22096             ADD +1 TO IB
 22097             IF WS-WORK-TERM GREATER CT-TRM (3)
 22098                MOVE ZEROS       TO WS-WK-RATE
 22099                GO TO 8800-EXIT.
 22100
 22101     IF CT-RT (IB) NOT NUMERIC
 22102         MOVE CT-RT-R (IB) TO CTBL-TABLE
 22103         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 22104         GO TO 8800-GET-COMP-RATE.
 22105
 22106     MOVE CT-RT (IB) TO WS-WK-RATE.
 22107
 22108 8800-EXIT.
 22109     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 407
* EL050.cbl
 22111 8900-ADDRESS-FILE.
 22112     IF ERACCT-FILE-ADDRESSED
 22113         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 22114         GO TO 8900-ADDRESS-EXIT.
 22115
 22116     IF ELCNTL-FILE-ADDRESSED
 22117         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 22118         GO TO 8900-ADDRESS-EXIT.
 22119
 22120     IF ERPLAN-FILE-ADDRESSED
 22121         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 22122         GO TO 8900-ADDRESS-EXIT.
 22123
 22124     IF ERFORM-FILE-ADDRESSED
 22125         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 22126         GO TO 8900-ADDRESS-EXIT.
 22127
 22128 8900-ADDRESS-EXIT.
 22129     EXIT.
 22130
 22131 9000-READ-CONTROL.
 22132
 22133* EXEC CICS HANDLE CONDITION
 22134*        NOTFND    (9000-NOTFND)
 22135*    END-EXEC.
 22136*    MOVE '"$I                   ! ? #00020580' TO DFHEIV0
 22137     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22138     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22139     MOVE X'3F20233030303230353830' TO DFHEIV0(25:11)
 22140     CALL 'kxdfhei1' USING DFHEIV0
 22141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22142
 22143
 22144
 22145* EXEC CICS READ
 22146*        DATASET     (CNTL-ID)
 22147*        SET         (ADDRESS OF CONTROL-FILE)
 22148*        RIDFLD      (ELCNTL-KEY)
 22149*        GTEQ
 22150*    END-EXEC.
 22151*    MOVE '&"S        G          (   #00020584' TO DFHEIV0
 22152     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 22153     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22154     MOVE X'2020233030303230353834' TO DFHEIV0(25:11)
 22155     CALL 'kxdfhei1' USING DFHEIV0,
 22156           CNTL-ID,
 22157           DFHEIV20,
 22158           DFHEIV99,
 22159           ELCNTL-KEY,
 22160           DFHEIV99,
 22161           DFHEIV99,
 22162           DFHEIV99
 22163     SET ADDRESS OF CONTROL-FILE TO
 22164         DFHEIV20
 22165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22166
 22167
 22168     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 408
* EL050.cbl
 22169
 22170 9000-NOTFND.
 22171     IF RC-SW-1 = '1'
 22172        MOVE ER-2616              TO WS-ERROR
 22173        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22174        GO TO 9000-EXIT.
 22175
 22176     IF RC-SW-1 = '2'
 22177        MOVE ER-2602              TO WS-ERROR
 22178        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 22179
 22180 9000-EXIT.
 22181      EXIT.
 22182
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 409
* EL050.cbl
 22184 9100-READ-CONTROL.
 22185
 22186* EXEC CICS HANDLE CONDITION
 22187*        NOTFND  (9100-NOTFND)
 22188*        ENDFILE (9100-NOTFND)
 22189*    END-EXEC.
 22190*    MOVE '"$I''                  ! @ #00020608' TO DFHEIV0
 22191     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22192     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22193     MOVE X'4020233030303230363038' TO DFHEIV0(25:11)
 22194     CALL 'kxdfhei1' USING DFHEIV0
 22195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22196
 22197
 22198
 22199* EXEC CICS READ
 22200*        DATASET     (CNTL-ID)
 22201*        INTO        (CONTROL-FILE)
 22202*        RIDFLD      (ELCNTL-KEY)
 22203*        GTEQ
 22204*    END-EXEC.
 22205     MOVE LENGTH OF
 22206      CONTROL-FILE
 22207       TO DFHEIV11
 22208*    MOVE '&"IL       G          (   #00020613' TO DFHEIV0
 22209     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22210     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22211     MOVE X'2020233030303230363133' TO DFHEIV0(25:11)
 22212     CALL 'kxdfhei1' USING DFHEIV0,
 22213           CNTL-ID,
 22214           CONTROL-FILE,
 22215           DFHEIV11,
 22216           ELCNTL-KEY,
 22217           DFHEIV99,
 22218           DFHEIV99,
 22219           DFHEIV99
 22220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22221
 22222
 22223     GO TO 9100-EXIT.
 22224
 22225 9100-NOTFND.
 22226     IF RC-SW-2 = '0'
 22227        MOVE '1'                  TO STATE-RECORD-ERROR
 22228        GO TO 9100-EXIT
 22229     END-IF
 22230     IF RC-SW-2 = '1'
 22231        MOVE '1'                  TO LF-BENEFIT-ERROR
 22232        MOVE ER-2604              TO WS-ERROR
 22233        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22234        GO TO 9100-EXIT.
 22235
 22236     IF RC-SW-2 = '2'
 22237        MOVE '1'                  TO AH-BENEFIT-ERROR
 22238        MOVE ER-2605              TO WS-ERROR
 22239        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22240        GO TO 9100-EXIT.
 22241
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 410
* EL050.cbl
 22242     IF RC-SW-2 = '3'
 22243         MOVE ER-2603           TO WS-ERROR
 22244         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22245         GO TO 9100-EXIT.
 22246
 22247     IF RC-SW-2 = '4'
 22248         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 22249         GO TO 9100-EXIT.
 22250
 22251     IF RC-SW-2 = '5'
 22252         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 22253         IF WS-AH-INPUT-CD-1 = SPACE
 22254             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 22255         ELSE
 22256             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 22257
 22258 9100-EXIT.
 22259      EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 411
* EL050.cbl
 22261 9200-CONTROL-GETMAIN.
 22262
 22263* EXEC CICS GETMAIN
 22264*         LENGTH   (750)
 22265*         SET      (ADDRESS OF CONTROL-FILE)
 22266*    END-EXEC.
 22267     MOVE 750
 22268       TO DFHEIV11
 22269*    MOVE '," L                  $   #00020659' TO DFHEIV0
 22270     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 22271     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22272     MOVE X'2020233030303230363539' TO DFHEIV0(25:11)
 22273     CALL 'kxdfhei1' USING DFHEIV0,
 22274           DFHEIV20,
 22275           DFHEIV11,
 22276           DFHEIV99
 22277     SET ADDRESS OF CONTROL-FILE TO
 22278         DFHEIV20
 22279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22280
 22281
 22282     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 22283
 22284 9200-EXIT.
 22285     EXIT.
 22286
 22287 9250-UNLOCK-RETURN.
 22288
 22289* EXEC CICS UNLOCK
 22290*        DATASET   (CERT-ID)
 22291*    END-EXEC.
 22292*    MOVE '&*                    #   #00020670' TO DFHEIV0
 22293     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 22294     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 22295     MOVE X'2020233030303230363730' TO DFHEIV0(25:11)
 22296     CALL 'kxdfhei1' USING DFHEIV0,
 22297           CERT-ID,
 22298           DFHEIV99
 22299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22300
 22301
 22302 9300-ABEND.
 22303     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 22304
 22305
 22306* EXEC CICS LINK
 22307*        PROGRAM   ('EL004')
 22308*        COMMAREA  (WS-ERROR-LINE)
 22309*        LENGTH    (72)
 22310*    END-EXEC.
 22311     MOVE 'EL004' TO DFHEIV1
 22312     MOVE 72
 22313       TO DFHEIV11
 22314*    MOVE '."C                   (   #00020677' TO DFHEIV0
 22315     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 22316     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22317     MOVE X'2020233030303230363737' TO DFHEIV0(25:11)
 22318     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 412
* EL050.cbl
 22319           DFHEIV1,
 22320           WS-ERROR-LINE,
 22321           DFHEIV11,
 22322           DFHEIV99,
 22323           DFHEIV99,
 22324           DFHEIV99,
 22325           DFHEIV99
 22326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22327
 22328
 22329     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 22330
 22331
 22332* EXEC CICS ABEND
 22333*        ABCODE ('EL50')
 22334*    END-EXEC.
 22335     MOVE 'EL50' TO DFHEIV5
 22336*    MOVE '.,A                   "   #00020685' TO DFHEIV0
 22337     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 22338     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 22339     MOVE X'2020233030303230363835' TO DFHEIV0(25:11)
 22340     CALL 'kxdfhei1' USING DFHEIV0,
 22341           DFHEIV5
 22342     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22343
 22344
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 413
* EL050.cbl
 22346
 22347******************************************************************
 22348*                                                                *
 22349*            E R R O R   F O R M A T   R O U T I N E             *
 22350*                                                                *
 22351******************************************************************
 22352
 22353 9900-ERROR-FORMAT.
 22354
 22355     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 22356                    PB-COMMON-ERROR (2) OR
 22357                    PB-COMMON-ERROR (3) OR
 22358                    PB-COMMON-ERROR (4) OR
 22359                    PB-COMMON-ERROR (5) OR
 22360                    PB-COMMON-ERROR (6) OR
 22361                    PB-COMMON-ERROR (7) OR
 22362                    PB-COMMON-ERROR (8) OR
 22363                    PB-COMMON-ERROR (9) OR
 22364                    PB-COMMON-ERROR (10)
 22365        GO TO 9900-EXIT.
 22366
 22367     IF PB-NO-OF-ERRORS = +10
 22368        GO TO 9900-EXIT.
 22369
 22370     ADD +1  TO PB-NO-OF-ERRORS.
 22371     MOVE WS-ERROR               TO PB-COMMON-ERROR
 22372                                       (PB-NO-OF-ERRORS).
 22373 9900-EXIT.
 22374     EXIT.
 22375
 22376 9990-RETURN.
 22377     IF BROWSE-STARTED
 22378
 22379* EXEC CICS ENDBR
 22380*            DATASET  (ACCT-ID)
 22381*       END-EXEC.
 22382     MOVE 0
 22383       TO DFHEIV11
 22384*    MOVE '&2                    $   #00020722' TO DFHEIV0
 22385     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22386     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22387     MOVE X'2020233030303230373232' TO DFHEIV0(25:11)
 22388     CALL 'kxdfhei1' USING DFHEIV0,
 22389           ACCT-ID,
 22390           DFHEIV11,
 22391           DFHEIV99
 22392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22393
 22394
 22395 9990-EXIT.
 22396     EXIT.
 22397
 22398
 22399****Check for CRTO record, add one if not found.
 22400 9991-CHECK-FOR-ELCRTO.
 22401
 22402* EXEC CICS HANDLE CONDITION
 22403*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 414
* EL050.cbl
 22404*         ENDFILE (9991-CRTO-NOT-FOUND)
 22405*     END-EXEC.
 22406*    MOVE '"$I''                  ! A #00020732' TO DFHEIV0
 22407     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22408     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22409     MOVE X'4120233030303230373332' TO DFHEIV0(25:11)
 22410     CALL 'kxdfhei1' USING DFHEIV0
 22411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22412
 22413     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 22414     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 22415     MOVE +0                     TO ELCRTO-SEQ-NO
 22416
 22417
 22418* EXEC CICS READ
 22419*       DATASET   ('ELCRTO')
 22420*       INTO      (ORIGINAL-CERTIFICATE)
 22421*       RIDFLD    (ELCRTO-KEY)
 22422*       GTEQ
 22423*       RESP      (WS-RESPONSE)
 22424*    END-EXEC
 22425     MOVE LENGTH OF
 22426      ORIGINAL-CERTIFICATE
 22427       TO DFHEIV11
 22428     MOVE 'ELCRTO' TO DFHEIV1
 22429*    MOVE '&"IL       G          (  N#00020740' TO DFHEIV0
 22430     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22431     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22432     MOVE X'204E233030303230373430' TO DFHEIV0(25:11)
 22433     CALL 'kxdfhei1' USING DFHEIV0,
 22434           DFHEIV1,
 22435           ORIGINAL-CERTIFICATE,
 22436           DFHEIV11,
 22437           ELCRTO-KEY,
 22438           DFHEIV99,
 22439           DFHEIV99,
 22440           DFHEIV99
 22441     MOVE EIBRESP  TO WS-RESPONSE
 22442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22443
 22444     IF WS-RESP-NORMAL
 22445        AND (OC-CONTROL-PRIMARY (1:33) =
 22446                 PB-CONTROL-BY-ACCOUNT (1:33))
 22447        AND (OC-RECORD-TYPE =  'I')
 22448           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 22449               GO TO 9991-CHECK-INDICATORS
 22450           ELSE
 22451               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 22452               GO TO 9991-CRTO-ADD-REC
 22453           END-IF
 22454     END-IF.
 22455
 22456 9991-CRTO-NOT-FOUND.
 22457
 22458     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 22459     MOVE 'OC'                TO OC-RECORD-ID
 22460     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 22461                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 415
* EL050.cbl
 22462     MOVE +4096               TO OC-KEY-SEQ-NO.
 22463
 22464 9991-CRTO-ADD-REC.
 22465
 22466     MOVE 'E050'              TO OC-LAST-MAINT-BY
 22467     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 22468     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 22469     MOVE 'I'                 TO OC-RECORD-TYPE
 22470     IF PB-ISSUE
 22471         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 22472         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 22473         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 22474         MOVE PB-I-AGE               TO OC-INS-AGE
 22475         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 22476         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 22477         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 22478         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 22479         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 22480         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 22481         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 22482         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 22483         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22484         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22485         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22486         IF PB-I-JOINT-COMMISSION > +0
 22487             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22488         ELSE
 22489             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22490         END-IF
 22491         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 22492         MOVE +0                     TO OC-LF-CANCEL-AMT
 22493                                        OC-LF-ITD-CANCEL-AMT
 22494         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22495         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22496         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22497         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22498         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22499         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22500         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22501         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 22502         MOVE +0                     TO OC-AH-CANCEL-AMT
 22503                                        OC-AH-ITD-CANCEL-AMT
 22504         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22505         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22506         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 22507     ELSE
 22508         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 22509         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 22510         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 22511         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 22512         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 22513         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 22514         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 22515         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 22516         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 22517          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 22518             MOVE SPACES             TO OC-LF-BENCD
 22519             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 416
* EL050.cbl
 22520                                        OC-LF-BEN-AMT
 22521                                        OC-LF-PRM-AMT
 22522                                        OC-LF-ALT-BEN-AMT
 22523                                        OC-LF-ALT-PRM-AMT
 22524                                        OC-LF-COMM-PCT
 22525                                        OC-LF-CANCEL-AMT
 22526             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 22527             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 22528         ELSE
 22529             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 22530             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 22531             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 22532             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 22533             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22534             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22535             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 22536             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 22537             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 22538             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 22539         END-IF
 22540         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 22541         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 22542          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 22543             MOVE SPACES             TO OC-AH-BENCD
 22544             MOVE ZEROS              TO OC-AH-TERM
 22545                                        OC-AH-BEN-AMT
 22546                                        OC-AH-PRM-AMT
 22547                                        OC-AH-COMM-PCT
 22548                                        OC-AH-CANCEL-AMT
 22549                                        OC-AH-CP
 22550             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 22551             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 22552         ELSE
 22553             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 22554             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 22555             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 22556             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 22557             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 22558             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 22559             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 22560             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 22561             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 22562         END-IF
 22563         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 22564         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 22565         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 22566         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 22567     END-IF
 22568     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 22569
 22570     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22571
 22572
 22573* EXEC CICS READ
 22574*         DATASET   (FILE-ERMAIL)
 22575*         RIDFLD    (MA-CONTROL-PRIMARY)
 22576*         INTO      (MAILING-DATA)
 22577*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 417
* EL050.cbl
 22578*    END-EXEC
 22579     MOVE LENGTH OF
 22580      MAILING-DATA
 22581       TO DFHEIV11
 22582*    MOVE '&"IL       E          (  N#00020876' TO DFHEIV0
 22583     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22584     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22585     MOVE X'204E233030303230383736' TO DFHEIV0(25:11)
 22586     CALL 'kxdfhei1' USING DFHEIV0,
 22587           FILE-ERMAIL,
 22588           MAILING-DATA,
 22589           DFHEIV11,
 22590           MA-CONTROL-PRIMARY,
 22591           DFHEIV99,
 22592           DFHEIV99,
 22593           DFHEIV99
 22594     MOVE EIBRESP  TO WS-RESPONSE
 22595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22596
 22597     IF WS-RESP-NORMAL
 22598         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22599     END-IF.
 22600
 22601     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22602     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22603
 22604
 22605* EXEC CICS READ
 22606*         DATASET  (CRTT-ID)
 22607*         RIDFLD   (WS-ELCRTT-KEY)
 22608*         INTO     (CERTIFICATE-TRAILERS)
 22609*         RESP     (WS-RESPONSE)
 22610*    END-EXEC
 22611     MOVE LENGTH OF
 22612      CERTIFICATE-TRAILERS
 22613       TO DFHEIV11
 22614*    MOVE '&"IL       E          (  N#00020890' TO DFHEIV0
 22615     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22616     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22617     MOVE X'204E233030303230383930' TO DFHEIV0(25:11)
 22618     CALL 'kxdfhei1' USING DFHEIV0,
 22619           CRTT-ID,
 22620           CERTIFICATE-TRAILERS,
 22621           DFHEIV11,
 22622           WS-ELCRTT-KEY,
 22623           DFHEIV99,
 22624           DFHEIV99,
 22625           DFHEIV99
 22626     MOVE EIBRESP  TO WS-RESPONSE
 22627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22628
 22629     IF WS-RESP-NORMAL
 22630         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 22631         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 22632     END-IF.
 22633
 22634
 22635* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 418
* EL050.cbl
 22636*       DATASET   ('ELCRTO')
 22637*       FROM      (ORIGINAL-CERTIFICATE)
 22638*       RIDFLD    (OC-CONTROL-PRIMARY)
 22639*       RESP      (WS-RESPONSE)
 22640*    END-EXEC.
 22641     MOVE LENGTH OF
 22642      ORIGINAL-CERTIFICATE
 22643       TO DFHEIV11
 22644     MOVE 'ELCRTO' TO DFHEIV1
 22645*    MOVE '&$ L                  ''  N#00020902' TO DFHEIV0
 22646     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 22647     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22648     MOVE X'204E233030303230393032' TO DFHEIV0(25:11)
 22649     CALL 'kxdfhei1' USING DFHEIV0,
 22650           DFHEIV1,
 22651           ORIGINAL-CERTIFICATE,
 22652           DFHEIV11,
 22653           OC-CONTROL-PRIMARY,
 22654           DFHEIV99,
 22655           DFHEIV99
 22656     MOVE EIBRESP  TO WS-RESPONSE
 22657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22658
 22659
 22660     GO TO 9991-EXIT.
 22661
 22662 9991-CHECK-INDICATORS.
 22663
 22664     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 22665         GO TO 9991-EXIT
 22666     END-IF.
 22667
 22668     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 22669         GO TO 9991-EXIT
 22670     END-IF.
 22671
 22672
 22673* EXEC CICS READ
 22674*       DATASET   ('ELCRTO')
 22675*       INTO      (ORIGINAL-CERTIFICATE)
 22676*       RIDFLD    (OC-CONTROL-PRIMARY)
 22677*       UPDATE
 22678*       RESP      (WS-RESPONSE)
 22679*    END-EXEC
 22680     MOVE LENGTH OF
 22681      ORIGINAL-CERTIFICATE
 22682       TO DFHEIV11
 22683     MOVE 'ELCRTO' TO DFHEIV1
 22684*    MOVE '&"IL       EU         (  N#00020921' TO DFHEIV0
 22685     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22686     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22687     MOVE X'204E233030303230393231' TO DFHEIV0(25:11)
 22688     CALL 'kxdfhei1' USING DFHEIV0,
 22689           DFHEIV1,
 22690           ORIGINAL-CERTIFICATE,
 22691           DFHEIV11,
 22692           OC-CONTROL-PRIMARY,
 22693           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 419
* EL050.cbl
 22694           DFHEIV99,
 22695           DFHEIV99
 22696     MOVE EIBRESP  TO WS-RESPONSE
 22697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22698     IF WS-RESP-NORMAL
 22699        IF PB-ISSUE
 22700          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 22701          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 22702          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 22703          MOVE PB-I-AGE               TO OC-INS-AGE
 22704          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 22705          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 22706          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 22707          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 22708          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 22709          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 22710          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 22711          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 22712          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22713          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22714          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22715          IF PB-I-JOINT-COMMISSION > +0
 22716              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22717          ELSE
 22718              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22719          END-IF
 22720          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22721          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22722          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22723          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22724          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22725          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22726          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22727          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22728          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22729
 22730          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22731
 22732* EXEC CICS READ
 22733*             DATASET   (FILE-ERMAIL)
 22734*             RIDFLD    (MA-CONTROL-PRIMARY)
 22735*             INTO      (MAILING-DATA)
 22736*             RESP      (WS-RESPONSE)
 22737*         END-EXEC
 22738     MOVE LENGTH OF
 22739      MAILING-DATA
 22740       TO DFHEIV11
 22741*    MOVE '&"IL       E          (  N#00020961' TO DFHEIV0
 22742     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22743     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22744     MOVE X'204E233030303230393631' TO DFHEIV0(25:11)
 22745     CALL 'kxdfhei1' USING DFHEIV0,
 22746           FILE-ERMAIL,
 22747           MAILING-DATA,
 22748           DFHEIV11,
 22749           MA-CONTROL-PRIMARY,
 22750           DFHEIV99,
 22751           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 420
* EL050.cbl
 22752           DFHEIV99
 22753     MOVE EIBRESP  TO WS-RESPONSE
 22754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22755          IF WS-RESP-NORMAL
 22756             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22757          END-IF
 22758
 22759          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22760          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22761
 22762* EXEC CICS READ
 22763*             DATASET  (CRTT-ID)
 22764*             RIDFLD   (WS-ELCRTT-KEY)
 22765*             INTO     (CERTIFICATE-TRAILERS)
 22766*             RESP     (WS-RESPONSE)
 22767*         END-EXEC
 22768     MOVE LENGTH OF
 22769      CERTIFICATE-TRAILERS
 22770       TO DFHEIV11
 22771*    MOVE '&"IL       E          (  N#00020973' TO DFHEIV0
 22772     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22773     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22774     MOVE X'204E233030303230393733' TO DFHEIV0(25:11)
 22775     CALL 'kxdfhei1' USING DFHEIV0,
 22776           CRTT-ID,
 22777           CERTIFICATE-TRAILERS,
 22778           DFHEIV11,
 22779           WS-ELCRTT-KEY,
 22780           DFHEIV99,
 22781           DFHEIV99,
 22782           DFHEIV99
 22783     MOVE EIBRESP  TO WS-RESPONSE
 22784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22785          IF WS-RESP-NORMAL
 22786             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 22787                               OC-INS-AGE-DEFAULT-FLAG
 22788             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 22789                               OC-JNT-AGE-DEFAULT-FLAG
 22790          END-IF
 22791
 22792        ELSE
 22793          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22794             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 22795             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 22796             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 22797          END-IF
 22798          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22799             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 22800             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 22801             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 22802          END-IF
 22803          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 22804        END-IF
 22805
 22806* EXEC CICS REWRITE
 22807*          DATASET   ('ELCRTO')
 22808*          FROM      (ORIGINAL-CERTIFICATE)
 22809*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 421
* EL050.cbl
 22810*       END-EXEC
 22811     MOVE LENGTH OF
 22812      ORIGINAL-CERTIFICATE
 22813       TO DFHEIV11
 22814     MOVE 'ELCRTO' TO DFHEIV1
 22815*    MOVE '&& L                  %  N#00020999' TO DFHEIV0
 22816     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 22817     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22818     MOVE X'204E233030303230393939' TO DFHEIV0(25:11)
 22819     CALL 'kxdfhei1' USING DFHEIV0,
 22820           DFHEIV1,
 22821           ORIGINAL-CERTIFICATE,
 22822           DFHEIV11,
 22823           DFHEIV99
 22824     MOVE EIBRESP  TO WS-RESPONSE
 22825     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22826     END-IF.
 22827
 22828 9991-EXIT.
 22829     EXIT.
 22830
 22831
 22832 9999-RETURN.
 22833     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 22834
 22835
 22836* EXEC CICS RETURN
 22837*    END-EXEC.
 22838*    MOVE '.(                    ''   #00021013' TO DFHEIV0
 22839     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 22840     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22841     MOVE X'2020233030303231303133' TO DFHEIV0(25:11)
 22842     CALL 'kxdfhei1' USING DFHEIV0,
 22843           DFHEIV99,
 22844           DFHEIV99,
 22845           DFHEIV99,
 22846           DFHEIV99,
 22847           DFHEIV99,
 22848           DFHEIV99
 22849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22850
 22851
 22852
 22853* GOBACK.
 22854     MOVE '9%                    "   ' TO DFHEIV0
 22855     MOVE 'EL050' TO DFHEIV1
 22856     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22857     GOBACK.
 22858
 22859 9999-DFHBACK SECTION.
 22860     MOVE '9%                    "   ' TO DFHEIV0
 22861     MOVE 'EL050' TO DFHEIV1
 22862     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22863     GOBACK.
 22864 9999-DFHEXIT.
 22865     IF DFHEIGDJ EQUAL 0001
 22866         NEXT SENTENCE
 22867     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 422
* EL050.cbl
 22868         GO TO 9300-ABEND,
 22869               3990-FILES-NOT-OPEN
 22870         DEPENDING ON DFHEIGDI
 22871     ELSE IF DFHEIGDJ EQUAL 3
 22872         GO TO 6610-START-BROWSE,
 22873               6630-ERRESS-PROBLEM,
 22874               6630-END-OF-FILE
 22875         DEPENDING ON DFHEIGDI
 22876     ELSE IF DFHEIGDJ EQUAL 4
 22877         GO TO 6630-END-OF-FILE,
 22878               6630-ERRESS-PROBLEM,
 22879               6630-ERRESS-PROBLEM,
 22880               6630-END-OF-FILE
 22881         DEPENDING ON DFHEIGDI
 22882     ELSE IF DFHEIGDJ EQUAL 5
 22883         GO TO 6630-END-OF-FILE,
 22884               6630-END-OF-FILE,
 22885               6630-ERRESS-PROBLEM,
 22886               6630-ERRESS-PROBLEM
 22887         DEPENDING ON DFHEIGDI
 22888     ELSE IF DFHEIGDJ EQUAL 6
 22889         GO TO 6660-START-BROWSE,
 22890               6690-ERRESC-PROBLEM,
 22891               6690-ERRESC-PROBLEM,
 22892               6690-END-OF-FILE
 22893         DEPENDING ON DFHEIGDI
 22894     ELSE IF DFHEIGDJ EQUAL 7
 22895         GO TO 6690-END-OF-FILE,
 22896               6690-ERRESC-PROBLEM,
 22897               6690-ERRESC-PROBLEM,
 22898               6690-END-OF-FILE
 22899         DEPENDING ON DFHEIGDI
 22900     ELSE IF DFHEIGDJ EQUAL 8
 22901         GO TO 6690-END-OF-FILE,
 22902               6690-ERRESC-PROBLEM,
 22903               6690-ERRESC-PROBLEM,
 22904               6690-END-OF-FILE
 22905         DEPENDING ON DFHEIGDI
 22906     ELSE IF DFHEIGDJ EQUAL 9
 22907         GO TO 7250-CONTINUE,
 22908               7250-CONTINUE
 22909         DEPENDING ON DFHEIGDI
 22910     ELSE IF DFHEIGDJ EQUAL 10
 22911         GO TO 7300-CONTINUE,
 22912               7300-CONTINUE
 22913         DEPENDING ON DFHEIGDI
 22914     ELSE IF DFHEIGDJ EQUAL 11
 22915         GO TO 8000-FREE-MAIN
 22916         DEPENDING ON DFHEIGDI
 22917     ELSE IF DFHEIGDJ EQUAL 12
 22918         GO TO 8100-NOTFND,
 22919               8100-NOTFND
 22920         DEPENDING ON DFHEIGDI
 22921     ELSE IF DFHEIGDJ EQUAL 13
 22922         GO TO 8110-NOTFND,
 22923               8110-NOTFND
 22924         DEPENDING ON DFHEIGDI
 22925     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 423
* EL050.cbl
 22926         GO TO 8130-EXIT
 22927         DEPENDING ON DFHEIGDI
 22928     ELSE IF DFHEIGDJ EQUAL 15
 22929         GO TO 8150-exit
 22930         DEPENDING ON DFHEIGDI
 22931     ELSE IF DFHEIGDJ EQUAL 16
 22932         GO TO 8180-NOTFND
 22933         DEPENDING ON DFHEIGDI
 22934     ELSE IF DFHEIGDJ EQUAL 17
 22935         GO TO 8190-NOTFND
 22936         DEPENDING ON DFHEIGDI
 22937     ELSE IF DFHEIGDJ EQUAL 18
 22938         GO TO 8195-NOTFND
 22939         DEPENDING ON DFHEIGDI
 22940     ELSE IF DFHEIGDJ EQUAL 19
 22941         GO TO 8200-NOTFND
 22942         DEPENDING ON DFHEIGDI
 22943     ELSE IF DFHEIGDJ EQUAL 20
 22944         GO TO 8300-NOTFND,
 22945               8300-ERRESS-PROBLEM,
 22946               8300-ERRESS-PROBLEM,
 22947               8300-NOTFND
 22948         DEPENDING ON DFHEIGDI
 22949     ELSE IF DFHEIGDJ EQUAL 21
 22950         GO TO 8450-FORM-NOT-FOUND,
 22951               8450-FORM-NOT-FOUND
 22952         DEPENDING ON DFHEIGDI
 22953     ELSE IF DFHEIGDJ EQUAL 22
 22954         GO TO 0199-ACCT-NOT-FOUND,
 22955               0199-ACCT-NOT-FOUND
 22956         DEPENDING ON DFHEIGDI
 22957     ELSE IF DFHEIGDJ EQUAL 23
 22958         GO TO 0199-ACCT-NOT-FOUND,
 22959               0199-ACCT-NOT-FOUND
 22960         DEPENDING ON DFHEIGDI
 22961     ELSE IF DFHEIGDJ EQUAL 24
 22962         GO TO 8582-COMP-NOT-FOUND,
 22963               8582-COMP-NOT-FOUND
 22964         DEPENDING ON DFHEIGDI
 22965     ELSE IF DFHEIGDJ EQUAL 25
 22966         GO TO 8583-AGTC-NOT-FOUND,
 22967               8583-AGTC-NOT-FOUND
 22968         DEPENDING ON DFHEIGDI
 22969     ELSE IF DFHEIGDJ EQUAL 26
 22970         GO TO 8584-BXRF-NOT-FOUND,
 22971               8584-BXRF-NOT-FOUND
 22972         DEPENDING ON DFHEIGDI
 22973     ELSE IF DFHEIGDJ EQUAL 27
 22974         GO TO 8585-PLAN-NOT-FOUND,
 22975               8585-PLAN-NOT-FOUND
 22976         DEPENDING ON DFHEIGDI
 22977     ELSE IF DFHEIGDJ EQUAL 28
 22978         GO TO 0299-CERT-NOT-FOUND
 22979         DEPENDING ON DFHEIGDI
 22980     ELSE IF DFHEIGDJ EQUAL 29
 22981         GO TO 8700-READ-CERT-MASTER
 22982         DEPENDING ON DFHEIGDI
 22983     ELSE IF DFHEIGDJ EQUAL 30
* Micro Focus Server Express         V5.1 revision 000 08-Dec-17 07:57 Page 424
* EL050.cbl
 22984         GO TO 8720-COMP-ACCOUNTS,
 22985               8730-END-BROWSE,
 22986               8740-NOT-FOUND
 22987         DEPENDING ON DFHEIGDI
 22988     ELSE IF DFHEIGDJ EQUAL 31
 22989         GO TO 9000-NOTFND
 22990         DEPENDING ON DFHEIGDI
 22991     ELSE IF DFHEIGDJ EQUAL 32
 22992         GO TO 9100-NOTFND,
 22993               9100-NOTFND
 22994         DEPENDING ON DFHEIGDI
 22995     ELSE IF DFHEIGDJ EQUAL 33
 22996         GO TO 9991-CRTO-NOT-FOUND,
 22997               9991-CRTO-NOT-FOUND
 22998         DEPENDING ON DFHEIGDI.
 22999     MOVE '9%                    "   ' TO DFHEIV0
 23000     MOVE 'EL050' TO DFHEIV1
 23001     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 23002     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       41680     Code:       94362
