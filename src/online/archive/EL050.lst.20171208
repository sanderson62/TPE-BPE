* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    48* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    49* 051914  CR2014043000002  TANA  CHANGE EDIT FOR CANCEL DATE
    50* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    51* 091114  IR2014091000001  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
    52*                                CERT #, ADD 2898 FORCIBLE ERROR
    53* 072215  IR2015031000002  PEMA  CHG EDIT FOR ERROR 2889
    54* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    55* 013017  CR2016053100001  PEMA  ACH PROCESSING
    56******************************************************************
    57 ENVIRONMENT DIVISION.
    58
    59 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page   3
* EL050.cbl
    61 WORKING-STORAGE SECTION.
    62 01  DFH-START PIC X(04).
    63
    64 77  FILLER   PIC X(32) VALUE '********************************'.
    65 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    66 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    67
    68 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    69 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    70                                   USAGE POINTER.
    71 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    72 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    73 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    74                                   USAGE IS POINTER.
    75 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    76 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    77                                   USAGE IS POINTER.
    78 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    79 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    80                                   USAGE IS POINTER.
    81
    82 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    83 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    84                                   USAGE IS POINTER.
    85
    86*    COPY ELC50WS.
    87*****************************************************************
    88*                                                               *
    89*                            ELC50WS.                           *
    90*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    91*                            VMOD=2.061.                        *
    92*                                                               *
    93*   THIS IS THE WORKING STORAGE FOR EL050                       *
    94*                                   EL517                       *
    95*****************************************************************
    96******************************************************************
    97*                   C H A N G E   L O G
    98*
    99* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   100*-----------------------------------------------------------------
   101*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   102* EFFECTIVE    NUMBER
   103*-----------------------------------------------------------------
   104* 123102                   PEMA  ADD DCC PROCESSING
   105* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
   106* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
   107* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
   108* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   109* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   110* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   111* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   112* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   113* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   114* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   115* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   116* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   117* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   118* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page   4
* EL050.cbl
   119* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   120* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   121* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   122* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   123* 030309  CR2009021700001  PEMA  ADD ER-2883
   124* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   125* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   126* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   127* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   128* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   129* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   130* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   131* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   132* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   133* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   134* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   135* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   136* 061412  CR2011022800001  AJRA  NAPERSOFT
   137* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   138* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   139* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   140* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   141* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   142* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   143* 040914  IR2014040900001  AJRA  ADD ERROR 2896
   144* 051914  CR2014043000002  TANA  ADD CAUSAL STATE AND ERROR 2897
   145* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   146* 091114  IR2014091000001  TANA  ADD ERROR 2898
   147* 121815  CR2015121700006  PEMA  ADD ERROR 3827
   148* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
   149* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
   150* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
   151* 100617  CR2017062000003  PEMA  Inforce state comm cap
   152*-----------------------------------------------------------------
   153
   154 01  WORK-AREAS.
   155
   156*****************************************************************
   157*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   158*****************************************************************
   159
   160     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   161     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   162     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   163     12  WS-NAME-EDIT-WORK-AREA.
   164         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   165         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   166             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   167         16  WS-WORK-NAME.
   168             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   169             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   170             20  FILLER           PIC X(10)     VALUE SPACES.
   171         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   172             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   173
   174*****************************************************************
   175*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   176*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page   5
* EL050.cbl
   177
   178     12  WS-ERRESC-KEY.
   179         16 WS-ERRESC-SEARCH-KEY.
   180             20  WS-ERRESC-COMPANY-CD PIC  X.
   181             20  WS-ERRESC-CARRIER    PIC  X.
   182             20  WS-ERRESC-GROUP      PIC X(6).
   183             20  WS-ERRESC-STATE      PIC XX.
   184             20  WS-ERRESC-ACCOUNT    PIC X(10).
   185         16 WS-ERRESC-RESIDUAL-KEY.
   186             20  WS-ERRESC-AGENT      PIC X(10).
   187             20  WS-ERRESC-RES-STATE  PIC XX.
   188             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   189*                                          YYYYMMDD
   190     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   191     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   192
   193*RESIDENT STATE TAX MASTER(ERRESS)
   194*
   195     12  WS-ERRESS-KEY.
   196         16  WS-ERRESS-COMPANY-CD      PIC  X.
   197         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   198         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   199         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   200*                                          YYYYMMDD
   201
   202     12  WS-CONTRACT-DATE              PIC 9(8).
   203*                                          YYYYMMDD
   204     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   205     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   206         16 WS-YEAR-YY                 PIC   9999.
   207         16 FILLER                     PIC 9(4).
   208*                                          YYYYMMDD
   209     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   210     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   211     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   212     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   213
   214     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   215         88  DPRB-1ST-TIME                      VALUE ' '.
   216
   217*****************************************************************
   218*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   219*****************************************************************
   220
   221     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   222     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   223     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   224     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   225     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   226     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   227     12  WS-ST-CAUSAL-STATE      PIC X          VALUE SPACES.
   228     12  ws-st-agent-sig-edit    pic x          value spaces.
   229     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   230     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   231     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   232     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   233         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   234         88 NO-AH-COVERAGE           VALUE '  ' '00'.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page   6
* EL050.cbl
   235     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   236         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   237         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   238     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   239
   240     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   241     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   242
   243     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   244     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   245     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   246     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   247     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   248     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   249     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   250     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   251     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   252     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   253     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   254     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   255     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   256     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   257     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   258     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   259     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   260     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   261     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   262     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   263     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   264     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   265     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   266     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   267     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   268     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   269     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   270     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   271     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   272     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   273     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   274     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   275     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   276     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   277     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   278     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   279     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   280     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   281     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   282     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   283     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   284     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   285     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   286     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   287     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   288     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   289     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   290     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   291     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   292     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page   7
* EL050.cbl
   293     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   294     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   295     12  WS-2671-SW               PIC X         VALUE SPACE.
   296     12  WS-2672-SW               PIC X         VALUE SPACE.
   297     12  ws-9813-sw               pic x         value spaces.
   298     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   299         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   300     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   301         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   302     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   303
   304     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   305         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   306         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   307         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   308         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   309
   310     12  WS-CREDIT-EDIT-CONTROLS.
   311         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   312         16  WS-MIN-AGE           PIC 99                VALUE  0.
   313         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   314         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   315         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   316         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   317
   318     12  ws-vehicle-odometer     pic s9(7) comp-3 value +0.
   319     12  WS-AGE-FIELDS.
   320         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   321         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   322         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   323         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   324
   325     12  WS-SAVE-ALLOWABLE-BENEFIT.
   326         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   327         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   328         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   329         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   330         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   331         16  FILLER                      PIC XX.
   332
   333     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   334     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   335     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   336     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   337     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   338     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   339     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   340     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   341     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   342     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   343
   344     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   345     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   346     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   347     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   348     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   349     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   350     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page   8
* EL050.cbl
   351     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   352         88  WS-REDUCING              VALUE 'R'.
   353         88  WS-LEVEL                 VALUE 'L' 'P'.
   354     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   355
   356     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   357     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   358     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   359     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   360     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   361     12  ws-ah-max-bens           pic 99        value zeros.
   362     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   363     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   364     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   365     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   366
   367     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   368     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   369     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   370     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   371     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   372     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   373     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   374     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   375     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   376     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   377     12  WS-ACCT-SIG-SW.
   378         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   379         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   380     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   381     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   382     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   383     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   384     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   385     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   386     12  ws-cred-union-fees       pic s9(5)v99  comp-3 value +0.
   387     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   388     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   389     12  WS-INITIALS.
   390         16  WS-INIT-1            PIC X         VALUE SPACES.
   391         16  WS-INIT-2            PIC X         VALUE SPACES.
   392
   393     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   394     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   395     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   396     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   397     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   398*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   399     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   400     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   401     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   402     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   403     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   404     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   405     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   406     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   407     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   408     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page   9
* EL050.cbl
   409     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   410     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   411     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   412     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   413     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   414     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   415     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   416     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   417     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   418     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   419     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   420     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   421******** FLA
   422     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   423     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   424     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   425     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   426     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   427********
   428     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   429     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   430     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   431     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   432     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   433     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   434     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   435     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   436     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   437     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   438
   439     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   440         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   441                                         '0' THRU '9'.
   442
   443     12  NUMBER-OF-MONTHS.
   444         16  SK-MO OCCURS 12 TIMES PIC X.
   445
   446     12  WS-WORK-DATE.
   447         16  WS-YEAR            PIC 99    VALUE 00.
   448         16  WS-MONTH           PIC 99    VALUE 00.
   449         16  WS-DAY             PIC 99    VALUE 00.
   450
   451     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   452     12  WS-WORK-CRIT-DEV       REDEFINES
   453         WS-WORK-LF-CRIT-PER    PIC X(03).
   454
   455     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   456     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   457
   458     12  WS-WORK-DATE-FROM.
   459         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   460         16  FILLER             PIC X  VALUE SPACE.
   461         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   462         16  FILLER             PIC X         VALUE SPACE.
   463         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   464
   465     12  WS-WORK-DATE-THRU.
   466         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  10
* EL050.cbl
   467         16  FILLER             PIC X         VALUE SPACE.
   468         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   469         16  FILLER             PIC X         VALUE SPACE.
   470         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   471
   472     12  WS-LF-INPUT-CD.
   473         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   474         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   475
   476     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   477     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   478         16  WS-AH-INPUT-CD-1   PIC X.
   479         16  WS-AH-INPUT-CD-2-3 PIC XX.
   480
   481     12  WS-SWITCHES.
   482         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   483         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   484             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   485         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   486             88  BANK-ACCT-FOUND          VALUE 'Y'.
   487         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   488             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   489         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   490             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   491         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   492             88  COMP-MASTER-FOUND        VALUE 'Y'.
   493         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   494             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   495         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   496             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   497         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   498             88  STAT-MASTER-FOUND        VALUE 'Y'.
   499         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   500             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   501         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   502             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   503         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   504             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   505         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   506             88  FORM-MASTER-FOUND        VALUE 'Y'.
   507         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   508             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   509         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   510             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   511         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   512             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   513         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   514             88  NO-BENEFIT-FOUND         VALUE 'N'.
   515         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   516             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   517         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   518             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   519         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   520             88  AH-BENEFIT-FOUND         VALUE ' '.
   521             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   522         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   523             88  LF-BENEFIT-FOUND         VALUE ' '.
   524             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  11
* EL050.cbl
   525         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   526             88  NO-STATE-RECORD          VALUE '1'.
   527         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   528             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   529         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   530             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   531         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   532             88  CERT-WAS-FOUND           VALUE ' '.
   533             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   534         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   535             88  BROWSE-STARTED           VALUE 'Y'.
   536         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   537             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   538         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   539             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   540         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   541             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   542         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   543             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   544         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   545             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   546         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   547             88  APP-CERT-USED            VALUE 'Y' 'A'.
   548         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   549             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   550             88  FIRST-TIME-THROUGH       VALUE '1'.
   551             88  CTBL-NOT-FOUND           VALUE '2'.
   552
   553         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   554             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   555
   556         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   557             88  DLO-ERROR-FOUND          VALUE 'Y'.
   558
   559********FLA
   560     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   561     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   562********
   563     12  RC-SW-1                  PIC X           VALUE '0'.
   564     12  RC-SW-2                  PIC X           VALUE '0'.
   565     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   566     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   567     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   568     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   569     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   570     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   571     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   572     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   573     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   574     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   575     12  LIT-SPACES               PIC X           VALUE SPACES.
   576     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   577     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   578     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   579     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   580     12  erpndm-unlock-sw         pic x           value spaces.
   581         88  need-to-unlock-erpndm  value 'Y'.
   582     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  12
* EL050.cbl
   583     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   584     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   585         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   586         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   587     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   588         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   589
   590 01  WS-EXTRA-PERIODS-BY-STATE.
   591     12  WS-INT-PERIODS          PIC 9.
   592     12  WS-EXTRA-PMTS           PIC 9.
   593 01  ws-net-only-state           pic x value 'N'.
   594 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   595     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   596     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   597 01  WS-CRI-SSN-WORK-AREA.
   598     05  WS-CRI-SOC-SEC-NO.
   599         10  WS-SS-REPT-CD       PIC X(5).
   600         10  WS-SS-LAST-NAME     PIC X(5).
   601         10  WS-SS-INITIAL       PIC X.
   602
   603     05  WS-CRI-REPORT-CODE.
   604         10  FILLER              PIC X(5).
   605         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   606
   607     05  WS-CRI-LAST-NAME.
   608         10  WS-CRI-NAME-MOVE    PIC X(5).
   609         10  FILLER              PIC X(10).
   610
   611 01  ws-state-commission-caps.
   612     05  ws-sl-wk-rate           pic sv9(5) comp-3 value zeros.
   613     05  ws-jl-wk-rate           pic sv9(5) comp-3 value zeros.
   614     05  ws-sa-wk-rate           pic sv9(5) comp-3 value zeros.
   615     05  ws-ja-wk-rate           pic sv9(5) comp-3 value zeros.
   616     05  ws-ga-sl-wk-rate        pic sv9(5) comp-3 value zeros.
   617     05  ws-ga-jl-wk-rate        pic sv9(5) comp-3 value zeros.
   618     05  ws-ga-sa-wk-rate        pic sv9(5) comp-3 value zeros.
   619     05  ws-ga-ja-wk-rate        pic sv9(5) comp-3 value zeros.
   620     05  ws-tot-sl-wk-rate       pic sv9(5) comp-3 value zeros.
   621     05  ws-tot-jl-wk-rate       pic sv9(5) comp-3 value zeros.
   622     05  ws-tot-sa-wk-rate       pic sv9(5) comp-3 value zeros.
   623     05  ws-tot-ja-wk-rate       pic sv9(5) comp-3 value zeros.
   624     05  ws-st-cap-limit-to      pic x.
   625     05  ws-st-comm-cap-sl       pic s9v9(4) comp-3.
   626     05  ws-st-comm-cap-jl       pic s9v9(4) comp-3.
   627     05  ws-st-comm-cap-sa       pic s9v9(4) comp-3.
   628     05  ws-st-comm-cap-ja       pic s9v9(4) comp-3.
   629     05  ws-st-ga-comm-cap-sl    pic s9v9(4) comp-3.
   630     05  ws-st-ga-comm-cap-jl    pic s9v9(4) comp-3.
   631     05  ws-st-ga-comm-cap-sa    pic s9v9(4) comp-3.
   632     05  ws-st-ga-comm-cap-ja    pic s9v9(4) comp-3.
   633     05  ws-st-tot-comm-cap-sl   pic s9v9(4) comp-3.
   634     05  ws-st-tot-comm-cap-jl   pic s9v9(4) comp-3.
   635     05  ws-st-tot-comm-cap-sa   pic s9v9(4) comp-3.
   636     05  ws-st-tot-comm-cap-ja   pic s9v9(4) comp-3.
   637 01  WS-NUM-TABLE                PIC X(26)  VALUE
   638     '12345678012345070923456789'.
   639 01  FILLER REDEFINES WS-NUM-TABLE.
   640     05  WS-NUM OCCURS 26        PIC 9.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  13
* EL050.cbl
   641 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   642 01  V1                          PIC S999 COMP-3.
   643 01  V2                          PIC S999 COMP-3.
   644 01  V3                          PIC S999 COMP-3.
   645 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   646 01  FILLER REDEFINES WS-WORK-VIN.
   647     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   648 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   649 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   650 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   651 01  WS-HEX-WORK.
   652     05  FILLER                  PIC X  VALUE LOW-VALUES.
   653     05  WS-HEX-BYTE             PIC X.
   654 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   655 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   656 01  WS-WORK-HIN-ROW-B.
   657     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   658
   659 01  ws-benefit-cd-chg-sw      pic x value spaces.
   660     88  benefit-code-chg           value 'Y'.
   661 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   662 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   663     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   664 01  WS-ROW-D-TABLE.
   665     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   666
   667 01  WS-HIN-TABLE-B.
   668     05  F                       PIC XX VALUE 'A2'.
   669     05  F                       PIC XX VALUE 'B3'.
   670     05  F                       PIC XX VALUE 'C4'.
   671     05  F                       PIC XX VALUE 'D5'.
   672     05  F                       PIC XX VALUE 'E6'.
   673     05  F                       PIC XX VALUE 'F7'.
   674     05  F                       PIC XX VALUE 'G8'.
   675     05  F                       PIC XX VALUE 'H9'.
   676     05  F                       PIC XX VALUE 'I1'.
   677     05  F                       PIC XX VALUE 'J2'.
   678     05  F                       PIC XX VALUE 'K3'.
   679     05  F                       PIC XX VALUE 'L4'.
   680     05  F                       PIC XX VALUE 'M5'.
   681     05  F                       PIC XX VALUE 'N6'.
   682     05  F                       PIC XX VALUE 'O0'.
   683     05  F                       PIC XX VALUE 'P7'.
   684     05  F                       PIC XX VALUE 'Q0'.
   685     05  F                       PIC XX VALUE 'R8'.
   686     05  F                       PIC XX VALUE 'S9'.
   687     05  F                       PIC XX VALUE 'T2'.
   688     05  F                       PIC XX VALUE 'U3'.
   689     05  F                       PIC XX VALUE 'V4'.
   690     05  F                       PIC XX VALUE 'W5'.
   691     05  F                       PIC XX VALUE 'X6'.
   692     05  F                       PIC XX VALUE 'Y7'.
   693     05  F                       PIC XX VALUE 'Z8'.
   694 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   695     05  WS-VAL-IN               PIC X.
   696     05  WS-VAL-OUT              PIC 9.
   697 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   698 01  WS-COMPARE-BINARY-DATES.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  14
* EL050.cbl
   699     05  WS-971231                PIC XX VALUE X'92FF'.
   700     05  WS-931231                PIC XX VALUE X'8CFF'.
   701     05  WS-791231                PIC XX VALUE X'77FF'.
   702     05  WS-771001                PIC XX VALUE X'74A1'.
   703     05  WS-820301                PIC XX VALUE X'7B41'.
   704     05  WS-831031                PIC XX VALUE X'7DBF'.
   705     05  WS-831231                PIC XX VALUE X'7DFF'.
   706     05  WS-810831                PIC XX VALUE X'7A7F'.
   707     05  WS-830901                PIC XX VALUE X'7D81'.
   708
   709 01  FILE-ACCESS-IDS.
   710     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   711     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   712     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   713     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   714     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   715     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   716     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   717     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   718     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   719     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   720     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   721     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   722     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   723     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   724     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   725     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   726     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   727 01  DD-IU-SW                    PIC X   VALUE ' '.
   728     88  DD-IU-PRESENT                 VALUE 'Y'.
   729
   730 01  ACCESS-KEYS.
   731     12  ELMSTR-KEY.
   732         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   733         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   734     12  W-CLAIM-KEY.
   735         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   736         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   737
   738     12  ELCNTL-KEY.
   739         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   740         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   741         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   742         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   743
   744     12  ELCERT-KEY.
   745         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   746         16  CERT-CARRIER         PIC X       VALUE SPACE.
   747         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   748         16  CERT-STATE           PIC XX      VALUE SPACES.
   749         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   750         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   751         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   752
   753     12  ELCERT2-KEY.
   754         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   755         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   756
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  15
* EL050.cbl
   757     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   758
   759     12  ELCERT-SAVE.
   760         16  FILLER                      PIC XX    VALUE SPACES.
   761
   762         16  WCS-CONTROL-PRIMARY.
   763             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   764             20  WCS-CARRIER             PIC X     VALUE SPACE.
   765             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   766             20  WCS-STATE               PIC XX    VALUE SPACES.
   767             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   768             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   769             20  WCS-CERT-NO.
   770                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   771                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   772
   773         16  CS-CONTROL-BY-NAME.
   774             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   775             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   776             20  CS-INSURED-INITIALS.
   777                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   778                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   779
   780         16  CS-CONTROL-BY-SSN.
   781             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   782             20  CS-SOC-SEC-NO.
   783                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   784                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   785                 24  CS-SSN-LN3.
   786                     28 CS-INSURED-INITIALS-A2   PIC XX
   787                                     VALUE SPACES.
   788                     28 CS-PART-LAST-NAME-A2     PIC X
   789                                     VALUE SPACE.
   790
   791         16  CS-CONTROL-BY-CERT-NO.
   792             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   793             20  CS-CERT-NO-A4           PIC X(11)
   794                                     VALUE SPACES.
   795
   796         16  CS-CONTROL-BY-MEMB.
   797             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   798             20  CS-MEMBER-NO.
   799                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   800                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   801                 24  CS-MEMB-LN4.
   802                     28 CS-INSURED-INITIALS-A5   PIC XX
   803                                      VALUE SPACES.
   804                     28 CS-PART-LAST-NAME-A5     PIC XX
   805                                      VALUE SPACES.
   806
   807         16  FILLER              PIC X(360) VALUE SPACES.
   808
   809     12  ERACCT-KEY.
   810         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   811         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   812         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   813         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   814         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  16
* EL050.cbl
   815         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   816
   817     12  ERCOMP-KEY.
   818         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   819         16  COMP-CARRIER         PIC X     VALUE SPACES.
   820         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   821         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   822         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   823         16  COMP-TYPE            PIC X     VALUE SPACES.
   824
   825     12  ERLOFC-KEY.
   826         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   827         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   828         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   829         16  LOFC-STATE           PIC XX    VALUE SPACES.
   830         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   831         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   832
   833     12  WS-ELCRTT-KEY.
   834         16  WS-ELCRTT-PRIMARY       PIC X(33).
   835         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   836
   837     12  ERBXRF-KEY.
   838         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   839         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   840         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   841         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   842
   843     12  ERAGTC-KEY.
   844         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   845         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   846         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   847         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   848         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   849         16  AGTC-TYPE            PIC X     VALUE SPACES.
   850
   851     12  ERPLAN-KEY.
   852         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   853         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   854         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   855         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   856         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   857         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   858         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   859         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   860
   861     12  ERFORM-KEY.
   862         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   863         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   864         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   865         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   866
   867     12  ERREIN-KEY.
   868         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   869         16  REIN-TYPE            PIC X     VALUE SPACES.
   870         16  REIN-TABLE-CO.
   871             20  REIN-CODE-1      PIC X     VALUE SPACE.
   872             20  REIN-CODE-2      PIC X     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  17
* EL050.cbl
   873             20  REIN-CODE-3      PIC X     VALUE SPACE.
   874         16  FILLER               PIC X(3)  VALUE SPACES.
   875
   876     12  ERCTBL-KEY.
   877         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   878         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   879         16  CTBL-CNTRL-2.
   880             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   881             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   882
   883     12  ELCRTO-KEY.
   884         16  ELCRTO-COMPANY-CD       PIC X.
   885         16  ELCRTO-CARRIER          PIC X.
   886         16  ELCRTO-GROUPING         PIC X(6).
   887         16  ELCRTO-STATE            PIC XX.
   888         16  ELCRTO-ACCOUNT          PIC X(10).
   889         16  ELCRTO-CERT-EFF-DT      PIC XX.
   890         16  ELCRTO-CERT-NO.
   891             20  ELCRTO-CERT-PRIME   PIC X(10).
   892             20  ELCRTO-CERT-SFX     PIC X.
   893         16  ELCRTO-RECORD-TYPE      PIC X.
   894         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   895
   896
   897     12  WS-ACCESS.
   898         16  FILLER               PIC XX    VALUE SPACES.
   899         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   900
   901     12  WS-CARR-ACCESS.
   902         16  FILLER               PIC X(3)  VALUE SPACES.
   903         16  WS-CARR              PIC X     VALUE SPACE.
   904*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   905*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   906     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   907         88  WS-DMD-LF-RATING   VALUE 'Y'.
   908         88  WS-DMD-AH-RATING   VALUE 'Y'.
   909         88  WS-DMD-NO-RATING   VALUE 'N'.
   910
   911     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   912         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   913                                         'NJ' 'NL'
   914                                         'PJ' 'PL'
   915                                         'SJ' 'SL'.
   916     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   917         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   918                                         'NI' 'NJ' 'NL' 'NU'
   919                                         'PJ' 'PL' 'PI' 'PU'
   920                                         'SI' 'SJ' 'SL' 'SU'
   921                                         'MX' 'MY' 'MZ'.
   922 01  ERPDEF-KEY-SAVE             PIC X(18).
   923 01  ERPDEF-KEY.
   924     12  ERPDEF-COMPANY-CD       PIC X.
   925     12  ERPDEF-STATE            PIC XX.
   926     12  ERPDEF-PROD-CD          PIC XXX.
   927     12  F                       PIC X(7).
   928     12  ERPDEF-BEN-TYPE         PIC X.
   929     12  ERPDEF-BEN-CODE         PIC XX.
   930     12  ERPDEF-EXP-DT           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  18
* EL050.cbl
   931
   932 01  ELSTAT-KEY-SAVE             PIC X(20).
   933 01  ELSTAT-KEY.
   934     12  ELSTAT-COMPANY-ID       PIC XXX.
   935     12  ELSTAT-CARRIER          PIC X.
   936     12  ELSTAT-GROUP            PIC X(6).
   937     12  ELSTAT-STATE            PIC XX.
   938     12  ELSTAT-EXP-DT           PIC 9(8).
   939 01  WS-ERROR-VALUES.
   940     12  ER-1570                     PIC S9(4)   VALUE +1570.
   941     12  ER-1571                     PIC S9(4)   VALUE +1571.
   942     12  er-1572                     pic s9(4)   value +1572.
   943     12  er-1573                     pic s9(4)   value +1573.
   944     12  er-1574                     pic s9(4)   value +1574.
   945     12  ER-1575                     PIC S9(4)   VALUE +1575.
   946     12  er-1576                     pic s9(4)   value +1576.
   947     12  er-1583                     pic s9(4)   value +1583.
   948     12  er-1743                     pic s9(4)   value +1743.
   949     12  er-1744                     pic s9(4)   value +1744.
   950     12  er-1745                     pic s9(4)   value +1745.
   951     12  er-1746                     pic s9(4)   value +1746.
   952     12  er-1747                     pic s9(4)   value +1747.
   953     12  er-1748                     pic s9(4)   value +1748.
   954     12  ER-1891                     PIC S9(4)   VALUE +1891.
   955     12  ER-1892                     PIC S9(4)   VALUE +1892.
   956     12  ER-1893                     PIC S9(4)   VALUE +1893.
   957     12  ER-1894                     PIC S9(4)   VALUE +1894.
   958     12  ER-1895                     PIC S9(4)   VALUE +1895.
   959     12  ER-1896                     PIC S9(4)   VALUE +1896.
   960     12  ER-1897                     PIC S9(4)   VALUE +1897.
   961     12  ER-1898                     PIC S9(4)   VALUE +1898.
   962     12  ER-1899                     PIC S9(4)   VALUE +1899.
   963     12  ER-1900                     PIC S9(4)   VALUE +1900.
   964     12  ER-1901                     PIC S9(4)   VALUE +1901.
   965     12  ER-1902                     PIC S9(4)   VALUE +1902.
   966     12  ER-1903                     PIC S9(4)   VALUE +1903.
   967     12  ER-1904                     PIC S9(4)   VALUE +1904.
   968     12  ER-1905                     PIC S9(4)   VALUE +1905.
   969     12  ER-1906                     PIC S9(4)   VALUE +1906.
   970     12  ER-1907                     PIC S9(4)   VALUE +1907.
   971     12  ER-1909                     PIC S9(4)   VALUE +1909.
   972     12  ER-1910                     PIC S9(4)   VALUE +1910.
   973     12  ER-1911                     PIC S9(4)   VALUE +1911.
   974     12  ER-1912                     PIC S9(4)   VALUE +1912.
   975     12  ER-1913                     PIC S9(4)   VALUE +1913.
   976     12  ER-1914                     PIC S9(4)   VALUE +1914.
   977     12  ER-1915                     PIC S9(4)   VALUE +1915.
   978     12  ER-1916                     PIC S9(4)   VALUE +1916.
   979     12  ER-1917                     PIC S9(4)   VALUE +1917.
   980     12  ER-1918                     PIC S9(4)   VALUE +1918.
   981     12  ER-1919                     PIC S9(4)   VALUE +1919.
   982     12  ER-1920                     PIC S9(4)   VALUE +1920.
   983     12  ER-1921                     PIC S9(4)   VALUE +1921.
   984     12  ER-1922                     PIC S9(4)   VALUE +1922.
   985     12  ER-1923                     PIC S9(4)   VALUE +1923.
   986     12  ER-1924                     PIC S9(4)   VALUE +1924.
   987     12  ER-1925                     PIC S9(4)   VALUE +1925.
   988     12  ER-1926                     PIC S9(4)   VALUE +1926.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  19
* EL050.cbl
   989     12  ER-1927                     PIC S9(4)   VALUE +1927.
   990     12  ER-1955                     PIC s9(4)   VALUE +1955.
   991     12  ER-1956                     PIC s9(4)   VALUE +1956.
   992     12  ER-1957                     PIC s9(4)   VALUE +1957.
   993     12  ER-1958                     PIC s9(4)   VALUE +1958.
   994     12  ER-1959                     PIC s9(4)   VALUE +1959.
   995     12  ER-1960                     PIC s9(4)   VALUE +1960.
   996     12  ER-1961                     PIC s9(4)   VALUE +1961.
   997     12  ER-1962                     PIC s9(4)   VALUE +1962.
   998     12  ER-1963                     PIC s9(4)   VALUE +1963.
   999     12  ER-2393                     PIC S9(4)   VALUE +2393.
  1000     12  ER-2600                     PIC S9(4)   VALUE +2600.
  1001     12  ER-2601                     PIC S9(4)   VALUE +2601.
  1002     12  ER-2602                     PIC S9(4)   VALUE +2602.
  1003     12  ER-2603                     PIC S9(4)   VALUE +2603.
  1004     12  ER-2604                     PIC S9(4)   VALUE +2604.
  1005     12  ER-2605                     PIC S9(4)   VALUE +2605.
  1006     12  ER-2606                     PIC S9(4)   VALUE +2606.
  1007     12  ER-2607                     PIC S9(4)   VALUE +2607.
  1008     12  ER-2608                     PIC S9(4)   VALUE +2608.
  1009     12  ER-2609                     PIC S9(4)   VALUE +2609.
  1010     12  ER-2610                     PIC S9(4)   VALUE +2610.
  1011     12  ER-2611                     PIC S9(4)   VALUE +2611.
  1012     12  ER-2612                     PIC S9(4)   VALUE +2612.
  1013     12  ER-2613                     PIC S9(4)   VALUE +2613.
  1014     12  ER-2614                     PIC S9(4)   VALUE +2614.
  1015     12  ER-2615                     PIC S9(4)   VALUE +2615.
  1016     12  ER-2616                     PIC S9(4)   VALUE +2616.
  1017     12  ER-2617                     PIC S9(4)   VALUE +2617.
  1018     12  ER-2618                     PIC S9(4)   VALUE +2618.
  1019     12  ER-2619                     PIC S9(4)   VALUE +2619.
  1020     12  ER-2620                     PIC S9(4)   VALUE +2620.
  1021     12  ER-2621                     PIC S9(4)   VALUE +2621.
  1022     12  ER-2622                     PIC S9(4)   VALUE +2622.
  1023     12  ER-2623                     PIC S9(4)   VALUE +2623.
  1024     12  ER-2624                     PIC S9(4)   VALUE +2624.
  1025     12  ER-2625                     PIC S9(4)   VALUE +2625.
  1026     12  ER-2626                     PIC S9(4)   VALUE +2626.
  1027     12  ER-2627                     PIC S9(4)   VALUE +2627.
  1028     12  ER-2628                     PIC S9(4)   VALUE +2628.
  1029     12  ER-2629                     PIC S9(4)   VALUE +2629.
  1030     12  ER-2630                     PIC S9(4)   VALUE +2630.
  1031     12  ER-2631                     PIC S9(4)   VALUE +2631.
  1032     12  ER-2632                     PIC S9(4)   VALUE +2632.
  1033     12  ER-2633                     PIC S9(4)   VALUE +2633.
  1034     12  ER-2634                     PIC S9(4)   VALUE +2634.
  1035     12  ER-2635                     PIC S9(4)   VALUE +2635.
  1036     12  ER-2636                     PIC S9(4)   VALUE +2636.
  1037     12  ER-2637                     PIC S9(4)   VALUE +2637.
  1038     12  ER-2638                     PIC S9(4)   VALUE +2638.
  1039     12  ER-2639                     PIC S9(4)   VALUE +2639.
  1040     12  ER-2640                     PIC S9(4)   VALUE +2640.
  1041     12  ER-2641                     PIC S9(4)   VALUE +2641.
  1042     12  ER-2642                     PIC S9(4)   VALUE +2642.
  1043     12  ER-2643                     PIC S9(4)   VALUE +2643.
  1044     12  ER-2644                     PIC S9(4)   VALUE +2644.
  1045     12  ER-2645                     PIC S9(4)   VALUE +2645.
  1046     12  ER-2646                     PIC S9(4)   VALUE +2646.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  20
* EL050.cbl
  1047     12  ER-2647                     PIC S9(4)   VALUE +2647.
  1048     12  ER-2648                     PIC S9(4)   VALUE +2648.
  1049     12  ER-2649                     PIC S9(4)   VALUE +2649.
  1050     12  ER-2650                     PIC S9(4)   VALUE +2650.
  1051     12  ER-2651                     PIC S9(4)   VALUE +2651.
  1052     12  ER-2652                     PIC S9(4)   VALUE +2652.
  1053     12  ER-2653                     PIC S9(4)   VALUE +2653.
  1054     12  ER-2654                     PIC S9(4)   VALUE +2654.
  1055     12  ER-2655                     PIC S9(4)   VALUE +2655.
  1056     12  ER-2656                     PIC S9(4)   VALUE +2656.
  1057     12  ER-2657                     PIC S9(4)   VALUE +2657.
  1058     12  ER-2658                     PIC S9(4)   VALUE +2658.
  1059     12  ER-2659                     PIC S9(4)   VALUE +2659.
  1060     12  ER-2660                     PIC S9(4)   VALUE +2660.
  1061     12  ER-2661                     PIC S9(4)   VALUE +2661.
  1062     12  ER-2662                     PIC S9(4)   VALUE +2662.
  1063     12  ER-2663                     PIC S9(4)   VALUE +2663.
  1064     12  ER-2664                     PIC S9(4)   VALUE +2664.
  1065     12  ER-2665                     PIC S9(4)   VALUE +2665.
  1066     12  ER-2666                     PIC S9(4)   VALUE +2666.
  1067     12  ER-2667                     PIC S9(4)   VALUE +2667.
  1068     12  ER-2668                     PIC S9(4)   VALUE +2668.
  1069     12  ER-2669                     PIC S9(4)   VALUE +2669.
  1070     12  ER-2670                     PIC S9(4)   VALUE +2670.
  1071     12  ER-2671                     PIC S9(4)   VALUE +2671.
  1072     12  ER-2672                     PIC S9(4)   VALUE +2672.
  1073     12  ER-2673                     PIC S9(4)   VALUE +2673.
  1074     12  ER-2674                     PIC S9(4)   VALUE +2674.
  1075     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1076     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1077     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1078     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1079     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1080     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1081     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1082     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1083     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1084     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1085     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1086     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1087     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1088     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1089     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1090     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1091     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1092     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1093     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1094     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1095     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1096     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1097     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1098     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1099     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1100     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1101     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1102     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1103     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1104     12  ER-2704                     PIC S9(4)   VALUE +2704.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  21
* EL050.cbl
  1105     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1106     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1107     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1108     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1109     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1110     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1111     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1112     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1113     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1114     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1115     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1116     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1117     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1118     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1119     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1120     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1121     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1122     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1123     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1124     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1125     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1126     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1127     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1128     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1129     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1130     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1131     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1132     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1133     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1134     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1135     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1136     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1137     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1138     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1139     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1140     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1141     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1142     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1143     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1144     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1145     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1146     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1147     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1148     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1149     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1150     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1151     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1152     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1153     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1154     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1155     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1156     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1157     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1158     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1159     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1160     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1161     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1162     12  ER-2772                     PIC S9(4)   VALUE +2772.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  22
* EL050.cbl
  1163     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1164     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1165     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1166     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1167     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1168     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1169     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1170     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1171     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1172     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1173     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1174     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1175     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1176     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1177     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1178     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1179     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1180     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1181     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1182     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1183     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1184     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1185     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1186     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1187     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1188     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1189     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1190     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1191     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1192     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1193     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1194     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1195     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1196     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1197     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1198     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1199     12  ER-2896                     PIC S9(4)   VALUE +2896.
  1200     12  ER-2897                     PIC S9(4)   VALUE +2897.
  1201     12  ER-2898                     PIC S9(4)   VALUE +2898.
  1202     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1203     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1204     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1205     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1206     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1207     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1208     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1209     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1210     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1211     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1212     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1213     12  ER-3059                     PIC S9(4)   VALUE +3059.
  1214     12  ER-3060                     PIC S9(4)   VALUE +3060.
  1215     12  ER-3061                     PIC S9(4)   VALUE +3061.
  1216     12  ER-3062                     PIC S9(4)   VALUE +3062.
  1217     12  ER-3063                     PIC S9(4)   VALUE +3063.
  1218     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1219     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1220     12  ER-3782                     PIC S9(4)   VALUE +3782.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  23
* EL050.cbl
  1221     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1222     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1223     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1224     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1225     12  ER-3827                     PIC S9(4)   VALUE +3827.
  1226     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1227     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1228     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1229     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1230     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1231     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1232     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1233     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1234     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1235     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1236     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1237     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1238     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1239     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1240     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1241     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1242     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1243     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1244     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1245     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1246     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1247     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1248     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1249     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1250     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1251     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1252     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1253     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1254     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1255     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1256     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1257     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1258     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1259     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1260     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1261     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1262     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1263     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1264     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1265     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1266     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1267     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1268     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1269     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1270     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1271     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1272     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1273     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1274     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1275     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1276     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1277     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1278     12  ER-8094                     PIC S9(4)   VALUE +8094.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  24
* EL050.cbl
  1279     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1280     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1281     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1282     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1283     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1284     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1285     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1286     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1287     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1288     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1289     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1290     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1291     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1292     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1293     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1294     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1295     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1296     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1297     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1298     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1299     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1300     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1301     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1302     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1303     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1304     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1305     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1306     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1307     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1308     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1309     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1310     12  ER-9813                     PIC S9(4)   VALUE +9813.
  1311     12  er-9823                     pic s9(4)   value +9823.
  1312     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1313******************************************************************
  1314***************   END OF ELC50WS     ****************************
  1315******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  25
* EL050.cbl
  1318 01  WORKING-STORAGE-WORK-AREAS.
  1319     12  WS-RESPONSE             PIC S9(8)  COMP.
  1320         88  WS-RESP-NORMAL           VALUE +00.
  1321         88  WS-RESP-ERROR            VALUE +01.
  1322         88  WS-RESP-NOTFND           VALUE +13.
  1323         88  WS-RESP-DUPREC           VALUE +14.
  1324         88  WS-RESP-ENDFILE          VALUE +20.
  1325     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1326     12  WORK-AREAS.
  1327         16  WK-CONV-GREG.
  1328             24  WCG-CENT             PIC XX.
  1329             24  WCG-REST             PIC X(4).
  1330         16  WORK-GREGORIAN-DATE.
  1331             24  WK-GREG-CENT         PIC XX.
  1332             24  WK-GREG-DATE-YYMMDD.
  1333                 28  WK-GREG-YYMM     PIC X(4).
  1334                 28  WK-GREG-DD       PIC XX.
  1335
  1336         16  WORK-SELECT-DATE.
  1337             24  WK-SELECT-CENT            PIC XX.
  1338             24  WK-SELECT-DATE-YYMMDD.
  1339                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1340                 28  FILLER                PIC XX.
  1341
  1342         16  WK-FORM-NO.
  1343             24  WK-FORM-BANK-ID       PIC X(5).
  1344             24  WK-FORM-UNDRWRTR      PIC X(1).
  1345             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1346
  1347         16  WK-MEMBER-NO.
  1348             24  WK-MEMBER-1-6        PIC X(6).
  1349             24  WK-MEMBER-7-12       PIC X(6).
  1350
  1351         16  WK-FULL-CERT-NO.
  1352             24  WK-CERT-POS-1-2      PIC X(2).
  1353             24  WK-CERT-POS-3        PIC X(1).
  1354             24  WK-CERT-POS-4        PIC X(1).
  1355             24  WK-CERT-POS-5-6      PIC X(2).
  1356             24  WK-CERT-POS-7        PIC X(1).
  1357             24  WK-CERT-POS-8-11     PIC X(4).
  1358
  1359         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1360             88  VALID-RATE-CODE        VALUE 'Y'.
  1361             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1362
  1363         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1364         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1365         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1366         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1367         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1368         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1369         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1370         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1371         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1372         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1373
  1374* DLO001
  1375 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  26
* EL050.cbl
  1376     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1377     12  DMPF-RETURN-CODE          PIC XX.
  1378         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1379         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1380         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1381         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1382         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1383         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1384
  1385* DLO002
  1386 01  WS-DLO-INTERNAL-POLICY-FORM.
  1387     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1388     12  DIPF-RETURN-CODE          PIC XX.
  1389         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1390         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1391         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1392         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1393         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1394         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1395
  1396* DLO003
  1397 01  WS-DLO-VALID-BANK-ID.
  1398     12  DVBI-BANK-ID              PIC X(5).
  1399     12  DVBI-BANK-ID-TYPE         PIC X.
  1400         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1401         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1402         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1403         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1404         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1405     12  DVBI-RETURN-CODE          PIC XX.
  1406         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1407         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1408         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1409         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1410         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1411         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1412         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1413         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1414         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1415
  1416* DLO007
  1417 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1418     12  DCUA-RES-STATE            PIC XX.
  1419     12  DCUA-BEN-TYPE             PIC XX.
  1420     12  DCUA-SYS-IDENT            PIC X.
  1421         88  DCUA-CLAIM                        VALUE 'C'.
  1422         88  DCUA-PREMIUM                      VALUE 'P'.
  1423     12  DCUA-COVERAGE-RULE        PIC X.
  1424     12  DCUA-CLIENT-ID            PIC X(10).
  1425     12  DCUA-EFF-DATE             PIC X(8).
  1426     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1427     12  DCUA-RETURN-CODE          PIC XX.
  1428         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1429     12  DCUA-CERT-NUMBER          PIC X(11).
  1430     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1431     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1432
  1433* DLO011
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  27
* EL050.cbl
  1434 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1435     12  DPRB-RATE-CODE            PIC X(4).
  1436     12  DPRB-COVERAGE-CATEG       PIC X.
  1437     12  DPRB-RETURN-CODE          PIC XX.
  1438         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1439         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1440         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1441         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1442         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1443         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1444         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1445         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1446         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1447     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1448     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1449     12  DPRB-BEN-TYPE             PIC XX.
  1450
  1451* DLO017
  1452 01  WS-DLO-VALID-RATE-CODE.
  1453     12  DVRC-RATE-CODE            PIC X(4).
  1454     12  DVRC-RETURN-CODE          PIC XX.
  1455         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1456         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1457         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1458         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1459         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1460         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1461
  1462* DLO019
  1463 01  WS-DLO-ORIG-COV-CAT.
  1464     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1465     12  DOCC-RETURN-CODE          PIC XX.
  1466     12  DOCC-ORIG-COV-CAT         PIC X.
  1467     12  DOCC-UNDERWITER           PIC XX.
  1468     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1469     12  DOCC-FILLER               PIC X(6).
  1470
  1471* DLO021
  1472 01  WS-DLO-VALID-LOAN-OFFICER.
  1473     12  DVLO-LOAN-OFFICER.
  1474         16  DVLO-BILL-TYPE        PIC X.
  1475         16  DVLO-BILL-SOURCE      PIC X.
  1476         16  DVLO-BATCH-TYPE       PIC X.
  1477     12  DVLO-RETURN-CODE          PIC XX.
  1478         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1479         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1480         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1481         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1482         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1483         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1484
  1485* DLO022
  1486 01  WS-DLO-VALID-STATE-CODE.
  1487     12  DVSC-STATE-CODE           PIC XX.
  1488     12  DVSC-RETURN-CODE          PIC XX.
  1489         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1490
  1491* DLO023
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  28
* EL050.cbl
  1492 01  WS-DLO-VALID-CODE-VALUES.
  1493     12  DVCV-SYSTEM-ID            PIC XX.
  1494         88  DVCV-CLAIMS                       VALUE 'CL'.
  1495         88  DVCV-CREDIT                       VALUE 'CR'.
  1496     12  DVCV-RECORD-TYPE          PIC XX.
  1497         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1498         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1499         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1500         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1501         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1502         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1503         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1504         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1505     12  DVCV-RECORD-KEY           PIC X(6).
  1506     12  DVCV-RETURN-CODE          PIC XX.
  1507         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1508         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1509         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1510         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1511         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1512         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1513         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1514     12  DVCV-CODE-DESC            PIC X(60).
  1515     12  DVCV-GEN-DESC-1           PIC X(20).
  1516     12  DVCV-GEN-DESC-2           PIC X(20).
  1517     12  DVCV-GEN-DESC-3           PIC X(20).
  1518
  1519 01  hldi-pass-area-len          pic s9(4) comp value +214.
  1520 01  hldi-pass-area.
  1521     03  PA-VIN                  PIC X(17).
  1522     03  PA-ErrorCode            PIC X(10).
  1523     03  PA-ErrorDesc            PIC X(30).
  1524     03  PA-ModelYear            PIC 9(7).
  1525     03  PA-MakeName             PIC X(50).
  1526     03  PA-ModelName            PIC X(50).
  1527     03  PA-SeriesName           PIC X(50).
  1528****  this is for aggregate report.
  1529****  Length is erpndb + 100 of passed-key-area
  1530 01  ws-passed-key-length        pic s9(4) comp value +587.
  1531 01  ws-pass-to-pemaggo.
  1532     05  ws-passed-erpndb        pic x(585).
  1533     05  ws-exceed-limit-yn      pic x.
  1534     05  ws-has-claim-yn         pic x.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  29
* EL050.cbl
  1536*    COPY ERCBXRF.
  1537******************************************************************
  1538*                                                                *
  1539*                                                                *
  1540*                            ERCBXRF                             *
  1541*                                                                *
  1542*   ONLINE CREDIT SYSTEM                                         *
  1543*                                                                *
  1544*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1545*                                                                *
  1546*   FILE TYPE = VSAM,KSDS                                        *
  1547*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1548*                                                                *
  1549*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1550*       ALTERNATE PATH = NONE                                    *
  1551*                                                                *
  1552*   LOG = NO                                                     *
  1553*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1554*                                                                *
  1555******************************************************************
  1556
  1557 01  BANK-CROSS-REFERENCE.
  1558     12  BK-RECORD-ID                PIC XX.
  1559         88  VALID-BK-ID             VALUE 'BK'.
  1560
  1561     12  BK-CONTROL-PRIMARY.
  1562         16  BK-COMPANY-CD           PIC X.
  1563         16  BK-CARRIER              PIC X.
  1564         16  BK-GROUPING             PIC X(6).
  1565         16  BK-BANK-NO              PIC X(10).
  1566
  1567     12  BK-MAINT-INFORMATION.
  1568         16  BK-LAST-MAINT-DT        PIC XX.
  1569         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1570         16  BK-LAST-MAINT-USER      PIC X(4).
  1571         16  FILLER                  PIC X(9).
  1572
  1573     12  FILLER                      PIC X(37).
  1574
  1575     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1576
  1577     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1578                            DEPENDING ON BK-BANK-POINTER-CNT.
  1579         16  BK-AM-ACCOUNT           PIC X(10).
  1580         16  BK-AM-EXP-DT            PIC XX.
  1581         16  BK-AM-EFF-DT            PIC XX.
  1582         16  BK-AM-STATE             PIC XX.
  1583         16  FILLER                  PIC X(20).
  1584
  1585******************************************************************
  1586
  1587*    COPY ERCCOMP.
  1588******************************************************************
  1589*                                                                *
  1590*                                                                *
  1591*                            ERCCOMP                             *
  1592*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1593*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  30
* EL050.cbl
  1594*                                                                *
  1595*   ONLINE CREDIT SYSTEM                                         *
  1596*                                                                *
  1597*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1598*                                                                *
  1599*   FILE TYPE = VSAM,KSDS                                        *
  1600*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1601*                                                                *
  1602*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1603*       ALTERNATE PATH = NONE                                    *
  1604*                                                                *
  1605*   LOG = NO                                                     *
  1606*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1607*                                                                *
  1608******************************************************************
  1609*                   C H A N G E   L O G
  1610*
  1611* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1612*-----------------------------------------------------------------
  1613*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1614* EFFECTIVE    NUMBER
  1615*-----------------------------------------------------------------
  1616* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1617* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1618* 092205    2005050300006  PEMA  ADD LEASE FEE
  1619* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1620* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1621* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1622* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1623* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1624* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1625******************************************************************
  1626
  1627 01  COMPENSATION-MASTER.
  1628     12  CO-RECORD-ID                          PIC XX.
  1629         88  VALID-CO-ID                          VALUE 'CO'.
  1630
  1631     12  CO-CONTROL-PRIMARY.
  1632         16  CO-COMPANY-CD                     PIC X.
  1633         16  CO-CONTROL.
  1634             20  CO-CTL-1.
  1635                 24  CO-CARR-GROUP.
  1636                     28  CO-CARRIER            PIC X.
  1637                     28  CO-GROUPING.
  1638                         32  CO-GROUP-PREFIX   PIC XXX.
  1639                         32  CO-GROUP-PRIME    PIC XXX.
  1640                 24  CO-RESP-NO.
  1641                     28  CO-RESP-PREFIX        PIC X(4).
  1642                     28  CO-RESP-PRIME         PIC X(6).
  1643             20  CO-CTL-2.
  1644                 24  CO-ACCOUNT.
  1645                     28  CO-ACCT-PREFIX        PIC X(4).
  1646                     28  CO-ACCT-PRIME         PIC X(6).
  1647         16  CO-TYPE                           PIC X.
  1648             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1649             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1650             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1651
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  31
* EL050.cbl
  1652     12  CO-MAINT-INFORMATION.
  1653         16  CO-LAST-MAINT-DT                  PIC XX.
  1654         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1655         16  CO-LAST-MAINT-USER                PIC X(4).
  1656     12  FILLER                                PIC XX.
  1657     12  CO-STMT-TYPE                          PIC XXX.
  1658     12  CO-COMP-TYPE                          PIC X.
  1659         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1660     12  CO-STMT-OWNER                         PIC X(4).
  1661     12  CO-BALANCE-CONTROL                    PIC X.
  1662         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1663         88  CO-NO-BALANCE                        VALUE 'N'.
  1664
  1665     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1666         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1667         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1668         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1669
  1670     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1671         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1672         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1673
  1674     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1675     12  CO-GA-DIRECT-DEP                      PIC X.
  1676     12  CO-FUTURE-SPACE                       PIC X.
  1677         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1678
  1679     12  CO-ACCT-NAME                          PIC X(30).
  1680     12  CO-MAIL-NAME                          PIC X(30).
  1681     12  CO-ADDR-1                             PIC X(30).
  1682     12  CO-ADDR-2                             PIC X(30).
  1683     12  CO-ADDR-3.
  1684         16  CO-ADDR-CITY                      PIC X(27).
  1685         16  CO-ADDR-STATE                     PIC XX.
  1686     12  CO-CSO-1099                           PIC X.
  1687     12  CO-ZIP.
  1688         16  CO-ZIP-PRIME.
  1689             20  CO-ZIP-PRI-1ST                PIC X.
  1690                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1691             20  FILLER                        PIC X(4).
  1692         16  CO-ZIP-PLUS4                      PIC X(4).
  1693     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1694         16  CO-CAN-POSTAL-1                   PIC XXX.
  1695         16  CO-CAN-POSTAL-2                   PIC XXX.
  1696         16  FILLER                            PIC XXX.
  1697     12  CO-SOC-SEC                            PIC X(13).
  1698     12  CO-TELEPHONE.
  1699         16  CO-AREA-CODE                      PIC XXX.
  1700         16  CO-PREFIX                         PIC XXX.
  1701         16  CO-PHONE                          PIC X(4).
  1702
  1703     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1704
  1705     12  CO-AR-BAL-LEVEL                       PIC X.
  1706         88  CO-AR-REF-LVL                        VALUE '1'.
  1707         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1708         88  CO-AR-BILL-LVL                       VALUE '2'.
  1709         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  32
* EL050.cbl
  1710         88  CO-AR-FR-LVL                         VALUE '4'.
  1711
  1712     12  CO-AR-NORMAL-PRINT                    PIC X.
  1713         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1714         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1715
  1716     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1717
  1718     12  CO-AR-REPORTING                       PIC X.
  1719         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1720         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1721
  1722     12  CO-AR-PULL-CHECK                      PIC X.
  1723         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1724         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1725
  1726     12  CO-AR-BALANCE-PRINT                   PIC X.
  1727         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1728
  1729     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1730         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1731         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1732         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1733
  1734     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1735
  1736     12  CO-USER-CODE                          PIC X.
  1737     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1738
  1739******************************************************************
  1740*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1741*    THE LAST MONTH END RUN.
  1742******************************************************************
  1743
  1744     12  CO-LAST-ACTIVITY-DATE.
  1745         16  CO-ACT-YEAR                       PIC 99.
  1746         16  CO-ACT-MONTH                      PIC 99.
  1747         16  CO-ACT-DAY                        PIC 99.
  1748
  1749     12  CO-LAST-STMT-DT.
  1750         16  CO-LAST-STMT-YEAR                 PIC 99.
  1751         16  CO-LAST-STMT-MONTH                PIC 99.
  1752         16  CO-LAST-STMT-DAY                  PIC 99.
  1753
  1754     12  CO-MO-END-TOTALS.
  1755         16  CO-MONTHLY-TOTALS.
  1756             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1757             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1758             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1759             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1760             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1761
  1762         16  CO-AGING-TOTALS.
  1763             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1764             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1765             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1766             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1767
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  33
* EL050.cbl
  1768         16  CO-YTD-TOTALS.
  1769             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1770             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1771
  1772         16  CO-OVER-UNDER-TOTALS.
  1773             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1774             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1775
  1776     12  CO-MISCELLANEOUS-TOTALS.
  1777         16  CO-FICA-TOTALS.
  1778             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1779             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1780
  1781         16  CO-CLAIM-TOTALS.
  1782             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1783             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1784
  1785******************************************************************
  1786*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1787*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1788******************************************************************
  1789
  1790     12  CO-CURRENT-TOTALS.
  1791         16  CO-CURRENT-LAST-STMT-DT.
  1792             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1793             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1794             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1795
  1796         16  CO-CURRENT-MONTHLY-TOTALS.
  1797             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1798             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1799             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1800             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1801             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1802
  1803         16  CO-CURRENT-AGING-TOTALS.
  1804             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1805             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1806             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1807             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1808
  1809         16  CO-CURRENT-YTD-TOTALS.
  1810             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1811             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1812
  1813     12  CO-PAID-COMM-TOTALS.
  1814         16  CO-YTD-PAID-COMMS.
  1815             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1816             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1817
  1818     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1819         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1820         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1821
  1822     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1823         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1824         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1825         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  34
* EL050.cbl
  1826         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1827         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1828         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1829         88  CO-FINAL-LETTER                  VALUE 'F'.
  1830         88  CO-RECONCILING                   VALUE 'R'.
  1831         88  CO-PHONE-CALL                    VALUE 'P'.
  1832         88  CO-LEGAL                         VALUE 'L'.
  1833         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1834         88  CO-WRITE-OFF                     VALUE 'W'.
  1835         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1836
  1837     12  CO-CSR-CODE                       PIC X(4).
  1838
  1839     12  CO-GA-STATUS-INFO.
  1840         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1841         16  CO-GA-TERMINATION-DT          PIC XX.
  1842         16  CO-GA-STATUS-CODE             PIC X.
  1843             88  CO-GA-ACTIVE                 VALUE 'A'.
  1844             88  CO-GA-INACTIVE               VALUE 'I'.
  1845             88  CO-GA-PENDING                VALUE 'P'.
  1846         16  CO-GA-COMMENTS.
  1847             20  CO-GA-COMMENT-1           PIC X(40).
  1848             20  CO-GA-COMMENT-2           PIC X(40).
  1849             20  CO-GA-COMMENT-3           PIC X(40).
  1850             20  CO-GA-COMMENT-4           PIC X(40).
  1851
  1852     12  CO-RPTCD2                         PIC X(10).
  1853     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1854         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1855         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1856
  1857     12  CO-TYPE-AGENT                     PIC X(01).
  1858         88  CO-CORPORATION                   VALUE 'C'.
  1859         88  CO-PARTNERSHIP                   VALUE 'P'.
  1860         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1861         88  CO-TRUST                         VALUE 'T'.
  1862         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1863
  1864     12  CO-FAXNO.
  1865         16  CO-FAX-AREA-CODE                  PIC XXX.
  1866         16  CO-FAX-PREFIX                     PIC XXX.
  1867         16  CO-FAX-PHONE                      PIC X(4).
  1868
  1869     12  CO-BANK-INFORMATION.
  1870         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1871         16  CO-BANK-TRANSIT-NON REDEFINES
  1872             CO-BANK-TRANSIT-NO                PIC 9(8).
  1873
  1874         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1875     12  CO-MISC-DEDUCT-INFO REDEFINES
  1876                  CO-BANK-INFORMATION.
  1877         16  CO-MD-GL-ACCT                     PIC X(10).
  1878         16  CO-MD-DIV                         PIC XX.
  1879         16  CO-MD-CENTER                      PIC X(4).
  1880         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1881         16  CO-CREATE-AP-CHECK                PIC X.
  1882         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1883         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  35
* EL050.cbl
  1884     12  CO-ACH-STATUS                         PIC X.
  1885         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1886         88  CO-ACH-PENDING                        VALUE 'P'.
  1887
  1888     12  CO-BILL-SW                            PIC X.
  1889     12  CO-CONTROL-NAME                       PIC X(30).
  1890     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1891     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1892     12  CO-CLP-STATE                          PIC XX.
  1893     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1894     12  CO-SPP-REFUND-EDIT                    PIC X.
  1895
  1896******************************************************************
  1897
  1898*    COPY ERCAGTC.
  1899******************************************************************
  1900*                                                                *
  1901*                                                                *
  1902*                            ERCAGTC                             *
  1903*                            VMOD=2.001                          *
  1904*                                                                *
  1905*   ONLINE CREDIT SYSTEM                                         *
  1906*                                                                *
  1907*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1908*                                                                *
  1909*   FILE TYPE = VSAM,KSDS                                        *
  1910*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1911*                                                                *
  1912*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1913*       ALTERNATE PATH = NONE                                    *
  1914*                                                                *
  1915*   LOG = NO                                                     *
  1916*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1917*                                                                *
  1918******************************************************************
  1919*                   C H A N G E   L O G
  1920*
  1921* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1922*-----------------------------------------------------------------
  1923*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1924* EFFECTIVE    NUMBER
  1925*-----------------------------------------------------------------
  1926* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1927* 111004                         NEW FILE AND COPYBOOK
  1928* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1929******************************************************************
  1930 01  AGENT-COMMISSIONS.
  1931     12  AG-RECORD-ID                          PIC XX.
  1932         88  VALID-CO-ID                          VALUE 'AG'.
  1933     12  AG-CONTROL-PRIMARY.
  1934         16  AG-COMPANY-CD                     PIC X.
  1935         16  AG-CONTROL.
  1936             20  AG-CTL-1.
  1937                 24  AG-CARR-GROUP.
  1938                     28  AG-CARRIER            PIC X.
  1939                     28  AG-GROUPING           PIC X(6).
  1940                 24  AG-BANK                   PIC X(10).
  1941             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  36
* EL050.cbl
  1942                 24  AG-EXP-DT                 PIC XX.
  1943         16  AG-TYPE                           PIC X.
  1944             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1945             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1946     12  AG-MAINT-INFORMATION.
  1947         16  AG-LAST-MAINT-DT                  PIC XX.
  1948         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1949         16  AG-LAST-MAINT-USER                PIC X(4).
  1950         16  FILLER                            PIC X(10).
  1951     12  AG-EFF-DT                             PIC XX.
  1952     12  AG-COMM-STRUCTURE.
  1953         16  AG-AGT-COMMS OCCURS 10.
  1954             20  AG-AGT                PIC X(10).
  1955             20  AG-COM-TYP            PIC X.
  1956             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1957             20  AG-RECALC-LV-INDIC    PIC X.
  1958             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1959             20  AG-LRCALC-LV-INDIC    PIC X.
  1960             20  FILLER                PIC X(05).
  1961     12  FILLER                  PIC X(145).
  1962******************************************************************
  1963*    COPY ERCRESS.
  1964******************************************************************
  1965*                                                                *
  1966*                            ERCRESS                             *
  1967*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1968*                            VMOD=2.002                          *
  1969*                                                                *
  1970*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1971*                                                                *
  1972*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1973*   VSAM RESIDENT STATE TAX MASTER                              *
  1974*                                                                *
  1975*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1976*                                                                *
  1977*   FILE TYPE = VSAM,KSDS                                        *
  1978*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1979*                                                                *
  1980*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1981*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1982*                                                                *
  1983*   LOG = NO                                                     *
  1984*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1985*                                                                *
  1986*                                                                *
  1987******************************************************************
  1988
  1989 01  RESIDENT-STATE-TAX-MASTER.
  1990
  1991     10  ERRESS-PRIMARY-KEY.
  1992         15  RES-COMPANY-CD        PIC X.
  1993         15  RES-RESIDENT-STATE    PIC XX.
  1994         15  RES-COVERAGE-CATEGORY PIC X.
  1995         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1996*                                      YYYYMMDD
  1997*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1998
  1999     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  37
* EL050.cbl
  2000
  2001         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  2002         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  2003         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  2004         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  2005
  2006     10 RES-RECALC-SW              PIC   X.
  2007         88 RECALC                VALUE 'Y'.
  2008         88 NO-RECALC             VALUE 'N'.
  2009     10  RES-MAINT-BY              PIC X(4).
  2010     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  2011     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  2012*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  38
* EL050.cbl
  2014*    COPY ERCRESC.
  2015******************************************************************
  2016*                                                                *
  2017*                            ERCRESC                             *
  2018*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2019*                            VMOD=2.003                          *
  2020*                                                                *
  2021*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  2022*                                                                *
  2023*   FILE TYPE = VSAM,KSDS                                        *
  2024*   RECORD SIZE = 103 RECFORM = FIXED                            *
  2025*                                                                *
  2026*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  2027*       ALTERNATE PATH1 = NONE                                   *
  2028*                                                                *
  2029*   LOG = NO                                                     *
  2030*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2031*                                                                *
  2032******************************************************************
  2033
  2034 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  2035
  2036     10  ERRESC-RECORD-KEY.
  2037         15  RESC-COMPANY-CD           PIC   X.
  2038         15  RESC-CARRIER              PIC   X.
  2039         15  RESC-GROUP                PIC   X(6).
  2040         15  RESC-STATE                PIC   XX.
  2041         15  RESC-ACCOUNT              PIC   X(10).
  2042         15  RESC-AGENT                PIC   X(10).
  2043         15  RESC-RESIDENT-STATE       PIC   XX.
  2044         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  2045*                                           YYYYMMDD
  2046     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  2047
  2048     10  RESC-COMM-RECORD-DATA.
  2049         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  2050             20 RESC-COVERAGE-CAT      PIC    X.
  2051             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  2052             20 RESC-COMMISSION-TAB REDEFINES
  2053                RESC-COMMISSION-PER    PIC  XXX.
  2054
  2055     10  RESC-MAINT-BY                 PIC X(4).
  2056     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  2057     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  2058*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  39
* EL050.cbl
  2060*    COPY ERCPLAN.
  2061******************************************************************
  2062*                                                                *
  2063*                                                                *
  2064*                            ERCPLAN                             *
  2065*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2066*                            VMOD=2.003                          *
  2067*                                                                *
  2068*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  2069*                                                                *
  2070*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  2071*   PLAN MASTER                                                  *
  2072*                                                                *
  2073*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  2074*                                                                *
  2075*   FILE TYPE = VSAM,KSDS                                        *
  2076*   RECORD SIZE = 420   RECFORM = FIX                            *
  2077*                                                                *
  2078*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  2079*       ALTERNATE PATH1 = N/A                                    *
  2080*                                                                *
  2081*   LOG = NO                                                     *
  2082*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2083*                                                                *
  2084*                                                                *
  2085******************************************************************
  2086
  2087 01  PLAN-MASTER.
  2088     12  PL-RECORD-ID                      PIC XX.
  2089         88  VALID-PL-ID                      VALUE 'PL'.
  2090
  2091     12  PL-CONTROL-PRIMARY.
  2092         16  PL-COMPANY-CD                 PIC X.
  2093         16  PL-MSTR-CNTRL.
  2094             20  PL-CONTROL-A.
  2095                 24  PL-CARRIER            PIC X.
  2096                 24  PL-GROUPING           PIC X(6).
  2097                 24  PL-STATE              PIC XX.
  2098                 24  PL-ACCOUNT            PIC X(10).
  2099             20  PL-BENEFIT-TYPE           PIC X.
  2100             20  PL-BENEFIT-CODE           PIC XX.
  2101             20  PL-REVISION-NO            PIC X(3).
  2102
  2103     12  PL-CONTROL-BY-VAR-GRP.
  2104         16  PL-COMPANY-CD-A1              PIC X.
  2105         16  PL-VG-CARRIER                 PIC X.
  2106         16  PL-VG-GROUPING                PIC X(6).
  2107         16  PL-VG-STATE                   PIC XX.
  2108         16  PL-VG-ACCOUNT                 PIC X(10).
  2109         16  PL-BENEFIT-TYPE-A1            PIC X.
  2110         16  PL-BENEFIT-CODE-A1            PIC XX.
  2111         16  PL-REVISION-NO-A1             PIC 999.
  2112
  2113     12  PL-MAINT-INFORMATION.
  2114         16  PL-LAST-MAINT-DT              PIC XX.
  2115         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2116         16  PL-LAST-MAINT-USER            PIC X(4).
  2117         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  40
* EL050.cbl
  2118
  2119     12  PL-LIABILITY-LIMITS.
  2120         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2121         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2122             20  PL-LM-AGE                 PIC S99        COMP-3.
  2123             20  PL-LM-DUR                 PIC S999       COMP-3.
  2124             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2125             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2126
  2127     12  FILLER                            PIC X(30).
  2128
  2129     12  PL-GL-ACCOUNT-NOS.
  2130         16  PL-PREMIUM-GL                 PIC X(8).
  2131         16  PL-COMM-GL                    PIC X(8).
  2132         16  PL-CLAIM-GL                   PIC X(8).
  2133     12  FILLER                            PIC X(24).
  2134     12  PL-TOLERANCES.
  2135         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2136         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2137         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2138         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2139         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2140         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2141     12  PL-OVER-SHORT.
  2142         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2143         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2144     12  FILLER                            PIC X(24).
  2145     12  PLAN-MISC.
  2146         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2147         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2148         16  PL-IG                         PIC X.
  2149         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2150         16  PL-POLICY-FORM                PIC X(12).
  2151         16  PL-EDIT-FOR-FORM              PIC X(01).
  2152         16  PL-DEV-CODE                   PIC XXX.
  2153         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2154         16  PL-CALC-METHOD                PIC X.
  2155         16  PL-BENEFIT-GROUP              PIC X(05).
  2156         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2157
  2158         16  FILLER                        PIC X(99).
  2159******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  41
* EL050.cbl
  2161*    COPY ELCCERT.
  2162******************************************************************
  2163*                                                                *
  2164*                            ELCCERT.                            *
  2165*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2166*                            VMOD=2.013                          *
  2167*                                                                *
  2168*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2169*                                                                *
  2170*   FILE TYPE = VSAM,KSDS                                        *
  2171*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2172*                                                                *
  2173*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2174*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2175*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2176*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2177*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2178*                                                                *
  2179*   LOG = YES                                                    *
  2180*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2181******************************************************************
  2182*                   C H A N G E   L O G
  2183*
  2184* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2185*-----------------------------------------------------------------
  2186*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2187* EFFECTIVE    NUMBER
  2188*-----------------------------------------------------------------
  2189* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2190* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2191* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2192* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2193* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2194* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2195* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2196* 032612  CR2011110200001  PEMA  AHL CHANGES
  2197* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2198* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2199******************************************************************
  2200
  2201 01  CERTIFICATE-MASTER.
  2202     12  CM-RECORD-ID                      PIC XX.
  2203         88  VALID-CM-ID                      VALUE 'CM'.
  2204
  2205     12  CM-CONTROL-PRIMARY.
  2206         16  CM-COMPANY-CD                 PIC X.
  2207         16  CM-CARRIER                    PIC X.
  2208         16  CM-GROUPING.
  2209             20  CM-GROUPING-PREFIX        PIC X(3).
  2210             20  CM-GROUPING-PRIME         PIC X(3).
  2211         16  CM-STATE                      PIC XX.
  2212         16  CM-ACCOUNT.
  2213             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2214             20  CM-ACCOUNT-PRIME          PIC X(6).
  2215         16  CM-CERT-EFF-DT                PIC XX.
  2216         16  CM-CERT-NO.
  2217             20  CM-CERT-PRIME             PIC X(10).
  2218             20  CM-CERT-SFX               PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  42
* EL050.cbl
  2219
  2220     12  CM-CONTROL-BY-NAME.
  2221         16  CM-COMPANY-CD-A1              PIC X.
  2222         16  CM-INSURED-LAST-NAME          PIC X(15).
  2223         16  CM-INSURED-INITIALS.
  2224             20  CM-INSURED-INITIAL1       PIC X.
  2225             20  CM-INSURED-INITIAL2       PIC X.
  2226
  2227     12  CM-CONTROL-BY-SSN.
  2228         16  CM-COMPANY-CD-A2              PIC X.
  2229         16  CM-SOC-SEC-NO.
  2230             20  CM-SSN-STATE              PIC XX.
  2231             20  CM-SSN-ACCOUNT            PIC X(6).
  2232             20  CM-SSN-LN3.
  2233                 25  CM-INSURED-INITIALS-A2.
  2234                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2235                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2236                 25 CM-PART-LAST-NAME-A2         PIC X.
  2237
  2238     12  CM-CONTROL-BY-CERT-NO.
  2239         16  CM-COMPANY-CD-A4              PIC X.
  2240         16  CM-CERT-NO-A4                 PIC X(11).
  2241
  2242     12  CM-CONTROL-BY-MEMB.
  2243         16  CM-COMPANY-CD-A5              PIC X.
  2244         16  CM-MEMBER-NO.
  2245             20  CM-MEMB-STATE             PIC XX.
  2246             20  CM-MEMB-ACCOUNT           PIC X(6).
  2247             20  CM-MEMB-LN4.
  2248                 25  CM-INSURED-INITIALS-A5.
  2249                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2250                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2251                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2252
  2253     12  CM-INSURED-PROFILE-DATA.
  2254         16  CM-INSURED-FIRST-NAME.
  2255             20  CM-INSURED-1ST-INIT       PIC X.
  2256             20  FILLER                    PIC X(9).
  2257         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2258         16  CM-INSURED-SEX                PIC X.
  2259             88  CM-SEX-MALE                  VALUE 'M'.
  2260             88  CM-SEX-FEMAL                 VALUE 'F'.
  2261         16  CM-INSURED-JOINT-AGE          PIC 99.
  2262         16  CM-JOINT-INSURED-NAME.
  2263             20  CM-JT-LAST-NAME           PIC X(15).
  2264             20  CM-JT-FIRST-NAME.
  2265                 24  CM-JT-1ST-INIT        PIC X.
  2266                 24  FILLER                PIC X(9).
  2267             20  CM-JT-INITIAL             PIC X.
  2268
  2269     12  CM-LIFE-DATA.
  2270         16  CM-LF-BENEFIT-CD              PIC XX.
  2271         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2272         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2273         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2274         16  CM-LF-DEV-CODE                PIC XXX.
  2275         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2276         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  43
* EL050.cbl
  2277         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2278         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2279         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2280         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2281         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2282         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2283         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2284         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2285         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2286         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2287         16  cm-temp-epiq                  pic xx.
  2288             88  EPIQ-CLASS                  value 'EQ'.
  2289*        16  FILLER                        PIC XX.
  2290
  2291     12  CM-AH-DATA.
  2292         16  CM-AH-BENEFIT-CD              PIC XX.
  2293         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2294         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2295         16  CM-AH-DEV-CODE                PIC XXX.
  2296         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2297         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2298         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2299         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2300         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2301         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2302         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2303         16  CM-AH-PAID-THRU-DT            PIC XX.
  2304             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2305         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2306         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  2307         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2308         16  FILLER                        PIC X.
  2309
  2310     12  CM-LOAN-INFORMATION.
  2311         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2312         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2313                                           PIC S9(5)V99  COMP-3.
  2314         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2315         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2316         16  CM-PAY-FREQUENCY              PIC S99.
  2317         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2318         16  CM-RATE-CLASS                 PIC XX.
  2319         16  CM-BENEFICIARY                PIC X(25).
  2320         16  CM-POLICY-FORM-NO             PIC X(12).
  2321         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2322         16  CM-LAST-ADD-ON-DT             PIC XX.
  2323         16  CM-DEDUCTIBLE-AMOUNTS.
  2324             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2325             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2326         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2327             20  CM-RESIDENT-STATE         PIC XX.
  2328             20  CM-RATE-CODE              PIC X(4).
  2329             20  FILLER                    PIC XX.
  2330         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2331             20  CM-LOAN-OFFICER           PIC X(5).
  2332             20  FILLER                    PIC XXX.
  2333         16  CM-CSR-CODE                   PIC XXX.
  2334         16  CM-UNDERWRITING-CODE          PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  44
* EL050.cbl
  2335             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2336         16  CM-POST-CARD-IND              PIC X.
  2337         16  CM-NH-INTERFACE-SW            PIC X.
  2338         16  CM-PREMIUM-TYPE               PIC X.
  2339             88  CM-SING-PRM                  VALUE '1'.
  2340             88  CM-O-B-COVERAGE              VALUE '2'.
  2341             88  CM-OPEN-END                  VALUE '3'.
  2342         16  CM-IND-GRP-TYPE               PIC X.
  2343             88  CM-INDIVIDUAL                VALUE 'I'.
  2344             88  CM-GROUP                     VALUE 'G'.
  2345         16  CM-SKIP-CODE                  PIC X.
  2346             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2347             88  SKIP-JULY                    VALUE '1'.
  2348             88  SKIP-AUGUST                  VALUE '2'.
  2349             88  SKIP-SEPTEMBER               VALUE '3'.
  2350             88  SKIP-JULY-AUG                VALUE '4'.
  2351             88  SKIP-AUG-SEPT                VALUE '5'.
  2352             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2353             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2354             88  SKIP-JUNE                    VALUE '8'.
  2355             88  SKIP-JUNE-JULY               VALUE '9'.
  2356             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2357             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2358         16  CM-PAYMENT-MODE               PIC X.
  2359             88  PAY-MONTHLY                  VALUE SPACE.
  2360             88  PAY-WEEKLY                   VALUE '1'.
  2361             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2362             88  PAY-BI-WEEKLY                VALUE '3'.
  2363             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2364         16  CM-LOAN-NUMBER                PIC X(8).
  2365         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2366         16  CM-OLD-LOF                    PIC XXX.
  2367*        16  CM-LOAN-OFFICER               PIC XXX.
  2368         16  CM-REIN-TABLE                 PIC XXX.
  2369         16  CM-SPECIAL-REIN-CODE          PIC X.
  2370         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2371         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2372         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2373
  2374     12  CM-STATUS-DATA.
  2375         16  CM-ENTRY-STATUS               PIC X.
  2376         16  CM-ENTRY-DT                   PIC XX.
  2377
  2378         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2379         16  CM-LF-CANCEL-DT               PIC XX.
  2380         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2381
  2382         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2383         16  CM-LF-DEATH-DT                PIC XX.
  2384         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2385
  2386         16  CM-LF-CURRENT-STATUS          PIC X.
  2387             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2388                                                'M' '4' '5' '9'.
  2389             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2390             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2391             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2392             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  45
* EL050.cbl
  2393             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2394             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2395             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2396             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2397             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2398             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2399             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2400             88  CM-LF-DECLINED               VALUE 'D'.
  2401             88  CM-LF-VOIDED                 VALUE 'V'.
  2402
  2403         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2404         16  CM-AH-CANCEL-DT               PIC XX.
  2405         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2406
  2407         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2408         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2409         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2410
  2411         16  CM-AH-CURRENT-STATUS          PIC X.
  2412             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2413                                                'M' '4' '5' '9'.
  2414             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2415             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2416             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2417             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2418             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2419             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2420             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2421             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2422             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2423             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2424             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2425             88  CM-AH-DECLINED               VALUE 'D'.
  2426             88  CM-AH-VOIDED                 VALUE 'V'.
  2427
  2428         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2429             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2430             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2431             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2432         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2433
  2434         16  CM-ENTRY-BATCH                PIC X(6).
  2435         16  CM-LF-EXIT-BATCH              PIC X(6).
  2436         16  CM-AH-EXIT-BATCH              PIC X(6).
  2437         16  CM-LAST-MONTH-END             PIC XX.
  2438
  2439     12  CM-NOTE-SW                        PIC X.
  2440         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2441         88  CERT-NOTES-PRESENT               VALUE '1'.
  2442         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2443         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2444         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2445         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2446         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2447         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2448     12  CM-COMP-EXCP-SW                   PIC X.
  2449         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2450         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  46
* EL050.cbl
  2451     12  CM-INSURED-ADDRESS-SW             PIC X.
  2452         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2453         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2454
  2455*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2456     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2457     12  FILLER                            PIC X.
  2458
  2459*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2460     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2461     12  FILLER                            PIC X.
  2462*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2463     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2464
  2465     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2466         88  CERT-ADDED-BATCH                 VALUE ' '.
  2467         88  CERT-ADDED-ONLINE                VALUE '1'.
  2468         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2469         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2470         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2471     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2472         88  CERT-AS-LOADED                   VALUE ' '.
  2473         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2474         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2475         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2476         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2477         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2478         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2479         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2480
  2481     12  CM-ACCOUNT-COMM-PCTS.
  2482         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2483         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2484
  2485     12  CM-USER-FIELD                     PIC X.
  2486     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2487     12  CM-CLP-STATE                      PIC XX.
  2488     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2489     12  CM-USER-RESERVED                  PIC XXX.
  2490     12  FILLER REDEFINES CM-USER-RESERVED.
  2491         16  CM-AH-CLASS-CD                PIC XX.
  2492         16  F                             PIC X.
  2493******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  47
* EL050.cbl
  2495*    COPY ERCMAIL.
  2496******************************************************************
  2497*                                                                *
  2498*                                                                *
  2499*                            ERCMAIL                             *
  2500*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2501*                            VMOD=2.003                          *
  2502*                                                                *
  2503*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2504*                                                                *
  2505*   FILE TYPE = VSAM,KSDS                                        *
  2506*   RECORD SIZE = 374   RECFORM = FIX                            *
  2507*                                                                *
  2508*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2509*   ALTERNATE PATH    = NOT USED                                 *
  2510*                                                                *
  2511*   LOG = YES                                                    *
  2512*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2513******************************************************************
  2514*                   C H A N G E   L O G
  2515*
  2516* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2517*-----------------------------------------------------------------
  2518*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2519* EFFECTIVE    NUMBER
  2520*-----------------------------------------------------------------
  2521* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2522* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2523* 111108                   PEMA  ADD CRED BENE ADDR2
  2524******************************************************************
  2525
  2526 01  MAILING-DATA.
  2527     12  MA-RECORD-ID                      PIC XX.
  2528         88  VALID-MA-ID                       VALUE 'MA'.
  2529
  2530     12  MA-CONTROL-PRIMARY.
  2531         16  MA-COMPANY-CD                 PIC X.
  2532         16  MA-CARRIER                    PIC X.
  2533         16  MA-GROUPING.
  2534             20  MA-GROUPING-PREFIX        PIC XXX.
  2535             20  MA-GROUPING-PRIME         PIC XXX.
  2536         16  MA-STATE                      PIC XX.
  2537         16  MA-ACCOUNT.
  2538             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2539             20  MA-ACCOUNT-PRIME          PIC X(6).
  2540         16  MA-CERT-EFF-DT                PIC XX.
  2541         16  MA-CERT-NO.
  2542             20  MA-CERT-PRIME             PIC X(10).
  2543             20  MA-CERT-SFX               PIC X.
  2544
  2545     12  FILLER                            PIC XX.
  2546
  2547     12  MA-ACCESS-CONTROL.
  2548         16  MA-SOURCE-SYSTEM              PIC XX.
  2549             88  MA-FROM-CREDIT                VALUE 'CR'.
  2550             88  MA-FROM-VSI                   VALUE 'VS'.
  2551             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2552             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  48
* EL050.cbl
  2553         16  MA-RECORD-ADD-DT              PIC XX.
  2554         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2555         16  MA-LAST-MAINT-DT              PIC XX.
  2556         16  MA-LAST-MAINT-BY              PIC XXXX.
  2557         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2558
  2559     12  MA-PROFILE-INFO.
  2560         16  MA-QUALIFY-CODE-1             PIC XX.
  2561         16  MA-QUALIFY-CODE-2             PIC XX.
  2562         16  MA-QUALIFY-CODE-3             PIC XX.
  2563         16  MA-QUALIFY-CODE-4             PIC XX.
  2564         16  MA-QUALIFY-CODE-5             PIC XX.
  2565
  2566         16  MA-INSURED-LAST-NAME          PIC X(15).
  2567         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2568         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2569         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2570         16  MA-INSURED-BIRTH-DT           PIC XX.
  2571         16  MA-INSURED-SEX                PIC X.
  2572             88  MA-SEX-MALE                   VALUE 'M'.
  2573             88  MA-SEX-FEMALE                 VALUE 'F'.
  2574         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2575
  2576         16  MA-ADDRESS-CORRECTED          PIC X.
  2577         16  MA-JOINT-BIRTH-DT             PIC XX.
  2578*        16  FILLER                        PIC X(12).
  2579
  2580         16  MA-ADDRESS-LINE-1             PIC X(30).
  2581         16  MA-ADDRESS-LINE-2             PIC X(30).
  2582         16  MA-CITY-STATE.
  2583             20  MA-CITY                   PIC X(28).
  2584             20  MA-ADDR-STATE             PIC XX.
  2585         16  MA-ZIP.
  2586             20  MA-ZIP-CODE.
  2587                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2588                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2589                 24  FILLER                PIC X(4).
  2590             20  MA-ZIP-PLUS4              PIC X(4).
  2591         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2592             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2593             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2594             20  FILLER                    PIC X(3).
  2595
  2596         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2597
  2598         16  FILLER                        PIC XXX.
  2599*        16  FILLER                        PIC X(10).
  2600
  2601     12  MA-CRED-BENE-INFO.
  2602         16  MA-CRED-BENE-NAME                 PIC X(25).
  2603         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2604         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2605         16  MA-CRED-BENE-CTYST.
  2606             20  MA-CRED-BENE-CITY             PIC X(28).
  2607             20  MA-CRED-BENE-STATE            PIC XX.
  2608         16  MA-CRED-BENE-ZIP.
  2609             20  MA-CB-ZIP-CODE.
  2610                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  49
* EL050.cbl
  2611                     88  MA-CB-CANADIAN-POST-CODE
  2612                                           VALUE 'A' THRU 'Z'.
  2613                 24  FILLER                    PIC X(4).
  2614             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2615         16  MA-CB-CANADIAN-POSTAL-CODE
  2616                            REDEFINES MA-CRED-BENE-ZIP.
  2617             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2618             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2619             20  FILLER                        PIC X(3).
  2620     12  MA-POST-CARD-MAIL-DATA.
  2621         16  MA-MAIL-DATA OCCURS 7.
  2622             20  MA-MAIL-TYPE              PIC X.
  2623                 88  MA-12MO-MAILING           VALUE '1'.
  2624                 88  MA-EXP-MAILING            VALUE '2'.
  2625             20  MA-MAIL-STATUS            PIC X.
  2626                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2627                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2628                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2629             20  MA-MAIL-DATE              PIC XX.
  2630     12  FILLER                            PIC XX.
  2631     12  FILLER                            PIC XX.
  2632*    12  FILLER                            PIC X(30).
  2633******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  50
* EL050.cbl
  2635*    COPY ERCPNDM.
  2636******************************************************************
  2637*                                                                *
  2638*                                                                *
  2639*                            ERCPNDM                             *
  2640*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2641*                            VMOD=2.003                          *
  2642*                                                                *
  2643*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2644*                                                                *
  2645*   FILE TYPE = VSAM,KSDS                                        *
  2646*   RECORD SIZE = 374   RECFORM = FIX                            *
  2647*                                                                *
  2648*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2649*   ALTERNATE PATH    = NOT USED                                 *
  2650*                                                                *
  2651*   LOG = YES                                                    *
  2652*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2653******************************************************************
  2654*                   C H A N G E   L O G
  2655*
  2656* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2657*-----------------------------------------------------------------
  2658*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2659* EFFECTIVE    NUMBER
  2660*-----------------------------------------------------------------
  2661* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2662* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2663* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2664* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  2665******************************************************************
  2666
  2667 01  PENDING-MAILING-DATA.
  2668     12  PM-RECORD-ID                      PIC XX.
  2669         88  VALID-MA-ID                       VALUE 'PM'.
  2670
  2671     12  PM-CONTROL-PRIMARY.
  2672         16  PM-COMPANY-CD                 PIC X.
  2673         16  PM-ENTRY-BATCH                PIC X(6).
  2674         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2675         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2676
  2677     12  FILLER                            PIC X(14).
  2678
  2679     12  PM-ACCESS-CONTROL.
  2680         16  PM-SOURCE-SYSTEM              PIC XX.
  2681             88  PM-FROM-CREDIT                VALUE 'CR'.
  2682             88  PM-FROM-VSI                   VALUE 'VS'.
  2683             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2684             88  PM-FROM-OTHER                 VALUE 'OT'.
  2685         16  PM-RECORD-ADD-DT              PIC XX.
  2686         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2687         16  PM-LAST-MAINT-DT              PIC XX.
  2688         16  PM-LAST-MAINT-BY              PIC XXXX.
  2689         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2690
  2691     12  PM-PROFILE-INFO.
  2692         16  PM-QUALIFY-CODE-1             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  51
* EL050.cbl
  2693         16  PM-QUALIFY-CODE-2             PIC XX.
  2694         16  PM-QUALIFY-CODE-3             PIC XX.
  2695         16  PM-QUALIFY-CODE-4             PIC XX.
  2696         16  PM-QUALIFY-CODE-5             PIC XX.
  2697
  2698         16  PM-INSURED-LAST-NAME          PIC X(15).
  2699         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2700         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2701         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2702         16  PM-INSURED-BIRTH-DT           PIC XX.
  2703         16  PM-INSURED-SEX                PIC X.
  2704             88  PM-SEX-MALE                   VALUE 'M'.
  2705             88  PM-SEX-FEMALE                 VALUE 'F'.
  2706         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2707
  2708         16  PM-ADDRESS-CORRECTED          PIC X.
  2709         16  PM-JOINT-BIRTH-DT             PIC XX.
  2710*        16  FILLER                        PIC X(12).
  2711
  2712         16  PM-ADDRESS-LINE-1             PIC X(30).
  2713         16  PM-ADDRESS-LINE-2             PIC X(30).
  2714         16  PM-CITY-STATE.
  2715             20  PM-CITY                   PIC X(28).
  2716             20  PM-STATE                  PIC XX.
  2717         16  PM-ZIP.
  2718             20  PM-ZIP-CODE.
  2719                 24  PM-ZIP-1              PIC X.
  2720                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2721                 24  FILLER                PIC X(4).
  2722             20  PM-ZIP-PLUS4              PIC X(4).
  2723         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2724             20  PM-CAN-POST1              PIC XXX.
  2725             20  PM-CAN-POST2              PIC XXX.
  2726             20  FILLER                    PIC XXX.
  2727
  2728         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2729         16  pm-city-st-zip-verified       pic x.
  2730         16  FILLER                        PIC XX.
  2731
  2732     12  PM-CRED-BENE-INFO.
  2733         16  PM-CRED-BENE-NAME             PIC X(25).
  2734         16  PM-CRED-BENE-ADDR             PIC X(30).
  2735         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2736         16  PM-CRED-BENE-CTYST.
  2737             20  PM-CRED-BENE-CITY         PIC X(28).
  2738             20  PM-CRED-BENE-STATE        PIC XX.
  2739         16  PM-CRED-BENE-ZIP.
  2740             20  PM-CB-ZIP-CODE.
  2741                 24  PM-CB-ZIP-1           PIC X.
  2742                     88  PM-CB-CANADIAN-POST-CODE
  2743                                  VALUE 'A' THRU 'Z'.
  2744                 24  FILLER                PIC X(4).
  2745             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2746         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2747             20  PM-CB-CAN-POST1           PIC XXX.
  2748             20  PM-CB-CAN-POST2           PIC XXX.
  2749             20  FILLER                    PIC XXX.
  2750     12  PM-POST-CARD-MAIL-DATA.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  52
* EL050.cbl
  2751         16  PM-MAIL-DATA OCCURS 7.
  2752             20  PM-MAIL-TYPE              PIC X.
  2753                 88  PM-12MO-MAILING           VALUE '1'.
  2754                 88  PM-EXP-MAILING            VALUE '2'.
  2755             20  PM-MAIL-STATUS            PIC X.
  2756                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2757                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2758                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2759             20  PM-MAIL-DATE              PIC XX.
  2760     12  FILLER                            PIC XX.
  2761     12  FILLER                            PIC X(12).
  2762*    12  FILLER                            PIC X(30).
  2763
  2764******************************************************************
  2765*                                COPY ERCLOFC.
  2766******************************************************************
  2767*                                                                *
  2768*                                                                *
  2769*                            ERCLOFC                             *
  2770*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2771*                            VMOD=2.003                          *
  2772*                                                                *
  2773*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2774*                                                                *
  2775*   FILE TYPE = VSAM,KSDS                                        *
  2776*   RECORD SIZE = 670   RECFORM = FIX                            *
  2777*                                                                *
  2778*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2779*                                                                *
  2780*   LOG = YES                                                    *
  2781*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2782*                                                                *
  2783******************************************************************
  2784
  2785 01  LOAN-OFFICER-MASTER.
  2786     12  LO-RECORD-ID                PIC XX.
  2787         88  VALID-LO-ID                VALUE 'LO'.
  2788
  2789     12  LO-CONTROL-PRIMARY.
  2790         16  LO-COMPANY-CD           PIC X.
  2791         16  LO-CARRIER              PIC X.
  2792         16  LO-GROUPING.
  2793             20  LO-GROUPING-PREFIX  PIC XXX.
  2794             20  LO-GROUPING-PRIME   PIC XXX.
  2795         16  LO-STATE                PIC XX.
  2796         16  LO-ACCOUNT.
  2797             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2798             20  LO-ACCOUNT-PRIME    PIC X(6).
  2799         16  LO-OFFICER-CODE         PIC X(5).
  2800
  2801     12  LO-OFFICER-NAME             PIC X(30).
  2802
  2803     12  LO-LAST-MAINT-DT            PIC XX.
  2804     12  LO-LAST-USER                PIC X(4).
  2805     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2806
  2807     12  LO-COMP-CONTROL             PIC X.
  2808             88  LO-SHOW-COMP           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  53
* EL050.cbl
  2809             88  LO-SUPPRESS-COMP       VALUE 'N'.
  2810     12  LO-DETAIL-CONTROL           PIC X.
  2811             88  LO-PRINT-DETAIL        VALUE 'D'.
  2812             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2813
  2814     12  LO-SV-CARRIER               PIC X.
  2815     12  LO-SV-GROUPING              PIC X(6).
  2816     12  LO-SV-STATE                 PIC XX.
  2817
  2818     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2819     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2820
  2821     12  LO-OFFICER-INFO.
  2822         16  FILLER OCCURS 12 TIMES.
  2823             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2824             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2825             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2826             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2827             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2828             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2829             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2830             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2831     12  FILLER                      PIC X(198).
  2832******************************************************************
  2833*                                COPY ERCPDEF.
  2834******************************************************************
  2835*                                                                *
  2836*                                                                *
  2837*                            ERCPDEF.                            *
  2838*                                                                *
  2839*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2840*                                                                *
  2841*    FILE TYPE = VSAM,KSDS                                       *
  2842*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2843*                                                                *
  2844*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2845*                                                                *
  2846*    LOG = YES                                                   *
  2847*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2848******************************************************************
  2849*                   C H A N G E   L O G
  2850*
  2851* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2852*-----------------------------------------------------------------
  2853*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2854* EFFECTIVE    NUMBER
  2855*-----------------------------------------------------------------
  2856* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2857* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2858* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  2859******************************************************************
  2860 01  PRODUCT-MASTER.
  2861    12  PD-RECORD-ID                 PIC X(02).
  2862        88  VALID-PD-ID                  VALUE 'PD'.
  2863    12  PD-CONTROL-PRIMARY.
  2864        16  PD-COMPANY-CD            PIC X.
  2865        16  PD-STATE                 PIC XX.
  2866        16  PD-PRODUCT-CD            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  54
* EL050.cbl
  2867        16  PD-FILLER                PIC X(7).
  2868        16  PD-BEN-TYPE              PIC X.
  2869        16  PD-BEN-CODE              PIC XX.
  2870        16  PD-PROD-EXP-DT           PIC XX.
  2871    12  FILLER                       PIC X(50).
  2872    12  PD-PRODUCT-DATA OCCURS 8.
  2873        16  PD-PROD-CODE             PIC X.
  2874            88  PD-PROD-LIFE           VALUE 'L'.
  2875            88  PD-PROD-PROP           VALUE 'P'.
  2876            88  PD-PROD-AH             VALUE 'A'.
  2877            88  PD-PROD-IU             VALUE 'I'.
  2878            88  PD-PROD-GAP            VALUE 'G'.
  2879            88  PD-PROD-FAML           VALUE 'F'.
  2880        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2881        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2882        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2883        16  PD-MAX-TERM              PIC S999        COMP-3.
  2884        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2885        16  FILLER                   PIC X.
  2886        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2887        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2888        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2889        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2890        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2891        16  PD-REC-CRIT-PERIOD       PIC 99.
  2892        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2893            20  PD-RECURRING-YN      PIC X.
  2894            20  FILLER               PIC X.
  2895        16  PD-RTW-MOS               PIC 99.
  2896        16  PD-MAX-EXTENSION         PIC 99.
  2897        16  pd-ben-pct               pic sv999 comp-3.
  2898*       16  FILLER                   PIC XX.
  2899    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2900    12  PD-TERM-LIMITS OCCURS 15.
  2901        16  PD-LOW-TERM              PIC S999        COMP-3.
  2902        16  PD-HI-TERM               PIC S999        COMP-3.
  2903*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2904    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2905        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2906        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2907    12  PD-EARN-FACTORS.
  2908        16  FILLER OCCURS 15.
  2909            20  FILLER OCCURS 15.
  2910                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2911    12  PD-PRODUCT-DESC              PIC X(80).
  2912    12  PD-TRUNCATED                 PIC X.
  2913    12  FILLER                       PIC X(59).
  2914    12  PD-MAINT-INFORMATION.
  2915        16  PD-LAST-MAINT-DT         PIC X(02).
  2916        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2917        16  PD-LAST-MAINT-BY         PIC X(04).
  2918*                                COPY ELCSTATE.
  2919******************************************************************
  2920*                                                                *
  2921*                                                                *
  2922*                            ELCSTATE.                           *
  2923*                                                                *
  2924*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  55
* EL050.cbl
  2925*                                                                *
  2926*   FILE TYPE = VSAM,KSDS                                        *
  2927*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2928*                                                                *
  2929*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2930*       ALTERNATE INDEX = NONE                                   *
  2931*                                                                *
  2932*   LOG = YES                                                    *
  2933*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2934******************************************************************
  2935*                   C H A N G E   L O G
  2936*
  2937* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2938*-----------------------------------------------------------------
  2939*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2940* EFFECTIVE    NUMBER
  2941*-----------------------------------------------------------------
  2942* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  2943******************************************************************
  2944*
  2945 01  STATE-FILE.
  2946     12  SF-RECORD-ID                       PIC XX.
  2947         88  VALID-CF-ID                        VALUE 'SF'.
  2948     12  SF-CONTROL-PRIMARY.
  2949         16  SF-COMPANY-ID                  PIC XXX.
  2950         16  SF-CARRIER-CODE                PIC X.
  2951         16  SF-GROUPING                    PIC X(6).
  2952         16  SF-STATE-CODE                  PIC XX.
  2953         16  SF-EXPIRE-DATE                 PIC 9(8).
  2954****************************************************************
  2955*             STATE CONTROLS
  2956****************************************************************
  2957     12  SF-LAST-MAINT-DT                   PIC XX.
  2958     12  SF-LAST-MAINT-BY                   PIC X(4).
  2959     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2960     12  SF-STATE-RT-CONTROLS.
  2961         16  SF-ST-RT-CALC                  PIC X.
  2962     12  SF-ST-TAX-CONTROLS.
  2963         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2964         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2965         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2966     12  SF-ST-REFUND-OPTIONS.
  2967         16  SF-ST-RF-LR-CALC               PIC X.
  2968         16  SF-ST-RF-LL-CALC               PIC X.
  2969         16  SF-ST-RF-LN-CALC               PIC X.
  2970         16  SF-ST-RF-AH-CALC               PIC X.
  2971         16  SF-ST-RF-CP-CALC               PIC X.
  2972     12  SF-ST-UNEARN-PREM-OPTIONS.
  2973         16  SF-ST-LUEP-R78                 PIC X.
  2974         16  SF-ST-LUEP-PRO                 PIC X.
  2975         16  SF-ST-LUEP-ST                  PIC X.
  2976         16  SF-ST-LUEP-DOM                 PIC X.
  2977         16  SF-ST-AUEP-R78                 PIC X.
  2978         16  SF-ST-AUEP-PRO                 PIC X.
  2979         16  SF-ST-AUEP-ST                  PIC X.
  2980         16  SF-ST-AUEP-DOM                 PIC X.
  2981         16  SF-ST-CUEP-R78                 PIC X.
  2982         16  SF-ST-CUEP-PRO                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  56
* EL050.cbl
  2983         16  SF-ST-CUEP-ST                  PIC X.
  2984         16  SF-ST-CUEP-DOM                 PIC X.
  2985     12  SF-ST-EARN-PREM-OPTIONS.
  2986         16  SF-ST-LEP-R78                  PIC X.
  2987         16  SF-ST-LEP-PRO                  PIC X.
  2988         16  SF-ST-LEP-ST                   PIC X.
  2989         16  SF-ST-LEP-DOM                  PIC X.
  2990         16  SF-ST-AEP-R78                  PIC X.
  2991         16  SF-ST-AEP-PRO                  PIC X.
  2992         16  SF-ST-AEP-ST                   PIC X.
  2993         16  SF-ST-AEP-DOM                  PIC X.
  2994         16  SF-ST-CEP-R78                  PIC X.
  2995         16  SF-ST-CEP-PRO                  PIC X.
  2996         16  SF-ST-CEP-ST                   PIC X.
  2997         16  SF-ST-CEP-DOM                  PIC X.
  2998     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  57
* EL050.cbl
  3000*    COPY ELCCRTT.
  3001******************************************************************
  3002*                                                                *
  3003*                            ELCCRTT.                            *
  3004*                                                                *
  3005*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3006*                                                                *
  3007*   FILE TYPE = VSAM,KSDS                                        *
  3008*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3009*                                                                *
  3010*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3011*                                                                *
  3012*   LOG = YES                                                    *
  3013*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3014******************************************************************
  3015*                   C H A N G E   L O G
  3016*
  3017* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3018*-----------------------------------------------------------------
  3019*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3020* EFFECTIVE    NUMBER
  3021*-----------------------------------------------------------------
  3022* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3023* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3024* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3025* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3026* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3027* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3028* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3029* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  3030* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  3031******************************************************************
  3032
  3033 01  CERTIFICATE-TRAILERS.
  3034     12  CS-RECORD-ID                      PIC XX.
  3035         88  VALID-CS-ID                      VALUE 'CS'.
  3036
  3037     12  CS-CONTROL-PRIMARY.
  3038         16  CS-COMPANY-CD                 PIC X.
  3039         16  CS-CARRIER                    PIC X.
  3040         16  CS-GROUPING                   PIC X(6).
  3041         16  CS-STATE                      PIC XX.
  3042         16  CS-ACCOUNT                    PIC X(10).
  3043         16  CS-CERT-EFF-DT                PIC XX.
  3044         16  CS-CERT-NO.
  3045             20  CS-CERT-PRIME             PIC X(10).
  3046             20  CS-CERT-SFX               PIC X.
  3047         16  CS-TRAILER-TYPE               PIC X.
  3048             88  COMM-TRLR           VALUE 'A'.
  3049             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3050             88  CERT-DATA-TRLR      VALUE 'C'.
  3051
  3052     12  CS-DATA-AREA                      PIC X(516).
  3053
  3054     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  3055         16  CS-BANK-COMMISSION-AREA.
  3056             20  CS-BANK-COMMS       OCCURS 10.
  3057                 24  CS-AGT                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  58
* EL050.cbl
  3058                 24  CS-COM-TYP            PIC X.
  3059                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3060                 24  CS-RECALC-LV-INDIC    PIC X.
  3061                 24  FILLER                PIC X(10).
  3062         16  FILLER                        PIC X(256).
  3063
  3064     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3065****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3066         16  CS-MB-CLAIM-DATA OCCURS 24.
  3067             20  CS-CLAIM-NO               PIC X(7).
  3068             20  CS-CLAIM-TYPE             PIC X.
  3069                 88  CS-AH-CLM               VALUE 'A'.
  3070                 88  CS-IU-CLM               VALUE 'I'.
  3071                 88  CS-GP-CLM               VALUE 'G'.
  3072                 88  CS-LF-CLM               VALUE 'L'.
  3073                 88  CS-PR-CLM               VALUE 'P'.
  3074                 88  CS-FL-CLM               VALUE 'F'.
  3075             20  CS-INSURED-TYPE           PIC X.
  3076                 88  CS-PRIM-INSURED          VALUE 'P'.
  3077                 88  CS-CO-BORROWER           VALUE 'C'.
  3078             20  CS-BENEFIT-PERIOD         PIC 99.
  3079             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3080             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3081             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3082         16  FILLER                        PIC X(12).
  3083     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3084         16  CS-VIN-NUMBER                 PIC X(17).
  3085         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3086         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3087         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3088         16  cs-agent-name.
  3089             20  cs-agent-fname            pic x(20).
  3090             20  cs-agent-mi               pic x.
  3091             20  cs-agent-lname            pic x(25).
  3092         16  cs-license-no                 pic x(15).
  3093         16  cs-npn-number                 pic x(10).
  3094         16  cs-agent-edit-status          pic x.
  3095             88  cs-ae-refer-to-manager      value 'M'.
  3096             88  cs-ae-cover-sheet           value 'C'.
  3097             88  cs-ae-sig-form              value 'S'.
  3098             88  cs-ae-verified              value 'V'.
  3099             88  cs-unidentified-signature   value 'U'.
  3100             88  cs-cert-returned            value 'R'.
  3101             88  cs-accept-no-commission     value 'N'.
  3102         16  cs-year                       pic 9999.
  3103         16  cs-make                       pic x(20).
  3104         16  cs-model                      pic x(20).
  3105         16  cs-future                     pic x(20).
  3106         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3107         16  FILLER                        PIC X(356). *> was 420
  3108*        16  FILLER                        PIC X(496).
  3109*    COPY ELCCRTO.
  3110******************************************************************
  3111*                                                                *
  3112*                            ELCCRTO.                            *
  3113*                                                                *
  3114*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  3115*                                                                *
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  59
* EL050.cbl
  3116*   FILE TYPE = VSAM,KSDS                                        *
  3117*   RECORD SIZE = 524  RECFORM = FIXED                           *
  3118*                                                                *
  3119*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  3120*                                                                *
  3121*   LOG = YES                                                    *
  3122*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3123******************************************************************
  3124*                   C H A N G E   L O G
  3125*
  3126* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3127*-----------------------------------------------------------------
  3128*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3129* EFFECTIVE    NUMBER
  3130*-----------------------------------------------------------------
  3131* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  3132* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  3133* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  3134* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3135* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  3136******************************************************************
  3137 01  ORIGINAL-CERTIFICATE.
  3138     12  OC-RECORD-ID                      PIC XX.
  3139         88  VALID-OC-ID                      VALUE 'OC'.
  3140     12  OC-CONTROL-PRIMARY.
  3141         16  OC-COMPANY-CD                 PIC X.
  3142         16  OC-CARRIER                    PIC X.
  3143         16  OC-GROUPING                   PIC X(6).
  3144         16  OC-STATE                      PIC XX.
  3145         16  OC-ACCOUNT                    PIC X(10).
  3146         16  OC-CERT-EFF-DT                PIC XX.
  3147         16  OC-CERT-NO.
  3148             20  OC-CERT-PRIME             PIC X(10).
  3149             20  OC-CERT-SFX               PIC X.
  3150         16  OC-RECORD-TYPE                PIC X.
  3151         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3152     12  OC-LAST-MAINT-DT                  PIC XX.
  3153     12  OC-LAST-MAINT-BY                  PIC X(4).
  3154     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3155     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3156     12  FILLER                            PIC X(49).
  3157     12  OC-ORIG-REC.
  3158         16  OC-INS-LAST-NAME              PIC X(15).
  3159         16  OC-INS-FIRST-NAME             PIC X(10).
  3160         16  OC-INS-MIDDLE-INIT            PIC X.
  3161         16  OC-INS-AGE                    PIC S999     COMP-3.
  3162         16  OC-JNT-LAST-NAME              PIC X(15).
  3163         16  OC-JNT-FIRST-NAME             PIC X(10).
  3164         16  OC-JNT-MIDDLE-INIT            PIC X.
  3165         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3166         16  OC-LF-BENCD                   PIC XX.
  3167         16  OC-LF-TERM                    PIC S999      COMP-3.
  3168         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3169         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3170         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3171         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3172         16  OC-LF-EXP-DT                  PIC XX.
  3173         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  60
* EL050.cbl
  3174         16  OC-LF-CANCEL-DT               PIC XX.
  3175         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3176         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3177         16  OC-AH-BENCD                   PIC XX.
  3178         16  OC-AH-TERM                    PIC S999      COMP-3.
  3179         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3180         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3181         16  OC-AH-EXP-DT                  PIC XX.
  3182         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3183         16  OC-AH-CP                      PIC 99.
  3184         16  OC-AH-CANCEL-DT               PIC XX.
  3185         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3186         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3187         16  OC-CRED-BENE-NAME             PIC X(25).
  3188         16  OC-1ST-PMT-DT                 PIC XX.
  3189         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3190         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3191         16  OC-ISSUE-TRAN-IND             PIC X.
  3192         16  OC-CANCEL-TRAN-IND            PIC X.
  3193         16  FILLER                        PIC X(211).
  3194
  3195     12  FILLER                            PIC X(50).
  3196******************************************************************
  3197
  3198*    COPY ELCDATE.
  3199******************************************************************
  3200*                                                                *
  3201*                                                                *
  3202*                            ELCDATE.                            *
  3203*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3204*                            VMOD=2.003
  3205*                                                                *
  3206*                                                                *
  3207*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3208*                 LENGTH = 200                                   *
  3209******************************************************************
  3210
  3211 01  DATE-CONVERSION-DATA.
  3212     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3213     12  DC-OPTION-CODE                PIC X.
  3214         88  BIN-TO-GREG                VALUE ' '.
  3215         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3216         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3217         88  YMD-GREG-TO-BIN            VALUE '3'.
  3218         88  MDY-GREG-TO-BIN            VALUE '4'.
  3219         88  JULIAN-TO-BIN              VALUE '5'.
  3220         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3221         88  FIND-CENTURY               VALUE '7'.
  3222         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3223         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3224         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3225         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3226         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3227         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3228         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3229         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3230         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3231         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  61
* EL050.cbl
  3232         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3233         88  BIN-3-TO-GREG              VALUE 'I'.
  3234         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3235         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3236         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3237         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3238         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3239         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3240         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3241         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3242         88  THREE-CHARACTER-BIN
  3243                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3244         88  GREGORIAN-TO-BIN
  3245                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3246         88  BIN-TO-GREGORIAN
  3247                  VALUES ' ' '1' 'I' '8' 'G'.
  3248         88  JULIAN-TO-BINARY
  3249                  VALUES '5' 'C' 'E' 'F'.
  3250     12  DC-ERROR-CODE                 PIC X.
  3251         88  NO-CONVERSION-ERROR        VALUE ' '.
  3252         88  DATE-CONVERSION-ERROR
  3253                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3254         88  DATE-IS-ZERO               VALUE '1'.
  3255         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3256         88  DATE-IS-INVALID            VALUE '3'.
  3257         88  DATE1-GREATER-DATE2        VALUE '4'.
  3258         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3259         88  DATE-INVALID-OPTION        VALUE '9'.
  3260         88  INVALID-CENTURY            VALUE 'A'.
  3261         88  ONLY-CENTURY               VALUE 'B'.
  3262         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3263         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3264     12  DC-END-OF-MONTH               PIC X.
  3265         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3266     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3267         88  USE-NORMAL-PROCESS         VALUE ' '.
  3268         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3269         88  ADJUST-UP-100-YRS          VALUE '2'.
  3270     12  FILLER                        PIC X.
  3271     12  DC-CONVERSION-DATES.
  3272         16  DC-BIN-DATE-1             PIC XX.
  3273         16  DC-BIN-DATE-2             PIC XX.
  3274         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3275         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3276                       DC-GREG-DATE-1-EDIT.
  3277             20  DC-EDIT1-MONTH        PIC 99.
  3278             20  SLASH1-1              PIC X.
  3279             20  DC-EDIT1-DAY          PIC 99.
  3280             20  SLASH1-2              PIC X.
  3281             20  DC-EDIT1-YEAR         PIC 99.
  3282         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3283         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3284                     DC-GREG-DATE-2-EDIT.
  3285             20  DC-EDIT2-MONTH        PIC 99.
  3286             20  SLASH2-1              PIC X.
  3287             20  DC-EDIT2-DAY          PIC 99.
  3288             20  SLASH2-2              PIC X.
  3289             20  DC-EDIT2-YEAR         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  62
* EL050.cbl
  3290         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3291         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3292                     DC-GREG-DATE-1-YMD.
  3293             20  DC-YMD-YEAR           PIC 99.
  3294             20  DC-YMD-MONTH          PIC 99.
  3295             20  DC-YMD-DAY            PIC 99.
  3296         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3297         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3298                      DC-GREG-DATE-1-MDY.
  3299             20  DC-MDY-MONTH          PIC 99.
  3300             20  DC-MDY-DAY            PIC 99.
  3301             20  DC-MDY-YEAR           PIC 99.
  3302         16  DC-GREG-DATE-1-ALPHA.
  3303             20  DC-ALPHA-MONTH        PIC X(10).
  3304             20  DC-ALPHA-DAY          PIC 99.
  3305             20  FILLER                PIC XX.
  3306             20  DC-ALPHA-CENTURY.
  3307                 24 DC-ALPHA-CEN-N     PIC 99.
  3308             20  DC-ALPHA-YEAR         PIC 99.
  3309         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3310         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3311         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3312         16  DC-JULIAN-DATE            PIC 9(05).
  3313         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3314                                       PIC 9(05).
  3315         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3316             20  DC-JULIAN-YEAR        PIC 99.
  3317             20  DC-JULIAN-DAYS        PIC 999.
  3318         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3319         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3320         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3321     12  DATE-CONVERSION-VARIBLES.
  3322         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3323         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3324             20  FILLER                PIC 9(3).
  3325             20  HOLD-CEN-1-CCYY.
  3326                 24  HOLD-CEN-1-CC     PIC 99.
  3327                 24  HOLD-CEN-1-YY     PIC 99.
  3328             20  HOLD-CEN-1-MO         PIC 99.
  3329             20  HOLD-CEN-1-DA         PIC 99.
  3330         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3331             20  HOLD-CEN-1-R-MO       PIC 99.
  3332             20  HOLD-CEN-1-R-DA       PIC 99.
  3333             20  HOLD-CEN-1-R-CCYY.
  3334                 24  HOLD-CEN-1-R-CC   PIC 99.
  3335                 24  HOLD-CEN-1-R-YY   PIC 99.
  3336             20  FILLER                PIC 9(3).
  3337         16  HOLD-CENTURY-1-X.
  3338             20  FILLER                PIC X(3)  VALUE SPACES.
  3339             20  HOLD-CEN-1-X-CCYY.
  3340                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3341                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3342             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3343             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3344         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3345             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3346             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3347             20  HOLD-CEN-1-R-X-CCYY.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  63
* EL050.cbl
  3348                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3349                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3350             20  FILLER                PIC XXX.
  3351         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3352         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3353         16  DC-JULIAN-DATE-1          PIC 9(07).
  3354         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3355             20  DC-JULIAN-1-CCYY.
  3356                 24  DC-JULIAN-1-CC    PIC 99.
  3357                 24  DC-JULIAN-1-YR    PIC 99.
  3358             20  DC-JULIAN-DA-1        PIC 999.
  3359         16  DC-JULIAN-DATE-2          PIC 9(07).
  3360         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3361             20  DC-JULIAN-2-CCYY.
  3362                 24  DC-JULIAN-2-CC    PIC 99.
  3363                 24  DC-JULIAN-2-YR    PIC 99.
  3364             20  DC-JULIAN-DA-2        PIC 999.
  3365         16  DC-GREG-DATE-A-EDIT.
  3366             20  DC-EDITA-MONTH        PIC 99.
  3367             20  SLASHA-1              PIC X VALUE '/'.
  3368             20  DC-EDITA-DAY          PIC 99.
  3369             20  SLASHA-2              PIC X VALUE '/'.
  3370             20  DC-EDITA-CCYY.
  3371                 24  DC-EDITA-CENT     PIC 99.
  3372                 24  DC-EDITA-YEAR     PIC 99.
  3373         16  DC-GREG-DATE-B-EDIT.
  3374             20  DC-EDITB-MONTH        PIC 99.
  3375             20  SLASHB-1              PIC X VALUE '/'.
  3376             20  DC-EDITB-DAY          PIC 99.
  3377             20  SLASHB-2              PIC X VALUE '/'.
  3378             20  DC-EDITB-CCYY.
  3379                 24  DC-EDITB-CENT     PIC 99.
  3380                 24  DC-EDITB-YEAR     PIC 99.
  3381         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3382         16  DC-GREG-DATE-CYMD-R REDEFINES
  3383                              DC-GREG-DATE-CYMD.
  3384             20  DC-CYMD-CEN           PIC 99.
  3385             20  DC-CYMD-YEAR          PIC 99.
  3386             20  DC-CYMD-MONTH         PIC 99.
  3387             20  DC-CYMD-DAY           PIC 99.
  3388         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3389         16  DC-GREG-DATE-MDCY-R REDEFINES
  3390                              DC-GREG-DATE-MDCY.
  3391             20  DC-MDCY-MONTH         PIC 99.
  3392             20  DC-MDCY-DAY           PIC 99.
  3393             20  DC-MDCY-CEN           PIC 99.
  3394             20  DC-MDCY-YEAR          PIC 99.
  3395    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3396        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3397    12  DC-EL310-DATE                  PIC X(21).
  3398    12  FILLER                         PIC X(28).
  3399
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  64
* EL050.cbl
  3401*    COPY ELCCALC.
  3402******************************************************************
  3403*                                                                *
  3404*                           ELCCALC.                            *
  3405*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3406*                            VMOD=2.025                          *
  3407*                                                                *
  3408*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3409*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3410*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3411*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3412*                                                                *
  3413*  PASSED TO ELRTRM                                              *
  3414*  -----------------                                             *
  3415*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3416*  ORIGINAL TERM                                                 *
  3417*  BEGINNING DATE                                                *
  3418*  ENDING DATE                                                   *
  3419*  COMPANY I.D.                                                  *
  3420*  ACCOUNT MASTER USER FIELD                                     *
  3421*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3422*  FREE LOOK DAYS                                                *
  3423*                                                                *
  3424*  RETURNED FROM ELRTRM                                          *
  3425*  ---------------------                                         *
  3426*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3427*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3428*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3429*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3430*----------------------------------------------------------------*
  3431*  PASSED TO ELRAMT                                              *
  3432*  ----------------                                              *
  3433*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3434*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3435*  ORIGINAL AMOUNT                                               *
  3436*  ALTERNATE BENEFIT (BALLON)                                    *
  3437*  A.P.R. - NET PAY ONLY                                         *
  3438*  METHOD
  3439*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3440*  COMPANY I.D.                                                  *
  3441*  BENEFIT TYPE                                                  *
  3442*                                                                *
  3443*  RETURNED FROM ELRAMT                                          *
  3444*  --------------------                                          *
  3445*  REMAINING AMOUNT 1 - CURRENT                                  *
  3446*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3447*  REMAINING AMOUNT FACTOR
  3448*----------------------------------------------------------------*
  3449*  PASSED TO ELRESV                                              *
  3450*  -----------------                                             *
  3451*  CERTIFICATE EFFECTIVE DATE                                    *
  3452*  VALUATION DATE                                                *
  3453*  PAID THRU DATE                                                *
  3454*  BENEFIT                                                       *
  3455*  INCURRED DATE                                                 *
  3456*  REPORTED DATE                                                 *
  3457*  ISSUE AGE                                                     *
  3458*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  65
* EL050.cbl
  3459*  CDT PERCENT                                                   *
  3460*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3461* *CLAIM TYPE (LIFE, A/H)                                        *
  3462* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3463* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3464*                                                                *
  3465*  RETURNED FROM ELRESV                                          *
  3466*  --------------------                                          *
  3467*  CDT TABLE USED                                                *
  3468*  CDT FACTOR USED                                               *
  3469*  PAY TO CURRENT RESERVE                                        *
  3470*  I.B.N.R. - A/H ONLY                                           *
  3471*  FUTURE (ACCRUED) AH ONLY                                      *
  3472*----------------------------------------------------------------*
  3473*  PASSED TO ELRATE                                              *
  3474*  ----------------                                              *
  3475*  CERT ISSUE DATE                                               *
  3476*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3477*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3478*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3479*  STATE CODE (CLIENT DEFINED)                                   *
  3480*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3481*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3482*  DEVIATION CODE                                                *
  3483*  ISSUE AGE                                                     *
  3484*  ORIGINAL BENEFIT AMOUNT                                       *
  3485*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3486*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3487*  BENEFIT KIND (LIFE OR A/H)                                    *
  3488*  A.P.R.                                                        *
  3489*  METHOD
  3490*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3491*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3492*  COMPANY I.D. (3 CHARACTER)                                    *
  3493*  BENEFIT CODE                                                  *
  3494*  BENEFIT OVERRIDE CODE                                         *
  3495*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3496*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3497*  JOINT INDICATOR (CSL ONLY)                                    *
  3498*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3499*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3500*                                                                *
  3501*  RETURNED FROM ELRATE                                          *
  3502*  --------------------                                          *
  3503*  CALCULATED PREMIUM                                            *
  3504*  PREMIUM RATE                                                  *
  3505*  MORTALITY CODE                                                *
  3506*  MAX ATTAINED AGE                                              *
  3507*  MAX AGE                                                       *
  3508*  MAX TERM                                                      *
  3509*  MAX MONTHLY BENEFIT                                           *
  3510*  MAX TOTAL BENIFIT                                             *
  3511*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3512*----------------------------------------------------------------*
  3513*  PASSED TO ELRFND                                              *
  3514*  ----------------                                              *
  3515*  CERT ISSUE DATE                                               *
  3516*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  66
* EL050.cbl
  3517*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3518*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3519*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3520*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3521*  STATE CODE (CLIENT DEFINED)                                   *
  3522*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3523*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3524*  DEVIATION CODE                                                *
  3525*  ISSUE AGE                                                     *
  3526*  ORIGINAL BENEFIT AMOUNT                                       *
  3527*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3528*  PROCESS TYPE (CANCEL)                                         *
  3529*  BENEFIT KIND (LIFE OR A/H)                                    *
  3530*  A.P.R.                                                        *
  3531*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3532*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3533*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3534*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3535*  COMPANY I.D. (3 CHARACTER)                                    *
  3536*  BENEFIT CODE                                                  *
  3537*  BENEFIT OVERRIDE CODE                                         *
  3538*                                                                *
  3539*  RETURNED FROM ELRFND                                          *
  3540*  --------------------                                          *
  3541*  CALCULATED REFUND                                             *
  3542*----------------------------------------------------------------*
  3543*  PASSED TO ELEARN                                              *
  3544*  ----------------                                              *
  3545*  CERT ISSUE DATE                                               *
  3546*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3547*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3548*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3549*  STATE CODE (CLIENT DEFINED)                                   *
  3550*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3551*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3552*  DEVIATION CODE                                                *
  3553*  ISSUE AGE                                                     *
  3554*  ORIGINAL BENEFIT AMOUNT                                       *
  3555*  BENEFIT KIND (LIFE OR A/H)                                    *
  3556*  A.P.R.                                                        *
  3557*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3558*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3559*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3560*  COMPANY I.D. (3 CHARACTER)                                    *
  3561*  BENEFIT CODE                                                  *
  3562*  BENEFIT OVERRIDE CODE                                         *
  3563*                                                                *
  3564*  RETURNED FROM ELEARN                                          *
  3565*  --------------------                                          *
  3566*  INDICATED  EARNINGS                                           *
  3567*----------------------------------------------------------------*
  3568*                 LENGTH = 450                                   *
  3569*                                                                *
  3570******************************************************************
  3571******************************************************************
  3572*                   C H A N G E   L O G
  3573*
  3574* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  67
* EL050.cbl
  3575*-----------------------------------------------------------------
  3576*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3577* EFFECTIVE    NUMBER
  3578*-----------------------------------------------------------------
  3579* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3580* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3581* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3582* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3583* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3584* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3585* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3586* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3587* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3588* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3589* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3590******************************************************************
  3591
  3592 01  CALCULATION-PASS-AREA.
  3593     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3594                                     COMP.
  3595
  3596     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3597       88  NO-CP-ERROR                             VALUE ZERO.
  3598       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3599                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3600       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3601       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3602       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3603       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3604       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3605       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3606       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3607       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3608       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3609       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3610       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3611       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3612       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3613       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3614       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3615       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3616       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3617
  3618     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3619       88  NO-CP-ERROR-2                           VALUE ZERO.
  3620***********************  INPUT AREAS ****************************
  3621
  3622     12  CP-CALCULATION-AREA.
  3623         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3624         16  CP-CERT-EFF-DT        PIC XX.
  3625         16  CP-VALUATION-DT       PIC XX.
  3626         16  CP-PAID-THRU-DT       PIC XX.
  3627         16  CP-BENEFIT-TYPE       PIC X.
  3628           88  CP-AH                               VALUE 'A' 'D'
  3629                                                   'I' 'U'.
  3630           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3631           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3632         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  68
* EL050.cbl
  3633         16  CP-REPORTED-DT        PIC XX.
  3634         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3635         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3636         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3637                                     COMP-3.
  3638         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3639                                     COMP-3.
  3640         16  CP-CDT-METHOD         PIC X.
  3641           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3642           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3643           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3644         16  CP-CLAIM-TYPE         PIC X.
  3645           88  CP-AH-CLAIM                         VALUE 'A'.
  3646           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3647         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3648                                     COMP-3.
  3649         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3650                                     COMP-3.
  3651         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3652                                     COMP-3.
  3653         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3654                                     COMP-3.
  3655         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3656                                     COMP-3.
  3657         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3658                                     COMP-3.
  3659         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3660                                     COMP-3.
  3661         16  CP-REM-TERM-METHOD    PIC X.
  3662           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3663           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3664           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3665           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3666           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3667           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3668           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3669         16  CP-EARNING-METHOD     PIC X.
  3670           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3671           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3672           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3673           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3674           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3675           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3676           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3677           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3678           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3679           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3680           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3681           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3682           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3683           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3684         16  CP-PROCESS-TYPE       PIC X.
  3685           88  CP-CLAIM                            VALUE '1'.
  3686           88  CP-CANCEL                           VALUE '2'.
  3687           88  CP-ISSUE                            VALUE '3'.
  3688         16  CP-SPECIAL-CALC-CD    PIC X.
  3689           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3690           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  69
* EL050.cbl
  3691           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3692           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3693           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3694           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3695           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3696           88  CP-FARM-PLAN                    VALUE 'F'.
  3697           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3698           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3699           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3700           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3701           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3702           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3703           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3704           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3705           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3706           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3707                                                     'W' 'X'.
  3708           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3709           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3710           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3711           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3712           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3713           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3714           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3715           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3716           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3717           88  CP-CSL-METH-1                   VALUE '5'.
  3718           88  CP-CSL-METH-2                   VALUE '6'.
  3719           88  CP-CSL-METH-3                   VALUE '7'.
  3720           88  CP-CSL-METH-4                   VALUE '8'.
  3721
  3722         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3723                                     COMP-3.
  3724         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3725         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3726         16  CP-STATE              PIC XX          VALUE SPACE.
  3727         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3728         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3729           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3730               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3731         16  CP-R78-OPTION         PIC X.
  3732           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3733           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3734
  3735         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3736         16  CP-IBNR-RESERVE-SW    PIC X.
  3737         16  CP-CLAIM-STATUS       PIC X.
  3738         16  CP-RATE-FILE          PIC X.
  3739         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3740                                     COMP-3.
  3741
  3742         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3743         16  CP-AH-OVERRIDE-CODE   PIC X.
  3744
  3745         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3746                                     COMP-3.
  3747         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3748                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  70
* EL050.cbl
  3749         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3750                                     COMP-3.
  3751         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3752                                     COMP-3.
  3753         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3754                                     COMP-3.
  3755         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3756                                  PIC S9(7)V99 COMP-3.
  3757
  3758         16  CP-PAID-FROM-DATE     PIC X(02).
  3759         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3760         16  CP-EXT-DAYS-CALC      PIC X.
  3761           88  CP-EXT-NO-CHG                   VALUE ' '.
  3762           88  CP-EXT-CHG-LF                   VALUE '1'.
  3763           88  CP-EXT-CHG-AH                   VALUE '2'.
  3764           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3765         16  CP-DOMICILE-STATE     PIC XX.
  3766         16  CP-CARRIER            PIC X.
  3767         16  CP-REIN-FLAG          PIC X.
  3768         16  CP-REM-TRM-CALC-OPTION PIC X.
  3769           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3770                      '2' '3' '4' '5'.
  3771           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3772           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3773           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3774           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3775           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3776           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3777           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3778           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3779         16  CP-SIG-SWITCH         PIC X.
  3780         16  CP-RATING-METHOD      PIC X.
  3781           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3782           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3783           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3784           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3785           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3786           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3787           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3788           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3789           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3790         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3791                                     COMP-3.
  3792         16  CP-BEN-CATEGORY       PIC X.
  3793         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3794         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3795                                   PIC S99V9(5) COMP-3.
  3796         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3797         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3798                                   PIC S99V9(5) COMP-3.
  3799         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3800         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3801         16  CP-EXPIRE-DT          PIC XX.
  3802         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3803         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3804         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3805         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3806         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  71
* EL050.cbl
  3807             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3808             88  CP-CALC-CLP              VALUE 'C'.
  3809         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3810         16  CP-CANCEL-REASON      PIC X.
  3811         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3812         16  CP-PMT-MODE           PIC X.
  3813         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3814         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3815         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3816         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3817         16  FILLER                PIC X.
  3818
  3819***************    OUTPUT FROM ELRESV   ************************
  3820
  3821         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3822
  3823         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3824                                     COMP-3.
  3825         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3826                                     COMP-3.
  3827         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3828                                     COMP-3.
  3829         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3830                                     COMP-3.
  3831         16  FILLER                PIC X(09).
  3832***************    OUTPUT FROM ELRTRM   *************************
  3833
  3834         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3835                                     COMP-3.
  3836         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3837                                     COMP-3.
  3838         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3839                                     COMP-3.
  3840         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3841                                     COMP-3.
  3842         16  FILLER                PIC X(12).
  3843
  3844***************    OUTPUT FROM ELRAMT   *************************
  3845
  3846         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3847                                     COMP-3.
  3848         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3849                                     COMP-3.
  3850         16  FILLER                PIC X(12).
  3851
  3852***************    OUTPUT FROM ELRATE   *************************
  3853
  3854         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3855                                     COMP-3.
  3856         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3857                                     COMP-3.
  3858         16  CP-MORTALITY-CODE     PIC X(4).
  3859         16  CP-RATE-EDIT-FLAG     PIC X.
  3860             88  CP-RATES-NEED-APR                  VALUE '1'.
  3861         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3862                                     COMP-3.
  3863         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3864         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  72
* EL050.cbl
  3865         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3866                                   PIC S9(7)V99 COMP-3.
  3867         16  FILLER                PIC X(07).
  3868
  3869***************    OUTPUT FROM ELRFND   *************************
  3870
  3871         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3872                                     COMP-3.
  3873         16  CP-REFUND-TYPE-USED   PIC X.
  3874           88  CP-R-AS-R78                         VALUE '1'.
  3875           88  CP-R-AS-PRORATA                     VALUE '2'.
  3876           88  CP-R-AS-CALIF                       VALUE '3'.
  3877           88  CP-R-AS-TEXAS                       VALUE '4'.
  3878           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3879           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3880           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3881           88  CP-R-AS-MEAN                        VALUE '8'.
  3882           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3883           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3884           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3885           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3886           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3887           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3888         16  FILLER                PIC X(12).
  3889
  3890***************    OUTPUT FROM ELEARN   *************************
  3891
  3892         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3893                                     COMP-3.
  3894         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3895                                     COMP-3.
  3896         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3897                                     COMP-3.
  3898         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3899                                     COMP-3.
  3900         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3901                                     COMP-3.
  3902         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3903                                     COMP-3.
  3904         16  CP-EARNING-TYPE-USED  PIC X.
  3905           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3906           88  CP-E-AS-R78                         VALUE '1'.
  3907           88  CP-E-AS-PRORATA                     VALUE '2'.
  3908           88  CP-E-AS-TEXAS                       VALUE '4'.
  3909           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3910           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3911           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3912           88  CP-E-AS-MEAN                        VALUE '8'.
  3913           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3914         16  FILLER                PIC X(12).
  3915
  3916***************    OUTPUT FROM ELPMNT   *************************
  3917
  3918         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3919                                     COMP-3.
  3920         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3921                                     COMP-3.
  3922         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  73
* EL050.cbl
  3923
  3924***************   MISC WORK AREAS    *****************************
  3925         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3926                                     COMP-3.
  3927         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3928                                     COMP-3.
  3929         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3930                                     COMP-3.
  3931         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3932                                     COMP-3.
  3933         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3934                                     COMP-3.
  3935         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3936                                     COMP-3.
  3937         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3938             88  OPEN-RATE-FILE                   VALUE 'O'.
  3939             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3940             88  IO-ERROR                         VALUE 'E'.
  3941
  3942         16  CP-FIRST-PAY-DATE     PIC XX.
  3943
  3944         16  CP-JOINT-INDICATOR    PIC X.
  3945
  3946         16  CP-RESERVE-REMAINING-TERM
  3947                                   PIC S9(4)V9    VALUE ZERO
  3948                                     COMP-3.
  3949
  3950         16  CP-INSURED-BIRTH-DT   PIC XX.
  3951
  3952         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3953                                     COMP-3.
  3954
  3955         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3956                                     COMP-3.
  3957
  3958         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3959                                     COMP-3.
  3960
  3961         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3962                                     COMP-3.
  3963
  3964         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3965                                     COMP-3.
  3966
  3967         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3968                                     COMP-3.
  3969
  3970         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3971                                     COMP-3.
  3972
  3973         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3974             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3975
  3976         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3977                                     COMP-3.
  3978         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3979                                     COMP-3.
  3980         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  74
* EL050.cbl
  3981         16  cp-extra-periods      pic 9 value zeros.
  3982         16  cp-net-only-state     pic x value spaces.
  3983         16  FILLER                PIC X(13).
  3984******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  75
* EL050.cbl
  3986******************************************************************
  3987*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3988*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3989*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3990*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3991*** MODIFICATION.                                              ***
  3992*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3993*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3994******************************************************************
  3995*    COPY ERCPNDB.
  3996******************************************************************
  3997*                                                                *
  3998*                                                                *
  3999*                            ERCPNDB.                            *
  4000*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4001*                            VMOD=2.025                          *
  4002*                                                                *
  4003*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4004*                                                                *
  4005******************************************************************
  4006*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4007*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4008******************************************************************
  4009*                                                                *
  4010*                                                                *
  4011*   FILE TYPE = VSAM,KSDS                                        *
  4012*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4013*                                                                *
  4014*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4015*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4016*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4017*                                                 RKP=13,LEN=36  *
  4018*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4019*                                      AND CHG-SEQ.)             *
  4020*                                                RKP=49,LEN=11   *
  4021*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4022*                                      AND CHG-SEQ.)             *
  4023*                                                RKP=60,LEN=15   *
  4024*                                                                *
  4025*   LOG = NO                                                     *
  4026*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4027******************************************************************
  4028******************************************************************
  4029*                   C H A N G E   L O G
  4030*
  4031* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4032*-----------------------------------------------------------------
  4033*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4034* EFFECTIVE    NUMBER
  4035*-----------------------------------------------------------------
  4036* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4037* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4038* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4039* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4040* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4041* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4042* 032306                   PEMA  ADD BOW LOAN NUMBER
  4043* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  76
* EL050.cbl
  4044* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4045* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4046* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4047* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4048* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4049* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4050* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4051* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4052* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4053* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  4054******************************************************************
  4055
  4056 01  PENDING-BUSINESS.
  4057     12  PB-RECORD-ID                     PIC XX.
  4058         88  VALID-PB-ID                        VALUE 'PB'.
  4059
  4060     12  PB-CONTROL-PRIMARY.
  4061         16  PB-COMPANY-CD                PIC X.
  4062         16  PB-ENTRY-BATCH               PIC X(6).
  4063         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4064         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4065
  4066     12  PB-CONTROL-BY-ACCOUNT.
  4067         16  PB-COMPANY-CD-A1             PIC X.
  4068         16  PB-CARRIER                   PIC X.
  4069         16  PB-GROUPING.
  4070             20  PB-GROUPING-PREFIX       PIC XXX.
  4071             20  PB-GROUPING-PRIME        PIC XXX.
  4072         16  PB-STATE                     PIC XX.
  4073         16  PB-ACCOUNT.
  4074             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4075             20  PB-ACCOUNT-PRIME         PIC X(6).
  4076         16  PB-CERT-EFF-DT               PIC XX.
  4077         16  PB-CERT-NO.
  4078             20  PB-CERT-PRIME            PIC X(10).
  4079             20  PB-CERT-SFX              PIC X.
  4080         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4081
  4082         16  PB-RECORD-TYPE               PIC X.
  4083             88  PB-MAILING-DATA                VALUE '0'.
  4084             88  PB-ISSUE                       VALUE '1'.
  4085             88  PB-CANCELLATION                VALUE '2'.
  4086             88  PB-BATCH-TRAILER               VALUE '9'.
  4087
  4088     12  PB-CONTROL-BY-ORIG-BATCH.
  4089         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4090         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4091         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4092         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4093
  4094     12  PB-CONTROL-BY-CSR.
  4095         16  PB-CSR-COMPANY-CD            PIC X.
  4096         16  PB-CSR-ID                    PIC X(4).
  4097         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4098         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4099         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4100******************************************************************
  4101*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  77
* EL050.cbl
  4102******************************************************************
  4103
  4104     12  PB-LAST-MAINT-DT                 PIC XX.
  4105     12  PB-LAST-MAINT-BY                 PIC X(4).
  4106     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4107
  4108     12  PB-RECORD-BODY                   PIC X(375).
  4109
  4110     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4111         16  PB-CERT-ORIGIN               PIC X.
  4112             88  CLASIC-CREATED-CERT         VALUE '1'.
  4113         16  PB-I-NAME.
  4114             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4115             20  PB-I-INSURED-FIRST-NAME.
  4116                 24  PB-I-INSURED-1ST-INIT PIC X.
  4117                 24  FILLER                PIC X(9).
  4118             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4119         16  PB-I-AGE                     PIC S99   COMP-3.
  4120         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4121         16  PB-I-BIRTHDAY                PIC XX.
  4122         16  PB-I-INSURED-SEX             PIC X.
  4123             88  PB-SEX-MALE     VALUE 'M'.
  4124             88  PB-SEX-FEMALE   VALUE 'F'.
  4125
  4126         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4127         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4128         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4129         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4130         16  PB-I-SKIP-CODE               PIC X.
  4131             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4132             88  PB-SKIP-JULY              VALUE '1'.
  4133             88  PB-SKIP-AUGUST            VALUE '2'.
  4134             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4135             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4136             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4137             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4138             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4139             88  PB-SKIP-JUNE              VALUE '8'.
  4140             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4141             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4142             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4143         16  PB-I-TERM-TYPE               PIC X.
  4144             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4145             88  PB-PAID-WEEKLY            VALUE 'W'.
  4146             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4147             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4148             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4149         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4150         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4151         16  PB-I-DATA-ENTRY-SW           PIC X.
  4152             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4153             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4154             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4155             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4156         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4157         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4158*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4159         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  78
* EL050.cbl
  4160         16  FILLER                       PIC X.
  4161
  4162         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4163             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4164             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4165                                                   '90' THRU '99'.
  4166         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4167                                          PIC XX.
  4168         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4169         16  PB-I-AMOUNT-FINANCED REDEFINES
  4170                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4171         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4172         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4173                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4174         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4175         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4176         16  PB-I-CLP-AMOUNT REDEFINES
  4177                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4178         16  PB-I-LF-CALC-FLAG            PIC X.
  4179             88 PB-COMP-LF-PREM               VALUE '?'.
  4180         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4181         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4182         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4183         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4184         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4185         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4186         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4187         16  PB-I-LF-ABBR                 PIC XXX.
  4188         16  PB-I-LF-INPUT-CD             PIC XX.
  4189
  4190         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4191             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4192             88  PB-INVALID-AH               VALUE '  ' '00'
  4193                                                   '90' THRU '99'.
  4194         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4195         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4196         16  PB-I-AH-CALC-FLAG            PIC X.
  4197             88 PB-COMP-AH-PREM                  VALUE '?'.
  4198         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4199         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4200         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  4201         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4202         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4203         16  PB-I-AH-ABBR                 PIC XXX.
  4204         16  PB-I-AH-INPUT-CD             PIC XXX.
  4205
  4206         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4207         16  PB-I-REIN-TABLE              PIC XXX.
  4208         16  PB-I-BUSINESS-TYPE           PIC 99.
  4209         16  PB-I-INDV-GRP-CD             PIC X.
  4210         16  PB-I-MORT-CODE.
  4211             20  PB-I-TABLE               PIC X.
  4212             20  PB-I-INTEREST            PIC XX.
  4213             20  PB-I-MORT-TYP            PIC X.
  4214         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4215         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4216         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4217         16  PB-I-INDV-GRP-OVRD           PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  79
* EL050.cbl
  4218         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4219         16  PB-I-SIG-SW                  PIC X.
  4220             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4221         16  PB-I-RATE-CLASS              PIC XX.
  4222         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4223         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4224         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4225         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4226         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4227         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4228         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4229         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4230         16  PB-I-OB-FLAG                 PIC X.
  4231             88  PB-I-OB                      VALUE 'B'.
  4232             88  PB-I-SUMMARY                 VALUE 'Z'.
  4233         16  PB-I-ENTRY-STATUS            PIC X.
  4234             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4235                                              'M' '5' '9' '2'.
  4236             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4237             88  PB-I-POLICY-PENDING          VALUE '2'.
  4238             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4239             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4240             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4241             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4242             88  PB-I-REIN-ONLY               VALUE '9'.
  4243             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4244             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4245             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4246             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4247         16  PB-I-INT-CODE                PIC X.
  4248             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4249             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4250         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4251         16  PB-I-SOC-SEC-NO              PIC X(11).
  4252         16  PB-I-MEMBER-NO               PIC X(12).
  4253         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4254*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4255         16  PB-I-OLD-LOF                 PIC XXX.
  4256         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4257         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4258         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4259         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4260         16  PB-I-LIFE-INDICATOR          PIC X.
  4261             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4262         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4263         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4264                                          PIC S9(5)V99    COMP-3.
  4265         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4266             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4267             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4268         16  PB-I-1ST-PMT-DT              PIC XX.
  4269         16  PB-I-JOINT-INSURED.
  4270             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4271             20 PB-I-JOINT-FIRST-NAME.
  4272                24  PB-I-JOINT-FIRST-INIT PIC X.
  4273                24  FILLER                PIC X(9).
  4274             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4275*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  80
* EL050.cbl
  4276         16  PB-I-BENEFICIARY-NAME.
  4277             20  PB-I-BANK-NUMBER         PIC X(10).
  4278             20  FILLER                   PIC X(15).
  4279         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4280         16  PB-I-REFERENCE               PIC X(12).
  4281         16  FILLER REDEFINES PB-I-REFERENCE.
  4282             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4283             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4284             20  PB-I-CLP-STATE           PIC XX.
  4285         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4286             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4287             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4288             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4289         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4290         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4291         16  PB-I-RESIDENT-STATE          PIC XX.
  4292         16  PB-I-RATE-CODE               PIC X(4).
  4293         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4294         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4295         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4296         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4297         16  PB-I-BANK-NOCHRGB            PIC 99.
  4298         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4299         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4300
  4301     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4302         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4303             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4304         16  PB-C-CANCEL-ORIGIN           PIC X.
  4305             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4306         16  PB-C-LF-CANCEL-DT            PIC XX.
  4307         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4308         16  PB-C-LF-CALC-REQ             PIC X.
  4309             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4310         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4311         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4312         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4313             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4314         16  PB-C-AH-CANCEL-DT            PIC XX.
  4315         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4316         16  PB-C-AH-CALC-REQ             PIC X.
  4317             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4318         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4319         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4320         16  PB-C-LAST-NAME               PIC X(15).
  4321         16  PB-C-REFUND-SW               PIC X.
  4322             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4323             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4324         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4325         16  PB-C-PAYEE-CODE              PIC X(6).
  4326         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4327         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4328         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4329         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4330         16  PB-C-REFERENCE               PIC X(12).
  4331         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4332         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4333         16  PB-C-POST-CARD-IND           PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  81
* EL050.cbl
  4334         16  PB-C-CANCEL-REASON           PIC X.
  4335         16  PB-C-REF-INTERFACE-SW        PIC X.
  4336         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4337         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4338         16  FILLER                       PIC X(01).
  4339*        16  FILLER                       PIC X(18).
  4340         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4341*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4342         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4343         16  PB-CANCELED-CERT-DATA.
  4344             20  PB-CI-INSURED-NAME.
  4345                 24  PB-CI-LAST-NAME      PIC X(15).
  4346                 24  PB-CI-INITIALS       PIC XX.
  4347             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4348             20  PB-CI-INSURED-SEX        PIC X.
  4349             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4350             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4351             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4352             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4353             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4354             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4355             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4356             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4357             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4358             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4359             20  PB-CI-RATE-CLASS         PIC XX.
  4360             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4361             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4362             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4363             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4364             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4365             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4366             20  PB-CI-LF-ABBR            PIC X(3).
  4367             20  PB-CI-AH-ABBR            PIC X(3).
  4368             20  PB-CI-OB-FLAG            PIC X.
  4369                 88  PB-CI-OB                VALUE 'B'.
  4370             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4371                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4372                                           'M' '4' '5' '9' '2'.
  4373                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4374                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4375                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4376                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4377                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4378                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4379                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4380                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4381                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4382                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4383                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4384                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4385                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4386             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4387                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4388                                           'M' '4' '5' '9' '2'.
  4389                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4390                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4391                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  82
* EL050.cbl
  4392                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4393                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4394                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4395                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4396                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4397                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4398                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4399                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4400                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4401                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4402             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4403             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4404             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4405             20  PB-CI-MEMBER-NO          PIC X(12).
  4406             20  PB-CI-INT-CODE           PIC X.
  4407                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4408                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4409             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4410             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4411             20  PB-CI-COMP-EXCP-SW       PIC X.
  4412                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4413                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4414             20  PB-CI-ENTRY-STATUS       PIC X.
  4415             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4416             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4417             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4418             20  PB-CI-DEATH-DT           PIC XX.
  4419             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4420             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4421             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4422             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4423             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4424             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4425             20  PB-CI-ENTRY-DT              PIC XX.
  4426             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4427             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4428             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4429             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4430             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4431             20  PB-CI-OLD-LOF               PIC XXX.
  4432*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4433             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4434             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4435             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4436             20  PB-CI-INDV-GRP-CD           PIC X.
  4437             20  PB-CI-BENEFICIARY-NAME.
  4438                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4439                 24  FILLER                  PIC X(15).
  4440             20  PB-CI-NOTE-SW               PIC X.
  4441             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4442             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4443             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4444             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4445             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4446             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4447             20  PB-CI-FIRST-NAME            PIC X(10).
  4448             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4449
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  83
* EL050.cbl
  4450         16  FILLER                       PIC X(13).
  4451*032306  16  FILLER                       PIC X(27).
  4452*        16  FILLER                       PIC X(46).
  4453
  4454     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4455         16  FILLER                       PIC X(10).
  4456         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4457         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4458         16  PB-M-INSURED-MID-INIT        PIC X.
  4459         16  PB-M-INSURED-AGE             PIC 99.
  4460         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4461         16  PB-M-INSURED-SEX             PIC X.
  4462         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4463         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4464         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4465         16  PB-M-INSURED-CITY-STATE.
  4466             20  PB-M-INSURED-CITY        PIC X(28).
  4467             20  PB-M-INSURED-STATE       PIC XX.
  4468         16  PB-M-INSURED-ZIP-CODE.
  4469             20  PB-M-INSURED-ZIP-PRIME.
  4470                 24  PB-M-INSURED-ZIP-1   PIC X.
  4471                     88  PB-M-CANADIAN-POST-CODE
  4472                                             VALUE 'A' THRU 'Z'.
  4473                 24  FILLER               PIC X(4).
  4474             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4475         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4476                                        PB-M-INSURED-ZIP-CODE.
  4477             20  PM-M-INS-CAN-POST1       PIC XXX.
  4478             20  PM-M-INS-CAN-POST2       PIC XXX.
  4479             20  FILLER                   PIC XXX.
  4480         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4481         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4482         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4483         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4484         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4485         16  PB-M-CRED-BENE-CITYST.
  4486             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4487             20  PB-M-CRED-BENE-STATE     PIC XX.
  4488         16  FILLER                       PIC X(92).
  4489
  4490     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4491         16  FILLER                       PIC X(10).
  4492         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4493         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4494         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4495         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4496         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4497         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4498         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4499         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4500         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4501         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4502         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4503         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4504         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4505         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4506         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4507         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  84
* EL050.cbl
  4508         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4509         16  PB-ACCOUNT-NAME              PIC X(30).
  4510         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4511         16  PB-REFERENCE                 PIC X(12).
  4512         16  PB-B-RECEIVED-DT             PIC XX.
  4513         16  FILLER                       PIC X(234).
  4514
  4515     12  PB-RECORD-STATUS.
  4516         16  PB-CREDIT-SELECT-DT          PIC XX.
  4517         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4518         16  PB-BILLED-DT                 PIC XX.
  4519         16  PB-BILLING-STATUS            PIC X.
  4520             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4521             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4522             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4523         16  PB-RECORD-BILL               PIC X.
  4524             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4525             88  PB-RECORD-RETURNED           VALUE 'R'.
  4526             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4527             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4528             88  PB-OVERRIDE-AH               VALUE 'A'.
  4529             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4530         16  PB-BATCH-ENTRY               PIC X.
  4531             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4532             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4533             88  PB-REISSUED-CERT             VALUE 'E'.
  4534             88  PB-CASH-CERT                 VALUE 'C'.
  4535             88  PB-MONTHLY-CERT              VALUE 'M'.
  4536             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4537             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4538             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4539         16  PB-FORCE-CODE                PIC X.
  4540             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4541             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4542             88  PB-CANCEL-FORCE              VALUE '8'.
  4543             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4544             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4545             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4546             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4547             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4548             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4549             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  4550             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4551         16  PB-FATAL-FLAG                PIC X.
  4552             88  PB-FATAL-ERRORS              VALUE 'X'.
  4553         16  PB-FORCE-ER-CD               PIC X.
  4554             88  PB-FORCE-ERRORS              VALUE 'F'.
  4555             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4556         16  PB-WARN-ER-CD                PIC X.
  4557             88  PB-WARNING-ERRORS            VALUE 'W'.
  4558         16  FILLER                       PIC X.
  4559         16  PB-OUT-BAL-CD                PIC X.
  4560             88  PB-OUT-OF-BAL                VALUE 'O'.
  4561         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4562         16  PB-AH-OVERRIDE-L1            PIC X.
  4563         16  PB-INPUT-DT                  PIC XX.
  4564         16  PB-INPUT-BY                  PIC X(4).
  4565         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  85
* EL050.cbl
  4566         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4567         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4568         16  PB-LF-EARNING-METHOD         PIC X.
  4569         16  PB-AH-EARNING-METHOD         PIC X.
  4570         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4571         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4572         16  PB-REIN-CD                   PIC XXX.
  4573         16  PB-LF-REFUND-TYPE            PIC X.
  4574         16  PB-AH-REFUND-TYPE            PIC X.
  4575         16  PB-ACCT-EFF-DT               PIC XX.
  4576         16  PB-ACCT-EXP-DT               PIC XX.
  4577         16  PB-COMPANY-ID                PIC X(3).
  4578         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4579         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4580         16  PB-SV-CARRIER                PIC X.
  4581         16  PB-SV-GROUPING               PIC X(6).
  4582         16  PB-SV-STATE                  PIC XX.
  4583         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4584         16  PB-GA-BILLING-INFO.
  4585             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4586                                          PIC XX.
  4587         16  PB-SV-REMIT-TO  REDEFINES
  4588             PB-GA-BILLING-INFO           PIC X(10).
  4589         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4590         16  PB-I-LOAN-OFFICER            PIC X(5).
  4591         16  PB-I-VIN                     PIC X(17).
  4592
  4593         16  FILLER                       PIC X(04).
  4594         16  IMNET-BYPASS-SW              PIC X.
  4595
  4596******************************************************************
  4597*                COMMON EDIT ERRORS                              *
  4598******************************************************************
  4599
  4600     12  PB-COMMON-ERRORS.
  4601         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4602                                           PIC S9(4)     COMP.
  4603
  4604******************************************************************
  4605
  4606* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4607*    COPY ELC50W1.
  4608******************************************************************
  4609*                                                                *
  4610*                                                                *
  4611*                             ELC50W1                            *
  4612*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4613*                            VMOD=2.004                          *
  4614*                                                                *
  4615*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4616*                                                                *
  4617*                                                                *
  4618******************************************************************
  4619
  4620     12  WK-WORK-AREA.
  4621         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4622         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4623         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  86
* EL050.cbl
  4624         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4625         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4626         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4627         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4628         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4629         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4630         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4631         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  4632         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4633         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4634         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4635         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4636         16  WK-CREDIT-EDIT-CONTROLS.
  4637             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4638             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4639             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4640             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4641             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4642             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4643         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4644         16  WK-SAVE-REIN-DATA.
  4645             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4646             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4647             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4648         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4649             88  ENTRY-FROM-EL6311       VALUE '6'.
  4650         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4651         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4652     12  WK-RECORD-ADDRESSES.
  4653         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4654         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4655         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4656         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4657         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4658         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4659         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4660         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4661     12  WK-OVER-SHORT-AREA.
  4662         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4663         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4664         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4665             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4666         16  FILLER                   PIC X(5) VALUE SPACES.
  4667
  4668*    COPY ELCEDITC.
  4669******************************************************************
  4670*                                                                *
  4671*                                                                *
  4672*                            ELCEDITC                            *
  4673*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4674*                            VMOD=2.012                          *
  4675*                                                                *
  4676*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4677*                     EL6313, EL050 AND EL517.                   *
  4678*                                                                *
  4679******************************************************************
  4680******************************************************************
  4681*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  87
* EL050.cbl
  4682*
  4683* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4684*-----------------------------------------------------------------
  4685*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4686* EFFECTIVE    NUMBER
  4687*-----------------------------------------------------------------
  4688* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4689******************************************************************
  4690
  4691     12  EDIT-CRITERIA-DATA.
  4692         16  EC-CO-MONTH-END-DT       PIC XX.
  4693         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4694         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4695         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4696         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4697         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4698         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4699         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4700         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4701         16  EC-CO-REM-TERM-CALC      PIC X.
  4702               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4703               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4704               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4705               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4706
  4707         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4708               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4709               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4710               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4711               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4712               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4713               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4714               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4715               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4716               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4717               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4718
  4719         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4720               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4721               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4722               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4723               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4724               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4725               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4726               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4727               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4728
  4729         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4730                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4731                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4732
  4733         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4734                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4735                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4736                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4737                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4738                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4739                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  88
* EL050.cbl
  4740                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4741                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4742
  4743         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4744               88  EC-BR-REDUCING                   VALUE 'R'.
  4745               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4746
  4747         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  4748         16  EC-BR-LF-DESC             PIC X(10).
  4749         16  EC-BR-AH-DESC             PIC X(10).
  4750         16  EC-BR-LF-COMMENT          PIC X(10).
  4751         16  EC-BR-AH-COMMENT          PIC X(10).
  4752
  4753         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4754               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4755               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4756               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4757               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4758
  4759         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4760               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4761               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4762               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4763               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4764
  4765         16  EC-BR-LF-REFUND-CALC      PIC X.
  4766                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4767                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4768                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4769                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4770                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4771                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4772                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4773
  4774         16  EC-BR-AH-REFUND-CALC      PIC X.
  4775                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4776                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4777                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4778                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4779                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4780                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4781                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4782                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4783
  4784         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4785                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4786                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4787                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4788
  4789         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4790                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4791                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4792                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4793
  4794         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4795         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4796         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4797         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  89
* EL050.cbl
  4798
  4799         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4800         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4801                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4802                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4803                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4804                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4805
  4806         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4807               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4808               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4809               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4810               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4811               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4812
  4813         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4814               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4815               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4816               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4817               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4818               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4819
  4820         16  EC-ST-LF-REFUND-CALC      PIC X.
  4821                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4822                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4823                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4824                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4825                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4826                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4827                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4828                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4829
  4830         16  EC-ST-AH-REFUND-CALC      PIC X.
  4831                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4832                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4833                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4834                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4835                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4836                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4837                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4838                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4839
  4840         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4841         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4842         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4843         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4844         16  EC-AM-EXPIRATION-DT       PIC XX.
  4845         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4846         16  EC-AM-CLASS-CD            PIC XX.
  4847         16  EC-AM-LF-DEVIATION        PIC XXX.
  4848         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4849         16  EC-AM-AH-DEVIATION        PIC XXX.
  4850         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4851         16  EC-AM-PHONE-NO            PIC X(10).
  4852
  4853         16  EC-AM-LF-REFUND-CALC      PIC X.
  4854                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4855                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  90
* EL050.cbl
  4856                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4857                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4858                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4859                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4860                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4861
  4862         16  EC-AM-AH-REFUND-CALC      PIC X.
  4863                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  4864                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4865                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4866                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4867                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4868                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4869                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4870
  4871         16  EC-AM-BEN-I-G-CD          PIC X.
  4872                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4873                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4874                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4875
  4876         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4877         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4878         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4879         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4880         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4881         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4882         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4883         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4884         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4885
  4886         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4887         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4888         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4889         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4890         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4891         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4892         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4893         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4894         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4895         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4896         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4897         16  EC-RT-LF-NSP-ST           PIC XX.
  4898         16  EC-RT-AH-NSP-ST           PIC XX.
  4899         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4900         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4901
  4902         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4903             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4904                                             'M' '5' '9' '2'.
  4905             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4906             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4907             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4908             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4909             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4910             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4911             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4912             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4913             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  91
* EL050.cbl
  4914             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4915
  4916         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4917             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4918                                             'M' '5' '9' '2'.
  4919             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4920             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4921             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  4922             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4923             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4924             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4925             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4926             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4927             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4928             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4929
  4930         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4931         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4932         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4933         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4934         16  EC-CM-DEATH-DT            PIC XX.
  4935
  4936*DMD CUSTOM CODING FIELDS BELOW
  4937*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4938         16  EC-BR-DMD-RATING-SW       PIC X.
  4939                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4940                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4941                 88  NO-DMD-RATING               VALUE 'N'.
  4942
  4943         16  EC-NEW-CERT               PIC X(11).
  4944         16  EC-NEW-STATE              PIC XX.
  4945         16  FILLER                    PIC X.
  4946*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4947         16  OVER-SHORT-EDIT-FIELDS.
  4948             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4949             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4950             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4951             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4952             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4953             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4954             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4955             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4956             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4957         16  FILLER                    PIC X(71).
  4958******************************************************************
  4959
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  92
* EL050.cbl
  4961*    COPY ELCDIFRD.
  4962******************************************************************
  4963*                                                                *
  4964*                                                                *
  4965*                            ELCDIFRD.                           *
  4966*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4967*                            VMOD=2.004                          *
  4968*                                                                *
  4969*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4970*                                                                *
  4971******************************************************************
  4972*
  4973  01  WS-DIFFERENCE-CALCULATION.
  4974        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4975        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4976        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4977        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4978        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4979        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4980        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4981        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4982        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4983        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4984        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4985
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  93
* EL050.cbl
  4987****************************************************************
  4988*
  4989* Copyright (c) 2007-2013 Dell Inc.
  4990* All rights reserved.
  4991*
  4992****************************************************************
  4993 01  DFHEIV.
  4994   02  DFHEIV0               PIC X(35).
  4995   02  DFHEIV1               PIC X(08).
  4996   02  DFHEIV2               PIC X(08).
  4997   02  DFHEIV3               PIC X(08).
  4998   02  DFHEIV4               PIC X(06).
  4999   02  DFHEIV5               PIC X(04).
  5000   02  DFHEIV6               PIC X(04).
  5001   02  DFHEIV7               PIC X(02).
  5002   02  DFHEIV8               PIC X(02).
  5003   02  DFHEIV9               PIC X(01).
  5004   02  DFHEIV10              PIC S9(7) COMP-3.
  5005   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5006   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5007   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5008   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5009   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5010   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5011   02  DFHEIV17              PIC X(04).
  5012   02  DFHEIV18              PIC X(04).
  5013   02  DFHEIV19              PIC X(04).
  5014   02  DFHEIV20              USAGE IS POINTER.
  5015   02  DFHEIV21              USAGE IS POINTER.
  5016   02  DFHEIV22              USAGE IS POINTER.
  5017   02  DFHEIV23              USAGE IS POINTER.
  5018   02  DFHEIV24              USAGE IS POINTER.
  5019   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5020   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5021   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5022   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5023   02  DFHEIV29              PIC S9(9) COMP SYNC.
  5024   02  DFHEIV30              PIC S9(9) COMP SYNC.
  5025   02  DFHEIV31              PIC S9(9) COMP SYNC.
  5026   02  DFHEIV32              PIC S9(4) COMP SYNC.
  5027   02  DFHEIV33              PIC S9(4) COMP SYNC.
  5028   02  DFHEIV34              PIC S9(4) COMP SYNC.
  5029   02  DFHEIV35              PIC S9(4) COMP SYNC.
  5030   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5031   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5032   02  FILLER                PIC X(02).
  5033   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5034   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5035   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5036   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5037   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5038   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  5039   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  5040 LINKAGE  SECTION.
  5041*****************************************************************
  5042*                                                               *
  5043* Copyright (c) 2007-2013 Dell Inc.                             *
  5044* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  94
* EL050.cbl
  5045*                                                               *
  5046*****************************************************************
  5047 01  dfheiblk.
  5048     02  eibtime          pic s9(7) comp-3.
  5049     02  eibdate          pic s9(7) comp-3.
  5050     02  eibtrnid         pic x(4).
  5051     02  eibtaskn         pic s9(7) comp-3.
  5052     02  eibtrmid         pic x(4).
  5053     02  dfheigdi         pic s9(4) comp.
  5054     02  eibcposn         pic s9(4) comp.
  5055     02  eibcalen         pic s9(4) comp.
  5056     02  eibaid           pic x(1).
  5057     02  eibfiller1       pic x(1).
  5058     02  eibfn            pic x(2).
  5059     02  eibfiller2       pic x(2).
  5060     02  eibrcode         pic x(6).
  5061     02  eibfiller3       pic x(2).
  5062     02  eibds            pic x(8).
  5063     02  eibreqid         pic x(8).
  5064     02  eibrsrce         pic x(8).
  5065     02  eibsync          pic x(1).
  5066     02  eibfree          pic x(1).
  5067     02  eibrecv          pic x(1).
  5068     02  eibsend          pic x(1).
  5069     02  eibatt           pic x(1).
  5070     02  eibeoc           pic x(1).
  5071     02  eibfmh           pic x(1).
  5072     02  eibcompl         pic x(1).
  5073     02  eibsig           pic x(1).
  5074     02  eibconf          pic x(1).
  5075     02  eiberr           pic x(1).
  5076     02  eibrldbk         pic x(1).
  5077     02  eiberrcd         pic x(4).
  5078     02  eibsynrb         pic x(1).
  5079     02  eibnodat         pic x(1).
  5080     02  eibfiller5       pic x(2).
  5081     02  eibresp          pic s9(8) comp.
  5082     02  eibresp2         pic s9(8) comp.
  5083     02  dfheigdj         pic s9(4) comp.
  5084     02  dfheigdk         pic s9(4) comp.
  5085
  5086 01  DFHCOMMAREA                   PIC X(1036).
  5087
  5088*01 PARMLIST .
  5089*    02  FILLER                    PIC S9(8)   COMP.
  5090*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  5091*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  5092*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  5093*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  5094*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  5095*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  5096*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  5097
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  95
* EL050.cbl
  5099*    COPY ELCCNTL.
  5100******************************************************************
  5101*                                                                *
  5102*                                                                *
  5103*                            ELCCNTL.                            *
  5104*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5105*                            VMOD=2.059                          *
  5106*                                                                *
  5107*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  5108*                                                                *
  5109*   FILE TYPE = VSAM,KSDS                                        *
  5110*   RECORD SIZE = 750  RECFORM = FIXED                           *
  5111*                                                                *
  5112*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  5113*       ALTERNATE INDEX = NONE                                   *
  5114*                                                                *
  5115*   LOG = YES                                                    *
  5116*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5117******************************************************************
  5118*                   C H A N G E   L O G
  5119*
  5120* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5121*-----------------------------------------------------------------
  5122*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5123* EFFECTIVE    NUMBER
  5124*-----------------------------------------------------------------
  5125* 082503                   PEMA  ADD BENEFIT GROUP
  5126* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5127* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5128* 092705    2005050300006  PEMA  ADD SPP LEASES
  5129* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5130* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5131* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5132* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5133* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5134* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5135* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  5136* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  5137* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  5138* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5139* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  5140******************************************************************
  5141*
  5142 01  CONTROL-FILE.
  5143     12  CF-RECORD-ID                       PIC XX.
  5144         88  VALID-CF-ID                        VALUE 'CF'.
  5145
  5146     12  CF-CONTROL-PRIMARY.
  5147         16  CF-COMPANY-ID                  PIC XXX.
  5148         16  CF-RECORD-TYPE                 PIC X.
  5149             88  CF-COMPANY-MASTER              VALUE '1'.
  5150             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5151             88  CF-STATE-MASTER                VALUE '3'.
  5152             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5153             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5154             88  CF-CARRIER-MASTER              VALUE '6'.
  5155             88  CF-MORTALITY-MASTER            VALUE '7'.
  5156             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  96
* EL050.cbl
  5157             88  CF-TERMINAL-MASTER             VALUE '9'.
  5158             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5159             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5160             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5161             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5162             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5163             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5164             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5165             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5166             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5167         16  CF-ACCESS-CD-GENL              PIC X(4).
  5168         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5169             20  CF-PROCESSOR               PIC X(4).
  5170         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5171             20  CF-STATE-CODE              PIC XX.
  5172             20  FILLER                     PIC XX.
  5173         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5174             20  FILLER                     PIC XX.
  5175             20  CF-HI-BEN-IN-REC           PIC XX.
  5176         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5177             20  FILLER                     PIC XXX.
  5178             20  CF-CARRIER-CNTL            PIC X.
  5179         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5180             20  FILLER                     PIC XX.
  5181             20  CF-HI-TYPE-IN-REC          PIC 99.
  5182         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5183             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5184                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5185             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5186             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5187         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5188             20  FILLER                     PIC X.
  5189             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5190         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5191             20  FILLER                     PIC XX.
  5192             20  CF-MORTGAGE-PLAN           PIC XX.
  5193         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5194
  5195     12  CF-LAST-MAINT-DT                   PIC XX.
  5196     12  CF-LAST-MAINT-BY                   PIC X(4).
  5197     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5198
  5199     12  CF-RECORD-BODY                     PIC X(728).
  5200
  5201
  5202****************************************************************
  5203*             COMPANY MASTER RECORD                            *
  5204****************************************************************
  5205
  5206     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5207         16  CF-COMPANY-ADDRESS.
  5208             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5209             20  CF-CL-IN-CARE-OF           PIC X(30).
  5210             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5211             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5212             20  CF-CL-CITY-STATE           PIC X(30).
  5213             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5214             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  97
* EL050.cbl
  5215         16  CF-COMPANY-CD                  PIC X.
  5216         16  CF-COMPANY-PASSWORD            PIC X(8).
  5217         16  CF-SECURITY-OPTION             PIC X.
  5218             88  ALL-SECURITY                   VALUE '1'.
  5219             88  COMPANY-VERIFY                 VALUE '2'.
  5220             88  PROCESSOR-VERIFY               VALUE '3'.
  5221             88  NO-SECURITY                    VALUE '4'.
  5222             88  ALL-BUT-TERM                   VALUE '5'.
  5223         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5224             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5225         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5226             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5227         16  CF-INFORCE-LOCATION            PIC X.
  5228             88  CERTS-ARE-ONLINE               VALUE '1'.
  5229             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5230             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5231         16  CF-LOWER-CASE-LETTERS          PIC X.
  5232         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5233             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5234             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5235             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5236             88  CF-ACCNT-CNTL                  VALUE '3'.
  5237             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5238
  5239         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5240         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5241
  5242         16  CF-LGX-CREDIT-USER             PIC X.
  5243             88  CO-IS-NOT-USER                 VALUE 'N'.
  5244             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5245
  5246         16 CF-CREDIT-CALC-CODES.
  5247             20  CF-CR-REM-TERM-CALC PIC X.
  5248               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5249               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5250               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5251               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5252               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5253               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5254               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5255             20  CF-CR-R78-METHOD           PIC X.
  5256               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5257               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5258
  5259         16  CF-CLAIM-CONTROL-COUNTS.
  5260             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5261                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5262
  5263             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5264                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5265
  5266             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5267                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5268
  5269             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5270                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5271
  5272         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  98
* EL050.cbl
  5273
  5274         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5275             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5276             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5277             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5278             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5279                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5280                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5281             20  CF-CO-PREM-REJECT-SW       PIC X.
  5282                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5283                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5284             20  CF-CO-REF-REJECT-SW        PIC X.
  5285                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5286                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5287
  5288         16  CF-CO-REPORTING-DT             PIC XX.
  5289         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5290         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5291           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5292           88  CF-CO-MONTH-END                  VALUE '1'.
  5293
  5294         16  CF-LGX-CLAIM-USER              PIC X.
  5295             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5296             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5297
  5298         16  CF-CREDIT-EDIT-CONTROLS.
  5299             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5300             20  CF-MIN-AGE                 PIC 99.
  5301             20  CF-DEFAULT-AGE             PIC 99.
  5302             20  CF-MIN-TERM                PIC S999      COMP-3.
  5303             20  CF-MAX-TERM                PIC S999      COMP-3.
  5304             20  CF-DEFAULT-SEX             PIC X.
  5305             20  CF-JOINT-AGE-INPUT         PIC X.
  5306                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5307             20  CF-BIRTH-DATE-INPUT        PIC X.
  5308                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5309             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5310                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5311                 88  CF-ZERO-CARRIER            VALUE '1'.
  5312                 88  CF-ZERO-GROUPING           VALUE '2'.
  5313                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5314             20  CF-EDIT-SW                 PIC X.
  5315                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5316             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5317             20  CF-CR-PR-METHOD            PIC X.
  5318               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5319               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5320             20  FILLER                     PIC X.
  5321
  5322         16  CF-CREDIT-MISC-CONTROLS.
  5323             20  CF-REIN-TABLE-SW           PIC X.
  5324                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5325             20  CF-COMP-TABLE-SW           PIC X.
  5326                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5327             20  CF-EXPERIENCE-RETENTION-AGE
  5328                                            PIC S9        COMP-3.
  5329             20  CF-CONVERSION-DT           PIC XX.
  5330             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page  99
* EL050.cbl
  5331             20  CF-RUN-FREQUENCY-SW        PIC X.
  5332                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5333                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5334
  5335             20  CF-CR-CHECK-NO-CONTROL.
  5336                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5337                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5338                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5339                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5340                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5341                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5342
  5343                 24  CF-CR-CHECK-COUNT       REDEFINES
  5344                     CF-CR-CHECK-COUNTER      PIC X(4).
  5345
  5346                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5347                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5348
  5349                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5350                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5351                 24  CF-MAIL-PROCESSING       PIC X.
  5352                     88  MAIL-PROCESSING          VALUE 'Y'.
  5353
  5354         16  CF-MISC-SYSTEM-CONTROL.
  5355             20  CF-SYSTEM-C                 PIC X.
  5356                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5357             20  CF-SYSTEM-D                 PIC X.
  5358                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5359             20  CF-SOC-SEC-NO-SW            PIC X.
  5360                 88  SOC-SEC-NO-USED             VALUE '1'.
  5361             20  CF-MEMBER-NO-SW             PIC X.
  5362                 88  MEMBER-NO-USED              VALUE '1'.
  5363             20  CF-TAX-ID-NUMBER            PIC X(11).
  5364             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5365             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5366                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5367                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5368                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5369                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5370             20  CF-SYSTEM-E                 PIC X.
  5371                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5372
  5373         16  CF-LGX-LIFE-USER               PIC X.
  5374             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5375             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5376
  5377         16  CF-CR-MONTH-END-DT             PIC XX.
  5378
  5379         16  CF-FILE-MAINT-DATES.
  5380             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5381                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5382             20  CF-LAST-BATCH       REDEFINES
  5383                 CF-LAST-BATCH-NO               PIC X(4).
  5384             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5385             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5386             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5387             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5388             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 100
* EL050.cbl
  5389             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5390             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5391             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5392             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5393             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5394
  5395         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5396         16  FILLER                         PIC X.
  5397
  5398         16  CF-ALT-MORT-CODE               PIC X(4).
  5399         16  CF-MEMBER-CAPTION              PIC X(10).
  5400
  5401         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5402             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5403             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5404             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5405             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5406             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5407
  5408         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5409
  5410         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5411         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5412         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5413         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5414
  5415         16  CF-AH-OVERRIDE-L1              PIC X.
  5416         16  CF-AH-OVERRIDE-L2              PIC XX.
  5417         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5418         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5419
  5420         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5421         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5422
  5423         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5424         16  CF-AR-LAST-EL860-DT            PIC XX.
  5425         16  CF-MP-MONTH-END-DT             PIC XX.
  5426
  5427         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5428         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5429             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5430
  5431         16  CF-AR-MONTH-END-DT             PIC XX.
  5432
  5433         16  CF-CRDTCRD-USER                PIC X.
  5434             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5435             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5436
  5437         16  CF-CC-MONTH-END-DT             PIC XX.
  5438
  5439         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5440
  5441         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5442             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5443             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5444             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5445         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5446         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 101
* EL050.cbl
  5447         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5448         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5449             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5450             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5451         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5452         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5453         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5454             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5455         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5456
  5457         16  CF-CL-ZIP-CODE.
  5458             20  CF-CL-ZIP-PRIME.
  5459                 24  CF-CL-ZIP-1ST          PIC X.
  5460                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5461                 24  FILLER                 PIC X(4).
  5462             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5463         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5464             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5465             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5466             20  FILLER                     PIC XXX.
  5467
  5468         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5469         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5470         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5471         16  CF-CO-OPTION-START-DATE        PIC XX.
  5472         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5473           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5474                                                      '3' '4'.
  5475           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5476           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5477           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5478           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5479           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5480           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5481
  5482         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5483
  5484         16  CF-PAYMENT-APPROVAL-LEVELS.
  5485             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5486             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5487             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5488             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5489             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5490             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5491
  5492         16  CF-END-USER-REPORTING-USER     PIC X.
  5493             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5494             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5495
  5496         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5497             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5498             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5499
  5500         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5501
  5502         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5503         16  FILLER                         PIC X.
  5504
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 102
* EL050.cbl
  5505         16  CF-CREDIT-ARCHIVE-CNTL.
  5506             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5507             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5508             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5509
  5510         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5511
  5512         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5513             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5514             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5515
  5516         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5517             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5518             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5519
  5520         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5521
  5522         16  CF-CO-ACH-ID-CODE              PIC  X.
  5523             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5524             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5525             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5526         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5527         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5528         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5529         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5530         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5531         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5532         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5533         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5534         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5535                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5536         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5537                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5538
  5539         16  CF-CO-OVER-SHORT.
  5540             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5541             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5542
  5543*         16  FILLER                         PIC X(102).
  5544         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5545             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5546             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5547
  5548         16  CF-AH-APPROVAL-DAYS.
  5549             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5550             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5551             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5552             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5553
  5554         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5555
  5556         16  CF-APPROV-LEV-5.
  5557             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5558             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5559             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5560
  5561         16  FILLER                         PIC X(68).
  5562****************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 103
* EL050.cbl
  5563*             PROCESSOR/USER RECORD                            *
  5564****************************************************************
  5565
  5566     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5567         16  CF-PROCESSOR-NAME              PIC X(30).
  5568         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5569         16  CF-PROCESSOR-TITLE             PIC X(26).
  5570         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5571                 88  MESSAGE-YES                VALUE 'Y'.
  5572                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5573
  5574*****************************************************
  5575****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5576****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5577****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5578****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5579*****************************************************
  5580
  5581         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5582             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5583             20  CF-APPLICATION-FORCE       PIC X.
  5584             20  CF-INDIVIDUAL-APP.
  5585                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5586                     28  CF-BROWSE-APP      PIC X.
  5587                     28  CF-UPDATE-APP      PIC X.
  5588
  5589         16  CF-CURRENT-TERM-ON             PIC X(4).
  5590         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5591             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5592             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5593             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5594             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5595             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5596             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5597             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5598         16  CF-PROCESSOR-CARRIER           PIC X.
  5599             88  NO-CARRIER-SECURITY            VALUE ' '.
  5600         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5601             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5602         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5603             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5604         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5605             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5606
  5607         16  CF-PROC-SYS-ACCESS-SW.
  5608             20  CF-PROC-CREDIT-CLAIMS-SW.
  5609                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5610                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5611                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5612                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5613             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5614                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5615                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5616             20  CF-PROC-LIFE-GNRLDGR-SW.
  5617                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5618                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5619                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5620                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 104
* EL050.cbl
  5621             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5622                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5623                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5624         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5625             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5626             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5627         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5628
  5629         16  CF-APPROVAL-LEVEL                  PIC X.
  5630             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5631             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5632             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5633             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5634             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5635
  5636         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5637
  5638         16  CF-LANGUAGE-TYPE                   PIC X.
  5639             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5640             88  CF-LANG-IS-FR                      VALUE 'F'.
  5641
  5642         16  CF-CSR-IND                         PIC X.
  5643         16  FILLER                             PIC X(239).
  5644
  5645****************************************************************
  5646*             PROCESSOR/REMINDERS RECORD                       *
  5647****************************************************************
  5648
  5649     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5650         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5651             20  CF-START-REMIND-DT         PIC XX.
  5652             20  CF-END-REMIND-DT           PIC XX.
  5653             20  CF-REMINDER-TEXT           PIC X(50).
  5654         16  FILLER                         PIC X(296).
  5655
  5656
  5657****************************************************************
  5658*             STATE MASTER RECORD                              *
  5659****************************************************************
  5660
  5661     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5662         16  CF-STATE-ABBREVIATION          PIC XX.
  5663         16  CF-STATE-NAME                  PIC X(25).
  5664         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5665         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5666             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5667             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5668             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5669             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5670                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5671                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5672             20  CF-ST-PREM-REJECT-SW       PIC X.
  5673                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5674                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5675             20  CF-ST-REF-REJECT-SW        PIC X.
  5676                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5677                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5678         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 105
* EL050.cbl
  5679         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5680         16  CF-ST-REFUND-RULES.
  5681             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5682             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5683             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5684         16  CF-ST-FST-PMT-EXTENSION.
  5685             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5686             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5687                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5688                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5689                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5690                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5691         16  CF-ST-STATE-CALL.
  5692             20  CF-ST-CALL-UNEARNED        PIC X.
  5693             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5694             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5695         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5696             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5697             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5698         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5699         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5700         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5701         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5702         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5703         16  FILLER                         PIC X.
  5704         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5705             20  CF-ST-BENEFIT-CD           PIC XX.
  5706             20  CF-ST-BENEFIT-KIND         PIC X.
  5707                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5708                 88  CF-ST-AH-KIND              VALUE 'A'.
  5709             20  CF-ST-REM-TERM-CALC        PIC X.
  5710                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5711                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5712                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5713                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5714                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5715                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5716                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5717                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5718
  5719             20  CF-ST-REFUND-CALC          PIC X.
  5720                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5721                 88  ST-REFD-BY-R78             VALUE '1'.
  5722                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5723                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5724                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5725                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5726                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5727                 88  ST-REFD-UTAH               VALUE '7'.
  5728                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5729                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5730                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5731
  5732             20  CF-ST-EARNING-CALC         PIC X.
  5733                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5734                 88  ST-EARN-BY-R78             VALUE '1'.
  5735                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5736                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 106
* EL050.cbl
  5737                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5738                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5739                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5740                 88  ST-EARN-MEAN               VALUE '8'.
  5741                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5742
  5743             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5744                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5745                 88  ST-OVRD-BY-R78             VALUE '1'.
  5746                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5747                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5748                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5749                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5750                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5751                 88  ST-OVRD-MEAN               VALUE '8'.
  5752                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5753             20  cf-st-extra-periods        pic 9.
  5754*            20  FILLER                     PIC X.
  5755
  5756         16  CF-ST-COMMISSION-CAPS.
  5757             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5758             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5759             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5760             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5761         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5762                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5763                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  5764                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  5765
  5766         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5767
  5768         16  CF-ST-STATUTORY-INTEREST.
  5769             20  CF-ST-STAT-DATE-FROM       PIC X.
  5770                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5771                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5772             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5773             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5774             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5775             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5776             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5777
  5778         16  CF-ST-OVER-SHORT.
  5779             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5780             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5781
  5782         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5783
  5784         16  CF-ST-RT-CALC                  PIC X.
  5785
  5786         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5787         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5788         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5789         16  CF-ST-RF-LR-CALC               PIC X.
  5790         16  CF-ST-RF-LL-CALC               PIC X.
  5791         16  CF-ST-RF-LN-CALC               PIC X.
  5792         16  CF-ST-RF-AH-CALC               PIC X.
  5793         16  CF-ST-RF-CP-CALC               PIC X.
  5794*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 107
* EL050.cbl
  5795*CIDMOD         16  FILLER                         PIC X(192).
  5796         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5797             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5798         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5799         16  CF-ST-VFY-2ND-BENE             PIC X.
  5800         16  CF-ST-CAUSAL-STATE             PIC X.
  5801         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5802         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  5803         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5804             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5805         16  CF-ST-NET-ONLY-STATE           PIC X.
  5806             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5807         16  cf-commission-cap-required     pic x.
  5808         16  CF-ST-GA-COMMISSION-CAPS.
  5809             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  5810             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  5811             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  5812             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  5813         16  CF-ST-TOT-COMMISSION-CAPS.
  5814             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  5815             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  5816             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  5817             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  5818         16  FILLER                         PIC X(156).
  5819
  5820****************************************************************
  5821*             BENEFIT MASTER RECORD                            *
  5822****************************************************************
  5823
  5824     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5825         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5826             20  CF-BENEFIT-CODE            PIC XX.
  5827             20  CF-BENEFIT-NUMERIC  REDEFINES
  5828                 CF-BENEFIT-CODE            PIC XX.
  5829             20  CF-BENEFIT-ALPHA           PIC XXX.
  5830             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5831             20  CF-BENEFIT-COMMENT         PIC X(10).
  5832
  5833             20  CF-LF-COVERAGE-TYPE        PIC X.
  5834                 88  CF-REDUCING                VALUE 'R'.
  5835                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5836
  5837             20  CF-SPECIAL-CALC-CD         PIC X.
  5838                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5839                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5840                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5841                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5842                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5843                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5844                 88  CF-FARM-PLAN               VALUE 'F'.
  5845                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5846                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5847                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5848                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5849                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5850                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5851                 88  CF-PRUDENTIAL              VALUE 'P'.
  5852                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 108
* EL050.cbl
  5853                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5854                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5855                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5856                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5857                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5858
  5859             20  CF-JOINT-INDICATOR         PIC X.
  5860                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5861
  5862*            20  FILLER                     PIC X(12).
  5863             20  cf-maximum-benefits        pic s999 comp-3.
  5864             20  FILLER                     PIC X(09).
  5865             20  CF-BENEFIT-CATEGORY        PIC X.
  5866             20  CF-LOAN-TYPE               PIC X(8).
  5867
  5868             20  CF-CO-REM-TERM-CALC        PIC X.
  5869                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5870                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5871                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5872                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5873                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5874
  5875             20  CF-CO-EARNINGS-CALC        PIC X.
  5876                 88  CO-EARN-BY-R78             VALUE '1'.
  5877                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5878                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5879                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5880                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5881                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5882                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5883                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5884
  5885             20  CF-CO-REFUND-CALC          PIC X.
  5886                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5887                 88  CO-REFD-BY-R78             VALUE '1'.
  5888                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5889                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5890                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5891                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5892                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5893                 88  CO-REFD-MEAN               VALUE '8'.
  5894                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5895                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5896                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5897
  5898             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5899                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5900                 88  CO-OVRD-BY-R78             VALUE '1'.
  5901                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5902                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5903                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5904                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5905                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5906                 88  CO-OVRD-MEAN               VALUE '8'.
  5907                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5908
  5909             20  CF-CO-BEN-I-G-CD           PIC X.
  5910                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 109
* EL050.cbl
  5911                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5912                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5913
  5914         16  FILLER                         PIC X(304).
  5915
  5916
  5917****************************************************************
  5918*             CARRIER MASTER RECORD                            *
  5919****************************************************************
  5920
  5921     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5922         16  CF-ADDRESS-DATA.
  5923             20  CF-MAIL-TO-NAME            PIC X(30).
  5924             20  CF-IN-CARE-OF              PIC X(30).
  5925             20  CF-ADDRESS-LINE-1          PIC X(30).
  5926             20  CF-ADDRESS-LINE-2          PIC X(30).
  5927             20  CF-CITY-STATE              PIC X(30).
  5928             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5929             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5930
  5931         16  CF-CLAIM-NO-CONTROL.
  5932             20  CF-CLAIM-NO-METHOD         PIC X.
  5933                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5934                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5935                 88  CLAIM-NO-SEQ               VALUE '3'.
  5936                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5937             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5938                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5939                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5940                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5941
  5942         16  CF-CHECK-NO-CONTROL.
  5943             20  CF-CHECK-NO-METHOD         PIC X.
  5944                 88  CHECK-NO-MANUAL            VALUE '1'.
  5945                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5946                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5947                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5948             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5949                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5950
  5951         16  CF-DOMICILE-STATE              PIC XX.
  5952
  5953         16  CF-EXPENSE-CONTROLS.
  5954             20  CF-EXPENSE-METHOD          PIC X.
  5955                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5956                 88  DOLLARS-PER-PMT            VALUE '2'.
  5957                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5958                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5959             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5960             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5961
  5962         16  CF-CORRESPONDENCE-CONTROL.
  5963             20  CF-LETTER-RESEND-OPT       PIC X.
  5964                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5965                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5966             20  FILLER                     PIC X(4).
  5967
  5968         16  CF-RESERVE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 110
* EL050.cbl
  5969             20  CF-MANUAL-SW               PIC X.
  5970                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5971             20  CF-FUTURE-SW               PIC X.
  5972                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5973             20  CF-PTC-SW                  PIC X.
  5974                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5975             20  CF-IBNR-SW                 PIC X.
  5976                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5977             20  CF-PTC-LF-SW               PIC X.
  5978                 88  CF-LF-PTC-USED             VALUE '1'.
  5979             20  CF-CDT-ACCESS-METHOD       PIC X.
  5980                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5981                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5982                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5983             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5984
  5985         16  CF-CLAIM-CALC-METHOD           PIC X.
  5986             88  360-PLUS-MONTHS                VALUE '1'.
  5987             88  365-PLUS-MONTHS                VALUE '2'.
  5988             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5989             88  360-DAILY                      VALUE '4'.
  5990             88  365-DAILY                      VALUE '5'.
  5991
  5992         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5993         16  FILLER                         PIC X(11).
  5994
  5995         16  CF-LIMIT-AMOUNTS.
  5996             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5997             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5998             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5999             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  6000             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  6001             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  6002             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  6003             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  6004             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  6005             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  6006
  6007         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  6008         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  6009         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  6010
  6011         16  CF-ZIP-CODE.
  6012             20  CF-ZIP-PRIME.
  6013                 24  CF-ZIP-1ST             PIC X.
  6014                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6015                 24  FILLER                 PIC X(4).
  6016             20  CF-ZIP-PLUS4               PIC X(4).
  6017         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  6018             20  CF-CAN-POSTAL-1            PIC XXX.
  6019             20  CF-CAN-POSTAL-2            PIC XXX.
  6020             20  FILLER                     PIC XXX.
  6021
  6022         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  6023         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  6024         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  6025
  6026         16  CF-RATING-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 111
* EL050.cbl
  6027             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  6028             88  CF-NO-RATING                   VALUE 'N'.
  6029
  6030         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  6031
  6032         16  CF-CARRIER-OVER-SHORT.
  6033             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  6034             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  6035
  6036         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  6037         16  CF-SECPAY-SWITCH               PIC X.
  6038             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  6039             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  6040         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  6041         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  6042         16  FILLER                         PIC X(444).
  6043*        16  FILLER                         PIC X(452).
  6044
  6045
  6046****************************************************************
  6047*             MORTALITY MASTER RECORD                          *
  6048****************************************************************
  6049
  6050     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6051         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  6052                                INDEXED BY CF-MORT-NDX.
  6053             20  CF-MORT-TABLE              PIC X(5).
  6054             20  CF-MORT-TABLE-TYPE         PIC X.
  6055                 88  CF-MORT-JOINT              VALUE 'J'.
  6056                 88  CF-MORT-SINGLE             VALUE 'S'.
  6057                 88  CF-MORT-COMBINED           VALUE 'C'.
  6058                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  6059                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  6060             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  6061             20  CF-MORT-AGE-METHOD         PIC XX.
  6062                 88  CF-AGE-LAST                VALUE 'AL'.
  6063                 88  CF-AGE-NEAR                VALUE 'AN'.
  6064             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  6065             20  CF-MORT-ADJUSTMENT-DIRECTION
  6066                                            PIC X.
  6067                 88  CF-MINUS                   VALUE '-'.
  6068                 88  CF-PLUS                    VALUE '+'.
  6069             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  6070             20  CF-MORT-JOINT-CODE         PIC X.
  6071                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  6072             20  CF-MORT-PC-Q               PIC X.
  6073                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  6074             20  CF-MORT-TABLE-CODE         PIC X(4).
  6075             20  CF-MORT-COMMENTS           PIC X(15).
  6076             20  FILLER                     PIC X(14).
  6077
  6078         16  FILLER                         PIC X(251).
  6079
  6080
  6081****************************************************************
  6082*             BUSSINESS TYPE MASTER RECORD                     *
  6083****************************************************************
  6084
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 112
* EL050.cbl
  6085     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6086* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  6087* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  6088* AND RECORD 05 IS TYPES 81-99
  6089         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  6090             20  CF-BUSINESS-TITLE          PIC  X(19).
  6091             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  6092                                            PIC S9V9(4) COMP-3.
  6093             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  6094             20  FILLER                     PIC  X.
  6095         16  FILLER                         PIC  X(248).
  6096
  6097
  6098****************************************************************
  6099*             TERMINAL MASTER RECORD                           *
  6100****************************************************************
  6101
  6102     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6103
  6104         16  CF-COMPANY-TERMINALS.
  6105             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  6106                                  PIC X(4).
  6107         16  FILLER               PIC X(248).
  6108
  6109
  6110****************************************************************
  6111*             LIFE EDIT MASTER RECORD                          *
  6112****************************************************************
  6113
  6114     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6115         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  6116             20  CF-LIFE-CODE-IN            PIC XX.
  6117             20  CF-LIFE-CODE-OUT           PIC XX.
  6118         16  FILLER                         PIC X(248).
  6119
  6120
  6121****************************************************************
  6122*             AH EDIT MASTER RECORD                            *
  6123****************************************************************
  6124
  6125     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6126         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  6127             20  CF-AH-CODE-IN              PIC XXX.
  6128             20  CF-AH-CODE-OUT             PIC XX.
  6129         16  FILLER                         PIC X(248).
  6130
  6131
  6132****************************************************************
  6133*             CREDIBILITY TABLES                               *
  6134****************************************************************
  6135
  6136     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6137         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  6138                             INDEXED BY CF-CRDB-NDX.
  6139             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  6140             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  6141             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  6142         16  FILLER                         PIC  X(332).
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 113
* EL050.cbl
  6143
  6144
  6145****************************************************************
  6146*             REPORT CUSTOMIZATION RECORD                      *
  6147****************************************************************
  6148
  6149     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6150         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6151             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6152             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6153             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6154**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6155****       A T-TRANSFER.                                   ****
  6156             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  6157
  6158         16  FILLER                         PIC XX.
  6159
  6160         16  CF-CARRIER-CNTL-OPT.
  6161             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6162                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6163                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  6164             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6165                                            PIC X.
  6166         16  CF-GROUP-CNTL-OPT.
  6167             20  CF-GROUP-OPT-SEQ           PIC 9.
  6168                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6169                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6170             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6171                                            PIC X(6).
  6172         16  CF-STATE-CNTL-OPT.
  6173             20  CF-STATE-OPT-SEQ           PIC 9.
  6174                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6175                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6176             20  CF-STATE-SELECT OCCURS 3 TIMES
  6177                                            PIC XX.
  6178         16  CF-ACCOUNT-CNTL-OPT.
  6179             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6180                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6181                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6182             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6183                                            PIC X(10).
  6184         16  CF-BUS-TYP-CNTL-OPT.
  6185             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6186                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6187                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6188             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6189                                            PIC XX.
  6190         16  CF-LF-TYP-CNTL-OPT.
  6191             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6192                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6193                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6194             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6195                                            PIC XX.
  6196         16  CF-AH-TYP-CNTL-OPT.
  6197             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6198                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6199                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6200             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 114
* EL050.cbl
  6201                                            PIC XX.
  6202         16  CF-REPTCD1-CNTL-OPT.
  6203             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6204                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6205                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6206             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6207                                            PIC X(10).
  6208         16  CF-REPTCD2-CNTL-OPT.
  6209             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6210                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6211                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6212             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6213                                            PIC X(10).
  6214         16  CF-USER1-CNTL-OPT.
  6215             20  CF-USER1-OPT-SEQ           PIC 9.
  6216                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6217                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6218             20  CF-USER1-SELECT OCCURS 3 TIMES
  6219                                            PIC X(10).
  6220         16  CF-USER2-CNTL-OPT.
  6221             20  CF-USER2-OPT-SEQ           PIC 9.
  6222                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6223                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6224             20  CF-USER2-SELECT OCCURS 3 TIMES
  6225                                            PIC X(10).
  6226         16  CF-USER3-CNTL-OPT.
  6227             20  CF-USER3-OPT-SEQ           PIC 9.
  6228                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6229                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6230             20  CF-USER3-SELECT OCCURS 3 TIMES
  6231                                            PIC X(10).
  6232         16  CF-USER4-CNTL-OPT.
  6233             20  CF-USER4-OPT-SEQ           PIC 9.
  6234                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6235                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6236             20  CF-USER4-SELECT OCCURS 3 TIMES
  6237                                            PIC X(10).
  6238         16  CF-USER5-CNTL-OPT.
  6239             20  CF-USER5-OPT-SEQ           PIC 9.
  6240                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6241                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6242             20  CF-USER5-SELECT OCCURS 3 TIMES
  6243                                            PIC X(10).
  6244         16  CF-REINS-CNTL-OPT.
  6245             20  CF-REINS-OPT-SEQ           PIC 9.
  6246                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6247                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6248             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6249                 24  CF-REINS-PRIME         PIC XXX.
  6250                 24  CF-REINS-SUB           PIC XXX.
  6251
  6252         16  CF-AGENT-CNTL-OPT.
  6253             20  CF-AGENT-OPT-SEQ           PIC 9.
  6254                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6255                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6256             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6257                                            PIC X(10).
  6258
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 115
* EL050.cbl
  6259         16  FILLER                         PIC X(43).
  6260
  6261         16  CF-LOSS-RATIO-SELECT.
  6262             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6263             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6264         16  CF-ENTRY-DATE-SELECT.
  6265             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6266             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6267         16  CF-EFFECTIVE-DATE-SELECT.
  6268             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6269             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6270
  6271         16  CF-EXCEPTION-LIST-IND          PIC X.
  6272             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6273
  6274         16  FILLER                         PIC X(318).
  6275
  6276****************************************************************
  6277*                  EXCEPTION REPORTING RECORD                  *
  6278****************************************************************
  6279
  6280     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6281         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6282             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6283
  6284         16  CF-COMBINED-LIFE-AH-OPT.
  6285             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6286             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6287             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6288             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6289
  6290         16  CF-LIFE-OPT.
  6291             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6292             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6293             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6294             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6295             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6296             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6297             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6298             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6299             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6300             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6301
  6302         16  CF-AH-OPT.
  6303             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6304             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6305             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6306             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6307             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6308             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6309             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6310             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6311             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6312             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6313
  6314         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6315             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6316             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 116
* EL050.cbl
  6317             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6318
  6319         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6320
  6321         16  FILLER                         PIC X(673).
  6322
  6323
  6324****************************************************************
  6325*             MORTGAGE SYSTEM PLAN RECORD                      *
  6326****************************************************************
  6327
  6328     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6329         16  CF-PLAN-TYPE                   PIC X.
  6330             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6331             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6332             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6333         16  CF-PLAN-ABBREV                 PIC XXX.
  6334         16  CF-PLAN-DESCRIPT               PIC X(10).
  6335         16  CF-PLAN-NOTES                  PIC X(20).
  6336         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6337         16  CF-PLAN-UNDERWRITING.
  6338             20  CF-PLAN-TERM-DATA.
  6339                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6340                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6341             20  CF-PLAN-AGE-DATA.
  6342                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6343                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6344                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6345             20  CF-PLAN-BENEFIT-DATA.
  6346                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6347                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6348                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6349                                            PIC S9(7)V99  COMP-3.
  6350         16  CF-PLAN-POLICY-FORMS.
  6351             20  CF-POLICY-FORM             PIC X(12).
  6352             20  CF-MASTER-APPLICATION      PIC X(12).
  6353             20  CF-MASTER-POLICY           PIC X(12).
  6354         16  CF-PLAN-RATING.
  6355             20  CF-RATE-CODE               PIC X(5).
  6356             20  CF-SEX-RATING              PIC X.
  6357                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6358                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6359             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6360             20  CF-SUB-STD-TYPE            PIC X.
  6361                 88  CF-PCT-OF-PREM            VALUE '1'.
  6362                 88  CF-PCT-OF-BENE            VALUE '2'.
  6363         16  CF-PLAN-PREM-TOLERANCES.
  6364             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6365             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6366         16  CF-PLAN-PYMT-TOLERANCES.
  6367             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6368             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6369         16  CF-PLAN-MISC-DATA.
  6370             20  FILLER                     PIC X.
  6371             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6372             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6373         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6374         16  CF-PLAN-IND-GRP                PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 117
* EL050.cbl
  6375             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6376                                                     '1'.
  6377             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6378                                                     '2'.
  6379         16  CF-MIB-SEARCH-SW               PIC X.
  6380             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6381             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6382             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6383             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6384         16  CF-ALPHA-SEARCH-SW             PIC X.
  6385             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6386             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6387             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6388             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6389             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6390             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6391             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6392             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6393             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6394             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6395                                                     'A' 'B' 'C'
  6396                                                     'X' 'Y' 'Z'.
  6397         16  CF-EFF-DT-RULE-SW              PIC X.
  6398             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6399             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6400             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6401             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6402             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6403         16  FILLER                         PIC X(4).
  6404         16  CF-HEALTH-QUESTIONS            PIC X.
  6405             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6406         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6407         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6408         16  CF-PLAN-SNGL-JNT               PIC X.
  6409             88  CF-COMBINED-PLAN              VALUE 'C'.
  6410             88  CF-JNT-PLAN                   VALUE 'J'.
  6411             88  CF-SNGL-PLAN                  VALUE 'S'.
  6412         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6413         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6414         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6415         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6416         16  CF-RERATE-CNTL                 PIC  X.
  6417             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6418             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6419             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6420             88  CF-AUTO-RECALC                 VALUE '4'.
  6421         16  CF-BENEFIT-TYPE                PIC  X.
  6422             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6423             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6424         16  CF-POLICY-FEE                  PIC S999V99
  6425                                                    COMP-3.
  6426         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6427         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6428         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6429         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6430         16  FILLER                         PIC  X(32).
  6431         16  CF-TERMINATION-FORM            PIC  X(04).
  6432         16  FILLER                         PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 118
* EL050.cbl
  6433         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6434                                                       COMP-3.
  6435         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6436         16  CF-ISSUE-LETTER                PIC  X(4).
  6437         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6438         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6439             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6440             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6441         16  CF-MP-REFUND-CALC              PIC X.
  6442             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6443             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6444             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6445             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6446             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6447             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6448             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6449             88  CF-MP-REFD-MEAN                VALUE '8'.
  6450         16  CF-ALT-RATE-CODE               PIC  X(5).
  6451
  6452
  6453         16  FILLER                         PIC X(498).
  6454****************************************************************
  6455*             MORTGAGE COMPANY MASTER RECORD                   *
  6456****************************************************************
  6457
  6458     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6459         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6460         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6461             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6462             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6463             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6464             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6465             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6466
  6467         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6468         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6469         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6470         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6471         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6472
  6473         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6474             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6475         16  CF-MP-RECON-USE-IND            PIC X(1).
  6476             88  CF-MP-USE-RECON             VALUE 'Y'.
  6477         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6478             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6479         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6480             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6481             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6482         16  FILLER                         PIC X(1).
  6483         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6484             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6485         16  CF-MORTG-MIB-VERSION           PIC X.
  6486             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6487             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6488             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6489         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6490             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 119
* EL050.cbl
  6491                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6492             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6493                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6494             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6495                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6496             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6497                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6498             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6499                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6500             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6501                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6502         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6503         16  FILLER                         PIC X(7).
  6504         16  CF-MORTG-DESTINATION-SYMBOL.
  6505             20  CF-MORTG-MIB-COMM          PIC X(5).
  6506             20  CF-MORTG-MIB-TERM          PIC X(5).
  6507         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6508             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6509         16  FILLER                         PIC X(03).
  6510         16  CF-MP-CHECK-NO-CONTROL.
  6511             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6512                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6513                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6514                                                ' ' LOW-VALUES.
  6515                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6516                                               VALUE '3'.
  6517         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6518         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6519         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6520             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6521                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6522             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6523                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6524             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6525                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6526             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6527                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6528             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6529                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6530             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6531                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6532         16  CF-MORTG-BILLING-AREA.
  6533             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6534                                            PIC X.
  6535         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6536         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6537         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6538         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6539             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6540             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6541         16  FILLER                         PIC X.
  6542         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6543             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6544             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6545         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6546         16  FILLER                         PIC X(8).
  6547         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6548         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 120
* EL050.cbl
  6549         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6550         16  CF-ACH-COMPANY-ID.
  6551             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6552                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6553                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6554                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6555             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6556         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6557             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6558         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6559             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6560             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6561         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6562         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6563         16  FILLER                         PIC X(536).
  6564
  6565****************************************************************
  6566*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6567****************************************************************
  6568
  6569     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6570         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6571             20  CF-FEMALE-HEIGHT.
  6572                 24  CF-FEMALE-FT           PIC 99.
  6573                 24  CF-FEMALE-IN           PIC 99.
  6574             20  CF-FEMALE-MIN-WT           PIC 999.
  6575             20  CF-FEMALE-MAX-WT           PIC 999.
  6576         16  FILLER                         PIC X(428).
  6577
  6578     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6579         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6580             20  CF-MALE-HEIGHT.
  6581                 24  CF-MALE-FT             PIC 99.
  6582                 24  CF-MALE-IN             PIC 99.
  6583             20  CF-MALE-MIN-WT             PIC 999.
  6584             20  CF-MALE-MAX-WT             PIC 999.
  6585         16  FILLER                         PIC X(428).
  6586******************************************************************
  6587*             AUTOMATIC ACTIVITY RECORD                          *
  6588******************************************************************
  6589     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6590         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6591             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6592             20  CF-SYS-LETTER-ID           PIC X(04).
  6593             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6594             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6595             20  CF-SYS-RESET-SW            PIC X(01).
  6596             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6597             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6598
  6599         16  FILLER                         PIC X(50).
  6600
  6601         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6602             20  CF-USER-ACTIVE-SW          PIC X(01).
  6603             20  CF-USER-LETTER-ID          PIC X(04).
  6604             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6605             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6606             20  CF-USER-RESET-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 121
* EL050.cbl
  6607             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6608             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6609             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6610
  6611         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 122
* EL050.cbl
  6613*    COPY ERCACCT.
  6614******************************************************************
  6615*                                                                *
  6616*                                                                *
  6617*                            ERCACCT                             *
  6618*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6619*                            VMOD=2.031                          *
  6620*                                                                *
  6621*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6622*                                                                *
  6623*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6624*   VSAM ACCOUNT MASTER FILES.                                   *
  6625*                                                                *
  6626*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6627*                                                                *
  6628*   FILE TYPE = VSAM,KSDS                                        *
  6629*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6630*                                                                *
  6631*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6632*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6633*                                                                *
  6634*   LOG = NO                                                     *
  6635*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6636*                                                                *
  6637*                                                                *
  6638******************************************************************
  6639*                   C H A N G E   L O G
  6640*
  6641* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6642*-----------------------------------------------------------------
  6643*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6644* EFFECTIVE    NUMBER
  6645*-----------------------------------------------------------------
  6646* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6647* 092705    2005050300006  PEMA  ADD SPP LEASES
  6648* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6649* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6650* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6651* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6652* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6653* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6654******************************************************************
  6655
  6656 01  ACCOUNT-MASTER.
  6657     12  AM-RECORD-ID                      PIC XX.
  6658         88  VALID-AM-ID                      VALUE 'AM'.
  6659
  6660     12  AM-CONTROL-PRIMARY.
  6661         16  AM-COMPANY-CD                 PIC X.
  6662         16  AM-MSTR-CNTRL.
  6663             20  AM-CONTROL-A.
  6664                 24  AM-CARRIER            PIC X.
  6665                 24  AM-GROUPING.
  6666                     28 AM-GROUPING-PREFIX PIC XXX.
  6667                     28 AM-GROUPING-PRIME  PIC XXX.
  6668                 24  AM-STATE              PIC XX.
  6669                 24  AM-ACCOUNT.
  6670                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 123
* EL050.cbl
  6671                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6672             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6673                                           PIC X(19).
  6674             20  AM-CNTRL-B.
  6675                 24  AM-EXPIRATION-DT      PIC XX.
  6676                 24  FILLER                PIC X(4).
  6677             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6678                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6679
  6680     12  AM-CONTROL-BY-VAR-GRP.
  6681         16  AM-COMPANY-CD-A1              PIC X.
  6682         16  AM-VG-CARRIER                 PIC X.
  6683         16  AM-VG-GROUPING                PIC X(6).
  6684         16  AM-VG-STATE                   PIC XX.
  6685         16  AM-VG-ACCOUNT                 PIC X(10).
  6686         16  AM-VG-DATE.
  6687             20  AM-VG-EXPIRATION-DT       PIC XX.
  6688             20  FILLER                    PIC X(4).
  6689         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6690                                           PIC 9(11)      COMP-3.
  6691     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6692         16  FILLER                        PIC X(10).
  6693         16  AM-VG-KEY3.
  6694             20  AM-VG3-ACCOUNT            PIC X(10).
  6695             20  AM-VG3-EXP-DT             PIC XX.
  6696         16  FILLER                        PIC X(4).
  6697     12  AM-MAINT-INFORMATION.
  6698         16  AM-LAST-MAINT-DT              PIC XX.
  6699         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6700         16  AM-LAST-MAINT-USER            PIC X(4).
  6701         16  FILLER                        PIC XX.
  6702
  6703     12  AM-EFFECTIVE-DT                   PIC XX.
  6704     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6705
  6706     12  AM-PREV-DATES  COMP-3.
  6707         16  AM-PREV-EXP-DT                PIC 9(11).
  6708         16  AM-PREV-EFF-DT                PIC 9(11).
  6709
  6710     12  AM-REPORT-CODE-1                  PIC X(10).
  6711     12  AM-REPORT-CODE-2                  PIC X(10).
  6712
  6713     12  AM-CITY-CODE                      PIC X(4).
  6714     12  AM-COUNTY-PARISH                  PIC X(6).
  6715
  6716     12  AM-NAME                           PIC X(30).
  6717     12  AM-PERSON                         PIC X(30).
  6718     12  AM-ADDRS                          PIC X(30).
  6719     12  AM-CITY.
  6720         16  AM-ADDR-CITY                  PIC X(28).
  6721         16  AM-ADDR-STATE                 PIC XX.
  6722     12  AM-ZIP.
  6723         16  AM-ZIP-PRIME.
  6724             20  AM-ZIP-PRI-1ST            PIC X.
  6725                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6726             20  FILLER                    PIC X(4).
  6727         16  AM-ZIP-PLUS4                  PIC X(4).
  6728     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 124
* EL050.cbl
  6729         16  AM-CAN-POSTAL-1               PIC XXX.
  6730         16  AM-CAN-POSTAL-2               PIC XXX.
  6731         16  FILLER                        PIC XXX.
  6732     12  AM-TEL-NO.
  6733         16  AM-AREA-CODE                  PIC 999.
  6734         16  AM-TEL-PRE                    PIC 999.
  6735         16  AM-TEL-NBR                    PIC 9(4).
  6736     12  AM-TEL-LOC                        PIC X.
  6737         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6738         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6739
  6740     12  AM-COMM-STRUCTURE.
  6741         16  AM-DEFN-1.
  6742             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6743                 24  AM-AGT.
  6744                     28  AM-AGT-PREFIX     PIC X(4).
  6745                     28  AM-AGT-PRIME      PIC X(6).
  6746                 24  AM-COM-TYP            PIC X.
  6747                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6748                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6749                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6750                 24  AM-RECALC-LV-INDIC    PIC X.
  6751                 24  AM-RETRO-LV-INDIC     PIC X.
  6752                 24  AM-GL-CODES           PIC X.
  6753                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6754                 24  FILLER                PIC X(01).
  6755         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6756             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6757                 24  FILLER                PIC X(11).
  6758                 24  AM-L-COMA             PIC XXX.
  6759                 24  AM-J-COMA             PIC XXX.
  6760                 24  AM-A-COMA             PIC XXX.
  6761                 24  FILLER                PIC X(6).
  6762
  6763     12  AM-COMM-CHANGE-STATUS             PIC X.
  6764         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6765
  6766     12  AM-CSR-CODE                       PIC X(4).
  6767
  6768     12  AM-BILLING-STATUS                 PIC X.
  6769         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6770         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6771     12  AM-AUTO-REFUND-SW                 PIC X.
  6772         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6773         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6774     12  AM-GPCD                           PIC 99.
  6775     12  AM-IG                             PIC X.
  6776         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6777         88  AM-HAS-GROUP                     VALUE '2'.
  6778     12  AM-STATUS                         PIC X.
  6779         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6780         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6781         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6782         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6783         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6784         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6785         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6786         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 125
* EL050.cbl
  6787         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6788         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6789     12  AM-REMIT-TO                       PIC 99.
  6790     12  AM-ID-NO                          PIC X(11).
  6791
  6792     12  AM-CAL-TABLE                      PIC XX.
  6793     12  AM-LF-DEVIATION                   PIC XXX.
  6794     12  AM-AH-DEVIATION                   PIC XXX.
  6795     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6796     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6797     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6798     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6799     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6800     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6801
  6802     12  AM-USER-FIELDS.
  6803         16  AM-FLD-1                      PIC XX.
  6804         16  AM-FLD-2                      PIC XX.
  6805         16  AM-FLD-3                      PIC XX.
  6806         16  AM-FLD-4                      PIC XX.
  6807         16  AM-FLD-5                      PIC XX.
  6808
  6809     12  AM-1ST-PROD-DATE.
  6810         16  AM-1ST-PROD-YR                PIC XX.
  6811         16  AM-1ST-PROD-MO                PIC XX.
  6812         16  AM-1ST-PROD-DA                PIC XX.
  6813     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6814     12  AM-CERTS-PURGED-DATE.
  6815         16  AM-PUR-YR                     PIC XX.
  6816         16  AM-PUR-MO                     PIC XX.
  6817         16  AM-PUR-DA                     PIC XX.
  6818     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6819     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6820     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6821     12  AM-INACTIVE-DATE.
  6822         16  AM-INA-MO                     PIC 99.
  6823         16  AM-INA-DA                     PIC 99.
  6824         16  AM-INA-YR                     PIC 99.
  6825     12  AM-AR-HI-CERT-DATE                PIC XX.
  6826
  6827     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6828     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6829
  6830     12  AM-OB-PAYMENT-MODE                PIC X.
  6831         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6832         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6833         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6834         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6835
  6836     12  AM-AH-ONLY-INDICATOR              PIC X.
  6837         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6838         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6839
  6840     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6841
  6842     12  AM-OVER-SHORT.
  6843         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6844         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 126
* EL050.cbl
  6845
  6846     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6847     12  AM-DCC-CLP-STATE                  PIC XX.
  6848
  6849     12  AM-RECALC-COMM                    PIC X.
  6850     12  AM-RECALC-REIN                    PIC X.
  6851
  6852     12  AM-REI-TABLE                      PIC XXX.
  6853     12  AM-REI-ET-LF                      PIC X.
  6854     12  AM-REI-ET-AH                      PIC X.
  6855     12  AM-REI-PE-LF                      PIC X.
  6856     12  AM-REI-PE-AH                      PIC X.
  6857     12  AM-REI-PRT-ST                     PIC X.
  6858     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6859     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6860     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6861     12  AM-REI-GROUP-A                    PIC X(6).
  6862     12  AM-REI-MORT                       PIC X(4).
  6863     12  AM-REI-PRT-OW                     PIC X.
  6864     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6865     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6866     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6867     12  AM-REI-GROUP-B                    PIC X(6).
  6868
  6869     12  AM-TRUST-TYPE                     PIC X(2).
  6870
  6871     12  AM-EMPLOYER-STMT-USED             PIC X.
  6872     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6873
  6874     12  AM-STD-AH-TYPE                    PIC XX.
  6875     12  AM-EARN-METHODS.
  6876         16  AM-EARN-METHOD-R              PIC X.
  6877             88 AM-REF-RL-R78                 VALUE 'R'.
  6878             88 AM-REF-RL-PR                  VALUE 'P'.
  6879             88 AM-REF-RL-MEAN                VALUE 'M'.
  6880             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6881         16  AM-EARN-METHOD-L              PIC X.
  6882             88 AM-REF-LL-R78                 VALUE 'R'.
  6883             88 AM-REF-LL-PR                  VALUE 'P'.
  6884             88 AM-REF-LL-MEAN                VALUE 'M'.
  6885             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6886         16  AM-EARN-METHOD-A              PIC X.
  6887             88 AM-REF-AH-R78                 VALUE 'R'.
  6888             88 AM-REF-AH-PR                  VALUE 'P'.
  6889             88 AM-REF-AH-MEAN                VALUE 'M'.
  6890             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6891             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6892             88 AM-REF-AH-NET                 VALUE 'N'.
  6893
  6894     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6895     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6896     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6897
  6898     12  AM-RET-Y-N                        PIC X.
  6899     12  AM-RET-P-E                        PIC X.
  6900     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6901     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6902     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 127
* EL050.cbl
  6903     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6904         16  AM-POOL-PRIME                 PIC XXX.
  6905         16  AM-POOL-SUB                   PIC XXX.
  6906     12  AM-RETRO-EARNINGS.
  6907         16  AM-RET-EARN-R                 PIC X.
  6908         16  AM-RET-EARN-L                 PIC X.
  6909         16  AM-RET-EARN-A                 PIC X.
  6910     12  AM-RET-ST-TAX-USE                 PIC X.
  6911         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6912         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6913     12  AM-RETRO-BEG-EARNINGS.
  6914         16  AM-RET-BEG-EARN-R             PIC X.
  6915         16  AM-RET-BEG-EARN-L             PIC X.
  6916         16  AM-RET-BEG-EARN-A             PIC X.
  6917     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6918     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6919
  6920     12  AM-USER-SELECT-OPTIONS.
  6921         16  AM-USER-SELECT-1              PIC X(10).
  6922         16  AM-USER-SELECT-2              PIC X(10).
  6923         16  AM-USER-SELECT-3              PIC X(10).
  6924         16  AM-USER-SELECT-4              PIC X(10).
  6925         16  AM-USER-SELECT-5              PIC X(10).
  6926
  6927     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6928
  6929     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6930
  6931     12  AM-RPT045A-SWITCH                 PIC X.
  6932         88  RPT045A-OFF                   VALUE 'N'.
  6933
  6934     12  AM-INSURANCE-LIMITS.
  6935         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6936         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6937
  6938     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6939         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6940
  6941     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6942         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6943         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6944
  6945     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6946
  6947     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6948     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6949     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6950     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6951     12  AM-DCC-UEF-STATE                  PIC XX.
  6952     12  FILLER                            PIC XXX.
  6953     12  AM-REPORT-CODE-3                  PIC X(10).
  6954*    12  FILLER                            PIC X(22).
  6955
  6956     12  AM-RESERVE-DATE.
  6957         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6958         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6959         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6960
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 128
* EL050.cbl
  6961     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6962     12  AM-NOTIFICATION-TYPES.
  6963         16  AM-NOTIF-OF-LETTERS           PIC X.
  6964         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6965         16  AM-NOTIF-OF-REPORTS           PIC X.
  6966         16  AM-NOTIF-OF-STATUS            PIC X.
  6967
  6968     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6969         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6970         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6971         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6972         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6973
  6974     12  AM-BENEFIT-CONTROLS.
  6975         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6976             20  AM-BENEFIT-CODE           PIC XX.
  6977             20  AM-BENEFIT-TYPE           PIC X.
  6978             20  AM-BENEFIT-REVISION       PIC XXX.
  6979             20  AM-BENEFIT-REM-TERM       PIC X.
  6980             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6981             20  FILLER                    PIC XX.
  6982         16  FILLER                        PIC X(80).
  6983
  6984     12  AM-TRANSFER-DATA.
  6985         16  AM-TRANSFERRED-FROM.
  6986             20  AM-TRNFROM-CARRIER        PIC X.
  6987             20  AM-TRNFROM-GROUPING.
  6988                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6989                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6990             20  AM-TRNFROM-STATE          PIC XX.
  6991             20  AM-TRNFROM-ACCOUNT.
  6992                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6993                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6994             20  AM-TRNFROM-DTE            PIC XX.
  6995         16  AM-TRANSFERRED-TO.
  6996             20  AM-TRNTO-CARRIER          PIC X.
  6997             20  AM-TRNTO-GROUPING.
  6998                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6999                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  7000             20  AM-TRNTO-STATE            PIC XX.
  7001             20  AM-TRNTO-ACCOUNT.
  7002                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  7003                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  7004             20  AM-TRNTO-DTE              PIC XX.
  7005         16  FILLER                        PIC X(10).
  7006
  7007     12  AM-SAVED-REMIT-TO                 PIC 99.
  7008
  7009     12  AM-COMM-STRUCTURE-SAVED.
  7010         16  AM-DEFN-1-SAVED.
  7011             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  7012                 24  AM-AGT-SV             PIC X(10).
  7013                 24  AM-COM-TYP-SV         PIC X.
  7014                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  7015                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  7016                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  7017                 24  AM-RECALC-LV-INDIC-SV PIC X.
  7018                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 129
* EL050.cbl
  7019                 24  AM-GL-CODES-SV        PIC X.
  7020                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  7021                 24  FILLER                PIC X.
  7022         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  7023             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  7024                 24  FILLER                PIC X(11).
  7025                 24  AM-L-COMA-SV          PIC XXX.
  7026                 24  AM-J-COMA-SV          PIC XXX.
  7027                 24  AM-A-COMA-SV          PIC XXX.
  7028                 24  FILLER                PIC X(6).
  7029
  7030     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  7031         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  7032            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  7033            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  7034            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  7035
  7036     12  AM-ORIG-DEALER-NO                 PIC X(10).
  7037     12  FILLER                            PIC X(120).
  7038
  7039     12  AM-ACCOUNT-EXECUTIVE-DATA.
  7040         16  AM-CONTROL-NAME               PIC X(30).
  7041         16  AM-EXECUTIVE-ONE.
  7042             20  AM-EXEC1-NAME             PIC X(15).
  7043             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  7044                                                          COMP-3.
  7045             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  7046                                                          COMP-3.
  7047         16  AM-EXECUTIVE-TWO.
  7048             20  AM-EXEC2-NAME             PIC X(15).
  7049             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  7050                                                          COMP-3.
  7051             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  7052                                                          COMP-3.
  7053
  7054     12  AM-RETRO-ADDITIONAL-DATA.
  7055         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  7056         16  AM-RETRO-PREM-P-E             PIC X.
  7057         16  AM-RETRO-CLMS-P-I             PIC X.
  7058         16  AM-RETRO-RET-BRACKET-LF.
  7059             20  AM-RETRO-RET-METHOD-LF    PIC X.
  7060                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  7061                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  7062             20  AM-RETRO-RET-BASIS-LF     PIC X.
  7063                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  7064                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  7065             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  7066                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  7067                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  7068         16  AM-RETRO-RET-BRACKET-AH.
  7069             20  AM-RETRO-RET-METHOD-AH    PIC X.
  7070                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  7071                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  7072                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  7073             20  AM-RETRO-RET-BASIS-AH     PIC X.
  7074                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  7075                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  7076             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 130
* EL050.cbl
  7077                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  7078                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  7079
  7080     12  AM-COMMENTS.
  7081         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  7082
  7083     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  7084         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  7085         16  AM-FLI-BILLING-CODE           PIC X.
  7086         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  7087         16  AM-FLI-UNITED-IDENT           PIC X.
  7088         16  AM-FLI-INTEREST-LOST-DATA.
  7089             20  AM-FLI-BANK-NO            PIC X(5).
  7090             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  7091             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  7092             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  7093         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  7094             20  AM-FLI-AGT                PIC X(9).
  7095             20  AM-FLI-AGT-COMM-ACC       PIC X.
  7096             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  7097         16  FILLER                        PIC X(102).
  7098
  7099     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  7100         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  7101             20  AM-BENEFIT-DMD-CODE         PIC XX.
  7102             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7103             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7104             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7105             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7106         16  FILLER                          PIC X(10).
  7107******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 131
* EL050.cbl
  7109*    COPY ERCREIN.
  7110******************************************************************
  7111*                                                                *
  7112*                            ERCREIN                             *
  7113*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7114*                            VMOD=2.010                          *
  7115*                                                                *
  7116*   ONLINE CREDIT SYSTEM                                         *
  7117*                                                                *
  7118*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  7119*                                                                *
  7120*   FILE TYPE = VSAM,KSDS                                        *
  7121*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  7122*                                                                *
  7123*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  7124*       ALTERNATE PATH = NONE                                    *
  7125*                                                                *
  7126*   LOG = NO                                                     *
  7127*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7128*                                                                *
  7129******************************************************************
  7130*                   C H A N G E   L O G
  7131*
  7132* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7133*-----------------------------------------------------------------
  7134*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7135* EFFECTIVE    NUMBER
  7136*-----------------------------------------------------------------
  7137* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  7138* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  7139******************************************************************
  7140 01  REINSURANCE-RECORD.
  7141     12  RE-RECORD-ID                      PIC XX.
  7142         88  VALID-RE-ID                      VALUE 'RE'.
  7143
  7144     12  RE-CONTROL-PRIMARY.
  7145         16  RE-COMPANY-CD                 PIC X.
  7146         16  RE-KEY.
  7147             20  RE-CODE                   PIC X.
  7148                 88  RE-TABLE-RECORD          VALUE 'A'.
  7149                 88  RE-COMPANY-RECORD        VALUE 'B'.
  7150             20  RE-TABLE                  PIC XXX.
  7151             20  FILLER                    PIC XXX.
  7152         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  7153             20  FILLER                    PIC X.
  7154             20  RE-COMPANY.
  7155                 24  RE-COMP-PRIME         PIC XXX.
  7156                 24  RE-COMP-SUB           PIC XXX.
  7157
  7158     12  RE-MAINT-INFORMATION.
  7159         16  RE-LAST-MAINT-DT              PIC XX.
  7160         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7161         16  RE-LAST-MAINT-USER            PIC X(4).
  7162         16  FILLER                        PIC X(10).
  7163
  7164     12  RE-TABLE-DATA.
  7165         16  RE-100-COMP                   PIC 99.
  7166
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 132
* EL050.cbl
  7167         16  RE-COMP-INFO    OCCURS 30 TIMES.
  7168             20  RE-REI-COMP-NO.
  7169                 24  RE-REI-COMP           PIC XXX.
  7170                 24  RE-REI-COMP-SUB       PIC XXX.
  7171             20  RE-LF-QC                  PIC X.
  7172             20  RE-AH-QC                  PIC X.
  7173             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  7174             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  7175             20  RE-LFAGE-LO               PIC 99.
  7176             20  RE-LFAGE-HI               PIC 99.
  7177             20  RE-AHAGE-LO               PIC 99.
  7178             20  RE-AHAGE-HI               PIC 99.
  7179             20  RE-LFTRM-LO               PIC S999       COMP-3.
  7180             20  RE-LFTRM-HI               PIC S999       COMP-3.
  7181             20  RE-AHTRM-LO               PIC S999       COMP-3.
  7182             20  RE-AHTRM-HI               PIC S999       COMP-3.
  7183             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  7184             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  7185             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  7186             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  7187             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  7188             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  7189             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  7190             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  7191             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  7192             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  7193             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  7194             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  7195             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  7196             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  7197             20  RE-LF-BEN-CODE            PIC X.
  7198             20  RE-AH-BEN-CODE            PIC X.
  7199             20  RE-INTERACTIVE            PIC X.
  7200             20  RE-REMAINING              PIC X.
  7201             20  RE-LF-RUNOFF-SW           PIC X.
  7202             20  RE-AH-RUNOFF-SW           PIC X.
  7203             20  FILLER                    PIC X(19).
  7204
  7205         16  RE-COMP-INFO-END              PIC X(6).
  7206         16  RE-NSP-ST-CD-LF               PIC XX.
  7207         16  RE-NSP-ST-CD-AH               PIC XX.
  7208         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7209             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7210
  7211         16  FILLER                        PIC X(27).
  7212
  7213     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7214         16  RE-NAME                       PIC X(30).
  7215         16  RE-LF-PE                      PIC X.
  7216         16  RE-AH-PE                      PIC X.
  7217         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7218         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7219         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7220         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7221         16  RE-PRT-ST                     PIC X.
  7222         16  RE-PRT-OW                     PIC X.
  7223         16  RE-MORT-CODE                  PIC X(4).
  7224         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 133
* EL050.cbl
  7225         16  RE-ZERO-LF-FEE                PIC X.
  7226         16  RE-ZERO-AH-FEE                PIC X.
  7227         16  RE-CEDE-NAME                  PIC X(30).
  7228         16  RE-LF-COMM                    PIC X.
  7229         16  RE-AH-COMM                    PIC X.
  7230         16  RE-LF-TAX                     PIC X.
  7231         16  RE-AH-TAX                     PIC X.
  7232         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7233         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7234         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7235
  7236         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7237             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7238
  7239         16  RE-LF-CEDING-FEE-BRACKETS.
  7240             20  RE-LF-FEE-METHOD          PIC X.
  7241                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7242                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7243                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7244                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7245             20  RE-LF-FEE-BASIS           PIC X.
  7246                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7247                 88  RE-LF-NET-CEDED               VALUE '2'.
  7248                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7249                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7250                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7251                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7252                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7253                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7254             20  FILLER                    PIC XXX.
  7255             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7256                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7257                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7258
  7259         16  RE-AH-CEDING-FEE-BRACKETS.
  7260             20  RE-AH-FEE-METHOD          PIC X.
  7261                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7262                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7263                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7264                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7265             20  RE-AH-FEE-BASIS           PIC X.
  7266                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7267                 88  RE-AH-NET-CEDED               VALUE '2'.
  7268                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7269                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7270                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7271                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7272                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7273                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7274             20  FILLER                    PIC XXX.
  7275             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7276                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7277                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7278
  7279         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7280
  7281         16  RE-OLD-CEDING-STMT            PIC X.
  7282
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 134
* EL050.cbl
  7283         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7284         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7285         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7286         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7287         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7288         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7289         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7290         16  RE-MORT-SW                    PIC X.
  7291         16  RE-CEDING-TYPE-FLAG           PIC X.
  7292             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7293             88  RE-CEDED                          VALUE 'C'.
  7294             88  RE-ASSUMED                        VALUE 'A'.
  7295             88  RE-PHANTOM                        VALUE 'P'.
  7296
  7297         16  RE-CEDING-STMT-OPT-A          PIC X.
  7298             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7299         16  RE-CEDING-STMT-OPT-B          PIC X.
  7300             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7301         16  RE-CEDING-STMT-OPT-C          PIC X.
  7302             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7303         16  RE-CEDING-STMT-OPT-D          PIC X.
  7304             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7305         16  RE-CEDING-STMT-OPT-E          PIC X.
  7306             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7307
  7308         16  RE-PRT-CRSV                   PIC X.
  7309
  7310         16  RE-GL-CENTER                  PIC X(4).
  7311
  7312         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7313
  7314         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7315
  7316         16  RE-EARN-STOP-CODE             PIC X.
  7317             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7318             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7319
  7320         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7321             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7322
  7323         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7324         16  FILLER                        PIC X(2281).
  7325
  7326         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7327
  7328******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 135
* EL050.cbl
  7330*    COPY ERCCTBL.
  7331******************************************************************
  7332*                                                                *
  7333*                                                                *
  7334*                            ERCCTBL                             *
  7335*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7336*                            VMOD=2.003
  7337*                                                                *
  7338*   ONLINE CREDIT SYSTEM                                         *
  7339*                                                                *
  7340*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7341*                                                                *
  7342*   FILE TYPE = VSAM,KSDS                                        *
  7343*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7344*                                                                *
  7345*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7346*       ALTERNATE PATH = NONE                                    *
  7347*                                                                *
  7348*   LOG = NO                                                     *
  7349*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7350*                                                                *
  7351*                                                                *
  7352******************************************************************
  7353
  7354 01  COMM-TABLE-RECORD.
  7355     12  CT-RECORD-ID                      PIC XX.
  7356         88  VALID-CT-ID                      VALUE 'CT'.
  7357
  7358     12  CT-CONTROL-PRIMARY.
  7359         16  CT-COMPANY-CD                 PIC X.
  7360         16  CT-TABLE                      PIC XXX.
  7361         16  CT-CNTRL-2.
  7362             20  CT-BEN-TYPE               PIC X.
  7363             20  CT-BEN-CODE               PIC XX.
  7364
  7365     12  CT-MAINT-INFORMATION.
  7366         16  CT-LAST-MAINT-DT              PIC XX.
  7367         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7368         16  CT-LAST-MAINT-USER            PIC X(4).
  7369         16  FILLER                        PIC X(31).
  7370
  7371     12  CT-LIMITS.
  7372         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7373
  7374         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7375
  7376         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7377
  7378     12  CT-RATES.
  7379         16  CT-RTX          OCCURS 27 TIMES.
  7380             20  CT-RT                     PIC SV9(5)     COMP-3.
  7381             20  CT-RT-R   REDEFINES
  7382                 CT-RT                     PIC XXX.
  7383
  7384     12  FILLER                            PIC  X(42).
  7385
  7386******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 136
* EL050.cbl
  7388*    COPY ERCFORM.
  7389******************************************************************
  7390*                                                                *
  7391*                                                                *
  7392*                            ERCFORM.                            *
  7393*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7394*                            VMOD=2.003                          *
  7395*                                                                *
  7396*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7397*                                                                *
  7398*    FILE TYPE = VSAM,KSDS                                       *
  7399*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7400*                                                                *
  7401*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7402*                                                                *
  7403*    LOG = YES                                                   *
  7404*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7405******************************************************************
  7406 01  FORM-MASTER.
  7407    12  FO-RECORD-ID                 PIC X(02).
  7408        88  VALID-FO-ID                  VALUE 'FO'.
  7409
  7410    12  FO-CONTROL-PRIMARY.
  7411        16  FO-COMPANY-CD            PIC X(01).
  7412        16  FO-STATE                 PIC X(02).
  7413        16  FO-FORM-ID               PIC X(12).
  7414        16  FO-FORM-EXP-DT           PIC X(02).
  7415
  7416    12  FO-POLICY-FORM-DATA.
  7417        16  FO-IND-GRP-CD            PIC X(01).
  7418        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7419        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7420        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7421        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7422        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7423        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7424        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7425        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7426        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7427        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7428        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7429        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7430        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7431        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7432        16  FO-APP-CERT-USE-CD       PIC X(01).
  7433
  7434    12  FILLER                       PIC X(29).
  7435
  7436    12  FO-FORM-PLAN-TABLE.
  7437        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7438            20  FO-PLAN-TYPE         PIC X(01).
  7439            20  FO-PLAN-ID           PIC X(02).
  7440            20  FO-PLAN-TERM         PIC 9(03).
  7441            20  FO-PLAN-REFUND-METHOD
  7442                                     PIC X.
  7443
  7444    12  FILLER                       PIC X(30).
  7445
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 137
* EL050.cbl
  7446    12  FO-COMMENTS-AREA.
  7447        16  FO-COMMENT-LINE-1        PIC X(78).
  7448
  7449    12  FILLER                       PIC X(20).
  7450
  7451    12  FO-MAINT-INFORMATION.
  7452        16  FO-LAST-MAINT-DT         PIC X(02).
  7453        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7454        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 138
* EL050.cbl
  7456*    COPY ELCMSTR.
  7457******************************************************************
  7458*                                                                *
  7459*                            ELCMSTR.                            *
  7460*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7461*                            VMOD=2.012                          *
  7462*                                                                *
  7463*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7464*                                                                *
  7465*   FILE TYPE = VSAM,KSDS                                        *
  7466*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7467*                                                                *
  7468*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7469*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7470*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7471*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7472*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7473*                                                 RKP=75,LEN=21  *
  7474*                                                                *
  7475*   **** NOTE ****                                               *
  7476*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7477*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7478*                                                                *
  7479*   LOG = YES                                                    *
  7480*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7481******************************************************************
  7482*                   C H A N G E   L O G
  7483*
  7484* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7485*-----------------------------------------------------------------
  7486*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7487* EFFECTIVE    NUMBER
  7488*-----------------------------------------------------------------
  7489* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7490* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7491* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7492* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7493* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7494* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  7495******************************************************************
  7496 01  CLAIM-MASTER.
  7497     12  CL-RECORD-ID                PIC XX.
  7498         88  VALID-CL-ID         VALUE 'CL'.
  7499
  7500     12  CL-CONTROL-PRIMARY.
  7501         16  CL-COMPANY-CD           PIC X.
  7502         16  CL-CARRIER              PIC X.
  7503         16  CL-CLAIM-NO             PIC X(7).
  7504         16  CL-CERT-NO.
  7505             20  CL-CERT-PRIME       PIC X(10).
  7506             20  CL-CERT-SFX         PIC X.
  7507
  7508     12  CL-CONTROL-BY-NAME.
  7509         16  CL-COMPANY-CD-A1        PIC X.
  7510         16  CL-INSURED-LAST-NAME    PIC X(15).
  7511         16  CL-INSURED-NAME.
  7512             20  CL-INSURED-1ST-NAME PIC X(12).
  7513             20  CL-INSURED-MID-INIT PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 139
* EL050.cbl
  7514
  7515     12  CL-CONTROL-BY-SSN.
  7516         16  CL-COMPANY-CD-A2        PIC X.
  7517         16  CL-SOC-SEC-NO.
  7518             20  CL-SSN-STATE        PIC XX.
  7519             20  CL-SSN-ACCOUNT      PIC X(6).
  7520             20  CL-SSN-LN3          PIC X(3).
  7521
  7522     12  CL-CONTROL-BY-CERT-NO.
  7523         16  CL-COMPANY-CD-A4        PIC X.
  7524         16  CL-CERT-NO-A4.
  7525             20  CL-CERT-A4-PRIME    PIC X(10).
  7526             20  CL-CERT-A4-SFX      PIC X.
  7527
  7528     12  CL-CONTROL-BY-CCN.
  7529         16  CL-COMPANY-CD-A5        PIC X.
  7530         16  CL-CCN-A5.
  7531             20  CL-CCN.
  7532                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7533                 24  CL-CCN-PRIME-A5 PIC X(12).
  7534             20  CL-CCN-FILLER-A5    PIC X(4).
  7535
  7536     12  CL-INSURED-PROFILE-DATA.
  7537         16  CL-INSURED-BIRTH-DT     PIC XX.
  7538         16  CL-INSURED-SEX-CD       PIC X.
  7539             88  INSURED-IS-MALE        VALUE 'M'.
  7540             88  INSURED-IS-FEMALE      VALUE 'F'.
  7541             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7542         16  CL-INSURED-OCC-CD       PIC X(6).
  7543         16  FILLER                  PIC X(5).
  7544
  7545     12  CL-PROCESSING-INFO.
  7546         16  CL-PROCESSOR-ID         PIC X(4).
  7547         16  CL-CLAIM-STATUS         PIC X.
  7548             88  CLAIM-IS-OPEN          VALUE 'O'.
  7549             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7550         16  CL-CLAIM-TYPE           PIC X.
  7551*            88  AH-CLAIM               VALUE 'A'.
  7552*            88  LIFE-CLAIM             VALUE 'L'.
  7553*            88  PROPERTY-CLAIM         VALUE 'P'.
  7554*            88  IUI-CLAIM              VALUE 'I'.
  7555*            88  GAP-CLAIM              VALUE 'G'.
  7556*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7557         16  CL-CLAIM-PREM-TYPE      PIC X.
  7558             88  SINGLE-PREMIUM         VALUE '1'.
  7559             88  O-B-COVERAGE           VALUE '2'.
  7560             88  OPEN-END-COVERAGE      VALUE '3'.
  7561         16  CL-INCURRED-DT          PIC XX.
  7562         16  CL-REPORTED-DT          PIC XX.
  7563         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7564         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7565         16  CL-LAST-PMT-DT          PIC XX.
  7566         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7567         16  CL-PAID-THRU-DT         PIC XX.
  7568         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7569         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7570         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7571         16  CL-PMT-CALC-METHOD      PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 140
* EL050.cbl
  7572             88  CL-360-DAY-YR          VALUE '1'.
  7573             88  CL-365-DAY-YR          VALUE '2'.
  7574             88  CL-FULL-MONTHS         VALUE '3'.
  7575         16  CL-CAUSE-CD             PIC X(6).
  7576
  7577         16  CL-PRIME-CERT-NO.
  7578             20  CL-PRIME-CERT-PRIME PIC X(10).
  7579             20  CL-PRIME-CERT-SFX   PIC X.
  7580
  7581         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7582             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7583             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7584
  7585         16  CL-MICROFILM-NO         PIC X(10).
  7586         16  FILLER REDEFINES CL-MICROFILM-NO.
  7587             20  CL-BENEFIT-PERIOD   PIC 99.
  7588             20  FILLER              PIC X(8).
  7589         16  CL-PROG-FORM-TYPE       PIC X.
  7590         16  CL-LAST-ADD-ON-DT       PIC XX.
  7591
  7592         16  CL-LAST-REOPEN-DT       PIC XX.
  7593         16  CL-LAST-CLOSE-DT        PIC XX.
  7594         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7595             88  FINAL-PAID             VALUE '1'.
  7596             88  CLAIM-DENIED           VALUE '2'.
  7597             88  AUTO-CLOSE             VALUE '3'.
  7598             88  MANUAL-CLOSE           VALUE '4'.
  7599             88  BENEFITS-CHANGED       VALUE 'C'.
  7600             88  SETUP-ERRORS           VALUE 'E'.
  7601         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7602         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7603         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7604             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7605         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7606         16  FILLER                  PIC X.
  7607
  7608     12  CL-CERTIFICATE-DATA.
  7609         16  CL-CERT-ORIGIN          PIC X.
  7610             88  CERT-WAS-ONLINE        VALUE '1'.
  7611             88  CERT-WAS-CREATED       VALUE '2'.
  7612             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7613         16  CL-CERT-KEY-DATA.
  7614             20  CL-CERT-CARRIER     PIC X.
  7615             20  CL-CERT-GROUPING    PIC X(6).
  7616             20  CL-CERT-STATE       PIC XX.
  7617             20  CL-CERT-ACCOUNT.
  7618                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7619                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7620             20  CL-CERT-EFF-DT      PIC XX.
  7621
  7622     12  CL-STATUS-CONTROLS.
  7623         16  CL-PRIORITY-CD          PIC X.
  7624             88  CONFIDENTIAL-DATA      VALUE '8'.
  7625             88  HIGHEST-PRIORITY       VALUE '9'.
  7626         16  CL-SUPV-ATTN-CD         PIC X.
  7627             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7628             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7629         16  CL-PURGED-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 141
* EL050.cbl
  7630         16  CL-RESTORED-DT          PIC XX.
  7631         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7632         16  CL-NEXT-RESEND-DT       PIC XX.
  7633         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7634         16  CL-CRITICAL-PERIOD      PIC 99.
  7635*        16  FILLER                  PIC XX.
  7636         16  CL-LAST-MAINT-DT        PIC XX.
  7637         16  CL-LAST-MAINT-USER      PIC X(4).
  7638         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7639         16  CL-LAST-MAINT-TYPE      PIC X.
  7640             88  CLAIM-SET-UP           VALUE ' '.
  7641             88  PAYMENT-MADE           VALUE '1'.
  7642             88  LETTER-SENT            VALUE '2'.
  7643             88  MASTER-WAS-ALTERED     VALUE '3'.
  7644             88  MASTER-WAS-RESTORED    VALUE '4'.
  7645             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7646             88  FILE-CONVERTED         VALUE '6'.
  7647             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7648             88  ERROR-CORRECTION       VALUE 'E'.
  7649         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7650         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7651         16  CL-BENEFICIARY          PIC X(10).
  7652         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7653         16  CL-DENIAL-TYPE          PIC X.
  7654             88  CL-TYPE-DENIAL          VALUE '1'.
  7655             88  CL-TYPE-RESCISSION      VALUE '2'.
  7656             88  CL-TYPE-REFORMATION     VALUE '3'.
  7657             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7658             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7659         16  CL-NO-OF-EXTENSIONS     PIC 99.
  7660         16  filler                  pic x(3).
  7661*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7662*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7663*        16  CL-RTW-DT               PIC XX.
  7664
  7665     12  CL-TRAILER-CONTROLS.
  7666         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7667             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7668             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7669             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7670         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7671         16  FILLER                  PIC XX.
  7672         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7673         16  CL-ADDRESS-TRAILER-CNT.
  7674             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7675                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7676             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7677                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7678             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7679                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7680             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7681                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7682             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7683                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7684             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7685                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7686             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7687                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 142
* EL050.cbl
  7688
  7689     12  CL-CV-REFERENCE-NO.
  7690         16  CL-CV-REFNO-PRIME       PIC X(18).
  7691         16  CL-CV-REFNO-SFX         PIC XX.
  7692
  7693     12  CL-FILE-LOCATION            PIC X(4).
  7694
  7695     12  CL-PROCESS-ERRORS.
  7696         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7697             88  NO-FATAL-ERRORS        VALUE ZERO.
  7698         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7699             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7700
  7701     12  CL-PRODUCT-CD               PIC X.
  7702
  7703     12  CL-CURRENT-KEY-DATA.
  7704         16  CL-CURRENT-CARRIER      PIC X.
  7705         16  CL-CURRENT-GROUPING     PIC X(6).
  7706         16  CL-CURRENT-STATE        PIC XX.
  7707         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7708
  7709     12  CL-ASSOCIATES               PIC X.
  7710         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7711         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7712         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7713         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7714
  7715     12  CL-ACTIVITY-CODE            PIC 99.
  7716     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7717     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7718
  7719     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7720     12  CL-LAG-REPORT-CODE          PIC 9.
  7721     12  CL-LOAN-TYPE                PIC XX.
  7722     12  CL-LEGAL-STATE              PIC XX.
  7723
  7724     12  CL-YESNOSW                  PIC X.
  7725     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7726         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7727         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7728         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7729     12  cl-insured-type             pic x.
  7730         88  cl-claim-on-primary         value 'P'.
  7731         88  cl-claim-on-co-borrower     value 'C'.
  7732     12  cl-benefit-expiration-dt    PIC XX.
  7733
  7734 01  PLAN-RECORDS.
  7735     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7736     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7737
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 143
* EL050.cbl
  7739 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7740                          ACCOUNT-MASTER REINSURANCE-RECORD
  7741                          COMM-TABLE-RECORD FORM-MASTER
  7742                          CLAIM-MASTER PLAN-RECORDS.
  7743 0000-DFHEXIT SECTION.
  7744     MOVE '9#                    $   ' TO DFHEIV0.
  7745     MOVE 'EL050' TO DFHEIV1.
  7746     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7747
  7748     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7749
  7750
  7751* EXEC CICS  HANDLE CONDITION
  7752*           ERROR    (9300-ABEND)
  7753*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7754*    END-EXEC.
  7755*    MOVE '"$.J                  ! " #00007746' TO DFHEIV0
  7756     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7757     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7758     MOVE X'2220233030303037373436' TO DFHEIV0(25:11)
  7759     CALL 'kxdfhei1' USING DFHEIV0
  7760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7761
  7762
  7763 0000-COPY-PROCEDURE-DIV.
  7764*                          COPY ELC50PD.
  7765******************************************************************
  7766*                                                                *
  7767*                            ELC50PD                             *
  7768*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7769*                            VMOD=2.188                          *
  7770*                                                                *
  7771******************************************************************
  7772*                   C H A N G E   L O G
  7773*
  7774* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7775*-----------------------------------------------------------------
  7776*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7777* EFFECTIVE    NUMBER
  7778*-----------------------------------------------------------------
  7779* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7780* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7781* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7782*                             2709 AND 2718
  7783* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7784* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7785* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7786* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7787* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7788*                                IS OPEN OR CNC DT < PD THRU
  7789* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7790* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7791* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7792* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7793* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7794* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7795* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7796* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 144
* EL050.cbl
  7797* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7798* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7799* 020906                   PEMA  EXPAND LOAN OFFICER
  7800* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7801* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7802* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7803* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7804* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7805* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7806* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7807* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7808* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7809* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7810* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7811* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7812* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7813* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7814* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7815* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7816* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7817* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7818* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7819* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7820* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7821* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7822* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7823* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7824* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7825*                                UPDATE VIN ON CERT TRAILER
  7826* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7827* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7828* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7829* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7830* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7831* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7832* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7833* 040610  IR2010030800001  PEMA  INIT Alternate BENEFIT
  7834* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7835* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7836* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7837* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7838* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7839* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7840* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7841* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7842* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7843* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7844* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7845* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7846* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7847* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7848* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7849* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7850* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7851* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7852* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7853* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7854* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 145
* EL050.cbl
  7855* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7856* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7857* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7858* 032912  CR2011110200001  PEMA  AHL CHANGES
  7859* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7860* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7861* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7862* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7863* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7864* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7865* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7866* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7867* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7868* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7869* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7870* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7871* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7872* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7873* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7874* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7875* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7876* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7877* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7878* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7879* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
  7880* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7881* 052114  IR2014042900002  PEMA  CORRECT CANCEL EDIT ON VOIDS
  7882* 051914  CR2014043000002  TANA  ADD CAUSAL STATE
  7883* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  7884* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  7885* 100114  IR2014100100003  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
  7886*                                CERT #, ADD 2898 FORCIBLE ERROR
  7887* 100214  IR2014100100002  PEMA  CHG WAY CAR7 CLP IS CALCED
  7888* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  7889* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
  7890* 121815  CR2015121700006  PEMA  ADD HANDLING FOR FOREIGN VINS
  7891* 010416  CR2015082600001  PEMA  ADD CID and DCC TO MON CODE
  7892* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  7893* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
  7894* 021916  CR2014010900001  TANA  ADD ACCT STATUS D,L,R,P
  7895* 032516  IR2016032100002  PEMA  Correct tolerance for DCC.
  7896* 041816  CR2009093000001  PEMA  enhance car, st lvl prem taxes
  7897* 052516  IR2016052400001  PEMA  Correct malformed IF stmt.
  7898* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
  7899* 052317  IR2017052300001  PEMA  Correct malformed conditional stm
  7900* 062717  IR2017061900003  PEMA  Fix 0% APR on refunds
  7901* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  7902* 100617  CR2017062000003  PEMA  New comm cap edits
  7903******************************************************************
  7904************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7905******************************************************************
  7906
  7907     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7908
  7909     MOVE SPACES                 TO PB-FATAL-FLAG
  7910                                    PB-FORCE-ER-CD
  7911                                    PB-WARN-ER-CD
  7912                                    PB-OUT-BAL-CD.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 146
* EL050.cbl
  7913
  7914     MOVE SPACE                  TO WS-IG-OVRD-AH
  7915                                    WS-IG-OVRD-LF
  7916                                    WS-IG-OVRD-AM
  7917                                    WS-IG-OVRD
  7918                                    WS-IG-OVRD-AH-PL
  7919                                    WS-IG-OVRD-LF-PL
  7920                                    WS-IG-OVRD-AH-BEN
  7921                                    WS-IG-OVRD-LF-BEN.
  7922
  7923******************************************************************
  7924*************       INITIALIZE COMMON ERRORS       ***************
  7925******************************************************************
  7926
  7927     MOVE +0                     TO PB-NO-OF-ERRORS.
  7928     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7929
  7930******************************************************************
  7931
  7932     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7933     SET JULIAN-TO-BIN           TO TRUE.
  7934*    MOVE 5                      TO DC-OPTION-CODE.
  7935     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7936     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7937
  7938     MOVE ZERO                   TO  SUB4.
  7939
  7940 0040-INITIALIZE-GA-BILL-DT.
  7941
  7942     ADD +1                      TO  SUB4.
  7943
  7944     IF  SUB4 GREATER THAN +5
  7945         GO TO 0050-CHECK-CNTL-FOUND.
  7946
  7947     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7948         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7949
  7950     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7951
  7952 0050-CHECK-CNTL-FOUND.
  7953
  7954     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7955        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7956                                         WS-AH-REM-TERM-CALC
  7957                                         EC-CO-REM-TERM-CALC
  7958        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7959        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7960        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7961                                         WS-TOL-AH-CLAIM
  7962        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7963                                         WS-TOL-AH-PREM
  7964                                         EC-CO-TOL-PREM
  7965        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7966                                         WS-TOL-AH-REFUND
  7967                                         EC-CO-TOL-REFUND
  7968        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7969                                         WS-AH-REFUND-OVS-AMT
  7970                                         EC-CO-OVR-SHT-AMT
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 147
* EL050.cbl
  7971        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7972                                         WS-TOL-AH-PREM-PCT
  7973                                         EC-CO-TOL-PREM-PCT
  7974        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7975                                         WS-TOL-AH-REFUND-PCT
  7976                                         EC-CO-TOL-REFUND-PCT
  7977        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7978                                         WS-AH-REFUND-OVS-PCT
  7979                                         EC-CO-OVR-SHT-PCT
  7980        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7981        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7982        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7983        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7984        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7985        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7986        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7987        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7988        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7989        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7990        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7991        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7992                                         EC-CO-MONTH-END-DT
  7993        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7994          GO TO 0100-READ-ACCT.
  7995
  7996     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7997     MOVE SPACES                 TO CNTL-ACCESS.
  7998     MOVE '1'                    TO CNTL-REC-TYPE.
  7999     MOVE +0                     TO CNTL-SEQ-NO.
  8000
  8001     MOVE '1' TO RC-SW-1.
  8002     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  8003     IF NOT CF-COMPANY-MASTER
  8004         MOVE ZEROS             TO WK-CO-TOL-PREM
  8005                                   WK-CO-TOL-CLAIM
  8006                                   WK-CO-TOL-REFUND
  8007                                   WK-REFUND-OVS-AMT
  8008                                   WK-REFUND-OVS-PCT
  8009                                   WK-CO-TOL-PREM-PCT
  8010                                   WK-CO-TOL-REFUND-PCT
  8011                                   WK-DEFAULT-APR
  8012                                   WK-CO-MAX-CAP
  8013        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  8014                                   WK-CR-R78-METHOD
  8015                                   WK-CO-REF-REJECT-SW
  8016                                   WK-CO-PREM-REJECT-SW
  8017                                   WK-REM-TRM-CALC-OPTION
  8018                                   WK-BIRTH-DATE-INPUT
  8019                                   WK-JOINT-AGE-INPUT
  8020        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  8021        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  8022        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  8023        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  8024          GO TO 0099-COMPANY-NOT-FOUND.
  8025
  8026     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  8027        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  8028     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 148
* EL050.cbl
  8029        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  8030     IF CF-CO-TOL-CAP NOT NUMERIC
  8031        MOVE +0                    TO CF-CO-TOL-CAP.
  8032     IF CF-DEFAULT-APR NOT NUMERIC
  8033        MOVE +0                    TO CF-DEFAULT-APR.
  8034
  8035     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  8036     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  8037     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  8038     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  8039     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  8040     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  8041     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  8042     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  8043     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  8044     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  8045     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  8046     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  8047
  8048     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  8049          CF-CO-OVR-SHT-AMT > +0
  8050        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  8051
  8052     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  8053          CF-CO-OVR-SHT-PCT > +0
  8054        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  8055
  8056     IF CF-VALID-REM-TRM-OPTION
  8057         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  8058     ELSE
  8059         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  8060
  8061     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  8062     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  8063     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  8064     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  8065
  8066     GO TO 0050-CHECK-CNTL-FOUND.
  8067
  8068 0099-COMPANY-NOT-FOUND.
  8069
  8070     MOVE ER-2616                TO WS-ERROR.
  8071     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8072
  8073 0100-READ-ACCT.
  8074
  8075     MOVE SPACES                 TO DATE-RANGE-SW.
  8076
  8077     IF WK-ACCT-ADDR = ZEROS
  8078        GO TO 0102-ACCT-GETMAIN.
  8079
  8080     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  8081     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  8082     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8083
  8084     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8085        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8086        GO TO 0105-READ-ACCT
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 149
* EL050.cbl
  8087     END-IF
  8088
  8089     IF PB-CARRIER NOT = SPACES
  8090        IF PB-CARRIER NOT = AM-VG-CARRIER
  8091           GO TO 0105-READ-ACCT.
  8092
  8093     IF PB-STATE NOT = SPACES
  8094        IF PB-STATE NOT = AM-VG-STATE
  8095           GO TO 0105-READ-ACCT.
  8096
  8097     IF PB-GROUPING NOT = SPACES
  8098        IF PB-GROUPING NOT = AM-VG-GROUPING
  8099           GO TO 0105-READ-ACCT.
  8100
  8101     MOVE 'X'                 TO DATE-RANGE-SW.
  8102
  8103     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8104        MOVE 'X'                 TO DATE-RANGE-SW
  8105        GO TO 0105-READ-ACCT.
  8106
  8107     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8108        GO TO 0105-READ-ACCT.
  8109
  8110     GO TO 0180-ACCOUNT-FOUND.
  8111
  8112 0102-ACCT-GETMAIN.
  8113     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  8114     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  8115
  8116 0105-READ-ACCT.
  8117     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  8118     MOVE PB-CARRIER             TO ACCT-CARRIER.
  8119     MOVE PB-GROUPING            TO ACCT-GROUPING.
  8120     MOVE PB-STATE               TO ACCT-STATE.
  8121     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  8122     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  8123
  8124     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  8125
  8126     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  8127
  8128 0110-FIND-ACCT-TOLERANCES-LOOP.
  8129     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  8130
  8131     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8132        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8133        GO TO 0199-ACCT-NOT-FOUND
  8134     END-IF
  8135     IF PB-CARRIER NOT = SPACES
  8136        IF PB-CARRIER NOT = AM-VG-CARRIER
  8137           GO TO 0199-ACCT-NOT-FOUND.
  8138
  8139     IF PB-STATE NOT = SPACES
  8140        IF PB-STATE NOT = AM-VG-STATE
  8141           GO TO 0199-ACCT-NOT-FOUND.
  8142
  8143     IF PB-GROUPING NOT = SPACES
  8144        IF PB-GROUPING NOT = AM-VG-GROUPING
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 150
* EL050.cbl
  8145           GO TO 0199-ACCT-NOT-FOUND.
  8146
  8147     MOVE 'X'                    TO DATE-RANGE-SW.
  8148
  8149     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8150        MOVE 'X'                 TO DATE-RANGE-SW
  8151        GO TO 0199-ACCT-NOT-FOUND.
  8152
  8153     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8154        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  8155
  8156 0180-ACCOUNT-FOUND.
  8157     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  8158     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  8159     MOVE AM-STATE               TO PB-SV-STATE.
  8160     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  8161
  8162     IF AM-CANCEL-FEE  NOT NUMERIC
  8163        MOVE ZEROS TO AM-CANCEL-FEE.
  8164
  8165     IF AM-MAX-MON-BEN NOT NUMERIC
  8166        MOVE ZEROS TO AM-MAX-MON-BEN.
  8167
  8168     IF AM-MAX-TOT-BEN NOT NUMERIC
  8169        MOVE ZEROS TO AM-MAX-TOT-BEN.
  8170
  8171     IF AM-CLP-TOL-PCT NOT NUMERIC
  8172        MOVE +0                  TO AM-CLP-TOL-PCT
  8173     END-IF
  8174     IF AM-SPP-LEASE-COMM NOT NUMERIC
  8175        MOVE +0                  TO AM-SPP-LEASE-COMM
  8176     END-IF
  8177     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8178        MOVE ER-2611             TO   WS-ERROR
  8179        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8180
  8181     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8182        MOVE ER-2621             TO   WS-ERROR
  8183        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8184
  8185     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  8186        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  8187        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  8188        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  8189         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  8190
  8191     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  8192     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  8193     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  8194     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  8195     IF AM-CLP-TOL-PCT NOT = ZEROS
  8196        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  8197     END-IF
  8198     IF AM-SPP-LEASE-COMM NOT = ZEROS
  8199        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  8200     END-IF
  8201*    IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8202*       MOVE +0                  TO WS-ACCT-ADDL-CLP
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 151
* EL050.cbl
  8203*                                   WS-ADMIN-FEES
  8204*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  8205*          (SUB5 > +10)
  8206*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8207*             AND (AM-A-COM (SUB5) NUMERIC)
  8208*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8209*                + (AM-A-COM (SUB5) * 1000)
  8210*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8211*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8212*                + (AM-A-COM (SUB5) * 1000)
  8213*             END-IF
  8214*             IF AM-COM-TYP (SUB5) = 'N'
  8215*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8216*                + (AM-A-COM (SUB5) * 1000)
  8217*             END-IF
  8218*          END-IF
  8219*       END-PERFORM
  8220*    END-IF
  8221     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  8222        AND (PB-ISSUE)
  8223        MOVE +0                  TO WS-ACCT-ADDL-CLP
  8224                                    ws-cred-union-fees
  8225        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8226           (SUB5 > +10)
  8227           MOVE +0 TO WS-WK-RATE
  8228           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N' OR
  8229                                   'O' OR 'S')
  8230              IF (AM-A-COM (SUB5) NUMERIC)
  8231                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8232                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8233              ELSE
  8234                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8235                 IF PB-ISSUE
  8236                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8237                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8238                 ELSE
  8239                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8240                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8241                 END-IF
  8242                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8243                 MOVE ZEROS             TO WS-SUB1
  8244                                           WS-COMMISSION
  8245                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8246                 MOVE '0530'               TO CTBL-SW
  8247                 MOVE ' '                  TO WS-CTBL-READ-SW
  8248                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8249                 IF FIRST-TIME-THROUGH
  8250                    MOVE 'AA'              TO CTBL-BEN-CODE
  8251                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8252                 END-IF
  8253                 IF CTBL-TABLE-FOUND
  8254                    IF PB-ISSUE
  8255                       COMPUTE WS-COMM-CK-AMT =
  8256                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8257                    ELSE
  8258                       COMPUTE WS-COMM-CK-AMT =
  8259                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8260                    END-IF
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 152
* EL050.cbl
  8261                    PERFORM 8800-GET-COMP-RATE
  8262                              THRU 8800-EXIT
  8263                 END-IF
  8264              END-IF
  8265              if am-com-typ (sub5) = 'O' or 'S'
  8266                 compute ws-cred-union-fees rounded =
  8267                    ws-cred-union-fees +
  8268                    (pb-i-ah-premium-amt * ws-wk-rate)
  8269              else
  8270                 COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8271                + (WS-WK-RATE * 1000)
  8272              end-if
  8273           END-IF
  8274        END-PERFORM
  8275     END-IF
  8276     IF PB-COMPANY-ID EQUAL 'CRI'
  8277         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8278
  8279     IF PB-COMPANY-ID EQUAL 'NCL'
  8280         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8281     END-IF
  8282
  8283     GO TO 0200-READ-CERT.
  8284
  8285 0199-ACCT-NOT-FOUND.
  8286
  8287     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8288
  8289     IF DATE-RANGE-SW NOT = SPACES
  8290        MOVE ER-2601             TO WS-ERROR
  8291        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8292     ELSE
  8293        MOVE ER-2619             TO WS-ERROR
  8294        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8295
  8296     GO TO 9990-RETURN.
  8297
  8298 0200-READ-CERT.
  8299
  8300     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8301     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8302     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8303     MOVE PB-SV-STATE            TO CERT-STATE.
  8304     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8305     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8306     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8307
  8308     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8309
  8310     IF CERT-WAS-NOT-FOUND
  8311        GO TO 0299-CERT-NOT-FOUND.
  8312
  8313     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8314        MOVE ER-2759             TO WS-ERROR
  8315        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8316        GO TO 0298-UNLOCK-RETURN.
  8317
  8318     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 153
* EL050.cbl
  8319         MOVE ER-2758            TO WS-ERROR
  8320         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8321         GO TO 0298-UNLOCK-RETURN.
  8322
  8323     IF PB-ISSUE
  8324        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8325           IF CERT-WAS-CREATED-FOR-CLAIM
  8326              NEXT SENTENCE
  8327            ELSE
  8328              MOVE ER-2626       TO WS-ERROR
  8329              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8330              GO TO 0298-UNLOCK-RETURN.
  8331
  8332     IF NOT PB-CANCELLATION
  8333        GO TO 0300-CONTINUE-EDIT.
  8334
  8335     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8336     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8337     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8338     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8339     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8340     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8341
  8342     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8343     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8344     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8345     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8346     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8347     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8348     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8349     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8350     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8351
  8352     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8353     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8354     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8355     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8356     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8357     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8358     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8359
  8360     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8361     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8362
  8363     MOVE CM-CREDIT-INTERFACE-SW-1
  8364                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8365     MOVE CM-CREDIT-INTERFACE-SW-2
  8366                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8367
  8368     IF CM-O-B-COVERAGE
  8369         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8370
  8371     IF CM-LIVES NOT NUMERIC
  8372         MOVE ZERO                TO CM-LIVES.
  8373
  8374     IF CM-BILLED NOT NUMERIC
  8375         MOVE ZERO                TO CM-BILLED.
  8376
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 154
* EL050.cbl
  8377     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8378         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8379         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8380         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8381         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8382         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8383         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8384         MOVE CM-LIVES             TO PB-CI-LIVES
  8385*The next line causes a problem with my change  I dont think it is
  8386*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8387
  8388     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8389     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8390     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8391     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8392     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8393     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8394
  8395     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8396     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8397     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8398     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8399
  8400     IF CM-LIFE-COMM-PCT NUMERIC
  8401         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8402     ELSE
  8403         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8404
  8405     IF CM-AH-COMM-PCT NUMERIC
  8406         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8407     ELSE
  8408         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8409
  8410     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8411
  8412     IF CM-LOAN-APR       NOT NUMERIC
  8413           MOVE ZERO               TO CM-LOAN-APR.
  8414
  8415     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8416           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8417
  8418     IF CM-LOAN-TERM      NOT NUMERIC
  8419           MOVE ZERO               TO CM-LOAN-TERM.
  8420
  8421     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8422           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8423
  8424     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8425           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8426
  8427     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8428     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8429     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8430     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8431     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8432     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8433     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8434     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 155
* EL050.cbl
  8435     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8436     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8437     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8438     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8439
  8440     IF CM-STATE = CM-SSN-STATE
  8441         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8442
  8443     IF CM-STATE NOT = CM-MEMB-STATE
  8444         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8445
  8446     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8447
  8448     IF PB-COMPANY-ID = 'CVL' OR 'DCC' or 'VPP'
  8449        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8450        IF CM-ADDL-CLP NOT NUMERIC
  8451           MOVE +0               TO CM-ADDL-CLP
  8452        END-IF
  8453        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8454        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8455           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8456        END-IF
  8457     END-IF
  8458     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8459        MOVE +0                  TO WS-ADMIN-FEES
  8460                                    WS-CSO-ADMIN-FEE
  8461                                    WS-COMM-AND-MFEE
  8462                                    WS-1ST-YR-ALLOW
  8463        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8464           (SUB5 > +10)
  8465           MOVE +0 TO WS-WK-RATE
  8466           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8467              IF (AM-A-COM (SUB5) NUMERIC)
  8468                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8469                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8470              ELSE
  8471                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8472                 IF PB-ISSUE
  8473                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8474                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8475                 ELSE
  8476                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8477                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8478                 END-IF
  8479                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8480                 MOVE ZEROS             TO WS-SUB1
  8481                                           WS-COMMISSION
  8482                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8483                 MOVE '0530'               TO CTBL-SW
  8484                 MOVE ' '                  TO WS-CTBL-READ-SW
  8485                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8486                 IF FIRST-TIME-THROUGH
  8487                    MOVE 'AA'              TO CTBL-BEN-CODE
  8488                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8489                 END-IF
  8490                 IF CTBL-TABLE-FOUND
  8491                    IF PB-ISSUE
  8492                       COMPUTE WS-COMM-CK-AMT =
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 156
* EL050.cbl
  8493                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8494                    ELSE
  8495                       COMPUTE WS-COMM-CK-AMT =
  8496                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8497                    END-IF
  8498                    PERFORM 8800-GET-COMP-RATE
  8499                              THRU 8800-EXIT
  8500                 END-IF
  8501              END-IF
  8502              IF AM-COM-TYP (SUB5) = 'I'
  8503                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8504                   + (WS-WK-RATE * 1000)
  8505              END-IF
  8506              IF AM-COM-TYP (SUB5) = 'N'
  8507                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8508                   + (WS-WK-RATE * 1000)
  8509              END-IF
  8510              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8511                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8512                   + (WS-WK-RATE * 1000)
  8513              END-IF
  8514              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8515                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8516                   + (WS-WK-RATE * 1000)
  8517              END-IF
  8518           END-IF
  8519        END-PERFORM
  8520     END-IF
  8521     GO TO 0300-CONTINUE-EDIT.
  8522
  8523 0298-UNLOCK-RETURN.
  8524      PERFORM 9250-UNLOCK-RETURN
  8525      GO TO 9990-RETURN.
  8526
  8527 0299-CERT-NOT-FOUND.
  8528
  8529     MOVE '1'                     TO CERT-STATUS-SW.
  8530
  8531     IF PB-COMPANY-ID = 'UCL'
  8532         IF WS-ERROR = ER-2799
  8533             GO TO 3000-CONTINUE-EDIT.
  8534
  8535     IF NOT PB-CANCELLATION
  8536         GO TO 0300-CONTINUE-EDIT.
  8537
  8538     MOVE ER-2726                  TO  WS-ERROR.
  8539     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8540     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8541     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8542                                    PB-CI-LF-TERM
  8543                                    PB-C-LF-REM-TERM
  8544                                    PB-CI-AH-TERM
  8545                                    PB-C-AH-REM-TERM
  8546                                    PB-CI-LF-BENEFIT-CD
  8547                                    PB-CI-LF-BENEFIT-AMT
  8548                                    PB-CI-LF-ALT-BENEFIT-AMT
  8549                                    PB-CI-LF-PREMIUM-AMT
  8550                                    PB-CI-LF-ALT-PREMIUM-AMT
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 157
* EL050.cbl
  8551                                    PB-CI-AH-BENEFIT-CD
  8552                                    PB-CI-AH-BENEFIT-AMT
  8553                                    PB-CI-AH-PREMIUM-AMT
  8554                                    PB-CI-PAY-FREQUENCY
  8555                                    PB-CI-LOAN-APR
  8556                                    PB-CI-LOAN-TERM
  8557                                    PB-CI-LIFE-COMMISSION
  8558                                    PB-CI-AH-COMMISSION
  8559                                    PB-CI-CURR-SEQ
  8560                                    PB-CI-AH-CANCEL-AMT
  8561                                    PB-CI-LF-CANCEL-AMT
  8562                                    PB-CI-RATE-DEV-PCT-LF
  8563                                    PB-CI-RATE-DEV-PCT-AH
  8564                                    PB-CI-EXTENTION-DAYS
  8565                                    PB-CI-TERM-IN-DAYS
  8566                                    PB-CI-LIVES
  8567                                    PB-CI-LF-CRIT-PER
  8568                                    PB-CI-AH-CRIT-PER
  8569                                    PB-CI-ADDL-CLP
  8570                                    PB-CI-DDF-IU-RATE-UP.
  8571
  8572     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8573                                    PB-CI-AH-SETTLEMENT-DT
  8574                                    PB-CI-DEATH-DT
  8575                                    PB-CI-LF-PRIOR-CANCEL-DT
  8576                                    PB-CI-AH-PRIOR-CANCEL-DT
  8577                                    PB-CI-ENTRY-DT
  8578                                    PB-CI-LF-EXPIRE-DT
  8579                                    PB-CI-AH-EXPIRE-DT
  8580                                    PB-CI-LOAN-1ST-PMT-DT.
  8581
  8582     IF ACCOUNT-MAST-FOUND
  8583        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8584        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8585
  8586
  8587 0300-CONTINUE-EDIT.
  8588
  8589     IF PB-ISSUE
  8590        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8591            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8592
  8593     IF PB-ISSUE
  8594        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8595            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8596
  8597     IF PB-ISSUE
  8598       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8599          (AM-NO-AH-ONLY)
  8600           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8601               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8602                   MOVE ER-2679 TO WS-ERROR
  8603                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8604
  8605     IF PB-ISSUE
  8606        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8607        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8608        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 158
* EL050.cbl
  8609     ELSE
  8610        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8611        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8612        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8613
  8614     MOVE 'N'                    TO PLAN-MASTER-SW
  8615                                    PLAN-MASTER-LIFE-SW
  8616                                    FORM-MASTER-SW
  8617                                    WS-APP-CERT-SW.
  8618
  8619     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8620                                    WS-PL-TOL-LF-REFUND
  8621                                    WS-PL-REF-OVS-AMT
  8622                                    WS-PL-TOL-LF-PREM-PCT
  8623                                    WS-PL-TOL-LF-REFUND-PCT
  8624                                    WS-PL-REF-OVS-PCT
  8625                                    WS-PL-TOL-LF-CLAIM.
  8626
  8627     IF PB-COMPANY-ID = 'NCL'
  8628       IF PB-ISSUE
  8629         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8630             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8631             IF FORM-MASTER-FOUND
  8632                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8633
  8634     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8635        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8636
  8637********************** MON CODE **********************
  8638     IF PB-COMPANY-ID = 'MON'
  8639     IF PB-ISSUE
  8640     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8641        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8642             PB-I-LOAN-APR = ZERO)
  8643               MOVE 14.0         TO PB-I-LOAN-APR.
  8644******************************************************
  8645
  8646     IF PB-COMPANY-ID = 'NCL'
  8647       IF PB-ISSUE
  8648           IF FORM-MASTER-FOUND
  8649             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8650                AM-DISMBR-COVERAGE
  8651                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8652                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8653                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8654                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8655                                           PB-I-LIFE-BENEFIT-CD.
  8656
  8657     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8658
  8659     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8660         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8661         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8662         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8663         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8664         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8665           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8666             GO TO 0301-LIFE-BENEFIT-SEARCH
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 159
* EL050.cbl
  8667         ELSE
  8668             NEXT SENTENCE
  8669     ELSE
  8670         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8671
  8672     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8673     MOVE '4'                    TO CNTL-REC-TYPE.
  8674     MOVE +0                     TO CNTL-SEQ-NO.
  8675     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8676
  8677     MOVE '1' TO RC-SW-2.
  8678     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8679
  8680     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8681        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8682         GO TO 0305-BENEFIT-NOT-FOUND.
  8683
  8684     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8685
  8686 0301-LIFE-BENEFIT-SEARCH.
  8687
  8688     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8689
  8690     IF NO-BENEFIT-FOUND
  8691        GO TO 0305-BENEFIT-NOT-FOUND.
  8692
  8693     IF WS-BEN-CD = '99'
  8694        GO TO 0305-BENEFIT-NOT-FOUND.
  8695
  8696     IF PB-COMPANY-ID = 'NCL'
  8697         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8698             GO TO 0304-LIFE-BENEFIT-FOUND.
  8699
  8700     MOVE +1                     TO SUB5.
  8701     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8702
  8703* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8704* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8705     IF PB-COMPANY-ID = 'DMD'
  8706         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8707
  8708 0302-EDIT-ACCT-LF-BENEFITS.
  8709
  8710     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8711        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8712           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8713                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8714           GO TO 03XX-GET-LIFE-ERPLAN.
  8715
  8716     IF SUB5 LESS THAN +20
  8717        ADD +1                   TO SUB5
  8718        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8719
  8720     MOVE +1                     TO SUB5.
  8721
  8722     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8723        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8724
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 160
* EL050.cbl
  8725 0303-EDIT-DMD-EXTRA-BENEFITS.
  8726
  8727     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8728        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8729           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8730                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8731           GO TO 03XX-GET-LIFE-ERPLAN.
  8732
  8733     IF SUB5 LESS THAN +30
  8734        ADD +1                   TO SUB5
  8735        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8736
  8737     MOVE +1                     TO SUB5.
  8738
  8739 03XX-EDIT-FOR-NINETY-LF.
  8740
  8741***************************************************************
  8742*                                                             *
  8743*    NINETY BENEFIT PLAN TYPES:                               *
  8744*                                                             *
  8745*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8746*      92 = ALL GROUP REDUCING BENEFITS                       *
  8747*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8748*      94 = ALL GROUP LEVEL BENEFITS                          *
  8749*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8750*           BENEFIT CONTROLS.                                 *
  8751*      99 = ALL BENEFITS                                      *
  8752*                                                             *
  8753***************************************************************
  8754
  8755     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8756                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8757
  8758     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8759       AND
  8760        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8761        GO TO 03XX-GET-LIFE-ERPLAN.
  8762
  8763     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8764       AND
  8765        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8766        IF CF-REDUCING (SUB3)
  8767           IF (PB-I-INDV-GRP-OVRD = 'I')
  8768              OR
  8769           ((AM-IG = '1') AND
  8770           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8771              OR
  8772           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8773           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8774           (AM-IG NOT = '2'))
  8775              GO TO 03XX-GET-LIFE-ERPLAN.
  8776
  8777     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8778       AND
  8779        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8780        IF CF-REDUCING (SUB3)
  8781           IF (PB-I-INDV-GRP-OVRD = 'G')
  8782              OR
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 161
* EL050.cbl
  8783           ((AM-IG = '2') AND
  8784           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8785              OR
  8786           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8787           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8788           (AM-IG NOT = '1'))
  8789              GO TO 03XX-GET-LIFE-ERPLAN.
  8790
  8791     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8792       AND
  8793        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8794        IF CF-LEVEL    (SUB3)
  8795           IF (PB-I-INDV-GRP-OVRD = 'I')
  8796              OR
  8797           ((AM-IG = '1') AND
  8798           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8799              OR
  8800           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8801           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8802            (AM-IG NOT = '2'))
  8803              GO TO 03XX-GET-LIFE-ERPLAN.
  8804
  8805     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8806       AND
  8807        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8808        IF CF-LEVEL    (SUB3)
  8809           IF (PB-I-INDV-GRP-OVRD = 'G')
  8810              OR
  8811           ((AM-IG = '2') AND
  8812           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8813              OR
  8814           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8815           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8816           (AM-IG NOT = '1'))
  8817              GO TO 03XX-GET-LIFE-ERPLAN.
  8818
  8819     IF SUB5 LESS THAN +20
  8820        ADD +1                   TO SUB5
  8821        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8822
  8823     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8824
  8825     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8826        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8827
  8828     MOVE +1                     TO SUB5.
  8829
  8830 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8831
  8832     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8833                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8834
  8835     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8836       AND
  8837        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8838        GO TO 03XX-GET-LIFE-ERPLAN.
  8839
  8840     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 162
* EL050.cbl
  8841       AND
  8842        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8843        IF CF-REDUCING (SUB3)
  8844           IF (PB-I-INDV-GRP-OVRD = 'I')
  8845              OR
  8846           ((AM-IG = '1') AND
  8847           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8848              OR
  8849           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8850           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8851           (AM-IG NOT = '2'))
  8852              GO TO 03XX-GET-LIFE-ERPLAN.
  8853
  8854     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8855       AND
  8856        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8857        IF CF-REDUCING (SUB3)
  8858           IF (PB-I-INDV-GRP-OVRD = 'G')
  8859              OR
  8860           ((AM-IG = '2') AND
  8861           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8862              OR
  8863           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8864           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8865           (AM-IG NOT = '1'))
  8866              GO TO 03XX-GET-LIFE-ERPLAN.
  8867
  8868     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8869       AND
  8870        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8871        IF CF-LEVEL    (SUB3)
  8872           IF (PB-I-INDV-GRP-OVRD = 'I')
  8873              OR
  8874           ((AM-IG = '1') AND
  8875           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8876              OR
  8877           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8878           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8879            (AM-IG NOT = '2'))
  8880              GO TO 03XX-GET-LIFE-ERPLAN.
  8881
  8882     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8883       AND
  8884        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8885        IF CF-LEVEL    (SUB3)
  8886           IF (PB-I-INDV-GRP-OVRD = 'G')
  8887              OR
  8888           ((AM-IG = '2') AND
  8889           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8890              OR
  8891           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8892           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8893           (AM-IG NOT = '1'))
  8894              GO TO 03XX-GET-LIFE-ERPLAN.
  8895
  8896     IF SUB5 LESS THAN +30
  8897        ADD +1                   TO SUB5
  8898        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 163
* EL050.cbl
  8899
  8900     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8901
  8902 03XX-EDIT-FOR-NINETY-LF-CONT.
  8903
  8904     MOVE +99                    TO SUB5.
  8905
  8906     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8907        IF PB-ISSUE
  8908           MOVE ER-1924          TO  WS-ERROR
  8909           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8910
  8911     GO TO 0304-LIFE-BENEFIT-FOUND.
  8912
  8913 03XX-GET-LIFE-ERPLAN.
  8914
  8915     IF WK-PLAN-ADDR EQUAL +0
  8916        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8917
  8918     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8919     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8920     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8921     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8922     MOVE 'Y'                    TO PLAN-MASTER-SW
  8923                                    PLAN-MASTER-LIFE-SW.
  8924     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8925
  8926 03XX-ERPLAN-LIFE-GETMAIN.
  8927
  8928     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8929     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8930
  8931 03XX-ERPLAN-LIFE-READ.
  8932
  8933     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8934     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8935     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8936     MOVE PB-SV-STATE            TO PLAN-STATE.
  8937     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8938     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8939     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8940     MOVE WS-SAVE-BENEFIT-REVISION
  8941                                 TO PLAN-REVISION-NO.
  8942
  8943     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8944     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8945
  8946     IF PB-COMPANY-ID = 'NCL'
  8947       IF NOT LF-PLAN-MASTER-FOUND
  8948         IF NOT PB-POLICY-IS-DECLINED  AND
  8949            NOT PB-POLICY-IS-VOIDED
  8950             MOVE  ER-1921         TO  WS-ERROR
  8951             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8952             GO TO 0304-LIFE-BENEFIT-FOUND.
  8953
  8954     IF NOT LF-PLAN-MASTER-FOUND
  8955        GO TO 0304-LIFE-BENEFIT-FOUND.
  8956
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 164
* EL050.cbl
  8957 XXXX-CHECK-LF-PLAN-KEY.
  8958
  8959     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8960        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8961        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8962        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8963        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8964        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8965        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8966        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8967        MOVE 'N'                 TO PLAN-MASTER-SW
  8968          GO TO 03XX-ERPLAN-LIFE-READ.
  8969
  8970     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8971
  8972     IF  PB-CANCELLATION
  8973         GO TO  0303-LF-ACCT-BEN-FOUND.
  8974
  8975     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8976        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8977           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8978           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8979              MOVE ER-2644             TO WS-ERROR
  8980              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8981           ELSE
  8982              NEXT SENTENCE
  8983        ELSE
  8984           IF PB-COMPANY-ID NOT = 'NCL'
  8985              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8986                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8987
  8988 0303-LF-ACCT-BEN-FOUND.
  8989
  8990     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8991
  8992     IF PL-DEV-CODE NOT = SPACES
  8993        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8994
  8995     IF PL-DEV-PCT NUMERIC AND
  8996        PL-DEV-PCT NOT = ZEROS
  8997        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8998
  8999     IF PL-TOL-PREM-AMT GREATER THAN +0
  9000        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  9001
  9002     IF PL-TOL-REF-AMT GREATER THAN +0
  9003        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  9004
  9005     IF PL-TOL-PREM-PCT GREATER THAN +0
  9006        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  9007
  9008     IF PL-TOL-REF-PCT GREATER THAN +0
  9009        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  9010
  9011     IF PL-TOL-CLM-AMT GREATER THAN +0
  9012        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  9013
  9014     IF PL-OVER-SHORT-AMT NUMERIC  AND
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 165
* EL050.cbl
  9015                          PL-OVER-SHORT-AMT > +0
  9016        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  9017
  9018     IF PL-OVER-SHORT-PCT NUMERIC  AND
  9019                          PL-OVER-SHORT-PCT > +0
  9020        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  9021
  9022     IF PL-SALES-TAX NUMERIC AND
  9023                          PL-SALES-TAX > +0
  9024         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  9025
  9026     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9027        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  9028                                    WS-IG-OVRD-AM.
  9029
  9030 0304-LIFE-BENEFIT-FOUND.
  9031
  9032     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  9033
  9034     IF PB-ISSUE
  9035        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  9036     ELSE
  9037        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  9038
  9039     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  9040     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  9041     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  9042     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  9043     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  9044                                         WS-LF-REFUND-CALC.
  9045     if (ws-lf-earnings-calc = '5')
  9046        and (pb-i-loan-apr = zeros)
  9047        and (benefit-code-chg)
  9048        move +99.9999 to pb-i-loan-apr
  9049     end-if
  9050
  9051     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9052        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  9053
  9054     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9055        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  9056     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  9057
  9058     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  9059     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  9060     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  9061     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  9062     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  9063     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  9064
  9065     IF PB-COMPANY-ID = 'NCL'  AND
  9066        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9067         NEXT SENTENCE
  9068     ELSE
  9069         IF SUB5 NOT GREATER THAN +20
  9070            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  9071               MOVE WS-SAVE-BENEFIT-REM-TERM
  9072                                      TO WS-AM-LF-BENE-REM-TERM
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 166
* EL050.cbl
  9073                                         EC-BR-LF-REM-TERM-CALC.
  9074
  9075     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  9076     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  9077
  9078     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  9079
  9080 0305-BENEFIT-NOT-FOUND.
  9081
  9082     MOVE '1'                    TO LF-BENEFIT-ERROR.
  9083     MOVE ER-2604                TO WS-ERROR.
  9084     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9085
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 167
* EL050.cbl
  9087
  9088 0310-FIND-AH-BENEFIT-RECORD.
  9089
  9090     MOVE 'N'                    TO PLAN-MASTER-SW
  9091                                    PLAN-MASTER-AH-SW.
  9092
  9093     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  9094                                    WS-PL-TOL-AH-REFUND
  9095                                    WS-AH-PL-REF-OVS-AMT
  9096                                    WS-PL-TOL-AH-PREM-PCT
  9097                                    WS-PL-TOL-AH-REFUND-PCT
  9098                                    WS-AH-PL-REF-OVS-PCT
  9099                                    WS-PL-TOL-AH-CLAIM.
  9100     MOVE ' '                    TO WS-AH-DCC-TRUNC
  9101
  9102
  9103     if pb-issue
  9104        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  9105           MOVE SPACES              TO PB-I-AH-INPUT-CD
  9106        end-if
  9107        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  9108           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  9109           GO TO 0399-BENEFIT-NOT-FOUND
  9110        end-if
  9111     end-if
  9112
  9113     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  9114        GO TO 0400-FIND-CARRIER.
  9115
  9116     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9117
  9118     IF WK-AH-BEN-ADDR NOT = ZEROS
  9119         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  9120         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9121         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9122         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  9123           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  9124             GO TO 0311-AH-BENEFIT-SEARCH
  9125         ELSE
  9126             NEXT SENTENCE
  9127     ELSE
  9128         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9129
  9130     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9131     MOVE '5'                    TO CNTL-REC-TYPE.
  9132     MOVE +0                     TO CNTL-SEQ-NO.
  9133     MOVE WS-ACCESS              TO CNTL-ACCESS.
  9134
  9135     MOVE '2' TO RC-SW-2.
  9136     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9137
  9138     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  9139        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  9140          GO TO 0399-BENEFIT-NOT-FOUND.
  9141
  9142     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  9143
  9144 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 168
* EL050.cbl
  9145
  9146     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9147
  9148     IF NO-BENEFIT-FOUND
  9149         GO TO 0399-BENEFIT-NOT-FOUND.
  9150
  9151     IF WS-BEN-CD = '99'
  9152        GO TO 0399-BENEFIT-NOT-FOUND.
  9153
  9154     IF PB-COMPANY-ID  =  'NCL'
  9155         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9156             GO TO 0314-A-H-BENEFIT-FOUND.
  9157
  9158     MOVE +1                     TO SUB5.
  9159     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9160
  9161* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  9162* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  9163     IF PB-COMPANY-ID = 'DMD'
  9164         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  9165
  9166 0312-EDIT-ACCT-AH-BENEFITS.
  9167
  9168     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9169        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  9170           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9171                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9172           GO TO 03XX-GET-AH-ERPLAN.
  9173
  9174     IF SUB5 LESS THAN +20
  9175        ADD +1                   TO SUB5
  9176        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  9177
  9178     MOVE +1                     TO SUB5.
  9179
  9180     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9181        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9182
  9183 0313-EDIT-DMD-EXTRA-BENEFITS.
  9184
  9185     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9186        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  9187           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9188                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9189           GO TO 03XX-GET-AH-ERPLAN.
  9190
  9191     IF SUB5 LESS THAN +30
  9192        ADD +1                   TO SUB5
  9193        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  9194
  9195     MOVE +1                     TO SUB5.
  9196
  9197 03XX-EDIT-FOR-NINETY-AH.
  9198
  9199***************************************************************
  9200*                                                             *
  9201*    NINETY BENEFIT PLAN TYPES:                               *
  9202*                                                             *
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 169
* EL050.cbl
  9203*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9204*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9205*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9206*           BENEFIT CONTROLS.                                 *
  9207*      99 = ALL BENEFITS.                                     *
  9208*                                                             *
  9209***************************************************************
  9210
  9211     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9212                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9213
  9214     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  9215       AND
  9216        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9217        GO TO 03XX-GET-AH-ERPLAN.
  9218
  9219     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  9220       AND
  9221        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9222           IF (PB-I-INDV-GRP-OVRD = 'I')
  9223              OR
  9224           ((AM-IG = '1') AND
  9225           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9226              OR
  9227           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9228           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9229           (AM-IG NOT = '2'))
  9230              GO TO 03XX-GET-AH-ERPLAN.
  9231
  9232     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  9233       AND
  9234        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9235           IF (PB-I-INDV-GRP-OVRD = 'G')
  9236              OR
  9237           ((AM-IG = '2') AND
  9238           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9239              OR
  9240           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9241           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9242           (AM-IG NOT = '1'))
  9243              GO TO 03XX-GET-AH-ERPLAN.
  9244
  9245     IF SUB5 LESS THAN +20
  9246        ADD +1                   TO SUB5
  9247        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9248
  9249     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9250        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9251
  9252     MOVE +1                    TO SUB5.
  9253
  9254 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9255
  9256     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9257                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9258
  9259     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9260       AND
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 170
* EL050.cbl
  9261        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9262        GO TO 03XX-GET-AH-ERPLAN.
  9263
  9264     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9265       AND
  9266        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9267           IF (PB-I-INDV-GRP-OVRD = 'I')
  9268              OR
  9269           ((AM-IG = '1') AND
  9270           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9271              OR
  9272           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9273           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9274           (AM-IG NOT = '2'))
  9275              GO TO 03XX-GET-AH-ERPLAN.
  9276
  9277     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9278       AND
  9279        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9280           IF (PB-I-INDV-GRP-OVRD = 'G')
  9281              OR
  9282           ((AM-IG = '2') AND
  9283           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9284              OR
  9285           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9286           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9287           (AM-IG NOT = '1'))
  9288              GO TO 03XX-GET-AH-ERPLAN.
  9289
  9290     IF SUB5 LESS THAN +30
  9291        ADD +1                   TO SUB5
  9292        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9293
  9294 03XX-EDIT-FOR-NINETY-AH-CONT.
  9295
  9296     MOVE +99                    TO SUB5.
  9297
  9298     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9299
  9300     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9301        IF PB-ISSUE
  9302           MOVE ER-1925          TO  WS-ERROR
  9303           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9304
  9305     GO TO 0314-A-H-BENEFIT-FOUND.
  9306
  9307 03XX-GET-AH-ERPLAN.
  9308
  9309     IF WK-PLAN-ADDR EQUAL +0
  9310         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9311
  9312     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9313     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9314     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9315     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9316     MOVE 'Y'                    TO PLAN-MASTER-SW
  9317                                    PLAN-MASTER-AH-SW.
  9318*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 171
* EL050.cbl
  9319     GO TO 03XX-ERPLAN-AH-READ.
  9320
  9321 03XX-ERPLAN-AH-GETMAIN.
  9322
  9323     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9324     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9325
  9326 03XX-ERPLAN-AH-READ.
  9327
  9328     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9329     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9330     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9331     MOVE PB-SV-STATE            TO PLAN-STATE.
  9332     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9333     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9334     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9335     MOVE WS-SAVE-BENEFIT-REVISION
  9336                                 TO PLAN-REVISION-NO.
  9337
  9338     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9339     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9340
  9341     IF PB-COMPANY-ID = 'NCL'
  9342       IF NOT AH-PLAN-MASTER-FOUND
  9343         IF NOT PB-POLICY-IS-DECLINED  AND
  9344            NOT PB-POLICY-IS-VOIDED
  9345             MOVE  ER-1922         TO  WS-ERROR
  9346             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9347             GO TO 0314-A-H-BENEFIT-FOUND.
  9348
  9349     IF NOT AH-PLAN-MASTER-FOUND
  9350        GO TO 0314-A-H-BENEFIT-FOUND.
  9351
  9352 XXXX-CHECK-AH-PLAN-KEY.
  9353
  9354     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9355        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9356        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9357        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9358        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9359        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9360        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9361        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9362        MOVE 'N'                 TO PLAN-MASTER-SW
  9363          GO TO 03XX-ERPLAN-AH-READ.
  9364
  9365     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9366
  9367     IF  PB-CANCELLATION
  9368         GO TO  0313-AH-ACCT-BEN-FOUND.
  9369
  9370     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9371       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9372          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9373          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9374             MOVE ER-2644             TO WS-ERROR
  9375             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9376          ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 172
* EL050.cbl
  9377             NEXT SENTENCE
  9378       ELSE
  9379          IF PB-COMPANY-ID NOT = 'NCL'
  9380             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9381                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9382
  9383 0313-AH-ACCT-BEN-FOUND.
  9384
  9385     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9386
  9387     IF PL-DEV-CODE NOT = SPACES
  9388        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9389
  9390     IF PL-DEV-PCT NUMERIC AND
  9391        PL-DEV-PCT NOT = ZEROS
  9392        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9393
  9394     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9395        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9396
  9397     IF PL-TOL-REF-AMT NOT EQUAL +0
  9398        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9399
  9400     IF PL-TOL-PREM-PCT GREATER THAN +0
  9401        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9402
  9403     IF PL-TOL-REF-PCT GREATER THAN +0
  9404        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9405
  9406     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9407        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9408
  9409     IF PL-OVER-SHORT-AMT NUMERIC AND
  9410                          PL-OVER-SHORT-AMT > +0
  9411        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9412
  9413     IF PL-OVER-SHORT-PCT NUMERIC AND
  9414                          PL-OVER-SHORT-PCT > +0
  9415        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9416
  9417     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9418        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9419        IF WS-IG-OVRD-AM EQUAL SPACES
  9420            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9421
  9422 0314-A-H-BENEFIT-FOUND.
  9423
  9424     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9425
  9426     IF PB-ISSUE
  9427        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9428       ELSE
  9429        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9430
  9431     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD
  9432     if cf-maximum-benefits (sub3) numeric
  9433        move cf-maximum-benefits (sub3)
  9434                                 to ws-ah-max-bens
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 173
* EL050.cbl
  9435     else
  9436        move zeros               to ws-ah-max-bens
  9437     end-if
  9438     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9439     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9440     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
  9441                                         WS-AH-REFUND-CALC.
  9442
  9443     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9444        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9445
  9446     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9447        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9448     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9449
  9450     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9451     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9452     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9453     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9454     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9455     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9456
  9457     IF PB-COMPANY-ID = 'NCL'  AND
  9458        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9459         NEXT SENTENCE
  9460     ELSE
  9461         IF SUB5 NOT GREATER THAN +20
  9462            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9463                MOVE WS-SAVE-BENEFIT-REM-TERM
  9464                                      TO WS-AM-AH-BENE-REM-TERM
  9465                                         EC-BR-AH-REM-TERM-CALC.
  9466
  9467     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9468     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9469
  9470     GO TO 0400-FIND-CARRIER.
  9471
  9472 0399-BENEFIT-NOT-FOUND.
  9473
  9474     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9475     MOVE ER-2605                TO WS-ERROR.
  9476     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9477
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 174
* EL050.cbl
  9479
  9480 0400-FIND-CARRIER.
  9481
  9482     MOVE PB-SV-CARRIER          TO WS-CARR.
  9483
  9484     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9485     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9486     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9487     MOVE '6'                    TO CNTL-REC-TYPE.
  9488
  9489*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9490     MOVE SPACE                  TO WS-DMD-RATING-SW
  9491                                    EC-BR-DMD-RATING-SW.
  9492
  9493     MOVE '2'                    TO RC-SW-1.
  9494     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9495
  9496     IF NOT CF-CARRIER-MASTER
  9497        GO TO 0400-CARRIER-NOT-FOUND.
  9498
  9499 0400-BUILD-CARR-TOL.
  9500
  9501     IF CF-CR-TOL-PREM NUMERIC AND
  9502        CF-CR-TOL-PREM GREATER THAN +0
  9503        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9504                                    WS-TOL-AH-PREM.
  9505
  9506     IF CF-CR-TOL-REFUND NUMERIC AND
  9507        CF-CR-TOL-REFUND GREATER THAN +0
  9508        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9509                                    WS-TOL-AH-REFUND.
  9510
  9511     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9512        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9513        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9514                                    WS-AH-REFUND-OVS-AMT.
  9515
  9516     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9517        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9518        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9519                                    WS-AH-REFUND-OVS-PCT.
  9520
  9521     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9522        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9523        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9524                                    WS-TOL-AH-PREM-PCT.
  9525
  9526     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9527        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9528        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9529                                     WS-TOL-AH-REFUND-PCT.
  9530
  9531     IF CF-COMPANY-ID EQUAL 'DMD'
  9532         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9533                                    EC-BR-DMD-RATING-SW.
  9534
  9535     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9536     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 175
* EL050.cbl
  9537        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9538     END-IF
  9539     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9540        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9541     END-IF
  9542     IF WS-TOL-CLP-PCT = ZEROS
  9543        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9544     END-IF
  9545
  9546     IF WS-SPP-LEASE-COMM = ZEROS
  9547        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9548     END-IF
  9549     GO TO 0400-FIND-ERPDEF.
  9550
  9551 0400-CARRIER-NOT-FOUND.
  9552
  9553     MOVE ER-2602                TO WS-ERROR.
  9554     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9555
  9556 0400-FIND-ERPDEF.
  9557*    IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  9558     IF (PB-COMPANY-ID = 'DCC')
  9559        AND (AM-DCC-PRODUCT-CODE <> spaces)
  9560        CONTINUE
  9561     ELSE
  9562        GO TO 0400-FIND-ERCOMP
  9563     END-IF
  9564     MOVE ' '                    TO PDEF-MASTER-SW
  9565     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9566     MOVE PB-STATE               TO ERPDEF-STATE
  9567     IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
  9568        MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
  9569     END-IF
  9570     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9571     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9572     IF PB-ISSUE
  9573        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9574     ELSE
  9575        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9576     END-IF
  9577     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9578     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9579     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9580     IF PDEF-MASTER-FOUND
  9581        MOVE 'N'                 TO PDEF-MASTER-SW
  9582        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9583        IF PDEF-MASTER-FOUND
  9584           IF (ERPDEF-KEY-SAVE (1:16) =
  9585                        PD-CONTROL-PRIMARY (1:16))
  9586              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9587              CONTINUE
  9588           ELSE
  9589              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9590              IF (ERPDEF-KEY-SAVE (1:16) =
  9591                        PD-CONTROL-PRIMARY (1:16))
  9592                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9593                 CONTINUE
  9594              ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 176
* EL050.cbl
  9595                 MOVE 'N'        TO PDEF-MASTER-SW
  9596              END-IF
  9597           END-IF
  9598        END-IF
  9599        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9600     END-IF
  9601     IF PDEF-MASTER-FOUND
  9602        IF PD-TRUNCATED = 'Y'
  9603           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9604        END-IF
  9605     END-IF
  9606     .
  9607 0400-FIND-ERCOMP.
  9608     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9609        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9610           (WS-SUB1 > +10)
  9611           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9612                 OR 'A' OR 'N'
  9613              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9614              MOVE PB-CARRIER    TO COMP-CARRIER
  9615              MOVE PB-GROUPING   TO COMP-GROUPING
  9616              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9617              MOVE AM-AGT (WS-SUB1)
  9618                                 TO COMP-FIN-RESP
  9619              MOVE 'G'           TO COMP-TYPE
  9620              PERFORM 8582-READ-COMPENSATION-MASTER
  9621                                 THRU 8582-EXIT
  9622              IF COMP-MASTER-FOUND
  9623                 IF CO-GA-INACTIVE
  9624                    MOVE ER-2763 TO WS-ERROR
  9625                    PERFORM 9900-ERROR-FORMAT
  9626                                 THRU 9900-EXIT
  9627                    MOVE +11     TO WS-SUB1
  9628                 END-IF
  9629                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9630                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9631                    MOVE ER-2788 TO WS-ERROR
  9632                    PERFORM 9900-ERROR-FORMAT
  9633                                 THRU 9900-EXIT
  9634                    MOVE +11     TO WS-SUB1
  9635                 END-IF
  9636              END-IF
  9637           END-IF
  9638        END-PERFORM
  9639     END-IF
  9640     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9641        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9642           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9643                                    WS-CLP-STATE
  9644        ELSE
  9645           MOVE SPACES           TO PB-I-CLP-STATE
  9646                                    WS-CLP-STATE
  9647        END-IF
  9648     END-IF
  9649
  9650     IF (PB-COMPANY-ID = 'DCC')
  9651        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9652        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 177
* EL050.cbl
  9653        CONTINUE
  9654     ELSE
  9655        GO TO 0400-FIND-STATE-RECORD
  9656     END-IF
  9657     MOVE SPACES                 TO WS-CLP-STATE
  9658     MOVE +0                     TO WS-BANK-FEE
  9659                                    WS-BANK-LFEE
  9660                                    WS-BANK-NOCHRGB
  9661
  9662     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9663     IF (PB-ISSUE)
  9664        AND (PB-I-BANK-NUMBER NOT =
  9665            SPACES AND ZEROS AND LOW-VALUES)
  9666        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9667     ELSE
  9668        IF (PB-CANCELLATION)
  9669           AND (PB-CI-BANK-NUMBER NOT =
  9670                SPACES AND ZEROS AND LOW-VALUES)
  9671           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9672        END-IF
  9673     END-IF
  9674     IF COMP-FIN-RESP NOT = LOW-VALUES
  9675        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9676        MOVE PB-CARRIER          TO COMP-CARRIER
  9677        MOVE PB-GROUPING         TO COMP-GROUPING
  9678        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9679        MOVE 'B'                 TO COMP-TYPE
  9680        PERFORM 8582-READ-COMPENSATION-MASTER
  9681                                 THRU 8582-EXIT
  9682        IF COMP-MASTER-FOUND
  9683           IF CO-MAX-BANK-FEE NOT NUMERIC
  9684              MOVE +0            TO CO-MAX-BANK-FEE
  9685           END-IF
  9686           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9687              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9688           END-IF
  9689           IF CO-GA-INACTIVE
  9690              MOVE ER-2763       TO WS-ERROR
  9691              PERFORM 9900-ERROR-FORMAT
  9692                                 THRU 9900-EXIT
  9693           END-IF
  9694           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9695              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9696              MOVE ER-2788 TO WS-ERROR
  9697              PERFORM 9900-ERROR-FORMAT
  9698                                 THRU 9900-EXIT
  9699              MOVE +11     TO WS-SUB1
  9700           END-IF
  9701           IF WS-AH-BEN-CATEGORY = 'G'
  9702              MOVE CO-MAX-BANK-FEE
  9703                                 TO WS-BANK-FEE
  9704                                    PB-I-BANK-FEE
  9705           ELSE
  9706              MOVE CO-MAX-BANK-FEE-LEASE
  9707                                 TO WS-BANK-LFEE
  9708                                    PB-I-BANK-FEE
  9709           END-IF
  9710           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 178
* EL050.cbl
  9711              AND (WS-AH-REFUND-CALC = 'G'))
  9712                        OR
  9713              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9714              AND (WS-AH-REFUND-CALC NOT = 'G'))
  9715              CONTINUE
  9716           ELSE
  9717              MOVE ER-2789 TO WS-ERROR
  9718              PERFORM 9900-ERROR-FORMAT
  9719                                 THRU 9900-EXIT
  9720           END-IF
  9721           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9722                                    PB-I-CLP-STATE
  9723           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9724           MOVE CO-CARRIER       TO BXRF-CARRIER
  9725           MOVE CO-GROUPING      TO BXRF-GROUPING
  9726           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9727           MOVE BXRF-MAX-REC-LENGTH
  9728                                 TO BXRF-REC-LENGTH
  9729           PERFORM 8584-READ-BANK-CROSS-REF
  9730                                 THRU 8584-EXIT
  9731           IF BXRF-MASTER-FOUND
  9732              MOVE ' '           TO BANK-ACCT-SW
  9733              MOVE BK-BANK-POINTER-CNT
  9734                                 TO BK-BANK-POINTER-CNT
  9735              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9736                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9737                 OR (BANK-ACCT-FOUND)
  9738                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9739                    AND (BK-AM-EXP-DT (WS-SUB1)
  9740                                 > PB-CERT-EFF-DT)
  9741                    AND (BK-AM-EFF-DT (WS-SUB1)
  9742                                 NOT > PB-CERT-EFF-DT)
  9743                    SET BANK-ACCT-FOUND TO TRUE
  9744                 END-IF
  9745              END-PERFORM
  9746              IF NOT BANK-ACCT-FOUND
  9747                 MOVE ZEROS      TO WS-BANK-FEE
  9748                                    WS-BANK-LFEE
  9749                 MOVE ER-2869    TO WS-ERROR
  9750                 PERFORM 9900-ERROR-FORMAT
  9751                                 THRU 9900-EXIT
  9752              ELSE
  9753                 PERFORM 5000-PROCESS-REPS
  9754                                 THRU 5000-EXIT
  9755                 IF AGENT-MASTER-FOUND
  9756                    MOVE +0      TO WS-BANK-FEE
  9757                                    WS-BANK-LFEE
  9758*                   MOVE AG-SPP-FEES (1)
  9759*                                TO PB-I-BANK-FEE
  9760*                                   WS-BANK-FEE
  9761                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9762                       (WS-SUB1 > +10)
  9763                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9764                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9765                       END-IF
  9766                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9767                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9768                       END-IF
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 179
* EL050.cbl
  9769                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9770                          AG-SPP-FEES (WS-SUB1)
  9771                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9772                          AG-SPP-LFEES (WS-SUB1)
  9773                    END-PERFORM
  9774                    IF WS-AH-BEN-CATEGORY = 'G'
  9775                       MOVE WS-BANK-FEE
  9776                                 TO PB-I-BANK-FEE
  9777                    ELSE
  9778                       MOVE WS-BANK-LFEE
  9779                                 TO PB-I-BANK-FEE
  9780                    END-IF
  9781                 END-IF
  9782              END-IF
  9783           END-IF
  9784        ELSE
  9785           MOVE ER-2879          TO WS-ERROR
  9786           PERFORM 9900-ERROR-FORMAT
  9787                                 THRU 9900-EXIT
  9788        END-IF
  9789     ELSE
  9790        MOVE ER-2879             TO WS-ERROR
  9791        PERFORM 9900-ERROR-FORMAT
  9792                                 THRU 9900-EXIT
  9793     END-IF
  9794     IF WS-AH-BEN-CATEGORY = 'G'
  9795        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9796        + WS-BANK-FEE
  9797     ELSE
  9798        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9799        + WS-BANK-LFEE
  9800     END-IF
  9801     .
  9802 0400-FIND-STATE-RECORD.
  9803
  9804     IF WK-STATE-ADDR NOT = ZEROS
  9805         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9806         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9807         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9808         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9809         IF PB-SV-STATE = CF-STATE-CODE
  9810             GO TO 0405-CONTINUE-EDIT
  9811         ELSE
  9812             NEXT SENTENCE
  9813     ELSE
  9814         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9815
  9816     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9817     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9818     MOVE '3'                    TO CNTL-REC-TYPE.
  9819     MOVE +0                     TO CNTL-SEQ-NO.
  9820
  9821     MOVE '3'                    TO RC-SW-2.
  9822     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9823
  9824     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9825        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9826        PB-SV-STATE   NOT = CF-STATE-CODE)
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 180
* EL050.cbl
  9827        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9828                                    WS-TOL-AH-CLAIM
  9829                                    WS-MINIMUM-REFUND
  9830                                    WS-TOL-LF-PREM
  9831                                    WS-TOL-AH-PREM
  9832                                    WS-TOL-LF-REFUND
  9833                                    WS-TOL-AH-REFUND
  9834                                    EC-ST-TOL-PREM-PCT
  9835                                    WS-TOL-LF-PREM-PCT
  9836                                    WS-TOL-AH-PREM-PCT
  9837                                    EC-ST-TOL-REFUND-PCT
  9838                                    WS-TOL-LF-REFUND-PCT
  9839                                    WS-TOL-AH-REFUND-PCT
  9840                                    EC-ST-TOL-PREM
  9841                                    EC-ST-TOL-REFUND
  9842                                    EC-ST-FST-PMT-DAYS-MAX
  9843                                    WS-FREE-LOOK-PERIOD
  9844                                    WS-ST-LF-PREM-TAX
  9845                                    WS-ST-AH-PREM-TAX-I
  9846                                    WS-ST-AH-PREM-TAX-G
  9847                                    WS-BANK-FEE
  9848                                    WS-BANK-LFEE
  9849                                    WS-TOL-CLP-PCT
  9850                                    WS-SPP-LEASE-COMM
  9851                                    WS-INT-PERIODS
  9852                                    WS-EXTRA-PMTS
  9853        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9854                                    EC-ST-FST-PMT-DAYS-CHG
  9855                                    WS-LF-REM-TERM-CALC
  9856                                    WS-LF-REFUND-CALC
  9857                                    EC-ST-LF-REM-TERM-CALC
  9858                                    EC-ST-LF-REFUND-CALC
  9859                                    WS-AH-REM-TERM-CALC
  9860                                    WS-AH-REFUND-CALC
  9861                                    WS-LF-BEN-CATEGORY
  9862                                    WS-AH-BEN-CATEGORY
  9863                                    WS-CLP-STATE
  9864                                    WS-ST-REFUND-CLAIM-FLAG
  9865                                    WS-ST-CAUSAL-STATE
  9866                                    ws-st-agent-sig-edit
  9867                                    EC-ST-AH-REM-TERM-CALC
  9868                                    EC-ST-AH-REFUND-CALC
  9869          GO TO 0499-STATE-NOT-FOUND.
  9870
  9871     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9872
  9873 0405-CONTINUE-EDIT.
  9874
  9875     if pb-company-id = 'AHL'
  9876        continue
  9877     else
  9878        IF PB-CERT-PRIME NOT NUMERIC
  9879           MOVE ER-2722          TO WS-ERROR
  9880           PERFORM 9900-ERROR-FORMAT
  9881                                 THRU 9900-EXIT
  9882        end-if
  9883     END-IF
  9884*    IF PB-COMPANY-ID = 'CID' OR 'DCC' or 'VPP'
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 181
* EL050.cbl
  9885*       MOVE +0                  TO SUB3
  9886*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9887*       IF SUB3 > +0
  9888*          MOVE ER-2722          TO WS-ERROR
  9889*          PERFORM 9900-ERROR-FORMAT
  9890*                                THRU 9900-EXIT
  9891*       END-IF
  9892*    END-IF
  9893*    IF PB-COMPANY-ID = 'CID' OR 'DCC' or 'VPP'
  9894*       IF PB-CERT-PRIME NOT NUMERIC
  9895*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9896*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9897*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9898*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9899*
  9900*          MOVE ER-2722          TO WS-ERROR
  9901*          PERFORM 9900-ERROR-FORMAT
  9902*                                THRU 9900-EXIT
  9903*       END-IF
  9904*    END-IF
  9905
  9906     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9907
  9908     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9909        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9910                                    WS-TOL-AH-CLAIM.
  9911
  9912     IF CF-ST-REFUND-MIN NOT NUMERIC
  9913        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9914
  9915     IF CF-ST-REFUND-MIN NOT = ZEROS
  9916        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9917
  9918     IF CF-ST-TOL-PREM  NOT = ZEROS
  9919        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9920                                    WS-TOL-AH-PREM
  9921        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9922
  9923     IF CF-ST-TOL-REFUND NOT = ZEROS
  9924        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9925                                    WS-TOL-AH-REFUND
  9926        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9927
  9928     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9929        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9930        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9931                                    WS-AH-REFUND-OVS-AMT
  9932                                    EC-ST-OVR-SHT-AMT.
  9933
  9934     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9935        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9936        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9937                                    WS-TOL-LF-PREM-PCT
  9938                                    WS-TOL-AH-PREM-PCT.
  9939
  9940     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9941        CF-ST-TOL-REF-PCT GREATER THAN +0
  9942        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 182
* EL050.cbl
  9943                                    WS-TOL-LF-REFUND-PCT
  9944                                    WS-TOL-AH-REFUND-PCT.
  9945
  9946     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9947        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9948        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9949                                    WS-AH-REFUND-OVS-PCT
  9950                                    EC-ST-OVR-SHT-PCT.
  9951
  9952     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9953     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9954
  9955     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9956          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9957
  9958     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9959     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9960     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9961
  9962     IF CF-ST-LF-PREM-TAX NUMERIC
  9963        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9964     END-IF
  9965     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9966        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9967     END-IF
  9968     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9969        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9970     END-IF
  9971
  9972     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9973         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9974     END-IF.
  9975
  9976     IF CF-ST-CAUSAL-STATE > SPACES
  9977         MOVE CF-ST-CAUSAL-STATE TO WS-ST-CAUSAL-STATE
  9978     END-IF.
  9979     if cf-st-extra-interest-periods not numeric
  9980        move zeros               to cf-st-extra-interest-periods
  9981     end-if
  9982     if cf-st-extra-payments not numeric
  9983        move zeros               to cf-st-extra-payments
  9984     end-if
  9985
  9986     move cf-st-extra-interest-periods
  9987                                 to ws-int-periods
  9988     move cf-st-extra-payments   to ws-extra-pmts
  9989     move cf-st-agent-sig-edit   to ws-st-agent-sig-edit
  9990     move cf-st-net-only-state   to ws-net-only-state
  9991     if cf-st-comm-cap-sl not numeric
  9992        move zeros               to cf-st-comm-cap-sl
  9993     end-if
  9994     if cf-st-comm-cap-jl not numeric
  9995        move zeros               to cf-st-comm-cap-jl
  9996     end-if
  9997     if cf-st-comm-cap-sa not numeric
  9998        move zeros               to cf-st-comm-cap-sa
  9999     end-if
 10000     if cf-st-comm-cap-ja not numeric
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 183
* EL050.cbl
 10001        move zeros               to cf-st-comm-cap-ja
 10002     end-if
 10003     if cf-st-ga-comm-cap-sl not numeric
 10004        move zeros               to cf-st-ga-comm-cap-sl
 10005     end-if
 10006     if cf-st-ga-comm-cap-jl not numeric
 10007        move zeros               to cf-st-ga-comm-cap-jl
 10008     end-if
 10009     if cf-st-ga-comm-cap-sa not numeric
 10010        move zeros               to cf-st-ga-comm-cap-sa
 10011     end-if
 10012     if cf-st-ga-comm-cap-ja not numeric
 10013        move zeros               to cf-st-ga-comm-cap-ja
 10014     end-if
 10015
 10016     if cf-st-tot-comm-cap-sl not numeric
 10017        move zeros               to cf-st-tot-comm-cap-sl
 10018     end-if
 10019     if cf-st-tot-comm-cap-jl not numeric
 10020        move zeros               to cf-st-tot-comm-cap-jl
 10021     end-if
 10022     if cf-st-tot-comm-cap-sa not numeric
 10023        move zeros               to cf-st-tot-comm-cap-sa
 10024     end-if
 10025     if cf-st-tot-comm-cap-ja not numeric
 10026        move zeros               to cf-st-tot-comm-cap-ja
 10027     end-if
 10028
 10029     move cf-comm-cap-limit-to   to ws-st-cap-limit-to
 10030     move cf-st-comm-cap-sl      to ws-st-comm-cap-sl
 10031     move cf-st-comm-cap-jl      to ws-st-comm-cap-jl
 10032     move cf-st-comm-cap-sa      to ws-st-comm-cap-sa
 10033     move cf-st-comm-cap-ja      to ws-st-comm-cap-ja
 10034     move cf-st-ga-comm-cap-sl   to ws-st-ga-comm-cap-sl
 10035     move cf-st-ga-comm-cap-jl   to ws-st-ga-comm-cap-jl
 10036     move cf-st-ga-comm-cap-sa   to ws-st-ga-comm-cap-sa
 10037     move cf-st-ga-comm-cap-ja   to ws-st-ga-comm-cap-ja
 10038     move cf-st-tot-comm-cap-sl  to ws-st-tot-comm-cap-sl
 10039     move cf-st-tot-comm-cap-jl  to ws-st-tot-comm-cap-jl
 10040     move cf-st-tot-comm-cap-sa  to ws-st-tot-comm-cap-sa
 10041     move cf-st-tot-comm-cap-ja  to ws-st-tot-comm-cap-ja
 10042     IF WS-LF-BENEFIT-CD = ZEROS
 10043        GO TO 0410-CHECK-AH.
 10044
 10045     IF CF-ST-RT-CALC NOT = SPACES
 10046        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 10047                                    EC-ST-LF-REM-TERM-CALC
 10048     END-IF
 10049
 10050     IF WS-LF-COVERAGE-TYPE = 'R'
 10051        IF WS-LF-EARNINGS-CALC = '5'
 10052           IF CF-ST-RF-LN-CALC > '0'
 10053              MOVE CF-ST-RF-LN-CALC
 10054                                 TO WS-LF-REFUND-CALC
 10055                                    EC-ST-LF-REFUND-CALC
 10056           END-IF
 10057        ELSE
 10058           IF CF-ST-RF-LR-CALC > '0'
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 184
* EL050.cbl
 10059              MOVE CF-ST-RF-LR-CALC
 10060                                 TO WS-LF-REFUND-CALC
 10061                                    EC-ST-LF-REFUND-CALC
 10062           END-IF
 10063        END-IF
 10064     ELSE
 10065        IF CF-ST-RF-LL-CALC > '0'
 10066           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
 10067                                    EC-ST-LF-REFUND-CALC
 10068        END-IF
 10069     END-IF
 10070
 10071     IF CF-ST-RT-CALC NOT = SPACES
 10072        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 10073                                    EC-ST-LF-REM-TERM-CALC
 10074     END-IF
 10075
 10076     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
 10077     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
 10078
 10079     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
 10080
 10081     IF NO-BENEFIT-FOUND
 10082        GO TO 0410-CHECK-AH.
 10083
 10084     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
 10085        MOVE CF-ST-REM-TERM-CALC  (SUB3)
 10086                                 TO EC-ST-LF-REM-TERM-CALC
 10087                                    WS-LF-REM-TERM-CALC
 10088     END-IF
 10089
 10090     IF CF-ST-REFUND-CALC (SUB3) > '0'
 10091        MOVE CF-ST-REFUND-CALC (SUB3)
 10092                                 TO WS-LF-REFUND-CALC
 10093                                    EC-ST-LF-REFUND-CALC
 10094     END-IF
 10095*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
 10096     if cf-st-extra-periods (sub3) not numeric
 10097        move zeros               to cf-st-extra-periods (sub3)
 10098     end-if
 10099     if cf-st-extra-periods (sub3) > zeros
 10100        if ws-lf-ben-category = 'P'
 10101           move cf-st-extra-periods (sub3)
 10102                                 to ws-extra-pmts
 10103        else
 10104           if ws-lf-ben-category = 'I'
 10105              move cf-st-extra-periods (sub3)
 10106                                 to ws-int-periods
 10107           end-if
 10108        end-if
 10109     end-if
 10110     .
 10111 0410-CHECK-AH.
 10112
 10113     IF WS-AH-BENEFIT-CD = ZEROS
 10114        GO TO 0500-SET-ACCOUNT.
 10115
 10116     IF CF-ST-RT-CALC NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 185
* EL050.cbl
 10117        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
 10118                                    EC-ST-AH-REM-TERM-CALC
 10119     END-IF
 10120
 10121     IF WS-AH-SPECIAL-CALC-CD = 'C'
 10122        IF CF-ST-RF-CP-CALC > '0'
 10123           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
 10124                                    EC-ST-AH-REFUND-CALC
 10125        END-IF
 10126     ELSE
 10127        IF CF-ST-RF-AH-CALC > '0'
 10128           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
 10129                                    EC-ST-AH-REFUND-CALC
 10130        END-IF
 10131     END-IF
 10132     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
 10133     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
 10134
 10135     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
 10136
 10137     IF NO-BENEFIT-FOUND
 10138        GO TO 0500-SET-ACCOUNT.
 10139
 10140     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
 10141        MOVE CF-ST-REM-TERM-CALC (SUB3)
 10142                                 TO WS-AH-REM-TERM-CALC
 10143                                    EC-ST-AH-REM-TERM-CALC
 10144     END-IF
 10145
 10146     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
 10147        MOVE CF-ST-REFUND-CALC (SUB3)
 10148                                 TO WS-AH-REFUND-CALC
 10149                                    EC-ST-AH-REFUND-CALC
 10150     END-IF
 10151
 10152*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
 10153
 10154     GO TO 0500-SET-ACCOUNT.
 10155
 10156 0499-STATE-NOT-FOUND.
 10157
 10158     MOVE ER-2603                TO WS-ERROR.
 10159     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10160
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 186
* EL050.cbl
 10162
 10163 0500-SET-ACCOUNT.
 10164*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
 10165     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10166        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
 10167        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 10168        MOVE WS-CLP-STATE        TO CNTL-ACCESS
 10169        MOVE '3'                 TO CNTL-REC-TYPE
 10170        MOVE +0                  TO CNTL-SEQ-NO
 10171
 10172        MOVE '3'                 TO RC-SW-2
 10173        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 10174
 10175        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 10176           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
 10177           WS-CLP-STATE  NOT = CF-STATE-CODE)
 10178           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
 10179                                    WS-ST-AH-PREM-TAX-I
 10180                                    WS-ST-AH-PREM-TAX-G
 10181        ELSE
 10182           IF CF-ST-LF-PREM-TAX NUMERIC
 10183              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10184           END-IF
 10185           IF CF-ST-AH-PREM-TAX-I NUMERIC
 10186              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10187           END-IF
 10188           IF CF-ST-AH-PREM-TAX-G NUMERIC
 10189              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10190           END-IF
 10191        END-IF
 10192        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
 10193     END-IF
 10194*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
 10195*  FOR DCC ONLY
 10196     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 10197
 10198        MOVE ' '                 TO STAT-MASTER-SW
 10199        MOVE PB-COMPANY-ID       TO ELSTAT-COMPANY-ID
 10200        MOVE PB-CARRIER          TO ELSTAT-CARRIER
 10201        MOVE PB-GROUPING         TO ELSTAT-GROUP
 10202        MOVE PB-STATE            TO ELSTAT-STATE
 10203        IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10204           MOVE WS-CLP-STATE     TO ELSTAT-STATE
 10205        END-IF
 10206
 10207        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 10208        SET BIN-TO-GREG          TO TRUE
 10209        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10210        MOVE DC-GREG-DATE-CYMD   TO ELSTAT-EXP-DT
 10211        MOVE ELSTAT-KEY          TO ELSTAT-KEY-SAVE
 10212
 10213        PERFORM 8750-START-ELSTAT THRU 8750-EXIT
 10214        IF STAT-MASTER-FOUND
 10215           MOVE 'N'              TO STAT-MASTER-SW
 10216           PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10217           IF STAT-MASTER-FOUND
 10218              IF (ELSTAT-KEY-SAVE (1:12) =
 10219                           SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 187
* EL050.cbl
 10220                 IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10221                    MOVE 'F'        TO STAT-MASTER-SW
 10222                 ELSE
 10223                    PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10224                    IF (STAT-MASTER-FOUND)
 10225                       AND (ELSTAT-KEY-SAVE (1:12) =
 10226                           SF-CONTROL-PRIMARY (1:12))
 10227                       AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10228                       MOVE 'F'     TO STAT-MASTER-SW
 10229                    END-IF
 10230                 END-IF
 10231              END-IF
 10232           END-IF
 10233        END-IF
 10234
 10235        IF STAT-MASTER-SW = 'F'
 10236           IF (SF-ST-LF-PREM-TAX NUMERIC)
 10237              and (sf-st-lf-prem-tax > zeros)
 10238              MOVE SF-ST-LF-PREM-TAX
 10239                                 TO WS-ST-LF-PREM-TAX
 10240           END-IF
 10241           IF (SF-ST-AH-PREM-TAX-I NUMERIC)
 10242              and (sf-st-ah-prem-tax-i > zeros)
 10243              MOVE SF-ST-AH-PREM-TAX-I
 10244                                 TO WS-ST-AH-PREM-TAX-I
 10245           END-IF
 10246           IF (SF-ST-AH-PREM-TAX-G NUMERIC)
 10247              and (sf-st-ah-prem-tax-g > zeros)
 10248              MOVE SF-ST-AH-PREM-TAX-G
 10249                                 TO WS-ST-AH-PREM-TAX-G
 10250           END-IF
 10251        END-IF
 10252     END-IF
 10253     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10254        AND (PB-ISSUE)
 10255        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10256        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 10257        AND (AM-GPCD = 06)
 10258        MOVE 'Y'                 TO WS-GOOD-HIN
 10259        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10260           MOVE PB-I-VIN         TO WS-WORK-VIN
 10261           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10262              (V1 > 16)
 10263              IF WS-WORK-VIN (V1:1) NUMERIC
 10264                 MOVE WS-WORK-VIN-N (V1)
 10265                                 TO WS-ROW-B-VAL (V1)
 10266              ELSE
 10267                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 10268                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 10269                    OR (V2 > 26)
 10270                 END-PERFORM
 10271                 IF V2 < 27
 10272                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 10273                 ELSE
 10274                    MOVE 'N'     TO WS-GOOD-HIN
 10275                 END-IF
 10276              END-IF
 10277              COMPUTE WS-ROW-D-VAL (V1) =
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 188
* EL050.cbl
 10278                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 10279              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
 10280                 WS-ROW-D-VAL (V1)
 10281           END-PERFORM
 10282           MOVE ZEROS            TO WS-VIN-REMAINDER
 10283           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 10284             REMAINDER WS-VIN-REMAINDER
 10285           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 10286              CONTINUE
 10287           ELSE
 10288              MOVE 'N'           TO WS-GOOD-HIN
 10289           END-IF
 10290        ELSE
 10291           MOVE 'N'              TO WS-GOOD-HIN
 10292        END-IF
 10293        IF WS-GOOD-HIN NOT = 'Y'
 10294           MOVE ER-3826           TO WS-ERROR
 10295           PERFORM 9900-ERROR-FORMAT
 10296                                 THRU 9900-EXIT
 10297        END-IF
 10298     END-IF
 10299     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10300        AND (PB-ISSUE)
 10301        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10302        AND (AM-GPCD NOT = 06)
 10303        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10304           perform 3400-edit-vin thru 3400-exit
 10305        ELSE
 10306          MOVE ER-3826           TO WS-ERROR
 10307          PERFORM 9900-ERROR-FORMAT
 10308                                 THRU 9900-EXIT
 10309        END-IF
 10310     END-IF
 10311     if (pb-company-id = 'CID')
 10312        and (pb-issue)
 10313        and (pb-i-vin not = spaces and low-values and zeros)
 10314        perform 3400-edit-vin    thru 3400-exit
 10315     end-if
 10316******************************************************************
 10317******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10318******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10319******* METHODS.
 10320******************************************************************
 10321     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10322        IF PB-CANCELLATION
 10323           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10324              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10325                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10326                IF FORM-MASTER-FOUND
 10327                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10328******************************************************************
 10329
 10330     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10331     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10332
 10333     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10334     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10335     MOVE AM-STATUS              TO WS-ACCT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 189
* EL050.cbl
 10336     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10337
 10338
 10339     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10340     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
 10341     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10342
 10343     IF AM-LF-OB-RATE NOT NUMERIC
 10344         MOVE ZERO               TO AM-LF-OB-RATE.
 10345
 10346     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10347         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10348
 10349     IF AM-AH-OB-RATE NOT NUMERIC
 10350         MOVE ZERO               TO AM-AH-OB-RATE.
 10351
 10352     IF WS-LF-JOINT-INDICATOR = 'J'
 10353         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10354     ELSE
 10355         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10356
 10357     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10358
 10359     IF WS-IG-OVRD-AM  EQUAL SPACE
 10360         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10361
 10362     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10363         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10364                                       WS-IG-OVRD
 10365     ELSE
 10366         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10367             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10368                                       WS-IG-OVRD
 10369         ELSE
 10370             MOVE AM-IG             TO WS-IG-OVRD-AH
 10371                                       WS-IG-OVRD.
 10372
 10373     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10374         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10375                                       WS-IG-OVRD
 10376     ELSE
 10377         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10378             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10379                                       WS-IG-OVRD
 10380         ELSE
 10381             MOVE AM-IG             TO WS-IG-OVRD-LF
 10382                                       WS-IG-OVRD.
 10383
 10384     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10385     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10386     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10387     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10388*     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10389     INSPECT WS-ACCT-STATUS CONVERTING '9876543210'
 10390                                              TO 'PRLDSFCTIA'.
 10391
 10392     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10393     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 190
* EL050.cbl
 10394     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10395     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10396
 10397     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10398     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10399     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10400     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10401     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10402     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10403     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10404
 10405     IF WS-ACCT-AH-DEV-PCT > +0
 10406        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10407     ELSE
 10408        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10409
 10410     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10411        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10412     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10413        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10414
 10415        IF AM-EARN-METHOD-L = 'S'
 10416            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10417                                        WS-LF-REFUND-CALC.
 10418
 10419        IF AM-EARN-METHOD-R = 'S'
 10420            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10421                                        WS-LF-REFUND-CALC.
 10422
 10423     IF WS-LF-COVERAGE-TYPE = 'R'
 10424         IF AM-EARN-METHOD-R = 'R'
 10425            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10426                                    WS-LF-REFUND-CALC.
 10427     IF WS-LF-COVERAGE-TYPE = 'R'
 10428         IF AM-EARN-METHOD-R = 'P'
 10429            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10430                                    WS-LF-REFUND-CALC.
 10431     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10432         IF AM-EARN-METHOD-L = 'R'
 10433            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10434                                    WS-LF-REFUND-CALC.
 10435     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10436         IF AM-EARN-METHOD-L = 'P'
 10437            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10438                                    WS-LF-REFUND-CALC.
 10439     IF WS-LF-COVERAGE-TYPE = 'R'
 10440         IF AM-EARN-METHOD-R = 'A'
 10441            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10442                                    WS-LF-REFUND-CALC.
 10443     IF WS-LF-COVERAGE-TYPE = 'R'
 10444         IF AM-EARN-METHOD-R = 'M'
 10445            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10446                                    WS-LF-REFUND-CALC.
 10447     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10448         IF AM-EARN-METHOD-L = 'A'
 10449            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10450                                    WS-LF-REFUND-CALC.
 10451     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 191
* EL050.cbl
 10452         IF AM-EARN-METHOD-L = 'M'
 10453            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10454                                    WS-LF-REFUND-CALC.
 10455
 10456     IF AM-EARN-METHOD-A = 'R'
 10457        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10458                                    WS-AH-REFUND-CALC.
 10459     IF AM-EARN-METHOD-A = 'P'
 10460        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10461                                    WS-AH-REFUND-CALC.
 10462     IF AM-EARN-METHOD-A = 'C'
 10463        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10464                                    WS-AH-REFUND-CALC.
 10465     IF AM-EARN-METHOD-A = 'A'
 10466        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10467                                    WS-AH-REFUND-CALC.
 10468     IF AM-EARN-METHOD-A = 'M'
 10469        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10470                                    WS-AH-REFUND-CALC.
 10471     IF AM-EARN-METHOD-A = 'N'
 10472        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10473                                    WS-AH-REFUND-CALC.
 10474     IF AM-EARN-METHOD-A = 'S'
 10475        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10476                                    WS-AH-REFUND-CALC.
 10477
 10478     IF AM-TOL-PREM NOT = ZEROS
 10479        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10480                                    WS-TOL-AH-PREM.
 10481
 10482     IF AM-OVR-SHT-AMT NUMERIC AND
 10483                  AM-OVR-SHT-AMT > 0
 10484        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10485                                    EC-AM-LF-OVR-SHT-AMT
 10486                                    WS-AH-REFUND-OVS-AMT
 10487                                    EC-AM-AH-OVR-SHT-AMT.
 10488
 10489     IF AM-OVR-SHT-PCT NUMERIC AND
 10490                    AM-OVR-SHT-PCT > 0
 10491        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10492                                    EC-AM-LF-OVR-SHT-PCT
 10493                                    WS-AH-REFUND-OVS-PCT
 10494                                    EC-AM-AH-OVR-SHT-PCT.
 10495
 10496     IF AM-TOL-REF-PCT NUMERIC AND
 10497                  AM-TOL-REF-PCT > 0
 10498        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10499                                    WS-TOL-AH-REFUND-PCT.
 10500
 10501     IF AM-TOL-REF  NOT = ZEROS  AND
 10502                  AM-TOL-REF NUMERIC
 10503        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10504                                    EC-AM-LF-TOL-REFUND
 10505                                    WS-TOL-AH-REFUND
 10506                                    EC-AM-AH-TOL-REFUND.
 10507
 10508     IF AM-TOL-CLM  NOT = ZEROS
 10509        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 192
* EL050.cbl
 10510                                    WS-TOL-AH-CLAIM.
 10511
 10512     IF AM-CLP-TOL-PCT NOT NUMERIC
 10513        MOVE +0                  TO AM-CLP-TOL-PCT
 10514     END-IF
 10515
 10516     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10517        MOVE +0                  TO AM-SPP-LEASE-COMM
 10518     END-IF
 10519     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10520        MOVE WS-PL-TOL-LF-PREM-PCT
 10521                                 TO WS-TOL-LF-PREM-PCT.
 10522
 10523     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10524        MOVE WS-PL-TOL-AH-PREM-PCT
 10525                                 TO WS-TOL-AH-PREM-PCT.
 10526
 10527     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10528        MOVE WS-PL-TOL-LF-REFUND-PCT
 10529                                 TO WS-TOL-LF-REFUND-PCT.
 10530
 10531     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10532        MOVE WS-PL-TOL-AH-REFUND-PCT
 10533                                 TO WS-TOL-AH-REFUND-PCT.
 10534
 10535     IF WS-PL-REF-OVS-AMT > +0
 10536        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10537
 10538     IF WS-PL-REF-OVS-PCT > +0
 10539        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10540
 10541     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10542        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10543     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10544        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10545     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10546        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10547     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10548        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10549     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10550        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10551     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10552        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10553
 10554     IF WS-AH-PL-REF-OVS-AMT > +0
 10555        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10556
 10557     IF WS-AH-PL-REF-OVS-PCT > +0
 10558        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10559
 10560     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10561     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10562
 10563     IF PB-CANCELLATION
 10564        GO TO 3000-CONTINUE-EDIT.
 10565
 10566     MOVE +1 TO SUB1.
 10567     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 193
* EL050.cbl
 10568     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10569
 10570     IF CF-COMPANY-ID = 'DMD'
 10571       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10572         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10573        ELSE
 10574         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10575
 10576  0525-FIND-ACCT-COMM.
 10577     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10578        NEXT SENTENCE
 10579      ELSE
 10580         ADD +1 TO SUB1
 10581         IF SUB1 LESS +11
 10582            GO TO 0525-FIND-ACCT-COMM
 10583          ELSE
 10584             GO TO 0550-st-comm-cap-check.
 10585
 10586     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10587     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10588                                    PB-I-LIFE-COMMISSION.
 10589***  IF PB-COMPANY-ID = 'CRI'
 10590     IF PB-PREM-ACCTNG-ONLY
 10591         GO TO 0550-st-comm-cap-check.
 10592
 10593     MOVE '0530' TO CTBL-SW.
 10594     MOVE ' '    TO WS-CTBL-READ-SW.
 10595
 10596
 10597 0530-GET-AH-COMP.
 10598     IF NO-AH-COVERAGE  OR
 10599        NO-AH-BENEFIT-MATCH
 10600           GO TO 0540-NEXT-READ-STEP.
 10601
 10602     IF AM-A-COM (SUB1) NUMERIC
 10603        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10604         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10605         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10606         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10607         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10608     ELSE
 10609          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10610          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10611          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10612          MOVE ZEROS             TO WS-SUB1
 10613                                    WS-COMMISSION
 10614          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10615          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10616          IF WS-COMMISSION > ZEROS
 10617             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10618             GO TO 0540-NEXT-READ-STEP
 10619          END-IF
 10620          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10621          IF CTBL-TABLE-FOUND
 10622             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10623                                        PB-I-AH-TERM
 10624             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10625             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 194
* EL050.cbl
 10626             GO TO 0540-NEXT-READ-STEP
 10627          ELSE
 10628             IF FIRST-TIME-THROUGH
 10629                 GO TO 0530-GET-AH-COMP
 10630             ELSE
 10631                 MOVE ER-2609                TO WS-ERROR
 10632                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10633
 10634 0540-NEXT-READ-STEP.
 10635     MOVE '0540' TO CTBL-SW.
 10636     MOVE ' '    TO WS-CTBL-READ-SW.
 10637
 10638 0540-GET-LF-COMP.
 10639     IF NO-LIFE-COVERAGE  OR
 10640        NO-LF-BENEFIT-MATCH
 10641           GO TO 0550-st-comm-cap-check.
 10642
 10643     IF WS-LF-JOINT-INDICATOR = 'J'
 10644        IF AM-J-COM (SUB1) NUMERIC
 10645           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10646           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10647           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10648           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10649           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10650        ELSE
 10651           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10652           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10653           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10654           MOVE ZEROS                TO WS-SUB1
 10655                                        WS-COMMISSION
 10656           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10657           IF WS-COMMISSION > ZEROS
 10658              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10659              GO TO 0550-st-comm-cap-check
 10660           END-IF
 10661           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10662           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10663           IF CTBL-TABLE-FOUND
 10664              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10665              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10666              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10667              GO TO 0550-st-comm-cap-check
 10668           ELSE
 10669              IF FIRST-TIME-THROUGH
 10670                  GO TO 0540-GET-LF-COMP
 10671              ELSE
 10672                  MOVE ER-2609                TO WS-ERROR
 10673                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10674                  GO TO 0550-st-comm-cap-check.
 10675
 10676     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10677        IF AM-L-COM (SUB1) NUMERIC
 10678           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10679           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10680           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10681           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10682           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10683        ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 195
* EL050.cbl
 10684           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10685           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10686           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10687           MOVE ZEROS                TO WS-SUB1
 10688                                        WS-COMMISSION
 10689           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10690           IF WS-COMMISSION IS GREATER THAN ZEROS
 10691              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10692              GO TO 0550-st-comm-cap-check
 10693           END-IF
 10694           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10695           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10696           IF CTBL-TABLE-FOUND
 10697              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10698              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10699              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10700              GO TO 0550-st-comm-cap-check
 10701           ELSE
 10702              IF FIRST-TIME-THROUGH
 10703                  GO TO 0540-GET-LF-COMP
 10704              ELSE
 10705                  MOVE ER-2609                TO WS-ERROR
 10706                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10707
 10708
 10709 0550-st-comm-cap-check.
 10710
 10711     perform varying sub5 from +1 by +1 until
 10712        (sub5 > +10)
 10713        move +0                  to ws-wk-rate
 10714        if (am-gl-codes (sub5) <> 'Y')
 10715           and (am-com-typ(sub5) = 'C' or 'D' or 'O' or 'P')
 10716           if pb-i-lf-benefit-cd <> '  ' and '00'
 10717              move zeros         to ws-wk-rate
 10718              if (am-l-com (sub5) numeric)
 10719                 and (am-l-coma (sub5) (3:1) not = 'L' and 'M')
 10720                 move am-l-com(sub5)
 10721                                 to ws-wk-rate
 10722              else
 10723                 move pb-company-cd to ctbl-company-cd
 10724                 move pb-i-lf-benefit-cd
 10725                                 to ctbl-ben-code
 10726                 move pb-i-lf-term  to ws-work-term
 10727                 move pb-life-override-l1
 10728                                 to ctbl-ben-type
 10729                 move zeros      to ws-sub1
 10730                                    ws-commission
 10731                 move am-l-coma (sub5)
 10732                                 to ctbl-table
 10733                 move '0540'     to ctbl-sw
 10734                 perform 0552-get-it
 10735                                 thru 0552-exit
 10736              end-if
 10737              compute ws-tot-sl-wk-rate =
 10738                 ws-tot-sl-wk-rate + ws-wk-rate
 10739              if am-com-typ(sub5) = 'C' or 'D'
 10740                 compute ws-sl-wk-rate =
 10741                    ws-sl-wk-rate + ws-wk-rate
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 196
* EL050.cbl
 10742              else
 10743                 if am-com-typ(sub5) = 'O' or 'P'
 10744                    compute ws-ga-sl-wk-rate =
 10745                       ws-ga-sl-wk-rate + ws-wk-rate
 10746                 end-if
 10747              end-if
 10748
 10749              move zeros         to ws-wk-rate
 10750              if (am-j-com (sub5) numeric)
 10751                 and (am-j-coma (sub5) (3:1) not = 'L' and 'M')
 10752                 move am-j-com(sub5)
 10753                                 to ws-wk-rate
 10754              else
 10755                 move pb-company-cd to ctbl-company-cd
 10756                 move pb-i-lf-benefit-cd
 10757                                 to ctbl-ben-code
 10758                 move pb-i-lf-term  to ws-work-term
 10759                 move pb-life-override-l1
 10760                                 to ctbl-ben-type
 10761                 move zeros      to ws-sub1
 10762                                    ws-commission
 10763                 move am-j-coma (sub5)
 10764                                 to ctbl-table
 10765                 move '0540'     to ctbl-sw
 10766                 perform 0552-get-it
 10767                                 thru 0552-exit
 10768              end-if
 10769              compute ws-tot-jl-wk-rate =
 10770                 ws-tot-jl-wk-rate + ws-wk-rate
 10771              if am-com-typ(sub5) = 'C' or 'D'
 10772                 compute ws-jl-wk-rate =
 10773                    ws-jl-wk-rate + ws-wk-rate
 10774              else
 10775                 if am-com-typ(sub5) = 'O' or 'P'
 10776                    compute ws-ga-jl-wk-rate =
 10777                       ws-ga-jl-wk-rate + ws-wk-rate
 10778                 end-if
 10779              end-if
 10780           end-if
 10781           move zeros            to ws-wk-rate
 10782
 10783           if pb-i-ah-benefit-cd <> '  ' and '00'
 10784              if (am-a-com (sub5) numeric)
 10785                 and (am-a-coma (sub5) (3:1) not = 'L' and 'M')
 10786                 move am-a-com(sub5)
 10787                                 to ws-wk-rate
 10788              else
 10789                 move pb-company-cd to ctbl-company-cd
 10790                 move pb-i-ah-benefit-cd
 10791                                 to ctbl-ben-code
 10792                 move pb-i-ah-term  to ws-work-term
 10793                 move pb-ah-override-l1
 10794                                 to ctbl-ben-type
 10795                 move zeros      to ws-sub1
 10796                                    ws-commission
 10797                 move am-a-coma (sub5)
 10798                                 to ctbl-table
 10799                 move '0530'     to ctbl-sw
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 197
* EL050.cbl
 10800                 perform 0552-get-it
 10801                                 thru 0552-exit
 10802              end-if
 10803              compute ws-tot-sa-wk-rate =
 10804                 ws-tot-sa-wk-rate + ws-wk-rate
 10805              if am-com-typ(sub5) = 'C' or 'D'
 10806                 compute ws-sa-wk-rate =
 10807                    ws-sa-wk-rate + ws-wk-rate
 10808              else
 10809                 if am-com-typ(sub5) = 'O' or 'P'
 10810                    compute ws-ga-sa-wk-rate =
 10811                       ws-ga-sa-wk-rate + ws-wk-rate
 10812                 end-if
 10813              end-if
 10814           end-if
 10815        end-if
 10816     end-perform
 10817
 10818     go to 0550-continue
 10819
 10820     .
 10821 0552-get-it.
 10822
 10823     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD
 10824     MOVE ZEROS                  TO WS-SUB1
 10825                                    WS-COMMISSION
 10826     MOVE ' '                    TO WS-CTBL-READ-SW
 10827     PERFORM 8300-READ-CTBL-TABLE
 10828                                 THRU 8300-EXIT
 10829     IF FIRST-TIME-THROUGH
 10830        MOVE 'AA'                TO CTBL-BEN-CODE
 10831        PERFORM 8300-READ-CTBL-TABLE
 10832                                 THRU 8300-EXIT
 10833     END-IF
 10834     IF CTBL-TABLE-FOUND
 10835        if pb-life-override-l1 = ctbl-ben-type
 10836           move pb-i-lf-benefit-amt
 10837                                 to WS-COMM-CK-AMT
 10838        else
 10839           compute ws-comm-ck-amt =
 10840              pb-I-ah-benefit-amt * pb-i-ah-term
 10841        end-if
 10842        PERFORM 8800-GET-COMP-RATE
 10843                                 THRU 8800-EXIT
 10844     else
 10845        move zeros               to ws-wk-rate
 10846     END-IF
 10847
 10848     .
 10849 0552-exit.
 10850     exit.
 10851
 10852 0550-continue.
 10853
 10854     if ws-lf-joint-indicator = 'J'
 10855        if (ws-jl-wk-rate > ws-st-comm-cap-jl)
 10856           and (ws-st-comm-cap-jl <> zeros)
 10857           MOVE ER-1956          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 198
* EL050.cbl
 10858           PERFORM 9900-ERROR-FORMAT
 10859                                 THRU 9900-EXIT
 10860        end-if
 10861        if (ws-ga-jl-wk-rate > ws-st-ga-comm-cap-jl)
 10862           and (ws-st-ga-comm-cap-jl <> zeros)
 10863           MOVE ER-1959          TO WS-ERROR
 10864           PERFORM 9900-ERROR-FORMAT
 10865                                 THRU 9900-EXIT
 10866        end-if
 10867        if (ws-tot-jl-wk-rate > ws-st-tot-comm-cap-jl)
 10868           and (ws-st-tot-comm-cap-jl <> zeros)
 10869           MOVE ER-1962          TO WS-ERROR
 10870           PERFORM 9900-ERROR-FORMAT
 10871                                 THRU 9900-EXIT
 10872        end-if
 10873     else
 10874        if (ws-sl-wk-rate > ws-st-comm-cap-sl)
 10875           and (ws-st-comm-cap-sl <> zeros)
 10876           MOVE ER-1955          TO WS-ERROR
 10877           PERFORM 9900-ERROR-FORMAT
 10878                                 THRU 9900-EXIT
 10879        end-if
 10880        if (ws-ga-sl-wk-rate > ws-st-ga-comm-cap-sl)
 10881           and (ws-st-ga-comm-cap-sl <> zeros)
 10882           MOVE ER-1958          TO WS-ERROR
 10883           PERFORM 9900-ERROR-FORMAT
 10884                                 THRU 9900-EXIT
 10885        end-if
 10886        if (ws-tot-sl-wk-rate > ws-st-tot-comm-cap-sl)
 10887           and (ws-st-tot-comm-cap-sl <> zeros)
 10888           MOVE ER-1961          TO WS-ERROR
 10889           PERFORM 9900-ERROR-FORMAT
 10890                                 THRU 9900-EXIT
 10891        end-if
 10892
 10893     if ws-ah-joint-indicator = 'J'
 10894        if (ws-sa-wk-rate > ws-st-comm-cap-ja)
 10895           and (ws-st-comm-cap-ja <> zeros)
 10896           MOVE ER-1957          TO WS-ERROR
 10897           PERFORM 9900-ERROR-FORMAT
 10898                                 THRU 9900-EXIT
 10899        end-if
 10900        if (ws-ga-sa-wk-rate > ws-st-ga-comm-cap-ja)
 10901           and (ws-st-ga-comm-cap-ja <> zeros)
 10902           MOVE ER-1960          TO WS-ERROR
 10903           PERFORM 9900-ERROR-FORMAT
 10904                                 THRU 9900-EXIT
 10905        end-if
 10906        if (ws-tot-sa-wk-rate > ws-st-tot-comm-cap-ja)
 10907           and (ws-st-tot-comm-cap-ja <> zeros)
 10908           MOVE ER-1963          TO WS-ERROR
 10909           PERFORM 9900-ERROR-FORMAT
 10910                                 THRU 9900-EXIT
 10911        end-if
 10912     else
 10913        if (ws-sa-wk-rate > ws-st-comm-cap-sa)
 10914           and (ws-st-comm-cap-sa <> zeros)
 10915           MOVE ER-1957          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 199
* EL050.cbl
 10916           PERFORM 9900-ERROR-FORMAT
 10917                                 THRU 9900-EXIT
 10918        end-if
 10919        if (ws-ga-sa-wk-rate > ws-st-ga-comm-cap-sa)
 10920           and (ws-st-ga-comm-cap-sa <> zeros)
 10921           MOVE ER-1960          TO WS-ERROR
 10922           PERFORM 9900-ERROR-FORMAT
 10923                                 THRU 9900-EXIT
 10924        end-if
 10925        if (ws-tot-sa-wk-rate > ws-st-tot-comm-cap-sa)
 10926           and (ws-st-tot-comm-cap-sa <> zeros)
 10927           MOVE ER-1963          TO WS-ERROR
 10928           PERFORM 9900-ERROR-FORMAT
 10929                                 THRU 9900-EXIT
 10930        end-if
 10931     end-if
 10932
 10933     .
 10934 0560-EDIT-CONTINUE.
 10935     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10936                                    WS-AH-PMF-COMM
 10937*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10938*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10939     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10940        (SUB1 > +10)
 10941        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10942           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10943           MOVE '0530'           TO CTBL-SW
 10944           MOVE ' '              TO WS-CTBL-READ-SW
 10945           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10946           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10947           MOVE '0540'           TO CTBL-SW
 10948           MOVE ' '              TO WS-CTBL-READ-SW
 10949           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10950        END-IF
 10951     END-PERFORM
 10952     GO TO 0564-EDIT-CONTINUE
 10953     .
 10954 0561-CHECK-AH.
 10955     IF (NO-AH-COVERAGE)
 10956        OR (NO-AH-BENEFIT-MATCH)
 10957        CONTINUE
 10958     ELSE
 10959        IF (AM-A-COM (SUB1) NUMERIC)
 10960           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10961           IF (AM-COM-TYP (SUB1) = 'A')
 10962              AND (WS-AH-PMF-COMM = ZEROS)
 10963              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10964           END-IF
 10965           CONTINUE
 10966        ELSE
 10967           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10968           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10969           MOVE PB-AH-OVERRIDE-L1
 10970                                 TO CTBL-BEN-TYPE
 10971           MOVE ZEROS            TO WS-SUB1
 10972                                    WS-COMMISSION
 10973           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 200
* EL050.cbl
 10974           PERFORM 8300-READ-CTBL-TABLE
 10975                                 THRU 8300-EXIT
 10976           IF CTBL-TABLE-FOUND
 10977              IF (AM-COM-TYP (SUB1) = 'A')
 10978                 AND (WS-AH-PMF-COMM = ZEROS)
 10979                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10980                                        PB-I-AH-TERM
 10981                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10982                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10983              END-IF
 10984              CONTINUE
 10985           ELSE
 10986              IF FIRST-TIME-THROUGH
 10987                 GO TO 0561-CHECK-AH
 10988              ELSE
 10989                 MOVE ER-2609    TO WS-ERROR
 10990                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10991              END-IF
 10992           END-IF
 10993        END-IF
 10994     END-IF
 10995     .
 10996 0561-EXIT.
 10997     EXIT.
 10998 0563-CHECK-LF.
 10999     IF (NO-LIFE-COVERAGE)
 11000        OR (NO-LF-BENEFIT-MATCH)
 11001        CONTINUE
 11002     ELSE
 11003        IF WS-LF-JOINT-INDICATOR = 'J'
 11004           IF AM-J-COM (SUB1) NUMERIC
 11005              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11006              IF (AM-COM-TYP (SUB1) = 'A')
 11007                 AND (WS-LF-PMF-COMM = ZEROS)
 11008                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 11009              END-IF
 11010              CONTINUE
 11011           ELSE
 11012              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 11013              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 11014              MOVE PB-LIFE-OVERRIDE-L1
 11015                                 TO CTBL-BEN-TYPE
 11016              MOVE ZEROS         TO WS-SUB1
 11017                                    WS-COMMISSION
 11018              MOVE AM-J-COMA (SUB1)
 11019                                 TO CTBL-TABLE
 11020              PERFORM 8300-READ-CTBL-TABLE
 11021                                 THRU 8300-EXIT
 11022              IF CTBL-TABLE-FOUND
 11023                 IF (AM-COM-TYP (SUB1) = 'A')
 11024                    AND (WS-LF-PMF-COMM = ZEROS)
 11025                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 11026                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 11027                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 11028                 END-IF
 11029                 CONTINUE
 11030              ELSE
 11031                 IF FIRST-TIME-THROUGH
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 201
* EL050.cbl
 11032                    GO TO 0563-CHECK-LF
 11033                 ELSE
 11034                    MOVE ER-2609 TO WS-ERROR
 11035                    PERFORM 9900-ERROR-FORMAT
 11036                                 THRU 9900-EXIT
 11037*                   GO TO 0560-EDIT-CONTINUE
 11038                 END-IF
 11039              END-IF
 11040           END-IF
 11041        ELSE
 11042           IF AM-L-COM (SUB1) NUMERIC
 11043              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11044              IF (AM-COM-TYP (SUB1) = 'A')
 11045                 AND (WS-LF-PMF-COMM = ZEROS)
 11046                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 11047              END-IF
 11048              CONTINUE
 11049           ELSE
 11050              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 11051              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 11052              MOVE PB-LIFE-OVERRIDE-L1
 11053                                 TO CTBL-BEN-TYPE
 11054              MOVE ZEROS         TO WS-SUB1
 11055                                    WS-COMMISSION
 11056              MOVE AM-L-COMA (SUB1)
 11057                                 TO CTBL-TABLE
 11058              PERFORM 8300-READ-CTBL-TABLE
 11059                                 THRU 8300-EXIT
 11060              IF CTBL-TABLE-FOUND
 11061                 CONTINUE
 11062              ELSE
 11063                 IF FIRST-TIME-THROUGH
 11064                    GO TO 0563-CHECK-LF
 11065                 ELSE
 11066                    MOVE ER-2609 TO WS-ERROR
 11067                    PERFORM 9900-ERROR-FORMAT
 11068                                 THRU 9900-EXIT
 11069                 END-IF
 11070              END-IF
 11071           END-IF
 11072        END-IF
 11073     END-IF
 11074     .
 11075 0563-EXIT.
 11076     EXIT.
 11077 0564-EDIT-CONTINUE.
 11078
 11079     IF  PB-COMPANY-ID EQUAL 'DMD'
 11080         IF PB-I-NUM-BILLED EQUAL ZEROS
 11081            MOVE ER-8148       TO WS-ERROR
 11082            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11083
 11084*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 11085*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11086*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 11087*         SET ELAPSED-BETWEEN-BIN TO TRUE
 11088*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11089*         IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 202
* EL050.cbl
 11090*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 11091*         ELSE
 11092*             IF PB-COMPANY-ID EQUAL 'HAN'
 11093*                 MOVE ZEROS     TO PB-I-AGE.
 11094     IF PB-I-BIRTHDAY > LOW-VALUES
 11095        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 11096        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11097        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11098        PERFORM 8500-DATE-CONVERT
 11099                                 THRU 8500-EXIT
 11100        IF NO-CONVERSION-ERROR
 11101           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 11102           IF PB-I-AGE > ZEROS
 11103              IF WS-WORK-AGE NOT = PB-I-AGE
 11104                 MOVE ER-9501    TO WS-ERROR
 11105                 PERFORM 9900-ERROR-FORMAT
 11106                                 THRU 9900-EXIT
 11107              END-IF
 11108           ELSE
 11109              MOVE WS-WORK-AGE   TO PB-I-AGE
 11110           END-IF
 11111        END-IF
 11112     END-IF
 11113     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 11114                                   WS-INS-AGE-SET
 11115     IF PB-I-AGE = ZEROS
 11116        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 11117           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11118                                   WS-INS-AGE-SET
 11119           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 11120
 11121     MOVE PB-I-AGE              TO WS-EDIT-AGE
 11122                                   WS-AH-EDIT-AGE.
 11123
 11124     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 11125        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 11126        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11127        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11128        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11129        IF NO-CONVERSION-ERROR
 11130           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 11131           IF PB-I-JOINT-AGE > 0
 11132              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 11133                 MOVE ER-9503    TO WS-ERROR
 11134                 PERFORM 9900-ERROR-FORMAT
 11135                                 THRU 9900-EXIT
 11136              END-IF
 11137           ELSE
 11138              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 11139           END-IF
 11140        ELSE
 11141           MOVE ZEROS            TO PB-I-JOINT-AGE
 11142        END-IF
 11143     END-IF
 11144     IF PB-I-JOINT-AGE NOT NUMERIC
 11145        MOVE ZERO               TO PB-I-JOINT-AGE.
 11146
 11147     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 203
* EL050.cbl
 11148                                   WS-JNT-AGE-SET
 11149     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 11150        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 11151           (WS-AH-JOINT-INDICATOR = 'J')
 11152           IF PB-I-JOINT-AGE = ZEROS
 11153               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 11154                                          WS-JNT-AGE-SET
 11155               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 11156           END-IF
 11157        END-IF
 11158     END-IF
 11159
 11160     MOVE ' ' TO PB-I-LIFE-INDICATOR
 11161     IF WS-LF-JOINT-INDICATOR = 'J'
 11162        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 11163        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 11164            IF  PB-I-JOINT-AGE = ZERO
 11165                MOVE ER-2686       TO WS-ERROR
 11166                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11167            ELSE
 11168                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 11169                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 11170                    IF PB-COMPANY-ID NOT = 'LBL'
 11171                        MOVE ER-2685    TO WS-ERROR
 11172                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11173
 11174     IF WS-AH-JOINT-INDICATOR = 'J'
 11175        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 11176            IF  PB-I-JOINT-AGE = ZERO
 11177                MOVE ER-2686       TO WS-ERROR
 11178                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11179            ELSE
 11180                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 11181                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 11182                                           WS-EDIT-AGE
 11183                    IF PB-COMPANY-ID NOT = 'LBL'
 11184                        MOVE ER-2685    TO WS-ERROR
 11185                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11186
 11187******************************************************************
 11188*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 11189******************************************************************
 11190
 11191     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 11192        (WS-AH-SPECIAL-CALC-CD = 'O')
 11193        NEXT SENTENCE
 11194     ELSE
 11195        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 11196          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 11197           (WS-LF-JOINT-INDICATOR = 'J'  OR
 11198            WS-AH-JOINT-INDICATOR = 'J')  AND
 11199           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 11200            MOVE ER-2627             TO WS-ERROR
 11201            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11202
 11203     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 11204        (WS-AH-SPECIAL-CALC-CD = 'O')
 11205         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 204
* EL050.cbl
 11206     ELSE
 11207         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 11208            WS-AH-JOINT-INDICATOR = 'J'
 11209             IF PB-I-JOINT-INSURED = SPACES
 11210                 IF PB-COMPANY-ID NOT = 'JAL'
 11211                     MOVE ER-2696    TO WS-ERROR
 11212                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11213
 11214     IF PB-COMPANY-ID NOT = 'BOA'
 11215        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 11216           (WS-AH-JOINT-INDICATOR NOT = 'J')
 11217           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 11218               PB-I-JOINT-INSURED NOT = SPACES)
 11219                MOVE ER-2691         TO WS-ERROR
 11220                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11221
 11222     IF PB-COMPANY-ID = 'BOA'
 11223        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 11224           (WS-AH-JOINT-INDICATOR NOT = 'J')
 11225            IF PB-I-JOINT-AGE NOT = ZEROS
 11226                MOVE ER-2691         TO WS-ERROR
 11227                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11228
 11229     IF PB-COMPANY-ID = 'CRI'
 11230        IF PB-I-SIG-SW = 'J'
 11231           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 11232              WS-AH-JOINT-INDICATOR NOT = 'J'
 11233              MOVE ER-2675       TO WS-ERROR
 11234              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11235
 11236     IF PB-COMPANY-ID = 'CRI'
 11237        IF PB-I-SIG-SW = 'S'
 11238           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 11239              WS-AH-JOINT-INDICATOR = 'J'
 11240              MOVE ER-2676       TO WS-ERROR
 11241              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11242
 11243     IF PB-COMPANY-ID = 'CVL'
 11244         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 11245            (WS-LF-JOINT-INDICATOR NOT = 'J')
 11246              MOVE ER-2783           TO WS-ERROR
 11247              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11248     IF (WS-LF-JOINT-INDICATOR = 'J')
 11249        AND (WS-AH-JOINT-INDICATOR = 'J')
 11250        AND (PB-I-LF-TERM > 120)
 11251        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 11252        MOVE ER-2783             TO WS-ERROR
 11253        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11254     END-IF
 11255     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 11256
 11257     IF PB-I-INDV-GRP-OVRD = 'I'
 11258        MOVE ER-2666             TO WS-ERROR
 11259        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11260        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 11261
 11262     IF PB-I-INDV-GRP-OVRD = 'G'
 11263        MOVE ER-2666             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 205
* EL050.cbl
 11264        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11265        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 11266
 11267     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 11268        NEXT SENTENCE
 11269     ELSE
 11270        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 11271
 11272     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 11273        IF WS-ERROR = ER-2666
 11274           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11275           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 11276
 11277     IF PB-COMPANY-ID = 'CID'
 11278        IF PB-STATE = 'UT' OR 'MO'
 11279           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 11280                 OR '76' OR '77')
 11281                      OR
 11282               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 11283                   OR '41' OR '42' OR '63' OR '64' OR '65'
 11284                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 11285                   OR '2K' OR '2L'))
 11286              AND PB-I-INDV-GRP-CD = 'I'
 11287              MOVE ER-2721             TO WS-ERROR
 11288              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11289           END-IF
 11290        END-IF
 11291     END-IF
 11292
 11293     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 11294     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 11295        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 11296     ELSE
 11297        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 11298     END-IF
 11299
 11300*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 11301*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 11302     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 11303                                    ACCOUNT-AH-CK-SW.
 11304
 11305     IF PB-REISSUED-CERT       OR
 11306        PB-REIN-ONLY-CERT      OR
 11307        PB-POLICY-IS-DECLINED  OR
 11308        PB-POLICY-IS-VOIDED
 11309*       OR PB-MONTHLY-CERT
 11310         GO TO 3000-CONTINUE-EDIT.
 11311
 11312     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11313        IF WS-EDIT-AGE           > +65
 11314           MOVE ER-2709          TO WS-ERROR
 11315           PERFORM 9900-ERROR-FORMAT
 11316                                 THRU 9900-EXIT
 11317        ELSE
 11318           IF WS-EDIT-AGE        > +55
 11319              MOVE ER-2718       TO WS-ERROR
 11320              PERFORM 9900-ERROR-FORMAT
 11321                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 206
* EL050.cbl
 11322           END-IF
 11323        END-IF
 11324     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 11325        IF WS-EDIT-AGE           > +65
 11326           MOVE ER-2709          TO WS-ERROR
 11327           PERFORM 9900-ERROR-FORMAT
 11328                                 THRU 9900-EXIT
 11329        END-IF
 11330     END-IF
 11331     .
 11332
 11333 0565-LIFE-PLAN-LIMIT-EDITS.
 11334
 11335     IF NOT LF-PLAN-MASTER-FOUND
 11336        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 11337                                    EC-AM-LF-MAX-TOT-BEN
 11338        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11339
 11340     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 11341
 11342     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11343         IF PL-LM-AGE (1) = ZEROS
 11344             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11345
 11346     IF NO-LF-BENEFIT-MATCH          OR
 11347        WS-LF-BENEFIT-CD = ZEROS     OR
 11348        WS-LF-SPECIAL-CALC-CD = 'M'
 11349        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11350
 11351     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 11352     MOVE +1                     TO SUB2.
 11353
 11354     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11355        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11356           MOVE +5   TO SUB2
 11357           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11358              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11359              (PL-LM-AGE (SUB2) EQUAL +0)
 11360              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 11361              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11362
 11363     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 11364
 11365     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 11366                               + PB-I-LF-ALT-BENEFIT-AMT.
 11367
 11368 0568-CHECK-LIFE-ATT-AGE.
 11369
 11370     IF PL-ATT-AGE NUMERIC AND
 11371        PL-ATT-AGE > +0
 11372        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11373     END-IF
 11374*    IF PL-ATT-AGE NUMERIC AND
 11375*       PL-ATT-AGE > +0
 11376*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11377*       IF PB-I-BIRTHDAY > LOW-VALUES
 11378*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11379*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 207
* EL050.cbl
 11380*          MOVE ZERO             TO DC-ELAPSED-DAYS
 11381*          SET BIN-PLUS-ELAPSED  TO TRUE
 11382*          PERFORM 8500-DATE-CONVERT
 11383*                                THRU 8500-EXIT
 11384*          IF NO-CONVERSION-ERROR
 11385*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 11386*             MOVE ER-2669       TO WS-ERROR
 11387*             PERFORM 9900-ERROR-FORMAT
 11388*                                THRU 9900-EXIT
 11389*          END-IF
 11390*       ELSE
 11391*          IF WS-ATT-AGE >= PL-ATT-AGE
 11392*             MOVE ER-2669       TO WS-ERROR
 11393*             PERFORM 9900-ERROR-FORMAT
 11394*                                THRU 9900-EXIT
 11395*          END-IF
 11396*       END-IF
 11397*    END-IF
 11398     .
 11399 0570-CHECK-LIFE-LIMITS.
 11400
 11401     IF PB-COMPANY-ID EQUAL 'CRI'
 11402        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11403           IF SUB2 GREATER THAN +4
 11404              MOVE ER-2637 TO WS-ERROR
 11405              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11406              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11407
 11408     IF PB-COMPANY-ID  =  'NCL'
 11409        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11410            SUB2 GREATER THAN +8
 11411             MOVE 'U'         TO PB-BATCH-ENTRY
 11412             MOVE ER-2637     TO WS-ERROR
 11413             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11414             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11415
 11416     IF SUB2 > +8
 11417        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11418           AND (PB-I-SIG-SW = 'Y')
 11419           CONTINUE
 11420        ELSE
 11421           MOVE ER-2637          TO WS-ERROR
 11422           PERFORM 9900-ERROR-FORMAT
 11423                                 THRU 9900-EXIT
 11424        END-IF
 11425        GO TO 0580-AH-PLAN-LIMIT-EDITS
 11426     END-IF
 11427     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 11428     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 11429     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 11430
 11431     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11432        ADD +1  TO SUB2
 11433        GO TO 0570-CHECK-LIFE-LIMITS.
 11434
 11435     IF PB-COMPANY-ID = 'NCL'
 11436         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 11437
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 208
* EL050.cbl
 11438     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 11439        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 11440        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11441           AND (PB-I-SIG-SW = 'Y')
 11442           CONTINUE
 11443        ELSE
 11444           MOVE ER-2637          TO WS-ERROR
 11445           PERFORM 9900-ERROR-FORMAT
 11446                                 THRU 9900-EXIT
 11447        END-IF
 11448     END-IF
 11449     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11450
 11451
 11452 0570-CHECK-NCL-LIFE-LIMITS.
 11453
 11454     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 11455        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
 11456         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11457
 11458     IF APP-CERT-USED
 11459         IF SUB2  LESS THAN  +5
 11460             MOVE +5          TO SUB2
 11461             GO TO 0570-CHECK-LIFE-LIMITS.
 11462
 11463     MOVE ER-2637             TO WS-ERROR.
 11464     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11465
 11466     MOVE 'U'                 TO PB-BATCH-ENTRY.
 11467
 11468 0575-CHECK-NCL-SIG-SWITCH.
 11469
 11470     IF NOT APP-CERT-USED
 11471         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11472
 11473     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11474        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11475        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11476        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11477         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11478
 11479     IF SUB2 GREATER THAN +4
 11480         IF PL-LM-AGE (5) = ZEROS  AND
 11481            PL-LM-AGE (6) = ZEROS  AND
 11482            PL-LM-AGE (7) = ZEROS  AND
 11483            PL-LM-AGE (8) = ZEROS
 11484             MOVE  ER-1927        TO WS-ERROR
 11485             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11486             GO TO 0580-AH-PLAN-LIMIT-EDITS
 11487         ELSE
 11488             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11489                 MOVE  ER-1920    TO WS-ERROR
 11490                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11491
 11492     IF PB-I-SIG-SW  = 'Y'
 11493       IF NOT PB-I-POLICY-ACCEPTED  AND
 11494          NOT PB-I-POLICY-DECLINED
 11495           MOVE 'U'               TO PB-BATCH-ENTRY
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 209
* EL050.cbl
 11496           MOVE  ER-1926          TO WS-ERROR
 11497           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11498
 11499
 11500 0580-AH-PLAN-LIMIT-EDITS.
 11501
 11502     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11503        IF PB-I-AH-BENEFIT-AMT > +1250
 11504           MOVE ER-2702          TO WS-ERROR
 11505           PERFORM 9900-ERROR-FORMAT
 11506                                 THRU 9900-EXIT
 11507        END-IF
 11508     END-IF
 11509
 11510     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 11511        AND (PB-MONTHLY-CERT)
 11512        IF PB-I-AH-BENEFIT-AMT > +3000
 11513           MOVE ER-2881          TO WS-ERROR
 11514           PERFORM 9900-ERROR-FORMAT
 11515                                 THRU 9900-EXIT
 11516        END-IF
 11517     END-IF
 11518     IF NOT AH-PLAN-MASTER-FOUND
 11519        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 11520        GO TO 3000-CONTINUE-EDIT.
 11521
 11522     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 11523
 11524     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11525         IF PL-LM-AGE (1) = ZEROS
 11526             GO TO 3000-CONTINUE-EDIT.
 11527
 11528     IF NO-AH-BENEFIT-MATCH          OR
 11529        WS-AH-BENEFIT-CD = ZEROS     OR
 11530        WS-AH-SPECIAL-CALC-CD = 'M'
 11531        GO TO 3000-CONTINUE-EDIT.
 11532
 11533     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11534     MOVE +1                     TO SUB2.
 11535
 11536     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11537        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11538           MOVE +5 TO SUB2
 11539           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11540              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11541              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11542              (PL-LM-AGE (SUB2) EQUAL +0)
 11543              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 11544              GO TO 3000-CONTINUE-EDIT.
 11545
 11546     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11547
 11548 0590-CHECK-AH-ATT-AGE.
 11549
 11550     IF PL-ATT-AGE NUMERIC AND
 11551        PL-ATT-AGE GREATER THAN +0
 11552        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11553     END-IF
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 210
* EL050.cbl
 11554*       IF WS-ATT-AGE >= PL-ATT-AGE
 11555*          MOVE ER-3054          TO WS-ERROR
 11556*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11557     .
 11558 0597-CHECK-AH-LIMITS.
 11559
 11560     IF PB-COMPANY-ID EQUAL 'CRI'
 11561        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11562           IF SUB2 GREATER THAN +4
 11563              MOVE ER-2638       TO WS-ERROR
 11564              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11565              GO TO 3000-CONTINUE-EDIT.
 11566
 11567     IF PB-COMPANY-ID  =  'NCL'
 11568        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11569            SUB2 GREATER THAN +8
 11570             MOVE 'U'            TO PB-BATCH-ENTRY
 11571             MOVE ER-2638        TO WS-ERROR
 11572             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11573             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11574
 11575     IF SUB2 > +8
 11576        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11577           AND (PB-I-SIG-SW = 'Y')
 11578           CONTINUE
 11579        ELSE
 11580           MOVE ER-2638          TO WS-ERROR
 11581           PERFORM 9900-ERROR-FORMAT
 11582                                 THRU 9900-EXIT
 11583        END-IF
 11584        GO TO 3000-CONTINUE-EDIT
 11585     END-IF
 11586
 11587     IF PB-COMPANY-ID = 'CRI'
 11588        IF WS-ERROR = ER-2638
 11589           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11590
 11591     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11592     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11593     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11594     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11595
 11596     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11597        ADD +1                   TO SUB2
 11598        GO TO 0597-CHECK-AH-LIMITS.
 11599
 11600     IF PB-COMPANY-ID = 'NCL'
 11601         GO TO 0597-CHECK-NCL-AH-LIMITS.
 11602
 11603     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11604        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11605        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11606                                 > PL-LM-AMT (SUB2))
 11607        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11608           AND (PB-I-SIG-SW = 'Y')
 11609           CONTINUE
 11610        ELSE
 11611           MOVE ER-2638          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 211
* EL050.cbl
 11612           PERFORM 9900-ERROR-FORMAT
 11613                                 THRU 9900-EXIT
 11614        END-IF
 11615     END-IF
 11616
 11617     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11618         IF  WS-ERROR    EQUAL    ER-2638
 11619             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11620                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11621                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11622                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11623                MOVE  ER-1910    TO  WS-ERROR
 11624                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11625
 11626     IF PB-COMPANY-ID = 'CRI'
 11627        IF WS-ERROR = ER-2638
 11628            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11629            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11630            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11631
 11632     GO TO 3000-CONTINUE-EDIT.
 11633
 11634 0597-CHECK-NCL-AH-LIMITS.
 11635
 11636     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11637        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11638        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11639                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11640         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11641
 11642     IF APP-CERT-USED
 11643         IF SUB2  LESS THAN  +5
 11644             MOVE +5             TO SUB2
 11645             GO TO 0597-CHECK-AH-LIMITS.
 11646
 11647     MOVE ER-2638                TO WS-ERROR.
 11648     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11649
 11650     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11651
 11652 0599-CHECK-NCL-SIG-SWITCH.
 11653
 11654     IF NOT APP-CERT-USED
 11655         GO TO 3000-CONTINUE-EDIT.
 11656
 11657     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11658        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11659        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11660        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11661         GO TO 3000-CONTINUE-EDIT.
 11662
 11663     IF SUB2 GREATER THAN +4
 11664         IF PL-LM-AGE (5) = ZEROS  AND
 11665            PL-LM-AGE (6) = ZEROS  AND
 11666            PL-LM-AGE (7) = ZEROS  AND
 11667            PL-LM-AGE (8) = ZEROS
 11668             MOVE  ER-1927        TO WS-ERROR
 11669             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 212
* EL050.cbl
 11670             GO TO 3000-CONTINUE-EDIT
 11671         ELSE
 11672             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11673                 MOVE  ER-1920    TO WS-ERROR
 11674                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11675
 11676     IF PB-I-SIG-SW  = 'Y'
 11677       IF NOT PB-I-POLICY-ACCEPTED  AND
 11678          NOT PB-I-POLICY-DECLINED
 11679           MOVE 'U'               TO PB-BATCH-ENTRY
 11680           MOVE  ER-1926          TO WS-ERROR
 11681           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11682
 11683******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 213
* EL050.cbl
 11685
 11686 3000-CONTINUE-EDIT.
 11687
 11688     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11689     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11690     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11691     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11692     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11693
 11694     IF BROWSE-STARTED
 11695        PERFORM 9990-RETURN THRU 9990-EXIT
 11696        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11697
 11698     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11699        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11700        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11701        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11702*       MOVE 1                   TO DC-OPTION-CODE
 11703        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11704        IF DATE-CONVERSION-ERROR
 11705           MOVE ER-2622          TO WS-ERROR
 11706           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11707        ELSE
 11708           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11709              MOVE ER-2623       TO WS-ERROR
 11710              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11711           ELSE
 11712              MOVE ER-2622       TO WS-ERROR
 11713              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11714
 11715     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11716     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11717     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11718*    MOVE 1                      TO DC-OPTION-CODE.
 11719     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11720     IF DATE-CONVERSION-ERROR
 11721        GO TO 3005-EDIT-CONTINUE
 11722     ELSE
 11723        IF DC-ELAPSED-DAYS GREATER +180
 11724           MOVE ER-2613          TO WS-ERROR
 11725           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11726        ELSE
 11727           IF DC-ELAPSED-DAYS GREATER +90
 11728              MOVE ER-2612       TO WS-ERROR
 11729              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11730           ELSE
 11731             IF DC-ELAPSED-DAYS GREATER +60
 11732                MOVE ER-2614     TO WS-ERROR
 11733                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11734
 11735 3005-EDIT-CONTINUE.
 11736
 11737     IF PB-CANCELLATION
 11738         GO TO 3700-EDIT-CANCEL.
 11739
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 214
* EL050.cbl
 11741******************************************************************
 11742*                  E D I T   I S S U E                           *
 11743******************************************************************
 11744
 11745 3020-EDIT-ISSUE.
 11746
 11747      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11748      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11749      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11750      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11751      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11752
 11753     IF PB-ISSUE-FORCE
 11754        OR PB-ISSUE-DATE-FORCED
 11755        OR PB-FORCE-OFF
 11756        OR PB-OVERCHARGE-FORCE
 11757        or pb-exceeded-limit-forced
 11758        CONTINUE
 11759     ELSE
 11760        MOVE ER-2670             TO WS-ERROR
 11761        PERFORM 9900-ERROR-FORMAT
 11762                                 THRU 9900-EXIT
 11763     END-IF
 11764     .
 11765 3022-SET-POLICY-STATUS.
 11766
 11767     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11768
 11769     IF (PB-REISSUED-CERT)
 11770             OR
 11771        ((PB-COMPANY-ID NOT = 'DCC' and 'VPP')
 11772         AND (PB-MONTHLY-CERT))
 11773         MOVE '5'                TO PB-I-ENTRY-STATUS
 11774         MOVE 'E'                TO PB-BATCH-ENTRY
 11775     END-IF
 11776
 11777     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 11778        IF PB-MONTHLY-CERT
 11779           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11780        END-IF
 11781        IF PB-CASH-CERT
 11782           MOVE 'C'              TO PB-I-ENTRY-STATUS
 11783        END-IF
 11784     END-IF
 11785     IF PB-POLICY-IS-DECLINED
 11786         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11787     IF PB-POLICY-IS-VOIDED
 11788         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11789     IF PB-NEEDS-UNDERWRITING
 11790         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11791     IF PB-REIN-ONLY-CERT
 11792         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11793     IF PB-PREM-ACCTNG-ONLY
 11794         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11795
 11796     MOVE SPACE                  TO PB-I-OB-FLAG.
 11797
 11798     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 215
* EL050.cbl
 11799         MOVE ER-2665            TO WS-ERROR
 11800         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11801         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11802
 11803     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11804        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11805           MOVE 'Z'             TO PB-I-OB-FLAG.
 11806
 11807     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11808        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11809           MOVE 'Z'             TO PB-I-OB-FLAG.
 11810
 11811     IF ACCOUNT-MAST-FOUND
 11812         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11813         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11814         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11815         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11816         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11817         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11818         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11819     END-IF
 11820
 11821     IF ACCOUNT-MAST-FOUND
 11822        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11823         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11824
 11825     IF (ACCOUNT-MAST-FOUND)
 11826*        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11827        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S' OR 'D' OR 'P')
 11828        IF PB-REISSUED-CERT
 11829           CONTINUE
 11830        ELSE
 11831           MOVE ER-2608          TO WS-ERROR
 11832           PERFORM 9900-ERROR-FORMAT
 11833                                 THRU 9900-EXIT
 11834         END-IF
 11835     END-IF
 11836
 11837     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11838        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11839        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11840
 11841**********   DMD CUSTOM CODE FOLLOWS  **********
 11842 3024-EDIT-DMD-FIELDS.
 11843     IF PB-COMPANY-ID NOT = 'DMD'
 11844        GO TO 3025-EDIT-REINSURANCE.
 11845
 11846*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11847*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11848*** ERROR IF THEY ARE NOT EQUAL.
 11849
 11850     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11851     SET BIN-TO-GREG               TO TRUE.
 11852     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11853     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11854**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11855
 11856     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 216
* EL050.cbl
 11857     SET BIN-TO-GREG               TO TRUE.
 11858     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11859     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11860**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11861
 11862     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11863        MOVE ER-8116               TO WS-ERROR
 11864        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11865
 11866     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11867
 11868     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11869                                      WK-FULL-CERT-NO.
 11870     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11871
 11872     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11873
 11874     IF PB-VALID-LIFE
 11875        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11876     ELSE
 11877        IF PB-VALID-AH
 11878          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11879
 11880
 11881     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11882     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11883     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11884                                      DCUA-UNDRWRTR-CODE
 11885                                      DCUA-UNDRWRTR-GROUP-CODE
 11886                                      DCUA-RETURN-CODE.
 11887
 11888****************************************************************
 11889*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11890***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11891***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11892***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11893***   TO THIS RECORD.                                        ***
 11894****************************************************************
 11895     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11896     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11897     IF DCUA-SUCCESSFUL-PROCESS
 11898        GO TO 3024-EDIT-DL7-CONT.
 11899
 11900     IF DCUA-RETURN-CODE EQUAL '01'
 11901        MOVE ER-8110               TO WS-ERROR
 11902        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11903        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11904        GO TO 3024-EDIT-DL7-CONT.
 11905
 11906     IF DCUA-RETURN-CODE EQUAL '02'
 11907        MOVE ER-8111               TO WS-ERROR
 11908        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11909        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11910        GO TO 3024-EDIT-DL7-CONT.
 11911
 11912     IF DCUA-RETURN-CODE EQUAL '03'
 11913        MOVE ER-8074               TO WS-ERROR
 11914        MOVE 'Y'                   TO WS-DLO-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 217
* EL050.cbl
 11915        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11916        GO TO 3024-EDIT-DL7-CONT.
 11917
 11918     IF DCUA-RETURN-CODE EQUAL '04'
 11919        MOVE ER-8075               TO WS-ERROR
 11920        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11921        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11922        GO TO 3024-EDIT-DL7-CONT.
 11923
 11924     IF DCUA-RETURN-CODE EQUAL '05'
 11925        MOVE ER-8076               TO WS-ERROR
 11926        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11927        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11928        GO TO 3024-EDIT-DL7-CONT.
 11929
 11930     IF DCUA-RETURN-CODE EQUAL '06'
 11931        MOVE ER-8077               TO WS-ERROR
 11932        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11933        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11934        GO TO 3024-EDIT-DL7-CONT.
 11935
 11936     IF DCUA-RETURN-CODE EQUAL '07'
 11937        MOVE ER-8078               TO WS-ERROR
 11938        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11939        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11940        GO TO 3024-EDIT-DL7-CONT.
 11941
 11942     IF DCUA-RETURN-CODE EQUAL 'E1'
 11943        MOVE ER-8079               TO WS-ERROR
 11944        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11945        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11946        GO TO 3024-EDIT-DL7-CONT.
 11947
 11948     IF DCUA-RETURN-CODE EQUAL 'E2'
 11949        MOVE ER-8080               TO WS-ERROR
 11950        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11951        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11952        GO TO 3024-EDIT-DL7-CONT.
 11953
 11954     IF DCUA-RETURN-CODE EQUAL 'E3'
 11955        MOVE ER-8098               TO WS-ERROR
 11956        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11957        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11958        GO TO 3024-EDIT-DL7-CONT.
 11959
 11960     IF DCUA-RETURN-CODE EQUAL 'C1'
 11961        MOVE ER-8099               TO WS-ERROR
 11962        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11963        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11964        GO TO 3024-EDIT-DL7-CONT.
 11965
 11966     IF DCUA-RETURN-CODE EQUAL 'U1'
 11967        MOVE ER-8109               TO WS-ERROR
 11968        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11969        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11970        GO TO 3024-EDIT-DL7-CONT.
 11971
 11972     IF DCUA-RETURN-CODE EQUAL 'N1'
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 218
* EL050.cbl
 11973        MOVE ER-8112               TO WS-ERROR
 11974        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11975        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11976        GO TO 3024-EDIT-DL7-CONT.
 11977
 11978     IF DCUA-RETURN-CODE EQUAL 'N2'
 11979        MOVE ER-8113               TO WS-ERROR
 11980        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11981        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11982        GO TO 3024-EDIT-DL7-CONT.
 11983
 11984     IF DCUA-RETURN-CODE EQUAL 'N3'
 11985        MOVE ER-8114               TO WS-ERROR
 11986        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11987        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11988        GO TO 3024-EDIT-DL7-CONT.
 11989
 11990     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11991     MOVE ER-8097                  TO WS-ERROR.
 11992     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11993     GO TO 3024-EDIT-DL7-CONT.
 11994
 11995 3024-EDIT-DL7-CONT.
 11996
 11997     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11998     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11999     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 12000        NEXT SENTENCE
 12001     ELSE
 12002        MOVE ER-9263               TO WS-ERROR
 12003        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12004
 12005******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 12006******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 12007     IF DCUA-CERT-NUMBER = PB-CERT-NO
 12008        NEXT SENTENCE
 12009     ELSE
 12010        MOVE ER-8039               TO WS-ERROR
 12011        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12012
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 219
* EL050.cbl
 12014****************************************************************
 12015*** VALIDATE STATE  : DLO022                                 ***
 12016****************************************************************
 12017     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 12018     MOVE SPACES                   TO DVSC-RETURN-CODE.
 12019
 12020     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 12021     IF DVSC-SUCCESSFUL-EDIT
 12022        GO TO 3024-EDIT-DL22-CONT.
 12023
 12024     IF DVSC-RETURN-CODE EQUAL '01'
 12025        MOVE ER-8300               TO WS-ERROR
 12026        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12027        GO TO 3024-EDIT-DL22-CONT.
 12028
 12029     IF DVSC-RETURN-CODE EQUAL '02'
 12030        MOVE ER-8301               TO WS-ERROR
 12031        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12032        GO TO 3024-EDIT-DL22-CONT.
 12033
 12034     IF DVSC-RETURN-CODE EQUAL '03'
 12035        MOVE ER-8302               TO WS-ERROR
 12036        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12037        GO TO 3024-EDIT-DL22-CONT.
 12038
 12039     IF DVSC-RETURN-CODE EQUAL 'N1'
 12040        MOVE ER-8304               TO WS-ERROR
 12041        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12042        GO TO 3024-EDIT-DL22-CONT.
 12043
 12044     MOVE ER-8303                  TO WS-ERROR
 12045     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12046
 12047 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 220
* EL050.cbl
 12049****************************************************************
 12050*** VALIDATE LOAN OFFICER : DLO021                           ***
 12051****************************************************************
 12052
 12053     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 12054     MOVE SPACES                    TO DVLO-RETURN-CODE.
 12055     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 12056     IF DVLO-SUCCESSFUL-EDIT
 12057        GO TO 3024-EDIT-DL21-CONT.
 12058
 12059     IF DVLO-RETURN-CODE EQUAL '01'
 12060        MOVE ER-8081               TO WS-ERROR
 12061        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12062        GO TO 3024-EDIT-DL21-CONT.
 12063
 12064     IF DVLO-RETURN-CODE EQUAL '02'
 12065        MOVE ER-8082               TO WS-ERROR
 12066        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12067        GO TO 3024-EDIT-DL21-CONT.
 12068
 12069     IF DVLO-RETURN-CODE EQUAL '03'
 12070        MOVE ER-8083               TO WS-ERROR
 12071        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12072        GO TO 3024-EDIT-DL21-CONT.
 12073
 12074     IF DVLO-RETURN-CODE EQUAL '04'
 12075        MOVE ER-8084               TO WS-ERROR
 12076        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12077        GO TO 3024-EDIT-DL21-CONT.
 12078
 12079     IF DVLO-RETURN-CODE EQUAL '05'
 12080        MOVE ER-8085               TO WS-ERROR
 12081        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12082        GO TO 3024-EDIT-DL21-CONT.
 12083
 12084     MOVE ER-7825                  TO WS-ERROR
 12085     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12086     GO TO 3024-EDIT-DL21-CONT.
 12087
 12088 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 221
* EL050.cbl
 12090
 12091****************************************************************
 12092*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 12093****************************************************************
 12094
 12095     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 12096     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 12097     MOVE SPACES                 TO DIPF-RETURN-CODE.
 12098     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 12099     IF DIPF-SUCCESSFUL-EDIT
 12100        GO TO 3024-EDIT-DL02-CONT.
 12101
 12102     IF DIPF-RETURN-CODE EQUAL '01'
 12103        MOVE ER-8086               TO WS-ERROR
 12104        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12105        GO TO 3024-EDIT-DL02-CONT.
 12106
 12107     IF DIPF-RETURN-CODE EQUAL '02'
 12108        MOVE ER-8087               TO WS-ERROR
 12109        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12110        GO TO 3024-EDIT-DL02-CONT.
 12111
 12112     IF DIPF-RETURN-CODE EQUAL '03'
 12113        MOVE ER-8088               TO WS-ERROR
 12114        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12115        GO TO 3024-EDIT-DL02-CONT.
 12116
 12117     MOVE ER-8095                  TO WS-ERROR
 12118     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12119     GO TO 3024-EDIT-DL02-CONT.
 12120
 12121 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 222
* EL050.cbl
 12123
 12124****************************************************************
 12125*** VALIDATE BANK ID : DLO003                                ***
 12126****************************************************************
 12127
 12128     MOVE WK-GREG-CENT           TO WCG-CENT.
 12129     MOVE WK-GREG-YYMM           TO WCG-REST.
 12130     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 12131        MOVE ER-8040               TO WS-ERROR
 12132        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12133
 12134     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 12135     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 12136     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 12137     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 12138     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 12139     IF DVBI-SUCCESSFUL-EDIT
 12140        GO TO 3024-EDIT-DL03-CONT.
 12141
 12142     IF DVBI-RETURN-CODE EQUAL '01'
 12143        MOVE ER-8089               TO WS-ERROR
 12144        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12145        GO TO 3024-EDIT-DL03-CONT.
 12146
 12147     IF DVBI-RETURN-CODE EQUAL '02'
 12148        MOVE ER-8090               TO WS-ERROR
 12149        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12150        GO TO 3024-EDIT-DL03-CONT.
 12151
 12152     IF DVBI-RETURN-CODE EQUAL '03'
 12153        MOVE ER-8091               TO WS-ERROR
 12154        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12155        GO TO 3024-EDIT-DL03-CONT.
 12156
 12157     IF DVBI-RETURN-CODE EQUAL '04'
 12158        MOVE ER-8092               TO WS-ERROR
 12159        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12160        GO TO 3024-EDIT-DL03-CONT.
 12161
 12162     IF DVBI-RETURN-CODE EQUAL '05'
 12163        MOVE ER-8093               TO WS-ERROR
 12164        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12165        GO TO 3024-EDIT-DL03-CONT.
 12166
 12167     IF DVBI-RETURN-CODE EQUAL '06'
 12168        MOVE ER-8094               TO WS-ERROR
 12169        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12170        GO TO 3024-EDIT-DL03-CONT.
 12171
 12172     MOVE ER-8096                  TO WS-ERROR
 12173     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12174     GO TO 3024-EDIT-DL03-CONT.
 12175
 12176 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 223
* EL050.cbl
 12178
 12179     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 12180        NEXT SENTENCE
 12181     ELSE
 12182        MOVE ER-8042               TO WS-ERROR
 12183        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12184
 12185     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 12186     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 12187     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 12188
 12189     IF DMPF-RETURN-CODE = '01'
 12190        MOVE ER-8067               TO WS-ERROR
 12191        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12192        GO TO 3024-EDIT-DL01-CONT.
 12193
 12194     IF DMPF-RETURN-CODE = '02'
 12195        MOVE ER-8068               TO WS-ERROR
 12196        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12197        GO TO 3024-EDIT-DL01-CONT.
 12198
 12199     IF DMPF-RETURN-CODE = '03'
 12200        MOVE ER-8069               TO WS-ERROR
 12201        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12202        GO TO 3024-EDIT-DL01-CONT.
 12203
 12204     IF DMPF-RETURN-CODE = 'E1'
 12205        MOVE ER-8070               TO WS-ERROR
 12206        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12207        GO TO 3024-EDIT-DL01-CONT.
 12208
 12209     IF DMPF-RETURN-CODE = 'N1'
 12210        MOVE ER-8071               TO WS-ERROR
 12211        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12212        GO TO 3024-EDIT-DL01-CONT.
 12213
 12214     IF DMPF-RETURN-CODE NOT = 'OK'
 12215        MOVE ER-8072               TO WS-ERROR
 12216        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12217
 12218 3024-EDIT-DL01-CONT.
 12219******************************************************************
 12220***  VALIDATES RATE CODES : DLO017                             ***
 12221******************************************************************
 12222
 12223      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 12224      MOVE SPACES                   TO DVRC-RETURN-CODE.
 12225      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 12226      IF DVRC-SUCCESSFUL-EDIT
 12227        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 12228        GO TO 3024-CHECK-VALID-RATE.
 12229
 12230      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 12231
 12232      IF DVRC-RETURN-CODE EQUAL '01'
 12233         MOVE ER-7817                   TO WS-ERROR
 12234         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12235         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 224
* EL050.cbl
 12236
 12237      IF DVRC-RETURN-CODE EQUAL '02'
 12238         MOVE ER-7818                   TO WS-ERROR
 12239         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12240         GO TO 3025-EDIT-REINSURANCE.
 12241
 12242      IF DVRC-RETURN-CODE EQUAL '03'
 12243         MOVE ER-7819                   TO WS-ERROR
 12244         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12245         GO TO 3025-EDIT-REINSURANCE.
 12246
 12247       MOVE ER-7820                     TO WS-ERROR.
 12248       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 12249       GO TO 3025-EDIT-REINSURANCE.
 12250
 12251******************************************************************
 12252***  GET PREMIUM RATES : DLO011                                ***
 12253******************************************************************
 12254
 12255 3024-CHECK-VALID-RATE.
 12256
 12257     IF VALID-RATE-CODE
 12258        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 12259        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 12260        MOVE SPACES                TO DPRB-RETURN-CODE
 12261        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 12262     ELSE
 12263         GO TO 3025-EDIT-REINSURANCE.
 12264
 12265      IF DPRB-SUCCESSFUL-PROCESS
 12266         IF PB-VALID-LIFE
 12267             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 12268             GO TO 3025-EDIT-REINSURANCE
 12269         ELSE
 12270             IF PB-VALID-AH
 12271                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 12272                 GO TO 3025-EDIT-REINSURANCE.
 12273
 12274      IF DPRB-RETURN-CODE EQUAL '01'
 12275         MOVE ER-7812                   TO WS-ERROR
 12276         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12277         GO TO 3025-EDIT-REINSURANCE.
 12278
 12279      IF DPRB-RETURN-CODE EQUAL '02'
 12280         MOVE ER-7813                   TO WS-ERROR
 12281         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12282         GO TO 3025-EDIT-REINSURANCE.
 12283
 12284      IF DPRB-RETURN-CODE EQUAL '03'
 12285         MOVE ER-7814                   TO WS-ERROR
 12286         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12287         GO TO 3025-EDIT-REINSURANCE.
 12288
 12289      IF DPRB-RETURN-CODE EQUAL '04'
 12290         IF NOT DPRB-1ST-TIME
 12291            MOVE ER-7815                   TO WS-ERROR
 12292            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12293            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 225
* EL050.cbl
 12294          ELSE
 12295         IF PB-VALID-LIFE
 12296            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 12297          ELSE
 12298            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 12299         END-IF
 12300         MOVE SPACES                TO DOCC-RETURN-CODE
 12301         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 12302         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 12303         IF DOCC-RETURN-CODE = 'OK'
 12304             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 12305             GO TO 3024-CHECK-VALID-RATE
 12306           ELSE
 12307             MOVE ER-7823               TO WS-ERROR
 12308             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 12309             GO TO 3025-EDIT-REINSURANCE.
 12310
 12311       MOVE ER-7816                     TO WS-ERROR.
 12312       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 12313       GO TO 3025-EDIT-REINSURANCE.
 12314
 12315**********   DMD CUSTOM CODE ABOVE    **********
 12316
 12317 3025-EDIT-REINSURANCE.
 12318     IF PB-I-SPECIAL-REIN-CODE = SPACE
 12319         GO TO 3027-EDIT-CONTINUE.
 12320
 12321     MOVE LOW-VALUES               TO ERREIN-KEY.
 12322     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 12323     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 12324                                      REIN-CODE-2
 12325                                      REIN-CODE-3.
 12326     MOVE 'A'                      TO REIN-TYPE.
 12327
 12328     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 12329
 12330     MOVE '3026' TO REIN-SW.
 12331     MOVE ' '                   TO WS-REIN-READ-SW.
 12332
 12333     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 12334     IF REIN-TABLE-NOT-FOUND
 12335         GO TO 3026-NO-SPEC-TABLE.
 12336
 12337     MOVE RE-TABLE              TO WK-REIN-TABLE.
 12338     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12339                                   WS-NSP-ST-CD-LF.
 12340     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12341                                   WS-NSP-ST-CD-AH.
 12342
 12343     GO TO 3040-EDIT-CONTINUE.
 12344
 12345 3026-NO-SPEC-TABLE.
 12346
 12347     MOVE ER-2664                TO WS-ERROR.
 12348     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12349     GO TO 3040-EDIT-CONTINUE.
 12350
 12351 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 226
* EL050.cbl
 12352
 12353     IF PB-I-REIN-TABLE = SPACES
 12354       GO TO 3040-EDIT-CONTINUE.
 12355
 12356     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 12357          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 12358          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 12359           GO TO 3040-EDIT-CONTINUE.
 12360
 12361     MOVE LOW-VALUES            TO ERREIN-KEY.
 12362     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 12363     MOVE 'A'                   TO REIN-TYPE.
 12364     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 12365
 12366     MOVE '3028'                TO REIN-SW.
 12367     MOVE ' '                   TO WS-REIN-READ-SW.
 12368
 12369     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 12370     IF REIN-TABLE-NOT-FOUND
 12371         GO TO 3028-NO-REIN-TABLE.
 12372
 12373     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 12374     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12375                                   WS-NSP-ST-CD-LF.
 12376     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12377                                   WS-NSP-ST-CD-AH.
 12378
 12379     GO TO 3040-EDIT-CONTINUE.
 12380
 12381 3028-NO-REIN-TABLE.
 12382
 12383     MOVE ER-2615                TO WS-ERROR.
 12384     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12385     GO TO 3040-EDIT-CONTINUE.
 12386
 12387 3040-EDIT-CONTINUE.
 12388
 12389     IF PB-I-LF-PREM-CALC NOT NUMERIC
 12390         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 12391
 12392     IF PB-I-AH-PREM-CALC NOT NUMERIC
 12393         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 12394
 12395     IF (NOT PB-REISSUED-CERT)
 12396        AND (NOT PB-MONTHLY-CERT)
 12397        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 12398            MOVE '001'           TO PB-I-LF-TERM
 12399            MOVE 'M'             TO PB-I-INSURED-SEX.
 12400
 12401     IF (NOT PB-REISSUED-CERT)
 12402        AND (NOT PB-MONTHLY-CERT)
 12403        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 12404            MOVE '001'           TO PB-I-AH-TERM
 12405            MOVE 'M'             TO PB-I-INSURED-SEX.
 12406
 12407 3040-EDIT-1ST-PMT-DT.
 12408     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 12409     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 227
* EL050.cbl
 12410         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 12411
 12412******************************************************************
 12413*                                                                *
 12414*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 12415*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 12416*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 12417*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 12418*                                                                *
 12419******************************************************************
 12420
 12421     IF PB-EFF-DT-PROCESSING
 12422        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12423                                    PB-I-LF-EXPIRE-DT
 12424                                    PB-I-AH-EXPIRE-DT
 12425        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12426        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12427        MOVE ZERO                TO DC-ELAPSED-DAYS
 12428        MOVE +1                  TO DC-ELAPSED-MONTHS
 12429        SET BIN-PLUS-ELAPSED     TO TRUE
 12430*       MOVE 6                   TO DC-OPTION-CODE
 12431        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12432        IF NO-CONVERSION-ERROR
 12433           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12434
 12435******************************************************************
 12436*                                                                *
 12437*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 12438*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 12439*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12440*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 12441*                                                                *
 12442******************************************************************
 12443
 12444     IF PB-EXT-DAYS-PROCESSING
 12445          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 12446                                         PB-I-LF-EXPIRE-DT
 12447                                         PB-I-AH-EXPIRE-DT
 12448          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 12449          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12450          MOVE +1                     TO DC-ELAPSED-MONTHS
 12451          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 12452          SET BIN-PLUS-ELAPSED        TO TRUE
 12453*         MOVE 6                      TO DC-OPTION-CODE
 12454          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12455          IF NO-CONVERSION-ERROR
 12456             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 12457
 12458******************************************************************
 12459*                                                                *
 12460*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 12461*        BASED ON THE OLDEST EXPIRE DATE.                        *
 12462*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12463*        (EXPIRE DATE - (TERM -1))  *  -1.
 12464*                                                                *
 12465******************************************************************
 12466
 12467     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 228
* EL050.cbl
 12468        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 12469           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 12470              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12471              MOVE PB-I-AH-TERM      TO WS-TERM
 12472           ELSE
 12473              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12474              MOVE PB-I-LF-TERM      TO WS-TERM
 12475        ELSE
 12476           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 12477              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12478              MOVE PB-I-LF-TERM      TO WS-TERM
 12479           ELSE
 12480              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12481              MOVE PB-I-AH-TERM      TO WS-TERM.
 12482
 12483     IF PB-EXPIRE-DT-PROCESSING
 12484        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12485        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12486        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 12487        MOVE ZERO                TO DC-ELAPSED-DAYS
 12488                                    DC-ODD-DAYS-OVER
 12489          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 12490          SET BIN-PLUS-ELAPSED    TO TRUE
 12491*         MOVE 6                  TO DC-OPTION-CODE
 12492          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12493          IF NO-CONVERSION-ERROR
 12494             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12495
 12496******************************************************************
 12497*                                                                *
 12498*            1ST PAYMENT DATE PROCESSING                         *
 12499*                                                                *
 12500******************************************************************
 12501
 12502     IF PB-1ST-PMT-DT-PROCESSING
 12503        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 12504                                    PB-I-AH-EXPIRE-DT
 12505        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 12506
 12507     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 12508         NEXT SENTENCE
 12509     ELSE
 12510         MOVE ER-2680                 TO WS-ERROR
 12511         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12512         GO TO 3060-ORIG-TERM-CHECK.
 12513
 12514     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12515     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 12516     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12517*    MOVE 1                      TO DC-OPTION-CODE.
 12518     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 12519                                    DC-ELAPSED-DAYS
 12520                                    DC-ODD-DAYS-OVER.
 12521
 12522     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12523
 12524     IF DATE-CONVERSION-ERROR
 12525        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 229
* EL050.cbl
 12526
 12527     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 12528     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 12529        AND (WS-LF-COVERAGE-TYPE = 'L')
 12530        IF (DC-ELAPSED-MONTHS > 1)
 12531                      OR
 12532           ((DC-ELAPSED-MONTHS = 1)
 12533           AND (DC-ODD-DAYS-OVER > 0))
 12534           MOVE ER-2882          TO WS-ERROR
 12535           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12536        END-IF
 12537     END-IF
 12538     if dc-elapsed-months > 0
 12539        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12540        + dc-odd-days-over
 12541     end-if
 12542     IF PB-EXT-DAYS-PROCESSING
 12543        CONTINUE
 12544     ELSE
 12545        IF DC-ELAPSED-MONTHS = +0
 12546           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12547        ELSE
 12548           IF (WS-LF-EARNINGS-CALC = '4')
 12549              AND (DC-ELAPSED-MONTHS > ZERO)
 12550              AND (DC-ELAPSED-DAYS > ZERO)
 12551              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12552           ELSE
 12553              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12554                                 THRU 6499-EXIT
 12555              MOVE WS-ODD-DAYS-OVER
 12556                                 TO PB-I-EXTENTION-DAYS
 12557           END-IF
 12558        END-IF
 12559     END-IF
 12560******************************************************************
 12561*                                                                *
 12562*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12563*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12564*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12565*            AND ANY ODD DAYS.                                   *
 12566*                                                                *
 12567******************************************************************
 12568
 12569     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12570                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12571     IF WS-LF-EARNINGS-CALC NOT = '4'
 12572        IF DC-ELAPSED-DAYS > ZEROS
 12573           MOVE ER-2681          TO WS-ERROR
 12574           PERFORM 9900-ERROR-FORMAT
 12575                                 THRU 9900-EXIT
 12576        END-IF
 12577     END-IF
 12578
 12579     IF WS-LF-EARNINGS-CALC NOT = '4'
 12580        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12581           MOVE ER-2681          TO WS-ERROR
 12582           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12583
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 230
* EL050.cbl
 12584     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12585        (PB-I-LF-TERM NOT = ZERO) AND
 12586         NOT NO-LIFE-COVERAGE
 12587          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12588          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12589          IF WS-LF-EARNINGS-CALC = '4'
 12590             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12591             PB-I-PAY-FREQUENCY
 12592          END-IF
 12593          MOVE ZERO              TO DC-ELAPSED-DAYS
 12594                                    DC-ODD-DAYS-OVER
 12595          MOVE 1                 TO DC-END-OF-MONTH
 12596          SET BIN-PLUS-ELAPSED        TO TRUE
 12597*         MOVE 6                 TO DC-OPTION-CODE
 12598          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12599          IF NO-CONVERSION-ERROR
 12600             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12601             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12602                (WS-LF-SPECIAL-CALC-CD = 'L')
 12603                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12604                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12605                  MOVE +1             TO DC-ELAPSED-MONTHS
 12606                  SET BIN-PLUS-ELAPSED  TO TRUE
 12607*                 MOVE 6              TO DC-OPTION-CODE
 12608                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12609                  IF NO-CONVERSION-ERROR
 12610                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12611
 12612* okay, i had to move the new att age edit down here because the
 12613* expiration date could get recalculated and i need the exp date
 12614     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12615        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12616        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12617        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12618           AND ZEROS
 12619           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12620           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12621           SET ELAPSED-BETWEEN-BIN TO TRUE
 12622           PERFORM 8500-DATE-CONVERT
 12623                                 THRU 8500-EXIT
 12624           IF NO-CONVERSION-ERROR
 12625              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12626                 MOVE ER-2669       TO WS-ERROR
 12627*                PERFORM 9900-ERROR-FORMAT
 12628*                                THRU 9900-EXIT
 12629              END-IF
 12630           END-IF
 12631        ELSE
 12632           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12633           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12634              MOVE ER-2669       TO WS-ERROR
 12635*             PERFORM 9900-ERROR-FORMAT
 12636*                                THRU 9900-EXIT
 12637           ELSE
 12638              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12639                 MOVE ER-1570    TO WS-ERROR
 12640                 PERFORM 9900-ERROR-FORMAT
 12641                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 231
* EL050.cbl
 12642              END-IF
 12643           END-IF
 12644        END-IF
 12645        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12646           AND ZEROS
 12647           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12648           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12649           SET ELAPSED-BETWEEN-BIN TO TRUE
 12650           PERFORM 8500-DATE-CONVERT
 12651                                 THRU 8500-EXIT
 12652           IF NO-CONVERSION-ERROR
 12653              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12654                 MOVE ER-2669       TO WS-ERROR
 12655*                PERFORM 9900-ERROR-FORMAT
 12656*                                THRU 9900-EXIT
 12657              END-IF
 12658           END-IF
 12659        ELSE
 12660           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12661             (PB-I-LF-TERM / 12)
 12662           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12663              MOVE ER-2669       TO WS-ERROR
 12664*             PERFORM 9900-ERROR-FORMAT
 12665*                                THRU 9900-EXIT
 12666           ELSE
 12667              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12668                 MOVE ER-1571    TO WS-ERROR
 12669                 PERFORM 9900-ERROR-FORMAT
 12670                                 THRU 9900-EXIT
 12671              END-IF
 12672           END-IF
 12673        END-IF
 12674        IF WS-ERROR = ER-2669
 12675           PERFORM 9900-ERROR-FORMAT
 12676                                 THRU 9900-EXIT
 12677        END-IF
 12678     END-IF
 12679     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12680        (PB-I-AH-TERM NOT = ZERO) AND
 12681         NOT NO-AH-COVERAGE
 12682          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12683             AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 12684             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12685             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12686          ELSE
 12687             IF WS-LF-EARNINGS-CALC = '4'
 12688                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12689                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12690                PB-I-PAY-FREQUENCY
 12691             ELSE
 12692                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12693                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12694             END-IF
 12695          END-IF
 12696          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12697                                         DC-ODD-DAYS-OVER
 12698          MOVE 1                      TO DC-END-OF-MONTH
 12699          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 232
* EL050.cbl
 12700*         MOVE 6                      TO DC-OPTION-CODE
 12701          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12702          IF NO-CONVERSION-ERROR
 12703             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12704     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12705        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12706        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12707        IF PB-I-BIRTHDAY > LOW-VALUES
 12708           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12709           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12710           SET ELAPSED-BETWEEN-BIN TO TRUE
 12711           PERFORM 8500-DATE-CONVERT
 12712                                 THRU 8500-EXIT
 12713           IF NO-CONVERSION-ERROR
 12714              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12715                 MOVE ER-3054       TO WS-ERROR
 12716*                PERFORM 9900-ERROR-FORMAT
 12717*                                THRU 9900-EXIT
 12718              END-IF
 12719           END-IF
 12720        ELSE
 12721           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12722           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12723              MOVE ER-3054       TO WS-ERROR
 12724*             PERFORM 9900-ERROR-FORMAT
 12725*                                THRU 9900-EXIT
 12726           END-IF
 12727        END-IF
 12728        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12729           AND ZEROS
 12730           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12731           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12732           SET ELAPSED-BETWEEN-BIN TO TRUE
 12733           PERFORM 8500-DATE-CONVERT
 12734                                 THRU 8500-EXIT
 12735           IF NO-CONVERSION-ERROR
 12736              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12737                 MOVE ER-3054       TO WS-ERROR
 12738*                PERFORM 9900-ERROR-FORMAT
 12739*                                THRU 9900-EXIT
 12740              END-IF
 12741           END-IF
 12742        ELSE
 12743           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12744             (PB-I-AH-TERM / 12)
 12745           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12746              MOVE ER-3054       TO WS-ERROR
 12747*             PERFORM 9900-ERROR-FORMAT
 12748*                                THRU 9900-EXIT
 12749           END-IF
 12750        END-IF
 12751        IF WS-ERROR = ER-3054
 12752           PERFORM 9900-ERROR-FORMAT
 12753                                 THRU 9900-EXIT
 12754        END-IF
 12755     END-IF
 12756     MOVE SPACE                       TO DC-END-OF-MONTH.
 12757
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 233
* EL050.cbl
 12758     IF PB-COMPANY-ID = 'NCB'
 12759        GO TO 3040-EDIT-EXTENSION-DAYS.
 12760
 12761     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12762       AND
 12763        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12764        NEXT SENTENCE
 12765     ELSE
 12766        GO TO 3040-EDIT-EXTENSION-DAYS.
 12767
 12768     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12769        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12770        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12771     ELSE
 12772        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12773        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12774
 12775     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12776*    MOVE '1'      TO DC-OPTION-CODE
 12777     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12778     IF (NO-CONVERSION-ERROR)
 12779        AND (DC-ELAPSED-MONTHS > +1)
 12780        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12781        MOVE ER-2668   TO WS-ERROR
 12782        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12783
 12784 3040-EDIT-EXTENSION-DAYS.
 12785
 12786     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12787        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12788         GO TO 3050-EDIT-TERM-IN-DAYS
 12789     ELSE
 12790         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12791
 12792     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12793         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12794     ELSE
 12795        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12796           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12797           MOVE ER-2681         TO WS-ERROR
 12798           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12799
 12800     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12801        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12802        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12803         GO TO 3060-ORIG-TERM-CHECK.
 12804
 12805     GO TO 3060-ORIG-TERM-CHECK.
 12806
 12807 3050-EDIT-TERM-IN-DAYS.
 12808
 12809     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12810
 12811     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12812         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12813     ELSE
 12814         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12815            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 234
* EL050.cbl
 12816            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12817
 12818     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12819                                       REMAINDER WS-WORK-TERM.
 12820     IF WS-WORK-TERM GREATER THAN ZERO
 12821         ADD +1 TO PB-I-LF-TERM.
 12822
 12823     IF NOT NO-AH-COVERAGE
 12824         MOVE ER-2684            TO WS-ERROR
 12825         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12826
 12827
 12828 3060-ORIG-TERM-CHECK.
 12829
 12830******************************************************************
 12831*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12832******************************************************************
 12833
 12834     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12835        NEXT SENTENCE
 12836     ELSE
 12837        IF NOT NO-LIFE-COVERAGE
 12838           IF PB-I-LF-TERM NUMERIC
 12839              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12840              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12841              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12842                  NEXT SENTENCE
 12843           ELSE
 12844              MOVE ER-2647       TO WS-ERROR
 12845              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12846
 12847     IF NOT NO-AH-COVERAGE
 12848         IF PB-I-AH-TERM NUMERIC
 12849            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12850            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12851            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12852             NEXT SENTENCE
 12853          ELSE
 12854              MOVE ER-2658       TO WS-ERROR
 12855              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12856
 12857     IF PB-COMPANY-ID = 'NCB'
 12858        GO TO 3070-LOAN-TERM-CHECK.
 12859
 12860     IF POLICY-HAS-AH
 12861       AND
 12862        POLICY-HAS-LIFE
 12863       AND
 12864        PB-I-LF-TERM NUMERIC
 12865       AND
 12866        PB-I-AH-TERM NUMERIC
 12867        NEXT SENTENCE
 12868     ELSE
 12869        GO TO 3070-LOAN-TERM-CHECK.
 12870
 12871     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12872     IF WS-TEX-FACT-2 LESS THAN +0
 12873        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 235
* EL050.cbl
 12874
 12875     IF WS-TEX-FACT-2 GREATER THAN +1
 12876        MOVE ER-2668             TO WS-ERROR
 12877        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12878
 12879 3070-LOAN-TERM-CHECK.
 12880
 12881     IF (WS-LF-BENEFIT-CD = ZERO)
 12882         OR (NO-LF-BENEFIT-MATCH)
 12883            GO TO 3125-EDIT-PMT-FREQ.
 12884*    IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 12885*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12886*          AND 'V' AND 'W' AND 'X'
 12887*          GO TO 3125-EDIT-PMT-FREQ
 12888*       END-IF
 12889*    ELSE
 12890*       IF WS-AH-DCC-TRUNC = 'T'
 12891*          CONTINUE
 12892*       ELSE
 12893*          GO TO 3125-EDIT-PMT-FREQ
 12894*       END-IF
 12895*    END-IF
 12896     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12897                    OR
 12898        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 12899        AND (WS-AH-DCC-TRUNC = 'T'))
 12900        CONTINUE
 12901     ELSE
 12902        GO TO 3125-EDIT-PMT-FREQ
 12903     END-IF
 12904     IF PB-I-LOAN-TERM NOT NUMERIC
 12905         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12906
 12907     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12908        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12909*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12910        PB-I-LOAN-TERM NOT GREATER THAN +360
 12911         NEXT SENTENCE
 12912     ELSE
 12913         MOVE ER-2648            TO WS-ERROR
 12914         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12915
 12916     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12917        MOVE ER-3058             TO WS-ERROR
 12918        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12919     end-if
 12920
 12921     IF WS-STATE-ABBREVIATION = 'NC'
 12922        IF PB-I-LOAN-TERM > +59
 12923           CONTINUE
 12924        ELSE
 12925           MOVE ER-2792          TO WS-ERROR
 12926           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12927        END-IF
 12928     END-IF
 12929
 12930     .
 12931 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 236
* EL050.cbl
 12932     IF (WS-LF-BENEFIT-CD = ZERO)
 12933         OR (NO-LF-BENEFIT-MATCH)
 12934            GO TO 3127-EDIT-LOAN-OFFICER.
 12935     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12936                    OR
 12937        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 12938        AND (WS-AH-DCC-TRUNC = 'T'))
 12939                    OR
 12940         (PB-COMPANY-ID = 'AHL')
 12941        CONTINUE
 12942     ELSE
 12943        IF (PB-I-LOAN-TERM > ZEROS)
 12944           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12945           MOVE ER-1575          TO WS-ERROR
 12946           PERFORM 9900-ERROR-FORMAT
 12947                                 THRU 9900-EXIT
 12948        END-IF
 12949     END-IF
 12950     IF WS-LF-EARNINGS-CALC NOT = '4'
 12951         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12952            MOVE ER-2653         TO WS-ERROR
 12953            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12954            GO TO 3127-EDIT-LOAN-OFFICER
 12955         ELSE
 12956            GO TO 3127-EDIT-LOAN-OFFICER.
 12957
 12958     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12959         MOVE ER-2655            TO WS-ERROR
 12960         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12961         GO TO 3127-EDIT-LOAN-OFFICER.
 12962
 12963     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12964         MOVE ER-2654            TO WS-ERROR
 12965         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12966         GO TO 3127-EDIT-LOAN-OFFICER.
 12967
 12968     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12969         GIVING WS-TEX-FACT-2
 12970             REMAINDER WS-TEX-FACT-3.
 12971
 12972*    IF WS-TEX-FACT-3 NOT = ZERO
 12973*       MOVE ER-2654             TO WS-ERROR
 12974*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12975
 12976
 12977 3127-EDIT-LOAN-OFFICER.
 12978
 12979     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12980        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12981           MOVE ER-2690          TO WS-ERROR
 12982           PERFORM 9900-ERROR-FORMAT
 12983                                 THRU 9900-EXIT
 12984        ELSE
 12985           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12986           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12987           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12988           MOVE PB-SV-STATE      TO LOFC-STATE
 12989           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 237
* EL050.cbl
 12990           MOVE PB-I-LOAN-OFFICER
 12991                                 TO LOFC-CODE
 12992           PERFORM 8586-READ-LOAN-OFFICER
 12993                                 THRU 8586-EXIT
 12994           IF (NOT LOFC-MASTER-FOUND)
 12995              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12996              MOVE ER-3006       TO WS-ERROR
 12997              PERFORM 9900-ERROR-FORMAT
 12998                                 THRU 9900-EXIT
 12999           END-IF
 13000        END-IF
 13001     END-IF
 13002     .
 13003 3129-EDIT-APR.
 13004
 13005     IF (WS-LF-BENEFIT-CD = ZERO)
 13006        OR (NO-LF-BENEFIT-MATCH)
 13007        IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 13008           GO TO 3130-EDIT-AGE
 13009*       ELSE
 13010*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 13011*             GO TO 3130-EDIT-AGE
 13012*          END-IF
 13013        END-IF
 13014     END-IF
 13015
 13016     IF (WS-STATE-ABBREVIATION = 'OH')
 13017         AND (PB-I-RATE-CLASS NOT = 'L ')
 13018         AND (PB-I-LF-TERM GREATER THAN 60)
 13019         AND (PB-CERT-EFF-DT GREATER WS-831031)
 13020         GO TO 3129-APR-CONT.
 13021
 13022     IF (WS-STATE-ABBREVIATION = 'RI')
 13023         AND (PB-I-LF-TERM GREATER THAN 60)
 13024         AND (PB-CERT-EFF-DT GREATER WS-831231)
 13025         GO TO 3129-APR-CONT.
 13026
 13027     IF (WS-STATE-ABBREVIATION = 'UT')
 13028         AND (PB-I-LF-TERM GREATER THAN 62)
 13029         AND (PB-CERT-EFF-DT GREATER WS-810831)
 13030         AND (PB-CERT-EFF-DT LESS WS-830901)
 13031         GO TO 3129-APR-CONT.
 13032
 13033     IF PB-COMPANY-ID = 'LAP'
 13034        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 13035           IF PB-I-LOAN-APR GREATER THAN ZEROS
 13036              MOVE ER-2656         TO WS-ERROR
 13037              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13038              GO TO 3130-EDIT-AGE.
 13039
 13040     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 13041        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 13042        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 13043        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13044        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 13045        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 13046         GO TO 3130-EDIT-AGE.
 13047
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 238
* EL050.cbl
 13048 3129-APR-CONT.
 13049     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 13050         (WS-LF-SPECIAL-CALC-CD = 'M'))
 13051         GO TO 3130-EDIT-AGE.
 13052
 13053     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 13054         WS-AH-BENEFIT-CD (1:1) = 'S')
 13055        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 13056        AND (PB-I-LOAN-APR = ZERO)
 13057        MOVE ER-2657             TO WS-ERROR
 13058        PERFORM 9900-ERROR-FORMAT
 13059                                 THRU 9900-EXIT
 13060        GO TO 3130-EDIT-AGE
 13061     END-IF
 13062*    IF PB-I-LOAN-APR = ZERO
 13063*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 13064*    END-IF
 13065
 13066     if pb-i-loan-apr = +99.9999
 13067        move er-2656             to ws-error
 13068        PERFORM 9900-ERROR-FORMAT
 13069                                 THRU 9900-EXIT
 13070        GO TO 3130-EDIT-AGE
 13071     end-if
 13072*    IF PB-I-LOAN-APR = ZERO
 13073*       MOVE ER-2656             TO WS-ERROR
 13074*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13075*       GO TO 3130-EDIT-AGE.
 13076
 13077*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 13078     if pb-i-loan-apr not = +99.9999
 13079        IF PB-I-LOAN-APR > +30.000
 13080           MOVE ER-2657          TO WS-ERROR
 13081           PERFORM 9900-ERROR-FORMAT
 13082                                 THRU 9900-EXIT
 13083        end-if
 13084     end-if
 13085     .
 13086 3130-EDIT-AGE.
 13087
 13088******************************************************************
 13089*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 13090******************************************************************
 13091
 13092     IF NOT NO-LIFE-COVERAGE
 13093        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13094           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 13095               MOVE ER-2628             TO WS-ERROR
 13096               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13097
 13098     IF NOT NO-AH-COVERAGE
 13099        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13100           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 13101               MOVE ER-2628         TO WS-ERROR
 13102               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13103
 13104 3133-SEX-CODE.
 13105     IF PB-I-INSURED-SEX = SPACE OR ZERO
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 239
* EL050.cbl
 13106         IF WS-DEFAULT-SEX = 'M'
 13107             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 13108          ELSE
 13109             IF WS-DEFAULT-SEX = 'F'
 13110             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 13111
 13112     IF PB-I-INSURED-SEX = '1'
 13113         MOVE 'M' TO PB-I-INSURED-SEX.
 13114
 13115     IF PB-I-INSURED-SEX = '2'
 13116         MOVE 'F' TO PB-I-INSURED-SEX.
 13117
 13118 3134-SIG-SW-EDIT.
 13119     IF PB-I-SIG-SW = SPACE
 13120         MOVE 'N'                TO  PB-I-SIG-SW.
 13121
 13122     IF PB-COMPANY-ID = 'NCL'
 13123         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 13124             NEXT SENTENCE
 13125         ELSE
 13126             MOVE ER-1923        TO  WS-ERROR
 13127             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13128     ELSE
 13129     IF PB-COMPANY-ID = 'CRI'
 13130         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 13131             NEXT SENTENCE
 13132         ELSE
 13133             MOVE ER-2606        TO  WS-ERROR
 13134             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13135     ELSE
 13136     IF PB-COMPANY-ID = 'TMS'
 13137         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 13138             NEXT SENTENCE
 13139         ELSE
 13140             MOVE ER-2689        TO  WS-ERROR
 13141             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13142     ELSE
 13143         IF PB-I-SIG-SW = 'Y' OR 'N'
 13144             NEXT SENTENCE
 13145         ELSE
 13146             MOVE ER-2651        TO  WS-ERROR
 13147             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13148
 13149     IF PB-COMPANY-ID = 'FLA'
 13150         IF (WS-EDIT-AGE GREATER 54  OR
 13151             WS-AH-EDIT-AGE GREATER 54)  AND
 13152            PB-I-SIG-SW = 'N'
 13153            MOVE ER-2651         TO  WS-ERROR
 13154            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13155
 13156 3135-NAME-EDIT.
 13157
 13158     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 13159        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 13160        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 13161           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 13162                                 TO PB-I-JOINT-FIRST-NAME
 13163        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 240
* EL050.cbl
 13164     END-IF
 13165     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 13166        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 13167        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 13168           MOVE PB-I-JOINT-LAST-NAME (2:14)
 13169                                 TO PB-I-JOINT-LAST-NAME
 13170        END-PERFORM
 13171     END-IF
 13172     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 13173        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 13174        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 13175           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 13176                                 TO PB-I-INSURED-FIRST-NAME
 13177        END-PERFORM
 13178     END-IF
 13179     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 13180        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 13181        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 13182           MOVE PB-I-INSURED-LAST-NAME (2:14)
 13183                                 TO PB-I-INSURED-LAST-NAME
 13184        END-PERFORM
 13185     END-IF
 13186     IF PB-I-INSURED-LAST-NAME = SPACES
 13187       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 13188       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 13189           MOVE ER-2660    TO WS-ERROR
 13190           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13191
 13192 3136-EDIT-SEX.
 13193
 13194******************************************************************
 13195*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 13196******************************************************************
 13197
 13198     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 13199        (WS-AH-SPECIAL-CALC-CD = 'O')
 13200        NEXT SENTENCE
 13201     ELSE
 13202        IF PB-I-INSURED-SEX = 'M' OR 'F'
 13203           NEXT SENTENCE
 13204        ELSE
 13205           MOVE ER-2629            TO WS-ERROR
 13206           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13207
 13208 3137-EDIT-EFF-DATE.
 13209
 13210     IF PB-REISSUED-CERT       OR
 13211        PB-POLICY-IS-DECLINED  OR
 13212        PB-POLICY-IS-VOIDED
 13213         GO TO 3139-EDIT-COVERAGE-CODES.
 13214
 13215     MOVE SPACE                  TO WS-2671-SW
 13216                                    WS-2672-SW.
 13217
 13218     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 13219         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 13220             MOVE ER-2703        TO WS-ERROR
 13221             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 241
* EL050.cbl
 13222             GO TO 3139-EDIT-COVERAGE-CODES.
 13223
 13224     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 13225         GO TO 3139-EDIT-COVERAGE-CODES.
 13226
 13227     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13228     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 13229*    MOVE '1'                    TO DC-OPTION-CODE.
 13230     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 13231     MOVE +0                     TO DC-ELAPSED-MONTHS
 13232                                    DC-ELAPSED-DAYS.
 13233     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13234
 13235     IF DATE-CONVERSION-ERROR
 13236         GO TO 3139-EDIT-COVERAGE-CODES.
 13237
 13238     IF DC-ELAPSED-DAYS GREATER +180
 13239         MOVE ER-2672            TO WS-ERROR
 13240         MOVE 'Y'                TO WS-2672-SW
 13241         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13242     END-IF
 13243
 13244     IF WS-ERROR = ER-2671  AND
 13245        PB-COMPANY-ID  = 'LBL'
 13246        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13247        MOVE SPACE               TO WS-2671-SW
 13248        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 13249
 13250     IF PB-ISSUE-DATE-FORCED  AND
 13251      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 13252         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 13253         MOVE ER-2673            TO WS-ERROR
 13254         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13255         MOVE SPACE              TO WS-2671-SW
 13256                                    WS-2672-SW.
 13257
 13258     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 13259         IF PB-ISSUE-DATE-FORCED
 13260             MOVE ER-2600          TO  WS-ERROR
 13261             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13262         ELSE
 13263             MOVE ER-2692          TO  WS-ERROR
 13264             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13265
 13266
 13267 3139-EDIT-COVERAGE-CODES.
 13268
 13269     if pb-company-id not = 'AHL'
 13270        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 13271           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 13272           MOVE ER-2787          TO WS-ERROR
 13273           PERFORM 9900-ERROR-FORMAT
 13274                                 THRU 9900-EXIT
 13275        END-IF
 13276     end-if
 13277     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13278        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 13279                                 > 250000.00
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 242
* EL050.cbl
 13280           MOVE ER-2719          TO WS-ERROR
 13281           PERFORM 9900-ERROR-FORMAT
 13282                                 THRU 9900-EXIT
 13283        END-IF
 13284     END-IF
 13285
 13286     IF PB-POLICY-IS-DECLINED  OR
 13287        PB-POLICY-IS-VOIDED
 13288         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13289
 13290     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 13291        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 13292         MOVE ER-2630                TO WS-ERROR
 13293         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13294
 13295     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 13296        PB-I-LF-BENEFIT-AMT = ZERO  AND
 13297        PB-I-LF-PREMIUM-AMT = ZERO
 13298         GO TO 3140-CHECK-AH-FOR-ZERO.
 13299
 13300     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 13301        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 13302        PB-I-LF-PREMIUM-AMT NOT = ZERO
 13303         GO TO 3140-CHECK-AH-FOR-ZERO.
 13304
 13305     IF (PB-I-LF-BENEFIT-CD = ZERO)
 13306        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13307        MOVE ER-2631             TO WS-ERROR
 13308        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13309     END-IF
 13310
 13311
 13312******************************************************************
 13313*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13314******************************************************************
 13315
 13316     IF WS-LF-SPECIAL-CALC-CD = 'O'
 13317        NEXT SENTENCE
 13318     ELSE
 13319        IF PB-I-LF-BENEFIT-AMT = ZERO
 13320           MOVE ER-2632             TO WS-ERROR
 13321           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13322
 13323
 13324******************************************************************
 13325*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13326******************************************************************
 13327
 13328     IF WS-LF-SPECIAL-CALC-CD = 'O'
 13329        CONTINUE
 13330     ELSE
 13331        IF PB-I-LF-PREMIUM-AMT = ZERO
 13332           IF (NOT PB-COMP-LF-PREM)
 13333              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13334              and (ws-lf-ben-category not = 'C')
 13335              MOVE ER-2633       TO WS-ERROR
 13336              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13337           END-IF
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 243
* EL050.cbl
 13338        END-IF
 13339     END-IF
 13340     .
 13341 3140-CHECK-AH-FOR-ZERO.
 13342
 13343     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 13344        PB-I-AH-BENEFIT-AMT = ZERO  AND
 13345        PB-I-AH-PREMIUM-AMT = ZERO
 13346         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13347
 13348     IF PB-COMPANY-ID = 'CSL'  AND
 13349        PB-I-AH-BENEFIT-CD = ZERO  AND
 13350        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 13351        PB-I-AH-PREMIUM-AMT = ZERO
 13352         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13353
 13354     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 13355        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 13356        PB-I-AH-PREMIUM-AMT NOT = ZERO
 13357         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13358
 13359     IF PB-I-AH-BENEFIT-CD = ZERO
 13360         MOVE ER-2634            TO WS-ERROR
 13361         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13362
 13363******************************************************************
 13364*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13365******************************************************************
 13366
 13367     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13368        NEXT SENTENCE
 13369     ELSE
 13370        IF PB-I-AH-BENEFIT-AMT = ZERO
 13371           MOVE ER-2635             TO WS-ERROR
 13372           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13373
 13374******************************************************************
 13375*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13376******************************************************************
 13377
 13378     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13379        NEXT SENTENCE
 13380     ELSE
 13381        IF PB-I-AH-PREMIUM-AMT = ZERO
 13382            IF NOT PB-COMP-AH-PREM
 13383                MOVE ER-2636    TO WS-ERROR
 13384                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13385
 13386
 13387 3140-EDIT-MAX-AMT-SIZES.
 13388* CUSTOM CODE FOR CLIENT    'DMD'
 13389     MOVE ZEROS                   TO WS-RES-STATE-TAX
 13390                                     WS-RES-MUNI-TAX
 13391                                     PB-I-STATE-TAX
 13392                                     PB-I-MUNI-TAX.
 13393
 13394     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 13395
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 244
* EL050.cbl
 13396     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 13397        GO TO 3150-RATE-OUTSTAND-BAL.
 13398
 13399     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 13400        GO TO 3150-RATE-OUTSTAND-BAL.
 13401
 13402     IF WS-LF-EARNINGS-CALC EQUAL '5'
 13403        GO TO 3150-RATE-OUTSTAND-BAL.
 13404
 13405     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 13406                             OR 'RIC')
 13407        GO TO 3150-RATE-OUTSTAND-BAL.
 13408
 13409     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 13410        IF PB-I-LOAN-APR GREATER THAN ZEROS
 13411            GO TO 3150-RATE-OUTSTAND-BAL
 13412        ELSE
 13413           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 13414               GO TO 3150-RATE-OUTSTAND-BAL.
 13415
 13416     IF NOT PB-NO-MONTHS-SKIPPED
 13417        GO TO 3150-RATE-OUTSTAND-BAL.
 13418
 13419     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 13420        GO TO 3150-RATE-OUTSTAND-BAL.
 13421
 13422     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 13423        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 13424           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 13425             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 13426           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 13427           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 13428              MOVE ER-2693     TO WS-ERROR
 13429              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13430              GO TO 3150-RATE-OUTSTAND-BAL
 13431           ELSE
 13432              GO TO 3150-RATE-OUTSTAND-BAL.
 13433
 13434 3150-RATE-OUTSTAND-BAL.
 13435
 13436* DMD RATING TEST
 13437     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13438         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13439         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13440         MOVE ER-2687                 TO WS-ERROR
 13441         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13442         MOVE 'B'                     TO PB-I-OB-FLAG
 13443         GO TO 3260-EDIT-CONTINUE.
 13444
 13445     IF  PB-COMPANY-ID   EQUAL    'CRI'
 13446         IF  WS-ERROR    EQUAL    ER-2693
 13447             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 13448                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13449                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13450                 MOVE  +0            TO  WS-ERROR.
 13451
 13452     IF  PB-COMPANY-ID   EQUAL    'CDL'
 13453         IF  WS-ERROR    EQUAL    ER-2693
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 245
* EL050.cbl
 13454             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 13455                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13456                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13457                 MOVE  +0            TO  WS-ERROR.
 13458
 13459     IF PLAN-MASTER-AH-SW = 'Y'
 13460        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13461            IF  WS-ERROR    EQUAL    ER-2693
 13462              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13463                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13464                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13465                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13466                 MOVE  ER-1910           TO  WS-ERROR
 13467                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13468
 13469     IF PLAN-MASTER-AH-SW = 'Y'
 13470        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13471            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13472               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13473               MOVE  ER-1910           TO  WS-ERROR
 13474               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13475
 13476     IF PLAN-MASTER-AH-SW = 'Y'
 13477        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13478            IF  WS-ERROR    EQUAL    ER-2693
 13479                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 13480                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13481                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13482                 MOVE  +0       TO  WS-ERROR.
 13483
 13484     IF WS-ERROR = ER-2693
 13485        IF PB-COMPANY-ID = 'JAL' AND
 13486           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 13487           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13488           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13489
 13490     IF WS-ERROR = ER-2693
 13491        IF PB-COMPANY-ID = 'NCL'  AND
 13492           PB-I-AH-BENEFIT-CD = 'OA'
 13493           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13494           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13495
 13496     IF WS-ERROR = ER-2693
 13497        IF PB-COMPANY-ID = 'CNL' AND
 13498           PB-I-LF-BENEFIT-CD = '71' OR '72'
 13499           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13500           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13501
 13502     IF WS-ERROR = ER-2693
 13503        IF PB-COMPANY-ID = 'HER'
 13504           IF WS-LEVEL
 13505              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13506              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13507
 13508     IF ((LF-BENEFIT-FOUND) AND
 13509         (NOT NO-LIFE-COVERAGE)  AND
 13510         (WS-LF-SPECIAL-CALC-CD = 'O'))
 13511       OR   ((AH-BENEFIT-FOUND) AND
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 246
* EL050.cbl
 13512             (NOT NO-AH-COVERAGE)    AND
 13513             (WS-AH-SPECIAL-CALC-CD = 'O'))
 13514         NEXT SENTENCE
 13515     ELSE
 13516         GO TO 3215-EDIT-RATES.
 13517
 13518     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13519        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13520           MOVE ER-2674          TO WS-ERROR
 13521           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13522           GO TO 3215-EDIT-RATES.
 13523
 13524     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13525        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13526           MOVE ER-2674          TO WS-ERROR
 13527           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13528           GO TO 3215-EDIT-RATES.
 13529
 13530     MOVE 'B'                    TO PB-I-OB-FLAG.
 13531
 13532     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13533         NEXT SENTENCE
 13534     ELSE
 13535         IF NOT NO-LIFE-COVERAGE
 13536             IF WS-ACCT-LF-OB-RT = ZERO
 13537                MOVE ER-2641    TO WS-ERROR
 13538                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13539
 13540     IF PB-COMPANY-ID = 'CRI'
 13541       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13542         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13543         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13544         IF WS-ERROR = ER-2675
 13545            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13546            MOVE ER-2687              TO WS-ERROR
 13547            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13548         ELSE
 13549            MOVE ER-2687              TO WS-ERROR
 13550            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13551
 13552
 13553     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13554         NEXT SENTENCE
 13555     ELSE
 13556       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13557            NEXT SENTENCE
 13558       ELSE
 13559         IF NOT NO-AH-COVERAGE
 13560             IF WS-ACCT-AH-OB-RT = ZERO
 13561                MOVE ER-2642    TO WS-ERROR
 13562                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13563
 13564     IF PB-COMPANY-ID = 'CRI'
 13565       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13566         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13567         IF WS-ERROR = ER-2676
 13568            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13569            MOVE ER-2687              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 247
* EL050.cbl
 13570            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13571         ELSE
 13572            MOVE ER-2687              TO WS-ERROR
 13573            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13574
 13575     IF PB-COMPANY-ID NOT = 'GIC'
 13576         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13577            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13578     ELSE
 13579         IF PB-I-LF-PREM-CALC = ZEROS
 13580             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13581                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13582
 13583     IF PB-COMPANY-ID NOT = 'GIC'
 13584         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13585            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13586     ELSE
 13587         IF PB-I-AH-PREM-CALC = ZEROS
 13588             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13589                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13590
 13591     MOVE ZEROS TO PB-I-MORT-CODE.
 13592
 13593     GO TO 3260-EDIT-CONTINUE.
 13594
 13595
 13596 3215-EDIT-RATES.
 13597     IF ACCOUNT-MAST-FOUND
 13598         NEXT SENTENCE
 13599     ELSE
 13600         GO TO 3999-END-EDIT.
 13601
 13602 3220-CHECK-LF-RATES.
 13603
 13604     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13605        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13606        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13607        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13608           AND (NOT WS-LF-CASH))
 13609                           OR
 13610           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13611           AND (NOT WS-AH-CASH)))
 13612                       AND
 13613           (PB-I-ENTRY-STATUS NOT = '5')
 13614           MOVE 'M'              TO PB-BATCH-ENTRY
 13615                                    PB-I-ENTRY-STATUS
 13616        END-IF
 13617     END-IF
 13618     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13619                                    PB-I-AH-PREM-CALC
 13620                                    PB-I-LF-ALT-PREM-CALC
 13621                                    PB-I-LF-ALT-RATE
 13622                                    PB-I-LF-REI-RATE
 13623                                    PB-I-LF-ALT-REI-RATE
 13624                                    PB-I-AH-REI-RATE
 13625                                    PB-I-TOT-FEES-CALC.
 13626
 13627     IF PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 248
* EL050.cbl
 13628        NEXT SENTENCE
 13629     ELSE
 13630        MOVE ZEROS               TO PB-I-LF-RATE
 13631                                    PB-I-AH-RATE.
 13632
 13633     IF PB-I-TOT-FEES NOT NUMERIC
 13634        MOVE ZEROS               TO PB-I-TOT-FEES
 13635     END-IF
 13636     IF PB-I-LIVES NOT NUMERIC
 13637         MOVE ZERO               TO PB-I-LIVES.
 13638
 13639     IF PB-I-NUM-BILLED NOT NUMERIC
 13640         MOVE ZERO               TO PB-I-NUM-BILLED.
 13641
 13642     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13643        MOVE +0                  TO PB-I-LF-PREM-TAX
 13644     END-IF
 13645
 13646     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13647        MOVE +0                  TO PB-I-AH-PREM-TAX
 13648     END-IF
 13649
 13650     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13651        PB-I-PAY-FREQUENCY = ZEROS
 13652            MOVE 12 TO CP-PAY-FREQUENCY
 13653     ELSE
 13654            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13655
 13656     IF PB-I-STATE-TAX NOT NUMERIC
 13657         MOVE ZEROS               TO PB-I-STATE-TAX.
 13658
 13659     IF PB-I-MUNI-TAX NOT NUMERIC
 13660         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13661
 13662     MOVE SPACES                 TO CP-BEN-CATEGORY
 13663     IF PB-COMPANY-ID  = 'CSL'  AND
 13664        PB-I-LF-TERM NOT = ZERO
 13665        COMPUTE WS-PAYMENT-AMT =
 13666             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13667        COMPUTE WS-CSL-AMT1 =
 13668             PB-I-LF-TERM * AM-MAX-MON-BEN
 13669        COMPUTE WS-CSL-AMT2 =
 13670             WS-PAYMENT-AMT * PB-I-LF-TERM
 13671        IF CP-PAY-FREQUENCY NOT = 12
 13672           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13673           MOVE '8' TO WS-CSL-CALC-CD
 13674        ELSE
 13675           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13676              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13677               AM-MAX-TOT-BEN
 13678               MOVE '6' TO WS-CSL-CALC-CD
 13679           ELSE
 13680              IF (WS-CSL-AMT1  GREATER THAN
 13681                 AM-MAX-TOT-BEN) AND
 13682                 (WS-CSL-AMT2  GREATER THAN
 13683                 AM-MAX-TOT-BEN)
 13684                 MOVE '7' TO WS-CSL-CALC-CD
 13685              ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 249
* EL050.cbl
 13686                 MOVE '5' TO WS-CSL-CALC-CD.
 13687
 13688     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13689         NEXT SENTENCE
 13690     ELSE
 13691         GO TO 3300-CHECK-AH-RATES.
 13692
 13693*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13694
 13695     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13696        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13697              OR
 13698           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13699           MOVE ER-2618          TO WS-ERROR
 13700           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13701           GO TO 3300-CHECK-AH-RATES.
 13702
 13703     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13704           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13705                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13706
 13707     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13708         MOVE ER-2687             TO WS-ERROR
 13709         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13710         MOVE 'Z000'              TO PB-I-MORT-CODE
 13711         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13712         GO TO 3300-CHECK-AH-RATES.
 13713
 13714     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13715        IF PB-I-LIVES = ZERO
 13716           MOVE ER-2688          TO WS-ERROR
 13717           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13718
 13719     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13720
 13721     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13722     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13723     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13724     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13725     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13726     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13727     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13728     MOVE '3'                    TO CP-PROCESS-TYPE.
 13729     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13730     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13731
 13732******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13733     IF PB-COMPANY-ID EQUAL 'CDL'
 13734         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13735            CP-EARN-AS-NET-PAY)
 13736             IF PB-CERT-EFF-DT GREATER  WS-931231
 13737                 MOVE '1'        TO CP-EARNING-METHOD.
 13738*******
 13739
 13740     MOVE PB-SV-STATE            TO CP-STATE.
 13741     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13742     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13743     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 250
* EL050.cbl
 13744     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13745     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13746                                    CP-RATING-BENEFIT-AMT.
 13747     IF CP-STATE-STD-ABBRV = 'OR'
 13748         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13749                                         PB-I-LF-ALT-BENEFIT-AMT.
 13750     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13751     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13752     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13753     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13754     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13755     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13756     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13757     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13758     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13759                                    CP-REMAINING-TERM
 13760                                    CP-LOAN-TERM.
 13761
 13762     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13763         NEXT SENTENCE
 13764     ELSE
 13765         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13766             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13767                                           PB-I-LF-PREMIUM-AMT.
 13768
 13769     IF PB-COMPANY-ID EQUAL 'CSL'
 13770        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13771           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13772                                         PB-I-LF-PREMIUM-AMT.
 13773
 13774     IF PB-COMPANY-ID EQUAL 'NCB'
 13775         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13776            CP-EARN-AS-NET-PAY
 13777             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13778                 PB-I-LF-PREMIUM-AMT.
 13779
 13780     IF (CP-TRUNCATED-LIFE)
 13781        or ((pb-company-id = 'AHL')
 13782           and (pb-i-loan-term > pb-i-lf-term))
 13783        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13784
 13785     IF PB-COMPANY-ID EQUAL 'CRI'
 13786        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13787
 13788     IF CP-TERM-IS-DAYS
 13789         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13790     ELSE
 13791         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13792     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13793        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13794        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13795        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13796        IF WS-LF-BEN-CATEGORY = 'D'
 13797           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13798           MOVE PB-I-LIFE-COMMISSION
 13799                                 TO CP-DCC-ACT-COMM
 13800           MOVE WS-LF-BEN-CATEGORY
 13801                                 TO CP-BEN-CATEGORY
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 251
* EL050.cbl
 13802        END-IF
 13803        IF (CP-BENEFIT-CD (1:1) = 'P')
 13804           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13805           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13806           add pb-i-ah-premium-amt to cp-original-premium
 13807        END-IF
 13808     END-IF
 13809     IF PB-COMPANY-ID = 'CSL'
 13810         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13811         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13812         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13813
 13814     IF PB-COMPANY-ID = 'CSL'
 13815        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13816
 13817     IF (CP-SPECIAL-CALC-CD = 'H')
 13818        OR (PB-COMPANY-ID = 'DCC' or 'VPP')
 13819         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13820                                    TO CP-ALTERNATE-BENEFIT
 13821         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13822     if (pb-company-id = 'CID')
 13823        and (ws-lf-earnings-calc = '4')
 13824        and (cp-state-std-abbrv = 'MN' OR 'WA')
 13825        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13826        move pb-i-term-type      to cp-pmt-mode
 13827        move pb-i-no-of-payments to cp-no-of-pmts
 13828     end-if
 13829     move ws-net-only-state      to cp-net-only-state
 13830     IF (PB-COMPANY-ID = 'CID')
 13831        AND (WS-LF-EARNINGS-CALC = 'B')
 13832        AND (CP-STATE-STD-ABBRV = 'MN')
 13833        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13834                                 TO CP-ALTERNATE-BENEFIT
 13835        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13836     END-IF
 13837     IF (PB-COMPANY-ID = 'CID')
 13838        AND (WS-LF-EARNINGS-CALC = 'B')
 13839        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13840                                 TO CP-ALTERNATE-BENEFIT
 13841        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13842        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13843*       compute cp-original-benefit = pb-i-lf-benefit-amt -
 13844*         pb-i-lf-alt-premium-amt
 13845        MOVE WS-LF-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13846        IF WS-LF-BEN-CATEGORY = 'P'
 13847           MOVE WS-EXTRA-PMTS    TO CP-EXTRA-PERIODS
 13848        ELSE
 13849           IF WS-LF-BEN-CATEGORY = 'I'
 13850              MOVE WS-INT-PERIODS TO CP-EXTRA-PERIODS
 13851           END-IF
 13852        END-IF
 13853     END-IF
 13854     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13855     MOVE 'R'                   TO CP-RATE-FILE.
 13856     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13857
 13858     IF CP-ERROR-RATE-NOT-FOUND
 13859        MOVE ER-2641            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 252
* EL050.cbl
 13860        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13861        GO TO 3300-CHECK-AH-RATES.
 13862
 13863     IF PB-COMPANY-ID EQUAL 'CRI'
 13864        IF CP-ERROR-NO-LIMITS-CRI
 13865           IF NOT ACCOUNT-LIFE-CHECKED
 13866              MOVE ER-2607      TO WS-ERROR
 13867              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13868
 13869******************************************************************
 13870*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13871*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13872******************************************************************
 13873
 13874* CALC LIFE AGE AT EXPIRATION.
 13875
 13876     COMPUTE WS-AGE-AT-EXPIRE =
 13877          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13878
 13879*    IF PB-STATE = 'CO' OR 'UT'
 13880*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13881*        MOVE 'F'            TO PB-FATAL-FLAG
 13882*        MOVE ER-2709        TO WS-ERROR
 13883*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13884*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13885
 13886*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13887*        MOVE 'X'            TO PB-FATAL-FLAG
 13888*        MOVE ER-2718        TO WS-ERROR
 13889*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13890*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13891
 13892* CALC A & H AGE AT EXPIRATION.
 13893
 13894     COMPUTE WS-AGE-AT-EXPIRE =
 13895          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13896
 13897*    IF PB-STATE = 'CO' OR 'UT'
 13898*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13899*        MOVE 'F'            TO PB-FATAL-FLAG
 13900*        MOVE ER-2709        TO WS-ERROR
 13901*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13902*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13903
 13904*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13905*        MOVE 'X'            TO PB-FATAL-FLAG
 13906*        MOVE ER-2718        TO WS-ERROR
 13907*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13908*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13909
 13910     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13911        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13912
 13913     IF (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13914        and (not pb-monthly-cert)
 13915        GO TO 3221-CHECK-ERROR-RATE-OPEN
 13916     end-if
 13917
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 253
* EL050.cbl
 13918     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13919        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13920
 13921     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13922         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13923         MOVE ER-2639        TO WS-ERROR
 13924         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13925
 13926
 13927******************************************************************
 13928*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13929******************************************************************
 13930
 13931 PREMIUM-EDITING-IS-BYPASSED.
 13932     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13933        AND (CP-R-MAX-ATT-AGE > +0)
 13934        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13935        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13936           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13937           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13938           MOVE '1'              TO DC-OPTION-CODE
 13939           PERFORM 8500-DATE-CONVERT
 13940                                 THRU 8500-EXIT
 13941           IF NO-CONVERSION-ERROR
 13942              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13943                 MOVE ER-2661       TO WS-ERROR
 13944*                PERFORM 9900-ERROR-FORMAT
 13945*                                THRU 9900-EXIT
 13946              END-IF
 13947           END-IF
 13948        ELSE
 13949           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13950           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13951              MOVE ER-2661       TO WS-ERROR
 13952*             PERFORM 9900-ERROR-FORMAT
 13953*                                THRU 9900-EXIT
 13954           ELSE
 13955              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13956                 MOVE ER-1570    TO WS-ERROR
 13957                 PERFORM 9900-ERROR-FORMAT
 13958                                 THRU 9900-EXIT
 13959              END-IF
 13960           END-IF
 13961        END-IF
 13962        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13963           MOVE PB-I-JOINT-BIRTHDAY
 13964                                 TO DC-BIN-DATE-1
 13965           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13966           MOVE '1'              TO DC-OPTION-CODE
 13967           PERFORM 8500-DATE-CONVERT
 13968                                 THRU 8500-EXIT
 13969           IF NO-CONVERSION-ERROR
 13970              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13971                 MOVE ER-2661       TO WS-ERROR
 13972*                PERFORM 9900-ERROR-FORMAT
 13973*                                THRU 9900-EXIT
 13974              END-IF
 13975           ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 254
* EL050.cbl
 13976              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13977           END-IF
 13978        ELSE
 13979           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13980             (PB-I-LF-TERM / 12)
 13981           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13982              MOVE ER-2661       TO WS-ERROR
 13983*             PERFORM 9900-ERROR-FORMAT
 13984*                                THRU 9900-EXIT
 13985           ELSE
 13986              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13987                 MOVE ER-1571    TO WS-ERROR
 13988                 PERFORM 9900-ERROR-FORMAT
 13989                                 THRU 9900-EXIT
 13990              END-IF
 13991           END-IF
 13992        END-IF
 13993        IF WS-ERROR = ER-2661
 13994           PERFORM 9900-ERROR-FORMAT
 13995                                 THRU 9900-EXIT
 13996        END-IF
 13997     END-IF
 13998*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13999*       MOVE ER-2661             TO WS-ERROR
 14000*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14001
 14002     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14003        MOVE ER-2662             TO WS-ERROR
 14004        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14005
 14006     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14007        MOVE ER-2677             TO WS-ERROR
 14008        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14009
 14010     IF CP-ERROR-LOAN-TERM
 14011        MOVE ER-2648             TO WS-ERROR
 14012        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14013
 14014 3221-CHECK-ERROR-RATE-OPEN.
 14015
 14016     IF CP-ERROR-RATE-FILE-NOTOPEN
 14017         GO TO 3990-FILES-NOT-OPEN.
 14018
 14019     IF PB-COMPANY-ID NOT = 'DMD'
 14020        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 14021     END-IF
 14022     .
 14023 3221-CONTINUE.
 14024     MOVE ZEROS                  TO WS-DCC-LF-RATE
 14025                                    WS-DCC-AH-RATE
 14026     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14027        IF WS-LF-BEN-CATEGORY = 'D'
 14028           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 14029              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14030        END-IF
 14031     END-IF
 14032     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 14033*   X'A4FF' = 12/31/2009
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 255
* EL050.cbl
 14034     IF (PB-COMPANY-ID = 'CID')
 14035        AND (WS-LF-EARNINGS-CALC = 'B')
 14036        AND (CP-STATE-STD-ABBRV = 'MN')
 14037        AND (PB-CERT-EFF-DT > X'A4FF')
 14038        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 14039     END-IF
 14040     MOVE ZEROS                  TO PB-I-LF-POLICY-FEE.
 14041
 14042     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 14043     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14044        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14045        AND (PB-I-POLICY-IS-MONTHLY)
 14046        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 14047        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 14048     END-IF
 14049     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 14050     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 14051     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 14052     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 14053     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14054        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 14055        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14056        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 14057        MOVE ER-2786             TO WS-ERROR
 14058        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14059     END-IF
 14060
 14061     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 14062
 14063******************************************************************
 14064*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 14065******************************************************************
 14066     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 14067        and ((not pb-monthly-cert)
 14068        or (ws-lf-ben-category = 'C'))
 14069        GO TO 3225-CHECK-ALT-LIFE-RATE.
 14070
 14071     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14072        GO TO 3225-CHECK-ALT-LIFE-RATE
 14073     ELSE
 14074       IF PB-I-LF-RATE = ZERO
 14075          MOVE ER-2641          TO WS-ERROR
 14076          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14077
 14078 3225-CHECK-ALT-LIFE-RATE.
 14079
 14080     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 14081        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 14082        (CP-SPECIAL-CALC-CD EQUAL 'H')
 14083         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 14084
 14085     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 14086         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 14087             AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
 14088                   OR
 14089              (PB-I-LF-ALT-PREMIUM-AMT > +0
 14090              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 14091              AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 256
* EL050.cbl
 14092             MOVE ER-2720        TO  WS-ERROR
 14093             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14094             GO TO 3225-RATING-CONT
 14095         ELSE
 14096             GO TO 3225-RATING-CONT.
 14097     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 14098        AND (AM-GPCD = 01 OR 06 OR 15)
 14099        MOVE ER-2798             TO WS-ERROR
 14100        PERFORM 9900-ERROR-FORMAT
 14101                                 THRU 9900-EXIT
 14102*       GO TO 3225-RATING-CONT
 14103     END-IF
 14104     if (pb-company-id = 'CID')
 14105        and (ws-lf-earnings-calc = 'B')
 14106        and (ws-lf-ben-category = 'P' or 'I')
 14107        and (ws-net-only-state = 'Y')
 14108        move cp-lf-balloon-prem  to pb-i-lf-alt-prem-calc
 14109        display ' balloon prem ' pb-i-lf-alt-prem-calc
 14110        go to 3225-rating-cont
 14111     end-if
 14112     IF (PB-COMPANY-ID = 'CID')
 14113        AND (WS-LF-EARNINGS-CALC = 'B')
 14114        AND (CP-STATE-STD-ABBRV = 'MN')
 14115        AND (PB-CERT-EFF-DT > X'A4FF')
 14116        GO TO 3225-RATING-CONT
 14117     END-IF
 14118     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14119        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14120           AND (PB-I-POLICY-IS-MONTHLY)
 14121           GO TO 3225-RATING-CONT
 14122        END-IF
 14123     END-IF
 14124
 14125     IF PB-COMPANY-ID EQUAL 'WDS' AND
 14126        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 14127        CP-EARN-AS-REG-BALLOON
 14128        NEXT SENTENCE
 14129     ELSE
 14130        MOVE '2'                 TO CP-EARNING-METHOD.
 14131
 14132 3225-SET-ALT-LIFE-RATE-LOOKUP.
 14133
 14134     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14135
 14136     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 14137        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 14138        (CP-SPECIAL-CALC-CD EQUAL 'H')
 14139         NEXT SENTENCE
 14140     ELSE
 14141         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 14142
 14143     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14144     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14145     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14146                                     CP-RATING-BENEFIT-AMT.
 14147     IF CP-STATE-STD-ABBRV = 'OR'
 14148         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14149                                         PB-I-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 257
* EL050.cbl
 14150     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14151        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14152     END-IF
 14153     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14154     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14155     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14156                                    CP-REMAINING-TERM
 14157                                    CP-LOAN-TERM.
 14158     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14159        ADD +1                   TO CP-ORIGINAL-TERM
 14160                                    CP-REMAINING-TERM
 14161                                    CP-LOAN-TERM.
 14162
 14163     MOVE 'R'                   TO CP-RATE-FILE.
 14164     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14165
 14166     IF CP-ERROR-RATE-NOT-FOUND
 14167         MOVE ER-2641            TO WS-ERROR
 14168         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14169         GO TO 3300-CHECK-AH-RATES.
 14170
 14171     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 14172     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 14173
 14174     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 14175         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 14176
 14177     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 14178                               + PB-I-LF-ALT-BENEFIT-AMT.
 14179
 14180     IF ACCOUNT-LIFE-CHECKED  OR
 14181        PB-POLICY-IS-VOIDED   OR
 14182        ((WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 14183        and (not pb-monthly-cert))
 14184        GO TO 3225-CONTINUE.
 14185
 14186     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14187        GO TO 3225-CONTINUE.
 14188
 14189     IF WS-LF-BENEFIT-AMT  GREATER THAN
 14190                             EC-RT-LF-MAX-TOT-BEN
 14191        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 14192        MOVE ER-2639       TO WS-ERROR
 14193        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14194
 14195 3225-CONTINUE.
 14196     IF PB-I-LF-ALT-RATE = ZERO
 14197         MOVE ER-2659            TO WS-ERROR
 14198         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14199
 14200     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 14201        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 14202        MOVE ER-2698             TO WS-ERROR
 14203        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14204
 14205 3225-RATING-CONT.
 14206
 14207     IF (WS-LF-SPECIAL-CALC-CD = 'E')
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 258
* EL050.cbl
 14208        and (not pb-monthly-cert)
 14209         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 14210         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 14211         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14212            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14213            CONTINUE
 14214         ELSE
 14215            MOVE ER-2687         TO WS-ERROR
 14216            PERFORM 9900-ERROR-FORMAT
 14217                                 THRU 9900-EXIT
 14218         END-IF
 14219         GO TO 3290-EDIT-LF-REIN-RATE
 14220     END-IF
 14221
 14222* DMD RATING TEST
 14223     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14224         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 14225         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 14226         MOVE ER-2687                 TO WS-ERROR
 14227         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14228         GO TO 3290-EDIT-LF-REIN-RATE.
 14229
 14230 3230-CLIENT-MORT-CD-SPECIALS.
 14231
 14232     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 14233     SET BIN-TO-GREG          TO TRUE.
 14234*    MOVE ' '                 TO DC-OPTION-CODE.
 14235     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14236     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 14237
 14238 C-POS-3230-MORT-CD.
 14239     IF PB-COMPANY-ID = 'POS' AND
 14240        PB-SV-CARRIER = '2'
 14241         NEXT SENTENCE
 14242     ELSE
 14243         GO TO C-POS-3240-MORT-CD.
 14244
 14245     IF PB-SV-GROUPING = '030'
 14246        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 14247         MOVE '2350' TO PB-I-MORT-CODE
 14248      ELSE
 14249         MOVE '3300' TO PB-I-MORT-CODE.
 14250
 14251
 14252 C-POS-3240-MORT-CD.
 14253     IF PB-COMPANY-ID = 'POS' AND
 14254        PB-SV-CARRIER = '1'
 14255         NEXT SENTENCE
 14256     ELSE
 14257         GO TO 3230-CONTINUE.
 14258
 14259     IF PB-SV-STATE = '45' OR '47'
 14260        OR PB-CERT-EFF-DT LESS THAN WS-771001
 14261         MOVE '5200' TO PB-I-MORT-CODE
 14262     ELSE
 14263         MOVE '8300' TO PB-I-MORT-CODE.
 14264
 14265 3230-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 259
* EL050.cbl
 14266
 14267     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 14268        GO TO 3240-CONTINUE
 14269     END-IF
 14270
 14271     IF PB-CERT-EFF-DT > WS-971231
 14272        GO TO 3240-CONTINUE
 14273     END-IF
 14274
 14275     IF LF-BENEFIT-FOUND AND
 14276        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 14277         MOVE 'F250'       TO PB-I-MORT-CODE
 14278     ELSE
 14279         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 14280             MOVE '7250'   TO PB-I-MORT-CODE
 14281         ELSE
 14282             MOVE '4251'   TO PB-I-MORT-CODE
 14283         END-IF
 14284     END-IF
 14285
 14286     .
 14287 3240-CONTINUE.
 14288
 14289     IF PB-COMPANY-ID NOT = 'GNL'
 14290         GO TO 3256-CONTINUE.
 14291
 14292     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 14293         MOVE 'A300' TO PB-I-MORT-CODE
 14294     ELSE
 14295         MOVE '8350' TO PB-I-MORT-CODE.
 14296
 14297 3256-CONTINUE.
 14298     IF PB-COMPANY-ID NOT = 'ABL'
 14299         GO TO 3260-EDIT-CONTINUE.
 14300
 14301     IF PB-I-LF-TERM GREATER THAN 59
 14302         MOVE 'F550' TO PB-I-MORT-CODE
 14303     ELSE
 14304         MOVE 'E550' TO PB-I-MORT-CODE.
 14305
 14306 3260-EDIT-CONTINUE.
 14307     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 14308
 14309 3290-EDIT-LF-REIN-RATE.
 14310     IF LF-REIN-NSP-NOT-USED
 14311         GO TO 3290-RATING-CONT.
 14312
 14313     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14314        GO TO 3290-RATING-CONT.
 14315     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 14316     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14317     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 14318     MOVE '3'                   TO CP-PROCESS-TYPE.
 14319     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14320
 14321******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 14322     IF PB-COMPANY-ID EQUAL 'CDL'
 14323         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 260
* EL050.cbl
 14324            CP-EARN-AS-NET-PAY)
 14325             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 14326*            MOVE SPACE          TO DC-OPTION-CODE
 14327             SET BIN-TO-GREG     TO TRUE
 14328             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 14329***  Y2K PROJ 7744
 14330             IF DC-GREG-DATE-CYMD GREATER 19931231
 14331                 MOVE '1'        TO CP-EARNING-METHOD.
 14332***  Y2K PROJ 7744
 14333*******
 14334
 14335     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14336     MOVE PB-SV-STATE           TO CP-STATE.
 14337     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 14338     MOVE ZERO                  TO CP-DEVIATION-CODE
 14339                                   CP-RATE-DEV-PCT.
 14340     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 14341     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 14342                                   CP-RATING-BENEFIT-AMT.
 14343
 14344************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 14345     IF PB-COMPANY-ID EQUAL 'NCB'
 14346         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 14347            CP-EARN-AS-NET-PAY
 14348             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14349                 PB-I-LF-PREMIUM-AMT.
 14350************
 14351
 14352     IF CP-STATE-STD-ABBRV = 'OR'
 14353         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14354                                         PB-I-LF-ALT-BENEFIT-AMT.
 14355     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 14356     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 14357     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 14358     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 14359     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 14360     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 14361     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 14362     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 14363                                   CP-REMAINING-TERM
 14364                                   CP-LOAN-TERM.
 14365     IF CP-TRUNCATED-LIFE
 14366        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 14367
 14368     IF CP-TERM-IS-DAYS
 14369         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 14370     ELSE
 14371         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14372
 14373     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14374        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14375     END-IF
 14376     IF PB-COMPANY-ID NOT = 'TIC'
 14377          MOVE ZERO          TO CP-CLASS-CODE.
 14378
 14379     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 14380
 14381     MOVE 'R'                   TO CP-RATE-FILE.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 261
* EL050.cbl
 14382     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14383
 14384     IF CP-ERROR-RATE-NOT-FOUND
 14385        IF PB-I-OB
 14386           MOVE ER-2625      TO WS-ERROR
 14387           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14388           GO TO 3299-EDIT-CONTINUE
 14389        ELSE
 14390           MOVE ER-2643      TO WS-ERROR
 14391           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14392           GO TO 3299-EDIT-CONTINUE.
 14393
 14394     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 14395
 14396     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 14397     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 14398
 14399     IF PB-I-LF-REI-RATE = ZERO
 14400         MOVE ER-2643        TO WS-ERROR
 14401         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14402
 14403 3290-CHECK-ALT-REIN-RATE.
 14404
 14405     IF WS-LF-EARNINGS-CALC NOT = 'B'
 14406        GO TO 3290-RATING-CONT.
 14407
 14408     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14409     MOVE '2'                    TO CP-EARNING-METHOD.
 14410     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 14411     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14412     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14413     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14414                                     CP-RATING-BENEFIT-AMT.
 14415     IF CP-STATE-STD-ABBRV = 'OR'
 14416         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14417                                         PB-I-LF-ALT-BENEFIT-AMT.
 14418     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14419        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14420     END-IF
 14421     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14422     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14423     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14424                                    CP-REMAINING-TERM
 14425                                    CP-LOAN-TERM.
 14426     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14427        ADD +1                   TO CP-ORIGINAL-TERM
 14428                                    CP-REMAINING-TERM
 14429                                    CP-LOAN-TERM.
 14430
 14431     MOVE 'R'                   TO CP-RATE-FILE.
 14432     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14433
 14434     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 14435
 14436     IF PB-I-LF-ALT-REI-RATE = ZERO
 14437         MOVE ER-2643            TO WS-ERROR
 14438         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14439
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 262
* EL050.cbl
 14440 3290-RATING-CONT.
 14441
 14442     IF PB-I-OB
 14443*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14444        GO TO 3300-CHECK-AH-RATES.
 14445
 14446 3299-EDIT-CONTINUE.
 14447
 14448     IF  PB-I-MORT-CODE GREATER THAN SPACES
 14449         NEXT SENTENCE
 14450     ELSE
 14451         MOVE ER-2620           TO WS-ERROR
 14452         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14453
 14454 3300-CHECK-AH-RATES.
 14455     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 14456         NEXT SENTENCE
 14457     ELSE
 14458         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14459
 14460     IF ((WS-AH-SPECIAL-CALC-CD = 'E')
 14461        and (not pb-monthly-cert))
 14462                  or
 14463        ((CF-COMPANY-ID = 'DMD') AND
 14464                (NO-DMD-RATING))
 14465         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14466            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14467            CONTINUE
 14468         ELSE
 14469            MOVE ER-2687         TO WS-ERROR
 14470            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14471         END-IF
 14472         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14473         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 14474     END-IF
 14475
 14476     IF PB-I-OB
 14477        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14478
 14479     IF WS-AH-SPECIAL-CALC-CD = 'M'
 14480         MOVE ER-2687             TO WS-ERROR
 14481         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14482         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14483         GO TO 3999-END-EDIT.
 14484
 14485*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 14486     if pb-company-id = 'AHL'
 14487        go to 3300-skip-crit-per
 14488     end-if
 14489     if (pb-i-ah-crit-per not = zeros)
 14490        and (ws-ah-special-calc-cd not = 'C')
 14491        MOVE ER-1572             TO WS-ERROR
 14492        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14493        go to 3300-skip-crit-per
 14494     END-IF
 14495     if (pb-company-id = 'DCC' or 'VPP')
 14496        and (am-dcc-product-code not = spaces)
 14497        go to 3300-skip-crit-per
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 263
* EL050.cbl
 14498     end-if
 14499     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 14500        IF PB-I-AH-CRIT-PER = ZERO
 14501           move ws-ah-max-bens   to pb-i-ah-crit-per
 14502*          MOVE ER-2618       TO WS-ERROR
 14503*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14504*          GO TO 3999-END-EDIT
 14505        END-IF
 14506     END-IF
 14507     if (ws-ah-special-calc-cd = 'C')
 14508        and (pb-i-ah-crit-per <> ws-ah-max-bens)
 14509        MOVE ER-1576             TO WS-ERROR
 14510        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14511     end-if
 14512
 14513     .
 14514 3300-skip-crit-per.
 14515     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14516     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14517     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14518     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14519     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14520     MOVE PB-SV-STATE            TO CP-STATE.
 14521     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14522     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 14523     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 14524*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14525     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14526     MOVE '3'                    TO CP-PROCESS-TYPE.
 14527     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14528     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14529                                    CP-RATING-BENEFIT-AMT.
 14530     IF PB-COMPANY-ID = 'CID'
 14531               OR
 14532        CP-STATE-STD-ABBRV = 'OR'
 14533         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14534                                         PB-I-AH-TERM.
 14535     IF PB-COMPANY-ID = 'DCC' or 'VPP' OR 'CID'
 14536        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 14537           AND (PB-I-POLICY-IS-MONTHLY)
 14538           MOVE PB-I-LF-BENEFIT-AMT
 14539                                 TO CP-NET-BENEFIT-AMT
 14540           move pb-i-ah-premium-amt to cp-original-premium
 14541           add pb-i-lf-premium-amt to cp-original-premium
 14542        END-IF
 14543     END-IF
 14544     MOVE SPACES                 TO CP-BEN-CATEGORY
 14545     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14546        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 14547        EVALUATE TRUE
 14548           WHEN (WS-AH-BEN-CATEGORY = 'G')
 14549              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14550              MOVE PB-I-LF-BENEFIT-AMT
 14551                                 TO CP-RATING-BENEFIT-AMT
 14552              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 14553           WHEN WS-AH-BEN-CATEGORY = 'G'
 14554              MOVE PB-I-UNPAID-CASH-PRICE
 14555                                 TO CP-RATING-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 264
* EL050.cbl
 14556           WHEN WS-AH-BEN-CATEGORY = 'D'
 14557              MOVE WS-AH-PMF-COMM
 14558                                 TO CP-DCC-PMF-COMM
 14559              MOVE PB-I-AH-COMMISSION
 14560                                 TO CP-DCC-ACT-COMM
 14561        END-EVALUATE
 14562     END-IF
 14563     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14564     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14565     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14566     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14567     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14568     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 14569     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14570                                    CP-REMAINING-TERM
 14571                                    WS-WORK-TERM.
 14572     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 14573
 14574     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14575     SET BIN-TO-GREG             TO TRUE.
 14576*    MOVE ' '                    TO DC-OPTION-CODE.
 14577     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14578     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 14579
 14580     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 14581     IF NOT VALID-SKIP-CODE
 14582         MOVE ER-2683            TO WS-ERROR
 14583         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14584         GO TO 3320-RATE-CONTINUE.
 14585
 14586     IF PB-NO-MONTHS-SKIPPED
 14587         GO TO 3320-RATE-CONTINUE.
 14588
 14589     MOVE SPACE TO NUMBER-OF-MONTHS.
 14590
 14591     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14592         MOVE 'S'                TO SK-MO (6).
 14593     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14594         MOVE 'S'                TO SK-MO (7).
 14595     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14596         MOVE 'S'                TO SK-MO (8).
 14597     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14598         MOVE 'S'                TO SK-MO (9).
 14599     IF PB-I-SKIP-CODE = 'A'
 14600         MOVE 'S'                TO SK-MO (10).
 14601
 14602     MOVE 1                      TO SUB2.
 14603     MOVE PB-I-AH-TERM           TO SUB3.
 14604     MOVE WS-MONTH               TO SUB1.
 14605     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14606     GO TO 3320-RATE-CONTINUE.
 14607
 14608 3310-GET-SKIP-MO.
 14609     IF SUB1 = 13
 14610         MOVE 1                  TO SUB1.
 14611
 14612     IF SK-MO (SUB1) = 'S'
 14613         SUBTRACT 1 FROM WS-WORK-TERM.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 265
* EL050.cbl
 14614
 14615     ADD 1 TO SUB2
 14616              SUB1.
 14617
 14618 3320-RATE-CONTINUE.
 14619
 14620     IF WS-WORK-TERM = ZERO
 14621         MOVE 1                  TO WS-WORK-TERM.
 14622
 14623     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14624                                    CP-LOAN-TERM.
 14625
 14626     IF PB-COMPANY-ID EQUAL 'DMD'
 14627         NEXT SENTENCE
 14628     ELSE
 14629         MOVE ZERO               TO PB-I-AH-RATE
 14630                                    PB-I-AH-REI-RATE.
 14631
 14632
 14633     IF PB-COMPANY-ID EQUAL 'CRI'
 14634        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14635
 14636     IF PB-COMPANY-ID = 'CSL'
 14637         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14638         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14639         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14640         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14641
 14642     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14643        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14644           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14645              PB-I-RATE-DEV-PCT-LF
 14646        END-IF
 14647        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14648                                 TO CP-ALTERNATE-BENEFIT
 14649        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14650        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14651        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14652     END-IF
 14653*    if ws-clp-state not = spaces
 14654*       move ws-clp-state to cp-state
 14655*    end-if
 14656     IF (PB-COMPANY-ID = 'CID')
 14657        AND (WS-LF-EARNINGS-CALC = 'B')
 14658        AND (CP-STATE-STD-ABBRV = 'MN')
 14659        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14660     ELSE
 14661        MOVE ' '                 TO CP-AH-BALLOON-SW
 14662     END-IF
 14663     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14664     MOVE 'R'                   TO CP-RATE-FILE.
 14665     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14666
 14667     IF (CP-ERROR-RATE-NOT-FOUND)
 14668        and (not pb-monthly-cert)
 14669        IF PB-I-OB
 14670           MOVE ER-2624          TO WS-ERROR
 14671           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 266
* EL050.cbl
 14672           GO TO 3340-CALCULATE-PREMIUM-AMT
 14673        ELSE
 14674          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14675              NEXT SENTENCE
 14676          ELSE
 14677           MOVE ER-2642          TO WS-ERROR
 14678           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14679           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14680
 14681     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14682        CP-ERROR-DIV-BY-ZERO
 14683           MOVE ER-3782          TO WS-ERROR
 14684           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14685
 14686     IF PB-COMPANY-ID EQUAL 'CRI'
 14687        IF CP-ERROR-NO-LIMITS-CRI
 14688           IF NOT ACCOUNT-AH-CHECKED
 14689              MOVE ER-2607          TO WS-ERROR
 14690              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14691
 14692     IF ACCOUNT-AH-CHECKED
 14693        NEXT SENTENCE
 14694     ELSE
 14695       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14696          MOVE ER-2640           TO WS-ERROR
 14697          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14698
 14699     IF PB-COMPANY-ID = 'CRI'
 14700         IF WS-ERROR = ER-2640
 14701             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14702     IF ACCOUNT-AH-CHECKED
 14703        CONTINUE
 14704     ELSE
 14705        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14706           AND (CP-R-MAX-ATT-AGE > +0)
 14707           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14708           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14709              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14710              MOVE PB-I-AH-EXPIRE-DT
 14711                                 TO DC-BIN-DATE-2
 14712              MOVE '1'           TO DC-OPTION-CODE
 14713              PERFORM 8500-DATE-CONVERT
 14714                                 THRU 8500-EXIT
 14715              IF NO-CONVERSION-ERROR
 14716                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14717                    MOVE ER-2661       TO WS-ERROR
 14718*                   PERFORM 9900-ERROR-FORMAT
 14719*                                THRU 9900-EXIT
 14720                 END-IF
 14721              END-IF
 14722           ELSE
 14723              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14724              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14725                 MOVE ER-2661    TO WS-ERROR
 14726*                PERFORM 9900-ERROR-FORMAT
 14727*                                THRU 9900-EXIT
 14728              ELSE
 14729                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 267
* EL050.cbl
 14730                    MOVE ER-1570 TO WS-ERROR
 14731                    PERFORM 9900-ERROR-FORMAT
 14732                                 THRU 9900-EXIT
 14733                 END-IF
 14734              END-IF
 14735           END-IF
 14736           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14737              MOVE PB-I-JOINT-BIRTHDAY
 14738                                    TO DC-BIN-DATE-1
 14739              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14740              MOVE '1'              TO DC-OPTION-CODE
 14741              PERFORM 8500-DATE-CONVERT
 14742                                    THRU 8500-EXIT
 14743              IF NO-CONVERSION-ERROR
 14744                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14745                    MOVE ER-2661       TO WS-ERROR
 14746*                   PERFORM 9900-ERROR-FORMAT
 14747*                                   THRU 9900-EXIT
 14748                 END-IF
 14749              END-IF
 14750           ELSE
 14751              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14752                (PB-I-AH-TERM / 12)
 14753              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14754                 MOVE ER-2661       TO WS-ERROR
 14755*                PERFORM 9900-ERROR-FORMAT
 14756*                                   THRU 9900-EXIT
 14757              ELSE
 14758                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14759                    MOVE ER-1571 TO WS-ERROR
 14760                    PERFORM 9900-ERROR-FORMAT
 14761                                 THRU 9900-EXIT
 14762                 END-IF
 14763              END-IF
 14764           END-IF
 14765           IF WS-ERROR = ER-2661
 14766              PERFORM 9900-ERROR-FORMAT
 14767                                    THRU 9900-EXIT
 14768           END-IF
 14769        END-IF
 14770     END-IF
 14771*    IF ACCOUNT-AH-CHECKED
 14772*       NEXT SENTENCE
 14773*    ELSE
 14774*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14775*          MOVE ER-2661          TO WS-ERROR
 14776*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14777
 14778     IF ACCOUNT-AH-CHECKED
 14779        NEXT SENTENCE
 14780     ELSE
 14781        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14782           MOVE ER-2663          TO WS-ERROR
 14783           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14784
 14785     IF ACCOUNT-AH-CHECKED OR
 14786        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14787         PB-POLICY-IS-VOIDED
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 268
* EL050.cbl
 14788        NEXT SENTENCE
 14789     ELSE
 14790        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 14791           MOVE ER-2667            TO WS-ERROR
 14792           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14793
 14794     IF PB-COMPANY-ID = 'CRI'
 14795         IF WS-ERROR = ER-2667
 14796             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14797
 14798     IF ACCOUNT-AH-CHECKED
 14799        NEXT SENTENCE
 14800     ELSE
 14801        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14802           MOVE ER-2678            TO WS-ERROR
 14803           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14804
 14805     IF CP-ERROR-RATE-FILE-NOTOPEN
 14806         GO TO 3990-FILES-NOT-OPEN.
 14807
 14808 3321-CONTINUE.
 14809     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14810     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14811     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14812*    IF (PB-COMPANY-ID = 'DCC')
 14813        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14814        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14815                                    PB-I-LF-ALT-PREM-CALC
 14816        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14817        IF WS-AH-BEN-CATEGORY = 'G'
 14818           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14819           + PB-I-ADDL-CLP)
 14820           * (1 + WS-TOL-CLP-PCT)
 14821*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14822        ELSE
 14823           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14824           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14825*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14826        END-IF
 14827        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14828                                 TO PB-I-AH-PREM-CALC
 14829        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14830           MOVE ER-8152          TO WS-ERROR
 14831           PERFORM 9900-ERROR-FORMAT
 14832                                 THRU 9900-EXIT
 14833        ELSE
 14834           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14835                 PB-I-ADDL-CLP)
 14836              MOVE ER-8148       TO WS-ERROR
 14837              PERFORM 9900-ERROR-FORMAT
 14838                                 THRU 9900-EXIT
 14839           END-IF
 14840        END-IF
 14841     END-IF
 14842     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14843        AND (PB-I-POLICY-IS-MONTHLY)
 14844        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14845        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 269
* EL050.cbl
 14846        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14847           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14848        END-IF
 14849     END-IF
 14850     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14851        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14852        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14853        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14854        MOVE ER-2786             TO WS-ERROR
 14855        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14856     END-IF
 14857     MOVE +0                     TO PB-I-AH-CLP
 14858     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14859        evaluate true
 14860           when WS-AH-BEN-CATEGORY = 'D'
 14861              COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT
 14862                * (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14863           when WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14864              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14865           when WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14866              compute ws-cred-union-fees rounded =
 14867                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14868                    pb-i-ah-commission)
 14869              COMPUTE PB-I-AH-CLP =
 14870                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14871        end-evaluate
 14872     END-IF
 14873     MOVE CP-CANCEL-FEE          TO PB-I-CANCEL-FEE
 14874
 14875     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14876         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14877
 14878     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14879         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14880
 14881     if (ws-ah-special-calc-cd = 'E')
 14882        and (pb-monthly-cert)
 14883        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14884     end-if
 14885     IF PB-COMPANY-ID = 'CRI'
 14886         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14887            PB-I-PAYMENT-AMOUNT = ZERO
 14888             NEXT SENTENCE
 14889         ELSE
 14890             COMPUTE PB-I-AH-PREM-CALC =
 14891                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14892                 (CP-PREMIUM-RATE / 100)
 14893             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14894                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14895                                             PB-I-RATE-DEV-PCT-AH.
 14896
 14897     IF (PB-I-AH-RATE  = ZERO)
 14898        and (not pb-monthly-cert)
 14899       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14900           NEXT SENTENCE
 14901       ELSE
 14902         MOVE ER-2642            TO WS-ERROR
 14903         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 270
* EL050.cbl
 14904
 14905     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14906     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14907     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14908     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14909     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14910     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14911
 14912     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14913        AND (WS-AH-BEN-CATEGORY = 'G')
 14914        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14915        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14916        IF CP-DEVIATION-CODE NOT = '000'
 14917           MOVE '000'            TO CP-DEVIATION-CODE
 14918           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14919           IF NO-CP-ERROR
 14920              COMPUTE PB-I-DDF-IU-RATE-UP =
 14921              PB-I-AH-CLP - CP-CALC-PREMIUM
 14922           ELSE
 14923              MOVE ER-3057        TO WS-ERROR
 14924              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14925           END-IF
 14926        END-IF
 14927     END-IF
 14928     .
 14929 3335-EDIT-AH-REIN-NSP-RATE.
 14930     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14931        if WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14932              compute ws-cred-union-fees rounded =
 14933                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14934                    pb-i-ah-commission)
 14935              COMPUTE PB-I-AH-CLP =
 14936                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14937        end-if
 14938     END-IF
 14939     IF AH-REIN-NSP-NOT-USED
 14940         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14941
 14942     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14943     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14944         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14945     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14946     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14947     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14948     MOVE PB-SV-STATE            TO CP-STATE.
 14949     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14950     MOVE ZERO                   TO CP-DEVIATION-CODE
 14951                                    CP-RATE-DEV-PCT.
 14952*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14953     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14954     MOVE '3'                    TO CP-PROCESS-TYPE.
 14955     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14956     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14957                                    CP-RATING-BENEFIT-AMT.
 14958     IF CP-STATE-STD-ABBRV = 'OR'
 14959         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14960                                         PB-I-AH-TERM.
 14961     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 271
* EL050.cbl
 14962     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14963     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14964     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14965     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14966     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14967                                    CP-REMAINING-TERM
 14968                                    WS-WORK-TERM.
 14969     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14970     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14971        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14972     END-IF
 14973     IF  PB-COMPANY-ID = 'TIC'
 14974         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14975            MOVE ZERO TO CP-CLASS-CODE.
 14976
 14977     IF PB-COMPANY-ID NOT = 'TIC'
 14978          MOVE ZERO          TO CP-CLASS-CODE.
 14979
 14980     MOVE ZERO               TO CP-DEVIATION-CODE.
 14981
 14982     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14983
 14984     MOVE ZERO               TO PB-I-AH-REI-RATE.
 14985
 14986     MOVE 'R'                   TO CP-RATE-FILE.
 14987     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14988
 14989     IF CP-ERROR-RATE-NOT-FOUND
 14990         MOVE ER-2645        TO WS-ERROR
 14991         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14992         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14993
 14994     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14995
 14996     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14997     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14998
 14999     IF PB-I-AH-REI-RATE = ZERO
 15000         MOVE ER-2645        TO WS-ERROR
 15001         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15002
 15003
 15004 3340-CALCULATE-PREMIUM-AMT.
 15005
 15006     IF PB-COMPANY-ID = 'NCL'
 15007         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 15008             WS-AH-SPECIAL-CALC-CD = 'O')
 15009             GO TO 3999-END-EDIT.
 15010
 15011     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 15012                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 15013                        'TMS' OR 'GTL' OR 'CID' OR 'DCC' or 'VPP'
 15014                         OR 'AHL'
 15015         NEXT SENTENCE
 15016     ELSE
 15017         IF WS-STATE-ABBREVIATION = 'CT'
 15018             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 15019                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 272
* EL050.cbl
 15020                 COMPUTE PB-I-LF-PREM-CALC =
 15021                                     PB-I-LF-PREM-CALC * .90
 15022                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 15023                                     PB-I-LF-ALT-PREM-CALC * .90
 15024                 COMPUTE PB-I-AH-PREM-CALC =
 15025                                     PB-I-AH-PREM-CALC * .90.
 15026
 15027     IF PB-COMP-LF-PREM
 15028        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 15029        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 15030
 15031     IF PB-COMP-AH-PREM
 15032        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 15033
 15034 3340-CHECK-DCC-TOT-FEES.
 15035     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 15036        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 15037        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 15038        AND (PB-I-POLICY-IS-MONTHLY)
 15039        CONTINUE
 15040     ELSE
 15041        GO TO 3340-EDIT-LF-AH-TOL
 15042     END-IF
 15043     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 15044     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 15045     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 15046        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 15047           PB-I-RATE-DEV-PCT-LF
 15048     END-IF
 15049     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 15050        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 15051           PB-I-RATE-DEV-PCT-AH
 15052     END-IF
 15053     MOVE 'N'                    TO CP-BEN-CATEGORY
 15054     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15055
 15056     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 15057     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 15058     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 15059     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15060     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 15061     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15062     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15063     MOVE '3'                    TO CP-PROCESS-TYPE.
 15064     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15065     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 15066
 15067     MOVE PB-SV-STATE            TO CP-STATE.
 15068     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 15069     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 15070     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 15071     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 15072     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 15073                                    CP-RATING-BENEFIT-AMT.
 15074     IF CP-STATE-STD-ABBRV = 'OR'
 15075         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 15076                                         PB-I-LF-ALT-BENEFIT-AMT.
 15077     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 273
* EL050.cbl
 15078     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 15079     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 15080     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15081     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15082     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15083     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 15084     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 15085     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 15086                                    CP-REMAINING-TERM
 15087                                    CP-LOAN-TERM.
 15088     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 15089        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 15090           PB-I-LF-PREMIUM-AMT
 15091     end-if
 15092
 15093     IF CP-TRUNCATED-LIFE
 15094        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 15095
 15096     IF CP-TERM-IS-DAYS
 15097         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 15098     ELSE
 15099         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15100
 15101     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15102     IF CP-SPECIAL-CALC-CD = 'H'
 15103         MOVE PB-I-LF-ALT-BENEFIT-AMT
 15104                                    TO CP-ALTERNATE-BENEFIT
 15105         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 15106     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 15107     MOVE 'R'                    TO CP-RATE-FILE
 15108     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 15109     IF NOT CP-ERROR-RATE-NOT-FOUND
 15110        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 15111        IF (CP-DCC-LF-RATE NOT = ZEROS)
 15112           AND (CP-BENEFIT-CD (1:1) = 'S')
 15113           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 15114                                    PB-I-LF-PREMIUM-AMT
 15115        END-IF
 15116     ELSE
 15117        MOVE +0                  TO PB-I-TOT-FEES-CALC
 15118     END-IF
 15119     .
 15120 3340-EDIT-LF-AH-TOL.
 15121
 15122***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 15123***    UNSIGN-WRK2    =    AH   DIFFERENCE
 15124***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 15125***
 15126     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 15127         PB-I-AH-PREMIUM-AMT
 15128          GIVING WS-CALC-WORK.
 15129
 15130     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 15131        AND WS-CALC-WORK NOT = ZERO
 15132         MOVE ER-2649            TO WS-ERROR
 15133         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15134
 15135     SUBTRACT PB-I-LF-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 274
* EL050.cbl
 15136             FROM PB-I-LF-PREMIUM-AMT
 15137                 GIVING WS-UNSIGN-WRK1.
 15138
 15139     SUBTRACT PB-I-LF-ALT-PREM-CALC
 15140             FROM PB-I-LF-ALT-PREMIUM-AMT
 15141                 GIVING WS-UNSIGN-WRK4.
 15142
 15143     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 15144                                + WS-UNSIGN-WRK4.
 15145
 15146     SUBTRACT PB-I-AH-PREM-CALC
 15147             FROM PB-I-AH-PREMIUM-AMT
 15148                 GIVING WS-UNSIGN-WRK2.
 15149
 15150******************************************************************
 15151*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 15152******************************************************************
 15153
 15154     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 15155         MOVE ZERO TO WS-UNSIGN-WRK1.
 15156
 15157     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 15158         MOVE ZERO TO WS-UNSIGN-WRK2.
 15159
 15160     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 15161             GIVING WS-UNSIGN-WRK3.
 15162
 15163 3342-CONTINUE.
 15164
 15165     IF (PB-I-LF-RATE = ZERO  AND
 15166         PB-I-AH-RATE = ZERO)
 15167         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 15168            WS-AH-SPECIAL-CALC-CD = 'O'
 15169              NEXT SENTENCE
 15170         ELSE
 15171             GO TO 3345-EDIT-CONTINUE.
 15172
 15173     IF  PB-RECORD-BILL   =  'B' OR  'L'
 15174         NEXT SENTENCE
 15175     ELSE
 15176     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 15177        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 15178           IF (PB-REISSUED-CERT         OR
 15179               PB-POLICY-IS-DECLINED    OR
 15180               PB-POLICY-IS-VOIDED)
 15181              NEXT SENTENCE
 15182           ELSE
 15183              IF WS-PREM-REJECT-SW = SPACE
 15184                 MOVE ER-2652    TO WS-ERROR
 15185                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15186                 GO TO 3344-CHECK-AH
 15187              ELSE
 15188                 MOVE ER-2650    TO WS-ERROR
 15189                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15190                 GO TO 3344-CHECK-AH.
 15191
 15192***
 15193***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 275
* EL050.cbl
 15194***
 15195
 15196     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 15197         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 15198            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 15199             (1 + WS-TOL-LF-PREM-PCT)
 15200         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 15201            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 15202             (1 - WS-TOL-LF-PREM-PCT)
 15203     ELSE
 15204         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 15205         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 15206
 15207***
 15208***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 15209***
 15210
 15211     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 15212         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 15213          WS-TOL-LF-PREM.
 15214
 15215     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 15216         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 15217          WS-TOL-LF-PREM.
 15218
 15219     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 15220        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 15221
 15222     IF PB-REISSUED-CERT
 15223        or PB-POLICY-IS-DECLINED
 15224        or PB-POLICY-IS-VOIDED
 15225        continue
 15226     ELSE
 15227        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15228              > WS-TOL-LF-HIGH-PREM-AMT)
 15229           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15230              < WS-TOL-LF-LOW-PREM-AMT))
 15231                      or
 15232           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15233              > WS-TOL-LF-HIGH-PREM-PCT)
 15234           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15235              < WS-TOL-LF-LOW-PREM-PCT))
 15236           IF WS-PREM-REJECT-SW = SPACE
 15237              MOVE ER-2652       TO WS-ERROR
 15238              PERFORM 9900-ERROR-FORMAT
 15239                                 THRU 9900-EXIT
 15240           ELSE
 15241              MOVE ER-2650       TO WS-ERROR
 15242              PERFORM 9900-ERROR-FORMAT
 15243                                 THRU 9900-EXIT
 15244           end-if
 15245        end-if
 15246     end-if
 15247
 15248*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 15249*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 15250*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15251*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 276
* EL050.cbl
 15252
 15253     IF WS-ERROR  =  ER-2650  OR  ER-2652
 15254        IF (PB-RECORD-BILL   =  'B' OR  'L')
 15255                      OR
 15256           ((PB-COMPANY-ID = 'DCC' or 'VPP')
 15257           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 15258           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15259           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 15260        END-IF
 15261     END-IF
 15262
 15263     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15264        IF WS-COMP-MAX-CAP GREATER THAN +0
 15265           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 15266              IF (PB-REISSUED-CERT         OR
 15267                  PB-POLICY-IS-DECLINED    OR
 15268                  PB-POLICY-IS-VOIDED)
 15269                 NEXT SENTENCE
 15270              ELSE
 15271                  MOVE ER-2646   TO  WS-ERROR
 15272                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15273
 15274 3344-CVL-TOLERANCE-CHECK.
 15275
 15276      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 15277          GO TO 3344-CHECK-AH.
 15278
 15279      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 15280          GO TO 3344-CHECK-AH.
 15281
 15282      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 15283                                     WS-UNSIGN-WRK6.
 15284
 15285      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 15286          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 15287                                 + PB-I-LF-PREMIUM-AMT
 15288                                 - PB-I-LF-PREM-CALC.
 15289
 15290      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 15291          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 15292                                 + PB-I-LF-ALT-PREMIUM-AMT
 15293                                 - PB-I-LF-ALT-PREM-CALC.
 15294
 15295      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 15296          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 15297              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 15298                 MOVE ER-2652    TO  WS-ERROR
 15299                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15300              ELSE
 15301                 MOVE ER-2650    TO  WS-ERROR
 15302                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15303
 15304      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 15305          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 15306              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 15307                 MOVE ER-2652    TO  WS-ERROR
 15308                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15309              ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 277
* EL050.cbl
 15310                 MOVE ER-2650    TO  WS-ERROR
 15311                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15312
 15313 3344-CHECK-AH.
 15314
 15315****************************************************************
 15316***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 15317***
 15318
 15319     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 15320         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 15321             (1 + WS-TOL-AH-PREM-PCT)
 15322         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 15323             (1 - WS-TOL-AH-PREM-PCT)
 15324     ELSE
 15325         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 15326         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 15327
 15328***
 15329***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 15330***
 15331
 15332     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 15333         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 15334
 15335     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 15336         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 15337
 15338     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 15339        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 15340
 15341     IF (PB-REISSUED-CERT)
 15342        OR (PB-POLICY-IS-DECLINED)
 15343        OR (PB-POLICY-IS-VOIDED)
 15344        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 15345        CONTINUE
 15346     ELSE
 15347        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 15348              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 15349                          or
 15350           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 15351              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 15352           IF WS-PREM-REJECT-SW = SPACE
 15353              MOVE ER-3052       TO WS-ERROR
 15354              PERFORM 9900-ERROR-FORMAT
 15355                                 THRU 9900-EXIT
 15356           ELSE
 15357              MOVE ER-3050       TO WS-ERROR
 15358              PERFORM 9900-ERROR-FORMAT
 15359                                 THRU 9900-EXIT
 15360           END-IF
 15361        END-IF
 15362     END-IF
 15363     if (pb-company-id = 'DCC' or 'VPP')
 15364        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 15365        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 15366        and (pb-i-policy-is-monthly)
 15367        compute ws-tol-ah-high-prem-amt =
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 278
* EL050.cbl
 15368           pb-i-tot-fees-calc + ws-tol-ah-prem
 15369        compute ws-tol-ah-low-prem-amt =
 15370           pb-i-tot-fees-calc - ws-tol-ah-prem
 15371        if ws-tol-ah-prem-pct > zeros
 15372           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 15373              (1 + ws-tol-ah-prem-pct)
 15374           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 15375              (1 - ws-tol-ah-prem-pct)
 15376        else
 15377           move +9999999.99      to ws-tol-ah-high-prem-pct
 15378           move +0               to ws-tol-ah-low-prem-pct
 15379        end-if
 15380        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 15381            or
 15382           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 15383                          or
 15384           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 15385           or
 15386           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 15387            move er-3049         to ws-error
 15388           perform 9900-error-format
 15389                                 thru 9900-exit
 15390
 15391        end-if
 15392     end-if
 15393     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 15394         IF  PB-RECORD-BILL   =  'B' OR 'A'
 15395             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15396             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 15397
 15398     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15399        IF WS-COMP-MAX-CAP GREATER THAN +0
 15400           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 15401              IF (PB-REISSUED-CERT         OR
 15402                  PB-POLICY-IS-DECLINED    OR
 15403                  PB-POLICY-IS-VOIDED)
 15404                 NEXT SENTENCE
 15405              ELSE
 15406                  MOVE ER-2646   TO  WS-ERROR
 15407                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15408
 15409     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 15410        (WS-COMP-MAX-CAP EQUAL +0)
 15411           GO TO 3345-EDIT-CONTINUE.
 15412
 15413     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 15414        GREATER THAN WS-COMP-MAX-CAP
 15415           MOVE ER-2646          TO  WS-ERROR
 15416           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15417
 15418 3345-EDIT-CONTINUE.
 15419
 15420*    IF PB-COMPANY-ID    EQUAL    'NCL'
 15421*       IF PB-ENTRY-BATCH   NUMERIC
 15422*          IF PB-ISSUE
 15423*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 15424*          ELSE
 15425*              IF PB-CANCELLATION
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 279
* EL050.cbl
 15426*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 15427
 15428*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15429*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 15430*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 15431*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 15432*        ELSE
 15433*            MOVE  ER-1909            TO  WS-ERROR
 15434*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15435
 15436     IF PB-I-POLICY-ACCEPTED
 15437        IF PB-POLICY-IS-DECLINED  OR
 15438           PB-REISSUED-CERT  OR
 15439           PB-REIN-ONLY-CERT  OR
 15440           PB-POLICY-IS-VOIDED
 15441            MOVE  ER-1891         TO  WS-ERROR
 15442            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15443        ELSE
 15444            MOVE SPACE            TO  PB-BATCH-ENTRY
 15445            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 15446
 15447     IF PB-I-POLICY-DECLINED
 15448        IF PB-REISSUED-CERT  OR
 15449           PB-REIN-ONLY-CERT  OR
 15450           PB-POLICY-IS-VOIDED
 15451            MOVE  ER-1906         TO  WS-ERROR
 15452            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15453        ELSE
 15454            MOVE  'D'             TO  PB-BATCH-ENTRY
 15455                                      PB-I-ENTRY-STATUS.
 15456
 15457     IF PB-I-NEEDS-UNDERWRITING
 15458        IF PB-POLICY-IS-DECLINED OR
 15459           PB-REISSUED-CERT  OR
 15460           PB-REIN-ONLY-CERT  OR
 15461           PB-POLICY-IS-VOIDED
 15462            MOVE  ER-1907         TO  WS-ERROR
 15463            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15464        ELSE
 15465            MOVE 'U'              TO  PB-BATCH-ENTRY
 15466                                      PB-I-ENTRY-STATUS.
 15467
 15468     IF PB-NEEDS-UNDERWRITING
 15469        MOVE  ER-1901             TO  WS-ERROR
 15470        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15471     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15472        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 15473        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 15474        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15475           AND (NOT WS-LF-CASH))
 15476                           OR
 15477           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15478           AND (NOT WS-AH-CASH)))
 15479                       AND
 15480           (PB-I-ENTRY-STATUS NOT = '5')
 15481           MOVE 'M'              TO PB-BATCH-ENTRY
 15482                                    PB-I-ENTRY-STATUS
 15483        END-IF
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 280
* EL050.cbl
 15484     END-IF
 15485     move pending-business       to ws-passed-erpndb
 15486     move ' '                    to ws-exceed-limit-yn
 15487     perform 7780-call-agg       thru 7780-exit
 15488*    display ' el050 exceed ' ws-exceed-limit-yn
 15489     if ws-exceed-limit-yn = 'Y'
 15490        MOVE  ER-9813            TO WS-ERROR
 15491        move 'Y'                 to ws-9813-sw
 15492        PERFORM  9900-ERROR-FORMAT
 15493                                 THRU 9900-EXIT
 15494     end-if
 15495     if (PB-EXCEEDED-LIMIT-FORCED)
 15496        and (ws-9813-sw = 'Y')
 15497        subtract +1 from PB-NO-OF-ERRORS
 15498        move er-9823             to ws-error
 15499        PERFORM  9900-ERROR-FORMAT
 15500                                 THRU 9900-EXIT
 15501     end-if
 15502     IF  PB-COMPANY-ID NOT = 'NCL'
 15503         GO TO 3999-END-EDIT.
 15504
 15505     IF PB-REISSUED-CERT  OR
 15506        PB-POLICY-IS-DECLINED  OR
 15507        PB-POLICY-IS-VOIDED  OR
 15508        PB-I-OB
 15509         GO TO 3999-END-EDIT.
 15510
 15511     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 15512         MOVE  ER-2644            TO  WS-ERROR
 15513         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15514         GO TO 3999-END-EDIT.
 15515
 15516     MOVE 'N'                     TO  FORM-MASTER-SW.
 15517     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 15518
 15519     IF NOT FORM-MASTER-FOUND
 15520         GO TO 3999-END-EDIT.
 15521
 15522     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 15523                                      FORM-MASTER-AH-SW.
 15524
 15525     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15526         MOVE  +1                 TO SUB6
 15527         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 15528
 15529     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15530         MOVE  +1                 TO SUB6
 15531         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 15532
 15533     IF LF-FORM-MASTER-FOUND  OR
 15534        AH-FORM-MASTER-FOUND
 15535         GO TO 3360-CHECK-FORM-LIMITS
 15536     ELSE
 15537         GO TO 3999-END-EDIT.
 15538
 15539******************************************************************
 15540*                  3350-GET-ERFORM                               *
 15541*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 281
* EL050.cbl
 15542*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 15543******************************************************************
 15544
 15545 3350-GET-ERFORM.
 15546
 15547     IF  WK-FORM-ADDR      EQUAL    ZEROS
 15548         GO TO  3350-ERFORM-GETMAIN.
 15549
 15550     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 15551     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 15552     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 15553     MOVE 'Y'                     TO FORM-MASTER-SW.
 15554
 15555     IF PB-CANCELLATION
 15556         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15557            PB-SV-STATE          EQUAL   FO-STATE       AND
 15558            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15559              GO TO 3350-EXIT
 15560         ELSE
 15561             NEXT SENTENCE
 15562     ELSE
 15563         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15564            PB-SV-STATE          EQUAL   FO-STATE       AND
 15565            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15566              GO TO 3350-EXIT.
 15567
 15568 3350-ERFORM-GETMAIN.
 15569
 15570     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 15571     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 15572
 15573 3350-ERFORM-READ.
 15574
 15575     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 15576     MOVE  PB-SV-STATE            TO  FORM-STATE.
 15577     IF PB-CANCELLATION
 15578         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 15579     ELSE
 15580         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 15581     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 15582
 15583     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 15584
 15585     IF FORM-MASTER-FOUND
 15586       IF PB-CANCELLATION
 15587          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15588             PB-SV-STATE          EQUAL   FO-STATE       AND
 15589             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15590              GO  TO 3350-EXIT
 15591          ELSE
 15592              NEXT SENTENCE
 15593       ELSE
 15594          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15595             PB-SV-STATE          EQUAL   FO-STATE       AND
 15596             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15597              GO  TO 3350-EXIT.
 15598
 15599     MOVE  'N'                    TO  FORM-MASTER-SW.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 282
* EL050.cbl
 15600     MOVE  ER-1895                TO  WS-ERROR.
 15601     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15602
 15603 3350-EXIT.
 15604      EXIT.
 15605
 15606******************************************************************
 15607*                  3355-EDIT-FORM-LF-BENEFITS                    *
 15608*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 15609*   VALID FOR THE POLICY FORM USED.                              *
 15610******************************************************************
 15611
 15612 3355-EDIT-FORM-LF-BENEFITS.
 15613
 15614     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15615        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15616         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 15617         GO TO   3355-EXIT.
 15618
 15619     IF  SUB6    LESS THAN   +40
 15620         ADD  +1      TO  SUB6
 15621         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 15622
 15623     MOVE  ER-1896         TO  WS-ERROR.
 15624     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15625
 15626 3355-EXIT.
 15627      EXIT.
 15628
 15629******************************************************************
 15630*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15631*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15632*   VALID FOR THE POLICY FORM USED.                              *
 15633******************************************************************
 15634
 15635 3356-EDIT-FORM-AH-BENEFITS.
 15636
 15637     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15638        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15639         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 15640         GO TO  3356-EXIT.
 15641
 15642      IF  SUB6    LESS THAN     +40
 15643          ADD  +1      TO  SUB6
 15644          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15645
 15646     MOVE  ER-1897         TO  WS-ERROR.
 15647     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15648
 15649 3356-EXIT.
 15650      EXIT.
 15651
 15652******************************************************************
 15653*                  3357-BENEFIT-SEARCH                           *
 15654*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15655*   CANCELLATIONS ONLY.                                          *
 15656******************************************************************
 15657 3357-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 283
* EL050.cbl
 15658     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15659         MOVE +1                          TO SUB6
 15660         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15661
 15662     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15663         MOVE +1                          TO SUB6
 15664         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15665
 15666 3357-EXIT.
 15667     EXIT.
 15668
 15669******************************************************************
 15670*                  3358-BENEFIT-LIFE-SEARCH                      *
 15671*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15672*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15673*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15674******************************************************************
 15675 3358-BENEFIT-LIFE-SEARCH.
 15676     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15677       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15678         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15679           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15680              IF FO-PLAN-REFUND-METHOD (SUB6)
 15681                     IS GREATER THAN SPACES
 15682                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15683                                          WS-LF-REFUND-CALC
 15684                 GO TO 3358-EXIT.
 15685
 15686     IF SUB6 LESS THAN +40
 15687         ADD +1                 TO SUB6
 15688         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15689
 15690 3358-EXIT.
 15691     EXIT.
 15692******************************************************************
 15693*                  3359-BENEFIT-AH-SEARCH                        *
 15694*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15695*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15696*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15697******************************************************************
 15698 3359-BENEFIT-AH-SEARCH.
 15699     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15700       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15701         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15702           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15703              IF FO-PLAN-REFUND-METHOD (SUB6)
 15704                      IS GREATER THAN SPACES
 15705                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15706                                          WS-AH-REFUND-CALC
 15707                 GO TO 3359-EXIT.
 15708
 15709     IF SUB6 LESS THAN +40
 15710         ADD +1                 TO SUB6
 15711         GO TO 3359-BENEFIT-AH-SEARCH.
 15712
 15713 3359-EXIT.
 15714     EXIT.
 15715
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 284
* EL050.cbl
 15716******************************************************************
 15717*                  3360-CHECK-FORM-LIMITS                        *
 15718*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15719*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15720******************************************************************
 15721
 15722 3360-CHECK-FORM-LIMITS.
 15723
 15724     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15725         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15726
 15727     IF NOT LF-FORM-MASTER-FOUND
 15728         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15729
 15730 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15731
 15732     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15733       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15734        WS-LF-JOINT-INDICATOR = 'J'  AND
 15735        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15736         IF PB-COMPANY-ID = 'NCL'
 15737            MOVE  ER-1911          TO  WS-ERROR
 15738            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15739         ELSE
 15740            MOVE  ER-1892          TO  WS-ERROR
 15741            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15742
 15743 3360-CHECK-FORM-LF-ATT-AGE.
 15744
 15745     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15746
 15747     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15748         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15749         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15750            IF PB-COMPANY-ID = 'NCL'
 15751                MOVE  ER-1913      TO  WS-ERROR
 15752                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15753            ELSE
 15754                MOVE  ER-1894      TO  WS-ERROR
 15755                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15756
 15757 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15758
 15759     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15760         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15761         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15762            IF PB-COMPANY-ID = 'NCL'
 15763                MOVE  ER-1914      TO  WS-ERROR
 15764                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15765            ELSE
 15766                MOVE  ER-1899      TO  WS-ERROR
 15767                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15768
 15769 3360-CHECK-FORM-LF-TERM-BAMT.
 15770
 15771     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15772         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15773         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 285
* EL050.cbl
 15774           IF  PB-COMPANY-ID = 'NCL'
 15775               MOVE  ER-1916       TO  WS-ERROR
 15776               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15777           ELSE
 15778               MOVE  ER-1902       TO  WS-ERROR
 15779               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15780
 15781     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15782                                    PB-I-LF-ALT-BENEFIT-AMT.
 15783
 15784     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15785         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15786         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15787             IF  PB-COMPANY-ID = 'NCL'
 15788                 MOVE  ER-1918     TO  WS-ERROR
 15789                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15790             ELSE
 15791                 MOVE  ER-1904     TO  WS-ERROR
 15792                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15793
 15794******************************************************************
 15795*                  3360-CHECK-FORM-AH-LIMITS                     *
 15796*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15797*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15798******************************************************************
 15799
 15800 3360-CHECK-FORM-AH-LIMITS.
 15801
 15802     IF NOT AH-FORM-MASTER-FOUND
 15803         GO TO 3999-END-EDIT.
 15804
 15805 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15806
 15807     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15808       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15809        WS-AH-JOINT-INDICATOR = 'J'  AND
 15810        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15811         IF PB-COMPANY-ID = 'NCL'
 15812            MOVE  ER-1912          TO  WS-ERROR
 15813            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15814         ELSE
 15815            MOVE  ER-1893          TO  WS-ERROR
 15816            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15817
 15818 3360-CHECK-FORM-AH-ATT-AGE.
 15819
 15820     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15821
 15822     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15823         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15824         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15825            IF PB-COMPANY-ID = 'NCL'
 15826                MOVE  ER-1913      TO  WS-ERROR
 15827                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15828            ELSE
 15829                MOVE  ER-1894      TO  WS-ERROR
 15830                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15831
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 286
* EL050.cbl
 15832 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15833
 15834     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15835         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15836         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15837            IF PB-COMPANY-ID = 'NCL'
 15838                MOVE  ER-1915      TO  WS-ERROR
 15839                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15840            ELSE
 15841                MOVE  ER-1900      TO  WS-ERROR
 15842                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15843
 15844 3360-CHECK-FORM-AH-TERM-BAMT.
 15845
 15846     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15847         FO-AH-MAX-TERM    GREATER THAN  +0
 15848         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15849             IF  PB-COMPANY-ID = 'NCL'
 15850                 MOVE  ER-1917     TO  WS-ERROR
 15851                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15852             ELSE
 15853                  MOVE  ER-1903    TO  WS-ERROR
 15854                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15855
 15856     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15857         FO-MAX-AH-AMT    GREATER THAN  +0
 15858         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15859             IF  PB-COMPANY-ID = 'NCL'
 15860                 MOVE  ER-1919     TO  WS-ERROR
 15861                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15862             ELSE
 15863                 MOVE  ER-1905     TO  WS-ERROR
 15864                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15865
 15866     GO TO 3999-END-EDIT.
 15867
 15868******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 287
* EL050.cbl
 15870 3400-edit-vin.
 15871
 15872     move spaces                 to hldi-pass-area
 15873     MOVE PB-I-VIN               TO WS-WORK-VIN
 15874     MOVE +8                     TO V2
 15875     MOVE ZEROS                  TO WS-VIN-TOTAL
 15876     PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15877      (V1 > 17)
 15878        IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 15879           MOVE ER-3825          TO WS-ERROR
 15880           PERFORM 9900-ERROR-FORMAT
 15881                                 THRU 9900-EXIT
 15882        ELSE
 15883           IF V1 = 8
 15884              MOVE 10            TO V2
 15885           END-IF
 15886           IF V1 = 9
 15887              MOVE 0             TO V2
 15888           END-IF
 15889           IF V1 = 10
 15890              MOVE 9             TO V2
 15891           END-IF
 15892           IF WS-WORK-VIN (V1:1) NUMERIC
 15893              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15894               + (WS-WORK-VIN-N (V1) * V2)
 15895           ELSE
 15896              MOVE WS-WORK-VIN (V1:1)
 15897                            TO WS-HEX-BYTE
 15898              COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 15899              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15900               + (WS-NUM (V3) * V2)
 15901           END-IF
 15902           COMPUTE V2 = V2 - 1
 15903        END-IF
 15904     END-PERFORM
 15905     MOVE ZEROS                  TO WS-VIN-REMAINDER
 15906     DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 15907        REMAINDER WS-VIN-REMAINDER
 15908     IF ((WS-WORK-VIN (9:1) = 'X')
 15909        AND (WS-VIN-REMAINDER = 10))
 15910                OR
 15911        (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 15912        if pb-company-id = 'VPP'
 15913           perform 3410-check-with-hldi
 15914                                 thru 3410-exit
 15915        end-if
 15916     ELSE
 15917        IF WS-WORK-VIN (1:1) > 0 AND < 6
 15918           MOVE ER-3826          TO WS-ERROR
 15919           PERFORM 9900-ERROR-FORMAT
 15920                                 THRU 9900-EXIT
 15921        ELSE
 15922           MOVE ER-3827          TO WS-ERROR
 15923           PERFORM 9900-ERROR-FORMAT
 15924                                 THRU 9900-EXIT
 15925        END-IF
 15926     END-IF
 15927
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 288
* EL050.cbl
 15928     .
 15929 3400-exit.
 15930     exit.
 15931 3410-check-with-hldi.
 15932     move spaces                 to hldi-pass-area
 15933     move pb-i-vin               to pa-vin
 15934     perform 7785-call-hldi      thru 7785-exit
 15935*    display 'PA-VIN        ' PA-VIN
 15936*    display 'PA-ErrorCode  ' PA-ErrorCode
 15937*    display 'PA-ErrorDesc  ' PA-ErrorDesc
 15938*    display 'PA-ModelYear  ' PA-ModelYear
 15939*    display 'PA-MakeName   ' PA-MakeName
 15940*    display 'PA-ModelName  ' PA-ModelName
 15941*    display 'PA-SeriesName ' PA-SeriesName
 15942     if pa-errorcode (1:1) not = '0'
 15943        move spaces              to hldi-pass-area
 15944        move pb-i-vin            to pa-vin
 15945*       move pa-errordesc        to pa-seriesname
 15946*       perform 7786-call-hldim  thru 7786-exit
 15947*       display 'PA-VIN        ' PA-VIN
 15948*       display 'PA-ErrorCode  ' PA-ErrorCode
 15949*       display 'PA-ErrorDesc  ' PA-ErrorDesc
 15950*       display 'PA-ModelYear  ' PA-ModelYear
 15951*       display 'PA-MakeName   ' PA-MakeName
 15952*       display 'PA-ModelName  ' PA-ModelName
 15953*       display 'PA-SeriesName ' PA-SeriesName
 15954     end-if
 15955     .
 15956 3410-exit.
 15957     exit.
 15958******************************************************************
 15959*                  E D I T   C A N C E L                         *
 15960******************************************************************
 15961
 15962 3700-EDIT-CANCEL.
 15963     IF PB-COMPANY-ID = 'DMD'
 15964         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15965                                         WS-RES-MUNI-TAX
 15966                                         PB-CI-STATE-TAX
 15967                                         PB-CI-MUNI-TAX
 15968         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15969
 15970*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15971*       IF PB-ENTRY-BATCH  NUMERIC
 15972*          IF PB-CANCELLATION
 15973*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15974*          ELSE
 15975*             IF PB-ISSUE
 15976*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15977
 15978     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15979        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15980     END-IF
 15981*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15982*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15983
 15984     IF CM-ENTRY-STATUS = 'V'
 15985        MOVE ER-2780             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 289
* EL050.cbl
 15986        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15987        GO TO 3999-END-EDIT.
 15988
 15989     IF CM-ENTRY-STATUS = 'D'
 15990        MOVE ER-2781             TO WS-ERROR
 15991        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15992        GO TO 3999-END-EDIT.
 15993
 15994     IF CM-ENTRY-STATUS = 'U'
 15995        MOVE ER-2782             TO WS-ERROR
 15996        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15997
 15998***************************************************************
 15999*                                                             *
 16000*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 16001*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 16002*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 16003*   OF ANOTHER COVERAGE.                                      *
 16004*                                                             *
 16005***************************************************************
 16006
 16007     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 16008                                    PB-C-AH-CANCEL-VOID-SW.
 16009
 16010     IF PB-C-LF-CANCEL-AMT = ZERO
 16011        NEXT SENTENCE
 16012     ELSE
 16013        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16014           AND
 16015           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16016               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 16017               MOVE ER-2745           TO WS-ERROR
 16018               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16019
 16020     IF PB-C-AH-CANCEL-AMT = ZERO
 16021        NEXT SENTENCE
 16022     ELSE
 16023        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16024           AND
 16025           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 16026               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 16027               MOVE ER-2745           TO WS-ERROR
 16028               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16029
 16030     IF WS-LF-EARNINGS-CALC = '4'
 16031        MOVE '4'                   TO WS-LF-REFUND-CALC.
 16032
 16033     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 16034     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 16035     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 16036     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 16037     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 16038     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 16039
 16040     MOVE ZERO                     TO PB-C-LF-REF-CALC
 16041                                      PB-C-AH-REF-CALC.
 16042     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 16043
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 290
* EL050.cbl
 16044******************************************************************
 16045*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 16046*             TO VALIDATE COVERAGE.                              *
 16047******************************************************************
 16048
 16049     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 16050        PB-C-LF-CANCEL-AMT = ZEROS
 16051          MOVE 'N'                 TO WS-LF-CANCEL-SW
 16052      ELSE
 16053          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 16054
 16055     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 16056        PB-C-AH-CANCEL-AMT = ZEROS
 16057          MOVE 'N'                 TO WS-AH-CANCEL-SW
 16058      ELSE
 16059          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 16060
 16061     EVALUATE TRUE
 16062         WHEN PB-CANCEL-FORCE             OR
 16063              PB-CANCEL-DATE-FORCED       OR
 16064              PB-FORCE-OFF
 16065                  IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 16066                     MOVE CM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 16067                  END-IF
 16068         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 16069               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 16070              (PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP')
 16071                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 16072         WHEN OTHER
 16073              IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 16074                 MOVE ER-2794              TO WS-ERROR
 16075              ELSE
 16076                 MOVE ER-2749              TO WS-ERROR
 16077              END-IF
 16078              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16079     END-EVALUATE.
 16080
 16081
 16082*    IF  PB-COMPANY-ID    EQUAL    'HER'
 16083*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 16084*            MOVE  ER-1909            TO  WS-ERROR
 16085*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 16086*        ELSE
 16087*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 16088
 16089     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 16090     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 16091        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 16092     ELSE
 16093        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 16094     END-IF
 16095     .
 16096 3705-EDIT-CANCEL-DT.
 16097
 16098     IF LF-COVERAGE-CANCELLED
 16099        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16100         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 16101         MOVE WS-CURRENT-MONTH-END
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 291
* EL050.cbl
 16102                                 TO DC-BIN-DATE-2
 16103         SET ELAPSED-BETWEEN-BIN TO TRUE
 16104*        MOVE 1                  TO DC-OPTION-CODE
 16105         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16106         IF DATE-CONVERSION-ERROR
 16107            NEXT SENTENCE
 16108          ELSE
 16109             IF DC-ELAPSED-DAYS GREATER +180
 16110                IF PB-CANCEL-DATE-FORCED  OR
 16111                   PB-CANCEL-DATE-FORCED-NO-FEE
 16112                      MOVE ER-2751  TO WS-ERROR
 16113                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16114                 ELSE
 16115                   MOVE ER-2752  TO WS-ERROR
 16116                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16117
 16118     IF AH-COVERAGE-CANCELLED
 16119        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16120         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 16121         MOVE WS-CURRENT-MONTH-END
 16122                                 TO DC-BIN-DATE-2
 16123         SET ELAPSED-BETWEEN-BIN TO TRUE
 16124*        MOVE 1                  TO DC-OPTION-CODE
 16125         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16126         IF DATE-CONVERSION-ERROR
 16127            NEXT SENTENCE
 16128          ELSE
 16129             IF DC-ELAPSED-DAYS GREATER +180
 16130                IF PB-CANCEL-DATE-FORCED OR
 16131                   PB-CANCEL-DATE-FORCED-NO-FEE
 16132                      MOVE ER-2751  TO WS-ERROR
 16133                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16134                 ELSE
 16135                   MOVE ER-2752  TO WS-ERROR
 16136                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16137
 16138     IF WS-ERROR = ER-2752
 16139        AND (PB-COMPANY-ID = 'ABL'
 16140         OR  PB-COMPANY-ID = 'FGL'
 16141         OR  PB-COMPANY-ID = 'IST'
 16142         OR  PB-COMPANY-ID = 'JHL'
 16143         OR  PB-COMPANY-ID = 'LAP'
 16144         OR  PB-COMPANY-ID = 'LBL'
 16145         OR  PB-COMPANY-ID = 'NCB'
 16146         OR  PB-COMPANY-ID = 'NLI'
 16147         OR  PB-COMPANY-ID = 'OFI'
 16148         OR  PB-COMPANY-ID = 'PLI'
 16149         OR  PB-COMPANY-ID = 'TAO'
 16150         OR  PB-COMPANY-ID = 'TIC'
 16151         OR  PB-COMPANY-ID = 'HER'
 16152         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 16153         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 16154            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 16155            MOVE ER-2762     TO WS-ERROR
 16156            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16157
 16158     IF LF-COVERAGE-CANCELLED
 16159        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 292
* EL050.cbl
 16160        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 16161             MOVE ER-2733         TO WS-ERROR
 16162             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16163
 16164     IF AH-COVERAGE-CANCELLED
 16165        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16166        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 16167              MOVE ER-2733        TO WS-ERROR
 16168              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16169
 16170     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 16171        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 16172        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 16173           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 16174            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 16175              IF PB-COMPANY-ID NOT = 'LAP'
 16176               MOVE ER-2704            TO WS-ERROR
 16177               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16178
 16179     IF CERT-WAS-NOT-FOUND
 16180         GO TO 3999-END-EDIT.
 16181
 16182     IF PB-COMPANY-ID EQUAL 'CDC'
 16183        IF LF-COVERAGE-CANCELLED
 16184           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16185            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 16186            MOVE PB-C-LF-CANCEL-DT
 16187                                 TO DC-BIN-DATE-2
 16188            SET ELAPSED-BETWEEN-BIN TO TRUE
 16189*           MOVE 1               TO DC-OPTION-CODE
 16190            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16191            IF DATE-CONVERSION-ERROR
 16192               NEXT SENTENCE
 16193             ELSE
 16194                IF DC-ELAPSED-DAYS GREATER +60
 16195                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 16196
 16197     IF PB-COMPANY-ID EQUAL 'CDC'
 16198        IF AH-COVERAGE-CANCELLED
 16199           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16200            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 16201            MOVE PB-C-AH-CANCEL-DT
 16202                                 TO DC-BIN-DATE-2
 16203            MOVE +0              TO DC-ELAPSED-DAYS
 16204                                    DC-ELAPSED-MONTHS
 16205            SET ELAPSED-BETWEEN-BIN  TO TRUE
 16206*           MOVE 1               TO DC-OPTION-CODE
 16207            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16208            IF DATE-CONVERSION-ERROR
 16209               NEXT SENTENCE
 16210             ELSE
 16211                IF DC-ELAPSED-DAYS GREATER +60
 16212                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 16213
 16214     MOVE +0                     TO DC-ELAPSED-DAYS
 16215                                    DC-ELAPSED-MONTHS.
 16216
 16217     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 293
* EL050.cbl
 16218        (WS-AH-SPECIAL-CALC-CD = 'Z')
 16219          MOVE 'Z'                TO PB-CI-OB-FLAG
 16220          MOVE ER-2767            TO WS-ERROR
 16221          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16222          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16223          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16224          GO TO 3775-OVER-REF-CHK
 16225        ELSE
 16226          MOVE ZEROS              TO PB-CI-LIVES
 16227                                     PB-C-LIVES
 16228          IF PB-CI-OB-FLAG NOT = 'B'
 16229             MOVE SPACE           TO PB-CI-OB-FLAG.
 16230
 16231     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 16232         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 16233     ELSE
 16234         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 16235
 16236     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 16237        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 16238            MOVE ER-2760         TO WS-ERROR
 16239            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16240
 16241     IF LF-COVERAGE-CANCELLED
 16242        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16243         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 16244            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 16245               MOVE ER-2774       TO WS-ERROR
 16246               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16247
 16248     IF AH-COVERAGE-CANCELLED
 16249        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16250         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 16251            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 16252               MOVE ER-2775       TO WS-ERROR
 16253               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16254
 16255     IF LF-COVERAGE-CANCELLED
 16256        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16257         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 16258            MOVE ER-2776         TO WS-ERROR
 16259            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16260
 16261     IF AH-COVERAGE-CANCELLED
 16262        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16263         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 16264            MOVE ER-2777         TO WS-ERROR
 16265            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16266
 16267     IF LF-COVERAGE-CANCELLED
 16268        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16269        if pb-ci-lf-expire-dt = low-values or spaces
 16270           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 16271           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 16272           MOVE PB-CI-EXTENTION-DAYS
 16273                                 TO DC-ELAPSED-DAYS
 16274           SET BIN-PLUS-ELAPSED  TO TRUE
 16275           PERFORM 8500-DATE-CONVERT
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 294
* EL050.cbl
 16276                                 THRU 8500-EXIT
 16277           IF DATE-CONVERSION-ERROR
 16278              move low-values    to dc-bin-date-2
 16279           end-if
 16280        else
 16281           move pb-ci-lf-expire-dt
 16282                                 to dc-bin-date-2
 16283        end-if
 16284        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 16285           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16286                             OR  'FIA'
 16287              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 16288           ELSE
 16289              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16290              MOVE ER-2731       TO WS-ERROR
 16291              PERFORM 9900-ERROR-FORMAT
 16292                                 THRU 9900-EXIT
 16293           end-if
 16294        end-if
 16295     end-if
 16296*    IF LF-COVERAGE-CANCELLED
 16297*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16298*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 16299*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 16300*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 16301*        SET BIN-PLUS-ELAPSED      TO TRUE
 16302*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16303*        IF DATE-CONVERSION-ERROR
 16304*           NEXT SENTENCE
 16305*         ELSE
 16306*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 16307*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16308*                            OR  'FIA'
 16309*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 16310*              ELSE
 16311*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16312*               MOVE ER-2731       TO WS-ERROR
 16313*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16314     .
 16315 3705-EDIT-AH-CANCEL-DT.
 16316     IF AH-COVERAGE-CANCELLED
 16317        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16318        if pb-ci-AH-expire-dt = low-values or spaces
 16319           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 16320           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 16321           MOVE PB-CI-EXTENTION-DAYS
 16322                                 TO DC-ELAPSED-DAYS
 16323           SET BIN-PLUS-ELAPSED  TO TRUE
 16324           PERFORM 8500-DATE-CONVERT
 16325                                 THRU 8500-EXIT
 16326           IF DATE-CONVERSION-ERROR
 16327              move low-values    to dc-bin-date-2
 16328           end-if
 16329        else
 16330           move pb-ci-ah-expire-dt
 16331                                 to dc-bin-date-2
 16332        end-if
 16333        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 295
* EL050.cbl
 16334           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16335                             OR  'FIA'
 16336              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 16337           ELSE
 16338              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16339              MOVE ER-2771       TO WS-ERROR
 16340              PERFORM 9900-ERROR-FORMAT
 16341                                 THRU 9900-EXIT
 16342           end-if
 16343        end-if
 16344     end-if
 16345*    IF AH-COVERAGE-CANCELLED
 16346*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16347*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 16348*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 16349*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 16350**       MOVE 6                    TO DC-OPTION-CODE
 16351*        SET BIN-PLUS-ELAPSED      TO TRUE
 16352*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16353*        IF DATE-CONVERSION-ERROR
 16354*           NEXT SENTENCE
 16355*         ELSE
 16356*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 16357*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16358*                             OR 'FIA'
 16359*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 16360*             ELSE
 16361*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16362*              MOVE ER-2771       TO WS-ERROR
 16363*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16364     .
 16365 3705-EDIT-CONTINUED.
 16366
 16367*    IF LF-COVERAGE-CANCELLED
 16368*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16369*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 16370*            MOVE ER-2727         TO WS-ERROR
 16371*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16372*
 16373*    IF AH-COVERAGE-CANCELLED
 16374*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16375*        IF PB-COMPANY-ID = 'ACE'
 16376*           MOVE ER-2727        TO WS-ERROR
 16377*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16378*        ELSE
 16379*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 16380*              MOVE ER-2727     TO WS-ERROR
 16381*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16382
 16383     IF PB-COMPANY-ID = 'ACE'
 16384       IF AH-COVERAGE-CANCELLED
 16385         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16386           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 16387              MOVE ER-2732      TO WS-ERROR
 16388              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16389
 16390     IF PB-COMPANY-ID      EQUAL   'HER'
 16391        IF WS-ERROR        EQUAL   ER-2727
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 296
* EL050.cbl
 16392            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 16393            MOVE  ER-2725          TO  WS-ERROR
 16394            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 16395
 16396     IF PB-C-CLAIM-CREATED-CANCEL
 16397            MOVE ER-2748         TO WS-ERROR
 16398            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16399
 16400     IF PB-C-LAST-NAME NOT = SPACES
 16401         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 16402            MOVE ER-2747         TO WS-ERROR
 16403            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16404
 16405 3710-EDIT-LUMP-SUM-PRIOR.
 16406
 16407     IF AH-COVERAGE-CANCELLED
 16408         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16409             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 16410                MOVE ER-2735    TO WS-ERROR
 16411                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16412
 16413     IF LF-COVERAGE-CANCELLED
 16414         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16415             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 16416                MOVE ER-2735    TO WS-ERROR
 16417                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16418
 16419 3710-EDIT-PRIOR-DEATH.
 16420
 16421*    IF LF-COVERAGE-CANCELLED
 16422*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16423*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16424*           (NOT PB-CI-OB)
 16425*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 16426*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 16427*                   MOVE ER-2732  TO WS-ERROR
 16428*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16429*
 16430*    IF AH-COVERAGE-CANCELLED
 16431*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16432*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16433*           (NOT PB-CI-OB)
 16434*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 16435*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 16436*                   MOVE ER-2732  TO WS-ERROR
 16437*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16438
 16439     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 16440         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 16441            (NOT PB-COMP-LF-CANCEL)
 16442             NEXT SENTENCE
 16443         ELSE
 16444           IF PB-C-LF-CANCEL-VOIDED
 16445              NEXT SENTENCE
 16446           ELSE
 16447              MOVE ER-2753      TO WS-ERROR
 16448              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16449
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 297
* EL050.cbl
 16450     IF CANCEL-FUTURE-DT
 16451         GO TO 3999-END-EDIT.
 16452
 16453 3715-GET-REMAIN-TERM-LF.
 16454
 16455     IF NO-LF-BENEFIT-MATCH  OR
 16456        WS-LF-BENEFIT-CD = ZEROS
 16457        GO TO 3730-GET-AH-REMAIN-TERM.
 16458
 16459     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 16460     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16461     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16462     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 16463     MOVE PB-SV-STATE            TO CP-STATE.
 16464     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16465     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 16466     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16467     MOVE '2'                    TO CP-PROCESS-TYPE.
 16468     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16469     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16470     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16471     IF (PB-COMPANY-ID = 'CID')
 16472        AND (CP-STATE-STD-ABBRV = 'WI')
 16473        MOVE '7'                 TO CP-REM-TERM-METHOD
 16474        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16475     ELSE
 16476        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16477        MOVE WS-REM-TRM-CALC-OPTION
 16478                                 TO CP-REM-TRM-CALC-OPTION
 16479     END-IF
 16480**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 16481     IF (PB-COMPANY-ID = 'CID')
 16482        AND (CP-STATE-STD-ABBRV = 'MO')
 16483        AND (PB-CERT-EFF-DT >= X'9B41')
 16484        AND (PB-CERT-EFF-DT <= X'A2FB')
 16485        MOVE '7'                 TO CP-REM-TERM-METHOD
 16486        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16487     END-IF
 16488     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 16489                                    CP-LOAN-TERM.
 16490     IF CP-TRUNCATED-LIFE
 16491        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 16492
 16493     IF CP-TERM-IS-DAYS
 16494         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 16495     ELSE
 16496         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16497
 16498     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 16499
 16500     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16501
 16502     IF LF-COVERAGE-CANCELLED
 16503        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 16504        NEXT SENTENCE
 16505      ELSE
 16506          GO TO 3730-GET-AH-REMAIN-TERM.
 16507
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 298
* EL050.cbl
 16508 3720-GET-LF-REFUND.
 16509
 16510     IF PB-C-LF-CANCEL-VOIDED
 16511        GO TO 3730-GET-AH-REMAIN-TERM
 16512     end-if
 16513
 16514     IF PB-COMPANY-ID EQUAL 'BOA'
 16515         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16516         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16517         GO TO 3730-GET-AH-REMAIN-TERM.
 16518
 16519     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 16520        (WS-AH-SPECIAL-CALC-CD = 'M')
 16521         MOVE ER-2767            TO WS-ERROR
 16522         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16523         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16524         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16525         GO TO 3780-UPDATE-CANCEL-CERT.
 16526
 16527*    if (ws-lf-earnings-calc = '6')
 16528*       or (pb-c-lf-refund-override = '6')
 16529*       move cp-remaining-term-1 to cp-remaining-term-2
 16530*    end-if
 16531     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 16532
 16533     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 16534     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 16535     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16536     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 16537     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 16538     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 16539     IF PB-COMPANY-ID = 'DCC'
 16540        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16541        IF PDEF-MASTER-FOUND
 16542           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16543              (V1 > +8)
 16544              OR (PD-PROD-CODE (V1) = 'L')
 16545           END-PERFORM
 16546           IF V1 < +9
 16547              MOVE PD-MAX-AMT (V1)
 16548                           TO CP-R-MAX-TOT-BEN
 16549                              EC-AM-LF-MAX-TOT-BEN
 16550           END-IF
 16551        ELSE
 16552        MOVE ' '                 TO PDEF-MASTER-SW
 16553        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16554        MOVE PB-STATE            TO ERPDEF-STATE
 16555        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
 16556           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16557        END-IF
 16558        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16559        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16560        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16561        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16562        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16563        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16564        IF PDEF-MASTER-FOUND
 16565           MOVE 'N'              TO PDEF-MASTER-SW
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 299
* EL050.cbl
 16566           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16567           IF PDEF-MASTER-FOUND
 16568              IF (ERPDEF-KEY-SAVE (1:16) =
 16569                           PD-CONTROL-PRIMARY (1:16))
 16570                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16571                 CONTINUE
 16572              ELSE
 16573                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16574                 IF (ERPDEF-KEY-SAVE (1:16) =
 16575                           PD-CONTROL-PRIMARY (1:16))
 16576                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16577                    CONTINUE
 16578                 ELSE
 16579                    MOVE 'N'     TO PDEF-MASTER-SW
 16580                 END-IF
 16581              END-IF
 16582
 16583              IF PDEF-MASTER-FOUND
 16584                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16585                    (V1 > +8)
 16586                    OR (PD-PROD-CODE (V1) = 'L')
 16587                 END-PERFORM
 16588                 IF V1 < +9
 16589                    MOVE PD-MAX-AMT (V1)
 16590                                 TO CP-R-MAX-TOT-BEN
 16591                                    EC-AM-LF-MAX-TOT-BEN
 16592                 END-IF
 16593              END-IF
 16594           END-IF
 16595           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16596        END-IF
 16597        END-IF
 16598     END-IF
 16599     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 16600
 16601     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 16602
 16603     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16604                                    PB-C-LF-REM-TERM.
 16605
 16606     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 16607     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 16608
 16609     IF PB-COMPANY-ID EQUAL 'FLC'
 16610        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 16611           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 16612           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 16613                    + PB-CI-LF-ALT-PREMIUM-AMT)
 16614                    - CM-LF-ITD-DEATH-AMT
 16615           IF PB-C-LF-REF-CALC LESS THAN +0
 16616              MOVE +0            TO PB-C-LF-REF-CALC
 16617              GO TO 3730-GET-AH-REMAIN-TERM
 16618           ELSE
 16619              GO TO 3730-GET-AH-REMAIN-TERM.
 16620
 16621     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16622                            OR '4' OR '5' OR '6' OR '8'
 16623                            OR '9' OR 'G'
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 300
* EL050.cbl
 16624        MOVE PB-C-LF-REFUND-OVERRIDE
 16625                                 TO CP-EARNING-METHOD.
 16626
 16627     if pb-company-id = 'AHL'
 16628        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 16629        if cp-class-code = spaces
 16630           move zeros            to cp-class-code
 16631        end-if
 16632     ELSE
 16633        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16634     END-IF
 16635*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16636     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 16637     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16638                                    CP-RATING-BENEFIT-AMT.
 16639     IF CP-STATE-STD-ABBRV = 'OR'
 16640         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16641                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16642     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16643     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16644     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16645     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 16646     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 16647     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16648     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16649     IF WS-DEFAULT-APR NOT NUMERIC
 16650         MOVE ZEROS TO WS-DEFAULT-APR.
 16651****   N O T E   ****
 16652*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 16653*      THE OH HARD CODING IN ELCRFNDP
 16654
 16655     IF PB-COMPANY-ID = 'CID'
 16656        IF CP-STATE-STD-ABBRV = 'OH'
 16657           MOVE WS-LF-EARNINGS-CALC
 16658                                 TO CP-EARNING-METHOD
 16659        END-IF
 16660     END-IF
 16661
 16662****   N O T E   ****
 16663
 16664*    IF CP-EARN-AS-NET-PAY
 16665*        IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16666*           IF WS-DEFAULT-APR GREATER THAN ZEROS
 16667*               MOVE WS-DEFAULT-APR
 16668*                                TO  CP-LOAN-APR
 16669*               MOVE ER-3780     TO  WS-ERROR
 16670*               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16671*           ELSE
 16672*               MOVE ER-3781     TO  WS-ERROR
 16673*               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16674*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 16675     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16676
 16677     IF CP-REFUND-TYPE-USED NOT = SPACE
 16678         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 16679
 16680     IF CP-ERROR-RATE-IS-ZERO OR
 16681        CP-ERROR-RATE-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 301
* EL050.cbl
 16682        MOVE ER-2740             TO WS-ERROR
 16683        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16684
 16685     IF CP-ERROR-RATE-FILE-NOTOPEN
 16686        MOVE ER-2617             TO WS-ERROR
 16687        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16688
 16689     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 16690        AND PB-CI-ENTRY-STATUS = 'M'
 16691        MOVE +0                  TO PB-C-LF-REF-CALC
 16692     ELSE
 16693        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 16694     END-IF
 16695
 16696     IF WS-LF-EARNINGS-CALC NOT = 'B'
 16697         GO TO 3730-GET-AH-REMAIN-TERM.
 16698
 16699*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 16700*       ADD +1                   TO PB-C-LF-REM-TERM
 16701*                                   CP-REMAINING-TERM
 16702*                                   CP-ORIGINAL-TERM.
 16703
 16704     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 16705     MOVE '2'                    TO CP-EARNING-METHOD
 16706                                    CP-RATING-METHOD.
 16707     IF PB-COMPANY-ID = 'CID'
 16708        IF (CP-STATE-STD-ABBRV = 'MN')
 16709           AND (PB-CERT-EFF-DT > X'A4FF')
 16710           AND (WS-LF-EARNINGS-CALC = 'B')
 16711           MOVE '5'              TO CP-EARNING-METHOD
 16712           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 16713        END-IF
 16714     END-IF
 16715     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16716                                        CP-REMAINING-BENEFIT
 16717                                        CP-RATING-BENEFIT-AMT.
 16718     IF CP-STATE-STD-ABBRV = 'OR'
 16719         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16720                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16721     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16722     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16723
 16724     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16725
 16726     IF CP-ERROR-RATE-IS-ZERO OR
 16727        CP-ERROR-RATE-NOT-FOUND
 16728        MOVE ER-2740             TO WS-ERROR
 16729        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16730
 16731     IF CP-ERROR-RATE-FILE-NOTOPEN
 16732        MOVE ER-2617             TO WS-ERROR
 16733        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16734
 16735     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16736
 16737******************************************************************
 16738
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 302
* EL050.cbl
 16740 3730-GET-AH-REMAIN-TERM.
 16741     IF NO-AH-BENEFIT-MATCH  OR
 16742        WS-AH-BENEFIT-CD = ZEROS
 16743         GO TO 3770-CHECK-REFUNDS.
 16744
 16745     IF PB-CI-AH-LUMP-SUM-DISAB
 16746         IF  PB-C-AH-CANCEL-AMT = ZERO
 16747            IF NOT PB-COMP-AH-CANCEL
 16748             GO TO 3770-CHECK-REFUNDS.
 16749
 16750     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16751     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16752     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16753     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16754     MOVE PB-SV-STATE            TO CP-STATE.
 16755     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16756     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16757     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16758     MOVE '2'                    TO CP-PROCESS-TYPE.
 16759     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16760     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16761     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16762     IF (PB-COMPANY-ID = 'CID')
 16763        AND (CP-STATE-STD-ABBRV = 'WI')
 16764        MOVE '7'                 TO CP-REM-TERM-METHOD
 16765        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16766     ELSE
 16767        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16768        MOVE WS-REM-TRM-CALC-OPTION
 16769                                 TO CP-REM-TRM-CALC-OPTION
 16770     END-IF
 16771     IF (PB-COMPANY-ID = 'CID')
 16772        AND (CP-STATE-STD-ABBRV = 'MO')
 16773        AND (PB-CERT-EFF-DT >= X'9B41')
 16774        AND (PB-CERT-EFF-DT <= X'A2FB')
 16775        MOVE '7'                 TO CP-REM-TERM-METHOD
 16776        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16777     END-IF
 16778     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16779                                    CP-LOAN-TERM.
 16780     IF NOT CP-TERM-IS-DAYS
 16781         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16782
 16783     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16784
 16785     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16786
 16787     IF AH-COVERAGE-CANCELLED
 16788        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16789        NEXT SENTENCE
 16790      ELSE
 16791         GO TO 3770-CHECK-REFUNDS.
 16792
 16793 3740-GET-AH-REFUND.
 16794
 16795     IF PB-C-AH-CANCEL-VOIDED
 16796        GO TO 3780-UPDATE-CANCEL-CERT
 16797     END-IF
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 303
* EL050.cbl
 16798
 16799     IF PB-COMPANY-ID = 'BOA'
 16800         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16801         GO TO 3770-CHECK-REFUNDS.
 16802
 16803     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16804*    MOVE ' '                    TO DC-OPTION-CODE
 16805     SET BIN-TO-GREG             TO TRUE
 16806     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16807     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16808                                    PB-C-AH-REM-TERM.
 16809     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16810     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16811
 16812     IF PB-COMPANY-ID EQUAL 'FLC'
 16813        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16814           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16815           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16816                    - CM-AH-ITD-AH-PMT)
 16817           IF PB-C-AH-REF-CALC LESS THAN +0
 16818              MOVE +0            TO PB-C-AH-REF-CALC
 16819              GO TO 3770-CHECK-REFUNDS
 16820           ELSE
 16821              GO TO 3770-CHECK-REFUNDS.
 16822
 16823     IF PB-COMPANY-ID = 'DCC'
 16824        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16825            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16826           MOVE 'S'              TO CP-EARNING-METHOD
 16827        END-IF
 16828     END-IF
 16829     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16830                            OR '4' OR '5' OR '6' OR '8'
 16831                            OR '9' OR 'G' OR 'S'
 16832        MOVE PB-C-AH-REFUND-OVERRIDE
 16833                                 TO CP-EARNING-METHOD.
 16834
 16835     if pb-company-id = 'AHL'
 16836        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16837        if cp-class-code = spaces
 16838           move zeros            to cp-class-code
 16839        end-if
 16840     ELSE
 16841        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16842     END-IF
 16843*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16844     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16845     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16846                                    CP-RATING-BENEFIT-AMT.
 16847     IF CP-STATE-STD-ABBRV = 'OR'
 16848         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16849                                         PB-CI-AH-TERM.
 16850     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16851     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16852     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16853     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16854     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16855     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 304
* EL050.cbl
 16856
 16857     IF CP-STATE-STD-ABBRV = 'OH'
 16858        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16859                                AND 'CID' AND 'DCC' and 'VPP'
 16860                                AND 'AHL')
 16861           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16862              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16863              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16864              MOVE '6' TO CP-EARNING-METHOD
 16865           END-IF
 16866        END-IF
 16867        IF PB-COMPANY-ID = 'CID'
 16868           IF NO-LIFE-COVERAGE
 16869              IF CP-CRITICAL-PERIOD
 16870                 MOVE '2'       TO CP-EARNING-METHOD
 16871              ELSE
 16872                 MOVE '6'       TO CP-EARNING-METHOD
 16873              END-IF
 16874           ELSE
 16875              IF WS-LF-COVERAGE-TYPE = 'L'
 16876                 MOVE '2'       TO CP-EARNING-METHOD
 16877              ELSE
 16878                 IF (PB-CI-LF-TERM > +60) OR
 16879                    (WS-LF-EARNINGS-CALC = '5')
 16880                    IF CP-CRITICAL-PERIOD
 16881                       MOVE '2'  TO CP-EARNING-METHOD
 16882                    ELSE
 16883                       MOVE '6'  TO CP-EARNING-METHOD
 16884                    END-IF
 16885                 ELSE
 16886                    MOVE '1'     TO CP-EARNING-METHOD
 16887                 END-IF
 16888              END-IF
 16889           END-IF
 16890        END-IF
 16891     END-IF
 16892
 16893*    IF CP-STATE-STD-ABBRV = 'VA'
 16894*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16895*          IF CP-ORIGINAL-TERM GREATER 61
 16896*             MOVE '6' TO CP-EARNING-METHOD
 16897*          ELSE
 16898*             MOVE '1' TO CP-EARNING-METHOD.
 16899
 16900     IF WS-DEFAULT-APR NOT NUMERIC
 16901         MOVE ZEROS TO WS-DEFAULT-APR.
 16902     IF CP-EARN-AS-NET-PAY
 16903         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16904            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16905                MOVE WS-DEFAULT-APR
 16906                                 TO  CP-LOAN-APR
 16907                MOVE ER-3780     TO  WS-ERROR
 16908                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16909            ELSE
 16910                MOVE ER-3781     TO  WS-ERROR
 16911                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16912     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16913     IF PB-COMPANY-ID = 'DCC'
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 305
* EL050.cbl
 16914        AND CP-CANCEL-REASON = 'R'
 16915        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16916        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16917     END-IF
 16918     IF PB-COMPANY-ID = 'DCC'
 16919        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16920        AND (CP-EARNING-METHOD = 'D')
 16921        AND (CP-CANCEL-REASON NOT = 'R')
 16922        CONTINUE
 16923     ELSE
 16924        GO TO 3750-CONTINUE
 16925     END-IF
 16926     MOVE ' '                    TO DD-IU-SW
 16927     IF NOT PDEF-MASTER-FOUND
 16928        MOVE ' '                 TO PDEF-MASTER-SW
 16929        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16930        MOVE PB-STATE            TO ERPDEF-STATE
 16931        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
 16932           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16933        END-IF
 16934        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16935        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16936        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16937        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16938        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16939        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16940        IF PDEF-MASTER-FOUND
 16941           MOVE 'N'              TO PDEF-MASTER-SW
 16942           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16943           IF PDEF-MASTER-FOUND
 16944              IF (ERPDEF-KEY-SAVE (1:16) =
 16945                           PD-CONTROL-PRIMARY (1:16))
 16946                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16947                 CONTINUE
 16948              ELSE
 16949                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16950                 IF (ERPDEF-KEY-SAVE (1:16) =
 16951                           PD-CONTROL-PRIMARY (1:16))
 16952                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16953                    CONTINUE
 16954                 ELSE
 16955                    MOVE ER-2740 TO WS-ERROR
 16956                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16957                    GO TO 3770-CHECK-REFUNDS
 16958                 END-IF
 16959              END-IF
 16960           END-IF
 16961           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16962        END-IF
 16963     END-IF
 16964     IF PDEF-MASTER-FOUND
 16965        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16966           (V1 > +8)
 16967           OR (PD-PROD-CODE (V1) = 'I')
 16968        END-PERFORM
 16969        IF V1 < +9
 16970           SET DD-IU-PRESENT        TO TRUE
 16971        END-IF
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 306
* EL050.cbl
 16972        IF WS-AH-DCC-TRUNC = 'T'
 16973           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16974        ELSE
 16975           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 16976        END-IF
 16977        EVALUATE TRUE
 16978           WHEN WS-TERM > +168
 16979              MOVE 15               TO V1
 16980           WHEN WS-TERM > +156
 16981              MOVE 14               TO V1
 16982           WHEN WS-TERM > +144
 16983              MOVE 13               TO V1
 16984           WHEN WS-TERM > +132
 16985              MOVE 12               TO V1
 16986           WHEN WS-TERM > +120
 16987              MOVE 11               TO V1
 16988           WHEN WS-TERM > +108
 16989              MOVE 10               TO V1
 16990           WHEN WS-TERM > +96
 16991              MOVE 9                TO V1
 16992           WHEN WS-TERM > +84
 16993              MOVE 8                TO V1
 16994           WHEN WS-TERM > +72
 16995              MOVE 7                TO V1
 16996           WHEN WS-TERM > +60
 16997              MOVE 6                TO V1
 16998           WHEN WS-TERM > +48
 16999              MOVE 5                TO V1
 17000           WHEN WS-TERM > +36
 17001              MOVE 4                TO V1
 17002           WHEN WS-TERM > +24
 17003              MOVE 3                TO V1
 17004           WHEN WS-TERM > +12
 17005              MOVE 2                TO V1
 17006           WHEN OTHER
 17007              MOVE 1                TO V1
 17008        END-EVALUATE
 17009
 17010        EVALUATE TRUE
 17011*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 17012*             < +13)
 17013*             AND (DD-IU-PRESENT)
 17014*             MOVE 2                TO V2
 17015*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 17016*             MOVE 1                TO V2
 17017           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 17018              MOVE 2                TO V2
 17019           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 17020              MOVE 3                TO V2
 17021           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 17022              MOVE 4                TO V2
 17023           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 17024              MOVE 5                TO V2
 17025           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 17026              MOVE 6                TO V2
 17027           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 17028              MOVE 7                TO V2
 17029           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 307
* EL050.cbl
 17030              MOVE 8                TO V2
 17031           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 17032              MOVE 9                TO V2
 17033           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 17034              MOVE 10               TO V2
 17035           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 17036              MOVE 11               TO V2
 17037           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 17038              MOVE 12               TO V2
 17039           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 17040              MOVE 13               TO V2
 17041           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 17042              MOVE 14               TO V2
 17043           WHEN OTHER
 17044              MOVE 15               TO V2
 17045        END-EVALUATE
 17046
 17047        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 17048                                 TO CP-DDF-LO-FACT
 17049        MOVE PD-UEP-FACTOR (V1 V2)
 17050                                 TO CP-DDF-HI-FACT
 17051
 17052        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 17053        MOVE CM-AH-CLP     TO CP-DDF-CLP
 17054        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 17055           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 17056        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 17057        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 17058        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 17059           + PD-1ST-YR-ADMIN-ALLOW
 17060
 17061        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 17062*       IF PI-CLP-YN = 'Y'
 17063*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 17064*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 17065*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 17066*       END-IF
 17067
 17068        IF DD-IU-PRESENT
 17069           MOVE 'I'              TO CP-EARNING-METHOD
 17070        END-IF
 17071        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 17072                                     CP-CLP-RATE-UP
 17073        IF CP-IU-RATE-UP NOT = ZEROS
 17074           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 17075              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 17076           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 17077              / (1 - WS-WORK-FACT)
 17078        END-IF
 17079     END-IF
 17080     .
 17081 3750-CONTINUE.
 17082     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 17083
 17084     IF CP-REFUND-TYPE-USED NOT = SPACE
 17085         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 17086
 17087     IF CP-ERROR-RATE-IS-ZERO OR
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 308
* EL050.cbl
 17088        CP-ERROR-RATE-NOT-FOUND
 17089        MOVE ER-2740             TO WS-ERROR
 17090        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17091
 17092     IF CP-ERROR-RATE-FILE-NOTOPEN
 17093        MOVE ER-2617             TO WS-ERROR
 17094        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17095     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17096        AND (PB-CI-ENTRY-STATUS = 'M')
 17097        MOVE +0                  TO PB-C-AH-REF-CALC
 17098     ELSE
 17099        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 17100     END-IF
 17101     if pb-company-id = 'VPP'
 17102        MOVE cm-ah-clp           to cp-original-premium
 17103        move zeros               to cp-calc-refund
 17104        perform 7600-get-refund  thru 7600-exit
 17105        if pb-c-ah-cancel-amt > pb-ci-cancel-fee
 17106           move cp-calc-refund   to pb-c-ah-rfnd-clp
 17107        else
 17108           move zeros            to pb-c-ah-rfnd-clp
 17109        end-if
 17110        display ' vpp ref clp ' cm-cert-no ' ' cm-ah-clp ' '
 17111           pb-c-ah-rfnd-clp ' ' pb-c-ah-cancel-amt ' '
 17112           pb-ci-cancel-fee
 17113     end-if
 17114     IF PB-COMPANY-ID = 'DCC'
 17115        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 17116        AND (CP-EARNING-METHOD = 'D' OR 'I')
 17117        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 17118        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 17119        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 17120        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 17121        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 17122        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 17123*       DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 17124     END-IF
 17125     .
 17126 3770-CHECK-REFUNDS.
 17127
 17128     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 17129        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17130           MOVE ER-2766          TO WS-ERROR
 17131           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17132           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 17133           IF PB-C-LF-REF-CALC LESS THAN ZERO
 17134              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 17135
 17136     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 17137        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17138           MOVE ER-2766          TO WS-ERROR
 17139           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17140           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 17141           IF PB-C-AH-REF-CALC LESS THAN ZERO
 17142              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 17143
 17144     IF PB-COMP-LF-CANCEL
 17145        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 309
* EL050.cbl
 17146        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 17147           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 17148              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 17149
 17150     IF PB-COMP-AH-CANCEL
 17151        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 17152        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 17153           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 17154              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 17155
 17156     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 17157             GIVING WS-UNSIGN-WRK1
 17158     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 17159             GIVING WS-UNSIGN-WRK2.
 17160
 17161     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17162         MOVE ZERO TO WS-UNSIGN-WRK1.
 17163
 17164     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17165         MOVE ZERO TO WS-UNSIGN-WRK2.
 17166
 17167     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 17168
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 310
* EL050.cbl
 17170
 17171 3772-CONTINUE.
 17172
 17173**********************************
 17174*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 17175*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 17176*** DOUBLES THE TOLERANCE AMOUNT.
 17177***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 17178**********************************
 17179     IF PB-COMPANY-ID = 'MON' or 'CID' or 'DCC' or 'VPP'
 17180     IF WS-UNSIGN-WRK3 >= WS-TOL-LF-REFUND
 17181         IF WS-REF-REJECT-SW = SPACE
 17182             MOVE ER-2754        TO WS-ERROR
 17183             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17184           ELSE
 17185             MOVE ER-2736        TO WS-ERROR
 17186             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17187**********************************
 17188
 17189 3773-CONTINUE.
 17190
 17191     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 17192        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 17193           MOVE ER-2723          TO WS-ERROR
 17194           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17195
 17196     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 17197        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 17198           MOVE ER-2724          TO WS-ERROR
 17199           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17200
 17201     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 17202         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 17203             (1 + WS-LF-REFUND-OVS-PCT)
 17204     ELSE
 17205         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 17206
 17207     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 17208         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 17209             (1 - WS-TOL-LF-REFUND-PCT)
 17210     ELSE
 17211         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 17212
 17213     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17214        AND (PB-CI-ENTRY-STATUS = 'M')
 17215        AND (PB-C-LF-CANCEL-AMT > +0)
 17216        MOVE ER-3843             TO WS-ERROR
 17217        PERFORM 9900-ERROR-FORMAT
 17218                                 THRU 9900-EXIT
 17219     END-IF
 17220     EVALUATE TRUE
 17221        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 17222           CONTINUE
 17223        WHEN PB-C-LF-CANCEL-AMT = +0
 17224                 AND PB-C-LF-REF-CALC > +0
 17225           CONTINUE
 17226        WHEN WS-LF-REFUND-OVS-AMT = 0
 17227                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 311
* EL050.cbl
 17228           CONTINUE
 17229        WHEN OTHER
 17230           IF WS-TOL-LF-REFUND  = +0
 17231              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 17232           END-IF
 17233           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 17234                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 17235                          (PB-C-LF-CANCEL-AMT))
 17236              CONTINUE
 17237           ELSE
 17238              IF WS-LF-REFUND-OVS-AMT = +0
 17239                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 17240              END-IF
 17241              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 17242                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 17243                                       PB-C-LF-CANCEL-AMT)
 17244                 CONTINUE
 17245              ELSE
 17246                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17247                   MOVE ER-2754   TO  WS-ERROR
 17248                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17249                 ELSE
 17250                    MOVE ER-2736   TO  WS-ERROR
 17251                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17252                 END-IF
 17253              END-IF
 17254           END-IF
 17255     END-EVALUATE.
 17256
 17257     EVALUATE TRUE
 17258        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 17259           CONTINUE
 17260        WHEN PB-C-LF-CANCEL-AMT = +0
 17261                 AND PB-C-LF-REF-CALC > +0
 17262           CONTINUE
 17263        WHEN OTHER
 17264           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 17265               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 17266              CONTINUE
 17267           ELSE
 17268              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 17269               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 17270                CONTINUE
 17271              ELSE
 17272                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17273                     MOVE ER-2754   TO  WS-ERROR
 17274                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17275                 ELSE
 17276                     MOVE ER-2736   TO  WS-ERROR
 17277                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17278                 END-IF
 17279              END-IF
 17280           END-IF
 17281     END-EVALUATE.
 17282
 17283     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 17284         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 17285             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 312
* EL050.cbl
 17286     ELSE
 17287         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 17288
 17289     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 17290         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 17291             (1 - WS-TOL-AH-REFUND-PCT)
 17292     ELSE
 17293         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 17294
 17295     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17296        AND (PB-CI-ENTRY-STATUS = 'M')
 17297        AND (PB-C-AH-CANCEL-AMT > +0)
 17298        MOVE ER-3843             TO WS-ERROR
 17299        PERFORM 9900-ERROR-FORMAT
 17300                                 THRU 9900-EXIT
 17301     END-IF
 17302     EVALUATE TRUE
 17303        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 17304           CONTINUE
 17305*       WHEN PB-C-AH-REF-CALC = +0 AND
 17306*                  PB-C-AH-CANCEL-AMT > +0
 17307        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 17308                   PB-C-AH-REF-CALC > +0
 17309           CONTINUE
 17310        WHEN WS-AH-REFUND-OVS-AMT = +0
 17311                AND WS-TOL-AH-REFUND = +0
 17312           CONTINUE
 17313        WHEN OTHER
 17314           IF WS-TOL-AH-REFUND = +0
 17315              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 17316           END-IF
 17317           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 17318               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 17319                                         PB-C-AH-CANCEL-AMT)
 17320              CONTINUE
 17321           ELSE
 17322              IF WS-AH-REFUND-OVS-AMT = +0
 17323                 MOVE +9999999.99 TO
 17324                         WS-AH-REFUND-OVS-AMT
 17325              END-IF
 17326              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 17327                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 17328                                         PB-C-AH-CANCEL-AMT)
 17329                 CONTINUE
 17330              ELSE
 17331                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17332                    MOVE ER-2754   TO  WS-ERROR
 17333                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17334                 ELSE
 17335                    MOVE ER-2736   TO  WS-ERROR
 17336                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17337                 END-IF
 17338              END-IF
 17339           END-IF
 17340     END-EVALUATE.
 17341
 17342     EVALUATE TRUE
 17343        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 313
* EL050.cbl
 17344           CONTINUE
 17345*       WHEN PB-C-AH-REF-CALC > +0 AND
 17346*                  PB-C-AH-CANCEL-AMT = +0
 17347        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 17348                   PB-C-AH-REF-CALC = +0
 17349           CONTINUE
 17350        WHEN OTHER
 17351           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 17352               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 17353              CONTINUE
 17354           ELSE
 17355              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 17356                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 17357                 CONTINUE
 17358              ELSE
 17359                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17360                     MOVE ER-2754   TO  WS-ERROR
 17361                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17362                 ELSE
 17363                     MOVE ER-2736   TO  WS-ERROR
 17364                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17365                 END-IF
 17366              END-IF
 17367           END-IF
 17368     END-EVALUATE.
 17369
 17370     IF (PB-C-LF-CANCEL-AMT = ZERO)
 17371        AND (PB-C-AH-CANCEL-AMT = ZERO)
 17372        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17373           AND  PB-C-LF-REF-CALC < +1.00
 17374           AND  PB-C-AH-REF-CALC < +1.00
 17375           CONTINUE
 17376        ELSE
 17377           IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17378              AND (PB-CI-ENTRY-STATUS = 'M')
 17379              CONTINUE
 17380           ELSE
 17381              MOVE ER-2741       TO WS-ERROR
 17382              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17383           END-IF
 17384        END-IF
 17385     END-IF
 17386
 17387     IF (PB-C-LF-CANCEL-AMT = ZERO
 17388        AND WS-LF-BENEFIT-CD NOT = ZERO
 17389        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 17390        AND PB-C-LF-REF-CALC NOT = ZERO)
 17391        OR
 17392        (PB-C-LF-CANCEL-AMT = ZERO
 17393        AND WS-LF-BENEFIT-CD NOT = ZERO
 17394        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 17395             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17396                AND PB-C-LF-REF-CALC LESS THAN +1.00
 17397                NEXT SENTENCE
 17398             ELSE
 17399                MOVE ER-2739        TO WS-ERROR
 17400                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17401
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 314
* EL050.cbl
 17402     IF (PB-C-AH-CANCEL-AMT = ZERO
 17403        AND WS-AH-BENEFIT-CD NOT = ZERO
 17404        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 17405        AND PB-C-AH-REF-CALC NOT = ZERO)
 17406        OR
 17407        (PB-C-AH-CANCEL-AMT = ZERO
 17408        AND WS-AH-BENEFIT-CD NOT = ZERO
 17409        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 17410             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17411                AND PB-C-AH-REF-CALC LESS THAN +1.00
 17412                NEXT SENTENCE
 17413             ELSE
 17414                MOVE ER-2738        TO WS-ERROR
 17415                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17416
 17417 3775-OVER-REF-CHK.
 17418
 17419     IF PB-CI-ENTRY-STATUS = '5'
 17420        GO TO 3780-UPDATE-CANCEL-CERT.
 17421
 17422     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 17423                              PB-CI-LF-ALT-PREMIUM-AMT.
 17424
 17425     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17426        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17427                                 PB-C-LF-REF-CALC
 17428      ELSE
 17429        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17430                                 PB-C-LF-CANCEL-AMT.
 17431
 17432     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 17433        MOVE ER-2755             TO WS-ERROR
 17434        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17435
 17436     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 17437
 17438     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17439        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17440                                 PB-C-AH-REF-CALC
 17441      ELSE
 17442        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17443                                 PB-C-AH-CANCEL-AMT.
 17444
 17445     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 17446        MOVE ER-2778             TO WS-ERROR
 17447        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17448
 17449     IF PB-CI-OB-FLAG NOT = 'Z'
 17450        NEXT SENTENCE
 17451       ELSE
 17452         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17453            MOVE ER-2757           TO WS-ERROR
 17454            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17455
 17456 3780-UPDATE-CANCEL-CERT.
 17457
 17458     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 17459        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 315
* EL050.cbl
 17460        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17461
 17462     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 17463         MOVE ER-2729              TO WS-ERROR
 17464         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17465
 17466     IF PB-CI-LF-BENEFIT-CD = ZERO
 17467         GO TO 3780-UPDATE-CONT-1.
 17468
 17469     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 17470         GO TO 3780-UPDATE-CONT-1.
 17471
 17472     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17473       AND
 17474        (PB-C-LF-CANCEL-AMT NEGATIVE)
 17475       AND
 17476        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 17477       AND
 17478        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 17479            NEXT SENTENCE
 17480       ELSE
 17481        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17482          AND
 17483***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17484***       AND
 17485           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 17486            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17487               MOVE ER-2730      TO WS-ERROR
 17488               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17489               GO TO 3999-END-EDIT
 17490            ELSE
 17491               GO TO 3999-END-EDIT
 17492        ELSE
 17493            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 17494               MOVE ER-2765           TO WS-ERROR
 17495               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17496               GO TO 3785-CHECK-NH.
 17497*              GO TO 3999-END-EDIT.
 17498
 17499 3780-UPDATE-CONT-1.
 17500     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 17501
 17502     IF PB-CI-AH-BENEFIT-CD = ZERO
 17503         GO TO 3780-UPDATE-CONT-2.
 17504
 17505     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 17506         GO TO 3780-UPDATE-CONT-2.
 17507
 17508     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 17509
 17510     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17511       AND
 17512        (PB-C-AH-CANCEL-AMT NEGATIVE)
 17513       AND
 17514        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 17515       AND
 17516        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 17517            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 316
* EL050.cbl
 17518       ELSE
 17519        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17520          AND
 17521***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17522***       AND
 17523           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 17524           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 17525            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17526               MOVE ER-2773      TO WS-ERROR
 17527               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17528               GO TO 3999-END-EDIT
 17529            ELSE
 17530               GO TO 3999-END-EDIT
 17531            END-IF
 17532           ELSE
 17533             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17534                IF MSTR-CERT-NO = W-CL-CERT-NO
 17535                   MOVE ER-2890 TO WS-ERROR
 17536                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17537                   GO TO 3999-END-EDIT
 17538                ELSE
 17539                   MOVE ER-2898 TO WS-ERROR
 17540                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17541                   GO TO 3999-END-EDIT
 17542                END-IF
 17543             ELSE
 17544                GO TO 3785-CHECK-NH
 17545             END-IF
 17546           END-IF
 17547          ELSE
 17548            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 17549              IF WS-AH-CLAIM-RESCINDED = 'Y'
 17550                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17551                   IF MSTR-CERT-NO = W-CL-CERT-NO
 17552                      MOVE ER-2890 TO WS-ERROR
 17553                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17554                      GO TO 3999-END-EDIT
 17555                   ELSE
 17556                      MOVE ER-2898 TO WS-ERROR
 17557                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17558                      GO TO 3999-END-EDIT
 17559                   END-IF
 17560                ELSE
 17561                   MOVE ER-2765 TO WS-ERROR
 17562                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17563                   GO TO 3785-CHECK-NH
 17564                END-IF
 17565              ELSE
 17566               MOVE ER-2765      TO WS-ERROR
 17567               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17568               GO TO 3785-CHECK-NH.
 17569*              GO TO 3999-END-EDIT.
 17570
 17571 3780-UPDATE-CONT-2.
 17572
 17573     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 17574        AND WS-LF-BENEFIT-CD = ZERO
 17575           MOVE ER-2743           TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 317
* EL050.cbl
 17576           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17577
 17578     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 17579        AND WS-AH-BENEFIT-CD = ZERO
 17580           MOVE ER-2744           TO WS-ERROR
 17581           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17582
 17583     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 17584        (PB-C-AH-CANCEL-AMT NEGATIVE))
 17585        AND
 17586        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 17587         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
 17588           MOVE ER-2746           TO WS-ERROR
 17589           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17590
 17591     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 17592       AND
 17593        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 17594             MOVE ER-2737        TO WS-ERROR
 17595             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17596
 17597     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 17598       AND
 17599        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 17600             MOVE ER-2737        TO WS-ERROR
 17601             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17602
 17603     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 17604         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 17605             OR 'CID' OR 'DCC' or 'VPP' OR 'AHL'
 17606             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 17607         ELSE
 17608             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 17609                 MOVE ER-2768    TO WS-ERROR
 17610                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17611             ELSE
 17612                 MOVE ER-2756    TO WS-ERROR
 17613                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17614
 17615     IF CERT-PEND-ISSUE-RETURNED
 17616        MOVE ER-2772             TO WS-ERROR
 17617        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17618 3785-CHECK-NH.
 17619*    IF PB-STATE NOT = 'NH' and 'TN'
 17620     IF PB-STATE NOT = 'NH'
 17621        GO TO 3999-END-EDIT
 17622     END-IF
 17623
 17624     MOVE ER-2796                TO WS-ERROR
 17625     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 17626     IF (PB-C-REF-INTERFACE-SW = 'Y')
 17627        OR (CM-NH-INTERFACE-SW = 'Y')
 17628        MOVE ER-2793             TO WS-ERROR
 17629        PERFORM 9900-ERROR-FORMAT
 17630                                 THRU 9900-EXIT
 17631     END-IF
 17632     MOVE +0                     TO WS-PAYMENT-AMT
 17633     if pb-state = 'NH'
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 318
* EL050.cbl
 17634        IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR
 17635               PB-C-AH-CANCEL-DT
 17636           GO TO 3999-END-EDIT
 17637        END-IF
 17638     end-if
 17639***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17640***-_-
 17641***-_-   For TN it's only flat cancels
 17642***-_-
 17643***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17644     if pb-state = 'TN'
 17645        if ((pb-c-lf-cancel-dt <> low-values)
 17646           and (pb-c-lf-cancel-dt <> pb-cert-eff-dt))
 17647                      or
 17648           ((pb-c-ah-cancel-dt <> low-values)
 17649           and (pb-c-ah-cancel-dt <> pb-cert-eff-dt))
 17650           GO TO 3999-END-EDIT
 17651        END-IF
 17652     end-if
 17653     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 17654        GO TO 3999-END-EDIT
 17655     END-IF
 17656***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17657***-_-
 17658***-_-   if cancel date within 15 days of effective date, bypass
 17659***-_-
 17660***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17661     IF PB-STATE NOT = 'NH'
 17662        GO TO 3785-CONTINUE
 17663     END-IF
 17664     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 17665     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 17666     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 17667        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 17668     END-IF
 17669     MOVE '1'                    TO DC-OPTION-CODE
 17670     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17671     IF NO-CONVERSION-ERROR
 17672        IF DC-ELAPSED-DAYS < +16
 17673           GO TO 3999-END-EDIT
 17674        END-IF
 17675     END-IF
 17676***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17677***-_-
 17678***-_-   if cancel date within 30 days of current date then
 17679***-_-   bypass else subtract 15 days from period
 17680***-_-
 17681***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17682     MOVE +0                     TO DC-ELAPSED-DAYS
 17683     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 17684     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 17685     MOVE '1'                    TO DC-OPTION-CODE
 17686     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17687     IF NO-CONVERSION-ERROR
 17688        IF DC-ELAPSED-DAYS > +30
 17689           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 17690        ELSE
 17691           GO TO 3999-END-EDIT
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 319
* EL050.cbl
 17692        END-IF
 17693     ELSE
 17694        GO TO 3999-END-EDIT
 17695     END-IF
 17696     .
 17697 3785-CONTINUE.
 17698     if pb-state = 'TN'
 17699        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 17700        MOVE PB-INPUT-DT         TO DC-BIN-DATE-2
 17701        MOVE '1'                 TO DC-OPTION-CODE
 17702        PERFORM 8500-DATE-CONVERT
 17703                                 THRU 8500-EXIT
 17704        IF no-CONVERSION-ERROR
 17705           IF DC-ELAPSED-DAYS < +16
 17706              GO TO 3999-END-EDIT
 17707           END-IF
 17708        END-IF
 17709     end-if
 17710***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17711***-_-
 17712***-_-   'NH' is 10%, TN is 3.5%
 17713***-_-
 17714***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17715     if pb-state = 'NH'
 17716        move +1.10               to ws-work-rate
 17717     else
 17718        move +1.035              to ws-work-rate
 17719     end-if
 17720     COMPUTE WS-PAYMENT-AMT ROUNDED =
 17721        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 17722           (ws-work-rate ** (DC-ELAPSED-DAYS / 365) - 1))
 17723     IF WS-PAYMENT-AMT < 600.00
 17724        GO TO 3999-END-EDIT
 17725     END-IF
 17726     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17727
 17728     IF (ERMAIL-FOUND = ' ')
 17729         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 17730         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 17731        GO TO 3999-END-EDIT
 17732     END-IF
 17733     MOVE ER-2795                TO WS-ERROR
 17734     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 17735
 17736     GO TO 3999-END-EDIT.
 17737******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 320
* EL050.cbl
 17739 3990-FILES-NOT-OPEN.
 17740
 17741     MOVE ER-2617                TO WS-ERROR.
 17742     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17743     GO TO 9990-RETURN.
 17744
 17745 3999-END-EDIT.
 17746
 17747     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 17748
 17749     IF PB-CANCELLATION AND CERT-WAS-FOUND
 17750         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 17751         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17752             PERFORM 9250-UNLOCK-RETURN
 17753             GO TO 9990-RETURN
 17754          ELSE
 17755             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17756             GO TO 9990-RETURN.
 17757
 17758     IF PB-CANCELLATION
 17759          GO TO 9990-RETURN.
 17760
 17761     IF CERT-WAS-NOT-FOUND
 17762        MOVE SPACES              TO CERTIFICATE-MASTER.
 17763
 17764     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 17765
 17766     IF CERT-WAS-FOUND
 17767         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17768             PERFORM 9250-UNLOCK-RETURN
 17769          ELSE
 17770            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17771      ELSE
 17772         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 17773
 17774*    if pb-company-id = 'VPP'
 17775*       perform 8150-read-elcrtt thru 8150-exit
 17776*       if ws-vehicle-odometer numeric
 17777*          if ws-vehicle-odometer > 6000
 17778*             move er-1583       to ws-error
 17779*             PERFORM 9900-ERROR-FORMAT
 17780*                                THRU 9900-EXIT
 17781*          end-if
 17782*       end-if
 17783*    end-if
 17784     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 17785        IF ((PB-COMPANY-ID = 'DCC')
 17786           AND (PB-CARRIER = '2' OR '4' OR '6'))
 17787                         or
 17788            (pb-company-id = 'CID' or 'VPP')
 17789            PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 17790        END-IF
 17791     END-IF.
 17792
 17793     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 17794         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 17795     END-IF.
 17796     move ' '                    to ws-ins-age-defaulted
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 321
* EL050.cbl
 17797     perform 8150-read-elcrtt    thru 8150-exit
 17798     if ws-ins-age-defaulted = 'Y'
 17799        move er-1573             to ws-error
 17800        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17801     end-if
 17802
 17803     if ws-jnt-age-defaulted = 'Y'
 17804        move er-1574             to ws-error
 17805        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17806     end-if
 17807***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17808***                                                           ****
 17809***  Set an error if the state requires verification of agent ****
 17810***  and agent hasn't verified yet and the status is not =    ****
 17811***  9,5,d and V and the term for lf or ah > 1 (not OB)       ****
 17812***  and the entry date > 09/01/2015.                         ****
 17813***                                                           ****
 17814***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17815     if (pb-input-dt >= X'AD81')    *> 09/01/2015
 17816        and (pb-i-entry-status not = '5' and 'D' and 'V')
 17817        and (pb-account (9:2) not = 'OB')
 17818        if (ws-st-agent-sig-edit = 'Y')
 17819           and (am-report-code-1 not = 'CONLEY')
 17820           evaluate true
 17821              when cs-agent-edit-status = 'C'
 17822                 move er-1743    to ws-error
 17823                 perform 9900-error-format
 17824                                 thru 9900-exit
 17825              when cs-agent-edit-status = 'S'
 17826                 move er-1744    to ws-error
 17827                 perform 9900-error-format
 17828                                 thru 9900-exit
 17829              when cs-agent-edit-status = 'M'
 17830                 move er-1745    to ws-error
 17831                 perform 9900-error-format
 17832                                 thru 9900-exit
 17833              when cs-agent-edit-status = 'R'
 17834                 move er-1747    to ws-error
 17835                 perform 9900-error-format
 17836                                 thru 9900-exit
 17837              when cs-agent-edit-status = 'N'
 17838                 move er-1748    to ws-error
 17839                 perform 9900-error-format
 17840                                 thru 9900-exit
 17841              when cs-agent-edit-status <> 'V' and 'U' and
 17842                                           'R' and 'N'
 17843                 move er-1746    to ws-error
 17844                 perform 9900-error-format
 17845                                 thru 9900-exit
 17846           end-evaluate
 17847        end-if
 17848     end-if
 17849     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 17850     IF ((PB-COMPANY-ID = 'DCC' or 'VPP')
 17851        AND (WS-NO-SECURE-PAY))
 17852                  OR
 17853        (WS-LF-SPECIAL-CALC-CD = 'O'
 17854        OR WS-AH-SPECIAL-CALC-CD = 'O')
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 322
* EL050.cbl
 17855        SET SKIP-ADDR-EDIT       TO TRUE
 17856     END-IF
 17857     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 17858        AND (NOT SKIP-ADDR-EDIT)
 17859        MOVE ER-2963             TO WS-ERROR
 17860        PERFORM 9900-ERROR-FORMAT
 17861                                 THRU 9900-EXIT
 17862        GO TO 9990-RETURN
 17863     END-IF
 17864     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 17865     IF ERPNDM-FOUND NOT = 'X'
 17866        move 'Y'                 to erpndm-unlock-sw
 17867        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17868           OR (PM-CITY        = SPACES OR LOW-VALUES)
 17869           OR (PM-STATE       = SPACES OR LOW-VALUES)
 17870           OR (PM-ZIP         = SPACES OR LOW-VALUES)
 17871           or (pm-zip-code    = zeros)
 17872           or (pm-zip-code not numeric))
 17873           AND (NOT SKIP-ADDR-EDIT)
 17874           MOVE ER-2694          TO WS-ERROR
 17875           PERFORM 9900-ERROR-FORMAT
 17876                                 THRU 9900-EXIT
 17877        END-IF
 17878        MOVE ' '                 TO STATE-RECORD-ERROR
 17879        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17880        MOVE PM-STATE            TO CNTL-ACCESS
 17881        MOVE '3'                 TO CNTL-REC-TYPE
 17882        MOVE +0                  TO CNTL-SEQ-NO
 17883        MOVE '0'                 TO RC-SW-2
 17884        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17885        IF (NO-STATE-RECORD)
 17886           OR (CF-RECORD-TYPE NOT = '3')
 17887           OR (PM-STATE NOT = CF-STATE-CODE)
 17888           IF (PM-STATE = SPACES)
 17889              AND (SKIP-ADDR-EDIT)
 17890              CONTINUE
 17891           ELSE
 17892              MOVE ER-2963       TO WS-ERROR
 17893              PERFORM 9900-ERROR-FORMAT
 17894                                 THRU 9900-EXIT
 17895           END-IF
 17896        END-IF
 17897        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 17898           MOVE ER-2883          TO WS-ERROR
 17899           PERFORM 9900-ERROR-FORMAT
 17900                                 THRU 9900-EXIT
 17901        END-IF
 17902        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 17903           MOVE ' '                 TO STATE-RECORD-ERROR
 17904           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17905           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 17906           MOVE '3'                 TO CNTL-REC-TYPE
 17907           MOVE +0                  TO CNTL-SEQ-NO
 17908           MOVE '0'                 TO RC-SW-2
 17909           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17910           IF NO-STATE-RECORD
 17911              OR (CF-RECORD-TYPE NOT = '3')
 17912              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 323
* EL050.cbl
 17913              MOVE ER-2964          TO WS-ERROR
 17914              PERFORM 9900-ERROR-FORMAT
 17915                                    THRU 9900-EXIT
 17916           END-IF
 17917        END-IF
 17918     ELSE
 17919        IF NOT SKIP-ADDR-EDIT
 17920           MOVE ER-2393          TO WS-ERROR
 17921           PERFORM 9900-ERROR-FORMAT
 17922                                 THRU 9900-EXIT
 17923        END-IF
 17924     END-IF
 17925     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17926
 17927     IF (ERMAIL-FOUND = ' ' AND
 17928        ERPNDM-FOUND = ' ')
 17929        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 17930           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 17931           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 17932          OR
 17933           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 17934          OR
 17935           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 17936           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 17937           GO TO 3999-UNLOCK-ERMAIL.
 17938
 17939     IF ERPNDM-FOUND = 'X'
 17940        GO TO 3999-UNLOCK-ERMAIL.
 17941
 17942     IF PM-INSURED-LAST-NAME      = SPACES
 17943        AND PM-INSURED-FIRST-NAME = SPACES
 17944        AND PM-ADDRESS-LINE-1     = SPACES
 17945        AND PM-ADDRESS-LINE-2     = SPACES
 17946        AND PM-CITY-STATE         = SPACES
 17947        AND PM-CRED-BENE-NAME     = SPACES
 17948        AND PM-CRED-BENE-ADDR     = SPACES
 17949        AND PM-CRED-BENE-CTYST    = SPACES
 17950        GO TO 3999-UNLOCK-ERMAIL
 17951     END-IF
 17952
 17953     MOVE SPACES                 TO MAILING-DATA.
 17954
 17955     MOVE 'MA'                   TO MA-RECORD-ID.
 17956     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 17957     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 17958     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 17959     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 17960     MOVE PB-SV-STATE            TO MA-STATE.
 17961     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 17962     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 17963
 17964     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 17965     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 17966
 17967     IF ERMAIL-FOUND = ' '
 17968        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 17969     ELSE
 17970        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 324
* EL050.cbl
 17971        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 17972        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 17973
 17974     GO TO 9990-RETURN.
 17975
 17976 3999-UNLOCK-ERMAIL.
 17977     IF ERMAIL-FOUND = ' '
 17978        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 17979
 17980     GO TO 9990-RETURN.
 17981******************************************************************
 17982
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 325
* EL050.cbl
 17984 4000-UPDATE-CANCELLED-CERT.
 17985     IF CERT-WAS-NOT-FOUND
 17986        GO TO 4299-EXIT.
 17987
 17988*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 17989     IF PB-C-NH-INT-ON-REFS > ZEROS
 17990        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 17991     END-IF
 17992     IF PB-C-REF-INTERFACE-SW = 'Y'
 17993        MOVE PB-C-REF-INTERFACE-SW
 17994                                 TO CM-NH-INTERFACE-SW
 17995     END-IF
 17996     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17997     IF ERMAIL-FOUND = 'X'
 17998        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17999        OR (MA-CITY        = SPACES OR LOW-VALUES)
 18000        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 18001        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 18002           MOVE ER-2694          TO WS-ERROR
 18003           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18004     END-IF
 18005
 18006     IF PB-C-POST-CARD-IND = 'Y'
 18007        MOVE +8                  TO SUB
 18008*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 18009        IF ERMAIL-FOUND = ' '
 18010           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 18011              (SUB > +7)
 18012              OR (MA-MAIL-STATUS (SUB) = '1')
 18013           END-PERFORM
 18014        END-IF
 18015        IF (SUB > +7)
 18016           OR (ERMAIL-FOUND = 'X')
 18017           MOVE ER-3789          TO WS-ERROR
 18018           PERFORM 9900-ERROR-FORMAT
 18019                                 THRU 9900-EXIT
 18020        END-IF
 18021     ELSE
 18022        MOVE 'N'                 TO PB-C-POST-CARD-IND
 18023     END-IF
 18024
 18025     IF ERMAIL-FOUND = ' '
 18026        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 18027     END-IF.
 18028
 18029     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 18030
 18031     IF PB-CI-OB-FLAG = 'Z'
 18032        GO TO 4150-SUMMARY-CERT-CANCEL.
 18033
 18034     IF PB-C-LF-CANCEL-VOIDED
 18035         PERFORM 4200-REVERSE-LF-CANCEL.
 18036     IF PB-C-AH-CANCEL-VOIDED
 18037         PERFORM 4200-REVERSE-AH-CANCEL.
 18038
 18039 4100-APPLY-LF-CANCEL.
 18040
 18041     MOVE +0                     TO WS-SUB.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 326
* EL050.cbl
 18042
 18043 4100-CHECK-LF-ERRORS.
 18044
 18045     ADD +1                       TO WS-SUB.
 18046
 18047     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 18048        IF LF-COVERAGE-CANCELLED
 18049           GO TO 4100-LF-CANCEL-CONT
 18050        ELSE
 18051           GO TO 4100-UPDATE-LF-COVERAGE.
 18052
 18053     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 18054                                   ER-2729 OR
 18055                                   ER-2730 OR
 18056                                   ER-2731 OR
 18057                                   ER-2732 OR
 18058                                   ER-2737 OR
 18059                                   ER-2740 OR
 18060                                   ER-2743 OR
 18061                                   ER-2749 OR
 18062                                   ER-2750 OR
 18063                                   ER-2755 OR
 18064                                   ER-2757 OR
 18065                                   ER-2760 OR
 18066                                   ER-2772 OR
 18067                                   ER-2774 OR
 18068                                   ER-2776 OR
 18069                                   ER-2794
 18070        GO TO 4100-UPDATE-LF-COVERAGE.
 18071
 18072     GO TO 4100-CHECK-LF-ERRORS.
 18073
 18074 4100-UPDATE-LF-COVERAGE.
 18075
 18076     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 18077     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 18078     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 18079        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 18080     END-IF
 18081     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 18082                                      TO CM-CREDIT-INTERFACE-SW-2.
 18083     IF CM-LF-CANCEL-DT = LOW-VALUE
 18084         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 18085
 18086     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 18087         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 18088                                         CM-LF-STATUS-AT-CANCEL.
 18089
 18090     GO TO 4100-APPLY-AH-CANCEL.
 18091
 18092 4100-LF-CANCEL-CONT.
 18093     IF PB-C-LF-CANCEL-VOIDED
 18094         GO TO 4100-APPLY-AH-CANCEL.
 18095
 18096     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 18097         GO TO 4100-APPLY-AH-CANCEL.
 18098
 18099     IF PB-C-LF-CANCEL-AMT GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 327
* EL050.cbl
 18100        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18101           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 18102        ELSE
 18103           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 18104
 18105     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 18106     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 18107
 18108     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 18109         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 18110
 18111     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 18112        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 18113         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 18114         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 18115
 18116     IF PB-RECORD-RETURNED
 18117        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18118      ELSE
 18119        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 18120
 18121 4100-APPLY-AH-CANCEL.
 18122
 18123     MOVE +0                      TO WS-SUB.
 18124
 18125 4100-CHECK-AH-ERRORS.
 18126
 18127     ADD +1                       TO WS-SUB.
 18128
 18129     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 18130        IF AH-COVERAGE-CANCELLED
 18131           GO TO 4100-AH-CANCEL-CONT
 18132        ELSE
 18133           GO TO 4100-UPDATE-AH-COVERAGE.
 18134
 18135     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 18136                                   ER-2729 OR
 18137                                   ER-2732 OR
 18138                                   ER-2737 OR
 18139                                   ER-2740 OR
 18140                                   ER-2744 OR
 18141                                   ER-2749 OR
 18142                                   ER-2750 OR
 18143                                   ER-2755 OR
 18144                                   ER-2757 OR
 18145                                   ER-2760 OR
 18146                                   ER-2771 OR
 18147                                   ER-2772 OR
 18148                                   ER-2773 OR
 18149                                   ER-2775 OR
 18150                                   ER-2777 OR
 18151                                   ER-2778 OR
 18152                                   ER-2794
 18153        GO TO 4100-UPDATE-AH-COVERAGE.
 18154
 18155     GO TO 4100-CHECK-AH-ERRORS.
 18156
 18157 4100-UPDATE-AH-COVERAGE.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 328
* EL050.cbl
 18158
 18159     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 18160     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 18161     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 18162     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 18163                                      TO CM-CREDIT-INTERFACE-SW-2.
 18164     IF CM-AH-CANCEL-DT = LOW-VALUE
 18165         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 18166
 18167     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 18168         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 18169                                         CM-AH-STATUS-AT-CANCEL.
 18170
 18171     IF LF-COVERAGE-CANCELLED
 18172         IF PB-RECORD-RETURNED
 18173              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 18174          ELSE
 18175              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 18176
 18177     GO TO 4299-EXIT.
 18178
 18179 4100-AH-CANCEL-CONT.
 18180     IF PB-C-AH-CANCEL-VOIDED
 18181         GO TO 4299-EXIT.
 18182
 18183     if cm-credit-interface-sw-2 = ' '
 18184        if pb-fatal-errors or pb-unforced-errors
 18185           move '4'              to cm-credit-interface-sw-2
 18186        else
 18187           move '1'              to cm-credit-interface-sw-2
 18188        end-if
 18189     end-if
 18190     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 18191         GO TO 4299-EXIT.
 18192
 18193     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 18194        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 18195           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 18196        ELSE
 18197           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 18198
 18199     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 18200     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 18201
 18202     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 18203         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 18204
 18205     IF CM-AH-STATUS-AT-CANCEL = SPACE
 18206         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 18207         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 18208
 18209     IF PB-RECORD-RETURNED
 18210        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 18211      ELSE
 18212        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 18213
 18214     GO TO 4299-EXIT.
 18215
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 329
* EL050.cbl
 18216 4150-SUMMARY-CERT-CANCEL.
 18217     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 18218
 18219     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18220        COMPUTE CM-LF-ITD-CANCEL-AMT =
 18221                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 18222     ELSE
 18223        COMPUTE CM-LF-ITD-CANCEL-AMT =
 18224                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 18225
 18226     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 18227        COMPUTE CM-AH-ITD-CANCEL-AMT =
 18228                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 18229     ELSE
 18230        COMPUTE CM-AH-ITD-CANCEL-AMT =
 18231                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 18232
 18233     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 18234        NEXT SENTENCE
 18235     ELSE
 18236        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 18237
 18238     GO TO 4299-EXIT.
 18239
 18240 4200-REVERSE-LF-CANCEL.
 18241     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 18242
 18243     IF CM-LF-CANCEL-APPLIED
 18244        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 18245        MOVE SPACES                TO CM-LF-EXIT-BATCH
 18246        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 18247
 18248     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 18249
 18250     IF PB-RECORD-RETURNED
 18251        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18252       ELSE
 18253        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 18254
 18255 4200-REVERSE-LF-EXIT.
 18256       EXIT.
 18257
 18258 4200-REVERSE-AH-CANCEL.
 18259     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 18260
 18261     IF CM-AH-CANCEL-APPLIED
 18262        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 18263        MOVE SPACES                TO CM-AH-EXIT-BATCH
 18264        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 18265
 18266     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 18267
 18268     IF PB-RECORD-RETURNED
 18269        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18270       ELSE
 18271        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 18272
 18273 4200-REVERSE-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 330
* EL050.cbl
 18274       EXIT.
 18275
 18276 4299-EXIT.
 18277       EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 331
* EL050.cbl
 18279
 18280 4500-UPDATE-NEW-CERT.
 18281     IF CERT-WAS-FOUND
 18282         NEXT SENTENCE
 18283       ELSE
 18284         GO TO 4520-BUILD-NEW-KEY.
 18285
 18286     IF  CLASIC-CREATED-CERT
 18287         GO TO 4999-EXIT.
 18288
 18289     IF  CERT-WAS-CREATED-FOR-CLAIM
 18290         GO TO 4520-BUILD-NEW-KEY.
 18291
 18292     IF CERT-ADDED-BATCH
 18293        IF CM-RECORD-ID = 'CM'
 18294            GO TO 4999-EXIT.
 18295
 18296 4520-BUILD-NEW-KEY.
 18297* BUILD CONTROL PRIMARY
 18298
 18299     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 18300                                       CM-COMPANY-CD-A1
 18301                                       CM-COMPANY-CD-A2
 18302                                       CM-COMPANY-CD-A4
 18303                                       CM-COMPANY-CD-A5.
 18304
 18305     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 18306     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 18307     MOVE PB-SV-STATE               TO CM-STATE.
 18308     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 18309     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 18310     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 18311     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 18312
 18313     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 18314
 18315     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 18316     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 18317     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 18318     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 18319
 18320     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 18321        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 18322
 18323     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 18324         MOVE PB-SV-STATE            TO CM-SSN-STATE
 18325         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 18326         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 18327         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 18328     ELSE
 18329         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 18330
 18331     IF PB-COMPANY-ID   EQUAL  'CRI'
 18332         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 18333         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 18334         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 18335         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 18336         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 332
* EL050.cbl
 18337
 18338     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 18339        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 18340         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 18341
 18342     IF PB-COMPANY-ID  = 'LBL'
 18343        IF PB-I-JOINT-COVERAGE
 18344            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 18345                                           PB-I-MEMBER-NO
 18346            GO TO 4550-CONT-CERT-PROCESS.
 18347
 18348     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 18349        NEXT SENTENCE
 18350     ELSE
 18351        GO TO 4540-BUILD-MEMBER-NO.
 18352
 18353******************************************************************
 18354*                                                                *
 18355*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 18356*    FOR 'MON'.                                                  *
 18357*                                                                *
 18358******************************************************************
 18359
 18360     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 18361     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 18362     MOVE +1                     TO WS-SUB1
 18363                                    WS-SUB2.
 18364
 18365 4530-EDIT-MEMB-NAME.
 18366
 18367     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 18368        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 18369        ADD +1                       TO WS-SUB2.
 18370
 18371     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 18372        ADD +1                       TO WS-SUB1
 18373        GO TO 4530-EDIT-MEMB-NAME.
 18374
 18375     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 18376     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 18377     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 18378*    MOVE SPACE                      TO DC-OPTION-CODE.
 18379     SET  BIN-TO-GREG                TO TRUE.
 18380     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18381     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 18382
 18383     GO TO 4550-CONT-CERT-PROCESS.
 18384
 18385******************************************************************
 18386*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 18387******************************************************************
 18388
 18389 4540-BUILD-MEMBER-NO.
 18390
 18391     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 18392         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 18393         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 18394         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 333
* EL050.cbl
 18395         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 18396     ELSE
 18397         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 18398
 18399     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 18400        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 18401         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 18402
 18403 4550-CONT-CERT-PROCESS.
 18404
 18405*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 18406*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 18407*    ELSE
 18408*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 18409
 18410     IF CERT-WAS-CREATED-FOR-CLAIM
 18411        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 18412        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 18413
 18414     IF CERT-AND-CLAIM-ONLINE
 18415        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 18416        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 18417
 18418     MOVE 'CM'                     TO CM-RECORD-ID.
 18419     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 18420
 18421     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 18422        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 18423        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 18424     ELSE
 18425        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 18426        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 18427
 18428     MOVE ZERO                     TO CM-LOAN-BALANCE.
 18429     MOVE '1'                      TO CM-PREMIUM-TYPE.
 18430     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 18431     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 18432     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 18433     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 18434     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 18435                                      CM-LF-ITD-CANCEL-AMT
 18436                                      CM-LF-ITD-DEATH-AMT
 18437                                      CM-AH-ITD-AH-PMT
 18438                                      CM-AH-ITD-LUMP-PMT
 18439                                      CM-AH-ITD-CANCEL-AMT
 18440                                      CM-LF-NSP-PREMIUM-AMT
 18441                                      CM-AH-NSP-PREMIUM-AMT.
 18442*                                     CM-CLAIM-DEDUCT-WITHHELD
 18443*                                     CM-CANCEL-DEDUCT-WITHHELD.
 18444     if pb-i-loan-apr = +99.9999
 18445        move zeros                 to cm-loan-apr
 18446     else
 18447        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 18448     end-if
 18449     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 18450     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 18451     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 18452     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 334
* EL050.cbl
 18453     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 18454     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 18455     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 18456     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 18457     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 18458     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 18459     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 18460
 18461     IF PB-I-LIVES NOT NUMERIC
 18462         MOVE ZERO                 TO PB-I-LIVES.
 18463
 18464     IF PB-I-NUM-BILLED NOT NUMERIC
 18465         MOVE ZERO                 TO PB-I-NUM-BILLED.
 18466
 18467     MOVE PB-I-LIVES               TO CM-LIVES.
 18468     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 18469
 18470     IF PB-COMPANY-ID EQUAL  'DMD'
 18471         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 18472         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 18473
 18474     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 18475     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 18476     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 18477     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 18478     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 18479     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 18480
 18481     IF PB-I-LF-POLICY-FEE NUMERIC
 18482        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 18483     ELSE
 18484        MOVE +0                    TO CM-LF-POLICY-FEE.
 18485
 18486     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18487        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 18488        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 18489     ELSE
 18490        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 18491
 18492     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 18493     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 18494     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 18495     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 18496     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 18497     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 18498     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 18499     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 18500     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 18501
 18502     IF PB-I-CANCEL-FEE NUMERIC
 18503        MOVE PB-I-CANCEL-FEE     TO CM-CANCEL-FEE
 18504     ELSE
 18505        MOVE +0                  TO CM-CANCEL-FEE
 18506     END-IF
 18507
 18508     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 18509        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 18510     ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 335
* EL050.cbl
 18511        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 18512
 18513     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 18514     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 18515
 18516     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 18517                                      CM-LF-DEATH-EXIT-DT
 18518                                      CM-AH-SETTLEMENT-EXIT-DT.
 18519
 18520*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 18521*                       'TIH' OR 'OFL' OR 'FLA' OR
 18522*                       'TII' OR 'TMS' OR 'CRI' OR
 18523*                       'NCL'
 18524     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 18525
 18526     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 18527         IF WS-LF-SPECIAL-CALC-CD = 'O'
 18528            MOVE '2'                TO CM-PREMIUM-TYPE.
 18529
 18530     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 18531         IF WS-AH-SPECIAL-CALC-CD = 'O'
 18532            MOVE '2'                TO CM-PREMIUM-TYPE.
 18533
 18534     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 18535         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 18536     ELSE
 18537         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 18538         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 18539
 18540     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 18541     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 18542     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 18543     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 18544     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 18545     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 18546     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 18547     MOVE SPACE                     TO CM-PAYMENT-MODE.
 18548
 18549     IF PB-NO-MONTHS-SKIPPED
 18550         MOVE SPACE                 TO CM-SKIP-CODE
 18551     ELSE
 18552         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 18553
 18554     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 18555     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 18556                                       CM-LF-STATUS-AT-CANCEL.
 18557
 18558     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 18559     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 18560                                       CM-AH-STATUS-AT-CANCEL.
 18561
 18562     MOVE '1'                       TO CM-ENTRY-STATUS.
 18563
 18564     IF PB-REISSUED-CERT
 18565        MOVE '5'                    TO CM-ENTRY-STATUS.
 18566
 18567     IF PB-MONTHLY-CERT
 18568        MOVE 'M'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 336
* EL050.cbl
 18569
 18570     IF PB-CASH-CERT
 18571        MOVE 'C'                    TO CM-ENTRY-STATUS.
 18572
 18573     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 18574     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 18575     IF PB-POLICY-IS-DECLINED
 18576        MOVE 'D'                    TO CM-ENTRY-STATUS.
 18577
 18578     IF PB-POLICY-IS-VOIDED
 18579        MOVE 'V'                    TO CM-ENTRY-STATUS.
 18580
 18581     IF PB-NEEDS-UNDERWRITING
 18582        MOVE 'U'                    TO CM-ENTRY-STATUS.
 18583
 18584     IF PB-REIN-ONLY-CERT
 18585        MOVE '9'                    TO CM-ENTRY-STATUS.
 18586
 18587     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 18588         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 18589     ELSE
 18590         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 18591
 18592     IF PB-RECORD-RETURNED
 18593        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 18594      ELSE
 18595        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 18596
 18597     IF PB-I-MAIL-ADDRS-PRESENT
 18598        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 18599
 18600     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 18601                                       CM-ENTRY-DT.
 18602
 18603 4999-EXIT.
 18604     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 337
* EL050.cbl
 18606
 18607 5000-PROCESS-REPS.
 18608     MOVE ' '                    TO AGTC-MASTER-SW
 18609     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 18610     MOVE CO-TYPE                TO AGTC-TYPE
 18611     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 18612     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 18613     IF (AGTC-MASTER-SW NOT = 'N')
 18614        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 18615        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 18616        PERFORM 8583-READ-ERAGTC-NEXT
 18617                                 THRU 8583-EXIT
 18618     END-IF
 18619     IF AGTC-MASTER-SW = 'N'
 18620        CONTINUE
 18621     ELSE
 18622        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 18623           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 18624              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 18625              MOVE 'Y'           TO AGTC-MASTER-SW
 18626           END-IF
 18627        END-IF
 18628     END-IF
 18629     .
 18630 5000-EXIT.
 18631     EXIT.
 18632 6370-EDIT-INPUT-LF-CODE.
 18633     move ' ' to ws-benefit-cd-chg-sw
 18634     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 18635        MOVE +1                  TO SUB
 18636        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 18637        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18638        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18639        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18640        GO TO 6370-SEARCH-LOOP.
 18641
 18642     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18643
 18644     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18645     MOVE SPACES                 TO CNTL-ACCESS.
 18646*    MOVE 'L'                    TO CNTL-REC-TYPE.
 18647     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 18648     MOVE +0                     TO CNTL-SEQ-NO.
 18649     MOVE '4' TO RC-SW-2.
 18650     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18651
 18652     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18653        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18654        GO TO 6370-NO-LF-FOUND.
 18655
 18656     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 18657     MOVE +1                     TO SUB.
 18658
 18659 6370-SEARCH-LOOP.
 18660     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 18661         GO TO 6370-NO-LF-FOUND.
 18662
 18663     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 338
* EL050.cbl
 18664        if (pb-i-lf-benefit-cd not = zeros and spaces)
 18665           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 18666           set benefit-code-chg to true
 18667        end-if
 18668        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 18669        GO TO 6370-HER-NET-PAY-CHECK.
 18670
 18671     ADD 1   TO SUB.
 18672*    IF SUB GREATER 120
 18673     IF SUB GREATER 200
 18674         GO TO 6370-NO-LF-FOUND.
 18675
 18676     GO TO 6370-SEARCH-LOOP.
 18677
 18678 6370-NO-LF-FOUND.
 18679
 18680     if (pb-i-lf-benefit-cd not = zeros and spaces)
 18681        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 18682        set benefit-code-chg to true
 18683     end-if
 18684     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 18685
 18686 6370-HER-NET-PAY-CHECK.
 18687
 18688     IF PB-COMPANY-ID = 'CID'
 18689        IF PB-SV-STATE = 'CA' OR 'MN'
 18690           IF PB-I-LF-BENEFIT-CD = '02'
 18691              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 18692           ELSE
 18693              IF PB-I-LF-BENEFIT-CD = '04'
 18694                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 18695              END-IF
 18696           END-IF
 18697        END-IF
 18698     END-IF
 18699
 18700     IF PB-COMPANY-ID NOT = 'HER'
 18701         GO TO 6370-EXIT.
 18702
 18703     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 18704         GO TO 6370-EXIT.
 18705
 18706     IF PB-I-LF-TERM NOT NUMERIC
 18707         MOVE ZEROS              TO PB-I-LF-TERM.
 18708
 18709     IF PB-I-LOAN-TERM NOT NUMERIC
 18710         MOVE ZEROS              TO PB-I-LOAN-TERM.
 18711
 18712     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 18713         GO TO 6370-EXIT.
 18714
 18715     IF PB-I-LF-BENEFIT-CD = '33'
 18716         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 18717
 18718     IF PB-I-LF-BENEFIT-CD = '34'
 18719         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 18720
 18721 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 339
* EL050.cbl
 18722     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 340
* EL050.cbl
 18724
 18725 6380-EDIT-INPUT-AH-CODE.
 18726     IF WK-AH-EDIT-ADDR NOT = ZEROS
 18727        MOVE +1                  TO SUB
 18728        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 18729        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18730        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18731        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18732        GO TO 6380-SEARCH-LOOP.
 18733
 18734     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18735
 18736     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18737     MOVE SPACES                 TO CNTL-ACCESS.
 18738     MOVE 'A'                    TO CNTL-REC-TYPE.
 18739*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 18740     MOVE +0                     TO CNTL-SEQ-NO.
 18741     MOVE '5' TO RC-SW-2.
 18742     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18743
 18744     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18745        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18746        GO TO 6380-NO-AH-FOUND.
 18747
 18748     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 18749     MOVE +1 TO SUB.
 18750
 18751 6380-SEARCH-LOOP.
 18752     IF CF-AH-CODE-OUT (SUB) = ZEROS
 18753         GO TO 6380-NO-AH-FOUND.
 18754
 18755     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 18756         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 18757         GO TO 6380-CSO-AH-ONLY-CHECKS.
 18758
 18759     ADD 1   TO SUB.
 18760     IF SUB GREATER THAN 96
 18761*    IF SUB GREATER THAN 300
 18762         GO TO 6380-NO-AH-FOUND.
 18763
 18764     GO TO 6380-SEARCH-LOOP.
 18765
 18766 6380-NO-AH-FOUND.
 18767
 18768     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 18769
 18770     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 18771         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 18772     ELSE
 18773         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 18774
 18775 6380-CSO-AH-ONLY-CHECKS.
 18776
 18777     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 18778        NEXT SENTENCE
 18779      ELSE
 18780        GO TO 6380-EXIT.
 18781
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 341
* EL050.cbl
 18782     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 18783         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 18784
 18785
 18786     GO TO 6380-EXIT
 18787     .
 18788 6380-CSO-LIFE-WITH-AH-CHECKS.
 18789
 18790
 18791     .
 18792 6380-EXIT.
 18793     EXIT.
 18794
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 342
* EL050.cbl
 18796
 18797 6400-COMPUTE-EXTENSION-DAYS.
 18798
 18799******************************************************************
 18800*                                                                *
 18801*                   COMPUTE EXTENSION DAYS                       *
 18802*                                                                *
 18803*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 18804*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 18805*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 18806*    THE EXTENSION DAYS.                                         *
 18807*                                                                *
 18808******************************************************************
 18809
 18810     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 18811     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 18812
 18813******************************************************************
 18814*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 18815*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 18816******************************************************************
 18817
 18818     IF DC-ELAPSED-MONTHS GREATER THAN +0
 18819        COMPUTE WS-ODD-DAYS-OVER =
 18820               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 18821     ELSE
 18822        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 18823
 18824     IF WS-ODD-DAYS-OVER = ZEROS
 18825           GO TO 6499-EXIT
 18826     ELSE
 18827        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 18828           IF WS-WDF-MONTH = 02
 18829              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 18830              ADD 2       TO  WS-ODD-DAYS-OVER
 18831              GO TO 6499-EXIT
 18832           ELSE
 18833              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 18834                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 18835                 GO TO 6499-EXIT
 18836               ELSE
 18837                 GO TO 6499-EXIT
 18838        ELSE
 18839           GO TO 6499-EXIT.
 18840
 18841 6412-CHECK-TO-DAY.
 18842
 18843        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 18844           IF WS-WDT-DAY = 28
 18845              ADD 2              TO WS-ODD-DAYS-OVER
 18846           ELSE
 18847              IF WS-WDT-DAY = 29
 18848                 ADD 1           TO WS-ODD-DAYS-OVER
 18849              ELSE
 18850                 NEXT SENTENCE
 18851        ELSE
 18852           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 18853              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 343
* EL050.cbl
 18854
 18855     GO TO 6499-EXIT.
 18856
 18857
 18858 6415-CHECK-LEAP-YEAR.
 18859
 18860     IF DC-DAYS-IN-MONTH = 29
 18861        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 18862
 18863 6415-EXIT.
 18864     EXIT.
 18865
 18866 6499-EXIT.
 18867      EXIT.
 18868
 18869 6500-END.
 18870     EXIT.
 18871
 18872
 18873******************************************************************
 18874************* PROCEDURE DIVISION FOR EL050 ***********************
 18875********************** ELC50PD END *******************************
 18876
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 344
* EL050.cbl
 18878
 18879**START***********************************************************
 18880*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 18881*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 18882******************************************************************
 18883*
 18884 6600-GET-STATE-MUNICIPAL-TAX.
 18885
 18886     IF PB-COMPANY-ID NOT = 'DMD'
 18887         GO TO 6640-EXIT.
 18888
 18889     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 18890     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 18891     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 18892*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 18893*
 18894***  Y2K PROJ 7744
 18895     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18896     SET BIN-TO-GREG          TO TRUE.
 18897     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18898
 18899     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18900
 18901     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 18902     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 18903
 18904
 18905* EXEC CICS HANDLE CONDITION
 18906*        INVREQ    (6610-START-BROWSE)
 18907*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18908*        NOTFND    (6630-END-OF-FILE)
 18909*    END-EXEC.
 18910*    MOVE '"$8JI                 ! # #00018894' TO DFHEIV0
 18911     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 18912     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18913     MOVE X'2320233030303138383934' TO DFHEIV0(25:11)
 18914     CALL 'kxdfhei1' USING DFHEIV0
 18915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18916
 18917
 18918 6610-START-BROWSE.
 18919
 18920
 18921* EXEC CICS HANDLE CONDITION
 18922*        NOTFND    (6630-END-OF-FILE)
 18923*        DISABLED  (6630-ERRESS-PROBLEM)
 18924*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18925*        ENDFILE   (6630-END-OF-FILE)
 18926*    END-EXEC.
 18927*    MOVE '"$IcJ''                ! $ #00018902' TO DFHEIV0
 18928     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18929     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18930     MOVE X'2420233030303138393032' TO DFHEIV0(25:11)
 18931     CALL 'kxdfhei1' USING DFHEIV0
 18932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18933
 18934
 18935
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 345
* EL050.cbl
 18936* EXEC CICS STARTBR
 18937*        DATASET (FILE-ID-ERRESS)
 18938*        RIDFLD  (WS-ERRESS-KEY)
 18939*        GTEQ
 18940*    END-EXEC.
 18941     MOVE 0
 18942       TO DFHEIV11
 18943*    MOVE '&,         G          &   #00018909' TO DFHEIV0
 18944     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18945     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18946     MOVE X'2020233030303138393039' TO DFHEIV0(25:11)
 18947     CALL 'kxdfhei1' USING DFHEIV0,
 18948           FILE-ID-ERRESS,
 18949           WS-ERRESS-KEY,
 18950           DFHEIV99,
 18951           DFHEIV11,
 18952           DFHEIV99
 18953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18954
 18955
 18956 6620-READ-NEXT-ERRESS-MASTER.
 18957
 18958
 18959* EXEC CICS HANDLE CONDITION
 18960*        NOTFND    (6630-END-OF-FILE)
 18961*        ENDFILE   (6630-END-OF-FILE)
 18962*        DISABLED  (6630-ERRESS-PROBLEM)
 18963*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18964*    END-EXEC.
 18965*    MOVE '"$I''cJ                ! % #00018917' TO DFHEIV0
 18966     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 18967     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18968     MOVE X'2520233030303138393137' TO DFHEIV0(25:11)
 18969     CALL 'kxdfhei1' USING DFHEIV0
 18970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18971
 18972
 18973
 18974* EXEC CICS READNEXT
 18975*        DATASET (FILE-ID-ERRESS)
 18976*        INTO    (RESIDENT-STATE-TAX-MASTER)
 18977*        RIDFLD  (WS-ERRESS-KEY)
 18978*    END-EXEC.
 18979     MOVE LENGTH OF
 18980      RESIDENT-STATE-TAX-MASTER
 18981       TO DFHEIV12
 18982     MOVE 0
 18983       TO DFHEIV11
 18984*    MOVE '&.IL                  )   #00018924' TO DFHEIV0
 18985     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18986     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18987     MOVE X'2020233030303138393234' TO DFHEIV0(25:11)
 18988     CALL 'kxdfhei1' USING DFHEIV0,
 18989           FILE-ID-ERRESS,
 18990           RESIDENT-STATE-TAX-MASTER,
 18991           DFHEIV12,
 18992           WS-ERRESS-KEY,
 18993           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 346
* EL050.cbl
 18994           DFHEIV11,
 18995           DFHEIV99,
 18996           DFHEIV99
 18997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18998
 18999
 19000     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 19001
 19002* EXEC CICS ENDBR
 19003*            DATASET (FILE-ID-ERRESS)
 19004*       END-EXEC
 19005     MOVE 0
 19006       TO DFHEIV11
 19007*    MOVE '&2                    $   #00018931' TO DFHEIV0
 19008     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19009     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19010     MOVE X'2020233030303138393331' TO DFHEIV0(25:11)
 19011     CALL 'kxdfhei1' USING DFHEIV0,
 19012           FILE-ID-ERRESS,
 19013           DFHEIV11,
 19014           DFHEIV99
 19015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19016        GO TO 6630-END-OF-FILE.
 19017
 19018     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 19019        NEXT SENTENCE
 19020      ELSE
 19021        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 19022
 19023*IS IT LIFE(1) OR IS IT P&C(2) ?????
 19024*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 19025*
 19026     MOVE +2                     TO WS-SUB1.
 19027
 19028     IF PB-ISSUE
 19029     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 19030        MOVE +1                  TO WS-SUB1.
 19031
 19032     IF PB-CANCELLATION
 19033     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 19034        MOVE +1                  TO WS-SUB1.
 19035*
 19036*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 19037*
 19038***  Y2K PROJ 7744
 19039     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 19040***  Y2K PROJ 7744
 19041
 19042*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 19043* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 19044* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 19045
 19046     ADD 1                    TO WS-YEAR-YY.
 19047
 19048     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 19049         MOVE RES-REN-STATE-TAX (WS-SUB1)
 19050                              TO WS-RES-STATE-TAX
 19051         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 347
* EL050.cbl
 19052                              TO WS-RES-MUNI-TAX
 19053     ELSE
 19054         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 19055                              TO WS-RES-STATE-TAX
 19056         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 19057                              TO WS-RES-MUNI-TAX.
 19058
 19059*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 19060
 19061     IF PB-CANCELLATION
 19062         GO TO 6640-CANCEL-TAX.
 19063
 19064     IF PB-I-LF-PREMIUM-AMT > ZEROS
 19065         COMPUTE PB-I-STATE-TAX ROUNDED =
 19066                                   PB-I-LF-PREMIUM-AMT
 19067                                 * WS-RES-STATE-TAX
 19068         COMPUTE PB-I-MUNI-TAX ROUNDED =
 19069                                   PB-I-LF-PREMIUM-AMT
 19070                                 * WS-RES-MUNI-TAX
 19071     ELSE
 19072     IF PB-I-AH-PREMIUM-AMT > ZEROS
 19073         COMPUTE PB-I-STATE-TAX ROUNDED =
 19074                                   PB-I-AH-PREMIUM-AMT
 19075                                 * WS-RES-STATE-TAX
 19076         COMPUTE PB-I-MUNI-TAX ROUNDED =
 19077                                   PB-I-AH-PREMIUM-AMT
 19078                                 * WS-RES-MUNI-TAX.
 19079
 19080
 19081* EXEC CICS ENDBR
 19082*         DATASET (FILE-ID-ERRESS)
 19083*    END-EXEC.
 19084     MOVE 0
 19085       TO DFHEIV11
 19086*    MOVE '&2                    $   #00018998' TO DFHEIV0
 19087     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19088     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19089     MOVE X'2020233030303138393938' TO DFHEIV0(25:11)
 19090     CALL 'kxdfhei1' USING DFHEIV0,
 19091           FILE-ID-ERRESS,
 19092           DFHEIV11,
 19093           DFHEIV99
 19094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19095
 19096
 19097     GO TO 6640-EXIT.
 19098
 19099 6640-CANCEL-TAX.
 19100     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 19101
 19102     IF PB-C-LF-CANCEL-AMT > ZEROS
 19103         COMPUTE PB-CI-STATE-TAX ROUNDED =
 19104                                   PB-C-LF-CANCEL-AMT
 19105                                 * WS-RES-STATE-TAX
 19106         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 19107                                   PB-C-LF-CANCEL-AMT
 19108                                *  WS-RES-MUNI-TAX
 19109     ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 348
* EL050.cbl
 19110     IF PB-C-AH-CANCEL-AMT > ZEROS
 19111         COMPUTE PB-CI-STATE-TAX ROUNDED =
 19112                                   PB-C-AH-CANCEL-AMT
 19113                                 * WS-RES-STATE-TAX
 19114         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 19115                                   PB-C-AH-CANCEL-AMT
 19116                                *  WS-RES-MUNI-TAX.
 19117
 19118
 19119* EXEC CICS ENDBR
 19120*         DATASET (FILE-ID-ERRESS)
 19121*    END-EXEC.
 19122     MOVE 0
 19123       TO DFHEIV11
 19124*    MOVE '&2                    $   #00019023' TO DFHEIV0
 19125     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19126     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19127     MOVE X'2020233030303139303233' TO DFHEIV0(25:11)
 19128     CALL 'kxdfhei1' USING DFHEIV0,
 19129           FILE-ID-ERRESS,
 19130           DFHEIV11,
 19131           DFHEIV99
 19132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19133
 19134
 19135     GO TO 6640-EXIT.
 19136
 19137 6630-END-OF-FILE.
 19138     MOVE ER-8002              TO WS-ERROR.
 19139     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19140
 19141     GO TO 6640-EXIT.
 19142
 19143 6630-ERRESS-PROBLEM.
 19144     MOVE ER-8044              TO WS-ERROR.
 19145     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19146
 19147 6640-EXIT.
 19148     EXIT.
 19149
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 349
* EL050.cbl
 19151 6650-GET-RES-STATE-COMM.
 19152
 19153     IF PB-COMPANY-ID NOT = 'DMD'
 19154         GO TO 6700-COMM-EXIT.
 19155
 19156     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 19157     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 19158     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 19159     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 19160     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 19161     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 19162     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 19163
 19164*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 19165*
 19166***  Y2K PROJ 7744
 19167     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 19168     SET BIN-TO-GREG          TO TRUE.
 19169     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 19170
 19171     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 19172***  Y2K PROJ 7744
 19173
 19174     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 19175
 19176
 19177* EXEC CICS HANDLE CONDITION
 19178*        INVREQ    (6660-START-BROWSE)
 19179*        DISABLED  (6690-ERRESC-PROBLEM)
 19180*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19181*        NOTFND    (6690-END-OF-FILE)
 19182*    END-EXEC.
 19183*    MOVE '"$8cJI                ! & #00019068' TO DFHEIV0
 19184     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 19185     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19186     MOVE X'2620233030303139303638' TO DFHEIV0(25:11)
 19187     CALL 'kxdfhei1' USING DFHEIV0
 19188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19189
 19190
 19191
 19192* EXEC CICS RESETBR
 19193*        DATASET (FILE-ID-ERRESC)
 19194*        RIDFLD  (WS-ERRESC-KEY)
 19195*    END-EXEC.
 19196     MOVE 0
 19197       TO DFHEIV11
 19198*    MOVE '&4         G          &   #00019075' TO DFHEIV0
 19199     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19200     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19201     MOVE X'2020233030303139303735' TO DFHEIV0(25:11)
 19202     CALL 'kxdfhei1' USING DFHEIV0,
 19203           FILE-ID-ERRESC,
 19204           WS-ERRESC-KEY,
 19205           DFHEIV99,
 19206           DFHEIV11,
 19207           DFHEIV99
 19208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 350
* EL050.cbl
 19209
 19210
 19211 6660-START-BROWSE.
 19212
 19213
 19214* EXEC CICS HANDLE CONDITION
 19215*        NOTFND    (6690-END-OF-FILE)
 19216*        DISABLED  (6690-ERRESC-PROBLEM)
 19217*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19218*        ENDFILE   (6690-END-OF-FILE)
 19219*    END-EXEC.
 19220*    MOVE '"$IcJ''                ! '' #00019082' TO DFHEIV0
 19221     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19222     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19223     MOVE X'2720233030303139303832' TO DFHEIV0(25:11)
 19224     CALL 'kxdfhei1' USING DFHEIV0
 19225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19226
 19227
 19228
 19229* EXEC CICS STARTBR
 19230*        DATASET (FILE-ID-ERRESC)
 19231*        RIDFLD  (WS-ERRESC-KEY)
 19232*        GTEQ
 19233*    END-EXEC.
 19234     MOVE 0
 19235       TO DFHEIV11
 19236*    MOVE '&,         G          &   #00019089' TO DFHEIV0
 19237     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19238     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19239     MOVE X'2020233030303139303839' TO DFHEIV0(25:11)
 19240     CALL 'kxdfhei1' USING DFHEIV0,
 19241           FILE-ID-ERRESC,
 19242           WS-ERRESC-KEY,
 19243           DFHEIV99,
 19244           DFHEIV11,
 19245           DFHEIV99
 19246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19247
 19248
 19249     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 19250
 19251 6670-READ-NEXT-ERRESC-MASTER.
 19252
 19253
 19254* EXEC CICS HANDLE CONDITION
 19255*        NOTFND    (6690-END-OF-FILE)
 19256*        DISABLED  (6690-ERRESC-PROBLEM)
 19257*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19258*        ENDFILE   (6690-END-OF-FILE)
 19259*    END-EXEC.
 19260*    MOVE '"$IcJ''                ! ( #00019099' TO DFHEIV0
 19261     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19262     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19263     MOVE X'2820233030303139303939' TO DFHEIV0(25:11)
 19264     CALL 'kxdfhei1' USING DFHEIV0
 19265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19266
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 351
* EL050.cbl
 19267
 19268
 19269* EXEC CICS READNEXT
 19270*        DATASET (FILE-ID-ERRESC)
 19271*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 19272*        RIDFLD  (ERRESC-RECORD-KEY)
 19273*    END-EXEC.
 19274     MOVE LENGTH OF
 19275      ACCOUNT-RESIDENT-ST-COMMISSION
 19276       TO DFHEIV12
 19277     MOVE 0
 19278       TO DFHEIV11
 19279*    MOVE '&.IL                  )   #00019106' TO DFHEIV0
 19280     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19281     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19282     MOVE X'2020233030303139313036' TO DFHEIV0(25:11)
 19283     CALL 'kxdfhei1' USING DFHEIV0,
 19284           FILE-ID-ERRESC,
 19285           ACCOUNT-RESIDENT-ST-COMMISSION,
 19286           DFHEIV12,
 19287           ERRESC-RECORD-KEY,
 19288           DFHEIV99,
 19289           DFHEIV11,
 19290           DFHEIV99,
 19291           DFHEIV99
 19292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19293
 19294
 19295     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 19296        NEXT SENTENCE
 19297     ELSE
 19298
 19299* EXEC CICS ENDBR
 19300*            DATASET (FILE-ID-ERRESC)
 19301*       END-EXEC
 19302     MOVE 0
 19303       TO DFHEIV11
 19304*    MOVE '&2                    $   #00019115' TO DFHEIV0
 19305     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19306     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19307     MOVE X'2020233030303139313135' TO DFHEIV0(25:11)
 19308     CALL 'kxdfhei1' USING DFHEIV0,
 19309           FILE-ID-ERRESC,
 19310           DFHEIV11,
 19311           DFHEIV99
 19312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19313        GO TO 6690-END-OF-FILE.
 19314
 19315     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 19316
 19317* EXEC CICS ENDBR
 19318*            DATASET (FILE-ID-ERRESC)
 19319*       END-EXEC
 19320     MOVE 0
 19321       TO DFHEIV11
 19322*    MOVE '&2                    $   #00019121' TO DFHEIV0
 19323     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19324     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 352
* EL050.cbl
 19325     MOVE X'2020233030303139313231' TO DFHEIV0(25:11)
 19326     CALL 'kxdfhei1' USING DFHEIV0,
 19327           FILE-ID-ERRESC,
 19328           DFHEIV11,
 19329           DFHEIV99
 19330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19331        GO TO 6690-END-OF-FILE.
 19332
 19333     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 19334        NEXT SENTENCE
 19335      ELSE
 19336        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 19337
 19338* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 19339*
 19340     MOVE ZEROS               TO WS-SUB WS-SUB1.
 19341
 19342     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 19343
 19344     IF WS-SUB1 > ZERO
 19345         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 19346             PERFORM 6680-SET-COMMISSION
 19347         ELSE
 19348             PERFORM 6680-SET-TABLE-CODE.
 19349
 19350
 19351* EXEC CICS ENDBR
 19352*         DATASET (FILE-ID-ERRESC)
 19353*    END-EXEC.
 19354     MOVE 0
 19355       TO DFHEIV11
 19356*    MOVE '&2                    $   #00019143' TO DFHEIV0
 19357     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19358     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19359     MOVE X'2020233030303139313433' TO DFHEIV0(25:11)
 19360     CALL 'kxdfhei1' USING DFHEIV0,
 19361           FILE-ID-ERRESC,
 19362           DFHEIV11,
 19363           DFHEIV99
 19364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19365
 19366
 19367     GO TO 6700-COMM-EXIT.
 19368
 19369 6680-SET-TABLE-CODE.
 19370     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 19371        MOVE ZEROS             TO WS-SUB1
 19372     ELSE
 19373* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 19374* TO COMPUTE AH COMMISSION.
 19375        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 19376        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 19377        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 19378        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 19379        PERFORM 6680-READ-CTBL-TABLE
 19380        IF WS-CTBL-READ-SW NOT = 'Y'
 19381           MOVE ZEROS          TO WS-SUB1.
 19382
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 353
* EL050.cbl
 19383 6680-READ-CTBL-TABLE.
 19384*
 19385* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 19386* TO COMPUTE LIFE COMMISSION
 19387
 19388     IF CTBL-SW = '0540'
 19389        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 19390        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 19391        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 19392
 19393     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 19394
 19395     IF CTBL-TABLE-FOUND
 19396        IF CTBL-SW = '0530'
 19397             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 19398                                    * PB-I-AH-TERM
 19399             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 19400             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 19401        ELSE
 19402             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 19403             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 19404             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 19405     ELSE
 19406        IF FIRST-TIME-THROUGH
 19407            GO TO 6680-READ-CTBL-TABLE
 19408        ELSE
 19409            MOVE ZEROS         TO WS-SUB1.
 19410
 19411 6680-SET-COMMISSION.
 19412     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 19413           MOVE ZEROS          TO WS-SUB1
 19414       ELSE
 19415           MOVE RESC-COMMISSION-PER (WS-SUB)
 19416                               TO WS-COMMISSION
 19417           IF CTBL-SW = '0530'
 19418               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 19419           ELSE
 19420               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 19421
 19422 6680-SEARCH-CATEGORY.
 19423     ADD +1                   TO WS-SUB.
 19424     IF WS-SUB > +12
 19425         GO TO 6680-EXIT.
 19426
 19427     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 19428          MOVE WS-SUB         TO WS-SUB1
 19429          GO TO 6680-EXIT.
 19430
 19431     GO TO 6680-SEARCH-CATEGORY.
 19432
 19433 6680-EXIT.
 19434     EXIT.
 19435
 19436 6690-END-OF-FILE.
 19437     GO TO 6700-COMM-EXIT.
 19438
 19439 6690-ERRESC-PROBLEM.
 19440      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 354
* EL050.cbl
 19441      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19442
 19443      GO TO 6700-COMM-EXIT.
 19444
 19445 6700-COMM-EXIT.
 19446     EXIT.
 19447
 19448 7000-GET-RATE.
 19449
 19450* EXEC CICS LINK
 19451*        PROGRAM    ('ELRATE')
 19452*        COMMAREA   (CALCULATION-PASS-AREA)
 19453*        LENGTH     (CP-COMM-LENGTH)
 19454*    END-EXEC.
 19455     MOVE 'ELRATE' TO DFHEIV1
 19456*    MOVE '."C                   (   #00019229' TO DFHEIV0
 19457     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19458     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19459     MOVE X'2020233030303139323239' TO DFHEIV0(25:11)
 19460     CALL 'kxdfhei1' USING DFHEIV0,
 19461           DFHEIV1,
 19462           CALCULATION-PASS-AREA,
 19463           CP-COMM-LENGTH,
 19464           DFHEIV99,
 19465           DFHEIV99,
 19466           DFHEIV99,
 19467           DFHEIV99
 19468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19469
 19470
 19471 7000-EXIT.
 19472     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 355
* EL050.cbl
 19474 7100-FIND-BENEFIT-IN-STATE.
 19475     MOVE 'N'                    TO BEN-SEARCH-SW.
 19476
 19477     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 19478         VARYING SUB3 FROM 1 BY 1 UNTIL
 19479            ((SUB3 GREATER 50) OR
 19480              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 19481               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 19482
 19483     IF SUB3 NOT = 51
 19484         MOVE 'Y'                TO BEN-SEARCH-SW.
 19485
 19486     GO TO 7199-EXIT.
 19487
 19488 7100-BENEFIT-DUMMY.
 19489
 19490 7100-DUMMY-EXIT.
 19491     EXIT.
 19492
 19493 7199-EXIT.
 19494     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 356
* EL050.cbl
 19496 7200-FIND-BENEFIT.
 19497     MOVE 'N'                    TO BEN-SEARCH-SW.
 19498
 19499     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 19500         VARYING SUB3 FROM 1 BY 1 UNTIL
 19501            ((SUB3 GREATER 8) OR
 19502            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 19503
 19504     IF SUB3 NOT = 9
 19505         MOVE 'Y'                TO BEN-SEARCH-SW.
 19506
 19507     GO TO 7200-EXIT.
 19508
 19509 7200-BENEFIT-DUMMY.
 19510
 19511 7200-DUMMY-EXIT.
 19512     EXIT.
 19513
 19514 7200-EXIT.
 19515     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 357
* EL050.cbl
 19517 7250-LOOK-FOR-RESCINDED-CLAIM.
 19518     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19519                                    W-CL-COMP-CD.
 19520     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19521                                    W-CL-CERT-NO.
 19522
 19523
 19524* EXEC CICS HANDLE CONDITION
 19525*        NOTFND  (7250-CONTINUE)
 19526*        ENDFILE (7250-CONTINUE)
 19527*    END-EXEC.
 19528*    MOVE '"$I''                  ! ) #00019287' TO DFHEIV0
 19529     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19530     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19531     MOVE X'2920233030303139323837' TO DFHEIV0(25:11)
 19532     CALL 'kxdfhei1' USING DFHEIV0
 19533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19534
 19535
 19536
 19537* EXEC CICS IGNORE CONDITION
 19538*        DUPKEY
 19539*    END-EXEC.
 19540*    MOVE '"*$                   !   #00019292' TO DFHEIV0
 19541     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19542     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19543     MOVE X'2020233030303139323932' TO DFHEIV0(25:11)
 19544     CALL 'kxdfhei1' USING DFHEIV0
 19545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19546
 19547
 19548
 19549* EXEC CICS STARTBR
 19550*        DATASET   (CLMS-ID)
 19551*        RIDFLD    (ELMSTR-KEY)
 19552*        GENERIC   EQUAL
 19553*        KEYLENGTH (ELMSTR-LENGTH)
 19554*    END-EXEC.
 19555     MOVE 0
 19556       TO DFHEIV11
 19557*    MOVE '&,   KG    E          &   #00019296' TO DFHEIV0
 19558     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19559     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19560     MOVE X'2020233030303139323936' TO DFHEIV0(25:11)
 19561     CALL 'kxdfhei1' USING DFHEIV0,
 19562           CLMS-ID,
 19563           ELMSTR-KEY,
 19564           ELMSTR-LENGTH,
 19565           DFHEIV11,
 19566           DFHEIV99
 19567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19568
 19569
 19570     MOVE 'Y'                    TO W-BROWSE-SW.
 19571
 19572 7250-NEXT-CLAIM.
 19573
 19574
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 358
* EL050.cbl
 19575* EXEC CICS READNEXT
 19576*        DATASET   (CLMS-ID)
 19577*        RIDFLD    (ELMSTR-KEY)
 19578*        SET       (ADDRESS OF CLAIM-MASTER)
 19579*    END-EXEC.
 19580     MOVE 0
 19581       TO DFHEIV11
 19582*    MOVE '&.S                   )   #00019307' TO DFHEIV0
 19583     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19584     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19585     MOVE X'2020233030303139333037' TO DFHEIV0(25:11)
 19586     CALL 'kxdfhei1' USING DFHEIV0,
 19587           CLMS-ID,
 19588           DFHEIV20,
 19589           DFHEIV99,
 19590           ELMSTR-KEY,
 19591           DFHEIV99,
 19592           DFHEIV11,
 19593           DFHEIV99,
 19594           DFHEIV99
 19595     SET ADDRESS OF CLAIM-MASTER TO
 19596         DFHEIV20
 19597     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19598
 19599
 19600     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19601        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19602         GO TO 7250-CONTINUE
 19603     END-IF.
 19604
 19605     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19606        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19607        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19608        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19609        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19610         GO TO 7250-NEXT-CLAIM
 19611     END-IF.
 19612
 19613     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19614        OR (CL-CLAIM-TYPE = 'I')
 19615        OR (CL-CLAIM-TYPE = 'G')
 19616        OR (CL-CLAIM-TYPE = 'F')
 19617          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19618              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 19619              GO TO 7250-CONTINUE
 19620          END-IF
 19621     END-IF.
 19622
 19623     GO TO 7250-NEXT-CLAIM.
 19624
 19625 7250-CONTINUE.
 19626
 19627     IF W-BROWSE-SW = 'Y'
 19628
 19629* EXEC CICS ENDBR
 19630*            DATASET   (CLMS-ID)
 19631*        END-EXEC
 19632     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 359
* EL050.cbl
 19633       TO DFHEIV11
 19634*    MOVE '&2                    $   #00019341' TO DFHEIV0
 19635     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19636     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19637     MOVE X'2020233030303139333431' TO DFHEIV0(25:11)
 19638     CALL 'kxdfhei1' USING DFHEIV0,
 19639           CLMS-ID,
 19640           DFHEIV11,
 19641           DFHEIV99
 19642     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19643         MOVE 'N' TO W-BROWSE-SW
 19644     END-IF.
 19645
 19646 7250-EXIT.
 19647     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 360
* EL050.cbl
 19649 7300-CHECK-FOR-OPEN-CLMS.
 19650
 19651*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 19652*    MOVE SPACES                 TO CNTL-ACCESS.
 19653*    MOVE '1'                    TO CNTL-REC-TYPE.
 19654*    MOVE +0                     TO CNTL-SEQ-NO.
 19655
 19656*    MOVE '3'                    TO RC-SW-1.
 19657*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 19658
 19659*    IF NOT CF-COMPANY-MASTER
 19660*         PERFORM 0099-COMPANY-NOT-FOUND
 19661*         GO TO 7300-EXIT.
 19662
 19663     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19664                                    W-CL-COMP-CD.
 19665     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19666                                    W-CL-CERT-NO.
 19667
 19668
 19669* EXEC CICS HANDLE CONDITION
 19670*        NOTFND  (7300-CONTINUE)
 19671*        ENDFILE (7300-CONTINUE)
 19672*    END-EXEC.
 19673*    MOVE '"$I''                  ! * #00019369' TO DFHEIV0
 19674     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19675     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19676     MOVE X'2A20233030303139333639' TO DFHEIV0(25:11)
 19677     CALL 'kxdfhei1' USING DFHEIV0
 19678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19679
 19680
 19681
 19682* EXEC CICS IGNORE CONDITION
 19683*        DUPKEY
 19684*    END-EXEC.
 19685*    MOVE '"*$                   !   #00019374' TO DFHEIV0
 19686     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19687     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19688     MOVE X'2020233030303139333734' TO DFHEIV0(25:11)
 19689     CALL 'kxdfhei1' USING DFHEIV0
 19690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19691
 19692
 19693
 19694* EXEC CICS STARTBR
 19695*        DATASET   (CLMS-ID)
 19696*        RIDFLD    (ELMSTR-KEY)
 19697*        GENERIC   EQUAL
 19698*        KEYLENGTH (ELMSTR-LENGTH)
 19699*    END-EXEC.
 19700     MOVE 0
 19701       TO DFHEIV11
 19702*    MOVE '&,   KG    E          &   #00019378' TO DFHEIV0
 19703     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19704     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19705     MOVE X'2020233030303139333738' TO DFHEIV0(25:11)
 19706     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 361
* EL050.cbl
 19707           CLMS-ID,
 19708           ELMSTR-KEY,
 19709           ELMSTR-LENGTH,
 19710           DFHEIV11,
 19711           DFHEIV99
 19712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19713
 19714
 19715     MOVE 'Y'                    TO W-BROWSE-SW.
 19716
 19717 7300-NEXT-CLAIM.
 19718
 19719
 19720* EXEC CICS READNEXT
 19721*        DATASET   (CLMS-ID)
 19722*        RIDFLD    (ELMSTR-KEY)
 19723*        SET       (ADDRESS OF CLAIM-MASTER)
 19724*    END-EXEC.
 19725     MOVE 0
 19726       TO DFHEIV11
 19727*    MOVE '&.S                   )   #00019389' TO DFHEIV0
 19728     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19729     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19730     MOVE X'2020233030303139333839' TO DFHEIV0(25:11)
 19731     CALL 'kxdfhei1' USING DFHEIV0,
 19732           CLMS-ID,
 19733           DFHEIV20,
 19734           DFHEIV99,
 19735           ELMSTR-KEY,
 19736           DFHEIV99,
 19737           DFHEIV11,
 19738           DFHEIV99,
 19739           DFHEIV99
 19740     SET ADDRESS OF CLAIM-MASTER TO
 19741         DFHEIV20
 19742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19743
 19744
 19745     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19746        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19747         GO TO 7300-CONTINUE.
 19748
 19749     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19750        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19751        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19752        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19753        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19754         GO TO 7300-NEXT-CLAIM.
 19755
 19756*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 19757     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19758        OR (CL-CLAIM-TYPE = 'I')
 19759        OR (CL-CLAIM-TYPE = 'G')
 19760        OR (CL-CLAIM-TYPE = 'F')
 19761        IF CLAIM-IS-OPEN
 19762           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19763             AND PB-C-AH-CANCEL-DT > SPACES
 19764              MOVE ER-2896        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 362
* EL050.cbl
 19765              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19766           END-IF
 19767           EVALUATE TRUE
 19768             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 19769                 MOVE ER-2884      TO WS-ERROR
 19770             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 19771                 MOVE ER-2887      TO WS-ERROR
 19772             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 19773                 MOVE ER-2886      TO WS-ERROR
 19774             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 19775                 MOVE ER-2888      TO WS-ERROR
 19776             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 19777                 MOVE ER-2885      TO WS-ERROR
 19778             WHEN OTHER
 19779                 MOVE ER-2768      TO WS-ERROR
 19780           END-EVALUATE
 19781           IF PB-C-AH-CANCEL-VOIDED OR
 19782              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19783                NOT AH-COVERAGE-CANCELLED)
 19784               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19785               MOVE ER-2768      TO WS-ERROR
 19786           END-IF
 19787           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19788           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19789              PB-FORCE-CODE NOT EQUAL '8'
 19790               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19791           END-IF
 19792           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 19793           GO TO 7300-NEXT-CLAIM
 19794        ELSE
 19795           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19796*****THIS IS A RESCISSION OR REFORMATION
 19797              IF AH-COVERAGE-CANCELLED
 19798                 IF WS-ST-CAUSAL-STATE = ('A' OR 'B')
 19799                    MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 19800                    MOVE 1                   TO DC-ELAPSED-DAYS
 19801                    MOVE ZERO                TO DC-ELAPSED-MONTHS
 19802                    SET BIN-PLUS-ELAPSED     TO TRUE
 19803                    PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 19804                    IF NO-CONVERSION-ERROR
 19805                       IF NOT (DC-BIN-DATE-2 = PB-C-AH-CANCEL-DT
 19806                        OR PB-C-AH-CANCEL-DT = CL-CERT-EFF-DT)
 19807                          MOVE ER-2897 TO WS-ERROR
 19808                          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19809                          GO TO 7300-NEXT-CLAIM
 19810                       END-IF
 19811                    END-IF
 19812                 ELSE
 19813                   IF PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT
 19814                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19815                         MOVE ER-2890 TO WS-ERROR
 19816                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19817                         GO TO 7300-NEXT-CLAIM
 19818                      ELSE
 19819                         MOVE ER-2898 TO WS-ERROR
 19820                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19821                         GO TO 7300-NEXT-CLAIM
 19822                      END-IF
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 363
* EL050.cbl
 19823                   END-IF
 19824                 END-IF
 19825              END-IF
 19826           ELSE
 19827              IF CL-DENIAL-TYPE = '1'  AND
 19828                 CL-TOTAL-PAID-AMT = 0
 19829                    GO TO 7300-NEXT-CLAIM
 19830              END-IF
 19831              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19832               AND PB-C-AH-CANCEL-DT > SPACES
 19833                 MOVE ER-2756        TO WS-ERROR
 19834                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19835                 GO TO 7300-NEXT-CLAIM
 19836              END-IF
 19837           END-IF
 19838        END-IF
 19839     ELSE
 19840*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 19841        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 19842           IF (CLAIM-IS-OPEN)
 19843              and ((pb-ci-lf-cancel-amt + pb-c-lf-cancel-amt)
 19844                 <> zeros
 19845              or (pb-ci-ah-cancel-amt + pb-c-ah-cancel-amt)
 19846                 <> zeros)
 19847              MOVE ER-2889      TO WS-ERROR
 19848              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19849              GO TO 7300-NEXT-CLAIM
 19850           ELSE
 19851              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19852*****THIS IS A RESCISSION OR REFORMATION or refor to rescission
 19853                 IF (LF-COVERAGE-CANCELLED AND
 19854                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 19855                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19856                         MOVE ER-2890 TO WS-ERROR
 19857                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19858                         GO TO 7300-NEXT-CLAIM
 19859                      ELSE
 19860                         MOVE ER-2898 TO WS-ERROR
 19861                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19862                         GO TO 7300-NEXT-CLAIM
 19863                      END-IF
 19864                 END-IF
 19865              ELSE
 19866                 IF (CL-DENIAL-TYPE = '1')   *> regular denial
 19867                    and (CL-TOTAL-PAID-AMT = 0)
 19868                    GO TO 7300-NEXT-CLAIM
 19869                 END-IF
 19870                 IF (
 19871                      (AH-COVERAGE-CANCELLED)
 19872                      AND (PB-C-AH-CANCEL-DT <> CL-INCURRED-DT)
 19873                      AND (WS-AH-CLAIM-RESCINDED <> 'Y')
 19874                      and (pb-ci-ah-cancel-amt +
 19875                         pb-c-ah-cancel-amt) <> zeros
 19876                    )
 19877                               OR
 19878                    (
 19879                      (LF-COVERAGE-CANCELLED)
 19880                      AND (PB-C-LF-CANCEL-DT <> CL-INCURRED-DT)
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 364
* EL050.cbl
 19881                      AND (WS-ST-REFUND-CLAIM-FLAG = '4')
 19882                      and (pb-ci-lf-cancel-amt +
 19883                         pb-c-lf-cancel-amt) <> zeros
 19884                    )
 19885                       MOVE ER-2965 TO WS-ERROR
 19886                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19887                       GO TO 7300-NEXT-CLAIM
 19888                 END-IF
 19889                 IF LF-COVERAGE-CANCELLED
 19890                  IF CL-TOTAL-PAID-AMT > 0
 19891                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 19892                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 19893                        MOVE ER-2891 TO WS-ERROR
 19894                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19895                        GO TO 7300-NEXT-CLAIM
 19896                      END-IF
 19897                    ELSE
 19898****only show this error if cert num matches exactly
 19899                      IF PB-CERT-NO = CL-CERT-NO
 19900                         MOVE ER-2892 TO WS-ERROR
 19901                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19902                         GO TO 7300-NEXT-CLAIM
 19903                      END-IF
 19904                    END-IF
 19905                  END-IF
 19906                 END-IF
 19907              END-IF
 19908           END-IF
 19909        END-IF
 19910     END-IF
 19911
 19912     GO TO 7300-NEXT-CLAIM.
 19913
 19914 7300-CONTINUE.
 19915
 19916     IF W-BROWSE-SW = 'Y'
 19917
 19918* EXEC CICS ENDBR
 19919*            DATASET   (CLMS-ID)
 19920*        END-EXEC.
 19921     MOVE 0
 19922       TO DFHEIV11
 19923*    MOVE '&2                    $   #00019567' TO DFHEIV0
 19924     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19925     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19926     MOVE X'2020233030303139353637' TO DFHEIV0(25:11)
 19927     CALL 'kxdfhei1' USING DFHEIV0,
 19928           CLMS-ID,
 19929           DFHEIV11,
 19930           DFHEIV99
 19931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19932
 19933
 19934 7300-EXIT.
 19935     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 365
* EL050.cbl
 19937
 19938 7400-GET-REMAIN-TERM.
 19939
 19940* EXEC CICS LINK
 19941*        PROGRAM    ('ELRTRM')
 19942*        COMMAREA   (CALCULATION-PASS-AREA)
 19943*        LENGTH     (CP-COMM-LENGTH)
 19944*    END-EXEC.
 19945     MOVE 'ELRTRM' TO DFHEIV1
 19946*    MOVE '."C                   (   #00019576' TO DFHEIV0
 19947     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19948     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19949     MOVE X'2020233030303139353736' TO DFHEIV0(25:11)
 19950     CALL 'kxdfhei1' USING DFHEIV0,
 19951           DFHEIV1,
 19952           CALCULATION-PASS-AREA,
 19953           CP-COMM-LENGTH,
 19954           DFHEIV99,
 19955           DFHEIV99,
 19956           DFHEIV99,
 19957           DFHEIV99
 19958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19959
 19960
 19961 7400-EXIT.
 19962     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 366
* EL050.cbl
 19964
 19965 7500-GET-REMAIN-AMOUNT.
 19966
 19967* EXEC CICS LINK
 19968*        PROGRAM    ('ELRAMT')
 19969*        COMMAREA   (CALCULATION-PASS-AREA)
 19970*        LENGTH     (CP-COMM-LENGTH)
 19971*    END-EXEC.
 19972     MOVE 'ELRAMT' TO DFHEIV1
 19973*    MOVE '."C                   (   #00019587' TO DFHEIV0
 19974     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19975     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19976     MOVE X'2020233030303139353837' TO DFHEIV0(25:11)
 19977     CALL 'kxdfhei1' USING DFHEIV0,
 19978           DFHEIV1,
 19979           CALCULATION-PASS-AREA,
 19980           CP-COMM-LENGTH,
 19981           DFHEIV99,
 19982           DFHEIV99,
 19983           DFHEIV99,
 19984           DFHEIV99
 19985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19986
 19987
 19988 7500-EXIT.
 19989     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 367
* EL050.cbl
 19991
 19992 7600-GET-REFUND.
 19993
 19994* EXEC CICS LINK
 19995*        PROGRAM    ('ELRFND')
 19996*        COMMAREA   (CALCULATION-PASS-AREA)
 19997*        LENGTH     (CP-COMM-LENGTH)
 19998*    END-EXEC.
 19999     MOVE 'ELRFND' TO DFHEIV1
 20000*    MOVE '."C                   (   #00019598' TO DFHEIV0
 20001     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20002     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20003     MOVE X'2020233030303139353938' TO DFHEIV0(25:11)
 20004     CALL 'kxdfhei1' USING DFHEIV0,
 20005           DFHEIV1,
 20006           CALCULATION-PASS-AREA,
 20007           CP-COMM-LENGTH,
 20008           DFHEIV99,
 20009           DFHEIV99,
 20010           DFHEIV99,
 20011           DFHEIV99
 20012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20013
 20014
 20015 7600-EXIT.
 20016     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 368
* EL050.cbl
 20018 7700-CALL-DL1.
 20019
 20020* EXEC CICS LINK
 20021*        PROGRAM    ('DLO001')
 20022*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 20023*        LENGTH     (DLO001-COMM-LENGTH)
 20024*    END-EXEC.
 20025     MOVE 'DLO001' TO DFHEIV1
 20026*    MOVE '."C                   (   #00019608' TO DFHEIV0
 20027     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20028     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20029     MOVE X'2020233030303139363038' TO DFHEIV0(25:11)
 20030     CALL 'kxdfhei1' USING DFHEIV0,
 20031           DFHEIV1,
 20032           WS-DLO-MASTER-POLICY-FORM,
 20033           DLO001-COMM-LENGTH,
 20034           DFHEIV99,
 20035           DFHEIV99,
 20036           DFHEIV99,
 20037           DFHEIV99
 20038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20039
 20040
 20041 7700-EXIT.
 20042     EXIT.
 20043
 20044 7710-CALL-DL2.
 20045
 20046* EXEC CICS LINK
 20047*        PROGRAM    ('DLO002')
 20048*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 20049*        LENGTH     (DLO002-COMM-LENGTH)
 20050*    END-EXEC.
 20051     MOVE 'DLO002' TO DFHEIV1
 20052*    MOVE '."C                   (   #00019618' TO DFHEIV0
 20053     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20054     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20055     MOVE X'2020233030303139363138' TO DFHEIV0(25:11)
 20056     CALL 'kxdfhei1' USING DFHEIV0,
 20057           DFHEIV1,
 20058           WS-DLO-INTERNAL-POLICY-FORM,
 20059           DLO002-COMM-LENGTH,
 20060           DFHEIV99,
 20061           DFHEIV99,
 20062           DFHEIV99,
 20063           DFHEIV99
 20064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20065
 20066
 20067 7710-EXIT.
 20068     EXIT.
 20069
 20070 7720-CALL-DL3.
 20071
 20072* EXEC CICS LINK
 20073*        PROGRAM    ('DLO003')
 20074*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 20075*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 369
* EL050.cbl
 20076*    END-EXEC.
 20077     MOVE 'DLO003' TO DFHEIV1
 20078*    MOVE '."C                   (   #00019628' TO DFHEIV0
 20079     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20080     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20081     MOVE X'2020233030303139363238' TO DFHEIV0(25:11)
 20082     CALL 'kxdfhei1' USING DFHEIV0,
 20083           DFHEIV1,
 20084           WS-DLO-VALID-BANK-ID,
 20085           DLO003-COMM-LENGTH,
 20086           DFHEIV99,
 20087           DFHEIV99,
 20088           DFHEIV99,
 20089           DFHEIV99
 20090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20091
 20092
 20093 7720-EXIT.
 20094     EXIT.
 20095
 20096 7730-CALL-DL7.
 20097
 20098* EXEC CICS LINK
 20099*        PROGRAM    ('DLO007')
 20100*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 20101*        LENGTH     (DLO007-COMM-LENGTH)
 20102*    END-EXEC.
 20103     MOVE 'DLO007' TO DFHEIV1
 20104*    MOVE '."C                   (   #00019638' TO DFHEIV0
 20105     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20106     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20107     MOVE X'2020233030303139363338' TO DFHEIV0(25:11)
 20108     CALL 'kxdfhei1' USING DFHEIV0,
 20109           DFHEIV1,
 20110           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 20111           DLO007-COMM-LENGTH,
 20112           DFHEIV99,
 20113           DFHEIV99,
 20114           DFHEIV99,
 20115           DFHEIV99
 20116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20117
 20118
 20119 7730-EXIT.
 20120     EXIT.
 20121
 20122 7740-CALL-DL11.
 20123
 20124* EXEC CICS LINK
 20125*        PROGRAM    ('DLO011')
 20126*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 20127*        LENGTH     (DLO011-COMM-LENGTH)
 20128*    END-EXEC.
 20129     MOVE 'DLO011' TO DFHEIV1
 20130*    MOVE '."C                   (   #00019648' TO DFHEIV0
 20131     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20132     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20133     MOVE X'2020233030303139363438' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 370
* EL050.cbl
 20134     CALL 'kxdfhei1' USING DFHEIV0,
 20135           DFHEIV1,
 20136           WS-DLO-PREM-RATES-BEN-TYPE,
 20137           DLO011-COMM-LENGTH,
 20138           DFHEIV99,
 20139           DFHEIV99,
 20140           DFHEIV99,
 20141           DFHEIV99
 20142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20143
 20144
 20145 7740-EXIT.
 20146     EXIT.
 20147
 20148 7750-CALL-DL17.
 20149
 20150* EXEC CICS LINK
 20151*        PROGRAM    ('DLO017')
 20152*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 20153*        LENGTH     (DLO017-COMM-LENGTH)
 20154*    END-EXEC.
 20155     MOVE 'DLO017' TO DFHEIV1
 20156*    MOVE '."C                   (   #00019658' TO DFHEIV0
 20157     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20158     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20159     MOVE X'2020233030303139363538' TO DFHEIV0(25:11)
 20160     CALL 'kxdfhei1' USING DFHEIV0,
 20161           DFHEIV1,
 20162           WS-DLO-VALID-RATE-CODE,
 20163           DLO017-COMM-LENGTH,
 20164           DFHEIV99,
 20165           DFHEIV99,
 20166           DFHEIV99,
 20167           DFHEIV99
 20168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20169
 20170
 20171 7750-EXIT.
 20172     EXIT.
 20173
 20174 7755-CALL-DL19.
 20175
 20176* EXEC CICS LINK
 20177*        PROGRAM    ('DLO019')
 20178*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 20179*        LENGTH     (DLO019-COMM-LENGTH)
 20180*    END-EXEC.
 20181     MOVE 'DLO019' TO DFHEIV1
 20182*    MOVE '."C                   (   #00019668' TO DFHEIV0
 20183     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20184     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20185     MOVE X'2020233030303139363638' TO DFHEIV0(25:11)
 20186     CALL 'kxdfhei1' USING DFHEIV0,
 20187           DFHEIV1,
 20188           WS-DLO-ORIG-COV-CAT,
 20189           DLO019-COMM-LENGTH,
 20190           DFHEIV99,
 20191           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 371
* EL050.cbl
 20192           DFHEIV99,
 20193           DFHEIV99
 20194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20195
 20196
 20197 7755-EXIT.
 20198     EXIT.
 20199
 20200 7760-CALL-DL21.
 20201
 20202* EXEC CICS LINK
 20203*        PROGRAM    ('DLO021')
 20204*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 20205*        LENGTH     (DLO021-COMM-LENGTH)
 20206*    END-EXEC.
 20207     MOVE 'DLO021' TO DFHEIV1
 20208*    MOVE '."C                   (   #00019678' TO DFHEIV0
 20209     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20210     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20211     MOVE X'2020233030303139363738' TO DFHEIV0(25:11)
 20212     CALL 'kxdfhei1' USING DFHEIV0,
 20213           DFHEIV1,
 20214           WS-DLO-VALID-LOAN-OFFICER,
 20215           DLO021-COMM-LENGTH,
 20216           DFHEIV99,
 20217           DFHEIV99,
 20218           DFHEIV99,
 20219           DFHEIV99
 20220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20221
 20222
 20223 7760-EXIT.
 20224     EXIT.
 20225
 20226 7770-CALL-DL22.
 20227
 20228* EXEC CICS LINK
 20229*        PROGRAM    ('DLO022')
 20230*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 20231*        LENGTH     (DLO022-COMM-LENGTH)
 20232*    END-EXEC.
 20233     MOVE 'DLO022' TO DFHEIV1
 20234*    MOVE '."C                   (   #00019688' TO DFHEIV0
 20235     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20236     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20237     MOVE X'2020233030303139363838' TO DFHEIV0(25:11)
 20238     CALL 'kxdfhei1' USING DFHEIV0,
 20239           DFHEIV1,
 20240           WS-DLO-VALID-STATE-CODE,
 20241           DLO022-COMM-LENGTH,
 20242           DFHEIV99,
 20243           DFHEIV99,
 20244           DFHEIV99,
 20245           DFHEIV99
 20246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20247
 20248
 20249 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 372
* EL050.cbl
 20250     EXIT.
 20251
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 373
* EL050.cbl
 20253
 20254 7780-CALL-AGG.
 20255
 20256* EXEC CICS LINK
 20257*        PROGRAM    ('ELAGGO')
 20258*        COMMAREA   (WS-PASS-to-pemaggo)
 20259*        LENGTH     (ws-passed-key-LENGTH)
 20260*    END-EXEC.
 20261     MOVE 'ELAGGO' TO DFHEIV1
 20262*    MOVE '."C                   (   #00019700' TO DFHEIV0
 20263     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20264     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20265     MOVE X'2020233030303139373030' TO DFHEIV0(25:11)
 20266     CALL 'kxdfhei1' USING DFHEIV0,
 20267           DFHEIV1,
 20268           WS-PASS-to-pemaggo,
 20269           ws-passed-key-LENGTH,
 20270           DFHEIV99,
 20271           DFHEIV99,
 20272           DFHEIV99,
 20273           DFHEIV99
 20274     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20275
 20276 7780-EXIT.
 20277     EXIT.
 20278 7785-CALL-HLDI.
 20279
 20280* EXEC CICS LINK
 20281*        PROGRAM    ('ELHLDI')
 20282*        COMMAREA   (HLDI-PASS-AREA)
 20283*        LENGTH     (HLDI-PASS-AREA-LEN)
 20284*    END-EXEC.
 20285     MOVE 'ELHLDI' TO DFHEIV1
 20286*    MOVE '."C                   (   #00019708' TO DFHEIV0
 20287     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20288     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20289     MOVE X'2020233030303139373038' TO DFHEIV0(25:11)
 20290     CALL 'kxdfhei1' USING DFHEIV0,
 20291           DFHEIV1,
 20292           HLDI-PASS-AREA,
 20293           HLDI-PASS-AREA-LEN,
 20294           DFHEIV99,
 20295           DFHEIV99,
 20296           DFHEIV99,
 20297           DFHEIV99
 20298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20299
 20300 7785-EXIT.
 20301     EXIT.
 20302 7786-CALL-HLDIM.
 20303
 20304* EXEC CICS LINK
 20305*        PROGRAM    ('ELHLDIM')
 20306*        COMMAREA   (HLDI-PASS-AREA)
 20307*        LENGTH     (HLDI-PASS-AREA-LEN)
 20308*    END-EXEC.
 20309     MOVE 'ELHLDIM' TO DFHEIV1
 20310*    MOVE '."C                   (   #00019716' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 374
* EL050.cbl
 20311     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20312     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20313     MOVE X'2020233030303139373136' TO DFHEIV0(25:11)
 20314     CALL 'kxdfhei1' USING DFHEIV0,
 20315           DFHEIV1,
 20316           HLDI-PASS-AREA,
 20317           HLDI-PASS-AREA-LEN,
 20318           DFHEIV99,
 20319           DFHEIV99,
 20320           DFHEIV99,
 20321           DFHEIV99
 20322     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20323
 20324 7786-EXIT.
 20325     EXIT.
 20326 7800-REWRITE-CERT.
 20327******************************************************************
 20328*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 20329*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 20330******************************************************************
 20331
 20332     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 20333        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 20334        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 20335        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 20336
 20337* EXEC CICS REWRITE
 20338*                  DATASET (CERT-ID)
 20339*                  FROM    (CERTIFICATE-MASTER)
 20340*              END-EXEC
 20341     MOVE LENGTH OF
 20342      CERTIFICATE-MASTER
 20343       TO DFHEIV11
 20344*    MOVE '&& L                  %   #00019733' TO DFHEIV0
 20345     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20346     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20347     MOVE X'2020233030303139373333' TO DFHEIV0(25:11)
 20348     CALL 'kxdfhei1' USING DFHEIV0,
 20349           CERT-ID,
 20350           CERTIFICATE-MASTER,
 20351           DFHEIV11,
 20352           DFHEIV99
 20353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20354        GO TO 7800-EXIT.
 20355
 20356       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 20357       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 20358
 20359 7800-EXIT.
 20360      EXIT.
 20361
 20362 7900-DELETE-CERT.
 20363
 20364* EXEC CICS DELETE
 20365*        DATASET (CERT-ID)
 20366*    END-EXEC.
 20367*    MOVE '&(                    &   #00019746' TO DFHEIV0
 20368     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 375
* EL050.cbl
 20369     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20370     MOVE X'2020233030303139373436' TO DFHEIV0(25:11)
 20371     CALL 'kxdfhei1' USING DFHEIV0,
 20372           CERT-ID,
 20373           DFHEIV99,
 20374           DFHEIV99,
 20375           DFHEIV99,
 20376           DFHEIV99
 20377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20378
 20379
 20380 7900-EXIT.
 20381     EXIT.
 20382
 20383 8000-WRITE-CERT.
 20384
 20385* EXEC CICS HANDLE CONDITION
 20386*        DUPKEY    (8000-FREE-MAIN)
 20387*    END-EXEC.
 20388*    MOVE '"$$                   ! + #00019754' TO DFHEIV0
 20389     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 20390     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20391     MOVE X'2B20233030303139373534' TO DFHEIV0(25:11)
 20392     CALL 'kxdfhei1' USING DFHEIV0
 20393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20394
 20395
 20396
 20397* EXEC CICS WRITE
 20398*        DATASET     (CERT-ID)
 20399*        FROM        (CERTIFICATE-MASTER)
 20400*        RIDFLD      (ELCERT-KEY)
 20401*    END-EXEC.
 20402     MOVE LENGTH OF
 20403      CERTIFICATE-MASTER
 20404       TO DFHEIV11
 20405*    MOVE '&$ L                  ''   #00019758' TO DFHEIV0
 20406     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20407     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20408     MOVE X'2020233030303139373538' TO DFHEIV0(25:11)
 20409     CALL 'kxdfhei1' USING DFHEIV0,
 20410           CERT-ID,
 20411           CERTIFICATE-MASTER,
 20412           DFHEIV11,
 20413           ELCERT-KEY,
 20414           DFHEIV99,
 20415           DFHEIV99
 20416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20417
 20418
 20419 8000-FREE-MAIN.
 20420
 20421 8000-EXIT.
 20422      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 376
* EL050.cbl
 20424
 20425 8100-READ-ERPNDM.
 20426
 20427* EXEC CICS HANDLE CONDITION
 20428*         NOTFND     (8100-NOTFND)
 20429*         ENDFILE    (8100-NOTFND)
 20430*    END-EXEC.
 20431*    MOVE '"$I''                  ! , #00019771' TO DFHEIV0
 20432     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20433     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20434     MOVE X'2C20233030303139373731' TO DFHEIV0(25:11)
 20435     CALL 'kxdfhei1' USING DFHEIV0
 20436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20437
 20438
 20439     MOVE SPACES                 TO ERPNDM-FOUND.
 20440     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 20441
 20442
 20443* EXEC CICS READ
 20444*         DATASET   (FILE-ERPNDM)
 20445*         RIDFLD    (PM-CONTROL-PRIMARY)
 20446*         INTO      (PENDING-MAILING-DATA)
 20447*    END-EXEC.
 20448     MOVE LENGTH OF
 20449      PENDING-MAILING-DATA
 20450       TO DFHEIV11
 20451*    MOVE '&"IL       E          (   #00019779' TO DFHEIV0
 20452     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20453     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20454     MOVE X'2020233030303139373739' TO DFHEIV0(25:11)
 20455     CALL 'kxdfhei1' USING DFHEIV0,
 20456           FILE-ERPNDM,
 20457           PENDING-MAILING-DATA,
 20458           DFHEIV11,
 20459           PM-CONTROL-PRIMARY,
 20460           DFHEIV99,
 20461           DFHEIV99,
 20462           DFHEIV99
 20463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20464
 20465
 20466     GO TO 8100-EXIT.
 20467
 20468 8100-NOTFND.
 20469
 20470     MOVE 'X'                    TO ERPNDM-FOUND.
 20471     MOVE ER-2694                TO WS-ERROR.
 20472     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20473     MOVE ER-2883                TO WS-ERROR
 20474     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 20475     .
 20476 8100-EXIT.
 20477     EXIT.
 20478
 20479 8110-READ-ERMAIL.
 20480
 20481* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 377
* EL050.cbl
 20482*         NOTFND     (8110-NOTFND)
 20483*         ENDFILE    (8110-NOTFND)
 20484*    END-EXEC.
 20485*    MOVE '"$I''                  ! - #00019799' TO DFHEIV0
 20486     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20487     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20488     MOVE X'2D20233030303139373939' TO DFHEIV0(25:11)
 20489     CALL 'kxdfhei1' USING DFHEIV0
 20490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20491
 20492
 20493     MOVE SPACES                 TO ERMAIL-FOUND.
 20494     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 20495     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 20496     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 20497     MOVE PB-SV-STATE            TO MA-STATE.
 20498
 20499
 20500* EXEC CICS READ
 20501*         UPDATE
 20502*         DATASET   (FILE-ERMAIL)
 20503*         RIDFLD    (MA-CONTROL-PRIMARY)
 20504*         INTO      (MAILING-DATA)
 20505*    END-EXEC.
 20506     MOVE LENGTH OF
 20507      MAILING-DATA
 20508       TO DFHEIV11
 20509*    MOVE '&"IL       EU         (   #00019810' TO DFHEIV0
 20510     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20511     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20512     MOVE X'2020233030303139383130' TO DFHEIV0(25:11)
 20513     CALL 'kxdfhei1' USING DFHEIV0,
 20514           FILE-ERMAIL,
 20515           MAILING-DATA,
 20516           DFHEIV11,
 20517           MA-CONTROL-PRIMARY,
 20518           DFHEIV99,
 20519           DFHEIV99,
 20520           DFHEIV99
 20521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20522
 20523
 20524     GO TO 8110-EXIT.
 20525
 20526 8110-NOTFND.
 20527     MOVE 'X'                    TO ERMAIL-FOUND.
 20528
 20529 8110-EXIT.
 20530     EXIT.
 20531
 20532 8120-REWRITE-ERMAIL.
 20533
 20534* EXEC CICS REWRITE
 20535*         DATASET    (FILE-ERMAIL)
 20536*         FROM       (MAILING-DATA)
 20537*    END-EXEC.
 20538     MOVE LENGTH OF
 20539      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 378
* EL050.cbl
 20540       TO DFHEIV11
 20541*    MOVE '&& L                  %   #00019826' TO DFHEIV0
 20542     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20543     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20544     MOVE X'2020233030303139383236' TO DFHEIV0(25:11)
 20545     CALL 'kxdfhei1' USING DFHEIV0,
 20546           FILE-ERMAIL,
 20547           MAILING-DATA,
 20548           DFHEIV11,
 20549           DFHEIV99
 20550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20551
 20552
 20553 8120-EXIT.
 20554     EXIT.
 20555
 20556 8130-WRITE-ERMAIL.
 20557
 20558* EXEC CICS HANDLE CONDITION
 20559*         DUPKEY   (8130-EXIT)
 20560*    END-EXEC.
 20561*    MOVE '"$$                   ! . #00019835' TO DFHEIV0
 20562     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 20563     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20564     MOVE X'2E20233030303139383335' TO DFHEIV0(25:11)
 20565     CALL 'kxdfhei1' USING DFHEIV0
 20566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20567
 20568
 20569
 20570* EXEC CICS WRITE
 20571*         DATASET     (FILE-ERMAIL)
 20572*         RIDFLD      (MA-CONTROL-PRIMARY)
 20573*         FROM        (MAILING-DATA)
 20574*    END-EXEC.
 20575     MOVE LENGTH OF
 20576      MAILING-DATA
 20577       TO DFHEIV11
 20578*    MOVE '&$ L                  ''   #00019839' TO DFHEIV0
 20579     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20580     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20581     MOVE X'2020233030303139383339' TO DFHEIV0(25:11)
 20582     CALL 'kxdfhei1' USING DFHEIV0,
 20583           FILE-ERMAIL,
 20584           MAILING-DATA,
 20585           DFHEIV11,
 20586           MA-CONTROL-PRIMARY,
 20587           DFHEIV99,
 20588           DFHEIV99
 20589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20590
 20591
 20592 8130-EXIT.
 20593     EXIT.
 20594
 20595 8140-UNLOCK-ERMAIL.
 20596
 20597* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 379
* EL050.cbl
 20598*         DATASET   (FILE-ERMAIL)
 20599*    END-EXEC.
 20600*    MOVE '&*                    #   #00019849' TO DFHEIV0
 20601     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20602     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20603     MOVE X'2020233030303139383439' TO DFHEIV0(25:11)
 20604     CALL 'kxdfhei1' USING DFHEIV0,
 20605           FILE-ERMAIL,
 20606           DFHEIV99
 20607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20608
 20609
 20610 8140-EXIT.
 20611     EXIT.
 20612
 20613 8150-read-elcrtt.
 20614
 20615
 20616* EXEC CICS HANDLE CONDITION
 20617*        NOTFND   (8150-exit)
 20618*    END-EXEC
 20619*    MOVE '"$I                   ! / #00019858' TO DFHEIV0
 20620     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20621     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20622     MOVE X'2F20233030303139383538' TO DFHEIV0(25:11)
 20623     CALL 'kxdfhei1' USING DFHEIV0
 20624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20625
 20626     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20627     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20628
 20629
 20630* EXEC CICS READ
 20631*        DATASET  (CRTT-ID)
 20632*        RIDFLD   (WS-ELCRTT-KEY)
 20633*        INTO     (CERTIFICATE-TRAILERS)
 20634*    END-EXEC
 20635     MOVE LENGTH OF
 20636      CERTIFICATE-TRAILERS
 20637       TO DFHEIV11
 20638*    MOVE '&"IL       E          (   #00019865' TO DFHEIV0
 20639     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20640     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20641     MOVE X'2020233030303139383635' TO DFHEIV0(25:11)
 20642     CALL 'kxdfhei1' USING DFHEIV0,
 20643           CRTT-ID,
 20644           CERTIFICATE-TRAILERS,
 20645           DFHEIV11,
 20646           WS-ELCRTT-KEY,
 20647           DFHEIV99,
 20648           DFHEIV99,
 20649           DFHEIV99
 20650     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20651
 20652     move cs-ins-age-default-flag to ws-ins-age-defaulted
 20653     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 20654     move cs-vehicle-odometer    to ws-vehicle-odometer
 20655
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 380
* EL050.cbl
 20656     .
 20657 8150-exit.
 20658     exit.
 20659 8180-UPDATE-VIN-NUMBER.
 20660
 20661* EXEC CICS HANDLE CONDITION
 20662*        NOTFND   (8180-NOTFND)
 20663*    END-EXEC.
 20664*    MOVE '"$I                   ! 0 #00019879' TO DFHEIV0
 20665     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20666     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20667     MOVE X'3020233030303139383739' TO DFHEIV0(25:11)
 20668     CALL 'kxdfhei1' USING DFHEIV0
 20669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20670
 20671
 20672     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20673     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20674
 20675
 20676* EXEC CICS READ
 20677*        UPDATE
 20678*        DATASET  (CRTT-ID)
 20679*        RIDFLD   (WS-ELCRTT-KEY)
 20680*        INTO     (CERTIFICATE-TRAILERS)
 20681*    END-EXEC.
 20682     MOVE LENGTH OF
 20683      CERTIFICATE-TRAILERS
 20684       TO DFHEIV11
 20685*    MOVE '&"IL       EU         (   #00019886' TO DFHEIV0
 20686     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20687     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20688     MOVE X'2020233030303139383836' TO DFHEIV0(25:11)
 20689     CALL 'kxdfhei1' USING DFHEIV0,
 20690           CRTT-ID,
 20691           CERTIFICATE-TRAILERS,
 20692           DFHEIV11,
 20693           WS-ELCRTT-KEY,
 20694           DFHEIV99,
 20695           DFHEIV99,
 20696           DFHEIV99
 20697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20698
 20699
 20700     IF (PB-I-VIN NOT EQUAL CS-VIN-NUMBER)
 20701        or (hldi-pass-area not = spaces)
 20702        move pa-modelyear        to cs-year
 20703        move pa-makename         to cs-make
 20704        move pa-modelname        to cs-model
 20705        move pa-seriesname       to cs-future
 20706        MOVE PB-I-VIN TO CS-VIN-NUMBER
 20707
 20708* EXEC CICS REWRITE
 20709*           DATASET  (CRTT-ID)
 20710*           FROM     (CERTIFICATE-TRAILERS)
 20711*        END-EXEC
 20712     MOVE LENGTH OF
 20713      CERTIFICATE-TRAILERS
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 381
* EL050.cbl
 20714       TO DFHEIV11
 20715*    MOVE '&& L                  %   #00019900' TO DFHEIV0
 20716     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20717     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20718     MOVE X'2020233030303139393030' TO DFHEIV0(25:11)
 20719     CALL 'kxdfhei1' USING DFHEIV0,
 20720           CRTT-ID,
 20721           CERTIFICATE-TRAILERS,
 20722           DFHEIV11,
 20723           DFHEIV99
 20724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20725     ELSE
 20726
 20727* EXEC CICS UNLOCK
 20728*          DATASET  (CRTT-ID)
 20729*       END-EXEC
 20730*    MOVE '&*                    #   #00019905' TO DFHEIV0
 20731     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20732     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20733     MOVE X'2020233030303139393035' TO DFHEIV0(25:11)
 20734     CALL 'kxdfhei1' USING DFHEIV0,
 20735           CRTT-ID,
 20736           DFHEIV99
 20737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20738     END-IF.
 20739
 20740     GO TO 8180-EXIT.
 20741
 20742 8180-NOTFND.
 20743
 20744     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20745     MOVE 'CS'         TO CS-RECORD-ID.
 20746     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20747     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20748     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20749     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 20750
 20751* EXEC CICS WRITE
 20752*       DATASET  (CRTT-ID)
 20753*       RIDFLD   (WS-ELCRTT-KEY)
 20754*       FROM     (CERTIFICATE-TRAILERS)
 20755*    END-EXEC.
 20756     MOVE LENGTH OF
 20757      CERTIFICATE-TRAILERS
 20758       TO DFHEIV11
 20759*    MOVE '&$ L                  ''   #00019920' TO DFHEIV0
 20760     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20761     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20762     MOVE X'2020233030303139393230' TO DFHEIV0(25:11)
 20763     CALL 'kxdfhei1' USING DFHEIV0,
 20764           CRTT-ID,
 20765           CERTIFICATE-TRAILERS,
 20766           DFHEIV11,
 20767           WS-ELCRTT-KEY,
 20768           DFHEIV99,
 20769           DFHEIV99
 20770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20771
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 382
* EL050.cbl
 20772
 20773 8180-EXIT.
 20774     EXIT.
 20775
 20776 8190-UPDATE-REFUND-CLAIM-FLAG.
 20777
 20778* EXEC CICS HANDLE CONDITION
 20779*        NOTFND   (8190-NOTFND)
 20780*    END-EXEC.
 20781*    MOVE '"$I                   ! 1 #00019930' TO DFHEIV0
 20782     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20783     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20784     MOVE X'3120233030303139393330' TO DFHEIV0(25:11)
 20785     CALL 'kxdfhei1' USING DFHEIV0
 20786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20787
 20788
 20789     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20790     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20791
 20792
 20793* EXEC CICS READ
 20794*        UPDATE
 20795*        DATASET  (CRTT-ID)
 20796*        RIDFLD   (WS-ELCRTT-KEY)
 20797*        INTO     (CERTIFICATE-TRAILERS)
 20798*    END-EXEC.
 20799     MOVE LENGTH OF
 20800      CERTIFICATE-TRAILERS
 20801       TO DFHEIV11
 20802*    MOVE '&"IL       EU         (   #00019937' TO DFHEIV0
 20803     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20804     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20805     MOVE X'2020233030303139393337' TO DFHEIV0(25:11)
 20806     CALL 'kxdfhei1' USING DFHEIV0,
 20807           CRTT-ID,
 20808           CERTIFICATE-TRAILERS,
 20809           DFHEIV11,
 20810           WS-ELCRTT-KEY,
 20811           DFHEIV99,
 20812           DFHEIV99,
 20813           DFHEIV99
 20814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20815
 20816
 20817     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20818
 20819* EXEC CICS REWRITE
 20820*       DATASET  (CRTT-ID)
 20821*       FROM     (CERTIFICATE-TRAILERS)
 20822*    END-EXEC.
 20823     MOVE LENGTH OF
 20824      CERTIFICATE-TRAILERS
 20825       TO DFHEIV11
 20826*    MOVE '&& L                  %   #00019945' TO DFHEIV0
 20827     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20828     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20829     MOVE X'2020233030303139393435' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 383
* EL050.cbl
 20830     CALL 'kxdfhei1' USING DFHEIV0,
 20831           CRTT-ID,
 20832           CERTIFICATE-TRAILERS,
 20833           DFHEIV11,
 20834           DFHEIV99
 20835     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20836
 20837
 20838     GO TO 8190-EXIT.
 20839
 20840 8190-NOTFND.
 20841
 20842     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20843     MOVE 'CS'         TO CS-RECORD-ID.
 20844     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20845     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20846     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20847     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20848
 20849* EXEC CICS WRITE
 20850*       DATASET  (CRTT-ID)
 20851*       RIDFLD   (WS-ELCRTT-KEY)
 20852*       FROM     (CERTIFICATE-TRAILERS)
 20853*    END-EXEC.
 20854     MOVE LENGTH OF
 20855      CERTIFICATE-TRAILERS
 20856       TO DFHEIV11
 20857*    MOVE '&$ L                  ''   #00019960' TO DFHEIV0
 20858     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20859     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20860     MOVE X'2020233030303139393630' TO DFHEIV0(25:11)
 20861     CALL 'kxdfhei1' USING DFHEIV0,
 20862           CRTT-ID,
 20863           CERTIFICATE-TRAILERS,
 20864           DFHEIV11,
 20865           WS-ELCRTT-KEY,
 20866           DFHEIV99,
 20867           DFHEIV99
 20868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20869
 20870
 20871 8190-EXIT.
 20872     EXIT.
 20873
 20874 8195-UPDATE-AGE-FLAGS.
 20875
 20876* EXEC CICS HANDLE CONDITION
 20877*        NOTFND   (8195-NOTFND)
 20878*    END-EXEC.
 20879*    MOVE '"$I                   ! 2 #00019970' TO DFHEIV0
 20880     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20881     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20882     MOVE X'3220233030303139393730' TO DFHEIV0(25:11)
 20883     CALL 'kxdfhei1' USING DFHEIV0
 20884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20885
 20886
 20887     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 384
* EL050.cbl
 20888     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20889
 20890
 20891* EXEC CICS READ
 20892*        UPDATE
 20893*        DATASET  (CRTT-ID)
 20894*        RIDFLD   (WS-ELCRTT-KEY)
 20895*        INTO     (CERTIFICATE-TRAILERS)
 20896*    END-EXEC.
 20897     MOVE LENGTH OF
 20898      CERTIFICATE-TRAILERS
 20899       TO DFHEIV11
 20900*    MOVE '&"IL       EU         (   #00019977' TO DFHEIV0
 20901     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20902     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20903     MOVE X'2020233030303139393737' TO DFHEIV0(25:11)
 20904     CALL 'kxdfhei1' USING DFHEIV0,
 20905           CRTT-ID,
 20906           CERTIFICATE-TRAILERS,
 20907           DFHEIV11,
 20908           WS-ELCRTT-KEY,
 20909           DFHEIV99,
 20910           DFHEIV99,
 20911           DFHEIV99
 20912     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20913
 20914
 20915     IF WS-INS-AGE-SET = 'Y'
 20916        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 20917     END-IF
 20918     IF WS-JNT-AGE-SET = 'Y'
 20919        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 20920     END-IF
 20921
 20922
 20923* EXEC CICS REWRITE
 20924*       DATASET  (CRTT-ID)
 20925*       FROM     (CERTIFICATE-TRAILERS)
 20926*    END-EXEC.
 20927     MOVE LENGTH OF
 20928      CERTIFICATE-TRAILERS
 20929       TO DFHEIV11
 20930*    MOVE '&& L                  %   #00019991' TO DFHEIV0
 20931     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20932     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20933     MOVE X'2020233030303139393931' TO DFHEIV0(25:11)
 20934     CALL 'kxdfhei1' USING DFHEIV0,
 20935           CRTT-ID,
 20936           CERTIFICATE-TRAILERS,
 20937           DFHEIV11,
 20938           DFHEIV99
 20939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20940
 20941
 20942     GO TO 8195-EXIT.
 20943
 20944 8195-NOTFND.
 20945
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 385
* EL050.cbl
 20946     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20947     MOVE 'CS'         TO CS-RECORD-ID.
 20948     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20949     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20950     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20951     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 20952     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 20953
 20954* EXEC CICS WRITE
 20955*       DATASET  (CRTT-ID)
 20956*       RIDFLD   (WS-ELCRTT-KEY)
 20957*       FROM     (CERTIFICATE-TRAILERS)
 20958*    END-EXEC.
 20959     MOVE LENGTH OF
 20960      CERTIFICATE-TRAILERS
 20961       TO DFHEIV11
 20962*    MOVE '&$ L                  ''   #00020007' TO DFHEIV0
 20963     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20964     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20965     MOVE X'2020233030303230303037' TO DFHEIV0(25:11)
 20966     CALL 'kxdfhei1' USING DFHEIV0,
 20967           CRTT-ID,
 20968           CERTIFICATE-TRAILERS,
 20969           DFHEIV11,
 20970           WS-ELCRTT-KEY,
 20971           DFHEIV99,
 20972           DFHEIV99
 20973     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20974
 20975
 20976 8195-EXIT.
 20977     EXIT.
 20978
 20979 8200-READ-REIN-TABLE.
 20980
 20981* EXEC CICS HANDLE CONDITION
 20982*         NOTFND   (8200-NOTFND)
 20983*    END-EXEC.
 20984*    MOVE '"$I                   ! 3 #00020017' TO DFHEIV0
 20985     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20986     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20987     MOVE X'3320233030303230303137' TO DFHEIV0(25:11)
 20988     CALL 'kxdfhei1' USING DFHEIV0
 20989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20990
 20991
 20992
 20993* EXEC CICS READ
 20994*        DATASET     (REIN-ID)
 20995*        SET         (ADDRESS OF REINSURANCE-RECORD)
 20996*        RIDFLD      (ERREIN-KEY)
 20997*    END-EXEC.
 20998*    MOVE '&"S        E          (   #00020021' TO DFHEIV0
 20999     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21000     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21001     MOVE X'2020233030303230303231' TO DFHEIV0(25:11)
 21002     CALL 'kxdfhei1' USING DFHEIV0,
 21003           REIN-ID,
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 386
* EL050.cbl
 21004           DFHEIV20,
 21005           DFHEIV99,
 21006           ERREIN-KEY,
 21007           DFHEIV99,
 21008           DFHEIV99,
 21009           DFHEIV99
 21010     SET ADDRESS OF REINSURANCE-RECORD TO
 21011         DFHEIV20
 21012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21013
 21014
 21015     GO TO 8200-EXIT.
 21016
 21017 8200-NOTFND.
 21018     MOVE 'N'             TO WS-REIN-READ-SW.
 21019
 21020 8200-EXIT.
 21021      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 387
* EL050.cbl
 21023
 21024 8300-READ-CTBL-TABLE.
 21025
 21026* EXEC CICS HANDLE CONDITION
 21027*        NOTFND    (8300-NOTFND)
 21028*        DISABLED  (8300-ERRESS-PROBLEM)
 21029*        NOTOPEN   (8300-ERRESS-PROBLEM)
 21030*        ENDFILE   (8300-NOTFND)
 21031*    END-EXEC.
 21032*    MOVE '"$IcJ''                ! 4 #00020037' TO DFHEIV0
 21033     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 21034     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21035     MOVE X'3420233030303230303337' TO DFHEIV0(25:11)
 21036     CALL 'kxdfhei1' USING DFHEIV0
 21037     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21038
 21039
 21040
 21041* EXEC CICS READ
 21042*        DATASET     (CTBL-ID)
 21043*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 21044*        RIDFLD      (ERCTBL-KEY)
 21045*    END-EXEC.
 21046*    MOVE '&"S        E          (   #00020044' TO DFHEIV0
 21047     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21048     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21049     MOVE X'2020233030303230303434' TO DFHEIV0(25:11)
 21050     CALL 'kxdfhei1' USING DFHEIV0,
 21051           CTBL-ID,
 21052           DFHEIV20,
 21053           DFHEIV99,
 21054           ERCTBL-KEY,
 21055           DFHEIV99,
 21056           DFHEIV99,
 21057           DFHEIV99
 21058     SET ADDRESS OF COMM-TABLE-RECORD TO
 21059         DFHEIV20
 21060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21061
 21062
 21063     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 21064
 21065     GO TO 8300-EXIT.
 21066
 21067 8300-NOTFND.
 21068
 21069     IF CTBL-SW = '0530'
 21070         MOVE 'AA'                     TO WS-AH-COMP-CD
 21071         MOVE '0550'                   TO CTBL-SW
 21072         MOVE '1'                      TO WS-CTBL-READ-SW
 21073         GO TO 8300-EXIT.
 21074
 21075     IF CTBL-SW = '0540'
 21076         MOVE 'AA'                     TO WS-LF-COMP-CD
 21077         MOVE '0550'                   TO CTBL-SW
 21078         MOVE '1'                      TO WS-CTBL-READ-SW
 21079         GO TO 8300-EXIT.
 21080
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 388
* EL050.cbl
 21081     IF CTBL-SW = '0550'
 21082         MOVE '2'                      TO WS-CTBL-READ-SW
 21083         GO TO 8300-EXIT.
 21084
 21085     GO TO 8300-EXIT.
 21086
 21087 8300-ERRESS-PROBLEM.
 21088
 21089      MOVE ER-8050              TO WS-ERROR.
 21090      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21091
 21092     GO TO 8300-EXIT.
 21093
 21094 8300-EXIT.
 21095      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 389
* EL050.cbl
 21097
 21098
 21099 8400-GETMAIN-ERFORM.
 21100
 21101
 21102* EXEC CICS   GETMAIN
 21103*        LENGTH  (500)
 21104*        SET     (ADDRESS OF FORM-MASTER)
 21105*    END-EXEC.
 21106     MOVE 500
 21107       TO DFHEIV11
 21108*    MOVE '," L                  $   #00020088' TO DFHEIV0
 21109     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21110     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21111     MOVE X'2020233030303230303838' TO DFHEIV0(25:11)
 21112     CALL 'kxdfhei1' USING DFHEIV0,
 21113           DFHEIV20,
 21114           DFHEIV11,
 21115           DFHEIV99
 21116     SET ADDRESS OF FORM-MASTER TO
 21117         DFHEIV20
 21118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21119
 21120
 21121     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 21122
 21123 8400-EXIT.
 21124      EXIT.
 21125
 21126 8450-READ-FORM-MASTER.
 21127
 21128
 21129* EXEC CICS  HANDLE CONDITION
 21130*        NOTFND   (8450-FORM-NOT-FOUND)
 21131*        ENDFILE  (8450-FORM-NOT-FOUND)
 21132*    END-EXEC.
 21133*    MOVE '"$I''                  ! 5 #00020100' TO DFHEIV0
 21134     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21135     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21136     MOVE X'3520233030303230313030' TO DFHEIV0(25:11)
 21137     CALL 'kxdfhei1' USING DFHEIV0
 21138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21139
 21140
 21141
 21142* EXEC CICS   READ
 21143*        DATASET   (FORM-ID)
 21144*        RIDFLD    (ERFORM-KEY)
 21145*        INTO      (FORM-MASTER)
 21146*        GTEQ
 21147*    END-EXEC.
 21148     MOVE LENGTH OF
 21149      FORM-MASTER
 21150       TO DFHEIV11
 21151*    MOVE '&"IL       G          (   #00020105' TO DFHEIV0
 21152     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21153     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21154     MOVE X'2020233030303230313035' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 390
* EL050.cbl
 21155     CALL 'kxdfhei1' USING DFHEIV0,
 21156           FORM-ID,
 21157           FORM-MASTER,
 21158           DFHEIV11,
 21159           ERFORM-KEY,
 21160           DFHEIV99,
 21161           DFHEIV99,
 21162           DFHEIV99
 21163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21164
 21165
 21166     MOVE  'Y'           TO  FORM-MASTER-SW.
 21167
 21168     GO TO  8450-EXIT.
 21169
 21170 8450-FORM-NOT-FOUND.
 21171
 21172     MOVE  'N'           TO  FORM-MASTER-SW.
 21173
 21174 8450-EXIT.
 21175      EXIT.
 21176
 21177 8500-DATE-CONVERT.
 21178
 21179* EXEC CICS LINK
 21180*        PROGRAM    ('ELDATCV')
 21181*        COMMAREA   (DATE-CONVERSION-DATA)
 21182*        LENGTH     (DC-COMM-LENGTH)
 21183*    END-EXEC.
 21184     MOVE 'ELDATCV' TO DFHEIV1
 21185*    MOVE '."C                   (   #00020124' TO DFHEIV0
 21186     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21187     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21188     MOVE X'2020233030303230313234' TO DFHEIV0(25:11)
 21189     CALL 'kxdfhei1' USING DFHEIV0,
 21190           DFHEIV1,
 21191           DATE-CONVERSION-DATA,
 21192           DC-COMM-LENGTH,
 21193           DFHEIV99,
 21194           DFHEIV99,
 21195           DFHEIV99,
 21196           DFHEIV99
 21197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21198
 21199
 21200 8500-EXIT.
 21201     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 391
* EL050.cbl
 21203
 21204 8555-RELOAD-CONTROL-FILE.
 21205     CONTINUE.
 21206
 21207 8555-EXIT.
 21208     EXIT.
 21209
 21210 8557-GETMAIN-ERPLAN.
 21211
 21212
 21213* EXEC CICS GETMAIN
 21214*        LENGTH    (840)
 21215*        SET       (ADDRESS OF PLAN-RECORDS)
 21216*    END-EXEC.
 21217     MOVE 840
 21218       TO DFHEIV11
 21219*    MOVE '," L                  $   #00020142' TO DFHEIV0
 21220     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21221     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21222     MOVE X'2020233030303230313432' TO DFHEIV0(25:11)
 21223     CALL 'kxdfhei1' USING DFHEIV0,
 21224           DFHEIV20,
 21225           DFHEIV11,
 21226           DFHEIV99
 21227     SET ADDRESS OF PLAN-RECORDS TO
 21228         DFHEIV20
 21229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21230
 21231
 21232     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 21233
 21234 8557-EXIT.
 21235     EXIT.
 21236
 21237 8560-GETMAIN.
 21238
 21239* EXEC CICS GETMAIN
 21240*        LENGTH    (2000)
 21241*        SET       (ADDRESS OF ACCOUNT-MASTER)
 21242*    END-EXEC.
 21243     MOVE 2000
 21244       TO DFHEIV11
 21245*    MOVE '," L                  $   #00020153' TO DFHEIV0
 21246     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21247     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21248     MOVE X'2020233030303230313533' TO DFHEIV0(25:11)
 21249     CALL 'kxdfhei1' USING DFHEIV0,
 21250           DFHEIV20,
 21251           DFHEIV11,
 21252           DFHEIV99
 21253     SET ADDRESS OF ACCOUNT-MASTER TO
 21254         DFHEIV20
 21255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21256
 21257
 21258     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 21259
 21260 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 392
* EL050.cbl
 21261     EXIT.
 21262
 21263 8570-START-ACCOUNT-MASTER.
 21264
 21265* EXEC CICS HANDLE CONDITION
 21266*        NOTFND    (0199-ACCT-NOT-FOUND)
 21267*        ENDFILE   (0199-ACCT-NOT-FOUND)
 21268*    END-EXEC.
 21269*    MOVE '"$I''                  ! 6 #00020164' TO DFHEIV0
 21270     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21271     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21272     MOVE X'3620233030303230313634' TO DFHEIV0(25:11)
 21273     CALL 'kxdfhei1' USING DFHEIV0
 21274     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21275
 21276
 21277
 21278* EXEC CICS STARTBR
 21279*        DATASET    (ACCT-ID)
 21280*        RIDFLD     (ERACCT-KEY)
 21281*        GTEQ
 21282*    END-EXEC.
 21283     MOVE 0
 21284       TO DFHEIV11
 21285*    MOVE '&,         G          &   #00020169' TO DFHEIV0
 21286     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21287     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21288     MOVE X'2020233030303230313639' TO DFHEIV0(25:11)
 21289     CALL 'kxdfhei1' USING DFHEIV0,
 21290           ACCT-ID,
 21291           ERACCT-KEY,
 21292           DFHEIV99,
 21293           DFHEIV11,
 21294           DFHEIV99
 21295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21296
 21297
 21298 8570-EXIT.
 21299     EXIT.
 21300
 21301 8580-READ-ACCOUNT-MASTER.
 21302
 21303* EXEC CICS HANDLE CONDITION
 21304*        NOTFND    (0199-ACCT-NOT-FOUND)
 21305*        ENDFILE   (0199-ACCT-NOT-FOUND)
 21306*    END-EXEC.
 21307*    MOVE '"$I''                  ! 7 #00020179' TO DFHEIV0
 21308     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21309     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21310     MOVE X'3720233030303230313739' TO DFHEIV0(25:11)
 21311     CALL 'kxdfhei1' USING DFHEIV0
 21312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21313
 21314
 21315
 21316* EXEC CICS READNEXT
 21317*        DATASET     (ACCT-ID)
 21318*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 393
* EL050.cbl
 21319*        RIDFLD      (ERACCT-KEY)
 21320*    END-EXEC.
 21321     MOVE LENGTH OF
 21322      ACCOUNT-MASTER
 21323       TO DFHEIV12
 21324     MOVE 0
 21325       TO DFHEIV11
 21326*    MOVE '&.IL                  )   #00020184' TO DFHEIV0
 21327     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21328     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21329     MOVE X'2020233030303230313834' TO DFHEIV0(25:11)
 21330     CALL 'kxdfhei1' USING DFHEIV0,
 21331           ACCT-ID,
 21332           ACCOUNT-MASTER,
 21333           DFHEIV12,
 21334           ERACCT-KEY,
 21335           DFHEIV99,
 21336           DFHEIV11,
 21337           DFHEIV99,
 21338           DFHEIV99
 21339     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21340
 21341
 21342 8580-EXIT.
 21343     EXIT.
 21344
 21345 8582-READ-COMPENSATION-MASTER.
 21346
 21347* EXEC CICS HANDLE CONDITION
 21348*        NOTFND    (8582-COMP-NOT-FOUND)
 21349*        ENDFILE   (8582-COMP-NOT-FOUND)
 21350*    END-EXEC.
 21351*    MOVE '"$I''                  ! 8 #00020194' TO DFHEIV0
 21352     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21353     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21354     MOVE X'3820233030303230313934' TO DFHEIV0(25:11)
 21355     CALL 'kxdfhei1' USING DFHEIV0
 21356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21357
 21358
 21359
 21360* EXEC CICS READ
 21361*        DATASET     (COMP-ID)
 21362*        INTO        (COMPENSATION-MASTER)
 21363*        RIDFLD      (ERCOMP-KEY)
 21364*    END-EXEC.
 21365     MOVE LENGTH OF
 21366      COMPENSATION-MASTER
 21367       TO DFHEIV11
 21368*    MOVE '&"IL       E          (   #00020199' TO DFHEIV0
 21369     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21370     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21371     MOVE X'2020233030303230313939' TO DFHEIV0(25:11)
 21372     CALL 'kxdfhei1' USING DFHEIV0,
 21373           COMP-ID,
 21374           COMPENSATION-MASTER,
 21375           DFHEIV11,
 21376           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 394
* EL050.cbl
 21377           DFHEIV99,
 21378           DFHEIV99,
 21379           DFHEIV99
 21380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21381
 21382
 21383     MOVE 'Y'                    TO COMP-MASTER-SW
 21384
 21385     GO TO 8582-EXIT
 21386     .
 21387 8582-COMP-NOT-FOUND.
 21388
 21389     MOVE 'N'                    TO COMP-MASTER-SW.
 21390
 21391 8582-EXIT.
 21392     EXIT.
 21393
 21394 8583-READ-ERAGTC.
 21395
 21396* EXEC CICS HANDLE CONDITION
 21397*        NOTFND    (8583-AGTC-NOT-FOUND)
 21398*        ENDFILE   (8583-AGTC-NOT-FOUND)
 21399*    END-EXEC.
 21400*    MOVE '"$I''                  ! 9 #00020217' TO DFHEIV0
 21401     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21402     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21403     MOVE X'3920233030303230323137' TO DFHEIV0(25:11)
 21404     CALL 'kxdfhei1' USING DFHEIV0
 21405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21406
 21407
 21408
 21409* EXEC CICS STARTBR
 21410*        DATASET    (AGTC-ID)
 21411*        RIDFLD     (ERAGTC-KEY)
 21412*        GTEQ
 21413*    END-EXEC.
 21414     MOVE 0
 21415       TO DFHEIV11
 21416*    MOVE '&,         G          &   #00020222' TO DFHEIV0
 21417     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21418     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21419     MOVE X'2020233030303230323232' TO DFHEIV0(25:11)
 21420     CALL 'kxdfhei1' USING DFHEIV0,
 21421           AGTC-ID,
 21422           ERAGTC-KEY,
 21423           DFHEIV99,
 21424           DFHEIV11,
 21425           DFHEIV99
 21426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21427
 21428
 21429 8583-READ-ERAGTC-NEXT.
 21430
 21431* EXEC CICS READNEXT
 21432*        DATASET     (AGTC-ID)
 21433*        INTO        (AGENT-COMMISSIONS)
 21434*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 395
* EL050.cbl
 21435*    END-EXEC.
 21436     MOVE LENGTH OF
 21437      AGENT-COMMISSIONS
 21438       TO DFHEIV12
 21439     MOVE 0
 21440       TO DFHEIV11
 21441*    MOVE '&.IL                  )   #00020229' TO DFHEIV0
 21442     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21443     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21444     MOVE X'2020233030303230323239' TO DFHEIV0(25:11)
 21445     CALL 'kxdfhei1' USING DFHEIV0,
 21446           AGTC-ID,
 21447           AGENT-COMMISSIONS,
 21448           DFHEIV12,
 21449           ERAGTC-KEY,
 21450           DFHEIV99,
 21451           DFHEIV11,
 21452           DFHEIV99,
 21453           DFHEIV99
 21454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21455
 21456
 21457*    MOVE 'Y'                    TO AGTC-MASTER-SW
 21458
 21459     GO TO 8583-EXIT
 21460     .
 21461 8583-AGTC-NOT-FOUND.
 21462
 21463     MOVE 'N'                    TO AGTC-MASTER-SW.
 21464
 21465 8583-EXIT.
 21466     EXIT.
 21467
 21468 8584-READ-BANK-CROSS-REF.
 21469
 21470* EXEC CICS HANDLE CONDITION
 21471*        NOTFND    (8584-BXRF-NOT-FOUND)
 21472*        ENDFILE   (8584-BXRF-NOT-FOUND)
 21473*    END-EXEC.
 21474*    MOVE '"$I''                  ! : #00020247' TO DFHEIV0
 21475     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21476     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21477     MOVE X'3A20233030303230323437' TO DFHEIV0(25:11)
 21478     CALL 'kxdfhei1' USING DFHEIV0
 21479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21480
 21481
 21482
 21483* EXEC CICS READ
 21484*        DATASET     (BXRF-ID)
 21485*        INTO        (BANK-CROSS-REFERENCE)
 21486*        RIDFLD      (ERBXRF-KEY)
 21487*        LENGTH      (BXRF-REC-LENGTH)
 21488*    END-EXEC.
 21489*    MOVE '&"IL       E          (   #00020252' TO DFHEIV0
 21490     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21491     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21492     MOVE X'2020233030303230323532' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 396
* EL050.cbl
 21493     CALL 'kxdfhei1' USING DFHEIV0,
 21494           BXRF-ID,
 21495           BANK-CROSS-REFERENCE,
 21496           BXRF-REC-LENGTH,
 21497           ERBXRF-KEY,
 21498           DFHEIV99,
 21499           DFHEIV99,
 21500           DFHEIV99
 21501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21502
 21503
 21504     MOVE 'Y'                    TO BXRF-MASTER-SW
 21505
 21506     GO TO 8584-EXIT
 21507     .
 21508 8584-BXRF-NOT-FOUND.
 21509
 21510     MOVE 'N'                    TO BXRF-MASTER-SW.
 21511
 21512 8584-EXIT.
 21513     EXIT.
 21514
 21515 8585-READ-PLAN-MASTER.
 21516
 21517
 21518* EXEC CICS HANDLE CONDITION
 21519*        NOTFND    (8585-PLAN-NOT-FOUND)
 21520*        ENDFILE   (8585-PLAN-NOT-FOUND)
 21521*    END-EXEC.
 21522*    MOVE '"$I''                  ! ; #00020272' TO DFHEIV0
 21523     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21524     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21525     MOVE X'3B20233030303230323732' TO DFHEIV0(25:11)
 21526     CALL 'kxdfhei1' USING DFHEIV0
 21527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21528
 21529
 21530
 21531* EXEC CICS READ
 21532*        DATASET     (PLAN-ID)
 21533*        INTO        (PLAN-MASTER)
 21534*        RIDFLD      (ERPLAN-KEY)
 21535*    END-EXEC.
 21536     MOVE LENGTH OF
 21537      PLAN-MASTER
 21538       TO DFHEIV11
 21539*    MOVE '&"IL       E          (   #00020277' TO DFHEIV0
 21540     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21541     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21542     MOVE X'2020233030303230323737' TO DFHEIV0(25:11)
 21543     CALL 'kxdfhei1' USING DFHEIV0,
 21544           PLAN-ID,
 21545           PLAN-MASTER,
 21546           DFHEIV11,
 21547           ERPLAN-KEY,
 21548           DFHEIV99,
 21549           DFHEIV99,
 21550           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 397
* EL050.cbl
 21551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21552
 21553
 21554     MOVE 'Y'                    TO PLAN-MASTER-SW.
 21555
 21556     GO TO 8585-EXIT.
 21557
 21558 8585-PLAN-NOT-FOUND.
 21559
 21560     MOVE 'N'                    TO PLAN-MASTER-SW.
 21561
 21562 8585-EXIT.
 21563     EXIT.
 21564
 21565 8586-READ-LOAN-OFFICER.
 21566
 21567* EXEC CICS READ
 21568*        DATASET     (LOFC-ID)
 21569*        INTO        (LOAN-OFFICER-MASTER)
 21570*        RIDFLD      (ERLOFC-KEY)
 21571*        RESP        (WS-RESPONSE)
 21572*    END-EXEC
 21573     MOVE LENGTH OF
 21574      LOAN-OFFICER-MASTER
 21575       TO DFHEIV11
 21576*    MOVE '&"IL       E          (  N#00020295' TO DFHEIV0
 21577     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21578     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21579     MOVE X'204E233030303230323935' TO DFHEIV0(25:11)
 21580     CALL 'kxdfhei1' USING DFHEIV0,
 21581           LOFC-ID,
 21582           LOAN-OFFICER-MASTER,
 21583           DFHEIV11,
 21584           ERLOFC-KEY,
 21585           DFHEIV99,
 21586           DFHEIV99,
 21587           DFHEIV99
 21588     MOVE EIBRESP  TO WS-RESPONSE
 21589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21590
 21591     IF WS-RESP-NORMAL
 21592        MOVE 'Y'                 TO LOFC-MASTER-SW
 21593     ELSE
 21594        MOVE 'N'                 TO LOFC-MASTER-SW
 21595     END-IF
 21596     .
 21597 8586-EXIT.
 21598     EXIT.
 21599 8587-START-ERPDEF.
 21600
 21601* EXEC CICS STARTBR
 21602*       DATASET   (PDEF-ID)
 21603*       RIDFLD    (ERPDEF-KEY)
 21604*       GTEQ
 21605*       RESP      (WS-RESPONSE)
 21606*    END-EXEC
 21607     MOVE 0
 21608       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 398
* EL050.cbl
 21609*    MOVE '&,         G          &  N#00020311' TO DFHEIV0
 21610     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21611     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21612     MOVE X'204E233030303230333131' TO DFHEIV0(25:11)
 21613     CALL 'kxdfhei1' USING DFHEIV0,
 21614           PDEF-ID,
 21615           ERPDEF-KEY,
 21616           DFHEIV99,
 21617           DFHEIV11,
 21618           DFHEIV99
 21619     MOVE EIBRESP  TO WS-RESPONSE
 21620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21621     IF WS-RESP-NORMAL
 21622        MOVE 'Y'                 TO PDEF-MASTER-SW
 21623     ELSE
 21624        MOVE 'N'                 TO PDEF-MASTER-SW
 21625     END-IF
 21626     .
 21627 8587-EXIT.
 21628     EXIT.
 21629 8588-READ-ERPDEF.
 21630
 21631* EXEC CICS READNEXT
 21632*       DATASET   (PDEF-ID)
 21633*       RIDFLD    (ERPDEF-KEY)
 21634*       INTO      (PRODUCT-MASTER)
 21635*       RESP      (WS-RESPONSE)
 21636*    END-EXEC
 21637     MOVE LENGTH OF
 21638      PRODUCT-MASTER
 21639       TO DFHEIV12
 21640     MOVE 0
 21641       TO DFHEIV11
 21642*    MOVE '&.IL                  )  N#00020326' TO DFHEIV0
 21643     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21644     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21645     MOVE X'204E233030303230333236' TO DFHEIV0(25:11)
 21646     CALL 'kxdfhei1' USING DFHEIV0,
 21647           PDEF-ID,
 21648           PRODUCT-MASTER,
 21649           DFHEIV12,
 21650           ERPDEF-KEY,
 21651           DFHEIV99,
 21652           DFHEIV11,
 21653           DFHEIV99,
 21654           DFHEIV99
 21655     MOVE EIBRESP  TO WS-RESPONSE
 21656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21657     IF WS-RESP-NORMAL
 21658        MOVE 'Y'                 TO PDEF-MASTER-SW
 21659     ELSE
 21660        MOVE 'N'                 TO PDEF-MASTER-SW
 21661     END-IF
 21662     .
 21663 8588-EXIT.
 21664     EXIT.
 21665 8589-ENDBR-ERPDEF.
 21666
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 399
* EL050.cbl
 21667* EXEC CICS ENDBR
 21668*       DATASET   (PDEF-ID)
 21669*    END-EXEC
 21670     MOVE 0
 21671       TO DFHEIV11
 21672*    MOVE '&2                    $   #00020341' TO DFHEIV0
 21673     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21674     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21675     MOVE X'2020233030303230333431' TO DFHEIV0(25:11)
 21676     CALL 'kxdfhei1' USING DFHEIV0,
 21677           PDEF-ID,
 21678           DFHEIV11,
 21679           DFHEIV99
 21680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21681     .
 21682 8589-EXIT.
 21683     EXIT.
 21684 8590-READ-CERT-MASTER.
 21685     IF PB-COMPANY-ID = 'UCL'
 21686         GO TO 8690-READ-CERT-MASTER-UCL.
 21687
 21688
 21689* EXEC CICS HANDLE CONDITION
 21690*         NOTFND    (0299-CERT-NOT-FOUND)
 21691*    END-EXEC.
 21692*    MOVE '"$I                   ! < #00020351' TO DFHEIV0
 21693     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21694     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21695     MOVE X'3C20233030303230333531' TO DFHEIV0(25:11)
 21696     CALL 'kxdfhei1' USING DFHEIV0
 21697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21698
 21699
 21700
 21701* EXEC CICS READ
 21702*        DATASET     (CERT-ID)
 21703*        INTO        (CERTIFICATE-MASTER)
 21704*        RIDFLD      (ELCERT-KEY)
 21705*        UPDATE
 21706*    END-EXEC.
 21707     MOVE LENGTH OF
 21708      CERTIFICATE-MASTER
 21709       TO DFHEIV11
 21710*    MOVE '&"IL       EU         (   #00020355' TO DFHEIV0
 21711     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21712     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21713     MOVE X'2020233030303230333535' TO DFHEIV0(25:11)
 21714     CALL 'kxdfhei1' USING DFHEIV0,
 21715           CERT-ID,
 21716           CERTIFICATE-MASTER,
 21717           DFHEIV11,
 21718           ELCERT-KEY,
 21719           DFHEIV99,
 21720           DFHEIV99,
 21721           DFHEIV99
 21722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21723
 21724
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 400
* EL050.cbl
 21725 8590-EXIT.
 21726     EXIT.
 21727
 21728 8690-READ-CERT-MASTER-UCL.
 21729
 21730* EXEC CICS HANDLE CONDITION
 21731*         NOTFND    (8700-READ-CERT-MASTER)
 21732*    END-EXEC.
 21733*    MOVE '"$I                   ! = #00020366' TO DFHEIV0
 21734     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21735     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21736     MOVE X'3D20233030303230333636' TO DFHEIV0(25:11)
 21737     CALL 'kxdfhei1' USING DFHEIV0
 21738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21739
 21740
 21741 8690-READ-CERT-CONT.
 21742
 21743* EXEC CICS READ
 21744*        DATASET     (CERT-ID)
 21745*        INTO        (CERTIFICATE-MASTER)
 21746*        RIDFLD      (ELCERT-KEY)
 21747*        UPDATE
 21748*    END-EXEC.
 21749     MOVE LENGTH OF
 21750      CERTIFICATE-MASTER
 21751       TO DFHEIV11
 21752*    MOVE '&"IL       EU         (   #00020371' TO DFHEIV0
 21753     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21754     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21755     MOVE X'2020233030303230333731' TO DFHEIV0(25:11)
 21756     CALL 'kxdfhei1' USING DFHEIV0,
 21757           CERT-ID,
 21758           CERTIFICATE-MASTER,
 21759           DFHEIV11,
 21760           ELCERT-KEY,
 21761           DFHEIV99,
 21762           DFHEIV99,
 21763           DFHEIV99
 21764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21765
 21766
 21767     GO TO 8590-EXIT.
 21768
 21769 8700-READ-CERT-MASTER.
 21770     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 21771     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 21772
 21773* EXEC CICS HANDLE CONDITION
 21774*         DUPKEY    (8720-COMP-ACCOUNTS)
 21775*         ENDFILE   (8730-END-BROWSE)
 21776*         NOTFND    (8740-NOT-FOUND)
 21777*    END-EXEC.
 21778*    MOVE '"$$''I                 ! > #00020383' TO DFHEIV0
 21779     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 21780     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21781     MOVE X'3E20233030303230333833' TO DFHEIV0(25:11)
 21782     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 401
* EL050.cbl
 21783     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21784
 21785
 21786
 21787* EXEC CICS STARTBR
 21788*        DATASET     ('ELCERT5')
 21789*        RIDFLD      (ELCERT2-KEY)
 21790*        EQUAL
 21791*    END-EXEC.
 21792     MOVE 'ELCERT5' TO DFHEIV1
 21793     MOVE 0
 21794       TO DFHEIV11
 21795*    MOVE '&,         E          &   #00020389' TO DFHEIV0
 21796     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 21797     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21798     MOVE X'2020233030303230333839' TO DFHEIV0(25:11)
 21799     CALL 'kxdfhei1' USING DFHEIV0,
 21800           DFHEIV1,
 21801           ELCERT2-KEY,
 21802           DFHEIV99,
 21803           DFHEIV11,
 21804           DFHEIV99
 21805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21806
 21807
 21808 8710-READ-NEXT.
 21809
 21810* EXEC CICS READNEXT
 21811*        DATASET     ('ELCERT5')
 21812*        INTO        (CERTIFICATE-MASTER)
 21813*        RIDFLD      (ELCERT2-KEY)
 21814*    END-EXEC.
 21815     MOVE LENGTH OF
 21816      CERTIFICATE-MASTER
 21817       TO DFHEIV12
 21818     MOVE 'ELCERT5' TO DFHEIV1
 21819     MOVE 0
 21820       TO DFHEIV11
 21821*    MOVE '&.IL                  )   #00020396' TO DFHEIV0
 21822     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21823     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21824     MOVE X'2020233030303230333936' TO DFHEIV0(25:11)
 21825     CALL 'kxdfhei1' USING DFHEIV0,
 21826           DFHEIV1,
 21827           CERTIFICATE-MASTER,
 21828           DFHEIV12,
 21829           ELCERT2-KEY,
 21830           DFHEIV99,
 21831           DFHEIV11,
 21832           DFHEIV99,
 21833           DFHEIV99
 21834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21835
 21836
 21837 8720-COMP-ACCOUNTS.
 21838
 21839* EXEC CICS ENTER
 21840*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 402
* EL050.cbl
 21841*         FROM (PB-C-LAST-NAME)
 21842*    END-EXEC.
 21843     MOVE 001
 21844       TO DFHEIV11
 21845*    MOVE ':$F                   %   #00020403' TO DFHEIV0
 21846     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21847     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21848     MOVE X'2020233030303230343033' TO DFHEIV0(25:11)
 21849     CALL 'kxdfhei1' USING DFHEIV0,
 21850           DFHEIV11,
 21851           PB-C-LAST-NAME,
 21852           DFHEIV99,
 21853           DFHEIV99
 21854     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21855
 21856
 21857
 21858* EXEC CICS ENTER
 21859*         TRACEID (002)
 21860*         FROM (CM-INSURED-LAST-NAME)
 21861*    END-EXEC.
 21862     MOVE 002
 21863       TO DFHEIV11
 21864*    MOVE ':$F                   %   #00020408' TO DFHEIV0
 21865     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21866     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21867     MOVE X'2020233030303230343038' TO DFHEIV0(25:11)
 21868     CALL 'kxdfhei1' USING DFHEIV0,
 21869           DFHEIV11,
 21870           CM-INSURED-LAST-NAME,
 21871           DFHEIV99,
 21872           DFHEIV99
 21873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21874
 21875
 21876     IF PB-CERT-NO NOT = CM-CERT-NO
 21877         GO TO 8730-END-BROWSE.
 21878
 21879     IF PB-ACCOUNT = CM-ACCOUNT
 21880         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 21881             MOVE ER-2799        TO WS-ERROR
 21882             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21883             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 21884             GO TO 8730-END-BROWSE.
 21885
 21886     GO TO 8710-READ-NEXT.
 21887
 21888 8730-END-BROWSE.
 21889
 21890* EXEC CICS ENDBR
 21891*         DATASET    ('ELCERT5')
 21892*    END-EXEC.
 21893     MOVE 'ELCERT5' TO DFHEIV1
 21894     MOVE 0
 21895       TO DFHEIV11
 21896*    MOVE '&2                    $   #00020426' TO DFHEIV0
 21897     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21898     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 403
* EL050.cbl
 21899     MOVE X'2020233030303230343236' TO DFHEIV0(25:11)
 21900     CALL 'kxdfhei1' USING DFHEIV0,
 21901           DFHEIV1,
 21902           DFHEIV11,
 21903           DFHEIV99
 21904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21905
 21906
 21907 8740-NOT-FOUND.
 21908     GO TO 0299-CERT-NOT-FOUND.
 21909
 21910 8750-START-ELSTAT.
 21911
 21912* EXEC CICS STARTBR
 21913*       DATASET   (STAT-ID)
 21914*       RIDFLD    (ELSTAT-KEY)
 21915*       GTEQ
 21916*       RESP      (WS-RESPONSE)
 21917*    END-EXEC
 21918     MOVE 0
 21919       TO DFHEIV11
 21920*    MOVE '&,         G          &  N#00020434' TO DFHEIV0
 21921     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21922     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21923     MOVE X'204E233030303230343334' TO DFHEIV0(25:11)
 21924     CALL 'kxdfhei1' USING DFHEIV0,
 21925           STAT-ID,
 21926           ELSTAT-KEY,
 21927           DFHEIV99,
 21928           DFHEIV11,
 21929           DFHEIV99
 21930     MOVE EIBRESP  TO WS-RESPONSE
 21931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21932     IF WS-RESP-NORMAL
 21933        MOVE 'Y'                 TO STAT-MASTER-SW
 21934     ELSE
 21935        MOVE 'N'                 TO STAT-MASTER-SW
 21936     END-IF
 21937     .
 21938 8750-EXIT.
 21939     EXIT.
 21940 8752-READ-ELSTAT.
 21941
 21942* EXEC CICS READNEXT
 21943*       DATASET   (STAT-ID)
 21944*       RIDFLD    (ELSTAT-KEY)
 21945*       INTO      (STATE-FILE)
 21946*       RESP      (WS-RESPONSE)
 21947*    END-EXEC
 21948     MOVE LENGTH OF
 21949      STATE-FILE
 21950       TO DFHEIV12
 21951     MOVE 0
 21952       TO DFHEIV11
 21953*    MOVE '&.IL                  )  N#00020449' TO DFHEIV0
 21954     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21955     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21956     MOVE X'204E233030303230343439' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 404
* EL050.cbl
 21957     CALL 'kxdfhei1' USING DFHEIV0,
 21958           STAT-ID,
 21959           STATE-FILE,
 21960           DFHEIV12,
 21961           ELSTAT-KEY,
 21962           DFHEIV99,
 21963           DFHEIV11,
 21964           DFHEIV99,
 21965           DFHEIV99
 21966     MOVE EIBRESP  TO WS-RESPONSE
 21967     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21968     IF WS-RESP-NORMAL
 21969        MOVE 'Y'                 TO STAT-MASTER-SW
 21970     ELSE
 21971        MOVE 'N'                 TO STAT-MASTER-SW
 21972     END-IF
 21973     .
 21974 8752-EXIT.
 21975     EXIT.
 21976 8800-GET-COMP-RATE.
 21977     MOVE +1 TO IB.
 21978     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 21979         ADD +9 TO IB
 21980         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 21981             ADD +9 TO IB
 21982             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 21983                MOVE ZEROS       TO WS-WK-RATE
 21984                GO TO 8800-EXIT.
 21985
 21986     IF PB-I-AGE GREATER CT-AGE (1)
 21987         ADD +3 TO IB
 21988         IF PB-I-AGE GREATER CT-AGE (2)
 21989             ADD +3 TO IB
 21990             IF PB-I-AGE GREATER CT-AGE (3)
 21991                MOVE ZEROS       TO WS-WK-RATE
 21992                GO TO 8800-EXIT.
 21993
 21994     IF WS-WORK-TERM GREATER CT-TRM (1)
 21995         ADD +1 TO IB
 21996         IF WS-WORK-TERM GREATER CT-TRM (2)
 21997             ADD +1 TO IB
 21998             IF WS-WORK-TERM GREATER CT-TRM (3)
 21999                MOVE ZEROS       TO WS-WK-RATE
 22000                GO TO 8800-EXIT.
 22001
 22002     IF CT-RT (IB) NOT NUMERIC
 22003         MOVE CT-RT-R (IB) TO CTBL-TABLE
 22004         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 22005         GO TO 8800-GET-COMP-RATE.
 22006
 22007     MOVE CT-RT (IB) TO WS-WK-RATE.
 22008
 22009 8800-EXIT.
 22010     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 405
* EL050.cbl
 22012 8900-ADDRESS-FILE.
 22013     IF ERACCT-FILE-ADDRESSED
 22014         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 22015         GO TO 8900-ADDRESS-EXIT.
 22016
 22017     IF ELCNTL-FILE-ADDRESSED
 22018         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 22019         GO TO 8900-ADDRESS-EXIT.
 22020
 22021     IF ERPLAN-FILE-ADDRESSED
 22022         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 22023         GO TO 8900-ADDRESS-EXIT.
 22024
 22025     IF ERFORM-FILE-ADDRESSED
 22026         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 22027         GO TO 8900-ADDRESS-EXIT.
 22028
 22029 8900-ADDRESS-EXIT.
 22030     EXIT.
 22031
 22032 9000-READ-CONTROL.
 22033
 22034* EXEC CICS HANDLE CONDITION
 22035*        NOTFND    (9000-NOTFND)
 22036*    END-EXEC.
 22037*    MOVE '"$I                   ! ? #00020520' TO DFHEIV0
 22038     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22039     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22040     MOVE X'3F20233030303230353230' TO DFHEIV0(25:11)
 22041     CALL 'kxdfhei1' USING DFHEIV0
 22042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22043
 22044
 22045
 22046* EXEC CICS READ
 22047*        DATASET     (CNTL-ID)
 22048*        SET         (ADDRESS OF CONTROL-FILE)
 22049*        RIDFLD      (ELCNTL-KEY)
 22050*        GTEQ
 22051*    END-EXEC.
 22052*    MOVE '&"S        G          (   #00020524' TO DFHEIV0
 22053     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 22054     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22055     MOVE X'2020233030303230353234' TO DFHEIV0(25:11)
 22056     CALL 'kxdfhei1' USING DFHEIV0,
 22057           CNTL-ID,
 22058           DFHEIV20,
 22059           DFHEIV99,
 22060           ELCNTL-KEY,
 22061           DFHEIV99,
 22062           DFHEIV99,
 22063           DFHEIV99
 22064     SET ADDRESS OF CONTROL-FILE TO
 22065         DFHEIV20
 22066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22067
 22068
 22069     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 406
* EL050.cbl
 22070
 22071 9000-NOTFND.
 22072     IF RC-SW-1 = '1'
 22073        MOVE ER-2616              TO WS-ERROR
 22074        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22075        GO TO 9000-EXIT.
 22076
 22077     IF RC-SW-1 = '2'
 22078        MOVE ER-2602              TO WS-ERROR
 22079        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 22080
 22081 9000-EXIT.
 22082      EXIT.
 22083
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 407
* EL050.cbl
 22085 9100-READ-CONTROL.
 22086
 22087* EXEC CICS HANDLE CONDITION
 22088*        NOTFND  (9100-NOTFND)
 22089*        ENDFILE (9100-NOTFND)
 22090*    END-EXEC.
 22091*    MOVE '"$I''                  ! @ #00020548' TO DFHEIV0
 22092     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22093     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22094     MOVE X'4020233030303230353438' TO DFHEIV0(25:11)
 22095     CALL 'kxdfhei1' USING DFHEIV0
 22096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22097
 22098
 22099
 22100* EXEC CICS READ
 22101*        DATASET     (CNTL-ID)
 22102*        INTO        (CONTROL-FILE)
 22103*        RIDFLD      (ELCNTL-KEY)
 22104*        GTEQ
 22105*    END-EXEC.
 22106     MOVE LENGTH OF
 22107      CONTROL-FILE
 22108       TO DFHEIV11
 22109*    MOVE '&"IL       G          (   #00020553' TO DFHEIV0
 22110     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22111     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22112     MOVE X'2020233030303230353533' TO DFHEIV0(25:11)
 22113     CALL 'kxdfhei1' USING DFHEIV0,
 22114           CNTL-ID,
 22115           CONTROL-FILE,
 22116           DFHEIV11,
 22117           ELCNTL-KEY,
 22118           DFHEIV99,
 22119           DFHEIV99,
 22120           DFHEIV99
 22121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22122
 22123
 22124     GO TO 9100-EXIT.
 22125
 22126 9100-NOTFND.
 22127     IF RC-SW-2 = '0'
 22128        MOVE '1'                  TO STATE-RECORD-ERROR
 22129        GO TO 9100-EXIT
 22130     END-IF
 22131     IF RC-SW-2 = '1'
 22132        MOVE '1'                  TO LF-BENEFIT-ERROR
 22133        MOVE ER-2604              TO WS-ERROR
 22134        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22135        GO TO 9100-EXIT.
 22136
 22137     IF RC-SW-2 = '2'
 22138        MOVE '1'                  TO AH-BENEFIT-ERROR
 22139        MOVE ER-2605              TO WS-ERROR
 22140        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22141        GO TO 9100-EXIT.
 22142
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 408
* EL050.cbl
 22143     IF RC-SW-2 = '3'
 22144         MOVE ER-2603           TO WS-ERROR
 22145         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22146         GO TO 9100-EXIT.
 22147
 22148     IF RC-SW-2 = '4'
 22149         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 22150         GO TO 9100-EXIT.
 22151
 22152     IF RC-SW-2 = '5'
 22153         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 22154         IF WS-AH-INPUT-CD-1 = SPACE
 22155             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 22156         ELSE
 22157             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 22158
 22159 9100-EXIT.
 22160      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 409
* EL050.cbl
 22162 9200-CONTROL-GETMAIN.
 22163
 22164* EXEC CICS GETMAIN
 22165*         LENGTH   (750)
 22166*         SET      (ADDRESS OF CONTROL-FILE)
 22167*    END-EXEC.
 22168     MOVE 750
 22169       TO DFHEIV11
 22170*    MOVE '," L                  $   #00020599' TO DFHEIV0
 22171     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 22172     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22173     MOVE X'2020233030303230353939' TO DFHEIV0(25:11)
 22174     CALL 'kxdfhei1' USING DFHEIV0,
 22175           DFHEIV20,
 22176           DFHEIV11,
 22177           DFHEIV99
 22178     SET ADDRESS OF CONTROL-FILE TO
 22179         DFHEIV20
 22180     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22181
 22182
 22183     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 22184
 22185 9200-EXIT.
 22186     EXIT.
 22187
 22188 9250-UNLOCK-RETURN.
 22189
 22190* EXEC CICS UNLOCK
 22191*        DATASET   (CERT-ID)
 22192*    END-EXEC.
 22193*    MOVE '&*                    #   #00020610' TO DFHEIV0
 22194     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 22195     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 22196     MOVE X'2020233030303230363130' TO DFHEIV0(25:11)
 22197     CALL 'kxdfhei1' USING DFHEIV0,
 22198           CERT-ID,
 22199           DFHEIV99
 22200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22201
 22202
 22203 9300-ABEND.
 22204     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 22205
 22206
 22207* EXEC CICS LINK
 22208*        PROGRAM   ('EL004')
 22209*        COMMAREA  (WS-ERROR-LINE)
 22210*        LENGTH    (72)
 22211*    END-EXEC.
 22212     MOVE 'EL004' TO DFHEIV1
 22213     MOVE 72
 22214       TO DFHEIV11
 22215*    MOVE '."C                   (   #00020617' TO DFHEIV0
 22216     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 22217     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22218     MOVE X'2020233030303230363137' TO DFHEIV0(25:11)
 22219     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 410
* EL050.cbl
 22220           DFHEIV1,
 22221           WS-ERROR-LINE,
 22222           DFHEIV11,
 22223           DFHEIV99,
 22224           DFHEIV99,
 22225           DFHEIV99,
 22226           DFHEIV99
 22227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22228
 22229
 22230     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 22231
 22232
 22233* EXEC CICS ABEND
 22234*        ABCODE ('EL50')
 22235*    END-EXEC.
 22236     MOVE 'EL50' TO DFHEIV5
 22237*    MOVE '.,A                   "   #00020625' TO DFHEIV0
 22238     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 22239     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 22240     MOVE X'2020233030303230363235' TO DFHEIV0(25:11)
 22241     CALL 'kxdfhei1' USING DFHEIV0,
 22242           DFHEIV5
 22243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22244
 22245
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 411
* EL050.cbl
 22247
 22248******************************************************************
 22249*                                                                *
 22250*            E R R O R   F O R M A T   R O U T I N E             *
 22251*                                                                *
 22252******************************************************************
 22253
 22254 9900-ERROR-FORMAT.
 22255
 22256     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 22257                    PB-COMMON-ERROR (2) OR
 22258                    PB-COMMON-ERROR (3) OR
 22259                    PB-COMMON-ERROR (4) OR
 22260                    PB-COMMON-ERROR (5) OR
 22261                    PB-COMMON-ERROR (6) OR
 22262                    PB-COMMON-ERROR (7) OR
 22263                    PB-COMMON-ERROR (8) OR
 22264                    PB-COMMON-ERROR (9) OR
 22265                    PB-COMMON-ERROR (10)
 22266        GO TO 9900-EXIT.
 22267
 22268     IF PB-NO-OF-ERRORS = +10
 22269        GO TO 9900-EXIT.
 22270
 22271     ADD +1  TO PB-NO-OF-ERRORS.
 22272     MOVE WS-ERROR               TO PB-COMMON-ERROR
 22273                                       (PB-NO-OF-ERRORS).
 22274 9900-EXIT.
 22275     EXIT.
 22276
 22277 9990-RETURN.
 22278     IF BROWSE-STARTED
 22279
 22280* EXEC CICS ENDBR
 22281*            DATASET  (ACCT-ID)
 22282*       END-EXEC.
 22283     MOVE 0
 22284       TO DFHEIV11
 22285*    MOVE '&2                    $   #00020662' TO DFHEIV0
 22286     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22287     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22288     MOVE X'2020233030303230363632' TO DFHEIV0(25:11)
 22289     CALL 'kxdfhei1' USING DFHEIV0,
 22290           ACCT-ID,
 22291           DFHEIV11,
 22292           DFHEIV99
 22293     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22294
 22295
 22296 9990-EXIT.
 22297     EXIT.
 22298
 22299
 22300****Check for CRTO record, add one if not found.
 22301 9991-CHECK-FOR-ELCRTO.
 22302
 22303* EXEC CICS HANDLE CONDITION
 22304*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 412
* EL050.cbl
 22305*         ENDFILE (9991-CRTO-NOT-FOUND)
 22306*     END-EXEC.
 22307*    MOVE '"$I''                  ! A #00020672' TO DFHEIV0
 22308     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22309     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22310     MOVE X'4120233030303230363732' TO DFHEIV0(25:11)
 22311     CALL 'kxdfhei1' USING DFHEIV0
 22312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22313
 22314     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 22315     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 22316     MOVE +0                     TO ELCRTO-SEQ-NO
 22317
 22318
 22319* EXEC CICS READ
 22320*       DATASET   ('ELCRTO')
 22321*       INTO      (ORIGINAL-CERTIFICATE)
 22322*       RIDFLD    (ELCRTO-KEY)
 22323*       GTEQ
 22324*       RESP      (WS-RESPONSE)
 22325*    END-EXEC
 22326     MOVE LENGTH OF
 22327      ORIGINAL-CERTIFICATE
 22328       TO DFHEIV11
 22329     MOVE 'ELCRTO' TO DFHEIV1
 22330*    MOVE '&"IL       G          (  N#00020680' TO DFHEIV0
 22331     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22332     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22333     MOVE X'204E233030303230363830' TO DFHEIV0(25:11)
 22334     CALL 'kxdfhei1' USING DFHEIV0,
 22335           DFHEIV1,
 22336           ORIGINAL-CERTIFICATE,
 22337           DFHEIV11,
 22338           ELCRTO-KEY,
 22339           DFHEIV99,
 22340           DFHEIV99,
 22341           DFHEIV99
 22342     MOVE EIBRESP  TO WS-RESPONSE
 22343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22344
 22345     IF WS-RESP-NORMAL
 22346        AND (OC-CONTROL-PRIMARY (1:33) =
 22347                 PB-CONTROL-BY-ACCOUNT (1:33))
 22348        AND (OC-RECORD-TYPE =  'I')
 22349           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 22350               GO TO 9991-CHECK-INDICATORS
 22351           ELSE
 22352               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 22353               GO TO 9991-CRTO-ADD-REC
 22354           END-IF
 22355     END-IF.
 22356
 22357 9991-CRTO-NOT-FOUND.
 22358
 22359     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 22360     MOVE 'OC'                TO OC-RECORD-ID
 22361     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 22362                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 413
* EL050.cbl
 22363     MOVE +4096               TO OC-KEY-SEQ-NO.
 22364
 22365 9991-CRTO-ADD-REC.
 22366
 22367     MOVE 'E050'              TO OC-LAST-MAINT-BY
 22368     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 22369     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 22370     MOVE 'I'                 TO OC-RECORD-TYPE
 22371     IF PB-ISSUE
 22372         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 22373         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 22374         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 22375         MOVE PB-I-AGE               TO OC-INS-AGE
 22376         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 22377         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 22378         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 22379         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 22380         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 22381         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 22382         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 22383         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 22384         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22385         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22386         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22387         IF PB-I-JOINT-COMMISSION > +0
 22388             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22389         ELSE
 22390             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22391         END-IF
 22392         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 22393         MOVE +0                     TO OC-LF-CANCEL-AMT
 22394                                        OC-LF-ITD-CANCEL-AMT
 22395         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22396         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22397         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22398         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22399         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22400         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22401         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22402         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 22403         MOVE +0                     TO OC-AH-CANCEL-AMT
 22404                                        OC-AH-ITD-CANCEL-AMT
 22405         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22406         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22407         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 22408     ELSE
 22409         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 22410         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 22411         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 22412         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 22413         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 22414         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 22415         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 22416         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 22417         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 22418          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 22419             MOVE SPACES             TO OC-LF-BENCD
 22420             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 414
* EL050.cbl
 22421                                        OC-LF-BEN-AMT
 22422                                        OC-LF-PRM-AMT
 22423                                        OC-LF-ALT-BEN-AMT
 22424                                        OC-LF-ALT-PRM-AMT
 22425                                        OC-LF-COMM-PCT
 22426                                        OC-LF-CANCEL-AMT
 22427             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 22428             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 22429         ELSE
 22430             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 22431             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 22432             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 22433             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 22434             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22435             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22436             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 22437             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 22438             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 22439             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 22440         END-IF
 22441         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 22442         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 22443          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 22444             MOVE SPACES             TO OC-AH-BENCD
 22445             MOVE ZEROS              TO OC-AH-TERM
 22446                                        OC-AH-BEN-AMT
 22447                                        OC-AH-PRM-AMT
 22448                                        OC-AH-COMM-PCT
 22449                                        OC-AH-CANCEL-AMT
 22450                                        OC-AH-CP
 22451             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 22452             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 22453         ELSE
 22454             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 22455             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 22456             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 22457             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 22458             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 22459             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 22460             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 22461             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 22462             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 22463         END-IF
 22464         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 22465         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 22466         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 22467         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 22468     END-IF
 22469     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 22470
 22471     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22472
 22473
 22474* EXEC CICS READ
 22475*         DATASET   (FILE-ERMAIL)
 22476*         RIDFLD    (MA-CONTROL-PRIMARY)
 22477*         INTO      (MAILING-DATA)
 22478*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 415
* EL050.cbl
 22479*    END-EXEC
 22480     MOVE LENGTH OF
 22481      MAILING-DATA
 22482       TO DFHEIV11
 22483*    MOVE '&"IL       E          (  N#00020816' TO DFHEIV0
 22484     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22485     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22486     MOVE X'204E233030303230383136' TO DFHEIV0(25:11)
 22487     CALL 'kxdfhei1' USING DFHEIV0,
 22488           FILE-ERMAIL,
 22489           MAILING-DATA,
 22490           DFHEIV11,
 22491           MA-CONTROL-PRIMARY,
 22492           DFHEIV99,
 22493           DFHEIV99,
 22494           DFHEIV99
 22495     MOVE EIBRESP  TO WS-RESPONSE
 22496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22497
 22498     IF WS-RESP-NORMAL
 22499         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22500     END-IF.
 22501
 22502     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22503     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22504
 22505
 22506* EXEC CICS READ
 22507*         DATASET  (CRTT-ID)
 22508*         RIDFLD   (WS-ELCRTT-KEY)
 22509*         INTO     (CERTIFICATE-TRAILERS)
 22510*         RESP     (WS-RESPONSE)
 22511*    END-EXEC
 22512     MOVE LENGTH OF
 22513      CERTIFICATE-TRAILERS
 22514       TO DFHEIV11
 22515*    MOVE '&"IL       E          (  N#00020830' TO DFHEIV0
 22516     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22517     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22518     MOVE X'204E233030303230383330' TO DFHEIV0(25:11)
 22519     CALL 'kxdfhei1' USING DFHEIV0,
 22520           CRTT-ID,
 22521           CERTIFICATE-TRAILERS,
 22522           DFHEIV11,
 22523           WS-ELCRTT-KEY,
 22524           DFHEIV99,
 22525           DFHEIV99,
 22526           DFHEIV99
 22527     MOVE EIBRESP  TO WS-RESPONSE
 22528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22529
 22530     IF WS-RESP-NORMAL
 22531         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 22532         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 22533     END-IF.
 22534
 22535
 22536* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 416
* EL050.cbl
 22537*       DATASET   ('ELCRTO')
 22538*       FROM      (ORIGINAL-CERTIFICATE)
 22539*       RIDFLD    (OC-CONTROL-PRIMARY)
 22540*       RESP      (WS-RESPONSE)
 22541*    END-EXEC.
 22542     MOVE LENGTH OF
 22543      ORIGINAL-CERTIFICATE
 22544       TO DFHEIV11
 22545     MOVE 'ELCRTO' TO DFHEIV1
 22546*    MOVE '&$ L                  ''  N#00020842' TO DFHEIV0
 22547     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 22548     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22549     MOVE X'204E233030303230383432' TO DFHEIV0(25:11)
 22550     CALL 'kxdfhei1' USING DFHEIV0,
 22551           DFHEIV1,
 22552           ORIGINAL-CERTIFICATE,
 22553           DFHEIV11,
 22554           OC-CONTROL-PRIMARY,
 22555           DFHEIV99,
 22556           DFHEIV99
 22557     MOVE EIBRESP  TO WS-RESPONSE
 22558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22559
 22560
 22561     GO TO 9991-EXIT.
 22562
 22563 9991-CHECK-INDICATORS.
 22564
 22565     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 22566         GO TO 9991-EXIT
 22567     END-IF.
 22568
 22569     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 22570         GO TO 9991-EXIT
 22571     END-IF.
 22572
 22573
 22574* EXEC CICS READ
 22575*       DATASET   ('ELCRTO')
 22576*       INTO      (ORIGINAL-CERTIFICATE)
 22577*       RIDFLD    (OC-CONTROL-PRIMARY)
 22578*       UPDATE
 22579*       RESP      (WS-RESPONSE)
 22580*    END-EXEC
 22581     MOVE LENGTH OF
 22582      ORIGINAL-CERTIFICATE
 22583       TO DFHEIV11
 22584     MOVE 'ELCRTO' TO DFHEIV1
 22585*    MOVE '&"IL       EU         (  N#00020861' TO DFHEIV0
 22586     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22587     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22588     MOVE X'204E233030303230383631' TO DFHEIV0(25:11)
 22589     CALL 'kxdfhei1' USING DFHEIV0,
 22590           DFHEIV1,
 22591           ORIGINAL-CERTIFICATE,
 22592           DFHEIV11,
 22593           OC-CONTROL-PRIMARY,
 22594           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 417
* EL050.cbl
 22595           DFHEIV99,
 22596           DFHEIV99
 22597     MOVE EIBRESP  TO WS-RESPONSE
 22598     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22599     IF WS-RESP-NORMAL
 22600        IF PB-ISSUE
 22601          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 22602          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 22603          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 22604          MOVE PB-I-AGE               TO OC-INS-AGE
 22605          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 22606          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 22607          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 22608          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 22609          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 22610          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 22611          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 22612          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 22613          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22614          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22615          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22616          IF PB-I-JOINT-COMMISSION > +0
 22617              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22618          ELSE
 22619              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22620          END-IF
 22621          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22622          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22623          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22624          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22625          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22626          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22627          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22628          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22629          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22630
 22631          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22632
 22633* EXEC CICS READ
 22634*             DATASET   (FILE-ERMAIL)
 22635*             RIDFLD    (MA-CONTROL-PRIMARY)
 22636*             INTO      (MAILING-DATA)
 22637*             RESP      (WS-RESPONSE)
 22638*         END-EXEC
 22639     MOVE LENGTH OF
 22640      MAILING-DATA
 22641       TO DFHEIV11
 22642*    MOVE '&"IL       E          (  N#00020901' TO DFHEIV0
 22643     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22644     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22645     MOVE X'204E233030303230393031' TO DFHEIV0(25:11)
 22646     CALL 'kxdfhei1' USING DFHEIV0,
 22647           FILE-ERMAIL,
 22648           MAILING-DATA,
 22649           DFHEIV11,
 22650           MA-CONTROL-PRIMARY,
 22651           DFHEIV99,
 22652           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 418
* EL050.cbl
 22653           DFHEIV99
 22654     MOVE EIBRESP  TO WS-RESPONSE
 22655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22656          IF WS-RESP-NORMAL
 22657             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22658          END-IF
 22659
 22660          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22661          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22662
 22663* EXEC CICS READ
 22664*             DATASET  (CRTT-ID)
 22665*             RIDFLD   (WS-ELCRTT-KEY)
 22666*             INTO     (CERTIFICATE-TRAILERS)
 22667*             RESP     (WS-RESPONSE)
 22668*         END-EXEC
 22669     MOVE LENGTH OF
 22670      CERTIFICATE-TRAILERS
 22671       TO DFHEIV11
 22672*    MOVE '&"IL       E          (  N#00020913' TO DFHEIV0
 22673     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22674     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22675     MOVE X'204E233030303230393133' TO DFHEIV0(25:11)
 22676     CALL 'kxdfhei1' USING DFHEIV0,
 22677           CRTT-ID,
 22678           CERTIFICATE-TRAILERS,
 22679           DFHEIV11,
 22680           WS-ELCRTT-KEY,
 22681           DFHEIV99,
 22682           DFHEIV99,
 22683           DFHEIV99
 22684     MOVE EIBRESP  TO WS-RESPONSE
 22685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22686          IF WS-RESP-NORMAL
 22687             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 22688                               OC-INS-AGE-DEFAULT-FLAG
 22689             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 22690                               OC-JNT-AGE-DEFAULT-FLAG
 22691          END-IF
 22692
 22693        ELSE
 22694          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22695             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 22696             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 22697             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 22698          END-IF
 22699          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22700             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 22701             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 22702             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 22703          END-IF
 22704          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 22705        END-IF
 22706
 22707* EXEC CICS REWRITE
 22708*          DATASET   ('ELCRTO')
 22709*          FROM      (ORIGINAL-CERTIFICATE)
 22710*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 419
* EL050.cbl
 22711*       END-EXEC
 22712     MOVE LENGTH OF
 22713      ORIGINAL-CERTIFICATE
 22714       TO DFHEIV11
 22715     MOVE 'ELCRTO' TO DFHEIV1
 22716*    MOVE '&& L                  %  N#00020939' TO DFHEIV0
 22717     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 22718     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22719     MOVE X'204E233030303230393339' TO DFHEIV0(25:11)
 22720     CALL 'kxdfhei1' USING DFHEIV0,
 22721           DFHEIV1,
 22722           ORIGINAL-CERTIFICATE,
 22723           DFHEIV11,
 22724           DFHEIV99
 22725     MOVE EIBRESP  TO WS-RESPONSE
 22726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22727     END-IF.
 22728
 22729 9991-EXIT.
 22730     EXIT.
 22731
 22732
 22733 9999-RETURN.
 22734     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 22735
 22736
 22737* EXEC CICS RETURN
 22738*    END-EXEC.
 22739*    MOVE '.(                    ''   #00020953' TO DFHEIV0
 22740     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 22741     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22742     MOVE X'2020233030303230393533' TO DFHEIV0(25:11)
 22743     CALL 'kxdfhei1' USING DFHEIV0,
 22744           DFHEIV99,
 22745           DFHEIV99,
 22746           DFHEIV99,
 22747           DFHEIV99,
 22748           DFHEIV99,
 22749           DFHEIV99
 22750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22751
 22752
 22753
 22754* GOBACK.
 22755     MOVE '9%                    "   ' TO DFHEIV0
 22756     MOVE 'EL050' TO DFHEIV1
 22757     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22758     GOBACK.
 22759
 22760 9999-DFHBACK SECTION.
 22761     MOVE '9%                    "   ' TO DFHEIV0
 22762     MOVE 'EL050' TO DFHEIV1
 22763     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22764     GOBACK.
 22765 9999-DFHEXIT.
 22766     IF DFHEIGDJ EQUAL 0001
 22767         NEXT SENTENCE
 22768     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 420
* EL050.cbl
 22769         GO TO 9300-ABEND,
 22770               3990-FILES-NOT-OPEN
 22771         DEPENDING ON DFHEIGDI
 22772     ELSE IF DFHEIGDJ EQUAL 3
 22773         GO TO 6610-START-BROWSE,
 22774               6630-ERRESS-PROBLEM,
 22775               6630-END-OF-FILE
 22776         DEPENDING ON DFHEIGDI
 22777     ELSE IF DFHEIGDJ EQUAL 4
 22778         GO TO 6630-END-OF-FILE,
 22779               6630-ERRESS-PROBLEM,
 22780               6630-ERRESS-PROBLEM,
 22781               6630-END-OF-FILE
 22782         DEPENDING ON DFHEIGDI
 22783     ELSE IF DFHEIGDJ EQUAL 5
 22784         GO TO 6630-END-OF-FILE,
 22785               6630-END-OF-FILE,
 22786               6630-ERRESS-PROBLEM,
 22787               6630-ERRESS-PROBLEM
 22788         DEPENDING ON DFHEIGDI
 22789     ELSE IF DFHEIGDJ EQUAL 6
 22790         GO TO 6660-START-BROWSE,
 22791               6690-ERRESC-PROBLEM,
 22792               6690-ERRESC-PROBLEM,
 22793               6690-END-OF-FILE
 22794         DEPENDING ON DFHEIGDI
 22795     ELSE IF DFHEIGDJ EQUAL 7
 22796         GO TO 6690-END-OF-FILE,
 22797               6690-ERRESC-PROBLEM,
 22798               6690-ERRESC-PROBLEM,
 22799               6690-END-OF-FILE
 22800         DEPENDING ON DFHEIGDI
 22801     ELSE IF DFHEIGDJ EQUAL 8
 22802         GO TO 6690-END-OF-FILE,
 22803               6690-ERRESC-PROBLEM,
 22804               6690-ERRESC-PROBLEM,
 22805               6690-END-OF-FILE
 22806         DEPENDING ON DFHEIGDI
 22807     ELSE IF DFHEIGDJ EQUAL 9
 22808         GO TO 7250-CONTINUE,
 22809               7250-CONTINUE
 22810         DEPENDING ON DFHEIGDI
 22811     ELSE IF DFHEIGDJ EQUAL 10
 22812         GO TO 7300-CONTINUE,
 22813               7300-CONTINUE
 22814         DEPENDING ON DFHEIGDI
 22815     ELSE IF DFHEIGDJ EQUAL 11
 22816         GO TO 8000-FREE-MAIN
 22817         DEPENDING ON DFHEIGDI
 22818     ELSE IF DFHEIGDJ EQUAL 12
 22819         GO TO 8100-NOTFND,
 22820               8100-NOTFND
 22821         DEPENDING ON DFHEIGDI
 22822     ELSE IF DFHEIGDJ EQUAL 13
 22823         GO TO 8110-NOTFND,
 22824               8110-NOTFND
 22825         DEPENDING ON DFHEIGDI
 22826     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 421
* EL050.cbl
 22827         GO TO 8130-EXIT
 22828         DEPENDING ON DFHEIGDI
 22829     ELSE IF DFHEIGDJ EQUAL 15
 22830         GO TO 8150-exit
 22831         DEPENDING ON DFHEIGDI
 22832     ELSE IF DFHEIGDJ EQUAL 16
 22833         GO TO 8180-NOTFND
 22834         DEPENDING ON DFHEIGDI
 22835     ELSE IF DFHEIGDJ EQUAL 17
 22836         GO TO 8190-NOTFND
 22837         DEPENDING ON DFHEIGDI
 22838     ELSE IF DFHEIGDJ EQUAL 18
 22839         GO TO 8195-NOTFND
 22840         DEPENDING ON DFHEIGDI
 22841     ELSE IF DFHEIGDJ EQUAL 19
 22842         GO TO 8200-NOTFND
 22843         DEPENDING ON DFHEIGDI
 22844     ELSE IF DFHEIGDJ EQUAL 20
 22845         GO TO 8300-NOTFND,
 22846               8300-ERRESS-PROBLEM,
 22847               8300-ERRESS-PROBLEM,
 22848               8300-NOTFND
 22849         DEPENDING ON DFHEIGDI
 22850     ELSE IF DFHEIGDJ EQUAL 21
 22851         GO TO 8450-FORM-NOT-FOUND,
 22852               8450-FORM-NOT-FOUND
 22853         DEPENDING ON DFHEIGDI
 22854     ELSE IF DFHEIGDJ EQUAL 22
 22855         GO TO 0199-ACCT-NOT-FOUND,
 22856               0199-ACCT-NOT-FOUND
 22857         DEPENDING ON DFHEIGDI
 22858     ELSE IF DFHEIGDJ EQUAL 23
 22859         GO TO 0199-ACCT-NOT-FOUND,
 22860               0199-ACCT-NOT-FOUND
 22861         DEPENDING ON DFHEIGDI
 22862     ELSE IF DFHEIGDJ EQUAL 24
 22863         GO TO 8582-COMP-NOT-FOUND,
 22864               8582-COMP-NOT-FOUND
 22865         DEPENDING ON DFHEIGDI
 22866     ELSE IF DFHEIGDJ EQUAL 25
 22867         GO TO 8583-AGTC-NOT-FOUND,
 22868               8583-AGTC-NOT-FOUND
 22869         DEPENDING ON DFHEIGDI
 22870     ELSE IF DFHEIGDJ EQUAL 26
 22871         GO TO 8584-BXRF-NOT-FOUND,
 22872               8584-BXRF-NOT-FOUND
 22873         DEPENDING ON DFHEIGDI
 22874     ELSE IF DFHEIGDJ EQUAL 27
 22875         GO TO 8585-PLAN-NOT-FOUND,
 22876               8585-PLAN-NOT-FOUND
 22877         DEPENDING ON DFHEIGDI
 22878     ELSE IF DFHEIGDJ EQUAL 28
 22879         GO TO 0299-CERT-NOT-FOUND
 22880         DEPENDING ON DFHEIGDI
 22881     ELSE IF DFHEIGDJ EQUAL 29
 22882         GO TO 8700-READ-CERT-MASTER
 22883         DEPENDING ON DFHEIGDI
 22884     ELSE IF DFHEIGDJ EQUAL 30
* Micro Focus Server Express         V5.1 revision 000 04-Dec-17 11:47 Page 422
* EL050.cbl
 22885         GO TO 8720-COMP-ACCOUNTS,
 22886               8730-END-BROWSE,
 22887               8740-NOT-FOUND
 22888         DEPENDING ON DFHEIGDI
 22889     ELSE IF DFHEIGDJ EQUAL 31
 22890         GO TO 9000-NOTFND
 22891         DEPENDING ON DFHEIGDI
 22892     ELSE IF DFHEIGDJ EQUAL 32
 22893         GO TO 9100-NOTFND,
 22894               9100-NOTFND
 22895         DEPENDING ON DFHEIGDI
 22896     ELSE IF DFHEIGDJ EQUAL 33
 22897         GO TO 9991-CRTO-NOT-FOUND,
 22898               9991-CRTO-NOT-FOUND
 22899         DEPENDING ON DFHEIGDI.
 22900     MOVE '9%                    "   ' TO DFHEIV0
 22901     MOVE 'EL050' TO DFHEIV1
 22902     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22903     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       41600     Code:       93880
