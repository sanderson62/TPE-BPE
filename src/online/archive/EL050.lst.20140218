* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46******************************************************************
    47 ENVIRONMENT DIVISION.
    48
    49 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page   3
* EL050.cbl
    51 WORKING-STORAGE SECTION.
    52 01  DFH-START PIC X(04).
    53
    54 77  FILLER   PIC X(32) VALUE '********************************'.
    55 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    56 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    57
    58 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    59 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    60                                   USAGE POINTER.
    61 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    62 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    63 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    64                                   USAGE IS POINTER.
    65 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    66 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    67                                   USAGE IS POINTER.
    68 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    69 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    70                                   USAGE IS POINTER.
    71
    72 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    73 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    74                                   USAGE IS POINTER.
    75
    76*    COPY ELC50WS.
    77*****************************************************************
    78*                                                               *
    79*                            ELC50WS.                           *
    80*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    81*                            VMOD=2.061.                        *
    82*                                                               *
    83*   THIS IS THE WORKING STORAGE FOR EL050                       *
    84*                                   EL517                       *
    85*****************************************************************
    86******************************************************************
    87*                   C H A N G E   L O G
    88*
    89* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    90*-----------------------------------------------------------------
    91*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    92* EFFECTIVE    NUMBER
    93*-----------------------------------------------------------------
    94* 123102                   PEMA  ADD DCC PROCESSING
    95* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
    96* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
    97* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
    98* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    99* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   100* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   101* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   102* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   103* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   104* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   105* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   106* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   107* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   108* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page   4
* EL050.cbl
   109* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   110* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   111* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   112* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   113* 030309  CR2009021700001  PEMA  ADD ER-2883
   114* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   115* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   116* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   117* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   118* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   119* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   120* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   121* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   122* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   123* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   124* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   125* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   126* 061412  CR2011022800001  AJRA  NAPERSOFT
   127* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   128* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   129* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   130* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   131* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   132*-----------------------------------------------------------------
   133
   134 01  WORK-AREAS.
   135
   136*****************************************************************
   137*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   138*****************************************************************
   139
   140     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   141     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   142     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   143     12  WS-NAME-EDIT-WORK-AREA.
   144         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   145         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   146             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   147         16  WS-WORK-NAME.
   148             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   149             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   150             20  FILLER           PIC X(10)     VALUE SPACES.
   151         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   152             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   153
   154*****************************************************************
   155*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   156*****************************************************************
   157
   158     12  WS-ERRESC-KEY.
   159         16 WS-ERRESC-SEARCH-KEY.
   160             20  WS-ERRESC-COMPANY-CD PIC  X.
   161             20  WS-ERRESC-CARRIER    PIC  X.
   162             20  WS-ERRESC-GROUP      PIC X(6).
   163             20  WS-ERRESC-STATE      PIC XX.
   164             20  WS-ERRESC-ACCOUNT    PIC X(10).
   165         16 WS-ERRESC-RESIDUAL-KEY.
   166             20  WS-ERRESC-AGENT      PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page   5
* EL050.cbl
   167             20  WS-ERRESC-RES-STATE  PIC XX.
   168             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   169*                                          YYYYMMDD
   170     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   171     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   172
   173*RESIDENT STATE TAX MASTER(ERRESS)
   174*
   175     12  WS-ERRESS-KEY.
   176         16  WS-ERRESS-COMPANY-CD      PIC  X.
   177         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   178         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   179         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   180*                                          YYYYMMDD
   181
   182     12  WS-CONTRACT-DATE              PIC 9(8).
   183*                                          YYYYMMDD
   184     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   185     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   186         16 WS-YEAR-YY                 PIC   9999.
   187         16 FILLER                     PIC 9(4).
   188*                                          YYYYMMDD
   189     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   190     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   191     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   192     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   193
   194     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   195         88  DPRB-1ST-TIME                      VALUE ' '.
   196
   197*****************************************************************
   198*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   199*****************************************************************
   200
   201     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   202     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   203     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   204     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   205     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   206     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   207     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   208     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   209     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   210     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   211         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   212         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   213     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   214         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   215         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   216     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   217
   218     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   219     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   220
   221     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   222     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   223     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   224     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page   6
* EL050.cbl
   225     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   226     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   227     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   228     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   229     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   230     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   231     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   232     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   233     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   234     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   235     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   236     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   237     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   238     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   239     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   240     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   241     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   242     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   243     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   244     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   245     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   246     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   247     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   248     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   249     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   250     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   251     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   252     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   253     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   254     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   255     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   256     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   257     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   258     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   259     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   260     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   261     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   262     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   263     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   264     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   265     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   266     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   267     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   268     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   269     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   270     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   271     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   272     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   273     12  WS-2671-SW               PIC X         VALUE SPACE.
   274     12  WS-2672-SW               PIC X         VALUE SPACE.
   275     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   276         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   277     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   278         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   279     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   280
   281     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   282         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page   7
* EL050.cbl
   283         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   284         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   285         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   286
   287     12  WS-CREDIT-EDIT-CONTROLS.
   288         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   289         16  WS-MIN-AGE           PIC 99                VALUE  0.
   290         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   291         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   292         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   293         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   294
   295     12  WS-AGE-FIELDS.
   296         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   297         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   298         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   299         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   300
   301     12  WS-SAVE-ALLOWABLE-BENEFIT.
   302         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   303         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   304         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   305         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   306         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   307         16  FILLER                      PIC XX.
   308
   309     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   310     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   311     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   312     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   313     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   314     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   315     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   316     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   317     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   318     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   319
   320     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   321     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   322     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   323     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   324     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   325     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   326     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   327     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   328         88  WS-REDUCING              VALUE 'R'.
   329         88  WS-LEVEL                 VALUE 'L' 'P'.
   330     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   331
   332     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   333     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   334     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   335     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   336     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   337     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   338     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   339     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   340     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page   8
* EL050.cbl
   341
   342     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   343     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   344     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   345     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   346     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   347     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   348     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   349     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   350     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   351     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   352     12  WS-ACCT-SIG-SW.
   353         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   354         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   355     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   356     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   357     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   358     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   359     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   360     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   361     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   362     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   363     12  WS-INITIALS.
   364         16  WS-INIT-1            PIC X         VALUE SPACES.
   365         16  WS-INIT-2            PIC X         VALUE SPACES.
   366
   367     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   368     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   369     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   370     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   371     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   372*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   373     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   374     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   375     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   376     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   377     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   378     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   379     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   380     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   381     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   382     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   383     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   384     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   385     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   386     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   387     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   388     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   389     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   390     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   391     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   392     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   393     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   394     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   395******** FLA
   396     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   397     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   398     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page   9
* EL050.cbl
   399     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   400     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   401********
   402     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   403     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   404     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   405     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   406     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   407     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   408     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   409     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   410     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   411     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   412
   413     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   414         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   415                                         '0' THRU '9'.
   416
   417     12  NUMBER-OF-MONTHS.
   418         16  SK-MO OCCURS 12 TIMES PIC X.
   419
   420     12  WS-WORK-DATE.
   421         16  WS-YEAR            PIC 99    VALUE 00.
   422         16  WS-MONTH           PIC 99    VALUE 00.
   423         16  WS-DAY             PIC 99    VALUE 00.
   424
   425     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   426     12  WS-WORK-CRIT-DEV       REDEFINES
   427         WS-WORK-LF-CRIT-PER    PIC X(03).
   428
   429     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   430     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   431
   432     12  WS-WORK-DATE-FROM.
   433         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   434         16  FILLER             PIC X  VALUE SPACE.
   435         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   436         16  FILLER             PIC X         VALUE SPACE.
   437         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   438
   439     12  WS-WORK-DATE-THRU.
   440         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   441         16  FILLER             PIC X         VALUE SPACE.
   442         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   443         16  FILLER             PIC X         VALUE SPACE.
   444         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   445
   446     12  WS-LF-INPUT-CD.
   447         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   448         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   449
   450     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   451     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   452         16  WS-AH-INPUT-CD-1   PIC X.
   453         16  WS-AH-INPUT-CD-2-3 PIC XX.
   454
   455     12  WS-SWITCHES.
   456         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  10
* EL050.cbl
   457         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   458             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   459         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   460             88  BANK-ACCT-FOUND          VALUE 'Y'.
   461         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   462             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   463         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   464             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   465         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   466             88  COMP-MASTER-FOUND        VALUE 'Y'.
   467         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   468             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   469         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   470             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   471         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   472             88  STAT-MASTER-FOUND        VALUE 'Y'.
   473         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   474             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   475         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   476             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   477         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   478             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   479         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   480             88  FORM-MASTER-FOUND        VALUE 'Y'.
   481         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   482             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   483         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   484             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   485         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   486             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   487         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   488             88  NO-BENEFIT-FOUND         VALUE 'N'.
   489         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   490             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   491         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   492             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   493         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   494             88  AH-BENEFIT-FOUND         VALUE ' '.
   495             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   496         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   497             88  LF-BENEFIT-FOUND         VALUE ' '.
   498             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   499         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   500             88  NO-STATE-RECORD          VALUE '1'.
   501         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   502             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   503         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   504             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   505         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   506             88  CERT-WAS-FOUND           VALUE ' '.
   507             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   508         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   509             88  BROWSE-STARTED           VALUE 'Y'.
   510         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   511             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   512         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   513             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   514         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  11
* EL050.cbl
   515             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   516         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   517             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   518         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   519             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   520         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   521             88  APP-CERT-USED            VALUE 'Y' 'A'.
   522         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   523             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   524             88  FIRST-TIME-THROUGH       VALUE '1'.
   525             88  CTBL-NOT-FOUND           VALUE '2'.
   526
   527         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   528             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   529
   530         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   531             88  DLO-ERROR-FOUND          VALUE 'Y'.
   532
   533********FLA
   534     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   535     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   536********
   537     12  RC-SW-1                  PIC X           VALUE '0'.
   538     12  RC-SW-2                  PIC X           VALUE '0'.
   539     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   540     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   541     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   542     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   543     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   544     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   545     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   546     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   547     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   548     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   549     12  LIT-SPACES               PIC X           VALUE SPACES.
   550     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   551     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   552     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   553     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   554     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   555     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   556     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   557         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   558         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   559     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   560         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   561
   562 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   563     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   564     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   565 01  WS-CRI-SSN-WORK-AREA.
   566     05  WS-CRI-SOC-SEC-NO.
   567         10  WS-SS-REPT-CD       PIC X(5).
   568         10  WS-SS-LAST-NAME     PIC X(5).
   569         10  WS-SS-INITIAL       PIC X.
   570
   571     05  WS-CRI-REPORT-CODE.
   572         10  FILLER              PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  12
* EL050.cbl
   573         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   574
   575     05  WS-CRI-LAST-NAME.
   576         10  WS-CRI-NAME-MOVE    PIC X(5).
   577         10  FILLER              PIC X(10).
   578
   579 01  WS-NUM-TABLE                PIC X(26)  VALUE
   580     '12345678012345070923456789'.
   581 01  FILLER REDEFINES WS-NUM-TABLE.
   582     05  WS-NUM OCCURS 26        PIC 9.
   583 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   584 01  V1                          PIC S999 COMP-3.
   585 01  V2                          PIC S999 COMP-3.
   586 01  V3                          PIC S999 COMP-3.
   587 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   588 01  FILLER REDEFINES WS-WORK-VIN.
   589     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   590 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   591 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   592 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   593 01  WS-HEX-WORK.
   594     05  FILLER                  PIC X  VALUE LOW-VALUES.
   595     05  WS-HEX-BYTE             PIC X.
   596 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   597 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   598 01  WS-WORK-HIN-ROW-B.
   599     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   600
   601 01  ws-benefit-cd-chg-sw      pic x value spaces.
   602     88  benefit-code-chg           value 'Y'.
   603 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   604 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   605     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   606 01  WS-ROW-D-TABLE.
   607     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   608
   609 01  WS-HIN-TABLE-B.
   610     05  F                       PIC XX VALUE 'A2'.
   611     05  F                       PIC XX VALUE 'B3'.
   612     05  F                       PIC XX VALUE 'C4'.
   613     05  F                       PIC XX VALUE 'D5'.
   614     05  F                       PIC XX VALUE 'E6'.
   615     05  F                       PIC XX VALUE 'F7'.
   616     05  F                       PIC XX VALUE 'G8'.
   617     05  F                       PIC XX VALUE 'H9'.
   618     05  F                       PIC XX VALUE 'I1'.
   619     05  F                       PIC XX VALUE 'J2'.
   620     05  F                       PIC XX VALUE 'K3'.
   621     05  F                       PIC XX VALUE 'L4'.
   622     05  F                       PIC XX VALUE 'M5'.
   623     05  F                       PIC XX VALUE 'N6'.
   624     05  F                       PIC XX VALUE 'O0'.
   625     05  F                       PIC XX VALUE 'P7'.
   626     05  F                       PIC XX VALUE 'Q0'.
   627     05  F                       PIC XX VALUE 'R8'.
   628     05  F                       PIC XX VALUE 'S9'.
   629     05  F                       PIC XX VALUE 'T2'.
   630     05  F                       PIC XX VALUE 'U3'.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  13
* EL050.cbl
   631     05  F                       PIC XX VALUE 'V4'.
   632     05  F                       PIC XX VALUE 'W5'.
   633     05  F                       PIC XX VALUE 'X6'.
   634     05  F                       PIC XX VALUE 'Y7'.
   635     05  F                       PIC XX VALUE 'Z8'.
   636 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   637     05  WS-VAL-IN               PIC X.
   638     05  WS-VAL-OUT              PIC 9.
   639 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   640 01  WS-COMPARE-BINARY-DATES.
   641     05  WS-971231                PIC XX VALUE X'92FF'.
   642     05  WS-931231                PIC XX VALUE X'8CFF'.
   643     05  WS-791231                PIC XX VALUE X'77FF'.
   644     05  WS-771001                PIC XX VALUE X'74A1'.
   645     05  WS-820301                PIC XX VALUE X'7B41'.
   646     05  WS-831031                PIC XX VALUE X'7DBF'.
   647     05  WS-831231                PIC XX VALUE X'7DFF'.
   648     05  WS-810831                PIC XX VALUE X'7A7F'.
   649     05  WS-830901                PIC XX VALUE X'7D81'.
   650
   651 01  FILE-ACCESS-IDS.
   652     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   653     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   654     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   655     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   656     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   657     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   658     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   659     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   660     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   661     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   662     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   663     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   664     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   665     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   666     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   667     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   668     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   669 01  DD-IU-SW                    PIC X   VALUE ' '.
   670     88  DD-IU-PRESENT                 VALUE 'Y'.
   671
   672 01  ACCESS-KEYS.
   673     12  ELMSTR-KEY.
   674         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   675         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   676     12  W-CLAIM-KEY.
   677         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   678         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   679
   680     12  ELCNTL-KEY.
   681         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   682         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   683         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   684         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   685
   686     12  ELCERT-KEY.
   687         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   688         16  CERT-CARRIER         PIC X       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  14
* EL050.cbl
   689         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   690         16  CERT-STATE           PIC XX      VALUE SPACES.
   691         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   692         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   693         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   694
   695     12  ELCERT2-KEY.
   696         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   697         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   698
   699     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   700
   701     12  ELCERT-SAVE.
   702         16  FILLER                      PIC XX    VALUE SPACES.
   703
   704         16  WCS-CONTROL-PRIMARY.
   705             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   706             20  WCS-CARRIER             PIC X     VALUE SPACE.
   707             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   708             20  WCS-STATE               PIC XX    VALUE SPACES.
   709             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   710             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   711             20  WCS-CERT-NO.
   712                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   713                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   714
   715         16  CS-CONTROL-BY-NAME.
   716             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   717             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   718             20  CS-INSURED-INITIALS.
   719                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   720                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   721
   722         16  CS-CONTROL-BY-SSN.
   723             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   724             20  CS-SOC-SEC-NO.
   725                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   726                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   727                 24  CS-SSN-LN3.
   728                     28 CS-INSURED-INITIALS-A2   PIC XX
   729                                     VALUE SPACES.
   730                     28 CS-PART-LAST-NAME-A2     PIC X
   731                                     VALUE SPACE.
   732
   733         16  CS-CONTROL-BY-CERT-NO.
   734             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   735             20  CS-CERT-NO-A4           PIC X(11)
   736                                     VALUE SPACES.
   737
   738         16  CS-CONTROL-BY-MEMB.
   739             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   740             20  CS-MEMBER-NO.
   741                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   742                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   743                 24  CS-MEMB-LN4.
   744                     28 CS-INSURED-INITIALS-A5   PIC XX
   745                                      VALUE SPACES.
   746                     28 CS-PART-LAST-NAME-A5     PIC XX
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  15
* EL050.cbl
   747                                      VALUE SPACES.
   748
   749         16  FILLER              PIC X(360) VALUE SPACES.
   750
   751     12  ERACCT-KEY.
   752         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   753         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   754         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   755         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   756         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   757         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   758
   759     12  ERCOMP-KEY.
   760         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   761         16  COMP-CARRIER         PIC X     VALUE SPACES.
   762         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   763         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   764         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   765         16  COMP-TYPE            PIC X     VALUE SPACES.
   766
   767     12  ERLOFC-KEY.
   768         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   769         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   770         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   771         16  LOFC-STATE           PIC XX    VALUE SPACES.
   772         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   773         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   774
   775     12  WS-ELCRTT-KEY.
   776         16  WS-ELCRTT-PRIMARY       PIC X(33).
   777         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   778
   779     12  ERBXRF-KEY.
   780         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   781         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   782         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   783         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   784
   785     12  ERAGTC-KEY.
   786         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   787         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   788         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   789         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   790         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   791         16  AGTC-TYPE            PIC X     VALUE SPACES.
   792
   793     12  ERPLAN-KEY.
   794         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   795         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   796         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   797         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   798         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   799         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   800         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   801         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   802
   803     12  ERFORM-KEY.
   804         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  16
* EL050.cbl
   805         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   806         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   807         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   808
   809     12  ERREIN-KEY.
   810         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   811         16  REIN-TYPE            PIC X     VALUE SPACES.
   812         16  REIN-TABLE-CO.
   813             20  REIN-CODE-1      PIC X     VALUE SPACE.
   814             20  REIN-CODE-2      PIC X     VALUE SPACE.
   815             20  REIN-CODE-3      PIC X     VALUE SPACE.
   816         16  FILLER               PIC X(3)  VALUE SPACES.
   817
   818     12  ERCTBL-KEY.
   819         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   820         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   821         16  CTBL-CNTRL-2.
   822             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   823             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   824
   825     12  ELCRTO-KEY.
   826         16  ELCRTO-COMPANY-CD       PIC X.
   827         16  ELCRTO-CARRIER          PIC X.
   828         16  ELCRTO-GROUPING         PIC X(6).
   829         16  ELCRTO-STATE            PIC XX.
   830         16  ELCRTO-ACCOUNT          PIC X(10).
   831         16  ELCRTO-CERT-EFF-DT      PIC XX.
   832         16  ELCRTO-CERT-NO.
   833             20  ELCRTO-CERT-PRIME   PIC X(10).
   834             20  ELCRTO-CERT-SFX     PIC X.
   835         16  ELCRTO-RECORD-TYPE      PIC X.
   836         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   837
   838
   839     12  WS-ACCESS.
   840         16  FILLER               PIC XX    VALUE SPACES.
   841         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   842
   843     12  WS-CARR-ACCESS.
   844         16  FILLER               PIC X(3)  VALUE SPACES.
   845         16  WS-CARR              PIC X     VALUE SPACE.
   846*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   847*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   848     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   849         88  WS-DMD-LF-RATING   VALUE 'Y'.
   850         88  WS-DMD-AH-RATING   VALUE 'Y'.
   851         88  WS-DMD-NO-RATING   VALUE 'N'.
   852
   853     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   854         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   855                                         'NJ' 'NL'
   856                                         'PJ' 'PL'
   857                                         'SJ' 'SL'.
   858     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   859         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   860                                         'NI' 'NJ' 'NL' 'NU'
   861                                         'PJ' 'PL' 'PI' 'PU'
   862                                         'SI' 'SJ' 'SL' 'SU'
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  17
* EL050.cbl
   863                                         'MX' 'MY' 'MZ'.
   864 01  ERPDEF-KEY-SAVE             PIC X(18).
   865 01  ERPDEF-KEY.
   866     12  ERPDEF-COMPANY-CD       PIC X.
   867     12  ERPDEF-STATE            PIC XX.
   868     12  ERPDEF-PROD-CD          PIC XXX.
   869     12  F                       PIC X(7).
   870     12  ERPDEF-BEN-TYPE         PIC X.
   871     12  ERPDEF-BEN-CODE         PIC XX.
   872     12  ERPDEF-EXP-DT           PIC XX.
   873
   874 01  ELSTAT-KEY-SAVE             PIC X(20).
   875 01  ELSTAT-KEY.
   876     12  ELSTAT-COMPANY-ID       PIC XXX.
   877     12  ELSTAT-CARRIER          PIC X.
   878     12  ELSTAT-GROUP            PIC X(6).
   879     12  ELSTAT-STATE            PIC XX.
   880     12  ELSTAT-EXP-DT           PIC 9(8).
   881 01  WS-ERROR-VALUES.
   882     12  ER-1570                     PIC S9(4)   VALUE +1570.
   883     12  ER-1571                     PIC S9(4)   VALUE +1571.
   884     12  er-1572                     pic s9(4)   value +1572.
   885     12  ER-1575                     PIC S9(4)   VALUE +1575.
   886     12  ER-1891                     PIC S9(4)   VALUE +1891.
   887     12  ER-1892                     PIC S9(4)   VALUE +1892.
   888     12  ER-1893                     PIC S9(4)   VALUE +1893.
   889     12  ER-1894                     PIC S9(4)   VALUE +1894.
   890     12  ER-1895                     PIC S9(4)   VALUE +1895.
   891     12  ER-1896                     PIC S9(4)   VALUE +1896.
   892     12  ER-1897                     PIC S9(4)   VALUE +1897.
   893     12  ER-1898                     PIC S9(4)   VALUE +1898.
   894     12  ER-1899                     PIC S9(4)   VALUE +1899.
   895     12  ER-1900                     PIC S9(4)   VALUE +1900.
   896     12  ER-1901                     PIC S9(4)   VALUE +1901.
   897     12  ER-1902                     PIC S9(4)   VALUE +1902.
   898     12  ER-1903                     PIC S9(4)   VALUE +1903.
   899     12  ER-1904                     PIC S9(4)   VALUE +1904.
   900     12  ER-1905                     PIC S9(4)   VALUE +1905.
   901     12  ER-1906                     PIC S9(4)   VALUE +1906.
   902     12  ER-1907                     PIC S9(4)   VALUE +1907.
   903     12  ER-1909                     PIC S9(4)   VALUE +1909.
   904     12  ER-1910                     PIC S9(4)   VALUE +1910.
   905     12  ER-1911                     PIC S9(4)   VALUE +1911.
   906     12  ER-1912                     PIC S9(4)   VALUE +1912.
   907     12  ER-1913                     PIC S9(4)   VALUE +1913.
   908     12  ER-1914                     PIC S9(4)   VALUE +1914.
   909     12  ER-1915                     PIC S9(4)   VALUE +1915.
   910     12  ER-1916                     PIC S9(4)   VALUE +1916.
   911     12  ER-1917                     PIC S9(4)   VALUE +1917.
   912     12  ER-1918                     PIC S9(4)   VALUE +1918.
   913     12  ER-1919                     PIC S9(4)   VALUE +1919.
   914     12  ER-1920                     PIC S9(4)   VALUE +1920.
   915     12  ER-1921                     PIC S9(4)   VALUE +1921.
   916     12  ER-1922                     PIC S9(4)   VALUE +1922.
   917     12  ER-1923                     PIC S9(4)   VALUE +1923.
   918     12  ER-1924                     PIC S9(4)   VALUE +1924.
   919     12  ER-1925                     PIC S9(4)   VALUE +1925.
   920     12  ER-1926                     PIC S9(4)   VALUE +1926.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  18
* EL050.cbl
   921     12  ER-1927                     PIC S9(4)   VALUE +1927.
   922     12  ER-2393                     PIC S9(4)   VALUE +2393.
   923     12  ER-2600                     PIC S9(4)   VALUE +2600.
   924     12  ER-2601                     PIC S9(4)   VALUE +2601.
   925     12  ER-2602                     PIC S9(4)   VALUE +2602.
   926     12  ER-2603                     PIC S9(4)   VALUE +2603.
   927     12  ER-2604                     PIC S9(4)   VALUE +2604.
   928     12  ER-2605                     PIC S9(4)   VALUE +2605.
   929     12  ER-2606                     PIC S9(4)   VALUE +2606.
   930     12  ER-2607                     PIC S9(4)   VALUE +2607.
   931     12  ER-2608                     PIC S9(4)   VALUE +2608.
   932     12  ER-2609                     PIC S9(4)   VALUE +2609.
   933     12  ER-2610                     PIC S9(4)   VALUE +2610.
   934     12  ER-2611                     PIC S9(4)   VALUE +2611.
   935     12  ER-2612                     PIC S9(4)   VALUE +2612.
   936     12  ER-2613                     PIC S9(4)   VALUE +2613.
   937     12  ER-2614                     PIC S9(4)   VALUE +2614.
   938     12  ER-2615                     PIC S9(4)   VALUE +2615.
   939     12  ER-2616                     PIC S9(4)   VALUE +2616.
   940     12  ER-2617                     PIC S9(4)   VALUE +2617.
   941     12  ER-2618                     PIC S9(4)   VALUE +2618.
   942     12  ER-2619                     PIC S9(4)   VALUE +2619.
   943     12  ER-2620                     PIC S9(4)   VALUE +2620.
   944     12  ER-2621                     PIC S9(4)   VALUE +2621.
   945     12  ER-2622                     PIC S9(4)   VALUE +2622.
   946     12  ER-2623                     PIC S9(4)   VALUE +2623.
   947     12  ER-2624                     PIC S9(4)   VALUE +2624.
   948     12  ER-2625                     PIC S9(4)   VALUE +2625.
   949     12  ER-2626                     PIC S9(4)   VALUE +2626.
   950     12  ER-2627                     PIC S9(4)   VALUE +2627.
   951     12  ER-2628                     PIC S9(4)   VALUE +2628.
   952     12  ER-2629                     PIC S9(4)   VALUE +2629.
   953     12  ER-2630                     PIC S9(4)   VALUE +2630.
   954     12  ER-2631                     PIC S9(4)   VALUE +2631.
   955     12  ER-2632                     PIC S9(4)   VALUE +2632.
   956     12  ER-2633                     PIC S9(4)   VALUE +2633.
   957     12  ER-2634                     PIC S9(4)   VALUE +2634.
   958     12  ER-2635                     PIC S9(4)   VALUE +2635.
   959     12  ER-2636                     PIC S9(4)   VALUE +2636.
   960     12  ER-2637                     PIC S9(4)   VALUE +2637.
   961     12  ER-2638                     PIC S9(4)   VALUE +2638.
   962     12  ER-2639                     PIC S9(4)   VALUE +2639.
   963     12  ER-2640                     PIC S9(4)   VALUE +2640.
   964     12  ER-2641                     PIC S9(4)   VALUE +2641.
   965     12  ER-2642                     PIC S9(4)   VALUE +2642.
   966     12  ER-2643                     PIC S9(4)   VALUE +2643.
   967     12  ER-2644                     PIC S9(4)   VALUE +2644.
   968     12  ER-2645                     PIC S9(4)   VALUE +2645.
   969     12  ER-2646                     PIC S9(4)   VALUE +2646.
   970     12  ER-2647                     PIC S9(4)   VALUE +2647.
   971     12  ER-2648                     PIC S9(4)   VALUE +2648.
   972     12  ER-2649                     PIC S9(4)   VALUE +2649.
   973     12  ER-2650                     PIC S9(4)   VALUE +2650.
   974     12  ER-2651                     PIC S9(4)   VALUE +2651.
   975     12  ER-2652                     PIC S9(4)   VALUE +2652.
   976     12  ER-2653                     PIC S9(4)   VALUE +2653.
   977     12  ER-2654                     PIC S9(4)   VALUE +2654.
   978     12  ER-2655                     PIC S9(4)   VALUE +2655.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  19
* EL050.cbl
   979     12  ER-2656                     PIC S9(4)   VALUE +2656.
   980     12  ER-2657                     PIC S9(4)   VALUE +2657.
   981     12  ER-2658                     PIC S9(4)   VALUE +2658.
   982     12  ER-2659                     PIC S9(4)   VALUE +2659.
   983     12  ER-2660                     PIC S9(4)   VALUE +2660.
   984     12  ER-2661                     PIC S9(4)   VALUE +2661.
   985     12  ER-2662                     PIC S9(4)   VALUE +2662.
   986     12  ER-2663                     PIC S9(4)   VALUE +2663.
   987     12  ER-2664                     PIC S9(4)   VALUE +2664.
   988     12  ER-2665                     PIC S9(4)   VALUE +2665.
   989     12  ER-2666                     PIC S9(4)   VALUE +2666.
   990     12  ER-2667                     PIC S9(4)   VALUE +2667.
   991     12  ER-2668                     PIC S9(4)   VALUE +2668.
   992     12  ER-2669                     PIC S9(4)   VALUE +2669.
   993     12  ER-2670                     PIC S9(4)   VALUE +2670.
   994     12  ER-2671                     PIC S9(4)   VALUE +2671.
   995     12  ER-2672                     PIC S9(4)   VALUE +2672.
   996     12  ER-2673                     PIC S9(4)   VALUE +2673.
   997     12  ER-2674                     PIC S9(4)   VALUE +2674.
   998     12  ER-2675                     PIC S9(4)   VALUE +2675.
   999     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1000     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1001     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1002     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1003     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1004     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1005     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1006     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1007     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1008     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1009     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1010     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1011     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1012     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1013     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1014     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1015     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1016     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1017     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1018     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1019     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1020     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1021     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1022     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1023     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1024     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1025     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1026     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1027     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1028     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1029     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1030     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1031     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1032     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1033     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1034     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1035     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1036     12  ER-2723                     PIC S9(4)   VALUE +2723.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  20
* EL050.cbl
  1037     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1038     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1039     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1040     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1041     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1042     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1043     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1044     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1045     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1046     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1047     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1048     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1049     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1050     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1051     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1052     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1053     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1054     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1055     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1056     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1057     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1058     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1059     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1060     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1061     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1062     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1063     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1064     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1065     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1066     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1067     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1068     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1069     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1070     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1071     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1072     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1073     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1074     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1075     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1076     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1077     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1078     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1079     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1080     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1081     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1082     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1083     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1084     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1085     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1086     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1087     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1088     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1089     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1090     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1091     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1092     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1093     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1094     12  ER-2781                     PIC S9(4)   VALUE +2781.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  21
* EL050.cbl
  1095     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1096     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1097     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1098     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1099     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1100     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1101     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1102     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1103     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1104     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1105     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1106     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1107     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1108     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1109     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1110     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1111     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1112     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1113     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1114     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1115     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1116     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1117     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1118     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1119     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1120     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1121     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1122     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1123     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1124     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1125     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1126     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1127     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1128     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1129     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1130     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1131     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1132     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1133     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1134     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1135     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1136     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1137     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1138     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1139     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1140     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1141     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1142     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1143     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1144     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1145     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1146     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1147     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1148     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1149     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1150     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1151     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1152     12  ER-8002                     PIC S9(4)   VALUE +8002.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  22
* EL050.cbl
  1153     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1154     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1155     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1156     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1157     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1158     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1159     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1160     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1161     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1162     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1163     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1164     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1165     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1166     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1167     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1168     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1169     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1170     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1171     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1172     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1173     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1174     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1175     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1176     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1177     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1178     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1179     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1180     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1181     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1182     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1183     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1184     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1185     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1186     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1187     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1188     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1189     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1190     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1191     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1192     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1193     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1194     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1195     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1196     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1197     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1198     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1199     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1200     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1201     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1202     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1203     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1204     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1205     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1206     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1207     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1208     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1209     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1210     12  ER-8303                     PIC S9(4)   VALUE +8303.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  23
* EL050.cbl
  1211     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1212     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1213     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1214     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1215     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1216     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1217     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1218     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1219     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1220     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1221     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1222     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1223     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1224     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1225******************************************************************
  1226***************   END OF ELC50WS     ****************************
  1227******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  24
* EL050.cbl
  1230 01  WORKING-STORAGE-WORK-AREAS.
  1231     12  WS-RESPONSE             PIC S9(8)  COMP.
  1232         88  WS-RESP-NORMAL           VALUE +00.
  1233         88  WS-RESP-ERROR            VALUE +01.
  1234         88  WS-RESP-NOTFND           VALUE +13.
  1235         88  WS-RESP-DUPREC           VALUE +14.
  1236         88  WS-RESP-ENDFILE          VALUE +20.
  1237     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1238     12  WORK-AREAS.
  1239         16  WK-CONV-GREG.
  1240             24  WCG-CENT             PIC XX.
  1241             24  WCG-REST             PIC X(4).
  1242         16  WORK-GREGORIAN-DATE.
  1243             24  WK-GREG-CENT         PIC XX.
  1244             24  WK-GREG-DATE-YYMMDD.
  1245                 28  WK-GREG-YYMM     PIC X(4).
  1246                 28  WK-GREG-DD       PIC XX.
  1247
  1248         16  WORK-SELECT-DATE.
  1249             24  WK-SELECT-CENT            PIC XX.
  1250             24  WK-SELECT-DATE-YYMMDD.
  1251                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1252                 28  FILLER                PIC XX.
  1253
  1254         16  WK-FORM-NO.
  1255             24  WK-FORM-BANK-ID       PIC X(5).
  1256             24  WK-FORM-UNDRWRTR      PIC X(1).
  1257             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1258
  1259         16  WK-MEMBER-NO.
  1260             24  WK-MEMBER-1-6        PIC X(6).
  1261             24  WK-MEMBER-7-12       PIC X(6).
  1262
  1263         16  WK-FULL-CERT-NO.
  1264             24  WK-CERT-POS-1-2      PIC X(2).
  1265             24  WK-CERT-POS-3        PIC X(1).
  1266             24  WK-CERT-POS-4        PIC X(1).
  1267             24  WK-CERT-POS-5-6      PIC X(2).
  1268             24  WK-CERT-POS-7        PIC X(1).
  1269             24  WK-CERT-POS-8-11     PIC X(4).
  1270
  1271         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1272             88  VALID-RATE-CODE        VALUE 'Y'.
  1273             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1274
  1275         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1276         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1277         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1278         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1279         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1280         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1281         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1282         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1283         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1284         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1285
  1286* DLO001
  1287 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  25
* EL050.cbl
  1288     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1289     12  DMPF-RETURN-CODE          PIC XX.
  1290         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1291         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1292         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1293         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1294         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1295         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1296
  1297* DLO002
  1298 01  WS-DLO-INTERNAL-POLICY-FORM.
  1299     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1300     12  DIPF-RETURN-CODE          PIC XX.
  1301         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1302         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1303         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1304         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1305         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1306         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1307
  1308* DLO003
  1309 01  WS-DLO-VALID-BANK-ID.
  1310     12  DVBI-BANK-ID              PIC X(5).
  1311     12  DVBI-BANK-ID-TYPE         PIC X.
  1312         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1313         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1314         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1315         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1316         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1317     12  DVBI-RETURN-CODE          PIC XX.
  1318         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1319         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1320         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1321         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1322         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1323         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1324         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1325         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1326         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1327
  1328* DLO007
  1329 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1330     12  DCUA-RES-STATE            PIC XX.
  1331     12  DCUA-BEN-TYPE             PIC XX.
  1332     12  DCUA-SYS-IDENT            PIC X.
  1333         88  DCUA-CLAIM                        VALUE 'C'.
  1334         88  DCUA-PREMIUM                      VALUE 'P'.
  1335     12  DCUA-COVERAGE-RULE        PIC X.
  1336     12  DCUA-CLIENT-ID            PIC X(10).
  1337     12  DCUA-EFF-DATE             PIC X(8).
  1338     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1339     12  DCUA-RETURN-CODE          PIC XX.
  1340         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1341     12  DCUA-CERT-NUMBER          PIC X(11).
  1342     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1343     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1344
  1345* DLO011
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  26
* EL050.cbl
  1346 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1347     12  DPRB-RATE-CODE            PIC X(4).
  1348     12  DPRB-COVERAGE-CATEG       PIC X.
  1349     12  DPRB-RETURN-CODE          PIC XX.
  1350         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1351         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1352         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1353         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1354         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1355         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1356         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1357         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1358         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1359     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1360     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1361     12  DPRB-BEN-TYPE             PIC XX.
  1362
  1363* DLO017
  1364 01  WS-DLO-VALID-RATE-CODE.
  1365     12  DVRC-RATE-CODE            PIC X(4).
  1366     12  DVRC-RETURN-CODE          PIC XX.
  1367         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1368         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1369         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1370         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1371         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1372         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1373
  1374* DLO019
  1375 01  WS-DLO-ORIG-COV-CAT.
  1376     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1377     12  DOCC-RETURN-CODE          PIC XX.
  1378     12  DOCC-ORIG-COV-CAT         PIC X.
  1379     12  DOCC-UNDERWITER           PIC XX.
  1380     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1381     12  DOCC-FILLER               PIC X(6).
  1382
  1383* DLO021
  1384 01  WS-DLO-VALID-LOAN-OFFICER.
  1385     12  DVLO-LOAN-OFFICER.
  1386         16  DVLO-BILL-TYPE        PIC X.
  1387         16  DVLO-BILL-SOURCE      PIC X.
  1388         16  DVLO-BATCH-TYPE       PIC X.
  1389     12  DVLO-RETURN-CODE          PIC XX.
  1390         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1391         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1392         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1393         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1394         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1395         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1396
  1397* DLO022
  1398 01  WS-DLO-VALID-STATE-CODE.
  1399     12  DVSC-STATE-CODE           PIC XX.
  1400     12  DVSC-RETURN-CODE          PIC XX.
  1401         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1402
  1403* DLO023
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  27
* EL050.cbl
  1404 01  WS-DLO-VALID-CODE-VALUES.
  1405     12  DVCV-SYSTEM-ID            PIC XX.
  1406         88  DVCV-CLAIMS                       VALUE 'CL'.
  1407         88  DVCV-CREDIT                       VALUE 'CR'.
  1408     12  DVCV-RECORD-TYPE          PIC XX.
  1409         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1410         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1411         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1412         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1413         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1414         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1415         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1416         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1417     12  DVCV-RECORD-KEY           PIC X(6).
  1418     12  DVCV-RETURN-CODE          PIC XX.
  1419         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1420         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1421         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1422         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1423         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1424         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1425         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1426     12  DVCV-CODE-DESC            PIC X(60).
  1427     12  DVCV-GEN-DESC-1           PIC X(20).
  1428     12  DVCV-GEN-DESC-2           PIC X(20).
  1429     12  DVCV-GEN-DESC-3           PIC X(20).
  1430
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  28
* EL050.cbl
  1432*    COPY ERCBXRF.
  1433******************************************************************
  1434*                                                                *
  1435*                                                                *
  1436*                            ERCBXRF                             *
  1437*                                                                *
  1438*   ONLINE CREDIT SYSTEM                                         *
  1439*                                                                *
  1440*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1441*                                                                *
  1442*   FILE TYPE = VSAM,KSDS                                        *
  1443*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1444*                                                                *
  1445*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1446*       ALTERNATE PATH = NONE                                    *
  1447*                                                                *
  1448*   LOG = NO                                                     *
  1449*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1450*                                                                *
  1451******************************************************************
  1452
  1453 01  BANK-CROSS-REFERENCE.
  1454     12  BK-RECORD-ID                PIC XX.
  1455         88  VALID-BK-ID             VALUE 'BK'.
  1456
  1457     12  BK-CONTROL-PRIMARY.
  1458         16  BK-COMPANY-CD           PIC X.
  1459         16  BK-CARRIER              PIC X.
  1460         16  BK-GROUPING             PIC X(6).
  1461         16  BK-BANK-NO              PIC X(10).
  1462
  1463     12  BK-MAINT-INFORMATION.
  1464         16  BK-LAST-MAINT-DT        PIC XX.
  1465         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1466         16  BK-LAST-MAINT-USER      PIC X(4).
  1467         16  FILLER                  PIC X(9).
  1468
  1469     12  FILLER                      PIC X(37).
  1470
  1471     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1472
  1473     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1474                            DEPENDING ON BK-BANK-POINTER-CNT.
  1475         16  BK-AM-ACCOUNT           PIC X(10).
  1476         16  BK-AM-EXP-DT            PIC XX.
  1477         16  BK-AM-EFF-DT            PIC XX.
  1478         16  BK-AM-STATE             PIC XX.
  1479         16  FILLER                  PIC X(20).
  1480
  1481******************************************************************
  1482
  1483*    COPY ERCCOMP.
  1484******************************************************************
  1485*                                                                *
  1486*                                                                *
  1487*                            ERCCOMP                             *
  1488*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1489*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  29
* EL050.cbl
  1490*                                                                *
  1491*   ONLINE CREDIT SYSTEM                                         *
  1492*                                                                *
  1493*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1494*                                                                *
  1495*   FILE TYPE = VSAM,KSDS                                        *
  1496*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1497*                                                                *
  1498*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1499*       ALTERNATE PATH = NONE                                    *
  1500*                                                                *
  1501*   LOG = NO                                                     *
  1502*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1503*                                                                *
  1504******************************************************************
  1505*                   C H A N G E   L O G
  1506*
  1507* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1508*-----------------------------------------------------------------
  1509*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1510* EFFECTIVE    NUMBER
  1511*-----------------------------------------------------------------
  1512* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1513* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1514* 092205    2005050300006  PEMA  ADD LEASE FEE
  1515* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1516* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1517* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1518* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1519* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1520* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1521******************************************************************
  1522
  1523 01  COMPENSATION-MASTER.
  1524     12  CO-RECORD-ID                          PIC XX.
  1525         88  VALID-CO-ID                          VALUE 'CO'.
  1526
  1527     12  CO-CONTROL-PRIMARY.
  1528         16  CO-COMPANY-CD                     PIC X.
  1529         16  CO-CONTROL.
  1530             20  CO-CTL-1.
  1531                 24  CO-CARR-GROUP.
  1532                     28  CO-CARRIER            PIC X.
  1533                     28  CO-GROUPING.
  1534                         32  CO-GROUP-PREFIX   PIC XXX.
  1535                         32  CO-GROUP-PRIME    PIC XXX.
  1536                 24  CO-RESP-NO.
  1537                     28  CO-RESP-PREFIX        PIC X(4).
  1538                     28  CO-RESP-PRIME         PIC X(6).
  1539             20  CO-CTL-2.
  1540                 24  CO-ACCOUNT.
  1541                     28  CO-ACCT-PREFIX        PIC X(4).
  1542                     28  CO-ACCT-PRIME         PIC X(6).
  1543         16  CO-TYPE                           PIC X.
  1544             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1545             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1546             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1547
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  30
* EL050.cbl
  1548     12  CO-MAINT-INFORMATION.
  1549         16  CO-LAST-MAINT-DT                  PIC XX.
  1550         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1551         16  CO-LAST-MAINT-USER                PIC X(4).
  1552     12  FILLER                                PIC XX.
  1553     12  CO-STMT-TYPE                          PIC XXX.
  1554     12  CO-COMP-TYPE                          PIC X.
  1555         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1556     12  CO-STMT-OWNER                         PIC X(4).
  1557     12  CO-BALANCE-CONTROL                    PIC X.
  1558         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1559         88  CO-NO-BALANCE                        VALUE 'N'.
  1560
  1561     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1562         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1563         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1564         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1565
  1566     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1567         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1568         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1569
  1570     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1571     12  CO-GA-DIRECT-DEP                      PIC X.
  1572     12  CO-FUTURE-SPACE                       PIC X.
  1573         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1574
  1575     12  CO-ACCT-NAME                          PIC X(30).
  1576     12  CO-MAIL-NAME                          PIC X(30).
  1577     12  CO-ADDR-1                             PIC X(30).
  1578     12  CO-ADDR-2                             PIC X(30).
  1579     12  CO-ADDR-3.
  1580         16  CO-ADDR-CITY                      PIC X(27).
  1581         16  CO-ADDR-STATE                     PIC XX.
  1582     12  CO-CSO-1099                           PIC X.
  1583     12  CO-ZIP.
  1584         16  CO-ZIP-PRIME.
  1585             20  CO-ZIP-PRI-1ST                PIC X.
  1586                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1587             20  FILLER                        PIC X(4).
  1588         16  CO-ZIP-PLUS4                      PIC X(4).
  1589     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1590         16  CO-CAN-POSTAL-1                   PIC XXX.
  1591         16  CO-CAN-POSTAL-2                   PIC XXX.
  1592         16  FILLER                            PIC XXX.
  1593     12  CO-SOC-SEC                            PIC X(13).
  1594     12  CO-TELEPHONE.
  1595         16  CO-AREA-CODE                      PIC XXX.
  1596         16  CO-PREFIX                         PIC XXX.
  1597         16  CO-PHONE                          PIC X(4).
  1598
  1599     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1600
  1601     12  CO-AR-BAL-LEVEL                       PIC X.
  1602         88  CO-AR-REF-LVL                        VALUE '1'.
  1603         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1604         88  CO-AR-BILL-LVL                       VALUE '2'.
  1605         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  31
* EL050.cbl
  1606         88  CO-AR-FR-LVL                         VALUE '4'.
  1607
  1608     12  CO-AR-NORMAL-PRINT                    PIC X.
  1609         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1610         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1611
  1612     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1613
  1614     12  CO-AR-REPORTING                       PIC X.
  1615         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1616         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1617
  1618     12  CO-AR-PULL-CHECK                      PIC X.
  1619         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1620         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1621
  1622     12  CO-AR-BALANCE-PRINT                   PIC X.
  1623         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1624
  1625     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1626         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1627         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1628         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1629
  1630     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1631
  1632     12  CO-USER-CODE                          PIC X.
  1633     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1634
  1635******************************************************************
  1636*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1637*    THE LAST MONTH END RUN.
  1638******************************************************************
  1639
  1640     12  CO-LAST-ACTIVITY-DATE.
  1641         16  CO-ACT-YEAR                       PIC 99.
  1642         16  CO-ACT-MONTH                      PIC 99.
  1643         16  CO-ACT-DAY                        PIC 99.
  1644
  1645     12  CO-LAST-STMT-DT.
  1646         16  CO-LAST-STMT-YEAR                 PIC 99.
  1647         16  CO-LAST-STMT-MONTH                PIC 99.
  1648         16  CO-LAST-STMT-DAY                  PIC 99.
  1649
  1650     12  CO-MO-END-TOTALS.
  1651         16  CO-MONTHLY-TOTALS.
  1652             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1653             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1654             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1655             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1656             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1657
  1658         16  CO-AGING-TOTALS.
  1659             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1660             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1661             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1662             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1663
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  32
* EL050.cbl
  1664         16  CO-YTD-TOTALS.
  1665             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1666             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1667
  1668         16  CO-OVER-UNDER-TOTALS.
  1669             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1670             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1671
  1672     12  CO-MISCELLANEOUS-TOTALS.
  1673         16  CO-FICA-TOTALS.
  1674             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1675             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1676
  1677         16  CO-CLAIM-TOTALS.
  1678             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1679             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1680
  1681******************************************************************
  1682*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1683*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1684******************************************************************
  1685
  1686     12  CO-CURRENT-TOTALS.
  1687         16  CO-CURRENT-LAST-STMT-DT.
  1688             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1689             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1690             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1691
  1692         16  CO-CURRENT-MONTHLY-TOTALS.
  1693             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1694             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1695             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1696             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1697             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1698
  1699         16  CO-CURRENT-AGING-TOTALS.
  1700             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1701             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1702             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1703             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1704
  1705         16  CO-CURRENT-YTD-TOTALS.
  1706             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1707             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1708
  1709     12  CO-PAID-COMM-TOTALS.
  1710         16  CO-YTD-PAID-COMMS.
  1711             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1712             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1713
  1714     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1715         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1716         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1717
  1718     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1719         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1720         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1721         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  33
* EL050.cbl
  1722         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1723         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1724         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1725         88  CO-FINAL-LETTER                  VALUE 'F'.
  1726         88  CO-RECONCILING                   VALUE 'R'.
  1727         88  CO-PHONE-CALL                    VALUE 'P'.
  1728         88  CO-LEGAL                         VALUE 'L'.
  1729         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1730         88  CO-WRITE-OFF                     VALUE 'W'.
  1731         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1732
  1733     12  CO-CSR-CODE                       PIC X(4).
  1734
  1735     12  CO-GA-STATUS-INFO.
  1736         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1737         16  CO-GA-TERMINATION-DT          PIC XX.
  1738         16  CO-GA-STATUS-CODE             PIC X.
  1739             88  CO-GA-ACTIVE                 VALUE 'A'.
  1740             88  CO-GA-INACTIVE               VALUE 'I'.
  1741             88  CO-GA-PENDING                VALUE 'P'.
  1742         16  CO-GA-COMMENTS.
  1743             20  CO-GA-COMMENT-1           PIC X(40).
  1744             20  CO-GA-COMMENT-2           PIC X(40).
  1745             20  CO-GA-COMMENT-3           PIC X(40).
  1746             20  CO-GA-COMMENT-4           PIC X(40).
  1747
  1748     12  CO-RPTCD2                         PIC X(10).
  1749     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1750         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1751         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1752
  1753     12  CO-TYPE-AGENT                     PIC X(01).
  1754         88  CO-CORPORATION                   VALUE 'C'.
  1755         88  CO-PARTNERSHIP                   VALUE 'P'.
  1756         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1757         88  CO-TRUST                         VALUE 'T'.
  1758         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1759
  1760     12  CO-FAXNO.
  1761         16  CO-FAX-AREA-CODE                  PIC XXX.
  1762         16  CO-FAX-PREFIX                     PIC XXX.
  1763         16  CO-FAX-PHONE                      PIC X(4).
  1764
  1765     12  CO-BANK-INFORMATION.
  1766         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1767         16  CO-BANK-TRANSIT-NON REDEFINES
  1768             CO-BANK-TRANSIT-NO                PIC 9(8).
  1769
  1770         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1771     12  CO-MISC-DEDUCT-INFO REDEFINES
  1772                  CO-BANK-INFORMATION.
  1773         16  CO-MD-GL-ACCT                     PIC X(10).
  1774         16  CO-MD-DIV                         PIC XX.
  1775         16  CO-MD-CENTER                      PIC X(4).
  1776         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1777         16  CO-CREATE-AP-CHECK                PIC X.
  1778         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1779         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  34
* EL050.cbl
  1780     12  CO-ACH-STATUS                         PIC X.
  1781         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1782         88  CO-ACH-PENDING                        VALUE 'P'.
  1783
  1784     12  CO-BILL-SW                            PIC X.
  1785     12  CO-CONTROL-NAME                       PIC X(30).
  1786     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1787     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1788     12  CO-CLP-STATE                          PIC XX.
  1789     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1790     12  CO-SPP-REFUND-EDIT                    PIC X.
  1791
  1792******************************************************************
  1793
  1794*    COPY ERCAGTC.
  1795******************************************************************
  1796*                                                                *
  1797*                                                                *
  1798*                            ERCAGTC                             *
  1799*                            VMOD=2.001                          *
  1800*                                                                *
  1801*   ONLINE CREDIT SYSTEM                                         *
  1802*                                                                *
  1803*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1804*                                                                *
  1805*   FILE TYPE = VSAM,KSDS                                        *
  1806*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1807*                                                                *
  1808*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1809*       ALTERNATE PATH = NONE                                    *
  1810*                                                                *
  1811*   LOG = NO                                                     *
  1812*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1813*                                                                *
  1814******************************************************************
  1815*                   C H A N G E   L O G
  1816*
  1817* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1818*-----------------------------------------------------------------
  1819*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1820* EFFECTIVE    NUMBER
  1821*-----------------------------------------------------------------
  1822* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1823* 111004                         NEW FILE AND COPYBOOK
  1824* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1825******************************************************************
  1826 01  AGENT-COMMISSIONS.
  1827     12  AG-RECORD-ID                          PIC XX.
  1828         88  VALID-CO-ID                          VALUE 'AG'.
  1829     12  AG-CONTROL-PRIMARY.
  1830         16  AG-COMPANY-CD                     PIC X.
  1831         16  AG-CONTROL.
  1832             20  AG-CTL-1.
  1833                 24  AG-CARR-GROUP.
  1834                     28  AG-CARRIER            PIC X.
  1835                     28  AG-GROUPING           PIC X(6).
  1836                 24  AG-BANK                   PIC X(10).
  1837             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  35
* EL050.cbl
  1838                 24  AG-EXP-DT                 PIC XX.
  1839         16  AG-TYPE                           PIC X.
  1840             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1841             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1842     12  AG-MAINT-INFORMATION.
  1843         16  AG-LAST-MAINT-DT                  PIC XX.
  1844         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1845         16  AG-LAST-MAINT-USER                PIC X(4).
  1846         16  FILLER                            PIC X(10).
  1847     12  AG-EFF-DT                             PIC XX.
  1848     12  AG-COMM-STRUCTURE.
  1849         16  AG-AGT-COMMS OCCURS 10.
  1850             20  AG-AGT                PIC X(10).
  1851             20  AG-COM-TYP            PIC X.
  1852             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1853             20  AG-RECALC-LV-INDIC    PIC X.
  1854             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1855             20  AG-LRCALC-LV-INDIC    PIC X.
  1856             20  FILLER                PIC X(05).
  1857     12  FILLER                  PIC X(145).
  1858******************************************************************
  1859*    COPY ERCRESS.
  1860******************************************************************
  1861*                                                                *
  1862*                            ERCRESS                             *
  1863*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1864*                            VMOD=2.002                          *
  1865*                                                                *
  1866*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1867*                                                                *
  1868*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1869*   VSAM RESIDENT STATE TAX MASTER                              *
  1870*                                                                *
  1871*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1872*                                                                *
  1873*   FILE TYPE = VSAM,KSDS                                        *
  1874*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1875*                                                                *
  1876*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1877*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1878*                                                                *
  1879*   LOG = NO                                                     *
  1880*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1881*                                                                *
  1882*                                                                *
  1883******************************************************************
  1884
  1885 01  RESIDENT-STATE-TAX-MASTER.
  1886
  1887     10  ERRESS-PRIMARY-KEY.
  1888         15  RES-COMPANY-CD        PIC X.
  1889         15  RES-RESIDENT-STATE    PIC XX.
  1890         15  RES-COVERAGE-CATEGORY PIC X.
  1891         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1892*                                      YYYYMMDD
  1893*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1894
  1895     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  36
* EL050.cbl
  1896
  1897         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1898         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1899         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  1900         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1901
  1902     10 RES-RECALC-SW              PIC   X.
  1903         88 RECALC                VALUE 'Y'.
  1904         88 NO-RECALC             VALUE 'N'.
  1905     10  RES-MAINT-BY              PIC X(4).
  1906     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1907     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1908*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  37
* EL050.cbl
  1910*    COPY ERCRESC.
  1911******************************************************************
  1912*                                                                *
  1913*                            ERCRESC                             *
  1914*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1915*                            VMOD=2.003                          *
  1916*                                                                *
  1917*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1918*                                                                *
  1919*   FILE TYPE = VSAM,KSDS                                        *
  1920*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1921*                                                                *
  1922*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1923*       ALTERNATE PATH1 = NONE                                   *
  1924*                                                                *
  1925*   LOG = NO                                                     *
  1926*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1927*                                                                *
  1928******************************************************************
  1929
  1930 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1931
  1932     10  ERRESC-RECORD-KEY.
  1933         15  RESC-COMPANY-CD           PIC   X.
  1934         15  RESC-CARRIER              PIC   X.
  1935         15  RESC-GROUP                PIC   X(6).
  1936         15  RESC-STATE                PIC   XX.
  1937         15  RESC-ACCOUNT              PIC   X(10).
  1938         15  RESC-AGENT                PIC   X(10).
  1939         15  RESC-RESIDENT-STATE       PIC   XX.
  1940         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1941*                                           YYYYMMDD
  1942     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1943
  1944     10  RESC-COMM-RECORD-DATA.
  1945         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1946             20 RESC-COVERAGE-CAT      PIC    X.
  1947             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1948             20 RESC-COMMISSION-TAB REDEFINES
  1949                RESC-COMMISSION-PER    PIC  XXX.
  1950
  1951     10  RESC-MAINT-BY                 PIC X(4).
  1952     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  1953     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  1954*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  38
* EL050.cbl
  1956*    COPY ERCPLAN.
  1957******************************************************************
  1958*                                                                *
  1959*                                                                *
  1960*                            ERCPLAN                             *
  1961*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1962*                            VMOD=2.003                          *
  1963*                                                                *
  1964*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  1965*                                                                *
  1966*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  1967*   PLAN MASTER                                                  *
  1968*                                                                *
  1969*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  1970*                                                                *
  1971*   FILE TYPE = VSAM,KSDS                                        *
  1972*   RECORD SIZE = 420   RECFORM = FIX                            *
  1973*                                                                *
  1974*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  1975*       ALTERNATE PATH1 = N/A                                    *
  1976*                                                                *
  1977*   LOG = NO                                                     *
  1978*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1979*                                                                *
  1980*                                                                *
  1981******************************************************************
  1982
  1983 01  PLAN-MASTER.
  1984     12  PL-RECORD-ID                      PIC XX.
  1985         88  VALID-PL-ID                      VALUE 'PL'.
  1986
  1987     12  PL-CONTROL-PRIMARY.
  1988         16  PL-COMPANY-CD                 PIC X.
  1989         16  PL-MSTR-CNTRL.
  1990             20  PL-CONTROL-A.
  1991                 24  PL-CARRIER            PIC X.
  1992                 24  PL-GROUPING           PIC X(6).
  1993                 24  PL-STATE              PIC XX.
  1994                 24  PL-ACCOUNT            PIC X(10).
  1995             20  PL-BENEFIT-TYPE           PIC X.
  1996             20  PL-BENEFIT-CODE           PIC XX.
  1997             20  PL-REVISION-NO            PIC X(3).
  1998
  1999     12  PL-CONTROL-BY-VAR-GRP.
  2000         16  PL-COMPANY-CD-A1              PIC X.
  2001         16  PL-VG-CARRIER                 PIC X.
  2002         16  PL-VG-GROUPING                PIC X(6).
  2003         16  PL-VG-STATE                   PIC XX.
  2004         16  PL-VG-ACCOUNT                 PIC X(10).
  2005         16  PL-BENEFIT-TYPE-A1            PIC X.
  2006         16  PL-BENEFIT-CODE-A1            PIC XX.
  2007         16  PL-REVISION-NO-A1             PIC 999.
  2008
  2009     12  PL-MAINT-INFORMATION.
  2010         16  PL-LAST-MAINT-DT              PIC XX.
  2011         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2012         16  PL-LAST-MAINT-USER            PIC X(4).
  2013         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  39
* EL050.cbl
  2014
  2015     12  PL-LIABILITY-LIMITS.
  2016         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2017         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2018             20  PL-LM-AGE                 PIC S99        COMP-3.
  2019             20  PL-LM-DUR                 PIC S999       COMP-3.
  2020             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2021             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2022
  2023     12  FILLER                            PIC X(30).
  2024
  2025     12  PL-GL-ACCOUNT-NOS.
  2026         16  PL-PREMIUM-GL                 PIC X(8).
  2027         16  PL-COMM-GL                    PIC X(8).
  2028         16  PL-CLAIM-GL                   PIC X(8).
  2029     12  FILLER                            PIC X(24).
  2030     12  PL-TOLERANCES.
  2031         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2032         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2033         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2034         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2035         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2036         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2037     12  PL-OVER-SHORT.
  2038         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2039         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2040     12  FILLER                            PIC X(24).
  2041     12  PLAN-MISC.
  2042         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2043         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2044         16  PL-IG                         PIC X.
  2045         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2046         16  PL-POLICY-FORM                PIC X(12).
  2047         16  PL-EDIT-FOR-FORM              PIC X(01).
  2048         16  PL-DEV-CODE                   PIC XXX.
  2049         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2050         16  PL-CALC-METHOD                PIC X.
  2051         16  PL-BENEFIT-GROUP              PIC X(05).
  2052         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2053
  2054         16  FILLER                        PIC X(99).
  2055******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  40
* EL050.cbl
  2057*    COPY ELCCERT.
  2058******************************************************************
  2059*                                                                *
  2060*                            ELCCERT.                            *
  2061*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2062*                            VMOD=2.013                          *
  2063*                                                                *
  2064*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2065*                                                                *
  2066*   FILE TYPE = VSAM,KSDS                                        *
  2067*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2068*                                                                *
  2069*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2070*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2071*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2072*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2073*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2074*                                                                *
  2075*   LOG = YES                                                    *
  2076*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2077******************************************************************
  2078*                   C H A N G E   L O G
  2079*
  2080* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2081*-----------------------------------------------------------------
  2082*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2083* EFFECTIVE    NUMBER
  2084*-----------------------------------------------------------------
  2085* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2086* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2087* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2088* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2089* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2090* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2091* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2092* 032612  CR2011110200001  PEMA  AHL CHANGES
  2093******************************************************************
  2094
  2095 01  CERTIFICATE-MASTER.
  2096     12  CM-RECORD-ID                      PIC XX.
  2097         88  VALID-CM-ID                      VALUE 'CM'.
  2098
  2099     12  CM-CONTROL-PRIMARY.
  2100         16  CM-COMPANY-CD                 PIC X.
  2101         16  CM-CARRIER                    PIC X.
  2102         16  CM-GROUPING.
  2103             20  CM-GROUPING-PREFIX        PIC X(3).
  2104             20  CM-GROUPING-PRIME         PIC X(3).
  2105         16  CM-STATE                      PIC XX.
  2106         16  CM-ACCOUNT.
  2107             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2108             20  CM-ACCOUNT-PRIME          PIC X(6).
  2109         16  CM-CERT-EFF-DT                PIC XX.
  2110         16  CM-CERT-NO.
  2111             20  CM-CERT-PRIME             PIC X(10).
  2112             20  CM-CERT-SFX               PIC X.
  2113
  2114     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  41
* EL050.cbl
  2115         16  CM-COMPANY-CD-A1              PIC X.
  2116         16  CM-INSURED-LAST-NAME          PIC X(15).
  2117         16  CM-INSURED-INITIALS.
  2118             20  CM-INSURED-INITIAL1       PIC X.
  2119             20  CM-INSURED-INITIAL2       PIC X.
  2120
  2121     12  CM-CONTROL-BY-SSN.
  2122         16  CM-COMPANY-CD-A2              PIC X.
  2123         16  CM-SOC-SEC-NO.
  2124             20  CM-SSN-STATE              PIC XX.
  2125             20  CM-SSN-ACCOUNT            PIC X(6).
  2126             20  CM-SSN-LN3.
  2127                 25  CM-INSURED-INITIALS-A2.
  2128                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2129                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2130                 25 CM-PART-LAST-NAME-A2         PIC X.
  2131
  2132     12  CM-CONTROL-BY-CERT-NO.
  2133         16  CM-COMPANY-CD-A4              PIC X.
  2134         16  CM-CERT-NO-A4                 PIC X(11).
  2135
  2136     12  CM-CONTROL-BY-MEMB.
  2137         16  CM-COMPANY-CD-A5              PIC X.
  2138         16  CM-MEMBER-NO.
  2139             20  CM-MEMB-STATE             PIC XX.
  2140             20  CM-MEMB-ACCOUNT           PIC X(6).
  2141             20  CM-MEMB-LN4.
  2142                 25  CM-INSURED-INITIALS-A5.
  2143                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2144                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2145                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2146
  2147     12  CM-INSURED-PROFILE-DATA.
  2148         16  CM-INSURED-FIRST-NAME.
  2149             20  CM-INSURED-1ST-INIT       PIC X.
  2150             20  FILLER                    PIC X(9).
  2151         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2152         16  CM-INSURED-SEX                PIC X.
  2153             88  CM-SEX-MALE                  VALUE 'M'.
  2154             88  CM-SEX-FEMAL                 VALUE 'F'.
  2155         16  CM-INSURED-JOINT-AGE          PIC 99.
  2156         16  CM-JOINT-INSURED-NAME.
  2157             20  CM-JT-LAST-NAME           PIC X(15).
  2158             20  CM-JT-FIRST-NAME.
  2159                 24  CM-JT-1ST-INIT        PIC X.
  2160                 24  FILLER                PIC X(9).
  2161             20  CM-JT-INITIAL             PIC X.
  2162
  2163     12  CM-LIFE-DATA.
  2164         16  CM-LF-BENEFIT-CD              PIC XX.
  2165         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2166         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2167         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2168         16  CM-LF-DEV-CODE                PIC XXX.
  2169         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2170         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2171         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2172         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  42
* EL050.cbl
  2173         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2174         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2175         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2176         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2177         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2178         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2179         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2180         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2181         16  FILLER                        PIC XX.
  2182
  2183     12  CM-AH-DATA.
  2184         16  CM-AH-BENEFIT-CD              PIC XX.
  2185         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2186         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2187         16  CM-AH-DEV-CODE                PIC XXX.
  2188         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2189         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2190         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2191         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2192         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2193         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2194         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2195         16  CM-AH-PAID-THRU-DT            PIC XX.
  2196             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2197         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2198         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2199         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2200         16  FILLER                        PIC X.
  2201
  2202     12  CM-LOAN-INFORMATION.
  2203         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2204         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2205                                           PIC S9(5)V99  COMP-3.
  2206         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2207         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2208         16  CM-PAY-FREQUENCY              PIC S99.
  2209         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2210         16  CM-RATE-CLASS                 PIC XX.
  2211         16  CM-BENEFICIARY                PIC X(25).
  2212         16  CM-POLICY-FORM-NO             PIC X(12).
  2213         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2214         16  CM-LAST-ADD-ON-DT             PIC XX.
  2215         16  CM-DEDUCTIBLE-AMOUNTS.
  2216             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2217             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2218         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2219             20  CM-RESIDENT-STATE         PIC XX.
  2220             20  CM-RATE-CODE              PIC X(4).
  2221             20  FILLER                    PIC XX.
  2222         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2223             20  CM-LOAN-OFFICER           PIC X(5).
  2224             20  FILLER                    PIC XXX.
  2225         16  CM-CSR-CODE                   PIC XXX.
  2226         16  CM-UNDERWRITING-CODE          PIC X.
  2227             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2228         16  CM-POST-CARD-IND              PIC X.
  2229         16  CM-NH-INTERFACE-SW            PIC X.
  2230         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  43
* EL050.cbl
  2231             88  CM-SING-PRM                  VALUE '1'.
  2232             88  CM-O-B-COVERAGE              VALUE '2'.
  2233             88  CM-OPEN-END                  VALUE '3'.
  2234         16  CM-IND-GRP-TYPE               PIC X.
  2235             88  CM-INDIVIDUAL                VALUE 'I'.
  2236             88  CM-GROUP                     VALUE 'G'.
  2237         16  CM-SKIP-CODE                  PIC X.
  2238             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2239             88  SKIP-JULY                    VALUE '1'.
  2240             88  SKIP-AUGUST                  VALUE '2'.
  2241             88  SKIP-SEPTEMBER               VALUE '3'.
  2242             88  SKIP-JULY-AUG                VALUE '4'.
  2243             88  SKIP-AUG-SEPT                VALUE '5'.
  2244             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2245             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2246             88  SKIP-JUNE                    VALUE '8'.
  2247             88  SKIP-JUNE-JULY               VALUE '9'.
  2248             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2249             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2250         16  CM-PAYMENT-MODE               PIC X.
  2251             88  PAY-MONTHLY                  VALUE SPACE.
  2252             88  PAY-WEEKLY                   VALUE '1'.
  2253             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2254             88  PAY-BI-WEEKLY                VALUE '3'.
  2255             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2256         16  CM-LOAN-NUMBER                PIC X(8).
  2257         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2258         16  CM-OLD-LOF                    PIC XXX.
  2259*        16  CM-LOAN-OFFICER               PIC XXX.
  2260         16  CM-REIN-TABLE                 PIC XXX.
  2261         16  CM-SPECIAL-REIN-CODE          PIC X.
  2262         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2263         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2264         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2265
  2266     12  CM-STATUS-DATA.
  2267         16  CM-ENTRY-STATUS               PIC X.
  2268         16  CM-ENTRY-DT                   PIC XX.
  2269
  2270         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2271         16  CM-LF-CANCEL-DT               PIC XX.
  2272         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2273
  2274         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2275         16  CM-LF-DEATH-DT                PIC XX.
  2276         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2277
  2278         16  CM-LF-CURRENT-STATUS          PIC X.
  2279             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2280                                                'M' '4' '5' '9'.
  2281             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2282             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2283             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2284             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2285             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2286             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2287             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2288             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  44
* EL050.cbl
  2289             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2290             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2291             88  CM-LF-DECLINED               VALUE 'D'.
  2292             88  CM-LF-VOIDED                 VALUE 'V'.
  2293
  2294         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2295         16  CM-AH-CANCEL-DT               PIC XX.
  2296         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2297
  2298         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2299         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2300         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2301
  2302         16  CM-AH-CURRENT-STATUS          PIC X.
  2303             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2304                                                'M' '4' '5' '9'.
  2305             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2306             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2307             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2308             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2309             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2310             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2311             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2312             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2313             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2314             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2315             88  CM-AH-DECLINED               VALUE 'D'.
  2316             88  CM-AH-VOIDED                 VALUE 'V'.
  2317
  2318         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2319             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2320             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2321             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2322         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2323
  2324         16  CM-ENTRY-BATCH                PIC X(6).
  2325         16  CM-LF-EXIT-BATCH              PIC X(6).
  2326         16  CM-AH-EXIT-BATCH              PIC X(6).
  2327         16  CM-LAST-MONTH-END             PIC XX.
  2328
  2329     12  CM-NOTE-SW                        PIC X.
  2330         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2331         88  CERT-NOTES-PRESENT               VALUE '1'.
  2332         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2333         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2334         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2335         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2336         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2337         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2338     12  CM-COMP-EXCP-SW                   PIC X.
  2339         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2340         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2341     12  CM-INSURED-ADDRESS-SW             PIC X.
  2342         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2343         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2344
  2345*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2346     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  45
* EL050.cbl
  2347     12  FILLER                            PIC X.
  2348
  2349*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2350     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2351     12  FILLER                            PIC X.
  2352*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2353     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2354
  2355     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2356         88  CERT-ADDED-BATCH                 VALUE ' '.
  2357         88  CERT-ADDED-ONLINE                VALUE '1'.
  2358         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2359         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2360         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2361     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2362         88  CERT-AS-LOADED                   VALUE ' '.
  2363         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2364         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2365         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2366         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2367         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2368         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2369         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2370
  2371     12  CM-ACCOUNT-COMM-PCTS.
  2372         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2373         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2374
  2375     12  CM-USER-FIELD                     PIC X.
  2376     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2377     12  CM-CLP-STATE                      PIC XX.
  2378     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2379     12  CM-USER-RESERVED                  PIC XXX.
  2380     12  FILLER REDEFINES CM-USER-RESERVED.
  2381         16  CM-AH-CLASS-CD                PIC XX.
  2382         16  F                             PIC X.
  2383******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  46
* EL050.cbl
  2385*    COPY ERCMAIL.
  2386******************************************************************
  2387*                                                                *
  2388*                                                                *
  2389*                            ERCMAIL                             *
  2390*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2391*                            VMOD=2.003                          *
  2392*                                                                *
  2393*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2394*                                                                *
  2395*   FILE TYPE = VSAM,KSDS                                        *
  2396*   RECORD SIZE = 374   RECFORM = FIX                            *
  2397*                                                                *
  2398*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2399*   ALTERNATE PATH    = NOT USED                                 *
  2400*                                                                *
  2401*   LOG = YES                                                    *
  2402*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2403******************************************************************
  2404*                   C H A N G E   L O G
  2405*
  2406* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2407*-----------------------------------------------------------------
  2408*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2409* EFFECTIVE    NUMBER
  2410*-----------------------------------------------------------------
  2411* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2412* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2413* 111108                   PEMA  ADD CRED BENE ADDR2
  2414******************************************************************
  2415
  2416 01  MAILING-DATA.
  2417     12  MA-RECORD-ID                      PIC XX.
  2418         88  VALID-MA-ID                       VALUE 'MA'.
  2419
  2420     12  MA-CONTROL-PRIMARY.
  2421         16  MA-COMPANY-CD                 PIC X.
  2422         16  MA-CARRIER                    PIC X.
  2423         16  MA-GROUPING.
  2424             20  MA-GROUPING-PREFIX        PIC XXX.
  2425             20  MA-GROUPING-PRIME         PIC XXX.
  2426         16  MA-STATE                      PIC XX.
  2427         16  MA-ACCOUNT.
  2428             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2429             20  MA-ACCOUNT-PRIME          PIC X(6).
  2430         16  MA-CERT-EFF-DT                PIC XX.
  2431         16  MA-CERT-NO.
  2432             20  MA-CERT-PRIME             PIC X(10).
  2433             20  MA-CERT-SFX               PIC X.
  2434
  2435     12  FILLER                            PIC XX.
  2436
  2437     12  MA-ACCESS-CONTROL.
  2438         16  MA-SOURCE-SYSTEM              PIC XX.
  2439             88  MA-FROM-CREDIT                VALUE 'CR'.
  2440             88  MA-FROM-VSI                   VALUE 'VS'.
  2441             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2442             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  47
* EL050.cbl
  2443         16  MA-RECORD-ADD-DT              PIC XX.
  2444         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2445         16  MA-LAST-MAINT-DT              PIC XX.
  2446         16  MA-LAST-MAINT-BY              PIC XXXX.
  2447         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2448
  2449     12  MA-PROFILE-INFO.
  2450         16  MA-QUALIFY-CODE-1             PIC XX.
  2451         16  MA-QUALIFY-CODE-2             PIC XX.
  2452         16  MA-QUALIFY-CODE-3             PIC XX.
  2453         16  MA-QUALIFY-CODE-4             PIC XX.
  2454         16  MA-QUALIFY-CODE-5             PIC XX.
  2455
  2456         16  MA-INSURED-LAST-NAME          PIC X(15).
  2457         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2458         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2459         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2460         16  MA-INSURED-BIRTH-DT           PIC XX.
  2461         16  MA-INSURED-SEX                PIC X.
  2462             88  MA-SEX-MALE                   VALUE 'M'.
  2463             88  MA-SEX-FEMALE                 VALUE 'F'.
  2464         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2465
  2466         16  MA-ADDRESS-CORRECTED          PIC X.
  2467         16  MA-JOINT-BIRTH-DT             PIC XX.
  2468*        16  FILLER                        PIC X(12).
  2469
  2470         16  MA-ADDRESS-LINE-1             PIC X(30).
  2471         16  MA-ADDRESS-LINE-2             PIC X(30).
  2472         16  MA-CITY-STATE.
  2473             20  MA-CITY                   PIC X(28).
  2474             20  MA-ADDR-STATE             PIC XX.
  2475         16  MA-ZIP.
  2476             20  MA-ZIP-CODE.
  2477                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2478                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2479                 24  FILLER                PIC X(4).
  2480             20  MA-ZIP-PLUS4              PIC X(4).
  2481         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2482             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2483             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2484             20  FILLER                    PIC X(3).
  2485
  2486         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2487
  2488         16  FILLER                        PIC XXX.
  2489*        16  FILLER                        PIC X(10).
  2490
  2491     12  MA-CRED-BENE-INFO.
  2492         16  MA-CRED-BENE-NAME                 PIC X(25).
  2493         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2494         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2495         16  MA-CRED-BENE-CTYST.
  2496             20  MA-CRED-BENE-CITY             PIC X(28).
  2497             20  MA-CRED-BENE-STATE            PIC XX.
  2498         16  MA-CRED-BENE-ZIP.
  2499             20  MA-CB-ZIP-CODE.
  2500                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  48
* EL050.cbl
  2501                     88  MA-CB-CANADIAN-POST-CODE
  2502                                           VALUE 'A' THRU 'Z'.
  2503                 24  FILLER                    PIC X(4).
  2504             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2505         16  MA-CB-CANADIAN-POSTAL-CODE
  2506                            REDEFINES MA-CRED-BENE-ZIP.
  2507             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2508             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2509             20  FILLER                        PIC X(3).
  2510     12  MA-POST-CARD-MAIL-DATA.
  2511         16  MA-MAIL-DATA OCCURS 7.
  2512             20  MA-MAIL-TYPE              PIC X.
  2513                 88  MA-12MO-MAILING           VALUE '1'.
  2514                 88  MA-EXP-MAILING            VALUE '2'.
  2515             20  MA-MAIL-STATUS            PIC X.
  2516                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2517                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2518                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2519             20  MA-MAIL-DATE              PIC XX.
  2520     12  FILLER                            PIC XX.
  2521     12  FILLER                            PIC XX.
  2522*    12  FILLER                            PIC X(30).
  2523******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  49
* EL050.cbl
  2525*    COPY ERCPNDM.
  2526******************************************************************
  2527*                                                                *
  2528*                                                                *
  2529*                            ERCPNDM                             *
  2530*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2531*                            VMOD=2.003                          *
  2532*                                                                *
  2533*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2534*                                                                *
  2535*   FILE TYPE = VSAM,KSDS                                        *
  2536*   RECORD SIZE = 374   RECFORM = FIX                            *
  2537*                                                                *
  2538*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2539*   ALTERNATE PATH    = NOT USED                                 *
  2540*                                                                *
  2541*   LOG = YES                                                    *
  2542*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2543******************************************************************
  2544*                   C H A N G E   L O G
  2545*
  2546* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2547*-----------------------------------------------------------------
  2548*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2549* EFFECTIVE    NUMBER
  2550*-----------------------------------------------------------------
  2551* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2552* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2553* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2554******************************************************************
  2555
  2556 01  PENDING-MAILING-DATA.
  2557     12  PM-RECORD-ID                      PIC XX.
  2558         88  VALID-MA-ID                       VALUE 'PM'.
  2559
  2560     12  PM-CONTROL-PRIMARY.
  2561         16  PM-COMPANY-CD                 PIC X.
  2562         16  PM-ENTRY-BATCH                PIC X(6).
  2563         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2564         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2565
  2566     12  FILLER                            PIC X(14).
  2567
  2568     12  PM-ACCESS-CONTROL.
  2569         16  PM-SOURCE-SYSTEM              PIC XX.
  2570             88  PM-FROM-CREDIT                VALUE 'CR'.
  2571             88  PM-FROM-VSI                   VALUE 'VS'.
  2572             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2573             88  PM-FROM-OTHER                 VALUE 'OT'.
  2574         16  PM-RECORD-ADD-DT              PIC XX.
  2575         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2576         16  PM-LAST-MAINT-DT              PIC XX.
  2577         16  PM-LAST-MAINT-BY              PIC XXXX.
  2578         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2579
  2580     12  PM-PROFILE-INFO.
  2581         16  PM-QUALIFY-CODE-1             PIC XX.
  2582         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  50
* EL050.cbl
  2583         16  PM-QUALIFY-CODE-3             PIC XX.
  2584         16  PM-QUALIFY-CODE-4             PIC XX.
  2585         16  PM-QUALIFY-CODE-5             PIC XX.
  2586
  2587         16  PM-INSURED-LAST-NAME          PIC X(15).
  2588         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2589         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2590         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2591         16  PM-INSURED-BIRTH-DT           PIC XX.
  2592         16  PM-INSURED-SEX                PIC X.
  2593             88  PM-SEX-MALE                   VALUE 'M'.
  2594             88  PM-SEX-FEMALE                 VALUE 'F'.
  2595         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2596
  2597         16  PM-ADDRESS-CORRECTED          PIC X.
  2598         16  PM-JOINT-BIRTH-DT             PIC XX.
  2599*        16  FILLER                        PIC X(12).
  2600
  2601         16  PM-ADDRESS-LINE-1             PIC X(30).
  2602         16  PM-ADDRESS-LINE-2             PIC X(30).
  2603         16  PM-CITY-STATE.
  2604             20  PM-CITY                   PIC X(28).
  2605             20  PM-STATE                  PIC XX.
  2606         16  PM-ZIP.
  2607             20  PM-ZIP-CODE.
  2608                 24  PM-ZIP-1              PIC X.
  2609                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2610                 24  FILLER                PIC X(4).
  2611             20  PM-ZIP-PLUS4              PIC X(4).
  2612         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2613             20  PM-CAN-POST1              PIC XXX.
  2614             20  PM-CAN-POST2              PIC XXX.
  2615             20  FILLER                    PIC XXX.
  2616
  2617         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2618
  2619         16  FILLER                        PIC X(03).
  2620
  2621     12  PM-CRED-BENE-INFO.
  2622         16  PM-CRED-BENE-NAME             PIC X(25).
  2623         16  PM-CRED-BENE-ADDR             PIC X(30).
  2624         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2625         16  PM-CRED-BENE-CTYST.
  2626             20  PM-CRED-BENE-CITY         PIC X(28).
  2627             20  PM-CRED-BENE-STATE        PIC XX.
  2628         16  PM-CRED-BENE-ZIP.
  2629             20  PM-CB-ZIP-CODE.
  2630                 24  PM-CB-ZIP-1           PIC X.
  2631                     88  PM-CB-CANADIAN-POST-CODE
  2632                                  VALUE 'A' THRU 'Z'.
  2633                 24  FILLER                PIC X(4).
  2634             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2635         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2636             20  PM-CB-CAN-POST1           PIC XXX.
  2637             20  PM-CB-CAN-POST2           PIC XXX.
  2638             20  FILLER                    PIC XXX.
  2639     12  PM-POST-CARD-MAIL-DATA.
  2640         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  51
* EL050.cbl
  2641             20  PM-MAIL-TYPE              PIC X.
  2642                 88  PM-12MO-MAILING           VALUE '1'.
  2643                 88  PM-EXP-MAILING            VALUE '2'.
  2644             20  PM-MAIL-STATUS            PIC X.
  2645                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2646                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2647                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2648             20  PM-MAIL-DATE              PIC XX.
  2649     12  FILLER                            PIC XX.
  2650     12  FILLER                            PIC X(12).
  2651*    12  FILLER                            PIC X(30).
  2652
  2653******************************************************************
  2654*                                COPY ERCLOFC.
  2655******************************************************************
  2656*                                                                *
  2657*                                                                *
  2658*                            ERCLOFC                             *
  2659*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2660*                            VMOD=2.003                          *
  2661*                                                                *
  2662*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2663*                                                                *
  2664*   FILE TYPE = VSAM,KSDS                                        *
  2665*   RECORD SIZE = 670   RECFORM = FIX                            *
  2666*                                                                *
  2667*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2668*                                                                *
  2669*   LOG = YES                                                    *
  2670*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2671*                                                                *
  2672******************************************************************
  2673
  2674 01  LOAN-OFFICER-MASTER.
  2675     12  LO-RECORD-ID                PIC XX.
  2676         88  VALID-LO-ID                VALUE 'LO'.
  2677
  2678     12  LO-CONTROL-PRIMARY.
  2679         16  LO-COMPANY-CD           PIC X.
  2680         16  LO-CARRIER              PIC X.
  2681         16  LO-GROUPING.
  2682             20  LO-GROUPING-PREFIX  PIC XXX.
  2683             20  LO-GROUPING-PRIME   PIC XXX.
  2684         16  LO-STATE                PIC XX.
  2685         16  LO-ACCOUNT.
  2686             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2687             20  LO-ACCOUNT-PRIME    PIC X(6).
  2688         16  LO-OFFICER-CODE         PIC X(5).
  2689
  2690     12  LO-OFFICER-NAME             PIC X(30).
  2691
  2692     12  LO-LAST-MAINT-DT            PIC XX.
  2693     12  LO-LAST-USER                PIC X(4).
  2694     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2695
  2696     12  LO-COMP-CONTROL             PIC X.
  2697             88  LO-SHOW-COMP           VALUE 'Y'.
  2698             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  52
* EL050.cbl
  2699     12  LO-DETAIL-CONTROL           PIC X.
  2700             88  LO-PRINT-DETAIL        VALUE 'D'.
  2701             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2702
  2703     12  LO-SV-CARRIER               PIC X.
  2704     12  LO-SV-GROUPING              PIC X(6).
  2705     12  LO-SV-STATE                 PIC XX.
  2706
  2707     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2708     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2709
  2710     12  LO-OFFICER-INFO.
  2711         16  FILLER OCCURS 12 TIMES.
  2712             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2713             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2714             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2715             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2716             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2717             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2718             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2719             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2720     12  FILLER                      PIC X(198).
  2721******************************************************************
  2722*                                COPY ERCPDEF.
  2723******************************************************************
  2724*                                                                *
  2725*                                                                *
  2726*                            ERCPDEF.                            *
  2727*                                                                *
  2728*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2729*                                                                *
  2730*    FILE TYPE = VSAM,KSDS                                       *
  2731*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2732*                                                                *
  2733*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2734*                                                                *
  2735*    LOG = YES                                                   *
  2736*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2737******************************************************************
  2738 01  PRODUCT-MASTER.
  2739    12  PD-RECORD-ID                 PIC X(02).
  2740        88  VALID-PD-ID                  VALUE 'PD'.
  2741    12  PD-CONTROL-PRIMARY.
  2742        16  PD-COMPANY-CD            PIC X.
  2743        16  PD-STATE                 PIC XX.
  2744        16  PD-PRODUCT-CD            PIC XXX.
  2745        16  PD-FILLER                PIC X(7).
  2746        16  PD-BEN-TYPE              PIC X.
  2747        16  PD-BEN-CODE              PIC XX.
  2748        16  PD-PROD-EXP-DT           PIC XX.
  2749    12  FILLER                       PIC X(50).
  2750    12  PD-PRODUCT-DATA OCCURS 8.
  2751        16  PD-PROD-CODE             PIC X.
  2752            88  PD-PROD-LIFE           VALUE 'L'.
  2753            88  PD-PROD-PROP           VALUE 'P'.
  2754            88  PD-PROD-AH             VALUE 'A'.
  2755            88  PD-PROD-IU             VALUE 'I'.
  2756            88  PD-PROD-GAP            VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  53
* EL050.cbl
  2757        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2758        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2759        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2760        16  PD-MAX-TERM              PIC S999        COMP-3.
  2761        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2762        16  FILLER                   PIC X.
  2763        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2764        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2765        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2766        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2767        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2768        16  PD-REC-CRIT-PERIOD       PIC X.
  2769        16  PD-RTW-MOS               PIC 99.
  2770        16  FILLER                   PIC X(5).
  2771    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2772    12  PD-TERM-LIMITS OCCURS 15.
  2773        16  PD-LOW-TERM              PIC S999        COMP-3.
  2774        16  PD-HI-TERM               PIC S999        COMP-3.
  2775*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2776    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2777        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2778        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2779    12  PD-EARN-FACTORS.
  2780        16  FILLER OCCURS 15.
  2781            20  FILLER OCCURS 15.
  2782                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2783    12  PD-PRODUCT-DESC              PIC X(80).
  2784    12  PD-TRUNCATED                 PIC X.
  2785    12  FILLER                       PIC X(59).
  2786    12  PD-MAINT-INFORMATION.
  2787        16  PD-LAST-MAINT-DT         PIC X(02).
  2788        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2789        16  PD-LAST-MAINT-BY         PIC X(04).
  2790*                                COPY ELCSTATE.
  2791******************************************************************
  2792*                                                                *
  2793*                                                                *
  2794*                            ELCSTATE.                           *
  2795*                                                                *
  2796*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2797*                                                                *
  2798*   FILE TYPE = VSAM,KSDS                                        *
  2799*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2800*                                                                *
  2801*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2802*       ALTERNATE INDEX = NONE                                   *
  2803*                                                                *
  2804*   LOG = YES                                                    *
  2805*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2806******************************************************************
  2807*                   C H A N G E   L O G
  2808*
  2809* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2810*-----------------------------------------------------------------
  2811*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2812* EFFECTIVE    NUMBER
  2813*-----------------------------------------------------------------
  2814* 122710  CR2010012700001  PEMA  NEW COPYBOOK
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  54
* EL050.cbl
  2815******************************************************************
  2816*
  2817 01  STATE-FILE.
  2818     12  SF-RECORD-ID                       PIC XX.
  2819         88  VALID-CF-ID                        VALUE 'SF'.
  2820     12  SF-CONTROL-PRIMARY.
  2821         16  SF-COMPANY-ID                  PIC XXX.
  2822         16  SF-CARRIER-CODE                PIC X.
  2823         16  SF-GROUPING                    PIC X(6).
  2824         16  SF-STATE-CODE                  PIC XX.
  2825         16  SF-EXPIRE-DATE                 PIC 9(8).
  2826****************************************************************
  2827*             STATE CONTROLS
  2828****************************************************************
  2829     12  SF-LAST-MAINT-DT                   PIC XX.
  2830     12  SF-LAST-MAINT-BY                   PIC X(4).
  2831     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2832     12  SF-STATE-RT-CONTROLS.
  2833         16  SF-ST-RT-CALC                  PIC X.
  2834     12  SF-ST-TAX-CONTROLS.
  2835         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2836         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2837         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2838     12  SF-ST-REFUND-OPTIONS.
  2839         16  SF-ST-RF-LR-CALC               PIC X.
  2840         16  SF-ST-RF-LL-CALC               PIC X.
  2841         16  SF-ST-RF-LN-CALC               PIC X.
  2842         16  SF-ST-RF-AH-CALC               PIC X.
  2843         16  SF-ST-RF-CP-CALC               PIC X.
  2844     12  SF-ST-UNEARN-PREM-OPTIONS.
  2845         16  SF-ST-LUEP-R78                 PIC X.
  2846         16  SF-ST-LUEP-PRO                 PIC X.
  2847         16  SF-ST-LUEP-ST                  PIC X.
  2848         16  SF-ST-LUEP-DOM                 PIC X.
  2849         16  SF-ST-AUEP-R78                 PIC X.
  2850         16  SF-ST-AUEP-PRO                 PIC X.
  2851         16  SF-ST-AUEP-ST                  PIC X.
  2852         16  SF-ST-AUEP-DOM                 PIC X.
  2853         16  SF-ST-CUEP-R78                 PIC X.
  2854         16  SF-ST-CUEP-PRO                 PIC X.
  2855         16  SF-ST-CUEP-ST                  PIC X.
  2856         16  SF-ST-CUEP-DOM                 PIC X.
  2857     12  SF-ST-EARN-PREM-OPTIONS.
  2858         16  SF-ST-LEP-R78                  PIC X.
  2859         16  SF-ST-LEP-PRO                  PIC X.
  2860         16  SF-ST-LEP-ST                   PIC X.
  2861         16  SF-ST-LEP-DOM                  PIC X.
  2862         16  SF-ST-AEP-R78                  PIC X.
  2863         16  SF-ST-AEP-PRO                  PIC X.
  2864         16  SF-ST-AEP-ST                   PIC X.
  2865         16  SF-ST-AEP-DOM                  PIC X.
  2866         16  SF-ST-CEP-R78                  PIC X.
  2867         16  SF-ST-CEP-PRO                  PIC X.
  2868         16  SF-ST-CEP-ST                   PIC X.
  2869         16  SF-ST-CEP-DOM                  PIC X.
  2870     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  55
* EL050.cbl
  2872*    COPY ELCCRTT.
  2873******************************************************************
  2874*                                                                *
  2875*                            ELCCRTT.                            *
  2876*                                                                *
  2877*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2878*                                                                *
  2879*   FILE TYPE = VSAM,KSDS                                        *
  2880*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2881*                                                                *
  2882*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2883*                                                                *
  2884*   LOG = YES                                                    *
  2885*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2886******************************************************************
  2887*                   C H A N G E   L O G
  2888*
  2889* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2890*-----------------------------------------------------------------
  2891*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2892* EFFECTIVE    NUMBER
  2893*-----------------------------------------------------------------
  2894* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2895* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2896* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2897* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2898* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2899******************************************************************
  2900
  2901 01  CERTIFICATE-TRAILERS.
  2902     12  CS-RECORD-ID                      PIC XX.
  2903         88  VALID-CS-ID                      VALUE 'CS'.
  2904
  2905     12  CS-CONTROL-PRIMARY.
  2906         16  CS-COMPANY-CD                 PIC X.
  2907         16  CS-CARRIER                    PIC X.
  2908         16  CS-GROUPING                   PIC X(6).
  2909         16  CS-STATE                      PIC XX.
  2910         16  CS-ACCOUNT                    PIC X(10).
  2911         16  CS-CERT-EFF-DT                PIC XX.
  2912         16  CS-CERT-NO.
  2913             20  CS-CERT-PRIME             PIC X(10).
  2914             20  CS-CERT-SFX               PIC X.
  2915         16  CS-TRAILER-TYPE               PIC X.
  2916             88  COMM-TRLR           VALUE 'A'.
  2917             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  2918             88  CERT-DATA-TRLR      VALUE 'C'.
  2919
  2920     12  CS-DATA-AREA                      PIC X(516).
  2921
  2922     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2923         16  CS-BANK-COMMISSION-AREA.
  2924             20  CS-BANK-COMMS       OCCURS 10.
  2925                 24  CS-AGT                PIC X(10).
  2926                 24  CS-COM-TYP            PIC X.
  2927                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2928                 24  CS-RECALC-LV-INDIC    PIC X.
  2929                 24  FILLER                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  56
* EL050.cbl
  2930         16  FILLER                        PIC X(256).
  2931
  2932     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  2933****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  2934****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  2935         16  CS-MB-CLAIM-DATA OCCURS 2.
  2936             20  FILLER OCCURS 10.
  2937                 24  CS-CLAIM-TYPE         PIC X.
  2938                     88  CS-AH-CLM           VALUE 'A'.
  2939                     88  CS-IU-CLM           VALUE 'I'.
  2940                     88  CS-GP-CLM           VALUE 'G'.
  2941                     88  CS-LF-CLM           VALUE 'L'.
  2942                     88  CS-PR-CLM           VALUE 'P'.
  2943                 24  CS-BANK               PIC S999 COMP-3.
  2944                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  2945                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  2946                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  2947         16  FILLER                        PIC X(216).
  2948     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2949         16  CS-VIN-NUMBER                 PIC X(17).
  2950         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2951         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  2952         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  2953         16  FILLER                        PIC X(496).
  2954******************************************************************
  2955*    COPY ELCCRTO.
  2956******************************************************************
  2957*                                                                *
  2958*                            ELCCRTO.                            *
  2959*                                                                *
  2960*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  2961*                                                                *
  2962*   FILE TYPE = VSAM,KSDS                                        *
  2963*   RECORD SIZE = 524  RECFORM = FIXED                           *
  2964*                                                                *
  2965*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  2966*                                                                *
  2967*   LOG = YES                                                    *
  2968*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2969******************************************************************
  2970*                   C H A N G E   L O G
  2971*
  2972* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2973*-----------------------------------------------------------------
  2974*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2975* EFFECTIVE    NUMBER
  2976*-----------------------------------------------------------------
  2977* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  2978* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  2979* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  2980* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2981* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  2982******************************************************************
  2983 01  ORIGINAL-CERTIFICATE.
  2984     12  OC-RECORD-ID                      PIC XX.
  2985         88  VALID-OC-ID                      VALUE 'OC'.
  2986     12  OC-CONTROL-PRIMARY.
  2987         16  OC-COMPANY-CD                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  57
* EL050.cbl
  2988         16  OC-CARRIER                    PIC X.
  2989         16  OC-GROUPING                   PIC X(6).
  2990         16  OC-STATE                      PIC XX.
  2991         16  OC-ACCOUNT                    PIC X(10).
  2992         16  OC-CERT-EFF-DT                PIC XX.
  2993         16  OC-CERT-NO.
  2994             20  OC-CERT-PRIME             PIC X(10).
  2995             20  OC-CERT-SFX               PIC X.
  2996         16  OC-RECORD-TYPE                PIC X.
  2997         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  2998     12  OC-LAST-MAINT-DT                  PIC XX.
  2999     12  OC-LAST-MAINT-BY                  PIC X(4).
  3000     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3001     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3002     12  FILLER                            PIC X(49).
  3003     12  OC-ORIG-REC.
  3004         16  OC-INS-LAST-NAME              PIC X(15).
  3005         16  OC-INS-FIRST-NAME             PIC X(10).
  3006         16  OC-INS-MIDDLE-INIT            PIC X.
  3007         16  OC-INS-AGE                    PIC S999     COMP-3.
  3008         16  OC-JNT-LAST-NAME              PIC X(15).
  3009         16  OC-JNT-FIRST-NAME             PIC X(10).
  3010         16  OC-JNT-MIDDLE-INIT            PIC X.
  3011         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3012         16  OC-LF-BENCD                   PIC XX.
  3013         16  OC-LF-TERM                    PIC S999      COMP-3.
  3014         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3015         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3016         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3017         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3018         16  OC-LF-EXP-DT                  PIC XX.
  3019         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  3020         16  OC-LF-CANCEL-DT               PIC XX.
  3021         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3022         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3023         16  OC-AH-BENCD                   PIC XX.
  3024         16  OC-AH-TERM                    PIC S999      COMP-3.
  3025         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3026         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3027         16  OC-AH-EXP-DT                  PIC XX.
  3028         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3029         16  OC-AH-CP                      PIC 99.
  3030         16  OC-AH-CANCEL-DT               PIC XX.
  3031         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3032         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3033         16  OC-CRED-BENE-NAME             PIC X(25).
  3034         16  OC-1ST-PMT-DT                 PIC XX.
  3035         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3036         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3037         16  OC-ISSUE-TRAN-IND             PIC X.
  3038         16  OC-CANCEL-TRAN-IND            PIC X.
  3039         16  FILLER                        PIC X(211).
  3040
  3041     12  FILLER                            PIC X(50).
  3042******************************************************************
  3043
  3044*    COPY ELCDATE.
  3045******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  58
* EL050.cbl
  3046*                                                                *
  3047*                                                                *
  3048*                            ELCDATE.                            *
  3049*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3050*                            VMOD=2.003
  3051*                                                                *
  3052*                                                                *
  3053*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3054*                 LENGTH = 200                                   *
  3055******************************************************************
  3056
  3057 01  DATE-CONVERSION-DATA.
  3058     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3059     12  DC-OPTION-CODE                PIC X.
  3060         88  BIN-TO-GREG                VALUE ' '.
  3061         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3062         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3063         88  YMD-GREG-TO-BIN            VALUE '3'.
  3064         88  MDY-GREG-TO-BIN            VALUE '4'.
  3065         88  JULIAN-TO-BIN              VALUE '5'.
  3066         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3067         88  FIND-CENTURY               VALUE '7'.
  3068         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3069         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3070         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3071         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3072         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3073         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3074         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3075         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3076         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3077         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3078         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3079         88  BIN-3-TO-GREG              VALUE 'I'.
  3080         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3081         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3082         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3083         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3084         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3085         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3086         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3087         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3088         88  THREE-CHARACTER-BIN
  3089                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3090         88  GREGORIAN-TO-BIN
  3091                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3092         88  BIN-TO-GREGORIAN
  3093                  VALUES ' ' '1' 'I' '8' 'G'.
  3094         88  JULIAN-TO-BINARY
  3095                  VALUES '5' 'C' 'E' 'F'.
  3096     12  DC-ERROR-CODE                 PIC X.
  3097         88  NO-CONVERSION-ERROR        VALUE ' '.
  3098         88  DATE-CONVERSION-ERROR
  3099                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3100         88  DATE-IS-ZERO               VALUE '1'.
  3101         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3102         88  DATE-IS-INVALID            VALUE '3'.
  3103         88  DATE1-GREATER-DATE2        VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  59
* EL050.cbl
  3104         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3105         88  DATE-INVALID-OPTION        VALUE '9'.
  3106         88  INVALID-CENTURY            VALUE 'A'.
  3107         88  ONLY-CENTURY               VALUE 'B'.
  3108         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3109         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3110     12  DC-END-OF-MONTH               PIC X.
  3111         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3112     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3113         88  USE-NORMAL-PROCESS         VALUE ' '.
  3114         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3115         88  ADJUST-UP-100-YRS          VALUE '2'.
  3116     12  FILLER                        PIC X.
  3117     12  DC-CONVERSION-DATES.
  3118         16  DC-BIN-DATE-1             PIC XX.
  3119         16  DC-BIN-DATE-2             PIC XX.
  3120         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3121         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3122                       DC-GREG-DATE-1-EDIT.
  3123             20  DC-EDIT1-MONTH        PIC 99.
  3124             20  SLASH1-1              PIC X.
  3125             20  DC-EDIT1-DAY          PIC 99.
  3126             20  SLASH1-2              PIC X.
  3127             20  DC-EDIT1-YEAR         PIC 99.
  3128         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3129         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3130                     DC-GREG-DATE-2-EDIT.
  3131             20  DC-EDIT2-MONTH        PIC 99.
  3132             20  SLASH2-1              PIC X.
  3133             20  DC-EDIT2-DAY          PIC 99.
  3134             20  SLASH2-2              PIC X.
  3135             20  DC-EDIT2-YEAR         PIC 99.
  3136         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3137         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3138                     DC-GREG-DATE-1-YMD.
  3139             20  DC-YMD-YEAR           PIC 99.
  3140             20  DC-YMD-MONTH          PIC 99.
  3141             20  DC-YMD-DAY            PIC 99.
  3142         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3143         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3144                      DC-GREG-DATE-1-MDY.
  3145             20  DC-MDY-MONTH          PIC 99.
  3146             20  DC-MDY-DAY            PIC 99.
  3147             20  DC-MDY-YEAR           PIC 99.
  3148         16  DC-GREG-DATE-1-ALPHA.
  3149             20  DC-ALPHA-MONTH        PIC X(10).
  3150             20  DC-ALPHA-DAY          PIC 99.
  3151             20  FILLER                PIC XX.
  3152             20  DC-ALPHA-CENTURY.
  3153                 24 DC-ALPHA-CEN-N     PIC 99.
  3154             20  DC-ALPHA-YEAR         PIC 99.
  3155         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3156         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3157         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3158         16  DC-JULIAN-DATE            PIC 9(05).
  3159         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3160                                       PIC 9(05).
  3161         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  60
* EL050.cbl
  3162             20  DC-JULIAN-YEAR        PIC 99.
  3163             20  DC-JULIAN-DAYS        PIC 999.
  3164         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3165         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3166         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3167     12  DATE-CONVERSION-VARIBLES.
  3168         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3169         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3170             20  FILLER                PIC 9(3).
  3171             20  HOLD-CEN-1-CCYY.
  3172                 24  HOLD-CEN-1-CC     PIC 99.
  3173                 24  HOLD-CEN-1-YY     PIC 99.
  3174             20  HOLD-CEN-1-MO         PIC 99.
  3175             20  HOLD-CEN-1-DA         PIC 99.
  3176         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3177             20  HOLD-CEN-1-R-MO       PIC 99.
  3178             20  HOLD-CEN-1-R-DA       PIC 99.
  3179             20  HOLD-CEN-1-R-CCYY.
  3180                 24  HOLD-CEN-1-R-CC   PIC 99.
  3181                 24  HOLD-CEN-1-R-YY   PIC 99.
  3182             20  FILLER                PIC 9(3).
  3183         16  HOLD-CENTURY-1-X.
  3184             20  FILLER                PIC X(3)  VALUE SPACES.
  3185             20  HOLD-CEN-1-X-CCYY.
  3186                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3187                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3188             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3189             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3190         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3191             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3192             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3193             20  HOLD-CEN-1-R-X-CCYY.
  3194                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3195                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3196             20  FILLER                PIC XXX.
  3197         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3198         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3199         16  DC-JULIAN-DATE-1          PIC 9(07).
  3200         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3201             20  DC-JULIAN-1-CCYY.
  3202                 24  DC-JULIAN-1-CC    PIC 99.
  3203                 24  DC-JULIAN-1-YR    PIC 99.
  3204             20  DC-JULIAN-DA-1        PIC 999.
  3205         16  DC-JULIAN-DATE-2          PIC 9(07).
  3206         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3207             20  DC-JULIAN-2-CCYY.
  3208                 24  DC-JULIAN-2-CC    PIC 99.
  3209                 24  DC-JULIAN-2-YR    PIC 99.
  3210             20  DC-JULIAN-DA-2        PIC 999.
  3211         16  DC-GREG-DATE-A-EDIT.
  3212             20  DC-EDITA-MONTH        PIC 99.
  3213             20  SLASHA-1              PIC X VALUE '/'.
  3214             20  DC-EDITA-DAY          PIC 99.
  3215             20  SLASHA-2              PIC X VALUE '/'.
  3216             20  DC-EDITA-CCYY.
  3217                 24  DC-EDITA-CENT     PIC 99.
  3218                 24  DC-EDITA-YEAR     PIC 99.
  3219         16  DC-GREG-DATE-B-EDIT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  61
* EL050.cbl
  3220             20  DC-EDITB-MONTH        PIC 99.
  3221             20  SLASHB-1              PIC X VALUE '/'.
  3222             20  DC-EDITB-DAY          PIC 99.
  3223             20  SLASHB-2              PIC X VALUE '/'.
  3224             20  DC-EDITB-CCYY.
  3225                 24  DC-EDITB-CENT     PIC 99.
  3226                 24  DC-EDITB-YEAR     PIC 99.
  3227         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3228         16  DC-GREG-DATE-CYMD-R REDEFINES
  3229                              DC-GREG-DATE-CYMD.
  3230             20  DC-CYMD-CEN           PIC 99.
  3231             20  DC-CYMD-YEAR          PIC 99.
  3232             20  DC-CYMD-MONTH         PIC 99.
  3233             20  DC-CYMD-DAY           PIC 99.
  3234         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3235         16  DC-GREG-DATE-MDCY-R REDEFINES
  3236                              DC-GREG-DATE-MDCY.
  3237             20  DC-MDCY-MONTH         PIC 99.
  3238             20  DC-MDCY-DAY           PIC 99.
  3239             20  DC-MDCY-CEN           PIC 99.
  3240             20  DC-MDCY-YEAR          PIC 99.
  3241    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3242        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3243    12  DC-EL310-DATE                  PIC X(21).
  3244    12  FILLER                         PIC X(28).
  3245
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  62
* EL050.cbl
  3247*    COPY ELCCALC.
  3248******************************************************************
  3249*                                                                *
  3250*                           ELCCALC.                            *
  3251*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3252*                            VMOD=2.025                          *
  3253*                                                                *
  3254*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3255*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3256*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3257*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3258*                                                                *
  3259*  PASSED TO ELRTRM                                              *
  3260*  -----------------                                             *
  3261*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3262*  ORIGINAL TERM                                                 *
  3263*  BEGINNING DATE                                                *
  3264*  ENDING DATE                                                   *
  3265*  COMPANY I.D.                                                  *
  3266*  ACCOUNT MASTER USER FIELD                                     *
  3267*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3268*  FREE LOOK DAYS                                                *
  3269*                                                                *
  3270*  RETURNED FROM ELRTRM                                          *
  3271*  ---------------------                                         *
  3272*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3273*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3274*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3275*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3276*----------------------------------------------------------------*
  3277*  PASSED TO ELRAMT                                              *
  3278*  ----------------                                              *
  3279*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3280*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3281*  ORIGINAL AMOUNT                                               *
  3282*  ALTERNATE BENEFIT (BALLON)                                    *
  3283*  A.P.R. - NET PAY ONLY                                         *
  3284*  METHOD
  3285*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3286*  COMPANY I.D.                                                  *
  3287*  BENEFIT TYPE                                                  *
  3288*                                                                *
  3289*  RETURNED FROM ELRAMT                                          *
  3290*  --------------------                                          *
  3291*  REMAINING AMOUNT 1 - CURRENT                                  *
  3292*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3293*  REMAINING AMOUNT FACTOR
  3294*----------------------------------------------------------------*
  3295*  PASSED TO ELRESV                                              *
  3296*  -----------------                                             *
  3297*  CERTIFICATE EFFECTIVE DATE                                    *
  3298*  VALUATION DATE                                                *
  3299*  PAID THRU DATE                                                *
  3300*  BENEFIT                                                       *
  3301*  INCURRED DATE                                                 *
  3302*  REPORTED DATE                                                 *
  3303*  ISSUE AGE                                                     *
  3304*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  63
* EL050.cbl
  3305*  CDT PERCENT                                                   *
  3306*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3307* *CLAIM TYPE (LIFE, A/H)                                        *
  3308* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3309* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3310*                                                                *
  3311*  RETURNED FROM ELRESV                                          *
  3312*  --------------------                                          *
  3313*  CDT TABLE USED                                                *
  3314*  CDT FACTOR USED                                               *
  3315*  PAY TO CURRENT RESERVE                                        *
  3316*  I.B.N.R. - A/H ONLY                                           *
  3317*  FUTURE (ACCRUED) AH ONLY                                      *
  3318*----------------------------------------------------------------*
  3319*  PASSED TO ELRATE                                              *
  3320*  ----------------                                              *
  3321*  CERT ISSUE DATE                                               *
  3322*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3323*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3324*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3325*  STATE CODE (CLIENT DEFINED)                                   *
  3326*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3327*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3328*  DEVIATION CODE                                                *
  3329*  ISSUE AGE                                                     *
  3330*  ORIGINAL BENEFIT AMOUNT                                       *
  3331*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3332*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3333*  BENEFIT KIND (LIFE OR A/H)                                    *
  3334*  A.P.R.                                                        *
  3335*  METHOD
  3336*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3337*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3338*  COMPANY I.D. (3 CHARACTER)                                    *
  3339*  BENEFIT CODE                                                  *
  3340*  BENEFIT OVERRIDE CODE                                         *
  3341*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3342*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3343*  JOINT INDICATOR (CSL ONLY)                                    *
  3344*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3345*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3346*                                                                *
  3347*  RETURNED FROM ELRATE                                          *
  3348*  --------------------                                          *
  3349*  CALCULATED PREMIUM                                            *
  3350*  PREMIUM RATE                                                  *
  3351*  MORTALITY CODE                                                *
  3352*  MAX ATTAINED AGE                                              *
  3353*  MAX AGE                                                       *
  3354*  MAX TERM                                                      *
  3355*  MAX MONTHLY BENEFIT                                           *
  3356*  MAX TOTAL BENIFIT                                             *
  3357*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3358*----------------------------------------------------------------*
  3359*  PASSED TO ELRFND                                              *
  3360*  ----------------                                              *
  3361*  CERT ISSUE DATE                                               *
  3362*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  64
* EL050.cbl
  3363*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3364*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3365*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3366*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3367*  STATE CODE (CLIENT DEFINED)                                   *
  3368*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3369*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3370*  DEVIATION CODE                                                *
  3371*  ISSUE AGE                                                     *
  3372*  ORIGINAL BENEFIT AMOUNT                                       *
  3373*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3374*  PROCESS TYPE (CANCEL)                                         *
  3375*  BENEFIT KIND (LIFE OR A/H)                                    *
  3376*  A.P.R.                                                        *
  3377*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3378*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3379*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3380*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3381*  COMPANY I.D. (3 CHARACTER)                                    *
  3382*  BENEFIT CODE                                                  *
  3383*  BENEFIT OVERRIDE CODE                                         *
  3384*                                                                *
  3385*  RETURNED FROM ELRFND                                          *
  3386*  --------------------                                          *
  3387*  CALCULATED REFUND                                             *
  3388*----------------------------------------------------------------*
  3389*  PASSED TO ELEARN                                              *
  3390*  ----------------                                              *
  3391*  CERT ISSUE DATE                                               *
  3392*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3393*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3394*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3395*  STATE CODE (CLIENT DEFINED)                                   *
  3396*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3397*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3398*  DEVIATION CODE                                                *
  3399*  ISSUE AGE                                                     *
  3400*  ORIGINAL BENEFIT AMOUNT                                       *
  3401*  BENEFIT KIND (LIFE OR A/H)                                    *
  3402*  A.P.R.                                                        *
  3403*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3404*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3405*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3406*  COMPANY I.D. (3 CHARACTER)                                    *
  3407*  BENEFIT CODE                                                  *
  3408*  BENEFIT OVERRIDE CODE                                         *
  3409*                                                                *
  3410*  RETURNED FROM ELEARN                                          *
  3411*  --------------------                                          *
  3412*  INDICATED  EARNINGS                                           *
  3413*----------------------------------------------------------------*
  3414*                 LENGTH = 450                                   *
  3415*                                                                *
  3416******************************************************************
  3417******************************************************************
  3418*                   C H A N G E   L O G
  3419*
  3420* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  65
* EL050.cbl
  3421*-----------------------------------------------------------------
  3422*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3423* EFFECTIVE    NUMBER
  3424*-----------------------------------------------------------------
  3425* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3426* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3427* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3428* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3429* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3430* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3431* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3432* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3433* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3434******************************************************************
  3435
  3436 01  CALCULATION-PASS-AREA.
  3437     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3438                                     COMP.
  3439
  3440     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3441       88  NO-CP-ERROR                             VALUE ZERO.
  3442       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3443                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3444       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3445       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3446       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3447       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3448       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3449       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3450       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3451       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3452       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3453       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3454       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3455       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3456       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3457       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3458       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3459       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3460       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3461
  3462     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3463       88  NO-CP-ERROR-2                           VALUE ZERO.
  3464***********************  INPUT AREAS ****************************
  3465
  3466     12  CP-CALCULATION-AREA.
  3467         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3468         16  CP-CERT-EFF-DT        PIC XX.
  3469         16  CP-VALUATION-DT       PIC XX.
  3470         16  CP-PAID-THRU-DT       PIC XX.
  3471         16  CP-BENEFIT-TYPE       PIC X.
  3472           88  CP-AH                               VALUE 'A' 'D'
  3473                                                   'I' 'U'.
  3474           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3475           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3476         16  CP-INCURRED-DT        PIC XX.
  3477         16  CP-REPORTED-DT        PIC XX.
  3478         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  66
* EL050.cbl
  3479         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3480         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3481                                     COMP-3.
  3482         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3483                                     COMP-3.
  3484         16  CP-CDT-METHOD         PIC X.
  3485           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3486           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3487           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3488         16  CP-CLAIM-TYPE         PIC X.
  3489           88  CP-AH-CLAIM                         VALUE 'A'.
  3490           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3491         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3492                                     COMP-3.
  3493         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3494                                     COMP-3.
  3495         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3496                                     COMP-3.
  3497         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3498                                     COMP-3.
  3499         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3500                                     COMP-3.
  3501         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3502                                     COMP-3.
  3503         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3504                                     COMP-3.
  3505         16  CP-REM-TERM-METHOD    PIC X.
  3506           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3507           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3508           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3509           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3510           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3511           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3512           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3513         16  CP-EARNING-METHOD     PIC X.
  3514           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3515           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3516           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3517           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3518           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3519           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3520           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3521           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3522           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3523           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3524           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3525           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3526           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3527           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3528         16  CP-PROCESS-TYPE       PIC X.
  3529           88  CP-CLAIM                            VALUE '1'.
  3530           88  CP-CANCEL                           VALUE '2'.
  3531           88  CP-ISSUE                            VALUE '3'.
  3532         16  CP-SPECIAL-CALC-CD    PIC X.
  3533           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3534           88  CP-1-MTH-INTEREST               VALUE ' '.
  3535           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3536           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  67
* EL050.cbl
  3537           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3538           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3539           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3540           88  CP-FARM-PLAN                    VALUE 'F'.
  3541           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3542           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3543           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3544           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3545           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3546           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3547           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3548           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3549           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3550           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3551                                                     'W' 'X'.
  3552           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3553           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3554           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3555           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3556           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3557           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3558           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3559           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3560           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3561           88  CP-CSL-METH-1                   VALUE '5'.
  3562           88  CP-CSL-METH-2                   VALUE '6'.
  3563           88  CP-CSL-METH-3                   VALUE '7'.
  3564           88  CP-CSL-METH-4                   VALUE '8'.
  3565
  3566         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3567                                     COMP-3.
  3568         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3569         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3570         16  CP-STATE              PIC XX          VALUE SPACE.
  3571         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3572         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3573           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3574               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3575         16  CP-R78-OPTION         PIC X.
  3576           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3577           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3578
  3579         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3580         16  CP-IBNR-RESERVE-SW    PIC X.
  3581         16  CP-CLAIM-STATUS       PIC X.
  3582         16  CP-RATE-FILE          PIC X.
  3583         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3584                                     COMP-3.
  3585
  3586         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3587         16  CP-AH-OVERRIDE-CODE   PIC X.
  3588
  3589         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3590                                     COMP-3.
  3591         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3592                                   PIC S9(5)V99 COMP-3.
  3593         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3594                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  68
* EL050.cbl
  3595         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3596                                     COMP-3.
  3597         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3598                                     COMP-3.
  3599         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3600                                  PIC S9(7)V99 COMP-3.
  3601
  3602         16  CP-PAID-FROM-DATE     PIC X(02).
  3603         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3604         16  CP-EXT-DAYS-CALC      PIC X.
  3605           88  CP-EXT-NO-CHG                   VALUE ' '.
  3606           88  CP-EXT-CHG-LF                   VALUE '1'.
  3607           88  CP-EXT-CHG-AH                   VALUE '2'.
  3608           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3609         16  CP-DOMICILE-STATE     PIC XX.
  3610         16  CP-CARRIER            PIC X.
  3611         16  CP-REIN-FLAG          PIC X.
  3612         16  CP-REM-TRM-CALC-OPTION PIC X.
  3613           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3614                      '2' '3' '4' '5'.
  3615           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3616           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3617           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3618           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3619           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3620           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3621           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3622           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3623         16  CP-SIG-SWITCH         PIC X.
  3624         16  CP-RATING-METHOD      PIC X.
  3625           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3626           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3627           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3628           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3629           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3630           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3631           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3632           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3633           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3634         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3635                                     COMP-3.
  3636         16  CP-BEN-CATEGORY       PIC X.
  3637         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3638         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3639                                   PIC S99V9(5) COMP-3.
  3640         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3641         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3642                                   PIC S99V9(5) COMP-3.
  3643         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3644         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3645         16  CP-EXPIRE-DT          PIC XX.
  3646         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3647         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3648         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3649         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3650         16  CP-DDF-SPEC-CALC      PIC X.
  3651             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3652             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  69
* EL050.cbl
  3653         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3654         16  CP-CANCEL-REASON      PIC X.
  3655         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3656         16  CP-PMT-MODE           PIC X.
  3657         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3658         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3659         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3660         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3661         16  FILLER                PIC X.
  3662
  3663***************    OUTPUT FROM ELRESV   ************************
  3664
  3665         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3666
  3667         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3668                                     COMP-3.
  3669         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3670                                     COMP-3.
  3671         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3672                                     COMP-3.
  3673         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3674                                     COMP-3.
  3675         16  FILLER                PIC X(09).
  3676***************    OUTPUT FROM ELRTRM   *************************
  3677
  3678         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3679                                     COMP-3.
  3680         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3681                                     COMP-3.
  3682         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3683                                     COMP-3.
  3684         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3685                                     COMP-3.
  3686         16  FILLER                PIC X(12).
  3687
  3688***************    OUTPUT FROM ELRAMT   *************************
  3689
  3690         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3691                                     COMP-3.
  3692         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3693                                     COMP-3.
  3694         16  FILLER                PIC X(12).
  3695
  3696***************    OUTPUT FROM ELRATE   *************************
  3697
  3698         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3699                                     COMP-3.
  3700         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3701                                     COMP-3.
  3702         16  CP-MORTALITY-CODE     PIC X(4).
  3703         16  CP-RATE-EDIT-FLAG     PIC X.
  3704             88  CP-RATES-NEED-APR                  VALUE '1'.
  3705         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3706                                     COMP-3.
  3707         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3708         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3709         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3710                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  70
* EL050.cbl
  3711         16  FILLER                PIC X(07).
  3712
  3713***************    OUTPUT FROM ELRFND   *************************
  3714
  3715         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3716                                     COMP-3.
  3717         16  CP-REFUND-TYPE-USED   PIC X.
  3718           88  CP-R-AS-R78                         VALUE '1'.
  3719           88  CP-R-AS-PRORATA                     VALUE '2'.
  3720           88  CP-R-AS-CALIF                       VALUE '3'.
  3721           88  CP-R-AS-TEXAS                       VALUE '4'.
  3722           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3723           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3724           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3725           88  CP-R-AS-MEAN                        VALUE '8'.
  3726           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3727           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3728           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3729           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3730           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3731           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3732         16  FILLER                PIC X(12).
  3733
  3734***************    OUTPUT FROM ELEARN   *************************
  3735
  3736         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3737                                     COMP-3.
  3738         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3739                                     COMP-3.
  3740         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3741                                     COMP-3.
  3742         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3743                                     COMP-3.
  3744         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3745                                     COMP-3.
  3746         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3747                                     COMP-3.
  3748         16  CP-EARNING-TYPE-USED  PIC X.
  3749           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3750           88  CP-E-AS-R78                         VALUE '1'.
  3751           88  CP-E-AS-PRORATA                     VALUE '2'.
  3752           88  CP-E-AS-TEXAS                       VALUE '4'.
  3753           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3754           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3755           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3756           88  CP-E-AS-MEAN                        VALUE '8'.
  3757           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3758         16  FILLER                PIC X(12).
  3759
  3760***************    OUTPUT FROM ELPMNT   *************************
  3761
  3762         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3763                                     COMP-3.
  3764         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3765                                     COMP-3.
  3766         16  FILLER                PIC X(12).
  3767
  3768***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  71
* EL050.cbl
  3769         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3770                                     COMP-3.
  3771         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3772                                     COMP-3.
  3773         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3774                                     COMP-3.
  3775         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3776                                     COMP-3.
  3777         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3778                                     COMP-3.
  3779         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3780                                     COMP-3.
  3781         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3782             88  OPEN-RATE-FILE                   VALUE 'O'.
  3783             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3784             88  IO-ERROR                         VALUE 'E'.
  3785
  3786         16  CP-FIRST-PAY-DATE     PIC XX.
  3787
  3788         16  CP-JOINT-INDICATOR    PIC X.
  3789
  3790         16  CP-RESERVE-REMAINING-TERM
  3791                                   PIC S9(4)V9    VALUE ZERO
  3792                                     COMP-3.
  3793
  3794         16  CP-INSURED-BIRTH-DT   PIC XX.
  3795
  3796         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3797                                     COMP-3.
  3798
  3799         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3800                                     COMP-3.
  3801
  3802         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3803                                     COMP-3.
  3804
  3805         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3806                                     COMP-3.
  3807
  3808         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3809                                     COMP-3.
  3810
  3811         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3812                                     COMP-3.
  3813
  3814         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3815                                     COMP-3.
  3816
  3817         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3818             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3819
  3820         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3821                                     COMP-3.
  3822         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3823                                     COMP-3.
  3824         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3825         16  FILLER                PIC X(15).
  3826******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  72
* EL050.cbl
  3828******************************************************************
  3829*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3830*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3831*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3832*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3833*** MODIFICATION.                                              ***
  3834*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3835*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3836******************************************************************
  3837*    COPY ERCPNDB.
  3838******************************************************************
  3839*                                                                *
  3840*                                                                *
  3841*                            ERCPNDB.                            *
  3842*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3843*                            VMOD=2.025                          *
  3844*                                                                *
  3845*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3846*                                                                *
  3847******************************************************************
  3848*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3849*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3850******************************************************************
  3851*                                                                *
  3852*                                                                *
  3853*   FILE TYPE = VSAM,KSDS                                        *
  3854*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3855*                                                                *
  3856*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3857*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3858*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3859*                                                 RKP=13,LEN=36  *
  3860*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3861*                                      AND CHG-SEQ.)             *
  3862*                                                RKP=49,LEN=11   *
  3863*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3864*                                      AND CHG-SEQ.)             *
  3865*                                                RKP=60,LEN=15   *
  3866*                                                                *
  3867*   LOG = NO                                                     *
  3868*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3869******************************************************************
  3870******************************************************************
  3871*                   C H A N G E   L O G
  3872*
  3873* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3874*-----------------------------------------------------------------
  3875*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3876* EFFECTIVE    NUMBER
  3877*-----------------------------------------------------------------
  3878* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3879* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3880* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3881* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3882* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3883* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3884* 032306                   PEMA  ADD BOW LOAN NUMBER
  3885* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  73
* EL050.cbl
  3886* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3887* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3888* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3889* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3890* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3891* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3892* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3893******************************************************************
  3894
  3895 01  PENDING-BUSINESS.
  3896     12  PB-RECORD-ID                     PIC XX.
  3897         88  VALID-PB-ID                        VALUE 'PB'.
  3898
  3899     12  PB-CONTROL-PRIMARY.
  3900         16  PB-COMPANY-CD                PIC X.
  3901         16  PB-ENTRY-BATCH               PIC X(6).
  3902         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3903         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3904
  3905     12  PB-CONTROL-BY-ACCOUNT.
  3906         16  PB-COMPANY-CD-A1             PIC X.
  3907         16  PB-CARRIER                   PIC X.
  3908         16  PB-GROUPING.
  3909             20  PB-GROUPING-PREFIX       PIC XXX.
  3910             20  PB-GROUPING-PRIME        PIC XXX.
  3911         16  PB-STATE                     PIC XX.
  3912         16  PB-ACCOUNT.
  3913             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3914             20  PB-ACCOUNT-PRIME         PIC X(6).
  3915         16  PB-CERT-EFF-DT               PIC XX.
  3916         16  PB-CERT-NO.
  3917             20  PB-CERT-PRIME            PIC X(10).
  3918             20  PB-CERT-SFX              PIC X.
  3919         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3920
  3921         16  PB-RECORD-TYPE               PIC X.
  3922             88  PB-MAILING-DATA                VALUE '0'.
  3923             88  PB-ISSUE                       VALUE '1'.
  3924             88  PB-CANCELLATION                VALUE '2'.
  3925             88  PB-BATCH-TRAILER               VALUE '9'.
  3926
  3927     12  PB-CONTROL-BY-ORIG-BATCH.
  3928         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3929         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3930         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3931         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3932
  3933     12  PB-CONTROL-BY-CSR.
  3934         16  PB-CSR-COMPANY-CD            PIC X.
  3935         16  PB-CSR-ID                    PIC X(4).
  3936         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3937         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3938         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3939******************************************************************
  3940*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3941******************************************************************
  3942
  3943     12  PB-LAST-MAINT-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  74
* EL050.cbl
  3944     12  PB-LAST-MAINT-BY                 PIC X(4).
  3945     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3946
  3947     12  PB-RECORD-BODY                   PIC X(375).
  3948
  3949     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3950         16  PB-CERT-ORIGIN               PIC X.
  3951             88  CLASIC-CREATED-CERT         VALUE '1'.
  3952         16  PB-I-NAME.
  3953             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3954             20  PB-I-INSURED-FIRST-NAME.
  3955                 24  PB-I-INSURED-1ST-INIT PIC X.
  3956                 24  FILLER                PIC X(9).
  3957             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3958         16  PB-I-AGE                     PIC S99   COMP-3.
  3959         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3960         16  PB-I-BIRTHDAY                PIC XX.
  3961         16  PB-I-INSURED-SEX             PIC X.
  3962             88  PB-SEX-MALE     VALUE 'M'.
  3963             88  PB-SEX-FEMALE   VALUE 'F'.
  3964
  3965         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3966         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3967         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  3968         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  3969         16  PB-I-SKIP-CODE               PIC X.
  3970             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  3971             88  PB-SKIP-JULY              VALUE '1'.
  3972             88  PB-SKIP-AUGUST            VALUE '2'.
  3973             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  3974             88  PB-SKIP-JULY-AUG          VALUE '4'.
  3975             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  3976             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  3977             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  3978             88  PB-SKIP-JUNE              VALUE '8'.
  3979             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  3980             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  3981             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  3982         16  PB-I-TERM-TYPE               PIC X.
  3983             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  3984             88  PB-PAID-WEEKLY            VALUE 'W'.
  3985             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  3986             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  3987             88  PB-PAID-13-YEARLY         VALUE 'T'.
  3988         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  3989         16  PB-I-POLICY-FORM-NO          PIC X(12).
  3990         16  PB-I-DATA-ENTRY-SW           PIC X.
  3991             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  3992             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  3993             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  3994             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  3995         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  3996         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  3997*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  3998         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  3999         16  FILLER                       PIC X.
  4000
  4001         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  75
* EL050.cbl
  4002             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4003             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4004                                                   '90' THRU '99'.
  4005         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4006                                          PIC XX.
  4007         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4008         16  PB-I-AMOUNT-FINANCED REDEFINES
  4009                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4010         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4011         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4012                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4013         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4014         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4015         16  PB-I-CLP-AMOUNT REDEFINES
  4016                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4017         16  PB-I-LF-CALC-FLAG            PIC X.
  4018             88 PB-COMP-LF-PREM               VALUE '?'.
  4019         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4020         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4021         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4022         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4023         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4024         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4025         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4026         16  PB-I-LF-ABBR                 PIC XXX.
  4027         16  PB-I-LF-INPUT-CD             PIC XX.
  4028
  4029         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4030             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4031             88  PB-INVALID-AH               VALUE '  ' '00'
  4032                                                   '90' THRU '99'.
  4033         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4034         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4035         16  PB-I-AH-CALC-FLAG            PIC X.
  4036             88 PB-COMP-AH-PREM                  VALUE '?'.
  4037         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4038         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4039         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4040         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4041         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4042         16  PB-I-AH-ABBR                 PIC XXX.
  4043         16  PB-I-AH-INPUT-CD             PIC XXX.
  4044
  4045         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4046         16  PB-I-REIN-TABLE              PIC XXX.
  4047         16  PB-I-BUSINESS-TYPE           PIC 99.
  4048         16  PB-I-INDV-GRP-CD             PIC X.
  4049         16  PB-I-MORT-CODE.
  4050             20  PB-I-TABLE               PIC X.
  4051             20  PB-I-INTEREST            PIC XX.
  4052             20  PB-I-MORT-TYP            PIC X.
  4053         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4054         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4055         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4056         16  PB-I-INDV-GRP-OVRD           PIC X.
  4057         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4058         16  PB-I-SIG-SW                  PIC X.
  4059             88  PB-POLICY-SIGNED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  76
* EL050.cbl
  4060         16  PB-I-RATE-CLASS              PIC XX.
  4061         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4062         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4063         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4064         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4065         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4066         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4067         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4068         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4069         16  PB-I-OB-FLAG                 PIC X.
  4070             88  PB-I-OB                      VALUE 'B'.
  4071             88  PB-I-SUMMARY                 VALUE 'Z'.
  4072         16  PB-I-ENTRY-STATUS            PIC X.
  4073             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4074                                              'M' '5' '9' '2'.
  4075             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4076             88  PB-I-POLICY-PENDING          VALUE '2'.
  4077             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4078             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4079             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4080             88  PB-I-REIN-ONLY               VALUE '9'.
  4081             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4082             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4083             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4084             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4085         16  PB-I-INT-CODE                PIC X.
  4086             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4087             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4088         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4089         16  PB-I-SOC-SEC-NO              PIC X(11).
  4090         16  PB-I-MEMBER-NO               PIC X(12).
  4091         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4092*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4093         16  PB-I-OLD-LOF                 PIC XXX.
  4094         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4095         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4096         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4097         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4098         16  PB-I-LIFE-INDICATOR          PIC X.
  4099             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4100         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4101         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4102                                          PIC S9(5)V99    COMP-3.
  4103         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4104             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4105             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4106         16  PB-I-1ST-PMT-DT              PIC XX.
  4107         16  PB-I-JOINT-INSURED.
  4108             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4109             20 PB-I-JOINT-FIRST-NAME.
  4110                24  PB-I-JOINT-FIRST-INIT PIC X.
  4111                24  FILLER                PIC X(9).
  4112             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4113*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4114         16  PB-I-BENEFICIARY-NAME.
  4115             20  PB-I-BANK-NUMBER         PIC X(10).
  4116             20  FILLER                   PIC X(15).
  4117         16  PB-I-LAST-ADD-ON-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  77
* EL050.cbl
  4118         16  PB-I-REFERENCE               PIC X(12).
  4119         16  FILLER REDEFINES PB-I-REFERENCE.
  4120             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4121             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4122             20  PB-I-CLP-STATE           PIC XX.
  4123         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4124             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4125             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4126             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4127         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4128         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4129         16  PB-I-RESIDENT-STATE          PIC XX.
  4130         16  PB-I-RATE-CODE               PIC X(4).
  4131         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4132         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4133         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4134         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4135         16  PB-I-BANK-NOCHRGB            PIC 99.
  4136         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4137         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4138
  4139     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4140         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4141             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4142         16  PB-C-CANCEL-ORIGIN           PIC X.
  4143             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4144         16  PB-C-LF-CANCEL-DT            PIC XX.
  4145         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4146         16  PB-C-LF-CALC-REQ             PIC X.
  4147             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4148         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4149         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4150         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4151             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4152         16  PB-C-AH-CANCEL-DT            PIC XX.
  4153         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4154         16  PB-C-AH-CALC-REQ             PIC X.
  4155             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4156         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4157         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4158         16  PB-C-LAST-NAME               PIC X(15).
  4159         16  PB-C-REFUND-SW               PIC X.
  4160             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4161             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4162         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4163         16  PB-C-PAYEE-CODE              PIC X(6).
  4164         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4165         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4166         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4167         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4168         16  PB-C-REFERENCE               PIC X(12).
  4169         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4170         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4171         16  PB-C-POST-CARD-IND           PIC X.
  4172         16  PB-C-CANCEL-REASON           PIC X.
  4173         16  PB-C-REF-INTERFACE-SW        PIC X.
  4174         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4175         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  78
* EL050.cbl
  4176         16  FILLER                       PIC X(01).
  4177*        16  FILLER                       PIC X(18).
  4178         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4179*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4180         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4181         16  PB-CANCELED-CERT-DATA.
  4182             20  PB-CI-INSURED-NAME.
  4183                 24  PB-CI-LAST-NAME      PIC X(15).
  4184                 24  PB-CI-INITIALS       PIC XX.
  4185             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4186             20  PB-CI-INSURED-SEX        PIC X.
  4187             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4188             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4189             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4190             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4191             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4192             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4193             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4194             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4195             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4196             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4197             20  PB-CI-RATE-CLASS         PIC XX.
  4198             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4199             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4200             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4201             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4202             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4203             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4204             20  PB-CI-LF-ABBR            PIC X(3).
  4205             20  PB-CI-AH-ABBR            PIC X(3).
  4206             20  PB-CI-OB-FLAG            PIC X.
  4207                 88  PB-CI-OB                VALUE 'B'.
  4208             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4209                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4210                                           'M' '4' '5' '9' '2'.
  4211                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4212                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4213                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4214                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4215                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4216                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4217                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4218                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4219                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4220                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4221                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4222                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4223             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4224                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4225                                           'M' '4' '5' '9' '2'.
  4226                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4227                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4228                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4229                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4230                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4231                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4232                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4233                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  79
* EL050.cbl
  4234                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4235                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4236                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4237                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4238             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4239             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4240             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4241             20  PB-CI-MEMBER-NO          PIC X(12).
  4242             20  PB-CI-INT-CODE           PIC X.
  4243                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4244                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4245             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4246             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4247             20  PB-CI-COMP-EXCP-SW       PIC X.
  4248                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4249                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4250             20  PB-CI-ENTRY-STATUS       PIC X.
  4251             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4252             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4253             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4254             20  PB-CI-DEATH-DT           PIC XX.
  4255             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4256             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4257             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4258             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4259             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4260             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4261             20  PB-CI-ENTRY-DT              PIC XX.
  4262             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4263             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4264             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4265             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4266             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4267             20  PB-CI-OLD-LOF               PIC XXX.
  4268*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4269             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4270             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4271             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4272             20  PB-CI-INDV-GRP-CD           PIC X.
  4273             20  PB-CI-BENEFICIARY-NAME.
  4274                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4275                 24  FILLER                  PIC X(15).
  4276             20  PB-CI-NOTE-SW               PIC X.
  4277             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4278             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4279             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4280             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4281             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4282             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4283             20  PB-CI-FIRST-NAME            PIC X(10).
  4284             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4285
  4286         16  FILLER                       PIC X(13).
  4287*032306  16  FILLER                       PIC X(27).
  4288*        16  FILLER                       PIC X(46).
  4289
  4290     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4291         16  FILLER                       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  80
* EL050.cbl
  4292         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4293         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4294         16  PB-M-INSURED-MID-INIT        PIC X.
  4295         16  PB-M-INSURED-AGE             PIC 99.
  4296         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4297         16  PB-M-INSURED-SEX             PIC X.
  4298         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4299         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4300         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4301         16  PB-M-INSURED-CITY-STATE.
  4302             20  PB-M-INSURED-CITY        PIC X(28).
  4303             20  PB-M-INSURED-STATE       PIC XX.
  4304         16  PB-M-INSURED-ZIP-CODE.
  4305             20  PB-M-INSURED-ZIP-PRIME.
  4306                 24  PB-M-INSURED-ZIP-1   PIC X.
  4307                     88  PB-M-CANADIAN-POST-CODE
  4308                                             VALUE 'A' THRU 'Z'.
  4309                 24  FILLER               PIC X(4).
  4310             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4311         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4312                                        PB-M-INSURED-ZIP-CODE.
  4313             20  PM-M-INS-CAN-POST1       PIC XXX.
  4314             20  PM-M-INS-CAN-POST2       PIC XXX.
  4315             20  FILLER                   PIC XXX.
  4316         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4317         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4318         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4319         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4320         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4321         16  PB-M-CRED-BENE-CITYST.
  4322             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4323             20  PB-M-CRED-BENE-STATE     PIC XX.
  4324         16  FILLER                       PIC X(92).
  4325
  4326     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4327         16  FILLER                       PIC X(10).
  4328         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4329         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4330         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4331         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4332         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4333         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4334         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4335         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4336         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4337         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4338         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4339         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4340         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4341         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4342         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4343         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4344         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4345         16  PB-ACCOUNT-NAME              PIC X(30).
  4346         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4347         16  PB-REFERENCE                 PIC X(12).
  4348         16  PB-B-RECEIVED-DT             PIC XX.
  4349         16  FILLER                       PIC X(234).
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  81
* EL050.cbl
  4350
  4351     12  PB-RECORD-STATUS.
  4352         16  PB-CREDIT-SELECT-DT          PIC XX.
  4353         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4354         16  PB-BILLED-DT                 PIC XX.
  4355         16  PB-BILLING-STATUS            PIC X.
  4356             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4357             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4358             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4359         16  PB-RECORD-BILL               PIC X.
  4360             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4361             88  PB-RECORD-RETURNED           VALUE 'R'.
  4362             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4363             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4364             88  PB-OVERRIDE-AH               VALUE 'A'.
  4365             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4366         16  PB-BATCH-ENTRY               PIC X.
  4367             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4368             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4369             88  PB-REISSUED-CERT             VALUE 'E'.
  4370             88  PB-MONTHLY-CERT              VALUE 'M'.
  4371             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4372             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4373             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4374         16  PB-FORCE-CODE                PIC X.
  4375             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4376             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4377             88  PB-CANCEL-FORCE              VALUE '8'.
  4378             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4379             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4380             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4381             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4382             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4383             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4384             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4385         16  PB-FATAL-FLAG                PIC X.
  4386             88  PB-FATAL-ERRORS              VALUE 'X'.
  4387         16  PB-FORCE-ER-CD               PIC X.
  4388             88  PB-FORCE-ERRORS              VALUE 'F'.
  4389             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4390         16  PB-WARN-ER-CD                PIC X.
  4391             88  PB-WARNING-ERRORS            VALUE 'W'.
  4392         16  FILLER                       PIC X.
  4393         16  PB-OUT-BAL-CD                PIC X.
  4394             88  PB-OUT-OF-BAL                VALUE 'O'.
  4395         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4396         16  PB-AH-OVERRIDE-L1            PIC X.
  4397         16  PB-INPUT-DT                  PIC XX.
  4398         16  PB-INPUT-BY                  PIC X(4).
  4399         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4400         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4401         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4402         16  PB-LF-EARNING-METHOD         PIC X.
  4403         16  PB-AH-EARNING-METHOD         PIC X.
  4404         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4405         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4406         16  PB-REIN-CD                   PIC XXX.
  4407         16  PB-LF-REFUND-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  82
* EL050.cbl
  4408         16  PB-AH-REFUND-TYPE            PIC X.
  4409         16  PB-ACCT-EFF-DT               PIC XX.
  4410         16  PB-ACCT-EXP-DT               PIC XX.
  4411         16  PB-COMPANY-ID                PIC X(3).
  4412         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4413         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4414         16  PB-SV-CARRIER                PIC X.
  4415         16  PB-SV-GROUPING               PIC X(6).
  4416         16  PB-SV-STATE                  PIC XX.
  4417         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4418         16  PB-GA-BILLING-INFO.
  4419             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4420                                          PIC XX.
  4421         16  PB-SV-REMIT-TO  REDEFINES
  4422             PB-GA-BILLING-INFO           PIC X(10).
  4423         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4424         16  PB-I-LOAN-OFFICER            PIC X(5).
  4425         16  PB-I-VIN                     PIC X(17).
  4426
  4427         16  FILLER                       PIC X(04).
  4428         16  IMNET-BYPASS-SW              PIC X.
  4429
  4430******************************************************************
  4431*                COMMON EDIT ERRORS                              *
  4432******************************************************************
  4433
  4434     12  PB-COMMON-ERRORS.
  4435         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4436                                           PIC S9(4)     COMP.
  4437
  4438******************************************************************
  4439
  4440* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4441*    COPY ELC50W1.
  4442******************************************************************
  4443*                                                                *
  4444*                                                                *
  4445*                             ELC50W1                            *
  4446*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4447*                            VMOD=2.004                          *
  4448*                                                                *
  4449*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4450*                                                                *
  4451*                                                                *
  4452******************************************************************
  4453
  4454     12  WK-WORK-AREA.
  4455         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4456         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4457         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4458         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4459         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4460         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4461         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4462         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4463         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4464         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4465         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  83
* EL050.cbl
  4466         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4467         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4468         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4469         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4470         16  WK-CREDIT-EDIT-CONTROLS.
  4471             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4472             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4473             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4474             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4475             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4476             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4477         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4478         16  WK-SAVE-REIN-DATA.
  4479             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4480             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4481             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4482         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4483             88  ENTRY-FROM-EL6311       VALUE '6'.
  4484         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4485         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4486     12  WK-RECORD-ADDRESSES.
  4487         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4488         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4489         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4490         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4491         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4492         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4493         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4494         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4495     12  WK-OVER-SHORT-AREA.
  4496         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4497         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4498         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4499             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4500         16  FILLER                   PIC X(5) VALUE SPACES.
  4501
  4502*    COPY ELCEDITC.
  4503******************************************************************
  4504*                                                                *
  4505*                                                                *
  4506*                            ELCEDITC                            *
  4507*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4508*                            VMOD=2.012                          *
  4509*                                                                *
  4510*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4511*                     EL6313, EL050 AND EL517.                   *
  4512*                                                                *
  4513******************************************************************
  4514******************************************************************
  4515*                   C H A N G E   L O G
  4516*
  4517* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4518*-----------------------------------------------------------------
  4519*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4520* EFFECTIVE    NUMBER
  4521*-----------------------------------------------------------------
  4522* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4523******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  84
* EL050.cbl
  4524
  4525     12  EDIT-CRITERIA-DATA.
  4526         16  EC-CO-MONTH-END-DT       PIC XX.
  4527         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4528         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4529         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4530         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4531         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4532         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4533         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4534         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4535         16  EC-CO-REM-TERM-CALC      PIC X.
  4536               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4537               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4538               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4539               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4540
  4541         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4542               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4543               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4544               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4545               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4546               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4547               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4548               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4549               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4550               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4551               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4552
  4553         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4554               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4555               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4556               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4557               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4558               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4559               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4560               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4561               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4562
  4563         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4564                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4565                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4566
  4567         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4568                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4569                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4570                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4571                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4572                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4573                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4574                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4575                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4576
  4577         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4578               88  EC-BR-REDUCING                   VALUE 'R'.
  4579               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4580
  4581         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  85
* EL050.cbl
  4582         16  EC-BR-LF-DESC             PIC X(10).
  4583         16  EC-BR-AH-DESC             PIC X(10).
  4584         16  EC-BR-LF-COMMENT          PIC X(10).
  4585         16  EC-BR-AH-COMMENT          PIC X(10).
  4586
  4587         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4588               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4589               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4590               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4591               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4592
  4593         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4594               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4595               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4596               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4597               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4598
  4599         16  EC-BR-LF-REFUND-CALC      PIC X.
  4600                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4601                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4602                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4603                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4604                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4605                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4606                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4607
  4608         16  EC-BR-AH-REFUND-CALC      PIC X.
  4609                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4610                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4611                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4612                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4613                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4614                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4615                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4616                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4617
  4618         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4619                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4620                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4621                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4622
  4623         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4624                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4625                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4626                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4627
  4628         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4629         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4630         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4631         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4632
  4633         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4634         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4635                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4636                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4637                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4638                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4639
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  86
* EL050.cbl
  4640         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4641               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4642               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4643               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4644               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4645               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4646
  4647         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4648               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4649               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4650               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4651               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4652               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4653
  4654         16  EC-ST-LF-REFUND-CALC      PIC X.
  4655                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4656                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4657                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4658                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4659                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4660                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4661                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4662                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4663
  4664         16  EC-ST-AH-REFUND-CALC      PIC X.
  4665                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4666                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4667                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4668                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4669                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4670                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4671                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4672                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4673
  4674         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4675         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4676         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4677         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4678         16  EC-AM-EXPIRATION-DT       PIC XX.
  4679         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4680         16  EC-AM-CLASS-CD            PIC XX.
  4681         16  EC-AM-LF-DEVIATION        PIC XXX.
  4682         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4683         16  EC-AM-AH-DEVIATION        PIC XXX.
  4684         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4685         16  EC-AM-PHONE-NO            PIC X(10).
  4686
  4687         16  EC-AM-LF-REFUND-CALC      PIC X.
  4688                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4689                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4690                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4691                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4692                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4693                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4694                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4695
  4696         16  EC-AM-AH-REFUND-CALC      PIC X.
  4697                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  87
* EL050.cbl
  4698                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4699                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4700                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4701                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4702                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4703                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4704
  4705         16  EC-AM-BEN-I-G-CD          PIC X.
  4706                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4707                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4708                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4709
  4710         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4711         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4712         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4713         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4714         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4715         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4716         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4717         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4718         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4719
  4720         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4721         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4722         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4723         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4724         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4725         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4726         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4727         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4728         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4729         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4730         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4731         16  EC-RT-LF-NSP-ST           PIC XX.
  4732         16  EC-RT-AH-NSP-ST           PIC XX.
  4733         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4734         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4735
  4736         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4737             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4738                                             'M' '5' '9' '2'.
  4739             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4740             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4741             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4742             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4743             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4744             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4745             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4746             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4747             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4748             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4749
  4750         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4751             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4752                                             'M' '5' '9' '2'.
  4753             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4754             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4755             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  88
* EL050.cbl
  4756             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4757             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4758             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4759             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4760             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4761             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4762             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4763
  4764         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4765         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4766         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4767         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4768         16  EC-CM-DEATH-DT            PIC XX.
  4769
  4770*DMD CUSTOM CODING FIELDS BELOW
  4771*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4772         16  EC-BR-DMD-RATING-SW       PIC X.
  4773                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4774                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4775                 88  NO-DMD-RATING               VALUE 'N'.
  4776
  4777         16  EC-NEW-CERT               PIC X(11).
  4778         16  EC-NEW-STATE              PIC XX.
  4779         16  FILLER                    PIC X.
  4780*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4781         16  OVER-SHORT-EDIT-FIELDS.
  4782             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4783             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4784             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4785             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4786             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4787             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4788             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4789             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4790             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4791         16  FILLER                    PIC X(71).
  4792******************************************************************
  4793
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  89
* EL050.cbl
  4795*    COPY ELCDIFRD.
  4796******************************************************************
  4797*                                                                *
  4798*                                                                *
  4799*                            ELCDIFRD.                           *
  4800*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4801*                            VMOD=2.004                          *
  4802*                                                                *
  4803*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4804*                                                                *
  4805******************************************************************
  4806*
  4807  01  WS-DIFFERENCE-CALCULATION.
  4808        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4809        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4810        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4811        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4812        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4813        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4814        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4815        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4816        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4817        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4818        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4819
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  90
* EL050.cbl
  4821****************************************************************
  4822*
  4823* Copyright (c) 2007 by Clerity Solutions, Inc.
  4824* All rights reserved.
  4825*
  4826****************************************************************
  4827 01  DFHEIV.
  4828   02  DFHEIV0               PIC X(35).
  4829   02  DFHEIV1               PIC X(08).
  4830   02  DFHEIV2               PIC X(08).
  4831   02  DFHEIV3               PIC X(08).
  4832   02  DFHEIV4               PIC X(06).
  4833   02  DFHEIV5               PIC X(04).
  4834   02  DFHEIV6               PIC X(04).
  4835   02  DFHEIV7               PIC X(02).
  4836   02  DFHEIV8               PIC X(02).
  4837   02  DFHEIV9               PIC X(01).
  4838   02  DFHEIV10              PIC S9(7) COMP-3.
  4839   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4840   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4841   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4842   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4843   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4844   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4845   02  DFHEIV17              PIC X(04).
  4846   02  DFHEIV18              PIC X(04).
  4847   02  DFHEIV19              PIC X(04).
  4848   02  DFHEIV20              USAGE IS POINTER.
  4849   02  DFHEIV21              USAGE IS POINTER.
  4850   02  DFHEIV22              USAGE IS POINTER.
  4851   02  DFHEIV23              USAGE IS POINTER.
  4852   02  DFHEIV24              USAGE IS POINTER.
  4853   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4854   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4855   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4856   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4857   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4858   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4859   02  FILLER                PIC X(02).
  4860   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4861   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4862   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4863   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4864   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4865 LINKAGE  SECTION.
  4866*****************************************************************
  4867*                                                               *
  4868* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4869* All rights reserved.                                          *
  4870*                                                               *
  4871*****************************************************************
  4872 01  dfheiblk.
  4873     02  eibtime          pic s9(7) comp-3.
  4874     02  eibdate          pic s9(7) comp-3.
  4875     02  eibtrnid         pic x(4).
  4876     02  eibtaskn         pic s9(7) comp-3.
  4877     02  eibtrmid         pic x(4).
  4878     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  91
* EL050.cbl
  4879     02  eibcposn         pic s9(4) comp.
  4880     02  eibcalen         pic s9(4) comp.
  4881     02  eibaid           pic x(1).
  4882     02  eibfiller1       pic x(1).
  4883     02  eibfn            pic x(2).
  4884     02  eibfiller2       pic x(2).
  4885     02  eibrcode         pic x(6).
  4886     02  eibfiller3       pic x(2).
  4887     02  eibds            pic x(8).
  4888     02  eibreqid         pic x(8).
  4889     02  eibrsrce         pic x(8).
  4890     02  eibsync          pic x(1).
  4891     02  eibfree          pic x(1).
  4892     02  eibrecv          pic x(1).
  4893     02  eibsend          pic x(1).
  4894     02  eibatt           pic x(1).
  4895     02  eibeoc           pic x(1).
  4896     02  eibfmh           pic x(1).
  4897     02  eibcompl         pic x(1).
  4898     02  eibsig           pic x(1).
  4899     02  eibconf          pic x(1).
  4900     02  eiberr           pic x(1).
  4901     02  eibrldbk         pic x(1).
  4902     02  eiberrcd         pic x(4).
  4903     02  eibsynrb         pic x(1).
  4904     02  eibnodat         pic x(1).
  4905     02  eibfiller5       pic x(2).
  4906     02  eibresp          pic 9(09) comp.
  4907     02  eibresp2         pic 9(09) comp.
  4908     02  dfheigdj         pic s9(4) comp.
  4909     02  dfheigdk         pic s9(4) comp.
  4910
  4911 01  DFHCOMMAREA                   PIC X(1036).
  4912
  4913*01 PARMLIST .
  4914*    02  FILLER                    PIC S9(8)   COMP.
  4915*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  4916*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  4917*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  4918*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  4919*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  4920*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  4921*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  4922
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  92
* EL050.cbl
  4924*    COPY ELCCNTL.
  4925******************************************************************
  4926*                                                                *
  4927*                                                                *
  4928*                            ELCCNTL.                            *
  4929*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4930*                            VMOD=2.059                          *
  4931*                                                                *
  4932*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4933*                                                                *
  4934*   FILE TYPE = VSAM,KSDS                                        *
  4935*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4936*                                                                *
  4937*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4938*       ALTERNATE INDEX = NONE                                   *
  4939*                                                                *
  4940*   LOG = YES                                                    *
  4941*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4942******************************************************************
  4943*                   C H A N G E   L O G
  4944*
  4945* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4946*-----------------------------------------------------------------
  4947*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4948* EFFECTIVE    NUMBER
  4949*-----------------------------------------------------------------
  4950* 082503                   PEMA  ADD BENEFIT GROUP
  4951* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4952* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4953* 092705    2005050300006  PEMA  ADD SPP LEASES
  4954* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4955* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4956* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4957* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4958* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4959* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4960* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4961* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4962* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4963******************************************************************
  4964*
  4965 01  CONTROL-FILE.
  4966     12  CF-RECORD-ID                       PIC XX.
  4967         88  VALID-CF-ID                        VALUE 'CF'.
  4968
  4969     12  CF-CONTROL-PRIMARY.
  4970         16  CF-COMPANY-ID                  PIC XXX.
  4971         16  CF-RECORD-TYPE                 PIC X.
  4972             88  CF-COMPANY-MASTER              VALUE '1'.
  4973             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4974             88  CF-STATE-MASTER                VALUE '3'.
  4975             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4976             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4977             88  CF-CARRIER-MASTER              VALUE '6'.
  4978             88  CF-MORTALITY-MASTER            VALUE '7'.
  4979             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4980             88  CF-TERMINAL-MASTER             VALUE '9'.
  4981             88  CF-AH-EDIT-MASTER              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  93
* EL050.cbl
  4982             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4983             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4984             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4985             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4986             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4987             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4988             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4989             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4990         16  CF-ACCESS-CD-GENL              PIC X(4).
  4991         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4992             20  CF-PROCESSOR               PIC X(4).
  4993         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4994             20  CF-STATE-CODE              PIC XX.
  4995             20  FILLER                     PIC XX.
  4996         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4997             20  FILLER                     PIC XX.
  4998             20  CF-HI-BEN-IN-REC           PIC XX.
  4999         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5000             20  FILLER                     PIC XXX.
  5001             20  CF-CARRIER-CNTL            PIC X.
  5002         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5003             20  FILLER                     PIC XX.
  5004             20  CF-HI-TYPE-IN-REC          PIC 99.
  5005         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5006             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5007                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5008             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5009             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5010         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5011             20  FILLER                     PIC X.
  5012             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5013         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5014             20  FILLER                     PIC XX.
  5015             20  CF-MORTGAGE-PLAN           PIC XX.
  5016         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5017
  5018     12  CF-LAST-MAINT-DT                   PIC XX.
  5019     12  CF-LAST-MAINT-BY                   PIC X(4).
  5020     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5021
  5022     12  CF-RECORD-BODY                     PIC X(728).
  5023
  5024
  5025****************************************************************
  5026*             COMPANY MASTER RECORD                            *
  5027****************************************************************
  5028
  5029     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5030         16  CF-COMPANY-ADDRESS.
  5031             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5032             20  CF-CL-IN-CARE-OF           PIC X(30).
  5033             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5034             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5035             20  CF-CL-CITY-STATE           PIC X(30).
  5036             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5037             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5038         16  CF-COMPANY-CD                  PIC X.
  5039         16  CF-COMPANY-PASSWORD            PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  94
* EL050.cbl
  5040         16  CF-SECURITY-OPTION             PIC X.
  5041             88  ALL-SECURITY                   VALUE '1'.
  5042             88  COMPANY-VERIFY                 VALUE '2'.
  5043             88  PROCESSOR-VERIFY               VALUE '3'.
  5044             88  NO-SECURITY                    VALUE '4'.
  5045             88  ALL-BUT-TERM                   VALUE '5'.
  5046         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5047             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5048         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5049             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5050         16  CF-INFORCE-LOCATION            PIC X.
  5051             88  CERTS-ARE-ONLINE               VALUE '1'.
  5052             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5053             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5054         16  CF-LOWER-CASE-LETTERS          PIC X.
  5055         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5056             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5057             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5058             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5059             88  CF-ACCNT-CNTL                  VALUE '3'.
  5060             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5061
  5062         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5063         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5064
  5065         16  CF-LGX-CREDIT-USER             PIC X.
  5066             88  CO-IS-NOT-USER                 VALUE 'N'.
  5067             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5068
  5069         16 CF-CREDIT-CALC-CODES.
  5070             20  CF-CR-REM-TERM-CALC PIC X.
  5071               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5072               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5073               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5074               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5075               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5076               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5077               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5078             20  CF-CR-R78-METHOD           PIC X.
  5079               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5080               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5081
  5082         16  CF-CLAIM-CONTROL-COUNTS.
  5083             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5084                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5085
  5086             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5087                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5088
  5089             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5090                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5091
  5092             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5093                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5094
  5095         16  CF-CURRENT-MONTH-END           PIC XX.
  5096
  5097         16  CF-CO-CALC-QUOTE-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  95
* EL050.cbl
  5098             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5099             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5100             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5101             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5102                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5103                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5104             20  CF-CO-PREM-REJECT-SW       PIC X.
  5105                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5106                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5107             20  CF-CO-REF-REJECT-SW        PIC X.
  5108                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5109                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5110
  5111         16  CF-CO-REPORTING-DT             PIC XX.
  5112         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5113         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5114           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5115           88  CF-CO-MONTH-END                  VALUE '1'.
  5116
  5117         16  CF-LGX-CLAIM-USER              PIC X.
  5118             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5119             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5120
  5121         16  CF-CREDIT-EDIT-CONTROLS.
  5122             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5123             20  CF-MIN-AGE                 PIC 99.
  5124             20  CF-DEFAULT-AGE             PIC 99.
  5125             20  CF-MIN-TERM                PIC S999      COMP-3.
  5126             20  CF-MAX-TERM                PIC S999      COMP-3.
  5127             20  CF-DEFAULT-SEX             PIC X.
  5128             20  CF-JOINT-AGE-INPUT         PIC X.
  5129                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5130             20  CF-BIRTH-DATE-INPUT        PIC X.
  5131                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5132             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5133                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5134                 88  CF-ZERO-CARRIER            VALUE '1'.
  5135                 88  CF-ZERO-GROUPING           VALUE '2'.
  5136                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5137             20  CF-EDIT-SW                 PIC X.
  5138                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5139             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5140             20  CF-CR-PR-METHOD            PIC X.
  5141               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5142               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5143             20  FILLER                     PIC X.
  5144
  5145         16  CF-CREDIT-MISC-CONTROLS.
  5146             20  CF-REIN-TABLE-SW           PIC X.
  5147                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5148             20  CF-COMP-TABLE-SW           PIC X.
  5149                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5150             20  CF-EXPERIENCE-RETENTION-AGE
  5151                                            PIC S9        COMP-3.
  5152             20  CF-CONVERSION-DT           PIC XX.
  5153             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5154             20  CF-RUN-FREQUENCY-SW        PIC X.
  5155                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  96
* EL050.cbl
  5156                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5157
  5158             20  CF-CR-CHECK-NO-CONTROL.
  5159                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5160                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5161                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5162                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5163                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5164                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5165
  5166                 24  CF-CR-CHECK-COUNT       REDEFINES
  5167                     CF-CR-CHECK-COUNTER      PIC X(4).
  5168
  5169                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5170                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5171
  5172                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5173                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5174                 24  CF-MAIL-PROCESSING       PIC X.
  5175                     88  MAIL-PROCESSING          VALUE 'Y'.
  5176
  5177         16  CF-MISC-SYSTEM-CONTROL.
  5178             20  CF-SYSTEM-C                 PIC X.
  5179                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5180             20  CF-SYSTEM-D                 PIC X.
  5181                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5182             20  CF-SOC-SEC-NO-SW            PIC X.
  5183                 88  SOC-SEC-NO-USED             VALUE '1'.
  5184             20  CF-MEMBER-NO-SW             PIC X.
  5185                 88  MEMBER-NO-USED              VALUE '1'.
  5186             20  CF-TAX-ID-NUMBER            PIC X(11).
  5187             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5188             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5189                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5190                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5191                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5192                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5193             20  CF-SYSTEM-E                 PIC X.
  5194                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5195
  5196         16  CF-LGX-LIFE-USER               PIC X.
  5197             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5198             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5199
  5200         16  CF-CR-MONTH-END-DT             PIC XX.
  5201
  5202         16  CF-FILE-MAINT-DATES.
  5203             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5204                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5205             20  CF-LAST-BATCH       REDEFINES
  5206                 CF-LAST-BATCH-NO               PIC X(4).
  5207             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5208             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5209             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5210             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5211             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5212             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5213             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  97
* EL050.cbl
  5214             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5215             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5216             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5217
  5218         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5219         16  FILLER                         PIC X.
  5220
  5221         16  CF-ALT-MORT-CODE               PIC X(4).
  5222         16  CF-MEMBER-CAPTION              PIC X(10).
  5223
  5224         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5225             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5226             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5227             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5228             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5229             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5230
  5231         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5232
  5233         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5234         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5235         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5236         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5237
  5238         16  CF-AH-OVERRIDE-L1              PIC X.
  5239         16  CF-AH-OVERRIDE-L2              PIC XX.
  5240         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5241         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5242
  5243         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5244         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5245
  5246         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5247         16  CF-AR-LAST-EL860-DT            PIC XX.
  5248         16  CF-MP-MONTH-END-DT             PIC XX.
  5249
  5250         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5251         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5252             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5253
  5254         16  CF-AR-MONTH-END-DT             PIC XX.
  5255
  5256         16  CF-CRDTCRD-USER                PIC X.
  5257             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5258             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5259
  5260         16  CF-CC-MONTH-END-DT             PIC XX.
  5261
  5262         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5263
  5264         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5265             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5266             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5267             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5268         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5269         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5270         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5271         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  98
* EL050.cbl
  5272             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5273             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5274         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5275         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5276         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5277             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5278         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5279
  5280         16  CF-CL-ZIP-CODE.
  5281             20  CF-CL-ZIP-PRIME.
  5282                 24  CF-CL-ZIP-1ST          PIC X.
  5283                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5284                 24  FILLER                 PIC X(4).
  5285             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5286         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5287             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5288             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5289             20  FILLER                     PIC XXX.
  5290
  5291         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5292         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5293         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5294         16  CF-CO-OPTION-START-DATE        PIC XX.
  5295         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5296           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5297                                                      '3' '4'.
  5298           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5299           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5300           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5301           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5302           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5303           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5304
  5305         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5306
  5307         16  CF-PAYMENT-APPROVAL-LEVELS.
  5308             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5309             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5310             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5311             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5312             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5313             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5314
  5315         16  CF-END-USER-REPORTING-USER     PIC X.
  5316             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5317             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5318
  5319         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5320             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5321             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5322
  5323         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5324
  5325         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5326         16  FILLER                         PIC X.
  5327
  5328         16  CF-CREDIT-ARCHIVE-CNTL.
  5329             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page  99
* EL050.cbl
  5330             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5331             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5332
  5333         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5334
  5335         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5336             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5337             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5338
  5339         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5340             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5341             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5342
  5343         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5344
  5345         16  CF-CO-ACH-ID-CODE              PIC  X.
  5346             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5347             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5348             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5349         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5350         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5351         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5352         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5353         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5354         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5355         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5356         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5357         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5358                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5359         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5360                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5361
  5362         16  CF-CO-OVER-SHORT.
  5363             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5364             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5365
  5366*         16  FILLER                         PIC X(102).
  5367         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5368             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5369             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5370
  5371         16  CF-AH-APPROVAL-DAYS.
  5372             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5373             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5374             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5375             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5376
  5377         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5378
  5379         16  CF-APPROV-LEV-5.
  5380             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5381             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5382             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5383
  5384         16  FILLER                         PIC X(68).
  5385****************************************************************
  5386*             PROCESSOR/USER RECORD                            *
  5387****************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 100
* EL050.cbl
  5388
  5389     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5390         16  CF-PROCESSOR-NAME              PIC X(30).
  5391         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5392         16  CF-PROCESSOR-TITLE             PIC X(26).
  5393         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5394                 88  MESSAGE-YES                VALUE 'Y'.
  5395                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5396
  5397*****************************************************
  5398****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5399****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5400****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5401****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5402*****************************************************
  5403
  5404         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5405             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5406             20  CF-APPLICATION-FORCE       PIC X.
  5407             20  CF-INDIVIDUAL-APP.
  5408                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5409                     28  CF-BROWSE-APP      PIC X.
  5410                     28  CF-UPDATE-APP      PIC X.
  5411
  5412         16  CF-CURRENT-TERM-ON             PIC X(4).
  5413         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5414             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5415             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5416             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5417             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5418             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5419             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5420             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5421         16  CF-PROCESSOR-CARRIER           PIC X.
  5422             88  NO-CARRIER-SECURITY            VALUE ' '.
  5423         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5424             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5425         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5426             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5427         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5428             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5429
  5430         16  CF-PROC-SYS-ACCESS-SW.
  5431             20  CF-PROC-CREDIT-CLAIMS-SW.
  5432                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5433                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5434                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5435                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5436             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5437                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5438                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5439             20  CF-PROC-LIFE-GNRLDGR-SW.
  5440                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5441                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5442                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5443                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5444             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5445                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 101
* EL050.cbl
  5446                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5447         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5448             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5449             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5450         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5451
  5452         16  CF-APPROVAL-LEVEL                  PIC X.
  5453             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5454             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5455             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5456             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5457             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5458
  5459         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5460
  5461         16  CF-LANGUAGE-TYPE                   PIC X.
  5462             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5463             88  CF-LANG-IS-FR                      VALUE 'F'.
  5464
  5465         16  CF-CSR-IND                         PIC X.
  5466         16  FILLER                             PIC X(239).
  5467
  5468****************************************************************
  5469*             PROCESSOR/REMINDERS RECORD                       *
  5470****************************************************************
  5471
  5472     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5473         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5474             20  CF-START-REMIND-DT         PIC XX.
  5475             20  CF-END-REMIND-DT           PIC XX.
  5476             20  CF-REMINDER-TEXT           PIC X(50).
  5477         16  FILLER                         PIC X(296).
  5478
  5479
  5480****************************************************************
  5481*             STATE MASTER RECORD                              *
  5482****************************************************************
  5483
  5484     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5485         16  CF-STATE-ABBREVIATION          PIC XX.
  5486         16  CF-STATE-NAME                  PIC X(25).
  5487         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5488         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5489             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5490             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5491             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5492             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5493                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5494                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5495             20  CF-ST-PREM-REJECT-SW       PIC X.
  5496                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5497                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5498             20  CF-ST-REF-REJECT-SW        PIC X.
  5499                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5500                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5501         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5502         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5503         16  CF-ST-REFUND-RULES.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 102
* EL050.cbl
  5504             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5505             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5506             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5507         16  CF-ST-FST-PMT-EXTENSION.
  5508             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5509             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5510                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5511                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5512                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5513                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5514         16  CF-ST-STATE-CALL.
  5515             20  CF-ST-CALL-UNEARNED        PIC X.
  5516             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5517             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5518         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5519             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5520             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5521         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5522         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5523         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5524         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5525         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5526         16  FILLER                         PIC X.
  5527         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5528             20  CF-ST-BENEFIT-CD           PIC XX.
  5529             20  CF-ST-BENEFIT-KIND         PIC X.
  5530                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5531                 88  CF-ST-AH-KIND              VALUE 'A'.
  5532             20  CF-ST-REM-TERM-CALC        PIC X.
  5533                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5534                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5535                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5536                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5537                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5538                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5539                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5540                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5541
  5542             20  CF-ST-REFUND-CALC          PIC X.
  5543                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5544                 88  ST-REFD-BY-R78             VALUE '1'.
  5545                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5546                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5547                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5548                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5549                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5550                 88  ST-REFD-UTAH               VALUE '7'.
  5551                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5552                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5553                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5554
  5555             20  CF-ST-EARNING-CALC         PIC X.
  5556                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5557                 88  ST-EARN-BY-R78             VALUE '1'.
  5558                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5559                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5560                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5561                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 103
* EL050.cbl
  5562                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5563                 88  ST-EARN-MEAN               VALUE '8'.
  5564                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5565
  5566             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5567                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5568                 88  ST-OVRD-BY-R78             VALUE '1'.
  5569                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5570                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5571                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5572                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5573                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5574                 88  ST-OVRD-MEAN               VALUE '8'.
  5575                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5576             20  FILLER                     PIC X.
  5577
  5578         16  CF-ST-COMMISSION-CAPS.
  5579             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5580             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5581             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5582             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5583         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5584                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5585
  5586         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5587
  5588         16  CF-ST-STATUTORY-INTEREST.
  5589             20  CF-ST-STAT-DATE-FROM       PIC X.
  5590                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5591                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5592             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5593             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5594             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5595             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5596             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5597
  5598         16  CF-ST-OVER-SHORT.
  5599             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5600             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5601
  5602         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5603
  5604         16  CF-ST-RT-CALC                  PIC X.
  5605
  5606         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5607         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5608         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5609         16  CF-ST-RF-LR-CALC               PIC X.
  5610         16  CF-ST-RF-LL-CALC               PIC X.
  5611         16  CF-ST-RF-LN-CALC               PIC X.
  5612         16  CF-ST-RF-AH-CALC               PIC X.
  5613         16  CF-ST-RF-CP-CALC               PIC X.
  5614*        16  FILLER                         PIC X(206).
  5615*CIDMOD         16  FILLER                         PIC X(192).
  5616         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5617             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5618         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5619         16  CF-ST-VFY-2ND-BENE             PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 104
* EL050.cbl
  5620         16  CF-ST-CAUSAL-STATE             PIC X.
  5621         16  FILLER                         PIC X(185).
  5622
  5623****************************************************************
  5624*             BENEFIT MASTER RECORD                            *
  5625****************************************************************
  5626
  5627     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5628         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5629             20  CF-BENEFIT-CODE            PIC XX.
  5630             20  CF-BENEFIT-NUMERIC  REDEFINES
  5631                 CF-BENEFIT-CODE            PIC XX.
  5632             20  CF-BENEFIT-ALPHA           PIC XXX.
  5633             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5634             20  CF-BENEFIT-COMMENT         PIC X(10).
  5635
  5636             20  CF-LF-COVERAGE-TYPE        PIC X.
  5637                 88  CF-REDUCING                VALUE 'R'.
  5638                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5639
  5640             20  CF-SPECIAL-CALC-CD         PIC X.
  5641                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5642                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5643                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5644                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5645                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5646                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5647                 88  CF-FARM-PLAN               VALUE 'F'.
  5648                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5649                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5650                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5651                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5652                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5653                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5654                 88  CF-PRUDENTIAL              VALUE 'P'.
  5655                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5656                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5657                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5658                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5659                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5660                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5661
  5662             20  CF-JOINT-INDICATOR         PIC X.
  5663                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5664
  5665*            20  FILLER                     PIC X(12).
  5666             20  FILLER                     PIC X(11).
  5667             20  CF-BENEFIT-CATEGORY        PIC X.
  5668             20  CF-LOAN-TYPE               PIC X(8).
  5669
  5670             20  CF-CO-REM-TERM-CALC        PIC X.
  5671                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5672                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5673                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5674                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5675                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5676
  5677             20  CF-CO-EARNINGS-CALC        PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 105
* EL050.cbl
  5678                 88  CO-EARN-BY-R78             VALUE '1'.
  5679                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5680                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5681                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5682                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5683                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5684                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5685                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5686
  5687             20  CF-CO-REFUND-CALC          PIC X.
  5688                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5689                 88  CO-REFD-BY-R78             VALUE '1'.
  5690                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5691                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5692                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5693                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5694                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5695                 88  CO-REFD-MEAN               VALUE '8'.
  5696                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5697                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5698                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5699
  5700             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5701                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5702                 88  CO-OVRD-BY-R78             VALUE '1'.
  5703                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5704                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5705                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5706                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5707                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5708                 88  CO-OVRD-MEAN               VALUE '8'.
  5709                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5710
  5711             20  CF-CO-BEN-I-G-CD           PIC X.
  5712                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5713                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5714                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5715
  5716         16  FILLER                         PIC X(304).
  5717
  5718
  5719****************************************************************
  5720*             CARRIER MASTER RECORD                            *
  5721****************************************************************
  5722
  5723     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5724         16  CF-ADDRESS-DATA.
  5725             20  CF-MAIL-TO-NAME            PIC X(30).
  5726             20  CF-IN-CARE-OF              PIC X(30).
  5727             20  CF-ADDRESS-LINE-1          PIC X(30).
  5728             20  CF-ADDRESS-LINE-2          PIC X(30).
  5729             20  CF-CITY-STATE              PIC X(30).
  5730             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5731             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5732
  5733         16  CF-CLAIM-NO-CONTROL.
  5734             20  CF-CLAIM-NO-METHOD         PIC X.
  5735                 88  CLAIM-NO-MANUAL            VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 106
* EL050.cbl
  5736                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5737                 88  CLAIM-NO-SEQ               VALUE '3'.
  5738                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5739             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5740                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5741                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5742                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5743
  5744         16  CF-CHECK-NO-CONTROL.
  5745             20  CF-CHECK-NO-METHOD         PIC X.
  5746                 88  CHECK-NO-MANUAL            VALUE '1'.
  5747                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5748                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5749                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5750             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5751                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5752
  5753         16  CF-DOMICILE-STATE              PIC XX.
  5754
  5755         16  CF-EXPENSE-CONTROLS.
  5756             20  CF-EXPENSE-METHOD          PIC X.
  5757                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5758                 88  DOLLARS-PER-PMT            VALUE '2'.
  5759                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5760                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5761             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5762             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5763
  5764         16  CF-CORRESPONDENCE-CONTROL.
  5765             20  CF-LETTER-RESEND-OPT       PIC X.
  5766                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5767                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5768             20  FILLER                     PIC X(4).
  5769
  5770         16  CF-RESERVE-CONTROLS.
  5771             20  CF-MANUAL-SW               PIC X.
  5772                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5773             20  CF-FUTURE-SW               PIC X.
  5774                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5775             20  CF-PTC-SW                  PIC X.
  5776                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5777             20  CF-IBNR-SW                 PIC X.
  5778                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5779             20  CF-PTC-LF-SW               PIC X.
  5780                 88  CF-LF-PTC-USED             VALUE '1'.
  5781             20  CF-CDT-ACCESS-METHOD       PIC X.
  5782                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5783                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5784                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5785             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5786
  5787         16  CF-CLAIM-CALC-METHOD           PIC X.
  5788             88  360-PLUS-MONTHS                VALUE '1'.
  5789             88  365-PLUS-MONTHS                VALUE '2'.
  5790             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5791             88  360-DAILY                      VALUE '4'.
  5792             88  365-DAILY                      VALUE '5'.
  5793
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 107
* EL050.cbl
  5794         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5795         16  FILLER                         PIC X(11).
  5796
  5797         16  CF-LIMIT-AMOUNTS.
  5798             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5799             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5800             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5801             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5802             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5803             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5804             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5805             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5806             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5807             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5808
  5809         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5810         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5811         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5812
  5813         16  CF-ZIP-CODE.
  5814             20  CF-ZIP-PRIME.
  5815                 24  CF-ZIP-1ST             PIC X.
  5816                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5817                 24  FILLER                 PIC X(4).
  5818             20  CF-ZIP-PLUS4               PIC X(4).
  5819         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5820             20  CF-CAN-POSTAL-1            PIC XXX.
  5821             20  CF-CAN-POSTAL-2            PIC XXX.
  5822             20  FILLER                     PIC XXX.
  5823
  5824         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5825         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5826         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5827
  5828         16  CF-RATING-SWITCH               PIC X.
  5829             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5830             88  CF-NO-RATING                   VALUE 'N'.
  5831
  5832         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5833
  5834         16  CF-CARRIER-OVER-SHORT.
  5835             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5836             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5837
  5838         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5839         16  CF-SECPAY-SWITCH               PIC X.
  5840             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5841             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5842         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5843         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5844         16  FILLER                         PIC X(444).
  5845*        16  FILLER                         PIC X(452).
  5846
  5847
  5848****************************************************************
  5849*             MORTALITY MASTER RECORD                          *
  5850****************************************************************
  5851
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 108
* EL050.cbl
  5852     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5853         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5854                                INDEXED BY CF-MORT-NDX.
  5855             20  CF-MORT-TABLE              PIC X(5).
  5856             20  CF-MORT-TABLE-TYPE         PIC X.
  5857                 88  CF-MORT-JOINT              VALUE 'J'.
  5858                 88  CF-MORT-SINGLE             VALUE 'S'.
  5859                 88  CF-MORT-COMBINED           VALUE 'C'.
  5860                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5861                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5862             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5863             20  CF-MORT-AGE-METHOD         PIC XX.
  5864                 88  CF-AGE-LAST                VALUE 'AL'.
  5865                 88  CF-AGE-NEAR                VALUE 'AN'.
  5866             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5867             20  CF-MORT-ADJUSTMENT-DIRECTION
  5868                                            PIC X.
  5869                 88  CF-MINUS                   VALUE '-'.
  5870                 88  CF-PLUS                    VALUE '+'.
  5871             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5872             20  CF-MORT-JOINT-CODE         PIC X.
  5873                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5874             20  CF-MORT-PC-Q               PIC X.
  5875                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5876             20  CF-MORT-TABLE-CODE         PIC X(4).
  5877             20  CF-MORT-COMMENTS           PIC X(15).
  5878             20  FILLER                     PIC X(14).
  5879
  5880         16  FILLER                         PIC X(251).
  5881
  5882
  5883****************************************************************
  5884*             BUSSINESS TYPE MASTER RECORD                     *
  5885****************************************************************
  5886
  5887     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5888* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5889* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5890* AND RECORD 05 IS TYPES 81-99
  5891         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5892             20  CF-BUSINESS-TITLE          PIC  X(19).
  5893             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5894                                            PIC S9V9(4) COMP-3.
  5895             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5896             20  FILLER                     PIC  X.
  5897         16  FILLER                         PIC  X(248).
  5898
  5899
  5900****************************************************************
  5901*             TERMINAL MASTER RECORD                           *
  5902****************************************************************
  5903
  5904     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5905
  5906         16  CF-COMPANY-TERMINALS.
  5907             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5908                                  PIC X(4).
  5909         16  FILLER               PIC X(248).
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 109
* EL050.cbl
  5910
  5911
  5912****************************************************************
  5913*             LIFE EDIT MASTER RECORD                          *
  5914****************************************************************
  5915
  5916     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5917         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5918             20  CF-LIFE-CODE-IN            PIC XX.
  5919             20  CF-LIFE-CODE-OUT           PIC XX.
  5920         16  FILLER                         PIC X(248).
  5921
  5922
  5923****************************************************************
  5924*             AH EDIT MASTER RECORD                            *
  5925****************************************************************
  5926
  5927     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5928         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5929             20  CF-AH-CODE-IN              PIC XXX.
  5930             20  CF-AH-CODE-OUT             PIC XX.
  5931         16  FILLER                         PIC X(248).
  5932
  5933
  5934****************************************************************
  5935*             CREDIBILITY TABLES                               *
  5936****************************************************************
  5937
  5938     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5939         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5940                             INDEXED BY CF-CRDB-NDX.
  5941             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5942             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5943             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5944         16  FILLER                         PIC  X(332).
  5945
  5946
  5947****************************************************************
  5948*             REPORT CUSTOMIZATION RECORD                      *
  5949****************************************************************
  5950
  5951     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5952         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5953             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5954             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5955             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5956**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5957****       A T-TRANSFER.                                   ****
  5958             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5959
  5960         16  FILLER                         PIC XX.
  5961
  5962         16  CF-CARRIER-CNTL-OPT.
  5963             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5964                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5965                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5966             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5967                                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 110
* EL050.cbl
  5968         16  CF-GROUP-CNTL-OPT.
  5969             20  CF-GROUP-OPT-SEQ           PIC 9.
  5970                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5971                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5972             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5973                                            PIC X(6).
  5974         16  CF-STATE-CNTL-OPT.
  5975             20  CF-STATE-OPT-SEQ           PIC 9.
  5976                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5977                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5978             20  CF-STATE-SELECT OCCURS 3 TIMES
  5979                                            PIC XX.
  5980         16  CF-ACCOUNT-CNTL-OPT.
  5981             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5982                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5983                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5984             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5985                                            PIC X(10).
  5986         16  CF-BUS-TYP-CNTL-OPT.
  5987             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5988                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5989                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5990             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5991                                            PIC XX.
  5992         16  CF-LF-TYP-CNTL-OPT.
  5993             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5994                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5995                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5996             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5997                                            PIC XX.
  5998         16  CF-AH-TYP-CNTL-OPT.
  5999             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6000                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6001                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6002             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  6003                                            PIC XX.
  6004         16  CF-REPTCD1-CNTL-OPT.
  6005             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6006                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6007                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6008             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6009                                            PIC X(10).
  6010         16  CF-REPTCD2-CNTL-OPT.
  6011             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6012                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6013                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6014             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6015                                            PIC X(10).
  6016         16  CF-USER1-CNTL-OPT.
  6017             20  CF-USER1-OPT-SEQ           PIC 9.
  6018                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6019                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6020             20  CF-USER1-SELECT OCCURS 3 TIMES
  6021                                            PIC X(10).
  6022         16  CF-USER2-CNTL-OPT.
  6023             20  CF-USER2-OPT-SEQ           PIC 9.
  6024                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6025                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 111
* EL050.cbl
  6026             20  CF-USER2-SELECT OCCURS 3 TIMES
  6027                                            PIC X(10).
  6028         16  CF-USER3-CNTL-OPT.
  6029             20  CF-USER3-OPT-SEQ           PIC 9.
  6030                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6031                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6032             20  CF-USER3-SELECT OCCURS 3 TIMES
  6033                                            PIC X(10).
  6034         16  CF-USER4-CNTL-OPT.
  6035             20  CF-USER4-OPT-SEQ           PIC 9.
  6036                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6037                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6038             20  CF-USER4-SELECT OCCURS 3 TIMES
  6039                                            PIC X(10).
  6040         16  CF-USER5-CNTL-OPT.
  6041             20  CF-USER5-OPT-SEQ           PIC 9.
  6042                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6043                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6044             20  CF-USER5-SELECT OCCURS 3 TIMES
  6045                                            PIC X(10).
  6046         16  CF-REINS-CNTL-OPT.
  6047             20  CF-REINS-OPT-SEQ           PIC 9.
  6048                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6049                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6050             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6051                 24  CF-REINS-PRIME         PIC XXX.
  6052                 24  CF-REINS-SUB           PIC XXX.
  6053
  6054         16  CF-AGENT-CNTL-OPT.
  6055             20  CF-AGENT-OPT-SEQ           PIC 9.
  6056                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6057                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6058             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6059                                            PIC X(10).
  6060
  6061         16  FILLER                         PIC X(43).
  6062
  6063         16  CF-LOSS-RATIO-SELECT.
  6064             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6065             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6066         16  CF-ENTRY-DATE-SELECT.
  6067             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6068             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6069         16  CF-EFFECTIVE-DATE-SELECT.
  6070             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6071             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6072
  6073         16  CF-EXCEPTION-LIST-IND          PIC X.
  6074             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6075
  6076         16  FILLER                         PIC X(318).
  6077
  6078****************************************************************
  6079*                  EXCEPTION REPORTING RECORD                  *
  6080****************************************************************
  6081
  6082     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6083         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 112
* EL050.cbl
  6084             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6085
  6086         16  CF-COMBINED-LIFE-AH-OPT.
  6087             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6088             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6089             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6090             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6091
  6092         16  CF-LIFE-OPT.
  6093             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6094             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6095             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6096             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6097             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6098             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6099             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6100             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6101             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6102             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6103
  6104         16  CF-AH-OPT.
  6105             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6106             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6107             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6108             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6109             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6110             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6111             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6112             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6113             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6114             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6115
  6116         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6117             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6118             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6119             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6120
  6121         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6122
  6123         16  FILLER                         PIC X(673).
  6124
  6125
  6126****************************************************************
  6127*             MORTGAGE SYSTEM PLAN RECORD                      *
  6128****************************************************************
  6129
  6130     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6131         16  CF-PLAN-TYPE                   PIC X.
  6132             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6133             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6134             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6135         16  CF-PLAN-ABBREV                 PIC XXX.
  6136         16  CF-PLAN-DESCRIPT               PIC X(10).
  6137         16  CF-PLAN-NOTES                  PIC X(20).
  6138         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6139         16  CF-PLAN-UNDERWRITING.
  6140             20  CF-PLAN-TERM-DATA.
  6141                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 113
* EL050.cbl
  6142                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6143             20  CF-PLAN-AGE-DATA.
  6144                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6145                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6146                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6147             20  CF-PLAN-BENEFIT-DATA.
  6148                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6149                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6150                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6151                                            PIC S9(7)V99  COMP-3.
  6152         16  CF-PLAN-POLICY-FORMS.
  6153             20  CF-POLICY-FORM             PIC X(12).
  6154             20  CF-MASTER-APPLICATION      PIC X(12).
  6155             20  CF-MASTER-POLICY           PIC X(12).
  6156         16  CF-PLAN-RATING.
  6157             20  CF-RATE-CODE               PIC X(5).
  6158             20  CF-SEX-RATING              PIC X.
  6159                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6160                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6161             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6162             20  CF-SUB-STD-TYPE            PIC X.
  6163                 88  CF-PCT-OF-PREM            VALUE '1'.
  6164                 88  CF-PCT-OF-BENE            VALUE '2'.
  6165         16  CF-PLAN-PREM-TOLERANCES.
  6166             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6167             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6168         16  CF-PLAN-PYMT-TOLERANCES.
  6169             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6170             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6171         16  CF-PLAN-MISC-DATA.
  6172             20  FILLER                     PIC X.
  6173             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6174             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6175         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6176         16  CF-PLAN-IND-GRP                PIC X.
  6177             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6178                                                     '1'.
  6179             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6180                                                     '2'.
  6181         16  CF-MIB-SEARCH-SW               PIC X.
  6182             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6183             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6184             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6185             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6186         16  CF-ALPHA-SEARCH-SW             PIC X.
  6187             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6188             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6189             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6190             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6191             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6192             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6193             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6194             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6195             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6196             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6197                                                     'A' 'B' 'C'
  6198                                                     'X' 'Y' 'Z'.
  6199         16  CF-EFF-DT-RULE-SW              PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 114
* EL050.cbl
  6200             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6201             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6202             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6203             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6204             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6205         16  FILLER                         PIC X(4).
  6206         16  CF-HEALTH-QUESTIONS            PIC X.
  6207             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6208         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6209         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6210         16  CF-PLAN-SNGL-JNT               PIC X.
  6211             88  CF-COMBINED-PLAN              VALUE 'C'.
  6212             88  CF-JNT-PLAN                   VALUE 'J'.
  6213             88  CF-SNGL-PLAN                  VALUE 'S'.
  6214         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6215         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6216         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6217         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6218         16  CF-RERATE-CNTL                 PIC  X.
  6219             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6220             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6221             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6222             88  CF-AUTO-RECALC                 VALUE '4'.
  6223         16  CF-BENEFIT-TYPE                PIC  X.
  6224             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6225             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6226         16  CF-POLICY-FEE                  PIC S999V99
  6227                                                    COMP-3.
  6228         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6229         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6230         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6231         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6232         16  FILLER                         PIC  X(32).
  6233         16  CF-TERMINATION-FORM            PIC  X(04).
  6234         16  FILLER                         PIC  X(08).
  6235         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6236                                                       COMP-3.
  6237         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6238         16  CF-ISSUE-LETTER                PIC  X(4).
  6239         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6240         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6241             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6242             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6243         16  CF-MP-REFUND-CALC              PIC X.
  6244             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6245             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6246             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6247             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6248             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6249             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6250             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6251             88  CF-MP-REFD-MEAN                VALUE '8'.
  6252         16  CF-ALT-RATE-CODE               PIC  X(5).
  6253
  6254
  6255         16  FILLER                         PIC X(498).
  6256****************************************************************
  6257*             MORTGAGE COMPANY MASTER RECORD                   *
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 115
* EL050.cbl
  6258****************************************************************
  6259
  6260     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6261         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6262         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6263             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6264             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6265             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6266             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6267             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6268
  6269         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6270         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6271         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6272         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6273         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6274
  6275         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6276             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6277         16  CF-MP-RECON-USE-IND            PIC X(1).
  6278             88  CF-MP-USE-RECON             VALUE 'Y'.
  6279         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6280             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6281         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6282             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6283             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6284         16  FILLER                         PIC X(1).
  6285         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6286             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6287         16  CF-MORTG-MIB-VERSION           PIC X.
  6288             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6289             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6290             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6291         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6292             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6293                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6294             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6295                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6296             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6297                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6298             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6299                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6300             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6301                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6302             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6303                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6304         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6305         16  FILLER                         PIC X(7).
  6306         16  CF-MORTG-DESTINATION-SYMBOL.
  6307             20  CF-MORTG-MIB-COMM          PIC X(5).
  6308             20  CF-MORTG-MIB-TERM          PIC X(5).
  6309         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6310             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6311         16  FILLER                         PIC X(03).
  6312         16  CF-MP-CHECK-NO-CONTROL.
  6313             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6314                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6315                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 116
* EL050.cbl
  6316                                                ' ' LOW-VALUES.
  6317                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6318                                               VALUE '3'.
  6319         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6320         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6321         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6322             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6323                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6324             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6325                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6326             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6327                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6328             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6329                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6330             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6331                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6332             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6333                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6334         16  CF-MORTG-BILLING-AREA.
  6335             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6336                                            PIC X.
  6337         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6338         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6339         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6340         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6341             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6342             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6343         16  FILLER                         PIC X.
  6344         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6345             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6346             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6347         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6348         16  FILLER                         PIC X(8).
  6349         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6350         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6351         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6352         16  CF-ACH-COMPANY-ID.
  6353             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6354                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6355                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6356                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6357             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6358         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6359             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6360         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6361             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6362             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6363         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6364         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6365         16  FILLER                         PIC X(536).
  6366
  6367****************************************************************
  6368*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6369****************************************************************
  6370
  6371     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6372         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6373             20  CF-FEMALE-HEIGHT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 117
* EL050.cbl
  6374                 24  CF-FEMALE-FT           PIC 99.
  6375                 24  CF-FEMALE-IN           PIC 99.
  6376             20  CF-FEMALE-MIN-WT           PIC 999.
  6377             20  CF-FEMALE-MAX-WT           PIC 999.
  6378         16  FILLER                         PIC X(428).
  6379
  6380     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6381         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6382             20  CF-MALE-HEIGHT.
  6383                 24  CF-MALE-FT             PIC 99.
  6384                 24  CF-MALE-IN             PIC 99.
  6385             20  CF-MALE-MIN-WT             PIC 999.
  6386             20  CF-MALE-MAX-WT             PIC 999.
  6387         16  FILLER                         PIC X(428).
  6388******************************************************************
  6389*             AUTOMATIC ACTIVITY RECORD                          *
  6390******************************************************************
  6391     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6392         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6393             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6394             20  CF-SYS-LETTER-ID           PIC X(04).
  6395             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6396             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6397             20  CF-SYS-RESET-SW            PIC X(01).
  6398             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6399             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6400
  6401         16  FILLER                         PIC X(50).
  6402
  6403         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6404             20  CF-USER-ACTIVE-SW          PIC X(01).
  6405             20  CF-USER-LETTER-ID          PIC X(04).
  6406             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6407             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6408             20  CF-USER-RESET-SW           PIC X(01).
  6409             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6410             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6411             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6412
  6413         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 118
* EL050.cbl
  6415*    COPY ERCACCT.
  6416******************************************************************
  6417*                                                                *
  6418*                                                                *
  6419*                            ERCACCT                             *
  6420*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6421*                            VMOD=2.031                          *
  6422*                                                                *
  6423*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6424*                                                                *
  6425*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6426*   VSAM ACCOUNT MASTER FILES.                                   *
  6427*                                                                *
  6428*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6429*                                                                *
  6430*   FILE TYPE = VSAM,KSDS                                        *
  6431*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6432*                                                                *
  6433*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6434*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6435*                                                                *
  6436*   LOG = NO                                                     *
  6437*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6438*                                                                *
  6439*                                                                *
  6440******************************************************************
  6441*                   C H A N G E   L O G
  6442*
  6443* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6444*-----------------------------------------------------------------
  6445*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6446* EFFECTIVE    NUMBER
  6447*-----------------------------------------------------------------
  6448* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6449* 092705    2005050300006  PEMA  ADD SPP LEASES
  6450* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6451* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6452* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6453* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6454* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6455******************************************************************
  6456
  6457 01  ACCOUNT-MASTER.
  6458     12  AM-RECORD-ID                      PIC XX.
  6459         88  VALID-AM-ID                      VALUE 'AM'.
  6460
  6461     12  AM-CONTROL-PRIMARY.
  6462         16  AM-COMPANY-CD                 PIC X.
  6463         16  AM-MSTR-CNTRL.
  6464             20  AM-CONTROL-A.
  6465                 24  AM-CARRIER            PIC X.
  6466                 24  AM-GROUPING.
  6467                     28 AM-GROUPING-PREFIX PIC XXX.
  6468                     28 AM-GROUPING-PRIME  PIC XXX.
  6469                 24  AM-STATE              PIC XX.
  6470                 24  AM-ACCOUNT.
  6471                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6472                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 119
* EL050.cbl
  6473             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6474                                           PIC X(19).
  6475             20  AM-CNTRL-B.
  6476                 24  AM-EXPIRATION-DT      PIC XX.
  6477                 24  FILLER                PIC X(4).
  6478             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6479                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6480
  6481     12  AM-CONTROL-BY-VAR-GRP.
  6482         16  AM-COMPANY-CD-A1              PIC X.
  6483         16  AM-VG-CARRIER                 PIC X.
  6484         16  AM-VG-GROUPING                PIC X(6).
  6485         16  AM-VG-STATE                   PIC XX.
  6486         16  AM-VG-ACCOUNT                 PIC X(10).
  6487         16  AM-VG-DATE.
  6488             20  AM-VG-EXPIRATION-DT       PIC XX.
  6489             20  FILLER                    PIC X(4).
  6490         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6491                                           PIC 9(11)      COMP-3.
  6492     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6493         16  FILLER                        PIC X(10).
  6494         16  AM-VG-KEY3.
  6495             20  AM-VG3-ACCOUNT            PIC X(10).
  6496             20  AM-VG3-EXP-DT             PIC XX.
  6497         16  FILLER                        PIC X(4).
  6498     12  AM-MAINT-INFORMATION.
  6499         16  AM-LAST-MAINT-DT              PIC XX.
  6500         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6501         16  AM-LAST-MAINT-USER            PIC X(4).
  6502         16  FILLER                        PIC XX.
  6503
  6504     12  AM-EFFECTIVE-DT                   PIC XX.
  6505     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6506
  6507     12  AM-PREV-DATES  COMP-3.
  6508         16  AM-PREV-EXP-DT                PIC 9(11).
  6509         16  AM-PREV-EFF-DT                PIC 9(11).
  6510
  6511     12  AM-REPORT-CODE-1                  PIC X(10).
  6512     12  AM-REPORT-CODE-2                  PIC X(10).
  6513
  6514     12  AM-CITY-CODE                      PIC X(4).
  6515     12  AM-COUNTY-PARISH                  PIC X(6).
  6516
  6517     12  AM-NAME                           PIC X(30).
  6518     12  AM-PERSON                         PIC X(30).
  6519     12  AM-ADDRS                          PIC X(30).
  6520     12  AM-CITY.
  6521         16  AM-ADDR-CITY                  PIC X(28).
  6522         16  AM-ADDR-STATE                 PIC XX.
  6523     12  AM-ZIP.
  6524         16  AM-ZIP-PRIME.
  6525             20  AM-ZIP-PRI-1ST            PIC X.
  6526                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6527             20  FILLER                    PIC X(4).
  6528         16  AM-ZIP-PLUS4                  PIC X(4).
  6529     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6530         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 120
* EL050.cbl
  6531         16  AM-CAN-POSTAL-2               PIC XXX.
  6532         16  FILLER                        PIC XXX.
  6533     12  AM-TEL-NO.
  6534         16  AM-AREA-CODE                  PIC 999.
  6535         16  AM-TEL-PRE                    PIC 999.
  6536         16  AM-TEL-NBR                    PIC 9(4).
  6537     12  AM-TEL-LOC                        PIC X.
  6538         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6539         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6540
  6541     12  AM-COMM-STRUCTURE.
  6542         16  AM-DEFN-1.
  6543             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6544                 24  AM-AGT.
  6545                     28  AM-AGT-PREFIX     PIC X(4).
  6546                     28  AM-AGT-PRIME      PIC X(6).
  6547                 24  AM-COM-TYP            PIC X.
  6548                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6549                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6550                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6551                 24  AM-RECALC-LV-INDIC    PIC X.
  6552                 24  AM-RETRO-LV-INDIC     PIC X.
  6553                 24  AM-GL-CODES           PIC X.
  6554                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6555                 24  FILLER                PIC X(01).
  6556         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6557             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6558                 24  FILLER                PIC X(11).
  6559                 24  AM-L-COMA             PIC XXX.
  6560                 24  AM-J-COMA             PIC XXX.
  6561                 24  AM-A-COMA             PIC XXX.
  6562                 24  FILLER                PIC X(6).
  6563
  6564     12  AM-COMM-CHANGE-STATUS             PIC X.
  6565         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6566
  6567     12  AM-CSR-CODE                       PIC X(4).
  6568
  6569     12  AM-BILLING-STATUS                 PIC X.
  6570         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6571         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6572     12  AM-AUTO-REFUND-SW                 PIC X.
  6573         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6574         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6575     12  AM-GPCD                           PIC 99.
  6576     12  AM-IG                             PIC X.
  6577         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6578         88  AM-HAS-GROUP                     VALUE '2'.
  6579     12  AM-STATUS                         PIC X.
  6580         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6581         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6582         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6583         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6584         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6585         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6586     12  AM-REMIT-TO                       PIC 99.
  6587     12  AM-ID-NO                          PIC X(11).
  6588
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 121
* EL050.cbl
  6589     12  AM-CAL-TABLE                      PIC XX.
  6590     12  AM-LF-DEVIATION                   PIC XXX.
  6591     12  AM-AH-DEVIATION                   PIC XXX.
  6592     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6593     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6594     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6595     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6596     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6597     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6598
  6599     12  AM-USER-FIELDS.
  6600         16  AM-FLD-1                      PIC XX.
  6601         16  AM-FLD-2                      PIC XX.
  6602         16  AM-FLD-3                      PIC XX.
  6603         16  AM-FLD-4                      PIC XX.
  6604         16  AM-FLD-5                      PIC XX.
  6605
  6606     12  AM-1ST-PROD-DATE.
  6607         16  AM-1ST-PROD-YR                PIC XX.
  6608         16  AM-1ST-PROD-MO                PIC XX.
  6609         16  AM-1ST-PROD-DA                PIC XX.
  6610     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6611     12  AM-CERTS-PURGED-DATE.
  6612         16  AM-PUR-YR                     PIC XX.
  6613         16  AM-PUR-MO                     PIC XX.
  6614         16  AM-PUR-DA                     PIC XX.
  6615     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6616     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6617     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6618     12  AM-INACTIVE-DATE.
  6619         16  AM-INA-MO                     PIC 99.
  6620         16  AM-INA-DA                     PIC 99.
  6621         16  AM-INA-YR                     PIC 99.
  6622     12  AM-AR-HI-CERT-DATE                PIC XX.
  6623
  6624     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6625     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6626
  6627     12  AM-OB-PAYMENT-MODE                PIC X.
  6628         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6629         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6630         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6631         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6632
  6633     12  AM-AH-ONLY-INDICATOR              PIC X.
  6634         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6635         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6636
  6637     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6638
  6639     12  AM-OVER-SHORT.
  6640         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6641         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6642
  6643     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6644     12  AM-DCC-CLP-STATE                  PIC XX.
  6645
  6646     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 122
* EL050.cbl
  6647     12  AM-RECALC-REIN                    PIC X.
  6648
  6649     12  AM-REI-TABLE                      PIC XXX.
  6650     12  AM-REI-ET-LF                      PIC X.
  6651     12  AM-REI-ET-AH                      PIC X.
  6652     12  AM-REI-PE-LF                      PIC X.
  6653     12  AM-REI-PE-AH                      PIC X.
  6654     12  AM-REI-PRT-ST                     PIC X.
  6655     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6656     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6657     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6658     12  AM-REI-GROUP-A                    PIC X(6).
  6659     12  AM-REI-MORT                       PIC X(4).
  6660     12  AM-REI-PRT-OW                     PIC X.
  6661     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6662     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6663     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6664     12  AM-REI-GROUP-B                    PIC X(6).
  6665
  6666     12  AM-TRUST-TYPE                     PIC X(2).
  6667
  6668     12  AM-EMPLOYER-STMT-USED             PIC X.
  6669     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6670
  6671     12  AM-STD-AH-TYPE                    PIC XX.
  6672     12  AM-EARN-METHODS.
  6673         16  AM-EARN-METHOD-R              PIC X.
  6674             88 AM-REF-RL-R78                 VALUE 'R'.
  6675             88 AM-REF-RL-PR                  VALUE 'P'.
  6676             88 AM-REF-RL-MEAN                VALUE 'M'.
  6677             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6678         16  AM-EARN-METHOD-L              PIC X.
  6679             88 AM-REF-LL-R78                 VALUE 'R'.
  6680             88 AM-REF-LL-PR                  VALUE 'P'.
  6681             88 AM-REF-LL-MEAN                VALUE 'M'.
  6682             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6683         16  AM-EARN-METHOD-A              PIC X.
  6684             88 AM-REF-AH-R78                 VALUE 'R'.
  6685             88 AM-REF-AH-PR                  VALUE 'P'.
  6686             88 AM-REF-AH-MEAN                VALUE 'M'.
  6687             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6688             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6689             88 AM-REF-AH-NET                 VALUE 'N'.
  6690
  6691     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6692     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6693     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6694
  6695     12  AM-RET-Y-N                        PIC X.
  6696     12  AM-RET-P-E                        PIC X.
  6697     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6698     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6699     12  AM-RET-GRP                        PIC X(6).
  6700     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6701         16  AM-POOL-PRIME                 PIC XXX.
  6702         16  AM-POOL-SUB                   PIC XXX.
  6703     12  AM-RETRO-EARNINGS.
  6704         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 123
* EL050.cbl
  6705         16  AM-RET-EARN-L                 PIC X.
  6706         16  AM-RET-EARN-A                 PIC X.
  6707     12  AM-RET-ST-TAX-USE                 PIC X.
  6708         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6709         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6710     12  AM-RETRO-BEG-EARNINGS.
  6711         16  AM-RET-BEG-EARN-R             PIC X.
  6712         16  AM-RET-BEG-EARN-L             PIC X.
  6713         16  AM-RET-BEG-EARN-A             PIC X.
  6714     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6715     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6716
  6717     12  AM-USER-SELECT-OPTIONS.
  6718         16  AM-USER-SELECT-1              PIC X(10).
  6719         16  AM-USER-SELECT-2              PIC X(10).
  6720         16  AM-USER-SELECT-3              PIC X(10).
  6721         16  AM-USER-SELECT-4              PIC X(10).
  6722         16  AM-USER-SELECT-5              PIC X(10).
  6723
  6724     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6725
  6726     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6727
  6728     12  AM-RPT045A-SWITCH                 PIC X.
  6729         88  RPT045A-OFF                   VALUE 'N'.
  6730
  6731     12  AM-INSURANCE-LIMITS.
  6732         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6733         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6734
  6735     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6736         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6737
  6738     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6739         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6740         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6741
  6742     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6743
  6744     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6745     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6746     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6747     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6748     12  AM-DCC-UEF-STATE                  PIC XX.
  6749     12  FILLER                            PIC XXX.
  6750     12  AM-REPORT-CODE-3                  PIC X(10).
  6751*    12  FILLER                            PIC X(22).
  6752
  6753     12  AM-RESERVE-DATE.
  6754         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6755         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6756         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6757
  6758     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6759     12  AM-NOTIFICATION-TYPES.
  6760         16  AM-NOTIF-OF-LETTERS           PIC X.
  6761         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6762         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 124
* EL050.cbl
  6763         16  AM-NOTIF-OF-STATUS            PIC X.
  6764
  6765     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6766         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6767         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6768         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6769         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6770
  6771     12  AM-BENEFIT-CONTROLS.
  6772         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6773             20  AM-BENEFIT-CODE           PIC XX.
  6774             20  AM-BENEFIT-TYPE           PIC X.
  6775             20  AM-BENEFIT-REVISION       PIC XXX.
  6776             20  AM-BENEFIT-REM-TERM       PIC X.
  6777             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6778             20  FILLER                    PIC XX.
  6779         16  FILLER                        PIC X(80).
  6780
  6781     12  AM-TRANSFER-DATA.
  6782         16  AM-TRANSFERRED-FROM.
  6783             20  AM-TRNFROM-CARRIER        PIC X.
  6784             20  AM-TRNFROM-GROUPING.
  6785                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6786                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6787             20  AM-TRNFROM-STATE          PIC XX.
  6788             20  AM-TRNFROM-ACCOUNT.
  6789                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6790                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6791             20  AM-TRNFROM-DTE            PIC XX.
  6792         16  AM-TRANSFERRED-TO.
  6793             20  AM-TRNTO-CARRIER          PIC X.
  6794             20  AM-TRNTO-GROUPING.
  6795                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6796                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6797             20  AM-TRNTO-STATE            PIC XX.
  6798             20  AM-TRNTO-ACCOUNT.
  6799                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6800                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6801             20  AM-TRNTO-DTE              PIC XX.
  6802         16  FILLER                        PIC X(10).
  6803
  6804     12  AM-SAVED-REMIT-TO                 PIC 99.
  6805
  6806     12  AM-COMM-STRUCTURE-SAVED.
  6807         16  AM-DEFN-1-SAVED.
  6808             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6809                 24  AM-AGT-SV             PIC X(10).
  6810                 24  AM-COM-TYP-SV         PIC X.
  6811                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6812                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6813                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6814                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6815                 24  FILLER                PIC X.
  6816                 24  AM-GL-CODES-SV        PIC X.
  6817                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6818                 24  FILLER                PIC X.
  6819         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6820             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 125
* EL050.cbl
  6821                 24  FILLER                PIC X(11).
  6822                 24  AM-L-COMA-SV          PIC XXX.
  6823                 24  AM-J-COMA-SV          PIC XXX.
  6824                 24  AM-A-COMA-SV          PIC XXX.
  6825                 24  FILLER                PIC X(6).
  6826
  6827     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6828         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6829            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6830            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6831            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6832
  6833     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6834     12  FILLER                            PIC X(120).
  6835
  6836     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6837         16  AM-CONTROL-NAME               PIC X(30).
  6838         16  AM-EXECUTIVE-ONE.
  6839             20  AM-EXEC1-NAME             PIC X(15).
  6840             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6841                                                          COMP-3.
  6842             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6843                                                          COMP-3.
  6844         16  AM-EXECUTIVE-TWO.
  6845             20  AM-EXEC2-NAME             PIC X(15).
  6846             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6847                                                          COMP-3.
  6848             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6849                                                          COMP-3.
  6850
  6851     12  AM-RETRO-ADDITIONAL-DATA.
  6852         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6853         16  AM-RETRO-PREM-P-E             PIC X.
  6854         16  AM-RETRO-CLMS-P-I             PIC X.
  6855         16  AM-RETRO-RET-BRACKET-LF.
  6856             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6857                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6858                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6859             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6860                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6861                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6862             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6863                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6864                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6865         16  AM-RETRO-RET-BRACKET-AH.
  6866             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6867                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6868                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6869                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6870             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6871                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6872                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6873             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6874                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6875                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6876
  6877     12  AM-COMMENTS.
  6878         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 126
* EL050.cbl
  6879
  6880     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6881         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6882         16  AM-FLI-BILLING-CODE           PIC X.
  6883         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6884         16  AM-FLI-UNITED-IDENT           PIC X.
  6885         16  AM-FLI-INTEREST-LOST-DATA.
  6886             20  AM-FLI-BANK-NO            PIC X(5).
  6887             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6888             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6889             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6890         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6891             20  AM-FLI-AGT                PIC X(9).
  6892             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6893             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6894         16  FILLER                        PIC X(102).
  6895
  6896     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6897         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6898             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6899             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6900             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6901             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6902             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6903         16  FILLER                          PIC X(10).
  6904******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 127
* EL050.cbl
  6906*    COPY ERCREIN.
  6907******************************************************************
  6908*                                                                *
  6909*                            ERCREIN                             *
  6910*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6911*                            VMOD=2.010                          *
  6912*                                                                *
  6913*   ONLINE CREDIT SYSTEM                                         *
  6914*                                                                *
  6915*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6916*                                                                *
  6917*   FILE TYPE = VSAM,KSDS                                        *
  6918*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6919*                                                                *
  6920*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6921*       ALTERNATE PATH = NONE                                    *
  6922*                                                                *
  6923*   LOG = NO                                                     *
  6924*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6925*                                                                *
  6926******************************************************************
  6927*                   C H A N G E   L O G
  6928*
  6929* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6930*-----------------------------------------------------------------
  6931*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6932* EFFECTIVE    NUMBER
  6933*-----------------------------------------------------------------
  6934* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6935* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6936******************************************************************
  6937 01  REINSURANCE-RECORD.
  6938     12  RE-RECORD-ID                      PIC XX.
  6939         88  VALID-RE-ID                      VALUE 'RE'.
  6940
  6941     12  RE-CONTROL-PRIMARY.
  6942         16  RE-COMPANY-CD                 PIC X.
  6943         16  RE-KEY.
  6944             20  RE-CODE                   PIC X.
  6945                 88  RE-TABLE-RECORD          VALUE 'A'.
  6946                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6947             20  RE-TABLE                  PIC XXX.
  6948             20  FILLER                    PIC XXX.
  6949         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6950             20  FILLER                    PIC X.
  6951             20  RE-COMPANY.
  6952                 24  RE-COMP-PRIME         PIC XXX.
  6953                 24  RE-COMP-SUB           PIC XXX.
  6954
  6955     12  RE-MAINT-INFORMATION.
  6956         16  RE-LAST-MAINT-DT              PIC XX.
  6957         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6958         16  RE-LAST-MAINT-USER            PIC X(4).
  6959         16  FILLER                        PIC X(10).
  6960
  6961     12  RE-TABLE-DATA.
  6962         16  RE-100-COMP                   PIC 99.
  6963
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 128
* EL050.cbl
  6964         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6965             20  RE-REI-COMP-NO.
  6966                 24  RE-REI-COMP           PIC XXX.
  6967                 24  RE-REI-COMP-SUB       PIC XXX.
  6968             20  RE-LF-QC                  PIC X.
  6969             20  RE-AH-QC                  PIC X.
  6970             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6971             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6972             20  RE-LFAGE-LO               PIC 99.
  6973             20  RE-LFAGE-HI               PIC 99.
  6974             20  RE-AHAGE-LO               PIC 99.
  6975             20  RE-AHAGE-HI               PIC 99.
  6976             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6977             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6978             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6979             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6980             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6981             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6982             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6983             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6984             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6985             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6986             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6987             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6988             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6989             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6990             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6991             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6992             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6993             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6994             20  RE-LF-BEN-CODE            PIC X.
  6995             20  RE-AH-BEN-CODE            PIC X.
  6996             20  RE-INTERACTIVE            PIC X.
  6997             20  RE-REMAINING              PIC X.
  6998             20  RE-LF-RUNOFF-SW           PIC X.
  6999             20  RE-AH-RUNOFF-SW           PIC X.
  7000             20  FILLER                    PIC X(19).
  7001
  7002         16  RE-COMP-INFO-END              PIC X(6).
  7003         16  RE-NSP-ST-CD-LF               PIC XX.
  7004         16  RE-NSP-ST-CD-AH               PIC XX.
  7005         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7006             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7007
  7008         16  FILLER                        PIC X(27).
  7009
  7010     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7011         16  RE-NAME                       PIC X(30).
  7012         16  RE-LF-PE                      PIC X.
  7013         16  RE-AH-PE                      PIC X.
  7014         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7015         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7016         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7017         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7018         16  RE-PRT-ST                     PIC X.
  7019         16  RE-PRT-OW                     PIC X.
  7020         16  RE-MORT-CODE                  PIC X(4).
  7021         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 129
* EL050.cbl
  7022         16  RE-ZERO-LF-FEE                PIC X.
  7023         16  RE-ZERO-AH-FEE                PIC X.
  7024         16  RE-CEDE-NAME                  PIC X(30).
  7025         16  RE-LF-COMM                    PIC X.
  7026         16  RE-AH-COMM                    PIC X.
  7027         16  RE-LF-TAX                     PIC X.
  7028         16  RE-AH-TAX                     PIC X.
  7029         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7030         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7031         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7032
  7033         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7034             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7035
  7036         16  RE-LF-CEDING-FEE-BRACKETS.
  7037             20  RE-LF-FEE-METHOD          PIC X.
  7038                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7039                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7040                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7041                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7042             20  RE-LF-FEE-BASIS           PIC X.
  7043                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7044                 88  RE-LF-NET-CEDED               VALUE '2'.
  7045                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7046                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7047                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7048                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7049                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7050                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7051             20  FILLER                    PIC XXX.
  7052             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7053                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7054                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7055
  7056         16  RE-AH-CEDING-FEE-BRACKETS.
  7057             20  RE-AH-FEE-METHOD          PIC X.
  7058                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7059                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7060                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7061                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7062             20  RE-AH-FEE-BASIS           PIC X.
  7063                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7064                 88  RE-AH-NET-CEDED               VALUE '2'.
  7065                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7066                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7067                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7068                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7069                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7070                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7071             20  FILLER                    PIC XXX.
  7072             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7073                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7074                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7075
  7076         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7077
  7078         16  RE-OLD-CEDING-STMT            PIC X.
  7079
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 130
* EL050.cbl
  7080         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7081         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7082         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7083         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7084         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7085         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7086         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7087         16  RE-MORT-SW                    PIC X.
  7088         16  RE-CEDING-TYPE-FLAG           PIC X.
  7089             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7090             88  RE-CEDED                          VALUE 'C'.
  7091             88  RE-ASSUMED                        VALUE 'A'.
  7092             88  RE-PHANTOM                        VALUE 'P'.
  7093
  7094         16  RE-CEDING-STMT-OPT-A          PIC X.
  7095             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7096         16  RE-CEDING-STMT-OPT-B          PIC X.
  7097             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7098         16  RE-CEDING-STMT-OPT-C          PIC X.
  7099             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7100         16  RE-CEDING-STMT-OPT-D          PIC X.
  7101             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7102         16  RE-CEDING-STMT-OPT-E          PIC X.
  7103             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7104
  7105         16  RE-PRT-CRSV                   PIC X.
  7106
  7107         16  RE-GL-CENTER                  PIC X(4).
  7108
  7109         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7110
  7111         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7112
  7113         16  RE-EARN-STOP-CODE             PIC X.
  7114             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7115             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7116
  7117         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7118             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7119
  7120         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7121         16  FILLER                        PIC X(2281).
  7122
  7123         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7124
  7125******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 131
* EL050.cbl
  7127*    COPY ERCCTBL.
  7128******************************************************************
  7129*                                                                *
  7130*                                                                *
  7131*                            ERCCTBL                             *
  7132*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7133*                            VMOD=2.003
  7134*                                                                *
  7135*   ONLINE CREDIT SYSTEM                                         *
  7136*                                                                *
  7137*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7138*                                                                *
  7139*   FILE TYPE = VSAM,KSDS                                        *
  7140*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7141*                                                                *
  7142*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7143*       ALTERNATE PATH = NONE                                    *
  7144*                                                                *
  7145*   LOG = NO                                                     *
  7146*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7147*                                                                *
  7148*                                                                *
  7149******************************************************************
  7150
  7151 01  COMM-TABLE-RECORD.
  7152     12  CT-RECORD-ID                      PIC XX.
  7153         88  VALID-CT-ID                      VALUE 'CT'.
  7154
  7155     12  CT-CONTROL-PRIMARY.
  7156         16  CT-COMPANY-CD                 PIC X.
  7157         16  CT-TABLE                      PIC XXX.
  7158         16  CT-CNTRL-2.
  7159             20  CT-BEN-TYPE               PIC X.
  7160             20  CT-BEN-CODE               PIC XX.
  7161
  7162     12  CT-MAINT-INFORMATION.
  7163         16  CT-LAST-MAINT-DT              PIC XX.
  7164         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7165         16  CT-LAST-MAINT-USER            PIC X(4).
  7166         16  FILLER                        PIC X(31).
  7167
  7168     12  CT-LIMITS.
  7169         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7170
  7171         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7172
  7173         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7174
  7175     12  CT-RATES.
  7176         16  CT-RTX          OCCURS 27 TIMES.
  7177             20  CT-RT                     PIC SV9(5)     COMP-3.
  7178             20  CT-RT-R   REDEFINES
  7179                 CT-RT                     PIC XXX.
  7180
  7181     12  FILLER                            PIC  X(42).
  7182
  7183******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 132
* EL050.cbl
  7185*    COPY ERCFORM.
  7186******************************************************************
  7187*                                                                *
  7188*                                                                *
  7189*                            ERCFORM.                            *
  7190*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7191*                            VMOD=2.003                          *
  7192*                                                                *
  7193*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7194*                                                                *
  7195*    FILE TYPE = VSAM,KSDS                                       *
  7196*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7197*                                                                *
  7198*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7199*                                                                *
  7200*    LOG = YES                                                   *
  7201*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7202******************************************************************
  7203 01  FORM-MASTER.
  7204    12  FO-RECORD-ID                 PIC X(02).
  7205        88  VALID-FO-ID                  VALUE 'FO'.
  7206
  7207    12  FO-CONTROL-PRIMARY.
  7208        16  FO-COMPANY-CD            PIC X(01).
  7209        16  FO-STATE                 PIC X(02).
  7210        16  FO-FORM-ID               PIC X(12).
  7211        16  FO-FORM-EXP-DT           PIC X(02).
  7212
  7213    12  FO-POLICY-FORM-DATA.
  7214        16  FO-IND-GRP-CD            PIC X(01).
  7215        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7216        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7217        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7218        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7219        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7220        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7221        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7222        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7223        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7224        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7225        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7226        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7227        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7228        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7229        16  FO-APP-CERT-USE-CD       PIC X(01).
  7230
  7231    12  FILLER                       PIC X(29).
  7232
  7233    12  FO-FORM-PLAN-TABLE.
  7234        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7235            20  FO-PLAN-TYPE         PIC X(01).
  7236            20  FO-PLAN-ID           PIC X(02).
  7237            20  FO-PLAN-TERM         PIC 9(03).
  7238            20  FO-PLAN-REFUND-METHOD
  7239                                     PIC X.
  7240
  7241    12  FILLER                       PIC X(30).
  7242
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 133
* EL050.cbl
  7243    12  FO-COMMENTS-AREA.
  7244        16  FO-COMMENT-LINE-1        PIC X(78).
  7245
  7246    12  FILLER                       PIC X(20).
  7247
  7248    12  FO-MAINT-INFORMATION.
  7249        16  FO-LAST-MAINT-DT         PIC X(02).
  7250        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7251        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 134
* EL050.cbl
  7253*    COPY ELCMSTR.
  7254******************************************************************
  7255*                                                                *
  7256*                            ELCMSTR.                            *
  7257*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7258*                            VMOD=2.012                          *
  7259*                                                                *
  7260*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7261*                                                                *
  7262*   FILE TYPE = VSAM,KSDS                                        *
  7263*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7264*                                                                *
  7265*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7266*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7267*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7268*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7269*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7270*                                                 RKP=75,LEN=21  *
  7271*                                                                *
  7272*   **** NOTE ****                                               *
  7273*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7274*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7275*                                                                *
  7276*   LOG = YES                                                    *
  7277*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7278******************************************************************
  7279*                   C H A N G E   L O G
  7280*
  7281* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7282*-----------------------------------------------------------------
  7283*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7284* EFFECTIVE    NUMBER
  7285*-----------------------------------------------------------------
  7286* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7287* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7288* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7289******************************************************************
  7290 01  CLAIM-MASTER.
  7291     12  CL-RECORD-ID                PIC XX.
  7292         88  VALID-CL-ID         VALUE 'CL'.
  7293
  7294     12  CL-CONTROL-PRIMARY.
  7295         16  CL-COMPANY-CD           PIC X.
  7296         16  CL-CARRIER              PIC X.
  7297         16  CL-CLAIM-NO             PIC X(7).
  7298         16  CL-CERT-NO.
  7299             20  CL-CERT-PRIME       PIC X(10).
  7300             20  CL-CERT-SFX         PIC X.
  7301
  7302     12  CL-CONTROL-BY-NAME.
  7303         16  CL-COMPANY-CD-A1        PIC X.
  7304         16  CL-INSURED-LAST-NAME    PIC X(15).
  7305         16  CL-INSURED-NAME.
  7306             20  CL-INSURED-1ST-NAME PIC X(12).
  7307             20  CL-INSURED-MID-INIT PIC X.
  7308
  7309     12  CL-CONTROL-BY-SSN.
  7310         16  CL-COMPANY-CD-A2        PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 135
* EL050.cbl
  7311         16  CL-SOC-SEC-NO.
  7312             20  CL-SSN-STATE        PIC XX.
  7313             20  CL-SSN-ACCOUNT      PIC X(6).
  7314             20  CL-SSN-LN3          PIC X(3).
  7315
  7316     12  CL-CONTROL-BY-CERT-NO.
  7317         16  CL-COMPANY-CD-A4        PIC X.
  7318         16  CL-CERT-NO-A4.
  7319             20  CL-CERT-A4-PRIME    PIC X(10).
  7320             20  CL-CERT-A4-SFX      PIC X.
  7321
  7322     12  CL-CONTROL-BY-CCN.
  7323         16  CL-COMPANY-CD-A5        PIC X.
  7324         16  CL-CCN-A5.
  7325             20  CL-CCN.
  7326                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7327                 24  CL-CCN-PRIME-A5 PIC X(12).
  7328             20  CL-CCN-FILLER-A5    PIC X(4).
  7329
  7330     12  CL-INSURED-PROFILE-DATA.
  7331         16  CL-INSURED-BIRTH-DT     PIC XX.
  7332         16  CL-INSURED-SEX-CD       PIC X.
  7333             88  INSURED-IS-MALE        VALUE 'M'.
  7334             88  INSURED-IS-FEMALE      VALUE 'F'.
  7335             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7336         16  CL-INSURED-OCC-CD       PIC X(6).
  7337         16  FILLER                  PIC X(5).
  7338
  7339     12  CL-PROCESSING-INFO.
  7340         16  CL-PROCESSOR-ID         PIC X(4).
  7341         16  CL-CLAIM-STATUS         PIC X.
  7342             88  CLAIM-IS-OPEN          VALUE 'O'.
  7343             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7344         16  CL-CLAIM-TYPE           PIC X.
  7345*            88  AH-CLAIM               VALUE 'A'.
  7346*            88  LIFE-CLAIM             VALUE 'L'.
  7347*            88  PROPERTY-CLAIM         VALUE 'P'.
  7348*            88  IUI-CLAIM              VALUE 'I'.
  7349*            88  GAP-CLAIM              VALUE 'G'.
  7350         16  CL-CLAIM-PREM-TYPE      PIC X.
  7351             88  SINGLE-PREMIUM         VALUE '1'.
  7352             88  O-B-COVERAGE           VALUE '2'.
  7353             88  OPEN-END-COVERAGE      VALUE '3'.
  7354         16  CL-INCURRED-DT          PIC XX.
  7355         16  CL-REPORTED-DT          PIC XX.
  7356         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7357         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7358         16  CL-LAST-PMT-DT          PIC XX.
  7359         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7360         16  CL-PAID-THRU-DT         PIC XX.
  7361         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7362         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7363         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7364         16  CL-PMT-CALC-METHOD      PIC X.
  7365             88  CL-360-DAY-YR          VALUE '1'.
  7366             88  CL-365-DAY-YR          VALUE '2'.
  7367             88  CL-FULL-MONTHS         VALUE '3'.
  7368         16  CL-CAUSE-CD             PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 136
* EL050.cbl
  7369
  7370         16  CL-PRIME-CERT-NO.
  7371             20  CL-PRIME-CERT-PRIME PIC X(10).
  7372             20  CL-PRIME-CERT-SFX   PIC X.
  7373
  7374         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7375             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7376             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7377
  7378         16  CL-MICROFILM-NO         PIC X(10).
  7379         16  CL-PROG-FORM-TYPE       PIC X.
  7380         16  CL-LAST-ADD-ON-DT       PIC XX.
  7381
  7382         16  CL-LAST-REOPEN-DT       PIC XX.
  7383         16  CL-LAST-CLOSE-DT        PIC XX.
  7384         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7385             88  FINAL-PAID             VALUE '1'.
  7386             88  CLAIM-DENIED           VALUE '2'.
  7387             88  AUTO-CLOSE             VALUE '3'.
  7388             88  MANUAL-CLOSE           VALUE '4'.
  7389             88  BENEFITS-CHANGED       VALUE 'C'.
  7390             88  SETUP-ERRORS           VALUE 'E'.
  7391         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7392         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7393         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7394             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7395         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7396         16  FILLER                  PIC X.
  7397
  7398     12  CL-CERTIFICATE-DATA.
  7399         16  CL-CERT-ORIGIN          PIC X.
  7400             88  CERT-WAS-ONLINE        VALUE '1'.
  7401             88  CERT-WAS-CREATED       VALUE '2'.
  7402             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7403         16  CL-CERT-KEY-DATA.
  7404             20  CL-CERT-CARRIER     PIC X.
  7405             20  CL-CERT-GROUPING    PIC X(6).
  7406             20  CL-CERT-STATE       PIC XX.
  7407             20  CL-CERT-ACCOUNT.
  7408                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7409                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7410             20  CL-CERT-EFF-DT      PIC XX.
  7411
  7412     12  CL-STATUS-CONTROLS.
  7413         16  CL-PRIORITY-CD          PIC X.
  7414             88  CONFIDENTIAL-DATA      VALUE '8'.
  7415             88  HIGHEST-PRIORITY       VALUE '9'.
  7416         16  CL-SUPV-ATTN-CD         PIC X.
  7417             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7418             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7419         16  CL-PURGED-DT            PIC XX.
  7420         16  CL-RESTORED-DT          PIC XX.
  7421         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7422         16  CL-NEXT-RESEND-DT       PIC XX.
  7423         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7424         16  CL-CRITICAL-PERIOD      PIC 99.
  7425*        16  FILLER                  PIC XX.
  7426         16  CL-LAST-MAINT-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 137
* EL050.cbl
  7427         16  CL-LAST-MAINT-USER      PIC X(4).
  7428         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7429         16  CL-LAST-MAINT-TYPE      PIC X.
  7430             88  CLAIM-SET-UP           VALUE ' '.
  7431             88  PAYMENT-MADE           VALUE '1'.
  7432             88  LETTER-SENT            VALUE '2'.
  7433             88  MASTER-WAS-ALTERED     VALUE '3'.
  7434             88  MASTER-WAS-RESTORED    VALUE '4'.
  7435             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7436             88  FILE-CONVERTED         VALUE '6'.
  7437             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7438             88  ERROR-CORRECTION       VALUE 'E'.
  7439         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7440         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7441         16  CL-BENEFICIARY          PIC X(10).
  7442         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7443         16  CL-DENIAL-TYPE          PIC X.
  7444             88  CL-TYPE-DENIAL          VALUE '1'.
  7445             88  CL-TYPE-RESCISSION      VALUE '2'.
  7446             88  CL-TYPE-REFORMATION     VALUE '3'.
  7447             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7448             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7449         16  CL-CRIT-PER-RECURRENT   PIC X.
  7450         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7451         16  CL-RTW-DT               PIC XX.
  7452
  7453     12  CL-TRAILER-CONTROLS.
  7454         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7455             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7456             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7457             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7458         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7459         16  FILLER                  PIC XX.
  7460         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7461         16  CL-ADDRESS-TRAILER-CNT.
  7462             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7463                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7464             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7465                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7466             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7467                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7468             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7469                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7470             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7471                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7472             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7473                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7474             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7475                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7476
  7477     12  CL-CV-REFERENCE-NO.
  7478         16  CL-CV-REFNO-PRIME       PIC X(18).
  7479         16  CL-CV-REFNO-SFX         PIC XX.
  7480
  7481     12  CL-FILE-LOCATION            PIC X(4).
  7482
  7483     12  CL-PROCESS-ERRORS.
  7484         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 138
* EL050.cbl
  7485             88  NO-FATAL-ERRORS        VALUE ZERO.
  7486         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7487             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7488
  7489     12  CL-PRODUCT-CD               PIC X.
  7490
  7491     12  CL-CURRENT-KEY-DATA.
  7492         16  CL-CURRENT-CARRIER      PIC X.
  7493         16  CL-CURRENT-GROUPING     PIC X(6).
  7494         16  CL-CURRENT-STATE        PIC XX.
  7495         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7496
  7497     12  CL-ASSOCIATES               PIC X.
  7498         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7499         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7500         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7501         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7502
  7503     12  CL-ACTIVITY-CODE            PIC 99.
  7504     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7505     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7506
  7507     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7508     12  CL-LAG-REPORT-CODE          PIC 9.
  7509     12  CL-LOAN-TYPE                PIC XX.
  7510     12  CL-LEGAL-STATE              PIC XX.
  7511
  7512     12  CL-YESNOSW                  PIC X.
  7513     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7514         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7515         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7516         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7517     12  cl-insured-claim            pic x.
  7518         88  cl-claim-on-primary         value 'P'.
  7519         88  cl-claim-on-secondary       value 'S'.
  7520     12  cl-benefit-expiration-dt    PIC XX.
  7521
  7522 01  PLAN-RECORDS.
  7523     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7524     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7525
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 139
* EL050.cbl
  7527 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7528                          ACCOUNT-MASTER REINSURANCE-RECORD
  7529                          COMM-TABLE-RECORD FORM-MASTER
  7530                          CLAIM-MASTER PLAN-RECORDS.
  7531 0000-DFHEXIT SECTION.
  7532     MOVE '9#                    $   ' TO DFHEIV0.
  7533     MOVE 'EL050' TO DFHEIV1.
  7534     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7535
  7536     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7537
  7538
  7539* EXEC CICS  HANDLE CONDITION
  7540*           ERROR    (9300-ABEND)
  7541*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7542*    END-EXEC.
  7543*    MOVE '"$.J                  ! " #00007534' TO DFHEIV0
  7544     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7545     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7546     MOVE X'2220233030303037353334' TO DFHEIV0(25:11)
  7547     CALL 'kxdfhei1' USING DFHEIV0
  7548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7549
  7550
  7551 0000-COPY-PROCEDURE-DIV.
  7552*                          COPY ELC50PD.
  7553******************************************************************
  7554*                                                                *
  7555*                            ELC50PD                             *
  7556*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7557*                            VMOD=2.188                          *
  7558*                                                                *
  7559******************************************************************
  7560*                   C H A N G E   L O G
  7561*
  7562* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7563*-----------------------------------------------------------------
  7564*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7565* EFFECTIVE    NUMBER
  7566*-----------------------------------------------------------------
  7567* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7568* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7569* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7570*                             2709 AND 2718
  7571* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7572* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7573* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7574* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7575* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7576*                                IS OPEN OR CNC DT < PD THRU
  7577* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7578* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7579* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7580* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7581* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7582* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7583* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7584* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 140
* EL050.cbl
  7585* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7586* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7587* 020906                   PEMA  EXPAND LOAN OFFICER
  7588* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7589* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7590* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7591* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7592* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7593* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7594* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7595* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7596* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7597* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7598* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7599* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7600* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7601* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7602* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7603* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7604* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7605* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7606* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7607* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7608* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7609* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7610* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7611* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7612* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7613*                                UPDATE VIN ON CERT TRAILER
  7614* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7615* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7616* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7617* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7618* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7619* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7620* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7621* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  7622* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7623* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7624* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7625* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7626* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7627* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7628* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7629* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7630* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7631* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7632* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7633* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7634* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7635* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7636* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7637* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7638* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7639* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7640* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7641* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7642* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 141
* EL050.cbl
  7643* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7644* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7645* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7646* 032912  CR2011110200001  PEMA  AHL CHANGES
  7647* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7648* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7649* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7650* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7651* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7652* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7653* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7654* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7655* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7656* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7657* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7658* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7659* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7660* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7661* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7662* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7663* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7664* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7665* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7666******************************************************************
  7667************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7668******************************************************************
  7669
  7670     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7671
  7672     MOVE SPACES                 TO PB-FATAL-FLAG
  7673                                    PB-FORCE-ER-CD
  7674                                    PB-WARN-ER-CD
  7675                                    PB-OUT-BAL-CD.
  7676
  7677     MOVE SPACE                  TO WS-IG-OVRD-AH
  7678                                    WS-IG-OVRD-LF
  7679                                    WS-IG-OVRD-AM
  7680                                    WS-IG-OVRD
  7681                                    WS-IG-OVRD-AH-PL
  7682                                    WS-IG-OVRD-LF-PL
  7683                                    WS-IG-OVRD-AH-BEN
  7684                                    WS-IG-OVRD-LF-BEN.
  7685
  7686******************************************************************
  7687*************       INITIALIZE COMMON ERRORS       ***************
  7688******************************************************************
  7689
  7690     MOVE +0                     TO PB-NO-OF-ERRORS.
  7691     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7692
  7693******************************************************************
  7694
  7695     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7696     SET JULIAN-TO-BIN           TO TRUE.
  7697*    MOVE 5                      TO DC-OPTION-CODE.
  7698     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7699     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7700
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 142
* EL050.cbl
  7701     MOVE ZERO                   TO  SUB4.
  7702
  7703 0040-INITIALIZE-GA-BILL-DT.
  7704
  7705     ADD +1                      TO  SUB4.
  7706
  7707     IF  SUB4 GREATER THAN +5
  7708         GO TO 0050-CHECK-CNTL-FOUND.
  7709
  7710     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7711         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7712
  7713     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7714
  7715 0050-CHECK-CNTL-FOUND.
  7716
  7717     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7718        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7719                                         WS-AH-REM-TERM-CALC
  7720                                         EC-CO-REM-TERM-CALC
  7721        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7722        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7723        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7724                                         WS-TOL-AH-CLAIM
  7725        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7726                                         WS-TOL-AH-PREM
  7727                                         EC-CO-TOL-PREM
  7728        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7729                                         WS-TOL-AH-REFUND
  7730                                         EC-CO-TOL-REFUND
  7731        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7732                                         WS-AH-REFUND-OVS-AMT
  7733                                         EC-CO-OVR-SHT-AMT
  7734        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7735                                         WS-TOL-AH-PREM-PCT
  7736                                         EC-CO-TOL-PREM-PCT
  7737        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7738                                         WS-TOL-AH-REFUND-PCT
  7739                                         EC-CO-TOL-REFUND-PCT
  7740        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7741                                         WS-AH-REFUND-OVS-PCT
  7742                                         EC-CO-OVR-SHT-PCT
  7743        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7744        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7745        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7746        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7747        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7748        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7749        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7750        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7751        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7752        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7753        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7754        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7755                                         EC-CO-MONTH-END-DT
  7756        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7757          GO TO 0100-READ-ACCT.
  7758
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 143
* EL050.cbl
  7759     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7760     MOVE SPACES                 TO CNTL-ACCESS.
  7761     MOVE '1'                    TO CNTL-REC-TYPE.
  7762     MOVE +0                     TO CNTL-SEQ-NO.
  7763
  7764     MOVE '1' TO RC-SW-1.
  7765     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7766     IF NOT CF-COMPANY-MASTER
  7767         MOVE ZEROS             TO WK-CO-TOL-PREM
  7768                                   WK-CO-TOL-CLAIM
  7769                                   WK-CO-TOL-REFUND
  7770                                   WK-REFUND-OVS-AMT
  7771                                   WK-REFUND-OVS-PCT
  7772                                   WK-CO-TOL-PREM-PCT
  7773                                   WK-CO-TOL-REFUND-PCT
  7774                                   WK-DEFAULT-APR
  7775                                   WK-CO-MAX-CAP
  7776        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7777                                   WK-CR-R78-METHOD
  7778                                   WK-CO-REF-REJECT-SW
  7779                                   WK-CO-PREM-REJECT-SW
  7780                                   WK-REM-TRM-CALC-OPTION
  7781                                   WK-BIRTH-DATE-INPUT
  7782                                   WK-JOINT-AGE-INPUT
  7783        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7784        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7785        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7786        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7787          GO TO 0099-COMPANY-NOT-FOUND.
  7788
  7789     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7790        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7791     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7792        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7793     IF CF-CO-TOL-CAP NOT NUMERIC
  7794        MOVE +0                    TO CF-CO-TOL-CAP.
  7795     IF CF-DEFAULT-APR NOT NUMERIC
  7796        MOVE +0                    TO CF-DEFAULT-APR.
  7797
  7798     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7799     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7800     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7801     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7802     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7803     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7804     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7805     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7806     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7807     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7808     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7809     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7810
  7811     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7812          CF-CO-OVR-SHT-AMT > +0
  7813        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7814
  7815     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7816          CF-CO-OVR-SHT-PCT > +0
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 144
* EL050.cbl
  7817        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7818
  7819     IF CF-VALID-REM-TRM-OPTION
  7820         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7821     ELSE
  7822         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7823
  7824     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7825     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7826     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7827     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7828
  7829     GO TO 0050-CHECK-CNTL-FOUND.
  7830
  7831 0099-COMPANY-NOT-FOUND.
  7832
  7833     MOVE ER-2616                TO WS-ERROR.
  7834     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7835
  7836 0100-READ-ACCT.
  7837
  7838     MOVE SPACES                 TO DATE-RANGE-SW.
  7839
  7840     IF WK-ACCT-ADDR = ZEROS
  7841        GO TO 0102-ACCT-GETMAIN.
  7842
  7843     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7844     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7845     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7846
  7847     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7848        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7849        GO TO 0105-READ-ACCT
  7850     END-IF
  7851
  7852     IF PB-CARRIER NOT = SPACES
  7853        IF PB-CARRIER NOT = AM-VG-CARRIER
  7854           GO TO 0105-READ-ACCT.
  7855
  7856     IF PB-STATE NOT = SPACES
  7857        IF PB-STATE NOT = AM-VG-STATE
  7858           GO TO 0105-READ-ACCT.
  7859
  7860     IF PB-GROUPING NOT = SPACES
  7861        IF PB-GROUPING NOT = AM-VG-GROUPING
  7862           GO TO 0105-READ-ACCT.
  7863
  7864     MOVE 'X'                 TO DATE-RANGE-SW.
  7865
  7866     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7867        MOVE 'X'                 TO DATE-RANGE-SW
  7868        GO TO 0105-READ-ACCT.
  7869
  7870     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7871        GO TO 0105-READ-ACCT.
  7872
  7873     GO TO 0180-ACCOUNT-FOUND.
  7874
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 145
* EL050.cbl
  7875 0102-ACCT-GETMAIN.
  7876     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  7877     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  7878
  7879 0105-READ-ACCT.
  7880     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  7881     MOVE PB-CARRIER             TO ACCT-CARRIER.
  7882     MOVE PB-GROUPING            TO ACCT-GROUPING.
  7883     MOVE PB-STATE               TO ACCT-STATE.
  7884     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  7885     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  7886
  7887     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  7888
  7889     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  7890
  7891 0110-FIND-ACCT-TOLERANCES-LOOP.
  7892     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  7893
  7894     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7895        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7896        GO TO 0199-ACCT-NOT-FOUND
  7897     END-IF
  7898     IF PB-CARRIER NOT = SPACES
  7899        IF PB-CARRIER NOT = AM-VG-CARRIER
  7900           GO TO 0199-ACCT-NOT-FOUND.
  7901
  7902     IF PB-STATE NOT = SPACES
  7903        IF PB-STATE NOT = AM-VG-STATE
  7904           GO TO 0199-ACCT-NOT-FOUND.
  7905
  7906     IF PB-GROUPING NOT = SPACES
  7907        IF PB-GROUPING NOT = AM-VG-GROUPING
  7908           GO TO 0199-ACCT-NOT-FOUND.
  7909
  7910     MOVE 'X'                    TO DATE-RANGE-SW.
  7911
  7912     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7913        MOVE 'X'                 TO DATE-RANGE-SW
  7914        GO TO 0199-ACCT-NOT-FOUND.
  7915
  7916     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7917        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  7918
  7919 0180-ACCOUNT-FOUND.
  7920     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  7921     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  7922     MOVE AM-STATE               TO PB-SV-STATE.
  7923     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  7924
  7925     IF AM-CANCEL-FEE  NOT NUMERIC
  7926        MOVE ZEROS TO AM-CANCEL-FEE.
  7927
  7928     IF AM-MAX-MON-BEN NOT NUMERIC
  7929        MOVE ZEROS TO AM-MAX-MON-BEN.
  7930
  7931     IF AM-MAX-TOT-BEN NOT NUMERIC
  7932        MOVE ZEROS TO AM-MAX-TOT-BEN.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 146
* EL050.cbl
  7933
  7934     IF AM-CLP-TOL-PCT NOT NUMERIC
  7935        MOVE +0                  TO AM-CLP-TOL-PCT
  7936     END-IF
  7937     IF AM-SPP-LEASE-COMM NOT NUMERIC
  7938        MOVE +0                  TO AM-SPP-LEASE-COMM
  7939     END-IF
  7940     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7941        MOVE ER-2611             TO   WS-ERROR
  7942        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7943
  7944     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7945        MOVE ER-2621             TO   WS-ERROR
  7946        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7947
  7948     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  7949        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  7950        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  7951        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  7952         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  7953
  7954     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  7955     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  7956     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  7957     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  7958     IF AM-CLP-TOL-PCT NOT = ZEROS
  7959        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  7960     END-IF
  7961     IF AM-SPP-LEASE-COMM NOT = ZEROS
  7962        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  7963     END-IF
  7964*    IF PB-COMPANY-ID = 'DCC'
  7965*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  7966*                                   WS-ADMIN-FEES
  7967*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  7968*          (SUB5 > +10)
  7969*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7970*             AND (AM-A-COM (SUB5) NUMERIC)
  7971*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7972*                + (AM-A-COM (SUB5) * 1000)
  7973*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  7974*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  7975*                + (AM-A-COM (SUB5) * 1000)
  7976*             END-IF
  7977*             IF AM-COM-TYP (SUB5) = 'N'
  7978*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  7979*                + (AM-A-COM (SUB5) * 1000)
  7980*             END-IF
  7981*          END-IF
  7982*       END-PERFORM
  7983*    END-IF
  7984     IF (PB-COMPANY-ID = 'DCC')
  7985        AND (PB-ISSUE)
  7986        MOVE +0                  TO WS-ACCT-ADDL-CLP
  7987        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  7988           (SUB5 > +10)
  7989           MOVE +0 TO WS-WK-RATE
  7990           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 147
* EL050.cbl
  7991              IF (AM-A-COM (SUB5) NUMERIC)
  7992                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  7993                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  7994              ELSE
  7995                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  7996                 IF PB-ISSUE
  7997                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  7998                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  7999                 ELSE
  8000                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8001                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8002                 END-IF
  8003                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8004                 MOVE ZEROS             TO WS-SUB1
  8005                                           WS-COMMISSION
  8006                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8007                 MOVE '0530'               TO CTBL-SW
  8008                 MOVE ' '                  TO WS-CTBL-READ-SW
  8009                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8010                 IF FIRST-TIME-THROUGH
  8011                    MOVE 'AA'              TO CTBL-BEN-CODE
  8012                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8013                 END-IF
  8014                 IF CTBL-TABLE-FOUND
  8015                    IF PB-ISSUE
  8016                       COMPUTE WS-COMM-CK-AMT =
  8017                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8018                    ELSE
  8019                       COMPUTE WS-COMM-CK-AMT =
  8020                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8021                    END-IF
  8022                    PERFORM 8800-GET-COMP-RATE
  8023                              THRU 8800-EXIT
  8024                 END-IF
  8025              END-IF
  8026              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8027                + (WS-WK-RATE * 1000)
  8028           END-IF
  8029        END-PERFORM
  8030     END-IF
  8031     IF PB-COMPANY-ID EQUAL 'CRI'
  8032         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8033
  8034     IF PB-COMPANY-ID EQUAL 'NCL'
  8035         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8036     END-IF
  8037
  8038     GO TO 0200-READ-CERT.
  8039
  8040 0199-ACCT-NOT-FOUND.
  8041
  8042     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8043
  8044     IF DATE-RANGE-SW NOT = SPACES
  8045        MOVE ER-2601             TO WS-ERROR
  8046        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8047     ELSE
  8048        MOVE ER-2619             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 148
* EL050.cbl
  8049        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8050
  8051     GO TO 9990-RETURN.
  8052
  8053 0200-READ-CERT.
  8054
  8055     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8056     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8057     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8058     MOVE PB-SV-STATE            TO CERT-STATE.
  8059     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8060     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8061     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8062
  8063     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8064
  8065     IF CERT-WAS-NOT-FOUND
  8066        GO TO 0299-CERT-NOT-FOUND.
  8067
  8068     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8069        MOVE ER-2759             TO WS-ERROR
  8070        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8071        GO TO 0298-UNLOCK-RETURN.
  8072
  8073     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8074         MOVE ER-2758            TO WS-ERROR
  8075         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8076         GO TO 0298-UNLOCK-RETURN.
  8077
  8078     IF PB-ISSUE
  8079        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8080           IF CERT-WAS-CREATED-FOR-CLAIM
  8081              NEXT SENTENCE
  8082            ELSE
  8083              MOVE ER-2626       TO WS-ERROR
  8084              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8085              GO TO 0298-UNLOCK-RETURN.
  8086
  8087     IF NOT PB-CANCELLATION
  8088        GO TO 0300-CONTINUE-EDIT.
  8089
  8090     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8091     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8092     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8093     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8094     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8095     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8096
  8097     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8098     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8099     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8100     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8101     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8102     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8103     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8104     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8105     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8106
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 149
* EL050.cbl
  8107     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8108     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8109     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8110     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8111     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8112     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8113     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8114
  8115     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8116     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8117
  8118     MOVE CM-CREDIT-INTERFACE-SW-1
  8119                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8120     MOVE CM-CREDIT-INTERFACE-SW-2
  8121                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8122
  8123     IF CM-O-B-COVERAGE
  8124         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8125
  8126     IF CM-LIVES NOT NUMERIC
  8127         MOVE ZERO                TO CM-LIVES.
  8128
  8129     IF CM-BILLED NOT NUMERIC
  8130         MOVE ZERO                TO CM-BILLED.
  8131
  8132     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8133         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8134         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8135         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8136         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8137         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8138         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8139         MOVE CM-LIVES             TO PB-CI-LIVES
  8140*The next line causes a problem with my change  I dont think it is
  8141*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8142
  8143     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8144     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8145     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8146     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8147     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8148     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8149
  8150     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8151     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8152     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8153     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8154
  8155     IF CM-LIFE-COMM-PCT NUMERIC
  8156         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8157     ELSE
  8158         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8159
  8160     IF CM-AH-COMM-PCT NUMERIC
  8161         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8162     ELSE
  8163         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8164
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 150
* EL050.cbl
  8165     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8166
  8167     IF CM-LOAN-APR       NOT NUMERIC
  8168           MOVE ZERO               TO CM-LOAN-APR.
  8169
  8170     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8171           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8172
  8173     IF CM-LOAN-TERM      NOT NUMERIC
  8174           MOVE ZERO               TO CM-LOAN-TERM.
  8175
  8176     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8177           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8178
  8179     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8180           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8181
  8182     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8183     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8184     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8185     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8186     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8187     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8188     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8189     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8190     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8191     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8192     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8193     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8194
  8195     IF CM-STATE = CM-SSN-STATE
  8196         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8197
  8198     IF CM-STATE NOT = CM-MEMB-STATE
  8199         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8200
  8201     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8202
  8203     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
  8204        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8205        IF CM-ADDL-CLP NOT NUMERIC
  8206           MOVE +0               TO CM-ADDL-CLP
  8207        END-IF
  8208        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8209        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8210           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8211        END-IF
  8212     END-IF
  8213     IF PB-COMPANY-ID = 'DCC'
  8214        MOVE +0                  TO WS-ADMIN-FEES
  8215                                    WS-CSO-ADMIN-FEE
  8216                                    WS-COMM-AND-MFEE
  8217                                    WS-1ST-YR-ALLOW
  8218        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8219           (SUB5 > +10)
  8220           MOVE +0 TO WS-WK-RATE
  8221           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8222              IF (AM-A-COM (SUB5) NUMERIC)
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 151
* EL050.cbl
  8223                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8224                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8225              ELSE
  8226                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8227                 IF PB-ISSUE
  8228                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8229                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8230                 ELSE
  8231                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8232                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8233                 END-IF
  8234                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8235                 MOVE ZEROS             TO WS-SUB1
  8236                                           WS-COMMISSION
  8237                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8238                 MOVE '0530'               TO CTBL-SW
  8239                 MOVE ' '                  TO WS-CTBL-READ-SW
  8240                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8241                 IF FIRST-TIME-THROUGH
  8242                    MOVE 'AA'              TO CTBL-BEN-CODE
  8243                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8244                 END-IF
  8245                 IF CTBL-TABLE-FOUND
  8246                    IF PB-ISSUE
  8247                       COMPUTE WS-COMM-CK-AMT =
  8248                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8249                    ELSE
  8250                       COMPUTE WS-COMM-CK-AMT =
  8251                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8252                    END-IF
  8253                    PERFORM 8800-GET-COMP-RATE
  8254                              THRU 8800-EXIT
  8255                 END-IF
  8256              END-IF
  8257              IF AM-COM-TYP (SUB5) = 'I'
  8258                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8259                   + (WS-WK-RATE * 1000)
  8260              END-IF
  8261              IF AM-COM-TYP (SUB5) = 'N'
  8262                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8263                   + (WS-WK-RATE * 1000)
  8264              END-IF
  8265              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8266                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8267                   + (WS-WK-RATE * 1000)
  8268              END-IF
  8269              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8270                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8271                   + (WS-WK-RATE * 1000)
  8272              END-IF
  8273           END-IF
  8274        END-PERFORM
  8275     END-IF
  8276     GO TO 0300-CONTINUE-EDIT.
  8277
  8278 0298-UNLOCK-RETURN.
  8279      PERFORM 9250-UNLOCK-RETURN
  8280      GO TO 9990-RETURN.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 152
* EL050.cbl
  8281
  8282 0299-CERT-NOT-FOUND.
  8283
  8284     MOVE '1'                     TO CERT-STATUS-SW.
  8285
  8286     IF PB-COMPANY-ID = 'UCL'
  8287         IF WS-ERROR = ER-2799
  8288             GO TO 3000-CONTINUE-EDIT.
  8289
  8290     IF NOT PB-CANCELLATION
  8291         GO TO 0300-CONTINUE-EDIT.
  8292
  8293     MOVE ER-2726                  TO  WS-ERROR.
  8294     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8295     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8296     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8297                                    PB-CI-LF-TERM
  8298                                    PB-C-LF-REM-TERM
  8299                                    PB-CI-AH-TERM
  8300                                    PB-C-AH-REM-TERM
  8301                                    PB-CI-LF-BENEFIT-CD
  8302                                    PB-CI-LF-BENEFIT-AMT
  8303                                    PB-CI-LF-ALT-BENEFIT-AMT
  8304                                    PB-CI-LF-PREMIUM-AMT
  8305                                    PB-CI-LF-ALT-PREMIUM-AMT
  8306                                    PB-CI-AH-BENEFIT-CD
  8307                                    PB-CI-AH-BENEFIT-AMT
  8308                                    PB-CI-AH-PREMIUM-AMT
  8309                                    PB-CI-PAY-FREQUENCY
  8310                                    PB-CI-LOAN-APR
  8311                                    PB-CI-LOAN-TERM
  8312                                    PB-CI-LIFE-COMMISSION
  8313                                    PB-CI-AH-COMMISSION
  8314                                    PB-CI-CURR-SEQ
  8315                                    PB-CI-AH-CANCEL-AMT
  8316                                    PB-CI-LF-CANCEL-AMT
  8317                                    PB-CI-RATE-DEV-PCT-LF
  8318                                    PB-CI-RATE-DEV-PCT-AH
  8319                                    PB-CI-EXTENTION-DAYS
  8320                                    PB-CI-TERM-IN-DAYS
  8321                                    PB-CI-LIVES
  8322                                    PB-CI-LF-CRIT-PER
  8323                                    PB-CI-AH-CRIT-PER
  8324                                    PB-CI-ADDL-CLP
  8325                                    PB-CI-DDF-IU-RATE-UP.
  8326
  8327     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8328                                    PB-CI-AH-SETTLEMENT-DT
  8329                                    PB-CI-DEATH-DT
  8330                                    PB-CI-LF-PRIOR-CANCEL-DT
  8331                                    PB-CI-AH-PRIOR-CANCEL-DT
  8332                                    PB-CI-ENTRY-DT
  8333                                    PB-CI-LF-EXPIRE-DT
  8334                                    PB-CI-AH-EXPIRE-DT
  8335                                    PB-CI-LOAN-1ST-PMT-DT.
  8336
  8337     IF ACCOUNT-MAST-FOUND
  8338        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 153
* EL050.cbl
  8339        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8340
  8341
  8342 0300-CONTINUE-EDIT.
  8343
  8344     IF PB-ISSUE
  8345        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8346            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8347
  8348     IF PB-ISSUE
  8349        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8350            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8351
  8352     IF PB-ISSUE
  8353       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8354          (AM-NO-AH-ONLY)
  8355           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8356               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8357                   MOVE ER-2679 TO WS-ERROR
  8358                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8359
  8360     IF PB-ISSUE
  8361        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8362        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8363        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8364     ELSE
  8365        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8366        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8367        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8368
  8369     MOVE 'N'                    TO PLAN-MASTER-SW
  8370                                    PLAN-MASTER-LIFE-SW
  8371                                    FORM-MASTER-SW
  8372                                    WS-APP-CERT-SW.
  8373
  8374     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8375                                    WS-PL-TOL-LF-REFUND
  8376                                    WS-PL-REF-OVS-AMT
  8377                                    WS-PL-TOL-LF-PREM-PCT
  8378                                    WS-PL-TOL-LF-REFUND-PCT
  8379                                    WS-PL-REF-OVS-PCT
  8380                                    WS-PL-TOL-LF-CLAIM.
  8381
  8382     IF PB-COMPANY-ID = 'NCL'
  8383       IF PB-ISSUE
  8384         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8385             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8386             IF FORM-MASTER-FOUND
  8387                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8388
  8389     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8390        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8391
  8392********************** MON CODE **********************
  8393     IF PB-COMPANY-ID = 'MON'
  8394     IF PB-ISSUE
  8395     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8396        AND (PB-I-LOAN-APR NOT NUMERIC OR
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 154
* EL050.cbl
  8397             PB-I-LOAN-APR = ZERO)
  8398               MOVE 14.0         TO PB-I-LOAN-APR.
  8399******************************************************
  8400
  8401     IF PB-COMPANY-ID = 'NCL'
  8402       IF PB-ISSUE
  8403           IF FORM-MASTER-FOUND
  8404             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8405                AM-DISMBR-COVERAGE
  8406                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8407                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8408                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8409                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8410                                           PB-I-LIFE-BENEFIT-CD.
  8411
  8412     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8413
  8414     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8415         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8416         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8417         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8418         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8419         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8420           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8421             GO TO 0301-LIFE-BENEFIT-SEARCH
  8422         ELSE
  8423             NEXT SENTENCE
  8424     ELSE
  8425         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8426
  8427     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8428     MOVE '4'                    TO CNTL-REC-TYPE.
  8429     MOVE +0                     TO CNTL-SEQ-NO.
  8430     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8431
  8432     MOVE '1' TO RC-SW-2.
  8433     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8434
  8435     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8436        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8437         GO TO 0305-BENEFIT-NOT-FOUND.
  8438
  8439     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8440
  8441 0301-LIFE-BENEFIT-SEARCH.
  8442
  8443     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8444
  8445     IF NO-BENEFIT-FOUND
  8446        GO TO 0305-BENEFIT-NOT-FOUND.
  8447
  8448     IF WS-BEN-CD = '99'
  8449        GO TO 0305-BENEFIT-NOT-FOUND.
  8450
  8451     IF PB-COMPANY-ID = 'NCL'
  8452         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8453             GO TO 0304-LIFE-BENEFIT-FOUND.
  8454
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 155
* EL050.cbl
  8455     MOVE +1                     TO SUB5.
  8456     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8457
  8458* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8459* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8460     IF PB-COMPANY-ID = 'DMD'
  8461         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8462
  8463 0302-EDIT-ACCT-LF-BENEFITS.
  8464
  8465     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8466        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8467           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8468                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8469           GO TO 03XX-GET-LIFE-ERPLAN.
  8470
  8471     IF SUB5 LESS THAN +20
  8472        ADD +1                   TO SUB5
  8473        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8474
  8475     MOVE +1                     TO SUB5.
  8476
  8477     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8478        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8479
  8480 0303-EDIT-DMD-EXTRA-BENEFITS.
  8481
  8482     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8483        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8484           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8485                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8486           GO TO 03XX-GET-LIFE-ERPLAN.
  8487
  8488     IF SUB5 LESS THAN +30
  8489        ADD +1                   TO SUB5
  8490        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8491
  8492     MOVE +1                     TO SUB5.
  8493
  8494 03XX-EDIT-FOR-NINETY-LF.
  8495
  8496***************************************************************
  8497*                                                             *
  8498*    NINETY BENEFIT PLAN TYPES:                               *
  8499*                                                             *
  8500*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8501*      92 = ALL GROUP REDUCING BENEFITS                       *
  8502*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8503*      94 = ALL GROUP LEVEL BENEFITS                          *
  8504*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8505*           BENEFIT CONTROLS.                                 *
  8506*      99 = ALL BENEFITS                                      *
  8507*                                                             *
  8508***************************************************************
  8509
  8510     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8511                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8512
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 156
* EL050.cbl
  8513     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8514       AND
  8515        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8516        GO TO 03XX-GET-LIFE-ERPLAN.
  8517
  8518     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8519       AND
  8520        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8521        IF CF-REDUCING (SUB3)
  8522           IF (PB-I-INDV-GRP-OVRD = 'I')
  8523              OR
  8524           ((AM-IG = '1') AND
  8525           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8526              OR
  8527           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8528           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8529           (AM-IG NOT = '2'))
  8530              GO TO 03XX-GET-LIFE-ERPLAN.
  8531
  8532     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8533       AND
  8534        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8535        IF CF-REDUCING (SUB3)
  8536           IF (PB-I-INDV-GRP-OVRD = 'G')
  8537              OR
  8538           ((AM-IG = '2') AND
  8539           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8540              OR
  8541           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8542           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8543           (AM-IG NOT = '1'))
  8544              GO TO 03XX-GET-LIFE-ERPLAN.
  8545
  8546     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8547       AND
  8548        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8549        IF CF-LEVEL    (SUB3)
  8550           IF (PB-I-INDV-GRP-OVRD = 'I')
  8551              OR
  8552           ((AM-IG = '1') AND
  8553           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8554              OR
  8555           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8556           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8557            (AM-IG NOT = '2'))
  8558              GO TO 03XX-GET-LIFE-ERPLAN.
  8559
  8560     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8561       AND
  8562        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8563        IF CF-LEVEL    (SUB3)
  8564           IF (PB-I-INDV-GRP-OVRD = 'G')
  8565              OR
  8566           ((AM-IG = '2') AND
  8567           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8568              OR
  8569           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8570           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 157
* EL050.cbl
  8571           (AM-IG NOT = '1'))
  8572              GO TO 03XX-GET-LIFE-ERPLAN.
  8573
  8574     IF SUB5 LESS THAN +20
  8575        ADD +1                   TO SUB5
  8576        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8577
  8578     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8579
  8580     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8581        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8582
  8583     MOVE +1                     TO SUB5.
  8584
  8585 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8586
  8587     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8588                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8589
  8590     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8591       AND
  8592        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8593        GO TO 03XX-GET-LIFE-ERPLAN.
  8594
  8595     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8596       AND
  8597        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8598        IF CF-REDUCING (SUB3)
  8599           IF (PB-I-INDV-GRP-OVRD = 'I')
  8600              OR
  8601           ((AM-IG = '1') AND
  8602           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8603              OR
  8604           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8605           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8606           (AM-IG NOT = '2'))
  8607              GO TO 03XX-GET-LIFE-ERPLAN.
  8608
  8609     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8610       AND
  8611        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8612        IF CF-REDUCING (SUB3)
  8613           IF (PB-I-INDV-GRP-OVRD = 'G')
  8614              OR
  8615           ((AM-IG = '2') AND
  8616           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8617              OR
  8618           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8619           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8620           (AM-IG NOT = '1'))
  8621              GO TO 03XX-GET-LIFE-ERPLAN.
  8622
  8623     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8624       AND
  8625        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8626        IF CF-LEVEL    (SUB3)
  8627           IF (PB-I-INDV-GRP-OVRD = 'I')
  8628              OR
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 158
* EL050.cbl
  8629           ((AM-IG = '1') AND
  8630           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8631              OR
  8632           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8633           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8634            (AM-IG NOT = '2'))
  8635              GO TO 03XX-GET-LIFE-ERPLAN.
  8636
  8637     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8638       AND
  8639        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8640        IF CF-LEVEL    (SUB3)
  8641           IF (PB-I-INDV-GRP-OVRD = 'G')
  8642              OR
  8643           ((AM-IG = '2') AND
  8644           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8645              OR
  8646           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8647           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8648           (AM-IG NOT = '1'))
  8649              GO TO 03XX-GET-LIFE-ERPLAN.
  8650
  8651     IF SUB5 LESS THAN +30
  8652        ADD +1                   TO SUB5
  8653        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8654
  8655     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8656
  8657 03XX-EDIT-FOR-NINETY-LF-CONT.
  8658
  8659     MOVE +99                    TO SUB5.
  8660
  8661     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8662        IF PB-ISSUE
  8663           MOVE ER-1924          TO  WS-ERROR
  8664           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8665
  8666     GO TO 0304-LIFE-BENEFIT-FOUND.
  8667
  8668 03XX-GET-LIFE-ERPLAN.
  8669
  8670     IF WK-PLAN-ADDR EQUAL +0
  8671        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8672
  8673     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8674     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8675     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8676     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8677     MOVE 'Y'                    TO PLAN-MASTER-SW
  8678                                    PLAN-MASTER-LIFE-SW.
  8679     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8680
  8681 03XX-ERPLAN-LIFE-GETMAIN.
  8682
  8683     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8684     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8685
  8686 03XX-ERPLAN-LIFE-READ.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 159
* EL050.cbl
  8687
  8688     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8689     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8690     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8691     MOVE PB-SV-STATE            TO PLAN-STATE.
  8692     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8693     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8694     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8695     MOVE WS-SAVE-BENEFIT-REVISION
  8696                                 TO PLAN-REVISION-NO.
  8697
  8698     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8699     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8700
  8701     IF PB-COMPANY-ID = 'NCL'
  8702       IF NOT LF-PLAN-MASTER-FOUND
  8703         IF NOT PB-POLICY-IS-DECLINED  AND
  8704            NOT PB-POLICY-IS-VOIDED
  8705             MOVE  ER-1921         TO  WS-ERROR
  8706             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8707             GO TO 0304-LIFE-BENEFIT-FOUND.
  8708
  8709     IF NOT LF-PLAN-MASTER-FOUND
  8710        GO TO 0304-LIFE-BENEFIT-FOUND.
  8711
  8712 XXXX-CHECK-LF-PLAN-KEY.
  8713
  8714     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8715        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8716        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8717        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8718        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8719        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8720        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8721        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8722        MOVE 'N'                 TO PLAN-MASTER-SW
  8723          GO TO 03XX-ERPLAN-LIFE-READ.
  8724
  8725     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8726
  8727     IF  PB-CANCELLATION
  8728         GO TO  0303-LF-ACCT-BEN-FOUND.
  8729
  8730     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8731        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8732           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8733           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8734              MOVE ER-2644             TO WS-ERROR
  8735              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8736           ELSE
  8737              NEXT SENTENCE
  8738        ELSE
  8739           IF PB-COMPANY-ID NOT = 'NCL'
  8740              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8741                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8742
  8743 0303-LF-ACCT-BEN-FOUND.
  8744
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 160
* EL050.cbl
  8745     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8746
  8747     IF PL-DEV-CODE NOT = SPACES
  8748        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8749
  8750     IF PL-DEV-PCT NUMERIC AND
  8751        PL-DEV-PCT NOT = ZEROS
  8752        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8753
  8754     IF PL-TOL-PREM-AMT GREATER THAN +0
  8755        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8756
  8757     IF PL-TOL-REF-AMT GREATER THAN +0
  8758        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8759
  8760     IF PL-TOL-PREM-PCT GREATER THAN +0
  8761        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8762
  8763     IF PL-TOL-REF-PCT GREATER THAN +0
  8764        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8765
  8766     IF PL-TOL-CLM-AMT GREATER THAN +0
  8767        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8768
  8769     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8770                          PL-OVER-SHORT-AMT > +0
  8771        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8772
  8773     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8774                          PL-OVER-SHORT-PCT > +0
  8775        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8776
  8777     IF PL-SALES-TAX NUMERIC AND
  8778                          PL-SALES-TAX > +0
  8779         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8780
  8781     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8782        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8783                                    WS-IG-OVRD-AM.
  8784
  8785 0304-LIFE-BENEFIT-FOUND.
  8786
  8787     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8788
  8789     IF PB-ISSUE
  8790        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8791     ELSE
  8792        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8793
  8794     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8795     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8796     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8797     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8798     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8799                                         WS-LF-REFUND-CALC.
  8800     if (ws-lf-earnings-calc = '5')
  8801        and (pb-i-loan-apr = zeros)
  8802        and (benefit-code-chg)
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 161
* EL050.cbl
  8803        move +99.9999 to pb-i-loan-apr
  8804     end-if
  8805
  8806     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8807        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8808
  8809     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  8810        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8811     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8812
  8813     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8814     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8815     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8816     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8817     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8818     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8819
  8820     IF PB-COMPANY-ID = 'NCL'  AND
  8821        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8822         NEXT SENTENCE
  8823     ELSE
  8824         IF SUB5 NOT GREATER THAN +20
  8825            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8826               MOVE WS-SAVE-BENEFIT-REM-TERM
  8827                                      TO WS-AM-LF-BENE-REM-TERM
  8828                                         EC-BR-LF-REM-TERM-CALC.
  8829
  8830     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8831     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8832
  8833     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8834
  8835 0305-BENEFIT-NOT-FOUND.
  8836
  8837     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8838     MOVE ER-2604                TO WS-ERROR.
  8839     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8840
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 162
* EL050.cbl
  8842
  8843 0310-FIND-AH-BENEFIT-RECORD.
  8844
  8845     MOVE 'N'                    TO PLAN-MASTER-SW
  8846                                    PLAN-MASTER-AH-SW.
  8847
  8848     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  8849                                    WS-PL-TOL-AH-REFUND
  8850                                    WS-AH-PL-REF-OVS-AMT
  8851                                    WS-PL-TOL-AH-PREM-PCT
  8852                                    WS-PL-TOL-AH-REFUND-PCT
  8853                                    WS-AH-PL-REF-OVS-PCT
  8854                                    WS-PL-TOL-AH-CLAIM.
  8855     MOVE ' '                    TO WS-AH-DCC-TRUNC
  8856
  8857
  8858     if pb-issue
  8859        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  8860           MOVE SPACES              TO PB-I-AH-INPUT-CD
  8861        end-if
  8862        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  8863           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  8864           GO TO 0399-BENEFIT-NOT-FOUND
  8865        end-if
  8866     end-if
  8867
  8868     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  8869        GO TO 0400-FIND-CARRIER.
  8870
  8871     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  8872
  8873     IF WK-AH-BEN-ADDR NOT = ZEROS
  8874         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  8875         SET ELCNTL-FILE-ADDRESSED TO TRUE
  8876         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8877         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8878           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8879             GO TO 0311-AH-BENEFIT-SEARCH
  8880         ELSE
  8881             NEXT SENTENCE
  8882     ELSE
  8883         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8884
  8885     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8886     MOVE '5'                    TO CNTL-REC-TYPE.
  8887     MOVE +0                     TO CNTL-SEQ-NO.
  8888     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8889
  8890     MOVE '2' TO RC-SW-2.
  8891     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8892
  8893     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8894        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8895          GO TO 0399-BENEFIT-NOT-FOUND.
  8896
  8897     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  8898
  8899 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 163
* EL050.cbl
  8900
  8901     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8902
  8903     IF NO-BENEFIT-FOUND
  8904         GO TO 0399-BENEFIT-NOT-FOUND.
  8905
  8906     IF WS-BEN-CD = '99'
  8907        GO TO 0399-BENEFIT-NOT-FOUND.
  8908
  8909     IF PB-COMPANY-ID  =  'NCL'
  8910         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8911             GO TO 0314-A-H-BENEFIT-FOUND.
  8912
  8913     MOVE +1                     TO SUB5.
  8914     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8915
  8916* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8917* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8918     IF PB-COMPANY-ID = 'DMD'
  8919         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8920
  8921 0312-EDIT-ACCT-AH-BENEFITS.
  8922
  8923     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8924        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  8925           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8926                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8927           GO TO 03XX-GET-AH-ERPLAN.
  8928
  8929     IF SUB5 LESS THAN +20
  8930        ADD +1                   TO SUB5
  8931        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  8932
  8933     MOVE +1                     TO SUB5.
  8934
  8935     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8936        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8937
  8938 0313-EDIT-DMD-EXTRA-BENEFITS.
  8939
  8940     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8941        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  8942           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8943                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8944           GO TO 03XX-GET-AH-ERPLAN.
  8945
  8946     IF SUB5 LESS THAN +30
  8947        ADD +1                   TO SUB5
  8948        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  8949
  8950     MOVE +1                     TO SUB5.
  8951
  8952 03XX-EDIT-FOR-NINETY-AH.
  8953
  8954***************************************************************
  8955*                                                             *
  8956*    NINETY BENEFIT PLAN TYPES:                               *
  8957*                                                             *
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 164
* EL050.cbl
  8958*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8959*      92 = ALL GROUP REDUCING BENEFITS.                      *
  8960*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8961*           BENEFIT CONTROLS.                                 *
  8962*      99 = ALL BENEFITS.                                     *
  8963*                                                             *
  8964***************************************************************
  8965
  8966     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8967                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8968
  8969     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8970       AND
  8971        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8972        GO TO 03XX-GET-AH-ERPLAN.
  8973
  8974     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  8975       AND
  8976        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8977           IF (PB-I-INDV-GRP-OVRD = 'I')
  8978              OR
  8979           ((AM-IG = '1') AND
  8980           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8981              OR
  8982           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8983           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8984           (AM-IG NOT = '2'))
  8985              GO TO 03XX-GET-AH-ERPLAN.
  8986
  8987     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  8988       AND
  8989        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8990           IF (PB-I-INDV-GRP-OVRD = 'G')
  8991              OR
  8992           ((AM-IG = '2') AND
  8993           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8994              OR
  8995           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8996           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8997           (AM-IG NOT = '1'))
  8998              GO TO 03XX-GET-AH-ERPLAN.
  8999
  9000     IF SUB5 LESS THAN +20
  9001        ADD +1                   TO SUB5
  9002        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9003
  9004     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9005        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9006
  9007     MOVE +1                    TO SUB5.
  9008
  9009 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9010
  9011     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9012                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9013
  9014     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9015       AND
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 165
* EL050.cbl
  9016        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9017        GO TO 03XX-GET-AH-ERPLAN.
  9018
  9019     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9020       AND
  9021        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9022           IF (PB-I-INDV-GRP-OVRD = 'I')
  9023              OR
  9024           ((AM-IG = '1') AND
  9025           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9026              OR
  9027           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9028           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9029           (AM-IG NOT = '2'))
  9030              GO TO 03XX-GET-AH-ERPLAN.
  9031
  9032     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9033       AND
  9034        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9035           IF (PB-I-INDV-GRP-OVRD = 'G')
  9036              OR
  9037           ((AM-IG = '2') AND
  9038           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9039              OR
  9040           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9041           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9042           (AM-IG NOT = '1'))
  9043              GO TO 03XX-GET-AH-ERPLAN.
  9044
  9045     IF SUB5 LESS THAN +30
  9046        ADD +1                   TO SUB5
  9047        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9048
  9049 03XX-EDIT-FOR-NINETY-AH-CONT.
  9050
  9051     MOVE +99                    TO SUB5.
  9052
  9053     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9054
  9055     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9056        IF PB-ISSUE
  9057           MOVE ER-1925          TO  WS-ERROR
  9058           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9059
  9060     GO TO 0314-A-H-BENEFIT-FOUND.
  9061
  9062 03XX-GET-AH-ERPLAN.
  9063
  9064     IF WK-PLAN-ADDR EQUAL +0
  9065         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9066
  9067     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9068     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9069     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9070     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9071     MOVE 'Y'                    TO PLAN-MASTER-SW
  9072                                    PLAN-MASTER-AH-SW.
  9073*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 166
* EL050.cbl
  9074     GO TO 03XX-ERPLAN-AH-READ.
  9075
  9076 03XX-ERPLAN-AH-GETMAIN.
  9077
  9078     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9079     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9080
  9081 03XX-ERPLAN-AH-READ.
  9082
  9083     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9084     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9085     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9086     MOVE PB-SV-STATE            TO PLAN-STATE.
  9087     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9088     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9089     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9090     MOVE WS-SAVE-BENEFIT-REVISION
  9091                                 TO PLAN-REVISION-NO.
  9092
  9093     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9094     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9095
  9096     IF PB-COMPANY-ID = 'NCL'
  9097       IF NOT AH-PLAN-MASTER-FOUND
  9098         IF NOT PB-POLICY-IS-DECLINED  AND
  9099            NOT PB-POLICY-IS-VOIDED
  9100             MOVE  ER-1922         TO  WS-ERROR
  9101             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9102             GO TO 0314-A-H-BENEFIT-FOUND.
  9103
  9104     IF NOT AH-PLAN-MASTER-FOUND
  9105        GO TO 0314-A-H-BENEFIT-FOUND.
  9106
  9107 XXXX-CHECK-AH-PLAN-KEY.
  9108
  9109     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9110        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9111        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9112        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9113        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9114        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9115        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9116        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9117        MOVE 'N'                 TO PLAN-MASTER-SW
  9118          GO TO 03XX-ERPLAN-AH-READ.
  9119
  9120     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9121
  9122     IF  PB-CANCELLATION
  9123         GO TO  0313-AH-ACCT-BEN-FOUND.
  9124
  9125     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9126       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9127          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9128          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9129             MOVE ER-2644             TO WS-ERROR
  9130             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9131          ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 167
* EL050.cbl
  9132             NEXT SENTENCE
  9133       ELSE
  9134          IF PB-COMPANY-ID NOT = 'NCL'
  9135             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9136                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9137
  9138 0313-AH-ACCT-BEN-FOUND.
  9139
  9140     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9141
  9142     IF PL-DEV-CODE NOT = SPACES
  9143        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9144
  9145     IF PL-DEV-PCT NUMERIC AND
  9146        PL-DEV-PCT NOT = ZEROS
  9147        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9148
  9149     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9150        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9151
  9152     IF PL-TOL-REF-AMT NOT EQUAL +0
  9153        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9154
  9155     IF PL-TOL-PREM-PCT GREATER THAN +0
  9156        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9157
  9158     IF PL-TOL-REF-PCT GREATER THAN +0
  9159        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9160
  9161     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9162        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9163
  9164     IF PL-OVER-SHORT-AMT NUMERIC AND
  9165                          PL-OVER-SHORT-AMT > +0
  9166        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9167
  9168     IF PL-OVER-SHORT-PCT NUMERIC AND
  9169                          PL-OVER-SHORT-PCT > +0
  9170        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9171
  9172     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9173        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9174        IF WS-IG-OVRD-AM EQUAL SPACES
  9175            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9176
  9177 0314-A-H-BENEFIT-FOUND.
  9178
  9179     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9180
  9181     IF PB-ISSUE
  9182        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9183       ELSE
  9184        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9185
  9186     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD.
  9187     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9188     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9189     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 168
* EL050.cbl
  9190                                         WS-AH-REFUND-CALC.
  9191
  9192     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9193        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9194
  9195     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9196        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9197     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9198
  9199     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9200     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9201     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9202     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9203     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9204     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9205
  9206     IF PB-COMPANY-ID = 'NCL'  AND
  9207        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9208         NEXT SENTENCE
  9209     ELSE
  9210         IF SUB5 NOT GREATER THAN +20
  9211            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9212                MOVE WS-SAVE-BENEFIT-REM-TERM
  9213                                      TO WS-AM-AH-BENE-REM-TERM
  9214                                         EC-BR-AH-REM-TERM-CALC.
  9215
  9216     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9217     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9218
  9219     GO TO 0400-FIND-CARRIER.
  9220
  9221 0399-BENEFIT-NOT-FOUND.
  9222
  9223     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9224     MOVE ER-2605                TO WS-ERROR.
  9225     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9226
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 169
* EL050.cbl
  9228
  9229 0400-FIND-CARRIER.
  9230
  9231     MOVE PB-SV-CARRIER          TO WS-CARR.
  9232
  9233     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9234     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9235     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9236     MOVE '6'                    TO CNTL-REC-TYPE.
  9237
  9238*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9239     MOVE SPACE                  TO WS-DMD-RATING-SW
  9240                                    EC-BR-DMD-RATING-SW.
  9241
  9242     MOVE '2'                    TO RC-SW-1.
  9243     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9244
  9245     IF NOT CF-CARRIER-MASTER
  9246        GO TO 0400-CARRIER-NOT-FOUND.
  9247
  9248 0400-BUILD-CARR-TOL.
  9249
  9250     IF CF-CR-TOL-PREM NUMERIC AND
  9251        CF-CR-TOL-PREM GREATER THAN +0
  9252        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9253                                    WS-TOL-AH-PREM.
  9254
  9255     IF CF-CR-TOL-REFUND NUMERIC AND
  9256        CF-CR-TOL-REFUND GREATER THAN +0
  9257        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9258                                    WS-TOL-AH-REFUND.
  9259
  9260     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9261        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9262        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9263                                    WS-AH-REFUND-OVS-AMT.
  9264
  9265     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9266        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9267        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9268                                    WS-AH-REFUND-OVS-PCT.
  9269
  9270     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9271        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9272        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9273                                    WS-TOL-AH-PREM-PCT.
  9274
  9275     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9276        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9277        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9278                                     WS-TOL-AH-REFUND-PCT.
  9279
  9280     IF CF-COMPANY-ID EQUAL 'DMD'
  9281         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9282                                    EC-BR-DMD-RATING-SW.
  9283
  9284     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9285     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 170
* EL050.cbl
  9286        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9287     END-IF
  9288     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9289        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9290     END-IF
  9291     IF WS-TOL-CLP-PCT = ZEROS
  9292        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9293     END-IF
  9294
  9295     IF WS-SPP-LEASE-COMM = ZEROS
  9296        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9297     END-IF
  9298     GO TO 0400-FIND-ERPDEF.
  9299
  9300 0400-CARRIER-NOT-FOUND.
  9301
  9302     MOVE ER-2602                TO WS-ERROR.
  9303     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9304
  9305 0400-FIND-ERPDEF.
  9306     IF PB-COMPANY-ID = 'DCC'
  9307        AND AM-DCC-PRODUCT-CODE = 'DDF'
  9308        CONTINUE
  9309     ELSE
  9310        GO TO 0400-FIND-ERCOMP
  9311     END-IF
  9312     MOVE ' '                    TO PDEF-MASTER-SW
  9313     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9314     MOVE PB-STATE               TO ERPDEF-STATE
  9315     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9316     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9317     IF PB-ISSUE
  9318        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9319     ELSE
  9320        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9321     END-IF
  9322     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9323     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9324     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9325     IF PDEF-MASTER-FOUND
  9326        MOVE 'N'                 TO PDEF-MASTER-SW
  9327        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9328        IF PDEF-MASTER-FOUND
  9329           IF (ERPDEF-KEY-SAVE (1:16) =
  9330                        PD-CONTROL-PRIMARY (1:16))
  9331              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9332              CONTINUE
  9333           ELSE
  9334              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9335              IF (ERPDEF-KEY-SAVE (1:16) =
  9336                        PD-CONTROL-PRIMARY (1:16))
  9337                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9338                 CONTINUE
  9339              ELSE
  9340                 MOVE 'N'        TO PDEF-MASTER-SW
  9341              END-IF
  9342           END-IF
  9343        END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 171
* EL050.cbl
  9344        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9345     END-IF
  9346     IF PDEF-MASTER-FOUND
  9347        IF PD-TRUNCATED = 'Y'
  9348           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9349        END-IF
  9350     END-IF
  9351     .
  9352 0400-FIND-ERCOMP.
  9353     IF PB-COMPANY-ID = 'DCC'
  9354        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9355           (WS-SUB1 > +10)
  9356           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9357                 OR 'A' OR 'N'
  9358              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9359              MOVE PB-CARRIER    TO COMP-CARRIER
  9360              MOVE PB-GROUPING   TO COMP-GROUPING
  9361              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9362              MOVE AM-AGT (WS-SUB1)
  9363                                 TO COMP-FIN-RESP
  9364              MOVE 'G'           TO COMP-TYPE
  9365              PERFORM 8582-READ-COMPENSATION-MASTER
  9366                                 THRU 8582-EXIT
  9367              IF COMP-MASTER-FOUND
  9368                 IF CO-GA-INACTIVE
  9369                    MOVE ER-2763 TO WS-ERROR
  9370                    PERFORM 9900-ERROR-FORMAT
  9371                                 THRU 9900-EXIT
  9372                    MOVE +11     TO WS-SUB1
  9373                 END-IF
  9374                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9375                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9376                    MOVE ER-2788 TO WS-ERROR
  9377                    PERFORM 9900-ERROR-FORMAT
  9378                                 THRU 9900-EXIT
  9379                    MOVE +11     TO WS-SUB1
  9380                 END-IF
  9381              END-IF
  9382           END-IF
  9383        END-PERFORM
  9384     END-IF
  9385     IF PB-COMPANY-ID = 'DCC'
  9386        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9387           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9388                                    WS-CLP-STATE
  9389        ELSE
  9390           MOVE SPACES           TO PB-I-CLP-STATE
  9391                                    WS-CLP-STATE
  9392        END-IF
  9393     END-IF
  9394
  9395     IF (PB-COMPANY-ID = 'DCC')
  9396        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9397        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9398        CONTINUE
  9399     ELSE
  9400        GO TO 0400-FIND-STATE-RECORD
  9401     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 172
* EL050.cbl
  9402     MOVE SPACES                 TO WS-CLP-STATE
  9403     MOVE +0                     TO WS-BANK-FEE
  9404                                    WS-BANK-LFEE
  9405                                    WS-BANK-NOCHRGB
  9406
  9407     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9408     IF (PB-ISSUE)
  9409        AND (PB-I-BANK-NUMBER NOT =
  9410            SPACES AND ZEROS AND LOW-VALUES)
  9411        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9412     ELSE
  9413        IF (PB-CANCELLATION)
  9414           AND (PB-CI-BANK-NUMBER NOT =
  9415                SPACES AND ZEROS AND LOW-VALUES)
  9416           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9417        END-IF
  9418     END-IF
  9419     IF COMP-FIN-RESP NOT = LOW-VALUES
  9420        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9421        MOVE PB-CARRIER          TO COMP-CARRIER
  9422        MOVE PB-GROUPING         TO COMP-GROUPING
  9423        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9424        MOVE 'B'                 TO COMP-TYPE
  9425        PERFORM 8582-READ-COMPENSATION-MASTER
  9426                                 THRU 8582-EXIT
  9427        IF COMP-MASTER-FOUND
  9428           IF CO-MAX-BANK-FEE NOT NUMERIC
  9429              MOVE +0            TO CO-MAX-BANK-FEE
  9430           END-IF
  9431           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9432              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9433           END-IF
  9434           IF CO-GA-INACTIVE
  9435              MOVE ER-2763       TO WS-ERROR
  9436              PERFORM 9900-ERROR-FORMAT
  9437                                 THRU 9900-EXIT
  9438           END-IF
  9439           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9440              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9441              MOVE ER-2788 TO WS-ERROR
  9442              PERFORM 9900-ERROR-FORMAT
  9443                                 THRU 9900-EXIT
  9444              MOVE +11     TO WS-SUB1
  9445           END-IF
  9446           IF WS-AH-BEN-CATEGORY = 'G'
  9447              MOVE CO-MAX-BANK-FEE
  9448                                 TO WS-BANK-FEE
  9449                                    PB-I-BANK-FEE
  9450           ELSE
  9451              MOVE CO-MAX-BANK-FEE-LEASE
  9452                                 TO WS-BANK-LFEE
  9453                                    PB-I-BANK-FEE
  9454           END-IF
  9455           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
  9456              AND (WS-AH-REFUND-CALC = 'G'))
  9457                        OR
  9458              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9459              AND (WS-AH-REFUND-CALC NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 173
* EL050.cbl
  9460              CONTINUE
  9461           ELSE
  9462              MOVE ER-2789 TO WS-ERROR
  9463              PERFORM 9900-ERROR-FORMAT
  9464                                 THRU 9900-EXIT
  9465           END-IF
  9466           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9467                                    PB-I-CLP-STATE
  9468           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9469           MOVE CO-CARRIER       TO BXRF-CARRIER
  9470           MOVE CO-GROUPING      TO BXRF-GROUPING
  9471           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9472           MOVE BXRF-MAX-REC-LENGTH
  9473                                 TO BXRF-REC-LENGTH
  9474           PERFORM 8584-READ-BANK-CROSS-REF
  9475                                 THRU 8584-EXIT
  9476           IF BXRF-MASTER-FOUND
  9477              MOVE ' '           TO BANK-ACCT-SW
  9478              MOVE BK-BANK-POINTER-CNT
  9479                                 TO BK-BANK-POINTER-CNT
  9480              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9481                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9482                 OR (BANK-ACCT-FOUND)
  9483                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9484                    AND (BK-AM-EXP-DT (WS-SUB1)
  9485                                 > PB-CERT-EFF-DT)
  9486                    AND (BK-AM-EFF-DT (WS-SUB1)
  9487                                 NOT > PB-CERT-EFF-DT)
  9488                    SET BANK-ACCT-FOUND TO TRUE
  9489                 END-IF
  9490              END-PERFORM
  9491              IF NOT BANK-ACCT-FOUND
  9492                 MOVE ZEROS      TO WS-BANK-FEE
  9493                                    WS-BANK-LFEE
  9494                 MOVE ER-2869    TO WS-ERROR
  9495                 PERFORM 9900-ERROR-FORMAT
  9496                                 THRU 9900-EXIT
  9497              ELSE
  9498                 PERFORM 5000-PROCESS-REPS
  9499                                 THRU 5000-EXIT
  9500                 IF AGENT-MASTER-FOUND
  9501                    MOVE +0      TO WS-BANK-FEE
  9502                                    WS-BANK-LFEE
  9503*                   MOVE AG-SPP-FEES (1)
  9504*                                TO PB-I-BANK-FEE
  9505*                                   WS-BANK-FEE
  9506                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9507                       (WS-SUB1 > +10)
  9508                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9509                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9510                       END-IF
  9511                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9512                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9513                       END-IF
  9514                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9515                          AG-SPP-FEES (WS-SUB1)
  9516                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9517                          AG-SPP-LFEES (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 174
* EL050.cbl
  9518                    END-PERFORM
  9519                    IF WS-AH-BEN-CATEGORY = 'G'
  9520                       MOVE WS-BANK-FEE
  9521                                 TO PB-I-BANK-FEE
  9522                    ELSE
  9523                       MOVE WS-BANK-LFEE
  9524                                 TO PB-I-BANK-FEE
  9525                    END-IF
  9526                 END-IF
  9527              END-IF
  9528           END-IF
  9529        ELSE
  9530           MOVE ER-2879          TO WS-ERROR
  9531           PERFORM 9900-ERROR-FORMAT
  9532                                 THRU 9900-EXIT
  9533        END-IF
  9534     ELSE
  9535        MOVE ER-2879             TO WS-ERROR
  9536        PERFORM 9900-ERROR-FORMAT
  9537                                 THRU 9900-EXIT
  9538     END-IF
  9539     IF WS-AH-BEN-CATEGORY = 'G'
  9540        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9541        + WS-BANK-FEE
  9542     ELSE
  9543        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9544        + WS-BANK-LFEE
  9545     END-IF
  9546     .
  9547 0400-FIND-STATE-RECORD.
  9548
  9549     IF WK-STATE-ADDR NOT = ZEROS
  9550         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9551         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9552         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9553         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9554         IF PB-SV-STATE = CF-STATE-CODE
  9555             GO TO 0405-CONTINUE-EDIT
  9556         ELSE
  9557             NEXT SENTENCE
  9558     ELSE
  9559         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9560
  9561     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9562     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9563     MOVE '3'                    TO CNTL-REC-TYPE.
  9564     MOVE +0                     TO CNTL-SEQ-NO.
  9565
  9566     MOVE '3'                    TO RC-SW-2.
  9567     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9568
  9569     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9570        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9571        PB-SV-STATE   NOT = CF-STATE-CODE)
  9572        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9573                                    WS-TOL-AH-CLAIM
  9574                                    WS-MINIMUM-REFUND
  9575                                    WS-TOL-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 175
* EL050.cbl
  9576                                    WS-TOL-AH-PREM
  9577                                    WS-TOL-LF-REFUND
  9578                                    WS-TOL-AH-REFUND
  9579                                    EC-ST-TOL-PREM-PCT
  9580                                    WS-TOL-LF-PREM-PCT
  9581                                    WS-TOL-AH-PREM-PCT
  9582                                    EC-ST-TOL-REFUND-PCT
  9583                                    WS-TOL-LF-REFUND-PCT
  9584                                    WS-TOL-AH-REFUND-PCT
  9585                                    EC-ST-TOL-PREM
  9586                                    EC-ST-TOL-REFUND
  9587                                    EC-ST-FST-PMT-DAYS-MAX
  9588                                    WS-FREE-LOOK-PERIOD
  9589                                    WS-ST-LF-PREM-TAX
  9590                                    WS-ST-AH-PREM-TAX-I
  9591                                    WS-ST-AH-PREM-TAX-G
  9592                                    WS-BANK-FEE
  9593                                    WS-BANK-LFEE
  9594                                    WS-TOL-CLP-PCT
  9595                                    WS-SPP-LEASE-COMM
  9596        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9597                                    EC-ST-FST-PMT-DAYS-CHG
  9598                                    WS-LF-REM-TERM-CALC
  9599                                    WS-LF-REFUND-CALC
  9600                                    EC-ST-LF-REM-TERM-CALC
  9601                                    EC-ST-LF-REFUND-CALC
  9602                                    WS-AH-REM-TERM-CALC
  9603                                    WS-AH-REFUND-CALC
  9604                                    WS-LF-BEN-CATEGORY
  9605                                    WS-AH-BEN-CATEGORY
  9606                                    WS-CLP-STATE
  9607                                    WS-ST-REFUND-CLAIM-FLAG
  9608                                    EC-ST-AH-REM-TERM-CALC
  9609                                    EC-ST-AH-REFUND-CALC
  9610          GO TO 0499-STATE-NOT-FOUND.
  9611
  9612     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9613
  9614 0405-CONTINUE-EDIT.
  9615
  9616     if pb-company-id = 'AHL'
  9617        continue
  9618     else
  9619        IF PB-CERT-PRIME NOT NUMERIC
  9620           MOVE ER-2722          TO WS-ERROR
  9621           PERFORM 9900-ERROR-FORMAT
  9622                                 THRU 9900-EXIT
  9623        end-if
  9624     END-IF
  9625*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9626*       MOVE +0                  TO SUB3
  9627*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9628*       IF SUB3 > +0
  9629*          MOVE ER-2722          TO WS-ERROR
  9630*          PERFORM 9900-ERROR-FORMAT
  9631*                                THRU 9900-EXIT
  9632*       END-IF
  9633*    END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 176
* EL050.cbl
  9634*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9635*       IF PB-CERT-PRIME NOT NUMERIC
  9636*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9637*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9638*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9639*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9640*
  9641*          MOVE ER-2722          TO WS-ERROR
  9642*          PERFORM 9900-ERROR-FORMAT
  9643*                                THRU 9900-EXIT
  9644*       END-IF
  9645*    END-IF
  9646
  9647     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9648
  9649     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9650        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9651                                    WS-TOL-AH-CLAIM.
  9652
  9653     IF CF-ST-REFUND-MIN NOT NUMERIC
  9654        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9655
  9656     IF CF-ST-REFUND-MIN NOT = ZEROS
  9657        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9658
  9659     IF CF-ST-TOL-PREM  NOT = ZEROS
  9660        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9661                                    WS-TOL-AH-PREM
  9662        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9663
  9664     IF CF-ST-TOL-REFUND NOT = ZEROS
  9665        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9666                                    WS-TOL-AH-REFUND
  9667        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9668
  9669     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9670        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9671        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9672                                    WS-AH-REFUND-OVS-AMT
  9673                                    EC-ST-OVR-SHT-AMT.
  9674
  9675     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9676        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9677        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9678                                    WS-TOL-LF-PREM-PCT
  9679                                    WS-TOL-AH-PREM-PCT.
  9680
  9681     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9682        CF-ST-TOL-REF-PCT GREATER THAN +0
  9683        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9684                                    WS-TOL-LF-REFUND-PCT
  9685                                    WS-TOL-AH-REFUND-PCT.
  9686
  9687     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9688        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9689        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9690                                    WS-AH-REFUND-OVS-PCT
  9691                                    EC-ST-OVR-SHT-PCT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 177
* EL050.cbl
  9692
  9693     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9694     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9695
  9696     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9697          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9698
  9699     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9700     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9701     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9702
  9703     IF CF-ST-LF-PREM-TAX NUMERIC
  9704        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9705     END-IF
  9706     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9707        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9708     END-IF
  9709     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9710        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9711     END-IF
  9712
  9713     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9714         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9715     END-IF.
  9716
  9717     IF WS-LF-BENEFIT-CD = ZEROS
  9718        GO TO 0410-CHECK-AH.
  9719
  9720     IF CF-ST-RT-CALC NOT = SPACES
  9721        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9722                                    EC-ST-LF-REM-TERM-CALC
  9723     END-IF
  9724
  9725     IF WS-LF-COVERAGE-TYPE = 'R'
  9726        IF WS-LF-EARNINGS-CALC = '5'
  9727           IF CF-ST-RF-LN-CALC > '0'
  9728              MOVE CF-ST-RF-LN-CALC
  9729                                 TO WS-LF-REFUND-CALC
  9730                                    EC-ST-LF-REFUND-CALC
  9731           END-IF
  9732        ELSE
  9733           IF CF-ST-RF-LR-CALC > '0'
  9734              MOVE CF-ST-RF-LR-CALC
  9735                                 TO WS-LF-REFUND-CALC
  9736                                    EC-ST-LF-REFUND-CALC
  9737           END-IF
  9738        END-IF
  9739     ELSE
  9740        IF CF-ST-RF-LL-CALC > '0'
  9741           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9742                                    EC-ST-LF-REFUND-CALC
  9743        END-IF
  9744     END-IF
  9745
  9746     IF CF-ST-RT-CALC NOT = SPACES
  9747        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9748                                    EC-ST-LF-REM-TERM-CALC
  9749     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 178
* EL050.cbl
  9750
  9751     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9752     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9753
  9754     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9755
  9756     IF NO-BENEFIT-FOUND
  9757        GO TO 0410-CHECK-AH.
  9758
  9759     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9760        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9761                                 TO EC-ST-LF-REM-TERM-CALC
  9762                                    WS-LF-REM-TERM-CALC
  9763     END-IF
  9764
  9765     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9766        MOVE CF-ST-REFUND-CALC (SUB3)
  9767                                 TO WS-LF-REFUND-CALC
  9768                                    EC-ST-LF-REFUND-CALC
  9769     END-IF
  9770*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9771
  9772     .
  9773 0410-CHECK-AH.
  9774
  9775     IF WS-AH-BENEFIT-CD = ZEROS
  9776        GO TO 0500-SET-ACCOUNT.
  9777
  9778     IF CF-ST-RT-CALC NOT = SPACES
  9779        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9780                                    EC-ST-AH-REM-TERM-CALC
  9781     END-IF
  9782
  9783     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9784        IF CF-ST-RF-CP-CALC > '0'
  9785           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9786                                    EC-ST-AH-REFUND-CALC
  9787        END-IF
  9788     ELSE
  9789        IF CF-ST-RF-AH-CALC > '0'
  9790           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9791                                    EC-ST-AH-REFUND-CALC
  9792        END-IF
  9793     END-IF
  9794     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9795     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9796
  9797     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9798
  9799     IF NO-BENEFIT-FOUND
  9800        GO TO 0500-SET-ACCOUNT.
  9801
  9802     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9803        MOVE CF-ST-REM-TERM-CALC (SUB3)
  9804                                 TO WS-AH-REM-TERM-CALC
  9805                                    EC-ST-AH-REM-TERM-CALC
  9806     END-IF
  9807
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 179
* EL050.cbl
  9808     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
  9809        MOVE CF-ST-REFUND-CALC (SUB3)
  9810                                 TO WS-AH-REFUND-CALC
  9811                                    EC-ST-AH-REFUND-CALC
  9812     END-IF
  9813
  9814*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
  9815
  9816     GO TO 0500-SET-ACCOUNT.
  9817
  9818 0499-STATE-NOT-FOUND.
  9819
  9820     MOVE ER-2603                TO WS-ERROR.
  9821     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9822
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 180
* EL050.cbl
  9824
  9825 0500-SET-ACCOUNT.
  9826*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
  9827     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9828        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
  9829        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
  9830        MOVE WS-CLP-STATE        TO CNTL-ACCESS
  9831        MOVE '3'                 TO CNTL-REC-TYPE
  9832        MOVE +0                  TO CNTL-SEQ-NO
  9833
  9834        MOVE '3'                 TO RC-SW-2
  9835        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
  9836
  9837        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9838           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9839           WS-CLP-STATE  NOT = CF-STATE-CODE)
  9840           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
  9841                                    WS-ST-AH-PREM-TAX-I
  9842                                    WS-ST-AH-PREM-TAX-G
  9843        ELSE
  9844           IF CF-ST-LF-PREM-TAX NUMERIC
  9845              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9846           END-IF
  9847           IF CF-ST-AH-PREM-TAX-I NUMERIC
  9848              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9849           END-IF
  9850           IF CF-ST-AH-PREM-TAX-G NUMERIC
  9851              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9852           END-IF
  9853        END-IF
  9854        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
  9855     END-IF
  9856*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
  9857*  FOR DCC ONLY
  9858     IF PB-COMPANY-ID = 'DCC'
  9859
  9860     MOVE ' '                    TO STAT-MASTER-SW
  9861     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
  9862     MOVE PB-CARRIER             TO ELSTAT-CARRIER
  9863     MOVE PB-GROUPING            TO ELSTAT-GROUP
  9864     MOVE PB-STATE               TO ELSTAT-STATE
  9865     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9866        MOVE WS-CLP-STATE        TO ELSTAT-STATE
  9867     END-IF
  9868
  9869     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  9870     SET BIN-TO-GREG             TO TRUE
  9871     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
  9872     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
  9873     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
  9874
  9875     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
  9876     IF STAT-MASTER-FOUND
  9877        MOVE 'N'                 TO STAT-MASTER-SW
  9878        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9879        IF STAT-MASTER-FOUND
  9880           IF (ELSTAT-KEY-SAVE (1:12) =
  9881                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 181
* EL050.cbl
  9882              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9883                 MOVE 'F'        TO STAT-MASTER-SW
  9884              ELSE
  9885                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9886                 IF (STAT-MASTER-FOUND)
  9887                    AND (ELSTAT-KEY-SAVE (1:12) =
  9888                        SF-CONTROL-PRIMARY (1:12))
  9889                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9890                    MOVE 'F'     TO STAT-MASTER-SW
  9891                 END-IF
  9892              END-IF
  9893           END-IF
  9894        END-IF
  9895     END-IF
  9896
  9897     IF STAT-MASTER-SW = 'F'
  9898        IF SF-ST-LF-PREM-TAX NUMERIC
  9899           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9900        END-IF
  9901        IF SF-ST-AH-PREM-TAX-I NUMERIC
  9902           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9903        END-IF
  9904        IF SF-ST-AH-PREM-TAX-G NUMERIC
  9905           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9906        END-IF
  9907     END-IF
  9908
  9909     END-IF
  9910     IF (PB-COMPANY-ID = 'DCC')
  9911        AND (PB-ISSUE)
  9912        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9913        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  9914        AND (AM-GPCD = 06)
  9915        MOVE 'Y'                 TO WS-GOOD-HIN
  9916        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9917           MOVE PB-I-VIN         TO WS-WORK-VIN
  9918           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9919              (V1 > 16)
  9920              IF WS-WORK-VIN (V1:1) NUMERIC
  9921                 MOVE WS-WORK-VIN-N (V1)
  9922                                 TO WS-ROW-B-VAL (V1)
  9923              ELSE
  9924                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
  9925                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
  9926                    OR (V2 > 26)
  9927                 END-PERFORM
  9928                 IF V2 < 27
  9929                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
  9930                 ELSE
  9931                    MOVE 'N'     TO WS-GOOD-HIN
  9932                 END-IF
  9933              END-IF
  9934              COMPUTE WS-ROW-D-VAL (V1) =
  9935                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
  9936              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
  9937                 WS-ROW-D-VAL (V1)
  9938           END-PERFORM
  9939           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 182
* EL050.cbl
  9940           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
  9941             REMAINDER WS-VIN-REMAINDER
  9942           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
  9943              CONTINUE
  9944           ELSE
  9945              MOVE 'N'           TO WS-GOOD-HIN
  9946           END-IF
  9947        ELSE
  9948           MOVE 'N'              TO WS-GOOD-HIN
  9949        END-IF
  9950        IF WS-GOOD-HIN NOT = 'Y'
  9951           MOVE ER-3826           TO WS-ERROR
  9952           PERFORM 9900-ERROR-FORMAT
  9953                                 THRU 9900-EXIT
  9954        END-IF
  9955     END-IF
  9956     IF (PB-COMPANY-ID = 'DCC')
  9957        AND (PB-ISSUE)
  9958        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9959        AND (AM-GPCD NOT = 06)
  9960        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9961          MOVE PB-I-VIN          TO WS-WORK-VIN
  9962          MOVE +8                TO V2
  9963          MOVE ZEROS             TO WS-VIN-TOTAL
  9964          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9965           (V1 > 17)
  9966             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
  9967                MOVE ER-3825     TO WS-ERROR
  9968                PERFORM 9900-ERROR-FORMAT
  9969                                 THRU 9900-EXIT
  9970             ELSE
  9971                IF V1 = 8
  9972                   MOVE 10       TO V2
  9973                END-IF
  9974                IF V1 = 9
  9975                   MOVE 0        TO V2
  9976                END-IF
  9977                IF V1 = 10
  9978                   MOVE 9        TO V2
  9979                END-IF
  9980                IF WS-WORK-VIN (V1:1) NUMERIC
  9981                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9982                    + (WS-WORK-VIN-N (V1) * V2)
  9983                ELSE
  9984                   MOVE WS-WORK-VIN (V1:1)
  9985                                 TO WS-HEX-BYTE
  9986                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
  9987                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9988                    + (WS-NUM (V3) * V2)
  9989                END-IF
  9990                COMPUTE V2 = V2 - 1
  9991             END-IF
  9992          END-PERFORM
  9993          MOVE ZEROS TO WS-VIN-REMAINDER
  9994          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
  9995             REMAINDER WS-VIN-REMAINDER
  9996          IF ((WS-WORK-VIN (9:1) = 'X')
  9997             AND (WS-VIN-REMAINDER = 10))
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 183
* EL050.cbl
  9998                     OR
  9999             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 10000             CONTINUE
 10001          ELSE
 10002             MOVE ER-3826        TO WS-ERROR
 10003             PERFORM 9900-ERROR-FORMAT
 10004                                 THRU 9900-EXIT
 10005          END-IF
 10006        ELSE
 10007          MOVE ER-3826           TO WS-ERROR
 10008          PERFORM 9900-ERROR-FORMAT
 10009                                 THRU 9900-EXIT
 10010        END-IF
 10011     END-IF
 10012******************************************************************
 10013******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10014******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10015******* METHODS.
 10016******************************************************************
 10017     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10018        IF PB-CANCELLATION
 10019           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10020              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10021                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10022                IF FORM-MASTER-FOUND
 10023                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10024******************************************************************
 10025
 10026     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10027     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10028
 10029     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10030     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10031     MOVE AM-STATUS              TO WS-ACCT-STATUS.
 10032     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10033
 10034
 10035     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10036     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
 10037     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10038
 10039     IF AM-LF-OB-RATE NOT NUMERIC
 10040         MOVE ZERO               TO AM-LF-OB-RATE.
 10041
 10042     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10043         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10044
 10045     IF AM-AH-OB-RATE NOT NUMERIC
 10046         MOVE ZERO               TO AM-AH-OB-RATE.
 10047
 10048     IF WS-LF-JOINT-INDICATOR = 'J'
 10049         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10050     ELSE
 10051         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10052
 10053     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10054
 10055     IF WS-IG-OVRD-AM  EQUAL SPACE
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 184
* EL050.cbl
 10056         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10057
 10058     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10059         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10060                                       WS-IG-OVRD
 10061     ELSE
 10062         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10063             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10064                                       WS-IG-OVRD
 10065         ELSE
 10066             MOVE AM-IG             TO WS-IG-OVRD-AH
 10067                                       WS-IG-OVRD.
 10068
 10069     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10070         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10071                                       WS-IG-OVRD
 10072     ELSE
 10073         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10074             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10075                                       WS-IG-OVRD
 10076         ELSE
 10077             MOVE AM-IG             TO WS-IG-OVRD-LF
 10078                                       WS-IG-OVRD.
 10079
 10080     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10081     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10082     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10083     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10084     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10085
 10086     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10087     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
 10088     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10089     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10090
 10091     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10092     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10093     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10094     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10095     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10096     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10097     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10098
 10099     IF WS-ACCT-AH-DEV-PCT > +0
 10100        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10101     ELSE
 10102        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10103
 10104     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10105        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10106     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10107        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10108
 10109        IF AM-EARN-METHOD-L = 'S'
 10110            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10111                                        WS-LF-REFUND-CALC.
 10112
 10113        IF AM-EARN-METHOD-R = 'S'
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 185
* EL050.cbl
 10114            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10115                                        WS-LF-REFUND-CALC.
 10116
 10117     IF WS-LF-COVERAGE-TYPE = 'R'
 10118         IF AM-EARN-METHOD-R = 'R'
 10119            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10120                                    WS-LF-REFUND-CALC.
 10121     IF WS-LF-COVERAGE-TYPE = 'R'
 10122         IF AM-EARN-METHOD-R = 'P'
 10123            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10124                                    WS-LF-REFUND-CALC.
 10125     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10126         IF AM-EARN-METHOD-L = 'R'
 10127            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10128                                    WS-LF-REFUND-CALC.
 10129     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10130         IF AM-EARN-METHOD-L = 'P'
 10131            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10132                                    WS-LF-REFUND-CALC.
 10133     IF WS-LF-COVERAGE-TYPE = 'R'
 10134         IF AM-EARN-METHOD-R = 'A'
 10135            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10136                                    WS-LF-REFUND-CALC.
 10137     IF WS-LF-COVERAGE-TYPE = 'R'
 10138         IF AM-EARN-METHOD-R = 'M'
 10139            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10140                                    WS-LF-REFUND-CALC.
 10141     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10142         IF AM-EARN-METHOD-L = 'A'
 10143            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10144                                    WS-LF-REFUND-CALC.
 10145     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10146         IF AM-EARN-METHOD-L = 'M'
 10147            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10148                                    WS-LF-REFUND-CALC.
 10149
 10150     IF AM-EARN-METHOD-A = 'R'
 10151        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10152                                    WS-AH-REFUND-CALC.
 10153     IF AM-EARN-METHOD-A = 'P'
 10154        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10155                                    WS-AH-REFUND-CALC.
 10156     IF AM-EARN-METHOD-A = 'C'
 10157        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10158                                    WS-AH-REFUND-CALC.
 10159     IF AM-EARN-METHOD-A = 'A'
 10160        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10161                                    WS-AH-REFUND-CALC.
 10162     IF AM-EARN-METHOD-A = 'M'
 10163        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10164                                    WS-AH-REFUND-CALC.
 10165     IF AM-EARN-METHOD-A = 'N'
 10166        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10167                                    WS-AH-REFUND-CALC.
 10168     IF AM-EARN-METHOD-A = 'S'
 10169        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10170                                    WS-AH-REFUND-CALC.
 10171
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 186
* EL050.cbl
 10172     IF AM-TOL-PREM NOT = ZEROS
 10173        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10174                                    WS-TOL-AH-PREM.
 10175
 10176     IF AM-OVR-SHT-AMT NUMERIC AND
 10177                  AM-OVR-SHT-AMT > 0
 10178        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10179                                    EC-AM-LF-OVR-SHT-AMT
 10180                                    WS-AH-REFUND-OVS-AMT
 10181                                    EC-AM-AH-OVR-SHT-AMT.
 10182
 10183     IF AM-OVR-SHT-PCT NUMERIC AND
 10184                    AM-OVR-SHT-PCT > 0
 10185        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10186                                    EC-AM-LF-OVR-SHT-PCT
 10187                                    WS-AH-REFUND-OVS-PCT
 10188                                    EC-AM-AH-OVR-SHT-PCT.
 10189
 10190     IF AM-TOL-REF-PCT NUMERIC AND
 10191                  AM-TOL-REF-PCT > 0
 10192        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10193                                    WS-TOL-AH-REFUND-PCT.
 10194
 10195     IF AM-TOL-REF  NOT = ZEROS  AND
 10196                  AM-TOL-REF NUMERIC
 10197        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10198                                    EC-AM-LF-TOL-REFUND
 10199                                    WS-TOL-AH-REFUND
 10200                                    EC-AM-AH-TOL-REFUND.
 10201
 10202     IF AM-TOL-CLM  NOT = ZEROS
 10203        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
 10204                                    WS-TOL-AH-CLAIM.
 10205
 10206     IF AM-CLP-TOL-PCT NOT NUMERIC
 10207        MOVE +0                  TO AM-CLP-TOL-PCT
 10208     END-IF
 10209
 10210     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10211        MOVE +0                  TO AM-SPP-LEASE-COMM
 10212     END-IF
 10213     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10214        MOVE WS-PL-TOL-LF-PREM-PCT
 10215                                 TO WS-TOL-LF-PREM-PCT.
 10216
 10217     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10218        MOVE WS-PL-TOL-AH-PREM-PCT
 10219                                 TO WS-TOL-AH-PREM-PCT.
 10220
 10221     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10222        MOVE WS-PL-TOL-LF-REFUND-PCT
 10223                                 TO WS-TOL-LF-REFUND-PCT.
 10224
 10225     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10226        MOVE WS-PL-TOL-AH-REFUND-PCT
 10227                                 TO WS-TOL-AH-REFUND-PCT.
 10228
 10229     IF WS-PL-REF-OVS-AMT > +0
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 187
* EL050.cbl
 10230        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10231
 10232     IF WS-PL-REF-OVS-PCT > +0
 10233        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10234
 10235     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10236        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10237     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10238        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10239     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10240        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10241     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10242        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10243     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10244        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10245     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10246        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10247
 10248     IF WS-AH-PL-REF-OVS-AMT > +0
 10249        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10250
 10251     IF WS-AH-PL-REF-OVS-PCT > +0
 10252        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10253
 10254     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10255     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10256
 10257     IF PB-CANCELLATION
 10258        GO TO 3000-CONTINUE-EDIT.
 10259
 10260     MOVE +1 TO SUB1.
 10261     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10262     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10263
 10264     IF CF-COMPANY-ID = 'DMD'
 10265       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10266         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10267        ELSE
 10268         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10269
 10270  0525-FIND-ACCT-COMM.
 10271     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10272        NEXT SENTENCE
 10273      ELSE
 10274         ADD +1 TO SUB1
 10275         IF SUB1 LESS +11
 10276            GO TO 0525-FIND-ACCT-COMM
 10277          ELSE
 10278             GO TO 0560-EDIT-CONTINUE.
 10279
 10280     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10281     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10282                                    PB-I-LIFE-COMMISSION.
 10283***  IF PB-COMPANY-ID = 'CRI'
 10284     IF PB-PREM-ACCTNG-ONLY
 10285         GO TO 0560-EDIT-CONTINUE.
 10286
 10287     MOVE '0530' TO CTBL-SW.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 188
* EL050.cbl
 10288     MOVE ' '    TO WS-CTBL-READ-SW.
 10289
 10290
 10291 0530-GET-AH-COMP.
 10292     IF NO-AH-COVERAGE  OR
 10293        NO-AH-BENEFIT-MATCH
 10294           GO TO 0540-NEXT-READ-STEP.
 10295
 10296     IF AM-A-COM (SUB1) NUMERIC
 10297        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10298         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10299         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10300         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10301         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10302     ELSE
 10303          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10304          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10305          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10306          MOVE ZEROS             TO WS-SUB1
 10307                                    WS-COMMISSION
 10308          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10309          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10310          IF WS-COMMISSION > ZEROS
 10311             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10312             GO TO 0540-NEXT-READ-STEP
 10313          END-IF
 10314          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10315          IF CTBL-TABLE-FOUND
 10316             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10317                                        PB-I-AH-TERM
 10318             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10319             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10320             GO TO 0540-NEXT-READ-STEP
 10321          ELSE
 10322             IF FIRST-TIME-THROUGH
 10323                 GO TO 0530-GET-AH-COMP
 10324             ELSE
 10325                 MOVE ER-2609                TO WS-ERROR
 10326                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10327
 10328 0540-NEXT-READ-STEP.
 10329     MOVE '0540' TO CTBL-SW.
 10330     MOVE ' '    TO WS-CTBL-READ-SW.
 10331
 10332 0540-GET-LF-COMP.
 10333     IF NO-LIFE-COVERAGE  OR
 10334        NO-LF-BENEFIT-MATCH
 10335           GO TO 0560-EDIT-CONTINUE.
 10336
 10337     IF WS-LF-JOINT-INDICATOR = 'J'
 10338        IF AM-J-COM (SUB1) NUMERIC
 10339           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10340           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10341           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10342           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10343           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10344        ELSE
 10345           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 189
* EL050.cbl
 10346           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10347           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10348           MOVE ZEROS                TO WS-SUB1
 10349                                        WS-COMMISSION
 10350           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10351           IF WS-COMMISSION > ZEROS
 10352              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10353              GO TO 0560-EDIT-CONTINUE
 10354           END-IF
 10355           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10356           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10357           IF CTBL-TABLE-FOUND
 10358              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10359              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10360              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10361              GO TO 0560-EDIT-CONTINUE
 10362           ELSE
 10363              IF FIRST-TIME-THROUGH
 10364                  GO TO 0540-GET-LF-COMP
 10365              ELSE
 10366                  MOVE ER-2609                TO WS-ERROR
 10367                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10368                  GO TO 0560-EDIT-CONTINUE.
 10369
 10370     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10371        IF AM-L-COM (SUB1) NUMERIC
 10372           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10373           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10374           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10375           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10376           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10377        ELSE
 10378           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10379           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10380           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10381           MOVE ZEROS                TO WS-SUB1
 10382                                        WS-COMMISSION
 10383           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10384           IF WS-COMMISSION IS GREATER THAN ZEROS
 10385              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10386              GO TO 0560-EDIT-CONTINUE
 10387           END-IF
 10388           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10389           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10390           IF CTBL-TABLE-FOUND
 10391              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10392              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10393              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10394              GO TO 0560-EDIT-CONTINUE
 10395           ELSE
 10396              IF FIRST-TIME-THROUGH
 10397                  GO TO 0540-GET-LF-COMP
 10398              ELSE
 10399                  MOVE ER-2609                TO WS-ERROR
 10400                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10401
 10402*    GO TO 0560-EDIT-CONTINUE.
 10403
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 190
* EL050.cbl
 10404 0560-EDIT-CONTINUE.
 10405     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10406                                    WS-AH-PMF-COMM
 10407*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10408*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10409     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10410        (SUB1 > +10)
 10411        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10412           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10413           MOVE '0530'           TO CTBL-SW
 10414           MOVE ' '              TO WS-CTBL-READ-SW
 10415           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10416           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10417           MOVE '0540'           TO CTBL-SW
 10418           MOVE ' '              TO WS-CTBL-READ-SW
 10419           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10420        END-IF
 10421     END-PERFORM
 10422     GO TO 0564-EDIT-CONTINUE
 10423     .
 10424 0561-CHECK-AH.
 10425     IF (NO-AH-COVERAGE)
 10426        OR (NO-AH-BENEFIT-MATCH)
 10427        CONTINUE
 10428     ELSE
 10429        IF (AM-A-COM (SUB1) NUMERIC)
 10430           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10431           IF (AM-COM-TYP (SUB1) = 'A')
 10432              AND (WS-AH-PMF-COMM = ZEROS)
 10433              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10434           END-IF
 10435           CONTINUE
 10436        ELSE
 10437           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10438           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10439           MOVE PB-AH-OVERRIDE-L1
 10440                                 TO CTBL-BEN-TYPE
 10441           MOVE ZEROS            TO WS-SUB1
 10442                                    WS-COMMISSION
 10443           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10444           PERFORM 8300-READ-CTBL-TABLE
 10445                                 THRU 8300-EXIT
 10446           IF CTBL-TABLE-FOUND
 10447              IF (AM-COM-TYP (SUB1) = 'A')
 10448                 AND (WS-AH-PMF-COMM = ZEROS)
 10449                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10450                                        PB-I-AH-TERM
 10451                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10452                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10453              END-IF
 10454              CONTINUE
 10455           ELSE
 10456              IF FIRST-TIME-THROUGH
 10457                 GO TO 0561-CHECK-AH
 10458              ELSE
 10459                 MOVE ER-2609    TO WS-ERROR
 10460                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10461              END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 191
* EL050.cbl
 10462           END-IF
 10463        END-IF
 10464     END-IF
 10465     .
 10466 0561-EXIT.
 10467     EXIT.
 10468 0563-CHECK-LF.
 10469     IF (NO-LIFE-COVERAGE)
 10470        OR (NO-LF-BENEFIT-MATCH)
 10471        CONTINUE
 10472     ELSE
 10473        IF WS-LF-JOINT-INDICATOR = 'J'
 10474           IF AM-J-COM (SUB1) NUMERIC
 10475              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10476              IF (AM-COM-TYP (SUB1) = 'A')
 10477                 AND (WS-LF-PMF-COMM = ZEROS)
 10478                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10479              END-IF
 10480              CONTINUE
 10481           ELSE
 10482              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10483              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10484              MOVE PB-LIFE-OVERRIDE-L1
 10485                                 TO CTBL-BEN-TYPE
 10486              MOVE ZEROS         TO WS-SUB1
 10487                                    WS-COMMISSION
 10488              MOVE AM-J-COMA (SUB1)
 10489                                 TO CTBL-TABLE
 10490              PERFORM 8300-READ-CTBL-TABLE
 10491                                 THRU 8300-EXIT
 10492              IF CTBL-TABLE-FOUND
 10493                 IF (AM-COM-TYP (SUB1) = 'A')
 10494                    AND (WS-LF-PMF-COMM = ZEROS)
 10495                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10496                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10497                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10498                 END-IF
 10499                 CONTINUE
 10500              ELSE
 10501                 IF FIRST-TIME-THROUGH
 10502                    GO TO 0563-CHECK-LF
 10503                 ELSE
 10504                    MOVE ER-2609 TO WS-ERROR
 10505                    PERFORM 9900-ERROR-FORMAT
 10506                                 THRU 9900-EXIT
 10507*                   GO TO 0560-EDIT-CONTINUE
 10508                 END-IF
 10509              END-IF
 10510           END-IF
 10511        ELSE
 10512           IF AM-L-COM (SUB1) NUMERIC
 10513              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10514              IF (AM-COM-TYP (SUB1) = 'A')
 10515                 AND (WS-LF-PMF-COMM = ZEROS)
 10516                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10517              END-IF
 10518              CONTINUE
 10519           ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 192
* EL050.cbl
 10520              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10521              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10522              MOVE PB-LIFE-OVERRIDE-L1
 10523                                 TO CTBL-BEN-TYPE
 10524              MOVE ZEROS         TO WS-SUB1
 10525                                    WS-COMMISSION
 10526              MOVE AM-L-COMA (SUB1)
 10527                                 TO CTBL-TABLE
 10528              PERFORM 8300-READ-CTBL-TABLE
 10529                                 THRU 8300-EXIT
 10530              IF CTBL-TABLE-FOUND
 10531                 CONTINUE
 10532              ELSE
 10533                 IF FIRST-TIME-THROUGH
 10534                    GO TO 0563-CHECK-LF
 10535                 ELSE
 10536                    MOVE ER-2609 TO WS-ERROR
 10537                    PERFORM 9900-ERROR-FORMAT
 10538                                 THRU 9900-EXIT
 10539                 END-IF
 10540              END-IF
 10541           END-IF
 10542        END-IF
 10543     END-IF
 10544     .
 10545 0563-EXIT.
 10546     EXIT.
 10547 0564-EDIT-CONTINUE.
 10548
 10549     IF  PB-COMPANY-ID EQUAL 'DMD'
 10550         IF PB-I-NUM-BILLED EQUAL ZEROS
 10551            MOVE ER-8148       TO WS-ERROR
 10552            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10553
 10554*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10555*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10556*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10557*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10558*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10559*         IF NO-CONVERSION-ERROR
 10560*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10561*         ELSE
 10562*             IF PB-COMPANY-ID EQUAL 'HAN'
 10563*                 MOVE ZEROS     TO PB-I-AGE.
 10564     IF PB-I-BIRTHDAY > LOW-VALUES
 10565        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10566        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10567        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10568        PERFORM 8500-DATE-CONVERT
 10569                                 THRU 8500-EXIT
 10570        IF NO-CONVERSION-ERROR
 10571           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10572           IF PB-I-AGE > ZEROS
 10573              IF WS-WORK-AGE NOT = PB-I-AGE
 10574                 MOVE ER-9501    TO WS-ERROR
 10575                 PERFORM 9900-ERROR-FORMAT
 10576                                 THRU 9900-EXIT
 10577              END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 193
* EL050.cbl
 10578           ELSE
 10579              MOVE WS-WORK-AGE   TO PB-I-AGE
 10580           END-IF
 10581        END-IF
 10582     END-IF
 10583     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 10584                                   WS-INS-AGE-SET
 10585     IF PB-I-AGE = ZEROS
 10586        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10587           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 10588                                   WS-INS-AGE-SET
 10589           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10590
 10591     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10592                                   WS-AH-EDIT-AGE.
 10593
 10594     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10595        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10596        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10597        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10598        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10599        IF NO-CONVERSION-ERROR
 10600           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10601           IF PB-I-JOINT-AGE > 0
 10602              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10603                 MOVE ER-9503    TO WS-ERROR
 10604                 PERFORM 9900-ERROR-FORMAT
 10605                                 THRU 9900-EXIT
 10606              END-IF
 10607           ELSE
 10608              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10609           END-IF
 10610        ELSE
 10611           MOVE ZEROS            TO PB-I-JOINT-AGE
 10612        END-IF
 10613     END-IF
 10614     IF PB-I-JOINT-AGE NOT NUMERIC
 10615        MOVE ZERO               TO PB-I-JOINT-AGE.
 10616
 10617     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 10618                                   WS-JNT-AGE-SET
 10619     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 10620        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10621           (WS-AH-JOINT-INDICATOR = 'J')
 10622           IF PB-I-JOINT-AGE = ZEROS
 10623               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 10624                                          WS-JNT-AGE-SET
 10625               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10626           END-IF
 10627        END-IF
 10628     END-IF
 10629
 10630     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10631     IF WS-LF-JOINT-INDICATOR = 'J'
 10632        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10633        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10634            IF  PB-I-JOINT-AGE = ZERO
 10635                MOVE ER-2686       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 194
* EL050.cbl
 10636                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10637            ELSE
 10638                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10639                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10640                    IF PB-COMPANY-ID NOT = 'LBL'
 10641                        MOVE ER-2685    TO WS-ERROR
 10642                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10643
 10644     IF WS-AH-JOINT-INDICATOR = 'J'
 10645        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10646            IF  PB-I-JOINT-AGE = ZERO
 10647                MOVE ER-2686       TO WS-ERROR
 10648                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10649            ELSE
 10650                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10651                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10652                                           WS-EDIT-AGE
 10653                    IF PB-COMPANY-ID NOT = 'LBL'
 10654                        MOVE ER-2685    TO WS-ERROR
 10655                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10656
 10657******************************************************************
 10658*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10659******************************************************************
 10660
 10661     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10662        (WS-AH-SPECIAL-CALC-CD = 'O')
 10663        NEXT SENTENCE
 10664     ELSE
 10665        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10666          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10667           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10668            WS-AH-JOINT-INDICATOR = 'J')  AND
 10669           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10670            MOVE ER-2627             TO WS-ERROR
 10671            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10672
 10673     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10674        (WS-AH-SPECIAL-CALC-CD = 'O')
 10675         NEXT SENTENCE
 10676     ELSE
 10677         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10678            WS-AH-JOINT-INDICATOR = 'J'
 10679             IF PB-I-JOINT-INSURED = SPACES
 10680                 IF PB-COMPANY-ID NOT = 'JAL'
 10681                     MOVE ER-2696    TO WS-ERROR
 10682                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10683
 10684     IF PB-COMPANY-ID NOT = 'BOA'
 10685        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10686           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10687           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10688               PB-I-JOINT-INSURED NOT = SPACES)
 10689                MOVE ER-2691         TO WS-ERROR
 10690                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10691
 10692     IF PB-COMPANY-ID = 'BOA'
 10693        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 195
* EL050.cbl
 10694           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10695            IF PB-I-JOINT-AGE NOT = ZEROS
 10696                MOVE ER-2691         TO WS-ERROR
 10697                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10698
 10699     IF PB-COMPANY-ID = 'CRI'
 10700        IF PB-I-SIG-SW = 'J'
 10701           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 10702              WS-AH-JOINT-INDICATOR NOT = 'J'
 10703              MOVE ER-2675       TO WS-ERROR
 10704              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10705
 10706     IF PB-COMPANY-ID = 'CRI'
 10707        IF PB-I-SIG-SW = 'S'
 10708           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10709              WS-AH-JOINT-INDICATOR = 'J'
 10710              MOVE ER-2676       TO WS-ERROR
 10711              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10712
 10713     IF PB-COMPANY-ID = 'CVL'
 10714         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10715            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10716              MOVE ER-2783           TO WS-ERROR
 10717              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10718     IF (WS-LF-JOINT-INDICATOR = 'J')
 10719        AND (WS-AH-JOINT-INDICATOR = 'J')
 10720        AND (PB-I-LF-TERM > 120)
 10721        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10722        MOVE ER-2783             TO WS-ERROR
 10723        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10724     END-IF
 10725     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10726
 10727     IF PB-I-INDV-GRP-OVRD = 'I'
 10728        MOVE ER-2666             TO WS-ERROR
 10729        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10730        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10731
 10732     IF PB-I-INDV-GRP-OVRD = 'G'
 10733        MOVE ER-2666             TO WS-ERROR
 10734        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10735        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10736
 10737     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10738        NEXT SENTENCE
 10739     ELSE
 10740        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10741
 10742     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10743        IF WS-ERROR = ER-2666
 10744           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10745           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10746
 10747     IF PB-COMPANY-ID = 'CID'
 10748        IF PB-STATE = 'UT' OR 'MO'
 10749           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10750                 OR '76' OR '77')
 10751                      OR
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 196
* EL050.cbl
 10752               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10753                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10754                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10755                   OR '2K' OR '2L'))
 10756              AND PB-I-INDV-GRP-CD = 'I'
 10757              MOVE ER-2721             TO WS-ERROR
 10758              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10759           END-IF
 10760        END-IF
 10761     END-IF
 10762
 10763     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10764     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10765        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10766     ELSE
 10767        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10768     END-IF
 10769
 10770*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10771*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10772     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10773                                    ACCOUNT-AH-CK-SW.
 10774
 10775     IF PB-REISSUED-CERT       OR
 10776        PB-REIN-ONLY-CERT      OR
 10777        PB-POLICY-IS-DECLINED  OR
 10778        PB-POLICY-IS-VOIDED
 10779*       OR PB-MONTHLY-CERT
 10780         GO TO 3000-CONTINUE-EDIT.
 10781
 10782     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10783        IF WS-EDIT-AGE           > +65
 10784           MOVE ER-2709          TO WS-ERROR
 10785           PERFORM 9900-ERROR-FORMAT
 10786                                 THRU 9900-EXIT
 10787        ELSE
 10788           IF WS-EDIT-AGE        > +55
 10789              MOVE ER-2718       TO WS-ERROR
 10790              PERFORM 9900-ERROR-FORMAT
 10791                                 THRU 9900-EXIT
 10792           END-IF
 10793        END-IF
 10794     IF PB-COMPANY-ID = 'DCC'
 10795        IF WS-EDIT-AGE           > +65
 10796           MOVE ER-2709          TO WS-ERROR
 10797           PERFORM 9900-ERROR-FORMAT
 10798                                 THRU 9900-EXIT
 10799        END-IF
 10800     END-IF
 10801     .
 10802
 10803 0565-LIFE-PLAN-LIMIT-EDITS.
 10804
 10805     IF NOT LF-PLAN-MASTER-FOUND
 10806        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10807                                    EC-AM-LF-MAX-TOT-BEN
 10808        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10809
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 197
* EL050.cbl
 10810     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10811
 10812     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10813         IF PL-LM-AGE (1) = ZEROS
 10814             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10815
 10816     IF NO-LF-BENEFIT-MATCH          OR
 10817        WS-LF-BENEFIT-CD = ZEROS     OR
 10818        WS-LF-SPECIAL-CALC-CD = 'M'
 10819        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10820
 10821     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10822     MOVE +1                     TO SUB2.
 10823
 10824     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10825        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10826           MOVE +5   TO SUB2
 10827           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10828              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10829              (PL-LM-AGE (SUB2) EQUAL +0)
 10830              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10831              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10832
 10833     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10834
 10835     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10836                               + PB-I-LF-ALT-BENEFIT-AMT.
 10837
 10838 0568-CHECK-LIFE-ATT-AGE.
 10839
 10840     IF PL-ATT-AGE NUMERIC AND
 10841        PL-ATT-AGE > +0
 10842        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10843     END-IF
 10844*    IF PL-ATT-AGE NUMERIC AND
 10845*       PL-ATT-AGE > +0
 10846*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10847*       IF PB-I-BIRTHDAY > LOW-VALUES
 10848*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10849*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 10850*          MOVE ZERO             TO DC-ELAPSED-DAYS
 10851*          SET BIN-PLUS-ELAPSED  TO TRUE
 10852*          PERFORM 8500-DATE-CONVERT
 10853*                                THRU 8500-EXIT
 10854*          IF NO-CONVERSION-ERROR
 10855*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 10856*             MOVE ER-2669       TO WS-ERROR
 10857*             PERFORM 9900-ERROR-FORMAT
 10858*                                THRU 9900-EXIT
 10859*          END-IF
 10860*       ELSE
 10861*          IF WS-ATT-AGE >= PL-ATT-AGE
 10862*             MOVE ER-2669       TO WS-ERROR
 10863*             PERFORM 9900-ERROR-FORMAT
 10864*                                THRU 9900-EXIT
 10865*          END-IF
 10866*       END-IF
 10867*    END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 198
* EL050.cbl
 10868     .
 10869 0570-CHECK-LIFE-LIMITS.
 10870
 10871     IF PB-COMPANY-ID EQUAL 'CRI'
 10872        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10873           IF SUB2 GREATER THAN +4
 10874              MOVE ER-2637 TO WS-ERROR
 10875              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10876              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10877
 10878     IF PB-COMPANY-ID  =  'NCL'
 10879        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10880            SUB2 GREATER THAN +8
 10881             MOVE 'U'         TO PB-BATCH-ENTRY
 10882             MOVE ER-2637     TO WS-ERROR
 10883             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10884             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10885
 10886     IF SUB2 > +8
 10887        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10888           AND (PB-I-SIG-SW = 'Y')
 10889           CONTINUE
 10890        ELSE
 10891           MOVE ER-2637          TO WS-ERROR
 10892           PERFORM 9900-ERROR-FORMAT
 10893                                 THRU 9900-EXIT
 10894        END-IF
 10895        GO TO 0580-AH-PLAN-LIMIT-EDITS
 10896     END-IF
 10897     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 10898     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 10899     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 10900
 10901     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10902        ADD +1  TO SUB2
 10903        GO TO 0570-CHECK-LIFE-LIMITS.
 10904
 10905     IF PB-COMPANY-ID = 'NCL'
 10906         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 10907
 10908     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 10909        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 10910        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10911           AND (PB-I-SIG-SW = 'Y')
 10912           CONTINUE
 10913        ELSE
 10914           MOVE ER-2637          TO WS-ERROR
 10915           PERFORM 9900-ERROR-FORMAT
 10916                                 THRU 9900-EXIT
 10917        END-IF
 10918     END-IF
 10919     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10920
 10921
 10922 0570-CHECK-NCL-LIFE-LIMITS.
 10923
 10924     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 10925        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 199
* EL050.cbl
 10926         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10927
 10928     IF APP-CERT-USED
 10929         IF SUB2  LESS THAN  +5
 10930             MOVE +5          TO SUB2
 10931             GO TO 0570-CHECK-LIFE-LIMITS.
 10932
 10933     MOVE ER-2637             TO WS-ERROR.
 10934     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10935
 10936     MOVE 'U'                 TO PB-BATCH-ENTRY.
 10937
 10938 0575-CHECK-NCL-SIG-SWITCH.
 10939
 10940     IF NOT APP-CERT-USED
 10941         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10942
 10943     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 10944        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 10945        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 10946        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 10947         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10948
 10949     IF SUB2 GREATER THAN +4
 10950         IF PL-LM-AGE (5) = ZEROS  AND
 10951            PL-LM-AGE (6) = ZEROS  AND
 10952            PL-LM-AGE (7) = ZEROS  AND
 10953            PL-LM-AGE (8) = ZEROS
 10954             MOVE  ER-1927        TO WS-ERROR
 10955             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 10956             GO TO 0580-AH-PLAN-LIMIT-EDITS
 10957         ELSE
 10958             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 10959                 MOVE  ER-1920    TO WS-ERROR
 10960                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10961
 10962     IF PB-I-SIG-SW  = 'Y'
 10963       IF NOT PB-I-POLICY-ACCEPTED  AND
 10964          NOT PB-I-POLICY-DECLINED
 10965           MOVE 'U'               TO PB-BATCH-ENTRY
 10966           MOVE  ER-1926          TO WS-ERROR
 10967           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10968
 10969
 10970 0580-AH-PLAN-LIMIT-EDITS.
 10971
 10972     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10973        IF PB-I-AH-BENEFIT-AMT > +1250
 10974           MOVE ER-2702          TO WS-ERROR
 10975           PERFORM 9900-ERROR-FORMAT
 10976                                 THRU 9900-EXIT
 10977        END-IF
 10978     END-IF
 10979
 10980     IF (PB-COMPANY-ID = 'DCC')
 10981        AND (PB-MONTHLY-CERT)
 10982        IF PB-I-AH-BENEFIT-AMT > +3000
 10983           MOVE ER-2881          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 200
* EL050.cbl
 10984           PERFORM 9900-ERROR-FORMAT
 10985                                 THRU 9900-EXIT
 10986        END-IF
 10987     END-IF
 10988     IF NOT AH-PLAN-MASTER-FOUND
 10989        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 10990        GO TO 3000-CONTINUE-EDIT.
 10991
 10992     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 10993
 10994     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10995         IF PL-LM-AGE (1) = ZEROS
 10996             GO TO 3000-CONTINUE-EDIT.
 10997
 10998     IF NO-AH-BENEFIT-MATCH          OR
 10999        WS-AH-BENEFIT-CD = ZEROS     OR
 11000        WS-AH-SPECIAL-CALC-CD = 'M'
 11001        GO TO 3000-CONTINUE-EDIT.
 11002
 11003     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11004     MOVE +1                     TO SUB2.
 11005
 11006     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11007        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11008           MOVE +5 TO SUB2
 11009           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11010              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11011              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11012              (PL-LM-AGE (SUB2) EQUAL +0)
 11013              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 11014              GO TO 3000-CONTINUE-EDIT.
 11015
 11016     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11017
 11018 0590-CHECK-AH-ATT-AGE.
 11019
 11020     IF PL-ATT-AGE NUMERIC AND
 11021        PL-ATT-AGE GREATER THAN +0
 11022        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11023     END-IF
 11024*       IF WS-ATT-AGE >= PL-ATT-AGE
 11025*          MOVE ER-3054          TO WS-ERROR
 11026*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11027     .
 11028 0597-CHECK-AH-LIMITS.
 11029
 11030     IF PB-COMPANY-ID EQUAL 'CRI'
 11031        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11032           IF SUB2 GREATER THAN +4
 11033              MOVE ER-2638       TO WS-ERROR
 11034              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11035              GO TO 3000-CONTINUE-EDIT.
 11036
 11037     IF PB-COMPANY-ID  =  'NCL'
 11038        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11039            SUB2 GREATER THAN +8
 11040             MOVE 'U'            TO PB-BATCH-ENTRY
 11041             MOVE ER-2638        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 201
* EL050.cbl
 11042             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11043             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11044
 11045     IF SUB2 > +8
 11046        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11047           AND (PB-I-SIG-SW = 'Y')
 11048           CONTINUE
 11049        ELSE
 11050           MOVE ER-2638          TO WS-ERROR
 11051           PERFORM 9900-ERROR-FORMAT
 11052                                 THRU 9900-EXIT
 11053        END-IF
 11054        GO TO 3000-CONTINUE-EDIT
 11055     END-IF
 11056
 11057     IF PB-COMPANY-ID = 'CRI'
 11058        IF WS-ERROR = ER-2638
 11059           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11060
 11061     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11062     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11063     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11064     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11065
 11066     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11067        ADD +1                   TO SUB2
 11068        GO TO 0597-CHECK-AH-LIMITS.
 11069
 11070     IF PB-COMPANY-ID = 'NCL'
 11071         GO TO 0597-CHECK-NCL-AH-LIMITS.
 11072
 11073     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11074        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11075        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11076                                 > PL-LM-AMT (SUB2))
 11077        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11078           AND (PB-I-SIG-SW = 'Y')
 11079           CONTINUE
 11080        ELSE
 11081           MOVE ER-2638          TO WS-ERROR
 11082           PERFORM 9900-ERROR-FORMAT
 11083                                 THRU 9900-EXIT
 11084        END-IF
 11085     END-IF
 11086
 11087     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11088         IF  WS-ERROR    EQUAL    ER-2638
 11089             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11090                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11091                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11092                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11093                MOVE  ER-1910    TO  WS-ERROR
 11094                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11095
 11096     IF PB-COMPANY-ID = 'CRI'
 11097        IF WS-ERROR = ER-2638
 11098            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11099            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 202
* EL050.cbl
 11100            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11101
 11102     GO TO 3000-CONTINUE-EDIT.
 11103
 11104 0597-CHECK-NCL-AH-LIMITS.
 11105
 11106     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11107        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11108        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11109                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11110         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11111
 11112     IF APP-CERT-USED
 11113         IF SUB2  LESS THAN  +5
 11114             MOVE +5             TO SUB2
 11115             GO TO 0597-CHECK-AH-LIMITS.
 11116
 11117     MOVE ER-2638                TO WS-ERROR.
 11118     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11119
 11120     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11121
 11122 0599-CHECK-NCL-SIG-SWITCH.
 11123
 11124     IF NOT APP-CERT-USED
 11125         GO TO 3000-CONTINUE-EDIT.
 11126
 11127     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11128        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11129        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11130        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11131         GO TO 3000-CONTINUE-EDIT.
 11132
 11133     IF SUB2 GREATER THAN +4
 11134         IF PL-LM-AGE (5) = ZEROS  AND
 11135            PL-LM-AGE (6) = ZEROS  AND
 11136            PL-LM-AGE (7) = ZEROS  AND
 11137            PL-LM-AGE (8) = ZEROS
 11138             MOVE  ER-1927        TO WS-ERROR
 11139             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11140             GO TO 3000-CONTINUE-EDIT
 11141         ELSE
 11142             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11143                 MOVE  ER-1920    TO WS-ERROR
 11144                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11145
 11146     IF PB-I-SIG-SW  = 'Y'
 11147       IF NOT PB-I-POLICY-ACCEPTED  AND
 11148          NOT PB-I-POLICY-DECLINED
 11149           MOVE 'U'               TO PB-BATCH-ENTRY
 11150           MOVE  ER-1926          TO WS-ERROR
 11151           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11152
 11153******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 203
* EL050.cbl
 11155
 11156 3000-CONTINUE-EDIT.
 11157
 11158     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11159     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11160     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11161     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11162     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11163
 11164     IF BROWSE-STARTED
 11165        PERFORM 9990-RETURN THRU 9990-EXIT
 11166        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11167
 11168     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11169        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11170        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11171        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11172*       MOVE 1                   TO DC-OPTION-CODE
 11173        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11174        IF DATE-CONVERSION-ERROR
 11175           MOVE ER-2622          TO WS-ERROR
 11176           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11177        ELSE
 11178           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11179              MOVE ER-2623       TO WS-ERROR
 11180              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11181           ELSE
 11182              MOVE ER-2622       TO WS-ERROR
 11183              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11184
 11185     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11186     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11187     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11188*    MOVE 1                      TO DC-OPTION-CODE.
 11189     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11190     IF DATE-CONVERSION-ERROR
 11191        GO TO 3005-EDIT-CONTINUE
 11192     ELSE
 11193        IF DC-ELAPSED-DAYS GREATER +180
 11194           MOVE ER-2613          TO WS-ERROR
 11195           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11196        ELSE
 11197           IF DC-ELAPSED-DAYS GREATER +90
 11198              MOVE ER-2612       TO WS-ERROR
 11199              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11200           ELSE
 11201             IF DC-ELAPSED-DAYS GREATER +60
 11202                MOVE ER-2614     TO WS-ERROR
 11203                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11204
 11205 3005-EDIT-CONTINUE.
 11206
 11207     IF PB-CANCELLATION
 11208         GO TO 3700-EDIT-CANCEL.
 11209
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 204
* EL050.cbl
 11211******************************************************************
 11212*                  E D I T   I S S U E                           *
 11213******************************************************************
 11214
 11215 3020-EDIT-ISSUE.
 11216
 11217      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11218      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11219      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11220      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11221      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11222
 11223     IF PB-ISSUE-FORCE
 11224        OR PB-ISSUE-DATE-FORCED
 11225        OR PB-FORCE-OFF
 11226        OR PB-OVERCHARGE-FORCE
 11227        CONTINUE
 11228     ELSE
 11229        MOVE ER-2670             TO WS-ERROR
 11230        PERFORM 9900-ERROR-FORMAT
 11231                                 THRU 9900-EXIT
 11232     END-IF
 11233     .
 11234 3022-SET-POLICY-STATUS.
 11235
 11236     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11237
 11238     IF (PB-REISSUED-CERT)
 11239             OR
 11240        ((PB-COMPANY-ID NOT = 'DCC')
 11241         AND (PB-MONTHLY-CERT))
 11242         MOVE '5'                TO PB-I-ENTRY-STATUS
 11243         MOVE 'E'                TO PB-BATCH-ENTRY
 11244     END-IF
 11245
 11246     IF PB-COMPANY-ID = 'DCC'
 11247        IF PB-MONTHLY-CERT
 11248           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11249        END-IF
 11250     END-IF
 11251     IF PB-POLICY-IS-DECLINED
 11252         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11253     IF PB-POLICY-IS-VOIDED
 11254         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11255     IF PB-NEEDS-UNDERWRITING
 11256         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11257     IF PB-REIN-ONLY-CERT
 11258         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11259     IF PB-PREM-ACCTNG-ONLY
 11260         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11261
 11262     MOVE SPACE                  TO PB-I-OB-FLAG.
 11263
 11264     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 11265         MOVE ER-2665            TO WS-ERROR
 11266         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11267         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11268
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 205
* EL050.cbl
 11269     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11270        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11271           MOVE 'Z'             TO PB-I-OB-FLAG.
 11272
 11273     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11274        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11275           MOVE 'Z'             TO PB-I-OB-FLAG.
 11276
 11277     IF ACCOUNT-MAST-FOUND
 11278         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11279         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11280         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11281         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11282         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11283         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11284         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11285     END-IF
 11286
 11287     IF ACCOUNT-MAST-FOUND
 11288        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11289         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11290
 11291     IF (ACCOUNT-MAST-FOUND)
 11292        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11293        IF PB-REISSUED-CERT
 11294           CONTINUE
 11295        ELSE
 11296           MOVE ER-2608          TO WS-ERROR
 11297           PERFORM 9900-ERROR-FORMAT
 11298                                 THRU 9900-EXIT
 11299         END-IF
 11300     END-IF
 11301
 11302     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11303        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11304        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11305
 11306**********   DMD CUSTOM CODE FOLLOWS  **********
 11307 3024-EDIT-DMD-FIELDS.
 11308     IF PB-COMPANY-ID NOT = 'DMD'
 11309        GO TO 3025-EDIT-REINSURANCE.
 11310
 11311*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11312*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11313*** ERROR IF THEY ARE NOT EQUAL.
 11314
 11315     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11316     SET BIN-TO-GREG               TO TRUE.
 11317     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11318     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11319**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11320
 11321     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11322     SET BIN-TO-GREG               TO TRUE.
 11323     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11324     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11325**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11326
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 206
* EL050.cbl
 11327     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11328        MOVE ER-8116               TO WS-ERROR
 11329        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11330
 11331     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11332
 11333     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11334                                      WK-FULL-CERT-NO.
 11335     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11336
 11337     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11338
 11339     IF PB-VALID-LIFE
 11340        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11341     ELSE
 11342        IF PB-VALID-AH
 11343          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11344
 11345
 11346     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11347     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11348     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11349                                      DCUA-UNDRWRTR-CODE
 11350                                      DCUA-UNDRWRTR-GROUP-CODE
 11351                                      DCUA-RETURN-CODE.
 11352
 11353****************************************************************
 11354*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11355***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11356***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11357***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11358***   TO THIS RECORD.                                        ***
 11359****************************************************************
 11360     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11361     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11362     IF DCUA-SUCCESSFUL-PROCESS
 11363        GO TO 3024-EDIT-DL7-CONT.
 11364
 11365     IF DCUA-RETURN-CODE EQUAL '01'
 11366        MOVE ER-8110               TO WS-ERROR
 11367        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11368        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11369        GO TO 3024-EDIT-DL7-CONT.
 11370
 11371     IF DCUA-RETURN-CODE EQUAL '02'
 11372        MOVE ER-8111               TO WS-ERROR
 11373        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11374        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11375        GO TO 3024-EDIT-DL7-CONT.
 11376
 11377     IF DCUA-RETURN-CODE EQUAL '03'
 11378        MOVE ER-8074               TO WS-ERROR
 11379        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11380        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11381        GO TO 3024-EDIT-DL7-CONT.
 11382
 11383     IF DCUA-RETURN-CODE EQUAL '04'
 11384        MOVE ER-8075               TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 207
* EL050.cbl
 11385        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11386        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11387        GO TO 3024-EDIT-DL7-CONT.
 11388
 11389     IF DCUA-RETURN-CODE EQUAL '05'
 11390        MOVE ER-8076               TO WS-ERROR
 11391        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11392        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11393        GO TO 3024-EDIT-DL7-CONT.
 11394
 11395     IF DCUA-RETURN-CODE EQUAL '06'
 11396        MOVE ER-8077               TO WS-ERROR
 11397        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11398        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11399        GO TO 3024-EDIT-DL7-CONT.
 11400
 11401     IF DCUA-RETURN-CODE EQUAL '07'
 11402        MOVE ER-8078               TO WS-ERROR
 11403        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11404        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11405        GO TO 3024-EDIT-DL7-CONT.
 11406
 11407     IF DCUA-RETURN-CODE EQUAL 'E1'
 11408        MOVE ER-8079               TO WS-ERROR
 11409        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11410        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11411        GO TO 3024-EDIT-DL7-CONT.
 11412
 11413     IF DCUA-RETURN-CODE EQUAL 'E2'
 11414        MOVE ER-8080               TO WS-ERROR
 11415        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11416        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11417        GO TO 3024-EDIT-DL7-CONT.
 11418
 11419     IF DCUA-RETURN-CODE EQUAL 'E3'
 11420        MOVE ER-8098               TO WS-ERROR
 11421        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11422        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11423        GO TO 3024-EDIT-DL7-CONT.
 11424
 11425     IF DCUA-RETURN-CODE EQUAL 'C1'
 11426        MOVE ER-8099               TO WS-ERROR
 11427        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11428        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11429        GO TO 3024-EDIT-DL7-CONT.
 11430
 11431     IF DCUA-RETURN-CODE EQUAL 'U1'
 11432        MOVE ER-8109               TO WS-ERROR
 11433        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11434        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11435        GO TO 3024-EDIT-DL7-CONT.
 11436
 11437     IF DCUA-RETURN-CODE EQUAL 'N1'
 11438        MOVE ER-8112               TO WS-ERROR
 11439        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11440        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11441        GO TO 3024-EDIT-DL7-CONT.
 11442
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 208
* EL050.cbl
 11443     IF DCUA-RETURN-CODE EQUAL 'N2'
 11444        MOVE ER-8113               TO WS-ERROR
 11445        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11446        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11447        GO TO 3024-EDIT-DL7-CONT.
 11448
 11449     IF DCUA-RETURN-CODE EQUAL 'N3'
 11450        MOVE ER-8114               TO WS-ERROR
 11451        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11452        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11453        GO TO 3024-EDIT-DL7-CONT.
 11454
 11455     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11456     MOVE ER-8097                  TO WS-ERROR.
 11457     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11458     GO TO 3024-EDIT-DL7-CONT.
 11459
 11460 3024-EDIT-DL7-CONT.
 11461
 11462     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11463     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11464     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11465        NEXT SENTENCE
 11466     ELSE
 11467        MOVE ER-9263               TO WS-ERROR
 11468        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11469
 11470******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11471******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11472     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11473        NEXT SENTENCE
 11474     ELSE
 11475        MOVE ER-8039               TO WS-ERROR
 11476        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11477
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 209
* EL050.cbl
 11479****************************************************************
 11480*** VALIDATE STATE  : DLO022                                 ***
 11481****************************************************************
 11482     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11483     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11484
 11485     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11486     IF DVSC-SUCCESSFUL-EDIT
 11487        GO TO 3024-EDIT-DL22-CONT.
 11488
 11489     IF DVSC-RETURN-CODE EQUAL '01'
 11490        MOVE ER-8300               TO WS-ERROR
 11491        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11492        GO TO 3024-EDIT-DL22-CONT.
 11493
 11494     IF DVSC-RETURN-CODE EQUAL '02'
 11495        MOVE ER-8301               TO WS-ERROR
 11496        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11497        GO TO 3024-EDIT-DL22-CONT.
 11498
 11499     IF DVSC-RETURN-CODE EQUAL '03'
 11500        MOVE ER-8302               TO WS-ERROR
 11501        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11502        GO TO 3024-EDIT-DL22-CONT.
 11503
 11504     IF DVSC-RETURN-CODE EQUAL 'N1'
 11505        MOVE ER-8304               TO WS-ERROR
 11506        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11507        GO TO 3024-EDIT-DL22-CONT.
 11508
 11509     MOVE ER-8303                  TO WS-ERROR
 11510     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11511
 11512 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 210
* EL050.cbl
 11514****************************************************************
 11515*** VALIDATE LOAN OFFICER : DLO021                           ***
 11516****************************************************************
 11517
 11518     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11519     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11520     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11521     IF DVLO-SUCCESSFUL-EDIT
 11522        GO TO 3024-EDIT-DL21-CONT.
 11523
 11524     IF DVLO-RETURN-CODE EQUAL '01'
 11525        MOVE ER-8081               TO WS-ERROR
 11526        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11527        GO TO 3024-EDIT-DL21-CONT.
 11528
 11529     IF DVLO-RETURN-CODE EQUAL '02'
 11530        MOVE ER-8082               TO WS-ERROR
 11531        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11532        GO TO 3024-EDIT-DL21-CONT.
 11533
 11534     IF DVLO-RETURN-CODE EQUAL '03'
 11535        MOVE ER-8083               TO WS-ERROR
 11536        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11537        GO TO 3024-EDIT-DL21-CONT.
 11538
 11539     IF DVLO-RETURN-CODE EQUAL '04'
 11540        MOVE ER-8084               TO WS-ERROR
 11541        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11542        GO TO 3024-EDIT-DL21-CONT.
 11543
 11544     IF DVLO-RETURN-CODE EQUAL '05'
 11545        MOVE ER-8085               TO WS-ERROR
 11546        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11547        GO TO 3024-EDIT-DL21-CONT.
 11548
 11549     MOVE ER-7825                  TO WS-ERROR
 11550     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11551     GO TO 3024-EDIT-DL21-CONT.
 11552
 11553 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 211
* EL050.cbl
 11555
 11556****************************************************************
 11557*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11558****************************************************************
 11559
 11560     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11561     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11562     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11563     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11564     IF DIPF-SUCCESSFUL-EDIT
 11565        GO TO 3024-EDIT-DL02-CONT.
 11566
 11567     IF DIPF-RETURN-CODE EQUAL '01'
 11568        MOVE ER-8086               TO WS-ERROR
 11569        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11570        GO TO 3024-EDIT-DL02-CONT.
 11571
 11572     IF DIPF-RETURN-CODE EQUAL '02'
 11573        MOVE ER-8087               TO WS-ERROR
 11574        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11575        GO TO 3024-EDIT-DL02-CONT.
 11576
 11577     IF DIPF-RETURN-CODE EQUAL '03'
 11578        MOVE ER-8088               TO WS-ERROR
 11579        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11580        GO TO 3024-EDIT-DL02-CONT.
 11581
 11582     MOVE ER-8095                  TO WS-ERROR
 11583     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11584     GO TO 3024-EDIT-DL02-CONT.
 11585
 11586 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 212
* EL050.cbl
 11588
 11589****************************************************************
 11590*** VALIDATE BANK ID : DLO003                                ***
 11591****************************************************************
 11592
 11593     MOVE WK-GREG-CENT           TO WCG-CENT.
 11594     MOVE WK-GREG-YYMM           TO WCG-REST.
 11595     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11596        MOVE ER-8040               TO WS-ERROR
 11597        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11598
 11599     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11600     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11601     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11602     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11603     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11604     IF DVBI-SUCCESSFUL-EDIT
 11605        GO TO 3024-EDIT-DL03-CONT.
 11606
 11607     IF DVBI-RETURN-CODE EQUAL '01'
 11608        MOVE ER-8089               TO WS-ERROR
 11609        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11610        GO TO 3024-EDIT-DL03-CONT.
 11611
 11612     IF DVBI-RETURN-CODE EQUAL '02'
 11613        MOVE ER-8090               TO WS-ERROR
 11614        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11615        GO TO 3024-EDIT-DL03-CONT.
 11616
 11617     IF DVBI-RETURN-CODE EQUAL '03'
 11618        MOVE ER-8091               TO WS-ERROR
 11619        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11620        GO TO 3024-EDIT-DL03-CONT.
 11621
 11622     IF DVBI-RETURN-CODE EQUAL '04'
 11623        MOVE ER-8092               TO WS-ERROR
 11624        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11625        GO TO 3024-EDIT-DL03-CONT.
 11626
 11627     IF DVBI-RETURN-CODE EQUAL '05'
 11628        MOVE ER-8093               TO WS-ERROR
 11629        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11630        GO TO 3024-EDIT-DL03-CONT.
 11631
 11632     IF DVBI-RETURN-CODE EQUAL '06'
 11633        MOVE ER-8094               TO WS-ERROR
 11634        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11635        GO TO 3024-EDIT-DL03-CONT.
 11636
 11637     MOVE ER-8096                  TO WS-ERROR
 11638     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11639     GO TO 3024-EDIT-DL03-CONT.
 11640
 11641 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 213
* EL050.cbl
 11643
 11644     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11645        NEXT SENTENCE
 11646     ELSE
 11647        MOVE ER-8042               TO WS-ERROR
 11648        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11649
 11650     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11651     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11652     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11653
 11654     IF DMPF-RETURN-CODE = '01'
 11655        MOVE ER-8067               TO WS-ERROR
 11656        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11657        GO TO 3024-EDIT-DL01-CONT.
 11658
 11659     IF DMPF-RETURN-CODE = '02'
 11660        MOVE ER-8068               TO WS-ERROR
 11661        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11662        GO TO 3024-EDIT-DL01-CONT.
 11663
 11664     IF DMPF-RETURN-CODE = '03'
 11665        MOVE ER-8069               TO WS-ERROR
 11666        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11667        GO TO 3024-EDIT-DL01-CONT.
 11668
 11669     IF DMPF-RETURN-CODE = 'E1'
 11670        MOVE ER-8070               TO WS-ERROR
 11671        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11672        GO TO 3024-EDIT-DL01-CONT.
 11673
 11674     IF DMPF-RETURN-CODE = 'N1'
 11675        MOVE ER-8071               TO WS-ERROR
 11676        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11677        GO TO 3024-EDIT-DL01-CONT.
 11678
 11679     IF DMPF-RETURN-CODE NOT = 'OK'
 11680        MOVE ER-8072               TO WS-ERROR
 11681        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11682
 11683 3024-EDIT-DL01-CONT.
 11684******************************************************************
 11685***  VALIDATES RATE CODES : DLO017                             ***
 11686******************************************************************
 11687
 11688      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11689      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11690      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11691      IF DVRC-SUCCESSFUL-EDIT
 11692        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11693        GO TO 3024-CHECK-VALID-RATE.
 11694
 11695      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11696
 11697      IF DVRC-RETURN-CODE EQUAL '01'
 11698         MOVE ER-7817                   TO WS-ERROR
 11699         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11700         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 214
* EL050.cbl
 11701
 11702      IF DVRC-RETURN-CODE EQUAL '02'
 11703         MOVE ER-7818                   TO WS-ERROR
 11704         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11705         GO TO 3025-EDIT-REINSURANCE.
 11706
 11707      IF DVRC-RETURN-CODE EQUAL '03'
 11708         MOVE ER-7819                   TO WS-ERROR
 11709         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11710         GO TO 3025-EDIT-REINSURANCE.
 11711
 11712       MOVE ER-7820                     TO WS-ERROR.
 11713       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11714       GO TO 3025-EDIT-REINSURANCE.
 11715
 11716******************************************************************
 11717***  GET PREMIUM RATES : DLO011                                ***
 11718******************************************************************
 11719
 11720 3024-CHECK-VALID-RATE.
 11721
 11722     IF VALID-RATE-CODE
 11723        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11724        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11725        MOVE SPACES                TO DPRB-RETURN-CODE
 11726        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11727     ELSE
 11728         GO TO 3025-EDIT-REINSURANCE.
 11729
 11730      IF DPRB-SUCCESSFUL-PROCESS
 11731         IF PB-VALID-LIFE
 11732             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11733             GO TO 3025-EDIT-REINSURANCE
 11734         ELSE
 11735             IF PB-VALID-AH
 11736                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11737                 GO TO 3025-EDIT-REINSURANCE.
 11738
 11739      IF DPRB-RETURN-CODE EQUAL '01'
 11740         MOVE ER-7812                   TO WS-ERROR
 11741         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11742         GO TO 3025-EDIT-REINSURANCE.
 11743
 11744      IF DPRB-RETURN-CODE EQUAL '02'
 11745         MOVE ER-7813                   TO WS-ERROR
 11746         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11747         GO TO 3025-EDIT-REINSURANCE.
 11748
 11749      IF DPRB-RETURN-CODE EQUAL '03'
 11750         MOVE ER-7814                   TO WS-ERROR
 11751         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11752         GO TO 3025-EDIT-REINSURANCE.
 11753
 11754      IF DPRB-RETURN-CODE EQUAL '04'
 11755         IF NOT DPRB-1ST-TIME
 11756            MOVE ER-7815                   TO WS-ERROR
 11757            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11758            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 215
* EL050.cbl
 11759          ELSE
 11760         IF PB-VALID-LIFE
 11761            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11762          ELSE
 11763            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11764         END-IF
 11765         MOVE SPACES                TO DOCC-RETURN-CODE
 11766         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11767         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11768         IF DOCC-RETURN-CODE = 'OK'
 11769             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11770             GO TO 3024-CHECK-VALID-RATE
 11771           ELSE
 11772             MOVE ER-7823               TO WS-ERROR
 11773             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11774             GO TO 3025-EDIT-REINSURANCE.
 11775
 11776       MOVE ER-7816                     TO WS-ERROR.
 11777       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11778       GO TO 3025-EDIT-REINSURANCE.
 11779
 11780**********   DMD CUSTOM CODE ABOVE    **********
 11781
 11782 3025-EDIT-REINSURANCE.
 11783     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11784         GO TO 3027-EDIT-CONTINUE.
 11785
 11786     MOVE LOW-VALUES               TO ERREIN-KEY.
 11787     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11788     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11789                                      REIN-CODE-2
 11790                                      REIN-CODE-3.
 11791     MOVE 'A'                      TO REIN-TYPE.
 11792
 11793     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11794
 11795     MOVE '3026' TO REIN-SW.
 11796     MOVE ' '                   TO WS-REIN-READ-SW.
 11797
 11798     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11799     IF REIN-TABLE-NOT-FOUND
 11800         GO TO 3026-NO-SPEC-TABLE.
 11801
 11802     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11803     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11804                                   WS-NSP-ST-CD-LF.
 11805     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11806                                   WS-NSP-ST-CD-AH.
 11807
 11808     GO TO 3040-EDIT-CONTINUE.
 11809
 11810 3026-NO-SPEC-TABLE.
 11811
 11812     MOVE ER-2664                TO WS-ERROR.
 11813     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11814     GO TO 3040-EDIT-CONTINUE.
 11815
 11816 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 216
* EL050.cbl
 11817
 11818     IF PB-I-REIN-TABLE = SPACES
 11819       GO TO 3040-EDIT-CONTINUE.
 11820
 11821     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11822          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11823          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11824           GO TO 3040-EDIT-CONTINUE.
 11825
 11826     MOVE LOW-VALUES            TO ERREIN-KEY.
 11827     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11828     MOVE 'A'                   TO REIN-TYPE.
 11829     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11830
 11831     MOVE '3028'                TO REIN-SW.
 11832     MOVE ' '                   TO WS-REIN-READ-SW.
 11833
 11834     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11835     IF REIN-TABLE-NOT-FOUND
 11836         GO TO 3028-NO-REIN-TABLE.
 11837
 11838     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 11839     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11840                                   WS-NSP-ST-CD-LF.
 11841     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11842                                   WS-NSP-ST-CD-AH.
 11843
 11844     GO TO 3040-EDIT-CONTINUE.
 11845
 11846 3028-NO-REIN-TABLE.
 11847
 11848     MOVE ER-2615                TO WS-ERROR.
 11849     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11850     GO TO 3040-EDIT-CONTINUE.
 11851
 11852 3040-EDIT-CONTINUE.
 11853
 11854     IF PB-I-LF-PREM-CALC NOT NUMERIC
 11855         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 11856
 11857     IF PB-I-AH-PREM-CALC NOT NUMERIC
 11858         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 11859
 11860     IF (NOT PB-REISSUED-CERT)
 11861        AND (NOT PB-MONTHLY-CERT)
 11862        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 11863            MOVE '001'           TO PB-I-LF-TERM
 11864            MOVE 'M'             TO PB-I-INSURED-SEX.
 11865
 11866     IF (NOT PB-REISSUED-CERT)
 11867        AND (NOT PB-MONTHLY-CERT)
 11868        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 11869            MOVE '001'           TO PB-I-AH-TERM
 11870            MOVE 'M'             TO PB-I-INSURED-SEX.
 11871
 11872 3040-EDIT-1ST-PMT-DT.
 11873     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 11874     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 217
* EL050.cbl
 11875         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 11876
 11877******************************************************************
 11878*                                                                *
 11879*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 11880*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 11881*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 11882*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 11883*                                                                *
 11884******************************************************************
 11885
 11886     IF PB-EFF-DT-PROCESSING
 11887        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11888                                    PB-I-LF-EXPIRE-DT
 11889                                    PB-I-AH-EXPIRE-DT
 11890        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11891        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11892        MOVE ZERO                TO DC-ELAPSED-DAYS
 11893        MOVE +1                  TO DC-ELAPSED-MONTHS
 11894        SET BIN-PLUS-ELAPSED     TO TRUE
 11895*       MOVE 6                   TO DC-OPTION-CODE
 11896        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11897        IF NO-CONVERSION-ERROR
 11898           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11899
 11900******************************************************************
 11901*                                                                *
 11902*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 11903*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 11904*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11905*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 11906*                                                                *
 11907******************************************************************
 11908
 11909     IF PB-EXT-DAYS-PROCESSING
 11910          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 11911                                         PB-I-LF-EXPIRE-DT
 11912                                         PB-I-AH-EXPIRE-DT
 11913          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 11914          MOVE ZERO                   TO DC-ELAPSED-DAYS
 11915          MOVE +1                     TO DC-ELAPSED-MONTHS
 11916          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 11917          SET BIN-PLUS-ELAPSED        TO TRUE
 11918*         MOVE 6                      TO DC-OPTION-CODE
 11919          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11920          IF NO-CONVERSION-ERROR
 11921             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 11922
 11923******************************************************************
 11924*                                                                *
 11925*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 11926*        BASED ON THE OLDEST EXPIRE DATE.                        *
 11927*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11928*        (EXPIRE DATE - (TERM -1))  *  -1.
 11929*                                                                *
 11930******************************************************************
 11931
 11932     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 218
* EL050.cbl
 11933        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 11934           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 11935              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11936              MOVE PB-I-AH-TERM      TO WS-TERM
 11937           ELSE
 11938              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11939              MOVE PB-I-LF-TERM      TO WS-TERM
 11940        ELSE
 11941           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 11942              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11943              MOVE PB-I-LF-TERM      TO WS-TERM
 11944           ELSE
 11945              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11946              MOVE PB-I-AH-TERM      TO WS-TERM.
 11947
 11948     IF PB-EXPIRE-DT-PROCESSING
 11949        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11950        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11951        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 11952        MOVE ZERO                TO DC-ELAPSED-DAYS
 11953                                    DC-ODD-DAYS-OVER
 11954          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 11955          SET BIN-PLUS-ELAPSED    TO TRUE
 11956*         MOVE 6                  TO DC-OPTION-CODE
 11957          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11958          IF NO-CONVERSION-ERROR
 11959             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11960
 11961******************************************************************
 11962*                                                                *
 11963*            1ST PAYMENT DATE PROCESSING                         *
 11964*                                                                *
 11965******************************************************************
 11966
 11967     IF PB-1ST-PMT-DT-PROCESSING
 11968        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 11969                                    PB-I-AH-EXPIRE-DT
 11970        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 11971
 11972     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 11973         NEXT SENTENCE
 11974     ELSE
 11975         MOVE ER-2680                 TO WS-ERROR
 11976         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11977         GO TO 3060-ORIG-TERM-CHECK.
 11978
 11979     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 11980     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 11981     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11982*    MOVE 1                      TO DC-OPTION-CODE.
 11983     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 11984                                    DC-ELAPSED-DAYS
 11985                                    DC-ODD-DAYS-OVER.
 11986
 11987     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11988
 11989     IF DATE-CONVERSION-ERROR
 11990        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 219
* EL050.cbl
 11991
 11992     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 11993     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 11994        AND (WS-LF-COVERAGE-TYPE = 'L')
 11995        IF (DC-ELAPSED-MONTHS > 1)
 11996                      OR
 11997           ((DC-ELAPSED-MONTHS = 1)
 11998           AND (DC-ODD-DAYS-OVER > 0))
 11999           MOVE ER-2882          TO WS-ERROR
 12000           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12001        END-IF
 12002     END-IF
 12003     if dc-elapsed-months > 0
 12004        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12005        + dc-odd-days-over
 12006     end-if
 12007     IF PB-EXT-DAYS-PROCESSING
 12008        CONTINUE
 12009     ELSE
 12010        IF DC-ELAPSED-MONTHS = +0
 12011           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12012        ELSE
 12013           IF (WS-LF-EARNINGS-CALC = '4')
 12014              AND (DC-ELAPSED-MONTHS > ZERO)
 12015              AND (DC-ELAPSED-DAYS > ZERO)
 12016              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12017           ELSE
 12018              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12019                                 THRU 6499-EXIT
 12020              MOVE WS-ODD-DAYS-OVER
 12021                                 TO PB-I-EXTENTION-DAYS
 12022           END-IF
 12023        END-IF
 12024     END-IF
 12025******************************************************************
 12026*                                                                *
 12027*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12028*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12029*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12030*            AND ANY ODD DAYS.                                   *
 12031*                                                                *
 12032******************************************************************
 12033
 12034     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12035                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12036     IF WS-LF-EARNINGS-CALC NOT = '4'
 12037        IF DC-ELAPSED-DAYS > ZEROS
 12038           MOVE ER-2681          TO WS-ERROR
 12039           PERFORM 9900-ERROR-FORMAT
 12040                                 THRU 9900-EXIT
 12041        END-IF
 12042     END-IF
 12043
 12044     IF WS-LF-EARNINGS-CALC NOT = '4'
 12045        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12046           MOVE ER-2681          TO WS-ERROR
 12047           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12048
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 220
* EL050.cbl
 12049     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12050        (PB-I-LF-TERM NOT = ZERO) AND
 12051         NOT NO-LIFE-COVERAGE
 12052          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12053          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12054          IF WS-LF-EARNINGS-CALC = '4'
 12055             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12056             PB-I-PAY-FREQUENCY
 12057          END-IF
 12058          MOVE ZERO              TO DC-ELAPSED-DAYS
 12059                                    DC-ODD-DAYS-OVER
 12060          MOVE 1                 TO DC-END-OF-MONTH
 12061          SET BIN-PLUS-ELAPSED        TO TRUE
 12062*         MOVE 6                 TO DC-OPTION-CODE
 12063          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12064          IF NO-CONVERSION-ERROR
 12065             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12066             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12067                (WS-LF-SPECIAL-CALC-CD = 'L')
 12068                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12069                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12070                  MOVE +1             TO DC-ELAPSED-MONTHS
 12071                  SET BIN-PLUS-ELAPSED  TO TRUE
 12072*                 MOVE 6              TO DC-OPTION-CODE
 12073                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12074                  IF NO-CONVERSION-ERROR
 12075                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12076
 12077* okay, i had to move the new att age edit down here because the
 12078* expiration date could get recalculated and i need the exp date
 12079     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12080        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12081        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12082        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12083           AND ZEROS
 12084           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12085           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12086           SET ELAPSED-BETWEEN-BIN TO TRUE
 12087           PERFORM 8500-DATE-CONVERT
 12088                                 THRU 8500-EXIT
 12089           IF NO-CONVERSION-ERROR
 12090              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12091                 MOVE ER-2669       TO WS-ERROR
 12092*                PERFORM 9900-ERROR-FORMAT
 12093*                                THRU 9900-EXIT
 12094              END-IF
 12095           END-IF
 12096        ELSE
 12097           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12098           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12099              MOVE ER-2669       TO WS-ERROR
 12100*             PERFORM 9900-ERROR-FORMAT
 12101*                                THRU 9900-EXIT
 12102           ELSE
 12103              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12104                 MOVE ER-1570    TO WS-ERROR
 12105                 PERFORM 9900-ERROR-FORMAT
 12106                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 221
* EL050.cbl
 12107              END-IF
 12108           END-IF
 12109        END-IF
 12110        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12111           AND ZEROS
 12112           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12113           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12114           SET ELAPSED-BETWEEN-BIN TO TRUE
 12115           PERFORM 8500-DATE-CONVERT
 12116                                 THRU 8500-EXIT
 12117           IF NO-CONVERSION-ERROR
 12118              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12119                 MOVE ER-2669       TO WS-ERROR
 12120*                PERFORM 9900-ERROR-FORMAT
 12121*                                THRU 9900-EXIT
 12122              END-IF
 12123           END-IF
 12124        ELSE
 12125           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12126             (PB-I-LF-TERM / 12)
 12127           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12128              MOVE ER-2669       TO WS-ERROR
 12129*             PERFORM 9900-ERROR-FORMAT
 12130*                                THRU 9900-EXIT
 12131           ELSE
 12132              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12133                 MOVE ER-1571    TO WS-ERROR
 12134                 PERFORM 9900-ERROR-FORMAT
 12135                                 THRU 9900-EXIT
 12136              END-IF
 12137           END-IF
 12138        END-IF
 12139        IF WS-ERROR = ER-2669
 12140           PERFORM 9900-ERROR-FORMAT
 12141                                 THRU 9900-EXIT
 12142        END-IF
 12143     END-IF
 12144     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12145        (PB-I-AH-TERM NOT = ZERO) AND
 12146         NOT NO-AH-COVERAGE
 12147          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12148             AND (PB-COMPANY-ID = 'DCC')
 12149             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12150             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12151          ELSE
 12152             IF WS-LF-EARNINGS-CALC = '4'
 12153                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12154                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12155                PB-I-PAY-FREQUENCY
 12156             ELSE
 12157                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12158                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12159             END-IF
 12160          END-IF
 12161          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12162                                         DC-ODD-DAYS-OVER
 12163          MOVE 1                      TO DC-END-OF-MONTH
 12164          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 222
* EL050.cbl
 12165*         MOVE 6                      TO DC-OPTION-CODE
 12166          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12167          IF NO-CONVERSION-ERROR
 12168             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12169     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12170        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12171        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12172        IF PB-I-BIRTHDAY > LOW-VALUES
 12173           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12174           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12175           SET ELAPSED-BETWEEN-BIN TO TRUE
 12176           PERFORM 8500-DATE-CONVERT
 12177                                 THRU 8500-EXIT
 12178           IF NO-CONVERSION-ERROR
 12179              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12180                 MOVE ER-3054       TO WS-ERROR
 12181*                PERFORM 9900-ERROR-FORMAT
 12182*                                THRU 9900-EXIT
 12183              END-IF
 12184           END-IF
 12185        ELSE
 12186           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12187           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12188              MOVE ER-3054       TO WS-ERROR
 12189*             PERFORM 9900-ERROR-FORMAT
 12190*                                THRU 9900-EXIT
 12191           END-IF
 12192        END-IF
 12193        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12194           AND ZEROS
 12195           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12196           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12197           SET ELAPSED-BETWEEN-BIN TO TRUE
 12198           PERFORM 8500-DATE-CONVERT
 12199                                 THRU 8500-EXIT
 12200           IF NO-CONVERSION-ERROR
 12201              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12202                 MOVE ER-3054       TO WS-ERROR
 12203*                PERFORM 9900-ERROR-FORMAT
 12204*                                THRU 9900-EXIT
 12205              END-IF
 12206           END-IF
 12207        ELSE
 12208           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12209             (PB-I-AH-TERM / 12)
 12210           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12211              MOVE ER-3054       TO WS-ERROR
 12212*             PERFORM 9900-ERROR-FORMAT
 12213*                                THRU 9900-EXIT
 12214           END-IF
 12215        END-IF
 12216        IF WS-ERROR = ER-3054
 12217           PERFORM 9900-ERROR-FORMAT
 12218                                 THRU 9900-EXIT
 12219        END-IF
 12220     END-IF
 12221     MOVE SPACE                       TO DC-END-OF-MONTH.
 12222
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 223
* EL050.cbl
 12223     IF PB-COMPANY-ID = 'NCB'
 12224        GO TO 3040-EDIT-EXTENSION-DAYS.
 12225
 12226     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12227       AND
 12228        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12229        NEXT SENTENCE
 12230     ELSE
 12231        GO TO 3040-EDIT-EXTENSION-DAYS.
 12232
 12233     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12234        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12235        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12236     ELSE
 12237        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12238        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12239
 12240     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12241*    MOVE '1'      TO DC-OPTION-CODE
 12242     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12243     IF (NO-CONVERSION-ERROR)
 12244        AND (DC-ELAPSED-MONTHS > +1)
 12245        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12246        MOVE ER-2668   TO WS-ERROR
 12247        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12248
 12249 3040-EDIT-EXTENSION-DAYS.
 12250
 12251     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12252        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12253         GO TO 3050-EDIT-TERM-IN-DAYS
 12254     ELSE
 12255         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12256
 12257     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12258         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12259     ELSE
 12260        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12261           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12262           MOVE ER-2681         TO WS-ERROR
 12263           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12264
 12265     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12266        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12267        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12268         GO TO 3060-ORIG-TERM-CHECK.
 12269
 12270     GO TO 3060-ORIG-TERM-CHECK.
 12271
 12272 3050-EDIT-TERM-IN-DAYS.
 12273
 12274     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12275
 12276     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12277         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12278     ELSE
 12279         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12280            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 224
* EL050.cbl
 12281            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12282
 12283     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12284                                       REMAINDER WS-WORK-TERM.
 12285     IF WS-WORK-TERM GREATER THAN ZERO
 12286         ADD +1 TO PB-I-LF-TERM.
 12287
 12288     IF NOT NO-AH-COVERAGE
 12289         MOVE ER-2684            TO WS-ERROR
 12290         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12291
 12292
 12293 3060-ORIG-TERM-CHECK.
 12294
 12295******************************************************************
 12296*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12297******************************************************************
 12298
 12299     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12300        NEXT SENTENCE
 12301     ELSE
 12302        IF NOT NO-LIFE-COVERAGE
 12303           IF PB-I-LF-TERM NUMERIC
 12304              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12305              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12306              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12307                  NEXT SENTENCE
 12308           ELSE
 12309              MOVE ER-2647       TO WS-ERROR
 12310              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12311
 12312     IF NOT NO-AH-COVERAGE
 12313         IF PB-I-AH-TERM NUMERIC
 12314            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12315            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12316            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12317             NEXT SENTENCE
 12318          ELSE
 12319              MOVE ER-2658       TO WS-ERROR
 12320              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12321
 12322     IF PB-COMPANY-ID = 'NCB'
 12323        GO TO 3070-LOAN-TERM-CHECK.
 12324
 12325     IF POLICY-HAS-AH
 12326       AND
 12327        POLICY-HAS-LIFE
 12328       AND
 12329        PB-I-LF-TERM NUMERIC
 12330       AND
 12331        PB-I-AH-TERM NUMERIC
 12332        NEXT SENTENCE
 12333     ELSE
 12334        GO TO 3070-LOAN-TERM-CHECK.
 12335
 12336     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12337     IF WS-TEX-FACT-2 LESS THAN +0
 12338        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 225
* EL050.cbl
 12339
 12340     IF WS-TEX-FACT-2 GREATER THAN +1
 12341        MOVE ER-2668             TO WS-ERROR
 12342        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12343
 12344 3070-LOAN-TERM-CHECK.
 12345
 12346     IF (WS-LF-BENEFIT-CD = ZERO)
 12347         OR (NO-LF-BENEFIT-MATCH)
 12348            GO TO 3125-EDIT-PMT-FREQ.
 12349*    IF PB-COMPANY-ID NOT = 'DCC'
 12350*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12351*          AND 'V' AND 'W' AND 'X'
 12352*          GO TO 3125-EDIT-PMT-FREQ
 12353*       END-IF
 12354*    ELSE
 12355*       IF WS-AH-DCC-TRUNC = 'T'
 12356*          CONTINUE
 12357*       ELSE
 12358*          GO TO 3125-EDIT-PMT-FREQ
 12359*       END-IF
 12360*    END-IF
 12361     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12362                    OR
 12363        ((PB-COMPANY-ID = 'DCC')
 12364        AND (WS-AH-DCC-TRUNC = 'T'))
 12365        CONTINUE
 12366     ELSE
 12367        GO TO 3125-EDIT-PMT-FREQ
 12368     END-IF
 12369     IF PB-I-LOAN-TERM NOT NUMERIC
 12370         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12371
 12372     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12373        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12374*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12375        PB-I-LOAN-TERM NOT GREATER THAN +360
 12376         NEXT SENTENCE
 12377     ELSE
 12378         MOVE ER-2648            TO WS-ERROR
 12379         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12380
 12381     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12382        MOVE ER-3058             TO WS-ERROR
 12383        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12384     end-if
 12385
 12386     IF WS-STATE-ABBREVIATION = 'NC'
 12387        IF PB-I-LOAN-TERM > +59
 12388           CONTINUE
 12389        ELSE
 12390           MOVE ER-2792          TO WS-ERROR
 12391           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12392        END-IF
 12393     END-IF
 12394
 12395     .
 12396 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 226
* EL050.cbl
 12397     IF (WS-LF-BENEFIT-CD = ZERO)
 12398         OR (NO-LF-BENEFIT-MATCH)
 12399            GO TO 3127-EDIT-LOAN-OFFICER.
 12400     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12401                    OR
 12402        ((PB-COMPANY-ID = 'DCC')
 12403        AND (WS-AH-DCC-TRUNC = 'T'))
 12404                    OR
 12405         (PB-COMPANY-ID = 'AHL')
 12406        CONTINUE
 12407     ELSE
 12408        IF (PB-I-LOAN-TERM > ZEROS)
 12409           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12410           MOVE ER-1575          TO WS-ERROR
 12411           PERFORM 9900-ERROR-FORMAT
 12412                                 THRU 9900-EXIT
 12413        END-IF
 12414     END-IF
 12415     IF WS-LF-EARNINGS-CALC NOT = '4'
 12416         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12417            MOVE ER-2653         TO WS-ERROR
 12418            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12419            GO TO 3127-EDIT-LOAN-OFFICER
 12420         ELSE
 12421            GO TO 3127-EDIT-LOAN-OFFICER.
 12422
 12423     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12424         MOVE ER-2655            TO WS-ERROR
 12425         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12426         GO TO 3127-EDIT-LOAN-OFFICER.
 12427
 12428     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12429         MOVE ER-2654            TO WS-ERROR
 12430         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12431         GO TO 3127-EDIT-LOAN-OFFICER.
 12432
 12433     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12434         GIVING WS-TEX-FACT-2
 12435             REMAINDER WS-TEX-FACT-3.
 12436
 12437*    IF WS-TEX-FACT-3 NOT = ZERO
 12438*       MOVE ER-2654             TO WS-ERROR
 12439*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12440
 12441
 12442 3127-EDIT-LOAN-OFFICER.
 12443
 12444     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12445        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12446           MOVE ER-2690          TO WS-ERROR
 12447           PERFORM 9900-ERROR-FORMAT
 12448                                 THRU 9900-EXIT
 12449        ELSE
 12450           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12451           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12452           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12453           MOVE PB-SV-STATE      TO LOFC-STATE
 12454           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 227
* EL050.cbl
 12455           MOVE PB-I-LOAN-OFFICER
 12456                                 TO LOFC-CODE
 12457           PERFORM 8586-READ-LOAN-OFFICER
 12458                                 THRU 8586-EXIT
 12459           IF (NOT LOFC-MASTER-FOUND)
 12460              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12461              MOVE ER-3006       TO WS-ERROR
 12462              PERFORM 9900-ERROR-FORMAT
 12463                                 THRU 9900-EXIT
 12464           END-IF
 12465        END-IF
 12466     END-IF
 12467     .
 12468 3129-EDIT-APR.
 12469
 12470     IF (WS-LF-BENEFIT-CD = ZERO)
 12471        OR (NO-LF-BENEFIT-MATCH)
 12472        IF PB-COMPANY-ID NOT = 'DCC'
 12473           GO TO 3130-EDIT-AGE
 12474*       ELSE
 12475*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12476*             GO TO 3130-EDIT-AGE
 12477*          END-IF
 12478        END-IF
 12479     END-IF
 12480
 12481     IF (WS-STATE-ABBREVIATION = 'OH')
 12482         AND (PB-I-RATE-CLASS NOT = 'L ')
 12483         AND (PB-I-LF-TERM GREATER THAN 60)
 12484         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12485         GO TO 3129-APR-CONT.
 12486
 12487     IF (WS-STATE-ABBREVIATION = 'RI')
 12488         AND (PB-I-LF-TERM GREATER THAN 60)
 12489         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12490         GO TO 3129-APR-CONT.
 12491
 12492     IF (WS-STATE-ABBREVIATION = 'UT')
 12493         AND (PB-I-LF-TERM GREATER THAN 62)
 12494         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12495         AND (PB-CERT-EFF-DT LESS WS-830901)
 12496         GO TO 3129-APR-CONT.
 12497
 12498     IF PB-COMPANY-ID = 'LAP'
 12499        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12500           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12501              MOVE ER-2656         TO WS-ERROR
 12502              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12503              GO TO 3130-EDIT-AGE.
 12504
 12505     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12506        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12507        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12508        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12509        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 12510        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 12511         GO TO 3130-EDIT-AGE.
 12512
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 228
* EL050.cbl
 12513 3129-APR-CONT.
 12514     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12515         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12516         GO TO 3130-EDIT-AGE.
 12517
 12518     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 12519         WS-AH-BENEFIT-CD (1:1) = 'S')
 12520        AND (PB-COMPANY-ID = 'DCC')
 12521        AND (PB-I-LOAN-APR = ZERO)
 12522        MOVE ER-2657             TO WS-ERROR
 12523        PERFORM 9900-ERROR-FORMAT
 12524                                 THRU 9900-EXIT
 12525        GO TO 3130-EDIT-AGE
 12526     END-IF
 12527*    IF PB-I-LOAN-APR = ZERO
 12528*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12529*    END-IF
 12530
 12531     if pb-i-loan-apr = +99.9999
 12532        move er-2656             to ws-error
 12533        PERFORM 9900-ERROR-FORMAT
 12534                                 THRU 9900-EXIT
 12535        GO TO 3130-EDIT-AGE
 12536     end-if
 12537*    IF PB-I-LOAN-APR = ZERO
 12538*       MOVE ER-2656             TO WS-ERROR
 12539*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12540*       GO TO 3130-EDIT-AGE.
 12541
 12542*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12543     if pb-i-loan-apr not = +99.9999
 12544        IF PB-I-LOAN-APR > +30.000
 12545           MOVE ER-2657          TO WS-ERROR
 12546           PERFORM 9900-ERROR-FORMAT
 12547                                 THRU 9900-EXIT
 12548        end-if
 12549     end-if
 12550     .
 12551 3130-EDIT-AGE.
 12552
 12553******************************************************************
 12554*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12555******************************************************************
 12556
 12557     IF NOT NO-LIFE-COVERAGE
 12558        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12559           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12560               MOVE ER-2628             TO WS-ERROR
 12561               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12562
 12563     IF NOT NO-AH-COVERAGE
 12564        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12565           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12566               MOVE ER-2628         TO WS-ERROR
 12567               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12568
 12569 3133-SEX-CODE.
 12570     IF PB-I-INSURED-SEX = SPACE OR ZERO
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 229
* EL050.cbl
 12571         IF WS-DEFAULT-SEX = 'M'
 12572             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12573          ELSE
 12574             IF WS-DEFAULT-SEX = 'F'
 12575             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12576
 12577     IF PB-I-INSURED-SEX = '1'
 12578         MOVE 'M' TO PB-I-INSURED-SEX.
 12579
 12580     IF PB-I-INSURED-SEX = '2'
 12581         MOVE 'F' TO PB-I-INSURED-SEX.
 12582
 12583 3134-SIG-SW-EDIT.
 12584     IF PB-I-SIG-SW = SPACE
 12585         MOVE 'N'                TO  PB-I-SIG-SW.
 12586
 12587     IF PB-COMPANY-ID = 'NCL'
 12588         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12589             NEXT SENTENCE
 12590         ELSE
 12591             MOVE ER-1923        TO  WS-ERROR
 12592             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12593     ELSE
 12594     IF PB-COMPANY-ID = 'CRI'
 12595         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12596             NEXT SENTENCE
 12597         ELSE
 12598             MOVE ER-2606        TO  WS-ERROR
 12599             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12600     ELSE
 12601     IF PB-COMPANY-ID = 'TMS'
 12602         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12603             NEXT SENTENCE
 12604         ELSE
 12605             MOVE ER-2689        TO  WS-ERROR
 12606             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12607     ELSE
 12608         IF PB-I-SIG-SW = 'Y' OR 'N'
 12609             NEXT SENTENCE
 12610         ELSE
 12611             MOVE ER-2651        TO  WS-ERROR
 12612             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12613
 12614     IF PB-COMPANY-ID = 'FLA'
 12615         IF (WS-EDIT-AGE GREATER 54  OR
 12616             WS-AH-EDIT-AGE GREATER 54)  AND
 12617            PB-I-SIG-SW = 'N'
 12618            MOVE ER-2651         TO  WS-ERROR
 12619            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12620
 12621 3135-NAME-EDIT.
 12622
 12623     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12624        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12625        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12626           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12627                                 TO PB-I-JOINT-FIRST-NAME
 12628        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 230
* EL050.cbl
 12629     END-IF
 12630     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12631        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12632        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12633           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12634                                 TO PB-I-JOINT-LAST-NAME
 12635        END-PERFORM
 12636     END-IF
 12637     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12638        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12639        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12640           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12641                                 TO PB-I-INSURED-FIRST-NAME
 12642        END-PERFORM
 12643     END-IF
 12644     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12645        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12646        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12647           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12648                                 TO PB-I-INSURED-LAST-NAME
 12649        END-PERFORM
 12650     END-IF
 12651     IF PB-I-INSURED-LAST-NAME = SPACES
 12652       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12653       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12654           MOVE ER-2660    TO WS-ERROR
 12655           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12656
 12657 3136-EDIT-SEX.
 12658
 12659******************************************************************
 12660*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12661******************************************************************
 12662
 12663     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12664        (WS-AH-SPECIAL-CALC-CD = 'O')
 12665        NEXT SENTENCE
 12666     ELSE
 12667        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12668           NEXT SENTENCE
 12669        ELSE
 12670           MOVE ER-2629            TO WS-ERROR
 12671           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12672
 12673 3137-EDIT-EFF-DATE.
 12674
 12675     IF PB-REISSUED-CERT       OR
 12676        PB-POLICY-IS-DECLINED  OR
 12677        PB-POLICY-IS-VOIDED
 12678         GO TO 3139-EDIT-COVERAGE-CODES.
 12679
 12680     MOVE SPACE                  TO WS-2671-SW
 12681                                    WS-2672-SW.
 12682
 12683     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12684         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12685             MOVE ER-2703        TO WS-ERROR
 12686             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 231
* EL050.cbl
 12687             GO TO 3139-EDIT-COVERAGE-CODES.
 12688
 12689     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12690         GO TO 3139-EDIT-COVERAGE-CODES.
 12691
 12692     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12693     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12694*    MOVE '1'                    TO DC-OPTION-CODE.
 12695     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12696     MOVE +0                     TO DC-ELAPSED-MONTHS
 12697                                    DC-ELAPSED-DAYS.
 12698     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12699
 12700     IF DATE-CONVERSION-ERROR
 12701         GO TO 3139-EDIT-COVERAGE-CODES.
 12702
 12703     IF DC-ELAPSED-DAYS GREATER +180
 12704         MOVE ER-2672            TO WS-ERROR
 12705         MOVE 'Y'                TO WS-2672-SW
 12706         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12707     END-IF
 12708
 12709     IF WS-ERROR = ER-2671  AND
 12710        PB-COMPANY-ID  = 'LBL'
 12711        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12712        MOVE SPACE               TO WS-2671-SW
 12713        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12714
 12715     IF PB-ISSUE-DATE-FORCED  AND
 12716      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12717         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12718         MOVE ER-2673            TO WS-ERROR
 12719         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12720         MOVE SPACE              TO WS-2671-SW
 12721                                    WS-2672-SW.
 12722
 12723     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12724         IF PB-ISSUE-DATE-FORCED
 12725             MOVE ER-2600          TO  WS-ERROR
 12726             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12727         ELSE
 12728             MOVE ER-2692          TO  WS-ERROR
 12729             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12730
 12731
 12732 3139-EDIT-COVERAGE-CODES.
 12733
 12734     if pb-company-id not = 'AHL'
 12735        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12736           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12737           MOVE ER-2787          TO WS-ERROR
 12738           PERFORM 9900-ERROR-FORMAT
 12739                                 THRU 9900-EXIT
 12740        END-IF
 12741     end-if
 12742     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12743        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12744                                 > 250000.00
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 232
* EL050.cbl
 12745           MOVE ER-2719          TO WS-ERROR
 12746           PERFORM 9900-ERROR-FORMAT
 12747                                 THRU 9900-EXIT
 12748        END-IF
 12749     END-IF
 12750
 12751     IF PB-POLICY-IS-DECLINED  OR
 12752        PB-POLICY-IS-VOIDED
 12753         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12754
 12755     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12756        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12757         MOVE ER-2630                TO WS-ERROR
 12758         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12759
 12760     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12761        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12762        PB-I-LF-PREMIUM-AMT = ZERO
 12763         GO TO 3140-CHECK-AH-FOR-ZERO.
 12764
 12765     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12766        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12767        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12768         GO TO 3140-CHECK-AH-FOR-ZERO.
 12769
 12770     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12771        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12772        MOVE ER-2631             TO WS-ERROR
 12773        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12774     END-IF
 12775
 12776
 12777******************************************************************
 12778*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12779******************************************************************
 12780
 12781     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12782        NEXT SENTENCE
 12783     ELSE
 12784        IF PB-I-LF-BENEFIT-AMT = ZERO
 12785           MOVE ER-2632             TO WS-ERROR
 12786           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12787
 12788
 12789******************************************************************
 12790*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12791******************************************************************
 12792
 12793     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12794        CONTINUE
 12795     ELSE
 12796        IF PB-I-LF-PREMIUM-AMT = ZERO
 12797           IF (NOT PB-COMP-LF-PREM)
 12798              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12799              MOVE ER-2633       TO WS-ERROR
 12800              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12801           END-IF
 12802        END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 233
* EL050.cbl
 12803     END-IF
 12804     .
 12805 3140-CHECK-AH-FOR-ZERO.
 12806
 12807     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12808        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12809        PB-I-AH-PREMIUM-AMT = ZERO
 12810         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12811
 12812     IF PB-COMPANY-ID = 'CSL'  AND
 12813        PB-I-AH-BENEFIT-CD = ZERO  AND
 12814        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12815        PB-I-AH-PREMIUM-AMT = ZERO
 12816         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12817
 12818     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12819        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12820        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12821         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12822
 12823     IF PB-I-AH-BENEFIT-CD = ZERO
 12824         MOVE ER-2634            TO WS-ERROR
 12825         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12826
 12827******************************************************************
 12828*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12829******************************************************************
 12830
 12831     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12832        NEXT SENTENCE
 12833     ELSE
 12834        IF PB-I-AH-BENEFIT-AMT = ZERO
 12835           MOVE ER-2635             TO WS-ERROR
 12836           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12837
 12838******************************************************************
 12839*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12840******************************************************************
 12841
 12842     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12843        NEXT SENTENCE
 12844     ELSE
 12845        IF PB-I-AH-PREMIUM-AMT = ZERO
 12846            IF NOT PB-COMP-AH-PREM
 12847                MOVE ER-2636    TO WS-ERROR
 12848                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12849
 12850
 12851 3140-EDIT-MAX-AMT-SIZES.
 12852* CUSTOM CODE FOR CLIENT    'DMD'
 12853     MOVE ZEROS                   TO WS-RES-STATE-TAX
 12854                                     WS-RES-MUNI-TAX
 12855                                     PB-I-STATE-TAX
 12856                                     PB-I-MUNI-TAX.
 12857
 12858     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 12859
 12860     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 234
* EL050.cbl
 12861        GO TO 3150-RATE-OUTSTAND-BAL.
 12862
 12863     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 12864        GO TO 3150-RATE-OUTSTAND-BAL.
 12865
 12866     IF WS-LF-EARNINGS-CALC EQUAL '5'
 12867        GO TO 3150-RATE-OUTSTAND-BAL.
 12868
 12869     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 12870                             OR 'RIC')
 12871        GO TO 3150-RATE-OUTSTAND-BAL.
 12872
 12873     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 12874        IF PB-I-LOAN-APR GREATER THAN ZEROS
 12875            GO TO 3150-RATE-OUTSTAND-BAL
 12876        ELSE
 12877           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 12878               GO TO 3150-RATE-OUTSTAND-BAL.
 12879
 12880     IF NOT PB-NO-MONTHS-SKIPPED
 12881        GO TO 3150-RATE-OUTSTAND-BAL.
 12882
 12883     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 12884        GO TO 3150-RATE-OUTSTAND-BAL.
 12885
 12886     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 12887        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 12888           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 12889             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12890           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 12891           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 12892              MOVE ER-2693     TO WS-ERROR
 12893              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12894              GO TO 3150-RATE-OUTSTAND-BAL
 12895           ELSE
 12896              GO TO 3150-RATE-OUTSTAND-BAL.
 12897
 12898 3150-RATE-OUTSTAND-BAL.
 12899
 12900* DMD RATING TEST
 12901     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 12902         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12903         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12904         MOVE ER-2687                 TO WS-ERROR
 12905         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12906         MOVE 'B'                     TO PB-I-OB-FLAG
 12907         GO TO 3260-EDIT-CONTINUE.
 12908
 12909     IF  PB-COMPANY-ID   EQUAL    'CRI'
 12910         IF  WS-ERROR    EQUAL    ER-2693
 12911             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 12912                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12913                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12914                 MOVE  +0            TO  WS-ERROR.
 12915
 12916     IF  PB-COMPANY-ID   EQUAL    'CDL'
 12917         IF  WS-ERROR    EQUAL    ER-2693
 12918             IF WS-STATE-ABBREVIATION EQUAL 'NC'
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 235
* EL050.cbl
 12919                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12920                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12921                 MOVE  +0            TO  WS-ERROR.
 12922
 12923     IF PLAN-MASTER-AH-SW = 'Y'
 12924        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12925            IF  WS-ERROR    EQUAL    ER-2693
 12926              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12927                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12928                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12929                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12930                 MOVE  ER-1910           TO  WS-ERROR
 12931                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12932
 12933     IF PLAN-MASTER-AH-SW = 'Y'
 12934        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12935            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12936               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12937               MOVE  ER-1910           TO  WS-ERROR
 12938               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12939
 12940     IF PLAN-MASTER-AH-SW = 'Y'
 12941        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12942            IF  WS-ERROR    EQUAL    ER-2693
 12943                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 12944                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12945                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12946                 MOVE  +0       TO  WS-ERROR.
 12947
 12948     IF WS-ERROR = ER-2693
 12949        IF PB-COMPANY-ID = 'JAL' AND
 12950           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 12951           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12952           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12953
 12954     IF WS-ERROR = ER-2693
 12955        IF PB-COMPANY-ID = 'NCL'  AND
 12956           PB-I-AH-BENEFIT-CD = 'OA'
 12957           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12958           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12959
 12960     IF WS-ERROR = ER-2693
 12961        IF PB-COMPANY-ID = 'CNL' AND
 12962           PB-I-LF-BENEFIT-CD = '71' OR '72'
 12963           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12964           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12965
 12966     IF WS-ERROR = ER-2693
 12967        IF PB-COMPANY-ID = 'HER'
 12968           IF WS-LEVEL
 12969              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12970              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12971
 12972     IF ((LF-BENEFIT-FOUND) AND
 12973         (NOT NO-LIFE-COVERAGE)  AND
 12974         (WS-LF-SPECIAL-CALC-CD = 'O'))
 12975       OR   ((AH-BENEFIT-FOUND) AND
 12976             (NOT NO-AH-COVERAGE)    AND
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 236
* EL050.cbl
 12977             (WS-AH-SPECIAL-CALC-CD = 'O'))
 12978         NEXT SENTENCE
 12979     ELSE
 12980         GO TO 3215-EDIT-RATES.
 12981
 12982     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12983        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12984           MOVE ER-2674          TO WS-ERROR
 12985           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12986           GO TO 3215-EDIT-RATES.
 12987
 12988     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12989        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12990           MOVE ER-2674          TO WS-ERROR
 12991           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12992           GO TO 3215-EDIT-RATES.
 12993
 12994     MOVE 'B'                    TO PB-I-OB-FLAG.
 12995
 12996     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12997         NEXT SENTENCE
 12998     ELSE
 12999         IF NOT NO-LIFE-COVERAGE
 13000             IF WS-ACCT-LF-OB-RT = ZERO
 13001                MOVE ER-2641    TO WS-ERROR
 13002                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13003
 13004     IF PB-COMPANY-ID = 'CRI'
 13005       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13006         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13007         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13008         IF WS-ERROR = ER-2675
 13009            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13010            MOVE ER-2687              TO WS-ERROR
 13011            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13012         ELSE
 13013            MOVE ER-2687              TO WS-ERROR
 13014            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13015
 13016
 13017     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13018         NEXT SENTENCE
 13019     ELSE
 13020       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13021            NEXT SENTENCE
 13022       ELSE
 13023         IF NOT NO-AH-COVERAGE
 13024             IF WS-ACCT-AH-OB-RT = ZERO
 13025                MOVE ER-2642    TO WS-ERROR
 13026                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13027
 13028     IF PB-COMPANY-ID = 'CRI'
 13029       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13030         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13031         IF WS-ERROR = ER-2676
 13032            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13033            MOVE ER-2687              TO WS-ERROR
 13034            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 237
* EL050.cbl
 13035         ELSE
 13036            MOVE ER-2687              TO WS-ERROR
 13037            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13038
 13039     IF PB-COMPANY-ID NOT = 'GIC'
 13040         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13041            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13042     ELSE
 13043         IF PB-I-LF-PREM-CALC = ZEROS
 13044             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13045                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13046
 13047     IF PB-COMPANY-ID NOT = 'GIC'
 13048         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13049            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13050     ELSE
 13051         IF PB-I-AH-PREM-CALC = ZEROS
 13052             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13053                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13054
 13055     MOVE ZEROS TO PB-I-MORT-CODE.
 13056
 13057     GO TO 3260-EDIT-CONTINUE.
 13058
 13059
 13060 3215-EDIT-RATES.
 13061     IF ACCOUNT-MAST-FOUND
 13062         NEXT SENTENCE
 13063     ELSE
 13064         GO TO 3999-END-EDIT.
 13065
 13066 3220-CHECK-LF-RATES.
 13067
 13068     IF PB-COMPANY-ID = 'DCC'
 13069        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13070        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13071        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13072           AND (NOT WS-LF-CASH))
 13073                           OR
 13074           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13075           AND (NOT WS-AH-CASH)))
 13076                       AND
 13077           (PB-I-ENTRY-STATUS NOT = '5')
 13078           MOVE 'M'              TO PB-BATCH-ENTRY
 13079                                    PB-I-ENTRY-STATUS
 13080        END-IF
 13081     END-IF
 13082     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13083                                    PB-I-AH-PREM-CALC
 13084                                    PB-I-LF-ALT-PREM-CALC
 13085                                    PB-I-LF-ALT-RATE
 13086                                    PB-I-LF-REI-RATE
 13087                                    PB-I-LF-ALT-REI-RATE
 13088                                    PB-I-AH-REI-RATE
 13089                                    PB-I-TOT-FEES-CALC.
 13090
 13091     IF PB-COMPANY-ID EQUAL 'DMD'
 13092        NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 238
* EL050.cbl
 13093     ELSE
 13094        MOVE ZEROS               TO PB-I-LF-RATE
 13095                                    PB-I-AH-RATE.
 13096
 13097     IF PB-I-TOT-FEES NOT NUMERIC
 13098        MOVE ZEROS               TO PB-I-TOT-FEES
 13099     END-IF
 13100     IF PB-I-LIVES NOT NUMERIC
 13101         MOVE ZERO               TO PB-I-LIVES.
 13102
 13103     IF PB-I-NUM-BILLED NOT NUMERIC
 13104         MOVE ZERO               TO PB-I-NUM-BILLED.
 13105
 13106     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13107        MOVE +0                  TO PB-I-LF-PREM-TAX
 13108     END-IF
 13109
 13110     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13111        MOVE +0                  TO PB-I-AH-PREM-TAX
 13112     END-IF
 13113
 13114     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13115        PB-I-PAY-FREQUENCY = ZEROS
 13116            MOVE 12 TO CP-PAY-FREQUENCY
 13117     ELSE
 13118            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13119
 13120     IF PB-I-STATE-TAX NOT NUMERIC
 13121         MOVE ZEROS               TO PB-I-STATE-TAX.
 13122
 13123     IF PB-I-MUNI-TAX NOT NUMERIC
 13124         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13125
 13126     MOVE SPACES                 TO CP-BEN-CATEGORY
 13127     IF PB-COMPANY-ID  = 'CSL'  AND
 13128        PB-I-LF-TERM NOT = ZERO
 13129        COMPUTE WS-PAYMENT-AMT =
 13130             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13131        COMPUTE WS-CSL-AMT1 =
 13132             PB-I-LF-TERM * AM-MAX-MON-BEN
 13133        COMPUTE WS-CSL-AMT2 =
 13134             WS-PAYMENT-AMT * PB-I-LF-TERM
 13135        IF CP-PAY-FREQUENCY NOT = 12
 13136           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13137           MOVE '8' TO WS-CSL-CALC-CD
 13138        ELSE
 13139           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13140              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13141               AM-MAX-TOT-BEN
 13142               MOVE '6' TO WS-CSL-CALC-CD
 13143           ELSE
 13144              IF (WS-CSL-AMT1  GREATER THAN
 13145                 AM-MAX-TOT-BEN) AND
 13146                 (WS-CSL-AMT2  GREATER THAN
 13147                 AM-MAX-TOT-BEN)
 13148                 MOVE '7' TO WS-CSL-CALC-CD
 13149              ELSE
 13150                 MOVE '5' TO WS-CSL-CALC-CD.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 239
* EL050.cbl
 13151
 13152     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13153         NEXT SENTENCE
 13154     ELSE
 13155         GO TO 3300-CHECK-AH-RATES.
 13156
 13157*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13158
 13159     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13160        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13161              OR
 13162           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13163           MOVE ER-2618          TO WS-ERROR
 13164           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13165           GO TO 3300-CHECK-AH-RATES.
 13166
 13167     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13168           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13169                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13170
 13171     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13172         MOVE ER-2687             TO WS-ERROR
 13173         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13174         MOVE 'Z000'              TO PB-I-MORT-CODE
 13175         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13176         GO TO 3300-CHECK-AH-RATES.
 13177
 13178     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13179        IF PB-I-LIVES = ZERO
 13180           MOVE ER-2688          TO WS-ERROR
 13181           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13182
 13183     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13184
 13185     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13186     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13187     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13188     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13189     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13190     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13191     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13192     MOVE '3'                    TO CP-PROCESS-TYPE.
 13193     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13194     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13195
 13196******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13197     IF PB-COMPANY-ID EQUAL 'CDL'
 13198         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13199            CP-EARN-AS-NET-PAY)
 13200             IF PB-CERT-EFF-DT GREATER  WS-931231
 13201                 MOVE '1'        TO CP-EARNING-METHOD.
 13202*******
 13203
 13204     MOVE PB-SV-STATE            TO CP-STATE.
 13205     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13206     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13207     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 13208     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 240
* EL050.cbl
 13209     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13210                                    CP-RATING-BENEFIT-AMT.
 13211     IF CP-STATE-STD-ABBRV = 'OR'
 13212         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13213                                         PB-I-LF-ALT-BENEFIT-AMT.
 13214     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13215     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13216     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13217     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13218     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13219     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13220     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13221     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13222     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13223                                    CP-REMAINING-TERM
 13224                                    CP-LOAN-TERM.
 13225
 13226     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13227         NEXT SENTENCE
 13228     ELSE
 13229         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13230             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13231                                           PB-I-LF-PREMIUM-AMT.
 13232
 13233     IF PB-COMPANY-ID EQUAL 'CSL'
 13234        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13235           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13236                                         PB-I-LF-PREMIUM-AMT.
 13237
 13238     IF PB-COMPANY-ID EQUAL 'NCB'
 13239         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13240            CP-EARN-AS-NET-PAY
 13241             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13242                 PB-I-LF-PREMIUM-AMT.
 13243
 13244     IF (CP-TRUNCATED-LIFE)
 13245        or ((pb-company-id = 'AHL')
 13246           and (pb-i-loan-term > pb-i-lf-term))
 13247        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13248
 13249     IF PB-COMPANY-ID EQUAL 'CRI'
 13250        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13251
 13252     IF CP-TERM-IS-DAYS
 13253         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13254     ELSE
 13255         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13256     IF PB-COMPANY-ID = 'DCC'
 13257        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13258        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13259        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13260        IF WS-LF-BEN-CATEGORY = 'D'
 13261           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13262           MOVE PB-I-LIFE-COMMISSION
 13263                                 TO CP-DCC-ACT-COMM
 13264           MOVE WS-LF-BEN-CATEGORY
 13265                                 TO CP-BEN-CATEGORY
 13266        END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 241
* EL050.cbl
 13267        IF (CP-BENEFIT-CD (1:1) = 'P')
 13268           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13269           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13270           add pb-i-ah-premium-amt to cp-original-premium
 13271        END-IF
 13272     END-IF
 13273     IF PB-COMPANY-ID = 'CSL'
 13274         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13275         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13276         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13277
 13278     IF PB-COMPANY-ID = 'CSL'
 13279        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13280
 13281     IF (CP-SPECIAL-CALC-CD = 'H')
 13282        OR (PB-COMPANY-ID = 'DCC')
 13283         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13284                                    TO CP-ALTERNATE-BENEFIT
 13285         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13286
 13287     IF (PB-COMPANY-ID = 'CID')
 13288        AND (WS-LF-EARNINGS-CALC = 'B')
 13289        AND (CP-STATE-STD-ABBRV = 'MN')
 13290        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13291                                 TO CP-ALTERNATE-BENEFIT
 13292        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13293     END-IF
 13294     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13295     MOVE 'R'                   TO CP-RATE-FILE.
 13296     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13297
 13298     IF CP-ERROR-RATE-NOT-FOUND
 13299        MOVE ER-2641            TO WS-ERROR
 13300        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13301        GO TO 3300-CHECK-AH-RATES.
 13302
 13303     IF PB-COMPANY-ID EQUAL 'CRI'
 13304        IF CP-ERROR-NO-LIMITS-CRI
 13305           IF NOT ACCOUNT-LIFE-CHECKED
 13306              MOVE ER-2607      TO WS-ERROR
 13307              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13308
 13309******************************************************************
 13310*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13311*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13312******************************************************************
 13313
 13314* CALC LIFE AGE AT EXPIRATION.
 13315
 13316     COMPUTE WS-AGE-AT-EXPIRE =
 13317          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13318
 13319*    IF PB-STATE = 'CO' OR 'UT'
 13320*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13321*        MOVE 'F'            TO PB-FATAL-FLAG
 13322*        MOVE ER-2709        TO WS-ERROR
 13323*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13324*        GO TO PREMIUM-EDITING-IS-BYPASSED.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 242
* EL050.cbl
 13325
 13326*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13327*        MOVE 'X'            TO PB-FATAL-FLAG
 13328*        MOVE ER-2718        TO WS-ERROR
 13329*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13330*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13331
 13332* CALC A & H AGE AT EXPIRATION.
 13333
 13334     COMPUTE WS-AGE-AT-EXPIRE =
 13335          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13336
 13337*    IF PB-STATE = 'CO' OR 'UT'
 13338*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13339*        MOVE 'F'            TO PB-FATAL-FLAG
 13340*        MOVE ER-2709        TO WS-ERROR
 13341*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13342*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13343
 13344*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13345*        MOVE 'X'            TO PB-FATAL-FLAG
 13346*        MOVE ER-2718        TO WS-ERROR
 13347*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13348*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13349
 13350     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13351        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13352
 13353     IF WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z'
 13354        GO TO 3221-CHECK-ERROR-RATE-OPEN
 13355     end-if
 13356
 13357     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13358        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13359
 13360     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13361         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13362         MOVE ER-2639        TO WS-ERROR
 13363         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13364
 13365
 13366******************************************************************
 13367*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13368******************************************************************
 13369
 13370 PREMIUM-EDITING-IS-BYPASSED.
 13371     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13372        AND (CP-R-MAX-ATT-AGE > +0)
 13373        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13374        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13375           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13376           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13377           MOVE '1'              TO DC-OPTION-CODE
 13378           PERFORM 8500-DATE-CONVERT
 13379                                 THRU 8500-EXIT
 13380           IF NO-CONVERSION-ERROR
 13381              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13382                 MOVE ER-2661       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 243
* EL050.cbl
 13383*                PERFORM 9900-ERROR-FORMAT
 13384*                                THRU 9900-EXIT
 13385              END-IF
 13386           END-IF
 13387        ELSE
 13388           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13389           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13390              MOVE ER-2661       TO WS-ERROR
 13391*             PERFORM 9900-ERROR-FORMAT
 13392*                                THRU 9900-EXIT
 13393           ELSE
 13394              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13395                 MOVE ER-1570    TO WS-ERROR
 13396                 PERFORM 9900-ERROR-FORMAT
 13397                                 THRU 9900-EXIT
 13398              END-IF
 13399           END-IF
 13400        END-IF
 13401        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13402           MOVE PB-I-JOINT-BIRTHDAY
 13403                                 TO DC-BIN-DATE-1
 13404           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13405           MOVE '1'              TO DC-OPTION-CODE
 13406           PERFORM 8500-DATE-CONVERT
 13407                                 THRU 8500-EXIT
 13408           IF NO-CONVERSION-ERROR
 13409              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13410                 MOVE ER-2661       TO WS-ERROR
 13411*                PERFORM 9900-ERROR-FORMAT
 13412*                                THRU 9900-EXIT
 13413              END-IF
 13414           ELSE
 13415              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13416           END-IF
 13417        ELSE
 13418           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13419             (PB-I-LF-TERM / 12)
 13420           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13421              MOVE ER-2661       TO WS-ERROR
 13422*             PERFORM 9900-ERROR-FORMAT
 13423*                                THRU 9900-EXIT
 13424           ELSE
 13425              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13426                 MOVE ER-1571    TO WS-ERROR
 13427                 PERFORM 9900-ERROR-FORMAT
 13428                                 THRU 9900-EXIT
 13429              END-IF
 13430           END-IF
 13431        END-IF
 13432        IF WS-ERROR = ER-2661
 13433           PERFORM 9900-ERROR-FORMAT
 13434                                 THRU 9900-EXIT
 13435        END-IF
 13436     END-IF
 13437*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13438*       MOVE ER-2661             TO WS-ERROR
 13439*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13440
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 244
* EL050.cbl
 13441     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13442        MOVE ER-2662             TO WS-ERROR
 13443        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13444
 13445     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13446        MOVE ER-2677             TO WS-ERROR
 13447        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13448
 13449     IF CP-ERROR-LOAN-TERM
 13450        MOVE ER-2648             TO WS-ERROR
 13451        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13452
 13453 3221-CHECK-ERROR-RATE-OPEN.
 13454
 13455     IF CP-ERROR-RATE-FILE-NOTOPEN
 13456         GO TO 3990-FILES-NOT-OPEN.
 13457
 13458     IF PB-COMPANY-ID NOT = 'DMD'
 13459        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13460     END-IF
 13461     .
 13462 3221-CONTINUE.
 13463     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13464                                    WS-DCC-AH-RATE
 13465     IF PB-COMPANY-ID = 'DCC'
 13466        IF WS-LF-BEN-CATEGORY = 'D'
 13467           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13468              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13469        END-IF
 13470     END-IF
 13471     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13472*   X'A4FF' = 12/31/2009
 13473     IF (PB-COMPANY-ID = 'CID')
 13474        AND (WS-LF-EARNINGS-CALC = 'B')
 13475        AND (CP-STATE-STD-ABBRV = 'MN')
 13476        AND (PB-CERT-EFF-DT > X'A4FF')
 13477        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13478     END-IF
 13479     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.
 13480
 13481     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13482     IF (PB-COMPANY-ID = 'DCC')
 13483        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13484        AND (PB-I-POLICY-IS-MONTHLY)
 13485        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13486        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13487     END-IF
 13488     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13489     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13490     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13491     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13492     IF (PB-COMPANY-ID = 'DCC')
 13493        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13494        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13495        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13496        MOVE ER-2786             TO WS-ERROR
 13497        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13498     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 245
* EL050.cbl
 13499
 13500     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13501
 13502******************************************************************
 13503*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13504******************************************************************
 13505     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13506        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13507
 13508     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13509        GO TO 3225-CHECK-ALT-LIFE-RATE
 13510     ELSE
 13511       IF PB-I-LF-RATE = ZERO
 13512          MOVE ER-2641          TO WS-ERROR
 13513          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13514
 13515 3225-CHECK-ALT-LIFE-RATE.
 13516
 13517     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13518        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13519        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13520         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13521
 13522     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13523         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13524             AND PB-COMPANY-ID NOT = 'DCC')
 13525                   OR
 13526              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13527              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13528              AND PB-COMPANY-ID NOT = 'DCC')
 13529             MOVE ER-2720        TO  WS-ERROR
 13530             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13531             GO TO 3225-RATING-CONT
 13532         ELSE
 13533             GO TO 3225-RATING-CONT.
 13534     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13535        AND (AM-GPCD = 01 OR 06 OR 15)
 13536        MOVE ER-2798             TO WS-ERROR
 13537        PERFORM 9900-ERROR-FORMAT
 13538                                 THRU 9900-EXIT
 13539*       GO TO 3225-RATING-CONT
 13540     END-IF
 13541     IF (PB-COMPANY-ID = 'CID')
 13542        AND (WS-LF-EARNINGS-CALC = 'B')
 13543        AND (CP-STATE-STD-ABBRV = 'MN')
 13544        AND (PB-CERT-EFF-DT > X'A4FF')
 13545        GO TO 3225-RATING-CONT
 13546     END-IF
 13547     IF PB-COMPANY-ID = 'DCC'
 13548        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13549           AND (PB-I-POLICY-IS-MONTHLY)
 13550           GO TO 3225-RATING-CONT
 13551        END-IF
 13552     END-IF
 13553
 13554     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13555        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13556        CP-EARN-AS-REG-BALLOON
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 246
* EL050.cbl
 13557        NEXT SENTENCE
 13558     ELSE
 13559        MOVE '2'                 TO CP-EARNING-METHOD.
 13560
 13561 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13562
 13563     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13564
 13565     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13566        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13567        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13568         NEXT SENTENCE
 13569     ELSE
 13570         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13571
 13572     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13573     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13574     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13575                                     CP-RATING-BENEFIT-AMT.
 13576     IF CP-STATE-STD-ABBRV = 'OR'
 13577         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13578                                         PB-I-LF-ALT-BENEFIT-AMT.
 13579     IF PB-COMPANY-ID = 'DCC'
 13580        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13581     END-IF
 13582     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13583     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13584     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13585                                    CP-REMAINING-TERM
 13586                                    CP-LOAN-TERM.
 13587     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13588        ADD +1                   TO CP-ORIGINAL-TERM
 13589                                    CP-REMAINING-TERM
 13590                                    CP-LOAN-TERM.
 13591
 13592     MOVE 'R'                   TO CP-RATE-FILE.
 13593     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13594
 13595     IF CP-ERROR-RATE-NOT-FOUND
 13596         MOVE ER-2641            TO WS-ERROR
 13597         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13598         GO TO 3300-CHECK-AH-RATES.
 13599
 13600     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13601     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13602
 13603     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13604         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13605
 13606     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13607                               + PB-I-LF-ALT-BENEFIT-AMT.
 13608
 13609     IF ACCOUNT-LIFE-CHECKED  OR
 13610        PB-POLICY-IS-VOIDED   OR
 13611        (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13612        GO TO 3225-CONTINUE.
 13613
 13614     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 247
* EL050.cbl
 13615        GO TO 3225-CONTINUE.
 13616
 13617     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13618                             EC-RT-LF-MAX-TOT-BEN
 13619        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13620        MOVE ER-2639       TO WS-ERROR
 13621        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13622
 13623 3225-CONTINUE.
 13624     IF PB-I-LF-ALT-RATE = ZERO
 13625         MOVE ER-2659            TO WS-ERROR
 13626         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13627
 13628     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13629        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13630        MOVE ER-2698             TO WS-ERROR
 13631        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13632
 13633 3225-RATING-CONT.
 13634
 13635     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13636         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13637         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13638         IF (PB-COMPANY-ID = 'DCC')
 13639            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13640            CONTINUE
 13641         ELSE
 13642            MOVE ER-2687         TO WS-ERROR
 13643            PERFORM 9900-ERROR-FORMAT
 13644                                 THRU 9900-EXIT
 13645         END-IF
 13646         GO TO 3290-EDIT-LF-REIN-RATE
 13647     END-IF
 13648
 13649* DMD RATING TEST
 13650     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13651         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13652         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13653         MOVE ER-2687                 TO WS-ERROR
 13654         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13655         GO TO 3290-EDIT-LF-REIN-RATE.
 13656
 13657 3230-CLIENT-MORT-CD-SPECIALS.
 13658
 13659     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13660     SET BIN-TO-GREG          TO TRUE.
 13661*    MOVE ' '                 TO DC-OPTION-CODE.
 13662     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13663     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13664
 13665 C-POS-3230-MORT-CD.
 13666     IF PB-COMPANY-ID = 'POS' AND
 13667        PB-SV-CARRIER = '2'
 13668         NEXT SENTENCE
 13669     ELSE
 13670         GO TO C-POS-3240-MORT-CD.
 13671
 13672     IF PB-SV-GROUPING = '030'
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 248
* EL050.cbl
 13673        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13674         MOVE '2350' TO PB-I-MORT-CODE
 13675      ELSE
 13676         MOVE '3300' TO PB-I-MORT-CODE.
 13677
 13678
 13679 C-POS-3240-MORT-CD.
 13680     IF PB-COMPANY-ID = 'POS' AND
 13681        PB-SV-CARRIER = '1'
 13682         NEXT SENTENCE
 13683     ELSE
 13684         GO TO 3230-CONTINUE.
 13685
 13686     IF PB-SV-STATE = '45' OR '47'
 13687        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13688         MOVE '5200' TO PB-I-MORT-CODE
 13689     ELSE
 13690         MOVE '8300' TO PB-I-MORT-CODE.
 13691
 13692 3230-CONTINUE.
 13693
 13694     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13695        GO TO 3240-CONTINUE
 13696     END-IF
 13697
 13698     IF PB-CERT-EFF-DT > WS-971231
 13699        GO TO 3240-CONTINUE
 13700     END-IF
 13701
 13702     IF LF-BENEFIT-FOUND AND
 13703        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13704         MOVE 'F250'       TO PB-I-MORT-CODE
 13705     ELSE
 13706         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13707             MOVE '7250'   TO PB-I-MORT-CODE
 13708         ELSE
 13709             MOVE '4251'   TO PB-I-MORT-CODE
 13710         END-IF
 13711     END-IF
 13712
 13713     .
 13714 3240-CONTINUE.
 13715
 13716     IF PB-COMPANY-ID NOT = 'GNL'
 13717         GO TO 3256-CONTINUE.
 13718
 13719     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13720         MOVE 'A300' TO PB-I-MORT-CODE
 13721     ELSE
 13722         MOVE '8350' TO PB-I-MORT-CODE.
 13723
 13724 3256-CONTINUE.
 13725     IF PB-COMPANY-ID NOT = 'ABL'
 13726         GO TO 3260-EDIT-CONTINUE.
 13727
 13728     IF PB-I-LF-TERM GREATER THAN 59
 13729         MOVE 'F550' TO PB-I-MORT-CODE
 13730     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 249
* EL050.cbl
 13731         MOVE 'E550' TO PB-I-MORT-CODE.
 13732
 13733 3260-EDIT-CONTINUE.
 13734     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13735
 13736 3290-EDIT-LF-REIN-RATE.
 13737     IF LF-REIN-NSP-NOT-USED
 13738         GO TO 3290-RATING-CONT.
 13739
 13740     IF PB-COMPANY-ID = 'DCC'
 13741        GO TO 3290-RATING-CONT.
 13742     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13743     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13744     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13745     MOVE '3'                   TO CP-PROCESS-TYPE.
 13746     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13747
 13748******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13749     IF PB-COMPANY-ID EQUAL 'CDL'
 13750         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13751            CP-EARN-AS-NET-PAY)
 13752             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13753*            MOVE SPACE          TO DC-OPTION-CODE
 13754             SET BIN-TO-GREG     TO TRUE
 13755             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13756***  Y2K PROJ 7744
 13757             IF DC-GREG-DATE-CYMD GREATER 19931231
 13758                 MOVE '1'        TO CP-EARNING-METHOD.
 13759***  Y2K PROJ 7744
 13760*******
 13761
 13762     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13763     MOVE PB-SV-STATE           TO CP-STATE.
 13764     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13765     MOVE ZERO                  TO CP-DEVIATION-CODE
 13766                                   CP-RATE-DEV-PCT.
 13767     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13768     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13769                                   CP-RATING-BENEFIT-AMT.
 13770
 13771************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13772     IF PB-COMPANY-ID EQUAL 'NCB'
 13773         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13774            CP-EARN-AS-NET-PAY
 13775             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13776                 PB-I-LF-PREMIUM-AMT.
 13777************
 13778
 13779     IF CP-STATE-STD-ABBRV = 'OR'
 13780         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13781                                         PB-I-LF-ALT-BENEFIT-AMT.
 13782     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13783     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13784     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13785     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13786     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13787     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13788     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 250
* EL050.cbl
 13789     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13790                                   CP-REMAINING-TERM
 13791                                   CP-LOAN-TERM.
 13792     IF CP-TRUNCATED-LIFE
 13793        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13794
 13795     IF CP-TERM-IS-DAYS
 13796         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13797     ELSE
 13798         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13799
 13800     IF PB-COMPANY-ID = 'DCC'
 13801        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13802     END-IF
 13803     IF PB-COMPANY-ID NOT = 'TIC'
 13804          MOVE ZERO          TO CP-CLASS-CODE.
 13805
 13806     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 13807
 13808     MOVE 'R'                   TO CP-RATE-FILE.
 13809     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13810
 13811     IF CP-ERROR-RATE-NOT-FOUND
 13812        IF PB-I-OB
 13813           MOVE ER-2625      TO WS-ERROR
 13814           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13815           GO TO 3299-EDIT-CONTINUE
 13816        ELSE
 13817           MOVE ER-2643      TO WS-ERROR
 13818           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13819           GO TO 3299-EDIT-CONTINUE.
 13820
 13821     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 13822
 13823     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 13824     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 13825
 13826     IF PB-I-LF-REI-RATE = ZERO
 13827         MOVE ER-2643        TO WS-ERROR
 13828         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13829
 13830 3290-CHECK-ALT-REIN-RATE.
 13831
 13832     IF WS-LF-EARNINGS-CALC NOT = 'B'
 13833        GO TO 3290-RATING-CONT.
 13834
 13835     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13836     MOVE '2'                    TO CP-EARNING-METHOD.
 13837     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 13838     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13839     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13840     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13841                                     CP-RATING-BENEFIT-AMT.
 13842     IF CP-STATE-STD-ABBRV = 'OR'
 13843         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13844                                         PB-I-LF-ALT-BENEFIT-AMT.
 13845     IF PB-COMPANY-ID = 'DCC'
 13846        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 251
* EL050.cbl
 13847     END-IF
 13848     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13849     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13850     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13851                                    CP-REMAINING-TERM
 13852                                    CP-LOAN-TERM.
 13853     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13854        ADD +1                   TO CP-ORIGINAL-TERM
 13855                                    CP-REMAINING-TERM
 13856                                    CP-LOAN-TERM.
 13857
 13858     MOVE 'R'                   TO CP-RATE-FILE.
 13859     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13860
 13861     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 13862
 13863     IF PB-I-LF-ALT-REI-RATE = ZERO
 13864         MOVE ER-2643            TO WS-ERROR
 13865         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13866
 13867 3290-RATING-CONT.
 13868
 13869     IF PB-I-OB
 13870*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13871        GO TO 3300-CHECK-AH-RATES.
 13872
 13873 3299-EDIT-CONTINUE.
 13874
 13875     IF  PB-I-MORT-CODE GREATER THAN SPACES
 13876         NEXT SENTENCE
 13877     ELSE
 13878         MOVE ER-2620           TO WS-ERROR
 13879         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13880
 13881 3300-CHECK-AH-RATES.
 13882     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 13883         NEXT SENTENCE
 13884     ELSE
 13885         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13886
 13887     IF (WS-AH-SPECIAL-CALC-CD = 'E')   OR
 13888        ((CF-COMPANY-ID = 'DMD') AND
 13889                (NO-DMD-RATING))
 13890         IF (PB-COMPANY-ID = 'DCC')
 13891            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13892            CONTINUE
 13893         ELSE
 13894            MOVE ER-2687         TO WS-ERROR
 13895            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13896         END-IF
 13897         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13898         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 13899     END-IF
 13900
 13901     IF PB-I-OB
 13902        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13903
 13904     IF WS-AH-SPECIAL-CALC-CD = 'M'
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 252
* EL050.cbl
 13905         MOVE ER-2687             TO WS-ERROR
 13906         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13907         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13908         GO TO 3999-END-EDIT.
 13909
 13910*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 13911     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 13912        IF PB-I-AH-CRIT-PER = ZERO
 13913           IF PB-COMPANY-ID = 'DCC'
 13914              AND AM-DCC-PRODUCT-CODE = 'DDF'
 13915              CONTINUE
 13916           ELSE
 13917              MOVE ER-2618       TO WS-ERROR
 13918              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13919              GO TO 3999-END-EDIT
 13920           END-IF
 13921        END-IF
 13922     END-IF
 13923     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13924     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13925     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13926     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13927     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13928     MOVE PB-SV-STATE            TO CP-STATE.
 13929     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13930     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 13931     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 13932*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 13933     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 13934     MOVE '3'                    TO CP-PROCESS-TYPE.
 13935     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 13936     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13937                                    CP-RATING-BENEFIT-AMT.
 13938     IF PB-COMPANY-ID = 'CID'
 13939               OR
 13940        CP-STATE-STD-ABBRV = 'OR'
 13941         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 13942                                         PB-I-AH-TERM.
 13943     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 13944        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 13945           AND (PB-I-POLICY-IS-MONTHLY)
 13946           MOVE PB-I-LF-BENEFIT-AMT
 13947                                 TO CP-NET-BENEFIT-AMT
 13948           move pb-i-ah-premium-amt to cp-original-premium
 13949           add pb-i-lf-premium-amt to cp-original-premium
 13950        END-IF
 13951     END-IF
 13952     MOVE SPACES                 TO CP-BEN-CATEGORY
 13953     IF PB-COMPANY-ID = 'DCC'
 13954        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13955        EVALUATE TRUE
 13956           WHEN (WS-AH-BEN-CATEGORY = 'G')
 13957              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13958              MOVE PB-I-LF-BENEFIT-AMT
 13959                                 TO CP-RATING-BENEFIT-AMT
 13960              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 13961           WHEN WS-AH-BEN-CATEGORY = 'G'
 13962              MOVE PB-I-UNPAID-CASH-PRICE
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 253
* EL050.cbl
 13963                                 TO CP-RATING-BENEFIT-AMT
 13964           WHEN WS-AH-BEN-CATEGORY = 'D'
 13965              MOVE WS-AH-PMF-COMM
 13966                                 TO CP-DCC-PMF-COMM
 13967              MOVE PB-I-AH-COMMISSION
 13968                                 TO CP-DCC-ACT-COMM
 13969        END-EVALUATE
 13970     END-IF
 13971     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 13972     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13973     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13974     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13975     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13976     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 13977     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 13978                                    CP-REMAINING-TERM
 13979                                    WS-WORK-TERM.
 13980     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 13981
 13982     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13983     SET BIN-TO-GREG             TO TRUE.
 13984*    MOVE ' '                    TO DC-OPTION-CODE.
 13985     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13986     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 13987
 13988     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 13989     IF NOT VALID-SKIP-CODE
 13990         MOVE ER-2683            TO WS-ERROR
 13991         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13992         GO TO 3320-RATE-CONTINUE.
 13993
 13994     IF PB-NO-MONTHS-SKIPPED
 13995         GO TO 3320-RATE-CONTINUE.
 13996
 13997     MOVE SPACE TO NUMBER-OF-MONTHS.
 13998
 13999     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14000         MOVE 'S'                TO SK-MO (6).
 14001     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14002         MOVE 'S'                TO SK-MO (7).
 14003     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14004         MOVE 'S'                TO SK-MO (8).
 14005     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14006         MOVE 'S'                TO SK-MO (9).
 14007     IF PB-I-SKIP-CODE = 'A'
 14008         MOVE 'S'                TO SK-MO (10).
 14009
 14010     MOVE 1                      TO SUB2.
 14011     MOVE PB-I-AH-TERM           TO SUB3.
 14012     MOVE WS-MONTH               TO SUB1.
 14013     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14014     GO TO 3320-RATE-CONTINUE.
 14015
 14016 3310-GET-SKIP-MO.
 14017     IF SUB1 = 13
 14018         MOVE 1                  TO SUB1.
 14019
 14020     IF SK-MO (SUB1) = 'S'
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 254
* EL050.cbl
 14021         SUBTRACT 1 FROM WS-WORK-TERM.
 14022
 14023     ADD 1 TO SUB2
 14024              SUB1.
 14025
 14026 3320-RATE-CONTINUE.
 14027
 14028     IF WS-WORK-TERM = ZERO
 14029         MOVE 1                  TO WS-WORK-TERM.
 14030
 14031     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14032                                    CP-LOAN-TERM.
 14033
 14034     IF PB-COMPANY-ID EQUAL 'DMD'
 14035         NEXT SENTENCE
 14036     ELSE
 14037         MOVE ZERO               TO PB-I-AH-RATE
 14038                                    PB-I-AH-REI-RATE.
 14039
 14040
 14041     IF PB-COMPANY-ID EQUAL 'CRI'
 14042        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14043
 14044     IF PB-COMPANY-ID = 'CSL'
 14045         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14046         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14047         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14048         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14049
 14050     IF PB-COMPANY-ID = 'DCC'
 14051        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14052           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14053              PB-I-RATE-DEV-PCT-LF
 14054        END-IF
 14055        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14056                                 TO CP-ALTERNATE-BENEFIT
 14057        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14058        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14059        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14060     END-IF
 14061     IF (PB-COMPANY-ID = 'CID')
 14062        AND (WS-LF-EARNINGS-CALC = 'B')
 14063        AND (CP-STATE-STD-ABBRV = 'MN')
 14064        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14065     ELSE
 14066        MOVE ' '                 TO CP-AH-BALLOON-SW
 14067     END-IF
 14068     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14069     MOVE 'R'                   TO CP-RATE-FILE.
 14070     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14071
 14072     IF CP-ERROR-RATE-NOT-FOUND
 14073        IF PB-I-OB
 14074           MOVE ER-2624          TO WS-ERROR
 14075           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14076           GO TO 3340-CALCULATE-PREMIUM-AMT
 14077        ELSE
 14078          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 255
* EL050.cbl
 14079              NEXT SENTENCE
 14080          ELSE
 14081           MOVE ER-2642          TO WS-ERROR
 14082           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14083           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14084
 14085     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14086        CP-ERROR-DIV-BY-ZERO
 14087           MOVE ER-3782          TO WS-ERROR
 14088           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14089
 14090     IF PB-COMPANY-ID EQUAL 'CRI'
 14091        IF CP-ERROR-NO-LIMITS-CRI
 14092           IF NOT ACCOUNT-AH-CHECKED
 14093              MOVE ER-2607          TO WS-ERROR
 14094              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14095
 14096     IF ACCOUNT-AH-CHECKED
 14097        NEXT SENTENCE
 14098     ELSE
 14099       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14100          MOVE ER-2640           TO WS-ERROR
 14101          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14102
 14103     IF PB-COMPANY-ID = 'CRI'
 14104         IF WS-ERROR = ER-2640
 14105             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14106     IF ACCOUNT-AH-CHECKED
 14107        CONTINUE
 14108     ELSE
 14109        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14110           AND (CP-R-MAX-ATT-AGE > +0)
 14111           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14112           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14113              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14114              MOVE PB-I-AH-EXPIRE-DT
 14115                                 TO DC-BIN-DATE-2
 14116              MOVE '1'           TO DC-OPTION-CODE
 14117              PERFORM 8500-DATE-CONVERT
 14118                                 THRU 8500-EXIT
 14119              IF NO-CONVERSION-ERROR
 14120                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14121                    MOVE ER-2661       TO WS-ERROR
 14122*                   PERFORM 9900-ERROR-FORMAT
 14123*                                THRU 9900-EXIT
 14124                 END-IF
 14125              END-IF
 14126           ELSE
 14127              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14128              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14129                 MOVE ER-2661    TO WS-ERROR
 14130*                PERFORM 9900-ERROR-FORMAT
 14131*                                THRU 9900-EXIT
 14132              ELSE
 14133                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14134                    MOVE ER-1570 TO WS-ERROR
 14135                    PERFORM 9900-ERROR-FORMAT
 14136                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 256
* EL050.cbl
 14137                 END-IF
 14138              END-IF
 14139           END-IF
 14140           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14141              MOVE PB-I-JOINT-BIRTHDAY
 14142                                    TO DC-BIN-DATE-1
 14143              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14144              MOVE '1'              TO DC-OPTION-CODE
 14145              PERFORM 8500-DATE-CONVERT
 14146                                    THRU 8500-EXIT
 14147              IF NO-CONVERSION-ERROR
 14148                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14149                    MOVE ER-2661       TO WS-ERROR
 14150*                   PERFORM 9900-ERROR-FORMAT
 14151*                                   THRU 9900-EXIT
 14152                 END-IF
 14153              END-IF
 14154           ELSE
 14155              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14156                (PB-I-AH-TERM / 12)
 14157              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14158                 MOVE ER-2661       TO WS-ERROR
 14159*                PERFORM 9900-ERROR-FORMAT
 14160*                                   THRU 9900-EXIT
 14161              ELSE
 14162                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14163                    MOVE ER-1571 TO WS-ERROR
 14164                    PERFORM 9900-ERROR-FORMAT
 14165                                 THRU 9900-EXIT
 14166                 END-IF
 14167              END-IF
 14168           END-IF
 14169           IF WS-ERROR = ER-2661
 14170              PERFORM 9900-ERROR-FORMAT
 14171                                    THRU 9900-EXIT
 14172           END-IF
 14173        END-IF
 14174     END-IF
 14175*    IF ACCOUNT-AH-CHECKED
 14176*       NEXT SENTENCE
 14177*    ELSE
 14178*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14179*          MOVE ER-2661          TO WS-ERROR
 14180*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14181
 14182     IF ACCOUNT-AH-CHECKED
 14183        NEXT SENTENCE
 14184     ELSE
 14185        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14186           MOVE ER-2663          TO WS-ERROR
 14187           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14188
 14189     IF ACCOUNT-AH-CHECKED OR
 14190        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14191         PB-POLICY-IS-VOIDED
 14192        NEXT SENTENCE
 14193     ELSE
 14194        IF CP-ERROR-TOT-OUTSIDE-LIMIT
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 257
* EL050.cbl
 14195           MOVE ER-2667            TO WS-ERROR
 14196           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14197
 14198     IF PB-COMPANY-ID = 'CRI'
 14199         IF WS-ERROR = ER-2667
 14200             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14201
 14202     IF ACCOUNT-AH-CHECKED
 14203        NEXT SENTENCE
 14204     ELSE
 14205        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14206           MOVE ER-2678            TO WS-ERROR
 14207           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14208
 14209     IF CP-ERROR-RATE-FILE-NOTOPEN
 14210         GO TO 3990-FILES-NOT-OPEN.
 14211
 14212 3321-CONTINUE.
 14213     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14214     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14215     IF (PB-COMPANY-ID = 'DCC')
 14216        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14217        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14218                                    PB-I-LF-ALT-PREM-CALC
 14219        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14220        IF WS-AH-BEN-CATEGORY = 'G'
 14221           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14222           + PB-I-ADDL-CLP)
 14223           * (1 + WS-TOL-CLP-PCT)
 14224*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14225        ELSE
 14226           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14227           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14228*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14229        END-IF
 14230        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14231                                 TO PB-I-AH-PREM-CALC
 14232        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14233           MOVE ER-8152          TO WS-ERROR
 14234           PERFORM 9900-ERROR-FORMAT
 14235                                 THRU 9900-EXIT
 14236        ELSE
 14237           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14238                 PB-I-ADDL-CLP)
 14239              MOVE ER-8148       TO WS-ERROR
 14240              PERFORM 9900-ERROR-FORMAT
 14241                                 THRU 9900-EXIT
 14242           END-IF
 14243        END-IF
 14244     END-IF
 14245     IF (PB-COMPANY-ID = 'DCC')
 14246        AND (PB-I-POLICY-IS-MONTHLY)
 14247        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14248        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14249        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14250           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14251        END-IF
 14252     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 258
* EL050.cbl
 14253     IF (PB-COMPANY-ID = 'DCC')
 14254        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14255        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14256        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14257        MOVE ER-2786             TO WS-ERROR
 14258        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14259     END-IF
 14260     MOVE +0                     TO PB-I-AH-CLP
 14261     IF PB-COMPANY-ID = 'DCC'
 14262        IF WS-AH-BEN-CATEGORY = 'D'
 14263           COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT *
 14264              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14265        ELSE
 14266           IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14267              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14268           END-IF
 14269        END-IF
 14270     END-IF
 14271     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.
 14272
 14273     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14274         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14275
 14276     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14277         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14278
 14279     IF PB-COMPANY-ID = 'CRI'
 14280         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14281            PB-I-PAYMENT-AMOUNT = ZERO
 14282             NEXT SENTENCE
 14283         ELSE
 14284             COMPUTE PB-I-AH-PREM-CALC =
 14285                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14286                 (CP-PREMIUM-RATE / 100)
 14287             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14288                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14289                                             PB-I-RATE-DEV-PCT-AH.
 14290
 14291     IF PB-I-AH-RATE  = ZERO
 14292       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14293           NEXT SENTENCE
 14294       ELSE
 14295         MOVE ER-2642            TO WS-ERROR
 14296         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14297
 14298     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14299     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14300     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14301     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14302     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14303     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14304
 14305     IF (PB-COMPANY-ID = 'DCC')
 14306        AND (WS-AH-BEN-CATEGORY = 'G')
 14307        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14308        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14309        IF CP-DEVIATION-CODE NOT = '000'
 14310           MOVE '000'            TO CP-DEVIATION-CODE
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 259
* EL050.cbl
 14311           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14312           IF NO-CP-ERROR
 14313              COMPUTE PB-I-DDF-IU-RATE-UP =
 14314              PB-I-AH-CLP - CP-CALC-PREMIUM
 14315           ELSE
 14316              MOVE ER-3057        TO WS-ERROR
 14317              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14318           END-IF
 14319        END-IF
 14320     END-IF
 14321     .
 14322 3335-EDIT-AH-REIN-NSP-RATE.
 14323     IF AH-REIN-NSP-NOT-USED
 14324         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14325
 14326     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14327     IF PB-COMPANY-ID = 'DCC'
 14328         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14329     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14330     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14331     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14332     MOVE PB-SV-STATE            TO CP-STATE.
 14333     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14334     MOVE ZERO                   TO CP-DEVIATION-CODE
 14335                                    CP-RATE-DEV-PCT.
 14336*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14337     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14338     MOVE '3'                    TO CP-PROCESS-TYPE.
 14339     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14340     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14341                                    CP-RATING-BENEFIT-AMT.
 14342     IF CP-STATE-STD-ABBRV = 'OR'
 14343         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14344                                         PB-I-AH-TERM.
 14345     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14346     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14347     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14348     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14349     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14350     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14351                                    CP-REMAINING-TERM
 14352                                    WS-WORK-TERM.
 14353     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14354     IF PB-COMPANY-ID = 'DCC'
 14355        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14356     END-IF
 14357     IF  PB-COMPANY-ID = 'TIC'
 14358         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14359            MOVE ZERO TO CP-CLASS-CODE.
 14360
 14361     IF PB-COMPANY-ID NOT = 'TIC'
 14362          MOVE ZERO          TO CP-CLASS-CODE.
 14363
 14364     MOVE ZERO               TO CP-DEVIATION-CODE.
 14365
 14366     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14367
 14368     MOVE ZERO               TO PB-I-AH-REI-RATE.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 260
* EL050.cbl
 14369
 14370     MOVE 'R'                   TO CP-RATE-FILE.
 14371     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14372
 14373     IF CP-ERROR-RATE-NOT-FOUND
 14374         MOVE ER-2645        TO WS-ERROR
 14375         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14376         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14377
 14378     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14379
 14380     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14381     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14382
 14383     IF PB-I-AH-REI-RATE = ZERO
 14384         MOVE ER-2645        TO WS-ERROR
 14385         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14386
 14387
 14388 3340-CALCULATE-PREMIUM-AMT.
 14389
 14390     IF PB-COMPANY-ID = 'NCL'
 14391         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14392             WS-AH-SPECIAL-CALC-CD = 'O')
 14393             GO TO 3999-END-EDIT.
 14394
 14395     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14396                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14397                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'
 14398                         OR 'AHL'
 14399         NEXT SENTENCE
 14400     ELSE
 14401         IF WS-STATE-ABBREVIATION = 'CT'
 14402             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14403                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14404                 COMPUTE PB-I-LF-PREM-CALC =
 14405                                     PB-I-LF-PREM-CALC * .90
 14406                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14407                                     PB-I-LF-ALT-PREM-CALC * .90
 14408                 COMPUTE PB-I-AH-PREM-CALC =
 14409                                     PB-I-AH-PREM-CALC * .90.
 14410
 14411     IF PB-COMP-LF-PREM
 14412        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14413        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14414
 14415     IF PB-COMP-AH-PREM
 14416        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14417
 14418 3340-CHECK-DCC-TOT-FEES.
 14419     IF (PB-COMPANY-ID = 'DCC')
 14420        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14421        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14422        AND (PB-I-POLICY-IS-MONTHLY)
 14423        CONTINUE
 14424     ELSE
 14425        GO TO 3340-EDIT-LF-AH-TOL
 14426     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 261
* EL050.cbl
 14427     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14428     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14429     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14430        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14431           PB-I-RATE-DEV-PCT-LF
 14432     END-IF
 14433     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14434        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14435           PB-I-RATE-DEV-PCT-AH
 14436     END-IF
 14437     MOVE 'N'                    TO CP-BEN-CATEGORY
 14438     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14439
 14440     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14441     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14442     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14443     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14444     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14445     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14446     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14447     MOVE '3'                    TO CP-PROCESS-TYPE.
 14448     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14449     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14450
 14451     MOVE PB-SV-STATE            TO CP-STATE.
 14452     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14453     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14454     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14455     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14456     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14457                                    CP-RATING-BENEFIT-AMT.
 14458     IF CP-STATE-STD-ABBRV = 'OR'
 14459         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14460                                         PB-I-LF-ALT-BENEFIT-AMT.
 14461     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14462     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14463     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14464     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14465     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14466     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14467     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14468     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14469     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14470                                    CP-REMAINING-TERM
 14471                                    CP-LOAN-TERM.
 14472     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14473        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14474           PB-I-LF-PREMIUM-AMT
 14475     end-if
 14476
 14477     IF CP-TRUNCATED-LIFE
 14478        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14479
 14480     IF CP-TERM-IS-DAYS
 14481         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14482     ELSE
 14483         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14484
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 262
* EL050.cbl
 14485     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14486     IF CP-SPECIAL-CALC-CD = 'H'
 14487         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14488                                    TO CP-ALTERNATE-BENEFIT
 14489         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14490     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14491     MOVE 'R'                    TO CP-RATE-FILE
 14492     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14493     IF NOT CP-ERROR-RATE-NOT-FOUND
 14494        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14495        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14496           AND (CP-BENEFIT-CD (1:1) = 'S')
 14497           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14498                                    PB-I-LF-PREMIUM-AMT
 14499        END-IF
 14500     ELSE
 14501        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14502     END-IF
 14503     .
 14504 3340-EDIT-LF-AH-TOL.
 14505
 14506***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14507***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14508***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14509***
 14510     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14511         PB-I-AH-PREMIUM-AMT
 14512          GIVING WS-CALC-WORK.
 14513
 14514     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14515        AND WS-CALC-WORK NOT = ZERO
 14516         MOVE ER-2649            TO WS-ERROR
 14517         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14518
 14519     SUBTRACT PB-I-LF-PREM-CALC
 14520             FROM PB-I-LF-PREMIUM-AMT
 14521                 GIVING WS-UNSIGN-WRK1.
 14522
 14523     SUBTRACT PB-I-LF-ALT-PREM-CALC
 14524             FROM PB-I-LF-ALT-PREMIUM-AMT
 14525                 GIVING WS-UNSIGN-WRK4.
 14526
 14527     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14528                                + WS-UNSIGN-WRK4.
 14529
 14530     SUBTRACT PB-I-AH-PREM-CALC
 14531             FROM PB-I-AH-PREMIUM-AMT
 14532                 GIVING WS-UNSIGN-WRK2.
 14533
 14534******************************************************************
 14535*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14536******************************************************************
 14537
 14538     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14539         MOVE ZERO TO WS-UNSIGN-WRK1.
 14540
 14541     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14542         MOVE ZERO TO WS-UNSIGN-WRK2.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 263
* EL050.cbl
 14543
 14544     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14545             GIVING WS-UNSIGN-WRK3.
 14546
 14547 3342-CONTINUE.
 14548
 14549     IF (PB-I-LF-RATE = ZERO  AND
 14550         PB-I-AH-RATE = ZERO)
 14551         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14552            WS-AH-SPECIAL-CALC-CD = 'O'
 14553              NEXT SENTENCE
 14554         ELSE
 14555             GO TO 3345-EDIT-CONTINUE.
 14556
 14557     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14558         NEXT SENTENCE
 14559     ELSE
 14560     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14561        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14562           IF (PB-REISSUED-CERT         OR
 14563               PB-POLICY-IS-DECLINED    OR
 14564               PB-POLICY-IS-VOIDED)
 14565              NEXT SENTENCE
 14566           ELSE
 14567              IF WS-PREM-REJECT-SW = SPACE
 14568                 MOVE ER-2652    TO WS-ERROR
 14569                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14570                 GO TO 3344-CHECK-AH
 14571              ELSE
 14572                 MOVE ER-2650    TO WS-ERROR
 14573                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14574                 GO TO 3344-CHECK-AH.
 14575
 14576***
 14577***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14578***
 14579
 14580     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14581         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 14582            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14583             (1 + WS-TOL-LF-PREM-PCT)
 14584         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14585            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14586             (1 - WS-TOL-LF-PREM-PCT)
 14587     ELSE
 14588         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 14589         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 14590
 14591***
 14592***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14593***
 14594
 14595     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14596         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14597          WS-TOL-LF-PREM.
 14598
 14599     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14600         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 264
* EL050.cbl
 14601          WS-TOL-LF-PREM.
 14602
 14603     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14604        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14605
 14606     IF PB-REISSUED-CERT
 14607        or PB-POLICY-IS-DECLINED
 14608        or PB-POLICY-IS-VOIDED
 14609        continue
 14610     ELSE
 14611        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14612              > WS-TOL-LF-HIGH-PREM-AMT)
 14613           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14614              < WS-TOL-LF-LOW-PREM-AMT))
 14615                      or
 14616           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14617              > WS-TOL-LF-HIGH-PREM-PCT)
 14618           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14619              < WS-TOL-LF-LOW-PREM-PCT))
 14620           IF WS-PREM-REJECT-SW = SPACE
 14621              MOVE ER-2652       TO WS-ERROR
 14622              PERFORM 9900-ERROR-FORMAT
 14623                                 THRU 9900-EXIT
 14624           ELSE
 14625              MOVE ER-2650       TO WS-ERROR
 14626              PERFORM 9900-ERROR-FORMAT
 14627                                 THRU 9900-EXIT
 14628           end-if
 14629        end-if
 14630     end-if
 14631
 14632*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14633*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14634*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14635*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14636
 14637     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14638        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14639                      OR
 14640           ((PB-COMPANY-ID = 'DCC')
 14641           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 14642           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14643           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14644        END-IF
 14645     END-IF
 14646
 14647     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14648        IF WS-COMP-MAX-CAP GREATER THAN +0
 14649           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14650              IF (PB-REISSUED-CERT         OR
 14651                  PB-POLICY-IS-DECLINED    OR
 14652                  PB-POLICY-IS-VOIDED)
 14653                 NEXT SENTENCE
 14654              ELSE
 14655                  MOVE ER-2646   TO  WS-ERROR
 14656                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14657
 14658 3344-CVL-TOLERANCE-CHECK.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 265
* EL050.cbl
 14659
 14660      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14661          GO TO 3344-CHECK-AH.
 14662
 14663      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14664          GO TO 3344-CHECK-AH.
 14665
 14666      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14667                                     WS-UNSIGN-WRK6.
 14668
 14669      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14670          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14671                                 + PB-I-LF-PREMIUM-AMT
 14672                                 - PB-I-LF-PREM-CALC.
 14673
 14674      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14675          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14676                                 + PB-I-LF-ALT-PREMIUM-AMT
 14677                                 - PB-I-LF-ALT-PREM-CALC.
 14678
 14679      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14680          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14681              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14682                 MOVE ER-2652    TO  WS-ERROR
 14683                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14684              ELSE
 14685                 MOVE ER-2650    TO  WS-ERROR
 14686                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14687
 14688      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14689          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14690              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14691                 MOVE ER-2652    TO  WS-ERROR
 14692                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14693              ELSE
 14694                 MOVE ER-2650    TO  WS-ERROR
 14695                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14696
 14697 3344-CHECK-AH.
 14698
 14699****************************************************************
 14700***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14701***
 14702
 14703     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14704         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14705             (1 + WS-TOL-AH-PREM-PCT)
 14706         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14707             (1 - WS-TOL-AH-PREM-PCT)
 14708     ELSE
 14709         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 14710         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 14711
 14712***
 14713***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14714***
 14715
 14716     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 266
* EL050.cbl
 14717         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14718
 14719     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14720         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14721
 14722     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14723        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14724
 14725     IF (PB-REISSUED-CERT)
 14726        OR (PB-POLICY-IS-DECLINED)
 14727        OR (PB-POLICY-IS-VOIDED)
 14728        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14729        CONTINUE
 14730     ELSE
 14731        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14732              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14733                          or
 14734           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 14735              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14736           IF WS-PREM-REJECT-SW = SPACE
 14737              MOVE ER-3052       TO WS-ERROR
 14738              PERFORM 9900-ERROR-FORMAT
 14739                                 THRU 9900-EXIT
 14740           ELSE
 14741              MOVE ER-3050       TO WS-ERROR
 14742              PERFORM 9900-ERROR-FORMAT
 14743                                 THRU 9900-EXIT
 14744           END-IF
 14745        END-IF
 14746     END-IF
 14747     if (pb-company-id = 'DCC')
 14748        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 14749        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 14750        and (pb-i-policy-is-monthly)
 14751        compute ws-tol-ah-high-prem-amt =
 14752           pb-i-tot-fees-calc + ws-tol-ah-prem
 14753        compute ws-tol-ah-low-prem-amt =
 14754           pb-i-tot-fees-calc - ws-tol-ah-prem
 14755        if ws-tol-ah-prem-pct > zeros
 14756           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 14757              (1 + ws-tol-ah-prem-pct)
 14758           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 14759              (1 - ws-tol-ah-prem-pct)
 14760        else
 14761           move +9999999.99      to ws-tol-ah-high-prem-pct
 14762           move +0               to ws-tol-ah-low-prem-pct
 14763        end-if
 14764        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 14765            or
 14766           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 14767                          or
 14768           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 14769           or
 14770           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 14771            move er-3049         to ws-error
 14772           perform 9900-error-format
 14773                                 thru 9900-exit
 14774
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 267
* EL050.cbl
 14775        end-if
 14776     end-if
 14777     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 14778         IF  PB-RECORD-BILL   =  'B' OR 'A'
 14779             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14780             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14781
 14782     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14783        IF WS-COMP-MAX-CAP GREATER THAN +0
 14784           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 14785              IF (PB-REISSUED-CERT         OR
 14786                  PB-POLICY-IS-DECLINED    OR
 14787                  PB-POLICY-IS-VOIDED)
 14788                 NEXT SENTENCE
 14789              ELSE
 14790                  MOVE ER-2646   TO  WS-ERROR
 14791                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14792
 14793     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 14794        (WS-COMP-MAX-CAP EQUAL +0)
 14795           GO TO 3345-EDIT-CONTINUE.
 14796
 14797     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 14798        GREATER THAN WS-COMP-MAX-CAP
 14799           MOVE ER-2646          TO  WS-ERROR
 14800           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14801
 14802 3345-EDIT-CONTINUE.
 14803
 14804*    IF PB-COMPANY-ID    EQUAL    'NCL'
 14805*       IF PB-ENTRY-BATCH   NUMERIC
 14806*          IF PB-ISSUE
 14807*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 14808*          ELSE
 14809*              IF PB-CANCELLATION
 14810*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 14811
 14812*    IF  PB-COMPANY-ID    EQUAL    'HER'
 14813*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 14814*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 14815*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 14816*        ELSE
 14817*            MOVE  ER-1909            TO  WS-ERROR
 14818*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14819
 14820     IF PB-I-POLICY-ACCEPTED
 14821        IF PB-POLICY-IS-DECLINED  OR
 14822           PB-REISSUED-CERT  OR
 14823           PB-REIN-ONLY-CERT  OR
 14824           PB-POLICY-IS-VOIDED
 14825            MOVE  ER-1891         TO  WS-ERROR
 14826            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14827        ELSE
 14828            MOVE SPACE            TO  PB-BATCH-ENTRY
 14829            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 14830
 14831     IF PB-I-POLICY-DECLINED
 14832        IF PB-REISSUED-CERT  OR
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 268
* EL050.cbl
 14833           PB-REIN-ONLY-CERT  OR
 14834           PB-POLICY-IS-VOIDED
 14835            MOVE  ER-1906         TO  WS-ERROR
 14836            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14837        ELSE
 14838            MOVE  'D'             TO  PB-BATCH-ENTRY
 14839                                      PB-I-ENTRY-STATUS.
 14840
 14841     IF PB-I-NEEDS-UNDERWRITING
 14842        IF PB-POLICY-IS-DECLINED OR
 14843           PB-REISSUED-CERT  OR
 14844           PB-REIN-ONLY-CERT  OR
 14845           PB-POLICY-IS-VOIDED
 14846            MOVE  ER-1907         TO  WS-ERROR
 14847            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14848        ELSE
 14849            MOVE 'U'              TO  PB-BATCH-ENTRY
 14850                                      PB-I-ENTRY-STATUS.
 14851
 14852     IF PB-NEEDS-UNDERWRITING
 14853        MOVE  ER-1901             TO  WS-ERROR
 14854        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 14855     IF PB-COMPANY-ID = 'DCC'
 14856        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 14857        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 14858        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14859           AND (NOT WS-LF-CASH))
 14860                           OR
 14861           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14862           AND (NOT WS-AH-CASH)))
 14863                       AND
 14864           (PB-I-ENTRY-STATUS NOT = '5')
 14865           MOVE 'M'              TO PB-BATCH-ENTRY
 14866                                    PB-I-ENTRY-STATUS
 14867        END-IF
 14868     END-IF
 14869     IF  PB-COMPANY-ID NOT = 'NCL'
 14870         GO TO 3999-END-EDIT.
 14871
 14872     IF PB-REISSUED-CERT  OR
 14873        PB-POLICY-IS-DECLINED  OR
 14874        PB-POLICY-IS-VOIDED  OR
 14875        PB-I-OB
 14876         GO TO 3999-END-EDIT.
 14877
 14878     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 14879         MOVE  ER-2644            TO  WS-ERROR
 14880         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 14881         GO TO 3999-END-EDIT.
 14882
 14883     MOVE 'N'                     TO  FORM-MASTER-SW.
 14884     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 14885
 14886     IF NOT FORM-MASTER-FOUND
 14887         GO TO 3999-END-EDIT.
 14888
 14889     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 14890                                      FORM-MASTER-AH-SW.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 269
* EL050.cbl
 14891
 14892     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14893         MOVE  +1                 TO SUB6
 14894         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 14895
 14896     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14897         MOVE  +1                 TO SUB6
 14898         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 14899
 14900     IF LF-FORM-MASTER-FOUND  OR
 14901        AH-FORM-MASTER-FOUND
 14902         GO TO 3360-CHECK-FORM-LIMITS
 14903     ELSE
 14904         GO TO 3999-END-EDIT.
 14905
 14906******************************************************************
 14907*                  3350-GET-ERFORM                               *
 14908*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 14909*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 14910******************************************************************
 14911
 14912 3350-GET-ERFORM.
 14913
 14914     IF  WK-FORM-ADDR      EQUAL    ZEROS
 14915         GO TO  3350-ERFORM-GETMAIN.
 14916
 14917     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 14918     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 14919     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 14920     MOVE 'Y'                     TO FORM-MASTER-SW.
 14921
 14922     IF PB-CANCELLATION
 14923         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14924            PB-SV-STATE          EQUAL   FO-STATE       AND
 14925            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14926              GO TO 3350-EXIT
 14927         ELSE
 14928             NEXT SENTENCE
 14929     ELSE
 14930         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14931            PB-SV-STATE          EQUAL   FO-STATE       AND
 14932            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14933              GO TO 3350-EXIT.
 14934
 14935 3350-ERFORM-GETMAIN.
 14936
 14937     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 14938     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 14939
 14940 3350-ERFORM-READ.
 14941
 14942     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 14943     MOVE  PB-SV-STATE            TO  FORM-STATE.
 14944     IF PB-CANCELLATION
 14945         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 14946     ELSE
 14947         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 14948     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 270
* EL050.cbl
 14949
 14950     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 14951
 14952     IF FORM-MASTER-FOUND
 14953       IF PB-CANCELLATION
 14954          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14955             PB-SV-STATE          EQUAL   FO-STATE       AND
 14956             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14957              GO  TO 3350-EXIT
 14958          ELSE
 14959              NEXT SENTENCE
 14960       ELSE
 14961          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14962             PB-SV-STATE          EQUAL   FO-STATE       AND
 14963             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14964              GO  TO 3350-EXIT.
 14965
 14966     MOVE  'N'                    TO  FORM-MASTER-SW.
 14967     MOVE  ER-1895                TO  WS-ERROR.
 14968     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14969
 14970 3350-EXIT.
 14971      EXIT.
 14972
 14973******************************************************************
 14974*                  3355-EDIT-FORM-LF-BENEFITS                    *
 14975*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 14976*   VALID FOR THE POLICY FORM USED.                              *
 14977******************************************************************
 14978
 14979 3355-EDIT-FORM-LF-BENEFITS.
 14980
 14981     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14982        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14983         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 14984         GO TO   3355-EXIT.
 14985
 14986     IF  SUB6    LESS THAN   +40
 14987         ADD  +1      TO  SUB6
 14988         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 14989
 14990     MOVE  ER-1896         TO  WS-ERROR.
 14991     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14992
 14993 3355-EXIT.
 14994      EXIT.
 14995
 14996******************************************************************
 14997*                  3356-EDIT-FORM-AH-BENEFITS                    *
 14998*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 14999*   VALID FOR THE POLICY FORM USED.                              *
 15000******************************************************************
 15001
 15002 3356-EDIT-FORM-AH-BENEFITS.
 15003
 15004     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15005        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15006         MOVE  'Y'                TO  FORM-MASTER-AH-SW
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 271
* EL050.cbl
 15007         GO TO  3356-EXIT.
 15008
 15009      IF  SUB6    LESS THAN     +40
 15010          ADD  +1      TO  SUB6
 15011          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15012
 15013     MOVE  ER-1897         TO  WS-ERROR.
 15014     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15015
 15016 3356-EXIT.
 15017      EXIT.
 15018
 15019******************************************************************
 15020*                  3357-BENEFIT-SEARCH                           *
 15021*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15022*   CANCELLATIONS ONLY.                                          *
 15023******************************************************************
 15024 3357-BENEFIT-SEARCH.
 15025     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15026         MOVE +1                          TO SUB6
 15027         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15028
 15029     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15030         MOVE +1                          TO SUB6
 15031         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15032
 15033 3357-EXIT.
 15034     EXIT.
 15035
 15036******************************************************************
 15037*                  3358-BENEFIT-LIFE-SEARCH                      *
 15038*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15039*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15040*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15041******************************************************************
 15042 3358-BENEFIT-LIFE-SEARCH.
 15043     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15044       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15045         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15046           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15047              IF FO-PLAN-REFUND-METHOD (SUB6)
 15048                     IS GREATER THAN SPACES
 15049                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15050                                          WS-LF-REFUND-CALC
 15051                 GO TO 3358-EXIT.
 15052
 15053     IF SUB6 LESS THAN +40
 15054         ADD +1                 TO SUB6
 15055         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15056
 15057 3358-EXIT.
 15058     EXIT.
 15059******************************************************************
 15060*                  3359-BENEFIT-AH-SEARCH                        *
 15061*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15062*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15063*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15064******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 272
* EL050.cbl
 15065 3359-BENEFIT-AH-SEARCH.
 15066     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15067       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15068         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15069           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15070              IF FO-PLAN-REFUND-METHOD (SUB6)
 15071                      IS GREATER THAN SPACES
 15072                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15073                                          WS-AH-REFUND-CALC
 15074                 GO TO 3359-EXIT.
 15075
 15076     IF SUB6 LESS THAN +40
 15077         ADD +1                 TO SUB6
 15078         GO TO 3359-BENEFIT-AH-SEARCH.
 15079
 15080 3359-EXIT.
 15081     EXIT.
 15082
 15083******************************************************************
 15084*                  3360-CHECK-FORM-LIMITS                        *
 15085*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15086*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15087******************************************************************
 15088
 15089 3360-CHECK-FORM-LIMITS.
 15090
 15091     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15092         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15093
 15094     IF NOT LF-FORM-MASTER-FOUND
 15095         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15096
 15097 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15098
 15099     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15100       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15101        WS-LF-JOINT-INDICATOR = 'J'  AND
 15102        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15103         IF PB-COMPANY-ID = 'NCL'
 15104            MOVE  ER-1911          TO  WS-ERROR
 15105            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15106         ELSE
 15107            MOVE  ER-1892          TO  WS-ERROR
 15108            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15109
 15110 3360-CHECK-FORM-LF-ATT-AGE.
 15111
 15112     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15113
 15114     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15115         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15116         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15117            IF PB-COMPANY-ID = 'NCL'
 15118                MOVE  ER-1913      TO  WS-ERROR
 15119                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15120            ELSE
 15121                MOVE  ER-1894      TO  WS-ERROR
 15122                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 273
* EL050.cbl
 15123
 15124 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15125
 15126     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15127         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15128         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15129            IF PB-COMPANY-ID = 'NCL'
 15130                MOVE  ER-1914      TO  WS-ERROR
 15131                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15132            ELSE
 15133                MOVE  ER-1899      TO  WS-ERROR
 15134                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15135
 15136 3360-CHECK-FORM-LF-TERM-BAMT.
 15137
 15138     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15139         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15140         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15141           IF  PB-COMPANY-ID = 'NCL'
 15142               MOVE  ER-1916       TO  WS-ERROR
 15143               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15144           ELSE
 15145               MOVE  ER-1902       TO  WS-ERROR
 15146               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15147
 15148     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15149                                    PB-I-LF-ALT-BENEFIT-AMT.
 15150
 15151     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15152         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15153         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15154             IF  PB-COMPANY-ID = 'NCL'
 15155                 MOVE  ER-1918     TO  WS-ERROR
 15156                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15157             ELSE
 15158                 MOVE  ER-1904     TO  WS-ERROR
 15159                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15160
 15161******************************************************************
 15162*                  3360-CHECK-FORM-AH-LIMITS                     *
 15163*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15164*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15165******************************************************************
 15166
 15167 3360-CHECK-FORM-AH-LIMITS.
 15168
 15169     IF NOT AH-FORM-MASTER-FOUND
 15170         GO TO 3999-END-EDIT.
 15171
 15172 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15173
 15174     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15175       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15176        WS-AH-JOINT-INDICATOR = 'J'  AND
 15177        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15178         IF PB-COMPANY-ID = 'NCL'
 15179            MOVE  ER-1912          TO  WS-ERROR
 15180            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 274
* EL050.cbl
 15181         ELSE
 15182            MOVE  ER-1893          TO  WS-ERROR
 15183            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15184
 15185 3360-CHECK-FORM-AH-ATT-AGE.
 15186
 15187     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15188
 15189     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15190         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15191         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15192            IF PB-COMPANY-ID = 'NCL'
 15193                MOVE  ER-1913      TO  WS-ERROR
 15194                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15195            ELSE
 15196                MOVE  ER-1894      TO  WS-ERROR
 15197                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15198
 15199 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15200
 15201     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15202         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15203         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15204            IF PB-COMPANY-ID = 'NCL'
 15205                MOVE  ER-1915      TO  WS-ERROR
 15206                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15207            ELSE
 15208                MOVE  ER-1900      TO  WS-ERROR
 15209                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15210
 15211 3360-CHECK-FORM-AH-TERM-BAMT.
 15212
 15213     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15214         FO-AH-MAX-TERM    GREATER THAN  +0
 15215         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15216             IF  PB-COMPANY-ID = 'NCL'
 15217                 MOVE  ER-1917     TO  WS-ERROR
 15218                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15219             ELSE
 15220                  MOVE  ER-1903    TO  WS-ERROR
 15221                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15222
 15223     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15224         FO-MAX-AH-AMT    GREATER THAN  +0
 15225         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15226             IF  PB-COMPANY-ID = 'NCL'
 15227                 MOVE  ER-1919     TO  WS-ERROR
 15228                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15229             ELSE
 15230                 MOVE  ER-1905     TO  WS-ERROR
 15231                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15232
 15233     GO TO 3999-END-EDIT.
 15234
 15235******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 275
* EL050.cbl
 15237******************************************************************
 15238*                  E D I T   C A N C E L                         *
 15239******************************************************************
 15240
 15241 3700-EDIT-CANCEL.
 15242     IF PB-COMPANY-ID = 'DMD'
 15243         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15244                                         WS-RES-MUNI-TAX
 15245                                         PB-CI-STATE-TAX
 15246                                         PB-CI-MUNI-TAX
 15247         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15248
 15249*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15250*       IF PB-ENTRY-BATCH  NUMERIC
 15251*          IF PB-CANCELLATION
 15252*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15253*          ELSE
 15254*             IF PB-ISSUE
 15255*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15256
 15257     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15258        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15259     END-IF
 15260*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15261*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15262
 15263     IF CM-ENTRY-STATUS = 'V'
 15264        MOVE ER-2780             TO WS-ERROR
 15265        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15266        GO TO 3999-END-EDIT.
 15267
 15268     IF CM-ENTRY-STATUS = 'D'
 15269        MOVE ER-2781             TO WS-ERROR
 15270        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15271        GO TO 3999-END-EDIT.
 15272
 15273     IF CM-ENTRY-STATUS = 'U'
 15274        MOVE ER-2782             TO WS-ERROR
 15275        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15276
 15277***************************************************************
 15278*                                                             *
 15279*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15280*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15281*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15282*   OF ANOTHER COVERAGE.                                      *
 15283*                                                             *
 15284***************************************************************
 15285
 15286     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15287                                    PB-C-AH-CANCEL-VOID-SW.
 15288
 15289     IF PB-C-LF-CANCEL-AMT = ZERO
 15290        NEXT SENTENCE
 15291     ELSE
 15292        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15293           AND
 15294           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 276
* EL050.cbl
 15295               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 15296               MOVE ER-2745           TO WS-ERROR
 15297               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15298
 15299     IF PB-C-AH-CANCEL-AMT = ZERO
 15300        NEXT SENTENCE
 15301     ELSE
 15302        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15303           AND
 15304           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15305               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15306               MOVE ER-2745           TO WS-ERROR
 15307               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15308
 15309     IF WS-LF-EARNINGS-CALC = '4'
 15310        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15311
 15312     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15313     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15314     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15315     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15316     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15317     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15318
 15319     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15320                                      PB-C-AH-REF-CALC.
 15321     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15322
 15323******************************************************************
 15324*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15325*             TO VALIDATE COVERAGE.                              *
 15326******************************************************************
 15327
 15328     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15329        PB-C-LF-CANCEL-AMT = ZEROS
 15330          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15331      ELSE
 15332          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15333
 15334     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15335        PB-C-AH-CANCEL-AMT = ZEROS
 15336          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15337      ELSE
 15338          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15339
 15340     EVALUATE TRUE
 15341         WHEN PB-CANCEL-FORCE             OR
 15342              PB-CANCEL-DATE-FORCED       OR
 15343              PB-FORCE-OFF
 15344                  IF PB-COMPANY-ID = 'ACE'
 15345                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15346                  END-IF
 15347         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15348               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15349              (PB-COMPANY-ID = 'ACE' )
 15350                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15351         WHEN OTHER
 15352              IF PB-COMPANY-ID = 'ACE'
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 277
* EL050.cbl
 15353                 MOVE ER-2794              TO WS-ERROR
 15354              ELSE
 15355                 MOVE ER-2749              TO WS-ERROR
 15356              END-IF
 15357              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15358     END-EVALUATE.
 15359
 15360
 15361*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15362*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15363*            MOVE  ER-1909            TO  WS-ERROR
 15364*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15365*        ELSE
 15366*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15367
 15368     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15369     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15370        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15371     ELSE
 15372        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15373     END-IF
 15374     .
 15375 3705-EDIT-CANCEL-DT.
 15376
 15377     IF LF-COVERAGE-CANCELLED
 15378        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15379         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15380         MOVE WS-CURRENT-MONTH-END
 15381                                 TO DC-BIN-DATE-2
 15382         SET ELAPSED-BETWEEN-BIN TO TRUE
 15383*        MOVE 1                  TO DC-OPTION-CODE
 15384         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15385         IF DATE-CONVERSION-ERROR
 15386            NEXT SENTENCE
 15387          ELSE
 15388             IF DC-ELAPSED-DAYS GREATER +180
 15389                IF PB-CANCEL-DATE-FORCED  OR
 15390                   PB-CANCEL-DATE-FORCED-NO-FEE
 15391                      MOVE ER-2751  TO WS-ERROR
 15392                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15393                 ELSE
 15394                   MOVE ER-2752  TO WS-ERROR
 15395                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15396
 15397     IF AH-COVERAGE-CANCELLED
 15398        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15399         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15400         MOVE WS-CURRENT-MONTH-END
 15401                                 TO DC-BIN-DATE-2
 15402         SET ELAPSED-BETWEEN-BIN TO TRUE
 15403*        MOVE 1                  TO DC-OPTION-CODE
 15404         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15405         IF DATE-CONVERSION-ERROR
 15406            NEXT SENTENCE
 15407          ELSE
 15408             IF DC-ELAPSED-DAYS GREATER +180
 15409                IF PB-CANCEL-DATE-FORCED OR
 15410                   PB-CANCEL-DATE-FORCED-NO-FEE
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 278
* EL050.cbl
 15411                      MOVE ER-2751  TO WS-ERROR
 15412                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15413                 ELSE
 15414                   MOVE ER-2752  TO WS-ERROR
 15415                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15416
 15417     IF WS-ERROR = ER-2752
 15418        AND (PB-COMPANY-ID = 'ABL'
 15419         OR  PB-COMPANY-ID = 'FGL'
 15420         OR  PB-COMPANY-ID = 'IST'
 15421         OR  PB-COMPANY-ID = 'JHL'
 15422         OR  PB-COMPANY-ID = 'LAP'
 15423         OR  PB-COMPANY-ID = 'LBL'
 15424         OR  PB-COMPANY-ID = 'NCB'
 15425         OR  PB-COMPANY-ID = 'NLI'
 15426         OR  PB-COMPANY-ID = 'OFI'
 15427         OR  PB-COMPANY-ID = 'PLI'
 15428         OR  PB-COMPANY-ID = 'TAO'
 15429         OR  PB-COMPANY-ID = 'TIC'
 15430         OR  PB-COMPANY-ID = 'HER'
 15431         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15432         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15433            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15434            MOVE ER-2762     TO WS-ERROR
 15435            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15436
 15437     IF LF-COVERAGE-CANCELLED
 15438        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15439        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15440             MOVE ER-2733         TO WS-ERROR
 15441             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15442
 15443     IF AH-COVERAGE-CANCELLED
 15444        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15445        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15446              MOVE ER-2733        TO WS-ERROR
 15447              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15448
 15449     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15450        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15451        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15452           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15453            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15454              IF PB-COMPANY-ID NOT = 'LAP'
 15455               MOVE ER-2704            TO WS-ERROR
 15456               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15457
 15458     IF CERT-WAS-NOT-FOUND
 15459         GO TO 3999-END-EDIT.
 15460
 15461     IF PB-COMPANY-ID EQUAL 'CDC'
 15462        IF LF-COVERAGE-CANCELLED
 15463           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15464            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15465            MOVE PB-C-LF-CANCEL-DT
 15466                                 TO DC-BIN-DATE-2
 15467            SET ELAPSED-BETWEEN-BIN TO TRUE
 15468*           MOVE 1               TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 279
* EL050.cbl
 15469            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15470            IF DATE-CONVERSION-ERROR
 15471               NEXT SENTENCE
 15472             ELSE
 15473                IF DC-ELAPSED-DAYS GREATER +60
 15474                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15475
 15476     IF PB-COMPANY-ID EQUAL 'CDC'
 15477        IF AH-COVERAGE-CANCELLED
 15478           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15479            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15480            MOVE PB-C-AH-CANCEL-DT
 15481                                 TO DC-BIN-DATE-2
 15482            MOVE +0              TO DC-ELAPSED-DAYS
 15483                                    DC-ELAPSED-MONTHS
 15484            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15485*           MOVE 1               TO DC-OPTION-CODE
 15486            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15487            IF DATE-CONVERSION-ERROR
 15488               NEXT SENTENCE
 15489             ELSE
 15490                IF DC-ELAPSED-DAYS GREATER +60
 15491                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15492
 15493     MOVE +0                     TO DC-ELAPSED-DAYS
 15494                                    DC-ELAPSED-MONTHS.
 15495
 15496     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15497        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15498          MOVE 'Z'                TO PB-CI-OB-FLAG
 15499          MOVE ER-2767            TO WS-ERROR
 15500          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15501          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15502          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15503          GO TO 3775-OVER-REF-CHK
 15504        ELSE
 15505          MOVE ZEROS              TO PB-CI-LIVES
 15506                                     PB-C-LIVES
 15507          IF PB-CI-OB-FLAG NOT = 'B'
 15508             MOVE SPACE           TO PB-CI-OB-FLAG.
 15509
 15510     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15511         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15512     ELSE
 15513         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15514
 15515     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15516        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15517            MOVE ER-2760         TO WS-ERROR
 15518            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15519
 15520     IF LF-COVERAGE-CANCELLED
 15521        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15522         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15523            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15524               MOVE ER-2774       TO WS-ERROR
 15525               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15526
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 280
* EL050.cbl
 15527     IF AH-COVERAGE-CANCELLED
 15528        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15529         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15530            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15531               MOVE ER-2775       TO WS-ERROR
 15532               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15533
 15534     IF LF-COVERAGE-CANCELLED
 15535        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15536         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15537            MOVE ER-2776         TO WS-ERROR
 15538            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15539
 15540     IF AH-COVERAGE-CANCELLED
 15541        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15542         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15543            MOVE ER-2777         TO WS-ERROR
 15544            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15545
 15546     IF LF-COVERAGE-CANCELLED
 15547        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15548        if pb-ci-lf-expire-dt = low-values or spaces
 15549           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15550           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 15551           MOVE PB-CI-EXTENTION-DAYS
 15552                                 TO DC-ELAPSED-DAYS
 15553           SET BIN-PLUS-ELAPSED  TO TRUE
 15554           PERFORM 8500-DATE-CONVERT
 15555                                 THRU 8500-EXIT
 15556           IF DATE-CONVERSION-ERROR
 15557              move low-values    to dc-bin-date-2
 15558           end-if
 15559        else
 15560           move pb-ci-lf-expire-dt
 15561                                 to dc-bin-date-2
 15562        end-if
 15563        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15564           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15565                             OR  'FIA'
 15566              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 15567           ELSE
 15568              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15569              MOVE ER-2731       TO WS-ERROR
 15570              PERFORM 9900-ERROR-FORMAT
 15571                                 THRU 9900-EXIT
 15572           end-if
 15573        end-if
 15574     end-if
 15575*    IF LF-COVERAGE-CANCELLED
 15576*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15577*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15578*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15579*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15580*        SET BIN-PLUS-ELAPSED      TO TRUE
 15581*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15582*        IF DATE-CONVERSION-ERROR
 15583*           NEXT SENTENCE
 15584*         ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 281
* EL050.cbl
 15585*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15586*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15587*                            OR  'FIA'
 15588*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15589*              ELSE
 15590*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15591*               MOVE ER-2731       TO WS-ERROR
 15592*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15593     .
 15594 3705-EDIT-AH-CANCEL-DT.
 15595     IF AH-COVERAGE-CANCELLED
 15596        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15597        if pb-ci-AH-expire-dt = low-values or spaces
 15598           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15599           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 15600           MOVE PB-CI-EXTENTION-DAYS
 15601                                 TO DC-ELAPSED-DAYS
 15602           SET BIN-PLUS-ELAPSED  TO TRUE
 15603           PERFORM 8500-DATE-CONVERT
 15604                                 THRU 8500-EXIT
 15605           IF DATE-CONVERSION-ERROR
 15606              move low-values    to dc-bin-date-2
 15607           end-if
 15608        else
 15609           move pb-ci-ah-expire-dt
 15610                                 to dc-bin-date-2
 15611        end-if
 15612        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15613           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15614                             OR  'FIA'
 15615              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 15616           ELSE
 15617              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15618              MOVE ER-2771       TO WS-ERROR
 15619              PERFORM 9900-ERROR-FORMAT
 15620                                 THRU 9900-EXIT
 15621           end-if
 15622        end-if
 15623     end-if
 15624*    IF AH-COVERAGE-CANCELLED
 15625*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15626*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15627*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15628*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15629**       MOVE 6                    TO DC-OPTION-CODE
 15630*        SET BIN-PLUS-ELAPSED      TO TRUE
 15631*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15632*        IF DATE-CONVERSION-ERROR
 15633*           NEXT SENTENCE
 15634*         ELSE
 15635*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15636*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15637*                             OR 'FIA'
 15638*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15639*             ELSE
 15640*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15641*              MOVE ER-2771       TO WS-ERROR
 15642*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 282
* EL050.cbl
 15643     .
 15644 3705-EDIT-CONTINUED.
 15645
 15646*    IF LF-COVERAGE-CANCELLED
 15647*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15648*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15649*            MOVE ER-2727         TO WS-ERROR
 15650*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15651*
 15652*    IF AH-COVERAGE-CANCELLED
 15653*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15654*        IF PB-COMPANY-ID = 'ACE'
 15655*           MOVE ER-2727        TO WS-ERROR
 15656*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15657*        ELSE
 15658*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15659*              MOVE ER-2727     TO WS-ERROR
 15660*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15661
 15662     IF PB-COMPANY-ID = 'ACE'
 15663       IF AH-COVERAGE-CANCELLED
 15664         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15665           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15666              MOVE ER-2732      TO WS-ERROR
 15667              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15668
 15669     IF PB-COMPANY-ID      EQUAL   'HER'
 15670        IF WS-ERROR        EQUAL   ER-2727
 15671            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15672            MOVE  ER-2725          TO  WS-ERROR
 15673            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15674
 15675     IF PB-C-CLAIM-CREATED-CANCEL
 15676            MOVE ER-2748         TO WS-ERROR
 15677            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15678
 15679     IF PB-C-LAST-NAME NOT = SPACES
 15680         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15681            MOVE ER-2747         TO WS-ERROR
 15682            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15683
 15684 3710-EDIT-LUMP-SUM-PRIOR.
 15685
 15686     IF AH-COVERAGE-CANCELLED
 15687         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15688             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15689                MOVE ER-2735    TO WS-ERROR
 15690                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15691
 15692     IF LF-COVERAGE-CANCELLED
 15693         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15694             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 15695                MOVE ER-2735    TO WS-ERROR
 15696                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15697
 15698 3710-EDIT-PRIOR-DEATH.
 15699
 15700*    IF LF-COVERAGE-CANCELLED
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 283
* EL050.cbl
 15701*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15702*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15703*           (NOT PB-CI-OB)
 15704*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 15705*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 15706*                   MOVE ER-2732  TO WS-ERROR
 15707*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15708*
 15709*    IF AH-COVERAGE-CANCELLED
 15710*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15711*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15712*           (NOT PB-CI-OB)
 15713*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 15714*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 15715*                   MOVE ER-2732  TO WS-ERROR
 15716*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15717
 15718     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 15719         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 15720            (NOT PB-COMP-LF-CANCEL)
 15721             NEXT SENTENCE
 15722         ELSE
 15723           IF PB-C-LF-CANCEL-VOIDED
 15724              NEXT SENTENCE
 15725           ELSE
 15726              MOVE ER-2753      TO WS-ERROR
 15727              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15728
 15729     IF CANCEL-FUTURE-DT
 15730         GO TO 3999-END-EDIT.
 15731
 15732 3715-GET-REMAIN-TERM-LF.
 15733
 15734     IF NO-LF-BENEFIT-MATCH  OR
 15735        WS-LF-BENEFIT-CD = ZEROS
 15736        GO TO 3730-GET-AH-REMAIN-TERM.
 15737
 15738     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15739     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15740     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15741     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 15742     MOVE PB-SV-STATE            TO CP-STATE.
 15743     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15744     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15745     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15746     MOVE '2'                    TO CP-PROCESS-TYPE.
 15747     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15748     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15749     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15750     IF (PB-COMPANY-ID = 'CID')
 15751        AND (CP-STATE-STD-ABBRV = 'WI')
 15752        MOVE '7'                 TO CP-REM-TERM-METHOD
 15753        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15754     ELSE
 15755        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15756        MOVE WS-REM-TRM-CALC-OPTION
 15757                                 TO CP-REM-TRM-CALC-OPTION
 15758     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 284
* EL050.cbl
 15759**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 15760     IF (PB-COMPANY-ID = 'CID')
 15761        AND (CP-STATE-STD-ABBRV = 'MO')
 15762        AND (PB-CERT-EFF-DT >= X'9B41')
 15763        AND (PB-CERT-EFF-DT <= X'A2FB')
 15764        MOVE '7'                 TO CP-REM-TERM-METHOD
 15765        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15766     END-IF
 15767     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 15768                                    CP-LOAN-TERM.
 15769     IF CP-TRUNCATED-LIFE
 15770        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 15771
 15772     IF CP-TERM-IS-DAYS
 15773         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 15774     ELSE
 15775         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15776
 15777     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 15778
 15779     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15780
 15781     IF LF-COVERAGE-CANCELLED
 15782        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 15783        NEXT SENTENCE
 15784      ELSE
 15785          GO TO 3730-GET-AH-REMAIN-TERM.
 15786
 15787 3720-GET-LF-REFUND.
 15788
 15789     IF PB-C-LF-CANCEL-VOIDED OR
 15790        PB-C-AH-CANCEL-VOIDED
 15791        GO TO 3780-UPDATE-CANCEL-CERT.
 15792
 15793     IF PB-COMPANY-ID EQUAL 'BOA'
 15794         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15795         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15796         GO TO 3730-GET-AH-REMAIN-TERM.
 15797
 15798     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 15799        (WS-AH-SPECIAL-CALC-CD = 'M')
 15800         MOVE ER-2767            TO WS-ERROR
 15801         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15802         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15803         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15804         GO TO 3780-UPDATE-CANCEL-CERT.
 15805
 15806*    if (ws-lf-earnings-calc = '6')
 15807*       or (pb-c-lf-refund-override = '6')
 15808*       move cp-remaining-term-1 to cp-remaining-term-2
 15809*    end-if
 15810     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 15811
 15812     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15813     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 15814     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15815     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 15816     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 285
* EL050.cbl
 15817     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 15818     IF (PB-COMPANY-ID = 'DCC')
 15819        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15820        IF PDEF-MASTER-FOUND
 15821           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15822              (V1 > +8)
 15823              OR (PD-PROD-CODE (V1) = 'L')
 15824           END-PERFORM
 15825           IF V1 < +9
 15826              MOVE PD-MAX-AMT (V1)
 15827                           TO CP-R-MAX-TOT-BEN
 15828                              EC-AM-LF-MAX-TOT-BEN
 15829           END-IF
 15830        ELSE
 15831        MOVE ' '                 TO PDEF-MASTER-SW
 15832        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15833        MOVE PB-STATE            TO ERPDEF-STATE
 15834        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15835        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15836        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15837        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15838        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15839        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15840        IF PDEF-MASTER-FOUND
 15841           MOVE 'N'              TO PDEF-MASTER-SW
 15842           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15843           IF PDEF-MASTER-FOUND
 15844              IF (ERPDEF-KEY-SAVE (1:16) =
 15845                           PD-CONTROL-PRIMARY (1:16))
 15846                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15847                 CONTINUE
 15848              ELSE
 15849                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15850                 IF (ERPDEF-KEY-SAVE (1:16) =
 15851                           PD-CONTROL-PRIMARY (1:16))
 15852                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15853                    CONTINUE
 15854                 ELSE
 15855                    MOVE 'N'     TO PDEF-MASTER-SW
 15856                 END-IF
 15857              END-IF
 15858              DISPLAY ' MADE IT TO REM AMT  IN IF STMT '
 15859
 15860              IF PDEF-MASTER-FOUND
 15861                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15862                    (V1 > +8)
 15863                    OR (PD-PROD-CODE (V1) = 'L')
 15864                 END-PERFORM
 15865                 IF V1 < +9
 15866                    MOVE PD-MAX-AMT (V1)
 15867                                 TO CP-R-MAX-TOT-BEN
 15868                                    EC-AM-LF-MAX-TOT-BEN
 15869                 END-IF
 15870              END-IF
 15871           END-IF
 15872           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 15873        END-IF
 15874        END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 286
* EL050.cbl
 15875     END-IF
 15876     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 15877
 15878     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 15879
 15880     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15881                                    PB-C-LF-REM-TERM.
 15882
 15883     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 15884     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 15885
 15886     IF PB-COMPANY-ID EQUAL 'FLC'
 15887        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 15888           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 15889           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 15890                    + PB-CI-LF-ALT-PREMIUM-AMT)
 15891                    - CM-LF-ITD-DEATH-AMT
 15892           IF PB-C-LF-REF-CALC LESS THAN +0
 15893              MOVE +0            TO PB-C-LF-REF-CALC
 15894              GO TO 3730-GET-AH-REMAIN-TERM
 15895           ELSE
 15896              GO TO 3730-GET-AH-REMAIN-TERM.
 15897
 15898     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15899                            OR '4' OR '5' OR '6' OR '8'
 15900                            OR '9' OR 'G'
 15901        MOVE PB-C-LF-REFUND-OVERRIDE
 15902                                 TO CP-EARNING-METHOD.
 15903
 15904     if pb-company-id = 'AHL'
 15905        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 15906        if cp-class-code = spaces
 15907           move zeros            to cp-class-code
 15908        end-if
 15909     ELSE
 15910        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 15911     END-IF
 15912*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15913     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 15914     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15915                                    CP-RATING-BENEFIT-AMT.
 15916     IF CP-STATE-STD-ABBRV = 'OR'
 15917         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15918                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15919     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15920     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15921     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15922     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 15923     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 15924     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15925     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 15926     IF WS-DEFAULT-APR NOT NUMERIC
 15927         MOVE ZEROS TO WS-DEFAULT-APR.
 15928****   N O T E   ****
 15929*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 15930*      THE OH HARD CODING IN ELCRFNDP
 15931
 15932     IF PB-COMPANY-ID = 'CID'
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 287
* EL050.cbl
 15933        IF CP-STATE-STD-ABBRV = 'OH'
 15934           MOVE WS-LF-EARNINGS-CALC
 15935                                 TO CP-EARNING-METHOD
 15936        END-IF
 15937     END-IF
 15938
 15939****   N O T E   ****
 15940
 15941     IF CP-EARN-AS-NET-PAY
 15942         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 15943            IF WS-DEFAULT-APR GREATER THAN ZEROS
 15944                MOVE WS-DEFAULT-APR
 15945                                 TO  CP-LOAN-APR
 15946                MOVE ER-3780     TO  WS-ERROR
 15947                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 15948            ELSE
 15949                MOVE ER-3781     TO  WS-ERROR
 15950                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15951*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 15952     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15953
 15954     IF CP-REFUND-TYPE-USED NOT = SPACE
 15955         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 15956
 15957     IF CP-ERROR-RATE-IS-ZERO OR
 15958        CP-ERROR-RATE-NOT-FOUND
 15959        MOVE ER-2740             TO WS-ERROR
 15960        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15961
 15962     IF CP-ERROR-RATE-FILE-NOTOPEN
 15963        MOVE ER-2617             TO WS-ERROR
 15964        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15965
 15966     IF PB-COMPANY-ID = 'DCC'
 15967        AND PB-CI-ENTRY-STATUS = 'M'
 15968        MOVE +0                  TO PB-C-LF-REF-CALC
 15969     ELSE
 15970        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 15971     END-IF
 15972
 15973     IF WS-LF-EARNINGS-CALC NOT = 'B'
 15974         GO TO 3730-GET-AH-REMAIN-TERM.
 15975
 15976*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 15977*       ADD +1                   TO PB-C-LF-REM-TERM
 15978*                                   CP-REMAINING-TERM
 15979*                                   CP-ORIGINAL-TERM.
 15980
 15981     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 15982     MOVE '2'                    TO CP-EARNING-METHOD
 15983                                    CP-RATING-METHOD.
 15984     IF PB-COMPANY-ID = 'CID'
 15985        IF (CP-STATE-STD-ABBRV = 'MN')
 15986           AND (PB-CERT-EFF-DT > X'A4FF')
 15987           AND (WS-LF-EARNINGS-CALC = 'B')
 15988           MOVE '5'              TO CP-EARNING-METHOD
 15989           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 15990        END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 288
* EL050.cbl
 15991     END-IF
 15992     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15993                                        CP-REMAINING-BENEFIT
 15994                                        CP-RATING-BENEFIT-AMT.
 15995     IF CP-STATE-STD-ABBRV = 'OR'
 15996         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15997                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15998     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15999     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16000
 16001     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16002
 16003     IF CP-ERROR-RATE-IS-ZERO OR
 16004        CP-ERROR-RATE-NOT-FOUND
 16005        MOVE ER-2740             TO WS-ERROR
 16006        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16007
 16008     IF CP-ERROR-RATE-FILE-NOTOPEN
 16009        MOVE ER-2617             TO WS-ERROR
 16010        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16011
 16012     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16013
 16014******************************************************************
 16015
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 289
* EL050.cbl
 16017 3730-GET-AH-REMAIN-TERM.
 16018     IF NO-AH-BENEFIT-MATCH  OR
 16019        WS-AH-BENEFIT-CD = ZEROS
 16020         GO TO 3770-CHECK-REFUNDS.
 16021
 16022     IF PB-CI-AH-LUMP-SUM-DISAB
 16023         IF  PB-C-AH-CANCEL-AMT = ZERO
 16024            IF NOT PB-COMP-AH-CANCEL
 16025             GO TO 3770-CHECK-REFUNDS.
 16026
 16027     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16028     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16029     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16030     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16031     MOVE PB-SV-STATE            TO CP-STATE.
 16032     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16033     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16034     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16035     MOVE '2'                    TO CP-PROCESS-TYPE.
 16036     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16037     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16038     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16039     IF (PB-COMPANY-ID = 'CID')
 16040        AND (CP-STATE-STD-ABBRV = 'WI')
 16041        MOVE '7'                 TO CP-REM-TERM-METHOD
 16042        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16043     ELSE
 16044        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16045        MOVE WS-REM-TRM-CALC-OPTION
 16046                                 TO CP-REM-TRM-CALC-OPTION
 16047     END-IF
 16048     IF (PB-COMPANY-ID = 'CID')
 16049        AND (CP-STATE-STD-ABBRV = 'MO')
 16050        AND (PB-CERT-EFF-DT >= X'9B41')
 16051        AND (PB-CERT-EFF-DT <= X'A2FB')
 16052        MOVE '7'                 TO CP-REM-TERM-METHOD
 16053        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16054     END-IF
 16055     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16056                                    CP-LOAN-TERM.
 16057     IF NOT CP-TERM-IS-DAYS
 16058         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16059
 16060     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16061
 16062     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16063
 16064     IF AH-COVERAGE-CANCELLED
 16065        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16066        NEXT SENTENCE
 16067      ELSE
 16068         GO TO 3770-CHECK-REFUNDS.
 16069
 16070 3740-GET-AH-REFUND.
 16071
 16072     IF PB-C-LF-CANCEL-VOIDED OR
 16073        PB-C-AH-CANCEL-VOIDED
 16074        GO TO 3780-UPDATE-CANCEL-CERT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 290
* EL050.cbl
 16075
 16076     IF PB-COMPANY-ID = 'BOA'
 16077         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16078         GO TO 3770-CHECK-REFUNDS.
 16079
 16080     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16081*    MOVE ' '                    TO DC-OPTION-CODE
 16082     SET BIN-TO-GREG             TO TRUE
 16083     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16084     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16085                                    PB-C-AH-REM-TERM.
 16086     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16087     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16088
 16089     IF PB-COMPANY-ID EQUAL 'FLC'
 16090        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16091           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16092           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16093                    - CM-AH-ITD-AH-PMT)
 16094           IF PB-C-AH-REF-CALC LESS THAN +0
 16095              MOVE +0            TO PB-C-AH-REF-CALC
 16096              GO TO 3770-CHECK-REFUNDS
 16097           ELSE
 16098              GO TO 3770-CHECK-REFUNDS.
 16099
 16100     IF PB-COMPANY-ID = 'DCC'
 16101        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16102            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16103           MOVE 'S'              TO CP-EARNING-METHOD
 16104        END-IF
 16105     END-IF
 16106     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16107                            OR '4' OR '5' OR '6' OR '8'
 16108                            OR '9' OR 'G' OR 'S'
 16109        MOVE PB-C-AH-REFUND-OVERRIDE
 16110                                 TO CP-EARNING-METHOD.
 16111
 16112     if pb-company-id = 'AHL'
 16113        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16114        if cp-class-code = spaces
 16115           move zeros            to cp-class-code
 16116        end-if
 16117     ELSE
 16118        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16119     END-IF
 16120*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16121     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16122     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16123                                    CP-RATING-BENEFIT-AMT.
 16124     IF CP-STATE-STD-ABBRV = 'OR'
 16125         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16126                                         PB-CI-AH-TERM.
 16127     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16128     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16129     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16130     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16131     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16132     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 291
* EL050.cbl
 16133
 16134     IF CP-STATE-STD-ABBRV = 'OH'
 16135        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16136                                AND 'CID' AND 'DCC' AND 'AHL')
 16137           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16138              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16139              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16140              MOVE '6' TO CP-EARNING-METHOD
 16141           END-IF
 16142        END-IF
 16143        IF PB-COMPANY-ID = 'CID'
 16144           IF NO-LIFE-COVERAGE
 16145              IF CP-CRITICAL-PERIOD
 16146                 MOVE '2'       TO CP-EARNING-METHOD
 16147              ELSE
 16148                 MOVE '6'       TO CP-EARNING-METHOD
 16149              END-IF
 16150           ELSE
 16151              IF WS-LF-COVERAGE-TYPE = 'L'
 16152                 MOVE '2'       TO CP-EARNING-METHOD
 16153              ELSE
 16154                 IF (PB-CI-LF-TERM > +60) OR
 16155                    (WS-LF-EARNINGS-CALC = '5')
 16156                    IF CP-CRITICAL-PERIOD
 16157                       MOVE '2'  TO CP-EARNING-METHOD
 16158                    ELSE
 16159                       MOVE '6'  TO CP-EARNING-METHOD
 16160                    END-IF
 16161                 ELSE
 16162                    MOVE '1'     TO CP-EARNING-METHOD
 16163                 END-IF
 16164              END-IF
 16165           END-IF
 16166        END-IF
 16167     END-IF
 16168
 16169*    IF CP-STATE-STD-ABBRV = 'VA'
 16170*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16171*          IF CP-ORIGINAL-TERM GREATER 61
 16172*             MOVE '6' TO CP-EARNING-METHOD
 16173*          ELSE
 16174*             MOVE '1' TO CP-EARNING-METHOD.
 16175
 16176     IF WS-DEFAULT-APR NOT NUMERIC
 16177         MOVE ZEROS TO WS-DEFAULT-APR.
 16178     IF CP-EARN-AS-NET-PAY
 16179         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16180            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16181                MOVE WS-DEFAULT-APR
 16182                                 TO  CP-LOAN-APR
 16183                MOVE ER-3780     TO  WS-ERROR
 16184                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16185            ELSE
 16186                MOVE ER-3781     TO  WS-ERROR
 16187                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16188     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16189     IF PB-COMPANY-ID = 'DCC'
 16190        AND CP-CANCEL-REASON = 'R'
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 292
* EL050.cbl
 16191        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16192        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16193     END-IF
 16194     IF PB-COMPANY-ID = 'DCC'
 16195        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16196        AND (CP-EARNING-METHOD = 'D')
 16197        AND (CP-CANCEL-REASON NOT = 'R')
 16198        CONTINUE
 16199     ELSE
 16200        GO TO 3750-CONTINUE
 16201     END-IF
 16202     MOVE ' '                    TO DD-IU-SW
 16203     IF NOT PDEF-MASTER-FOUND
 16204        MOVE ' '                 TO PDEF-MASTER-SW
 16205        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16206        MOVE PB-STATE            TO ERPDEF-STATE
 16207        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16208        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16209        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16210        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16211        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16212        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16213        IF PDEF-MASTER-FOUND
 16214           MOVE 'N'              TO PDEF-MASTER-SW
 16215           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16216           IF PDEF-MASTER-FOUND
 16217              IF (ERPDEF-KEY-SAVE (1:16) =
 16218                           PD-CONTROL-PRIMARY (1:16))
 16219                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16220                 CONTINUE
 16221              ELSE
 16222                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16223                 IF (ERPDEF-KEY-SAVE (1:16) =
 16224                           PD-CONTROL-PRIMARY (1:16))
 16225                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16226                    CONTINUE
 16227                 ELSE
 16228                    MOVE ER-2740 TO WS-ERROR
 16229                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16230                    GO TO 3770-CHECK-REFUNDS
 16231                 END-IF
 16232              END-IF
 16233           END-IF
 16234           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16235        END-IF
 16236     END-IF
 16237     IF PDEF-MASTER-FOUND
 16238        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16239           (V1 > +8)
 16240           OR (PD-PROD-CODE (V1) = 'I')
 16241        END-PERFORM
 16242        IF V1 < +9
 16243           SET DD-IU-PRESENT        TO TRUE
 16244        END-IF
 16245        IF WS-AH-DCC-TRUNC = 'T'
 16246           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16247        ELSE
 16248           MOVE CP-ORIGINAL-TERM    TO WS-TERM
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 293
* EL050.cbl
 16249        END-IF
 16250        EVALUATE TRUE
 16251           WHEN WS-TERM > +168
 16252              MOVE 15               TO V1
 16253           WHEN WS-TERM > +156
 16254              MOVE 14               TO V1
 16255           WHEN WS-TERM > +144
 16256              MOVE 13               TO V1
 16257           WHEN WS-TERM > +132
 16258              MOVE 12               TO V1
 16259           WHEN WS-TERM > +120
 16260              MOVE 11               TO V1
 16261           WHEN WS-TERM > +108
 16262              MOVE 10               TO V1
 16263           WHEN WS-TERM > +96
 16264              MOVE 9                TO V1
 16265           WHEN WS-TERM > +84
 16266              MOVE 8                TO V1
 16267           WHEN WS-TERM > +72
 16268              MOVE 7                TO V1
 16269           WHEN WS-TERM > +60
 16270              MOVE 6                TO V1
 16271           WHEN WS-TERM > +48
 16272              MOVE 5                TO V1
 16273           WHEN WS-TERM > +36
 16274              MOVE 4                TO V1
 16275           WHEN WS-TERM > +24
 16276              MOVE 3                TO V1
 16277           WHEN WS-TERM > +12
 16278              MOVE 2                TO V1
 16279           WHEN OTHER
 16280              MOVE 1                TO V1
 16281        END-EVALUATE
 16282
 16283        EVALUATE TRUE
 16284*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 16285*             < +13)
 16286*             AND (DD-IU-PRESENT)
 16287*             MOVE 2                TO V2
 16288*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 16289*             MOVE 1                TO V2
 16290           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 16291              MOVE 2                TO V2
 16292           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 16293              MOVE 3                TO V2
 16294           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 16295              MOVE 4                TO V2
 16296           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 16297              MOVE 5                TO V2
 16298           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 16299              MOVE 6                TO V2
 16300           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 16301              MOVE 7                TO V2
 16302           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 16303              MOVE 8                TO V2
 16304           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 16305              MOVE 9                TO V2
 16306           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 294
* EL050.cbl
 16307              MOVE 10               TO V2
 16308           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 16309              MOVE 11               TO V2
 16310           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 16311              MOVE 12               TO V2
 16312           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 16313              MOVE 13               TO V2
 16314           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 16315              MOVE 14               TO V2
 16316           WHEN OTHER
 16317              MOVE 15               TO V2
 16318        END-EVALUATE
 16319
 16320        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 16321                                 TO CP-DDF-LO-FACT
 16322        MOVE PD-UEP-FACTOR (V1 V2)
 16323                                 TO CP-DDF-HI-FACT
 16324
 16325        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 16326        MOVE CM-AH-CLP     TO CP-DDF-CLP
 16327        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 16328           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 16329        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 16330        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 16331        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 16332           + PD-1ST-YR-ADMIN-ALLOW
 16333
 16334        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16335*       IF PI-CLP-YN = 'Y'
 16336*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 16337*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 16338*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 16339*       END-IF
 16340
 16341        IF DD-IU-PRESENT
 16342           MOVE 'I'              TO CP-EARNING-METHOD
 16343        END-IF
 16344        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16345                                     CP-CLP-RATE-UP
 16346        IF CP-IU-RATE-UP NOT = ZEROS
 16347           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 16348              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 16349           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 16350              / (1 - WS-WORK-FACT)
 16351        END-IF
 16352     END-IF
 16353     .
 16354 3750-CONTINUE.
 16355     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16356
 16357     IF CP-REFUND-TYPE-USED NOT = SPACE
 16358         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16359
 16360     IF CP-ERROR-RATE-IS-ZERO OR
 16361        CP-ERROR-RATE-NOT-FOUND
 16362        MOVE ER-2740             TO WS-ERROR
 16363        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16364
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 295
* EL050.cbl
 16365     IF CP-ERROR-RATE-FILE-NOTOPEN
 16366        MOVE ER-2617             TO WS-ERROR
 16367        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16368     IF PB-COMPANY-ID = 'DCC'
 16369        AND PB-CI-ENTRY-STATUS = 'M'
 16370        MOVE +0                  TO PB-C-AH-REF-CALC
 16371     ELSE
 16372        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 16373     END-IF
 16374     IF PB-COMPANY-ID = 'DCC'
 16375        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16376        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16377        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16378        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16379        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16380        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16381        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16382        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16383        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16384     END-IF
 16385     GO TO 3770-CHECK-REFUNDS.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 296
* EL050.cbl
 16387
 16388 3770-CHECK-REFUNDS.
 16389
 16390     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16391        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16392           MOVE ER-2766          TO WS-ERROR
 16393           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16394           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16395           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16396              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16397
 16398     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16399        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16400           MOVE ER-2766          TO WS-ERROR
 16401           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16402           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16403           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16404              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16405
 16406     IF PB-COMP-LF-CANCEL
 16407        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 16408        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16409           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16410              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16411
 16412     IF PB-COMP-AH-CANCEL
 16413        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16414        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16415           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16416              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16417
 16418     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16419             GIVING WS-UNSIGN-WRK1
 16420     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16421             GIVING WS-UNSIGN-WRK2.
 16422
 16423     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16424         MOVE ZERO TO WS-UNSIGN-WRK1.
 16425
 16426     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16427         MOVE ZERO TO WS-UNSIGN-WRK2.
 16428
 16429     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16430
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 297
* EL050.cbl
 16432
 16433 3772-CONTINUE.
 16434
 16435**********************************
 16436*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16437*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16438*** DOUBLES THE TOLERANCE AMOUNT.
 16439***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16440**********************************
 16441     IF PB-COMPANY-ID = 'MON'
 16442     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND
 16443         IF WS-REF-REJECT-SW = SPACE
 16444             MOVE ER-2754        TO WS-ERROR
 16445             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16446           ELSE
 16447             MOVE ER-2736        TO WS-ERROR
 16448             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16449**********************************
 16450
 16451 3773-CONTINUE.
 16452
 16453     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16454        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16455           MOVE ER-2723          TO WS-ERROR
 16456           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16457
 16458     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16459        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16460           MOVE ER-2724          TO WS-ERROR
 16461           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16462
 16463     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16464         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16465             (1 + WS-LF-REFUND-OVS-PCT)
 16466     ELSE
 16467         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16468
 16469     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16470         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16471             (1 - WS-TOL-LF-REFUND-PCT)
 16472     ELSE
 16473         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16474
 16475     IF (PB-COMPANY-ID = 'DCC')
 16476        AND (PB-CI-ENTRY-STATUS = 'M')
 16477        AND (PB-C-LF-CANCEL-AMT > +0)
 16478        MOVE ER-3843             TO WS-ERROR
 16479        PERFORM 9900-ERROR-FORMAT
 16480                                 THRU 9900-EXIT
 16481     END-IF
 16482     EVALUATE TRUE
 16483        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16484           CONTINUE
 16485        WHEN PB-C-LF-CANCEL-AMT = +0
 16486                 AND PB-C-LF-REF-CALC > +0
 16487           CONTINUE
 16488        WHEN WS-LF-REFUND-OVS-AMT = 0
 16489                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 298
* EL050.cbl
 16490           CONTINUE
 16491        WHEN OTHER
 16492           IF WS-TOL-LF-REFUND  = +0
 16493              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16494           END-IF
 16495           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16496                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16497                          (PB-C-LF-CANCEL-AMT))
 16498              CONTINUE
 16499           ELSE
 16500              IF WS-LF-REFUND-OVS-AMT = +0
 16501                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16502              END-IF
 16503              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16504                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16505                                       PB-C-LF-CANCEL-AMT)
 16506                 CONTINUE
 16507              ELSE
 16508                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16509                   MOVE ER-2754   TO  WS-ERROR
 16510                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16511                 ELSE
 16512                    MOVE ER-2736   TO  WS-ERROR
 16513                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16514                 END-IF
 16515              END-IF
 16516           END-IF
 16517     END-EVALUATE.
 16518
 16519     EVALUATE TRUE
 16520        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16521           CONTINUE
 16522        WHEN PB-C-LF-CANCEL-AMT = +0
 16523                 AND PB-C-LF-REF-CALC > +0
 16524           CONTINUE
 16525        WHEN OTHER
 16526           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16527               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16528              CONTINUE
 16529           ELSE
 16530              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16531               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16532                CONTINUE
 16533              ELSE
 16534                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16535                     MOVE ER-2754   TO  WS-ERROR
 16536                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16537                 ELSE
 16538                     MOVE ER-2736   TO  WS-ERROR
 16539                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16540                 END-IF
 16541              END-IF
 16542           END-IF
 16543     END-EVALUATE.
 16544
 16545     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16546         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16547             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 299
* EL050.cbl
 16548     ELSE
 16549         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16550
 16551     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16552         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16553             (1 - WS-TOL-AH-REFUND-PCT)
 16554     ELSE
 16555         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16556
 16557     IF (PB-COMPANY-ID = 'DCC')
 16558        AND (PB-CI-ENTRY-STATUS = 'M')
 16559        AND (PB-C-AH-CANCEL-AMT > +0)
 16560        MOVE ER-3843             TO WS-ERROR
 16561        PERFORM 9900-ERROR-FORMAT
 16562                                 THRU 9900-EXIT
 16563     END-IF
 16564     EVALUATE TRUE
 16565        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16566           CONTINUE
 16567*       WHEN PB-C-AH-REF-CALC = +0 AND
 16568*                  PB-C-AH-CANCEL-AMT > +0
 16569        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16570                   PB-C-AH-REF-CALC > +0
 16571           CONTINUE
 16572        WHEN WS-AH-REFUND-OVS-AMT = +0
 16573                AND WS-TOL-AH-REFUND = +0
 16574           CONTINUE
 16575        WHEN OTHER
 16576           IF WS-TOL-AH-REFUND = +0
 16577              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16578           END-IF
 16579           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16580               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16581                                         PB-C-AH-CANCEL-AMT)
 16582              CONTINUE
 16583           ELSE
 16584              IF WS-AH-REFUND-OVS-AMT = +0
 16585                 MOVE +9999999.99 TO
 16586                         WS-AH-REFUND-OVS-AMT
 16587              END-IF
 16588              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16589                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16590                                         PB-C-AH-CANCEL-AMT)
 16591                 CONTINUE
 16592              ELSE
 16593                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16594                    MOVE ER-2754   TO  WS-ERROR
 16595                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16596                 ELSE
 16597                    MOVE ER-2736   TO  WS-ERROR
 16598                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16599                 END-IF
 16600              END-IF
 16601           END-IF
 16602     END-EVALUATE.
 16603
 16604     EVALUATE TRUE
 16605        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 300
* EL050.cbl
 16606           CONTINUE
 16607*       WHEN PB-C-AH-REF-CALC > +0 AND
 16608*                  PB-C-AH-CANCEL-AMT = +0
 16609        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16610                   PB-C-AH-REF-CALC = +0
 16611           CONTINUE
 16612        WHEN OTHER
 16613           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16614               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16615              CONTINUE
 16616           ELSE
 16617              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16618                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16619                 CONTINUE
 16620              ELSE
 16621                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16622                     MOVE ER-2754   TO  WS-ERROR
 16623                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16624                 ELSE
 16625                     MOVE ER-2736   TO  WS-ERROR
 16626                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16627                 END-IF
 16628              END-IF
 16629           END-IF
 16630     END-EVALUATE.
 16631
 16632     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16633        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16634        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16635           AND  PB-C-LF-REF-CALC < +1.00
 16636           AND  PB-C-AH-REF-CALC < +1.00
 16637           CONTINUE
 16638        ELSE
 16639           IF (PB-COMPANY-ID = 'DCC')
 16640              AND (PB-CI-ENTRY-STATUS = 'M')
 16641              CONTINUE
 16642           ELSE
 16643              MOVE ER-2741       TO WS-ERROR
 16644              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16645           END-IF
 16646        END-IF
 16647     END-IF
 16648
 16649     IF (PB-C-LF-CANCEL-AMT = ZERO
 16650        AND WS-LF-BENEFIT-CD NOT = ZERO
 16651        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16652        AND PB-C-LF-REF-CALC NOT = ZERO)
 16653        OR
 16654        (PB-C-LF-CANCEL-AMT = ZERO
 16655        AND WS-LF-BENEFIT-CD NOT = ZERO
 16656        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16657             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16658                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16659                NEXT SENTENCE
 16660             ELSE
 16661                MOVE ER-2739        TO WS-ERROR
 16662                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16663
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 301
* EL050.cbl
 16664     IF (PB-C-AH-CANCEL-AMT = ZERO
 16665        AND WS-AH-BENEFIT-CD NOT = ZERO
 16666        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16667        AND PB-C-AH-REF-CALC NOT = ZERO)
 16668        OR
 16669        (PB-C-AH-CANCEL-AMT = ZERO
 16670        AND WS-AH-BENEFIT-CD NOT = ZERO
 16671        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16672             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16673                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16674                NEXT SENTENCE
 16675             ELSE
 16676                MOVE ER-2738        TO WS-ERROR
 16677                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16678
 16679 3775-OVER-REF-CHK.
 16680
 16681     IF PB-CI-ENTRY-STATUS = '5'
 16682        GO TO 3780-UPDATE-CANCEL-CERT.
 16683
 16684     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 16685                              PB-CI-LF-ALT-PREMIUM-AMT.
 16686
 16687     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16688        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16689                                 PB-C-LF-REF-CALC
 16690      ELSE
 16691        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16692                                 PB-C-LF-CANCEL-AMT.
 16693
 16694     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 16695        MOVE ER-2755             TO WS-ERROR
 16696        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16697
 16698     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 16699
 16700     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 16701        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16702                                 PB-C-AH-REF-CALC
 16703      ELSE
 16704        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16705                                 PB-C-AH-CANCEL-AMT.
 16706
 16707     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 16708        MOVE ER-2778             TO WS-ERROR
 16709        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16710
 16711     IF PB-CI-OB-FLAG NOT = 'Z'
 16712        NEXT SENTENCE
 16713       ELSE
 16714         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16715            MOVE ER-2757           TO WS-ERROR
 16716            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16717
 16718 3780-UPDATE-CANCEL-CERT.
 16719
 16720     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 16721        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 302
* EL050.cbl
 16722        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16723
 16724     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 16725         MOVE ER-2729              TO WS-ERROR
 16726         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16727
 16728     IF PB-CI-LF-BENEFIT-CD = ZERO
 16729         GO TO 3780-UPDATE-CONT-1.
 16730
 16731     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 16732         GO TO 3780-UPDATE-CONT-1.
 16733
 16734     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16735       AND
 16736        (PB-C-LF-CANCEL-AMT NEGATIVE)
 16737       AND
 16738        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 16739       AND
 16740        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16741            NEXT SENTENCE
 16742       ELSE
 16743        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16744          AND
 16745***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16746***       AND
 16747           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 16748            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16749               MOVE ER-2730      TO WS-ERROR
 16750               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16751               GO TO 3999-END-EDIT
 16752            ELSE
 16753               GO TO 3999-END-EDIT
 16754        ELSE
 16755            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 16756               MOVE ER-2765           TO WS-ERROR
 16757               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16758               GO TO 3785-CHECK-NH.
 16759*              GO TO 3999-END-EDIT.
 16760
 16761 3780-UPDATE-CONT-1.
 16762     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 16763
 16764     IF PB-CI-AH-BENEFIT-CD = ZERO
 16765         GO TO 3780-UPDATE-CONT-2.
 16766
 16767     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 16768         GO TO 3780-UPDATE-CONT-2.
 16769
 16770     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 16771
 16772     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16773       AND
 16774        (PB-C-AH-CANCEL-AMT NEGATIVE)
 16775       AND
 16776        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 16777       AND
 16778        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 16779            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 303
* EL050.cbl
 16780       ELSE
 16781        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16782          AND
 16783***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16784***       AND
 16785           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 16786           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 16787            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16788               MOVE ER-2773      TO WS-ERROR
 16789               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16790               GO TO 3999-END-EDIT
 16791            ELSE
 16792               GO TO 3999-END-EDIT
 16793            END-IF
 16794           ELSE
 16795             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16796                MOVE ER-2890 TO WS-ERROR
 16797                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16798                GO TO 3999-END-EDIT
 16799             ELSE
 16800                GO TO 3785-CHECK-NH
 16801             END-IF
 16802           END-IF
 16803          ELSE
 16804            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 16805              IF WS-AH-CLAIM-RESCINDED = 'Y'
 16806                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16807                   MOVE ER-2890 TO WS-ERROR
 16808                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16809                   GO TO 3999-END-EDIT
 16810                ELSE
 16811                   MOVE ER-2765 TO WS-ERROR
 16812                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16813                   GO TO 3785-CHECK-NH
 16814                END-IF
 16815              ELSE
 16816               MOVE ER-2765      TO WS-ERROR
 16817               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16818               GO TO 3785-CHECK-NH.
 16819*              GO TO 3999-END-EDIT.
 16820
 16821 3780-UPDATE-CONT-2.
 16822
 16823     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 16824        AND WS-LF-BENEFIT-CD = ZERO
 16825           MOVE ER-2743           TO WS-ERROR
 16826           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16827
 16828     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 16829        AND WS-AH-BENEFIT-CD = ZERO
 16830           MOVE ER-2744           TO WS-ERROR
 16831           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16832
 16833     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 16834        (PB-C-AH-CANCEL-AMT NEGATIVE))
 16835        AND
 16836        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 16837         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 304
* EL050.cbl
 16838           MOVE ER-2746           TO WS-ERROR
 16839           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16840
 16841     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16842       AND
 16843        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 16844             MOVE ER-2737        TO WS-ERROR
 16845             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16846
 16847     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16848       AND
 16849        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 16850             MOVE ER-2737        TO WS-ERROR
 16851             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16852
 16853     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 16854         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 16855             OR 'CID' OR 'DCC' OR 'AHL'
 16856             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 16857         ELSE
 16858             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 16859                 MOVE ER-2768    TO WS-ERROR
 16860                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16861             ELSE
 16862                 MOVE ER-2756    TO WS-ERROR
 16863                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16864
 16865     IF CERT-PEND-ISSUE-RETURNED
 16866        MOVE ER-2772             TO WS-ERROR
 16867        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16868 3785-CHECK-NH.
 16869     IF PB-STATE NOT = 'NH'
 16870        GO TO 3999-END-EDIT
 16871     END-IF
 16872
 16873     MOVE ER-2796                TO WS-ERROR
 16874     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 16875     IF (PB-C-REF-INTERFACE-SW = 'Y')
 16876        OR (CM-NH-INTERFACE-SW = 'Y')
 16877        MOVE ER-2793             TO WS-ERROR
 16878        PERFORM 9900-ERROR-FORMAT
 16879                                 THRU 9900-EXIT
 16880     END-IF
 16881     MOVE +0                     TO WS-PAYMENT-AMT
 16882     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 16883        GO TO 3999-END-EDIT
 16884     END-IF
 16885     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 16886        GO TO 3999-END-EDIT
 16887     END-IF
 16888     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16889     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 16890     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 16891        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 16892     END-IF
 16893     MOVE '1'                    TO DC-OPTION-CODE
 16894     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16895     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 305
* EL050.cbl
 16896        IF DC-ELAPSED-DAYS < +16
 16897           GO TO 3999-END-EDIT
 16898        END-IF
 16899     END-IF
 16900     MOVE +0                     TO DC-ELAPSED-DAYS
 16901     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 16902     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 16903     MOVE '1'                    TO DC-OPTION-CODE
 16904     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16905     IF NO-CONVERSION-ERROR
 16906        IF DC-ELAPSED-DAYS > +30
 16907           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 16908        ELSE
 16909           GO TO 3999-END-EDIT
 16910        END-IF
 16911     ELSE
 16912        GO TO 3999-END-EDIT
 16913     END-IF
 16914     COMPUTE WS-PAYMENT-AMT ROUNDED =
 16915        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 16916           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 16917     IF WS-PAYMENT-AMT < 600.00
 16918        GO TO 3999-END-EDIT
 16919     END-IF
 16920     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 16921
 16922     IF (ERMAIL-FOUND = ' ')
 16923         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 16924         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 16925        GO TO 3999-END-EDIT
 16926     END-IF
 16927     MOVE ER-2795                TO WS-ERROR
 16928     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 16929
 16930     GO TO 3999-END-EDIT.
 16931******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 306
* EL050.cbl
 16933 3990-FILES-NOT-OPEN.
 16934
 16935     MOVE ER-2617                TO WS-ERROR.
 16936     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16937     GO TO 9990-RETURN.
 16938
 16939 3999-END-EDIT.
 16940
 16941     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 16942
 16943     IF PB-CANCELLATION AND CERT-WAS-FOUND
 16944         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 16945         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16946             PERFORM 9250-UNLOCK-RETURN
 16947             GO TO 9990-RETURN
 16948          ELSE
 16949             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16950             GO TO 9990-RETURN.
 16951
 16952     IF PB-CANCELLATION
 16953          GO TO 9990-RETURN.
 16954
 16955     IF CERT-WAS-NOT-FOUND
 16956        MOVE SPACES              TO CERTIFICATE-MASTER.
 16957
 16958     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 16959
 16960     IF CERT-WAS-FOUND
 16961         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16962             PERFORM 9250-UNLOCK-RETURN
 16963          ELSE
 16964            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16965      ELSE
 16966         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 16967
 16968     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 16969        IF PB-COMPANY-ID = 'DCC' AND
 16970           (PB-CARRIER = '2' OR '4' OR '6')
 16971              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 16972        END-IF
 16973     END-IF.
 16974
 16975     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 16976         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 16977     END-IF.
 16978
 16979     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 16980     IF ((PB-COMPANY-ID = 'DCC')
 16981        AND (WS-NO-SECURE-PAY))
 16982                  OR
 16983        (WS-LF-SPECIAL-CALC-CD = 'O'
 16984        OR WS-AH-SPECIAL-CALC-CD = 'O')
 16985        SET SKIP-ADDR-EDIT       TO TRUE
 16986     END-IF
 16987     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 16988        AND (NOT SKIP-ADDR-EDIT)
 16989        MOVE ER-2963             TO WS-ERROR
 16990        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 307
* EL050.cbl
 16991                                 THRU 9900-EXIT
 16992        GO TO 9990-RETURN
 16993     END-IF
 16994     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 16995     IF ERPNDM-FOUND NOT = 'X'
 16996        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 16997           OR (PM-CITY        = SPACES OR LOW-VALUES)
 16998           OR (PM-STATE       = SPACES OR LOW-VALUES)
 16999           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 17000           AND (NOT SKIP-ADDR-EDIT)
 17001           MOVE ER-2694          TO WS-ERROR
 17002           PERFORM 9900-ERROR-FORMAT
 17003                                 THRU 9900-EXIT
 17004        END-IF
 17005        MOVE ' '                 TO STATE-RECORD-ERROR
 17006        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17007        MOVE PM-STATE            TO CNTL-ACCESS
 17008        MOVE '3'                 TO CNTL-REC-TYPE
 17009        MOVE +0                  TO CNTL-SEQ-NO
 17010        MOVE '0'                 TO RC-SW-2
 17011        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17012        IF (NO-STATE-RECORD)
 17013           OR (CF-RECORD-TYPE NOT = '3')
 17014           OR (PM-STATE NOT = CF-STATE-CODE)
 17015           IF (PM-STATE = SPACES)
 17016              AND (SKIP-ADDR-EDIT)
 17017              CONTINUE
 17018           ELSE
 17019              MOVE ER-2963       TO WS-ERROR
 17020              PERFORM 9900-ERROR-FORMAT
 17021                                 THRU 9900-EXIT
 17022           END-IF
 17023        END-IF
 17024        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 17025           MOVE ER-2883          TO WS-ERROR
 17026           PERFORM 9900-ERROR-FORMAT
 17027                                 THRU 9900-EXIT
 17028        END-IF
 17029        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 17030           MOVE ' '                 TO STATE-RECORD-ERROR
 17031           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17032           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 17033           MOVE '3'                 TO CNTL-REC-TYPE
 17034           MOVE +0                  TO CNTL-SEQ-NO
 17035           MOVE '0'                 TO RC-SW-2
 17036           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17037           IF NO-STATE-RECORD
 17038              OR (CF-RECORD-TYPE NOT = '3')
 17039              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 17040              MOVE ER-2964          TO WS-ERROR
 17041              PERFORM 9900-ERROR-FORMAT
 17042                                    THRU 9900-EXIT
 17043           END-IF
 17044        END-IF
 17045     ELSE
 17046        IF NOT SKIP-ADDR-EDIT
 17047           MOVE ER-2393          TO WS-ERROR
 17048           PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 308
* EL050.cbl
 17049                                 THRU 9900-EXIT
 17050        END-IF
 17051     END-IF
 17052
 17053     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17054
 17055     IF (ERMAIL-FOUND = ' ' AND
 17056        ERPNDM-FOUND = ' ')
 17057        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 17058           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 17059           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 17060          OR
 17061           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 17062          OR
 17063           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 17064           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 17065           GO TO 3999-UNLOCK-ERMAIL.
 17066
 17067     IF ERPNDM-FOUND = 'X'
 17068        GO TO 3999-UNLOCK-ERMAIL.
 17069
 17070     IF PM-INSURED-LAST-NAME      = SPACES
 17071        AND PM-INSURED-FIRST-NAME = SPACES
 17072        AND PM-ADDRESS-LINE-1     = SPACES
 17073        AND PM-ADDRESS-LINE-2     = SPACES
 17074        AND PM-CITY-STATE         = SPACES
 17075        AND PM-CRED-BENE-NAME     = SPACES
 17076        AND PM-CRED-BENE-ADDR     = SPACES
 17077        AND PM-CRED-BENE-CTYST    = SPACES
 17078        GO TO 3999-UNLOCK-ERMAIL
 17079     END-IF
 17080
 17081     MOVE SPACES                 TO MAILING-DATA.
 17082
 17083     MOVE 'MA'                   TO MA-RECORD-ID.
 17084     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 17085     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 17086     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 17087     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 17088     MOVE PB-SV-STATE            TO MA-STATE.
 17089     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 17090     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 17091
 17092     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 17093     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 17094
 17095     IF ERMAIL-FOUND = ' '
 17096        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 17097     ELSE
 17098        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 17099        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 17100        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 17101
 17102     GO TO 9990-RETURN.
 17103
 17104 3999-UNLOCK-ERMAIL.
 17105     IF ERMAIL-FOUND = ' '
 17106        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 309
* EL050.cbl
 17107
 17108     GO TO 9990-RETURN.
 17109******************************************************************
 17110
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 310
* EL050.cbl
 17112 4000-UPDATE-CANCELLED-CERT.
 17113     IF CERT-WAS-NOT-FOUND
 17114        GO TO 4299-EXIT.
 17115
 17116*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 17117     IF PB-C-NH-INT-ON-REFS > ZEROS
 17118        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 17119     END-IF
 17120     IF PB-C-REF-INTERFACE-SW = 'Y'
 17121        MOVE PB-C-REF-INTERFACE-SW
 17122                                 TO CM-NH-INTERFACE-SW
 17123     END-IF
 17124     IF PB-C-POST-CARD-IND = 'Y'
 17125        MOVE +8                  TO SUB
 17126        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17127        IF ERMAIL-FOUND = ' '
 17128           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 17129              (SUB > +7)
 17130              OR (MA-MAIL-STATUS (SUB) = '1')
 17131           END-PERFORM
 17132        END-IF
 17133        IF (SUB > +7)
 17134           OR (ERMAIL-FOUND = 'X')
 17135           MOVE ER-3789          TO WS-ERROR
 17136           PERFORM 9900-ERROR-FORMAT
 17137                                 THRU 9900-EXIT
 17138        END-IF
 17139     ELSE
 17140        MOVE 'N'                 TO PB-C-POST-CARD-IND
 17141     END-IF
 17142     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 17143
 17144     IF PB-CI-OB-FLAG = 'Z'
 17145        GO TO 4150-SUMMARY-CERT-CANCEL.
 17146
 17147     IF PB-C-LF-CANCEL-VOIDED
 17148         PERFORM 4200-REVERSE-LF-CANCEL.
 17149     IF PB-C-AH-CANCEL-VOIDED
 17150         PERFORM 4200-REVERSE-AH-CANCEL.
 17151
 17152 4100-APPLY-LF-CANCEL.
 17153
 17154     MOVE +0                     TO WS-SUB.
 17155
 17156 4100-CHECK-LF-ERRORS.
 17157
 17158     ADD +1                       TO WS-SUB.
 17159
 17160     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17161        IF LF-COVERAGE-CANCELLED
 17162           GO TO 4100-LF-CANCEL-CONT
 17163        ELSE
 17164           GO TO 4100-UPDATE-LF-COVERAGE.
 17165
 17166     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17167                                   ER-2729 OR
 17168                                   ER-2730 OR
 17169                                   ER-2731 OR
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 311
* EL050.cbl
 17170                                   ER-2732 OR
 17171                                   ER-2737 OR
 17172                                   ER-2740 OR
 17173                                   ER-2743 OR
 17174                                   ER-2749 OR
 17175                                   ER-2750 OR
 17176                                   ER-2755 OR
 17177                                   ER-2757 OR
 17178                                   ER-2760 OR
 17179                                   ER-2772 OR
 17180                                   ER-2774 OR
 17181                                   ER-2776 OR
 17182                                   ER-2794
 17183        GO TO 4100-UPDATE-LF-COVERAGE.
 17184
 17185     GO TO 4100-CHECK-LF-ERRORS.
 17186
 17187 4100-UPDATE-LF-COVERAGE.
 17188
 17189     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 17190     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 17191     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 17192        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 17193     END-IF
 17194     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17195                                      TO CM-CREDIT-INTERFACE-SW-2.
 17196     IF CM-LF-CANCEL-DT = LOW-VALUE
 17197         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 17198
 17199     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 17200         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 17201                                         CM-LF-STATUS-AT-CANCEL.
 17202
 17203     GO TO 4100-APPLY-AH-CANCEL.
 17204
 17205 4100-LF-CANCEL-CONT.
 17206     IF PB-C-LF-CANCEL-VOIDED
 17207         GO TO 4100-APPLY-AH-CANCEL.
 17208
 17209     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17210         GO TO 4100-APPLY-AH-CANCEL.
 17211
 17212     IF PB-C-LF-CANCEL-AMT GREATER ZERO
 17213        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17214           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 17215        ELSE
 17216           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 17217
 17218     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 17219     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 17220
 17221     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 17222         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 17223
 17224     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 17225        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 17226         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 17227         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 312
* EL050.cbl
 17228
 17229     IF PB-RECORD-RETURNED
 17230        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17231      ELSE
 17232        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 17233
 17234 4100-APPLY-AH-CANCEL.
 17235
 17236     MOVE +0                      TO WS-SUB.
 17237
 17238 4100-CHECK-AH-ERRORS.
 17239
 17240     ADD +1                       TO WS-SUB.
 17241
 17242     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17243        IF AH-COVERAGE-CANCELLED
 17244           GO TO 4100-AH-CANCEL-CONT
 17245        ELSE
 17246           GO TO 4100-UPDATE-AH-COVERAGE.
 17247
 17248     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17249                                   ER-2729 OR
 17250                                   ER-2732 OR
 17251                                   ER-2737 OR
 17252                                   ER-2740 OR
 17253                                   ER-2744 OR
 17254                                   ER-2749 OR
 17255                                   ER-2750 OR
 17256                                   ER-2755 OR
 17257                                   ER-2757 OR
 17258                                   ER-2760 OR
 17259                                   ER-2771 OR
 17260                                   ER-2772 OR
 17261                                   ER-2773 OR
 17262                                   ER-2775 OR
 17263                                   ER-2777 OR
 17264                                   ER-2794
 17265        GO TO 4100-UPDATE-AH-COVERAGE.
 17266
 17267     GO TO 4100-CHECK-AH-ERRORS.
 17268
 17269 4100-UPDATE-AH-COVERAGE.
 17270
 17271     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 17272     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 17273     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 17274     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17275                                      TO CM-CREDIT-INTERFACE-SW-2.
 17276     IF CM-AH-CANCEL-DT = LOW-VALUE
 17277         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 17278
 17279     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 17280         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 17281                                         CM-AH-STATUS-AT-CANCEL.
 17282
 17283     IF LF-COVERAGE-CANCELLED
 17284         IF PB-RECORD-RETURNED
 17285              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 313
* EL050.cbl
 17286          ELSE
 17287              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 17288
 17289     GO TO 4299-EXIT.
 17290
 17291 4100-AH-CANCEL-CONT.
 17292     IF PB-C-AH-CANCEL-VOIDED
 17293         GO TO 4299-EXIT.
 17294
 17295     if cm-credit-interface-sw-2 = ' '
 17296        if pb-fatal-errors or pb-unforced-errors
 17297           move '4'              to cm-credit-interface-sw-2
 17298        else
 17299           move '1'              to cm-credit-interface-sw-2
 17300        end-if
 17301     end-if
 17302     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17303         GO TO 4299-EXIT.
 17304
 17305     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 17306        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17307           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 17308        ELSE
 17309           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 17310
 17311     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 17312     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 17313
 17314     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 17315         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 17316
 17317     IF CM-AH-STATUS-AT-CANCEL = SPACE
 17318         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 17319         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 17320
 17321     IF PB-RECORD-RETURNED
 17322        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 17323      ELSE
 17324        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 17325
 17326     GO TO 4299-EXIT.
 17327
 17328 4150-SUMMARY-CERT-CANCEL.
 17329     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 17330
 17331     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17332        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17333                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 17334     ELSE
 17335        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17336                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 17337
 17338     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17339        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17340                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 17341     ELSE
 17342        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17343                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 314
* EL050.cbl
 17344
 17345     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17346        NEXT SENTENCE
 17347     ELSE
 17348        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 17349
 17350     GO TO 4299-EXIT.
 17351
 17352 4200-REVERSE-LF-CANCEL.
 17353     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 17354
 17355     IF CM-LF-CANCEL-APPLIED
 17356        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 17357        MOVE SPACES                TO CM-LF-EXIT-BATCH
 17358        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 17359
 17360     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 17361
 17362     IF PB-RECORD-RETURNED
 17363        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17364       ELSE
 17365        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17366
 17367 4200-REVERSE-LF-EXIT.
 17368       EXIT.
 17369
 17370 4200-REVERSE-AH-CANCEL.
 17371     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17372
 17373     IF CM-AH-CANCEL-APPLIED
 17374        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17375        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17376        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17377
 17378     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17379
 17380     IF PB-RECORD-RETURNED
 17381        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17382       ELSE
 17383        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17384
 17385 4200-REVERSE-AH-EXIT.
 17386       EXIT.
 17387
 17388 4299-EXIT.
 17389       EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 315
* EL050.cbl
 17391
 17392 4500-UPDATE-NEW-CERT.
 17393     IF CERT-WAS-FOUND
 17394         NEXT SENTENCE
 17395       ELSE
 17396         GO TO 4520-BUILD-NEW-KEY.
 17397
 17398     IF  CLASIC-CREATED-CERT
 17399         GO TO 4999-EXIT.
 17400
 17401     IF  CERT-WAS-CREATED-FOR-CLAIM
 17402         GO TO 4520-BUILD-NEW-KEY.
 17403
 17404     IF CERT-ADDED-BATCH
 17405        IF CM-RECORD-ID = 'CM'
 17406            GO TO 4999-EXIT.
 17407
 17408 4520-BUILD-NEW-KEY.
 17409* BUILD CONTROL PRIMARY
 17410
 17411     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17412                                       CM-COMPANY-CD-A1
 17413                                       CM-COMPANY-CD-A2
 17414                                       CM-COMPANY-CD-A4
 17415                                       CM-COMPANY-CD-A5.
 17416
 17417     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17418     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17419     MOVE PB-SV-STATE               TO CM-STATE.
 17420     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17421     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17422     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17423     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17424
 17425     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17426
 17427     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17428     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17429     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17430     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17431
 17432     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17433        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17434
 17435     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17436         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17437         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17438         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17439         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17440     ELSE
 17441         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17442
 17443     IF PB-COMPANY-ID   EQUAL  'CRI'
 17444         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17445         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17446         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17447         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17448         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 316
* EL050.cbl
 17449
 17450     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17451        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17452         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17453
 17454     IF PB-COMPANY-ID  = 'LBL'
 17455        IF PB-I-JOINT-COVERAGE
 17456            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17457                                           PB-I-MEMBER-NO
 17458            GO TO 4550-CONT-CERT-PROCESS.
 17459
 17460     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17461        NEXT SENTENCE
 17462     ELSE
 17463        GO TO 4540-BUILD-MEMBER-NO.
 17464
 17465******************************************************************
 17466*                                                                *
 17467*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17468*    FOR 'MON'.                                                  *
 17469*                                                                *
 17470******************************************************************
 17471
 17472     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17473     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17474     MOVE +1                     TO WS-SUB1
 17475                                    WS-SUB2.
 17476
 17477 4530-EDIT-MEMB-NAME.
 17478
 17479     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17480        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17481        ADD +1                       TO WS-SUB2.
 17482
 17483     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17484        ADD +1                       TO WS-SUB1
 17485        GO TO 4530-EDIT-MEMB-NAME.
 17486
 17487     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17488     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17489     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17490*    MOVE SPACE                      TO DC-OPTION-CODE.
 17491     SET  BIN-TO-GREG                TO TRUE.
 17492     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17493     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17494
 17495     GO TO 4550-CONT-CERT-PROCESS.
 17496
 17497******************************************************************
 17498*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17499******************************************************************
 17500
 17501 4540-BUILD-MEMBER-NO.
 17502
 17503     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17504         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17505         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17506         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 317
* EL050.cbl
 17507         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17508     ELSE
 17509         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17510
 17511     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17512        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17513         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17514
 17515 4550-CONT-CERT-PROCESS.
 17516
 17517*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17518*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17519*    ELSE
 17520*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17521
 17522     IF CERT-WAS-CREATED-FOR-CLAIM
 17523        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17524        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17525
 17526     IF CERT-AND-CLAIM-ONLINE
 17527        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17528        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17529
 17530     MOVE 'CM'                     TO CM-RECORD-ID.
 17531     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17532
 17533     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17534        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17535        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17536     ELSE
 17537        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17538        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17539
 17540     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17541     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17542     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17543     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17544     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 17545     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 17546     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 17547                                      CM-LF-ITD-CANCEL-AMT
 17548                                      CM-LF-ITD-DEATH-AMT
 17549                                      CM-AH-ITD-AH-PMT
 17550                                      CM-AH-ITD-LUMP-PMT
 17551                                      CM-AH-ITD-CANCEL-AMT
 17552                                      CM-LF-NSP-PREMIUM-AMT
 17553                                      CM-AH-NSP-PREMIUM-AMT.
 17554*                                     CM-CLAIM-DEDUCT-WITHHELD
 17555*                                     CM-CANCEL-DEDUCT-WITHHELD.
 17556     if pb-i-loan-apr = +99.9999
 17557        move zeros                 to cm-loan-apr
 17558     else
 17559        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 17560     end-if
 17561     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 17562     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 17563     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 17564     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 318
* EL050.cbl
 17565     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 17566     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 17567     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 17568     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 17569     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 17570     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 17571     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 17572
 17573     IF PB-I-LIVES NOT NUMERIC
 17574         MOVE ZERO                 TO PB-I-LIVES.
 17575
 17576     IF PB-I-NUM-BILLED NOT NUMERIC
 17577         MOVE ZERO                 TO PB-I-NUM-BILLED.
 17578
 17579     MOVE PB-I-LIVES               TO CM-LIVES.
 17580     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 17581
 17582     IF PB-COMPANY-ID EQUAL  'DMD'
 17583         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 17584         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 17585
 17586     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 17587     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 17588     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 17589     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 17590     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 17591     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 17592
 17593     IF PB-I-LF-POLICY-FEE NUMERIC
 17594        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 17595     ELSE
 17596        MOVE +0                    TO CM-LF-POLICY-FEE.
 17597
 17598     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17599        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 17600        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 17601     ELSE
 17602        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 17603
 17604     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 17605     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 17606     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 17607     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 17608     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 17609     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 17610     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 17611     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 17612     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 17613
 17614     IF PB-I-AH-POLICY-FEE NUMERIC
 17615        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE
 17616     ELSE
 17617        MOVE +0                    TO CM-AH-POLICY-FEE.
 17618
 17619     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17620        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 17621     ELSE
 17622        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 319
* EL050.cbl
 17623
 17624     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 17625     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 17626
 17627     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 17628                                      CM-LF-DEATH-EXIT-DT
 17629                                      CM-AH-SETTLEMENT-EXIT-DT.
 17630
 17631*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 17632*                       'TIH' OR 'OFL' OR 'FLA' OR
 17633*                       'TII' OR 'TMS' OR 'CRI' OR
 17634*                       'NCL'
 17635     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 17636
 17637     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 17638         IF WS-LF-SPECIAL-CALC-CD = 'O'
 17639            MOVE '2'                TO CM-PREMIUM-TYPE.
 17640
 17641     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 17642         IF WS-AH-SPECIAL-CALC-CD = 'O'
 17643            MOVE '2'                TO CM-PREMIUM-TYPE.
 17644
 17645     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 17646         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 17647     ELSE
 17648         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 17649         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 17650
 17651     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 17652     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 17653     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 17654     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 17655     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 17656     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 17657     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 17658     MOVE SPACE                     TO CM-PAYMENT-MODE.
 17659
 17660     IF PB-NO-MONTHS-SKIPPED
 17661         MOVE SPACE                 TO CM-SKIP-CODE
 17662     ELSE
 17663         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 17664
 17665     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 17666     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 17667                                       CM-LF-STATUS-AT-CANCEL.
 17668
 17669     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 17670     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 17671                                       CM-AH-STATUS-AT-CANCEL.
 17672
 17673     MOVE '1'                       TO CM-ENTRY-STATUS.
 17674
 17675     IF PB-REISSUED-CERT
 17676        MOVE '5'                    TO CM-ENTRY-STATUS.
 17677
 17678     IF PB-MONTHLY-CERT
 17679        MOVE 'M'                    TO CM-ENTRY-STATUS.
 17680
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 320
* EL050.cbl
 17681     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 17682     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 17683     IF PB-POLICY-IS-DECLINED
 17684        MOVE 'D'                    TO CM-ENTRY-STATUS.
 17685
 17686     IF PB-POLICY-IS-VOIDED
 17687        MOVE 'V'                    TO CM-ENTRY-STATUS.
 17688
 17689     IF PB-NEEDS-UNDERWRITING
 17690        MOVE 'U'                    TO CM-ENTRY-STATUS.
 17691
 17692     IF PB-REIN-ONLY-CERT
 17693        MOVE '9'                    TO CM-ENTRY-STATUS.
 17694
 17695     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 17696         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 17697     ELSE
 17698         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 17699
 17700     IF PB-RECORD-RETURNED
 17701        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 17702      ELSE
 17703        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 17704
 17705     IF PB-I-MAIL-ADDRS-PRESENT
 17706        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 17707
 17708     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 17709                                       CM-ENTRY-DT.
 17710
 17711 4999-EXIT.
 17712     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 321
* EL050.cbl
 17714
 17715 5000-PROCESS-REPS.
 17716     MOVE ' '                    TO AGTC-MASTER-SW
 17717     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 17718     MOVE CO-TYPE                TO AGTC-TYPE
 17719     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 17720     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 17721     IF (AGTC-MASTER-SW NOT = 'N')
 17722        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 17723        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 17724        PERFORM 8583-READ-ERAGTC-NEXT
 17725                                 THRU 8583-EXIT
 17726     END-IF
 17727     IF AGTC-MASTER-SW = 'N'
 17728        CONTINUE
 17729     ELSE
 17730        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 17731           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 17732              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 17733              MOVE 'Y'           TO AGTC-MASTER-SW
 17734           END-IF
 17735        END-IF
 17736     END-IF
 17737     .
 17738 5000-EXIT.
 17739     EXIT.
 17740 6370-EDIT-INPUT-LF-CODE.
 17741     move ' ' to ws-benefit-cd-chg-sw
 17742     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 17743        MOVE +1                  TO SUB
 17744        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 17745        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17746        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17747        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17748        GO TO 6370-SEARCH-LOOP.
 17749
 17750     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17751
 17752     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17753     MOVE SPACES                 TO CNTL-ACCESS.
 17754*    MOVE 'L'                    TO CNTL-REC-TYPE.
 17755     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 17756     MOVE +0                     TO CNTL-SEQ-NO.
 17757     MOVE '4' TO RC-SW-2.
 17758     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17759
 17760     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17761        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17762        GO TO 6370-NO-LF-FOUND.
 17763
 17764     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 17765     MOVE +1                     TO SUB.
 17766
 17767 6370-SEARCH-LOOP.
 17768     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 17769         GO TO 6370-NO-LF-FOUND.
 17770
 17771     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 322
* EL050.cbl
 17772        if (pb-i-lf-benefit-cd not = zeros and spaces)
 17773           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 17774           set benefit-code-chg to true
 17775        end-if
 17776        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 17777        GO TO 6370-HER-NET-PAY-CHECK.
 17778
 17779     ADD 1   TO SUB.
 17780*    IF SUB GREATER 120
 17781     IF SUB GREATER 200
 17782         GO TO 6370-NO-LF-FOUND.
 17783
 17784     GO TO 6370-SEARCH-LOOP.
 17785
 17786 6370-NO-LF-FOUND.
 17787
 17788     if (pb-i-lf-benefit-cd not = zeros and spaces)
 17789        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 17790        set benefit-code-chg to true
 17791     end-if
 17792     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 17793
 17794 6370-HER-NET-PAY-CHECK.
 17795
 17796     IF PB-COMPANY-ID = 'CID'
 17797        IF PB-SV-STATE = 'CA' OR 'MN'
 17798           IF PB-I-LF-BENEFIT-CD = '02'
 17799              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 17800           ELSE
 17801              IF PB-I-LF-BENEFIT-CD = '04'
 17802                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 17803              END-IF
 17804           END-IF
 17805        END-IF
 17806     END-IF
 17807
 17808     IF PB-COMPANY-ID NOT = 'HER'
 17809         GO TO 6370-EXIT.
 17810
 17811     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 17812         GO TO 6370-EXIT.
 17813
 17814     IF PB-I-LF-TERM NOT NUMERIC
 17815         MOVE ZEROS              TO PB-I-LF-TERM.
 17816
 17817     IF PB-I-LOAN-TERM NOT NUMERIC
 17818         MOVE ZEROS              TO PB-I-LOAN-TERM.
 17819
 17820     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 17821         GO TO 6370-EXIT.
 17822
 17823     IF PB-I-LF-BENEFIT-CD = '33'
 17824         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 17825
 17826     IF PB-I-LF-BENEFIT-CD = '34'
 17827         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 17828
 17829 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 323
* EL050.cbl
 17830     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 324
* EL050.cbl
 17832
 17833 6380-EDIT-INPUT-AH-CODE.
 17834     IF WK-AH-EDIT-ADDR NOT = ZEROS
 17835        MOVE +1                  TO SUB
 17836        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 17837        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17838        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17839        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17840        GO TO 6380-SEARCH-LOOP.
 17841
 17842     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17843
 17844     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17845     MOVE SPACES                 TO CNTL-ACCESS.
 17846     MOVE 'A'                    TO CNTL-REC-TYPE.
 17847*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 17848     MOVE +0                     TO CNTL-SEQ-NO.
 17849     MOVE '5' TO RC-SW-2.
 17850     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17851
 17852     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17853        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17854        GO TO 6380-NO-AH-FOUND.
 17855
 17856     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 17857     MOVE +1 TO SUB.
 17858
 17859 6380-SEARCH-LOOP.
 17860     IF CF-AH-CODE-OUT (SUB) = ZEROS
 17861         GO TO 6380-NO-AH-FOUND.
 17862
 17863     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 17864         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 17865         GO TO 6380-CSO-AH-ONLY-CHECKS.
 17866
 17867     ADD 1   TO SUB.
 17868     IF SUB GREATER THAN 96
 17869*    IF SUB GREATER THAN 300
 17870         GO TO 6380-NO-AH-FOUND.
 17871
 17872     GO TO 6380-SEARCH-LOOP.
 17873
 17874 6380-NO-AH-FOUND.
 17875
 17876     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 17877
 17878     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 17879         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 17880     ELSE
 17881         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 17882
 17883 6380-CSO-AH-ONLY-CHECKS.
 17884
 17885     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 17886        NEXT SENTENCE
 17887      ELSE
 17888        GO TO 6380-EXIT.
 17889
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 325
* EL050.cbl
 17890     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 17891         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 17892
 17893
 17894     GO TO 6380-EXIT
 17895     .
 17896 6380-CSO-LIFE-WITH-AH-CHECKS.
 17897
 17898
 17899     .
 17900 6380-EXIT.
 17901     EXIT.
 17902
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 326
* EL050.cbl
 17904
 17905 6400-COMPUTE-EXTENSION-DAYS.
 17906
 17907******************************************************************
 17908*                                                                *
 17909*                   COMPUTE EXTENSION DAYS                       *
 17910*                                                                *
 17911*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 17912*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 17913*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 17914*    THE EXTENSION DAYS.                                         *
 17915*                                                                *
 17916******************************************************************
 17917
 17918     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 17919     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 17920
 17921******************************************************************
 17922*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 17923*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 17924******************************************************************
 17925
 17926     IF DC-ELAPSED-MONTHS GREATER THAN +0
 17927        COMPUTE WS-ODD-DAYS-OVER =
 17928               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 17929     ELSE
 17930        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 17931
 17932     IF WS-ODD-DAYS-OVER = ZEROS
 17933           GO TO 6499-EXIT
 17934     ELSE
 17935        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 17936           IF WS-WDF-MONTH = 02
 17937              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 17938              ADD 2       TO  WS-ODD-DAYS-OVER
 17939              GO TO 6499-EXIT
 17940           ELSE
 17941              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 17942                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 17943                 GO TO 6499-EXIT
 17944               ELSE
 17945                 GO TO 6499-EXIT
 17946        ELSE
 17947           GO TO 6499-EXIT.
 17948
 17949 6412-CHECK-TO-DAY.
 17950
 17951        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 17952           IF WS-WDT-DAY = 28
 17953              ADD 2              TO WS-ODD-DAYS-OVER
 17954           ELSE
 17955              IF WS-WDT-DAY = 29
 17956                 ADD 1           TO WS-ODD-DAYS-OVER
 17957              ELSE
 17958                 NEXT SENTENCE
 17959        ELSE
 17960           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 17961              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 327
* EL050.cbl
 17962
 17963     GO TO 6499-EXIT.
 17964
 17965
 17966 6415-CHECK-LEAP-YEAR.
 17967
 17968     IF DC-DAYS-IN-MONTH = 29
 17969        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 17970
 17971 6415-EXIT.
 17972     EXIT.
 17973
 17974 6499-EXIT.
 17975      EXIT.
 17976
 17977 6500-END.
 17978     EXIT.
 17979
 17980
 17981******************************************************************
 17982************* PROCEDURE DIVISION FOR EL050 ***********************
 17983********************** ELC50PD END *******************************
 17984
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 328
* EL050.cbl
 17986
 17987**START***********************************************************
 17988*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 17989*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 17990******************************************************************
 17991*
 17992 6600-GET-STATE-MUNICIPAL-TAX.
 17993
 17994     IF PB-COMPANY-ID NOT = 'DMD'
 17995         GO TO 6640-EXIT.
 17996
 17997     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 17998     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 17999     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 18000*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 18001*
 18002***  Y2K PROJ 7744
 18003     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18004     SET BIN-TO-GREG          TO TRUE.
 18005     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18006
 18007     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18008
 18009     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 18010     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 18011
 18012
 18013* EXEC CICS HANDLE CONDITION
 18014*        INVREQ    (6610-START-BROWSE)
 18015*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18016*        NOTFND    (6630-END-OF-FILE)
 18017*    END-EXEC.
 18018*    MOVE '"$8JI                 ! # #00018000' TO DFHEIV0
 18019     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 18020     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18021     MOVE X'2320233030303138303030' TO DFHEIV0(25:11)
 18022     CALL 'kxdfhei1' USING DFHEIV0
 18023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18024
 18025
 18026 6610-START-BROWSE.
 18027
 18028
 18029* EXEC CICS HANDLE CONDITION
 18030*        NOTFND    (6630-END-OF-FILE)
 18031*        DISABLED  (6630-ERRESS-PROBLEM)
 18032*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18033*        ENDFILE   (6630-END-OF-FILE)
 18034*    END-EXEC.
 18035*    MOVE '"$IcJ''                ! $ #00018008' TO DFHEIV0
 18036     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18037     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18038     MOVE X'2420233030303138303038' TO DFHEIV0(25:11)
 18039     CALL 'kxdfhei1' USING DFHEIV0
 18040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18041
 18042
 18043
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 329
* EL050.cbl
 18044* EXEC CICS STARTBR
 18045*        DATASET (FILE-ID-ERRESS)
 18046*        RIDFLD  (WS-ERRESS-KEY)
 18047*        GTEQ
 18048*    END-EXEC.
 18049     MOVE 0
 18050       TO DFHEIV11
 18051*    MOVE '&,         G          &   #00018015' TO DFHEIV0
 18052     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18053     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18054     MOVE X'2020233030303138303135' TO DFHEIV0(25:11)
 18055     CALL 'kxdfhei1' USING DFHEIV0,
 18056           FILE-ID-ERRESS,
 18057           WS-ERRESS-KEY,
 18058           DFHEIV99,
 18059           DFHEIV11,
 18060           DFHEIV99
 18061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18062
 18063
 18064 6620-READ-NEXT-ERRESS-MASTER.
 18065
 18066
 18067* EXEC CICS HANDLE CONDITION
 18068*        NOTFND    (6630-END-OF-FILE)
 18069*        ENDFILE   (6630-END-OF-FILE)
 18070*        DISABLED  (6630-ERRESS-PROBLEM)
 18071*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18072*    END-EXEC.
 18073*    MOVE '"$I''cJ                ! % #00018023' TO DFHEIV0
 18074     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 18075     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18076     MOVE X'2520233030303138303233' TO DFHEIV0(25:11)
 18077     CALL 'kxdfhei1' USING DFHEIV0
 18078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18079
 18080
 18081
 18082* EXEC CICS READNEXT
 18083*        DATASET (FILE-ID-ERRESS)
 18084*        INTO    (RESIDENT-STATE-TAX-MASTER)
 18085*        RIDFLD  (WS-ERRESS-KEY)
 18086*    END-EXEC.
 18087     MOVE LENGTH OF
 18088      RESIDENT-STATE-TAX-MASTER
 18089       TO DFHEIV12
 18090     MOVE 0
 18091       TO DFHEIV11
 18092*    MOVE '&.IL                  )   #00018030' TO DFHEIV0
 18093     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18094     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18095     MOVE X'2020233030303138303330' TO DFHEIV0(25:11)
 18096     CALL 'kxdfhei1' USING DFHEIV0,
 18097           FILE-ID-ERRESS,
 18098           RESIDENT-STATE-TAX-MASTER,
 18099           DFHEIV12,
 18100           WS-ERRESS-KEY,
 18101           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 330
* EL050.cbl
 18102           DFHEIV11,
 18103           DFHEIV99,
 18104           DFHEIV99
 18105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18106
 18107
 18108     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 18109
 18110* EXEC CICS ENDBR
 18111*            DATASET (FILE-ID-ERRESS)
 18112*       END-EXEC
 18113     MOVE 0
 18114       TO DFHEIV11
 18115*    MOVE '&2                    $   #00018037' TO DFHEIV0
 18116     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18117     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18118     MOVE X'2020233030303138303337' TO DFHEIV0(25:11)
 18119     CALL 'kxdfhei1' USING DFHEIV0,
 18120           FILE-ID-ERRESS,
 18121           DFHEIV11,
 18122           DFHEIV99
 18123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18124        GO TO 6630-END-OF-FILE.
 18125
 18126     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 18127        NEXT SENTENCE
 18128      ELSE
 18129        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 18130
 18131*IS IT LIFE(1) OR IS IT P&C(2) ?????
 18132*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 18133*
 18134     MOVE +2                     TO WS-SUB1.
 18135
 18136     IF PB-ISSUE
 18137     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 18138        MOVE +1                  TO WS-SUB1.
 18139
 18140     IF PB-CANCELLATION
 18141     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 18142        MOVE +1                  TO WS-SUB1.
 18143*
 18144*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 18145*
 18146***  Y2K PROJ 7744
 18147     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 18148***  Y2K PROJ 7744
 18149
 18150*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 18151* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 18152* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 18153
 18154     ADD 1                    TO WS-YEAR-YY.
 18155
 18156     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 18157         MOVE RES-REN-STATE-TAX (WS-SUB1)
 18158                              TO WS-RES-STATE-TAX
 18159         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 331
* EL050.cbl
 18160                              TO WS-RES-MUNI-TAX
 18161     ELSE
 18162         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 18163                              TO WS-RES-STATE-TAX
 18164         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 18165                              TO WS-RES-MUNI-TAX.
 18166
 18167*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 18168
 18169     IF PB-CANCELLATION
 18170         GO TO 6640-CANCEL-TAX.
 18171
 18172     IF PB-I-LF-PREMIUM-AMT > ZEROS
 18173         COMPUTE PB-I-STATE-TAX ROUNDED =
 18174                                   PB-I-LF-PREMIUM-AMT
 18175                                 * WS-RES-STATE-TAX
 18176         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18177                                   PB-I-LF-PREMIUM-AMT
 18178                                 * WS-RES-MUNI-TAX
 18179     ELSE
 18180     IF PB-I-AH-PREMIUM-AMT > ZEROS
 18181         COMPUTE PB-I-STATE-TAX ROUNDED =
 18182                                   PB-I-AH-PREMIUM-AMT
 18183                                 * WS-RES-STATE-TAX
 18184         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18185                                   PB-I-AH-PREMIUM-AMT
 18186                                 * WS-RES-MUNI-TAX.
 18187
 18188
 18189* EXEC CICS ENDBR
 18190*         DATASET (FILE-ID-ERRESS)
 18191*    END-EXEC.
 18192     MOVE 0
 18193       TO DFHEIV11
 18194*    MOVE '&2                    $   #00018104' TO DFHEIV0
 18195     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18196     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18197     MOVE X'2020233030303138313034' TO DFHEIV0(25:11)
 18198     CALL 'kxdfhei1' USING DFHEIV0,
 18199           FILE-ID-ERRESS,
 18200           DFHEIV11,
 18201           DFHEIV99
 18202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18203
 18204
 18205     GO TO 6640-EXIT.
 18206
 18207 6640-CANCEL-TAX.
 18208     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 18209
 18210     IF PB-C-LF-CANCEL-AMT > ZEROS
 18211         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18212                                   PB-C-LF-CANCEL-AMT
 18213                                 * WS-RES-STATE-TAX
 18214         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18215                                   PB-C-LF-CANCEL-AMT
 18216                                *  WS-RES-MUNI-TAX
 18217     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 332
* EL050.cbl
 18218     IF PB-C-AH-CANCEL-AMT > ZEROS
 18219         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18220                                   PB-C-AH-CANCEL-AMT
 18221                                 * WS-RES-STATE-TAX
 18222         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18223                                   PB-C-AH-CANCEL-AMT
 18224                                *  WS-RES-MUNI-TAX.
 18225
 18226
 18227* EXEC CICS ENDBR
 18228*         DATASET (FILE-ID-ERRESS)
 18229*    END-EXEC.
 18230     MOVE 0
 18231       TO DFHEIV11
 18232*    MOVE '&2                    $   #00018129' TO DFHEIV0
 18233     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18234     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18235     MOVE X'2020233030303138313239' TO DFHEIV0(25:11)
 18236     CALL 'kxdfhei1' USING DFHEIV0,
 18237           FILE-ID-ERRESS,
 18238           DFHEIV11,
 18239           DFHEIV99
 18240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18241
 18242
 18243     GO TO 6640-EXIT.
 18244
 18245 6630-END-OF-FILE.
 18246     MOVE ER-8002              TO WS-ERROR.
 18247     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18248
 18249     GO TO 6640-EXIT.
 18250
 18251 6630-ERRESS-PROBLEM.
 18252     MOVE ER-8044              TO WS-ERROR.
 18253     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18254
 18255 6640-EXIT.
 18256     EXIT.
 18257
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 333
* EL050.cbl
 18259 6650-GET-RES-STATE-COMM.
 18260
 18261     IF PB-COMPANY-ID NOT = 'DMD'
 18262         GO TO 6700-COMM-EXIT.
 18263
 18264     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 18265     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 18266     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 18267     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 18268     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 18269     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 18270     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 18271
 18272*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 18273*
 18274***  Y2K PROJ 7744
 18275     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18276     SET BIN-TO-GREG          TO TRUE.
 18277     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18278
 18279     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18280***  Y2K PROJ 7744
 18281
 18282     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 18283
 18284
 18285* EXEC CICS HANDLE CONDITION
 18286*        INVREQ    (6660-START-BROWSE)
 18287*        DISABLED  (6690-ERRESC-PROBLEM)
 18288*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18289*        NOTFND    (6690-END-OF-FILE)
 18290*    END-EXEC.
 18291*    MOVE '"$8cJI                ! & #00018174' TO DFHEIV0
 18292     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 18293     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18294     MOVE X'2620233030303138313734' TO DFHEIV0(25:11)
 18295     CALL 'kxdfhei1' USING DFHEIV0
 18296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18297
 18298
 18299
 18300* EXEC CICS RESETBR
 18301*        DATASET (FILE-ID-ERRESC)
 18302*        RIDFLD  (WS-ERRESC-KEY)
 18303*    END-EXEC.
 18304     MOVE 0
 18305       TO DFHEIV11
 18306*    MOVE '&4         G          &   #00018181' TO DFHEIV0
 18307     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18308     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18309     MOVE X'2020233030303138313831' TO DFHEIV0(25:11)
 18310     CALL 'kxdfhei1' USING DFHEIV0,
 18311           FILE-ID-ERRESC,
 18312           WS-ERRESC-KEY,
 18313           DFHEIV99,
 18314           DFHEIV11,
 18315           DFHEIV99
 18316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 334
* EL050.cbl
 18317
 18318
 18319 6660-START-BROWSE.
 18320
 18321
 18322* EXEC CICS HANDLE CONDITION
 18323*        NOTFND    (6690-END-OF-FILE)
 18324*        DISABLED  (6690-ERRESC-PROBLEM)
 18325*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18326*        ENDFILE   (6690-END-OF-FILE)
 18327*    END-EXEC.
 18328*    MOVE '"$IcJ''                ! '' #00018188' TO DFHEIV0
 18329     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18330     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18331     MOVE X'2720233030303138313838' TO DFHEIV0(25:11)
 18332     CALL 'kxdfhei1' USING DFHEIV0
 18333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18334
 18335
 18336
 18337* EXEC CICS STARTBR
 18338*        DATASET (FILE-ID-ERRESC)
 18339*        RIDFLD  (WS-ERRESC-KEY)
 18340*        GTEQ
 18341*    END-EXEC.
 18342     MOVE 0
 18343       TO DFHEIV11
 18344*    MOVE '&,         G          &   #00018195' TO DFHEIV0
 18345     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18346     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18347     MOVE X'2020233030303138313935' TO DFHEIV0(25:11)
 18348     CALL 'kxdfhei1' USING DFHEIV0,
 18349           FILE-ID-ERRESC,
 18350           WS-ERRESC-KEY,
 18351           DFHEIV99,
 18352           DFHEIV11,
 18353           DFHEIV99
 18354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18355
 18356
 18357     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 18358
 18359 6670-READ-NEXT-ERRESC-MASTER.
 18360
 18361
 18362* EXEC CICS HANDLE CONDITION
 18363*        NOTFND    (6690-END-OF-FILE)
 18364*        DISABLED  (6690-ERRESC-PROBLEM)
 18365*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18366*        ENDFILE   (6690-END-OF-FILE)
 18367*    END-EXEC.
 18368*    MOVE '"$IcJ''                ! ( #00018205' TO DFHEIV0
 18369     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18370     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18371     MOVE X'2820233030303138323035' TO DFHEIV0(25:11)
 18372     CALL 'kxdfhei1' USING DFHEIV0
 18373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18374
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 335
* EL050.cbl
 18375
 18376
 18377* EXEC CICS READNEXT
 18378*        DATASET (FILE-ID-ERRESC)
 18379*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18380*        RIDFLD  (ERRESC-RECORD-KEY)
 18381*    END-EXEC.
 18382     MOVE LENGTH OF
 18383      ACCOUNT-RESIDENT-ST-COMMISSION
 18384       TO DFHEIV12
 18385     MOVE 0
 18386       TO DFHEIV11
 18387*    MOVE '&.IL                  )   #00018212' TO DFHEIV0
 18388     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18389     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18390     MOVE X'2020233030303138323132' TO DFHEIV0(25:11)
 18391     CALL 'kxdfhei1' USING DFHEIV0,
 18392           FILE-ID-ERRESC,
 18393           ACCOUNT-RESIDENT-ST-COMMISSION,
 18394           DFHEIV12,
 18395           ERRESC-RECORD-KEY,
 18396           DFHEIV99,
 18397           DFHEIV11,
 18398           DFHEIV99,
 18399           DFHEIV99
 18400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18401
 18402
 18403     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18404        NEXT SENTENCE
 18405     ELSE
 18406
 18407* EXEC CICS ENDBR
 18408*            DATASET (FILE-ID-ERRESC)
 18409*       END-EXEC
 18410     MOVE 0
 18411       TO DFHEIV11
 18412*    MOVE '&2                    $   #00018221' TO DFHEIV0
 18413     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18414     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18415     MOVE X'2020233030303138323231' TO DFHEIV0(25:11)
 18416     CALL 'kxdfhei1' USING DFHEIV0,
 18417           FILE-ID-ERRESC,
 18418           DFHEIV11,
 18419           DFHEIV99
 18420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18421        GO TO 6690-END-OF-FILE.
 18422
 18423     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18424
 18425* EXEC CICS ENDBR
 18426*            DATASET (FILE-ID-ERRESC)
 18427*       END-EXEC
 18428     MOVE 0
 18429       TO DFHEIV11
 18430*    MOVE '&2                    $   #00018227' TO DFHEIV0
 18431     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18432     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 336
* EL050.cbl
 18433     MOVE X'2020233030303138323237' TO DFHEIV0(25:11)
 18434     CALL 'kxdfhei1' USING DFHEIV0,
 18435           FILE-ID-ERRESC,
 18436           DFHEIV11,
 18437           DFHEIV99
 18438     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18439        GO TO 6690-END-OF-FILE.
 18440
 18441     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18442        NEXT SENTENCE
 18443      ELSE
 18444        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18445
 18446* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18447*
 18448     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18449
 18450     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18451
 18452     IF WS-SUB1 > ZERO
 18453         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18454             PERFORM 6680-SET-COMMISSION
 18455         ELSE
 18456             PERFORM 6680-SET-TABLE-CODE.
 18457
 18458
 18459* EXEC CICS ENDBR
 18460*         DATASET (FILE-ID-ERRESC)
 18461*    END-EXEC.
 18462     MOVE 0
 18463       TO DFHEIV11
 18464*    MOVE '&2                    $   #00018249' TO DFHEIV0
 18465     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18466     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18467     MOVE X'2020233030303138323439' TO DFHEIV0(25:11)
 18468     CALL 'kxdfhei1' USING DFHEIV0,
 18469           FILE-ID-ERRESC,
 18470           DFHEIV11,
 18471           DFHEIV99
 18472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18473
 18474
 18475     GO TO 6700-COMM-EXIT.
 18476
 18477 6680-SET-TABLE-CODE.
 18478     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18479        MOVE ZEROS             TO WS-SUB1
 18480     ELSE
 18481* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18482* TO COMPUTE AH COMMISSION.
 18483        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18484        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18485        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18486        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18487        PERFORM 6680-READ-CTBL-TABLE
 18488        IF WS-CTBL-READ-SW NOT = 'Y'
 18489           MOVE ZEROS          TO WS-SUB1.
 18490
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 337
* EL050.cbl
 18491 6680-READ-CTBL-TABLE.
 18492*
 18493* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18494* TO COMPUTE LIFE COMMISSION
 18495
 18496     IF CTBL-SW = '0540'
 18497        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18498        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18499        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18500
 18501     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18502
 18503     IF CTBL-TABLE-FOUND
 18504        IF CTBL-SW = '0530'
 18505             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18506                                    * PB-I-AH-TERM
 18507             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18508             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18509        ELSE
 18510             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18511             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18512             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18513     ELSE
 18514        IF FIRST-TIME-THROUGH
 18515            GO TO 6680-READ-CTBL-TABLE
 18516        ELSE
 18517            MOVE ZEROS         TO WS-SUB1.
 18518
 18519 6680-SET-COMMISSION.
 18520     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18521           MOVE ZEROS          TO WS-SUB1
 18522       ELSE
 18523           MOVE RESC-COMMISSION-PER (WS-SUB)
 18524                               TO WS-COMMISSION
 18525           IF CTBL-SW = '0530'
 18526               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18527           ELSE
 18528               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18529
 18530 6680-SEARCH-CATEGORY.
 18531     ADD +1                   TO WS-SUB.
 18532     IF WS-SUB > +12
 18533         GO TO 6680-EXIT.
 18534
 18535     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18536          MOVE WS-SUB         TO WS-SUB1
 18537          GO TO 6680-EXIT.
 18538
 18539     GO TO 6680-SEARCH-CATEGORY.
 18540
 18541 6680-EXIT.
 18542     EXIT.
 18543
 18544 6690-END-OF-FILE.
 18545     GO TO 6700-COMM-EXIT.
 18546
 18547 6690-ERRESC-PROBLEM.
 18548      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 338
* EL050.cbl
 18549      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18550
 18551      GO TO 6700-COMM-EXIT.
 18552
 18553 6700-COMM-EXIT.
 18554     EXIT.
 18555
 18556 7000-GET-RATE.
 18557
 18558* EXEC CICS LINK
 18559*        PROGRAM    ('ELRATE')
 18560*        COMMAREA   (CALCULATION-PASS-AREA)
 18561*        LENGTH     (CP-COMM-LENGTH)
 18562*    END-EXEC.
 18563     MOVE 'ELRATE' TO DFHEIV1
 18564*    MOVE '."C                   (   #00018335' TO DFHEIV0
 18565     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18566     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18567     MOVE X'2020233030303138333335' TO DFHEIV0(25:11)
 18568     CALL 'kxdfhei1' USING DFHEIV0,
 18569           DFHEIV1,
 18570           CALCULATION-PASS-AREA,
 18571           CP-COMM-LENGTH,
 18572           DFHEIV99,
 18573           DFHEIV99,
 18574           DFHEIV99,
 18575           DFHEIV99
 18576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18577
 18578
 18579 7000-EXIT.
 18580     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 339
* EL050.cbl
 18582 7100-FIND-BENEFIT-IN-STATE.
 18583     MOVE 'N'                    TO BEN-SEARCH-SW.
 18584
 18585     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 18586         VARYING SUB3 FROM 1 BY 1 UNTIL
 18587            ((SUB3 GREATER 50) OR
 18588              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 18589               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 18590
 18591     IF SUB3 NOT = 51
 18592         MOVE 'Y'                TO BEN-SEARCH-SW.
 18593
 18594     GO TO 7199-EXIT.
 18595
 18596 7100-BENEFIT-DUMMY.
 18597
 18598 7100-DUMMY-EXIT.
 18599     EXIT.
 18600
 18601 7199-EXIT.
 18602     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 340
* EL050.cbl
 18604 7200-FIND-BENEFIT.
 18605     MOVE 'N'                    TO BEN-SEARCH-SW.
 18606
 18607     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18608         VARYING SUB3 FROM 1 BY 1 UNTIL
 18609            ((SUB3 GREATER 8) OR
 18610            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 18611
 18612     IF SUB3 NOT = 9
 18613         MOVE 'Y'                TO BEN-SEARCH-SW.
 18614
 18615     GO TO 7200-EXIT.
 18616
 18617 7200-BENEFIT-DUMMY.
 18618
 18619 7200-DUMMY-EXIT.
 18620     EXIT.
 18621
 18622 7200-EXIT.
 18623     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 341
* EL050.cbl
 18625 7250-LOOK-FOR-RESCINDED-CLAIM.
 18626     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18627                                    W-CL-COMP-CD.
 18628     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18629                                    W-CL-CERT-NO.
 18630
 18631
 18632* EXEC CICS HANDLE CONDITION
 18633*        NOTFND  (7250-CONTINUE)
 18634*        ENDFILE (7250-CONTINUE)
 18635*    END-EXEC.
 18636*    MOVE '"$I''                  ! ) #00018393' TO DFHEIV0
 18637     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18638     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18639     MOVE X'2920233030303138333933' TO DFHEIV0(25:11)
 18640     CALL 'kxdfhei1' USING DFHEIV0
 18641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18642
 18643
 18644
 18645* EXEC CICS IGNORE CONDITION
 18646*        DUPKEY
 18647*    END-EXEC.
 18648*    MOVE '"*$                   !   #00018398' TO DFHEIV0
 18649     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18650     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18651     MOVE X'2020233030303138333938' TO DFHEIV0(25:11)
 18652     CALL 'kxdfhei1' USING DFHEIV0
 18653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18654
 18655
 18656
 18657* EXEC CICS STARTBR
 18658*        DATASET   (CLMS-ID)
 18659*        RIDFLD    (ELMSTR-KEY)
 18660*        GENERIC   EQUAL
 18661*        KEYLENGTH (ELMSTR-LENGTH)
 18662*    END-EXEC.
 18663     MOVE 0
 18664       TO DFHEIV11
 18665*    MOVE '&,   KG    E          &   #00018402' TO DFHEIV0
 18666     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18667     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18668     MOVE X'2020233030303138343032' TO DFHEIV0(25:11)
 18669     CALL 'kxdfhei1' USING DFHEIV0,
 18670           CLMS-ID,
 18671           ELMSTR-KEY,
 18672           ELMSTR-LENGTH,
 18673           DFHEIV11,
 18674           DFHEIV99
 18675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18676
 18677
 18678     MOVE 'Y'                    TO W-BROWSE-SW.
 18679
 18680 7250-NEXT-CLAIM.
 18681
 18682
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 342
* EL050.cbl
 18683* EXEC CICS READNEXT
 18684*        DATASET   (CLMS-ID)
 18685*        RIDFLD    (ELMSTR-KEY)
 18686*        SET       (ADDRESS OF CLAIM-MASTER)
 18687*    END-EXEC.
 18688     MOVE 0
 18689       TO DFHEIV11
 18690*    MOVE '&.S                   )   #00018413' TO DFHEIV0
 18691     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18692     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18693     MOVE X'2020233030303138343133' TO DFHEIV0(25:11)
 18694     CALL 'kxdfhei1' USING DFHEIV0,
 18695           CLMS-ID,
 18696           DFHEIV20,
 18697           DFHEIV99,
 18698           ELMSTR-KEY,
 18699           DFHEIV99,
 18700           DFHEIV11,
 18701           DFHEIV99,
 18702           DFHEIV99
 18703     SET ADDRESS OF CLAIM-MASTER TO
 18704         DFHEIV20
 18705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18706
 18707
 18708     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18709        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18710         GO TO 7250-CONTINUE
 18711     END-IF.
 18712
 18713     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18714        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18715        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18716        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18717        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18718         GO TO 7250-NEXT-CLAIM
 18719     END-IF.
 18720
 18721     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18722        OR (CL-CLAIM-TYPE = 'I')
 18723        OR (CL-CLAIM-TYPE = 'G')
 18724          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18725              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 18726              GO TO 7250-CONTINUE
 18727          END-IF
 18728     END-IF.
 18729
 18730     GO TO 7250-NEXT-CLAIM.
 18731
 18732 7250-CONTINUE.
 18733
 18734     IF W-BROWSE-SW = 'Y'
 18735
 18736* EXEC CICS ENDBR
 18737*            DATASET   (CLMS-ID)
 18738*        END-EXEC
 18739     MOVE 0
 18740       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 343
* EL050.cbl
 18741*    MOVE '&2                    $   #00018446' TO DFHEIV0
 18742     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18743     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18744     MOVE X'2020233030303138343436' TO DFHEIV0(25:11)
 18745     CALL 'kxdfhei1' USING DFHEIV0,
 18746           CLMS-ID,
 18747           DFHEIV11,
 18748           DFHEIV99
 18749     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18750         MOVE 'N' TO W-BROWSE-SW
 18751     END-IF.
 18752
 18753 7250-EXIT.
 18754     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 344
* EL050.cbl
 18756 7300-CHECK-FOR-OPEN-CLMS.
 18757
 18758*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 18759*    MOVE SPACES                 TO CNTL-ACCESS.
 18760*    MOVE '1'                    TO CNTL-REC-TYPE.
 18761*    MOVE +0                     TO CNTL-SEQ-NO.
 18762
 18763*    MOVE '3'                    TO RC-SW-1.
 18764*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 18765
 18766*    IF NOT CF-COMPANY-MASTER
 18767*         PERFORM 0099-COMPANY-NOT-FOUND
 18768*         GO TO 7300-EXIT.
 18769
 18770     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18771                                    W-CL-COMP-CD.
 18772     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18773                                    W-CL-CERT-NO.
 18774
 18775
 18776* EXEC CICS HANDLE CONDITION
 18777*        NOTFND  (7300-CONTINUE)
 18778*        ENDFILE (7300-CONTINUE)
 18779*    END-EXEC.
 18780*    MOVE '"$I''                  ! * #00018474' TO DFHEIV0
 18781     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18782     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18783     MOVE X'2A20233030303138343734' TO DFHEIV0(25:11)
 18784     CALL 'kxdfhei1' USING DFHEIV0
 18785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18786
 18787
 18788
 18789* EXEC CICS IGNORE CONDITION
 18790*        DUPKEY
 18791*    END-EXEC.
 18792*    MOVE '"*$                   !   #00018479' TO DFHEIV0
 18793     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18794     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18795     MOVE X'2020233030303138343739' TO DFHEIV0(25:11)
 18796     CALL 'kxdfhei1' USING DFHEIV0
 18797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18798
 18799
 18800
 18801* EXEC CICS STARTBR
 18802*        DATASET   (CLMS-ID)
 18803*        RIDFLD    (ELMSTR-KEY)
 18804*        GENERIC   EQUAL
 18805*        KEYLENGTH (ELMSTR-LENGTH)
 18806*    END-EXEC.
 18807     MOVE 0
 18808       TO DFHEIV11
 18809*    MOVE '&,   KG    E          &   #00018483' TO DFHEIV0
 18810     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18811     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18812     MOVE X'2020233030303138343833' TO DFHEIV0(25:11)
 18813     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 345
* EL050.cbl
 18814           CLMS-ID,
 18815           ELMSTR-KEY,
 18816           ELMSTR-LENGTH,
 18817           DFHEIV11,
 18818           DFHEIV99
 18819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18820
 18821
 18822     MOVE 'Y'                    TO W-BROWSE-SW.
 18823
 18824 7300-NEXT-CLAIM.
 18825
 18826
 18827* EXEC CICS READNEXT
 18828*        DATASET   (CLMS-ID)
 18829*        RIDFLD    (ELMSTR-KEY)
 18830*        SET       (ADDRESS OF CLAIM-MASTER)
 18831*    END-EXEC.
 18832     MOVE 0
 18833       TO DFHEIV11
 18834*    MOVE '&.S                   )   #00018494' TO DFHEIV0
 18835     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18836     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18837     MOVE X'2020233030303138343934' TO DFHEIV0(25:11)
 18838     CALL 'kxdfhei1' USING DFHEIV0,
 18839           CLMS-ID,
 18840           DFHEIV20,
 18841           DFHEIV99,
 18842           ELMSTR-KEY,
 18843           DFHEIV99,
 18844           DFHEIV11,
 18845           DFHEIV99,
 18846           DFHEIV99
 18847     SET ADDRESS OF CLAIM-MASTER TO
 18848         DFHEIV20
 18849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18850
 18851
 18852     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18853        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18854         GO TO 7300-CONTINUE.
 18855
 18856     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18857        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18858        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18859        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18860        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18861         GO TO 7300-NEXT-CLAIM.
 18862
 18863*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 18864     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18865        OR (CL-CLAIM-TYPE = 'I')
 18866        OR (CL-CLAIM-TYPE = 'G')
 18867        IF CLAIM-IS-OPEN
 18868           EVALUATE TRUE
 18869             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 18870                 MOVE ER-2884      TO WS-ERROR
 18871             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 346
* EL050.cbl
 18872                 MOVE ER-2887      TO WS-ERROR
 18873             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 18874                 MOVE ER-2886      TO WS-ERROR
 18875             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 18876                 MOVE ER-2888      TO WS-ERROR
 18877             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 18878                 MOVE ER-2885      TO WS-ERROR
 18879             WHEN OTHER
 18880                 MOVE ER-2768      TO WS-ERROR
 18881           END-EVALUATE
 18882           IF PB-C-AH-CANCEL-VOIDED OR
 18883              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18884                NOT AH-COVERAGE-CANCELLED)
 18885               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18886               MOVE ER-2768      TO WS-ERROR
 18887           END-IF
 18888           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18889           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18890              PB-FORCE-CODE NOT EQUAL '8'
 18891               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18892           END-IF
 18893           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 18894           GO TO 7300-CONTINUE
 18895        ELSE
 18896           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18897*****THIS IS A RESCISSION OR REFORMATION
 18898              IF (AH-COVERAGE-CANCELLED AND
 18899                  PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT)
 18900                    MOVE ER-2890 TO WS-ERROR
 18901                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18902                    GO TO 7300-CONTINUE
 18903              END-IF
 18904           ELSE
 18905              IF CL-DENIAL-TYPE = '1'  AND
 18906                 CL-TOTAL-PAID-AMT = 0
 18907                    GO TO 7300-NEXT-CLAIM
 18908              END-IF
 18909              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 18910               AND PB-C-AH-CANCEL-DT > SPACES
 18911                 MOVE ER-2756        TO WS-ERROR
 18912                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18913                 GO TO 7300-CONTINUE
 18914              END-IF
 18915           END-IF
 18916        END-IF
 18917     ELSE
 18918*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 18919        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 18920           IF CLAIM-IS-OPEN
 18921              MOVE ER-2889      TO WS-ERROR
 18922              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18923              GO TO 7300-CONTINUE
 18924           ELSE
 18925              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18926*****THIS IS A RESCISSION OR REFORMATION
 18927                 IF (LF-COVERAGE-CANCELLED AND
 18928                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 18929                       MOVE ER-2890 TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 347
* EL050.cbl
 18930                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18931                       GO TO 7300-CONTINUE
 18932                 END-IF
 18933              ELSE
 18934                 IF CL-DENIAL-TYPE = '1'  AND
 18935                    CL-TOTAL-PAID-AMT = 0
 18936                       GO TO 7300-NEXT-CLAIM
 18937                 END-IF
 18938                 IF (AH-COVERAGE-CANCELLED AND
 18939                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 18940                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 18941                    (LF-COVERAGE-CANCELLED AND
 18942                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 18943                     WS-ST-REFUND-CLAIM-FLAG = '4')
 18944                       MOVE ER-2965 TO WS-ERROR
 18945                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18946                       GO TO 7300-CONTINUE
 18947                 END-IF
 18948                 IF LF-COVERAGE-CANCELLED
 18949                  IF CL-TOTAL-PAID-AMT > 0
 18950                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 18951                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 18952                        MOVE ER-2891 TO WS-ERROR
 18953                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18954                        GO TO 7300-CONTINUE
 18955                      END-IF
 18956                    ELSE
 18957                      MOVE ER-2892 TO WS-ERROR
 18958                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18959                      GO TO 7300-CONTINUE
 18960                    END-IF
 18961                  END-IF
 18962                 END-IF
 18963              END-IF
 18964           END-IF
 18965        END-IF
 18966     END-IF
 18967
 18968     GO TO 7300-NEXT-CLAIM.
 18969
 18970 7300-CONTINUE.
 18971
 18972     IF W-BROWSE-SW = 'Y'
 18973
 18974* EXEC CICS ENDBR
 18975*            DATASET   (CLMS-ID)
 18976*        END-EXEC.
 18977     MOVE 0
 18978       TO DFHEIV11
 18979*    MOVE '&2                    $   #00018621' TO DFHEIV0
 18980     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18981     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18982     MOVE X'2020233030303138363231' TO DFHEIV0(25:11)
 18983     CALL 'kxdfhei1' USING DFHEIV0,
 18984           CLMS-ID,
 18985           DFHEIV11,
 18986           DFHEIV99
 18987     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 348
* EL050.cbl
 18988
 18989
 18990 7300-EXIT.
 18991     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 349
* EL050.cbl
 18993
 18994 7400-GET-REMAIN-TERM.
 18995
 18996* EXEC CICS LINK
 18997*        PROGRAM    ('ELRTRM')
 18998*        COMMAREA   (CALCULATION-PASS-AREA)
 18999*        LENGTH     (CP-COMM-LENGTH)
 19000*    END-EXEC.
 19001     MOVE 'ELRTRM' TO DFHEIV1
 19002*    MOVE '."C                   (   #00018630' TO DFHEIV0
 19003     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19004     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19005     MOVE X'2020233030303138363330' TO DFHEIV0(25:11)
 19006     CALL 'kxdfhei1' USING DFHEIV0,
 19007           DFHEIV1,
 19008           CALCULATION-PASS-AREA,
 19009           CP-COMM-LENGTH,
 19010           DFHEIV99,
 19011           DFHEIV99,
 19012           DFHEIV99,
 19013           DFHEIV99
 19014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19015
 19016
 19017 7400-EXIT.
 19018     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 350
* EL050.cbl
 19020
 19021 7500-GET-REMAIN-AMOUNT.
 19022
 19023* EXEC CICS LINK
 19024*        PROGRAM    ('ELRAMT')
 19025*        COMMAREA   (CALCULATION-PASS-AREA)
 19026*        LENGTH     (CP-COMM-LENGTH)
 19027*    END-EXEC.
 19028     MOVE 'ELRAMT' TO DFHEIV1
 19029*    MOVE '."C                   (   #00018641' TO DFHEIV0
 19030     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19031     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19032     MOVE X'2020233030303138363431' TO DFHEIV0(25:11)
 19033     CALL 'kxdfhei1' USING DFHEIV0,
 19034           DFHEIV1,
 19035           CALCULATION-PASS-AREA,
 19036           CP-COMM-LENGTH,
 19037           DFHEIV99,
 19038           DFHEIV99,
 19039           DFHEIV99,
 19040           DFHEIV99
 19041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19042
 19043
 19044 7500-EXIT.
 19045     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 351
* EL050.cbl
 19047
 19048 7600-GET-REFUND.
 19049
 19050* EXEC CICS LINK
 19051*        PROGRAM    ('ELRFND')
 19052*        COMMAREA   (CALCULATION-PASS-AREA)
 19053*        LENGTH     (CP-COMM-LENGTH)
 19054*    END-EXEC.
 19055     MOVE 'ELRFND' TO DFHEIV1
 19056*    MOVE '."C                   (   #00018652' TO DFHEIV0
 19057     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19058     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19059     MOVE X'2020233030303138363532' TO DFHEIV0(25:11)
 19060     CALL 'kxdfhei1' USING DFHEIV0,
 19061           DFHEIV1,
 19062           CALCULATION-PASS-AREA,
 19063           CP-COMM-LENGTH,
 19064           DFHEIV99,
 19065           DFHEIV99,
 19066           DFHEIV99,
 19067           DFHEIV99
 19068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19069
 19070
 19071 7600-EXIT.
 19072     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 352
* EL050.cbl
 19074 7700-CALL-DL1.
 19075
 19076* EXEC CICS LINK
 19077*        PROGRAM    ('DLO001')
 19078*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 19079*        LENGTH     (DLO001-COMM-LENGTH)
 19080*    END-EXEC.
 19081     MOVE 'DLO001' TO DFHEIV1
 19082*    MOVE '."C                   (   #00018662' TO DFHEIV0
 19083     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19084     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19085     MOVE X'2020233030303138363632' TO DFHEIV0(25:11)
 19086     CALL 'kxdfhei1' USING DFHEIV0,
 19087           DFHEIV1,
 19088           WS-DLO-MASTER-POLICY-FORM,
 19089           DLO001-COMM-LENGTH,
 19090           DFHEIV99,
 19091           DFHEIV99,
 19092           DFHEIV99,
 19093           DFHEIV99
 19094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19095
 19096
 19097 7700-EXIT.
 19098     EXIT.
 19099
 19100 7710-CALL-DL2.
 19101
 19102* EXEC CICS LINK
 19103*        PROGRAM    ('DLO002')
 19104*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 19105*        LENGTH     (DLO002-COMM-LENGTH)
 19106*    END-EXEC.
 19107     MOVE 'DLO002' TO DFHEIV1
 19108*    MOVE '."C                   (   #00018672' TO DFHEIV0
 19109     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19110     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19111     MOVE X'2020233030303138363732' TO DFHEIV0(25:11)
 19112     CALL 'kxdfhei1' USING DFHEIV0,
 19113           DFHEIV1,
 19114           WS-DLO-INTERNAL-POLICY-FORM,
 19115           DLO002-COMM-LENGTH,
 19116           DFHEIV99,
 19117           DFHEIV99,
 19118           DFHEIV99,
 19119           DFHEIV99
 19120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19121
 19122
 19123 7710-EXIT.
 19124     EXIT.
 19125
 19126 7720-CALL-DL3.
 19127
 19128* EXEC CICS LINK
 19129*        PROGRAM    ('DLO003')
 19130*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 19131*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 353
* EL050.cbl
 19132*    END-EXEC.
 19133     MOVE 'DLO003' TO DFHEIV1
 19134*    MOVE '."C                   (   #00018682' TO DFHEIV0
 19135     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19136     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19137     MOVE X'2020233030303138363832' TO DFHEIV0(25:11)
 19138     CALL 'kxdfhei1' USING DFHEIV0,
 19139           DFHEIV1,
 19140           WS-DLO-VALID-BANK-ID,
 19141           DLO003-COMM-LENGTH,
 19142           DFHEIV99,
 19143           DFHEIV99,
 19144           DFHEIV99,
 19145           DFHEIV99
 19146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19147
 19148
 19149 7720-EXIT.
 19150     EXIT.
 19151
 19152 7730-CALL-DL7.
 19153
 19154* EXEC CICS LINK
 19155*        PROGRAM    ('DLO007')
 19156*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 19157*        LENGTH     (DLO007-COMM-LENGTH)
 19158*    END-EXEC.
 19159     MOVE 'DLO007' TO DFHEIV1
 19160*    MOVE '."C                   (   #00018692' TO DFHEIV0
 19161     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19162     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19163     MOVE X'2020233030303138363932' TO DFHEIV0(25:11)
 19164     CALL 'kxdfhei1' USING DFHEIV0,
 19165           DFHEIV1,
 19166           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 19167           DLO007-COMM-LENGTH,
 19168           DFHEIV99,
 19169           DFHEIV99,
 19170           DFHEIV99,
 19171           DFHEIV99
 19172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19173
 19174
 19175 7730-EXIT.
 19176     EXIT.
 19177
 19178 7740-CALL-DL11.
 19179
 19180* EXEC CICS LINK
 19181*        PROGRAM    ('DLO011')
 19182*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 19183*        LENGTH     (DLO011-COMM-LENGTH)
 19184*    END-EXEC.
 19185     MOVE 'DLO011' TO DFHEIV1
 19186*    MOVE '."C                   (   #00018702' TO DFHEIV0
 19187     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19188     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19189     MOVE X'2020233030303138373032' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 354
* EL050.cbl
 19190     CALL 'kxdfhei1' USING DFHEIV0,
 19191           DFHEIV1,
 19192           WS-DLO-PREM-RATES-BEN-TYPE,
 19193           DLO011-COMM-LENGTH,
 19194           DFHEIV99,
 19195           DFHEIV99,
 19196           DFHEIV99,
 19197           DFHEIV99
 19198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19199
 19200
 19201 7740-EXIT.
 19202     EXIT.
 19203
 19204 7750-CALL-DL17.
 19205
 19206* EXEC CICS LINK
 19207*        PROGRAM    ('DLO017')
 19208*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 19209*        LENGTH     (DLO017-COMM-LENGTH)
 19210*    END-EXEC.
 19211     MOVE 'DLO017' TO DFHEIV1
 19212*    MOVE '."C                   (   #00018712' TO DFHEIV0
 19213     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19214     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19215     MOVE X'2020233030303138373132' TO DFHEIV0(25:11)
 19216     CALL 'kxdfhei1' USING DFHEIV0,
 19217           DFHEIV1,
 19218           WS-DLO-VALID-RATE-CODE,
 19219           DLO017-COMM-LENGTH,
 19220           DFHEIV99,
 19221           DFHEIV99,
 19222           DFHEIV99,
 19223           DFHEIV99
 19224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19225
 19226
 19227 7750-EXIT.
 19228     EXIT.
 19229
 19230 7755-CALL-DL19.
 19231
 19232* EXEC CICS LINK
 19233*        PROGRAM    ('DLO019')
 19234*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 19235*        LENGTH     (DLO019-COMM-LENGTH)
 19236*    END-EXEC.
 19237     MOVE 'DLO019' TO DFHEIV1
 19238*    MOVE '."C                   (   #00018722' TO DFHEIV0
 19239     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19240     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19241     MOVE X'2020233030303138373232' TO DFHEIV0(25:11)
 19242     CALL 'kxdfhei1' USING DFHEIV0,
 19243           DFHEIV1,
 19244           WS-DLO-ORIG-COV-CAT,
 19245           DLO019-COMM-LENGTH,
 19246           DFHEIV99,
 19247           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 355
* EL050.cbl
 19248           DFHEIV99,
 19249           DFHEIV99
 19250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19251
 19252
 19253 7755-EXIT.
 19254     EXIT.
 19255
 19256 7760-CALL-DL21.
 19257
 19258* EXEC CICS LINK
 19259*        PROGRAM    ('DLO021')
 19260*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 19261*        LENGTH     (DLO021-COMM-LENGTH)
 19262*    END-EXEC.
 19263     MOVE 'DLO021' TO DFHEIV1
 19264*    MOVE '."C                   (   #00018732' TO DFHEIV0
 19265     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19266     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19267     MOVE X'2020233030303138373332' TO DFHEIV0(25:11)
 19268     CALL 'kxdfhei1' USING DFHEIV0,
 19269           DFHEIV1,
 19270           WS-DLO-VALID-LOAN-OFFICER,
 19271           DLO021-COMM-LENGTH,
 19272           DFHEIV99,
 19273           DFHEIV99,
 19274           DFHEIV99,
 19275           DFHEIV99
 19276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19277
 19278
 19279 7760-EXIT.
 19280     EXIT.
 19281
 19282 7770-CALL-DL22.
 19283
 19284* EXEC CICS LINK
 19285*        PROGRAM    ('DLO022')
 19286*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 19287*        LENGTH     (DLO022-COMM-LENGTH)
 19288*    END-EXEC.
 19289     MOVE 'DLO022' TO DFHEIV1
 19290*    MOVE '."C                   (   #00018742' TO DFHEIV0
 19291     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19292     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19293     MOVE X'2020233030303138373432' TO DFHEIV0(25:11)
 19294     CALL 'kxdfhei1' USING DFHEIV0,
 19295           DFHEIV1,
 19296           WS-DLO-VALID-STATE-CODE,
 19297           DLO022-COMM-LENGTH,
 19298           DFHEIV99,
 19299           DFHEIV99,
 19300           DFHEIV99,
 19301           DFHEIV99
 19302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19303
 19304
 19305 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 356
* EL050.cbl
 19306     EXIT.
 19307
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 357
* EL050.cbl
 19309
 19310 7800-REWRITE-CERT.
 19311******************************************************************
 19312*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 19313*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 19314******************************************************************
 19315
 19316     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 19317        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 19318        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 19319        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 19320
 19321* EXEC CICS REWRITE
 19322*                  DATASET (CERT-ID)
 19323*                  FROM    (CERTIFICATE-MASTER)
 19324*              END-EXEC
 19325     MOVE LENGTH OF
 19326      CERTIFICATE-MASTER
 19327       TO DFHEIV11
 19328*    MOVE '&& L                  %   #00018763' TO DFHEIV0
 19329     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19330     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19331     MOVE X'2020233030303138373633' TO DFHEIV0(25:11)
 19332     CALL 'kxdfhei1' USING DFHEIV0,
 19333           CERT-ID,
 19334           CERTIFICATE-MASTER,
 19335           DFHEIV11,
 19336           DFHEIV99
 19337     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19338        GO TO 7800-EXIT.
 19339
 19340       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 19341       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 19342
 19343 7800-EXIT.
 19344      EXIT.
 19345
 19346 7900-DELETE-CERT.
 19347
 19348* EXEC CICS DELETE
 19349*        DATASET (CERT-ID)
 19350*    END-EXEC.
 19351*    MOVE '&(                    &   #00018776' TO DFHEIV0
 19352     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 19353     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19354     MOVE X'2020233030303138373736' TO DFHEIV0(25:11)
 19355     CALL 'kxdfhei1' USING DFHEIV0,
 19356           CERT-ID,
 19357           DFHEIV99,
 19358           DFHEIV99,
 19359           DFHEIV99,
 19360           DFHEIV99
 19361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19362
 19363
 19364 7900-EXIT.
 19365     EXIT.
 19366
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 358
* EL050.cbl
 19367 8000-WRITE-CERT.
 19368
 19369* EXEC CICS HANDLE CONDITION
 19370*        DUPKEY    (8000-FREE-MAIN)
 19371*    END-EXEC.
 19372*    MOVE '"$$                   ! + #00018784' TO DFHEIV0
 19373     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19374     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19375     MOVE X'2B20233030303138373834' TO DFHEIV0(25:11)
 19376     CALL 'kxdfhei1' USING DFHEIV0
 19377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19378
 19379
 19380
 19381* EXEC CICS WRITE
 19382*        DATASET     (CERT-ID)
 19383*        FROM        (CERTIFICATE-MASTER)
 19384*        RIDFLD      (ELCERT-KEY)
 19385*    END-EXEC.
 19386     MOVE LENGTH OF
 19387      CERTIFICATE-MASTER
 19388       TO DFHEIV11
 19389*    MOVE '&$ L                  ''   #00018788' TO DFHEIV0
 19390     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19391     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19392     MOVE X'2020233030303138373838' TO DFHEIV0(25:11)
 19393     CALL 'kxdfhei1' USING DFHEIV0,
 19394           CERT-ID,
 19395           CERTIFICATE-MASTER,
 19396           DFHEIV11,
 19397           ELCERT-KEY,
 19398           DFHEIV99,
 19399           DFHEIV99
 19400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19401
 19402
 19403 8000-FREE-MAIN.
 19404
 19405 8000-EXIT.
 19406      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 359
* EL050.cbl
 19408
 19409 8100-READ-ERPNDM.
 19410
 19411* EXEC CICS HANDLE CONDITION
 19412*         NOTFND     (8100-NOTFND)
 19413*         ENDFILE    (8100-NOTFND)
 19414*    END-EXEC.
 19415*    MOVE '"$I''                  ! , #00018801' TO DFHEIV0
 19416     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19417     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19418     MOVE X'2C20233030303138383031' TO DFHEIV0(25:11)
 19419     CALL 'kxdfhei1' USING DFHEIV0
 19420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19421
 19422
 19423     MOVE SPACES                 TO ERPNDM-FOUND.
 19424     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19425
 19426
 19427* EXEC CICS READ
 19428*         DATASET   (FILE-ERPNDM)
 19429*         RIDFLD    (PM-CONTROL-PRIMARY)
 19430*         INTO      (PENDING-MAILING-DATA)
 19431*    END-EXEC.
 19432     MOVE LENGTH OF
 19433      PENDING-MAILING-DATA
 19434       TO DFHEIV11
 19435*    MOVE '&"IL       E          (   #00018809' TO DFHEIV0
 19436     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19437     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19438     MOVE X'2020233030303138383039' TO DFHEIV0(25:11)
 19439     CALL 'kxdfhei1' USING DFHEIV0,
 19440           FILE-ERPNDM,
 19441           PENDING-MAILING-DATA,
 19442           DFHEIV11,
 19443           PM-CONTROL-PRIMARY,
 19444           DFHEIV99,
 19445           DFHEIV99,
 19446           DFHEIV99
 19447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19448
 19449
 19450     GO TO 8100-EXIT.
 19451
 19452 8100-NOTFND.
 19453
 19454     MOVE 'X'                    TO ERPNDM-FOUND.
 19455     MOVE ER-2694                TO WS-ERROR.
 19456     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19457     MOVE ER-2883                TO WS-ERROR
 19458     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 19459     .
 19460 8100-EXIT.
 19461     EXIT.
 19462
 19463 8110-READ-ERMAIL.
 19464
 19465* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 360
* EL050.cbl
 19466*         NOTFND     (8110-NOTFND)
 19467*         ENDFILE    (8110-NOTFND)
 19468*    END-EXEC.
 19469*    MOVE '"$I''                  ! - #00018829' TO DFHEIV0
 19470     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19471     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19472     MOVE X'2D20233030303138383239' TO DFHEIV0(25:11)
 19473     CALL 'kxdfhei1' USING DFHEIV0
 19474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19475
 19476
 19477     MOVE SPACES                 TO ERMAIL-FOUND.
 19478     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 19479     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 19480     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 19481     MOVE PB-SV-STATE            TO MA-STATE.
 19482
 19483
 19484* EXEC CICS READ
 19485*         UPDATE
 19486*         DATASET   (FILE-ERMAIL)
 19487*         RIDFLD    (MA-CONTROL-PRIMARY)
 19488*         INTO      (MAILING-DATA)
 19489*    END-EXEC.
 19490     MOVE LENGTH OF
 19491      MAILING-DATA
 19492       TO DFHEIV11
 19493*    MOVE '&"IL       EU         (   #00018840' TO DFHEIV0
 19494     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19495     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19496     MOVE X'2020233030303138383430' TO DFHEIV0(25:11)
 19497     CALL 'kxdfhei1' USING DFHEIV0,
 19498           FILE-ERMAIL,
 19499           MAILING-DATA,
 19500           DFHEIV11,
 19501           MA-CONTROL-PRIMARY,
 19502           DFHEIV99,
 19503           DFHEIV99,
 19504           DFHEIV99
 19505     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19506
 19507
 19508     GO TO 8110-EXIT.
 19509
 19510 8110-NOTFND.
 19511     MOVE 'X'                    TO ERMAIL-FOUND.
 19512
 19513 8110-EXIT.
 19514     EXIT.
 19515
 19516 8120-REWRITE-ERMAIL.
 19517
 19518* EXEC CICS REWRITE
 19519*         DATASET    (FILE-ERMAIL)
 19520*         FROM       (MAILING-DATA)
 19521*    END-EXEC.
 19522     MOVE LENGTH OF
 19523      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 361
* EL050.cbl
 19524       TO DFHEIV11
 19525*    MOVE '&& L                  %   #00018856' TO DFHEIV0
 19526     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19527     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19528     MOVE X'2020233030303138383536' TO DFHEIV0(25:11)
 19529     CALL 'kxdfhei1' USING DFHEIV0,
 19530           FILE-ERMAIL,
 19531           MAILING-DATA,
 19532           DFHEIV11,
 19533           DFHEIV99
 19534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19535
 19536
 19537 8120-EXIT.
 19538     EXIT.
 19539
 19540 8130-WRITE-ERMAIL.
 19541
 19542* EXEC CICS HANDLE CONDITION
 19543*         DUPKEY   (8130-EXIT)
 19544*    END-EXEC.
 19545*    MOVE '"$$                   ! . #00018865' TO DFHEIV0
 19546     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19547     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19548     MOVE X'2E20233030303138383635' TO DFHEIV0(25:11)
 19549     CALL 'kxdfhei1' USING DFHEIV0
 19550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19551
 19552
 19553
 19554* EXEC CICS WRITE
 19555*         DATASET     (FILE-ERMAIL)
 19556*         RIDFLD      (MA-CONTROL-PRIMARY)
 19557*         FROM        (MAILING-DATA)
 19558*    END-EXEC.
 19559     MOVE LENGTH OF
 19560      MAILING-DATA
 19561       TO DFHEIV11
 19562*    MOVE '&$ L                  ''   #00018869' TO DFHEIV0
 19563     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19564     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19565     MOVE X'2020233030303138383639' TO DFHEIV0(25:11)
 19566     CALL 'kxdfhei1' USING DFHEIV0,
 19567           FILE-ERMAIL,
 19568           MAILING-DATA,
 19569           DFHEIV11,
 19570           MA-CONTROL-PRIMARY,
 19571           DFHEIV99,
 19572           DFHEIV99
 19573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19574
 19575
 19576 8130-EXIT.
 19577     EXIT.
 19578
 19579 8140-UNLOCK-ERMAIL.
 19580
 19581* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 362
* EL050.cbl
 19582*         DATASET   (FILE-ERMAIL)
 19583*    END-EXEC.
 19584*    MOVE '&*                    #   #00018879' TO DFHEIV0
 19585     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19586     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19587     MOVE X'2020233030303138383739' TO DFHEIV0(25:11)
 19588     CALL 'kxdfhei1' USING DFHEIV0,
 19589           FILE-ERMAIL,
 19590           DFHEIV99
 19591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19592
 19593
 19594 8140-EXIT.
 19595     EXIT.
 19596
 19597 8180-UPDATE-VIN-NUMBER.
 19598
 19599* EXEC CICS HANDLE CONDITION
 19600*        NOTFND   (8180-NOTFND)
 19601*    END-EXEC.
 19602*    MOVE '"$I                   ! / #00018887' TO DFHEIV0
 19603     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19604     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19605     MOVE X'2F20233030303138383837' TO DFHEIV0(25:11)
 19606     CALL 'kxdfhei1' USING DFHEIV0
 19607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19608
 19609
 19610     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19611     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19612
 19613
 19614* EXEC CICS READ
 19615*        UPDATE
 19616*        DATASET  (CRTT-ID)
 19617*        RIDFLD   (WS-ELCRTT-KEY)
 19618*        INTO     (CERTIFICATE-TRAILERS)
 19619*    END-EXEC.
 19620     MOVE LENGTH OF
 19621      CERTIFICATE-TRAILERS
 19622       TO DFHEIV11
 19623*    MOVE '&"IL       EU         (   #00018894' TO DFHEIV0
 19624     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19625     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19626     MOVE X'2020233030303138383934' TO DFHEIV0(25:11)
 19627     CALL 'kxdfhei1' USING DFHEIV0,
 19628           CRTT-ID,
 19629           CERTIFICATE-TRAILERS,
 19630           DFHEIV11,
 19631           WS-ELCRTT-KEY,
 19632           DFHEIV99,
 19633           DFHEIV99,
 19634           DFHEIV99
 19635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19636
 19637
 19638     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 19639         MOVE PB-I-VIN TO CS-VIN-NUMBER
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 363
* EL050.cbl
 19640
 19641* EXEC CICS REWRITE
 19642*           DATASET  (CRTT-ID)
 19643*           FROM     (CERTIFICATE-TRAILERS)
 19644*        END-EXEC
 19645     MOVE LENGTH OF
 19646      CERTIFICATE-TRAILERS
 19647       TO DFHEIV11
 19648*    MOVE '&& L                  %   #00018903' TO DFHEIV0
 19649     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19650     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19651     MOVE X'2020233030303138393033' TO DFHEIV0(25:11)
 19652     CALL 'kxdfhei1' USING DFHEIV0,
 19653           CRTT-ID,
 19654           CERTIFICATE-TRAILERS,
 19655           DFHEIV11,
 19656           DFHEIV99
 19657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19658     ELSE
 19659
 19660* EXEC CICS UNLOCK
 19661*          DATASET  (CRTT-ID)
 19662*       END-EXEC
 19663*    MOVE '&*                    #   #00018908' TO DFHEIV0
 19664     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19665     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19666     MOVE X'2020233030303138393038' TO DFHEIV0(25:11)
 19667     CALL 'kxdfhei1' USING DFHEIV0,
 19668           CRTT-ID,
 19669           DFHEIV99
 19670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19671     END-IF.
 19672
 19673     GO TO 8180-EXIT.
 19674
 19675 8180-NOTFND.
 19676
 19677     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19678     MOVE 'CS'         TO CS-RECORD-ID.
 19679     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19680     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19681     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19682     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 19683
 19684* EXEC CICS WRITE
 19685*       DATASET  (CRTT-ID)
 19686*       RIDFLD   (WS-ELCRTT-KEY)
 19687*       FROM     (CERTIFICATE-TRAILERS)
 19688*    END-EXEC.
 19689     MOVE LENGTH OF
 19690      CERTIFICATE-TRAILERS
 19691       TO DFHEIV11
 19692*    MOVE '&$ L                  ''   #00018923' TO DFHEIV0
 19693     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19694     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19695     MOVE X'2020233030303138393233' TO DFHEIV0(25:11)
 19696     CALL 'kxdfhei1' USING DFHEIV0,
 19697           CRTT-ID,
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 364
* EL050.cbl
 19698           CERTIFICATE-TRAILERS,
 19699           DFHEIV11,
 19700           WS-ELCRTT-KEY,
 19701           DFHEIV99,
 19702           DFHEIV99
 19703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19704
 19705
 19706 8180-EXIT.
 19707     EXIT.
 19708
 19709 8190-UPDATE-REFUND-CLAIM-FLAG.
 19710
 19711* EXEC CICS HANDLE CONDITION
 19712*        NOTFND   (8190-NOTFND)
 19713*    END-EXEC.
 19714*    MOVE '"$I                   ! 0 #00018933' TO DFHEIV0
 19715     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19716     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19717     MOVE X'3020233030303138393333' TO DFHEIV0(25:11)
 19718     CALL 'kxdfhei1' USING DFHEIV0
 19719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19720
 19721
 19722     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19723     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19724
 19725
 19726* EXEC CICS READ
 19727*        UPDATE
 19728*        DATASET  (CRTT-ID)
 19729*        RIDFLD   (WS-ELCRTT-KEY)
 19730*        INTO     (CERTIFICATE-TRAILERS)
 19731*    END-EXEC.
 19732     MOVE LENGTH OF
 19733      CERTIFICATE-TRAILERS
 19734       TO DFHEIV11
 19735*    MOVE '&"IL       EU         (   #00018940' TO DFHEIV0
 19736     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19737     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19738     MOVE X'2020233030303138393430' TO DFHEIV0(25:11)
 19739     CALL 'kxdfhei1' USING DFHEIV0,
 19740           CRTT-ID,
 19741           CERTIFICATE-TRAILERS,
 19742           DFHEIV11,
 19743           WS-ELCRTT-KEY,
 19744           DFHEIV99,
 19745           DFHEIV99,
 19746           DFHEIV99
 19747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19748
 19749
 19750     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19751
 19752* EXEC CICS REWRITE
 19753*       DATASET  (CRTT-ID)
 19754*       FROM     (CERTIFICATE-TRAILERS)
 19755*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 365
* EL050.cbl
 19756     MOVE LENGTH OF
 19757      CERTIFICATE-TRAILERS
 19758       TO DFHEIV11
 19759*    MOVE '&& L                  %   #00018948' TO DFHEIV0
 19760     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19761     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19762     MOVE X'2020233030303138393438' TO DFHEIV0(25:11)
 19763     CALL 'kxdfhei1' USING DFHEIV0,
 19764           CRTT-ID,
 19765           CERTIFICATE-TRAILERS,
 19766           DFHEIV11,
 19767           DFHEIV99
 19768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19769
 19770
 19771     GO TO 8190-EXIT.
 19772
 19773 8190-NOTFND.
 19774
 19775     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19776     MOVE 'CS'         TO CS-RECORD-ID.
 19777     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19778     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19779     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19780     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19781
 19782* EXEC CICS WRITE
 19783*       DATASET  (CRTT-ID)
 19784*       RIDFLD   (WS-ELCRTT-KEY)
 19785*       FROM     (CERTIFICATE-TRAILERS)
 19786*    END-EXEC.
 19787     MOVE LENGTH OF
 19788      CERTIFICATE-TRAILERS
 19789       TO DFHEIV11
 19790*    MOVE '&$ L                  ''   #00018963' TO DFHEIV0
 19791     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19792     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19793     MOVE X'2020233030303138393633' TO DFHEIV0(25:11)
 19794     CALL 'kxdfhei1' USING DFHEIV0,
 19795           CRTT-ID,
 19796           CERTIFICATE-TRAILERS,
 19797           DFHEIV11,
 19798           WS-ELCRTT-KEY,
 19799           DFHEIV99,
 19800           DFHEIV99
 19801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19802
 19803
 19804 8190-EXIT.
 19805     EXIT.
 19806
 19807 8195-UPDATE-AGE-FLAGS.
 19808
 19809* EXEC CICS HANDLE CONDITION
 19810*        NOTFND   (8195-NOTFND)
 19811*    END-EXEC.
 19812*    MOVE '"$I                   ! 1 #00018973' TO DFHEIV0
 19813     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 366
* EL050.cbl
 19814     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19815     MOVE X'3120233030303138393733' TO DFHEIV0(25:11)
 19816     CALL 'kxdfhei1' USING DFHEIV0
 19817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19818
 19819
 19820     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19821     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19822
 19823
 19824* EXEC CICS READ
 19825*        UPDATE
 19826*        DATASET  (CRTT-ID)
 19827*        RIDFLD   (WS-ELCRTT-KEY)
 19828*        INTO     (CERTIFICATE-TRAILERS)
 19829*    END-EXEC.
 19830     MOVE LENGTH OF
 19831      CERTIFICATE-TRAILERS
 19832       TO DFHEIV11
 19833*    MOVE '&"IL       EU         (   #00018980' TO DFHEIV0
 19834     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19835     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19836     MOVE X'2020233030303138393830' TO DFHEIV0(25:11)
 19837     CALL 'kxdfhei1' USING DFHEIV0,
 19838           CRTT-ID,
 19839           CERTIFICATE-TRAILERS,
 19840           DFHEIV11,
 19841           WS-ELCRTT-KEY,
 19842           DFHEIV99,
 19843           DFHEIV99,
 19844           DFHEIV99
 19845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19846
 19847
 19848     IF WS-INS-AGE-SET = 'Y'
 19849        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 19850     END-IF
 19851     IF WS-JNT-AGE-SET = 'Y'
 19852        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 19853     END-IF
 19854
 19855
 19856* EXEC CICS REWRITE
 19857*       DATASET  (CRTT-ID)
 19858*       FROM     (CERTIFICATE-TRAILERS)
 19859*    END-EXEC.
 19860     MOVE LENGTH OF
 19861      CERTIFICATE-TRAILERS
 19862       TO DFHEIV11
 19863*    MOVE '&& L                  %   #00018994' TO DFHEIV0
 19864     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19865     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19866     MOVE X'2020233030303138393934' TO DFHEIV0(25:11)
 19867     CALL 'kxdfhei1' USING DFHEIV0,
 19868           CRTT-ID,
 19869           CERTIFICATE-TRAILERS,
 19870           DFHEIV11,
 19871           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 367
* EL050.cbl
 19872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19873
 19874
 19875     GO TO 8195-EXIT.
 19876
 19877 8195-NOTFND.
 19878
 19879     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19880     MOVE 'CS'         TO CS-RECORD-ID.
 19881     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19882     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19883     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19884     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 19885     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 19886
 19887* EXEC CICS WRITE
 19888*       DATASET  (CRTT-ID)
 19889*       RIDFLD   (WS-ELCRTT-KEY)
 19890*       FROM     (CERTIFICATE-TRAILERS)
 19891*    END-EXEC.
 19892     MOVE LENGTH OF
 19893      CERTIFICATE-TRAILERS
 19894       TO DFHEIV11
 19895*    MOVE '&$ L                  ''   #00019010' TO DFHEIV0
 19896     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19897     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19898     MOVE X'2020233030303139303130' TO DFHEIV0(25:11)
 19899     CALL 'kxdfhei1' USING DFHEIV0,
 19900           CRTT-ID,
 19901           CERTIFICATE-TRAILERS,
 19902           DFHEIV11,
 19903           WS-ELCRTT-KEY,
 19904           DFHEIV99,
 19905           DFHEIV99
 19906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19907
 19908
 19909 8195-EXIT.
 19910     EXIT.
 19911
 19912 8200-READ-REIN-TABLE.
 19913
 19914* EXEC CICS HANDLE CONDITION
 19915*         NOTFND   (8200-NOTFND)
 19916*    END-EXEC.
 19917*    MOVE '"$I                   ! 2 #00019020' TO DFHEIV0
 19918     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19919     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19920     MOVE X'3220233030303139303230' TO DFHEIV0(25:11)
 19921     CALL 'kxdfhei1' USING DFHEIV0
 19922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19923
 19924
 19925
 19926* EXEC CICS READ
 19927*        DATASET     (REIN-ID)
 19928*        SET         (ADDRESS OF REINSURANCE-RECORD)
 19929*        RIDFLD      (ERREIN-KEY)
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 368
* EL050.cbl
 19930*    END-EXEC.
 19931*    MOVE '&"S        E          (   #00019024' TO DFHEIV0
 19932     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19933     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19934     MOVE X'2020233030303139303234' TO DFHEIV0(25:11)
 19935     CALL 'kxdfhei1' USING DFHEIV0,
 19936           REIN-ID,
 19937           DFHEIV20,
 19938           DFHEIV99,
 19939           ERREIN-KEY,
 19940           DFHEIV99,
 19941           DFHEIV99,
 19942           DFHEIV99
 19943     SET ADDRESS OF REINSURANCE-RECORD TO
 19944         DFHEIV20
 19945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19946
 19947
 19948     GO TO 8200-EXIT.
 19949
 19950 8200-NOTFND.
 19951     MOVE 'N'             TO WS-REIN-READ-SW.
 19952
 19953 8200-EXIT.
 19954      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 369
* EL050.cbl
 19956
 19957 8300-READ-CTBL-TABLE.
 19958
 19959* EXEC CICS HANDLE CONDITION
 19960*        NOTFND    (8300-NOTFND)
 19961*        DISABLED  (8300-ERRESS-PROBLEM)
 19962*        NOTOPEN   (8300-ERRESS-PROBLEM)
 19963*        ENDFILE   (8300-NOTFND)
 19964*    END-EXEC.
 19965*    MOVE '"$IcJ''                ! 3 #00019040' TO DFHEIV0
 19966     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19967     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19968     MOVE X'3320233030303139303430' TO DFHEIV0(25:11)
 19969     CALL 'kxdfhei1' USING DFHEIV0
 19970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19971
 19972
 19973
 19974* EXEC CICS READ
 19975*        DATASET     (CTBL-ID)
 19976*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 19977*        RIDFLD      (ERCTBL-KEY)
 19978*    END-EXEC.
 19979*    MOVE '&"S        E          (   #00019047' TO DFHEIV0
 19980     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19981     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19982     MOVE X'2020233030303139303437' TO DFHEIV0(25:11)
 19983     CALL 'kxdfhei1' USING DFHEIV0,
 19984           CTBL-ID,
 19985           DFHEIV20,
 19986           DFHEIV99,
 19987           ERCTBL-KEY,
 19988           DFHEIV99,
 19989           DFHEIV99,
 19990           DFHEIV99
 19991     SET ADDRESS OF COMM-TABLE-RECORD TO
 19992         DFHEIV20
 19993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19994
 19995
 19996     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 19997
 19998     GO TO 8300-EXIT.
 19999
 20000 8300-NOTFND.
 20001
 20002     IF CTBL-SW = '0530'
 20003         MOVE 'AA'                     TO WS-AH-COMP-CD
 20004         MOVE '0550'                   TO CTBL-SW
 20005         MOVE '1'                      TO WS-CTBL-READ-SW
 20006         GO TO 8300-EXIT.
 20007
 20008     IF CTBL-SW = '0540'
 20009         MOVE 'AA'                     TO WS-LF-COMP-CD
 20010         MOVE '0550'                   TO CTBL-SW
 20011         MOVE '1'                      TO WS-CTBL-READ-SW
 20012         GO TO 8300-EXIT.
 20013
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 370
* EL050.cbl
 20014     IF CTBL-SW = '0550'
 20015         MOVE '2'                      TO WS-CTBL-READ-SW
 20016         GO TO 8300-EXIT.
 20017
 20018     GO TO 8300-EXIT.
 20019
 20020 8300-ERRESS-PROBLEM.
 20021
 20022      MOVE ER-8050              TO WS-ERROR.
 20023      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20024
 20025     GO TO 8300-EXIT.
 20026
 20027 8300-EXIT.
 20028      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 371
* EL050.cbl
 20030
 20031
 20032 8400-GETMAIN-ERFORM.
 20033
 20034
 20035* EXEC CICS   GETMAIN
 20036*        LENGTH  (500)
 20037*        SET     (ADDRESS OF FORM-MASTER)
 20038*    END-EXEC.
 20039     MOVE 500
 20040       TO DFHEIV11
 20041*    MOVE '," L                  $   #00019091' TO DFHEIV0
 20042     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20043     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20044     MOVE X'2020233030303139303931' TO DFHEIV0(25:11)
 20045     CALL 'kxdfhei1' USING DFHEIV0,
 20046           DFHEIV20,
 20047           DFHEIV11,
 20048           DFHEIV99
 20049     SET ADDRESS OF FORM-MASTER TO
 20050         DFHEIV20
 20051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20052
 20053
 20054     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 20055
 20056 8400-EXIT.
 20057      EXIT.
 20058
 20059 8450-READ-FORM-MASTER.
 20060
 20061
 20062* EXEC CICS  HANDLE CONDITION
 20063*        NOTFND   (8450-FORM-NOT-FOUND)
 20064*        ENDFILE  (8450-FORM-NOT-FOUND)
 20065*    END-EXEC.
 20066*    MOVE '"$I''                  ! 4 #00019103' TO DFHEIV0
 20067     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20068     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20069     MOVE X'3420233030303139313033' TO DFHEIV0(25:11)
 20070     CALL 'kxdfhei1' USING DFHEIV0
 20071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20072
 20073
 20074
 20075* EXEC CICS   READ
 20076*        DATASET   (FORM-ID)
 20077*        RIDFLD    (ERFORM-KEY)
 20078*        INTO      (FORM-MASTER)
 20079*        GTEQ
 20080*    END-EXEC.
 20081     MOVE LENGTH OF
 20082      FORM-MASTER
 20083       TO DFHEIV11
 20084*    MOVE '&"IL       G          (   #00019108' TO DFHEIV0
 20085     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20086     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20087     MOVE X'2020233030303139313038' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 372
* EL050.cbl
 20088     CALL 'kxdfhei1' USING DFHEIV0,
 20089           FORM-ID,
 20090           FORM-MASTER,
 20091           DFHEIV11,
 20092           ERFORM-KEY,
 20093           DFHEIV99,
 20094           DFHEIV99,
 20095           DFHEIV99
 20096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20097
 20098
 20099     MOVE  'Y'           TO  FORM-MASTER-SW.
 20100
 20101     GO TO  8450-EXIT.
 20102
 20103 8450-FORM-NOT-FOUND.
 20104
 20105     MOVE  'N'           TO  FORM-MASTER-SW.
 20106
 20107 8450-EXIT.
 20108      EXIT.
 20109
 20110 8500-DATE-CONVERT.
 20111
 20112* EXEC CICS LINK
 20113*        PROGRAM    ('ELDATCV')
 20114*        COMMAREA   (DATE-CONVERSION-DATA)
 20115*        LENGTH     (DC-COMM-LENGTH)
 20116*    END-EXEC.
 20117     MOVE 'ELDATCV' TO DFHEIV1
 20118*    MOVE '."C                   (   #00019127' TO DFHEIV0
 20119     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20120     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20121     MOVE X'2020233030303139313237' TO DFHEIV0(25:11)
 20122     CALL 'kxdfhei1' USING DFHEIV0,
 20123           DFHEIV1,
 20124           DATE-CONVERSION-DATA,
 20125           DC-COMM-LENGTH,
 20126           DFHEIV99,
 20127           DFHEIV99,
 20128           DFHEIV99,
 20129           DFHEIV99
 20130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20131
 20132
 20133 8500-EXIT.
 20134     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 373
* EL050.cbl
 20136
 20137 8555-RELOAD-CONTROL-FILE.
 20138     CONTINUE.
 20139
 20140 8555-EXIT.
 20141     EXIT.
 20142
 20143 8557-GETMAIN-ERPLAN.
 20144
 20145
 20146* EXEC CICS GETMAIN
 20147*        LENGTH    (840)
 20148*        SET       (ADDRESS OF PLAN-RECORDS)
 20149*    END-EXEC.
 20150     MOVE 840
 20151       TO DFHEIV11
 20152*    MOVE '," L                  $   #00019145' TO DFHEIV0
 20153     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20154     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20155     MOVE X'2020233030303139313435' TO DFHEIV0(25:11)
 20156     CALL 'kxdfhei1' USING DFHEIV0,
 20157           DFHEIV20,
 20158           DFHEIV11,
 20159           DFHEIV99
 20160     SET ADDRESS OF PLAN-RECORDS TO
 20161         DFHEIV20
 20162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20163
 20164
 20165     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 20166
 20167 8557-EXIT.
 20168     EXIT.
 20169
 20170 8560-GETMAIN.
 20171
 20172* EXEC CICS GETMAIN
 20173*        LENGTH    (2000)
 20174*        SET       (ADDRESS OF ACCOUNT-MASTER)
 20175*    END-EXEC.
 20176     MOVE 2000
 20177       TO DFHEIV11
 20178*    MOVE '," L                  $   #00019156' TO DFHEIV0
 20179     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20180     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20181     MOVE X'2020233030303139313536' TO DFHEIV0(25:11)
 20182     CALL 'kxdfhei1' USING DFHEIV0,
 20183           DFHEIV20,
 20184           DFHEIV11,
 20185           DFHEIV99
 20186     SET ADDRESS OF ACCOUNT-MASTER TO
 20187         DFHEIV20
 20188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20189
 20190
 20191     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 20192
 20193 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 374
* EL050.cbl
 20194     EXIT.
 20195
 20196 8570-START-ACCOUNT-MASTER.
 20197
 20198* EXEC CICS HANDLE CONDITION
 20199*        NOTFND    (0199-ACCT-NOT-FOUND)
 20200*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20201*    END-EXEC.
 20202*    MOVE '"$I''                  ! 5 #00019167' TO DFHEIV0
 20203     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20204     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20205     MOVE X'3520233030303139313637' TO DFHEIV0(25:11)
 20206     CALL 'kxdfhei1' USING DFHEIV0
 20207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20208
 20209
 20210
 20211* EXEC CICS STARTBR
 20212*        DATASET    (ACCT-ID)
 20213*        RIDFLD     (ERACCT-KEY)
 20214*        GTEQ
 20215*    END-EXEC.
 20216     MOVE 0
 20217       TO DFHEIV11
 20218*    MOVE '&,         G          &   #00019172' TO DFHEIV0
 20219     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20220     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20221     MOVE X'2020233030303139313732' TO DFHEIV0(25:11)
 20222     CALL 'kxdfhei1' USING DFHEIV0,
 20223           ACCT-ID,
 20224           ERACCT-KEY,
 20225           DFHEIV99,
 20226           DFHEIV11,
 20227           DFHEIV99
 20228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20229
 20230
 20231 8570-EXIT.
 20232     EXIT.
 20233
 20234 8580-READ-ACCOUNT-MASTER.
 20235
 20236* EXEC CICS HANDLE CONDITION
 20237*        NOTFND    (0199-ACCT-NOT-FOUND)
 20238*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20239*    END-EXEC.
 20240*    MOVE '"$I''                  ! 6 #00019182' TO DFHEIV0
 20241     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20242     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20243     MOVE X'3620233030303139313832' TO DFHEIV0(25:11)
 20244     CALL 'kxdfhei1' USING DFHEIV0
 20245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20246
 20247
 20248
 20249* EXEC CICS READNEXT
 20250*        DATASET     (ACCT-ID)
 20251*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 375
* EL050.cbl
 20252*        RIDFLD      (ERACCT-KEY)
 20253*    END-EXEC.
 20254     MOVE LENGTH OF
 20255      ACCOUNT-MASTER
 20256       TO DFHEIV12
 20257     MOVE 0
 20258       TO DFHEIV11
 20259*    MOVE '&.IL                  )   #00019187' TO DFHEIV0
 20260     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20261     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20262     MOVE X'2020233030303139313837' TO DFHEIV0(25:11)
 20263     CALL 'kxdfhei1' USING DFHEIV0,
 20264           ACCT-ID,
 20265           ACCOUNT-MASTER,
 20266           DFHEIV12,
 20267           ERACCT-KEY,
 20268           DFHEIV99,
 20269           DFHEIV11,
 20270           DFHEIV99,
 20271           DFHEIV99
 20272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20273
 20274
 20275 8580-EXIT.
 20276     EXIT.
 20277
 20278 8582-READ-COMPENSATION-MASTER.
 20279
 20280* EXEC CICS HANDLE CONDITION
 20281*        NOTFND    (8582-COMP-NOT-FOUND)
 20282*        ENDFILE   (8582-COMP-NOT-FOUND)
 20283*    END-EXEC.
 20284*    MOVE '"$I''                  ! 7 #00019197' TO DFHEIV0
 20285     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20286     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20287     MOVE X'3720233030303139313937' TO DFHEIV0(25:11)
 20288     CALL 'kxdfhei1' USING DFHEIV0
 20289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20290
 20291
 20292
 20293* EXEC CICS READ
 20294*        DATASET     (COMP-ID)
 20295*        INTO        (COMPENSATION-MASTER)
 20296*        RIDFLD      (ERCOMP-KEY)
 20297*    END-EXEC.
 20298     MOVE LENGTH OF
 20299      COMPENSATION-MASTER
 20300       TO DFHEIV11
 20301*    MOVE '&"IL       E          (   #00019202' TO DFHEIV0
 20302     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20303     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20304     MOVE X'2020233030303139323032' TO DFHEIV0(25:11)
 20305     CALL 'kxdfhei1' USING DFHEIV0,
 20306           COMP-ID,
 20307           COMPENSATION-MASTER,
 20308           DFHEIV11,
 20309           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 376
* EL050.cbl
 20310           DFHEIV99,
 20311           DFHEIV99,
 20312           DFHEIV99
 20313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20314
 20315
 20316     MOVE 'Y'                    TO COMP-MASTER-SW
 20317
 20318     GO TO 8582-EXIT
 20319     .
 20320 8582-COMP-NOT-FOUND.
 20321
 20322     MOVE 'N'                    TO COMP-MASTER-SW.
 20323
 20324 8582-EXIT.
 20325     EXIT.
 20326
 20327 8583-READ-ERAGTC.
 20328
 20329* EXEC CICS HANDLE CONDITION
 20330*        NOTFND    (8583-AGTC-NOT-FOUND)
 20331*        ENDFILE   (8583-AGTC-NOT-FOUND)
 20332*    END-EXEC.
 20333*    MOVE '"$I''                  ! 8 #00019220' TO DFHEIV0
 20334     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20335     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20336     MOVE X'3820233030303139323230' TO DFHEIV0(25:11)
 20337     CALL 'kxdfhei1' USING DFHEIV0
 20338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20339
 20340
 20341
 20342* EXEC CICS STARTBR
 20343*        DATASET    (AGTC-ID)
 20344*        RIDFLD     (ERAGTC-KEY)
 20345*        GTEQ
 20346*    END-EXEC.
 20347     MOVE 0
 20348       TO DFHEIV11
 20349*    MOVE '&,         G          &   #00019225' TO DFHEIV0
 20350     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20351     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20352     MOVE X'2020233030303139323235' TO DFHEIV0(25:11)
 20353     CALL 'kxdfhei1' USING DFHEIV0,
 20354           AGTC-ID,
 20355           ERAGTC-KEY,
 20356           DFHEIV99,
 20357           DFHEIV11,
 20358           DFHEIV99
 20359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20360
 20361
 20362 8583-READ-ERAGTC-NEXT.
 20363
 20364* EXEC CICS READNEXT
 20365*        DATASET     (AGTC-ID)
 20366*        INTO        (AGENT-COMMISSIONS)
 20367*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 377
* EL050.cbl
 20368*    END-EXEC.
 20369     MOVE LENGTH OF
 20370      AGENT-COMMISSIONS
 20371       TO DFHEIV12
 20372     MOVE 0
 20373       TO DFHEIV11
 20374*    MOVE '&.IL                  )   #00019232' TO DFHEIV0
 20375     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20376     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20377     MOVE X'2020233030303139323332' TO DFHEIV0(25:11)
 20378     CALL 'kxdfhei1' USING DFHEIV0,
 20379           AGTC-ID,
 20380           AGENT-COMMISSIONS,
 20381           DFHEIV12,
 20382           ERAGTC-KEY,
 20383           DFHEIV99,
 20384           DFHEIV11,
 20385           DFHEIV99,
 20386           DFHEIV99
 20387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20388
 20389
 20390*    MOVE 'Y'                    TO AGTC-MASTER-SW
 20391
 20392     GO TO 8583-EXIT
 20393     .
 20394 8583-AGTC-NOT-FOUND.
 20395
 20396     MOVE 'N'                    TO AGTC-MASTER-SW.
 20397
 20398 8583-EXIT.
 20399     EXIT.
 20400
 20401 8584-READ-BANK-CROSS-REF.
 20402
 20403* EXEC CICS HANDLE CONDITION
 20404*        NOTFND    (8584-BXRF-NOT-FOUND)
 20405*        ENDFILE   (8584-BXRF-NOT-FOUND)
 20406*    END-EXEC.
 20407*    MOVE '"$I''                  ! 9 #00019250' TO DFHEIV0
 20408     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20409     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20410     MOVE X'3920233030303139323530' TO DFHEIV0(25:11)
 20411     CALL 'kxdfhei1' USING DFHEIV0
 20412     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20413
 20414
 20415
 20416* EXEC CICS READ
 20417*        DATASET     (BXRF-ID)
 20418*        INTO        (BANK-CROSS-REFERENCE)
 20419*        RIDFLD      (ERBXRF-KEY)
 20420*        LENGTH      (BXRF-REC-LENGTH)
 20421*    END-EXEC.
 20422*    MOVE '&"IL       E          (   #00019255' TO DFHEIV0
 20423     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20424     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20425     MOVE X'2020233030303139323535' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 378
* EL050.cbl
 20426     CALL 'kxdfhei1' USING DFHEIV0,
 20427           BXRF-ID,
 20428           BANK-CROSS-REFERENCE,
 20429           BXRF-REC-LENGTH,
 20430           ERBXRF-KEY,
 20431           DFHEIV99,
 20432           DFHEIV99,
 20433           DFHEIV99
 20434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20435
 20436
 20437     MOVE 'Y'                    TO BXRF-MASTER-SW
 20438
 20439     GO TO 8584-EXIT
 20440     .
 20441 8584-BXRF-NOT-FOUND.
 20442
 20443     MOVE 'N'                    TO BXRF-MASTER-SW.
 20444
 20445 8584-EXIT.
 20446     EXIT.
 20447
 20448 8585-READ-PLAN-MASTER.
 20449
 20450
 20451* EXEC CICS HANDLE CONDITION
 20452*        NOTFND    (8585-PLAN-NOT-FOUND)
 20453*        ENDFILE   (8585-PLAN-NOT-FOUND)
 20454*    END-EXEC.
 20455*    MOVE '"$I''                  ! : #00019275' TO DFHEIV0
 20456     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20457     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20458     MOVE X'3A20233030303139323735' TO DFHEIV0(25:11)
 20459     CALL 'kxdfhei1' USING DFHEIV0
 20460     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20461
 20462
 20463
 20464* EXEC CICS READ
 20465*        DATASET     (PLAN-ID)
 20466*        INTO        (PLAN-MASTER)
 20467*        RIDFLD      (ERPLAN-KEY)
 20468*    END-EXEC.
 20469     MOVE LENGTH OF
 20470      PLAN-MASTER
 20471       TO DFHEIV11
 20472*    MOVE '&"IL       E          (   #00019280' TO DFHEIV0
 20473     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20474     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20475     MOVE X'2020233030303139323830' TO DFHEIV0(25:11)
 20476     CALL 'kxdfhei1' USING DFHEIV0,
 20477           PLAN-ID,
 20478           PLAN-MASTER,
 20479           DFHEIV11,
 20480           ERPLAN-KEY,
 20481           DFHEIV99,
 20482           DFHEIV99,
 20483           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 379
* EL050.cbl
 20484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20485
 20486
 20487     MOVE 'Y'                    TO PLAN-MASTER-SW.
 20488
 20489     GO TO 8585-EXIT.
 20490
 20491 8585-PLAN-NOT-FOUND.
 20492
 20493     MOVE 'N'                    TO PLAN-MASTER-SW.
 20494
 20495 8585-EXIT.
 20496     EXIT.
 20497
 20498 8586-READ-LOAN-OFFICER.
 20499
 20500* EXEC CICS READ
 20501*        DATASET     (LOFC-ID)
 20502*        INTO        (LOAN-OFFICER-MASTER)
 20503*        RIDFLD      (ERLOFC-KEY)
 20504*        RESP        (WS-RESPONSE)
 20505*    END-EXEC
 20506     MOVE LENGTH OF
 20507      LOAN-OFFICER-MASTER
 20508       TO DFHEIV11
 20509*    MOVE '&"IL       E          (  N#00019298' TO DFHEIV0
 20510     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20511     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20512     MOVE X'204E233030303139323938' TO DFHEIV0(25:11)
 20513     CALL 'kxdfhei1' USING DFHEIV0,
 20514           LOFC-ID,
 20515           LOAN-OFFICER-MASTER,
 20516           DFHEIV11,
 20517           ERLOFC-KEY,
 20518           DFHEIV99,
 20519           DFHEIV99,
 20520           DFHEIV99
 20521     MOVE EIBRESP  TO WS-RESPONSE
 20522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20523
 20524     IF WS-RESP-NORMAL
 20525        MOVE 'Y'                 TO LOFC-MASTER-SW
 20526     ELSE
 20527        MOVE 'N'                 TO LOFC-MASTER-SW
 20528     END-IF
 20529     .
 20530 8586-EXIT.
 20531     EXIT.
 20532 8587-START-ERPDEF.
 20533
 20534* EXEC CICS STARTBR
 20535*       DATASET   (PDEF-ID)
 20536*       RIDFLD    (ERPDEF-KEY)
 20537*       GTEQ
 20538*       RESP      (WS-RESPONSE)
 20539*    END-EXEC
 20540     MOVE 0
 20541       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 380
* EL050.cbl
 20542*    MOVE '&,         G          &  N#00019314' TO DFHEIV0
 20543     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20544     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20545     MOVE X'204E233030303139333134' TO DFHEIV0(25:11)
 20546     CALL 'kxdfhei1' USING DFHEIV0,
 20547           PDEF-ID,
 20548           ERPDEF-KEY,
 20549           DFHEIV99,
 20550           DFHEIV11,
 20551           DFHEIV99
 20552     MOVE EIBRESP  TO WS-RESPONSE
 20553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20554     IF WS-RESP-NORMAL
 20555        MOVE 'Y'                 TO PDEF-MASTER-SW
 20556     ELSE
 20557        MOVE 'N'                 TO PDEF-MASTER-SW
 20558     END-IF
 20559     .
 20560 8587-EXIT.
 20561     EXIT.
 20562 8588-READ-ERPDEF.
 20563
 20564* EXEC CICS READNEXT
 20565*       DATASET   (PDEF-ID)
 20566*       RIDFLD    (ERPDEF-KEY)
 20567*       INTO      (PRODUCT-MASTER)
 20568*       RESP      (WS-RESPONSE)
 20569*    END-EXEC
 20570     MOVE LENGTH OF
 20571      PRODUCT-MASTER
 20572       TO DFHEIV12
 20573     MOVE 0
 20574       TO DFHEIV11
 20575*    MOVE '&.IL                  )  N#00019329' TO DFHEIV0
 20576     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20577     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20578     MOVE X'204E233030303139333239' TO DFHEIV0(25:11)
 20579     CALL 'kxdfhei1' USING DFHEIV0,
 20580           PDEF-ID,
 20581           PRODUCT-MASTER,
 20582           DFHEIV12,
 20583           ERPDEF-KEY,
 20584           DFHEIV99,
 20585           DFHEIV11,
 20586           DFHEIV99,
 20587           DFHEIV99
 20588     MOVE EIBRESP  TO WS-RESPONSE
 20589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20590     IF WS-RESP-NORMAL
 20591        MOVE 'Y'                 TO PDEF-MASTER-SW
 20592     ELSE
 20593        MOVE 'N'                 TO PDEF-MASTER-SW
 20594     END-IF
 20595     .
 20596 8588-EXIT.
 20597     EXIT.
 20598 8589-ENDBR-ERPDEF.
 20599
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 381
* EL050.cbl
 20600* EXEC CICS ENDBR
 20601*       DATASET   (PDEF-ID)
 20602*    END-EXEC
 20603     MOVE 0
 20604       TO DFHEIV11
 20605*    MOVE '&2                    $   #00019344' TO DFHEIV0
 20606     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20607     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20608     MOVE X'2020233030303139333434' TO DFHEIV0(25:11)
 20609     CALL 'kxdfhei1' USING DFHEIV0,
 20610           PDEF-ID,
 20611           DFHEIV11,
 20612           DFHEIV99
 20613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20614     .
 20615 8589-EXIT.
 20616     EXIT.
 20617 8590-READ-CERT-MASTER.
 20618     IF PB-COMPANY-ID = 'UCL'
 20619         GO TO 8690-READ-CERT-MASTER-UCL.
 20620
 20621
 20622* EXEC CICS HANDLE CONDITION
 20623*         NOTFND    (0299-CERT-NOT-FOUND)
 20624*    END-EXEC.
 20625*    MOVE '"$I                   ! ; #00019354' TO DFHEIV0
 20626     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20627     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20628     MOVE X'3B20233030303139333534' TO DFHEIV0(25:11)
 20629     CALL 'kxdfhei1' USING DFHEIV0
 20630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20631
 20632
 20633
 20634* EXEC CICS READ
 20635*        DATASET     (CERT-ID)
 20636*        INTO        (CERTIFICATE-MASTER)
 20637*        RIDFLD      (ELCERT-KEY)
 20638*        UPDATE
 20639*    END-EXEC.
 20640     MOVE LENGTH OF
 20641      CERTIFICATE-MASTER
 20642       TO DFHEIV11
 20643*    MOVE '&"IL       EU         (   #00019358' TO DFHEIV0
 20644     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20645     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20646     MOVE X'2020233030303139333538' TO DFHEIV0(25:11)
 20647     CALL 'kxdfhei1' USING DFHEIV0,
 20648           CERT-ID,
 20649           CERTIFICATE-MASTER,
 20650           DFHEIV11,
 20651           ELCERT-KEY,
 20652           DFHEIV99,
 20653           DFHEIV99,
 20654           DFHEIV99
 20655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20656
 20657
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 382
* EL050.cbl
 20658 8590-EXIT.
 20659     EXIT.
 20660
 20661 8690-READ-CERT-MASTER-UCL.
 20662
 20663* EXEC CICS HANDLE CONDITION
 20664*         NOTFND    (8700-READ-CERT-MASTER)
 20665*    END-EXEC.
 20666*    MOVE '"$I                   ! < #00019369' TO DFHEIV0
 20667     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20668     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20669     MOVE X'3C20233030303139333639' TO DFHEIV0(25:11)
 20670     CALL 'kxdfhei1' USING DFHEIV0
 20671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20672
 20673
 20674 8690-READ-CERT-CONT.
 20675
 20676* EXEC CICS READ
 20677*        DATASET     (CERT-ID)
 20678*        INTO        (CERTIFICATE-MASTER)
 20679*        RIDFLD      (ELCERT-KEY)
 20680*        UPDATE
 20681*    END-EXEC.
 20682     MOVE LENGTH OF
 20683      CERTIFICATE-MASTER
 20684       TO DFHEIV11
 20685*    MOVE '&"IL       EU         (   #00019374' TO DFHEIV0
 20686     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20687     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20688     MOVE X'2020233030303139333734' TO DFHEIV0(25:11)
 20689     CALL 'kxdfhei1' USING DFHEIV0,
 20690           CERT-ID,
 20691           CERTIFICATE-MASTER,
 20692           DFHEIV11,
 20693           ELCERT-KEY,
 20694           DFHEIV99,
 20695           DFHEIV99,
 20696           DFHEIV99
 20697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20698
 20699
 20700     GO TO 8590-EXIT.
 20701
 20702 8700-READ-CERT-MASTER.
 20703     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 20704     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 20705
 20706* EXEC CICS HANDLE CONDITION
 20707*         DUPKEY    (8720-COMP-ACCOUNTS)
 20708*         ENDFILE   (8730-END-BROWSE)
 20709*         NOTFND    (8740-NOT-FOUND)
 20710*    END-EXEC.
 20711*    MOVE '"$$''I                 ! = #00019386' TO DFHEIV0
 20712     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 20713     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20714     MOVE X'3D20233030303139333836' TO DFHEIV0(25:11)
 20715     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 383
* EL050.cbl
 20716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20717
 20718
 20719
 20720* EXEC CICS STARTBR
 20721*        DATASET     ('ELCERT5')
 20722*        RIDFLD      (ELCERT2-KEY)
 20723*        EQUAL
 20724*    END-EXEC.
 20725     MOVE 'ELCERT5' TO DFHEIV1
 20726     MOVE 0
 20727       TO DFHEIV11
 20728*    MOVE '&,         E          &   #00019392' TO DFHEIV0
 20729     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 20730     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20731     MOVE X'2020233030303139333932' TO DFHEIV0(25:11)
 20732     CALL 'kxdfhei1' USING DFHEIV0,
 20733           DFHEIV1,
 20734           ELCERT2-KEY,
 20735           DFHEIV99,
 20736           DFHEIV11,
 20737           DFHEIV99
 20738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20739
 20740
 20741 8710-READ-NEXT.
 20742
 20743* EXEC CICS READNEXT
 20744*        DATASET     ('ELCERT5')
 20745*        INTO        (CERTIFICATE-MASTER)
 20746*        RIDFLD      (ELCERT2-KEY)
 20747*    END-EXEC.
 20748     MOVE LENGTH OF
 20749      CERTIFICATE-MASTER
 20750       TO DFHEIV12
 20751     MOVE 'ELCERT5' TO DFHEIV1
 20752     MOVE 0
 20753       TO DFHEIV11
 20754*    MOVE '&.IL                  )   #00019399' TO DFHEIV0
 20755     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20756     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20757     MOVE X'2020233030303139333939' TO DFHEIV0(25:11)
 20758     CALL 'kxdfhei1' USING DFHEIV0,
 20759           DFHEIV1,
 20760           CERTIFICATE-MASTER,
 20761           DFHEIV12,
 20762           ELCERT2-KEY,
 20763           DFHEIV99,
 20764           DFHEIV11,
 20765           DFHEIV99,
 20766           DFHEIV99
 20767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20768
 20769
 20770 8720-COMP-ACCOUNTS.
 20771
 20772* EXEC CICS ENTER
 20773*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 384
* EL050.cbl
 20774*         FROM (PB-C-LAST-NAME)
 20775*    END-EXEC.
 20776     MOVE 001
 20777       TO DFHEIV11
 20778*    MOVE ':$F                   %   #00019406' TO DFHEIV0
 20779     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20780     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20781     MOVE X'2020233030303139343036' TO DFHEIV0(25:11)
 20782     CALL 'kxdfhei1' USING DFHEIV0,
 20783           DFHEIV11,
 20784           PB-C-LAST-NAME,
 20785           DFHEIV99,
 20786           DFHEIV99
 20787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20788
 20789
 20790
 20791* EXEC CICS ENTER
 20792*         TRACEID (002)
 20793*         FROM (CM-INSURED-LAST-NAME)
 20794*    END-EXEC.
 20795     MOVE 002
 20796       TO DFHEIV11
 20797*    MOVE ':$F                   %   #00019411' TO DFHEIV0
 20798     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20799     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20800     MOVE X'2020233030303139343131' TO DFHEIV0(25:11)
 20801     CALL 'kxdfhei1' USING DFHEIV0,
 20802           DFHEIV11,
 20803           CM-INSURED-LAST-NAME,
 20804           DFHEIV99,
 20805           DFHEIV99
 20806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20807
 20808
 20809     IF PB-CERT-NO NOT = CM-CERT-NO
 20810         GO TO 8730-END-BROWSE.
 20811
 20812     IF PB-ACCOUNT = CM-ACCOUNT
 20813         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 20814             MOVE ER-2799        TO WS-ERROR
 20815             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20816             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 20817             GO TO 8730-END-BROWSE.
 20818
 20819     GO TO 8710-READ-NEXT.
 20820
 20821 8730-END-BROWSE.
 20822
 20823* EXEC CICS ENDBR
 20824*         DATASET    ('ELCERT5')
 20825*    END-EXEC.
 20826     MOVE 'ELCERT5' TO DFHEIV1
 20827     MOVE 0
 20828       TO DFHEIV11
 20829*    MOVE '&2                    $   #00019429' TO DFHEIV0
 20830     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20831     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 385
* EL050.cbl
 20832     MOVE X'2020233030303139343239' TO DFHEIV0(25:11)
 20833     CALL 'kxdfhei1' USING DFHEIV0,
 20834           DFHEIV1,
 20835           DFHEIV11,
 20836           DFHEIV99
 20837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20838
 20839
 20840 8740-NOT-FOUND.
 20841     GO TO 0299-CERT-NOT-FOUND.
 20842
 20843 8750-START-ELSTAT.
 20844
 20845* EXEC CICS STARTBR
 20846*       DATASET   (STAT-ID)
 20847*       RIDFLD    (ELSTAT-KEY)
 20848*       GTEQ
 20849*       RESP      (WS-RESPONSE)
 20850*    END-EXEC
 20851     MOVE 0
 20852       TO DFHEIV11
 20853*    MOVE '&,         G          &  N#00019437' TO DFHEIV0
 20854     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20855     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20856     MOVE X'204E233030303139343337' TO DFHEIV0(25:11)
 20857     CALL 'kxdfhei1' USING DFHEIV0,
 20858           STAT-ID,
 20859           ELSTAT-KEY,
 20860           DFHEIV99,
 20861           DFHEIV11,
 20862           DFHEIV99
 20863     MOVE EIBRESP  TO WS-RESPONSE
 20864     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20865     IF WS-RESP-NORMAL
 20866        MOVE 'Y'                 TO STAT-MASTER-SW
 20867     ELSE
 20868        MOVE 'N'                 TO STAT-MASTER-SW
 20869     END-IF
 20870     .
 20871 8750-EXIT.
 20872     EXIT.
 20873 8752-READ-ELSTAT.
 20874
 20875* EXEC CICS READNEXT
 20876*       DATASET   (STAT-ID)
 20877*       RIDFLD    (ELSTAT-KEY)
 20878*       INTO      (STATE-FILE)
 20879*       RESP      (WS-RESPONSE)
 20880*    END-EXEC
 20881     MOVE LENGTH OF
 20882      STATE-FILE
 20883       TO DFHEIV12
 20884     MOVE 0
 20885       TO DFHEIV11
 20886*    MOVE '&.IL                  )  N#00019452' TO DFHEIV0
 20887     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20888     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20889     MOVE X'204E233030303139343532' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 386
* EL050.cbl
 20890     CALL 'kxdfhei1' USING DFHEIV0,
 20891           STAT-ID,
 20892           STATE-FILE,
 20893           DFHEIV12,
 20894           ELSTAT-KEY,
 20895           DFHEIV99,
 20896           DFHEIV11,
 20897           DFHEIV99,
 20898           DFHEIV99
 20899     MOVE EIBRESP  TO WS-RESPONSE
 20900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20901     IF WS-RESP-NORMAL
 20902        MOVE 'Y'                 TO STAT-MASTER-SW
 20903     ELSE
 20904        MOVE 'N'                 TO STAT-MASTER-SW
 20905     END-IF
 20906     .
 20907 8752-EXIT.
 20908     EXIT.
 20909 8800-GET-COMP-RATE.
 20910     MOVE +1 TO IB.
 20911     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 20912         ADD +9 TO IB
 20913         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 20914             ADD +9 TO IB
 20915             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 20916                MOVE ZEROS       TO WS-WK-RATE
 20917                GO TO 8800-EXIT.
 20918
 20919     IF PB-I-AGE GREATER CT-AGE (1)
 20920         ADD +3 TO IB
 20921         IF PB-I-AGE GREATER CT-AGE (2)
 20922             ADD +3 TO IB
 20923             IF PB-I-AGE GREATER CT-AGE (3)
 20924                MOVE ZEROS       TO WS-WK-RATE
 20925                GO TO 8800-EXIT.
 20926
 20927     IF WS-WORK-TERM GREATER CT-TRM (1)
 20928         ADD +1 TO IB
 20929         IF WS-WORK-TERM GREATER CT-TRM (2)
 20930             ADD +1 TO IB
 20931             IF WS-WORK-TERM GREATER CT-TRM (3)
 20932                MOVE ZEROS       TO WS-WK-RATE
 20933                GO TO 8800-EXIT.
 20934
 20935     IF CT-RT (IB) NOT NUMERIC
 20936         MOVE CT-RT-R (IB) TO CTBL-TABLE
 20937         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 20938         GO TO 8800-GET-COMP-RATE.
 20939
 20940     MOVE CT-RT (IB) TO WS-WK-RATE.
 20941
 20942 8800-EXIT.
 20943     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 387
* EL050.cbl
 20945 8900-ADDRESS-FILE.
 20946     IF ERACCT-FILE-ADDRESSED
 20947         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 20948         GO TO 8900-ADDRESS-EXIT.
 20949
 20950     IF ELCNTL-FILE-ADDRESSED
 20951         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 20952         GO TO 8900-ADDRESS-EXIT.
 20953
 20954     IF ERPLAN-FILE-ADDRESSED
 20955         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 20956         GO TO 8900-ADDRESS-EXIT.
 20957
 20958     IF ERFORM-FILE-ADDRESSED
 20959         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 20960         GO TO 8900-ADDRESS-EXIT.
 20961
 20962 8900-ADDRESS-EXIT.
 20963     EXIT.
 20964
 20965 9000-READ-CONTROL.
 20966
 20967* EXEC CICS HANDLE CONDITION
 20968*        NOTFND    (9000-NOTFND)
 20969*    END-EXEC.
 20970*    MOVE '"$I                   ! > #00019523' TO DFHEIV0
 20971     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20972     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20973     MOVE X'3E20233030303139353233' TO DFHEIV0(25:11)
 20974     CALL 'kxdfhei1' USING DFHEIV0
 20975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20976
 20977
 20978
 20979* EXEC CICS READ
 20980*        DATASET     (CNTL-ID)
 20981*        SET         (ADDRESS OF CONTROL-FILE)
 20982*        RIDFLD      (ELCNTL-KEY)
 20983*        GTEQ
 20984*    END-EXEC.
 20985*    MOVE '&"S        G          (   #00019527' TO DFHEIV0
 20986     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20987     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20988     MOVE X'2020233030303139353237' TO DFHEIV0(25:11)
 20989     CALL 'kxdfhei1' USING DFHEIV0,
 20990           CNTL-ID,
 20991           DFHEIV20,
 20992           DFHEIV99,
 20993           ELCNTL-KEY,
 20994           DFHEIV99,
 20995           DFHEIV99,
 20996           DFHEIV99
 20997     SET ADDRESS OF CONTROL-FILE TO
 20998         DFHEIV20
 20999     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21000
 21001
 21002     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 388
* EL050.cbl
 21003
 21004 9000-NOTFND.
 21005     IF RC-SW-1 = '1'
 21006        MOVE ER-2616              TO WS-ERROR
 21007        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21008        GO TO 9000-EXIT.
 21009
 21010     IF RC-SW-1 = '2'
 21011        MOVE ER-2602              TO WS-ERROR
 21012        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21013
 21014 9000-EXIT.
 21015      EXIT.
 21016
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 389
* EL050.cbl
 21018 9100-READ-CONTROL.
 21019
 21020* EXEC CICS HANDLE CONDITION
 21021*        NOTFND  (9100-NOTFND)
 21022*        ENDFILE (9100-NOTFND)
 21023*    END-EXEC.
 21024*    MOVE '"$I''                  ! ? #00019551' TO DFHEIV0
 21025     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21026     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21027     MOVE X'3F20233030303139353531' TO DFHEIV0(25:11)
 21028     CALL 'kxdfhei1' USING DFHEIV0
 21029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21030
 21031
 21032
 21033* EXEC CICS READ
 21034*        DATASET     (CNTL-ID)
 21035*        INTO        (CONTROL-FILE)
 21036*        RIDFLD      (ELCNTL-KEY)
 21037*        GTEQ
 21038*    END-EXEC.
 21039     MOVE LENGTH OF
 21040      CONTROL-FILE
 21041       TO DFHEIV11
 21042*    MOVE '&"IL       G          (   #00019556' TO DFHEIV0
 21043     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21044     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21045     MOVE X'2020233030303139353536' TO DFHEIV0(25:11)
 21046     CALL 'kxdfhei1' USING DFHEIV0,
 21047           CNTL-ID,
 21048           CONTROL-FILE,
 21049           DFHEIV11,
 21050           ELCNTL-KEY,
 21051           DFHEIV99,
 21052           DFHEIV99,
 21053           DFHEIV99
 21054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21055
 21056
 21057     GO TO 9100-EXIT.
 21058
 21059 9100-NOTFND.
 21060     IF RC-SW-2 = '0'
 21061        MOVE '1'                  TO STATE-RECORD-ERROR
 21062        GO TO 9100-EXIT
 21063     END-IF
 21064     IF RC-SW-2 = '1'
 21065        MOVE '1'                  TO LF-BENEFIT-ERROR
 21066        MOVE ER-2604              TO WS-ERROR
 21067        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21068        GO TO 9100-EXIT.
 21069
 21070     IF RC-SW-2 = '2'
 21071        MOVE '1'                  TO AH-BENEFIT-ERROR
 21072        MOVE ER-2605              TO WS-ERROR
 21073        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21074        GO TO 9100-EXIT.
 21075
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 390
* EL050.cbl
 21076     IF RC-SW-2 = '3'
 21077         MOVE ER-2603           TO WS-ERROR
 21078         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21079         GO TO 9100-EXIT.
 21080
 21081     IF RC-SW-2 = '4'
 21082         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 21083         GO TO 9100-EXIT.
 21084
 21085     IF RC-SW-2 = '5'
 21086         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 21087         IF WS-AH-INPUT-CD-1 = SPACE
 21088             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 21089         ELSE
 21090             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 21091
 21092 9100-EXIT.
 21093      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 391
* EL050.cbl
 21095 9200-CONTROL-GETMAIN.
 21096
 21097* EXEC CICS GETMAIN
 21098*         LENGTH   (750)
 21099*         SET      (ADDRESS OF CONTROL-FILE)
 21100*    END-EXEC.
 21101     MOVE 750
 21102       TO DFHEIV11
 21103*    MOVE '," L                  $   #00019602' TO DFHEIV0
 21104     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21105     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21106     MOVE X'2020233030303139363032' TO DFHEIV0(25:11)
 21107     CALL 'kxdfhei1' USING DFHEIV0,
 21108           DFHEIV20,
 21109           DFHEIV11,
 21110           DFHEIV99
 21111     SET ADDRESS OF CONTROL-FILE TO
 21112         DFHEIV20
 21113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21114
 21115
 21116     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 21117
 21118 9200-EXIT.
 21119     EXIT.
 21120
 21121 9250-UNLOCK-RETURN.
 21122
 21123* EXEC CICS UNLOCK
 21124*        DATASET   (CERT-ID)
 21125*    END-EXEC.
 21126*    MOVE '&*                    #   #00019613' TO DFHEIV0
 21127     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21128     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21129     MOVE X'2020233030303139363133' TO DFHEIV0(25:11)
 21130     CALL 'kxdfhei1' USING DFHEIV0,
 21131           CERT-ID,
 21132           DFHEIV99
 21133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21134
 21135
 21136 9300-ABEND.
 21137     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 21138
 21139
 21140* EXEC CICS LINK
 21141*        PROGRAM   ('EL004')
 21142*        COMMAREA  (WS-ERROR-LINE)
 21143*        LENGTH    (72)
 21144*    END-EXEC.
 21145     MOVE 'EL004' TO DFHEIV1
 21146     MOVE 72
 21147       TO DFHEIV11
 21148*    MOVE '."C                   (   #00019620' TO DFHEIV0
 21149     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21150     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21151     MOVE X'2020233030303139363230' TO DFHEIV0(25:11)
 21152     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 392
* EL050.cbl
 21153           DFHEIV1,
 21154           WS-ERROR-LINE,
 21155           DFHEIV11,
 21156           DFHEIV99,
 21157           DFHEIV99,
 21158           DFHEIV99,
 21159           DFHEIV99
 21160     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21161
 21162
 21163     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 21164
 21165
 21166* EXEC CICS ABEND
 21167*        ABCODE ('EL50')
 21168*    END-EXEC.
 21169     MOVE 'EL50' TO DFHEIV5
 21170*    MOVE '.,A                   "   #00019628' TO DFHEIV0
 21171     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 21172     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 21173     MOVE X'2020233030303139363238' TO DFHEIV0(25:11)
 21174     CALL 'kxdfhei1' USING DFHEIV0,
 21175           DFHEIV5
 21176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21177
 21178
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 393
* EL050.cbl
 21180
 21181******************************************************************
 21182*                                                                *
 21183*            E R R O R   F O R M A T   R O U T I N E             *
 21184*                                                                *
 21185******************************************************************
 21186
 21187 9900-ERROR-FORMAT.
 21188
 21189     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 21190                    PB-COMMON-ERROR (2) OR
 21191                    PB-COMMON-ERROR (3) OR
 21192                    PB-COMMON-ERROR (4) OR
 21193                    PB-COMMON-ERROR (5) OR
 21194                    PB-COMMON-ERROR (6) OR
 21195                    PB-COMMON-ERROR (7) OR
 21196                    PB-COMMON-ERROR (8) OR
 21197                    PB-COMMON-ERROR (9) OR
 21198                    PB-COMMON-ERROR (10)
 21199        GO TO 9900-EXIT.
 21200
 21201     IF PB-NO-OF-ERRORS = +10
 21202        GO TO 9900-EXIT.
 21203
 21204     ADD +1  TO PB-NO-OF-ERRORS.
 21205     MOVE WS-ERROR               TO PB-COMMON-ERROR
 21206                                       (PB-NO-OF-ERRORS).
 21207 9900-EXIT.
 21208     EXIT.
 21209
 21210 9990-RETURN.
 21211     IF BROWSE-STARTED
 21212
 21213* EXEC CICS ENDBR
 21214*            DATASET  (ACCT-ID)
 21215*       END-EXEC.
 21216     MOVE 0
 21217       TO DFHEIV11
 21218*    MOVE '&2                    $   #00019665' TO DFHEIV0
 21219     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21220     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21221     MOVE X'2020233030303139363635' TO DFHEIV0(25:11)
 21222     CALL 'kxdfhei1' USING DFHEIV0,
 21223           ACCT-ID,
 21224           DFHEIV11,
 21225           DFHEIV99
 21226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21227
 21228
 21229 9990-EXIT.
 21230     EXIT.
 21231
 21232
 21233****Check for CRTO record, add one if not found.
 21234 9991-CHECK-FOR-ELCRTO.
 21235
 21236* EXEC CICS HANDLE CONDITION
 21237*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 394
* EL050.cbl
 21238*         ENDFILE (9991-CRTO-NOT-FOUND)
 21239*     END-EXEC.
 21240*    MOVE '"$I''                  ! @ #00019675' TO DFHEIV0
 21241     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21242     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21243     MOVE X'4020233030303139363735' TO DFHEIV0(25:11)
 21244     CALL 'kxdfhei1' USING DFHEIV0
 21245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21246
 21247     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21248     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21249     MOVE +0                     TO ELCRTO-SEQ-NO
 21250
 21251
 21252* EXEC CICS READ
 21253*       DATASET   ('ELCRTO')
 21254*       INTO      (ORIGINAL-CERTIFICATE)
 21255*       RIDFLD    (ELCRTO-KEY)
 21256*       GTEQ
 21257*       RESP      (WS-RESPONSE)
 21258*    END-EXEC
 21259     MOVE LENGTH OF
 21260      ORIGINAL-CERTIFICATE
 21261       TO DFHEIV11
 21262     MOVE 'ELCRTO' TO DFHEIV1
 21263*    MOVE '&"IL       G          (  N#00019683' TO DFHEIV0
 21264     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21265     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21266     MOVE X'204E233030303139363833' TO DFHEIV0(25:11)
 21267     CALL 'kxdfhei1' USING DFHEIV0,
 21268           DFHEIV1,
 21269           ORIGINAL-CERTIFICATE,
 21270           DFHEIV11,
 21271           ELCRTO-KEY,
 21272           DFHEIV99,
 21273           DFHEIV99,
 21274           DFHEIV99
 21275     MOVE EIBRESP  TO WS-RESPONSE
 21276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21277
 21278     IF WS-RESP-NORMAL
 21279        AND (OC-CONTROL-PRIMARY (1:33) =
 21280                 PB-CONTROL-BY-ACCOUNT (1:33))
 21281        AND (OC-RECORD-TYPE =  'I')
 21282           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21283               GO TO 9991-CHECK-INDICATORS
 21284           ELSE
 21285               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21286               GO TO 9991-CRTO-ADD-REC
 21287           END-IF
 21288     END-IF.
 21289
 21290 9991-CRTO-NOT-FOUND.
 21291
 21292     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21293     MOVE 'OC'                TO OC-RECORD-ID
 21294     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21295                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 395
* EL050.cbl
 21296     MOVE +4096               TO OC-KEY-SEQ-NO.
 21297
 21298 9991-CRTO-ADD-REC.
 21299
 21300     MOVE 'E050'              TO OC-LAST-MAINT-BY
 21301     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 21302     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21303     MOVE 'I'                 TO OC-RECORD-TYPE
 21304     IF PB-ISSUE
 21305         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21306         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21307         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21308         MOVE PB-I-AGE               TO OC-INS-AGE
 21309         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21310         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21311         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21312         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21313         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21314         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21315         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21316         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21317         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21318         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21319         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21320         IF PB-I-JOINT-COMMISSION > +0
 21321             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21322         ELSE
 21323             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21324         END-IF
 21325         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21326         MOVE +0                     TO OC-LF-CANCEL-AMT
 21327                                        OC-LF-ITD-CANCEL-AMT
 21328         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21329         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21330         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21331         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21332         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21333         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21334         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21335         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21336         MOVE +0                     TO OC-AH-CANCEL-AMT
 21337                                        OC-AH-ITD-CANCEL-AMT
 21338         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21339         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21340         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 21341     ELSE
 21342         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21343         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21344         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21345         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21346         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21347         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21348         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21349         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21350         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21351          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21352             MOVE SPACES             TO OC-LF-BENCD
 21353             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 396
* EL050.cbl
 21354                                        OC-LF-BEN-AMT
 21355                                        OC-LF-PRM-AMT
 21356                                        OC-LF-ALT-BEN-AMT
 21357                                        OC-LF-ALT-PRM-AMT
 21358                                        OC-LF-COMM-PCT
 21359                                        OC-LF-CANCEL-AMT
 21360             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21361             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21362         ELSE
 21363             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21364             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21365             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21366             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21367             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21368             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21369             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21370             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21371             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21372             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21373         END-IF
 21374         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21375         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21376          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21377             MOVE SPACES             TO OC-AH-BENCD
 21378             MOVE ZEROS              TO OC-AH-TERM
 21379                                        OC-AH-BEN-AMT
 21380                                        OC-AH-PRM-AMT
 21381                                        OC-AH-COMM-PCT
 21382                                        OC-AH-CANCEL-AMT
 21383                                        OC-AH-CP
 21384             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21385             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21386         ELSE
 21387             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21388             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21389             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21390             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21391             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21392             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21393             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 21394             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21395             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21396         END-IF
 21397         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21398         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21399         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 21400         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 21401     END-IF
 21402     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21403
 21404     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21405
 21406
 21407* EXEC CICS READ
 21408*         DATASET   (FILE-ERMAIL)
 21409*         RIDFLD    (MA-CONTROL-PRIMARY)
 21410*         INTO      (MAILING-DATA)
 21411*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 397
* EL050.cbl
 21412*    END-EXEC
 21413     MOVE LENGTH OF
 21414      MAILING-DATA
 21415       TO DFHEIV11
 21416*    MOVE '&"IL       E          (  N#00019819' TO DFHEIV0
 21417     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21418     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21419     MOVE X'204E233030303139383139' TO DFHEIV0(25:11)
 21420     CALL 'kxdfhei1' USING DFHEIV0,
 21421           FILE-ERMAIL,
 21422           MAILING-DATA,
 21423           DFHEIV11,
 21424           MA-CONTROL-PRIMARY,
 21425           DFHEIV99,
 21426           DFHEIV99,
 21427           DFHEIV99
 21428     MOVE EIBRESP  TO WS-RESPONSE
 21429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21430
 21431     IF WS-RESP-NORMAL
 21432         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21433     END-IF.
 21434
 21435     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21436     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21437
 21438
 21439* EXEC CICS READ
 21440*         DATASET  (CRTT-ID)
 21441*         RIDFLD   (WS-ELCRTT-KEY)
 21442*         INTO     (CERTIFICATE-TRAILERS)
 21443*         RESP     (WS-RESPONSE)
 21444*    END-EXEC
 21445     MOVE LENGTH OF
 21446      CERTIFICATE-TRAILERS
 21447       TO DFHEIV11
 21448*    MOVE '&"IL       E          (  N#00019833' TO DFHEIV0
 21449     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21450     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21451     MOVE X'204E233030303139383333' TO DFHEIV0(25:11)
 21452     CALL 'kxdfhei1' USING DFHEIV0,
 21453           CRTT-ID,
 21454           CERTIFICATE-TRAILERS,
 21455           DFHEIV11,
 21456           WS-ELCRTT-KEY,
 21457           DFHEIV99,
 21458           DFHEIV99,
 21459           DFHEIV99
 21460     MOVE EIBRESP  TO WS-RESPONSE
 21461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21462
 21463     IF WS-RESP-NORMAL
 21464         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 21465         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21466     END-IF.
 21467
 21468
 21469* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 398
* EL050.cbl
 21470*       DATASET   ('ELCRTO')
 21471*       FROM      (ORIGINAL-CERTIFICATE)
 21472*       RIDFLD    (OC-CONTROL-PRIMARY)
 21473*       RESP      (WS-RESPONSE)
 21474*    END-EXEC.
 21475     MOVE LENGTH OF
 21476      ORIGINAL-CERTIFICATE
 21477       TO DFHEIV11
 21478     MOVE 'ELCRTO' TO DFHEIV1
 21479*    MOVE '&$ L                  ''  N#00019845' TO DFHEIV0
 21480     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21481     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21482     MOVE X'204E233030303139383435' TO DFHEIV0(25:11)
 21483     CALL 'kxdfhei1' USING DFHEIV0,
 21484           DFHEIV1,
 21485           ORIGINAL-CERTIFICATE,
 21486           DFHEIV11,
 21487           OC-CONTROL-PRIMARY,
 21488           DFHEIV99,
 21489           DFHEIV99
 21490     MOVE EIBRESP  TO WS-RESPONSE
 21491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21492
 21493
 21494     GO TO 9991-EXIT.
 21495
 21496 9991-CHECK-INDICATORS.
 21497
 21498     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 21499         GO TO 9991-EXIT
 21500     END-IF.
 21501
 21502     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 21503         GO TO 9991-EXIT
 21504     END-IF.
 21505
 21506
 21507* EXEC CICS READ
 21508*       DATASET   ('ELCRTO')
 21509*       INTO      (ORIGINAL-CERTIFICATE)
 21510*       RIDFLD    (OC-CONTROL-PRIMARY)
 21511*       UPDATE
 21512*       RESP      (WS-RESPONSE)
 21513*    END-EXEC
 21514     MOVE LENGTH OF
 21515      ORIGINAL-CERTIFICATE
 21516       TO DFHEIV11
 21517     MOVE 'ELCRTO' TO DFHEIV1
 21518*    MOVE '&"IL       EU         (  N#00019864' TO DFHEIV0
 21519     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21520     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21521     MOVE X'204E233030303139383634' TO DFHEIV0(25:11)
 21522     CALL 'kxdfhei1' USING DFHEIV0,
 21523           DFHEIV1,
 21524           ORIGINAL-CERTIFICATE,
 21525           DFHEIV11,
 21526           OC-CONTROL-PRIMARY,
 21527           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 399
* EL050.cbl
 21528           DFHEIV99,
 21529           DFHEIV99
 21530     MOVE EIBRESP  TO WS-RESPONSE
 21531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21532     IF WS-RESP-NORMAL
 21533        IF PB-ISSUE
 21534          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21535          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21536          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21537          MOVE PB-I-AGE               TO OC-INS-AGE
 21538          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21539          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21540          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21541          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21542          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21543          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21544          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21545          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21546          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21547          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21548          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21549          IF PB-I-JOINT-COMMISSION > +0
 21550              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21551          ELSE
 21552              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21553          END-IF
 21554          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21555          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21556          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21557          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21558          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21559          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21560          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21561          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21562          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21563
 21564          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21565
 21566* EXEC CICS READ
 21567*             DATASET   (FILE-ERMAIL)
 21568*             RIDFLD    (MA-CONTROL-PRIMARY)
 21569*             INTO      (MAILING-DATA)
 21570*             RESP      (WS-RESPONSE)
 21571*         END-EXEC
 21572     MOVE LENGTH OF
 21573      MAILING-DATA
 21574       TO DFHEIV11
 21575*    MOVE '&"IL       E          (  N#00019904' TO DFHEIV0
 21576     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21577     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21578     MOVE X'204E233030303139393034' TO DFHEIV0(25:11)
 21579     CALL 'kxdfhei1' USING DFHEIV0,
 21580           FILE-ERMAIL,
 21581           MAILING-DATA,
 21582           DFHEIV11,
 21583           MA-CONTROL-PRIMARY,
 21584           DFHEIV99,
 21585           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 400
* EL050.cbl
 21586           DFHEIV99
 21587     MOVE EIBRESP  TO WS-RESPONSE
 21588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21589          IF WS-RESP-NORMAL
 21590             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21591          END-IF
 21592
 21593          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21594          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21595
 21596* EXEC CICS READ
 21597*             DATASET  (CRTT-ID)
 21598*             RIDFLD   (WS-ELCRTT-KEY)
 21599*             INTO     (CERTIFICATE-TRAILERS)
 21600*             RESP     (WS-RESPONSE)
 21601*         END-EXEC
 21602     MOVE LENGTH OF
 21603      CERTIFICATE-TRAILERS
 21604       TO DFHEIV11
 21605*    MOVE '&"IL       E          (  N#00019916' TO DFHEIV0
 21606     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21607     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21608     MOVE X'204E233030303139393136' TO DFHEIV0(25:11)
 21609     CALL 'kxdfhei1' USING DFHEIV0,
 21610           CRTT-ID,
 21611           CERTIFICATE-TRAILERS,
 21612           DFHEIV11,
 21613           WS-ELCRTT-KEY,
 21614           DFHEIV99,
 21615           DFHEIV99,
 21616           DFHEIV99
 21617     MOVE EIBRESP  TO WS-RESPONSE
 21618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21619          IF WS-RESP-NORMAL
 21620             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 21621                               OC-INS-AGE-DEFAULT-FLAG
 21622             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 21623                               OC-JNT-AGE-DEFAULT-FLAG
 21624          END-IF
 21625
 21626        ELSE
 21627          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21628             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21629             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21630             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 21631          END-IF
 21632          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21633             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21634             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21635             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 21636          END-IF
 21637          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 21638        END-IF
 21639
 21640* EXEC CICS REWRITE
 21641*          DATASET   ('ELCRTO')
 21642*          FROM      (ORIGINAL-CERTIFICATE)
 21643*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 401
* EL050.cbl
 21644*       END-EXEC
 21645     MOVE LENGTH OF
 21646      ORIGINAL-CERTIFICATE
 21647       TO DFHEIV11
 21648     MOVE 'ELCRTO' TO DFHEIV1
 21649*    MOVE '&& L                  %  N#00019942' TO DFHEIV0
 21650     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21651     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21652     MOVE X'204E233030303139393432' TO DFHEIV0(25:11)
 21653     CALL 'kxdfhei1' USING DFHEIV0,
 21654           DFHEIV1,
 21655           ORIGINAL-CERTIFICATE,
 21656           DFHEIV11,
 21657           DFHEIV99
 21658     MOVE EIBRESP  TO WS-RESPONSE
 21659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21660     END-IF.
 21661
 21662 9991-EXIT.
 21663     EXIT.
 21664
 21665
 21666 9999-RETURN.
 21667     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 21668
 21669
 21670* EXEC CICS RETURN
 21671*    END-EXEC.
 21672*    MOVE '.(                    ''   #00019956' TO DFHEIV0
 21673     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 21674     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21675     MOVE X'2020233030303139393536' TO DFHEIV0(25:11)
 21676     CALL 'kxdfhei1' USING DFHEIV0,
 21677           DFHEIV99,
 21678           DFHEIV99,
 21679           DFHEIV99,
 21680           DFHEIV99,
 21681           DFHEIV99,
 21682           DFHEIV99
 21683     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21684
 21685
 21686
 21687* GOBACK.
 21688     MOVE '9%                    "   ' TO DFHEIV0
 21689     MOVE 'EL050' TO DFHEIV1
 21690     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21691     GOBACK.
 21692
 21693 9999-DFHBACK SECTION.
 21694     MOVE '9%                    "   ' TO DFHEIV0
 21695     MOVE 'EL050' TO DFHEIV1
 21696     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21697     GOBACK.
 21698 9999-DFHEXIT.
 21699     IF DFHEIGDJ EQUAL 0001
 21700         NEXT SENTENCE
 21701     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 402
* EL050.cbl
 21702         GO TO 9300-ABEND,
 21703               3990-FILES-NOT-OPEN
 21704         DEPENDING ON DFHEIGDI
 21705     ELSE IF DFHEIGDJ EQUAL 3
 21706         GO TO 6610-START-BROWSE,
 21707               6630-ERRESS-PROBLEM,
 21708               6630-END-OF-FILE
 21709         DEPENDING ON DFHEIGDI
 21710     ELSE IF DFHEIGDJ EQUAL 4
 21711         GO TO 6630-END-OF-FILE,
 21712               6630-ERRESS-PROBLEM,
 21713               6630-ERRESS-PROBLEM,
 21714               6630-END-OF-FILE
 21715         DEPENDING ON DFHEIGDI
 21716     ELSE IF DFHEIGDJ EQUAL 5
 21717         GO TO 6630-END-OF-FILE,
 21718               6630-END-OF-FILE,
 21719               6630-ERRESS-PROBLEM,
 21720               6630-ERRESS-PROBLEM
 21721         DEPENDING ON DFHEIGDI
 21722     ELSE IF DFHEIGDJ EQUAL 6
 21723         GO TO 6660-START-BROWSE,
 21724               6690-ERRESC-PROBLEM,
 21725               6690-ERRESC-PROBLEM,
 21726               6690-END-OF-FILE
 21727         DEPENDING ON DFHEIGDI
 21728     ELSE IF DFHEIGDJ EQUAL 7
 21729         GO TO 6690-END-OF-FILE,
 21730               6690-ERRESC-PROBLEM,
 21731               6690-ERRESC-PROBLEM,
 21732               6690-END-OF-FILE
 21733         DEPENDING ON DFHEIGDI
 21734     ELSE IF DFHEIGDJ EQUAL 8
 21735         GO TO 6690-END-OF-FILE,
 21736               6690-ERRESC-PROBLEM,
 21737               6690-ERRESC-PROBLEM,
 21738               6690-END-OF-FILE
 21739         DEPENDING ON DFHEIGDI
 21740     ELSE IF DFHEIGDJ EQUAL 9
 21741         GO TO 7250-CONTINUE,
 21742               7250-CONTINUE
 21743         DEPENDING ON DFHEIGDI
 21744     ELSE IF DFHEIGDJ EQUAL 10
 21745         GO TO 7300-CONTINUE,
 21746               7300-CONTINUE
 21747         DEPENDING ON DFHEIGDI
 21748     ELSE IF DFHEIGDJ EQUAL 11
 21749         GO TO 8000-FREE-MAIN
 21750         DEPENDING ON DFHEIGDI
 21751     ELSE IF DFHEIGDJ EQUAL 12
 21752         GO TO 8100-NOTFND,
 21753               8100-NOTFND
 21754         DEPENDING ON DFHEIGDI
 21755     ELSE IF DFHEIGDJ EQUAL 13
 21756         GO TO 8110-NOTFND,
 21757               8110-NOTFND
 21758         DEPENDING ON DFHEIGDI
 21759     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 403
* EL050.cbl
 21760         GO TO 8130-EXIT
 21761         DEPENDING ON DFHEIGDI
 21762     ELSE IF DFHEIGDJ EQUAL 15
 21763         GO TO 8180-NOTFND
 21764         DEPENDING ON DFHEIGDI
 21765     ELSE IF DFHEIGDJ EQUAL 16
 21766         GO TO 8190-NOTFND
 21767         DEPENDING ON DFHEIGDI
 21768     ELSE IF DFHEIGDJ EQUAL 17
 21769         GO TO 8195-NOTFND
 21770         DEPENDING ON DFHEIGDI
 21771     ELSE IF DFHEIGDJ EQUAL 18
 21772         GO TO 8200-NOTFND
 21773         DEPENDING ON DFHEIGDI
 21774     ELSE IF DFHEIGDJ EQUAL 19
 21775         GO TO 8300-NOTFND,
 21776               8300-ERRESS-PROBLEM,
 21777               8300-ERRESS-PROBLEM,
 21778               8300-NOTFND
 21779         DEPENDING ON DFHEIGDI
 21780     ELSE IF DFHEIGDJ EQUAL 20
 21781         GO TO 8450-FORM-NOT-FOUND,
 21782               8450-FORM-NOT-FOUND
 21783         DEPENDING ON DFHEIGDI
 21784     ELSE IF DFHEIGDJ EQUAL 21
 21785         GO TO 0199-ACCT-NOT-FOUND,
 21786               0199-ACCT-NOT-FOUND
 21787         DEPENDING ON DFHEIGDI
 21788     ELSE IF DFHEIGDJ EQUAL 22
 21789         GO TO 0199-ACCT-NOT-FOUND,
 21790               0199-ACCT-NOT-FOUND
 21791         DEPENDING ON DFHEIGDI
 21792     ELSE IF DFHEIGDJ EQUAL 23
 21793         GO TO 8582-COMP-NOT-FOUND,
 21794               8582-COMP-NOT-FOUND
 21795         DEPENDING ON DFHEIGDI
 21796     ELSE IF DFHEIGDJ EQUAL 24
 21797         GO TO 8583-AGTC-NOT-FOUND,
 21798               8583-AGTC-NOT-FOUND
 21799         DEPENDING ON DFHEIGDI
 21800     ELSE IF DFHEIGDJ EQUAL 25
 21801         GO TO 8584-BXRF-NOT-FOUND,
 21802               8584-BXRF-NOT-FOUND
 21803         DEPENDING ON DFHEIGDI
 21804     ELSE IF DFHEIGDJ EQUAL 26
 21805         GO TO 8585-PLAN-NOT-FOUND,
 21806               8585-PLAN-NOT-FOUND
 21807         DEPENDING ON DFHEIGDI
 21808     ELSE IF DFHEIGDJ EQUAL 27
 21809         GO TO 0299-CERT-NOT-FOUND
 21810         DEPENDING ON DFHEIGDI
 21811     ELSE IF DFHEIGDJ EQUAL 28
 21812         GO TO 8700-READ-CERT-MASTER
 21813         DEPENDING ON DFHEIGDI
 21814     ELSE IF DFHEIGDJ EQUAL 29
 21815         GO TO 8720-COMP-ACCOUNTS,
 21816               8730-END-BROWSE,
 21817               8740-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 06-Dec-13 09:13 Page 404
* EL050.cbl
 21818         DEPENDING ON DFHEIGDI
 21819     ELSE IF DFHEIGDJ EQUAL 30
 21820         GO TO 9000-NOTFND
 21821         DEPENDING ON DFHEIGDI
 21822     ELSE IF DFHEIGDJ EQUAL 31
 21823         GO TO 9100-NOTFND,
 21824               9100-NOTFND
 21825         DEPENDING ON DFHEIGDI
 21826     ELSE IF DFHEIGDJ EQUAL 32
 21827         GO TO 9991-CRTO-NOT-FOUND,
 21828               9991-CRTO-NOT-FOUND
 21829         DEPENDING ON DFHEIGDI.
 21830     MOVE '9%                    "   ' TO DFHEIV0
 21831     MOVE 'EL050' TO DFHEIV1
 21832     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21833     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       40008     Code:       87926
