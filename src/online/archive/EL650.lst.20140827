* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page   1
* EL650.cbl
* Options: int("EL650.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL650.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL650.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL650.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL650 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 07/14/94 14:53:46.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.048.
     9
    10*AUTHOR.        LOGIC,INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page   2
* EL650.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXC4 - ACCOUNT MASTER MAINTENANCE.
    27*
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    37*                              ADJUSTED REDEFINES EL650AI FILLER
    38* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    39* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
    40*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
    41* 121207  CR2007121100001  PEMA  SPACE OUT ORIG DLR NO ON COPY
    42* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    43* 080612  CR2012042700005  PEMA  ADD OVER 120 DAYS FOR AHL
    44* 111513  IR2013110500003  PEMA  CORRECT MAINT FUNC OF "N"
    45******************************************************************
    46
    47 ENVIRONMENT DIVISION.
    48 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page   3
* EL650.cbl
    50 WORKING-STORAGE SECTION.
    51 01  DFH-START PIC X(04).
    52 77  FILLER  PIC  X(32) VALUE '********************************'.
    53 77  FILLER  PIC  X(32) VALUE '*    EL650 WORKING STORAGE     *'.
    54 77  FILLER  PIC  X(32) VALUE '********* VMOD=2.048 ***********'.
    55 77  d1                      pic s999 value +0 comp-3.
    56
    57 01  WS-COMM-LENGTH          PIC S9(4) COMP VALUE +1500.
    58
    59 01  ws-display-eff-date     pic x(10) value spaces.
    60 01  ws-display-exp-date     pic x(10) value spaces.
    61 01  WS-DATE-AREA.
    62     12  SAVE-DATE           PIC  X(8)       VALUE SPACES.
    63     12  SAVE-BIN-DATE       PIC  XX         VALUE SPACES.
    64
    65 01  STANDARD-AREAS.
    66     12  GETMAIN-SPACE           PIC  X      VALUE SPACE.
    67     12  MAP-NAME                PIC  X(8)   VALUE 'EL650A'.
    68     12  MAPSET-NAME             PIC  X(8)   VALUE 'EL650S'.
    69     12  SCREEN-NUMBER           PIC  X(4)   VALUE '650A'.
    70     12  TRANS-ID                PIC  X(4)   VALUE 'EXC4'.
    71     12  EL6311-TRANS-ID         PIC  X(4)   VALUE 'EXB1'.
    72     12  EL1273-TRANS-ID         PIC  X(4)   VALUE 'EXX3'.
    73     12  EL652-TRANS-ID          PIC  X(4)   VALUE 'EXD4'.
    74     12  EL6523-TRANS-ID         PIC  X(4)   VALUE 'EXDD'.
    75     12  EL6311NC-TRANS-ID       PIC  X(4)   VALUE 'NXB1'.
    76     12  EL640-TRANS-ID          PIC  X(4)   VALUE 'EXC1'.
    77     12  EL658-TRANS-ID          PIC  X(4)   VALUE 'EXJ3'.
    78     12  EL130-TRANS-ID          PIC  X(4)   VALUE 'EX19'.
    79     12  EL6503-TRANS-ID         PIC  X(4)   VALUE 'EXC7'.
    80     12  EL6509-TRANS-ID         PIC  X(4)   VALUE 'EXDA'.
    81     12  EL6592-TRANS-ID         PIC  X(4)   VALUE 'EX66'.
    82     12  EL608-TRANS-ID          PIC  X(4)   VALUE 'EX1E'.
    83     12  THIS-PGM                PIC  X(8)   VALUE 'EL650'.
    84     12  PGM-NAME                PIC  X(8).
    85     12  RETURNED-FROM           PIC  X(8)   VALUE SPACES.
    86     12  TIME-IN                 PIC S9(7)   VALUE ZEROS.
    87     12  TIME-OUT-R  REDEFINES  TIME-IN.
    88         16  FILLER              PIC  X.
    89         16  TIME-OUT            PIC  99V99.
    90         16  FILLER              PIC  XX.
    91     12  XCTL-005                PIC  X(8)   VALUE 'EL005'.
    92     12  XCTL-010                PIC  X(8)   VALUE 'EL010'.
    93     12  XCTL-126                PIC  X(8)   VALUE 'EL126'.
    94     12  XCTL-EL601              PIC  X(8)   VALUE 'EL601 '.
    95     12  XCTL-6501               PIC  X(8)   VALUE 'EL6501'.
    96     12  XCTL-6502               PIC  X(8)   VALUE 'EL6502'.
    97     12  XCTL-6503               PIC  X(8)   VALUE 'EL6503'.
    98     12  XCTL-6504               PIC  X(8)   VALUE 'EL6504'.
    99     12  XCTL-6505               PIC  X(8)   VALUE 'EL6505'.
   100     12  XCTL-6506               PIC  X(8)   VALUE 'EL6506'.
   101     12  XCTL-6508               PIC  X(8)   VALUE 'EL6508'.
   102     12  XCTL-6509               PIC  X(8)   VALUE 'EL6509'.
   103     12  LINK-001                PIC  X(8)   VALUE 'EL001'.
   104     12  LINK-004                PIC  X(8)   VALUE 'EL004'.
   105     12  LINK-ELDATCV            PIC  X(8)   VALUE 'ELDATCV'.
   106     12  FILE-ID                 PIC  X(8)   VALUE SPACES.
   107     12  CNTL-FILE-ID            PIC  X(8)   VALUE 'ELCNTL'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page   4
* EL650.cbl
   108     12  ACCT-FILE-ID            PIC  X(8)   VALUE 'ERACCT'.
   109     12  COMP-FILE-ID            PIC  X(8)   VALUE 'ERCOMP'.
   110     12  NAME-FILE-ID            PIC  X(8)   VALUE 'ERNAME'.
   111     12  PEND2-FILE-ID           PIC  X(8)   VALUE 'ERPNDB2'.
   112     12  PLAN-FILE-ID            PIC  X(8)   VALUE 'ERPLAN'.
   113     12  ACCT2-FILE-ID           PIC  X(8)   VALUE 'ERACCT2'.
   114     12  ACCT-REC-LEN            PIC S9(4)   VALUE +2000  COMP.
   115     12  PLAN-REC-LEN            PIC S9(4)   VALUE +420   COMP.
   116     12  COMP-REC-LEN            PIC S9(4)   VALUE +700   COMP.
   117     12  NAME-REC-LEN            PIC S9(4)   VALUE +160   COMP.
   118     12  SC-ITEM                 PIC S9(4)   VALUE +1     COMP.
   119     12  ERGXRF-FILE-ID          PIC  X(8)   VALUE 'ERGXRF'.
   120     12  ERGXRF-REC-LEN          PIC S9(4)   VALUE +0     COMP.
   121     12  ERGXRF-INC-LEN          PIC S9(4)   VALUE +31    COMP.
   122     12  ERGXRF-MIN-LEN          PIC S9(4)   VALUE +109   COMP.
   123     12  ERGXRF-MAX-LEN          PIC S9(8)   VALUE +31264 COMP.
   124     12  BIN-MIN-DATE            PIC  XX     VALUE LOW-VALUES.
   125     12  BIN-MAX-DATE            PIC  XX     VALUE LOW-VALUES.
   126     12  B4-ACCT-KEY.
   127         16  B4-ACCT-CO          PIC  X      VALUE LOW-VALUES.
   128         16  B4-ACCT-CARRIER     PIC  X      VALUE SPACES.
   129         16  B4-ACCT-GROUPING    PIC  X(6)   VALUE SPACES.
   130         16  B4-ACCT-STATE       PIC  XX     VALUE SPACES.
   131         16  B4-ACCT-ACCOUNT     PIC  X(10)  VALUE SPACES.
   132         16  B4-ACCT-EXP-DT      PIC  XX     VALUE LOW-VALUES.
   133         16  B4-ACCT-EFF-DT      PIC  XX     VALUE LOW-VALUES.
   134     12  AF-ACCT-KEY.
   135         16  AF-ACCT-CO          PIC  X      VALUE LOW-VALUES.
   136         16  AF-ACCT-CARRIER     PIC  X      VALUE SPACES.
   137         16  AF-ACCT-GROUPING    PIC  X(6)   VALUE SPACES.
   138         16  AF-ACCT-STATE       PIC  XX     VALUE SPACES.
   139         16  AF-ACCT-ACCOUNT     PIC  X(10)  VALUE SPACES.
   140         16  AF-ACCT-EXP-DT      PIC  XX     VALUE LOW-VALUES.
   141         16  AF-ACCT-EFF-DT      PIC  XX     VALUE LOW-VALUES.
   142     12  GX-AM-CONTROL-PRIMARY.
   143         16  GX-AM-COMPANY-CD    PIC  X      VALUE LOW-VALUES.
   144         16  GX-REST-OF-KEY      PIC  X(21)  VALUE SPACES.
   145         16  GX-AM-CNTL-FILLER   PIC  X(4)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page   5
* EL650.cbl
   147*                                copy ERCGXRF.
   148******************************************************************
   149*                                                                *
   150*                                                                *
   151*                            ERCGXRF                             *
   152*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   153*                            VMOD=2.002                          *
   154*                                                                *
   155*   ONLINE CREDIT SYSTEM                                         *
   156*                                                                *
   157*   FILE DESCRIPTION = GENERAL AGENT CROSS REFERENCE             *
   158*                                                                *
   159*   FILE TYPE = VSAM,KSDS                                        *
   160*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
   161*                                                                *
   162*   BASE CLUSTER NAME = ERGXRF                   RKP=2,LEN=18    *
   163*       ALTERNATE PATH = NONE                                    *
   164*                                                                *
   165*   LOG = NO                                                     *
   166*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   167*                                                                *
   168******************************************************************
   169
   170 01  AGENT-CROSS-REFERENCE.
   171     12  GX-RECORD-ID                PIC XX.
   172         88  VALID-GX-ID             VALUE 'GX'.
   173
   174     12  GX-CONTROL-PRIMARY.
   175         16  GX-COMPANY-CD           PIC X.
   176         16  GX-CARRIER              PIC X.
   177         16  GX-GROUPING             PIC X(6).
   178         16  GX-AGENT-NO             PIC X(10).
   179
   180     12  GX-MAINT-INFORMATION.
   181         16  GX-LAST-MAINT-DT        PIC XX.
   182         16  GX-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
   183         16  GX-LAST-MAINT-USER      PIC X(4).
   184         16  FILLER                  PIC X(9).
   185
   186     12  FILLER                      PIC X(37).
   187
   188     12  GX-AGENT-POINTER-CNT        PIC S9(4)  COMP.
   189
   190     12  GX-AGENT-POINTER   OCCURS 1 TO 1006 TIMES
   191                            DEPENDING ON GX-AGENT-POINTER-CNT.
   192         16  GX-AM-CARRIER           PIC X.
   193         16  GX-AM-GROUPING          PIC X(6).
   194         16  GX-AM-STATE             PIC XX.
   195         16  GX-AM-ACCOUNT           PIC X(10).
   196         16  GX-AM-EXPIRATION-DT     PIC XX.
   197         16  GX-AM-LEVEL-NO          PIC S9(4)     COMP.
   198         16  GX-LAST-BILL-DT         PIC XX.
   199         16  GX-AM-EFF-DT            PIC XX.
   200         16  FILLER                  PIC X(4).
   201
   202******************************************************************
   203 01  WORK-AREAS-AND-SWITCHES.
   204     12  WS-PAGE-LINES               PIC  S99    VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page   6
* EL650.cbl
   205     12  WS-ACCT2-FOUND              PIC  X      VALUE 'N'.
   206     12  GETMAIN-SW                  PIC  X      VALUE SPACES.
   207     12  NEW-KEY-SAVE.
   208         16  NEW-KEY-COMPANY-CD      PIC  X      VALUE LOW-VALUES.
   209         16  NEW-KEY-CNTRL           PIC  X(19)  VALUE SPACES.
   210     12  WS-PLAN-KEY.
   211         16  EK-CCGSA-KEY.
   212           18  EK-COMPANY-CD         PIC  X     VALUE LOW-VALUES.
   213           18  EK-CARRIER            PIC  X     VALUE SPACES.
   214           18  EK-GROUPING           PIC  X(6)  VALUE SPACES.
   215           18  EK-STATE              PIC  XX    VALUE SPACES.
   216           18  EK-ACCOUNT            PIC  X(10) VALUE SPACES.
   217         16  EK-BTYPE                PIC  X     VALUE SPACES.
   218         16  EK-BCODE                PIC  XX    VALUE SPACES.
   219         16  EK-REVISION             PIC  XXX   VALUE SPACES.
   220     12  WS-EXP-SAVE                 PIC  XX    VALUE LOW-VALUES.
   221     12  CURRENT-SAVE                PIC  X(6)  VALUE SPACES.
   222     12  SAVE-ACCT-KEY               PIC  X(26).
   223     12  SAVE-CURR-EXP-DT            PIC  XX    VALUE LOW-VALUES.
   224     12  SAVE-CURR-EFF-DT            PIC  XX    VALUE LOW-VALUES.
   225     12  WS-EFFCHG-SAVE              PIC  9(11) VALUE ZEROS.
   226     12  WS-EXPCHG-SAVE              PIC  9(11) VALUE ZEROS.
   227     12  BIN-CURRENT-SAVE            PIC  XX    VALUE LOW-VALUES.
   228     12  WS-VERIFY-AREA.
   229         16  FILLER      OCCURS  33  TIMES
   230                             INDEXED  BY  WS-INDEX.
   231             20  WS-ACCT-KEY         PIC  X(20).
   232             20  WS-ACCT-EXP-DT      PIC  XX.
   233             20  WS-ACCT-EFF-DT      PIC  XX.
   234             20  WS-ACCT-HI-CERT     PIC  XX.
   235             20  WS-ACCT-LO-CERT     PIC  XX.
   236     12  WS-TEST-KEY                 PIC  X(20)  VALUE SPACES.
   237     12  WS-SAVE-VERIFY-KEY          PIC  X(20)  VALUE SPACES.
   238     12  WS-ACCT-VERIFY-KEY.
   239         16  WS-ACCT-VER-COMP-CD     PIC  X      VALUE LOW-VALUES.
   240         16  WS-ACCT-VER-CARR        PIC  X      VALUE SPACES.
   241         16  WS-ACCT-VER-GROUP       PIC  X(6)   VALUE SPACES.
   242         16  WS-ACCT-VER-STATE       PIC  XX     VALUE SPACES.
   243         16  WS-ACCT-VER-ACCOUNT     PIC  X(10)  VALUE SPACES.
   244         16  WS-ACCT-VER-EXP-DT      PIC  XX     VALUE LOW-VALUES.
   245     12  filler                      pic x(10)   value spaces.
   246     12  KEY-SAVE.
   247         16  SV-CO                   PIC  X      VALUE LOW-VALUES.
   248         16  SV-CARRIER              PIC  X      VALUE SPACES.
   249         16  SV-GROUPING             PIC  X(6)   VALUE SPACES.
   250         16  SV-STATE                PIC  XX     VALUE SPACES.
   251         16  SV-ACCOUNT              PIC  X(10)  VALUE SPACES.
   252
   253     12  WS-DEEDIT-FIELD              PIC X(10)  VALUE SPACES.
   254     12  WS-DT-DEEDIT-FIELD REDEFINES WS-DEEDIT-FIELD
   255                                      PIC X(10).
   256     12  WS-DEEDIT-FIELD-DATE REDEFINES WS-DT-DEEDIT-FIELD.
   257         16  FILLER                   PIC X(4).
   258         16  WS-DEEDIT-FIELD-DATE-OUT PIC X(6).
   259
   260     12  WS-AXRF-KEY.
   261         16  WS-AXRF-COMPANY-CD      PIC  X     VALUE LOW-VALUES.
   262         16  WS-AXRF-CARRIER         PIC  X     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page   7
* EL650.cbl
   263         16  WS-AXRF-GROUPING        PIC  X(6)  VALUE SPACES.
   264         16  WS-AXRF-AGENT-NO        PIC  X(10) VALUE SPACES.
   265     12  AXRF-SUB                    PIC S9(4) COMP VALUE +0.
   266     12  GX-AGENT-SUB                PIC S9(4) COMP VALUE +0.
   267     12  COMM-WORK-SUB               PIC S9(4) COMP VALUE +0.
   268     12  COMM-WORK-SUB2              PIC S9(4) COMP VALUE +0.
   269     12  ELCNTL-KEY.
   270         16  CNTL-COMP-ID            PIC  X(3) VALUE SPACES.
   271         16  CNTL-REC-TYPE           PIC  X    VALUE SPACES.
   272         16  CNTL-ACCESS.
   273             20  CNTL-STATE          PIC  XX   VALUE SPACES.
   274             20  FILLER              PIC  X    VALUE SPACES.
   275             20  CNTL-CARRIER        PIC  X    VALUE SPACES.
   276         16  CNTL-SEQ-NO             PIC S9(4) COMP VALUE +0.
   277     12  ERPNDB-KEY.
   278         16  PNDB-COMPANY-CD-A1      PIC  X  VALUE LOW-VALUES.
   279         16  PNDB-CARRIER            PIC  X    VALUE SPACES.
   280         16  PNDB-GROUPING           PIC  X(6) VALUE SPACES.
   281         16  PNDB-STATE              PIC  XX   VALUE SPACES.
   282         16  PNDB-ACCOUNT            PIC  X(10) VALUE SPACES.
   283         16  PNDB-CERT-EFF-DT        PIC  XX    VALUE LOW-VALUES.
   284         16  PNDB-CERT-NO            PIC  X(11) VALUE SPACES.
   285         16  PNDB-ALT-CHG-SEQ-NO     PIC S9(4)   COMP VALUE +0.
   286         16  PNDB-RECORD-TYPE        PIC  X   VALUE SPACES.
   287     12  REC-SW                      PIC  9          VALUE 0.
   288         88  REC-FOUND                               VALUE 1.
   289     12  K-WITH-LINE-USED            PIC  9          VALUE 0.
   290         88  K-WITH-LINE-NO                          VALUE 1.
   291     12  RETURN-FROM-SW              PIC  9          VALUE 0.
   292         88  RETURNING-FROM-6501                     VALUE 1.
   293     12  BROWSE-STARTED-SW           PIC  X          VALUE ' '.
   294         88  BROWSE-STARTED                          VALUE 'Y'.
   295     12  FIRST-TIME-SW               PIC  X          VALUE ' '.
   296         88  FIRST-TIME                              VALUE 'Y'.
   297     12  FROM-WHERE-SW               PIC  X          VALUE ' '.
   298         88  FROM-DELETE                             VALUE '1'.
   299         88  FROM-CHANGE                             VALUE '2'.
   300     12  FROM-EL608-SW               PIC  X          VALUE 'N'.
   301     12  PENDING-BUSINESS-SW         PIC  X          VALUE 'N'.
   302         88  THERE-IS-PENDING-BUSINESS               VALUE 'Y'.
   303     12  PENDING-BROWSE-SW           PIC  X          VALUE 'N'.
   304         88  PENDING-BROWSE-STARTED                  VALUE 'Y'.
   305     12  TS-QUEUE.
   306         16  TS-SCREEN               PIC  X(4)   VALUE SPACES.
   307         16  TS-TERM                 PIC  X(4)   VALUE SPACES.
   308     12  TS-LENGTH                   PIC S9(4) COMP VALUE +640.
   309     12  TS-ITEM                     PIC S9(4) COMP VALUE +0.
   310     12  AGT-SUB                     PIC 99      VALUE ZEROS.
   311     12  VALID-AGT-SW                PIC X       VALUE 'N'.
   312
   313 01  ERROR-MESSAGES.
   314     12  ER-0000             PIC  X(4)       VALUE '0000'.
   315     12  ER-0004             PIC  X(4)       VALUE '0004'.
   316     12  ER-0008             PIC  X(4)       VALUE '0008'.
   317     12  ER-0022             PIC  X(4)       VALUE '0022'.
   318     12  ER-0023             PIC  X(4)       VALUE '0023'.
   319     12  ER-0029             PIC  X(4)       VALUE '0029'.
   320     12  ER-0042             PIC  X(4)       VALUE '0042'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page   8
* EL650.cbl
   321     12  ER-0050             PIC  X(4)       VALUE '0050'.
   322     12  ER-0052             PIC  X(4)       VALUE '0052'.
   323     12  ER-0066             PIC  X(4)       VALUE '0066'.
   324     12  ER-0067             PIC  X(4)       VALUE '0067'.
   325     12  ER-0070             PIC  X(4)       VALUE '0070'.
   326     12  ER-0144             PIC  X(4)       VALUE '0144'.
   327     12  ER-0168             PIC  X(4)       VALUE '0168'.
   328     12  ER-0193             PIC  X(4)       VALUE '0193'.
   329     12  ER-0195             PIC  X(4)       VALUE '0195'.
   330     12  ER-0216             PIC  X(4)       VALUE '0216'.
   331     12  ER-0226             PIC  X(4)       VALUE '0226'.
   332     12  ER-0348             PIC  X(4)       VALUE '0348'.
   333     12  ER-0453             PIC  X(4)       VALUE '0453'.
   334     12  ER-0454             PIC  X(4)       VALUE '0454'.
   335     12  ER-0455             PIC  X(4)       VALUE '0455'.
   336     12  ER-0456             PIC  X(4)       VALUE '0456'.
   337     12  ER-0457             PIC  X(4)       VALUE '0457'.
   338     12  ER-0470             PIC  X(4)       VALUE '0470'.
   339     12  ER-0471             PIC  X(4)       VALUE '0471'.
   340     12  ER-0472             PIC  X(4)       VALUE '0472'.
   341     12  ER-0482             PIC  X(4)       VALUE '0482'.
   342     12  ER-0561             PIC  X(4)       VALUE '0561'.
   343     12  ER-0619             PIC  X(4)       VALUE '0619'.
   344     12  ER-0630             PIC  X(4)       VALUE '0630'.
   345     12  ER-0668             PIC  X(4)       VALUE '0668'.
   346     12  ER-0899             PIC  X(4)       VALUE '0899'.
   347     12  ER-1220             PIC  X(4)       VALUE '1220'.
   348     12  ER-1228             PIC  X(4)       VALUE '1228'.
   349     12  ER-1238             PIC  X(4)       VALUE '1238'.
   350     12  ER-1299             PIC  X(4)       VALUE '1299'.
   351     12  ER-1612             PIC  X(4)       VALUE '1612'.
   352     12  ER-2051             PIC  X(4)       VALUE '2051'.
   353     12  ER-2052             PIC  X(4)       VALUE '2052'.
   354     12  ER-2053             PIC  X(4)       VALUE '2053'.
   355     12  ER-2054             PIC  X(4)       VALUE '2054'.
   356     12  ER-2058             PIC  X(4)       VALUE '2058'.
   357     12  ER-2059             PIC  X(4)       VALUE '2059'.
   358     12  ER-2060             PIC  X(4)       VALUE '2060'.
   359     12  ER-2061             PIC  X(4)       VALUE '2061'.
   360     12  ER-2062             PIC  X(4)       VALUE '2062'.
   361     12  ER-2063             PIC  X(4)       VALUE '2063'.
   362     12  ER-2064             PIC  X(4)       VALUE '2064'.
   363     12  ER-2065             PIC  X(4)       VALUE '2065'.
   364     12  ER-2066             PIC  X(4)       VALUE '2066'.
   365     12  ER-2068             PIC  X(4)       VALUE '2068'.
   366     12  ER-2069             PIC  X(4)       VALUE '2069'.
   367     12  ER-2070             PIC  X(4)       VALUE '2070'.
   368     12  ER-2072             PIC  X(4)       VALUE '2072'.
   369     12  ER-2073             PIC  X(4)       VALUE '2073'.
   370     12  ER-2074             PIC  X(4)       VALUE '2074'.
   371     12  ER-2075             PIC  X(4)       VALUE '2075'.
   372     12  ER-2087             PIC  X(4)       VALUE '2087'.
   373     12  ER-2113             PIC  X(4)       VALUE '2113'.
   374     12  ER-2151             PIC  X(4)       VALUE '2151'.
   375     12  ER-2370             PIC  X(4)       VALUE '2370'.
   376     12  ER-2572             PIC  X(4)       VALUE '2572'.
   377     12  ER-3155             PIC  X(4)       VALUE '3155'.
   378     12  ER-3785             PIC  X(4)       VALUE '3785'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page   9
* EL650.cbl
   379     12  ER-9638             PIC  X(4)       VALUE '9638'.
   380     12  ER-9999             PIC  X(4)       VALUE '9999'.
   381
   382 01  TEMP-STORAGE-RECORD.
   383     12  TS-ACCT-KEY     OCCURS  32  TIMES
   384                             INDEXED  BY  TS-INDEX
   385                                 PIC  X(20).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  10
* EL650.cbl
   387*    COPY ELCSCTM.
   388******************************************************************
   389*                                                                *
   390*                                                                *
   391*                            ELCSCTM                             *
   392*                            VMOD=2.001                          *
   393*                                                                *
   394*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   395*                                                                *
   396******************************************************************
   397 01  SECURITY-MESSAGE.
   398     12  FILLER                          PIC X(30)
   399            VALUE '** LOGIC SECURITY VIOLATION -'.
   400     12  SM-READ                         PIC X(6).
   401     12  FILLER                          PIC X(5)
   402            VALUE ' PGM='.
   403     12  SM-PGM                          PIC X(6).
   404     12  FILLER                          PIC X(5)
   405            VALUE ' OPR='.
   406     12  SM-PROCESSOR-ID                 PIC X(4).
   407     12  FILLER                          PIC X(6)
   408            VALUE ' TERM='.
   409     12  SM-TERMID                       PIC X(4).
   410     12  FILLER                          PIC XX   VALUE SPACE.
   411     12  SM-JUL-DATE                     PIC 9(5).
   412     12  FILLER                          PIC X    VALUE SPACE.
   413     12  SM-TIME                         PIC 99.99.
   414
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  11
* EL650.cbl
   416*    COPY ELCSCRTY.
   417******************************************************************
   418*                                                                *
   419*                                                                *
   420*                            ELCSCRTY                            *
   421*                            VMOD=2.001                          *
   422*                                                                *
   423*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   424*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   425*        SAVED IN PI-SECURITY-ADDRESS.                           *
   426*                                                                *
   427******************************************************************
   428 01  SECURITY-CONTROL.
   429     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   430     12  FILLER                       PIC XX    VALUE 'SC'.
   431     12  SC-CREDIT-CODES.
   432         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   433             20  SC-CREDIT-DISPLAY    PIC X.
   434             20  SC-CREDIT-UPDATE     PIC X.
   435     12  SC-CLAIMS-CODES.
   436         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   437             20  SC-CLAIMS-DISPLAY    PIC X.
   438             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  12
* EL650.cbl
   440*    COPY ELCLOGOF.
   441******************************************************************
   442*                                                                *
   443*                                                                *
   444*                            ELCLOGOF.                           *
   445*                            VMOD=2.001                          *
   446*                                                                *
   447*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   448*                                                                *
   449******************************************************************
   450 01  CLASIC-LOGOFF.
   451     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   452     12  LOGOFF-TEXT.
   453         16  FILLER          PIC X(5)    VALUE SPACES.
   454         16  LOGOFF-MSG.
   455             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   456             20  FILLER      PIC X       VALUE SPACES.
   457             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   458         16  FILLER          PIC X(80)
   459           VALUE '* YOU ARE NOW LOGGED OFF'.
   460         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   461         16  FILLER          PIC X       VALUE QUOTE.
   462         16  LOGOFF-SYS-MSG  PIC X(17)
   463           VALUE 'S CLAS-IC SYSTEM '.
   464     12  TEXT-MESSAGES.
   465         16  UNACCESS-MSG    PIC X(29)
   466             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   467         16  PGMIDERR-MSG    PIC X(17)
   468             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  13
* EL650.cbl
   470*    COPY ELCDATE.
   471******************************************************************
   472*                                                                *
   473*                                                                *
   474*                            ELCDATE.                            *
   475*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   476*                            VMOD=2.003
   477*                                                                *
   478*                                                                *
   479*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   480*                 LENGTH = 200                                   *
   481******************************************************************
   482
   483 01  DATE-CONVERSION-DATA.
   484     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   485     12  DC-OPTION-CODE                PIC X.
   486         88  BIN-TO-GREG                VALUE ' '.
   487         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   488         88  EDIT-GREG-TO-BIN           VALUE '2'.
   489         88  YMD-GREG-TO-BIN            VALUE '3'.
   490         88  MDY-GREG-TO-BIN            VALUE '4'.
   491         88  JULIAN-TO-BIN              VALUE '5'.
   492         88  BIN-PLUS-ELAPSED           VALUE '6'.
   493         88  FIND-CENTURY               VALUE '7'.
   494         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   495         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   496         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   497         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   498         88  JULIAN-TO-BIN-3            VALUE 'C'.
   499         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   500         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   501         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   502         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   503         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   504         88  CHECK-LEAP-YEAR            VALUE 'H'.
   505         88  BIN-3-TO-GREG              VALUE 'I'.
   506         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   507         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   508         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   509         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   510         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   511         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   512         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   513         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   514         88  THREE-CHARACTER-BIN
   515                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   516         88  GREGORIAN-TO-BIN
   517                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   518         88  BIN-TO-GREGORIAN
   519                  VALUES ' ' '1' 'I' '8' 'G'.
   520         88  JULIAN-TO-BINARY
   521                  VALUES '5' 'C' 'E' 'F'.
   522     12  DC-ERROR-CODE                 PIC X.
   523         88  NO-CONVERSION-ERROR        VALUE ' '.
   524         88  DATE-CONVERSION-ERROR
   525                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   526         88  DATE-IS-ZERO               VALUE '1'.
   527         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  14
* EL650.cbl
   528         88  DATE-IS-INVALID            VALUE '3'.
   529         88  DATE1-GREATER-DATE2        VALUE '4'.
   530         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   531         88  DATE-INVALID-OPTION        VALUE '9'.
   532         88  INVALID-CENTURY            VALUE 'A'.
   533         88  ONLY-CENTURY               VALUE 'B'.
   534         88  ONLY-LEAP-YEAR             VALUE 'C'.
   535         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   536     12  DC-END-OF-MONTH               PIC X.
   537         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   538     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   539         88  USE-NORMAL-PROCESS         VALUE ' '.
   540         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   541         88  ADJUST-UP-100-YRS          VALUE '2'.
   542     12  FILLER                        PIC X.
   543     12  DC-CONVERSION-DATES.
   544         16  DC-BIN-DATE-1             PIC XX.
   545         16  DC-BIN-DATE-2             PIC XX.
   546         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   547         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   548                       DC-GREG-DATE-1-EDIT.
   549             20  DC-EDIT1-MONTH        PIC 99.
   550             20  SLASH1-1              PIC X.
   551             20  DC-EDIT1-DAY          PIC 99.
   552             20  SLASH1-2              PIC X.
   553             20  DC-EDIT1-YEAR         PIC 99.
   554         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   555         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   556                     DC-GREG-DATE-2-EDIT.
   557             20  DC-EDIT2-MONTH        PIC 99.
   558             20  SLASH2-1              PIC X.
   559             20  DC-EDIT2-DAY          PIC 99.
   560             20  SLASH2-2              PIC X.
   561             20  DC-EDIT2-YEAR         PIC 99.
   562         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   563         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   564                     DC-GREG-DATE-1-YMD.
   565             20  DC-YMD-YEAR           PIC 99.
   566             20  DC-YMD-MONTH          PIC 99.
   567             20  DC-YMD-DAY            PIC 99.
   568         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   569         16  DC-GREG-DATE-1-MDY-R REDEFINES
   570                      DC-GREG-DATE-1-MDY.
   571             20  DC-MDY-MONTH          PIC 99.
   572             20  DC-MDY-DAY            PIC 99.
   573             20  DC-MDY-YEAR           PIC 99.
   574         16  DC-GREG-DATE-1-ALPHA.
   575             20  DC-ALPHA-MONTH        PIC X(10).
   576             20  DC-ALPHA-DAY          PIC 99.
   577             20  FILLER                PIC XX.
   578             20  DC-ALPHA-CENTURY.
   579                 24 DC-ALPHA-CEN-N     PIC 99.
   580             20  DC-ALPHA-YEAR         PIC 99.
   581         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   582         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   583         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   584         16  DC-JULIAN-DATE            PIC 9(05).
   585         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  15
* EL650.cbl
   586                                       PIC 9(05).
   587         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   588             20  DC-JULIAN-YEAR        PIC 99.
   589             20  DC-JULIAN-DAYS        PIC 999.
   590         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   591         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   592         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   593     12  DATE-CONVERSION-VARIBLES.
   594         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   595         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   596             20  FILLER                PIC 9(3).
   597             20  HOLD-CEN-1-CCYY.
   598                 24  HOLD-CEN-1-CC     PIC 99.
   599                 24  HOLD-CEN-1-YY     PIC 99.
   600             20  HOLD-CEN-1-MO         PIC 99.
   601             20  HOLD-CEN-1-DA         PIC 99.
   602         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   603             20  HOLD-CEN-1-R-MO       PIC 99.
   604             20  HOLD-CEN-1-R-DA       PIC 99.
   605             20  HOLD-CEN-1-R-CCYY.
   606                 24  HOLD-CEN-1-R-CC   PIC 99.
   607                 24  HOLD-CEN-1-R-YY   PIC 99.
   608             20  FILLER                PIC 9(3).
   609         16  HOLD-CENTURY-1-X.
   610             20  FILLER                PIC X(3)  VALUE SPACES.
   611             20  HOLD-CEN-1-X-CCYY.
   612                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   613                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   614             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   615             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   616         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   617             20  HOLD-CEN-1-R-X-MO     PIC XX.
   618             20  HOLD-CEN-1-R-X-DA     PIC XX.
   619             20  HOLD-CEN-1-R-X-CCYY.
   620                 24  HOLD-CEN-1-R-X-CC PIC XX.
   621                 24  HOLD-CEN-1-R-X-YY PIC XX.
   622             20  FILLER                PIC XXX.
   623         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   624         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   625         16  DC-JULIAN-DATE-1          PIC 9(07).
   626         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   627             20  DC-JULIAN-1-CCYY.
   628                 24  DC-JULIAN-1-CC    PIC 99.
   629                 24  DC-JULIAN-1-YR    PIC 99.
   630             20  DC-JULIAN-DA-1        PIC 999.
   631         16  DC-JULIAN-DATE-2          PIC 9(07).
   632         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   633             20  DC-JULIAN-2-CCYY.
   634                 24  DC-JULIAN-2-CC    PIC 99.
   635                 24  DC-JULIAN-2-YR    PIC 99.
   636             20  DC-JULIAN-DA-2        PIC 999.
   637         16  DC-GREG-DATE-A-EDIT.
   638             20  DC-EDITA-MONTH        PIC 99.
   639             20  SLASHA-1              PIC X VALUE '/'.
   640             20  DC-EDITA-DAY          PIC 99.
   641             20  SLASHA-2              PIC X VALUE '/'.
   642             20  DC-EDITA-CCYY.
   643                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  16
* EL650.cbl
   644                 24  DC-EDITA-YEAR     PIC 99.
   645         16  DC-GREG-DATE-B-EDIT.
   646             20  DC-EDITB-MONTH        PIC 99.
   647             20  SLASHB-1              PIC X VALUE '/'.
   648             20  DC-EDITB-DAY          PIC 99.
   649             20  SLASHB-2              PIC X VALUE '/'.
   650             20  DC-EDITB-CCYY.
   651                 24  DC-EDITB-CENT     PIC 99.
   652                 24  DC-EDITB-YEAR     PIC 99.
   653         16  DC-GREG-DATE-CYMD         PIC 9(08).
   654         16  DC-GREG-DATE-CYMD-R REDEFINES
   655                              DC-GREG-DATE-CYMD.
   656             20  DC-CYMD-CEN           PIC 99.
   657             20  DC-CYMD-YEAR          PIC 99.
   658             20  DC-CYMD-MONTH         PIC 99.
   659             20  DC-CYMD-DAY           PIC 99.
   660         16  DC-GREG-DATE-MDCY         PIC 9(08).
   661         16  DC-GREG-DATE-MDCY-R REDEFINES
   662                              DC-GREG-DATE-MDCY.
   663             20  DC-MDCY-MONTH         PIC 99.
   664             20  DC-MDCY-DAY           PIC 99.
   665             20  DC-MDCY-CEN           PIC 99.
   666             20  DC-MDCY-YEAR          PIC 99.
   667    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   668        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   669    12  DC-EL310-DATE                  PIC X(21).
   670    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  17
* EL650.cbl
   672*    COPY ELCATTR.
   673******************************************************************
   674*                                                                *
   675*                            ELCATTR.                            *
   676*                            VMOD=2.001                          *
   677*                                                                *
   678*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   679*                                                                *
   680*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   681*                                                                *
   682*                   POS 1   P=PROTECTED                          *
   683*                           U=UNPROTECTED                        *
   684*                           S=ASKIP                              *
   685*                   POS 2   A=ALPHA/NUMERIC                      *
   686*                           N=NUMERIC                            *
   687*                   POS 3   N=NORMAL                             *
   688*                           B=BRIGHT                             *
   689*                           D=DARK                               *
   690*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   691*                           OF=MODIFIED DATA TAG OFF             *
   692*                                                                *
   693*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   694******************************************************************
   695 01  ATTRIBUTE-LIST.
   696     12  AL-PABOF            PIC X       VALUE 'Y'.
   697     12  AL-PABON            PIC X       VALUE 'Z'.
   698     12  AL-PADOF            PIC X       VALUE '%'.
   699     12  AL-PADON            PIC X       VALUE '_'.
   700     12  AL-PANOF            PIC X       VALUE '-'.
   701     12  AL-PANON            PIC X       VALUE '/'.
   702     12  AL-SABOF            PIC X       VALUE '8'.
   703     12  AL-SABON            PIC X       VALUE '9'.
   704     12  AL-SADOF            PIC X       VALUE '@'.
   705     12  AL-SADON            PIC X       VALUE QUOTE.
   706     12  AL-SANOF            PIC X       VALUE '0'.
   707     12  AL-SANON            PIC X       VALUE '1'.
   708     12  AL-UABOF            PIC X       VALUE 'H'.
   709     12  AL-UABON            PIC X       VALUE 'I'.
   710     12  AL-UADOF            PIC X       VALUE '<'.
   711     12  AL-UADON            PIC X       VALUE '('.
   712     12  AL-UANOF            PIC X       VALUE ' '.
   713     12  AL-UANON            PIC X       VALUE 'A'.
   714     12  AL-UNBOF            PIC X       VALUE 'Q'.
   715     12  AL-UNBON            PIC X       VALUE 'R'.
   716     12  AL-UNDOF            PIC X       VALUE '*'.
   717     12  AL-UNDON            PIC X       VALUE ')'.
   718     12  AL-UNNOF            PIC X       VALUE '&'.
   719     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  18
* EL650.cbl
   721*    COPY ELCEMIB.
   722******************************************************************
   723*                                                                *
   724*                                                                *
   725*                            ELCEMIB.                            *
   726*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   727*                            VMOD=2.005                          *
   728*                                                                *
   729*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   730*                                                                *
   731******************************************************************
   732 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   733     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   734     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   735     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   736     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   737     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   738     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   739     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   740     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   741     12  EMI-SWITCH1             PIC X        VALUE '1'.
   742         88  EMI-NO-ERRORS                    VALUE '1'.
   743         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   744         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   745     12  EMI-SWITCH2             PIC X        VALUE '1'.
   746         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   747     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   748         88  EMI-AREA1-EMPTY                  VALUE '1'.
   749         88  EMI-AREA1-FULL                   VALUE '2'.
   750     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   751         88  EMI-AREA2-EMPTY                  VALUE '1'.
   752         88  EMI-AREA2-FULL                   VALUE '2'.
   753     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   754         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   755         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   756         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   757         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   758         88  EMI-BYPASS-FATALS                VALUE 'X'.
   759     12  EMI-ERROR-LINES.
   760         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   761         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   762         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   763         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   764             20  EMI-ERR-CODES OCCURS 10 TIMES.
   765                 24  EMI-ERR-NUM         PIC X(4).
   766                 24  EMI-FILLER          PIC X.
   767                 24  EMI-SEV             PIC X.
   768                 24  FILLER              PIC X.
   769             20  FILLER                  PIC X(02).
   770     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   771         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   772             20  EMI-ERROR-NUMBER    PIC X(4).
   773             20  EMI-FILL            PIC X.
   774             20  EMI-SEVERITY        PIC X.
   775             20  FILLER              PIC X.
   776             20  EMI-ERROR-TEXT.
   777                 24  EMI-TEXT-VARIABLE   PIC X(10).
   778                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  19
* EL650.cbl
   779     12  EMI-SEVERITY-SAVE           PIC X.
   780         88  EMI-NOTE                    VALUE 'N'.
   781         88  EMI-WARNING                 VALUE 'W'.
   782         88  EMI-FORCABLE                VALUE 'F'.
   783         88  EMI-FATAL                   VALUE 'X'.
   784     12  EMI-MESSAGE-FLAG            PIC X.
   785         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   786         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   787     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   788     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   789         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   790         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   791         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   792     12  emi-claim-no                pic x(7).
   793     12  emi-claim-type              pic x(6).
   794     12  FILLER                      PIC X(124)  VALUE SPACES.
   795     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   796     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   797     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   798     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  20
* EL650.cbl
   800*    COPY ELCINTF.
   801******************************************************************
   802*                                                                *
   803*                                                                *
   804*                            ELCINTF.                            *
   805*                            VMOD=2.017                          *
   806*                                                                *
   807*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   808*                                                                *
   809*       LENGTH = 1024                                            *
   810*                                                                *
   811******************************************************************
   812*                   C H A N G E   L O G
   813*
   814* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   815*-----------------------------------------------------------------
   816*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   817* EFFECTIVE    NUMBER
   818*-----------------------------------------------------------------
   819* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   820******************************************************************
   821 01  PROGRAM-INTERFACE-BLOCK.
   822     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   823     12  PI-CALLING-PROGRAM              PIC X(8).
   824     12  PI-SAVED-PROGRAM-1              PIC X(8).
   825     12  PI-SAVED-PROGRAM-2              PIC X(8).
   826     12  PI-SAVED-PROGRAM-3              PIC X(8).
   827     12  PI-SAVED-PROGRAM-4              PIC X(8).
   828     12  PI-SAVED-PROGRAM-5              PIC X(8).
   829     12  PI-SAVED-PROGRAM-6              PIC X(8).
   830     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   831     12  PI-COMPANY-ID                   PIC XXX.
   832     12  PI-COMPANY-CD                   PIC X.
   833
   834     12  PI-COMPANY-PASSWORD             PIC X(8).
   835
   836     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   837
   838     12  PI-CONTROL-IN-PROGRESS.
   839         16  PI-CARRIER                  PIC X.
   840         16  PI-GROUPING                 PIC X(6).
   841         16  PI-STATE                    PIC XX.
   842         16  PI-ACCOUNT                  PIC X(10).
   843         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   844                                         PIC X(10).
   845         16  PI-CLAIM-CERT-GRP.
   846             20  PI-CLAIM-NO             PIC X(7).
   847             20  PI-CERT-NO.
   848                 25  PI-CERT-PRIME       PIC X(10).
   849                 25  PI-CERT-SFX         PIC X.
   850             20  PI-CERT-EFF-DT          PIC XX.
   851         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   852             20  PI-PLAN-CODE            PIC X(2).
   853             20  PI-REVISION-NUMBER      PIC X(3).
   854             20  PI-PLAN-EFF-DT          PIC X(2).
   855             20  PI-PLAN-EXP-DT          PIC X(2).
   856             20  FILLER                  PIC X(11).
   857         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  21
* EL650.cbl
   858             20  PI-OE-REFERENCE-1.
   859                 25  PI-OE-REF-1-PRIME   PIC X(18).
   860                 25  PI-OE-REF-1-SUFF    PIC XX.
   861
   862     12  PI-SESSION-IN-PROGRESS          PIC X.
   863         88  CLAIM-SESSION                   VALUE '1'.
   864         88  CREDIT-SESSION                  VALUE '2'.
   865         88  WARRANTY-SESSION                VALUE '3'.
   866         88  MORTGAGE-SESSION                VALUE '4'.
   867         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   868
   869
   870*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   871
   872     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   873     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   874
   875     12  PI-CREDIT-USER                  PIC X.
   876         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   877         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   878
   879     12  PI-CLAIM-USER                   PIC X.
   880         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   881         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   882
   883     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   884         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   885         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   886         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   887         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   888         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   889
   890     12  PI-PROCESSOR-ID                 PIC X(4).
   891
   892     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   893
   894     12  PI-MEMBER-CAPTION               PIC X(10).
   895
   896     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   897         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   898
   899     12  PI-LIFE-OVERRIDE-L1             PIC X.
   900     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   901     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   902     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   903
   904     12  PI-AH-OVERRIDE-L1               PIC X.
   905     12  PI-AH-OVERRIDE-L2               PIC XX.
   906     12  PI-AH-OVERRIDE-L6               PIC X(6).
   907     12  PI-AH-OVERRIDE-L12              PIC X(12).
   908
   909     12  PI-NEW-SYSTEM                   PIC X(2).
   910
   911     12  PI-PRIMARY-CERT-NO              PIC X(11).
   912     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   913         88  PI-USES-PAID-TO                 VALUE '1'.
   914     12  PI-CRDTCRD-SYSTEM.
   915         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  22
* EL650.cbl
   916             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   917             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   918         16  PI-CC-MONTH-END-DT          PIC XX.
   919     12  PI-PROCESSOR-PRINTER            PIC X(4).
   920
   921     12  PI-OE-REFERENCE-2.
   922         16  PI-OE-REF-2-PRIME           PIC X(10).
   923         16  PI-OE-REF-2-SUFF            PIC X.
   924
   925     12  PI-REM-TRM-CALC-OPTION          PIC X.
   926
   927     12  PI-LANGUAGE-TYPE                PIC X.
   928             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   929             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   930             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   931
   932     12  PI-POLICY-LINKAGE-IND           PIC X.
   933         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   934         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   935                                                   LOW-VALUES.
   936
   937     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   938     12  PI-CLAIM-PW-SESSION             PIC X(1).
   939         88  PI-CLAIM-CREDIT                 VALUE '1'.
   940         88  PI-CLAIM-CONVEN                 VALUE '2'.
   941
   942     12  PI-PROCESSOR-CSR-IND            PIC X.
   943         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   944         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   945
   946     12  FILLER                          PIC X(3).
   947
   948     12  PI-SYSTEM-LEVEL                 PIC X(145).
   949
   950     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   951         PI-SYSTEM-LEVEL.
   952
   953         16  PI-ENTRY-CODES.
   954             20  PI-ENTRY-CD-1           PIC X.
   955             20  PI-ENTRY-CD-2           PIC X.
   956
   957         16  PI-RETURN-CODES.
   958             20  PI-RETURN-CD-1          PIC X.
   959             20  PI-RETURN-CD-2          PIC X.
   960
   961         16  PI-UPDATE-STATUS-SAVE.
   962             20  PI-UPDATE-BY            PIC X(4).
   963             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   964
   965         16  PI-LOWER-CASE-LETTERS       PIC X.
   966             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   967
   968*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   969*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   970*            88  CARRIER-CLM-CNTL            VALUE '2'.
   971
   972         16  PI-CERT-ACCESS-CONTROL      PIC X.
   973             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  23
* EL650.cbl
   974             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   975             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   976             88  ACCNT-CNTL                  VALUE '3'.
   977             88  CARR-ACCNT-CNTL             VALUE '4'.
   978
   979         16  PI-PROCESSOR-CAP-LIST.
   980             20  PI-SYSTEM-CONTROLS.
   981                24 PI-SYSTEM-DISPLAY     PIC X.
   982                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   983                24 PI-SYSTEM-MODIFY      PIC X.
   984                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   985             20  FILLER                  PIC XX.
   986             20  PI-DISPLAY-CAP          PIC X.
   987                 88  DISPLAY-CAP             VALUE 'Y'.
   988             20  PI-MODIFY-CAP           PIC X.
   989                 88  MODIFY-CAP              VALUE 'Y'.
   990             20  PI-MSG-AT-LOGON-CAP     PIC X.
   991                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   992             20  PI-FORCE-CAP            PIC X.
   993                 88  FORCE-CAP               VALUE 'Y'.
   994
   995         16  PI-PROGRAM-CONTROLS.
   996             20  PI-PGM-PRINT-OPT        PIC X.
   997             20  PI-PGM-FORMAT-OPT       PIC X.
   998             20  PI-PGM-PROCESS-OPT      PIC X.
   999             20  PI-PGM-TOTALS-OPT       PIC X.
  1000
  1001         16  PI-HELP-INTERFACE.
  1002             20  PI-LAST-ERROR-NO        PIC X(4).
  1003             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1004
  1005         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1006             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1007
  1008         16  PI-CR-CONTROL-IN-PROGRESS.
  1009             20  PI-CR-CARRIER           PIC X.
  1010             20  PI-CR-GROUPING          PIC X(6).
  1011             20  PI-CR-STATE             PIC XX.
  1012             20  PI-CR-ACCOUNT           PIC X(10).
  1013             20  PI-CR-FIN-RESP          PIC X(10).
  1014             20  PI-CR-TYPE              PIC X.
  1015
  1016         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1017
  1018         16  PI-CR-MONTH-END-DT          PIC XX.
  1019
  1020         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1021             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1022             88  PI-ZERO-CARRIER             VALUE '1'.
  1023             88  PI-ZERO-GROUPING            VALUE '2'.
  1024             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1025
  1026         16  PI-CARRIER-SECURITY         PIC X.
  1027             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1028
  1029         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1030             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1031             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  24
* EL650.cbl
  1032
  1033         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1034             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1035                                         INDEXED BY PI-ACCESS-NDX
  1036                                         PIC X.
  1037
  1038         16  PI-GA-BILLING-CONTROL       PIC X.
  1039             88  PI-GA-BILLING               VALUE '1'.
  1040
  1041         16  PI-MAIL-PROCESSING          PIC X.
  1042             88  PI-MAIL-YES                 VALUE 'Y'.
  1043
  1044         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1045
  1046         16  PI-AR-SYSTEM.
  1047             20  PI-AR-PROCESSING-CNTL   PIC X.
  1048                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1049             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1050             20  PI-AR-MONTH-END-DT      PIC XX.
  1051
  1052         16  PI-MP-SYSTEM.
  1053             20  PI-MORTGAGE-USER            PIC X.
  1054                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1055                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1056             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1057                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1058                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1059                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1060                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1061                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1062             20  PI-MP-MONTH-END-DT          PIC XX.
  1063             20  PI-MP-REFERENCE-NO.
  1064                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1065                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1066
  1067         16  PI-LABEL-CONTROL            PIC X(01).
  1068             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1069             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1070
  1071         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1072             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1073
  1074         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1075             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1076             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1077
  1078         16  FILLER                      PIC X(14).
  1079
  1080     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1081******************************************************************
  1082*    COPY ELC650PI.
  1083******************************************************************
  1084*
  1085*                            ELC650PI.
  1086*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1087*                            VMOD=2.007
  1088*  ***  NOTE  ***   IF ANY CHANGES ARE MADE TO THIS COPYBOOK
  1089*   YOU MUST CONSIDER ALL PROGRAMS THAT USE THIS COPYBOOK AND
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  25
* EL650.cbl
  1090* PROGRAM EL6565.  ALSO, CONSIDER EL106 AND EL1061
  1091*
  1092******************************************************************
  1093
  1094     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
  1095         16  PI-MAINT                   PIC X.
  1096         16  PI-PREV-ACCOUNT            PIC X(20).
  1097         16  PI-PREV-VG-ACCOUNT         PIC X(20).
  1098         16  PI-ACCT-KEY.
  1099             20  PI-ACCT-CCGSA-KEY.
  1100                 24  PI-ACCT-CO             PIC X.
  1101                 24  PI-ACCT-CARRIER        PIC X.
  1102                 24  PI-ACCT-GROUPING       PIC X(6).
  1103                 24  PI-ACCT-STATE          PIC XX.
  1104                 24  PI-ACCT-ACCOUNT        PIC X(10).
  1105             20  PI-ACCT-EXP-DT           PIC XX.
  1106             20  PI-ACCT-REST-OF-EXP      PIC X(4).
  1107         16  PI-ACCT-ID                 PIC X(8).
  1108         16  PI-PLAN-KEY.
  1109             20  PI-PLAN-ACCT-KEY.
  1110                 24  PI-PLAN-COMPANY-CD PIC X.
  1111                 24  PI-PLAN-CARRIER    PIC X.
  1112                 24  PI-PLAN-GROUP      PIC X(6).
  1113                 24  PI-PLAN-STATE      PIC X(2).
  1114                 24  PI-PLAN-ACCOUNT    PIC X(10).
  1115             20  PI-PLAN-BEN-TYPE       PIC X.
  1116             20  PI-PLAN-BEN            PIC XX.
  1117             20  PI-PLAN-REVISION       PIC X(3).
  1118         16  PI-WS-STATE                PIC XX.
  1119         16  PI-WS-CLASS                PIC XX.
  1120         16  PI-WS-DEV                  PIC X(3).
  1121         16  PI-WS-TYPE                 PIC X.
  1122         16  PI-WS-PLAN                 PIC XX.
  1123
  1124         16  PI-ERPNDB-ALT-KEY.
  1125             20  PI-PB-COMPANY-CD-A1    PIC X.
  1126             20  PI-PB-CARRIER          PIC X.
  1127             20  PI-PB-GROUPING         PIC X(6).
  1128             20  PI-PB-STATE            PIC XX.
  1129             20  PI-PB-ACCOUNT          PIC X(10).
  1130             20  PI-PB-CERT-EFF-DT      PIC XX.
  1131             20  PI-PB-CERT-NO          PIC X(10).
  1132             20  PI-PB-ALT-CHG-SEQ-NO   PIC S9(4)      COMP.
  1133             20  PI-PB-RECORD-TYPE      PIC X.
  1134
  1135         16  PI-DATE-RANGE-TABLE.
  1136             20  PI-TABLE-ENT OCCURS 32 TIMES
  1137                            INDEXED BY T-INDEX.
  1138                 24  PI-BIN-EFF-DT          PIC XX.
  1139                 24  PI-BIN-EXP-DT          PIC XX.
  1140                 24  PI-BIN-MAINT-DT        PIC XX.
  1141                 24  PI-BIN-LO-CERT         PIC XX.
  1142                 24  PI-BIN-AR-HI-CERT      PIC XX.
  1143                 24  PI-BIN-HI-CERT         PIC XX.
  1144         16  PI-PAGE-NUMBER             PIC S9.
  1145             88  PI-FST-PAGE               VALUE +1.
  1146             88  PI-2ND-PAGE               VALUE +2.
  1147             88  PI-3RD-PAGE               VALUE +3.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  26
* EL650.cbl
  1148             88  PI-LST-PAGE               VALUE +4.
  1149         16  PI-TOTAL-LINES             PIC S99.
  1150         16  PI-LINE-SELECTED    PIC S9.
  1151***  Y2K PROJ 7744
  1152         16  EFFCHG-SAVE         PIC 9(11)   COMP-3.
  1153         16  BIN-EFFCHG-SAVE     PIC XX.
  1154         16  EXPCHG-SAVE         PIC 9(11)   COMP-3.
  1155***  Y2K PROJ 7744
  1156         16  BIN-EXPCHG-SAVE     PIC XX.
  1157         16  PI-RECORD-ADDED-SW  PIC X.
  1158             88  PI-RECORD-ADDED            VALUE '1'.
  1159             88  PI-RECORD-NOT-CREATED      VALUE SPACE.
  1160         16  PI-ACCNAME          PIC X(30).
  1161         16  PI-COMM-POINTER     PIC S9(8)   COMP.
  1162         16  PI-SV-MAINT         PIC X.
  1163         16  PI-CURRENT-LINE     PIC S9(3)   COMP-3.
  1164         16  PI-TEMP-STOR-ITEMS  PIC S9(4)   COMP.
  1165         16  PI-UPDATE-SW        PIC X.
  1166             88  PI-CHANGES-MADE             VALUE '1'.
  1167         16  PI-NOTE-TYPE        PIC X.
  1168             88  PI-ACCT-NOTE                VALUE '1'.
  1169         16  PI-DMD-FILE-SW      PIC X.
  1170             88  END-OF-FILE                 VALUE 'E'.
  1171             88  INTO-NEXT-BENEFITS          VALUE 'I'.
  1172             88  FIRST-OCCURS                VALUE 'F'.
  1173         16  PI-DMD-OCCURS       PIC S999.
  1174         16  PI-DMD-SCREEN       PIC X.
  1175             88  SCREEN-1-DISPLAYED  VALUE '1'.
  1176             88  SCREEN-2-DISPLAYED  VALUE '2'.
  1177             88  SCREEN-3-DISPLAYED  VALUE '3'.
  1178         16  PI-NAMEFLG          PIC X.
  1179         16  PI-EL650-DEL-SW     PIC X.
  1180         16  PI-MAX-MFEE         PIC S9(5) COMP-3.
  1181         16  PI-DCC-PROD-CODE    PIC XXX.
  1182         16  FILLER              PIC X(35).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  27
* EL650.cbl
  1184*          16  PI-NAMEFLG       PIC X.
  1185
  1186*    COPY ELCJPFX.
  1187******************************************************************
  1188*                                                                *
  1189*                                                                *
  1190*                            ELCJPFX.                            *
  1191*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1192*                            VMOD=2.002                          *
  1193*                                                                *
  1194*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1195*                                                                *
  1196*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1197*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1198*        ELCNTL - CONTROL FILE                                   *
  1199*        ELMSTR - CLAIM MASTERS                                  *
  1200*        ELTRLR - ACTIVITY TRAILERS                              *
  1201*        ELCHKQ - CHECK QUE                                      *
  1202******************************************************************
  1203 01  JOURNAL-RECORD.
  1204     12  jp-date                     pic s9(5) comp-3.
  1205     12  jp-time                     pic s9(7) comp-3.
  1206     12  JP-USER-ID                  PIC X(4).
  1207     12  JP-FILE-ID                  PIC X(8).
  1208     12  JP-PROGRAM-ID               PIC X(8).
  1209     12  JP-RECORD-TYPE              PIC X.
  1210         88 JP-ADD              VALUE 'A'.
  1211         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1212         88 JP-AFTER-CHANGE     VALUE 'C'.
  1213         88 JP-DELETE           VALUE 'D'.
  1214         88 JP-GENERIC-DELETE   VALUE 'G'.
  1215         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1216         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1217     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1218     12  JP-RECORD-AREA
  1219
  1220
  1221                                 PIC  X(2000).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  28
* EL650.cbl
  1223*    COPY ELCAID.
  1224******************************************************************
  1225*                                                                *
  1226*                            ELCAID.                             *
  1227*                            VMOD=2.001                          *
  1228*                                                                *
  1229*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1230*                                                                *
  1231*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1232*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1233******************************************************************
  1234
  1235 01  DFHAID.
  1236   02  DFHNULL   PIC  X  VALUE  ' '.
  1237   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1238   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1239   02  DFHPEN    PIC  X  VALUE  '='.
  1240   02  DFHOPID   PIC  X  VALUE  'W'.
  1241   02  DFHPA1    PIC  X  VALUE  '%'.
  1242   02  DFHPA2    PIC  X  VALUE  '>'.
  1243   02  DFHPA3    PIC  X  VALUE  ','.
  1244   02  DFHPF1    PIC  X  VALUE  '1'.
  1245   02  DFHPF2    PIC  X  VALUE  '2'.
  1246   02  DFHPF3    PIC  X  VALUE  '3'.
  1247   02  DFHPF4    PIC  X  VALUE  '4'.
  1248   02  DFHPF5    PIC  X  VALUE  '5'.
  1249   02  DFHPF6    PIC  X  VALUE  '6'.
  1250   02  DFHPF7    PIC  X  VALUE  '7'.
  1251   02  DFHPF8    PIC  X  VALUE  '8'.
  1252   02  DFHPF9    PIC  X  VALUE  '9'.
  1253   02  DFHPF10   PIC  X  VALUE  ':'.
  1254   02  DFHPF11   PIC  X  VALUE  '#'.
  1255   02  DFHPF12   PIC  X  VALUE  '@'.
  1256   02  DFHPF13   PIC  X  VALUE  'A'.
  1257   02  DFHPF14   PIC  X  VALUE  'B'.
  1258   02  DFHPF15   PIC  X  VALUE  'C'.
  1259   02  DFHPF16   PIC  X  VALUE  'D'.
  1260   02  DFHPF17   PIC  X  VALUE  'E'.
  1261   02  DFHPF18   PIC  X  VALUE  'F'.
  1262   02  DFHPF19   PIC  X  VALUE  'G'.
  1263   02  DFHPF20   PIC  X  VALUE  'H'.
  1264   02  DFHPF21   PIC  X  VALUE  'I'.
  1265*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1266   02  DFHPF22   PIC  X  VALUE  '['.
  1267   02  DFHPF23   PIC  X  VALUE  '.'.
  1268   02  DFHPF24   PIC  X  VALUE  '<'.
  1269   02  DFHMSRE   PIC  X  VALUE  'X'.
  1270   02  DFHSTRF   PIC  X  VALUE  'h'.
  1271   02  DFHTRIG   PIC  X  VALUE  '"'.
  1272
  1273 01  FILLER  REDEFINES  DFHAID.
  1274     12  FILLER              PIC  X(8).
  1275     12  PF-VALUES           PIC  X      OCCURS  24  TIMES.
  1276     12  FILLER              PIC  X(3).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  29
* EL650.cbl
  1278*    COPY EL650S.
  1279 01  EL650AI.
  1280     05  FILLER            PIC  X(0012).
  1281*    -------------------------------
  1282     05  DATEL PIC S9(0004) COMP.
  1283     05  DATEF PIC  X(0001).
  1284     05  FILLER REDEFINES DATEF.
  1285         10  DATEA PIC  X(0001).
  1286     05  DATEI PIC  X(0008).
  1287*    -------------------------------
  1288     05  TIMEL PIC S9(0004) COMP.
  1289     05  TIMEF PIC  X(0001).
  1290     05  FILLER REDEFINES TIMEF.
  1291         10  TIMEA PIC  X(0001).
  1292     05  TIMEI PIC  X(0005).
  1293*    -------------------------------
  1294     05  CMPNYIDL PIC S9(0004) COMP.
  1295     05  CMPNYIDF PIC  X(0001).
  1296     05  FILLER REDEFINES CMPNYIDF.
  1297         10  CMPNYIDA PIC  X(0001).
  1298     05  CMPNYIDI PIC  X(0003).
  1299*    -------------------------------
  1300     05  USERIDL PIC S9(0004) COMP.
  1301     05  USERIDF PIC  X(0001).
  1302     05  FILLER REDEFINES USERIDF.
  1303         10  USERIDA PIC  X(0001).
  1304     05  USERIDI PIC  X(0004).
  1305*    -------------------------------
  1306     05  MAINTL PIC S9(0004) COMP.
  1307     05  MAINTF PIC  X(0001).
  1308     05  FILLER REDEFINES MAINTF.
  1309         10  MAINTA PIC  X(0001).
  1310     05  MAINTI PIC  X(0001).
  1311*    -------------------------------
  1312     05  TRNMSG1L PIC S9(0004) COMP.
  1313     05  TRNMSG1F PIC  X(0001).
  1314     05  FILLER REDEFINES TRNMSG1F.
  1315         10  TRNMSG1A PIC  X(0001).
  1316     05  TRNMSG1I PIC  X(0017).
  1317*    -------------------------------
  1318     05  LINEL PIC S9(0004) COMP.
  1319     05  LINEF PIC  X(0001).
  1320     05  FILLER REDEFINES LINEF.
  1321         10  LINEA PIC  X(0001).
  1322     05  LINEI PIC  9.
  1323*    -------------------------------
  1324     05  ACARIERL PIC S9(0004) COMP.
  1325     05  ACARIERF PIC  X(0001).
  1326     05  FILLER REDEFINES ACARIERF.
  1327         10  ACARIERA PIC  X(0001).
  1328     05  ACARIERI PIC  X(0001).
  1329*    -------------------------------
  1330     05  AGROUPL PIC S9(0004) COMP.
  1331     05  AGROUPF PIC  X(0001).
  1332     05  FILLER REDEFINES AGROUPF.
  1333         10  AGROUPA PIC  X(0001).
  1334     05  AGROUPI PIC  X(0006).
  1335*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  30
* EL650.cbl
  1336     05  ASTATEL PIC S9(0004) COMP.
  1337     05  ASTATEF PIC  X(0001).
  1338     05  FILLER REDEFINES ASTATEF.
  1339         10  ASTATEA PIC  X(0001).
  1340     05  ASTATEI PIC  X(0002).
  1341*    -------------------------------
  1342     05  AACCTL PIC S9(0004) COMP.
  1343     05  AACCTF PIC  X(0001).
  1344     05  FILLER REDEFINES AACCTF.
  1345         10  AACCTA PIC  X(0001).
  1346     05  AACCTI PIC  X(0010).
  1347*    -------------------------------
  1348     05  NAMEFLGL PIC S9(0004) COMP.
  1349     05  NAMEFLGF PIC  X(0001).
  1350     05  FILLER REDEFINES NAMEFLGF.
  1351         10  NAMEFLGA PIC  X(0001).
  1352     05  NAMEFLGI PIC  X(0001).
  1353*    -------------------------------
  1354     05  NAMEL PIC S9(0004) COMP.
  1355     05  NAMEF PIC  X(0001).
  1356     05  FILLER REDEFINES NAMEF.
  1357         10  NAMEA PIC  X(0001).
  1358     05  NAMEI PIC  X(0030).
  1359*    -------------------------------
  1360     05  ARHDGL PIC S9(0004) COMP.
  1361     05  ARHDGF PIC  X(0001).
  1362     05  FILLER REDEFINES ARHDGF.
  1363         10  ARHDGA PIC  X(0001).
  1364     05  ARHDGI PIC  X(0010).
  1365*    -------------------------------
  1366     05  DET1L PIC S9(0004) COMP.
  1367     05  DET1F PIC  X(0001).
  1368     05  FILLER REDEFINES DET1F.
  1369         10  DET1A PIC  X(0001).
  1370     05  DET1I PIC  X(0070).
  1371*    -------------------------------
  1372     05  DET2L PIC S9(0004) COMP.
  1373     05  DET2F PIC  X(0001).
  1374     05  FILLER REDEFINES DET2F.
  1375         10  DET2A PIC  X(0001).
  1376     05  DET2I PIC  X(0070).
  1377*    -------------------------------
  1378     05  DET3L PIC S9(0004) COMP.
  1379     05  DET3F PIC  X(0001).
  1380     05  FILLER REDEFINES DET3F.
  1381         10  DET3A PIC  X(0001).
  1382     05  DET3I PIC  X(0070).
  1383*    -------------------------------
  1384     05  DET4L PIC S9(0004) COMP.
  1385     05  DET4F PIC  X(0001).
  1386     05  FILLER REDEFINES DET4F.
  1387         10  DET4A PIC  X(0001).
  1388     05  DET4I PIC  X(0070).
  1389*    -------------------------------
  1390     05  DET5L PIC S9(0004) COMP.
  1391     05  DET5F PIC  X(0001).
  1392     05  FILLER REDEFINES DET5F.
  1393         10  DET5A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  31
* EL650.cbl
  1394     05  DET5I PIC  X(0070).
  1395*    -------------------------------
  1396     05  DET6L PIC S9(0004) COMP.
  1397     05  DET6F PIC  X(0001).
  1398     05  FILLER REDEFINES DET6F.
  1399         10  DET6A PIC  X(0001).
  1400     05  DET6I PIC  X(0070).
  1401*    -------------------------------
  1402     05  DET7L PIC S9(0004) COMP.
  1403     05  DET7F PIC  X(0001).
  1404     05  FILLER REDEFINES DET7F.
  1405         10  DET7A PIC  X(0001).
  1406     05  DET7I PIC  X(0070).
  1407*    -------------------------------
  1408     05  DET8L PIC S9(0004) COMP.
  1409     05  DET8F PIC  X(0001).
  1410     05  FILLER REDEFINES DET8F.
  1411         10  DET8A PIC  X(0001).
  1412     05  DET8I PIC  X(0070).
  1413*    -------------------------------
  1414     05  TRNMSG2L PIC S9(0004) COMP.
  1415     05  TRNMSG2F PIC  X(0001).
  1416     05  FILLER REDEFINES TRNMSG2F.
  1417         10  TRNMSG2A PIC  X(0001).
  1418     05  TRNMSG2I PIC  X(0020).
  1419*    -------------------------------
  1420     05  EFFCHGL PIC S9(0004) COMP.
  1421     05  EFFCHGF PIC  X(0001).
  1422     05  FILLER REDEFINES EFFCHGF.
  1423         10  EFFCHGA PIC  X(0001).
  1424     05  EFFCHGI PIC  X(0008).
  1425*    -------------------------------
  1426     05  EXPCHGL PIC S9(0004) COMP.
  1427     05  EXPCHGF PIC  X(0001).
  1428     05  FILLER REDEFINES EXPCHGF.
  1429         10  EXPCHGA PIC  X(0001).
  1430     05  EXPCHGI PIC  X(0008).
  1431*    -------------------------------
  1432     05  TRNMSG3L PIC S9(0004) COMP.
  1433     05  TRNMSG3F PIC  X(0001).
  1434     05  FILLER REDEFINES TRNMSG3F.
  1435         10  TRNMSG3A PIC  X(0001).
  1436     05  TRNMSG3I PIC  X(0003).
  1437*    -------------------------------
  1438     05  TRNTOL PIC S9(0004) COMP.
  1439     05  TRNTOF PIC  X(0001).
  1440     05  FILLER REDEFINES TRNTOF.
  1441         10  TRNTOA PIC  X(0001).
  1442     05  TRNTOI PIC  X(0019).
  1443*    -------------------------------
  1444     05  TRNTODTL PIC S9(0004) COMP.
  1445     05  TRNTODTF PIC  X(0001).
  1446     05  FILLER REDEFINES TRNTODTF.
  1447         10  TRNTODTA PIC  X(0001).
  1448     05  TRNTODTI PIC  X(0008).
  1449*    -------------------------------
  1450     05  TRNMSG4L PIC S9(0004) COMP.
  1451     05  TRNMSG4F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  32
* EL650.cbl
  1452     05  FILLER REDEFINES TRNMSG4F.
  1453         10  TRNMSG4A PIC  X(0001).
  1454     05  TRNMSG4I PIC  X(0005).
  1455*    -------------------------------
  1456     05  TRNFROML PIC S9(0004) COMP.
  1457     05  TRNFROMF PIC  X(0001).
  1458     05  FILLER REDEFINES TRNFROMF.
  1459         10  TRNFROMA PIC  X(0001).
  1460     05  TRNFROMI PIC  X(0019).
  1461*    -------------------------------
  1462     05  TRNFRDTL PIC S9(0004) COMP.
  1463     05  TRNFRDTF PIC  X(0001).
  1464     05  FILLER REDEFINES TRNFRDTF.
  1465         10  TRNFRDTA PIC  X(0001).
  1466     05  TRNFRDTI PIC  X(0008).
  1467*    -------------------------------
  1468     05  ERRMSG1L PIC S9(0004) COMP.
  1469     05  ERRMSG1F PIC  X(0001).
  1470     05  FILLER REDEFINES ERRMSG1F.
  1471         10  ERRMSG1A PIC  X(0001).
  1472     05  ERRMSG1I PIC  X(0075).
  1473*    -------------------------------
  1474     05  ERRMSG2L PIC S9(0004) COMP.
  1475     05  ERRMSG2F PIC  X(0001).
  1476     05  FILLER REDEFINES ERRMSG2F.
  1477         10  ERRMSG2A PIC  X(0001).
  1478     05  ERRMSG2I PIC  X(0075).
  1479*    -------------------------------
  1480     05  PFENTERL PIC S9(0004) COMP.
  1481     05  PFENTERF PIC  X(0001).
  1482     05  FILLER REDEFINES PFENTERF.
  1483         10  PFENTERA PIC  X(0001).
  1484     05  PFENTERI PIC  9(2).
  1485 01  EL650AO REDEFINES EL650AI.
  1486     05  FILLER            PIC  X(0012).
  1487*    -------------------------------
  1488     05  FILLER            PIC  X(0003).
  1489     05  DATEO PIC  X(0008).
  1490*    -------------------------------
  1491     05  FILLER            PIC  X(0003).
  1492     05  TIMEO PIC  99.99.
  1493*    -------------------------------
  1494     05  FILLER            PIC  X(0003).
  1495     05  CMPNYIDO PIC  X(0003).
  1496*    -------------------------------
  1497     05  FILLER            PIC  X(0003).
  1498     05  USERIDO PIC  X(0004).
  1499*    -------------------------------
  1500     05  FILLER            PIC  X(0003).
  1501     05  MAINTO PIC  X(0001).
  1502*    -------------------------------
  1503     05  FILLER            PIC  X(0003).
  1504     05  TRNMSG1O PIC  X(0017).
  1505*    -------------------------------
  1506     05  FILLER            PIC  X(0003).
  1507     05  LINEO PIC  X(0001).
  1508*    -------------------------------
  1509     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  33
* EL650.cbl
  1510     05  ACARIERO PIC  X(0001).
  1511*    -------------------------------
  1512     05  FILLER            PIC  X(0003).
  1513     05  AGROUPO PIC  X(0006).
  1514*    -------------------------------
  1515     05  FILLER            PIC  X(0003).
  1516     05  ASTATEO PIC  X(0002).
  1517*    -------------------------------
  1518     05  FILLER            PIC  X(0003).
  1519     05  AACCTO PIC  X(0010).
  1520*    -------------------------------
  1521     05  FILLER            PIC  X(0003).
  1522     05  NAMEFLGO PIC  X(0001).
  1523*    -------------------------------
  1524     05  FILLER            PIC  X(0003).
  1525     05  NAMEO PIC  X(0030).
  1526*    -------------------------------
  1527     05  FILLER            PIC  X(0003).
  1528     05  ARHDGO PIC  X(0010).
  1529*    -------------------------------
  1530     05  FILLER            PIC  X(0003).
  1531     05  DET1O PIC  X(0070).
  1532*    -------------------------------
  1533     05  FILLER            PIC  X(0003).
  1534     05  DET2O PIC  X(0070).
  1535*    -------------------------------
  1536     05  FILLER            PIC  X(0003).
  1537     05  DET3O PIC  X(0070).
  1538*    -------------------------------
  1539     05  FILLER            PIC  X(0003).
  1540     05  DET4O PIC  X(0070).
  1541*    -------------------------------
  1542     05  FILLER            PIC  X(0003).
  1543     05  DET5O PIC  X(0070).
  1544*    -------------------------------
  1545     05  FILLER            PIC  X(0003).
  1546     05  DET6O PIC  X(0070).
  1547*    -------------------------------
  1548     05  FILLER            PIC  X(0003).
  1549     05  DET7O PIC  X(0070).
  1550*    -------------------------------
  1551     05  FILLER            PIC  X(0003).
  1552     05  DET8O PIC  X(0070).
  1553*    -------------------------------
  1554     05  FILLER            PIC  X(0003).
  1555     05  TRNMSG2O PIC  X(0020).
  1556*    -------------------------------
  1557     05  FILLER            PIC  X(0003).
  1558     05  EFFCHGO PIC  X(0008).
  1559*    -------------------------------
  1560     05  FILLER            PIC  X(0003).
  1561     05  EXPCHGO PIC  99B99B99.
  1562*    -------------------------------
  1563     05  FILLER            PIC  X(0003).
  1564     05  TRNMSG3O PIC  X(0003).
  1565*    -------------------------------
  1566     05  FILLER            PIC  X(0003).
  1567     05  TRNTOO PIC  X(0019).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  34
* EL650.cbl
  1568*    -------------------------------
  1569     05  FILLER            PIC  X(0003).
  1570     05  TRNTODTO PIC  X(0008).
  1571*    -------------------------------
  1572     05  FILLER            PIC  X(0003).
  1573     05  TRNMSG4O PIC  X(0005).
  1574*    -------------------------------
  1575     05  FILLER            PIC  X(0003).
  1576     05  TRNFROMO PIC  X(0019).
  1577*    -------------------------------
  1578     05  FILLER            PIC  X(0003).
  1579     05  TRNFRDTO PIC  X(0008).
  1580*    -------------------------------
  1581     05  FILLER            PIC  X(0003).
  1582     05  ERRMSG1O PIC  X(0075).
  1583*    -------------------------------
  1584     05  FILLER            PIC  X(0003).
  1585     05  ERRMSG2O PIC  X(0075).
  1586*    -------------------------------
  1587     05  FILLER            PIC  X(0003).
  1588     05  PFENTERO PIC  X(0002).
  1589*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  35
* EL650.cbl
  1591 01  EL650R  REDEFINES  EL650AI.
  1592     12  FILLER                      PIC  X(153).
  1593     12  MAP-RECORD-AREA.
  1594         16  DATE-RANGES     OCCURS  8  TIMES
  1595                                 INDEXED  BY  M-INDEX.
  1596             20  FILLER              PIC  X(3).
  1597             20  MAP-EFF-DT          PIC  X(8).
  1598             20  FILLER              PIC  X(6).
  1599             20  MAP-EXP-DT          PIC  X(8).
  1600             20  MAP-EXP-DT-ED  REDEFINES
  1601                 MAP-EXP-DT          PIC 99B99B99.
  1602             20  FILLER              PIC  X(4).
  1603             20  MAP-LST-MAINT-DT    PIC  X(8).
  1604             20  FILLER              PIC  X(3).
  1605             20  MAP-LOW-CERT        PIC  X(8).
  1606             20  FILLER              PIC  X(3).
  1607             20  MAP-HIGH-CERT       PIC  X(8).
  1608             20  FILLER              PIC  X(4).
  1609             20  MAP-AR-DATE         PIC  X(8).
  1610             20  FILLER              PIC  XX.
  1611     12  FILLER                      PIC  X(286).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  36
* EL650.cbl
  1613****************************************************************
  1614*
  1615* Copyright (c) 2007 by Clerity Solutions, Inc.
  1616* All rights reserved.
  1617*
  1618****************************************************************
  1619 01  DFHEIV.
  1620   02  DFHEIV0               PIC X(35).
  1621   02  DFHEIV1               PIC X(08).
  1622   02  DFHEIV2               PIC X(08).
  1623   02  DFHEIV3               PIC X(08).
  1624   02  DFHEIV4               PIC X(06).
  1625   02  DFHEIV5               PIC X(04).
  1626   02  DFHEIV6               PIC X(04).
  1627   02  DFHEIV7               PIC X(02).
  1628   02  DFHEIV8               PIC X(02).
  1629   02  DFHEIV9               PIC X(01).
  1630   02  DFHEIV10              PIC S9(7) COMP-3.
  1631   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1632   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1633   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1634   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1635   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1636   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1637   02  DFHEIV17              PIC X(04).
  1638   02  DFHEIV18              PIC X(04).
  1639   02  DFHEIV19              PIC X(04).
  1640   02  DFHEIV20              USAGE IS POINTER.
  1641   02  DFHEIV21              USAGE IS POINTER.
  1642   02  DFHEIV22              USAGE IS POINTER.
  1643   02  DFHEIV23              USAGE IS POINTER.
  1644   02  DFHEIV24              USAGE IS POINTER.
  1645   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1646   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1647   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1648   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1649   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1650   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1651   02  FILLER                PIC X(02).
  1652   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1653   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1654   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1655   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1656   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1657 LINKAGE  SECTION.
  1658*****************************************************************
  1659*                                                               *
  1660* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1661* All rights reserved.                                          *
  1662*                                                               *
  1663*****************************************************************
  1664 01  dfheiblk.
  1665     02  eibtime          pic s9(7) comp-3.
  1666     02  eibdate          pic s9(7) comp-3.
  1667     02  eibtrnid         pic x(4).
  1668     02  eibtaskn         pic s9(7) comp-3.
  1669     02  eibtrmid         pic x(4).
  1670     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  37
* EL650.cbl
  1671     02  eibcposn         pic s9(4) comp.
  1672     02  eibcalen         pic s9(4) comp.
  1673     02  eibaid           pic x(1).
  1674     02  eibfiller1       pic x(1).
  1675     02  eibfn            pic x(2).
  1676     02  eibfiller2       pic x(2).
  1677     02  eibrcode         pic x(6).
  1678     02  eibfiller3       pic x(2).
  1679     02  eibds            pic x(8).
  1680     02  eibreqid         pic x(8).
  1681     02  eibrsrce         pic x(8).
  1682     02  eibsync          pic x(1).
  1683     02  eibfree          pic x(1).
  1684     02  eibrecv          pic x(1).
  1685     02  eibsend          pic x(1).
  1686     02  eibatt           pic x(1).
  1687     02  eibeoc           pic x(1).
  1688     02  eibfmh           pic x(1).
  1689     02  eibcompl         pic x(1).
  1690     02  eibsig           pic x(1).
  1691     02  eibconf          pic x(1).
  1692     02  eiberr           pic x(1).
  1693     02  eibrldbk         pic x(1).
  1694     02  eiberrcd         pic x(4).
  1695     02  eibsynrb         pic x(1).
  1696     02  eibnodat         pic x(1).
  1697     02  eibfiller5       pic x(2).
  1698     02  eibresp          pic 9(09) comp.
  1699     02  eibresp2         pic 9(09) comp.
  1700     02  dfheigdj         pic s9(4) comp.
  1701     02  dfheigdk         pic s9(4) comp.
  1702 01  DFHCOMMAREA             PIC  X(1500).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  38
* EL650.cbl
  1704*01 PARMLIST .
  1705*    12  FILLER              PIC S9(8)   COMP.
  1706*    12  ERACCT-POINTER      PIC S9(8)   COMP.
  1707*    12  ERCOMP-POINTER      PIC S9(8)   COMP.
  1708*    12  ERNAME-POINTER      PIC S9(8)   COMP.
  1709*    12  ERPLAN-POINTER      PIC S9(8)   COMP.
  1710*    12  ELCNTL-POINTER      PIC S9(8)   COMP.
  1711*    12  ERPNDB-POINTER      PIC S9(8)   COMP.
  1712*    12  AXRF-POINTER        PIC S9(8)   COMP.
  1713*    12  AXRF2-POINTER       PIC S9(8)   COMP.
  1714*    12  AXRF3-POINTER       PIC S9(8)   COMP.
  1715*    12  AXRF4-POINTER       PIC S9(8)   COMP.
  1716*    12  AXRF5-POINTER       PIC S9(8)   COMP.
  1717*    12  AXRF6-POINTER       PIC S9(8)   COMP.
  1718*    12  AXRF7-POINTER       PIC S9(8)   COMP.
  1719*    12  AXRF8-POINTER       PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  39
* EL650.cbl
  1721*    COPY ERCACCT.
  1722******************************************************************
  1723*                                                                *
  1724*                                                                *
  1725*                            ERCACCT                             *
  1726*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1727*                            VMOD=2.031                          *
  1728*                                                                *
  1729*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1730*                                                                *
  1731*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1732*   VSAM ACCOUNT MASTER FILES.                                   *
  1733*                                                                *
  1734*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1735*                                                                *
  1736*   FILE TYPE = VSAM,KSDS                                        *
  1737*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1738*                                                                *
  1739*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1740*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1741*                                                                *
  1742*   LOG = NO                                                     *
  1743*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1744*                                                                *
  1745*                                                                *
  1746******************************************************************
  1747*                   C H A N G E   L O G
  1748*
  1749* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1750*-----------------------------------------------------------------
  1751*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1752* EFFECTIVE    NUMBER
  1753*-----------------------------------------------------------------
  1754* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1755* 092705    2005050300006  PEMA  ADD SPP LEASES
  1756* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1757* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1758* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1759* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1760* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1761******************************************************************
  1762
  1763 01  ACCOUNT-MASTER.
  1764     12  AM-RECORD-ID                      PIC XX.
  1765         88  VALID-AM-ID                      VALUE 'AM'.
  1766
  1767     12  AM-CONTROL-PRIMARY.
  1768         16  AM-COMPANY-CD                 PIC X.
  1769         16  AM-MSTR-CNTRL.
  1770             20  AM-CONTROL-A.
  1771                 24  AM-CARRIER            PIC X.
  1772                 24  AM-GROUPING.
  1773                     28 AM-GROUPING-PREFIX PIC XXX.
  1774                     28 AM-GROUPING-PRIME  PIC XXX.
  1775                 24  AM-STATE              PIC XX.
  1776                 24  AM-ACCOUNT.
  1777                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1778                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  40
* EL650.cbl
  1779             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1780                                           PIC X(19).
  1781             20  AM-CNTRL-B.
  1782                 24  AM-EXPIRATION-DT      PIC XX.
  1783                 24  FILLER                PIC X(4).
  1784             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1785                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1786
  1787     12  AM-CONTROL-BY-VAR-GRP.
  1788         16  AM-COMPANY-CD-A1              PIC X.
  1789         16  AM-VG-CARRIER                 PIC X.
  1790         16  AM-VG-GROUPING                PIC X(6).
  1791         16  AM-VG-STATE                   PIC XX.
  1792         16  AM-VG-ACCOUNT                 PIC X(10).
  1793         16  AM-VG-DATE.
  1794             20  AM-VG-EXPIRATION-DT       PIC XX.
  1795             20  FILLER                    PIC X(4).
  1796         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1797                                           PIC 9(11)      COMP-3.
  1798     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1799         16  FILLER                        PIC X(10).
  1800         16  AM-VG-KEY3.
  1801             20  AM-VG3-ACCOUNT            PIC X(10).
  1802             20  AM-VG3-EXP-DT             PIC XX.
  1803         16  FILLER                        PIC X(4).
  1804     12  AM-MAINT-INFORMATION.
  1805         16  AM-LAST-MAINT-DT              PIC XX.
  1806         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1807         16  AM-LAST-MAINT-USER            PIC X(4).
  1808         16  FILLER                        PIC XX.
  1809
  1810     12  AM-EFFECTIVE-DT                   PIC XX.
  1811     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1812
  1813     12  AM-PREV-DATES  COMP-3.
  1814         16  AM-PREV-EXP-DT                PIC 9(11).
  1815         16  AM-PREV-EFF-DT                PIC 9(11).
  1816
  1817     12  AM-REPORT-CODE-1                  PIC X(10).
  1818     12  AM-REPORT-CODE-2                  PIC X(10).
  1819
  1820     12  AM-CITY-CODE                      PIC X(4).
  1821     12  AM-COUNTY-PARISH                  PIC X(6).
  1822
  1823     12  AM-NAME                           PIC X(30).
  1824     12  AM-PERSON                         PIC X(30).
  1825     12  AM-ADDRS                          PIC X(30).
  1826     12  AM-CITY.
  1827         16  AM-ADDR-CITY                  PIC X(28).
  1828         16  AM-ADDR-STATE                 PIC XX.
  1829     12  AM-ZIP.
  1830         16  AM-ZIP-PRIME.
  1831             20  AM-ZIP-PRI-1ST            PIC X.
  1832                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1833             20  FILLER                    PIC X(4).
  1834         16  AM-ZIP-PLUS4                  PIC X(4).
  1835     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1836         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  41
* EL650.cbl
  1837         16  AM-CAN-POSTAL-2               PIC XXX.
  1838         16  FILLER                        PIC XXX.
  1839     12  AM-TEL-NO.
  1840         16  AM-AREA-CODE                  PIC 999.
  1841         16  AM-TEL-PRE                    PIC 999.
  1842         16  AM-TEL-NBR                    PIC 9(4).
  1843     12  AM-TEL-LOC                        PIC X.
  1844         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1845         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1846
  1847     12  AM-COMM-STRUCTURE.
  1848         16  AM-DEFN-1.
  1849             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1850                 24  AM-AGT.
  1851                     28  AM-AGT-PREFIX     PIC X(4).
  1852                     28  AM-AGT-PRIME      PIC X(6).
  1853                 24  AM-COM-TYP            PIC X.
  1854                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1855                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1856                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1857                 24  AM-RECALC-LV-INDIC    PIC X.
  1858                 24  AM-RETRO-LV-INDIC     PIC X.
  1859                 24  AM-GL-CODES           PIC X.
  1860                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1861                 24  FILLER                PIC X(01).
  1862         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1863             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1864                 24  FILLER                PIC X(11).
  1865                 24  AM-L-COMA             PIC XXX.
  1866                 24  AM-J-COMA             PIC XXX.
  1867                 24  AM-A-COMA             PIC XXX.
  1868                 24  FILLER                PIC X(6).
  1869
  1870     12  AM-COMM-CHANGE-STATUS             PIC X.
  1871         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1872
  1873     12  AM-CSR-CODE                       PIC X(4).
  1874
  1875     12  AM-BILLING-STATUS                 PIC X.
  1876         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1877         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1878     12  AM-AUTO-REFUND-SW                 PIC X.
  1879         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1880         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1881     12  AM-GPCD                           PIC 99.
  1882     12  AM-IG                             PIC X.
  1883         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1884         88  AM-HAS-GROUP                     VALUE '2'.
  1885     12  AM-STATUS                         PIC X.
  1886         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1887         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1888         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1889         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1890         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1891         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1892     12  AM-REMIT-TO                       PIC 99.
  1893     12  AM-ID-NO                          PIC X(11).
  1894
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  42
* EL650.cbl
  1895     12  AM-CAL-TABLE                      PIC XX.
  1896     12  AM-LF-DEVIATION                   PIC XXX.
  1897     12  AM-AH-DEVIATION                   PIC XXX.
  1898     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1899     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1900     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1901     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1902     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1903     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1904
  1905     12  AM-USER-FIELDS.
  1906         16  AM-FLD-1                      PIC XX.
  1907         16  AM-FLD-2                      PIC XX.
  1908         16  AM-FLD-3                      PIC XX.
  1909         16  AM-FLD-4                      PIC XX.
  1910         16  AM-FLD-5                      PIC XX.
  1911
  1912     12  AM-1ST-PROD-DATE.
  1913         16  AM-1ST-PROD-YR                PIC XX.
  1914         16  AM-1ST-PROD-MO                PIC XX.
  1915         16  AM-1ST-PROD-DA                PIC XX.
  1916     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1917     12  AM-CERTS-PURGED-DATE.
  1918         16  AM-PUR-YR                     PIC XX.
  1919         16  AM-PUR-MO                     PIC XX.
  1920         16  AM-PUR-DA                     PIC XX.
  1921     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1922     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1923     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1924     12  AM-INACTIVE-DATE.
  1925         16  AM-INA-MO                     PIC 99.
  1926         16  AM-INA-DA                     PIC 99.
  1927         16  AM-INA-YR                     PIC 99.
  1928     12  AM-AR-HI-CERT-DATE                PIC XX.
  1929
  1930     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1931     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1932
  1933     12  AM-OB-PAYMENT-MODE                PIC X.
  1934         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1935         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1936         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1937         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1938
  1939     12  AM-AH-ONLY-INDICATOR              PIC X.
  1940         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1941         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1942
  1943     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1944
  1945     12  AM-OVER-SHORT.
  1946         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1947         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1948
  1949     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1950     12  AM-DCC-CLP-STATE                  PIC XX.
  1951
  1952     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  43
* EL650.cbl
  1953     12  AM-RECALC-REIN                    PIC X.
  1954
  1955     12  AM-REI-TABLE                      PIC XXX.
  1956     12  AM-REI-ET-LF                      PIC X.
  1957     12  AM-REI-ET-AH                      PIC X.
  1958     12  AM-REI-PE-LF                      PIC X.
  1959     12  AM-REI-PE-AH                      PIC X.
  1960     12  AM-REI-PRT-ST                     PIC X.
  1961     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1962     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1963     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1964     12  AM-REI-GROUP-A                    PIC X(6).
  1965     12  AM-REI-MORT                       PIC X(4).
  1966     12  AM-REI-PRT-OW                     PIC X.
  1967     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1968     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1969     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1970     12  AM-REI-GROUP-B                    PIC X(6).
  1971
  1972     12  AM-TRUST-TYPE                     PIC X(2).
  1973
  1974     12  AM-EMPLOYER-STMT-USED             PIC X.
  1975     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1976
  1977     12  AM-STD-AH-TYPE                    PIC XX.
  1978     12  AM-EARN-METHODS.
  1979         16  AM-EARN-METHOD-R              PIC X.
  1980             88 AM-REF-RL-R78                 VALUE 'R'.
  1981             88 AM-REF-RL-PR                  VALUE 'P'.
  1982             88 AM-REF-RL-MEAN                VALUE 'M'.
  1983             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1984         16  AM-EARN-METHOD-L              PIC X.
  1985             88 AM-REF-LL-R78                 VALUE 'R'.
  1986             88 AM-REF-LL-PR                  VALUE 'P'.
  1987             88 AM-REF-LL-MEAN                VALUE 'M'.
  1988             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1989         16  AM-EARN-METHOD-A              PIC X.
  1990             88 AM-REF-AH-R78                 VALUE 'R'.
  1991             88 AM-REF-AH-PR                  VALUE 'P'.
  1992             88 AM-REF-AH-MEAN                VALUE 'M'.
  1993             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1994             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1995             88 AM-REF-AH-NET                 VALUE 'N'.
  1996
  1997     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1998     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1999     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2000
  2001     12  AM-RET-Y-N                        PIC X.
  2002     12  AM-RET-P-E                        PIC X.
  2003     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2004     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2005     12  AM-RET-GRP                        PIC X(6).
  2006     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2007         16  AM-POOL-PRIME                 PIC XXX.
  2008         16  AM-POOL-SUB                   PIC XXX.
  2009     12  AM-RETRO-EARNINGS.
  2010         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  44
* EL650.cbl
  2011         16  AM-RET-EARN-L                 PIC X.
  2012         16  AM-RET-EARN-A                 PIC X.
  2013     12  AM-RET-ST-TAX-USE                 PIC X.
  2014         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2015         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2016     12  AM-RETRO-BEG-EARNINGS.
  2017         16  AM-RET-BEG-EARN-R             PIC X.
  2018         16  AM-RET-BEG-EARN-L             PIC X.
  2019         16  AM-RET-BEG-EARN-A             PIC X.
  2020     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2021     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2022
  2023     12  AM-USER-SELECT-OPTIONS.
  2024         16  AM-USER-SELECT-1              PIC X(10).
  2025         16  AM-USER-SELECT-2              PIC X(10).
  2026         16  AM-USER-SELECT-3              PIC X(10).
  2027         16  AM-USER-SELECT-4              PIC X(10).
  2028         16  AM-USER-SELECT-5              PIC X(10).
  2029
  2030     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2031
  2032     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2033
  2034     12  AM-RPT045A-SWITCH                 PIC X.
  2035         88  RPT045A-OFF                   VALUE 'N'.
  2036
  2037     12  AM-INSURANCE-LIMITS.
  2038         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2039         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2040
  2041     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2042         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2043
  2044     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2045         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2046         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2047
  2048     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2049
  2050     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2051     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2052     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2053     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2054     12  AM-DCC-UEF-STATE                  PIC XX.
  2055     12  FILLER                            PIC XXX.
  2056     12  AM-REPORT-CODE-3                  PIC X(10).
  2057*    12  FILLER                            PIC X(22).
  2058
  2059     12  AM-RESERVE-DATE.
  2060         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2061         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2062         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2063
  2064     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2065     12  AM-NOTIFICATION-TYPES.
  2066         16  AM-NOTIF-OF-LETTERS           PIC X.
  2067         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2068         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  45
* EL650.cbl
  2069         16  AM-NOTIF-OF-STATUS            PIC X.
  2070
  2071     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2072         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2073         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2074         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2075         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2076
  2077     12  AM-BENEFIT-CONTROLS.
  2078         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2079             20  AM-BENEFIT-CODE           PIC XX.
  2080             20  AM-BENEFIT-TYPE           PIC X.
  2081             20  AM-BENEFIT-REVISION       PIC XXX.
  2082             20  AM-BENEFIT-REM-TERM       PIC X.
  2083             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2084             20  FILLER                    PIC XX.
  2085         16  FILLER                        PIC X(80).
  2086
  2087     12  AM-TRANSFER-DATA.
  2088         16  AM-TRANSFERRED-FROM.
  2089             20  AM-TRNFROM-CARRIER        PIC X.
  2090             20  AM-TRNFROM-GROUPING.
  2091                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2092                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2093             20  AM-TRNFROM-STATE          PIC XX.
  2094             20  AM-TRNFROM-ACCOUNT.
  2095                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2096                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2097             20  AM-TRNFROM-DTE            PIC XX.
  2098         16  AM-TRANSFERRED-TO.
  2099             20  AM-TRNTO-CARRIER          PIC X.
  2100             20  AM-TRNTO-GROUPING.
  2101                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2102                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2103             20  AM-TRNTO-STATE            PIC XX.
  2104             20  AM-TRNTO-ACCOUNT.
  2105                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2106                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2107             20  AM-TRNTO-DTE              PIC XX.
  2108         16  FILLER                        PIC X(10).
  2109
  2110     12  AM-SAVED-REMIT-TO                 PIC 99.
  2111
  2112     12  AM-COMM-STRUCTURE-SAVED.
  2113         16  AM-DEFN-1-SAVED.
  2114             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2115                 24  AM-AGT-SV             PIC X(10).
  2116                 24  AM-COM-TYP-SV         PIC X.
  2117                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2118                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2119                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2120                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2121                 24  FILLER                PIC X.
  2122                 24  AM-GL-CODES-SV        PIC X.
  2123                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2124                 24  FILLER                PIC X.
  2125         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2126             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  46
* EL650.cbl
  2127                 24  FILLER                PIC X(11).
  2128                 24  AM-L-COMA-SV          PIC XXX.
  2129                 24  AM-J-COMA-SV          PIC XXX.
  2130                 24  AM-A-COMA-SV          PIC XXX.
  2131                 24  FILLER                PIC X(6).
  2132
  2133     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2134         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2135            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2136            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2137            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2138
  2139     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2140     12  FILLER                            PIC X(120).
  2141
  2142     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2143         16  AM-CONTROL-NAME               PIC X(30).
  2144         16  AM-EXECUTIVE-ONE.
  2145             20  AM-EXEC1-NAME             PIC X(15).
  2146             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2147                                                          COMP-3.
  2148             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2149                                                          COMP-3.
  2150         16  AM-EXECUTIVE-TWO.
  2151             20  AM-EXEC2-NAME             PIC X(15).
  2152             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2153                                                          COMP-3.
  2154             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2155                                                          COMP-3.
  2156
  2157     12  AM-RETRO-ADDITIONAL-DATA.
  2158         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2159         16  AM-RETRO-PREM-P-E             PIC X.
  2160         16  AM-RETRO-CLMS-P-I             PIC X.
  2161         16  AM-RETRO-RET-BRACKET-LF.
  2162             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2163                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2164                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2165             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2166                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2167                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2168             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2169                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2170                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2171         16  AM-RETRO-RET-BRACKET-AH.
  2172             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2173                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2174                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2175                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2176             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2177                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2178                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2179             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2180                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2181                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2182
  2183     12  AM-COMMENTS.
  2184         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  47
* EL650.cbl
  2185
  2186     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2187         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2188         16  AM-FLI-BILLING-CODE           PIC X.
  2189         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2190         16  AM-FLI-UNITED-IDENT           PIC X.
  2191         16  AM-FLI-INTEREST-LOST-DATA.
  2192             20  AM-FLI-BANK-NO            PIC X(5).
  2193             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2194             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2195             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2196         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2197             20  AM-FLI-AGT                PIC X(9).
  2198             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2199             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2200         16  FILLER                        PIC X(102).
  2201
  2202     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2203         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2204             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2205             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2206             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2207             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2208             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2209         16  FILLER                          PIC X(10).
  2210******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  48
* EL650.cbl
  2212*    COPY ERCCOMP.
  2213******************************************************************
  2214*                                                                *
  2215*                                                                *
  2216*                            ERCCOMP                             *
  2217*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2218*                            VMOD=2.019                          *
  2219*                                                                *
  2220*   ONLINE CREDIT SYSTEM                                         *
  2221*                                                                *
  2222*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  2223*                                                                *
  2224*   FILE TYPE = VSAM,KSDS                                        *
  2225*   RECORD SIZE = 700   RECFORM = FIXED                          *
  2226*                                                                *
  2227*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  2228*       ALTERNATE PATH = NONE                                    *
  2229*                                                                *
  2230*   LOG = NO                                                     *
  2231*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2232*                                                                *
  2233******************************************************************
  2234*                   C H A N G E   L O G
  2235*
  2236* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2237*-----------------------------------------------------------------
  2238*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2239* EFFECTIVE    NUMBER
  2240*-----------------------------------------------------------------
  2241* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2242* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  2243* 092205    2005050300006  PEMA  ADD LEASE FEE
  2244* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  2245* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  2246* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  2247* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2248* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  2249* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  2250******************************************************************
  2251
  2252 01  COMPENSATION-MASTER.
  2253     12  CO-RECORD-ID                          PIC XX.
  2254         88  VALID-CO-ID                          VALUE 'CO'.
  2255
  2256     12  CO-CONTROL-PRIMARY.
  2257         16  CO-COMPANY-CD                     PIC X.
  2258         16  CO-CONTROL.
  2259             20  CO-CTL-1.
  2260                 24  CO-CARR-GROUP.
  2261                     28  CO-CARRIER            PIC X.
  2262                     28  CO-GROUPING.
  2263                         32  CO-GROUP-PREFIX   PIC XXX.
  2264                         32  CO-GROUP-PRIME    PIC XXX.
  2265                 24  CO-RESP-NO.
  2266                     28  CO-RESP-PREFIX        PIC X(4).
  2267                     28  CO-RESP-PRIME         PIC X(6).
  2268             20  CO-CTL-2.
  2269                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  49
* EL650.cbl
  2270                     28  CO-ACCT-PREFIX        PIC X(4).
  2271                     28  CO-ACCT-PRIME         PIC X(6).
  2272         16  CO-TYPE                           PIC X.
  2273             88  CO-COMPANY-TYPE                  VALUE 'C'.
  2274             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  2275             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  2276
  2277     12  CO-MAINT-INFORMATION.
  2278         16  CO-LAST-MAINT-DT                  PIC XX.
  2279         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2280         16  CO-LAST-MAINT-USER                PIC X(4).
  2281     12  FILLER                                PIC XX.
  2282     12  CO-STMT-TYPE                          PIC XXX.
  2283     12  CO-COMP-TYPE                          PIC X.
  2284         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  2285     12  CO-STMT-OWNER                         PIC X(4).
  2286     12  CO-BALANCE-CONTROL                    PIC X.
  2287         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  2288         88  CO-NO-BALANCE                        VALUE 'N'.
  2289
  2290     12  CO-INTERNAL-CONTROL-1                 PIC X.
  2291         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  2292         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  2293         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  2294
  2295     12  CO-INTERNAL-CONTROL-2                 PIC X.
  2296         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  2297         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  2298
  2299     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  2300     12  CO-GA-DIRECT-DEP                      PIC X.
  2301     12  CO-FUTURE-SPACE                       PIC X.
  2302         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  2303
  2304     12  CO-ACCT-NAME                          PIC X(30).
  2305     12  CO-MAIL-NAME                          PIC X(30).
  2306     12  CO-ADDR-1                             PIC X(30).
  2307     12  CO-ADDR-2                             PIC X(30).
  2308     12  CO-ADDR-3.
  2309         16  CO-ADDR-CITY                      PIC X(27).
  2310         16  CO-ADDR-STATE                     PIC XX.
  2311     12  CO-CSO-1099                           PIC X.
  2312     12  CO-ZIP.
  2313         16  CO-ZIP-PRIME.
  2314             20  CO-ZIP-PRI-1ST                PIC X.
  2315                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2316             20  FILLER                        PIC X(4).
  2317         16  CO-ZIP-PLUS4                      PIC X(4).
  2318     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  2319         16  CO-CAN-POSTAL-1                   PIC XXX.
  2320         16  CO-CAN-POSTAL-2                   PIC XXX.
  2321         16  FILLER                            PIC XXX.
  2322     12  CO-SOC-SEC                            PIC X(13).
  2323     12  CO-TELEPHONE.
  2324         16  CO-AREA-CODE                      PIC XXX.
  2325         16  CO-PREFIX                         PIC XXX.
  2326         16  CO-PHONE                          PIC X(4).
  2327
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  50
* EL650.cbl
  2328     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  2329
  2330     12  CO-AR-BAL-LEVEL                       PIC X.
  2331         88  CO-AR-REF-LVL                        VALUE '1'.
  2332         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  2333         88  CO-AR-BILL-LVL                       VALUE '2'.
  2334         88  CO-AR-AGT-LVL                        VALUE '3'.
  2335         88  CO-AR-FR-LVL                         VALUE '4'.
  2336
  2337     12  CO-AR-NORMAL-PRINT                    PIC X.
  2338         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  2339         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  2340
  2341     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  2342
  2343     12  CO-AR-REPORTING                       PIC X.
  2344         88  CO-AR-NET-REPORT                     VALUE 'N'.
  2345         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  2346
  2347     12  CO-AR-PULL-CHECK                      PIC X.
  2348         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  2349         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  2350
  2351     12  CO-AR-BALANCE-PRINT                   PIC X.
  2352         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  2353
  2354     12  CO-AR-LAST-RUN-CODE                   PIC X.
  2355         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  2356         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  2357         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  2358
  2359     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  2360
  2361     12  CO-USER-CODE                          PIC X.
  2362     12  CO-REPORT-GROUP-ID                    PIC X(12).
  2363
  2364******************************************************************
  2365*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  2366*    THE LAST MONTH END RUN.
  2367******************************************************************
  2368
  2369     12  CO-LAST-ACTIVITY-DATE.
  2370         16  CO-ACT-YEAR                       PIC 99.
  2371         16  CO-ACT-MONTH                      PIC 99.
  2372         16  CO-ACT-DAY                        PIC 99.
  2373
  2374     12  CO-LAST-STMT-DT.
  2375         16  CO-LAST-STMT-YEAR                 PIC 99.
  2376         16  CO-LAST-STMT-MONTH                PIC 99.
  2377         16  CO-LAST-STMT-DAY                  PIC 99.
  2378
  2379     12  CO-MO-END-TOTALS.
  2380         16  CO-MONTHLY-TOTALS.
  2381             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  2382             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  2383             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  2384             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  2385             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  51
* EL650.cbl
  2386
  2387         16  CO-AGING-TOTALS.
  2388             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  2389             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  2390             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  2391             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  2392
  2393         16  CO-YTD-TOTALS.
  2394             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  2395             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  2396
  2397         16  CO-OVER-UNDER-TOTALS.
  2398             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2399             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2400
  2401     12  CO-MISCELLANEOUS-TOTALS.
  2402         16  CO-FICA-TOTALS.
  2403             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  2404             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  2405
  2406         16  CO-CLAIM-TOTALS.
  2407             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  2408             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  2409
  2410******************************************************************
  2411*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  2412*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  2413******************************************************************
  2414
  2415     12  CO-CURRENT-TOTALS.
  2416         16  CO-CURRENT-LAST-STMT-DT.
  2417             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  2418             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  2419             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  2420
  2421         16  CO-CURRENT-MONTHLY-TOTALS.
  2422             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  2423             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  2424             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  2425             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  2426             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  2427
  2428         16  CO-CURRENT-AGING-TOTALS.
  2429             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  2430             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  2431             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  2432             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  2433
  2434         16  CO-CURRENT-YTD-TOTALS.
  2435             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  2436             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  2437
  2438     12  CO-PAID-COMM-TOTALS.
  2439         16  CO-YTD-PAID-COMMS.
  2440             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  2441             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  2442
  2443     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  52
* EL650.cbl
  2444         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  2445         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  2446
  2447     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  2448         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  2449         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  2450         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  2451         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  2452         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  2453         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  2454         88  CO-FINAL-LETTER                  VALUE 'F'.
  2455         88  CO-RECONCILING                   VALUE 'R'.
  2456         88  CO-PHONE-CALL                    VALUE 'P'.
  2457         88  CO-LEGAL                         VALUE 'L'.
  2458         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  2459         88  CO-WRITE-OFF                     VALUE 'W'.
  2460         88  CO-NO-ACTION                     VALUE 'N' ' '.
  2461
  2462     12  CO-CSR-CODE                       PIC X(4).
  2463
  2464     12  CO-GA-STATUS-INFO.
  2465         16  CO-GA-EFFECTIVE-DT            PIC XX.
  2466         16  CO-GA-TERMINATION-DT          PIC XX.
  2467         16  CO-GA-STATUS-CODE             PIC X.
  2468             88  CO-GA-ACTIVE                 VALUE 'A'.
  2469             88  CO-GA-INACTIVE               VALUE 'I'.
  2470             88  CO-GA-PENDING                VALUE 'P'.
  2471         16  CO-GA-COMMENTS.
  2472             20  CO-GA-COMMENT-1           PIC X(40).
  2473             20  CO-GA-COMMENT-2           PIC X(40).
  2474             20  CO-GA-COMMENT-3           PIC X(40).
  2475             20  CO-GA-COMMENT-4           PIC X(40).
  2476
  2477     12  CO-RPTCD2                         PIC X(10).
  2478     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  2479         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  2480         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  2481
  2482     12  CO-TYPE-AGENT                     PIC X(01).
  2483         88  CO-CORPORATION                   VALUE 'C'.
  2484         88  CO-PARTNERSHIP                   VALUE 'P'.
  2485         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  2486         88  CO-TRUST                         VALUE 'T'.
  2487         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  2488
  2489     12  CO-FAXNO.
  2490         16  CO-FAX-AREA-CODE                  PIC XXX.
  2491         16  CO-FAX-PREFIX                     PIC XXX.
  2492         16  CO-FAX-PHONE                      PIC X(4).
  2493
  2494     12  CO-BANK-INFORMATION.
  2495         16  CO-BANK-TRANSIT-NO                PIC X(8).
  2496         16  CO-BANK-TRANSIT-NON REDEFINES
  2497             CO-BANK-TRANSIT-NO                PIC 9(8).
  2498
  2499         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  2500     12  CO-MISC-DEDUCT-INFO REDEFINES
  2501                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  53
* EL650.cbl
  2502         16  CO-MD-GL-ACCT                     PIC X(10).
  2503         16  CO-MD-DIV                         PIC XX.
  2504         16  CO-MD-CENTER                      PIC X(4).
  2505         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  2506         16  CO-CREATE-AP-CHECK                PIC X.
  2507         16  CO-DELIVER-CK-TO-MEL              PIC X.
  2508         16  FILLER                            PIC XXX.
  2509     12  CO-ACH-STATUS                         PIC X.
  2510         88  CO-ACH-ACTIVE                         VALUE 'A'.
  2511         88  CO-ACH-PENDING                        VALUE 'P'.
  2512
  2513     12  CO-BILL-SW                            PIC X.
  2514     12  CO-CONTROL-NAME                       PIC X(30).
  2515     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  2516     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  2517     12  CO-CLP-STATE                          PIC XX.
  2518     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  2519     12  CO-SPP-REFUND-EDIT                    PIC X.
  2520
  2521******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  54
* EL650.cbl
  2523*    COPY ERCNAME.
  2524******************************************************************
  2525*                                                                *
  2526*                                                                *
  2527*                            ERCNAME                             *
  2528*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2529*                            VMOD=2.003                          *
  2530*                                                                *
  2531*   CREDIT SYSTEM ACCOUNT MASTER NAME, COMPENSATION MASTER       *
  2532*       NAME, REINSURANCE COMPANY NAME LOOKUP FILE.              *
  2533*                                                                *
  2534*   FILE DESCRIPTION = NAME LOOKUP FILE                          *
  2535*                                                                *
  2536*   FILE TYPE = VSAM,KSDS                                        *
  2537*   RECORD SIZE = 160   RECFORM = FIX                            *
  2538*                                                                *
  2539*   BASE CLUSTER NAME = ERNAME                    RKP=2,LEN=61   *
  2540*                                                                *
  2541*   LOG = NO                                                     *
  2542*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2543*                                                                *
  2544*                                                                *
  2545******************************************************************
  2546
  2547 01  NAME-LOOKUP-MASTER.
  2548     12  NL-RECORD-ID                PIC  X(02).
  2549         88  VALID-NL-ID                         VALUE 'NL'.
  2550
  2551     12  NL-RECORD-KEY.
  2552         16  NL-CONTROL-PRIMARY.
  2553             20  NL-COMPANY-CD       PIC  X(01).
  2554             20  NL-NAME             PIC  X(30).
  2555             20  NL-RECORD-TYPE      PIC  X(01).
  2556                 88  NL-ACCOUNT-TYPE             VALUE 'A'.
  2557                 88  NL-COMPENSATION-TYPE        VALUE 'C'.
  2558                 88  NL-REINSURANCE-TYPE         VALUE 'R'.
  2559
  2560         16  NL-ACCOUNT-MASTER.
  2561             20  NL-AM-COMPANY-CD    PIC  X(01).
  2562             20  NL-AM-CARRIER       PIC  X(01).
  2563             20  NL-AM-GROUPING      PIC  X(06).
  2564             20  NL-AM-STATE         PIC  X(02).
  2565             20  NL-AM-ACCOUNT       PIC  X(10).
  2566             20  FILLER              PIC  X(09).
  2567
  2568         16  NL-COMPENSATION-MASTER
  2569                                 REDEFINES  NL-ACCOUNT-MASTER.
  2570             20  NL-CO-COMPANY-CD    PIC  X(01).
  2571             20  NL-CO-CARRIER       PIC  X(01).
  2572             20  NL-CO-GROUPING      PIC  X(06).
  2573             20  NL-CO-RESP-NO       PIC  X(10).
  2574             20  NL-CO-ACCOUNT       PIC  X(10).
  2575             20  NL-CO-TYPE          PIC  X(01).
  2576
  2577         16  NL-REINSURANCE-RECORD
  2578                                 REDEFINES  NL-ACCOUNT-MASTER.
  2579             20  NL-RE-COMPANY-CD    PIC  X(01).
  2580             20  NL-RE-CODE          PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  55
* EL650.cbl
  2581             20  NL-RE-COMPANY.
  2582                 24  NL-RE-COMP      PIC  X(03).
  2583                 24  NL-RE-CO-SUB    PIC  X(03).
  2584             20  NL-RE-TABLE         PIC  X(03).
  2585             20  FILLER              PIC  X(18).
  2586
  2587     12  NL-MAINT-INFORMATION.
  2588         16  NL-LAST-MAINT-DT        PIC  X(02).
  2589         16  NL-LAST-MAINT-HHMMSS    PIC S9(07)  COMP-3.
  2590         16  NL-LAST-MAINT-USER      PIC  X(04).
  2591         16  FILLER                  PIC  X(10).
  2592
  2593     12  NL-RE-LEVELS  OCCURS  30  TIMES.
  2594         16  NL-RE-LEVEL             PIC  9(02).
  2595
  2596     12  NL-CITY                     PIC  X(15).
  2597     12  NL-ST                       PIC  XX.
  2598
  2599******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  56
* EL650.cbl
  2601*    COPY ERCPLAN.
  2602******************************************************************
  2603*                                                                *
  2604*                                                                *
  2605*                            ERCPLAN                             *
  2606*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2607*                            VMOD=2.003                          *
  2608*                                                                *
  2609*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  2610*                                                                *
  2611*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  2612*   PLAN MASTER                                                  *
  2613*                                                                *
  2614*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  2615*                                                                *
  2616*   FILE TYPE = VSAM,KSDS                                        *
  2617*   RECORD SIZE = 420   RECFORM = FIX                            *
  2618*                                                                *
  2619*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  2620*       ALTERNATE PATH1 = N/A                                    *
  2621*                                                                *
  2622*   LOG = NO                                                     *
  2623*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2624*                                                                *
  2625*                                                                *
  2626******************************************************************
  2627
  2628 01  PLAN-MASTER.
  2629     12  PL-RECORD-ID                      PIC XX.
  2630         88  VALID-PL-ID                      VALUE 'PL'.
  2631
  2632     12  PL-CONTROL-PRIMARY.
  2633         16  PL-COMPANY-CD                 PIC X.
  2634         16  PL-MSTR-CNTRL.
  2635             20  PL-CONTROL-A.
  2636                 24  PL-CARRIER            PIC X.
  2637                 24  PL-GROUPING           PIC X(6).
  2638                 24  PL-STATE              PIC XX.
  2639                 24  PL-ACCOUNT            PIC X(10).
  2640             20  PL-BENEFIT-TYPE           PIC X.
  2641             20  PL-BENEFIT-CODE           PIC XX.
  2642             20  PL-REVISION-NO            PIC X(3).
  2643
  2644     12  PL-CONTROL-BY-VAR-GRP.
  2645         16  PL-COMPANY-CD-A1              PIC X.
  2646         16  PL-VG-CARRIER                 PIC X.
  2647         16  PL-VG-GROUPING                PIC X(6).
  2648         16  PL-VG-STATE                   PIC XX.
  2649         16  PL-VG-ACCOUNT                 PIC X(10).
  2650         16  PL-BENEFIT-TYPE-A1            PIC X.
  2651         16  PL-BENEFIT-CODE-A1            PIC XX.
  2652         16  PL-REVISION-NO-A1             PIC 999.
  2653
  2654     12  PL-MAINT-INFORMATION.
  2655         16  PL-LAST-MAINT-DT              PIC XX.
  2656         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2657         16  PL-LAST-MAINT-USER            PIC X(4).
  2658         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  57
* EL650.cbl
  2659
  2660     12  PL-LIABILITY-LIMITS.
  2661         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2662         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2663             20  PL-LM-AGE                 PIC S99        COMP-3.
  2664             20  PL-LM-DUR                 PIC S999       COMP-3.
  2665             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2666             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2667
  2668     12  FILLER                            PIC X(30).
  2669
  2670     12  PL-GL-ACCOUNT-NOS.
  2671         16  PL-PREMIUM-GL                 PIC X(8).
  2672         16  PL-COMM-GL                    PIC X(8).
  2673         16  PL-CLAIM-GL                   PIC X(8).
  2674     12  FILLER                            PIC X(24).
  2675     12  PL-TOLERANCES.
  2676         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2677         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2678         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2679         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2680         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2681         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2682     12  PL-OVER-SHORT.
  2683         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2684         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2685     12  FILLER                            PIC X(24).
  2686     12  PLAN-MISC.
  2687         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2688         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2689         16  PL-IG                         PIC X.
  2690         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2691         16  PL-POLICY-FORM                PIC X(12).
  2692         16  PL-EDIT-FOR-FORM              PIC X(01).
  2693         16  PL-DEV-CODE                   PIC XXX.
  2694         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2695         16  PL-CALC-METHOD                PIC X.
  2696         16  PL-BENEFIT-GROUP              PIC X(05).
  2697         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2698
  2699         16  FILLER                        PIC X(99).
  2700******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  58
* EL650.cbl
  2702*    COPY ELCCNTL.
  2703******************************************************************
  2704*                                                                *
  2705*                                                                *
  2706*                            ELCCNTL.                            *
  2707*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2708*                            VMOD=2.059                          *
  2709*                                                                *
  2710*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2711*                                                                *
  2712*   FILE TYPE = VSAM,KSDS                                        *
  2713*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2714*                                                                *
  2715*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2716*       ALTERNATE INDEX = NONE                                   *
  2717*                                                                *
  2718*   LOG = YES                                                    *
  2719*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2720******************************************************************
  2721*                   C H A N G E   L O G
  2722*
  2723* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2724*-----------------------------------------------------------------
  2725*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2726* EFFECTIVE    NUMBER
  2727*-----------------------------------------------------------------
  2728* 082503                   PEMA  ADD BENEFIT GROUP
  2729* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2730* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2731* 092705    2005050300006  PEMA  ADD SPP LEASES
  2732* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2733* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2734* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2735* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2736* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2737* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2738* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2739* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2740* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2741******************************************************************
  2742*
  2743 01  CONTROL-FILE.
  2744     12  CF-RECORD-ID                       PIC XX.
  2745         88  VALID-CF-ID                        VALUE 'CF'.
  2746
  2747     12  CF-CONTROL-PRIMARY.
  2748         16  CF-COMPANY-ID                  PIC XXX.
  2749         16  CF-RECORD-TYPE                 PIC X.
  2750             88  CF-COMPANY-MASTER              VALUE '1'.
  2751             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2752             88  CF-STATE-MASTER                VALUE '3'.
  2753             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2754             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2755             88  CF-CARRIER-MASTER              VALUE '6'.
  2756             88  CF-MORTALITY-MASTER            VALUE '7'.
  2757             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2758             88  CF-TERMINAL-MASTER             VALUE '9'.
  2759             88  CF-AH-EDIT-MASTER              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  59
* EL650.cbl
  2760             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2761             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2762             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2763             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2764             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2765             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2766             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2767             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2768         16  CF-ACCESS-CD-GENL              PIC X(4).
  2769         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2770             20  CF-PROCESSOR               PIC X(4).
  2771         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2772             20  CF-STATE-CODE              PIC XX.
  2773             20  FILLER                     PIC XX.
  2774         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2775             20  FILLER                     PIC XX.
  2776             20  CF-HI-BEN-IN-REC           PIC XX.
  2777         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2778             20  FILLER                     PIC XXX.
  2779             20  CF-CARRIER-CNTL            PIC X.
  2780         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2781             20  FILLER                     PIC XX.
  2782             20  CF-HI-TYPE-IN-REC          PIC 99.
  2783         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2784             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2785                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2786             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2787             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2788         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2789             20  FILLER                     PIC X.
  2790             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2791         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2792             20  FILLER                     PIC XX.
  2793             20  CF-MORTGAGE-PLAN           PIC XX.
  2794         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2795
  2796     12  CF-LAST-MAINT-DT                   PIC XX.
  2797     12  CF-LAST-MAINT-BY                   PIC X(4).
  2798     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2799
  2800     12  CF-RECORD-BODY                     PIC X(728).
  2801
  2802
  2803****************************************************************
  2804*             COMPANY MASTER RECORD                            *
  2805****************************************************************
  2806
  2807     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2808         16  CF-COMPANY-ADDRESS.
  2809             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2810             20  CF-CL-IN-CARE-OF           PIC X(30).
  2811             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2812             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2813             20  CF-CL-CITY-STATE           PIC X(30).
  2814             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2815             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2816         16  CF-COMPANY-CD                  PIC X.
  2817         16  CF-COMPANY-PASSWORD            PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  60
* EL650.cbl
  2818         16  CF-SECURITY-OPTION             PIC X.
  2819             88  ALL-SECURITY                   VALUE '1'.
  2820             88  COMPANY-VERIFY                 VALUE '2'.
  2821             88  PROCESSOR-VERIFY               VALUE '3'.
  2822             88  NO-SECURITY                    VALUE '4'.
  2823             88  ALL-BUT-TERM                   VALUE '5'.
  2824         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2825             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2826         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2827             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2828         16  CF-INFORCE-LOCATION            PIC X.
  2829             88  CERTS-ARE-ONLINE               VALUE '1'.
  2830             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2831             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2832         16  CF-LOWER-CASE-LETTERS          PIC X.
  2833         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2834             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2835             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2836             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2837             88  CF-ACCNT-CNTL                  VALUE '3'.
  2838             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2839
  2840         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2841         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2842
  2843         16  CF-LGX-CREDIT-USER             PIC X.
  2844             88  CO-IS-NOT-USER                 VALUE 'N'.
  2845             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2846
  2847         16 CF-CREDIT-CALC-CODES.
  2848             20  CF-CR-REM-TERM-CALC PIC X.
  2849               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2850               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2851               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2852               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2853               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2854               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2855               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2856             20  CF-CR-R78-METHOD           PIC X.
  2857               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2858               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2859
  2860         16  CF-CLAIM-CONTROL-COUNTS.
  2861             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2862                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2863
  2864             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2865                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2866
  2867             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2868                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2869
  2870             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2871                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2872
  2873         16  CF-CURRENT-MONTH-END           PIC XX.
  2874
  2875         16  CF-CO-CALC-QUOTE-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  61
* EL650.cbl
  2876             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2877             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2878             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2879             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2880                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2881                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2882             20  CF-CO-PREM-REJECT-SW       PIC X.
  2883                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2884                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2885             20  CF-CO-REF-REJECT-SW        PIC X.
  2886                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2887                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2888
  2889         16  CF-CO-REPORTING-DT             PIC XX.
  2890         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2891         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2892           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2893           88  CF-CO-MONTH-END                  VALUE '1'.
  2894
  2895         16  CF-LGX-CLAIM-USER              PIC X.
  2896             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2897             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2898
  2899         16  CF-CREDIT-EDIT-CONTROLS.
  2900             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2901             20  CF-MIN-AGE                 PIC 99.
  2902             20  CF-DEFAULT-AGE             PIC 99.
  2903             20  CF-MIN-TERM                PIC S999      COMP-3.
  2904             20  CF-MAX-TERM                PIC S999      COMP-3.
  2905             20  CF-DEFAULT-SEX             PIC X.
  2906             20  CF-JOINT-AGE-INPUT         PIC X.
  2907                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2908             20  CF-BIRTH-DATE-INPUT        PIC X.
  2909                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2910             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2911                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2912                 88  CF-ZERO-CARRIER            VALUE '1'.
  2913                 88  CF-ZERO-GROUPING           VALUE '2'.
  2914                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2915             20  CF-EDIT-SW                 PIC X.
  2916                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2917             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2918             20  CF-CR-PR-METHOD            PIC X.
  2919               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2920               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2921             20  FILLER                     PIC X.
  2922
  2923         16  CF-CREDIT-MISC-CONTROLS.
  2924             20  CF-REIN-TABLE-SW           PIC X.
  2925                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2926             20  CF-COMP-TABLE-SW           PIC X.
  2927                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2928             20  CF-EXPERIENCE-RETENTION-AGE
  2929                                            PIC S9        COMP-3.
  2930             20  CF-CONVERSION-DT           PIC XX.
  2931             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2932             20  CF-RUN-FREQUENCY-SW        PIC X.
  2933                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  62
* EL650.cbl
  2934                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2935
  2936             20  CF-CR-CHECK-NO-CONTROL.
  2937                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2938                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2939                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2940                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2941                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2942                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2943
  2944                 24  CF-CR-CHECK-COUNT       REDEFINES
  2945                     CF-CR-CHECK-COUNTER      PIC X(4).
  2946
  2947                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2948                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2949
  2950                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2951                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2952                 24  CF-MAIL-PROCESSING       PIC X.
  2953                     88  MAIL-PROCESSING          VALUE 'Y'.
  2954
  2955         16  CF-MISC-SYSTEM-CONTROL.
  2956             20  CF-SYSTEM-C                 PIC X.
  2957                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2958             20  CF-SYSTEM-D                 PIC X.
  2959                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2960             20  CF-SOC-SEC-NO-SW            PIC X.
  2961                 88  SOC-SEC-NO-USED             VALUE '1'.
  2962             20  CF-MEMBER-NO-SW             PIC X.
  2963                 88  MEMBER-NO-USED              VALUE '1'.
  2964             20  CF-TAX-ID-NUMBER            PIC X(11).
  2965             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2966             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2967                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2968                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2969                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2970                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2971             20  CF-SYSTEM-E                 PIC X.
  2972                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2973
  2974         16  CF-LGX-LIFE-USER               PIC X.
  2975             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2976             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2977
  2978         16  CF-CR-MONTH-END-DT             PIC XX.
  2979
  2980         16  CF-FILE-MAINT-DATES.
  2981             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2982                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2983             20  CF-LAST-BATCH       REDEFINES
  2984                 CF-LAST-BATCH-NO               PIC X(4).
  2985             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2986             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2987             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2988             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2989             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2990             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2991             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  63
* EL650.cbl
  2992             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2993             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2994             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2995
  2996         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2997         16  FILLER                         PIC X.
  2998
  2999         16  CF-ALT-MORT-CODE               PIC X(4).
  3000         16  CF-MEMBER-CAPTION              PIC X(10).
  3001
  3002         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3003             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3004             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3005             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3006             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3007             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3008
  3009         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3010
  3011         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3012         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3013         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3014         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3015
  3016         16  CF-AH-OVERRIDE-L1              PIC X.
  3017         16  CF-AH-OVERRIDE-L2              PIC XX.
  3018         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3019         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3020
  3021         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3022         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3023
  3024         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3025         16  CF-AR-LAST-EL860-DT            PIC XX.
  3026         16  CF-MP-MONTH-END-DT             PIC XX.
  3027
  3028         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3029         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3030             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3031
  3032         16  CF-AR-MONTH-END-DT             PIC XX.
  3033
  3034         16  CF-CRDTCRD-USER                PIC X.
  3035             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3036             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3037
  3038         16  CF-CC-MONTH-END-DT             PIC XX.
  3039
  3040         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3041
  3042         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3043             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3044             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3045             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3046         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3047         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3048         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3049         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  64
* EL650.cbl
  3050             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3051             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3052         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3053         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3054         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3055             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3056         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3057
  3058         16  CF-CL-ZIP-CODE.
  3059             20  CF-CL-ZIP-PRIME.
  3060                 24  CF-CL-ZIP-1ST          PIC X.
  3061                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3062                 24  FILLER                 PIC X(4).
  3063             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3064         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3065             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3066             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3067             20  FILLER                     PIC XXX.
  3068
  3069         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3070         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3071         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3072         16  CF-CO-OPTION-START-DATE        PIC XX.
  3073         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3074           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3075                                                      '3' '4'.
  3076           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3077           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3078           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3079           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3080           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3081           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3082
  3083         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3084
  3085         16  CF-PAYMENT-APPROVAL-LEVELS.
  3086             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3087             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3088             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3089             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3090             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3091             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3092
  3093         16  CF-END-USER-REPORTING-USER     PIC X.
  3094             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3095             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3096
  3097         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3098             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3099             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3100
  3101         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3102
  3103         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3104         16  FILLER                         PIC X.
  3105
  3106         16  CF-CREDIT-ARCHIVE-CNTL.
  3107             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  65
* EL650.cbl
  3108             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3109             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3110
  3111         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3112
  3113         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3114             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3115             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3116
  3117         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3118             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3119             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3120
  3121         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3122
  3123         16  CF-CO-ACH-ID-CODE              PIC  X.
  3124             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3125             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3126             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3127         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3128         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3129         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3130         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3131         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3132         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3133         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3134         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3135         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3136                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3137         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3138                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3139
  3140         16  CF-CO-OVER-SHORT.
  3141             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3142             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3143
  3144*         16  FILLER                         PIC X(102).
  3145         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3146             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3147             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3148
  3149         16  CF-AH-APPROVAL-DAYS.
  3150             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3151             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3152             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3153             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3154
  3155         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3156
  3157         16  CF-APPROV-LEV-5.
  3158             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3159             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3160             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3161
  3162         16  FILLER                         PIC X(68).
  3163****************************************************************
  3164*             PROCESSOR/USER RECORD                            *
  3165****************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  66
* EL650.cbl
  3166
  3167     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3168         16  CF-PROCESSOR-NAME              PIC X(30).
  3169         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3170         16  CF-PROCESSOR-TITLE             PIC X(26).
  3171         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3172                 88  MESSAGE-YES                VALUE 'Y'.
  3173                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3174
  3175*****************************************************
  3176****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3177****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3178****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3179****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3180*****************************************************
  3181
  3182         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3183             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3184             20  CF-APPLICATION-FORCE       PIC X.
  3185             20  CF-INDIVIDUAL-APP.
  3186                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3187                     28  CF-BROWSE-APP      PIC X.
  3188                     28  CF-UPDATE-APP      PIC X.
  3189
  3190         16  CF-CURRENT-TERM-ON             PIC X(4).
  3191         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3192             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3193             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3194             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3195             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3196             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3197             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3198             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3199         16  CF-PROCESSOR-CARRIER           PIC X.
  3200             88  NO-CARRIER-SECURITY            VALUE ' '.
  3201         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3202             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3203         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3204             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3205         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3206             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3207
  3208         16  CF-PROC-SYS-ACCESS-SW.
  3209             20  CF-PROC-CREDIT-CLAIMS-SW.
  3210                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3211                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3212                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3213                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3214             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3215                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3216                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3217             20  CF-PROC-LIFE-GNRLDGR-SW.
  3218                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3219                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3220                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3221                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3222             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3223                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  67
* EL650.cbl
  3224                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3225         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3226             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3227             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3228         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3229
  3230         16  CF-APPROVAL-LEVEL                  PIC X.
  3231             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3232             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3233             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3234             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3235             88  APPROVAL-LEVEL-5                   VALUE '5'.
  3236
  3237         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3238
  3239         16  CF-LANGUAGE-TYPE                   PIC X.
  3240             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3241             88  CF-LANG-IS-FR                      VALUE 'F'.
  3242
  3243         16  CF-CSR-IND                         PIC X.
  3244         16  FILLER                             PIC X(239).
  3245
  3246****************************************************************
  3247*             PROCESSOR/REMINDERS RECORD                       *
  3248****************************************************************
  3249
  3250     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3251         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3252             20  CF-START-REMIND-DT         PIC XX.
  3253             20  CF-END-REMIND-DT           PIC XX.
  3254             20  CF-REMINDER-TEXT           PIC X(50).
  3255         16  FILLER                         PIC X(296).
  3256
  3257
  3258****************************************************************
  3259*             STATE MASTER RECORD                              *
  3260****************************************************************
  3261
  3262     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3263         16  CF-STATE-ABBREVIATION          PIC XX.
  3264         16  CF-STATE-NAME                  PIC X(25).
  3265         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3266         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3267             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3268             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3269             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3270             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3271                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3272                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3273             20  CF-ST-PREM-REJECT-SW       PIC X.
  3274                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3275                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3276             20  CF-ST-REF-REJECT-SW        PIC X.
  3277                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3278                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3279         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3280         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3281         16  CF-ST-REFUND-RULES.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  68
* EL650.cbl
  3282             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3283             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3284             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3285         16  CF-ST-FST-PMT-EXTENSION.
  3286             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3287             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3288                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3289                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3290                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3291                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3292         16  CF-ST-STATE-CALL.
  3293             20  CF-ST-CALL-UNEARNED        PIC X.
  3294             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3295             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3296         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3297             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3298             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3299         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3300         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3301         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3302         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3303         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3304         16  FILLER                         PIC X.
  3305         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3306             20  CF-ST-BENEFIT-CD           PIC XX.
  3307             20  CF-ST-BENEFIT-KIND         PIC X.
  3308                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3309                 88  CF-ST-AH-KIND              VALUE 'A'.
  3310             20  CF-ST-REM-TERM-CALC        PIC X.
  3311                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3312                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3313                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3314                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3315                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3316                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3317                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3318                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3319
  3320             20  CF-ST-REFUND-CALC          PIC X.
  3321                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3322                 88  ST-REFD-BY-R78             VALUE '1'.
  3323                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3324                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3325                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3326                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3327                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3328                 88  ST-REFD-UTAH               VALUE '7'.
  3329                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3330                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3331                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3332
  3333             20  CF-ST-EARNING-CALC         PIC X.
  3334                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3335                 88  ST-EARN-BY-R78             VALUE '1'.
  3336                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3337                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3338                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3339                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  69
* EL650.cbl
  3340                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3341                 88  ST-EARN-MEAN               VALUE '8'.
  3342                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3343
  3344             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3345                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3346                 88  ST-OVRD-BY-R78             VALUE '1'.
  3347                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3348                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3349                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3350                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3351                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3352                 88  ST-OVRD-MEAN               VALUE '8'.
  3353                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3354             20  FILLER                     PIC X.
  3355
  3356         16  CF-ST-COMMISSION-CAPS.
  3357             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3358             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3359             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3360             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3361         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3362                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3363
  3364         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3365
  3366         16  CF-ST-STATUTORY-INTEREST.
  3367             20  CF-ST-STAT-DATE-FROM       PIC X.
  3368                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3369                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3370             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3371             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3372             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3373             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3374             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3375
  3376         16  CF-ST-OVER-SHORT.
  3377             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3378             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3379
  3380         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3381
  3382         16  CF-ST-RT-CALC                  PIC X.
  3383
  3384         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3385         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3386         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3387         16  CF-ST-RF-LR-CALC               PIC X.
  3388         16  CF-ST-RF-LL-CALC               PIC X.
  3389         16  CF-ST-RF-LN-CALC               PIC X.
  3390         16  CF-ST-RF-AH-CALC               PIC X.
  3391         16  CF-ST-RF-CP-CALC               PIC X.
  3392*        16  FILLER                         PIC X(206).
  3393*CIDMOD         16  FILLER                         PIC X(192).
  3394         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3395             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3396         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3397         16  CF-ST-VFY-2ND-BENE             PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  70
* EL650.cbl
  3398         16  CF-ST-CAUSAL-STATE             PIC X.
  3399         16  FILLER                         PIC X(185).
  3400
  3401****************************************************************
  3402*             BENEFIT MASTER RECORD                            *
  3403****************************************************************
  3404
  3405     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3406         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3407             20  CF-BENEFIT-CODE            PIC XX.
  3408             20  CF-BENEFIT-NUMERIC  REDEFINES
  3409                 CF-BENEFIT-CODE            PIC XX.
  3410             20  CF-BENEFIT-ALPHA           PIC XXX.
  3411             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3412             20  CF-BENEFIT-COMMENT         PIC X(10).
  3413
  3414             20  CF-LF-COVERAGE-TYPE        PIC X.
  3415                 88  CF-REDUCING                VALUE 'R'.
  3416                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3417
  3418             20  CF-SPECIAL-CALC-CD         PIC X.
  3419                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3420                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3421                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3422                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3423                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3424                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3425                 88  CF-FARM-PLAN               VALUE 'F'.
  3426                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3427                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3428                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3429                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3430                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3431                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3432                 88  CF-PRUDENTIAL              VALUE 'P'.
  3433                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3434                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3435                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3436                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3437                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3438                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3439
  3440             20  CF-JOINT-INDICATOR         PIC X.
  3441                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3442
  3443*            20  FILLER                     PIC X(12).
  3444             20  FILLER                     PIC X(11).
  3445             20  CF-BENEFIT-CATEGORY        PIC X.
  3446             20  CF-LOAN-TYPE               PIC X(8).
  3447
  3448             20  CF-CO-REM-TERM-CALC        PIC X.
  3449                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3450                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3451                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3452                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3453                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3454
  3455             20  CF-CO-EARNINGS-CALC        PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  71
* EL650.cbl
  3456                 88  CO-EARN-BY-R78             VALUE '1'.
  3457                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3458                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3459                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3460                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3461                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3462                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3463                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3464
  3465             20  CF-CO-REFUND-CALC          PIC X.
  3466                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3467                 88  CO-REFD-BY-R78             VALUE '1'.
  3468                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3469                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3470                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3471                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3472                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3473                 88  CO-REFD-MEAN               VALUE '8'.
  3474                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3475                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3476                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3477
  3478             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3479                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3480                 88  CO-OVRD-BY-R78             VALUE '1'.
  3481                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3482                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3483                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3484                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3485                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3486                 88  CO-OVRD-MEAN               VALUE '8'.
  3487                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3488
  3489             20  CF-CO-BEN-I-G-CD           PIC X.
  3490                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3491                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3492                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3493
  3494         16  FILLER                         PIC X(304).
  3495
  3496
  3497****************************************************************
  3498*             CARRIER MASTER RECORD                            *
  3499****************************************************************
  3500
  3501     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3502         16  CF-ADDRESS-DATA.
  3503             20  CF-MAIL-TO-NAME            PIC X(30).
  3504             20  CF-IN-CARE-OF              PIC X(30).
  3505             20  CF-ADDRESS-LINE-1          PIC X(30).
  3506             20  CF-ADDRESS-LINE-2          PIC X(30).
  3507             20  CF-CITY-STATE              PIC X(30).
  3508             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3509             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3510
  3511         16  CF-CLAIM-NO-CONTROL.
  3512             20  CF-CLAIM-NO-METHOD         PIC X.
  3513                 88  CLAIM-NO-MANUAL            VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  72
* EL650.cbl
  3514                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3515                 88  CLAIM-NO-SEQ               VALUE '3'.
  3516                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3517             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3518                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3519                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3520                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3521
  3522         16  CF-CHECK-NO-CONTROL.
  3523             20  CF-CHECK-NO-METHOD         PIC X.
  3524                 88  CHECK-NO-MANUAL            VALUE '1'.
  3525                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3526                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3527                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3528             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3529                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3530
  3531         16  CF-DOMICILE-STATE              PIC XX.
  3532
  3533         16  CF-EXPENSE-CONTROLS.
  3534             20  CF-EXPENSE-METHOD          PIC X.
  3535                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3536                 88  DOLLARS-PER-PMT            VALUE '2'.
  3537                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3538                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3539             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3540             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3541
  3542         16  CF-CORRESPONDENCE-CONTROL.
  3543             20  CF-LETTER-RESEND-OPT       PIC X.
  3544                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3545                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3546             20  FILLER                     PIC X(4).
  3547
  3548         16  CF-RESERVE-CONTROLS.
  3549             20  CF-MANUAL-SW               PIC X.
  3550                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3551             20  CF-FUTURE-SW               PIC X.
  3552                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3553             20  CF-PTC-SW                  PIC X.
  3554                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3555             20  CF-IBNR-SW                 PIC X.
  3556                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3557             20  CF-PTC-LF-SW               PIC X.
  3558                 88  CF-LF-PTC-USED             VALUE '1'.
  3559             20  CF-CDT-ACCESS-METHOD       PIC X.
  3560                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3561                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3562                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3563             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3564
  3565         16  CF-CLAIM-CALC-METHOD           PIC X.
  3566             88  360-PLUS-MONTHS                VALUE '1'.
  3567             88  365-PLUS-MONTHS                VALUE '2'.
  3568             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3569             88  360-DAILY                      VALUE '4'.
  3570             88  365-DAILY                      VALUE '5'.
  3571
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  73
* EL650.cbl
  3572         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3573         16  FILLER                         PIC X(11).
  3574
  3575         16  CF-LIMIT-AMOUNTS.
  3576             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3577             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3578             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3579             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3580             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3581             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3582             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3583             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3584             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3585             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3586
  3587         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3588         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3589         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3590
  3591         16  CF-ZIP-CODE.
  3592             20  CF-ZIP-PRIME.
  3593                 24  CF-ZIP-1ST             PIC X.
  3594                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3595                 24  FILLER                 PIC X(4).
  3596             20  CF-ZIP-PLUS4               PIC X(4).
  3597         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3598             20  CF-CAN-POSTAL-1            PIC XXX.
  3599             20  CF-CAN-POSTAL-2            PIC XXX.
  3600             20  FILLER                     PIC XXX.
  3601
  3602         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3603         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3604         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3605
  3606         16  CF-RATING-SWITCH               PIC X.
  3607             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3608             88  CF-NO-RATING                   VALUE 'N'.
  3609
  3610         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3611
  3612         16  CF-CARRIER-OVER-SHORT.
  3613             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3614             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3615
  3616         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3617         16  CF-SECPAY-SWITCH               PIC X.
  3618             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3619             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3620         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3621         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3622         16  FILLER                         PIC X(444).
  3623*        16  FILLER                         PIC X(452).
  3624
  3625
  3626****************************************************************
  3627*             MORTALITY MASTER RECORD                          *
  3628****************************************************************
  3629
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  74
* EL650.cbl
  3630     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3631         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3632                                INDEXED BY CF-MORT-NDX.
  3633             20  CF-MORT-TABLE              PIC X(5).
  3634             20  CF-MORT-TABLE-TYPE         PIC X.
  3635                 88  CF-MORT-JOINT              VALUE 'J'.
  3636                 88  CF-MORT-SINGLE             VALUE 'S'.
  3637                 88  CF-MORT-COMBINED           VALUE 'C'.
  3638                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3639                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3640             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3641             20  CF-MORT-AGE-METHOD         PIC XX.
  3642                 88  CF-AGE-LAST                VALUE 'AL'.
  3643                 88  CF-AGE-NEAR                VALUE 'AN'.
  3644             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3645             20  CF-MORT-ADJUSTMENT-DIRECTION
  3646                                            PIC X.
  3647                 88  CF-MINUS                   VALUE '-'.
  3648                 88  CF-PLUS                    VALUE '+'.
  3649             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3650             20  CF-MORT-JOINT-CODE         PIC X.
  3651                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3652             20  CF-MORT-PC-Q               PIC X.
  3653                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3654             20  CF-MORT-TABLE-CODE         PIC X(4).
  3655             20  CF-MORT-COMMENTS           PIC X(15).
  3656             20  FILLER                     PIC X(14).
  3657
  3658         16  FILLER                         PIC X(251).
  3659
  3660
  3661****************************************************************
  3662*             BUSSINESS TYPE MASTER RECORD                     *
  3663****************************************************************
  3664
  3665     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3666* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3667* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3668* AND RECORD 05 IS TYPES 81-99
  3669         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3670             20  CF-BUSINESS-TITLE          PIC  X(19).
  3671             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3672                                            PIC S9V9(4) COMP-3.
  3673             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3674             20  FILLER                     PIC  X.
  3675         16  FILLER                         PIC  X(248).
  3676
  3677
  3678****************************************************************
  3679*             TERMINAL MASTER RECORD                           *
  3680****************************************************************
  3681
  3682     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3683
  3684         16  CF-COMPANY-TERMINALS.
  3685             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3686                                  PIC X(4).
  3687         16  FILLER               PIC X(248).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  75
* EL650.cbl
  3688
  3689
  3690****************************************************************
  3691*             LIFE EDIT MASTER RECORD                          *
  3692****************************************************************
  3693
  3694     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3695         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3696             20  CF-LIFE-CODE-IN            PIC XX.
  3697             20  CF-LIFE-CODE-OUT           PIC XX.
  3698         16  FILLER                         PIC X(248).
  3699
  3700
  3701****************************************************************
  3702*             AH EDIT MASTER RECORD                            *
  3703****************************************************************
  3704
  3705     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3706         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3707             20  CF-AH-CODE-IN              PIC XXX.
  3708             20  CF-AH-CODE-OUT             PIC XX.
  3709         16  FILLER                         PIC X(248).
  3710
  3711
  3712****************************************************************
  3713*             CREDIBILITY TABLES                               *
  3714****************************************************************
  3715
  3716     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3717         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3718                             INDEXED BY CF-CRDB-NDX.
  3719             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3720             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3721             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3722         16  FILLER                         PIC  X(332).
  3723
  3724
  3725****************************************************************
  3726*             REPORT CUSTOMIZATION RECORD                      *
  3727****************************************************************
  3728
  3729     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3730         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3731             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3732             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3733             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3734**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3735****       A T-TRANSFER.                                   ****
  3736             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3737
  3738         16  FILLER                         PIC XX.
  3739
  3740         16  CF-CARRIER-CNTL-OPT.
  3741             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3742                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3743                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3744             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3745                                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  76
* EL650.cbl
  3746         16  CF-GROUP-CNTL-OPT.
  3747             20  CF-GROUP-OPT-SEQ           PIC 9.
  3748                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3749                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3750             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3751                                            PIC X(6).
  3752         16  CF-STATE-CNTL-OPT.
  3753             20  CF-STATE-OPT-SEQ           PIC 9.
  3754                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3755                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3756             20  CF-STATE-SELECT OCCURS 3 TIMES
  3757                                            PIC XX.
  3758         16  CF-ACCOUNT-CNTL-OPT.
  3759             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3760                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3761                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3762             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3763                                            PIC X(10).
  3764         16  CF-BUS-TYP-CNTL-OPT.
  3765             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3766                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3767                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3768             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3769                                            PIC XX.
  3770         16  CF-LF-TYP-CNTL-OPT.
  3771             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3772                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3773                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3774             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3775                                            PIC XX.
  3776         16  CF-AH-TYP-CNTL-OPT.
  3777             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3778                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3779                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3780             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3781                                            PIC XX.
  3782         16  CF-REPTCD1-CNTL-OPT.
  3783             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3784                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3785                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3786             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3787                                            PIC X(10).
  3788         16  CF-REPTCD2-CNTL-OPT.
  3789             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3790                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3791                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3792             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3793                                            PIC X(10).
  3794         16  CF-USER1-CNTL-OPT.
  3795             20  CF-USER1-OPT-SEQ           PIC 9.
  3796                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3797                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3798             20  CF-USER1-SELECT OCCURS 3 TIMES
  3799                                            PIC X(10).
  3800         16  CF-USER2-CNTL-OPT.
  3801             20  CF-USER2-OPT-SEQ           PIC 9.
  3802                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3803                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  77
* EL650.cbl
  3804             20  CF-USER2-SELECT OCCURS 3 TIMES
  3805                                            PIC X(10).
  3806         16  CF-USER3-CNTL-OPT.
  3807             20  CF-USER3-OPT-SEQ           PIC 9.
  3808                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3809                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3810             20  CF-USER3-SELECT OCCURS 3 TIMES
  3811                                            PIC X(10).
  3812         16  CF-USER4-CNTL-OPT.
  3813             20  CF-USER4-OPT-SEQ           PIC 9.
  3814                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3815                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3816             20  CF-USER4-SELECT OCCURS 3 TIMES
  3817                                            PIC X(10).
  3818         16  CF-USER5-CNTL-OPT.
  3819             20  CF-USER5-OPT-SEQ           PIC 9.
  3820                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3821                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3822             20  CF-USER5-SELECT OCCURS 3 TIMES
  3823                                            PIC X(10).
  3824         16  CF-REINS-CNTL-OPT.
  3825             20  CF-REINS-OPT-SEQ           PIC 9.
  3826                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3827                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3828             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3829                 24  CF-REINS-PRIME         PIC XXX.
  3830                 24  CF-REINS-SUB           PIC XXX.
  3831
  3832         16  CF-AGENT-CNTL-OPT.
  3833             20  CF-AGENT-OPT-SEQ           PIC 9.
  3834                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3835                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3836             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3837                                            PIC X(10).
  3838
  3839         16  FILLER                         PIC X(43).
  3840
  3841         16  CF-LOSS-RATIO-SELECT.
  3842             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3843             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3844         16  CF-ENTRY-DATE-SELECT.
  3845             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3846             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3847         16  CF-EFFECTIVE-DATE-SELECT.
  3848             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3849             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3850
  3851         16  CF-EXCEPTION-LIST-IND          PIC X.
  3852             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3853
  3854         16  FILLER                         PIC X(318).
  3855
  3856****************************************************************
  3857*                  EXCEPTION REPORTING RECORD                  *
  3858****************************************************************
  3859
  3860     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3861         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  78
* EL650.cbl
  3862             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3863
  3864         16  CF-COMBINED-LIFE-AH-OPT.
  3865             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3866             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3867             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3868             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3869
  3870         16  CF-LIFE-OPT.
  3871             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3872             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3873             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3874             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3875             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3876             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3877             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3878             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3879             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3880             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3881
  3882         16  CF-AH-OPT.
  3883             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3884             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3885             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3886             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3887             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3888             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3889             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3890             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3891             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3892             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3893
  3894         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3895             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3896             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3897             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3898
  3899         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3900
  3901         16  FILLER                         PIC X(673).
  3902
  3903
  3904****************************************************************
  3905*             MORTGAGE SYSTEM PLAN RECORD                      *
  3906****************************************************************
  3907
  3908     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3909         16  CF-PLAN-TYPE                   PIC X.
  3910             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3911             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3912             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3913         16  CF-PLAN-ABBREV                 PIC XXX.
  3914         16  CF-PLAN-DESCRIPT               PIC X(10).
  3915         16  CF-PLAN-NOTES                  PIC X(20).
  3916         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3917         16  CF-PLAN-UNDERWRITING.
  3918             20  CF-PLAN-TERM-DATA.
  3919                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  79
* EL650.cbl
  3920                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3921             20  CF-PLAN-AGE-DATA.
  3922                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3923                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3924                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3925             20  CF-PLAN-BENEFIT-DATA.
  3926                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3927                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3928                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3929                                            PIC S9(7)V99  COMP-3.
  3930         16  CF-PLAN-POLICY-FORMS.
  3931             20  CF-POLICY-FORM             PIC X(12).
  3932             20  CF-MASTER-APPLICATION      PIC X(12).
  3933             20  CF-MASTER-POLICY           PIC X(12).
  3934         16  CF-PLAN-RATING.
  3935             20  CF-RATE-CODE               PIC X(5).
  3936             20  CF-SEX-RATING              PIC X.
  3937                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3938                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3939             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3940             20  CF-SUB-STD-TYPE            PIC X.
  3941                 88  CF-PCT-OF-PREM            VALUE '1'.
  3942                 88  CF-PCT-OF-BENE            VALUE '2'.
  3943         16  CF-PLAN-PREM-TOLERANCES.
  3944             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3945             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3946         16  CF-PLAN-PYMT-TOLERANCES.
  3947             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3948             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3949         16  CF-PLAN-MISC-DATA.
  3950             20  FILLER                     PIC X.
  3951             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3952             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3953         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3954         16  CF-PLAN-IND-GRP                PIC X.
  3955             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3956                                                     '1'.
  3957             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3958                                                     '2'.
  3959         16  CF-MIB-SEARCH-SW               PIC X.
  3960             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3961             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3962             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3963             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3964         16  CF-ALPHA-SEARCH-SW             PIC X.
  3965             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3966             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3967             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3968             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3969             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3970             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3971             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3972             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3973             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3974             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3975                                                     'A' 'B' 'C'
  3976                                                     'X' 'Y' 'Z'.
  3977         16  CF-EFF-DT-RULE-SW              PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  80
* EL650.cbl
  3978             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3979             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3980             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3981             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3982             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3983         16  FILLER                         PIC X(4).
  3984         16  CF-HEALTH-QUESTIONS            PIC X.
  3985             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3986         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3987         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3988         16  CF-PLAN-SNGL-JNT               PIC X.
  3989             88  CF-COMBINED-PLAN              VALUE 'C'.
  3990             88  CF-JNT-PLAN                   VALUE 'J'.
  3991             88  CF-SNGL-PLAN                  VALUE 'S'.
  3992         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3993         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3994         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3995         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3996         16  CF-RERATE-CNTL                 PIC  X.
  3997             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3998             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3999             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4000             88  CF-AUTO-RECALC                 VALUE '4'.
  4001         16  CF-BENEFIT-TYPE                PIC  X.
  4002             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4003             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4004         16  CF-POLICY-FEE                  PIC S999V99
  4005                                                    COMP-3.
  4006         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4007         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4008         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4009         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4010         16  FILLER                         PIC  X(32).
  4011         16  CF-TERMINATION-FORM            PIC  X(04).
  4012         16  FILLER                         PIC  X(08).
  4013         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4014                                                       COMP-3.
  4015         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4016         16  CF-ISSUE-LETTER                PIC  X(4).
  4017         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4018         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4019             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4020             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4021         16  CF-MP-REFUND-CALC              PIC X.
  4022             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4023             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4024             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4025             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4026             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4027             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4028             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4029             88  CF-MP-REFD-MEAN                VALUE '8'.
  4030         16  CF-ALT-RATE-CODE               PIC  X(5).
  4031
  4032
  4033         16  FILLER                         PIC X(498).
  4034****************************************************************
  4035*             MORTGAGE COMPANY MASTER RECORD                   *
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  81
* EL650.cbl
  4036****************************************************************
  4037
  4038     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4039         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4040         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4041             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4042             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4043             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4044             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4045             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4046
  4047         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4048         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4049         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4050         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4051         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4052
  4053         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4054             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4055         16  CF-MP-RECON-USE-IND            PIC X(1).
  4056             88  CF-MP-USE-RECON             VALUE 'Y'.
  4057         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4058             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4059         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4060             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4061             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4062         16  FILLER                         PIC X(1).
  4063         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4064             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4065         16  CF-MORTG-MIB-VERSION           PIC X.
  4066             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4067             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4068             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4069         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4070             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4071                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4072             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4073                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4074             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4075                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4076             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4077                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4078             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4079                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4080             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4081                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4082         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4083         16  FILLER                         PIC X(7).
  4084         16  CF-MORTG-DESTINATION-SYMBOL.
  4085             20  CF-MORTG-MIB-COMM          PIC X(5).
  4086             20  CF-MORTG-MIB-TERM          PIC X(5).
  4087         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4088             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4089         16  FILLER                         PIC X(03).
  4090         16  CF-MP-CHECK-NO-CONTROL.
  4091             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4092                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4093                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  82
* EL650.cbl
  4094                                                ' ' LOW-VALUES.
  4095                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4096                                               VALUE '3'.
  4097         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4098         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4099         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4100             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4101                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4102             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4103                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4104             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4105                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4106             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4107                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4108             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4109                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4110             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4111                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4112         16  CF-MORTG-BILLING-AREA.
  4113             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4114                                            PIC X.
  4115         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4116         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4117         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4118         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4119             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4120             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4121         16  FILLER                         PIC X.
  4122         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4123             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4124             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4125         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4126         16  FILLER                         PIC X(8).
  4127         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4128         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4129         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4130         16  CF-ACH-COMPANY-ID.
  4131             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4132                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4133                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4134                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4135             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4136         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4137             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4138         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4139             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4140             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4141         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4142         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4143         16  FILLER                         PIC X(536).
  4144
  4145****************************************************************
  4146*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4147****************************************************************
  4148
  4149     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4150         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4151             20  CF-FEMALE-HEIGHT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  83
* EL650.cbl
  4152                 24  CF-FEMALE-FT           PIC 99.
  4153                 24  CF-FEMALE-IN           PIC 99.
  4154             20  CF-FEMALE-MIN-WT           PIC 999.
  4155             20  CF-FEMALE-MAX-WT           PIC 999.
  4156         16  FILLER                         PIC X(428).
  4157
  4158     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4159         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4160             20  CF-MALE-HEIGHT.
  4161                 24  CF-MALE-FT             PIC 99.
  4162                 24  CF-MALE-IN             PIC 99.
  4163             20  CF-MALE-MIN-WT             PIC 999.
  4164             20  CF-MALE-MAX-WT             PIC 999.
  4165         16  FILLER                         PIC X(428).
  4166******************************************************************
  4167*             AUTOMATIC ACTIVITY RECORD                          *
  4168******************************************************************
  4169     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4170         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4171             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4172             20  CF-SYS-LETTER-ID           PIC X(04).
  4173             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4174             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4175             20  CF-SYS-RESET-SW            PIC X(01).
  4176             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4177             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4178
  4179         16  FILLER                         PIC X(50).
  4180
  4181         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4182             20  CF-USER-ACTIVE-SW          PIC X(01).
  4183             20  CF-USER-LETTER-ID          PIC X(04).
  4184             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4185             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4186             20  CF-USER-RESET-SW           PIC X(01).
  4187             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4188             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4189             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4190
  4191         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  84
* EL650.cbl
  4193*    COPY ERCPNDB.
  4194******************************************************************
  4195*                                                                *
  4196*                                                                *
  4197*                            ERCPNDB.                            *
  4198*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4199*                            VMOD=2.025                          *
  4200*                                                                *
  4201*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4202*                                                                *
  4203******************************************************************
  4204*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4205*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4206******************************************************************
  4207*                                                                *
  4208*                                                                *
  4209*   FILE TYPE = VSAM,KSDS                                        *
  4210*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4211*                                                                *
  4212*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4213*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4214*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4215*                                                 RKP=13,LEN=36  *
  4216*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4217*                                      AND CHG-SEQ.)             *
  4218*                                                RKP=49,LEN=11   *
  4219*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4220*                                      AND CHG-SEQ.)             *
  4221*                                                RKP=60,LEN=15   *
  4222*                                                                *
  4223*   LOG = NO                                                     *
  4224*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4225******************************************************************
  4226******************************************************************
  4227*                   C H A N G E   L O G
  4228*
  4229* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4230*-----------------------------------------------------------------
  4231*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4232* EFFECTIVE    NUMBER
  4233*-----------------------------------------------------------------
  4234* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4235* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4236* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4237* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4238* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4239* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4240* 032306                   PEMA  ADD BOW LOAN NUMBER
  4241* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  4242* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4243* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4244* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4245* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4246* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4247* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4248* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4249******************************************************************
  4250
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  85
* EL650.cbl
  4251 01  PENDING-BUSINESS.
  4252     12  PB-RECORD-ID                     PIC XX.
  4253         88  VALID-PB-ID                        VALUE 'PB'.
  4254
  4255     12  PB-CONTROL-PRIMARY.
  4256         16  PB-COMPANY-CD                PIC X.
  4257         16  PB-ENTRY-BATCH               PIC X(6).
  4258         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4259         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4260
  4261     12  PB-CONTROL-BY-ACCOUNT.
  4262         16  PB-COMPANY-CD-A1             PIC X.
  4263         16  PB-CARRIER                   PIC X.
  4264         16  PB-GROUPING.
  4265             20  PB-GROUPING-PREFIX       PIC XXX.
  4266             20  PB-GROUPING-PRIME        PIC XXX.
  4267         16  PB-STATE                     PIC XX.
  4268         16  PB-ACCOUNT.
  4269             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4270             20  PB-ACCOUNT-PRIME         PIC X(6).
  4271         16  PB-CERT-EFF-DT               PIC XX.
  4272         16  PB-CERT-NO.
  4273             20  PB-CERT-PRIME            PIC X(10).
  4274             20  PB-CERT-SFX              PIC X.
  4275         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4276
  4277         16  PB-RECORD-TYPE               PIC X.
  4278             88  PB-MAILING-DATA                VALUE '0'.
  4279             88  PB-ISSUE                       VALUE '1'.
  4280             88  PB-CANCELLATION                VALUE '2'.
  4281             88  PB-BATCH-TRAILER               VALUE '9'.
  4282
  4283     12  PB-CONTROL-BY-ORIG-BATCH.
  4284         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4285         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4286         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4287         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4288
  4289     12  PB-CONTROL-BY-CSR.
  4290         16  PB-CSR-COMPANY-CD            PIC X.
  4291         16  PB-CSR-ID                    PIC X(4).
  4292         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4293         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4294         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4295******************************************************************
  4296*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4297******************************************************************
  4298
  4299     12  PB-LAST-MAINT-DT                 PIC XX.
  4300     12  PB-LAST-MAINT-BY                 PIC X(4).
  4301     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4302
  4303     12  PB-RECORD-BODY                   PIC X(375).
  4304
  4305     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4306         16  PB-CERT-ORIGIN               PIC X.
  4307             88  CLASIC-CREATED-CERT         VALUE '1'.
  4308         16  PB-I-NAME.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  86
* EL650.cbl
  4309             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4310             20  PB-I-INSURED-FIRST-NAME.
  4311                 24  PB-I-INSURED-1ST-INIT PIC X.
  4312                 24  FILLER                PIC X(9).
  4313             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4314         16  PB-I-AGE                     PIC S99   COMP-3.
  4315         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4316         16  PB-I-BIRTHDAY                PIC XX.
  4317         16  PB-I-INSURED-SEX             PIC X.
  4318             88  PB-SEX-MALE     VALUE 'M'.
  4319             88  PB-SEX-FEMALE   VALUE 'F'.
  4320
  4321         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4322         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4323         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4324         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4325         16  PB-I-SKIP-CODE               PIC X.
  4326             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4327             88  PB-SKIP-JULY              VALUE '1'.
  4328             88  PB-SKIP-AUGUST            VALUE '2'.
  4329             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4330             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4331             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4332             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4333             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4334             88  PB-SKIP-JUNE              VALUE '8'.
  4335             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4336             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4337             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4338         16  PB-I-TERM-TYPE               PIC X.
  4339             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4340             88  PB-PAID-WEEKLY            VALUE 'W'.
  4341             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4342             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4343             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4344         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4345         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4346         16  PB-I-DATA-ENTRY-SW           PIC X.
  4347             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4348             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4349             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4350             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4351         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4352         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4353*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4354         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4355         16  FILLER                       PIC X.
  4356
  4357         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4358             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4359             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4360                                                   '90' THRU '99'.
  4361         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4362                                          PIC XX.
  4363         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4364         16  PB-I-AMOUNT-FINANCED REDEFINES
  4365                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4366         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  87
* EL650.cbl
  4367         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4368                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4369         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4370         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4371         16  PB-I-CLP-AMOUNT REDEFINES
  4372                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4373         16  PB-I-LF-CALC-FLAG            PIC X.
  4374             88 PB-COMP-LF-PREM               VALUE '?'.
  4375         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4376         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4377         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4378         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4379         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4380         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4381         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4382         16  PB-I-LF-ABBR                 PIC XXX.
  4383         16  PB-I-LF-INPUT-CD             PIC XX.
  4384
  4385         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4386             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4387             88  PB-INVALID-AH               VALUE '  ' '00'
  4388                                                   '90' THRU '99'.
  4389         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4390         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4391         16  PB-I-AH-CALC-FLAG            PIC X.
  4392             88 PB-COMP-AH-PREM                  VALUE '?'.
  4393         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4394         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4395         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4396         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4397         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4398         16  PB-I-AH-ABBR                 PIC XXX.
  4399         16  PB-I-AH-INPUT-CD             PIC XXX.
  4400
  4401         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4402         16  PB-I-REIN-TABLE              PIC XXX.
  4403         16  PB-I-BUSINESS-TYPE           PIC 99.
  4404         16  PB-I-INDV-GRP-CD             PIC X.
  4405         16  PB-I-MORT-CODE.
  4406             20  PB-I-TABLE               PIC X.
  4407             20  PB-I-INTEREST            PIC XX.
  4408             20  PB-I-MORT-TYP            PIC X.
  4409         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4410         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4411         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4412         16  PB-I-INDV-GRP-OVRD           PIC X.
  4413         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4414         16  PB-I-SIG-SW                  PIC X.
  4415             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4416         16  PB-I-RATE-CLASS              PIC XX.
  4417         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4418         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4419         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4420         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4421         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4422         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4423         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4424         16  PB-I-BENEFIT-TYPE            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  88
* EL650.cbl
  4425         16  PB-I-OB-FLAG                 PIC X.
  4426             88  PB-I-OB                      VALUE 'B'.
  4427             88  PB-I-SUMMARY                 VALUE 'Z'.
  4428         16  PB-I-ENTRY-STATUS            PIC X.
  4429             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4430                                              'M' '5' '9' '2'.
  4431             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4432             88  PB-I-POLICY-PENDING          VALUE '2'.
  4433             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4434             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4435             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4436             88  PB-I-REIN-ONLY               VALUE '9'.
  4437             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4438             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4439             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4440             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4441         16  PB-I-INT-CODE                PIC X.
  4442             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4443             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4444         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4445         16  PB-I-SOC-SEC-NO              PIC X(11).
  4446         16  PB-I-MEMBER-NO               PIC X(12).
  4447         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4448*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4449         16  PB-I-OLD-LOF                 PIC XXX.
  4450         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4451         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4452         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4453         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4454         16  PB-I-LIFE-INDICATOR          PIC X.
  4455             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4456         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4457         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4458                                          PIC S9(5)V99    COMP-3.
  4459         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4460             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4461             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4462         16  PB-I-1ST-PMT-DT              PIC XX.
  4463         16  PB-I-JOINT-INSURED.
  4464             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4465             20 PB-I-JOINT-FIRST-NAME.
  4466                24  PB-I-JOINT-FIRST-INIT PIC X.
  4467                24  FILLER                PIC X(9).
  4468             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4469*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4470         16  PB-I-BENEFICIARY-NAME.
  4471             20  PB-I-BANK-NUMBER         PIC X(10).
  4472             20  FILLER                   PIC X(15).
  4473         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4474         16  PB-I-REFERENCE               PIC X(12).
  4475         16  FILLER REDEFINES PB-I-REFERENCE.
  4476             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4477             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4478             20  PB-I-CLP-STATE           PIC XX.
  4479         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4480             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4481             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4482             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  89
* EL650.cbl
  4483         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4484         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4485         16  PB-I-RESIDENT-STATE          PIC XX.
  4486         16  PB-I-RATE-CODE               PIC X(4).
  4487         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4488         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4489         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4490         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4491         16  PB-I-BANK-NOCHRGB            PIC 99.
  4492         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4493         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4494
  4495     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4496         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4497             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4498         16  PB-C-CANCEL-ORIGIN           PIC X.
  4499             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4500         16  PB-C-LF-CANCEL-DT            PIC XX.
  4501         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4502         16  PB-C-LF-CALC-REQ             PIC X.
  4503             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4504         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4505         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4506         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4507             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4508         16  PB-C-AH-CANCEL-DT            PIC XX.
  4509         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4510         16  PB-C-AH-CALC-REQ             PIC X.
  4511             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4512         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4513         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4514         16  PB-C-LAST-NAME               PIC X(15).
  4515         16  PB-C-REFUND-SW               PIC X.
  4516             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4517             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4518         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4519         16  PB-C-PAYEE-CODE              PIC X(6).
  4520         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4521         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4522         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4523         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4524         16  PB-C-REFERENCE               PIC X(12).
  4525         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4526         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4527         16  PB-C-POST-CARD-IND           PIC X.
  4528         16  PB-C-CANCEL-REASON           PIC X.
  4529         16  PB-C-REF-INTERFACE-SW        PIC X.
  4530         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4531         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4532         16  FILLER                       PIC X(01).
  4533*        16  FILLER                       PIC X(18).
  4534         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4535*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4536         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4537         16  PB-CANCELED-CERT-DATA.
  4538             20  PB-CI-INSURED-NAME.
  4539                 24  PB-CI-LAST-NAME      PIC X(15).
  4540                 24  PB-CI-INITIALS       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  90
* EL650.cbl
  4541             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4542             20  PB-CI-INSURED-SEX        PIC X.
  4543             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4544             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4545             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4546             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4547             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4548             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4549             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4550             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4551             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4552             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4553             20  PB-CI-RATE-CLASS         PIC XX.
  4554             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4555             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4556             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4557             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4558             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4559             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4560             20  PB-CI-LF-ABBR            PIC X(3).
  4561             20  PB-CI-AH-ABBR            PIC X(3).
  4562             20  PB-CI-OB-FLAG            PIC X.
  4563                 88  PB-CI-OB                VALUE 'B'.
  4564             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4565                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4566                                           'M' '4' '5' '9' '2'.
  4567                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4568                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4569                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4570                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4571                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4572                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4573                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4574                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4575                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4576                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4577                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4578                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4579             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4580                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4581                                           'M' '4' '5' '9' '2'.
  4582                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4583                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4584                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4585                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4586                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4587                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4588                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4589                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4590                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4591                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4592                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4593                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4594             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4595             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4596             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4597             20  PB-CI-MEMBER-NO          PIC X(12).
  4598             20  PB-CI-INT-CODE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  91
* EL650.cbl
  4599                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4600                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4601             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4602             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4603             20  PB-CI-COMP-EXCP-SW       PIC X.
  4604                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4605                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4606             20  PB-CI-ENTRY-STATUS       PIC X.
  4607             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4608             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4609             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4610             20  PB-CI-DEATH-DT           PIC XX.
  4611             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4612             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4613             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4614             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4615             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4616             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4617             20  PB-CI-ENTRY-DT              PIC XX.
  4618             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4619             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4620             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4621             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4622             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4623             20  PB-CI-OLD-LOF               PIC XXX.
  4624*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4625             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4626             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4627             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4628             20  PB-CI-INDV-GRP-CD           PIC X.
  4629             20  PB-CI-BENEFICIARY-NAME.
  4630                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4631                 24  FILLER                  PIC X(15).
  4632             20  PB-CI-NOTE-SW               PIC X.
  4633             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4634             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4635             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4636             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4637             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4638             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4639             20  PB-CI-FIRST-NAME            PIC X(10).
  4640             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4641
  4642         16  FILLER                       PIC X(13).
  4643*032306  16  FILLER                       PIC X(27).
  4644*        16  FILLER                       PIC X(46).
  4645
  4646     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4647         16  FILLER                       PIC X(10).
  4648         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4649         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4650         16  PB-M-INSURED-MID-INIT        PIC X.
  4651         16  PB-M-INSURED-AGE             PIC 99.
  4652         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4653         16  PB-M-INSURED-SEX             PIC X.
  4654         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4655         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4656         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  92
* EL650.cbl
  4657         16  PB-M-INSURED-CITY-STATE.
  4658             20  PB-M-INSURED-CITY        PIC X(28).
  4659             20  PB-M-INSURED-STATE       PIC XX.
  4660         16  PB-M-INSURED-ZIP-CODE.
  4661             20  PB-M-INSURED-ZIP-PRIME.
  4662                 24  PB-M-INSURED-ZIP-1   PIC X.
  4663                     88  PB-M-CANADIAN-POST-CODE
  4664                                             VALUE 'A' THRU 'Z'.
  4665                 24  FILLER               PIC X(4).
  4666             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4667         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4668                                        PB-M-INSURED-ZIP-CODE.
  4669             20  PM-M-INS-CAN-POST1       PIC XXX.
  4670             20  PM-M-INS-CAN-POST2       PIC XXX.
  4671             20  FILLER                   PIC XXX.
  4672         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4673         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4674         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4675         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4676         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4677         16  PB-M-CRED-BENE-CITYST.
  4678             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4679             20  PB-M-CRED-BENE-STATE     PIC XX.
  4680         16  FILLER                       PIC X(92).
  4681
  4682     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4683         16  FILLER                       PIC X(10).
  4684         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4685         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4686         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4687         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4688         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4689         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4690         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4691         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4692         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4693         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4694         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4695         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4696         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4697         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4698         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4699         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4700         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4701         16  PB-ACCOUNT-NAME              PIC X(30).
  4702         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4703         16  PB-REFERENCE                 PIC X(12).
  4704         16  PB-B-RECEIVED-DT             PIC XX.
  4705         16  FILLER                       PIC X(234).
  4706
  4707     12  PB-RECORD-STATUS.
  4708         16  PB-CREDIT-SELECT-DT          PIC XX.
  4709         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4710         16  PB-BILLED-DT                 PIC XX.
  4711         16  PB-BILLING-STATUS            PIC X.
  4712             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4713             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4714             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  93
* EL650.cbl
  4715         16  PB-RECORD-BILL               PIC X.
  4716             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4717             88  PB-RECORD-RETURNED           VALUE 'R'.
  4718             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4719             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4720             88  PB-OVERRIDE-AH               VALUE 'A'.
  4721             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4722         16  PB-BATCH-ENTRY               PIC X.
  4723             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4724             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4725             88  PB-REISSUED-CERT             VALUE 'E'.
  4726             88  PB-MONTHLY-CERT              VALUE 'M'.
  4727             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4728             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4729             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4730         16  PB-FORCE-CODE                PIC X.
  4731             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4732             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4733             88  PB-CANCEL-FORCE              VALUE '8'.
  4734             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4735             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4736             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4737             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4738             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4739             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4740             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4741         16  PB-FATAL-FLAG                PIC X.
  4742             88  PB-FATAL-ERRORS              VALUE 'X'.
  4743         16  PB-FORCE-ER-CD               PIC X.
  4744             88  PB-FORCE-ERRORS              VALUE 'F'.
  4745             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4746         16  PB-WARN-ER-CD                PIC X.
  4747             88  PB-WARNING-ERRORS            VALUE 'W'.
  4748         16  FILLER                       PIC X.
  4749         16  PB-OUT-BAL-CD                PIC X.
  4750             88  PB-OUT-OF-BAL                VALUE 'O'.
  4751         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4752         16  PB-AH-OVERRIDE-L1            PIC X.
  4753         16  PB-INPUT-DT                  PIC XX.
  4754         16  PB-INPUT-BY                  PIC X(4).
  4755         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4756         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4757         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4758         16  PB-LF-EARNING-METHOD         PIC X.
  4759         16  PB-AH-EARNING-METHOD         PIC X.
  4760         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4761         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4762         16  PB-REIN-CD                   PIC XXX.
  4763         16  PB-LF-REFUND-TYPE            PIC X.
  4764         16  PB-AH-REFUND-TYPE            PIC X.
  4765         16  PB-ACCT-EFF-DT               PIC XX.
  4766         16  PB-ACCT-EXP-DT               PIC XX.
  4767         16  PB-COMPANY-ID                PIC X(3).
  4768         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4769         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4770         16  PB-SV-CARRIER                PIC X.
  4771         16  PB-SV-GROUPING               PIC X(6).
  4772         16  PB-SV-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  94
* EL650.cbl
  4773         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4774         16  PB-GA-BILLING-INFO.
  4775             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4776                                          PIC XX.
  4777         16  PB-SV-REMIT-TO  REDEFINES
  4778             PB-GA-BILLING-INFO           PIC X(10).
  4779         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4780         16  PB-I-LOAN-OFFICER            PIC X(5).
  4781         16  PB-I-VIN                     PIC X(17).
  4782
  4783         16  FILLER                       PIC X(04).
  4784         16  IMNET-BYPASS-SW              PIC X.
  4785
  4786******************************************************************
  4787*                COMMON EDIT ERRORS                              *
  4788******************************************************************
  4789
  4790     12  PB-COMMON-ERRORS.
  4791         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4792                                           PIC S9(4)     COMP.
  4793
  4794******************************************************************
  4795*EJECT
  4796*    COPY ERCGXRF.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  95
* EL650.cbl
  4798 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA ACCOUNT-MASTER
  4799                          COMPENSATION-MASTER
  4800                          NAME-LOOKUP-MASTER PLAN-MASTER
  4801                          CONTROL-FILE PENDING-BUSINESS.
  4802 0000-DFHEXIT SECTION.
  4803     MOVE '9#                    $   ' TO DFHEIV0.
  4804     MOVE 'EL650' TO DFHEIV1.
  4805     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  4806
  4807     MOVE LOW-VALUES             TO  WS-VERIFY-AREA.
  4808     INITIALIZE  TEMP-STORAGE-RECORD.
  4809
  4810     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  4811     MOVE '5'                    TO  DC-OPTION-CODE.
  4812
  4813     PERFORM 9700-DATE-CONVERSION.
  4814
  4815     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  4816     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  4817     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  4818     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  4819*    display ' beginning of program el650   '
  4820
  4821     IF EIBCALEN  =  0
  4822         GO TO 8800-UNAUTHORIZED-ACCESS.
  4823
  4824     MOVE SCREEN-NUMBER          TO  TS-SCREEN.
  4825     MOVE EIBTRMID               TO  TS-TERM.
  4826     MOVE LOW-VALUES             TO  EL650AI.
  4827
  4828     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  4829         MOVE PI-CALLING-PROGRAM        TO  RETURNED-FROM.
  4830
  4831     IF PI-CALLING-PROGRAM  NOT = THIS-PGM
  4832         IF PI-RETURN-TO-PROGRAM  NOT = THIS-PGM
  4833             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  4834             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  4835             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  4836             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  4837             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  4838             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  4839             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  4840             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  4841             MOVE LOW-VALUES            TO  PI-PROGRAM-WORK-AREA
  4842             MOVE ZEROS                 TO  PI-TOTAL-LINES
  4843                                            PI-LINE-SELECTED
  4844             MOVE SPACE                 TO  PI-RECORD-ADDED-SW
  4845             MOVE 1                     TO  PI-PAGE-NUMBER
  4846         ELSE
  4847             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  4848             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  4849             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  4850             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  4851             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  4852             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  4853             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  4854             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  4855
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  96
* EL650.cbl
  4856**************************************************************
  4857*               CLIENT "DMD" CUSTOM CODE
  4858* CHECK IF CONTROL PASSED FROM EL608 PROGRAM
  4859* START BROWSE BEGINNING WITH KEY PASSED BY EL608
  4860*              CSO CR# 6475
  4861     IF EIBTRNID  =  EL608-TRANS-ID
  4862         MOVE 1                     TO RETURN-FROM-SW
  4863         MOVE 'Y'                   TO FROM-EL608-SW
  4864         MOVE TRANS-ID              TO EIBTRNID
  4865         MOVE XCTL-EL601            TO PI-RETURN-TO-PROGRAM
  4866         MOVE PI-PREV-VG-ACCOUNT    TO PI-ACCT-CCGSA-KEY
  4867                                       KEY-SAVE
  4868         MOVE LOW-VALUES            TO PI-ACCT-EXP-DT
  4869                                       PI-ACCT-REST-OF-EXP
  4870                                       PI-DATE-RANGE-TABLE
  4871
  4872* EXEC CICS  HANDLE CONDITION
  4873*            NOTFND   (5340-END)
  4874*            ENDFILE  (5330-NOT-FOUND)
  4875*        END-EXEC
  4876*    MOVE '"$I''                  ! " #00004867' TO DFHEIV0
  4877     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  4878     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4879     MOVE X'2220233030303034383637' TO DFHEIV0(25:11)
  4880     CALL 'kxdfhei1' USING DFHEIV0
  4881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4882         MOVE 'Y'                   TO FIRST-TIME-SW
  4883         MOVE ZEROS                 TO PI-TOTAL-LINES
  4884         SET T-INDEX
  4885             TS-INDEX  TO  +1
  4886         MOVE ACCT-FILE-ID          TO PI-ACCT-ID
  4887         MOVE 1                     TO PI-PAGE-NUMBER
  4888         MOVE 'S'                   TO PI-MAINT
  4889         MOVE DFHPF1                TO EIBAID
  4890         GO TO 1002-SHOW-NEW-RECORDS.
  4891*    END OF CLIENT "DMD" CUSTOM CODE
  4892**************************************************************
  4893
  4894     IF RETURNED-FROM = XCTL-6501 OR XCTL-6502 OR XCTL-6503 OR
  4895                        XCTL-6504 OR XCTL-6505 OR XCTL-6506 OR
  4896                        XCTL-6508
  4897         MOVE 1                     TO  RETURN-FROM-SW
  4898         MOVE PI-PREV-VG-ACCOUNT    TO  PI-ACCT-CCGSA-KEY
  4899         MOVE PI-ACCT-CCGSA-KEY     TO  KEY-SAVE
  4900         MOVE LOW-VALUES            TO  PI-ACCT-EXP-DT
  4901         GO TO 1002-SHOW-NEW-RECORDS.
  4902
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  97
* EL650.cbl
  4904     IF EIBTRNID  NOT =  TRANS-ID
  4905         IF EIBTRNID  NOT = EL640-TRANS-ID  AND
  4906            EIBTRNID  NOT = EL658-TRANS-ID  AND
  4907            EIBTRNID  NOT = EL6311-TRANS-ID AND
  4908            EIBTRNID  NOT = EL1273-TRANS-ID AND
  4909            EIBTRNID  NOT = EL652-TRANS-ID  AND
  4910            EIBTRNID  NOT = EL6523-TRANS-ID AND
  4911            EIBTRNID  NOT = EL6311NC-TRANS-ID AND
  4912            EIBTRNID  NOT = EL130-TRANS-ID  AND
  4913            EIBTRNID  NOT = EL6592-TRANS-ID AND
  4914            EIBTRNID  NOT = EL6509-TRANS-ID
  4915            AND EIBTRNID NOT = EL6503-TRANS-ID
  4916             GO TO 8100-SEND-INITIAL-MAP
  4917         ELSE
  4918             IF PI-CR-CONTROL-IN-PROGRESS  = SPACES
  4919                 GO TO 8100-SEND-INITIAL-MAP
  4920             ELSE
  4921                 MOVE 'S'             TO  MAINTI
  4922                 MOVE PI-CR-CARRIER   TO  ACARIERI
  4923                 MOVE PI-CR-GROUPING  TO  AGROUPI
  4924                 MOVE PI-CR-STATE     TO  ASTATEI
  4925                 MOVE PI-CR-ACCOUNT   TO  AACCTI
  4926                 MOVE +1              TO  ACARIERL
  4927                                          MAINTL
  4928                 MOVE +6              TO  AGROUPL
  4929                 MOVE +2              TO  ASTATEL
  4930                 MOVE +10             TO  AACCTL
  4931                 GO TO 0330-EDIT-DATA.
  4932
  4933
  4934* EXEC CICS  HANDLE CONDITION
  4935*        PGMIDERR  (9600-PGMID-ERROR)
  4936*        ERROR     (9990-ABEND)
  4937*    END-EXEC.
  4938*    MOVE '"$L.                  ! # #00004922' TO DFHEIV0
  4939     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  4940     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4941     MOVE X'2320233030303034393232' TO DFHEIV0(25:11)
  4942     CALL 'kxdfhei1' USING DFHEIV0
  4943     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4944
  4945
  4946     IF EIBAID  = DFHCLEAR
  4947         GO TO 9400-CLEAR.
  4948
  4949     IF PI-PROCESSOR-ID  =  'LGXX'
  4950         GO TO 0200-RECEIVE.
  4951
  4952
  4953* EXEC CICS  READQ TS
  4954*        QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  4955*        INTO    (SECURITY-CONTROL)
  4956*        LENGTH  (SC-COMM-LENGTH)
  4957*        ITEM    (SC-ITEM)
  4958*    END-EXEC.
  4959*    MOVE '*$II   L              ''   #00004933' TO DFHEIV0
  4960     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  4961     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  98
* EL650.cbl
  4962     MOVE X'2020233030303034393333' TO DFHEIV0(25:11)
  4963     CALL 'kxdfhei1' USING DFHEIV0,
  4964           PI-SECURITY-TEMP-STORE-ID,
  4965           SECURITY-CONTROL,
  4966           SC-COMM-LENGTH,
  4967           SC-ITEM,
  4968           DFHEIV99,
  4969           DFHEIV99
  4970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4971
  4972
  4973     MOVE SC-CREDIT-DISPLAY (04)  TO  PI-DISPLAY-CAP.
  4974     MOVE SC-CREDIT-UPDATE  (04)  TO  PI-MODIFY-CAP.
  4975
  4976     IF NOT DISPLAY-CAP
  4977         MOVE 'READ'             TO  SM-READ
  4978         PERFORM 9995-SECURITY-VIOLATION  THRU  9995-EXIT
  4979         MOVE ER-0070            TO  EMI-ERROR
  4980         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4981         GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page  99
* EL650.cbl
  4983 0200-RECEIVE.
  4984     IF EIBAID  = DFHPA1  OR  DFHPA2  OR  DFHPA3
  4985         MOVE ER-0008            TO  EMI-ERROR
  4986         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4987         MOVE -1                 TO  MAINTL
  4988         GO TO 8200-SEND-DATAONLY.
  4989
  4990
  4991* EXEC CICS  RECEIVE
  4992*        MAP     (MAP-NAME)
  4993*        MAPSET  (MAPSET-NAME)
  4994*        INTO    (EL650AI)
  4995*    END-EXEC.
  4996     MOVE LENGTH OF
  4997      EL650AI
  4998       TO DFHEIV11
  4999*    MOVE '8"T I  L              ''   #00004957' TO DFHEIV0
  5000     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5001     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5002     MOVE X'2020233030303034393537' TO DFHEIV0(25:11)
  5003     CALL 'kxdfhei1' USING DFHEIV0,
  5004           MAP-NAME,
  5005           EL650AI,
  5006           DFHEIV11,
  5007           MAPSET-NAME,
  5008           DFHEIV99,
  5009           DFHEIV99
  5010     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5011
  5012
  5013     IF PFENTERL  = ZERO
  5014         GO TO 0300-CHECK-PFKEYS.
  5015
  5016     IF EIBAID  NOT = DFHENTER
  5017         MOVE ER-0004            TO  EMI-ERROR
  5018         GO TO 0320-INPUT-ERROR.
  5019
  5020     IF (PFENTERI NUMERIC)
  5021       AND  (PFENTERI GREATER ZERO AND LESS 25)
  5022         MOVE PF-VALUES (PFENTERI)  TO  EIBAID
  5023     ELSE
  5024         MOVE ER-0029               TO  EMI-ERROR
  5025         GO TO 0320-INPUT-ERROR.
  5026
  5027 0300-CHECK-PFKEYS.
  5028     IF EIBAID  = DFHPF23
  5029         GO TO 8810-PF23.
  5030
  5031     IF EIBAID  = DFHPF24
  5032         GO TO 9200-RETURN-MAIN-MENU.
  5033
  5034     IF EIBAID  = DFHPF12
  5035         GO TO 9500-PF12.
  5036
  5037     IF MAINTL  NOT = ZERO   AND
  5038        MAINTI  NOT = SPACE  AND
  5039        EIBAID  NOT = DFHENTER
  5040          MOVE ER-0050            TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 100
* EL650.cbl
  5041          GO TO 0320-INPUT-ERROR.
  5042
  5043     if (maintl not = zeros)
  5044        and (mainti not = 'D')
  5045        move spaces              to pi-el650-del-sw
  5046     end-if
  5047     IF EIBAID  = DFHPF1
  5048         GO TO 5300-FIND-NEXT-ACCOUNT.
  5049
  5050     IF EIBAID  = DFHPF2
  5051         GO TO 5400-FIND-PREV-ACCOUNT.
  5052
  5053     IF EIBAID  = DFHPF3
  5054         GO TO 5100-FIND-NEXT-RANGE.
  5055
  5056     IF EIBAID  = DFHPF4
  5057         GO TO 5200-FIND-PREV-RANGE.
  5058
  5059     IF EIBAID  = DFHPF5
  5060         GO TO 8900-PF5.
  5061
  5062     IF EIBAID  = DFHPF6
  5063        GO TO 8910-PF6
  5064     END-IF
  5065     IF EIBAID  = DFHENTER
  5066         GO TO 0330-EDIT-DATA.
  5067
  5068     MOVE ER-0029                TO  EMI-ERROR.
  5069
  5070 0320-INPUT-ERROR.
  5071     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5072
  5073     MOVE AL-UNBON               TO  PFENTERA.
  5074
  5075     IF PFENTERL  = ZERO
  5076         MOVE -1                 TO  MAINTL
  5077     ELSE
  5078         MOVE -1                 TO  PFENTERL.
  5079
  5080     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 101
* EL650.cbl
  5082 0330-EDIT-DATA.
  5083     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5084     MOVE '5'                    TO  DC-OPTION-CODE.
  5085
  5086     PERFORM 9700-DATE-CONVERSION.
  5087
  5088     MOVE DC-BIN-DATE-1          TO  BIN-CURRENT-SAVE.
  5089     MOVE DC-GREG-DATE-1-YMD     TO  CURRENT-SAVE.
  5090
  5091     IF ACARIERL GREATER ZEROS
  5092         IF PI-CARRIER-SECURITY GREATER SPACES
  5093             IF ACARIERI = PI-CARRIER-SECURITY
  5094                 NEXT SENTENCE
  5095             ELSE
  5096                 MOVE -1         TO  ACARIERL
  5097                 MOVE ER-2370    TO  EMI-ERROR
  5098                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5099                 MOVE AL-UABON   TO  ACARIERA
  5100                 GO TO 8200-SEND-DATAONLY.
  5101
  5102     IF MAINTI  = 'S'
  5103       IF LINEL = ZEROS
  5104           MOVE 1 TO PI-PAGE-NUMBER
  5105           GO TO 1000-SHOW-ACCOUNT
  5106       ELSE
  5107           GO TO 1000-SHOW-ACCOUNT.
  5108
  5109     PERFORM 6800-COMPANY-REC-READ  THRU  6899-EXIT.
  5110
  5111     IF EMI-ERROR  NOT = ZEROS
  5112         MOVE -1                 TO  MAINTL
  5113         GO TO 8200-SEND-DATAONLY.
  5114
  5115     IF NOT  MODIFY-CAP
  5116         MOVE 'UPDATE'           TO  SM-READ
  5117         PERFORM 9995-SECURITY-VIOLATION  THRU  9995-EXIT
  5118         MOVE ER-0070            TO  EMI-ERROR
  5119         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5120         MOVE AL-UANON           TO  ACARIERA  AGROUPA
  5121                                     ASTATEA   AACCTA
  5122         GO TO 8100-SEND-INITIAL-MAP.
  5123
  5124     IF MAINTI  = 'A'
  5125         GO TO 1500-ADD-ACCOUNT.
  5126
  5127     IF MAINTI  = 'C'
  5128         IF PI-SV-MAINT IS EQUAL TO 'L'
  5129            MOVE -1              TO  MAINTL
  5130            MOVE AL-UABON        TO  MAINTA
  5131            MOVE ER-0899         TO  EMI-ERROR
  5132            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5133            GO TO 8200-SEND-DATAONLY
  5134         ELSE
  5135            GO TO 2000-CHANGE-ACCOUNT.
  5136
  5137     IF MAINTI  = 'D'
  5138         GO TO 2500-DELETE-ACCOUNT.
  5139
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 102
* EL650.cbl
  5140     IF MAINTI  = 'X'
  5141         GO TO 3000-CHANGE-EXPIRATION.
  5142
  5143     IF MAINTI  = 'E'
  5144         GO TO 3500-CHANGE-EFFECTIVE.
  5145
  5146     IF MAINTI  = 'L'
  5147         MOVE 'L'             TO  PI-SV-MAINT
  5148         GO TO 4000-CHANGE-ALL.
  5149
  5150     IF MAINTI  = 'K'
  5151       IF LINEL GREATER ZERO
  5152           GO TO 4900-CREATE-NEW-ACCOUNT
  5153        ELSE
  5154           GO TO 4500-CREATE-NEW-ACCOUNT.
  5155
  5156     IF PI-COMPANY-ID  =  'LGX' OR 'MIC' OR 'MCC'
  5157         IF MAINTI  = 'T'
  5158             GO TO 4500-CREATE-NEW-ACCOUNT.
  5159
  5160     IF MAINTI  = 'N'
  5161         GO TO 5000-CREATE-NEW-RANGE.
  5162
  5163     MOVE ER-0023                TO  EMI-ERROR.
  5164
  5165     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5166
  5167     MOVE -1                     TO  MAINTL.
  5168     MOVE AL-UABON               TO  MAINTA.
  5169
  5170     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 103
* EL650.cbl
  5172 1000-SHOW-ACCOUNT.
  5173     PERFORM 6100-BUILD-KEY  THRU  6199-EXIT.
  5174
  5175     IF LINEL GREATER ZEROS   AND
  5176        PI-TOTAL-LINES  NOT =  ZEROS
  5177         NEXT SENTENCE
  5178     ELSE
  5179         GO TO 1002-SHOW-NEW-RECORDS.
  5180
  5181     PERFORM 6000-EDIT-LINE  THRU  6000-LIN-EXIT.
  5182
  5183     IF EMI-ERROR  NOT = ZEROS
  5184         GO TO 8200-SEND-DATAONLY.
  5185
  5186     SET T-INDEX                 TO  LINEI.
  5187
  5188     IF PI-2ND-PAGE
  5189         SET T-INDEX  UP  BY  8
  5190     ELSE
  5191     IF PI-3RD-PAGE
  5192         SET T-INDEX  UP  BY  16
  5193     ELSE
  5194     IF PI-LST-PAGE
  5195         SET T-INDEX  UP  BY  24.
  5196
  5197     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  5198     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  5199
  5200     IF PI-PREV-ACCOUNT  =  PI-ACCT-CCGSA-KEY
  5201         MOVE MAINTI             TO  PI-MAINT
  5202         MOVE XCTL-6501          TO  PGM-NAME
  5203         GO TO 9300-XCTL
  5204     ELSE
  5205         IF PI-PREV-VG-ACCOUNT = PI-ACCT-CCGSA-KEY
  5206             MOVE MAINTI         TO  PI-MAINT
  5207             MOVE XCTL-6501      TO  PGM-NAME
  5208             PERFORM 7400-READ-TEMP-STORAGE  THRU  7400-EXIT
  5209             SET TS-INDEX        TO  T-INDEX
  5210             MOVE TS-ACCT-KEY (TS-INDEX)
  5211                                 TO  PI-ACCT-CCGSA-KEY
  5212             GO TO 9300-XCTL.
  5213
  5214 1002-SHOW-NEW-RECORDS.
  5215
  5216* EXEC CICS  HANDLE CONDITION
  5217*         NOTFND   (1010-NOT-FOUND)
  5218*         ENDFILE  (1010-NOT-FOUND)
  5219*    END-EXEC.
  5220*    MOVE '"$I''                  ! $ #00005165' TO DFHEIV0
  5221     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  5222     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5223     MOVE X'2420233030303035313635' TO DFHEIV0(25:11)
  5224     CALL 'kxdfhei1' USING DFHEIV0
  5225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5226
  5227
  5228     SET T-INDEX
  5229        TS-INDEX  TO  +1.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 104
* EL650.cbl
  5230
  5231     MOVE PI-ACCT-CCGSA-KEY      TO  KEY-SAVE.
  5232
  5233     MOVE LOW-VALUES             TO  TEMP-STORAGE-RECORD.
  5234
  5235     MOVE ZEROS                  TO  PI-TOTAL-LINES.
  5236
  5237     PERFORM 7100-START-BROWSE  THRU  7100-EXIT.
  5238
  5239     MOVE 'Y'                    TO  BROWSE-STARTED-SW.
  5240
  5241 1005-READ-ACCT.
  5242     PERFORM 6310-READNEXT  THRU  6310-EXIT.
  5243
  5244     IF K-WITH-LINE-NO
  5245       IF SV-CARRIER   NOT = AM-CARRIER  OR
  5246          SV-GROUPING  NOT = AM-GROUPING OR
  5247          SV-STATE     NOT = AM-STATE    OR
  5248          SV-ACCOUNT   NOT = AM-ACCOUNT
  5249            GO TO 1010-NOT-FOUND.
  5250
  5251     IF SV-CO  NOT = AM-COMPANY-CD
  5252         GO TO 1010-NOT-FOUND.
  5253
  5254     IF SV-ACCOUNT  NOT =  AM-ACCOUNT
  5255         GO TO 1010-NOT-FOUND.
  5256
  5257     IF SV-STATE  NOT = AM-STATE
  5258       AND  (ST-ACCNT-CNTL
  5259       OR  CARR-ST-ACCNT-CNTL
  5260       OR  CARR-GROUP-ST-ACCNT-CNTL)
  5261         GO TO 1010-NOT-FOUND.
  5262
  5263     IF SV-CARRIER  NOT =  AM-CARRIER
  5264       AND  (CARR-ACCNT-CNTL
  5265       OR  CARR-ST-ACCNT-CNTL
  5266       OR  CARR-GROUP-ST-ACCNT-CNTL)
  5267         GO TO 1010-NOT-FOUND.
  5268
  5269     IF SV-GROUPING  NOT = AM-GROUPING
  5270       AND  CARR-GROUP-ST-ACCNT-CNTL
  5271         GO TO 1010-NOT-FOUND.
  5272
  5273     IF AM-TRNTO-DTE  =  SPACES
  5274         MOVE LOW-VALUES         TO  AM-TRNTO-DTE.
  5275
  5276     IF AM-TRNFROM-DTE  = SPACES
  5277         MOVE LOW-VALUES         TO  AM-TRNFROM-DTE.
  5278
  5279     IF T-INDEX  = 1
  5280         IF PI-COMPANY-ID  =  'LGX' OR 'MIC' OR 'MCC'
  5281             MOVE AM-TRANSFERRED-TO  TO  TRNTOO
  5282             MOVE AM-TRNTO-DTE       TO  DC-BIN-DATE-1
  5283             MOVE SPACE              TO  DC-OPTION-CODE
  5284             PERFORM 9700-DATE-CONVERSION
  5285             IF DATE-CONVERSION-ERROR
  5286                 MOVE SPACES         TO  TRNTODTO
  5287             ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 105
* EL650.cbl
  5288                 MOVE DC-GREG-DATE-1-EDIT
  5289                                     TO  TRNTODTO.
  5290
  5291     IF T-INDEX  =  1
  5292         IF PI-COMPANY-ID  =  'LGX' OR 'MIC' OR 'MCC'
  5293             MOVE AM-TRANSFERRED-FROM  TO  TRNFROMO
  5294             MOVE AM-TRNFROM-DTE       TO  DC-BIN-DATE-1
  5295             MOVE SPACE                TO  DC-OPTION-CODE
  5296             PERFORM 9700-DATE-CONVERSION
  5297             IF DATE-CONVERSION-ERROR
  5298                 MOVE SPACES           TO  TRNFRDTO
  5299             ELSE
  5300                 MOVE DC-GREG-DATE-1-EDIT
  5301                                       TO  TRNFRDTO.
  5302
  5303     IF T-INDEX  = 1
  5304         MOVE AM-CONTROL-PRIMARY  TO  PI-PREV-ACCOUNT
  5305         MOVE PI-ACCT-CCGSA-KEY   TO  PI-PREV-VG-ACCOUNT
  5306         MOVE AM-NAME             TO  NAMEO
  5307                                      PI-ACCNAME
  5308         MOVE SPACE               TO  NAMEFLGO
  5309                                      PI-NAMEFLG.
  5310
  5311     IF AM-NAME  NOT = NAMEO
  5312         MOVE '*'                TO  NAMEFLGO
  5313                                     PI-NAMEFLG.
  5314
  5315     PERFORM 1020-MOVE-TO-TABLE  THRU  1020-EXIT.
  5316
  5317     GO TO 1005-READ-ACCT.
  5318
  5319 1010-NOT-FOUND.
  5320     IF BROWSE-STARTED
  5321
  5322* EXEC CICS  ENDBR
  5323*            DATASET  (PI-ACCT-ID)
  5324*        END-EXEC.
  5325     MOVE 0
  5326       TO DFHEIV11
  5327*    MOVE '&2                    $   #00005263' TO DFHEIV0
  5328     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5329     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5330     MOVE X'2020233030303035323633' TO DFHEIV0(25:11)
  5331     CALL 'kxdfhei1' USING DFHEIV0,
  5332           PI-ACCT-ID,
  5333           DFHEIV11,
  5334           DFHEIV99
  5335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5336
  5337
  5338     IF T-INDEX  NOT = 1
  5339         PERFORM 7200-WRITE-TEMP-STORAGE  THRU  7200-EXIT
  5340         GO TO 7000-BUILD-OUTPUT-MAP.
  5341
  5342     MOVE ER-0226                TO  EMI-ERROR.
  5343
  5344     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5345
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 106
* EL650.cbl
  5346     MOVE -1                     TO  ACARIERL.
  5347     MOVE AL-UABON               TO  ACARIERA
  5348                                     AGROUPA
  5349                                     ASTATEA
  5350                                     AACCTA.
  5351
  5352     IF FROM-EL608-SW = 'Y'
  5353         MOVE SV-CARRIER     TO  ACARIERO
  5354         MOVE SV-GROUPING    TO  AGROUPO
  5355         MOVE SV-STATE       TO  ASTATEO
  5356         MOVE SV-ACCOUNT     TO  AACCTO
  5357         MOVE 'N'            TO  FROM-EL608-SW.
  5358
  5359     IF PI-MAINT = 'A'
  5360         IF PI-RECORD-NOT-CREATED
  5361             MOVE SV-CARRIER     TO  ACARIERO
  5362             MOVE SV-GROUPING    TO  AGROUPO
  5363             MOVE SV-STATE       TO  ASTATEO
  5364             MOVE SV-ACCOUNT     TO  AACCTO
  5365             MOVE ER-2151        TO  EMI-ERROR
  5366             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5367             MOVE 'S'            TO  PI-MAINT.
  5368
  5369     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 107
* EL650.cbl
  5371 1020-MOVE-TO-TABLE.
  5372     MOVE AM-EXPIRATION-DT       TO  PI-BIN-EXP-DT   (T-INDEX).
  5373     MOVE AM-EFFECTIVE-DT        TO  PI-BIN-EFF-DT   (T-INDEX).
  5374     MOVE AM-LAST-MAINT-DT       TO  PI-BIN-MAINT-DT (T-INDEX).
  5375     MOVE AM-HI-CERT-DATE        TO  DC-GREG-DATE-1-YMD.
  5376     MOVE '3'                    TO  DC-OPTION-CODE.
  5377
  5378     PERFORM 9700-DATE-CONVERSION.
  5379
  5380     IF DATE-CONVERSION-ERROR
  5381         MOVE LOW-VALUES         TO  PI-BIN-HI-CERT (T-INDEX)
  5382     ELSE
  5383         MOVE DC-BIN-DATE-1      TO  PI-BIN-HI-CERT (T-INDEX).
  5384
  5385     MOVE AM-LO-CERT-DATE        TO  DC-GREG-DATE-1-YMD.
  5386     MOVE '3'                    TO  DC-OPTION-CODE.
  5387
  5388     PERFORM 9700-DATE-CONVERSION.
  5389
  5390     IF DATE-CONVERSION-ERROR
  5391         MOVE LOW-VALUES         TO  PI-BIN-LO-CERT (T-INDEX)
  5392     ELSE
  5393         MOVE DC-BIN-DATE-1      TO  PI-BIN-LO-CERT (T-INDEX).
  5394
  5395     MOVE AM-AR-HI-CERT-DATE     TO  PI-BIN-AR-HI-CERT (T-INDEX).
  5396     MOVE AM-CONTROL-PRIMARY     TO  TS-ACCT-KEY (TS-INDEX).
  5397
  5398     ADD 1                       TO  PI-TOTAL-LINES.
  5399
  5400     SET T-INDEX
  5401        TS-INDEX  UP  BY  +1.
  5402
  5403     IF T-INDEX  = +33
  5404         GO TO 7000-BUILD-OUTPUT-MAP.
  5405
  5406
  5407 1020-EXIT.
  5408     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 108
* EL650.cbl
  5410 1500-ADD-ACCOUNT.
  5411     PERFORM 6100-BUILD-KEY             THRU  6199-EXIT.
  5412
  5413     MOVE PI-ACCT-CCGSA-KEY      TO  NEW-KEY-SAVE.
  5414
  5415     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  5416                                     PI-ACCT-REST-OF-EXP.
  5417
  5418     PERFORM 6500-READ-ACCT  THRU  6599-EXIT.
  5419
  5420     IF REC-FOUND
  5421         MOVE -1                 TO  ACARIERL
  5422         MOVE ER-0561            TO  EMI-ERROR
  5423         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5424         GO TO 8200-SEND-DATAONLY.
  5425
  5426     MOVE NEW-KEY-SAVE           TO PI-ACCT-CCGSA-KEY.
  5427
  5428     PERFORM 6000-EDIT-EFFECTIVE-DATE   THRU  6000-EFF-EXIT.
  5429
  5430     PERFORM 6000-EDIT-EXPIRATION-DATE  THRU  6000-EXP-EXIT.
  5431
  5432     PERFORM 6700-VERIFY-STATE-CARRIER  THRU  6799-EXIT.
  5433
  5434     IF BIN-EXPCHG-SAVE NOT GREATER BIN-EFFCHG-SAVE
  5435         MOVE -1                 TO  EXPCHGL
  5436         MOVE ER-1228            TO  EMI-ERROR
  5437         MOVE AL-UABON           TO  EXPCHGA
  5438         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5439
  5440     IF NOT EMI-NO-ERRORS
  5441         GO TO 8200-SEND-DATAONLY.
  5442
  5443     PERFORM 4100-BUILD-VERIFICATION  THRU  4199-EXIT.
  5444
  5445     IF WS-ACCT2-FOUND  = 'Y'
  5446         PERFORM 4200-CHECK-VALIDITY  THRU  4200-EXIT
  5447             VARYING  WS-INDEX  FROM  +1  BY  +1
  5448                UNTIL WS-INDEX GREATER +32.
  5449
  5450     IF NOT EMI-NO-ERRORS
  5451         GO TO 8200-SEND-DATAONLY.
  5452
  5453     MOVE PI-ACCT-CCGSA-KEY      TO  NEW-KEY-SAVE.
  5454
  5455     MOVE NEW-KEY-SAVE           TO  PI-ACCT-CCGSA-KEY
  5456                                     PI-PREV-ACCOUNT
  5457                                     PI-PREV-VG-ACCOUNT.
  5458     MOVE LOW-VALUES             TO  PI-DATE-RANGE-TABLE
  5459                                     PI-ACCT-REST-OF-EXP.
  5460     MOVE BIN-EXPCHG-SAVE        TO  PI-ACCT-EXP-DT
  5461                                     PI-BIN-EXP-DT (1)
  5462     MOVE BIN-EFFCHG-SAVE        TO  PI-BIN-EFF-DT (1).
  5463     MOVE 1                      TO  PI-TOTAL-LINES
  5464                                     PI-PAGE-NUMBER
  5465                                     PI-LINE-SELECTED.
  5466     MOVE SPACE                  TO  PI-RECORD-ADDED-SW.
  5467     MOVE MAINTI                 TO  PI-MAINT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 109
* EL650.cbl
  5468     MOVE XCTL-6501              TO  PGM-NAME.
  5469
  5470     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 110
* EL650.cbl
  5472 2000-CHANGE-ACCOUNT.
  5473     PERFORM 6100-BUILD-KEY  THRU  6199-EXIT.
  5474
  5475     PERFORM 6200-CHECK-KEY  THRU  6200-EXIT.
  5476
  5477     PERFORM 6000-EDIT-LINE  THRU  6000-LIN-EXIT.
  5478
  5479     IF NOT EMI-NO-ERRORS
  5480         GO TO 8200-SEND-DATAONLY.
  5481
  5482     SET T-INDEX TO LINEI.
  5483
  5484     IF PI-2ND-PAGE
  5485         SET T-INDEX  UP  BY  8
  5486     ELSE
  5487     IF PI-3RD-PAGE
  5488         SET T-INDEX  UP  BY  16
  5489     ELSE
  5490     IF PI-LST-PAGE
  5491         SET T-INDEX  UP  BY  24.
  5492
  5493     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  5494     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  5495     MOVE MAINTI                   TO  PI-MAINT.
  5496     MOVE XCTL-6501                TO  PGM-NAME.
  5497
  5498     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 111
* EL650.cbl
  5500 2500-DELETE-ACCOUNT.
  5501     PERFORM 6100-BUILD-KEY  THRU  6199-EXIT.
  5502
  5503     PERFORM 6200-CHECK-KEY  THRU  6200-EXIT.
  5504
  5505     PERFORM 6000-EDIT-LINE  THRU  6000-LIN-EXIT.
  5506
  5507     IF NOT EMI-NO-ERRORS
  5508         GO TO 8200-SEND-DATAONLY.
  5509
  5510     SET T-INDEX                 TO  LINEI.
  5511
  5512     IF PI-2ND-PAGE
  5513         SET T-INDEX  UP  BY  8
  5514     ELSE
  5515     IF PI-3RD-PAGE
  5516         SET T-INDEX  UP  BY  16
  5517     ELSE
  5518     IF PI-LST-PAGE
  5519         SET T-INDEX  UP  BY  24.
  5520
  5521     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT
  5522                                       BIN-MAX-DATE.
  5523     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  5524     MOVE PI-BIN-EFF-DT (T-INDEX)  TO  BIN-MIN-DATE.
  5525     MOVE '1'                      TO  FROM-WHERE-SW.
  5526
  5527     PERFORM 2550-CHECK-HI-LO-DATES  THRU  2550-EXIT
  5528       VARYING  T-INDEX  FROM  +1  BY  +1
  5529         UNTIL  T-INDEX GREATER PI-TOTAL-LINES.
  5530
  5531     MOVE SPACE                  TO  FROM-WHERE-SW.
  5532
  5533     IF NOT EMI-NO-ERRORS
  5534         GO TO 8200-SEND-DATAONLY.
  5535
  5536     SET T-INDEX TO LINEI.
  5537
  5538     IF PI-2ND-PAGE
  5539         SET T-INDEX  UP  BY  8
  5540     ELSE
  5541     IF PI-3RD-PAGE
  5542         SET T-INDEX  UP  BY  16
  5543     ELSE
  5544     IF PI-LST-PAGE
  5545         SET T-INDEX  UP  BY  24.
  5546
  5547
  5548* EXEC CICS  READ
  5549*        UPDATE
  5550*        DATASET  (PI-ACCT-ID)
  5551*        SET      (ADDRESS OF ACCOUNT-MASTER)
  5552*        RIDFLD   (PI-ACCT-KEY)
  5553*    END-EXEC.
  5554*    MOVE '&"S        EU         (   #00005476' TO DFHEIV0
  5555     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5556     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5557     MOVE X'2020233030303035343736' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 112
* EL650.cbl
  5558     CALL 'kxdfhei1' USING DFHEIV0,
  5559           PI-ACCT-ID,
  5560           DFHEIV20,
  5561           DFHEIV99,
  5562           PI-ACCT-KEY,
  5563           DFHEIV99,
  5564           DFHEIV99,
  5565           DFHEIV99
  5566     SET ADDRESS OF ACCOUNT-MASTER TO
  5567         DFHEIV20
  5568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5569
  5570
  5571     IF PI-BIN-LO-CERT (T-INDEX)  NOT =  LOW-VALUES  OR
  5572        PI-BIN-HI-CERT (T-INDEX)  NOT =  LOW-VALUES
  5573         MOVE ER-2070            TO  EMI-ERROR
  5574         MOVE -1                 TO  MAINTL
  5575         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5576         GO TO 8200-SEND-DATAONLY.
  5577
  5578     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  5579         MOVE 'N'                TO  PENDING-BUSINESS-SW
  5580     ELSE
  5581         PERFORM 2560-CHECK-PENDING-BUSINESS  THRU  2569-EXIT.
  5582
  5583     IF THERE-IS-PENDING-BUSINESS
  5584         MOVE ER-1612            TO  EMI-ERROR
  5585         MOVE -1                 TO  MAINTL
  5586         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5587         GO TO 8200-SEND-DATAONLY.
  5588
  5589     MOVE AM-CONTROL-PRIMARY     TO  B4-ACCT-KEY.
  5590     MOVE AM-EFFECTIVE-DT        TO  B4-ACCT-EFF-DT.
  5591
  5592     if pi-el650-del-sw = 'Y'
  5593        continue
  5594     else
  5595        move 'Y'                 to pi-el650-del-sw
  5596        move er-1299             to emi-error
  5597        perform 9900-error-format thru 9900-exit
  5598        MOVE 1 TO PI-PAGE-NUMBER
  5599        move spaces              to mainto
  5600        MOVE -1                  TO MAINTL
  5601        GO TO 1000-SHOW-ACCOUNT
  5602     end-if
  5603     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT
  5604
  5605****** DO NOT DELETE PLAN MASTER RECORDS IF MORE ACCT DATE RANGES
  5606     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  5607         NEXT SENTENCE
  5608     ELSE
  5609         IF PI-TOTAL-LINES  = 1
  5610             PERFORM 4800-DELETE-PLAN-REC   THRU  4899-EXIT
  5611         end-if
  5612     end-if
  5613
  5614     MOVE 'D'                    TO  JP-RECORD-TYPE
  5615     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 113
* EL650.cbl
  5616
  5617
  5618* EXEC CICS  DELETE
  5619*        DATASET  (PI-ACCT-ID)
  5620*    END-EXEC
  5621*    MOVE '&(                    &   #00005529' TO DFHEIV0
  5622     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  5623     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5624     MOVE X'2020233030303035353239' TO DFHEIV0(25:11)
  5625     CALL 'kxdfhei1' USING DFHEIV0,
  5626           PI-ACCT-ID,
  5627           DFHEIV99,
  5628           DFHEIV99,
  5629           DFHEIV99,
  5630           DFHEIV99
  5631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5632
  5633     PERFORM 8400-LOG-JOURNAL-RECORD
  5634
  5635     PERFORM 6600-UPDATE-MAINT-DT  THRU  6699-EXIT
  5636
  5637     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  5638                                     PI-ACCT-REST-OF-EXP
  5639                                     LINEO
  5640     MOVE ER-0000                TO  EMI-ERROR
  5641
  5642     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5643
  5644     IF PI-TOTAL-LINES  = 1
  5645         MOVE LOW-VALUES         TO  PI-DATE-RANGE-TABLE
  5646         MOVE ZEROS              TO  PI-TOTAL-LINES
  5647         MOVE 1                  TO  PI-PAGE-NUMBER
  5648         GO TO 7000-BUILD-OUTPUT-MAP
  5649     end-if
  5650     GO TO 1002-SHOW-NEW-RECORDS.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 114
* EL650.cbl
  5652 2550-CHECK-HI-LO-DATES.
  5653     IF FROM-CHANGE
  5654         GO TO 2550-CHECK-CHANGE.
  5655
  5656     IF PI-BIN-LO-CERT (T-INDEX)  =  LOW-VALUES  AND
  5657        PI-BIN-HI-CERT (T-INDEX)  =  LOW-VALUES
  5658         GO TO 2550-CHECK-AR-DELETE.
  5659
  5660     IF ((PI-BIN-HI-CERT (T-INDEX) NOT LESS BIN-MIN-DATE AND
  5661          PI-BIN-HI-CERT (T-INDEX) LESS BIN-MAX-DATE)
  5662       OR
  5663         (PI-BIN-LO-CERT (T-INDEX) NOT LESS BIN-MIN-DATE AND
  5664          PI-BIN-LO-CERT (T-INDEX) LESS BIN-MAX-DATE))
  5665       AND
  5666            (PI-PROCESSOR-ID  NOT =  'LGXX')
  5667         MOVE ER-2087            TO  EMI-ERROR
  5668         MOVE -1                 TO  MAINTL
  5669         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5670
  5671 2550-CHECK-AR-DELETE.
  5672     IF NOT PI-AR-PROCESSING
  5673         GO TO 2550-EXIT.
  5674
  5675     IF T-INDEX NOT = LINEI
  5676         GO TO 2550-EXIT.
  5677
  5678     IF PI-BIN-AR-HI-CERT (T-INDEX) = LOW-VALUES OR SPACES
  5679        GO TO 2550-EXIT.
  5680
  5681     MOVE ER-3155                TO  EMI-ERROR
  5682     MOVE -1                     TO  MAINTL
  5683     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5684
  5685 2550-CHECK-CHANGE.
  5686     IF PI-BIN-HI-CERT (T-INDEX)  = LOW-VALUES OR SPACES
  5687         GO TO 2550-CHECK-AR-CHANGE.
  5688
  5689     IF PI-BIN-HI-CERT (T-INDEX) NOT LESS BIN-MAX-DATE
  5690         MOVE ER-2113            TO  EMI-ERROR
  5691         MOVE -1                 TO  MAINTL
  5692         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5693
  5694 2550-CHECK-AR-CHANGE.
  5695      IF NOT PI-AR-PROCESSING
  5696          GO TO 2550-EXIT.
  5697
  5698      IF PI-BIN-AR-HI-CERT (T-INDEX) = LOW-VALUES
  5699          GO TO 2550-EXIT.
  5700
  5701      IF PI-BIN-AR-HI-CERT (T-INDEX) NOT LESS BIN-MAX-DATE
  5702         MOVE ER-3155            TO  EMI-ERROR
  5703         MOVE -1                 TO  MAINTL
  5704         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5705
  5706 2550-EXIT.
  5707     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 115
* EL650.cbl
  5709 2560-CHECK-PENDING-BUSINESS.
  5710     MOVE 'N'                    TO  PENDING-BUSINESS-SW.
  5711     MOVE LOW-VALUES             TO  ERPNDB-KEY
  5712                                     PI-ERPNDB-ALT-KEY.
  5713     MOVE AM-COMPANY-CD-A1       TO  PNDB-COMPANY-CD-A1
  5714                                     PI-PB-COMPANY-CD-A1.
  5715     MOVE AM-VG-CARRIER          TO  PNDB-CARRIER
  5716                                     PI-PB-CARRIER.
  5717     MOVE AM-VG-GROUPING         TO  PNDB-GROUPING
  5718                                     PI-PB-GROUPING.
  5719     MOVE AM-VG-STATE            TO  PNDB-STATE
  5720                                     PI-PB-STATE.
  5721     MOVE AM-VG-ACCOUNT          TO  PNDB-ACCOUNT
  5722                                     PI-PB-ACCOUNT.
  5723
  5724
  5725* EXEC CICS  HANDLE CONDITION
  5726*         NOTFND   (2568-NO-RECORDS)
  5727*         ENDFILE  (2568-NO-RECORDS)
  5728*    END-EXEC.
  5729*    MOVE '"$I''                  ! % #00005624' TO DFHEIV0
  5730     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  5731     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5732     MOVE X'2520233030303035363234' TO DFHEIV0(25:11)
  5733     CALL 'kxdfhei1' USING DFHEIV0
  5734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5735
  5736
  5737
  5738* EXEC CICS  STARTBR
  5739*        DATASET  (PEND2-FILE-ID)
  5740*        RIDFLD   (ERPNDB-KEY)
  5741*    END-EXEC.
  5742     MOVE 0
  5743       TO DFHEIV11
  5744*    MOVE '&,         G          &   #00005629' TO DFHEIV0
  5745     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5746     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5747     MOVE X'2020233030303035363239' TO DFHEIV0(25:11)
  5748     CALL 'kxdfhei1' USING DFHEIV0,
  5749           PEND2-FILE-ID,
  5750           ERPNDB-KEY,
  5751           DFHEIV99,
  5752           DFHEIV11,
  5753           DFHEIV99
  5754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5755
  5756
  5757     MOVE 'Y'                    TO  PENDING-BROWSE-SW.
  5758
  5759 2562-READ-NEXT-PENDING.
  5760
  5761* EXEC CICS  READNEXT
  5762*        DATASET  (PEND2-FILE-ID)
  5763*        RIDFLD   (ERPNDB-KEY)
  5764*        SET      (ADDRESS OF PENDING-BUSINESS)
  5765*    END-EXEC.
  5766     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 116
* EL650.cbl
  5767       TO DFHEIV11
  5768*    MOVE '&.S                   )   #00005637' TO DFHEIV0
  5769     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  5770     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5771     MOVE X'2020233030303035363337' TO DFHEIV0(25:11)
  5772     CALL 'kxdfhei1' USING DFHEIV0,
  5773           PEND2-FILE-ID,
  5774           DFHEIV20,
  5775           DFHEIV99,
  5776           ERPNDB-KEY,
  5777           DFHEIV99,
  5778           DFHEIV11,
  5779           DFHEIV99,
  5780           DFHEIV99
  5781     SET ADDRESS OF PENDING-BUSINESS TO
  5782         DFHEIV20
  5783     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5784
  5785
  5786     IF PB-COMPANY-CD-A1 = PI-PB-COMPANY-CD-A1 AND
  5787        PB-CARRIER       = PI-PB-CARRIER       AND
  5788        PB-GROUPING      = PI-PB-GROUPING      AND
  5789        PB-STATE         = PI-PB-STATE         AND
  5790        PB-ACCOUNT       = PI-PB-ACCOUNT
  5791            NEXT SENTENCE
  5792          ELSE
  5793            GO TO 2568-NO-RECORDS.
  5794
  5795     IF PB-ISSUE
  5796       OR  PB-CANCELLATION
  5797         NEXT SENTENCE
  5798     ELSE
  5799         GO TO 2562-READ-NEXT-PENDING.
  5800
  5801     IF PB-CERT-EFF-DT  IS EQUAL TO  AM-EFFECTIVE-DT
  5802         MOVE 'Y'                TO  PENDING-BUSINESS-SW
  5803         GO TO 2568-NO-RECORDS.
  5804
  5805     IF PB-CERT-EFF-DT  IS GREATER THAN  AM-EFFECTIVE-DT
  5806       AND PB-CERT-EFF-DT  IS LESS THAN  AM-EXPIRATION-DT
  5807         MOVE 'Y'                TO  PENDING-BUSINESS-SW
  5808         GO TO 2568-NO-RECORDS.
  5809
  5810     GO TO 2562-READ-NEXT-PENDING.
  5811
  5812 2568-NO-RECORDS.
  5813     IF PENDING-BROWSE-STARTED
  5814         MOVE ' '                TO  PENDING-BROWSE-SW
  5815
  5816* EXEC CICS ENDBR
  5817*           DATASET  (PEND2-FILE-ID)
  5818*       END-EXEC.
  5819     MOVE 0
  5820       TO DFHEIV11
  5821*    MOVE '&2                    $   #00005672' TO DFHEIV0
  5822     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5823     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5824     MOVE X'2020233030303035363732' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 117
* EL650.cbl
  5825     CALL 'kxdfhei1' USING DFHEIV0,
  5826           PEND2-FILE-ID,
  5827           DFHEIV11,
  5828           DFHEIV99
  5829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5830
  5831
  5832 2569-EXIT.
  5833     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 118
* EL650.cbl
  5835 3000-CHANGE-EXPIRATION.
  5836     PERFORM 6100-BUILD-KEY             THRU  6199-EXIT.
  5837     PERFORM 6200-CHECK-KEY             THRU  6200-EXIT.
  5838     PERFORM 6000-EDIT-EXPIRATION-DATE  THRU  6000-EXP-EXIT.
  5839     PERFORM 4100-BUILD-VERIFICATION    THRU  4199-EXIT.
  5840
  5841     SET T-INDEX  TO  PI-TOTAL-LINES.
  5842
  5843     PERFORM VARYING WS-INDEX FROM +1 BY +1
  5844             UNTIL  PI-BIN-EXP-DT (T-INDEX)
  5845                        =  WS-ACCT-EXP-DT (WS-INDEX)
  5846                 OR  WS-INDEX GREATER +32
  5847     END-PERFORM.
  5848
  5849     IF PI-BIN-EXP-DT (T-INDEX) = WS-ACCT-EXP-DT (WS-INDEX)
  5850         MOVE BIN-EXPCHG-SAVE    TO  WS-ACCT-EXP-DT (WS-INDEX)
  5851         PERFORM 4300-VERIFY-INTEGRITY THRU 4399-EXIT
  5852             VARYING  WS-INDEX  FROM  +1  BY  +1
  5853               UNTIL  WS-INDEX GREATER +32
  5854     ELSE
  5855         MOVE ER-0453            TO  EMI-ERROR
  5856         MOVE -1                 TO  MAINTL
  5857         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5858
  5859     IF NOT EMI-NO-ERRORS
  5860         GO TO 8200-SEND-DATAONLY.
  5861
  5862     MOVE BIN-EXPCHG-SAVE        TO  BIN-MAX-DATE.
  5863     MOVE '2'                    TO  FROM-WHERE-SW.
  5864
  5865     PERFORM 2550-CHECK-HI-LO-DATES  THRU  2550-EXIT
  5866       VARYING  T-INDEX  FROM  +1  BY  +1
  5867         UNTIL  T-INDEX GREATER PI-TOTAL-LINES.
  5868
  5869     MOVE SPACE                  TO  FROM-WHERE-SW.
  5870
  5871     IF NOT EMI-NO-ERRORS
  5872         GO TO 8200-SEND-DATAONLY.
  5873
  5874     SET T-INDEX  TO  PI-TOTAL-LINES.
  5875     PERFORM 6010-DATE-CHECK  THRU  6010-EXIT.
  5876
  5877     IF NOT EMI-NO-ERRORS
  5878         GO TO 8200-SEND-DATAONLY.
  5879
  5880     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  5881     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  5882     MOVE PI-ACCT-KEY              TO  B4-ACCT-KEY.
  5883     MOVE PI-BIN-EFF-DT (T-INDEX)  TO  B4-ACCT-EFF-DT.
  5884
  5885     PERFORM 3100-DELETE-DATE-RANGE  THRU  3199-EXIT.
  5886
  5887     MOVE BIN-EXPCHG-SAVE        TO  AM-EXPIRATION-DT
  5888                                     AM-VG-EXPIRATION-DT
  5889                                     PI-BIN-EXP-DT (T-INDEX).
  5890     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT
  5891                                     PI-BIN-MAINT-DT (T-INDEX).
  5892     MOVE AM-CONTROL-PRIMARY     TO  AF-ACCT-KEY.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 119
* EL650.cbl
  5893     MOVE AM-EFFECTIVE-DT        TO  AF-ACCT-EFF-DT.
  5894
  5895     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  5896
  5897     PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT.
  5898
  5899     PERFORM 6600-UPDATE-MAINT-DT   THRU  6699-EXIT.
  5900
  5901     MOVE SPACES                 TO  EXPCHGI.
  5902     MOVE AL-UANOF               TO  EXPCHGA.
  5903     MOVE ER-0000                TO  EMI-ERROR.
  5904
  5905     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5906
  5907     GO TO 7000-BUILD-OUTPUT-MAP.
  5908
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 120
* EL650.cbl
  5910 3100-DELETE-DATE-RANGE.
  5911
  5912* EXEC CICS GETMAIN
  5913*        LENGTH   (ACCT-REC-LEN)
  5914*        SET      (ADDRESS OF ACCOUNT-MASTER)
  5915*        INITIMG  (GETMAIN-SPACE)
  5916*    END-EXEC.
  5917*    MOVE ',"IL                  $   #00005755' TO DFHEIV0
  5918     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  5919     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5920     MOVE X'2020233030303035373535' TO DFHEIV0(25:11)
  5921     CALL 'kxdfhei1' USING DFHEIV0,
  5922           DFHEIV20,
  5923           ACCT-REC-LEN,
  5924           GETMAIN-SPACE
  5925     SET ADDRESS OF ACCOUNT-MASTER TO
  5926         DFHEIV20
  5927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5928
  5929
  5930
  5931* EXEC CICS  HANDLE CONDITION
  5932*        NOTFND   (3175-CONTINUE)
  5933*        ENDFILE  (3175-CONTINUE)
  5934*    END-EXEC.
  5935*    MOVE '"$I''                  ! & #00005761' TO DFHEIV0
  5936     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  5937     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5938     MOVE X'2620233030303035373631' TO DFHEIV0(25:11)
  5939     CALL 'kxdfhei1' USING DFHEIV0
  5940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5941
  5942
  5943
  5944
  5945* EXEC CICS  READ
  5946*        UPDATE
  5947*        DATASET  (PI-ACCT-ID)
  5948*        INTO     (ACCOUNT-MASTER)
  5949*        RIDFLD   (PI-ACCT-KEY)
  5950*    END-EXEC.
  5951     MOVE LENGTH OF
  5952      ACCOUNT-MASTER
  5953       TO DFHEIV11
  5954*    MOVE '&"IL       EU         (   #00005767' TO DFHEIV0
  5955     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5956     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5957     MOVE X'2020233030303035373637' TO DFHEIV0(25:11)
  5958     CALL 'kxdfhei1' USING DFHEIV0,
  5959           PI-ACCT-ID,
  5960           ACCOUNT-MASTER,
  5961           DFHEIV11,
  5962           PI-ACCT-KEY,
  5963           DFHEIV99,
  5964           DFHEIV99,
  5965           DFHEIV99
  5966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5967
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 121
* EL650.cbl
  5968
  5969     MOVE 'D'                    TO  JP-RECORD-TYPE.
  5970     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  5971     MOVE ACCT-FILE-ID           TO  FILE-ID.
  5972
  5973
  5974* EXEC CICS  DELETE
  5975*        DATASET  (PI-ACCT-ID)
  5976*    END-EXEC.
  5977*    MOVE '&(                    &   #00005778' TO DFHEIV0
  5978     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  5979     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5980     MOVE X'2020233030303035373738' TO DFHEIV0(25:11)
  5981     CALL 'kxdfhei1' USING DFHEIV0,
  5982           PI-ACCT-ID,
  5983           DFHEIV99,
  5984           DFHEIV99,
  5985           DFHEIV99,
  5986           DFHEIV99
  5987     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5988
  5989
  5990     PERFORM 8400-LOG-JOURNAL-RECORD.
  5991
  5992     GO TO 3199-EXIT.
  5993
  5994 3175-CONTINUE.
  5995     IF BROWSE-STARTED
  5996         PERFORM 6320-ENDBR THRU 6320-EXIT.
  5997
  5998     MOVE ER-0226                TO  EMI-ERROR.
  5999
  6000     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6001
  6002     MOVE -1                     TO  MAINTL.
  6003
  6004     GO TO 8200-SEND-DATAONLY.
  6005
  6006 3199-EXIT.
  6007     EXIT.
  6008
  6009 3200-ADD-DATE-RANGE.
  6010     MOVE 'A'                    TO  JP-RECORD-TYPE.
  6011     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  6012
  6013
  6014* EXEC CICS  WRITE
  6015*        FROM     (ACCOUNT-MASTER)
  6016*        RIDFLD   (AM-CONTROL-PRIMARY)
  6017*        DATASET  (PI-ACCT-ID)
  6018*    END-EXEC.
  6019     MOVE LENGTH OF
  6020      ACCOUNT-MASTER
  6021       TO DFHEIV11
  6022*    MOVE '&$ L                  ''   #00005805' TO DFHEIV0
  6023     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6024     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6025     MOVE X'2020233030303035383035' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 122
* EL650.cbl
  6026     CALL 'kxdfhei1' USING DFHEIV0,
  6027           PI-ACCT-ID,
  6028           ACCOUNT-MASTER,
  6029           DFHEIV11,
  6030           AM-CONTROL-PRIMARY,
  6031           DFHEIV99,
  6032           DFHEIV99
  6033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6034
  6035
  6036     PERFORM 8400-LOG-JOURNAL-RECORD.
  6037
  6038 3299-EXIT.
  6039     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 123
* EL650.cbl
  6041 3500-CHANGE-EFFECTIVE.
  6042     PERFORM 6100-BUILD-KEY  THRU  6199-EXIT.
  6043
  6044     PERFORM 6200-CHECK-KEY  THRU  6200-EXIT.
  6045
  6046     PERFORM 6000-EDIT-EFFECTIVE-DATE  THRU  6000-EFF-EXIT.
  6047
  6048     IF NOT EMI-NO-ERRORS
  6049         GO TO 8200-SEND-DATAONLY.
  6050
  6051     PERFORM 4100-BUILD-VERIFICATION  THRU  4199-EXIT.
  6052
  6053     SET T-INDEX                 TO  +1.
  6054
  6055     PERFORM VARYING  WS-INDEX  FROM  +1  BY  +1
  6056             UNTIL  PI-BIN-EFF-DT (T-INDEX)
  6057                        =  WS-ACCT-EFF-DT (WS-INDEX)
  6058                 OR  WS-INDEX GREATER +32
  6059     END-PERFORM.
  6060
  6061     IF PI-BIN-EFF-DT (T-INDEX)
  6062                 = WS-ACCT-EFF-DT (WS-INDEX)
  6063         MOVE BIN-EFFCHG-SAVE    TO  WS-ACCT-EFF-DT (WS-INDEX)
  6064         PERFORM 4300-VERIFY-INTEGRITY THRU 4399-EXIT
  6065             VARYING  WS-INDEX  FROM  +1  BY  +1
  6066               UNTIL  WS-INDEX GREATER +32
  6067     ELSE
  6068         MOVE ER-0453            TO  EMI-ERROR
  6069         MOVE -1                 TO  MAINTL
  6070         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6071
  6072     IF NOT EMI-NO-ERRORS
  6073         GO TO 8200-SEND-DATAONLY.
  6074
  6075     SET T-INDEX TO  1.
  6076
  6077     PERFORM 6010-DATE-CHECK  THRU  6010-EXIT.
  6078
  6079     IF NOT EMI-NO-ERRORS
  6080         GO TO 8200-SEND-DATAONLY.
  6081
  6082     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  6083     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  6084     MOVE PI-ACCT-KEY              TO  B4-ACCT-KEY.
  6085     MOVE PI-BIN-EFF-DT (T-INDEX)  TO  B4-ACCT-EFF-DT.
  6086
  6087
  6088* EXEC CICS  READ
  6089*        UPDATE
  6090*        DATASET  (PI-ACCT-ID)
  6091*        SET      (ADDRESS OF ACCOUNT-MASTER)
  6092*        RIDFLD   (PI-ACCT-KEY)
  6093*    END-EXEC.
  6094*    MOVE '&"S        EU         (   #00005862' TO DFHEIV0
  6095     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6096     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6097     MOVE X'2020233030303035383632' TO DFHEIV0(25:11)
  6098     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 124
* EL650.cbl
  6099           PI-ACCT-ID,
  6100           DFHEIV20,
  6101           DFHEIV99,
  6102           PI-ACCT-KEY,
  6103           DFHEIV99,
  6104           DFHEIV99,
  6105           DFHEIV99
  6106     SET ADDRESS OF ACCOUNT-MASTER TO
  6107         DFHEIV20
  6108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6109
  6110
  6111     MOVE 'B'                    TO  JP-RECORD-TYPE.
  6112     MOVE ACCT-FILE-ID           TO  FILE-ID.
  6113     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  6114
  6115     PERFORM 8400-LOG-JOURNAL-RECORD.
  6116
  6117     MOVE BIN-EFFCHG-SAVE        TO  AM-EFFECTIVE-DT
  6118                                     PI-BIN-EFF-DT (T-INDEX).
  6119     MOVE EFFCHG-SAVE            TO  AM-EFFECT-DT.
  6120     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT
  6121                                     PI-BIN-MAINT-DT (T-INDEX).
  6122     MOVE AM-CONTROL-PRIMARY     TO  AF-ACCT-KEY.
  6123     MOVE AM-EFFECTIVE-DT        TO  AF-ACCT-EFF-DT.
  6124     MOVE 'C'                    TO  JP-RECORD-TYPE.
  6125     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  6126
  6127     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  6128
  6129
  6130* EXEC CICS  REWRITE
  6131*        FROM     (ACCOUNT-MASTER)
  6132*        DATASET  (PI-ACCT-ID)
  6133*    END-EXEC.
  6134     MOVE LENGTH OF
  6135      ACCOUNT-MASTER
  6136       TO DFHEIV11
  6137*    MOVE '&& L                  %   #00005887' TO DFHEIV0
  6138     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6139     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6140     MOVE X'2020233030303035383837' TO DFHEIV0(25:11)
  6141     CALL 'kxdfhei1' USING DFHEIV0,
  6142           PI-ACCT-ID,
  6143           ACCOUNT-MASTER,
  6144           DFHEIV11,
  6145           DFHEIV99
  6146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6147
  6148
  6149     PERFORM 8400-LOG-JOURNAL-RECORD.
  6150
  6151     PERFORM 6600-UPDATE-MAINT-DT  THRU  6699-EXIT.
  6152
  6153     MOVE SPACES                 TO  EFFCHGO.
  6154
  6155     MOVE ZERO                   TO  EFFCHGL
  6156                                     EXPCHGL.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 125
* EL650.cbl
  6157
  6158     MOVE AL-UANOF               TO  EFFCHGA.
  6159
  6160     MOVE ER-0000                TO  EMI-ERROR.
  6161
  6162     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6163
  6164     GO TO 7000-BUILD-OUTPUT-MAP.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 126
* EL650.cbl
  6166 4000-CHANGE-ALL.
  6167     PERFORM 6100-BUILD-KEY  THRU  6199-EXIT.
  6168
  6169     PERFORM 6200-CHECK-KEY  THRU  6200-EXIT.
  6170
  6171     IF NOT EMI-NO-ERRORS
  6172         GO TO 8200-SEND-DATAONLY.
  6173
  6174     MOVE 1                      TO  PI-LINE-SELECTED.
  6175     MOVE MAINTI                 TO  PI-MAINT.
  6176     MOVE XCTL-6501              TO  PGM-NAME.
  6177
  6178     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 127
* EL650.cbl
  6180 4100-BUILD-VERIFICATION.
  6181     MOVE SPACES                 TO  BROWSE-STARTED-SW.
  6182
  6183     SET WS-INDEX  TO  +1.
  6184
  6185     MOVE 'N'                    TO  WS-ACCT2-FOUND.
  6186     MOVE PI-ACCT-KEY            TO  WS-ACCT-VERIFY-KEY.
  6187     MOVE LOW-VALUES             TO  WS-ACCT-VER-EXP-DT
  6188                                     WS-VERIFY-AREA.
  6189
  6190     IF ST-ACCNT-CNTL  OR
  6191        ACCNT-CNTL
  6192          MOVE SPACES             TO  WS-ACCT-VER-CARR.
  6193
  6194     IF ST-ACCNT-CNTL      OR
  6195        CARR-ST-ACCNT-CNTL OR
  6196        ACCNT-CNTL         OR
  6197        CARR-ACCNT-CNTL
  6198          MOVE SPACES             TO  WS-ACCT-VER-GROUP.
  6199
  6200     IF ACCNT-CNTL OR
  6201        CARR-ACCNT-CNTL
  6202          MOVE SPACES             TO  WS-ACCT-VER-STATE.
  6203
  6204     MOVE WS-ACCT-VERIFY-KEY     TO  WS-SAVE-VERIFY-KEY.
  6205
  6206
  6207* EXEC CICS  HANDLE CONDITION
  6208*        NOTFND   (4175-CONTINUE)
  6209*        ENDFILE  (4175-CONTINUE)
  6210*    END-EXEC.
  6211*    MOVE '"$I''                  ! '' #00005949' TO DFHEIV0
  6212     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6213     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6214     MOVE X'2720233030303035393439' TO DFHEIV0(25:11)
  6215     CALL 'kxdfhei1' USING DFHEIV0
  6216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6217
  6218
  6219
  6220* EXEC CICS  STARTBR
  6221*        DATASET  (ACCT2-FILE-ID)
  6222*        RIDFLD   (WS-ACCT-VERIFY-KEY)
  6223*        GTEQ
  6224*    END-EXEC.
  6225     MOVE 0
  6226       TO DFHEIV11
  6227*    MOVE '&,         G          &   #00005954' TO DFHEIV0
  6228     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6229     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6230     MOVE X'2020233030303035393534' TO DFHEIV0(25:11)
  6231     CALL 'kxdfhei1' USING DFHEIV0,
  6232           ACCT2-FILE-ID,
  6233           WS-ACCT-VERIFY-KEY,
  6234           DFHEIV99,
  6235           DFHEIV11,
  6236           DFHEIV99
  6237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 128
* EL650.cbl
  6238
  6239
  6240     MOVE 'Y'                    TO  BROWSE-STARTED-SW.
  6241
  6242 4150-READ-NEXT.
  6243
  6244* EXEC CICS  READNEXT
  6245*        DATASET  (ACCT2-FILE-ID)
  6246*        RIDFLD   (WS-ACCT-VERIFY-KEY)
  6247*        SET      (ADDRESS OF ACCOUNT-MASTER)
  6248*    END-EXEC.
  6249     MOVE 0
  6250       TO DFHEIV11
  6251*    MOVE '&.S                   )   #00005963' TO DFHEIV0
  6252     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6253     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6254     MOVE X'2020233030303035393633' TO DFHEIV0(25:11)
  6255     CALL 'kxdfhei1' USING DFHEIV0,
  6256           ACCT2-FILE-ID,
  6257           DFHEIV20,
  6258           DFHEIV99,
  6259           WS-ACCT-VERIFY-KEY,
  6260           DFHEIV99,
  6261           DFHEIV11,
  6262           DFHEIV99,
  6263           DFHEIV99
  6264     SET ADDRESS OF ACCOUNT-MASTER TO
  6265         DFHEIV20
  6266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6267
  6268
  6269     MOVE AM-CONTROL-BY-VAR-GRP  TO  WS-TEST-KEY.
  6270
  6271     IF WS-TEST-KEY  NOT = WS-SAVE-VERIFY-KEY
  6272         GO TO 4175-CONTINUE.
  6273
  6274     MOVE 'Y'                    TO  WS-ACCT2-FOUND.
  6275     MOVE AM-CONTROL-PRIMARY     TO  WS-ACCT-KEY (WS-INDEX).
  6276     MOVE AM-VG-EXPIRATION-DT    TO  WS-ACCT-EXP-DT (WS-INDEX).
  6277     MOVE AM-EFFECTIVE-DT        TO  WS-ACCT-EFF-DT (WS-INDEX).
  6278     MOVE AM-HI-CERT-DATE        TO  DC-GREG-DATE-1-YMD.
  6279     MOVE '3'                    TO  DC-OPTION-CODE.
  6280
  6281     PERFORM 9700-DATE-CONVERSION.
  6282
  6283     IF DATE-CONVERSION-ERROR
  6284         MOVE LOW-VALUES         TO  WS-ACCT-HI-CERT (WS-INDEX)
  6285     ELSE
  6286         MOVE DC-BIN-DATE-1      TO  WS-ACCT-HI-CERT (WS-INDEX).
  6287
  6288     MOVE AM-LO-CERT-DATE        TO  DC-GREG-DATE-1-YMD.
  6289     MOVE '3'                    TO  DC-OPTION-CODE.
  6290
  6291     PERFORM 9700-DATE-CONVERSION.
  6292
  6293     IF DATE-CONVERSION-ERROR
  6294         MOVE LOW-VALUES         TO  WS-ACCT-LO-CERT (WS-INDEX)
  6295     ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 129
* EL650.cbl
  6296         MOVE DC-BIN-DATE-1      TO  WS-ACCT-LO-CERT (WS-INDEX).
  6297
  6298     SET WS-INDEX  UP  BY  +1.
  6299
  6300     GO TO 4150-READ-NEXT.
  6301
  6302 4175-CONTINUE.
  6303     IF BROWSE-STARTED
  6304
  6305* EXEC CICS  ENDBR
  6306*            DATASET  (ACCT2-FILE-ID)
  6307*        END-EXEC
  6308     MOVE 0
  6309       TO DFHEIV11
  6310*    MOVE '&2                    $   #00006004' TO DFHEIV0
  6311     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6312     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6313     MOVE X'2020233030303036303034' TO DFHEIV0(25:11)
  6314     CALL 'kxdfhei1' USING DFHEIV0,
  6315           ACCT2-FILE-ID,
  6316           DFHEIV11,
  6317           DFHEIV99
  6318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6319         MOVE SPACES             TO  BROWSE-STARTED-SW.
  6320
  6321 4199-EXIT.
  6322     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 130
* EL650.cbl
  6324 4200-CHECK-VALIDITY.
  6325     IF (BIN-EXPCHG-SAVE GREATER
  6326                    WS-ACCT-EFF-DT (WS-INDEX))
  6327       AND  (BIN-EXPCHG-SAVE NOT GREATER
  6328                    WS-ACCT-EXP-DT (WS-INDEX))
  6329         MOVE ER-2051            TO  EMI-ERROR
  6330         MOVE -1                 TO  EXPCHGL
  6331         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6332
  6333     IF BIN-EFFCHG-SAVE NOT LESS WS-ACCT-EFF-DT (WS-INDEX) AND
  6334        BIN-EFFCHG-SAVE LESS     WS-ACCT-EXP-DT (WS-INDEX)
  6335          MOVE ER-2051            TO  EMI-ERROR
  6336          MOVE -1                 TO  EFFCHGL
  6337          PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6338
  6339 4200-EXIT.
  6340     EXIT.
  6341 4220-DISPLAY-VERI-TABLE.
  6342
  6343     perform varying d1 from +1 by +1 until
  6344        (d1 > +32)
  6345        or (ws-acct-eff-dt (d1) = low-values)
  6346        move ws-acct-eff-dt (d1) to dc-bin-date-1
  6347        move ' '                 to dc-option-code
  6348        perform 9700-date-conversion
  6349        move dc-greg-date-1-edit to ws-display-eff-date
  6350
  6351        move ws-acct-exp-dt (d1) to dc-bin-date-1
  6352        move ' '                 to dc-option-code
  6353        perform 9700-date-conversion
  6354        move dc-greg-date-1-edit to ws-display-exp-date
  6355
  6356        display ' date range ' d1 ' ' ws-display-eff-date
  6357                                  ' ' ws-display-exp-date
  6358     end-perform
  6359
  6360     .
  6361 4220-EXIT.
  6362     EXIT.
  6363
  6364 4300-VERIFY-INTEGRITY.
  6365     set d1 to ws-index
  6366     IF WS-ACCT-EFF-DT (WS-INDEX + 1)  = LOW-VALUES
  6367         SET WS-INDEX  TO  +32
  6368         GO TO 4399-EXIT.
  6369
  6370     IF ((WS-ACCT-EXP-DT (WS-INDEX)  =  BIN-EXPCHG-SAVE)  OR
  6371        (WS-ACCT-EFF-DT (WS-INDEX + 1)  =  BIN-EFFCHG-SAVE))
  6372                  AND
  6373        (WS-ACCT-EXP-DT (WS-INDEX) > WS-ACCT-EFF-DT (WS-INDEX))
  6374         SET WS-INDEX  TO  +33
  6375         GO TO 4399-EXIT.
  6376
  6377     IF (WS-ACCT-EXP-DT (WS-INDEX) NOT GREATER
  6378                    WS-ACCT-EFF-DT (WS-INDEX + 1))
  6379       AND  (WS-ACCT-EXP-DT (WS-INDEX) GREATER
  6380                    WS-ACCT-EFF-DT (WS-INDEX))
  6381         GO TO 4399-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 131
* EL650.cbl
  6382
  6383     MOVE ER-2051                TO  EMI-ERROR.
  6384     MOVE -1                     TO  EXPCHGL.
  6385
  6386     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6387
  6388 4399-EXIT.
  6389     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 132
* EL650.cbl
  6391 4500-CREATE-NEW-ACCOUNT.
  6392     PERFORM 6100-BUILD-KEY            THRU 6199-EXIT.
  6393
  6394     PERFORM 6700-VERIFY-STATE-CARRIER THRU 6799-EXIT.
  6395
  6396     IF MAINTI = 'T'
  6397         PERFORM 6000-EDIT-EFFECTIVE-DATE THRU 6000-EFF-EXIT.
  6398
  6399     PERFORM 4100-BUILD-VERIFICATION THRU 4199-EXIT.
  6400
  6401     IF WS-ACCT2-FOUND = 'Y'
  6402         MOVE ER-0561            TO  EMI-ERROR
  6403         MOVE -1                 TO  MAINTL
  6404         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6405
  6406     MOVE SPACES                 TO  GETMAIN-SW.
  6407
  6408     IF NOT EMI-NO-ERRORS
  6409         GO TO 8200-SEND-DATAONLY.
  6410
  6411     IF PI-PREV-ACCOUNT  =  LOW-VALUES
  6412         MOVE ER-0453            TO  EMI-ERROR
  6413         MOVE -1                 TO  MAINTL
  6414         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6415         GO TO 8200-SEND-DATAONLY.
  6416
  6417     MOVE PI-ACCT-CCGSA-KEY      TO  NEW-KEY-SAVE.
  6418
  6419     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  6420                                     PI-ACCT-REST-OF-EXP.
  6421
  6422     PERFORM 6500-READ-ACCT  THRU  6599-EXIT.
  6423
  6424     IF REC-FOUND
  6425         MOVE -1                 TO  ACARIERL
  6426         MOVE ER-0561            TO  EMI-ERROR
  6427         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6428         GO TO 8200-SEND-DATAONLY.
  6429
  6430     MOVE PI-PREV-ACCOUNT        TO  PI-ACCT-CCGSA-KEY.
  6431     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  6432                                     PI-ACCT-REST-OF-EXP.
  6433
  6434
  6435* EXEC CICS  HANDLE CONDITION
  6436*        NOTFND   (4530-NOT-FOUND)
  6437*        ENDFILE  (4530-NOT-FOUND)
  6438*    END-EXEC.
  6439*    MOVE '"$I''                  ! ( #00006122' TO DFHEIV0
  6440     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6441     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6442     MOVE X'2820233030303036313232' TO DFHEIV0(25:11)
  6443     CALL 'kxdfhei1' USING DFHEIV0
  6444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6445
  6446
  6447     PERFORM 6300-STARTBR  THRU  6300-EXIT.
  6448
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 133
* EL650.cbl
  6449 4510-READ-NEXT.
  6450     PERFORM 6310-READNEXT  THRU  6310-EXIT.
  6451
  6452     IF PI-ACCT-CCGSA-KEY  NOT = PI-PREV-ACCOUNT
  6453         GO TO 4540-END-COPY.
  6454
  6455     MOVE AM-EXPIRATION-DT       TO  WS-EXP-SAVE.
  6456     MOVE NEW-KEY-SAVE           TO  AM-CONTROL-PRIMARY.
  6457     MOVE LOW-VALUES             TO  AM-CNTRL-B.
  6458     MOVE WS-EXP-SAVE            TO  AM-EXPIRATION-DT.
  6459
  6460     PERFORM 6400-BUILD-VG-KEY  THRU  6499-EXIT.
  6461
  6462     IF MAINTI  = 'T'
  6463         MOVE '2'                TO  AM-STATUS
  6464         MOVE AM-ACCOUNT         TO  AM-AGT (1)
  6465         MOVE PI-ACCT-CARRIER    TO  AM-TRNFROM-CARRIER
  6466         MOVE PI-ACCT-GROUPING   TO  AM-TRNFROM-GROUPING
  6467         MOVE PI-ACCT-STATE      TO  AM-TRNFROM-STATE
  6468         MOVE PI-ACCT-ACCOUNT    TO  AM-TRNFROM-ACCOUNT
  6469         MOVE BIN-EFFCHG-SAVE    TO  AM-TRNFROM-DTE
  6470     ELSE
  6471         MOVE LOW-VALUES         TO  AM-AR-HI-CERT-DATE
  6472         MOVE ZEROS              TO  AM-HI-CERT-DATE
  6473                                     AM-LO-CERT-DATE
  6474         MOVE SPACES             TO  AM-1ST-PROD-DATE
  6475                                     AM-PREV-DATES
  6476                                     AM-ORIG-DEALER-NO
  6477     END-IF
  6478
  6479     MOVE SPACES                 TO  AM-CERTS-PURGED-DATE.
  6480     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT.
  6481     MOVE PI-PROCESSOR-ID        TO  AM-LAST-MAINT-USER.
  6482     MOVE EIBTIME                TO  AM-LAST-MAINT-HHMMSS.
  6483
  6484     PERFORM 5500-ADD-NEW-AXRF-RECORD  THRU  5599-EXIT.
  6485
  6486     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  6487     MOVE 'A'                    TO  JP-RECORD-TYPE.
  6488
  6489     PERFORM 6320-ENDBR THRU 6320-EXIT.
  6490
  6491
  6492* EXEC CICS GETMAIN
  6493*        LENGTH   (ACCT-REC-LEN)
  6494*        SET      (ADDRESS OF ACCOUNT-MASTER)
  6495*        INITIMG  (GETMAIN-SPACE)
  6496*    END-EXEC.
  6497*    MOVE ',"IL                  $   #00006171' TO DFHEIV0
  6498     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6499     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6500     MOVE X'2020233030303036313731' TO DFHEIV0(25:11)
  6501     CALL 'kxdfhei1' USING DFHEIV0,
  6502           DFHEIV20,
  6503           ACCT-REC-LEN,
  6504           GETMAIN-SPACE
  6505     SET ADDRESS OF ACCOUNT-MASTER TO
  6506         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 134
* EL650.cbl
  6507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6508
  6509
  6510     MOVE JP-RECORD-AREA         TO  ACCOUNT-MASTER.
  6511
  6512
  6513* EXEC CICS  WRITE
  6514*        DATASET  (PI-ACCT-ID)
  6515*        RIDFLD   (AM-CONTROL-PRIMARY)
  6516*        FROM     (ACCOUNT-MASTER)
  6517*    END-EXEC.
  6518     MOVE LENGTH OF
  6519      ACCOUNT-MASTER
  6520       TO DFHEIV11
  6521*    MOVE '&$ L                  ''   #00006179' TO DFHEIV0
  6522     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6523     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6524     MOVE X'2020233030303036313739' TO DFHEIV0(25:11)
  6525     CALL 'kxdfhei1' USING DFHEIV0,
  6526           PI-ACCT-ID,
  6527           ACCOUNT-MASTER,
  6528           DFHEIV11,
  6529           AM-CONTROL-PRIMARY,
  6530           DFHEIV99,
  6531           DFHEIV99
  6532     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6533
  6534
  6535     MOVE PI-ACCT-ID             TO  FILE-ID.
  6536
  6537     PERFORM 8400-LOG-JOURNAL-RECORD.
  6538
  6539     PERFORM 6300-STARTBR  THRU 6300-EXIT.
  6540     PERFORM 6310-READNEXT THRU 6310-EXIT.
  6541
  6542     GO TO 4510-READ-NEXT.
  6543
  6544 4530-NOT-FOUND.
  6545     IF BROWSE-STARTED
  6546         PERFORM 6320-ENDBR THRU 6320-EXIT.
  6547
  6548     MOVE ER-0226                TO  EMI-ERROR.
  6549
  6550     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6551
  6552     MOVE -1                     TO  MAINTL.
  6553
  6554     GO TO 8200-SEND-DATAONLY.
  6555
  6556 4540-END-COPY.
  6557     IF MAINTI = 'K'
  6558         IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  6559             NEXT SENTENCE
  6560         ELSE
  6561             PERFORM 4600-ADD-ERPLAN-RECORD THRU 4699-EXIT.
  6562
  6563     IF BROWSE-STARTED
  6564         PERFORM 6320-ENDBR THRU 6320-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 135
* EL650.cbl
  6565
  6566     IF MAINTI  NOT = 'T'
  6567         GO TO 4590-SHOW-NEW-ACCOUNT.
  6568
  6569     MOVE PI-PREV-ACCOUNT        TO  PI-ACCT-CCGSA-KEY.
  6570     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  6571                                     PI-ACCT-REST-OF-EXP.
  6572
  6573     PERFORM 6300-STARTBR  THRU  6300-EXIT.
  6574
  6575 4550-READ-NEXT.
  6576     PERFORM 6310-READNEXT  THRU  6310-EXIT.
  6577
  6578     IF PI-ACCT-CCGSA-KEY  NOT =  PI-PREV-ACCOUNT
  6579         GO TO 4570-END-REWRITE.
  6580
  6581
  6582* EXEC CICS  READ
  6583*        UPDATE
  6584*        DATASET  (PI-ACCT-ID)
  6585*        SET      (ADDRESS OF ACCOUNT-MASTER)
  6586*        RIDFLD   (PI-ACCT-KEY)
  6587*    END-EXEC.
  6588*    MOVE '&"S        EU         (   #00006231' TO DFHEIV0
  6589     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6590     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6591     MOVE X'2020233030303036323331' TO DFHEIV0(25:11)
  6592     CALL 'kxdfhei1' USING DFHEIV0,
  6593           PI-ACCT-ID,
  6594           DFHEIV20,
  6595           DFHEIV99,
  6596           PI-ACCT-KEY,
  6597           DFHEIV99,
  6598           DFHEIV99,
  6599           DFHEIV99
  6600     SET ADDRESS OF ACCOUNT-MASTER TO
  6601         DFHEIV20
  6602     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6603
  6604
  6605     MOVE 'B'                    TO  JP-RECORD-TYPE.
  6606     MOVE ACCT-FILE-ID           TO  FILE-ID.
  6607     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  6608
  6609     PERFORM 8400-LOG-JOURNAL-RECORD.
  6610
  6611     MOVE NEW-KEY-CNTRL          TO  AM-TRANSFERRED-TO.
  6612     MOVE BIN-EFFCHG-SAVE        TO  AM-TRNTO-DTE.
  6613     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT.
  6614     MOVE PI-PROCESSOR-ID        TO  AM-LAST-MAINT-USER.
  6615     MOVE EIBTIME                TO  AM-LAST-MAINT-HHMMSS.
  6616     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  6617     MOVE 'C'                    TO  JP-RECORD-TYPE.
  6618
  6619
  6620* EXEC CICS  REWRITE
  6621*        DATASET  (PI-ACCT-ID)
  6622*        FROM     (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 136
* EL650.cbl
  6623*    END-EXEC.
  6624     MOVE LENGTH OF
  6625      ACCOUNT-MASTER
  6626       TO DFHEIV11
  6627*    MOVE '&& L                  %   #00006252' TO DFHEIV0
  6628     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6629     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6630     MOVE X'2020233030303036323532' TO DFHEIV0(25:11)
  6631     CALL 'kxdfhei1' USING DFHEIV0,
  6632           PI-ACCT-ID,
  6633           ACCOUNT-MASTER,
  6634           DFHEIV11,
  6635           DFHEIV99
  6636     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6637
  6638
  6639     MOVE PI-ACCT-ID             TO  FILE-ID.
  6640
  6641     PERFORM 8400-LOG-JOURNAL-RECORD.
  6642
  6643     GO TO 4550-READ-NEXT.
  6644
  6645 4570-END-REWRITE.
  6646     IF BROWSE-STARTED
  6647         PERFORM 6320-ENDBR  THRU  6320-EXIT.
  6648
  6649     MOVE SPACES                 TO  MAINTI
  6650                                     EFFCHGI.
  6651     MOVE AL-UANOF               TO  EFFCHGA.
  6652
  6653 4590-SHOW-NEW-ACCOUNT.
  6654     PERFORM 6600-UPDATE-MAINT-DT  THRU  6699-EXIT.
  6655
  6656     MOVE NEW-KEY-SAVE           TO  PI-PREV-ACCOUNT
  6657                                     PI-ACCT-CCGSA-KEY.
  6658
  6659     MOVE -1                     TO  MAINTL.
  6660     MOVE ER-0000                TO  EMI-ERROR.
  6661
  6662     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6663
  6664     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT.
  6665
  6666     GO TO 1002-SHOW-NEW-RECORDS.
  6667
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 137
* EL650.cbl
  6669 4600-ADD-ERPLAN-RECORD.
  6670
  6671* EXEC CICS  HANDLE CONDITION
  6672*        NOTFND   (4699-EXIT)
  6673*        ENDFILE  (4689-EOF)
  6674*    END-EXEC.
  6675*    MOVE '"$I''                  ! ) #00006288' TO DFHEIV0
  6676     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6677     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6678     MOVE X'2920233030303036323838' TO DFHEIV0(25:11)
  6679     CALL 'kxdfhei1' USING DFHEIV0
  6680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6681
  6682
  6683     MOVE LOW-VALUES            TO WS-PLAN-KEY.
  6684     MOVE PI-PREV-ACCOUNT       TO EK-CCGSA-KEY.
  6685
  6686     PERFORM 4700-STARTBR-PLAN THRU 4700-EXIT.
  6687
  6688 4610-READ-NEXT.
  6689     PERFORM 4710-READNEXT-PLAN THRU 4710-EXIT.
  6690
  6691     IF EK-CCGSA-KEY NOT = PI-PREV-ACCOUNT
  6692         GO TO 4689-EOF.
  6693
  6694     MOVE NEW-KEY-SAVE           TO  PL-CONTROL-PRIMARY.
  6695
  6696     MOVE EK-BTYPE               TO  PL-BENEFIT-TYPE.
  6697     MOVE EK-BCODE               TO  PL-BENEFIT-CODE.
  6698     MOVE EK-REVISION            TO  PL-REVISION-NO.
  6699
  6700     MOVE PL-CONTROL-PRIMARY     TO  PL-CONTROL-BY-VAR-GRP.
  6701
  6702     MOVE PLAN-MASTER            TO  JP-RECORD-AREA.
  6703
  6704
  6705* EXEC CICS  ENDBR
  6706*        DATASET  (PLAN-FILE-ID)
  6707*    END-EXEC.
  6708     MOVE 0
  6709       TO DFHEIV11
  6710*    MOVE '&2                    $   #00006314' TO DFHEIV0
  6711     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6712     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6713     MOVE X'2020233030303036333134' TO DFHEIV0(25:11)
  6714     CALL 'kxdfhei1' USING DFHEIV0,
  6715           PLAN-FILE-ID,
  6716           DFHEIV11,
  6717           DFHEIV99
  6718     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6719
  6720
  6721
  6722* EXEC CICS GETMAIN
  6723*        LENGTH   (PLAN-REC-LEN)
  6724*        SET      (ADDRESS OF PLAN-MASTER)
  6725*        INITIMG  (GETMAIN-SPACE)
  6726*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 138
* EL650.cbl
  6727*    MOVE ',"IL                  $   #00006318' TO DFHEIV0
  6728     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6729     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6730     MOVE X'2020233030303036333138' TO DFHEIV0(25:11)
  6731     CALL 'kxdfhei1' USING DFHEIV0,
  6732           DFHEIV20,
  6733           PLAN-REC-LEN,
  6734           GETMAIN-SPACE
  6735     SET ADDRESS OF PLAN-MASTER TO
  6736         DFHEIV20
  6737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6738
  6739
  6740     MOVE JP-RECORD-AREA         TO PLAN-MASTER.
  6741
  6742
  6743* EXEC CICS  WRITE
  6744*        DATASET  (PLAN-FILE-ID)
  6745*        RIDFLD   (PL-CONTROL-PRIMARY)
  6746*        FROM     (PLAN-MASTER)
  6747*    END-EXEC.
  6748     MOVE LENGTH OF
  6749      PLAN-MASTER
  6750       TO DFHEIV11
  6751*    MOVE '&$ L                  ''   #00006326' TO DFHEIV0
  6752     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6753     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6754     MOVE X'2020233030303036333236' TO DFHEIV0(25:11)
  6755     CALL 'kxdfhei1' USING DFHEIV0,
  6756           PLAN-FILE-ID,
  6757           PLAN-MASTER,
  6758           DFHEIV11,
  6759           PL-CONTROL-PRIMARY,
  6760           DFHEIV99,
  6761           DFHEIV99
  6762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6763
  6764
  6765     PERFORM 4700-STARTBR-PLAN  THRU 4700-EXIT.
  6766     PERFORM 4710-READNEXT-PLAN THRU 4710-EXIT.
  6767
  6768     GO TO 4610-READ-NEXT.
  6769
  6770 4689-EOF.
  6771
  6772* EXEC CICS  ENDBR
  6773*        DATASET  (PLAN-FILE-ID)
  6774*    END-EXEC.
  6775     MOVE 0
  6776       TO DFHEIV11
  6777*    MOVE '&2                    $   #00006338' TO DFHEIV0
  6778     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6779     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6780     MOVE X'2020233030303036333338' TO DFHEIV0(25:11)
  6781     CALL 'kxdfhei1' USING DFHEIV0,
  6782           PLAN-FILE-ID,
  6783           DFHEIV11,
  6784           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 139
* EL650.cbl
  6785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6786
  6787
  6788 4699-EXIT.
  6789      EXIT.
  6790
  6791 4700-STARTBR-PLAN.
  6792
  6793* EXEC CICS  STARTBR
  6794*        DATASET  (PLAN-FILE-ID)
  6795*        RIDFLD   (WS-PLAN-KEY)
  6796*    END-EXEC.
  6797     MOVE 0
  6798       TO DFHEIV11
  6799*    MOVE '&,         G          &   #00006346' TO DFHEIV0
  6800     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6801     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6802     MOVE X'2020233030303036333436' TO DFHEIV0(25:11)
  6803     CALL 'kxdfhei1' USING DFHEIV0,
  6804           PLAN-FILE-ID,
  6805           WS-PLAN-KEY,
  6806           DFHEIV99,
  6807           DFHEIV11,
  6808           DFHEIV99
  6809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6810
  6811
  6812 4700-EXIT.
  6813      EXIT.
  6814
  6815 4710-READNEXT-PLAN.
  6816
  6817* EXEC CICS  READNEXT
  6818*        DATASET  (PLAN-FILE-ID)
  6819*        SET      (ADDRESS OF PLAN-MASTER)
  6820*        RIDFLD   (WS-PLAN-KEY)
  6821*    END-EXEC.
  6822     MOVE 0
  6823       TO DFHEIV11
  6824*    MOVE '&.S                   )   #00006355' TO DFHEIV0
  6825     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6826     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6827     MOVE X'2020233030303036333535' TO DFHEIV0(25:11)
  6828     CALL 'kxdfhei1' USING DFHEIV0,
  6829           PLAN-FILE-ID,
  6830           DFHEIV20,
  6831           DFHEIV99,
  6832           WS-PLAN-KEY,
  6833           DFHEIV99,
  6834           DFHEIV11,
  6835           DFHEIV99,
  6836           DFHEIV99
  6837     SET ADDRESS OF PLAN-MASTER TO
  6838         DFHEIV20
  6839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6840
  6841
  6842 4710-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 140
* EL650.cbl
  6843      EXIT.
  6844
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 141
* EL650.cbl
  6846 4800-DELETE-PLAN-REC.
  6847
  6848* EXEC CICS  HANDLE CONDITION
  6849*        NOTFND   (4899-EXIT)
  6850*        ENDFILE  (4889-EOF)
  6851*    END-EXEC.
  6852*    MOVE '"$I''                  ! * #00006366' TO DFHEIV0
  6853     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6854     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6855     MOVE X'2A20233030303036333636' TO DFHEIV0(25:11)
  6856     CALL 'kxdfhei1' USING DFHEIV0
  6857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6858
  6859
  6860     MOVE LOW-VALUES            TO WS-PLAN-KEY.
  6861     MOVE AM-CONTROL-PRIMARY    TO EK-CCGSA-KEY
  6862                                   PI-PREV-ACCOUNT.
  6863
  6864 4805-STARTBR.
  6865     PERFORM 4700-STARTBR-PLAN THRU 4700-EXIT.
  6866
  6867 4810-READ-NEXT.
  6868     PERFORM 4710-READNEXT-PLAN THRU 4710-EXIT.
  6869
  6870     IF EK-CCGSA-KEY NOT = PI-PREV-ACCOUNT
  6871         GO TO 4889-EOF.
  6872
  6873
  6874* EXEC CICS  ENDBR
  6875*        DATASET  (PLAN-FILE-ID)
  6876*    END-EXEC.
  6877     MOVE 0
  6878       TO DFHEIV11
  6879*    MOVE '&2                    $   #00006384' TO DFHEIV0
  6880     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6881     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6882     MOVE X'2020233030303036333834' TO DFHEIV0(25:11)
  6883     CALL 'kxdfhei1' USING DFHEIV0,
  6884           PLAN-FILE-ID,
  6885           DFHEIV11,
  6886           DFHEIV99
  6887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6888
  6889
  6890
  6891* EXEC CICS  READ
  6892*        UPDATE
  6893*        DATASET  (PLAN-FILE-ID)
  6894*        SET      (ADDRESS OF PLAN-MASTER)
  6895*        RIDFLD   (WS-PLAN-KEY)
  6896*    END-EXEC.
  6897*    MOVE '&"S        EU         (   #00006388' TO DFHEIV0
  6898     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6899     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6900     MOVE X'2020233030303036333838' TO DFHEIV0(25:11)
  6901     CALL 'kxdfhei1' USING DFHEIV0,
  6902           PLAN-FILE-ID,
  6903           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 142
* EL650.cbl
  6904           DFHEIV99,
  6905           WS-PLAN-KEY,
  6906           DFHEIV99,
  6907           DFHEIV99,
  6908           DFHEIV99
  6909     SET ADDRESS OF PLAN-MASTER TO
  6910         DFHEIV20
  6911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6912
  6913
  6914
  6915* EXEC CICS  DELETE
  6916*        DATASET  (PLAN-FILE-ID)
  6917*    END-EXEC.
  6918*    MOVE '&(                    &   #00006395' TO DFHEIV0
  6919     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  6920     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6921     MOVE X'2020233030303036333935' TO DFHEIV0(25:11)
  6922     CALL 'kxdfhei1' USING DFHEIV0,
  6923           PLAN-FILE-ID,
  6924           DFHEIV99,
  6925           DFHEIV99,
  6926           DFHEIV99,
  6927           DFHEIV99
  6928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6929
  6930
  6931     GO TO 4805-STARTBR.
  6932
  6933 4889-EOF.
  6934
  6935* EXEC CICS  ENDBR
  6936*        DATASET  (PLAN-FILE-ID)
  6937*    END-EXEC.
  6938     MOVE 0
  6939       TO DFHEIV11
  6940*    MOVE '&2                    $   #00006402' TO DFHEIV0
  6941     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6942     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6943     MOVE X'2020233030303036343032' TO DFHEIV0(25:11)
  6944     CALL 'kxdfhei1' USING DFHEIV0,
  6945           PLAN-FILE-ID,
  6946           DFHEIV11,
  6947           DFHEIV99
  6948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6949
  6950
  6951 4899-EXIT.
  6952      EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 143
* EL650.cbl
  6954 4900-CREATE-NEW-ACCOUNT.
  6955     PERFORM 6100-BUILD-KEY             THRU  6199-EXIT.
  6956
  6957     SET T-INDEX                 TO  LINEI.
  6958
  6959     IF PI-2ND-PAGE
  6960         SET T-INDEX  UP  BY  8
  6961     ELSE
  6962     IF PI-3RD-PAGE
  6963         SET T-INDEX  UP  BY  16
  6964     ELSE
  6965     IF PI-LST-PAGE
  6966         SET T-INDEX  UP  BY  24.
  6967
  6968     IF EFFCHGL NOT =  ZERO
  6969         PERFORM 6000-EDIT-EFFECTIVE-DATE   THRU  6000-EFF-EXIT
  6970       ELSE
  6971         MOVE PI-BIN-EFF-DT (T-INDEX)  TO  BIN-EFFCHG-SAVE.
  6972
  6973     IF EXPCHGL NOT =  ZERO
  6974         PERFORM 6000-EDIT-EXPIRATION-DATE  THRU  6000-EXP-EXIT
  6975       ELSE
  6976         MOVE PI-BIN-EXP-DT (T-INDEX)  TO  BIN-EXPCHG-SAVE.
  6977
  6978     PERFORM 6700-VERIFY-STATE-CARRIER  THRU  6799-EXIT.
  6979
  6980     IF BIN-EXPCHG-SAVE NOT GREATER BIN-EFFCHG-SAVE
  6981         MOVE -1                 TO  EXPCHGL
  6982         MOVE ER-1228            TO  EMI-ERROR
  6983         MOVE AL-UABON           TO  EXPCHGA
  6984         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6985
  6986     PERFORM 6000-EDIT-LINE  THRU  6000-LIN-EXIT.
  6987
  6988     IF EMI-ERROR  NOT = ZEROS
  6989         GO TO 8200-SEND-DATAONLY.
  6990
  6991     MOVE SPACES                 TO  GETMAIN-SW.
  6992
  6993     IF NOT EMI-NO-ERRORS
  6994         GO TO 8200-SEND-DATAONLY.
  6995
  6996     IF PI-PREV-ACCOUNT  =  LOW-VALUES
  6997         MOVE ER-0453            TO  EMI-ERROR
  6998         MOVE -1                 TO  MAINTL
  6999         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7000         GO TO 8200-SEND-DATAONLY.
  7001
  7002     MOVE PI-ACCT-CCGSA-KEY      TO  NEW-KEY-SAVE.
  7003
  7004     PERFORM 4100-BUILD-VERIFICATION  THRU  4199-EXIT.
  7005
  7006     PERFORM 4200-CHECK-VALIDITY  THRU  4200-EXIT
  7007         VARYING  WS-INDEX  FROM  +1  BY  +1
  7008            UNTIL WS-INDEX GREATER +32.
  7009
  7010     IF NOT EMI-NO-ERRORS
  7011         GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 144
* EL650.cbl
  7012
  7013     MOVE PI-PREV-ACCOUNT          TO  PI-ACCT-CCGSA-KEY.
  7014     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  7015     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  7016
  7017     PERFORM 6500-READ-ACCT     THRU  6599-EXIT.
  7018
  7019     MOVE LOW-VALUES             TO  AM-AR-HI-CERT-DATE
  7020     MOVE ZEROS                  TO  AM-HI-CERT-DATE
  7021                                     AM-LO-CERT-DATE
  7022     MOVE ZEROS                  TO  AM-DCC-MAX-MARKETING-FEE
  7023     MOVE SPACES                 TO  AM-1ST-PROD-DATE
  7024                                     AM-PREV-DATES
  7025                                     AM-ORIG-DEALER-NO
  7026
  7027     MOVE SPACES                 TO  AM-CERTS-PURGED-DATE.
  7028     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT.
  7029     MOVE PI-PROCESSOR-ID        TO  AM-LAST-MAINT-USER.
  7030     MOVE EIBTIME                TO  AM-LAST-MAINT-HHMMSS.
  7031
  7032     PERFORM 5500-ADD-NEW-AXRF-RECORD  THRU  5599-EXIT.
  7033
  7034     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  7035     MOVE 'A'                    TO  JP-RECORD-TYPE.
  7036
  7037
  7038* EXEC CICS GETMAIN
  7039*        LENGTH   (ACCT-REC-LEN)
  7040*        SET      (ADDRESS OF ACCOUNT-MASTER)
  7041*        INITIMG  (GETMAIN-SPACE)
  7042*    END-EXEC.
  7043*    MOVE ',"IL                  $   #00006492' TO DFHEIV0
  7044     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7045     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7046     MOVE X'2020233030303036343932' TO DFHEIV0(25:11)
  7047     CALL 'kxdfhei1' USING DFHEIV0,
  7048           DFHEIV20,
  7049           ACCT-REC-LEN,
  7050           GETMAIN-SPACE
  7051     SET ADDRESS OF ACCOUNT-MASTER TO
  7052         DFHEIV20
  7053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7054
  7055
  7056     MOVE JP-RECORD-AREA         TO  ACCOUNT-MASTER.
  7057     MOVE NEW-KEY-SAVE           TO  AM-CONTROL-PRIMARY.
  7058     MOVE LOW-VALUES             TO  AM-CNTRL-B.
  7059     MOVE BIN-EFFCHG-SAVE        TO  AM-EFFECTIVE-DT.
  7060     MOVE BIN-EXPCHG-SAVE        TO  AM-EXPIRATION-DT
  7061                                     AM-VG-EXPIRATION-DT.
  7062
  7063     PERFORM 6400-BUILD-VG-KEY  THRU  6499-EXIT.
  7064
  7065
  7066* EXEC CICS  HANDLE CONDITION
  7067*        DUPREC   (4580-DUPREC)
  7068*        DUPKEY   (4580-DUPREC)
  7069*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 145
* EL650.cbl
  7070*    MOVE '"$%$                  ! + #00006507' TO DFHEIV0
  7071     MOVE X'222425242020202020202020' TO DFHEIV0(1:12)
  7072     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7073     MOVE X'2B20233030303036353037' TO DFHEIV0(25:11)
  7074     CALL 'kxdfhei1' USING DFHEIV0
  7075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7076
  7077
  7078
  7079* EXEC CICS  WRITE
  7080*        DATASET  (PI-ACCT-ID)
  7081*        RIDFLD   (AM-CONTROL-PRIMARY)
  7082*        FROM     (ACCOUNT-MASTER)
  7083*    END-EXEC.
  7084     MOVE LENGTH OF
  7085      ACCOUNT-MASTER
  7086       TO DFHEIV11
  7087*    MOVE '&$ L                  ''   #00006512' TO DFHEIV0
  7088     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7089     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7090     MOVE X'2020233030303036353132' TO DFHEIV0(25:11)
  7091     CALL 'kxdfhei1' USING DFHEIV0,
  7092           PI-ACCT-ID,
  7093           ACCOUNT-MASTER,
  7094           DFHEIV11,
  7095           AM-CONTROL-PRIMARY,
  7096           DFHEIV99,
  7097           DFHEIV99
  7098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7099
  7100
  7101     MOVE PI-ACCT-ID             TO  FILE-ID.
  7102
  7103     PERFORM 8400-LOG-JOURNAL-RECORD.
  7104
  7105     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  7106         NEXT SENTENCE
  7107     ELSE
  7108         PERFORM 4950-ADD-ERPLAN-RECORD THRU 4959-EXIT
  7109         PERFORM 4960-ADD-ERCOMP-RECORD THRU 4969-EXIT.
  7110
  7111 4580-DUPREC.
  7112     MOVE 1                  TO K-WITH-LINE-USED.
  7113     MOVE LOW-VALUES         TO EL650AI.
  7114
  7115     GO TO 4590-SHOW-NEW-ACCOUNT.
  7116
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 146
* EL650.cbl
  7118 4950-ADD-ERPLAN-RECORD.
  7119
  7120* EXEC CICS GETMAIN
  7121*        LENGTH   (PLAN-REC-LEN)
  7122*        SET      (ADDRESS OF PLAN-MASTER)
  7123*        INITIMG  (GETMAIN-SPACE)
  7124*    END-EXEC.
  7125*    MOVE ',"IL                  $   #00006536' TO DFHEIV0
  7126     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7127     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7128     MOVE X'2020233030303036353336' TO DFHEIV0(25:11)
  7129     CALL 'kxdfhei1' USING DFHEIV0,
  7130           DFHEIV20,
  7131           PLAN-REC-LEN,
  7132           GETMAIN-SPACE
  7133     SET ADDRESS OF PLAN-MASTER TO
  7134         DFHEIV20
  7135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7136
  7137
  7138
  7139* EXEC CICS  HANDLE CONDITION
  7140*        DUPREC   (4959-EXIT)
  7141*        DUPKEY   (4959-EXIT)
  7142*    END-EXEC.
  7143*    MOVE '"$%$                  ! , #00006542' TO DFHEIV0
  7144     MOVE X'222425242020202020202020' TO DFHEIV0(1:12)
  7145     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7146     MOVE X'2C20233030303036353432' TO DFHEIV0(25:11)
  7147     CALL 'kxdfhei1' USING DFHEIV0
  7148     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7149
  7150
  7151     MOVE NEW-KEY-SAVE           TO  PL-CONTROL-PRIMARY.
  7152
  7153     MOVE EK-BTYPE               TO  PL-BENEFIT-TYPE.
  7154     MOVE EK-BCODE               TO  PL-BENEFIT-CODE.
  7155     MOVE EK-REVISION            TO  PL-REVISION-NO.
  7156
  7157     MOVE PL-CONTROL-PRIMARY     TO  PL-CONTROL-BY-VAR-GRP.
  7158
  7159
  7160* EXEC CICS  WRITE
  7161*        DATASET  (PLAN-FILE-ID)
  7162*        RIDFLD   (PL-CONTROL-PRIMARY)
  7163*        FROM     (PLAN-MASTER)
  7164*    END-EXEC.
  7165     MOVE LENGTH OF
  7166      PLAN-MASTER
  7167       TO DFHEIV11
  7168*    MOVE '&$ L                  ''   #00006555' TO DFHEIV0
  7169     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7170     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7171     MOVE X'2020233030303036353535' TO DFHEIV0(25:11)
  7172     CALL 'kxdfhei1' USING DFHEIV0,
  7173           PLAN-FILE-ID,
  7174           PLAN-MASTER,
  7175           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 147
* EL650.cbl
  7176           PL-CONTROL-PRIMARY,
  7177           DFHEIV99,
  7178           DFHEIV99
  7179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7180
  7181
  7182 4959-EXIT.
  7183     EXIT.
  7184
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 148
* EL650.cbl
  7186 4960-ADD-ERCOMP-RECORD.
  7187
  7188* EXEC CICS GETMAIN
  7189*         LENGTH   (COMP-REC-LEN)
  7190*         SET      (ADDRESS OF COMPENSATION-MASTER)
  7191*         INITIMG  (GETMAIN-SPACE)
  7192*    END-EXEC.
  7193*    MOVE ',"IL                  $   #00006566' TO DFHEIV0
  7194     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7195     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7196     MOVE X'2020233030303036353636' TO DFHEIV0(25:11)
  7197     CALL 'kxdfhei1' USING DFHEIV0,
  7198           DFHEIV20,
  7199           COMP-REC-LEN,
  7200           GETMAIN-SPACE
  7201     SET ADDRESS OF COMPENSATION-MASTER TO
  7202         DFHEIV20
  7203     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7204
  7205
  7206     MOVE SPACES                 TO COMPENSATION-MASTER.
  7207     MOVE ZEROS TO CO-BAL-FWD      CO-CUR-COM   CO-CUR-CHG
  7208                   CO-CUR-PMT      CO-END-BAL   CO-CUR
  7209                   CO-OV30         CO-OV60      CO-OV90
  7210                   CO-YTD-COM      CO-YTD-OV    CO-CUR-OVR-UNDR
  7211                   CO-YTD-OVR-UNDR CO-CUR-FICA CO-YTD-FICA
  7212                   CO-LF-CLM-AMT   CO-AH-CLM-AMT
  7213                   CO-CURRENT-BAL-FWD CO-CURRENT-CUR-COM
  7214                   CO-CURRENT-CUR-CHG CO-CURRENT-END-BAL
  7215                   CO-CURRENT-CUR     CO-CURRENT-OV30
  7216                   CO-CURRENT-OV60    CO-CURRENT-OV90
  7217                   CO-CURRENT-CUR-PMT
  7218                   CO-CURRENT-YTD-COM CO-CURRENT-YTD-OV
  7219                   CO-ACT-YEAR        CO-ACT-MONTH
  7220                   CO-ACT-DAY         CO-LAST-STMT-YEAR
  7221                   CO-LAST-STMT-MONTH CO-LAST-STMT-DAY
  7222                   CO-CURRENT-LAST-STMT-YEAR
  7223                   CO-CURRENT-LAST-STMT-MONTH
  7224                   CO-CURRENT-LAST-STMT-DAY
  7225                   CO-YTD-PAID-COM
  7226                   CO-YTD-PAID-OV co-ov120 co-current-ov120
  7227     MOVE BIN-CURRENT-SAVE       TO CO-LAST-MAINT-DT.
  7228     MOVE PI-PROCESSOR-ID        TO CO-LAST-MAINT-USER.
  7229     MOVE EIBTIME                TO CO-LAST-MAINT-HHMMSS.
  7230     MOVE PI-CR-MONTH-END-DT     TO CO-ROLADEX-PRINT-DT.
  7231     MOVE PI-COMPANY-CD          TO CO-COMPANY-CD.
  7232
  7233     IF PI-ZERO-CARRIER OR PI-ZERO-CAR-GROUP
  7234         MOVE ZEROS              TO CO-CARRIER
  7235     ELSE
  7236         MOVE AM-CARRIER         TO CO-CARRIER.
  7237
  7238     IF PI-ZERO-GROUPING OR PI-ZERO-CAR-GROUP
  7239         MOVE ZEROS              TO CO-GROUPING
  7240     ELSE
  7241         MOVE AM-GROUPING        TO CO-GROUPING.
  7242
  7243     MOVE 'A'                    TO CO-TYPE.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 149
* EL650.cbl
  7244     MOVE AM-NAME                TO CO-ACCT-NAME.
  7245     MOVE AM-PERSON              TO CO-MAIL-NAME.
  7246     MOVE AM-ADDRS               TO CO-ADDR-1.
  7247*    MOVE AM-CITY                TO CO-ADDR-3.
  7248     MOVE AM-ADDR-CITY           TO CO-ADDR-CITY
  7249     MOVE AM-ADDR-STATE          TO CO-ADDR-STATE
  7250     MOVE AM-ZIP                 TO CO-ZIP.
  7251     MOVE AM-CSR-CODE            TO CO-CSR-CODE.
  7252     MOVE AM-TEL-NO              TO CO-TELEPHONE.
  7253     MOVE AM-ID-NO               TO CO-SOC-SEC.
  7254
  7255     IF AM-REMIT-TO NOT = ZERO
  7256         MOVE AM-AGT (AM-REMIT-TO) TO CO-RESP-NO
  7257       ELSE
  7258         MOVE AM-ACCOUNT           TO CO-RESP-NO.
  7259
  7260     MOVE +0                      TO AGT-SUB.
  7261
  7262     PERFORM 4970-FIND-C-AGT THRU 4970-EXIT.
  7263
  7264     IF VALID-AGT-SW = 'Y'
  7265         NEXT SENTENCE
  7266     ELSE
  7267         GO TO 4969-EXIT.
  7268
  7269     IF CO-RESP-NO = CO-ACCOUNT
  7270         MOVE 'Y'                  TO CO-BALANCE-CONTROL
  7271     ELSE
  7272         MOVE 'N'                  TO CO-BALANCE-CONTROL.
  7273
  7274     IF PI-AR-PROCESSING
  7275        MOVE 'G'                   TO CO-AR-REPORTING
  7276        MOVE '1'                   TO CO-AR-BAL-LEVEL
  7277        MOVE 'Y'                   TO CO-AR-PULL-CHECK
  7278        MOVE 'Y'                   TO CO-AR-NORMAL-PRINT.
  7279
  7280     IF PI-COMPANY-ID = 'CRI' OR 'HER' OR 'HSL'
  7281        MOVE 'N'                   TO CO-AR-REPORTING.
  7282
  7283     IF PI-COMPANY-ID = 'HER' OR 'HSL'
  7284        MOVE '999999'              TO CO-AR-SUMMARY-CODE.
  7285
  7286     PERFORM 4980-ADD-COMPENSATION-NAME THRU 4980-EXIT.
  7287
  7288
  7289* EXEC CICS HANDLE CONDITION
  7290*         DUPREC   (4969-EXIT)
  7291*         DUPKEY   (4969-EXIT)
  7292*    END-EXEC.
  7293*    MOVE '"$%$                  ! - #00006654' TO DFHEIV0
  7294     MOVE X'222425242020202020202020' TO DFHEIV0(1:12)
  7295     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7296     MOVE X'2D20233030303036363534' TO DFHEIV0(25:11)
  7297     CALL 'kxdfhei1' USING DFHEIV0
  7298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7299
  7300
  7301
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 150
* EL650.cbl
  7302* EXEC CICS WRITE
  7303*        FROM      (COMPENSATION-MASTER)
  7304*        RIDFLD    (CO-CONTROL-PRIMARY)
  7305*        DATASET   (COMP-FILE-ID)
  7306*    END-EXEC.
  7307     MOVE LENGTH OF
  7308      COMPENSATION-MASTER
  7309       TO DFHEIV11
  7310*    MOVE '&$ L                  ''   #00006659' TO DFHEIV0
  7311     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7312     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7313     MOVE X'2020233030303036363539' TO DFHEIV0(25:11)
  7314     CALL 'kxdfhei1' USING DFHEIV0,
  7315           COMP-FILE-ID,
  7316           COMPENSATION-MASTER,
  7317           DFHEIV11,
  7318           CO-CONTROL-PRIMARY,
  7319           DFHEIV99,
  7320           DFHEIV99
  7321     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7322
  7323
  7324 4969-EXIT.
  7325     EXIT.
  7326
  7327 4970-FIND-C-AGT.
  7328     ADD 1 TO  AGT-SUB.
  7329     IF AGT-SUB GREATER 10
  7330         MOVE 'N'                TO  VALID-AGT-SW
  7331         GO TO 4970-EXIT.
  7332
  7333     IF (AM-COM-TYP (AGT-SUB) = 'C' OR 'D' OR 'F' OR 'S')
  7334         MOVE AM-AGT (AGT-SUB)   TO  CO-ACCOUNT
  7335         MOVE 'Y'                TO  VALID-AGT-SW
  7336         GO TO 4970-EXIT
  7337     ELSE
  7338         GO TO 4970-FIND-C-AGT.
  7339
  7340 4970-EXIT.
  7341     EXIT.
  7342
  7343 4980-ADD-COMPENSATION-NAME.
  7344
  7345* EXEC CICS HANDLE CONDITION
  7346*         DUPREC   (4980-EXIT)
  7347*    END-EXEC.
  7348*    MOVE '"$%                   ! . #00006685' TO DFHEIV0
  7349     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7350     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7351     MOVE X'2E20233030303036363835' TO DFHEIV0(25:11)
  7352     CALL 'kxdfhei1' USING DFHEIV0
  7353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7354
  7355
  7356
  7357* EXEC CICS GETMAIN
  7358*         LENGTH   (NAME-REC-LEN)
  7359*         SET      (ADDRESS OF NAME-LOOKUP-MASTER)
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 151
* EL650.cbl
  7360*         INITIMG  (GETMAIN-SPACE)
  7361*    END-EXEC.
  7362*    MOVE ',"IL                  $   #00006689' TO DFHEIV0
  7363     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7364     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7365     MOVE X'2020233030303036363839' TO DFHEIV0(25:11)
  7366     CALL 'kxdfhei1' USING DFHEIV0,
  7367           DFHEIV20,
  7368           NAME-REC-LEN,
  7369           GETMAIN-SPACE
  7370     SET ADDRESS OF NAME-LOOKUP-MASTER TO
  7371         DFHEIV20
  7372     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7373
  7374
  7375     MOVE SPACES                 TO  NAME-LOOKUP-MASTER.
  7376     MOVE BIN-CURRENT-SAVE       TO  NL-LAST-MAINT-DT.
  7377     MOVE PI-PROCESSOR-ID        TO  NL-LAST-MAINT-USER.
  7378     MOVE EIBTIME                TO  NL-LAST-MAINT-HHMMSS.
  7379     MOVE PI-COMPANY-CD          TO  NL-COMPANY-CD.
  7380     MOVE CO-ACCT-NAME           TO  NL-NAME.
  7381     MOVE CO-ADDR-CITY           TO  NL-CITY
  7382     MOVE CO-ADDR-STATE          TO  NL-ST
  7383     MOVE 'C'                    TO  NL-RECORD-TYPE.
  7384     MOVE PI-COMPANY-CD          TO  NL-CO-COMPANY-CD.
  7385     MOVE CO-CARRIER             TO  NL-CO-CARRIER.
  7386     MOVE CO-GROUPING            TO  NL-CO-GROUPING.
  7387     MOVE CO-RESP-NO             TO  NL-CO-RESP-NO.
  7388     MOVE CO-ACCOUNT             TO  NL-CO-ACCOUNT.
  7389     MOVE CO-TYPE                TO  NL-CO-TYPE.
  7390
  7391
  7392* EXEC CICS WRITE
  7393*        FROM      (NAME-LOOKUP-MASTER)
  7394*        RIDFLD    (NL-CONTROL-PRIMARY)
  7395*        DATASET   (NAME-FILE-ID)
  7396*    END-EXEC.
  7397     MOVE LENGTH OF
  7398      NAME-LOOKUP-MASTER
  7399       TO DFHEIV11
  7400*    MOVE '&$ L                  ''   #00006711' TO DFHEIV0
  7401     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7402     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7403     MOVE X'2020233030303036373131' TO DFHEIV0(25:11)
  7404     CALL 'kxdfhei1' USING DFHEIV0,
  7405           NAME-FILE-ID,
  7406           NAME-LOOKUP-MASTER,
  7407           DFHEIV11,
  7408           NL-CONTROL-PRIMARY,
  7409           DFHEIV99,
  7410           DFHEIV99
  7411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7412
  7413
  7414 4980-EXIT.
  7415     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 152
* EL650.cbl
  7417 5000-CREATE-NEW-RANGE.
  7418
  7419     PERFORM 6100-BUILD-KEY  THRU  6199-EXIT.
  7420     PERFORM 6200-CHECK-KEY  THRU  6200-EXIT.
  7421
  7422     PERFORM 6000-EDIT-EFFECTIVE-DATE  THRU 6000-EFF-EXIT.
  7423     PERFORM 6000-EDIT-EXPIRATION-DATE THRU 6000-EXP-EXIT.
  7424
  7425     SET T-INDEX TO PI-TOTAL-LINES.
  7426
  7427     PERFORM 600A-CHECK-HI-LO-DATES    THRU 600A-EXIT
  7428        VARYING T-INDEX FROM T-INDEX BY +1
  7429         UNTIL  T-INDEX GREATER PI-TOTAL-LINES.
  7430
  7431     IF NOT EMI-NO-ERRORS
  7432         GO TO 8200-SEND-DATAONLY.
  7433
  7434     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  7435     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  7436
  7437     IF BIN-EFFCHG-SAVE NOT LESS BIN-EXPCHG-SAVE
  7438         MOVE -1                 TO  EFFCHGL EXPCHGL
  7439         MOVE AL-UANON           TO  EFFCHGA EXPCHGA
  7440         MOVE ER-2053            TO  EMI-ERROR
  7441         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7442
  7443     IF NOT EMI-NO-ERRORS
  7444         GO TO 8200-SEND-DATAONLY.
  7445
  7446***************************************************************
  7447*    NO EFFECTIVE DATE ENTERED, WILL USE CURRENT EXPIRATION   *
  7448*    DATE IF WITHIN LIMITS                                    *
  7449***************************************************************
  7450
  7451     IF EFFCHGL = ZERO
  7452         SET T-INDEX             TO  PI-TOTAL-LINES
  7453         IF PI-BIN-EXP-DT (T-INDEX)  =  HIGH-VALUES
  7454             MOVE ER-2060        TO  EMI-ERROR
  7455             MOVE -1             TO  EFFCHGL
  7456             MOVE AL-UABON       TO  EFFCHGA
  7457             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7458             GO TO 8200-SEND-DATAONLY
  7459         ELSE
  7460             IF PI-BIN-EXP-DT (T-INDEX) NOT LESS
  7461                    BIN-EXPCHG-SAVE
  7462                 MOVE ER-2061    TO  EMI-ERROR
  7463                 MOVE -1         TO  EXPCHGL
  7464                 MOVE AL-UABON   TO  EXPCHGA
  7465                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7466                 GO TO 8200-SEND-DATAONLY.
  7467
  7468     PERFORM 4100-BUILD-VERIFICATION  THRU  4199-EXIT.
  7469
  7470*    display ' VERI TABLE BEFORE '
  7471*    perform 4220-DISPLAY-VERI-TABLE
  7472*                                thru 4220-exit
  7473     IF EFFCHGL = ZERO
  7474         MOVE PI-BIN-EXP-DT (T-INDEX)
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 153
* EL650.cbl
  7475                                 TO WS-ACCT-EFF-DT (WS-INDEX)
  7476         MOVE BIN-EXPCHG-SAVE    TO WS-ACCT-EXP-DT (WS-INDEX)
  7477     ELSE
  7478         MOVE BIN-EFFCHG-SAVE    TO WS-ACCT-EFF-DT (WS-INDEX)
  7479                                    WS-ACCT-EXP-DT (WS-INDEX - 1)
  7480         MOVE BIN-EXPCHG-SAVE    TO WS-ACCT-EXP-DT (WS-INDEX).
  7481
  7482*    display ' VERI TABLE AFTER  '
  7483*    perform 4220-DISPLAY-VERI-TABLE
  7484*                                thru 4220-exit
  7485     PERFORM 4300-VERIFY-INTEGRITY  THRU  4399-EXIT
  7486         VARYING  WS-INDEX  FROM  +1  BY  +1
  7487           UNTIL  WS-INDEX  GREATER +32.
  7488
  7489     IF NOT EMI-NO-ERRORS
  7490         GO TO 8200-SEND-DATAONLY.
  7491
  7492     IF EFFCHGL  =  ZEROS
  7493         MOVE PI-BIN-EXP-DT (T-INDEX)
  7494                                  TO  PI-ACCT-EXP-DT
  7495                                      BIN-EFFCHG-SAVE
  7496                                      DC-BIN-DATE-1
  7497         MOVE SPACE               TO  DC-OPTION-CODE
  7498         PERFORM 9700-DATE-CONVERSION
  7499***  Y2K PROJ 7744
  7500         MOVE DC-GREG-DATE-1-YMD  TO  WS-EFFCHG-SAVE
  7501         MOVE DC-ALPHA-CENTURY    TO  WS-EFFCHG-SAVE(4:2)
  7502         MOVE WS-EFFCHG-SAVE      TO  EFFCHG-SAVE
  7503
  7504         PERFORM 5020-READ-PREV-REC
  7505         PERFORM 5050-CREATE-NEW-REC  THRU  5050-EXIT
  7506         GO TO 5005-EXIT
  7507     END-IF.
  7508***  Y2K PROJ 7744
  7509
  7510     IF NOT EMI-NO-ERRORS
  7511         GO TO 8200-SEND-DATAONLY.
  7512
  7513     SET T-INDEX  TO  PI-TOTAL-LINES.
  7514
  7515*    IF (EFFCHGL GREATER THAN +0) AND
  7516*       (EXPCHGL GREATER THAN +0)
  7517*       IF (PI-BIN-EXP-DT (T-INDEX) EQUAL HIGH-VALUES) AND
  7518*          (BIN-EXPCHG-SAVE EQUAL HIGH-VALUES)
  7519*          NEXT SENTENCE
  7520*       ELSE
  7521*          GO TO 5006-FIND-EXP-DATE.
  7522*
  7523
  7524
  7525***************************************************************
  7526*    EFFECTIVE DATE ENTERED, WILL REPLACE CURRENT EXPIRATION  *
  7527*    DATE IF ALL NINES AND CREATE NEW RANGE                   *
  7528***************************************************************
  7529     SET T-INDEX  TO  PI-TOTAL-LINES.
  7530
  7531     IF BROWSE-STARTED-SW EQUAL 'Y'
  7532        PERFORM 6320-ENDBR THRU 6320-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 154
* EL650.cbl
  7533
  7534     IF PI-BIN-EXP-DT (T-INDEX)  = HIGH-VALUES
  7535         IF PI-BIN-EFF-DT (T-INDEX) NOT LESS BIN-EFFCHG-SAVE
  7536             MOVE ER-2063             TO  EMI-ERROR
  7537             MOVE -1                  TO  EFFCHGL
  7538             MOVE AL-UABON            TO  EFFCHGA
  7539             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7540             GO TO 8200-SEND-DATAONLY
  7541         ELSE
  7542             MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT
  7543             MOVE LOW-VALUES              TO  PI-ACCT-REST-OF-EXP
  7544             MOVE PI-ACCT-KEY         TO  B4-ACCT-KEY
  7545             MOVE PI-BIN-EFF-DT (T-INDEX)
  7546                                      TO  B4-ACCT-EFF-DT
  7547             PERFORM 3100-DELETE-DATE-RANGE  THRU  3199-EXIT
  7548             MOVE BIN-EFFCHG-SAVE     TO  AM-EXPIRATION-DT
  7549                                          AM-VG-EXPIRATION-DT
  7550                                          PI-BIN-EXP-DT
  7551                                                    (T-INDEX)
  7552             MOVE AM-CONTROL-PRIMARY  TO  AF-ACCT-KEY
  7553             MOVE AM-EFFECTIVE-DT     TO  AF-ACCT-EFF-DT
  7554             PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT
  7555             PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT
  7556             PERFORM 5050-CREATE-NEW-REC    THRU  5050-EXIT
  7557             GO TO 5005-EXIT.
  7558
  7559***************************************************************
  7560*    EFFECTIVE DATE ENTERED, CHECK TO ENSURE EFFECTIVE        *
  7561*    DATE GREATER PREVIOUS EXPIRATION DATE                    *
  7562***************************************************************
  7563     SET T-INDEX  TO  PI-TOTAL-LINES.
  7564
  7565     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  7566     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  7567
  7568     IF BIN-EFFCHG-SAVE LESS PI-BIN-EXP-DT (T-INDEX)
  7569         PERFORM 5010-CHECK-VALID-NEW-RANGE  THRU  5010-EXIT
  7570     ELSE
  7571         PERFORM 5020-READ-PREV-REC
  7572         PERFORM 5050-CREATE-NEW-REC  THRU  5050-EXIT.
  7573
  7574 5005-EXIT.
  7575     MOVE SPACES                 TO  EFFCHGO
  7576                                     EXPCHGI.
  7577     MOVE AL-UANOF               TO  EFFCHGA
  7578                                     EXPCHGA.
  7579     MOVE ER-0000                TO  EMI-ERROR.
  7580
  7581     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7582
  7583     GO TO 7000-BUILD-OUTPUT-MAP.
  7584
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 155
* EL650.cbl
  7586 5006-FIND-EXP-DATE.
  7587     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  7588                                     PI-ACCT-REST-OF-EXP.
  7589     PERFORM 6300-STARTBR  THRU  6300-EXIT.
  7590
  7591     PERFORM 6310-READNEXT  THRU  6310-EXIT
  7592         VARYING  T-INDEX  FROM  +1  BY  +1
  7593           UNTIL  PI-BIN-EXP-DT (T-INDEX)  > BIN-EFFCHG-SAVE.
  7594
  7595     IF BIN-EFFCHG-SAVE > PI-BIN-EXP-DT (T-INDEX)
  7596        MOVE ER-1220             TO  EMI-ERROR
  7597        MOVE -1                  TO  EFFCHGL
  7598        MOVE AL-UABON            TO  EFFCHGA
  7599        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7600        GO TO         8200-SEND-DATAONLY.
  7601
  7602     IF (BIN-EFFCHG-SAVE > PI-BIN-EFF-DT (T-INDEX)) AND
  7603        (BIN-EXPCHG-SAVE < PI-BIN-EXP-DT (T-INDEX))
  7604        PERFORM 5007-CREATE-SUB-DATE-RANGES THRU 5007-EXIT
  7605        MOVE 1 TO PI-PAGE-NUMBER
  7606        GO TO 1000-SHOW-ACCOUNT
  7607     ELSE
  7608     IF (BIN-EFFCHG-SAVE = PI-BIN-EFF-DT (T-INDEX)) AND
  7609        (BIN-EXPCHG-SAVE < PI-BIN-EXP-DT (T-INDEX))
  7610        PERFORM 5008-CREATE-SUB-DATE-RANGES THRU 5008-EXIT
  7611        MOVE 1 TO PI-PAGE-NUMBER
  7612        GO TO 1000-SHOW-ACCOUNT
  7613     ELSE
  7614        MOVE ER-2051             TO  EMI-ERROR
  7615        MOVE -1                  TO  EFFCHGL
  7616        MOVE AL-UABON            TO  EFFCHGA
  7617        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7618        GO TO 8200-SEND-DATAONLY.
  7619
  7620 5006-EXIT. EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 156
* EL650.cbl
  7622 5007-CREATE-SUB-DATE-RANGES.
  7623
  7624     IF BROWSE-STARTED-SW EQUAL 'Y'
  7625        PERFORM 6320-ENDBR THRU 6320-EXIT.
  7626
  7627     IF NOT SYSTEM-MODIFY-CAP
  7628         MOVE 'UPDATE'           TO  SM-READ
  7629         PERFORM 9995-SECURITY-VIOLATION  THRU  9995-EXIT
  7630         MOVE ER-0070            TO  EMI-ERROR
  7631         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7632         GO TO 8100-SEND-INITIAL-MAP.
  7633
  7634
  7635* EXEC CICS GETMAIN
  7636*        LENGTH   (ACCT-REC-LEN)
  7637*        SET      (ADDRESS OF ACCOUNT-MASTER)
  7638*        INITIMG  (GETMAIN-SPACE)
  7639*    END-EXEC.
  7640*    MOVE ',"IL                  $   #00006937' TO DFHEIV0
  7641     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7642     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7643     MOVE X'2020233030303036393337' TO DFHEIV0(25:11)
  7644     CALL 'kxdfhei1' USING DFHEIV0,
  7645           DFHEIV20,
  7646           ACCT-REC-LEN,
  7647           GETMAIN-SPACE
  7648     SET ADDRESS OF ACCOUNT-MASTER TO
  7649         DFHEIV20
  7650     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7651
  7652
  7653
  7654* EXEC CICS  HANDLE CONDITION
  7655*        ENDFILE  (5007-EXIT)
  7656*        NOTFND   (5007-EXIT)
  7657*    END-EXEC.
  7658*    MOVE '"$''I                  ! / #00006943' TO DFHEIV0
  7659     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  7660     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7661     MOVE X'2F20233030303036393433' TO DFHEIV0(25:11)
  7662     CALL 'kxdfhei1' USING DFHEIV0
  7663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7664
  7665
  7666     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  7667     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  7668
  7669
  7670* EXEC CICS  READ
  7671*        UPDATE
  7672*        DATASET  (PI-ACCT-ID)
  7673*        SET      (ADDRESS OF ACCOUNT-MASTER)
  7674*        RIDFLD   (PI-ACCT-KEY)
  7675*    END-EXEC.
  7676*    MOVE '&"S        EU         (   #00006951' TO DFHEIV0
  7677     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7678     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7679     MOVE X'2020233030303036393531' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 157
* EL650.cbl
  7680     CALL 'kxdfhei1' USING DFHEIV0,
  7681           PI-ACCT-ID,
  7682           DFHEIV20,
  7683           DFHEIV99,
  7684           PI-ACCT-KEY,
  7685           DFHEIV99,
  7686           DFHEIV99,
  7687           DFHEIV99
  7688     SET ADDRESS OF ACCOUNT-MASTER TO
  7689         DFHEIV20
  7690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7691
  7692
  7693     MOVE AM-CONTROL-PRIMARY     TO  SAVE-ACCT-KEY.
  7694     MOVE AM-EXPIRATION-DT       TO  SAVE-CURR-EXP-DT.
  7695     MOVE AM-EFFECTIVE-DT        TO  SAVE-CURR-EFF-DT.
  7696     MOVE AM-CONTROL-PRIMARY     TO  AF-ACCT-KEY.
  7697     MOVE AM-EXPIRATION-DT       TO  AF-ACCT-EFF-DT.
  7698     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT
  7699     MOVE 'C'                    TO  JP-RECORD-TYPE.
  7700     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  7701     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  7702
  7703     MOVE BIN-EXPCHG-SAVE     TO  AM-EFFECTIVE-DT
  7704                                  PI-BIN-EFF-DT (T-INDEX).
  7705
  7706* EXEC CICS  REWRITE
  7707*        FROM     (ACCOUNT-MASTER)
  7708*        DATASET  (PI-ACCT-ID)
  7709*    END-EXEC.
  7710     MOVE LENGTH OF
  7711      ACCOUNT-MASTER
  7712       TO DFHEIV11
  7713*    MOVE '&& L                  %   #00006970' TO DFHEIV0
  7714     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7715     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7716     MOVE X'2020233030303036393730' TO DFHEIV0(25:11)
  7717     CALL 'kxdfhei1' USING DFHEIV0,
  7718           PI-ACCT-ID,
  7719           ACCOUNT-MASTER,
  7720           DFHEIV11,
  7721           DFHEIV99
  7722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7723
  7724
  7725
  7726* EXEC CICS SYNCPOINT
  7727*    END-EXEC.
  7728*    MOVE '6"                    !   #00006975' TO DFHEIV0
  7729     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  7730     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7731     MOVE X'2020233030303036393735' TO DFHEIV0(25:11)
  7732     CALL 'kxdfhei1' USING DFHEIV0
  7733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7734
  7735
  7736     PERFORM 8400-LOG-JOURNAL-RECORD.
  7737     PERFORM 6600-UPDATE-MAINT-DT  THRU  6699-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 158
* EL650.cbl
  7738     MOVE SAVE-ACCT-KEY       TO  AM-CONTROL-PRIMARY.
  7739     MOVE LOW-VALUES          TO  AM-CNTRL-B.
  7740     MOVE SAVE-CURR-EFF-DT    TO  PI-BIN-EFF-DT (T-INDEX)
  7741                                  AM-EFFECTIVE-DT.
  7742     MOVE BIN-EFFCHG-SAVE     TO  PI-BIN-EXP-DT (T-INDEX)
  7743                                  AM-EXPIRATION-DT
  7744                                  AM-VG-EXPIRATION-DT.
  7745     MOVE BIN-CURRENT-SAVE    TO  AM-LAST-MAINT-DT
  7746                                  PI-BIN-MAINT-DT (T-INDEX).
  7747     MOVE AM-CONTROL-PRIMARY  TO  AF-ACCT-KEY.
  7748     MOVE AM-EFFECTIVE-DT     TO  AF-ACCT-EFF-DT.
  7749     MOVE LOW-VALUES          TO  AM-AR-HI-CERT-DATE
  7750     MOVE SPACES              TO  AM-1ST-PROD-DATE
  7751                                  AM-PREV-DATES.
  7752     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  7753
  7754
  7755* EXEC CICS  HANDLE CONDITION
  7756*        ENDFILE  (5007-EXIT)
  7757*        NOTFND   (5007-EXIT)
  7758*        DUPREC   (5007-EXIT)
  7759*        ILLOGIC  (5007-EXIT)
  7760*        INVREQ   (5007-EXIT)
  7761*    END-EXEC.
  7762*    MOVE '"$''I%38               ! 0 #00006996' TO DFHEIV0
  7763     MOVE X'222427492533382020202020' TO DFHEIV0(1:12)
  7764     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7765     MOVE X'3020233030303036393936' TO DFHEIV0(25:11)
  7766     CALL 'kxdfhei1' USING DFHEIV0
  7767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7768
  7769
  7770     MOVE 'AM'                TO AM-RECORD-ID.
  7771
  7772     PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT.
  7773     PERFORM 8400-LOG-JOURNAL-RECORD.
  7774     PERFORM 6600-UPDATE-MAINT-DT   THRU  6699-EXIT.
  7775
  7776     MOVE SAVE-ACCT-KEY       TO  AM-CONTROL-PRIMARY.
  7777     MOVE BIN-EFFCHG-SAVE     TO  AM-EFFECTIVE-DT
  7778                                  PI-BIN-EFF-DT (T-INDEX).
  7779     MOVE BIN-EXPCHG-SAVE     TO  PI-BIN-EXP-DT (T-INDEX)
  7780                                  AM-EXPIRATION-DT
  7781                                  AM-VG-EXPIRATION-DT.
  7782     MOVE BIN-CURRENT-SAVE    TO  AM-LAST-MAINT-DT
  7783                                  PI-BIN-MAINT-DT (T-INDEX).
  7784     MOVE LOW-VALUES          TO  AM-AR-HI-CERT-DATE
  7785     MOVE SPACES              TO  AM-1ST-PROD-DATE
  7786                                  AM-PREV-DATES.
  7787     MOVE AM-CONTROL-PRIMARY  TO  AF-ACCT-KEY.
  7788     MOVE AM-EFFECTIVE-DT     TO  AF-ACCT-EFF-DT.
  7789     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  7790     PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT.
  7791     PERFORM 8400-LOG-JOURNAL-RECORD.
  7792     PERFORM 6600-UPDATE-MAINT-DT   THRU  6699-EXIT.
  7793
  7794     MOVE ZERO                TO EFFCHGL
  7795                                 EXPCHGL.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 159
* EL650.cbl
  7796
  7797
  7798* EXEC CICS  HANDLE CONDITION
  7799*         NOTFND   (5015-NOT-FOUND)
  7800*         ENDFILE  (5015-NOT-FOUND)
  7801*    END-EXEC.
  7802*    MOVE '"$I''                  ! 1 #00007031' TO DFHEIV0
  7803     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7804     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7805     MOVE X'3120233030303037303331' TO DFHEIV0(25:11)
  7806     CALL 'kxdfhei1' USING DFHEIV0
  7807     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7808
  7809
  7810 5007-EXIT. EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 160
* EL650.cbl
  7812 5008-CREATE-SUB-DATE-RANGES.
  7813
  7814     IF BROWSE-STARTED-SW EQUAL 'Y'
  7815        PERFORM 6320-ENDBR THRU 6320-EXIT.
  7816
  7817     IF NOT SYSTEM-MODIFY-CAP
  7818         MOVE 'UPDATE'           TO  SM-READ
  7819         PERFORM 9995-SECURITY-VIOLATION  THRU  9995-EXIT
  7820         MOVE ER-0070            TO  EMI-ERROR
  7821         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7822         GO TO 8100-SEND-INITIAL-MAP.
  7823
  7824     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  7825     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  7826     MOVE PI-ACCT-KEY              TO  B4-ACCT-KEY.
  7827     MOVE PI-BIN-EFF-DT (T-INDEX)  TO  B4-ACCT-EFF-DT.
  7828
  7829     PERFORM 3100-DELETE-DATE-RANGE  THRU  3199-EXIT.
  7830
  7831     MOVE BIN-EXPCHG-SAVE        TO  AM-EXPIRATION-DT
  7832                                     AM-VG-EXPIRATION-DT
  7833                                     PI-BIN-EXP-DT (T-INDEX).
  7834     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT
  7835                                     PI-BIN-MAINT-DT (T-INDEX).
  7836     MOVE AM-CONTROL-PRIMARY     TO  AF-ACCT-KEY.
  7837     MOVE AM-EFFECTIVE-DT        TO  AF-ACCT-EFF-DT.
  7838
  7839     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  7840
  7841     PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT.
  7842
  7843     PERFORM 6600-UPDATE-MAINT-DT   THRU  6699-EXIT.
  7844
  7845     IF T-INDEX = PI-TOTAL-LINES
  7846        MOVE ZERO             TO EFFCHGL
  7847                                 EXPCHGL
  7848        GO TO 5008-EXIT.
  7849
  7850     MOVE BIN-EXPCHG-SAVE        TO  PI-ACCT-EXP-DT
  7851     MOVE LOW-VALUES             TO  PI-ACCT-REST-OF-EXP.
  7852     PERFORM 6300-STARTBR  THRU  6300-EXIT.
  7853
  7854     PERFORM 6310-READNEXT  THRU  6310-EXIT.
  7855
  7856     PERFORM 6310-READNEXT  THRU  6310-EXIT
  7857         VARYING  T-INDEX  FROM T-INDEX  BY  +1
  7858           UNTIL  PI-BIN-EXP-DT (T-INDEX)  > BIN-EXPCHG-SAVE.
  7859
  7860     IF BROWSE-STARTED-SW EQUAL 'Y'
  7861        PERFORM 6320-ENDBR THRU 6320-EXIT.
  7862
  7863
  7864* EXEC CICS  READ
  7865*        UPDATE
  7866*        DATASET  (PI-ACCT-ID)
  7867*        SET      (ADDRESS OF ACCOUNT-MASTER)
  7868*        RIDFLD   (PI-ACCT-KEY)
  7869*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 161
* EL650.cbl
  7870*    MOVE '&"S        EU         (   #00007089' TO DFHEIV0
  7871     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7872     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7873     MOVE X'2020233030303037303839' TO DFHEIV0(25:11)
  7874     CALL 'kxdfhei1' USING DFHEIV0,
  7875           PI-ACCT-ID,
  7876           DFHEIV20,
  7877           DFHEIV99,
  7878           PI-ACCT-KEY,
  7879           DFHEIV99,
  7880           DFHEIV99,
  7881           DFHEIV99
  7882     SET ADDRESS OF ACCOUNT-MASTER TO
  7883         DFHEIV20
  7884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7885
  7886
  7887     MOVE 'B'                    TO  JP-RECORD-TYPE.
  7888     MOVE ACCT-FILE-ID           TO  FILE-ID.
  7889     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  7890
  7891     PERFORM 8400-LOG-JOURNAL-RECORD.
  7892
  7893     MOVE BIN-EXPCHG-SAVE        TO  AM-EFFECTIVE-DT
  7894                                     PI-BIN-EFF-DT (T-INDEX).
  7895     MOVE EXPCHG-SAVE            TO  AM-EFFECT-DT.
  7896     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT
  7897                                     PI-BIN-MAINT-DT (T-INDEX).
  7898     MOVE AM-CONTROL-PRIMARY     TO  AF-ACCT-KEY.
  7899     MOVE AM-EFFECTIVE-DT        TO  AF-ACCT-EFF-DT.
  7900     MOVE 'C'                    TO  JP-RECORD-TYPE.
  7901     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  7902
  7903     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  7904
  7905
  7906* EXEC CICS  REWRITE
  7907*        FROM     (ACCOUNT-MASTER)
  7908*        DATASET  (PI-ACCT-ID)
  7909*    END-EXEC.
  7910     MOVE LENGTH OF
  7911      ACCOUNT-MASTER
  7912       TO DFHEIV11
  7913*    MOVE '&& L                  %   #00007114' TO DFHEIV0
  7914     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7915     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7916     MOVE X'2020233030303037313134' TO DFHEIV0(25:11)
  7917     CALL 'kxdfhei1' USING DFHEIV0,
  7918           PI-ACCT-ID,
  7919           ACCOUNT-MASTER,
  7920           DFHEIV11,
  7921           DFHEIV99
  7922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7923
  7924
  7925     PERFORM 8400-LOG-JOURNAL-RECORD.
  7926
  7927     PERFORM 6600-UPDATE-MAINT-DT  THRU  6699-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 162
* EL650.cbl
  7928
  7929
  7930
  7931     MOVE ZERO                TO EFFCHGL
  7932                                 EXPCHGL.
  7933
  7934
  7935* EXEC CICS  HANDLE CONDITION
  7936*         NOTFND   (5015-NOT-FOUND)
  7937*         ENDFILE  (5015-NOT-FOUND)
  7938*    END-EXEC.
  7939*    MOVE '"$I''                  ! 2 #00007128' TO DFHEIV0
  7940     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7941     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7942     MOVE X'3220233030303037313238' TO DFHEIV0(25:11)
  7943     CALL 'kxdfhei1' USING DFHEIV0
  7944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7945
  7946
  7947 5008-EXIT. EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 163
* EL650.cbl
  7949 5010-CHECK-VALID-NEW-RANGE.
  7950
  7951***************************************************************
  7952*    THIS PARAGRAPH ALLOWS YOU TO EXPIRE A RANGE PRIOR TO HI  *
  7953*    CERT DATE AS LONG AS A NEW RANGE IS BEING CREATED        *
  7954***************************************************************
  7955
  7956     IF PI-AR-PROCESSING
  7957        GO TO 5010-CHECK-AR-VALID-NEW-RANGE.
  7958
  7959     IF BIN-EXPCHG-SAVE GREATER PI-BIN-EXP-DT (T-INDEX)  AND
  7960                        GREATER BIN-EFFCHG-SAVE          AND
  7961                        GREATER PI-BIN-HI-CERT (T-INDEX)
  7962         MOVE PI-BIN-EXP-DT (T-INDEX)
  7963                                  TO  PI-ACCT-EXP-DT
  7964         MOVE LOW-VALUES          TO  PI-ACCT-REST-OF-EXP
  7965         MOVE PI-ACCT-KEY         TO  B4-ACCT-KEY
  7966         MOVE PI-BIN-EFF-DT (T-INDEX)
  7967                                  TO  B4-ACCT-EFF-DT
  7968         PERFORM 3100-DELETE-DATE-RANGE  THRU  3199-EXIT
  7969         MOVE BIN-EFFCHG-SAVE     TO  AM-EXPIRATION-DT
  7970                                      AM-VG-EXPIRATION-DT
  7971                                      PI-BIN-EXP-DT (T-INDEX)
  7972         MOVE BIN-CURRENT-SAVE    TO  PI-BIN-MAINT-DT (T-INDEX)
  7973         MOVE AM-CONTROL-PRIMARY  TO  AF-ACCT-KEY
  7974         MOVE AM-EFFECTIVE-DT     TO  AF-ACCT-EFF-DT
  7975         PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT
  7976         PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT
  7977         PERFORM 5050-CREATE-NEW-REC    THRU  5050-EXIT
  7978     ELSE
  7979         MOVE ER-2051             TO  EMI-ERROR
  7980         MOVE -1                  TO  EFFCHGL
  7981         MOVE AL-UABON            TO  EFFCHGA  EXPCHGA
  7982         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7983         GO TO 8200-SEND-DATAONLY.
  7984
  7985     GO TO 5010-EXIT.
  7986
  7987 5010-CHECK-AR-VALID-NEW-RANGE.
  7988
  7989***************************************************************
  7990*    THIS PARAGRAPH ALLOWS YOU TO EXPIRE A RANGE PRIOR TO HI  *
  7991*    A/R CERT DATE AS LONG AS A NEW RANGE IS BEING CREATED    *
  7992***************************************************************
  7993
  7994     IF BIN-EXPCHG-SAVE GREATER PI-BIN-EXP-DT (T-INDEX)  AND
  7995                        GREATER BIN-EFFCHG-SAVE          AND
  7996                        GREATER PI-BIN-AR-HI-CERT (T-INDEX)
  7997         MOVE PI-BIN-EXP-DT (T-INDEX)
  7998                                  TO  PI-ACCT-EXP-DT
  7999         MOVE LOW-VALUES          TO  PI-ACCT-REST-OF-EXP
  8000         MOVE PI-ACCT-KEY         TO  B4-ACCT-KEY
  8001         MOVE PI-BIN-EFF-DT (T-INDEX)
  8002                                  TO  B4-ACCT-EFF-DT
  8003         PERFORM 3100-DELETE-DATE-RANGE  THRU  3199-EXIT
  8004         MOVE BIN-EFFCHG-SAVE     TO  AM-EXPIRATION-DT
  8005                                      AM-VG-EXPIRATION-DT
  8006                                      PI-BIN-EXP-DT (T-INDEX)
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 164
* EL650.cbl
  8007         MOVE BIN-CURRENT-SAVE    TO  PI-BIN-MAINT-DT (T-INDEX)
  8008         MOVE AM-CONTROL-PRIMARY  TO  AF-ACCT-KEY
  8009         MOVE AM-EFFECTIVE-DT     TO  AF-ACCT-EFF-DT
  8010         PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT
  8011         PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT
  8012         PERFORM 5050-CREATE-NEW-REC    THRU  5050-EXIT
  8013     ELSE
  8014         MOVE ER-2051             TO  EMI-ERROR
  8015         MOVE -1                  TO  EFFCHGL
  8016         MOVE AL-UABON            TO  EFFCHGA  EXPCHGA
  8017         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8018         GO TO 8200-SEND-DATAONLY.
  8019
  8020 5010-EXIT.
  8021     EXIT.
  8022
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 165
* EL650.cbl
  8024 5015-NOT-FOUND.
  8025     MOVE ER-0226                TO  EMI-ERROR.
  8026     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8027     MOVE -1                 TO  MAINTL.
  8028     GO TO 8200-SEND-DATAONLY.
  8029
  8030 5015-EXIT.
  8031     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 166
* EL650.cbl
  8033 5020-READ-PREV-REC.
  8034
  8035* EXEC CICS  READ
  8036*        DATASET  (PI-ACCT-ID)
  8037*        SET      (ADDRESS OF ACCOUNT-MASTER)
  8038*        RIDFLD   (PI-ACCT-KEY)
  8039*    END-EXEC.
  8040*    MOVE '&"S        E          (   #00007220' TO DFHEIV0
  8041     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8042     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8043     MOVE X'2020233030303037323230' TO DFHEIV0(25:11)
  8044     CALL 'kxdfhei1' USING DFHEIV0,
  8045           PI-ACCT-ID,
  8046           DFHEIV20,
  8047           DFHEIV99,
  8048           PI-ACCT-KEY,
  8049           DFHEIV99,
  8050           DFHEIV99,
  8051           DFHEIV99
  8052     SET ADDRESS OF ACCOUNT-MASTER TO
  8053         DFHEIV20
  8054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8055
  8056
  8057 5050-CREATE-NEW-REC.
  8058     MOVE BIN-EFFCHG-SAVE        TO  AM-EFFECTIVE-DT.
  8059     MOVE BIN-EXPCHG-SAVE        TO  AM-EXPIRATION-DT
  8060                                     AM-VG-EXPIRATION-DT.
  8061     MOVE EFFCHG-SAVE            TO  AM-EFFECT-DT.
  8062     MOVE SPACES                 TO  AM-CERTS-PURGED-DATE
  8063                                     AM-1ST-PROD-DATE
  8064                                     AM-PREV-DATES
  8065                                     AM-BILLING-STATUS.
  8066     MOVE ZEROS                  TO  AM-HI-CERT-DATE
  8067                                     AM-LO-CERT-DATE.
  8068
  8069     IF AM-AR-HI-CERT-DATE NOT LESS THAN AM-EFFECTIVE-DT
  8070        NEXT SENTENCE
  8071     ELSE
  8072        MOVE LOW-VALUES          TO  AM-AR-HI-CERT-DATE.
  8073
  8074     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT.
  8075     MOVE PI-PROCESSOR-ID        TO  AM-LAST-MAINT-USER.
  8076     MOVE EIBTIME                TO  AM-LAST-MAINT-HHMMSS.
  8077
  8078     SET T-INDEX  UP  BY  1.
  8079     IF T-INDEX  GREATER 32
  8080         MOVE ER-2062            TO  EMI-ERROR
  8081         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8082         MOVE -1                 TO  MAINTL
  8083         GO TO 8200-SEND-DATAONLY.
  8084
  8085     ADD 1                       TO  PI-TOTAL-LINES.
  8086
  8087     MOVE LOW-VALUES             TO  PI-TABLE-ENT    (T-INDEX).
  8088     MOVE BIN-EFFCHG-SAVE        TO  PI-BIN-EFF-DT   (T-INDEX).
  8089     MOVE BIN-EXPCHG-SAVE        TO  PI-BIN-EXP-DT   (T-INDEX).
  8090     MOVE AM-AR-HI-CERT-DATE     TO  PI-BIN-AR-HI-CERT (T-INDEX).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 167
* EL650.cbl
  8091     MOVE BIN-CURRENT-SAVE       TO  PI-BIN-MAINT-DT (T-INDEX).
  8092
  8093     PERFORM 5500-ADD-NEW-AXRF-RECORD  THRU  5599-EXIT.
  8094
  8095     MOVE 'A'                    TO  JP-RECORD-TYPE.
  8096     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  8097     MOVE ACCT-FILE-ID           TO  FILE-ID.
  8098
  8099
  8100* EXEC CICS  WRITE
  8101*        RIDFLD   (AM-CONTROL-PRIMARY)
  8102*        FROM     (ACCOUNT-MASTER)
  8103*        DATASET  (PI-ACCT-ID)
  8104*    END-EXEC.
  8105     MOVE LENGTH OF
  8106      ACCOUNT-MASTER
  8107       TO DFHEIV11
  8108*    MOVE '&$ L                  ''   #00007268' TO DFHEIV0
  8109     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8110     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8111     MOVE X'2020233030303037323638' TO DFHEIV0(25:11)
  8112     CALL 'kxdfhei1' USING DFHEIV0,
  8113           PI-ACCT-ID,
  8114           ACCOUNT-MASTER,
  8115           DFHEIV11,
  8116           AM-CONTROL-PRIMARY,
  8117           DFHEIV99,
  8118           DFHEIV99
  8119     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8120
  8121
  8122     PERFORM 8400-LOG-JOURNAL-RECORD.
  8123
  8124     PERFORM 6600-UPDATE-MAINT-DT  THRU  6699-EXIT.
  8125
  8126 5050-EXIT.
  8127     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 168
* EL650.cbl
  8129 5100-FIND-NEXT-RANGE.
  8130     MOVE PI-PREV-VG-ACCOUNT     TO  KEY-SAVE.
  8131
  8132     IF PI-TOTAL-LINES  = ZERO
  8133         GO TO 5210-NO-DATA.
  8134
  8135     IF PI-LST-PAGE
  8136       OR (PI-FST-PAGE AND PI-TOTAL-LINES NOT GREATER 8)
  8137       OR (PI-2ND-PAGE AND PI-TOTAL-LINES NOT GREATER 16)
  8138       OR (PI-3RD-PAGE AND PI-TOTAL-LINES NOT GREATER 24)
  8139         MOVE ER-2065            TO  EMI-ERROR
  8140         MOVE -1                 TO  MAINTL
  8141         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8142         GO TO 8200-SEND-DATAONLY.
  8143
  8144     IF PI-FST-PAGE
  8145         MOVE 2                  TO  PI-PAGE-NUMBER
  8146     ELSE
  8147     IF PI-2ND-PAGE
  8148         MOVE 3                  TO  PI-PAGE-NUMBER
  8149     ELSE
  8150     IF PI-3RD-PAGE
  8151         MOVE 4                  TO  PI-PAGE-NUMBER.
  8152
  8153     GO TO 7000-BUILD-OUTPUT-MAP.
  8154
  8155 5200-FIND-PREV-RANGE.
  8156     MOVE PI-PREV-VG-ACCOUNT     TO  KEY-SAVE.
  8157
  8158     IF PI-TOTAL-LINES  =  ZERO
  8159         GO TO 5210-NO-DATA.
  8160
  8161     IF PI-FST-PAGE
  8162         MOVE ER-2066            TO  EMI-ERROR
  8163         MOVE -1                 TO  MAINTL
  8164         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8165         GO TO 8200-SEND-DATAONLY.
  8166
  8167     IF PI-2ND-PAGE
  8168         MOVE 1                  TO  PI-PAGE-NUMBER
  8169     ELSE
  8170     IF PI-3RD-PAGE
  8171         MOVE 2                  TO  PI-PAGE-NUMBER
  8172     ELSE
  8173     IF PI-LST-PAGE
  8174         MOVE 3                  TO  PI-PAGE-NUMBER.
  8175
  8176     GO TO 7000-BUILD-OUTPUT-MAP.
  8177
  8178 5210-NO-DATA.
  8179     MOVE ER-2069                TO  EMI-ERROR.
  8180     MOVE -1                     TO  MAINTL.
  8181
  8182     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8183
  8184     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 169
* EL650.cbl
  8186 5300-FIND-NEXT-ACCOUNT.
  8187     MOVE PI-PREV-ACCOUNT        TO  PI-ACCT-CCGSA-KEY.
  8188     MOVE 'Y'                    TO  FIRST-TIME-SW.
  8189
  8190     IF PI-PREV-ACCOUNT  = LOW-VALUES
  8191         MOVE PI-COMPANY-CD      TO  PI-ACCT-CO
  8192     ELSE
  8193         PERFORM 6100-BUILD-KEY  THRU  6199-EXIT
  8194         MOVE HIGH-VALUES        TO  PI-ACCT-EXP-DT
  8195         MOVE LOW-VALUES         TO  PI-ACCT-REST-OF-EXP.
  8196
  8197     IF NOT EMI-NO-ERRORS
  8198         GO TO 8200-SEND-DATAONLY.
  8199
  8200
  8201* EXEC CICS  HANDLE CONDITION
  8202*        NOTFND   (5340-END)
  8203*        ENDFILE  (5330-NOT-FOUND)
  8204*    END-EXEC.
  8205*    MOVE '"$I''                  ! 3 #00007352' TO DFHEIV0
  8206     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8207     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8208     MOVE X'3320233030303037333532' TO DFHEIV0(25:11)
  8209     CALL 'kxdfhei1' USING DFHEIV0
  8210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8211
  8212
  8213 5305-START-BR.
  8214     MOVE ZEROS                  TO  PI-TOTAL-LINES.
  8215
  8216     SET T-INDEX
  8217        TS-INDEX  TO  +1.
  8218
  8219     PERFORM 6300-STARTBR  THRU  6300-EXIT.
  8220
  8221 5310-READ-NEXT.
  8222     PERFORM 6310-READNEXT  THRU  6310-EXIT.
  8223
  8224     IF PI-ACCT-CO  NOT = PI-COMPANY-CD
  8225         GO TO 5330-NOT-FOUND.
  8226
  8227     IF PI-CARRIER-SECURITY GREATER SPACES
  8228         IF PI-ACCT-CARRIER  =  PI-CARRIER-SECURITY
  8229             NEXT SENTENCE
  8230         ELSE
  8231             GO TO 5310-READ-NEXT.
  8232
  8233     IF FIRST-TIME
  8234         IF PI-ACCT-CCGSA-KEY  NOT = KEY-SAVE
  8235             MOVE SPACES             TO  FIRST-TIME-SW
  8236             MOVE PI-ACCT-CCGSA-KEY  TO  KEY-SAVE
  8237                                         PI-PREV-VG-ACCOUNT
  8238         ELSE
  8239             GO TO 5310-READ-NEXT.
  8240
  8241     IF PI-PREV-ACCOUNT  =  LOW-VALUES
  8242         IF PI-COMPANY-CD  = PI-ACCT-CO
  8243             GO TO 5320-DISPLAY-RECORD
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 170
* EL650.cbl
  8244         ELSE
  8245             MOVE ER-0066        TO  EMI-ERROR
  8246             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8247             MOVE -1             TO  MAINTL
  8248             GO TO 8200-SEND-DATAONLY.
  8249
  8250     IF PI-ACCT-CCGSA-KEY  = KEY-SAVE
  8251         GO TO 5320-DISPLAY-RECORD
  8252     ELSE
  8253         MOVE 1                  TO  PI-PAGE-NUMBER
  8254         GO TO 7000-BUILD-OUTPUT-MAP.
  8255
  8256 5320-DISPLAY-RECORD.
  8257     IF T-INDEX  = 1
  8258         MOVE LOW-VALUES         TO  PI-DATE-RANGE-TABLE
  8259         MOVE SPACE              TO  NAMEFLGO
  8260                                     PI-NAMEFLG.
  8261
  8262     IF AM-TRNTO-DTE  =  SPACES
  8263         MOVE LOW-VALUES         TO  AM-TRNTO-DTE.
  8264
  8265     IF AM-TRNFROM-DTE  = SPACES
  8266         MOVE LOW-VALUES         TO  AM-TRNFROM-DTE.
  8267
  8268     IF T-INDEX  = 1
  8269         IF PI-COMPANY-ID  = 'LGX'  OR
  8270                             'MIC'  OR  'MCC'
  8271             MOVE AM-TRANSFERRED-TO  TO  TRNTOO
  8272             MOVE AM-TRNTO-DTE       TO  DC-BIN-DATE-1
  8273             MOVE SPACE              TO  DC-OPTION-CODE
  8274             PERFORM 9700-DATE-CONVERSION
  8275             IF DATE-CONVERSION-ERROR
  8276                 MOVE SPACES         TO  TRNTODTO
  8277             ELSE
  8278                 MOVE DC-GREG-DATE-1-EDIT
  8279                                     TO  TRNTODTO.
  8280
  8281     IF T-INDEX  = 1
  8282         IF PI-COMPANY-ID  =  'LGX'  OR
  8283                              'MIC'  OR  'MCC'
  8284             MOVE AM-TRANSFERRED-FROM  TO  TRNFROMO
  8285             MOVE AM-TRNFROM-DTE       TO  DC-BIN-DATE-1
  8286             MOVE SPACE                TO  DC-OPTION-CODE
  8287             PERFORM 9700-DATE-CONVERSION
  8288             IF DATE-CONVERSION-ERROR
  8289                 MOVE SPACES           TO  TRNFRDTO
  8290             ELSE
  8291                 MOVE DC-GREG-DATE-1-EDIT
  8292                                       TO  TRNFRDTO.
  8293
  8294     IF NAMEO  NOT = LOW-VALUES
  8295         IF AM-NAME  NOT = NAMEO
  8296             MOVE '*'            TO  NAMEFLGO
  8297                                     PI-NAMEFLG.
  8298
  8299     MOVE AM-CONTROL-PRIMARY     TO  PI-PREV-ACCOUNT.
  8300
  8301     IF T-INDEX  = 1
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 171
* EL650.cbl
  8302         MOVE AM-NAME                TO  NAMEO
  8303                                         PI-ACCNAME
  8304        ELSE
  8305         MOVE PI-ACCNAME             TO  NAMEO.
  8306
  8307     PERFORM 1020-MOVE-TO-TABLE  THRU  1020-EXIT.
  8308
  8309     GO TO 5310-READ-NEXT.
  8310
  8311 5330-NOT-FOUND.
  8312     IF BROWSE-STARTED
  8313         PERFORM 6320-ENDBR  THRU  6320-EXIT
  8314     ELSE
  8315         GO TO 5340-END.
  8316
  8317     IF PI-ACCT-ACCOUNT  = LOW-VALUE
  8318         MOVE ER-0472            TO  EMI-ERROR
  8319         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8320         MOVE -1                 TO  MAINTL
  8321         GO TO 8200-SEND-DATAONLY.
  8322
  8323     IF PI-ACCT-CCGSA-KEY  =  PI-PREV-ACCOUNT
  8324       AND  T-INDEX  NOT = 1
  8325         MOVE 1                  TO  PI-PAGE-NUMBER
  8326         GO TO 7000-BUILD-OUTPUT-MAP
  8327     ELSE
  8328         IF T-INDEX  NOT = 1
  8329             MOVE ER-0066        TO  EMI-ERROR
  8330             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8331             MOVE 1              TO  PI-PAGE-NUMBER
  8332             GO TO 7000-BUILD-OUTPUT-MAP.
  8333
  8334 5340-END.
  8335     MOVE ER-0066                TO  EMI-ERROR.
  8336
  8337     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8338
  8339     MOVE -1                     TO  MAINTL.
  8340
  8341     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 172
* EL650.cbl
  8343 5400-FIND-PREV-ACCOUNT.
  8344     IF PI-PREV-ACCOUNT  = LOW-VALUES
  8345         GO TO 5430-NOT-FOUND.
  8346
  8347     MOVE PI-PREV-ACCOUNT        TO  PI-ACCT-CCGSA-KEY.
  8348     MOVE PI-BIN-EXP-DT (1)      TO  PI-ACCT-EXP-DT.
  8349     MOVE LOW-VALUES             TO  PI-ACCT-REST-OF-EXP.
  8350
  8351
  8352* EXEC CICS  HANDLE CONDITION
  8353*        NOTFND   (5440-NOT-FOUND)
  8354*        ENDFILE  (5430-NOT-FOUND)
  8355*    END-EXEC.
  8356*    MOVE '"$I''                  ! 4 #00007495' TO DFHEIV0
  8357     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8358     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8359     MOVE X'3420233030303037343935' TO DFHEIV0(25:11)
  8360     CALL 'kxdfhei1' USING DFHEIV0
  8361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8362
  8363
  8364
  8365* EXEC CICS  STARTBR
  8366*        DATASET  (PI-ACCT-ID)
  8367*        RIDFLD   (PI-ACCT-KEY)
  8368*    END-EXEC.
  8369     MOVE 0
  8370       TO DFHEIV11
  8371*    MOVE '&,         G          &   #00007500' TO DFHEIV0
  8372     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8373     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8374     MOVE X'2020233030303037353030' TO DFHEIV0(25:11)
  8375     CALL 'kxdfhei1' USING DFHEIV0,
  8376           PI-ACCT-ID,
  8377           PI-ACCT-KEY,
  8378           DFHEIV99,
  8379           DFHEIV11,
  8380           DFHEIV99
  8381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8382
  8383
  8384     MOVE 'Y'                    TO  BROWSE-STARTED-SW
  8385                                     FIRST-TIME-SW.
  8386 5410-READ-PREV.
  8387
  8388* EXEC CICS  READPREV
  8389*        DATASET  (PI-ACCT-ID)
  8390*        SET      (ADDRESS OF ACCOUNT-MASTER)
  8391*        RIDFLD   (PI-ACCT-KEY)
  8392*    END-EXEC.
  8393     MOVE 0
  8394       TO DFHEIV11
  8395*    MOVE '&0S                   )   #00007508' TO DFHEIV0
  8396     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8397     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8398     MOVE X'2020233030303037353038' TO DFHEIV0(25:11)
  8399     CALL 'kxdfhei1' USING DFHEIV0,
  8400           PI-ACCT-ID,
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 173
* EL650.cbl
  8401           DFHEIV20,
  8402           DFHEIV99,
  8403           PI-ACCT-KEY,
  8404           DFHEIV99,
  8405           DFHEIV11,
  8406           DFHEIV99,
  8407           DFHEIV99
  8408     SET ADDRESS OF ACCOUNT-MASTER TO
  8409         DFHEIV20
  8410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8411
  8412
  8413     IF FIRST-TIME
  8414         MOVE SPACE              TO  FIRST-TIME-SW
  8415         GO TO 5410-READ-PREV.
  8416
  8417     IF PI-ACCT-CO  NOT = PI-COMPANY-CD
  8418         GO TO 5430-NOT-FOUND.
  8419
  8420     IF PI-CARRIER-SECURITY GREATER SPACES
  8421         IF PI-ACCT-CARRIER  = PI-CARRIER-SECURITY
  8422             NEXT SENTENCE
  8423         ELSE
  8424             GO TO 5410-READ-PREV.
  8425
  8426     MOVE AM-CONTROL-PRIMARY     TO  PI-PREV-ACCOUNT.
  8427     MOVE PI-ACCT-CCGSA-KEY      TO  KEY-SAVE
  8428                                     PI-PREV-VG-ACCOUNT.
  8429     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  8430                                     PI-ACCT-REST-OF-EXP
  8431                                     PI-DATE-RANGE-TABLE.
  8432
  8433     MOVE SPACE                  TO  BROWSE-STARTED-SW.
  8434
  8435
  8436* EXEC CICS  ENDBR
  8437*        DATASET  (PI-ACCT-ID)
  8438*    END-EXEC.
  8439     MOVE 0
  8440       TO DFHEIV11
  8441*    MOVE '&2                    $   #00007536' TO DFHEIV0
  8442     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8443     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8444     MOVE X'2020233030303037353336' TO DFHEIV0(25:11)
  8445     CALL 'kxdfhei1' USING DFHEIV0,
  8446           PI-ACCT-ID,
  8447           DFHEIV11,
  8448           DFHEIV99
  8449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8450
  8451
  8452     GO TO 5305-START-BR.
  8453
  8454 5430-NOT-FOUND.
  8455     IF BROWSE-STARTED
  8456         MOVE SPACE              TO  BROWSE-STARTED-SW
  8457
  8458* EXEC CICS  ENDBR
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 174
* EL650.cbl
  8459*            DATASET  (PI-ACCT-ID)
  8460*        END-EXEC.
  8461     MOVE 0
  8462       TO DFHEIV11
  8463*    MOVE '&2                    $   #00007545' TO DFHEIV0
  8464     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8465     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8466     MOVE X'2020233030303037353435' TO DFHEIV0(25:11)
  8467     CALL 'kxdfhei1' USING DFHEIV0,
  8468           PI-ACCT-ID,
  8469           DFHEIV11,
  8470           DFHEIV99
  8471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8472
  8473
  8474     MOVE ER-0067                TO  EMI-ERROR.
  8475
  8476     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8477
  8478     MOVE -1                     TO  MAINTL.
  8479
  8480     IF PI-PREV-ACCOUNT  = LOW-VALUES
  8481         GO TO 5300-FIND-NEXT-ACCOUNT.
  8482
  8483     GO TO 8200-SEND-DATAONLY.
  8484
  8485 5440-NOT-FOUND.
  8486     MOVE PI-PREV-ACCOUNT        TO  PI-ACCT-CCGSA-KEY.
  8487
  8488     PERFORM 6310-READNEXT THRU 6310-EXIT.
  8489
  8490     GO TO 5410-READ-PREV.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 175
* EL650.cbl
  8492 5500-ADD-NEW-AXRF-RECORD.
  8493     IF NOT PI-GA-BILLING
  8494         GO TO 5599-EXIT.
  8495
  8496     MOVE +1                     TO  AXRF-SUB.
  8497
  8498*    IF MAINTI  = 'K'
  8499*        IF GETMAIN-SW  = 'X'
  8500*            GO TO 5510-BUILD-AXRF-KEY.
  8501
  8502     MOVE ERGXRF-MAX-LEN         TO  ERGXRF-REC-LEN.
  8503
  8504*    EXEC CICS  GETMAIN
  8505*        LENGTH   (ERGXRF-REC-LEN)
  8506*        SET      (ADDRESS OF AGENT-CROSS-REFERENCE)
  8507*        INITIMG  (GETMAIN-SPACE)
  8508*    END-EXEC.
  8509*    display ' beginning of CP displays  '
  8510*    display ' ergxrf-rec-len  ==   '  ergxrf-rec-len
  8511*    display ' address         ==   '
  8512*              address of agent-cross-reference
  8513*    display ' contents        ==   '  agent-cross-reference (1:1)
  8514*    display ' end       of CP displays  '
  8515
  8516*    MOVE 'X'                    TO  GETMAIN-SW.
  8517
  8518 5510-BUILD-AXRF-KEY.
  8519     MOVE ERGXRF-MAX-LEN         TO  ERGXRF-REC-LEN.
  8520
  8521     IF AXRF-SUB  =  +11
  8522         GO TO 5599-EXIT.
  8523
  8524     IF AM-AGT (AXRF-SUB)  =  SPACES  OR ZEROS OR LOW-VALUES
  8525         ADD +1 TO AXRF-SUB
  8526         GO TO 5510-BUILD-AXRF-KEY.
  8527
  8528     IF (AM-COM-TYP (AXRF-SUB)  NOT = 'O' AND 'P'
  8529         AND 'G' AND 'B' AND 'I' AND 'L' AND 'K' AND 'A')
  8530         ADD +1 TO AXRF-SUB
  8531         GO TO 5510-BUILD-AXRF-KEY.
  8532
  8533     MOVE PI-COMPANY-CD          TO  WS-AXRF-COMPANY-CD.
  8534
  8535     IF PI-ZERO-CARRIER  OR
  8536        PI-ZERO-CAR-GROUP
  8537         MOVE ZERO               TO  WS-AXRF-CARRIER
  8538     ELSE
  8539         MOVE AM-CARRIER         TO  WS-AXRF-CARRIER.
  8540
  8541     IF PI-ZERO-GROUPING  OR
  8542        PI-ZERO-CAR-GROUP
  8543         MOVE ZEROS              TO  WS-AXRF-GROUPING
  8544     ELSE
  8545         MOVE AM-GROUPING        TO  WS-AXRF-GROUPING.
  8546
  8547     MOVE AM-AGT (AXRF-SUB)      TO  WS-AXRF-AGENT-NO.
  8548
  8549
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 176
* EL650.cbl
  8550* EXEC CICS  HANDLE CONDITION
  8551*        ENDFILE  (5525-SKIP-REWRITE)
  8552*        NOTFND   (5525-SKIP-REWRITE)
  8553*    END-EXEC.
  8554*    MOVE '"$''I                  ! 5 #00007624' TO DFHEIV0
  8555     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  8556     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8557     MOVE X'3520233030303037363234' TO DFHEIV0(25:11)
  8558     CALL 'kxdfhei1' USING DFHEIV0
  8559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8560
  8561
  8562
  8563* EXEC CICS  READ
  8564*        DATASET  (ERGXRF-FILE-ID)
  8565*        LENGTH   (ERGXRF-REC-LEN)
  8566*        INTO     (AGENT-CROSS-REFERENCE)
  8567*        RIDFLD   (WS-AXRF-KEY)
  8568*        EQUAL
  8569*        UPDATE
  8570*    END-EXEC.
  8571*    MOVE '&"IL       EU         (   #00007629' TO DFHEIV0
  8572     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8573     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8574     MOVE X'2020233030303037363239' TO DFHEIV0(25:11)
  8575     CALL 'kxdfhei1' USING DFHEIV0,
  8576           ERGXRF-FILE-ID,
  8577           AGENT-CROSS-REFERENCE,
  8578           ERGXRF-REC-LEN,
  8579           WS-AXRF-KEY,
  8580           DFHEIV99,
  8581           DFHEIV99,
  8582           DFHEIV99
  8583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8584
  8585
  8586     MOVE GX-AGENT-POINTER-CNT   TO  GX-AGENT-POINTER-CNT.
  8587     MOVE +1                     TO  GX-AGENT-SUB.
  8588
  8589     IF GX-AGENT-POINTER-CNT = +1006
  8590         GO TO 5525-SKIP-REWRITE.
  8591
  8592
  8593 5520-FIND-REC-LOCATION.
  8594     MOVE AM-COMPANY-CD          TO  GX-AM-COMPANY-CD.
  8595     MOVE GX-AGENT-POINTER (GX-AGENT-SUB)
  8596                                 TO  GX-REST-OF-KEY.
  8597     MOVE LOW-VALUES             TO  GX-AM-CNTL-FILLER.
  8598
  8599     IF GX-AM-CONTROL-PRIMARY GREATER AM-CONTROL-PRIMARY  OR
  8600        GX-AGENT-SUB          GREATER GX-AGENT-POINTER-CNT
  8601         NEXT SENTENCE
  8602     ELSE
  8603         ADD +1 TO GX-AGENT-SUB
  8604         GO TO 5520-FIND-REC-LOCATION.
  8605
  8606     MOVE GX-AGENT-POINTER-CNT   TO  COMM-WORK-SUB
  8607                                     COMM-WORK-SUB2.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 177
* EL650.cbl
  8608
  8609     ADD +1 TO COMM-WORK-SUB2.
  8610
  8611     IF GX-AGENT-SUB GREATER GX-AGENT-POINTER-CNT
  8612         NEXT SENTENCE
  8613      ELSE
  8614         PERFORM 5530-BUMP-AXRF-REC
  8615             VARYING  COMM-WORK-SUB  FROM  COMM-WORK-SUB  BY  -1
  8616               UNTIL  COMM-WORK-SUB2 = GX-AGENT-SUB.
  8617
  8618     ADD ERGXRF-INC-LEN TO  ERGXRF-REC-LEN.
  8619     ADD  +1 TO  GX-AGENT-POINTER-CNT.
  8620
  8621     MOVE AM-CARRIER        TO  GX-AM-CARRIER   (COMM-WORK-SUB2).
  8622     MOVE AM-GROUPING       TO  GX-AM-GROUPING  (COMM-WORK-SUB2).
  8623     MOVE AM-STATE          TO  GX-AM-STATE     (COMM-WORK-SUB2).
  8624     MOVE AM-ACCOUNT        TO  GX-AM-ACCOUNT   (COMM-WORK-SUB2).
  8625     MOVE AM-EXPIRATION-DT  TO  GX-AM-EXPIRATION-DT
  8626                                                (COMM-WORK-SUB2).
  8627     MOVE AM-EFFECTIVE-DT   TO  GX-AM-EFF-DT    (COMM-WORK-SUB2).
  8628     MOVE AXRF-SUB          TO  GX-AM-LEVEL-NO  (COMM-WORK-SUB2).
  8629     MOVE LOW-VALUES        TO  GX-LAST-BILL-DT (COMM-WORK-SUB2).
  8630     MOVE BIN-CURRENT-SAVE  TO  GX-LAST-MAINT-DT.
  8631     MOVE EIBTIME           TO  GX-LAST-MAINT-HHMMSS.
  8632     MOVE PI-PROCESSOR-ID   TO  GX-LAST-MAINT-USER.
  8633     compute ergxrf-rec-len = (gx-agent-pointer-cnt * +31) + +78
  8634     if ergxrf-rec-len > +31264
  8635        move +31264          to ergxrf-rec-len
  8636        move +1006           to gx-agent-pointer-cnt
  8637     end-if
  8638
  8639
  8640* EXEC CICS  REWRITE
  8641*        FROM     (AGENT-CROSS-REFERENCE)
  8642*        LENGTH   (ERGXRF-REC-LEN)
  8643*        DATASET  (ERGXRF-FILE-ID)
  8644*    END-EXEC.
  8645*    MOVE '&& L                  %   #00007691' TO DFHEIV0
  8646     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8647     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8648     MOVE X'2020233030303037363931' TO DFHEIV0(25:11)
  8649     CALL 'kxdfhei1' USING DFHEIV0,
  8650           ERGXRF-FILE-ID,
  8651           AGENT-CROSS-REFERENCE,
  8652           ERGXRF-REC-LEN,
  8653           DFHEIV99
  8654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8655
  8656
  8657 5525-SKIP-REWRITE.
  8658
  8659     ADD +1 TO AXRF-SUB.
  8660
  8661     GO TO 5510-BUILD-AXRF-KEY.
  8662
  8663 5530-BUMP-AXRF-REC.
  8664     MOVE GX-AGENT-POINTER (COMM-WORK-SUB)
  8665                          TO  GX-AGENT-POINTER (COMM-WORK-SUB2).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 178
* EL650.cbl
  8666
  8667     SUBTRACT +1  FROM  COMM-WORK-SUB2.
  8668
  8669 5599-EXIT.
  8670     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 179
* EL650.cbl
  8672 5600-CHG-AXRF-RECORDS.
  8673     IF NOT PI-GA-BILLING
  8674         GO TO 5699-EXIT.
  8675
  8676     MOVE +1                     TO  AXRF-SUB.
  8677     MOVE ERGXRF-MAX-LEN         TO  ERGXRF-REC-LEN.
  8678
  8679*    IF GETMAIN-SW  = 'X'
  8680*        GO TO 5610-BUILD-AXRF-KEY.
  8681
  8682*    EXEC CICS  GETMAIN
  8683*        LENGTH   (ERGXRF-REC-LEN)
  8684*        SET      (ADDRESS OF AGENT-CROSS-REFERENCE)
  8685*        INITIMG  (GETMAIN-SPACE)
  8686*    END-EXEC.
  8687*
  8688*    display ' beginning of CP displays  '
  8689*    display ' ergxrf-rec-len  ==   '  ergxrf-rec-len
  8690*    display ' address         ==   '
  8691*              address of agent-cross-reference
  8692*    display ' contents        ==   '  agent-cross-reference (1:1)
  8693*    display ' end       of CP displays  '
  8694
  8695*    MOVE 'X'                    TO  GETMAIN-SW.
  8696
  8697 5610-BUILD-AXRF-KEY.
  8698     IF AXRF-SUB  = +11
  8699         GO TO 5699-EXIT.
  8700
  8701     IF AM-AGT (AXRF-SUB)  = SPACES OR ZEROS OR LOW-VALUES
  8702         ADD +1 TO AXRF-SUB
  8703         GO TO 5610-BUILD-AXRF-KEY.
  8704
  8705     IF (AM-COM-TYP (AXRF-SUB)  NOT = 'O'  AND  'P'
  8706         AND 'G' AND 'B' AND 'I' AND 'L' AND 'K' AND 'A')
  8707         ADD +1 TO AXRF-SUB
  8708         GO TO 5610-BUILD-AXRF-KEY.
  8709
  8710     MOVE ERGXRF-MAX-LEN         TO  ERGXRF-REC-LEN.
  8711     MOVE PI-COMPANY-CD          TO  WS-AXRF-COMPANY-CD.
  8712
  8713     IF PI-ZERO-CARRIER OR
  8714        PI-ZERO-CAR-GROUP
  8715         MOVE ZERO               TO  WS-AXRF-CARRIER
  8716     ELSE
  8717         MOVE AM-CARRIER         TO  WS-AXRF-CARRIER.
  8718
  8719     IF PI-ZERO-GROUPING  OR
  8720        PI-ZERO-CAR-GROUP
  8721         MOVE ZEROS              TO  WS-AXRF-GROUPING
  8722     ELSE
  8723         MOVE AM-GROUPING        TO  WS-AXRF-GROUPING.
  8724
  8725     MOVE AM-AGT (AXRF-SUB)      TO  WS-AXRF-AGENT-NO.
  8726
  8727
  8728* EXEC CICS  HANDLE CONDITION
  8729*        ENDFILE  (5615-SKIP-REWRITE)
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 180
* EL650.cbl
  8730*        NOTFND   (5615-SKIP-REWRITE)
  8731*    END-EXEC.
  8732*    MOVE '"$''I                  ! 6 #00007767' TO DFHEIV0
  8733     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  8734     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8735     MOVE X'3620233030303037373637' TO DFHEIV0(25:11)
  8736     CALL 'kxdfhei1' USING DFHEIV0
  8737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8738
  8739
  8740
  8741* EXEC CICS  READ
  8742*        DATASET  (ERGXRF-FILE-ID)
  8743*        LENGTH   (ERGXRF-REC-LEN)
  8744*        INTO     (AGENT-CROSS-REFERENCE)
  8745*        RIDFLD   (WS-AXRF-KEY)
  8746*        EQUAL
  8747*        UPDATE
  8748*    END-EXEC.
  8749*    MOVE '&"IL       EU         (   #00007772' TO DFHEIV0
  8750     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8751     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8752     MOVE X'2020233030303037373732' TO DFHEIV0(25:11)
  8753     CALL 'kxdfhei1' USING DFHEIV0,
  8754           ERGXRF-FILE-ID,
  8755           AGENT-CROSS-REFERENCE,
  8756           ERGXRF-REC-LEN,
  8757           WS-AXRF-KEY,
  8758           DFHEIV99,
  8759           DFHEIV99,
  8760           DFHEIV99
  8761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8762
  8763
  8764     MOVE GX-AGENT-POINTER-CNT   TO  GX-AGENT-POINTER-CNT.
  8765
  8766     PERFORM VARYING GX-AGENT-SUB FROM +1 BY +1
  8767             UNTIL
  8768       (GX-AGENT-SUB GREATER GX-AGENT-POINTER-CNT)
  8769            OR
  8770       (GX-AM-ACCOUNT       (GX-AGENT-SUB) = B4-ACCT-ACCOUNT  AND
  8771        GX-AM-EXPIRATION-DT (GX-AGENT-SUB) = B4-ACCT-EXP-DT   AND
  8772        GX-AM-EFF-DT        (GX-AGENT-SUB) = B4-ACCT-EFF-DT   AND
  8773        GX-AM-CARRIER       (GX-AGENT-SUB) = B4-ACCT-CARRIER  AND
  8774        GX-AM-GROUPING      (GX-AGENT-SUB) = B4-ACCT-GROUPING AND
  8775        GX-AM-STATE         (GX-AGENT-SUB) = B4-ACCT-STATE)
  8776     END-PERFORM.
  8777
  8778     IF MAINTI  = 'D'
  8779        IF GX-AGENT-SUB NOT GREATER GX-AGENT-POINTER-CNT
  8780            MOVE GX-AGENT-SUB    TO  COMM-WORK-SUB
  8781            PERFORM 5630-BUMP-RECORDS
  8782                VARYING  GX-AGENT-SUB  FROM  GX-AGENT-SUB  BY  +1
  8783                  UNTIL  GX-AGENT-SUB  = GX-AGENT-POINTER-CNT
  8784            SUBTRACT ERGXRF-INC-LEN  FROM  ERGXRF-REC-LEN
  8785            SUBTRACT +1              FROM  GX-AGENT-POINTER-CNT
  8786            GO TO 5615-REWRITE-AXRF-RECORD.
  8787
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 181
* EL650.cbl
  8788     IF GX-AGENT-SUB NOT GREATER GX-AGENT-POINTER-CNT
  8789        MOVE AF-ACCT-EFF-DT  TO GX-AM-EFF-DT        (GX-AGENT-SUB)
  8790        MOVE AF-ACCT-EXP-DT  TO GX-AM-EXPIRATION-DT (GX-AGENT-SUB)
  8791        MOVE AXRF-SUB        TO GX-AM-LEVEL-NO      (GX-AGENT-SUB)
  8792        GO TO 5615-REWRITE-AXRF-RECORD.
  8793
  8794
  8795* EXEC CICS  UNLOCK
  8796*        DATASET  (ERGXRF-FILE-ID)
  8797*    END-EXEC.
  8798*    MOVE '&*                    #   #00007811' TO DFHEIV0
  8799     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  8800     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8801     MOVE X'2020233030303037383131' TO DFHEIV0(25:11)
  8802     CALL 'kxdfhei1' USING DFHEIV0,
  8803           ERGXRF-FILE-ID,
  8804           DFHEIV99
  8805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8806
  8807
  8808     GO TO 5615-SKIP-REWRITE.
  8809
  8810 5615-REWRITE-AXRF-RECORD.
  8811     IF MAINTI  = 'D'
  8812       AND  GX-AGENT-POINTER-CNT  =  +0
  8813
  8814* EXEC CICS  DELETE
  8815*            DATASET  (ERGXRF-FILE-ID)
  8816*        END-EXEC
  8817*    MOVE '&(                    &   #00007820' TO DFHEIV0
  8818     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8819     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8820     MOVE X'2020233030303037383230' TO DFHEIV0(25:11)
  8821     CALL 'kxdfhei1' USING DFHEIV0,
  8822           ERGXRF-FILE-ID,
  8823           DFHEIV99,
  8824           DFHEIV99,
  8825           DFHEIV99,
  8826           DFHEIV99
  8827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8828     ELSE
  8829         MOVE BIN-CURRENT-SAVE   TO  GX-LAST-MAINT-DT
  8830         MOVE EIBTIME            TO  GX-LAST-MAINT-HHMMSS
  8831         MOVE PI-PROCESSOR-ID    TO  GX-LAST-MAINT-USER
  8832         compute ergxrf-rec-len =
  8833              (gx-agent-pointer-cnt * +31) + +78
  8834         if ergxrf-rec-len > +31264
  8835            move +31264          to ergxrf-rec-len
  8836            move +1006           to gx-agent-pointer-cnt
  8837         end-if
  8838
  8839* EXEC CICS  REWRITE
  8840*            FROM     (AGENT-CROSS-REFERENCE)
  8841*            LENGTH   (ERGXRF-REC-LEN)
  8842*            DATASET  (ERGXRF-FILE-ID)
  8843*        END-EXEC.
  8844*    MOVE '&& L                  %   #00007833' TO DFHEIV0
  8845     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 182
* EL650.cbl
  8846     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8847     MOVE X'2020233030303037383333' TO DFHEIV0(25:11)
  8848     CALL 'kxdfhei1' USING DFHEIV0,
  8849           ERGXRF-FILE-ID,
  8850           AGENT-CROSS-REFERENCE,
  8851           ERGXRF-REC-LEN,
  8852           DFHEIV99
  8853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8854
  8855
  8856 5615-SKIP-REWRITE.
  8857     ADD +1  TO  AXRF-SUB.
  8858
  8859     GO TO 5610-BUILD-AXRF-KEY.
  8860
  8861 5630-BUMP-RECORDS.
  8862     ADD +1  TO  COMM-WORK-SUB.
  8863
  8864     MOVE GX-AGENT-POINTER (COMM-WORK-SUB)
  8865                            TO  GX-AGENT-POINTER (GX-AGENT-SUB).
  8866
  8867 5699-EXIT.
  8868     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 183
* EL650.cbl
  8870 6000-EDIT-EFFECTIVE-DATE.
  8871     IF EFFCHGL  NOT =  ZEROS
  8872         MOVE EFFCHGI                  TO  WS-DT-DEEDIT-FIELD
  8873         PERFORM 8600-DEEDIT  THRU 8600-EXIT
  8874         MOVE WS-DEEDIT-FIELD-DATE-OUT TO  DC-GREG-DATE-1-MDY
  8875         MOVE '4'                      TO  DC-OPTION-CODE
  8876         PERFORM 9700-DATE-CONVERSION
  8877         IF DATE-CONVERSION-ERROR
  8878             MOVE ER-0348              TO  EMI-ERROR
  8879             MOVE -1                   TO  EFFCHGL
  8880             MOVE AL-UABON             TO  EFFCHGA
  8881             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8882         ELSE
  8883             MOVE DC-GREG-DATE-1-EDIT  TO  EFFCHGI
  8884             MOVE AL-UANON             TO  EFFCHGA
  8885***  Y2K PROJ 7744
  8886             MOVE DC-GREG-DATE-1-YMD   TO  WS-EFFCHG-SAVE
  8887             MOVE DC-ALPHA-CENTURY     TO  WS-EFFCHG-SAVE(4:2)
  8888             MOVE WS-EFFCHG-SAVE       TO  EFFCHG-SAVE
  8889             MOVE DC-BIN-DATE-1        TO  BIN-EFFCHG-SAVE
  8890         END-IF
  8891***  Y2K PROJ 7744
  8892     ELSE
  8893         IF MAINTI  NOT = 'N'
  8894             MOVE ER-0216              TO  EMI-ERROR
  8895             MOVE -1                   TO  EFFCHGL
  8896             MOVE AL-UABON             TO  EFFCHGA
  8897             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8898
  8899 6000-EFF-EXIT.
  8900     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 184
* EL650.cbl
  8902 6000-EDIT-EXPIRATION-DATE.
  8903***  Y2K PROJ 7744
  8904     IF EXPCHGL  NOT = ZEROS
  8905         MOVE EXPCHGI                  TO  WS-DT-DEEDIT-FIELD
  8906         PERFORM 8600-DEEDIT  THRU 8600-EXIT
  8907         IF WS-DEEDIT-FIELD-DATE-OUT NOT LESS 999999
  8908             MOVE WS-DEEDIT-FIELD-DATE-OUT TO  EXPCHGO
  8909             INSPECT EXPCHGI CONVERTING SPACES TO '/'
  8910             MOVE HIGH-VALUES              TO  BIN-EXPCHG-SAVE
  8911             MOVE 99999999999              TO  EXPCHG-SAVE
  8912         ELSE
  8913             MOVE WS-DEEDIT-FIELD-DATE-OUT TO  DC-GREG-DATE-1-MDY
  8914             MOVE '4'                      TO  DC-OPTION-CODE
  8915             PERFORM 9700-DATE-CONVERSION
  8916             IF DATE-CONVERSION-ERROR
  8917                 MOVE ER-0454              TO  EMI-ERROR
  8918                 MOVE -1                   TO  EXPCHGL
  8919                 MOVE AL-UABON             TO  EXPCHGA
  8920                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8921             ELSE
  8922                 MOVE DC-GREG-DATE-1-EDIT  TO  EXPCHGI
  8923                 MOVE AL-UANON             TO  EXPCHGA
  8924                 MOVE DC-GREG-DATE-1-YMD   TO  WS-EXPCHG-SAVE
  8925                 MOVE DC-ALPHA-CENTURY     TO  WS-EXPCHG-SAVE(4:2)
  8926                 MOVE WS-EXPCHG-SAVE       TO  EXPCHG-SAVE
  8927                 MOVE DC-BIN-DATE-1        TO  BIN-EXPCHG-SAVE
  8928             END-IF
  8929         END-IF
  8930     ELSE
  8931         IF MAINTI  NOT =  'N'
  8932             MOVE ER-2058                  TO  EMI-ERROR
  8933             MOVE -1                       TO  EXPCHGL
  8934             MOVE AL-UABON                 TO  EXPCHGA
  8935             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8936         ELSE
  8937             MOVE HIGH-VALUES              TO  BIN-EXPCHG-SAVE
  8938             MOVE 99999999999              TO  EXPCHG-SAVE
  8939         END-IF
  8940     END-IF.
  8941***  Y2K PROJ 7744
  8942
  8943 6000-EXP-EXIT.
  8944     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 185
* EL650.cbl
  8946 6000-EDIT-LINE.
  8947     IF LINEL  = ZEROS
  8948         GO TO 6000-NO-LINE.
  8949
  8950     MOVE AL-UNNON               TO  LINEA.
  8951
  8952     IF LINEI NOT NUMERIC
  8953         GO TO 6000-LINE-ERROR.
  8954
  8955     IF LINEI LESS 1 OR GREATER 8 OR GREATER PI-TOTAL-LINES
  8956         GO TO 6000-LINE-ERROR.
  8957
  8958     MOVE PI-TOTAL-LINES         TO WS-PAGE-LINES.
  8959
  8960     IF PI-2ND-PAGE
  8961         SUBTRACT 8 FROM WS-PAGE-LINES
  8962     ELSE
  8963     IF PI-3RD-PAGE
  8964         SUBTRACT 16 FROM WS-PAGE-LINES
  8965     ELSE
  8966     IF PI-LST-PAGE
  8967         SUBTRACT 24 FROM WS-PAGE-LINES.
  8968
  8969     IF LINEI GREATER WS-PAGE-LINES
  8970         GO TO 6000-LINE-ERROR.
  8971
  8972     MOVE LINEI                  TO  PI-LINE-SELECTED.
  8973
  8974     GO TO 6000-LIN-EXIT.
  8975
  8976 6000-NO-LINE.
  8977     IF PI-TOTAL-LINES  = 1
  8978         MOVE 1                  TO  PI-LINE-SELECTED
  8979                                     LINEI
  8980         MOVE AL-UNNON           TO  LINEA
  8981         GO TO 6000-LIN-EXIT.
  8982
  8983 6000-LINE-ERROR.
  8984     MOVE ER-2064                TO  EMI-ERROR.
  8985     MOVE -1                     TO  LINEL.
  8986     MOVE AL-UABON               TO  LINEA.
  8987
  8988     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8989
  8990 6000-LIN-EXIT.
  8991     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 186
* EL650.cbl
  8993 600A-CHECK-HI-LO-DATES.
  8994
  8995     IF PI-BIN-HI-CERT (T-INDEX)  =  LOW-VALUES
  8996         GO TO 600A-CHECK-AR-DATES.
  8997
  8998     IF BIN-EFFCHG-SAVE GREATER THAN PI-BIN-EFF-DT (T-INDEX)
  8999     IF (PI-BIN-HI-CERT (T-INDEX) NOT LESS BIN-EXPCHG-SAVE)
  9000         MOVE ER-2113            TO  EMI-ERROR
  9001         MOVE -1                 TO  MAINTL
  9002         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9003
  9004*    IF (PI-BIN-HI-CERT (T-INDEX) NOT LESS BIN-EXPCHG-SAVE)
  9005*        MOVE ER-2113            TO  EMI-ERROR
  9006*        MOVE -1                 TO  MAINTL
  9007*        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9008
  9009 600A-CHECK-AR-DATES.
  9010     IF NOT PI-AR-PROCESSING
  9011         GO TO 600A-EXIT.
  9012
  9013     IF PI-BIN-AR-HI-CERT (T-INDEX) = LOW-VALUES OR SPACES
  9014        GO TO 600A-EXIT.
  9015
  9016     IF (PI-BIN-AR-HI-CERT (T-INDEX) NOT LESS BIN-EXPCHG-SAVE)
  9017         MOVE ER-2113            TO  EMI-ERROR
  9018         MOVE -1                 TO  MAINTL
  9019         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9020
  9021 600A-EXIT.
  9022     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 187
* EL650.cbl
  9024 6010-DATE-CHECK.
  9025     IF MAINTI  = 'E'
  9026         GO TO 6010-CHECK-EFF.
  9027
  9028     IF PI-BIN-HI-CERT (T-INDEX)  NOT = LOW-VALUES
  9029         IF BIN-EXPCHG-SAVE NOT GREATER PI-BIN-HI-CERT (T-INDEX)
  9030             MOVE ER-2072        TO  EMI-ERROR
  9031             MOVE -1             TO  EXPCHGL
  9032             MOVE AL-UABON       TO  EXPCHGA
  9033             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9034
  9035     IF BIN-EXPCHG-SAVE NOT GREATER PI-BIN-EFF-DT (T-INDEX)
  9036         MOVE ER-2074            TO  EMI-ERROR
  9037         MOVE -1                 TO  EXPCHGL
  9038         MOVE AL-UABON           TO  EXPCHGA
  9039         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9040
  9041     GO TO 6010-EXIT.
  9042
  9043 6010-CHECK-EFF.
  9044     IF PI-BIN-LO-CERT (T-INDEX)  NOT =  LOW-VALUES
  9045        IF (BIN-EFFCHG-SAVE >= PI-BIN-LO-CERT (T-INDEX))
  9046           AND (PI-PROCESSOR-ID NOT = 'PEMA')
  9047           MOVE ER-2073          TO EMI-ERROR
  9048           MOVE -1               TO EFFCHGL
  9049           MOVE AL-UABON         TO EFFCHGA
  9050           PERFORM 9900-ERROR-FORMAT
  9051                                 THRU 9900-EXIT
  9052        END-IF
  9053     END-IF
  9054
  9055     IF BIN-EFFCHG-SAVE NOT LESS PI-BIN-EXP-DT (T-INDEX)
  9056         MOVE ER-2075            TO  EMI-ERROR
  9057         MOVE -1                 TO  EFFCHGL
  9058         MOVE AL-UABON           TO  EFFCHGA
  9059         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9060
  9061 6010-EXIT.
  9062     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 188
* EL650.cbl
  9064 6100-BUILD-KEY.
  9065     MOVE LOW-VALUES             TO  PI-ACCT-KEY.
  9066     MOVE PI-COMPANY-CD          TO  PI-ACCT-CO.
  9067
  9068     IF ACARIERI  =  SPACES  OR  LOW-VALUES
  9069         IF MAINTI  = 'S'
  9070           OR  FIRST-TIME
  9071             MOVE SPACES         TO  PI-ACCT-CARRIER
  9072         ELSE
  9073             MOVE -1             TO  ACARIERL
  9074             MOVE ER-2059        TO  EMI-ERROR
  9075             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9076     ELSE
  9077         MOVE AL-UANON           TO  ACARIERA
  9078         MOVE ACARIERI           TO  PI-ACCT-CARRIER.
  9079
  9080     IF AGROUPI  =  SPACES  OR  LOW-VALUES
  9081         IF MAINTI  = 'S'
  9082           OR  FIRST-TIME
  9083             MOVE SPACES         TO  PI-ACCT-GROUPING
  9084         ELSE
  9085             MOVE -1             TO  AGROUPL
  9086             MOVE ER-2059        TO  EMI-ERROR
  9087             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9088     ELSE
  9089         IF AGROUPI  =  '0     '
  9090             MOVE -1             TO  AGROUPL
  9091             MOVE ER-0195        TO  EMI-ERROR
  9092             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9093         ELSE
  9094             MOVE AL-UANON       TO  AGROUPA
  9095             MOVE AGROUPI        TO  PI-ACCT-GROUPING.
  9096
  9097     IF ASTATEI  = SPACES  OR  LOW-VALUES
  9098         IF MAINTI  =  'S'
  9099           OR  FIRST-TIME
  9100             MOVE SPACES         TO  PI-ACCT-STATE
  9101         ELSE
  9102             MOVE -1             TO  ASTATEL
  9103             MOVE ER-2059        TO  EMI-ERROR
  9104             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9105     ELSE
  9106         MOVE AL-UANON           TO  ASTATEA
  9107         MOVE ASTATEI            TO  PI-ACCT-STATE.
  9108
  9109     IF AACCTI  = SPACES  OR  LOW-VALUES
  9110        IF MAINTI  = 'S'
  9111          OR  FIRST-TIME
  9112            MOVE SPACES          TO  PI-ACCT-ACCOUNT
  9113        ELSE
  9114            MOVE -1              TO  AACCTL
  9115            MOVE ER-2059         TO  EMI-ERROR
  9116            PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9117     ELSE
  9118         MOVE AL-UANON           TO  AACCTA
  9119         MOVE AACCTI             TO  PI-ACCT-ACCOUNT.
  9120
  9121     IF PI-ACCT-CARRIER  = SPACES
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 189
* EL650.cbl
  9122       AND  (CARR-ACCNT-CNTL
  9123       OR   CARR-ST-ACCNT-CNTL
  9124       OR   CARR-GROUP-ST-ACCNT-CNTL)
  9125         MOVE ER-0193            TO  EMI-ERROR
  9126         MOVE -1                 TO  ACARIERL
  9127         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9128
  9129     IF PI-ACCT-GROUPING  =  SPACES
  9130       AND  CARR-GROUP-ST-ACCNT-CNTL
  9131         MOVE ER-0195            TO  EMI-ERROR
  9132         MOVE -1                 TO  AGROUPL
  9133         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9134
  9135     IF PI-ACCT-STATE  = SPACES
  9136       AND  (ST-ACCNT-CNTL
  9137       OR   CARR-ST-ACCNT-CNTL
  9138       OR   CARR-GROUP-ST-ACCNT-CNTL)
  9139         MOVE ER-0144            TO  EMI-ERROR
  9140         MOVE -1                 TO  ASTATEL
  9141         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9142
  9143     IF MAINTI  =  'S'
  9144       OR  FIRST-TIME
  9145         NEXT SENTENCE
  9146     ELSE
  9147         MOVE PI-ACCT-CCGSA-KEY  TO  KEY-SAVE.
  9148
  9149     IF NOT EMI-NO-ERRORS
  9150         IF EIBTRNID = EL6311-TRANS-ID
  9151             GO TO 8100-SEND-INITIAL-MAP
  9152           ELSE
  9153             GO TO 8200-SEND-DATAONLY.
  9154
  9155     IF PI-ACCT-CARRIER   = SPACES  OR
  9156        PI-ACCT-STATE     = SPACES  OR
  9157        PI-ACCT-GROUPING  = SPACES
  9158         MOVE ACCT2-FILE-ID      TO  PI-ACCT-ID
  9159     ELSE
  9160         MOVE ACCT-FILE-ID       TO  PI-ACCT-ID.
  9161
  9162     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  9163                                     PI-ACCT-REST-OF-EXP.
  9164
  9165 6199-EXIT.
  9166     EXIT.
  9167
  9168 6200-CHECK-KEY.
  9169     IF PI-PREV-ACCOUNT  NOT = PI-ACCT-CCGSA-KEY
  9170         MOVE ER-0453            TO  EMI-ERROR
  9171         MOVE -1                 TO  MAINTL
  9172         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9173
  9174 6200-EXIT.
  9175     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 190
* EL650.cbl
  9177 6300-STARTBR.
  9178     MOVE ACCT-FILE-ID           TO  PI-ACCT-ID.
  9179
  9180
  9181* EXEC CICS  STARTBR
  9182*        DATASET  (PI-ACCT-ID)
  9183*        RIDFLD   (PI-ACCT-KEY)
  9184*    END-EXEC.
  9185     MOVE 0
  9186       TO DFHEIV11
  9187*    MOVE '&,         G          &   #00008163' TO DFHEIV0
  9188     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9189     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9190     MOVE X'2020233030303038313633' TO DFHEIV0(25:11)
  9191     CALL 'kxdfhei1' USING DFHEIV0,
  9192           PI-ACCT-ID,
  9193           PI-ACCT-KEY,
  9194           DFHEIV99,
  9195           DFHEIV11,
  9196           DFHEIV99
  9197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9198
  9199
  9200     MOVE 'Y'                    TO  BROWSE-STARTED-SW.
  9201     MOVE PI-ACCT-CCGSA-KEY      TO  KEY-SAVE.
  9202
  9203 6300-EXIT.
  9204     EXIT.
  9205
  9206 6310-READNEXT.
  9207
  9208* EXEC CICS  READNEXT
  9209*        DATASET  (PI-ACCT-ID)
  9210*        SET      (ADDRESS OF ACCOUNT-MASTER)
  9211*        RIDFLD   (PI-ACCT-KEY)
  9212*    END-EXEC.
  9213     MOVE 0
  9214       TO DFHEIV11
  9215*    MOVE '&.S                   )   #00008175' TO DFHEIV0
  9216     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9217     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9218     MOVE X'2020233030303038313735' TO DFHEIV0(25:11)
  9219     CALL 'kxdfhei1' USING DFHEIV0,
  9220           PI-ACCT-ID,
  9221           DFHEIV20,
  9222           DFHEIV99,
  9223           PI-ACCT-KEY,
  9224           DFHEIV99,
  9225           DFHEIV11,
  9226           DFHEIV99,
  9227           DFHEIV99
  9228     SET ADDRESS OF ACCOUNT-MASTER TO
  9229         DFHEIV20
  9230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9231
  9232
  9233 6310-EXIT.
  9234     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 191
* EL650.cbl
  9235
  9236 6320-ENDBR.
  9237     MOVE SPACE                  TO  BROWSE-STARTED-SW.
  9238
  9239
  9240* EXEC CICS  ENDBR
  9241*        DATASET  (PI-ACCT-ID)
  9242*    END-EXEC.
  9243     MOVE 0
  9244       TO DFHEIV11
  9245*    MOVE '&2                    $   #00008187' TO DFHEIV0
  9246     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9247     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9248     MOVE X'2020233030303038313837' TO DFHEIV0(25:11)
  9249     CALL 'kxdfhei1' USING DFHEIV0,
  9250           PI-ACCT-ID,
  9251           DFHEIV11,
  9252           DFHEIV99
  9253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9254
  9255
  9256 6320-EXIT.
  9257     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 192
* EL650.cbl
  9259 6400-BUILD-VG-KEY.
  9260     MOVE AM-CONTROL-PRIMARY     TO  AM-CONTROL-BY-VAR-GRP.
  9261
  9262     IF ST-ACCNT-CNTL
  9263         MOVE SPACES             TO  AM-VG-CARRIER
  9264                                     AM-VG-GROUPING.
  9265
  9266     IF CARR-ST-ACCNT-CNTL
  9267         MOVE SPACES             TO  AM-VG-GROUPING.
  9268
  9269     IF ACCNT-CNTL
  9270         MOVE SPACES             TO  AM-VG-CARRIER
  9271                                     AM-VG-STATE
  9272                                     AM-VG-GROUPING.
  9273
  9274     IF CARR-ACCNT-CNTL
  9275         MOVE SPACES             TO  AM-VG-STATE
  9276                                     AM-VG-GROUPING.
  9277
  9278 6499-EXIT.
  9279     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 193
* EL650.cbl
  9281 6500-READ-ACCT.
  9282
  9283* EXEC CICS  HANDLE CONDITION
  9284*        NOTFND  (6599-EXIT)
  9285*    END-EXEC.
  9286*    MOVE '"$I                   ! 7 #00008217' TO DFHEIV0
  9287     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9288     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9289     MOVE X'3720233030303038323137' TO DFHEIV0(25:11)
  9290     CALL 'kxdfhei1' USING DFHEIV0
  9291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9292
  9293
  9294     MOVE ZERO                   TO  REC-SW.
  9295
  9296
  9297* EXEC CICS  READ
  9298*        GTEQ
  9299*        DATASET  (ACCT-FILE-ID)
  9300*        SET      (ADDRESS OF ACCOUNT-MASTER)
  9301*        RIDFLD   (PI-ACCT-KEY)
  9302*    END-EXEC.
  9303*    MOVE '&"S        G          (   #00008223' TO DFHEIV0
  9304     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9305     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9306     MOVE X'2020233030303038323233' TO DFHEIV0(25:11)
  9307     CALL 'kxdfhei1' USING DFHEIV0,
  9308           ACCT-FILE-ID,
  9309           DFHEIV20,
  9310           DFHEIV99,
  9311           PI-ACCT-KEY,
  9312           DFHEIV99,
  9313           DFHEIV99,
  9314           DFHEIV99
  9315     SET ADDRESS OF ACCOUNT-MASTER TO
  9316         DFHEIV20
  9317     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9318
  9319
  9320     MOVE AM-CONTROL-PRIMARY     TO  PI-ACCT-KEY.
  9321     MOVE LOW-VALUES             TO  PI-ACCT-REST-OF-EXP.
  9322
  9323     IF PI-ACCT-CCGSA-KEY  = NEW-KEY-SAVE
  9324         MOVE 1                  TO  REC-SW.
  9325
  9326 6599-EXIT.
  9327     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 194
* EL650.cbl
  9329 6600-UPDATE-MAINT-DT.
  9330     MOVE SPACES                 TO  ELCNTL-KEY.
  9331     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9332     MOVE '1'                    TO  CNTL-REC-TYPE.
  9333     MOVE +0                     TO  CNTL-SEQ-NO.
  9334
  9335
  9336* EXEC CICS  HANDLE CONDITION
  9337*        NOTFND  (6699-EXIT)
  9338*    END-EXEC.
  9339*    MOVE '"$I                   ! 8 #00008245' TO DFHEIV0
  9340     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9341     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9342     MOVE X'3820233030303038323435' TO DFHEIV0(25:11)
  9343     CALL 'kxdfhei1' USING DFHEIV0
  9344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9345
  9346
  9347
  9348* EXEC CICS  READ
  9349*        UPDATE
  9350*        DATASET  (CNTL-FILE-ID)
  9351*        SET      (ADDRESS OF CONTROL-FILE)
  9352*        RIDFLD   (ELCNTL-KEY)
  9353*    END-EXEC.
  9354*    MOVE '&"S        EU         (   #00008249' TO DFHEIV0
  9355     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9356     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9357     MOVE X'2020233030303038323439' TO DFHEIV0(25:11)
  9358     CALL 'kxdfhei1' USING DFHEIV0,
  9359           CNTL-FILE-ID,
  9360           DFHEIV20,
  9361           DFHEIV99,
  9362           ELCNTL-KEY,
  9363           DFHEIV99,
  9364           DFHEIV99,
  9365           DFHEIV99
  9366     SET ADDRESS OF CONTROL-FILE TO
  9367         DFHEIV20
  9368     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9369
  9370
  9371     MOVE CONTROL-FILE           TO  JP-RECORD-AREA.
  9372     MOVE 'B'                    TO  JP-RECORD-TYPE.
  9373     MOVE CNTL-FILE-ID           TO  FILE-ID.
  9374
  9375     PERFORM 8400-LOG-JOURNAL-RECORD.
  9376
  9377     MOVE BIN-CURRENT-SAVE       TO  CF-ACCOUNT-MSTR-MAINT-DT.
  9378     MOVE CONTROL-FILE           TO  JP-RECORD-AREA.
  9379     MOVE 'C'                    TO  JP-RECORD-TYPE.
  9380     MOVE CNTL-FILE-ID           TO  FILE-ID.
  9381
  9382
  9383* EXEC CICS  REWRITE
  9384*        DATASET  (CNTL-FILE-ID)
  9385*        FROM     (CONTROL-FILE)
  9386*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 195
* EL650.cbl
  9387     MOVE LENGTH OF
  9388      CONTROL-FILE
  9389       TO DFHEIV11
  9390*    MOVE '&& L                  %   #00008267' TO DFHEIV0
  9391     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9392     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9393     MOVE X'2020233030303038323637' TO DFHEIV0(25:11)
  9394     CALL 'kxdfhei1' USING DFHEIV0,
  9395           CNTL-FILE-ID,
  9396           CONTROL-FILE,
  9397           DFHEIV11,
  9398           DFHEIV99
  9399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9400
  9401
  9402     PERFORM 8400-LOG-JOURNAL-RECORD.
  9403
  9404 6699-EXIT.
  9405     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 196
* EL650.cbl
  9407 6700-VERIFY-STATE-CARRIER.
  9408     IF PI-ACCT-CARRIER  = SPACES
  9409         GO TO 6750-CHECK-STATE.
  9410
  9411     MOVE SPACES                 TO  ELCNTL-KEY.
  9412     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9413     MOVE '6'                    TO  CNTL-REC-TYPE.
  9414     MOVE PI-ACCT-CARRIER        TO  CNTL-CARRIER
  9415     MOVE +0                     TO  CNTL-SEQ-NO.
  9416
  9417
  9418* EXEC CICS  HANDLE CONDITION
  9419*        NOTFND  (6720-NO-CARRIER)
  9420*    END-EXEC.
  9421*    MOVE '"$I                   ! 9 #00008287' TO DFHEIV0
  9422     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9423     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9424     MOVE X'3920233030303038323837' TO DFHEIV0(25:11)
  9425     CALL 'kxdfhei1' USING DFHEIV0
  9426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9427
  9428
  9429
  9430* EXEC CICS  READ
  9431*        DATASET  (CNTL-FILE-ID)
  9432*        SET      (ADDRESS OF CONTROL-FILE)
  9433*        RIDFLD   (ELCNTL-KEY)
  9434*    END-EXEC.
  9435*    MOVE '&"S        E          (   #00008291' TO DFHEIV0
  9436     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9437     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9438     MOVE X'2020233030303038323931' TO DFHEIV0(25:11)
  9439     CALL 'kxdfhei1' USING DFHEIV0,
  9440           CNTL-FILE-ID,
  9441           DFHEIV20,
  9442           DFHEIV99,
  9443           ELCNTL-KEY,
  9444           DFHEIV99,
  9445           DFHEIV99,
  9446           DFHEIV99
  9447     SET ADDRESS OF CONTROL-FILE TO
  9448         DFHEIV20
  9449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9450
  9451
  9452     GO TO 6750-CHECK-STATE.
  9453
  9454 6720-NO-CARRIER.
  9455     MOVE ER-0193                TO  EMI-ERROR.
  9456     MOVE -1                     TO  ACARIERL.
  9457     MOVE AL-UABON               TO  ACARIERA.
  9458
  9459     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9460
  9461 6750-CHECK-STATE.
  9462     IF PI-ACCT-STATE  =  SPACES
  9463         GO TO 6799-EXIT.
  9464
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 197
* EL650.cbl
  9465     MOVE SPACES                 TO  ELCNTL-KEY.
  9466     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9467     MOVE '3'                    TO  CNTL-REC-TYPE.
  9468     MOVE PI-ACCT-STATE          TO  CNTL-STATE.
  9469     MOVE +0                     TO  CNTL-SEQ-NO.
  9470
  9471
  9472* EXEC CICS  HANDLE CONDITION
  9473*        NOTFND  (6780-NO-STATE)
  9474*    END-EXEC.
  9475*    MOVE '"$I                   ! : #00008316' TO DFHEIV0
  9476     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9477     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9478     MOVE X'3A20233030303038333136' TO DFHEIV0(25:11)
  9479     CALL 'kxdfhei1' USING DFHEIV0
  9480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9481
  9482
  9483
  9484* EXEC CICS  READ
  9485*        DATASET  (CNTL-FILE-ID)
  9486*        SET      (ADDRESS OF CONTROL-FILE)
  9487*        RIDFLD   (ELCNTL-KEY)
  9488*    END-EXEC.
  9489*    MOVE '&"S        E          (   #00008320' TO DFHEIV0
  9490     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9491     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9492     MOVE X'2020233030303038333230' TO DFHEIV0(25:11)
  9493     CALL 'kxdfhei1' USING DFHEIV0,
  9494           CNTL-FILE-ID,
  9495           DFHEIV20,
  9496           DFHEIV99,
  9497           ELCNTL-KEY,
  9498           DFHEIV99,
  9499           DFHEIV99,
  9500           DFHEIV99
  9501     SET ADDRESS OF CONTROL-FILE TO
  9502         DFHEIV20
  9503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9504
  9505
  9506     GO TO 6799-EXIT.
  9507
  9508 6780-NO-STATE.
  9509     MOVE ER-0144                TO  EMI-ERROR.
  9510     MOVE -1                     TO  ASTATEL.
  9511     MOVE AL-UABON               TO  ASTATEA.
  9512
  9513     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9514
  9515 6799-EXIT.
  9516     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 198
* EL650.cbl
  9518 6800-COMPANY-REC-READ.
  9519     MOVE SPACES                 TO  ELCNTL-KEY.
  9520     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9521     MOVE '1'                    TO  CNTL-REC-TYPE.
  9522     MOVE +0                     TO  CNTL-SEQ-NO.
  9523
  9524
  9525* EXEC CICS  HANDLE CONDITION
  9526*        NOTFND  (6880-NO-COMP)
  9527*    END-EXEC.
  9528*    MOVE '"$I                   ! ; #00008344' TO DFHEIV0
  9529     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9530     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9531     MOVE X'3B20233030303038333434' TO DFHEIV0(25:11)
  9532     CALL 'kxdfhei1' USING DFHEIV0
  9533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9534
  9535
  9536
  9537* EXEC CICS  READ
  9538*        DATASET  (CNTL-FILE-ID)
  9539*        SET      (ADDRESS OF CONTROL-FILE)
  9540*        RIDFLD   (ELCNTL-KEY)
  9541*    END-EXEC.
  9542*    MOVE '&"S        E          (   #00008348' TO DFHEIV0
  9543     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9544     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9545     MOVE X'2020233030303038333438' TO DFHEIV0(25:11)
  9546     CALL 'kxdfhei1' USING DFHEIV0,
  9547           CNTL-FILE-ID,
  9548           DFHEIV20,
  9549           DFHEIV99,
  9550           ELCNTL-KEY,
  9551           DFHEIV99,
  9552           DFHEIV99,
  9553           DFHEIV99
  9554     SET ADDRESS OF CONTROL-FILE TO
  9555         DFHEIV20
  9556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9557
  9558
  9559     IF CF-ACCOUNT-MSTR-MAINT-DT  = LOW-VALUES
  9560         MOVE ER-2572            TO  EMI-ERROR
  9561         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9562
  9563     GO TO 6899-EXIT.
  9564
  9565 6880-NO-COMP.
  9566     MOVE ER-0022                TO  EMI-ERROR.
  9567
  9568     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9569
  9570 6899-EXIT.
  9571     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 199
* EL650.cbl
  9573 7000-BUILD-OUTPUT-MAP.
  9574     IF RETURNING-FROM-6501
  9575         MOVE PI-PREV-VG-ACCOUNT  TO  KEY-SAVE.
  9576
  9577     IF PI-COMPANY-ID  = 'LGX'  OR  'MIC'  OR  'MCC'
  9578         MOVE AL-SANOF           TO  TRNMSG1A
  9579                                     TRNMSG2A
  9580                                     TRNMSG3A
  9581                                     TRNMSG4A.
  9582
  9583     MOVE AL-UANON               TO  ACARIERA
  9584                                     AGROUPA
  9585                                     ASTATEA
  9586                                     AACCTA.
  9587     MOVE SV-CARRIER             TO  ACARIERO.
  9588     MOVE SV-GROUPING            TO  AGROUPO.
  9589     MOVE SV-STATE               TO  ASTATEO.
  9590     MOVE SV-ACCOUNT             TO  AACCTO.
  9591
  9592     SET M-INDEX  TO  1.
  9593
  9594     MOVE LOW-VALUES             TO  MAP-RECORD-AREA.
  9595
  9596     IF PI-MAINT  = 'A'
  9597       AND  PI-RECORD-NOT-CREATED
  9598         MOVE ER-2151            TO  EMI-ERROR
  9599         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9600         GO TO 7000-END.
  9601
  9602     IF PI-FST-PAGE
  9603         SET T-INDEX   TO  1
  9604     ELSE
  9605     IF PI-2ND-PAGE
  9606         SET T-INDEX   TO  9
  9607     ELSE
  9608     IF PI-3RD-PAGE
  9609         SET T-INDEX   TO  17
  9610     ELSE
  9611         SET T-INDEX   TO  25.
  9612
  9613 7000-LOOP.
  9614     IF PI-BIN-EXP-DT (T-INDEX)  NOT = HIGH-VALUES
  9615         MOVE PI-BIN-EXP-DT (T-INDEX)
  9616                                 TO  DC-BIN-DATE-1
  9617         MOVE SPACE              TO  DC-OPTION-CODE
  9618         PERFORM 9700-DATE-CONVERSION
  9619         IF DATE-CONVERSION-ERROR
  9620             MOVE SPACES         TO  MAP-EXP-DT (M-INDEX)
  9621         ELSE
  9622             MOVE DC-GREG-DATE-1-EDIT
  9623                                 TO  MAP-EXP-DT (M-INDEX)
  9624     ELSE
  9625         MOVE 999999             TO  MAP-EXP-DT-ED (M-INDEX)
  9626         INSPECT MAP-EXP-DT-ED (M-INDEX) CONVERTING SPACES TO '/'.
  9627
  9628     MOVE PI-BIN-EFF-DT (T-INDEX)  TO  DC-BIN-DATE-1.
  9629     MOVE SPACE                    TO  DC-OPTION-CODE.
  9630
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 200
* EL650.cbl
  9631     PERFORM 9700-DATE-CONVERSION.
  9632
  9633     IF DATE-CONVERSION-ERROR
  9634         MOVE SPACES               TO  MAP-EFF-DT (M-INDEX)
  9635     ELSE
  9636         MOVE DC-GREG-DATE-1-EDIT  TO  MAP-EFF-DT (M-INDEX).
  9637
  9638     IF PI-BIN-MAINT-DT (T-INDEX)  = LOW-VALUES
  9639         MOVE SPACES             TO  MAP-LST-MAINT-DT (M-INDEX)
  9640     ELSE
  9641         MOVE PI-BIN-MAINT-DT (T-INDEX)
  9642                                 TO  DC-BIN-DATE-1
  9643         MOVE SPACE              TO  DC-OPTION-CODE
  9644         PERFORM 9700-DATE-CONVERSION
  9645         IF DATE-CONVERSION-ERROR
  9646             MOVE SPACES         TO  MAP-LST-MAINT-DT (M-INDEX)
  9647         ELSE
  9648             MOVE DC-GREG-DATE-1-EDIT
  9649                                 TO  MAP-LST-MAINT-DT (M-INDEX).
  9650
  9651     IF PI-BIN-HI-CERT (T-INDEX)  =  LOW-VALUES
  9652         MOVE SPACES             TO  MAP-HIGH-CERT (M-INDEX)
  9653     ELSE
  9654         MOVE PI-BIN-HI-CERT (T-INDEX)
  9655                                 TO  DC-BIN-DATE-1
  9656         MOVE SPACE              TO  DC-OPTION-CODE
  9657         PERFORM 9700-DATE-CONVERSION
  9658         IF DATE-CONVERSION-ERROR
  9659             MOVE SPACES         TO  MAP-HIGH-CERT (M-INDEX)
  9660         ELSE
  9661             MOVE DC-GREG-DATE-1-EDIT
  9662                                 TO  MAP-HIGH-CERT (M-INDEX).
  9663
  9664     IF PI-BIN-LO-CERT (T-INDEX)  = LOW-VALUES
  9665         MOVE SPACES             TO  MAP-LOW-CERT (M-INDEX)
  9666     ELSE
  9667         MOVE PI-BIN-LO-CERT (T-INDEX)
  9668                                 TO  DC-BIN-DATE-1
  9669         MOVE SPACE              TO  DC-OPTION-CODE
  9670         PERFORM 9700-DATE-CONVERSION
  9671         IF DATE-CONVERSION-ERROR
  9672             MOVE SPACES         TO  MAP-LOW-CERT (M-INDEX)
  9673         ELSE
  9674             MOVE DC-GREG-DATE-1-EDIT
  9675                                 TO  MAP-LOW-CERT (M-INDEX).
  9676
  9677     IF PI-BIN-AR-HI-CERT (T-INDEX)  = LOW-VALUES OR SPACES
  9678         MOVE SPACES             TO  MAP-AR-DATE (M-INDEX)
  9679     ELSE
  9680         MOVE PI-BIN-AR-HI-CERT (T-INDEX)
  9681                                 TO  DC-BIN-DATE-1
  9682         MOVE SPACE              TO  DC-OPTION-CODE
  9683         PERFORM 9700-DATE-CONVERSION
  9684         IF DATE-CONVERSION-ERROR
  9685             MOVE SPACES         TO  MAP-AR-DATE (M-INDEX)
  9686         ELSE
  9687             MOVE DC-GREG-DATE-1-EDIT
  9688                                 TO  MAP-AR-DATE (M-INDEX).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 201
* EL650.cbl
  9689
  9690     IF M-INDEX  =  8  OR
  9691        T-INDEX  =  PI-TOTAL-LINES
  9692         NEXT SENTENCE
  9693     ELSE
  9694         SET M-INDEX
  9695             T-INDEX  UP  BY  1
  9696         GO TO 7000-LOOP.
  9697
  9698     IF M-INDEX  =  8
  9699       AND  T-INDEX  LESS THAN  PI-TOTAL-LINES
  9700         MOVE ER-0668            TO  EMI-ERROR
  9701         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9702
  9703     IF T-INDEX  =  PI-TOTAL-LINES
  9704         MOVE ER-0630            TO  EMI-ERROR
  9705         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9706
  9707 7000-END.
  9708     MOVE -1                     TO  MAINTL.
  9709     MOVE MAINTI                 TO  PI-MAINT.
  9710
  9711     IF MAINTI  = 'S'  OR  'D'
  9712       OR  RETURNING-FROM-6501
  9713         MOVE LOW-VALUES         TO  MAINTI
  9714         MOVE PI-ACCNAME         TO  NAMEO
  9715         MOVE PI-NAMEFLG         TO  NAMEFLGO
  9716         GO TO 8100-SEND-INITIAL-MAP.
  9717
  9718     IF EIBAID  =  DFHPF1  OR  DFHPF2  OR
  9719                   DFHPF3  OR  DFHPF4
  9720         MOVE 'S'                TO  PI-MAINT
  9721         MOVE PI-ACCNAME         TO  NAMEO
  9722         MOVE PI-NAMEFLG         TO  NAMEFLGO
  9723         GO TO 8100-SEND-INITIAL-MAP.
  9724
  9725     IF MAINTI  = 'N' OR 'E' OR 'X'
  9726        MOVE SPACES                 TO  BIN-EXPCHG-SAVE
  9727                                        BIN-EFFCHG-SAVE
  9728        MOVE SPACES                 TO  EFFCHGI
  9729                                        EXPCHGI
  9730        MOVE AL-UANOF               TO  EFFCHGA
  9731                                        EXPCHGA
  9732        MOVE SPACES                 TO  PI-MAINT
  9733        MOVE SPACES                 TO  MAINTI
  9734                                        MAINTO
  9735        MOVE AL-UANOF               TO  MAINTA.
  9736
  9737     IF K-WITH-LINE-NO
  9738         MOVE ZERO         TO K-WITH-LINE-USED
  9739         GO TO 8100-SEND-INITIAL-MAP.
  9740
  9741     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 202
* EL650.cbl
  9743 7100-START-BROWSE.
  9744
  9745* EXEC CICS  STARTBR
  9746*        DATASET  (PI-ACCT-ID)
  9747*        RIDFLD   (PI-ACCT-KEY)
  9748*    END-EXEC.
  9749     MOVE 0
  9750       TO DFHEIV11
  9751*    MOVE '&,         G          &   #00008539' TO DFHEIV0
  9752     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9753     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9754     MOVE X'2020233030303038353339' TO DFHEIV0(25:11)
  9755     CALL 'kxdfhei1' USING DFHEIV0,
  9756           PI-ACCT-ID,
  9757           PI-ACCT-KEY,
  9758           DFHEIV99,
  9759           DFHEIV11,
  9760           DFHEIV99
  9761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9762
  9763
  9764 7100-EXIT.
  9765     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 203
* EL650.cbl
  9767 7200-WRITE-TEMP-STORAGE.
  9768     PERFORM 7300-DELETE-TEMP-STORAGE  THRU  7300-EXIT.
  9769
  9770
  9771* EXEC CICS  HANDLE CONDITION
  9772*        ITEMERR  (7200-EXIT)
  9773*        QIDERR   (7200-EXIT)
  9774*    END-EXEC.
  9775*    MOVE '"$<N                  ! < #00008550' TO DFHEIV0
  9776     MOVE X'22243C4E2020202020202020' TO DFHEIV0(1:12)
  9777     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9778     MOVE X'3C20233030303038353530' TO DFHEIV0(25:11)
  9779     CALL 'kxdfhei1' USING DFHEIV0
  9780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9781
  9782
  9783     MOVE +0                     TO  TS-ITEM.
  9784
  9785
  9786* EXEC CICS  WRITEQ TS
  9787*        QUEUE   (TS-QUEUE)
  9788*        FROM    (TEMP-STORAGE-RECORD)
  9789*        LENGTH  (TS-LENGTH)
  9790*        ITEM    (TS-ITEM)
  9791*    END-EXEC.
  9792*    MOVE '*" I                  ''   #00008557' TO DFHEIV0
  9793     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
  9794     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9795     MOVE X'2020233030303038353537' TO DFHEIV0(25:11)
  9796     CALL 'kxdfhei1' USING DFHEIV0,
  9797           TS-QUEUE,
  9798           TEMP-STORAGE-RECORD,
  9799           TS-LENGTH,
  9800           TS-ITEM,
  9801           DFHEIV99,
  9802           DFHEIV99
  9803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9804
  9805
  9806 7200-EXIT.
  9807     EXIT.
  9808
  9809 7300-DELETE-TEMP-STORAGE.
  9810
  9811* EXEC CICS  HANDLE CONDITION
  9812*        ITEMERR  (7300-EXIT)
  9813*        QIDERR   (7300-EXIT)
  9814*    END-EXEC.
  9815*    MOVE '"$<N                  ! = #00008568' TO DFHEIV0
  9816     MOVE X'22243C4E2020202020202020' TO DFHEIV0(1:12)
  9817     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9818     MOVE X'3D20233030303038353638' TO DFHEIV0(25:11)
  9819     CALL 'kxdfhei1' USING DFHEIV0
  9820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9821
  9822
  9823
  9824* EXEC CICS  DELETEQ TS
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 204
* EL650.cbl
  9825*        QUEUE  (TS-QUEUE)
  9826*    END-EXEC.
  9827*    MOVE '*&                    #   #00008573' TO DFHEIV0
  9828     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  9829     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9830     MOVE X'2020233030303038353733' TO DFHEIV0(25:11)
  9831     CALL 'kxdfhei1' USING DFHEIV0,
  9832           TS-QUEUE,
  9833           DFHEIV99
  9834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9835
  9836
  9837 7300-EXIT.
  9838     EXIT.
  9839
  9840 7400-READ-TEMP-STORAGE.
  9841
  9842* EXEC CICS  HANDLE CONDITION
  9843*        ITEMERR  (7400-EXIT)
  9844*        QIDERR   (7400-EXIT)
  9845*    END-EXEC.
  9846*    MOVE '"$<N                  ! > #00008581' TO DFHEIV0
  9847     MOVE X'22243C4E2020202020202020' TO DFHEIV0(1:12)
  9848     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9849     MOVE X'3E20233030303038353831' TO DFHEIV0(25:11)
  9850     CALL 'kxdfhei1' USING DFHEIV0
  9851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9852
  9853
  9854     MOVE +1                     TO  TS-ITEM.
  9855
  9856
  9857* EXEC CICS  READQ TS
  9858*        QUEUE   (TS-QUEUE)
  9859*        INTO    (TEMP-STORAGE-RECORD)
  9860*        LENGTH  (TS-LENGTH)
  9861*        ITEM    (TS-ITEM)
  9862*    END-EXEC.
  9863*    MOVE '*$II   L              ''   #00008588' TO DFHEIV0
  9864     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  9865     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9866     MOVE X'2020233030303038353838' TO DFHEIV0(25:11)
  9867     CALL 'kxdfhei1' USING DFHEIV0,
  9868           TS-QUEUE,
  9869           TEMP-STORAGE-RECORD,
  9870           TS-LENGTH,
  9871           TS-ITEM,
  9872           DFHEIV99,
  9873           DFHEIV99
  9874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9875
  9876
  9877 7400-EXIT.
  9878     EXIT.
  9879
  9880 8100-SEND-INITIAL-MAP.
  9881     MOVE SAVE-DATE              TO  DATEO.
  9882     MOVE EIBTIME                TO  TIME-IN.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 205
* EL650.cbl
  9883     MOVE TIME-OUT               TO  TIMEO.
  9884     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  9885     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  9886     MOVE -1                     TO  MAINTL.
  9887     MOVE AL-UABON               TO  MAINTA.
  9888     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  9889     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  9890
  9891     IF PI-AR-PROCESSING
  9892        MOVE AL-PANOF            TO  ARHDGA.
  9893
  9894
  9895* EXEC CICS  SEND
  9896*        MAP     (MAP-NAME)
  9897*        MAPSET  (MAPSET-NAME)
  9898*        FROM    (EL650AO)
  9899*        ERASE
  9900*        CURSOR
  9901*    END-EXEC.
  9902     MOVE LENGTH OF
  9903      EL650AO
  9904       TO DFHEIV12
  9905     MOVE -1
  9906       TO DFHEIV11
  9907*    MOVE '8$     CT  E    H L F ,   #00008612' TO DFHEIV0
  9908     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  9909     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9910     MOVE X'2020233030303038363132' TO DFHEIV0(25:11)
  9911     CALL 'kxdfhei1' USING DFHEIV0,
  9912           MAP-NAME,
  9913           EL650AO,
  9914           DFHEIV12,
  9915           MAPSET-NAME,
  9916           DFHEIV99,
  9917           DFHEIV99,
  9918           DFHEIV99,
  9919           DFHEIV11,
  9920           DFHEIV99,
  9921           DFHEIV99,
  9922           DFHEIV99
  9923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9924
  9925
  9926     GO TO 9100-RETURN-TRAN.
  9927
  9928 8200-SEND-DATAONLY.
  9929     MOVE SAVE-DATE              TO  DATEO.
  9930     MOVE EIBTIME                TO  TIME-IN.
  9931     MOVE TIME-OUT               TO  TIMEO.
  9932     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  9933     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  9934     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  9935     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  9936
  9937
  9938* EXEC CICS  SEND
  9939*        MAP     (MAP-NAME)
  9940*        MAPSET  (MAPSET-NAME)
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 206
* EL650.cbl
  9941*        FROM    (EL650AO)
  9942*        DATAONLY
  9943*        CURSOR
  9944*    END-EXEC.
  9945     MOVE LENGTH OF
  9946      EL650AO
  9947       TO DFHEIV12
  9948     MOVE -1
  9949       TO DFHEIV11
  9950*    MOVE '8$D    CT       H L F ,   #00008631' TO DFHEIV0
  9951     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  9952     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9953     MOVE X'2020233030303038363331' TO DFHEIV0(25:11)
  9954     CALL 'kxdfhei1' USING DFHEIV0,
  9955           MAP-NAME,
  9956           EL650AO,
  9957           DFHEIV12,
  9958           MAPSET-NAME,
  9959           DFHEIV99,
  9960           DFHEIV99,
  9961           DFHEIV99,
  9962           DFHEIV11,
  9963           DFHEIV99,
  9964           DFHEIV99,
  9965           DFHEIV99
  9966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9967
  9968
  9969     GO TO 9100-RETURN-TRAN.
  9970
  9971 8300-SEND-TEXT.
  9972
  9973* EXEC CICS  SEND TEXT
  9974*        FROM    (LOGOFF-TEXT)
  9975*        LENGTH  (LOGOFF-LENGTH)
  9976*        ERASE
  9977*        FREEKB
  9978*    END-EXEC.
  9979*    MOVE '8&      T  E F  H   F -   #00008642' TO DFHEIV0
  9980     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  9981     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  9982     MOVE X'2020233030303038363432' TO DFHEIV0(25:11)
  9983     CALL 'kxdfhei1' USING DFHEIV0,
  9984           LOGOFF-TEXT,
  9985           LOGOFF-LENGTH,
  9986           DFHEIV99,
  9987           DFHEIV99,
  9988           DFHEIV99,
  9989           DFHEIV99,
  9990           DFHEIV99,
  9991           DFHEIV99,
  9992           DFHEIV99,
  9993           DFHEIV99,
  9994           DFHEIV99,
  9995           DFHEIV99
  9996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9997
  9998
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 207
* EL650.cbl
  9999
 10000* EXEC CICS  RETURN
 10001*    END-EXEC.
 10002*    MOVE '.(                    ''   #00008649' TO DFHEIV0
 10003     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 10004     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10005     MOVE X'2020233030303038363439' TO DFHEIV0(25:11)
 10006     CALL 'kxdfhei1' USING DFHEIV0,
 10007           DFHEIV99,
 10008           DFHEIV99,
 10009           DFHEIV99,
 10010           DFHEIV99,
 10011           DFHEIV99,
 10012           DFHEIV99
 10013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10014
 10015
 10016 8400-LOG-JOURNAL-RECORD.
 10017*    MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
 10018*    MOVE FILE-ID                TO  JP-FILE-ID.
 10019*    MOVE THIS-PGM               TO  JP-PROGRAM-ID.
 10020*
 10021*    IF PI-JOURNAL-FILE-ID  NOT =  ZERO
 10022*        EXEC CICS  JOURNAL
 10023*            JFILEID  (PI-JOURNAL-FILE-ID)
 10024*            JTYPEID  ('ER')
 10025*            FROM     (JOURNAL-RECORD)
 10026*            LENGTH   (2023)
 10027*        END-EXEC.
 10028
 10029 8600-DEEDIT.
 10030
 10031* EXEC CICS  BIF DEEDIT
 10032*        FIELD   (WS-DEEDIT-FIELD)
 10033*        LENGTH  (10)
 10034*    END-EXEC.
 10035     MOVE 10
 10036       TO DFHEIV11
 10037*    MOVE '@"L                   #   #00008666' TO DFHEIV0
 10038     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10039     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10040     MOVE X'2020233030303038363636' TO DFHEIV0(25:11)
 10041     CALL 'kxdfhei1' USING DFHEIV0,
 10042           WS-DEEDIT-FIELD,
 10043           DFHEIV11
 10044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10045
 10046 8600-EXIT.
 10047      EXIT.
 10048 8800-UNAUTHORIZED-ACCESS.
 10049     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
 10050
 10051     GO TO 8300-SEND-TEXT.
 10052
 10053 8810-PF23.
 10054     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
 10055     MOVE XCTL-005               TO  PGM-NAME.
 10056
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 208
* EL650.cbl
 10057     GO TO 9300-XCTL.
 10058
 10059 8900-PF5.
 10060     IF PI-PREV-VG-ACCOUNT EQUAL LOW-VALUES OR SPACES
 10061         MOVE ER-3785            TO  EMI-ERROR
 10062         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 10063         MOVE -1                 TO  MAINTL
 10064         GO TO 8200-SEND-DATAONLY.
 10065
 10066     MOVE PI-PREV-VG-ACCOUNT     TO  PI-ACCT-CCGSA-KEY.
 10067
 10068     MOVE XCTL-6509              TO  PGM-NAME.
 10069
 10070     GO TO 9300-XCTL.
 10071
 10072 8910-PF6.
 10073     IF PI-PREV-VG-ACCOUNT EQUAL LOW-VALUES OR SPACES
 10074        MOVE ER-3785             TO EMI-ERROR
 10075        PERFORM 9900-ERROR-FORMAT
 10076                                 THRU 9900-EXIT
 10077        MOVE -1                  TO MAINTL
 10078        GO TO 8200-SEND-DATAONLY
 10079     END-IF
 10080     MOVE PI-PREV-VG-ACCOUNT     TO PI-ACCT-CCGSA-KEY
 10081     MOVE XCTL-6503              TO PGM-NAME
 10082     GO TO 9300-XCTL
 10083     .
 10084 9100-RETURN-TRAN.
 10085     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
 10086     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
 10087
 10088* EXEC CICS  RETURN
 10089*        TRANSID   (TRANS-ID)
 10090*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 10091*        LENGTH    (WS-COMM-LENGTH)
 10092*    END-EXEC.
 10093*    MOVE '.(CT                  ''   #00008711' TO DFHEIV0
 10094     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 10095     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10096     MOVE X'2020233030303038373131' TO DFHEIV0(25:11)
 10097     CALL 'kxdfhei1' USING DFHEIV0,
 10098           TRANS-ID,
 10099           PROGRAM-INTERFACE-BLOCK,
 10100           WS-COMM-LENGTH,
 10101           DFHEIV99,
 10102           DFHEIV99,
 10103           DFHEIV99
 10104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10105
 10106
 10107 9200-RETURN-MAIN-MENU.
 10108     MOVE XCTL-126               TO  PGM-NAME.
 10109
 10110     GO TO 9300-XCTL.
 10111
 10112 9300-XCTL.
 10113
 10114* EXEC CICS  XCTL
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 209
* EL650.cbl
 10115*        PROGRAM   (PGM-NAME)
 10116*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 10117*        LENGTH    (WS-COMM-LENGTH)
 10118*    END-EXEC.
 10119*    MOVE '.$C                   %   #00008723' TO DFHEIV0
 10120     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10121     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10122     MOVE X'2020233030303038373233' TO DFHEIV0(25:11)
 10123     CALL 'kxdfhei1' USING DFHEIV0,
 10124           PGM-NAME,
 10125           PROGRAM-INTERFACE-BLOCK,
 10126           WS-COMM-LENGTH,
 10127           DFHEIV99
 10128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10129
 10130
 10131 9400-CLEAR.
 10132     MOVE SPACES                 TO  PI-SV-MAINT.
 10133     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
 10134
 10135     GO TO 9300-XCTL.
 10136
 10137 9500-PF12.
 10138     MOVE XCTL-010               TO  PGM-NAME.
 10139
 10140     GO TO 9300-XCTL.
 10141
 10142 9600-PGMID-ERROR.
 10143
 10144* EXEC CICS  HANDLE CONDITION
 10145*        PGMIDERR  (8300-SEND-TEXT)
 10146*    END-EXEC.
 10147*    MOVE '"$L                   ! ? #00008741' TO DFHEIV0
 10148     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10149     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10150     MOVE X'3F20233030303038373431' TO DFHEIV0(25:11)
 10151     CALL 'kxdfhei1' USING DFHEIV0
 10152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10153
 10154
 10155     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
 10156     MOVE ' '                    TO  PI-ENTRY-CD-1.
 10157     MOVE XCTL-005               TO  PGM-NAME.
 10158     MOVE PGM-NAME               TO  LOGOFF-PGM.
 10159     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
 10160
 10161     GO TO 9300-XCTL.
 10162
 10163 9700-DATE-CONVERSION.
 10164     MOVE LINK-ELDATCV           TO  PGM-NAME.
 10165
 10166
 10167* EXEC CICS  LINK
 10168*        PROGRAM   (PGM-NAME)
 10169*        COMMAREA  (DATE-CONVERSION-DATA)
 10170*        LENGTH    (DC-COMM-LENGTH)
 10171*    END-EXEC.
 10172*    MOVE '."C                   (   #00008756' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 210
* EL650.cbl
 10173     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10174     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10175     MOVE X'2020233030303038373536' TO DFHEIV0(25:11)
 10176     CALL 'kxdfhei1' USING DFHEIV0,
 10177           PGM-NAME,
 10178           DATE-CONVERSION-DATA,
 10179           DC-COMM-LENGTH,
 10180           DFHEIV99,
 10181           DFHEIV99,
 10182           DFHEIV99,
 10183           DFHEIV99
 10184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10185
 10186
 10187 9900-ERROR-FORMAT.
 10188     IF NOT EMI-ERRORS-COMPLETE
 10189         MOVE LINK-001           TO  PGM-NAME
 10190
 10191* EXEC CICS  LINK
 10192*            PROGRAM   (PGM-NAME)
 10193*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
 10194*            LENGTH    (EMI-COMM-LENGTH)
 10195*        END-EXEC.
 10196*    MOVE '."C                   (   #00008765' TO DFHEIV0
 10197     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10198     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10199     MOVE X'2020233030303038373635' TO DFHEIV0(25:11)
 10200     CALL 'kxdfhei1' USING DFHEIV0,
 10201           PGM-NAME,
 10202           ERROR-MESSAGE-INTERFACE-BLOCK,
 10203           EMI-COMM-LENGTH,
 10204           DFHEIV99,
 10205           DFHEIV99,
 10206           DFHEIV99,
 10207           DFHEIV99
 10208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10209
 10210
 10211 9900-EXIT.
 10212     EXIT.
 10213
 10214 9990-ABEND.
 10215     MOVE LINK-004               TO  PGM-NAME.
 10216     MOVE DFHEIBLK               TO  EMI-LINE1.
 10217
 10218
 10219* EXEC CICS  LINK
 10220*        PROGRAM   (PGM-NAME)
 10221*        COMMAREA  (EMI-LINE1)
 10222*        LENGTH    (72)
 10223*    END-EXEC.
 10224     MOVE 72
 10225       TO DFHEIV11
 10226*    MOVE '."C                   (   #00008778' TO DFHEIV0
 10227     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10228     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10229     MOVE X'2020233030303038373738' TO DFHEIV0(25:11)
 10230     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 211
* EL650.cbl
 10231           PGM-NAME,
 10232           EMI-LINE1,
 10233           DFHEIV11,
 10234           DFHEIV99,
 10235           DFHEIV99,
 10236           DFHEIV99,
 10237           DFHEIV99
 10238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10239
 10240
 10241     MOVE -1                     TO  MAINTL.
 10242
 10243     GO TO 8200-SEND-DATAONLY.
 10244
 10245 9995-SECURITY-VIOLATION.
 10246*                            COPY ELCSCTP.
 10247******************************************************************
 10248*                                                                *
 10249*                            ELCSCTP                             *
 10250*                            VMOD=2.001                          *
 10251*                                                                *
 10252*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10253******************************************************************
 10254
 10255
 10256     MOVE EIBDATE          TO SM-JUL-DATE.
 10257     MOVE EIBTRMID         TO SM-TERMID.
 10258     MOVE THIS-PGM         TO SM-PGM.
 10259     MOVE EIBTIME          TO TIME-IN.
 10260     MOVE TIME-OUT         TO SM-TIME.
 10261     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10262
 10263
 10264* EXEC CICS LINK
 10265*         PROGRAM  ('EL003')
 10266*         COMMAREA (SECURITY-MESSAGE)
 10267*         LENGTH   (80)
 10268*    END-EXEC.
 10269     MOVE 'EL003' TO DFHEIV1
 10270     MOVE 80
 10271       TO DFHEIV11
 10272*    MOVE '."C                   (   #00008806' TO DFHEIV0
 10273     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10274     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10275     MOVE X'2020233030303038383036' TO DFHEIV0(25:11)
 10276     CALL 'kxdfhei1' USING DFHEIV0,
 10277           DFHEIV1,
 10278           SECURITY-MESSAGE,
 10279           DFHEIV11,
 10280           DFHEIV99,
 10281           DFHEIV99,
 10282           DFHEIV99,
 10283           DFHEIV99
 10284     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10285
 10286
 10287******************************************************************
 10288
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 212
* EL650.cbl
 10289
 10290 9995-EXIT.
 10291     EXIT.
 10292
 10293 9999-DFHBACK SECTION.
 10294     MOVE '9%                    "   ' TO DFHEIV0
 10295     MOVE 'EL650' TO DFHEIV1
 10296     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10297     GOBACK.
 10298 9999-DFHEXIT.
 10299     IF DFHEIGDJ EQUAL 0001
 10300         NEXT SENTENCE
 10301     ELSE IF DFHEIGDJ EQUAL 2
 10302         GO TO 5340-END,
 10303               5330-NOT-FOUND
 10304         DEPENDING ON DFHEIGDI
 10305     ELSE IF DFHEIGDJ EQUAL 3
 10306         GO TO 9600-PGMID-ERROR,
 10307               9990-ABEND
 10308         DEPENDING ON DFHEIGDI
 10309     ELSE IF DFHEIGDJ EQUAL 4
 10310         GO TO 1010-NOT-FOUND,
 10311               1010-NOT-FOUND
 10312         DEPENDING ON DFHEIGDI
 10313     ELSE IF DFHEIGDJ EQUAL 5
 10314         GO TO 2568-NO-RECORDS,
 10315               2568-NO-RECORDS
 10316         DEPENDING ON DFHEIGDI
 10317     ELSE IF DFHEIGDJ EQUAL 6
 10318         GO TO 3175-CONTINUE,
 10319               3175-CONTINUE
 10320         DEPENDING ON DFHEIGDI
 10321     ELSE IF DFHEIGDJ EQUAL 7
 10322         GO TO 4175-CONTINUE,
 10323               4175-CONTINUE
 10324         DEPENDING ON DFHEIGDI
 10325     ELSE IF DFHEIGDJ EQUAL 8
 10326         GO TO 4530-NOT-FOUND,
 10327               4530-NOT-FOUND
 10328         DEPENDING ON DFHEIGDI
 10329     ELSE IF DFHEIGDJ EQUAL 9
 10330         GO TO 4699-EXIT,
 10331               4689-EOF
 10332         DEPENDING ON DFHEIGDI
 10333     ELSE IF DFHEIGDJ EQUAL 10
 10334         GO TO 4899-EXIT,
 10335               4889-EOF
 10336         DEPENDING ON DFHEIGDI
 10337     ELSE IF DFHEIGDJ EQUAL 11
 10338         GO TO 4580-DUPREC,
 10339               4580-DUPREC
 10340         DEPENDING ON DFHEIGDI
 10341     ELSE IF DFHEIGDJ EQUAL 12
 10342         GO TO 4959-EXIT,
 10343               4959-EXIT
 10344         DEPENDING ON DFHEIGDI
 10345     ELSE IF DFHEIGDJ EQUAL 13
 10346         GO TO 4969-EXIT,
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 213
* EL650.cbl
 10347               4969-EXIT
 10348         DEPENDING ON DFHEIGDI
 10349     ELSE IF DFHEIGDJ EQUAL 14
 10350         GO TO 4980-EXIT
 10351         DEPENDING ON DFHEIGDI
 10352     ELSE IF DFHEIGDJ EQUAL 15
 10353         GO TO 5007-EXIT,
 10354               5007-EXIT
 10355         DEPENDING ON DFHEIGDI
 10356     ELSE IF DFHEIGDJ EQUAL 16
 10357         GO TO 5007-EXIT,
 10358               5007-EXIT,
 10359               5007-EXIT,
 10360               5007-EXIT,
 10361               5007-EXIT
 10362         DEPENDING ON DFHEIGDI
 10363     ELSE IF DFHEIGDJ EQUAL 17
 10364         GO TO 5015-NOT-FOUND,
 10365               5015-NOT-FOUND
 10366         DEPENDING ON DFHEIGDI
 10367     ELSE IF DFHEIGDJ EQUAL 18
 10368         GO TO 5015-NOT-FOUND,
 10369               5015-NOT-FOUND
 10370         DEPENDING ON DFHEIGDI
 10371     ELSE IF DFHEIGDJ EQUAL 19
 10372         GO TO 5340-END,
 10373               5330-NOT-FOUND
 10374         DEPENDING ON DFHEIGDI
 10375     ELSE IF DFHEIGDJ EQUAL 20
 10376         GO TO 5440-NOT-FOUND,
 10377               5430-NOT-FOUND
 10378         DEPENDING ON DFHEIGDI
 10379     ELSE IF DFHEIGDJ EQUAL 21
 10380         GO TO 5525-SKIP-REWRITE,
 10381               5525-SKIP-REWRITE
 10382         DEPENDING ON DFHEIGDI
 10383     ELSE IF DFHEIGDJ EQUAL 22
 10384         GO TO 5615-SKIP-REWRITE,
 10385               5615-SKIP-REWRITE
 10386         DEPENDING ON DFHEIGDI
 10387     ELSE IF DFHEIGDJ EQUAL 23
 10388         GO TO 6599-EXIT
 10389         DEPENDING ON DFHEIGDI
 10390     ELSE IF DFHEIGDJ EQUAL 24
 10391         GO TO 6699-EXIT
 10392         DEPENDING ON DFHEIGDI
 10393     ELSE IF DFHEIGDJ EQUAL 25
 10394         GO TO 6720-NO-CARRIER
 10395         DEPENDING ON DFHEIGDI
 10396     ELSE IF DFHEIGDJ EQUAL 26
 10397         GO TO 6780-NO-STATE
 10398         DEPENDING ON DFHEIGDI
 10399     ELSE IF DFHEIGDJ EQUAL 27
 10400         GO TO 6880-NO-COMP
 10401         DEPENDING ON DFHEIGDI
 10402     ELSE IF DFHEIGDJ EQUAL 28
 10403         GO TO 7200-EXIT,
 10404               7200-EXIT
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 14:02 Page 214
* EL650.cbl
 10405         DEPENDING ON DFHEIGDI
 10406     ELSE IF DFHEIGDJ EQUAL 29
 10407         GO TO 7300-EXIT,
 10408               7300-EXIT
 10409         DEPENDING ON DFHEIGDI
 10410     ELSE IF DFHEIGDJ EQUAL 30
 10411         GO TO 7400-EXIT,
 10412               7400-EXIT
 10413         DEPENDING ON DFHEIGDI
 10414     ELSE IF DFHEIGDJ EQUAL 31
 10415         GO TO 8300-SEND-TEXT
 10416         DEPENDING ON DFHEIGDI.
 10417     MOVE '9%                    "   ' TO DFHEIV0
 10418     MOVE 'EL650' TO DFHEIV1
 10419     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10420     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       40228     Code:       34338
