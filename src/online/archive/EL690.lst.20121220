* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL690.cbl
* Options: int("EL690.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL690.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL690.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL690.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL690 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/12/96 10:00:53.
     7*                            VMOD=2.005
     8*
     9*
    10*AUTHOR.        LOGIC,INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL690.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*       TRANSACTION - EXM3 - CREDIT SYSTEM CORRESPONDENCE REVIEW
    27*
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    37*                              ADJUSTED REDEFINES EL690AI FILLER
    38* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    39* 070711    2011022800001  AJRA  NAPERSOFT CHANGES
    40* 012312    2011022800001  AJRA  NAPERSOFT CHANGES
    41* 101512    2011022800001  AJRA  FIX LIST FOR SAME CERT DIFF EFF D
    42******************************************************************
    43
    44 ENVIRONMENT DIVISION.
    45 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL690.cbl
    47 WORKING-STORAGE SECTION.
    48 01  DFH-START PIC X(04).
    49 77  FILLER   PIC  X(32) VALUE '*******************************'.
    50 77  FILLER   PIC  X(32) VALUE '*    EL690 WORKING STORAGE    *'.
    51 77  FILLER   PIC  X(32) VALUE '********* VMOD=2.005 **********'.
    52
    53 01  W-PROGRAM-CONSTANTS.
    54     12  FILLER                  PIC  X(18)
    55                                 VALUE 'PROGRAM CONSTANTS:'.
    56     12  W-APPL-SCRTY-NDX        PIC S9(04)  VALUE +3    COMP.
    57
    58     12  W-ARCH-FILE-ID          PIC  X(08)  VALUE 'ERARCH'.
    59     12  W-ARCH2-FILE-ID         PIC  X(08)  VALUE 'ERARCH2'.
    60     12  W-ARCH3-FILE-ID         PIC  X(08)  VALUE 'ERARCH3'.
    61     12  W-ARCH4-FILE-ID         PIC  X(08)  VALUE 'ERARCH4'.
    62     12  W-ARCH5-FILE-ID         PIC  X(08)  VALUE 'ERARCH5'.
    63     12  W-ARCH6-FILE-ID         PIC  X(08)  VALUE 'ERARCH6'.
    64     12  W-ARCT-FILE-ID          PIC  X(08)  VALUE 'ERARCT'.
    65     12  W-CNTL-FILE-ID          PIC  X(08)  VALUE 'ELCNTL'.
    66     12  W-LINK-001              PIC  X(08)  VALUE 'EL001'.
    67     12  W-LINK-004              PIC  X(08)  VALUE 'EL004'.
    68     12  W-MAP                   PIC  X(08)  VALUE 'EL690A'.
    69     12  W-MAP-REDEFINE  REDEFINES   W-MAP.
    70         16  FILLER              PIC  X(02).
    71         16  W-MAP-NUM           PIC  X(06).
    72     12  W-MAPSET                PIC  X(08)  VALUE 'EL690S'.
    73     12  W-THIS-PGM              PIC  X(08)  VALUE 'EL690'.
    74     12  W-TRANSACTION           PIC  X(04)  VALUE 'EXM3'.
    75     12  W-XCTL-005              PIC  X(08)  VALUE 'EL005'.
    76     12  W-XCTL-010              PIC  X(08)  VALUE 'EL010'.
    77     12  W-XCTL-153              PIC  X(08)  VALUE 'EL690'.
    78     12  W-XCTL-626              PIC  X(08)  VALUE 'EL626'.
    79     12  W-XCTL-689              PIC  X(08)  VALUE 'EL689'.
    80     12  W-XCTL-691              PIC  X(08)  VALUE 'EL691'.
    81
    82 01  W-WORK-AREAS.
    83     12  FILLER                  PIC  X(11)
    84                                      VALUE 'WORK AREAS:'.
    85
    86     12  W-ARCH-NDX              PIC S9(04)  COMP.
    87     12  W-ARCH-NDX2             PIC S9(04)  COMP.
    88     12  W-ARCH-NDX3             PIC S9(04)  COMP.
    89     12  W-ARCH-NUMBER           PIC S9(08)  COMP.
    90     12  W-HOLD-ARCHIVE          PIC S9(08)  COMP.
    91     12  W-KEY-NDX               PIC S9(04)  COMP.
    92     12  W-LAST-ERROR            PIC  9(04)  VALUE 9999.
    93
    94     12  W-CALL-PGM              PIC  X(08)  VALUE SPACES.
    95
    96     12  W-DEEDIT-FIELD          PIC  X(15).
    97     12  W-DEEDIT-FIELD-V0 REDEFINES W-DEEDIT-FIELD
    98                                 PIC S9(15).
    99
   100     12  W-HOLD-LINE             PIC X(100).
   101     12  W-RETURNED-FROM         PIC  X(08)  VALUE SPACES.
   102     12  W-RESEND-DATE-1         PIC  X(02)  VALUE SPACES.
   103     12  W-RESEND-DATE-2         PIC  X(02)  VALUE SPACES.
   104     12  W-RESEND-DATE-3         PIC  X(02)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL690.cbl
   105     12  W-REPLY-DATE            PIC  X(02)  VALUE SPACES.
   106     12  W-SAVE-BIN-DATE         PIC  X(02)  VALUE SPACES.
   107     12  W-SAVE-DATE             PIC  X(08)  VALUE SPACES.
   108     12  W-STATUS                PIC  X(01)  VALUE SPACES.
   109
   110     12  W-TIME-IN               PIC S9(07).
   111     12  FILLER REDEFINES W-TIME-IN.
   112         16  FILLER              PIC  X(01).
   113         16  W-TIME-OUT          PIC  9(02)V9(02).
   114         16  FILLER              PIC  X(02).
   115
   116 01  W-KEY-FIELDS.
   117     12  FILLER                  PIC  X(11)
   118                                      VALUE 'KEY FIELDS:'.
   119     12  W-CNTL-KEY.
   120         16  W-CNTL-COMPANY-ID   PIC  X(03).
   121         16  W-CNTL-RECORD-TYPE  PIC  X(01).
   122         16  FILLER              PIC  X(04).
   123         16  W-CNTL-SEQ          PIC S9(04) COMP.
   124     12  W-QUID-KEY.
   125         16  W-QUID-TERMINAL     PIC  X(04).
   126         16  W-QUID-MAP-NUM      PIC  X(04).
   127*
   128*    12  W-SC-QUID-KEY.
   129*        16  W-SC-QUID-TERMINAL  PIC  X(04).
   130*        16  W-SC-QUID-SYSTEM    PIC  X(04).
   131
   132     12  W-ARCH-KEY.
   133         16  W-ARCH-COMPANY-CD   PIC  X(01).
   134         16  W-ARCH-ARCHIVE-NO   PIC S9(08) COMP.
   135
   136     12  W-ARCH2-KEY.
   137         16  W-ARCH2-COMPANY-CD  PIC  X(01).
   138         16  W-ARCH2-CSCSAE-KEYLET.
   139             20  W-ARCH2-CERT-PRIME
   140                                 PIC  X(10).
   141             20  W-ARCH2-SUFFIX  PIC  X(01).
   142             20  W-ARCH2-CARRIER PIC  X(01).
   143             20  W-ARCH2-GROUPING
   144                                 PIC  X(06).
   145             20  W-ARCH2-STATE   PIC  X(02).
   146             20  W-ARCH2-ACCOUNT PIC  X(10).
   147             20  W-ARCH2-EFF-DTE PIC  X(02).
   148         16  W-ARCH2-ARCHIVE-NO  PIC S9(08) COMP.
   149
   150     12  W-ARCH3-KEY.
   151         16  W-ARCH3-COMPANY-CD  PIC  X(01).
   152         16  W-ARCH3-FCGSA-KEYLET.
   153             20  W-ARCH3-FORM    PIC  X(04).
   154             20  W-ARCH3-CARRIER PIC  X(01).
   155             20  W-ARCH3-GROUPING
   156                                 PIC  X(06).
   157             20  W-ARCH3-STATE   PIC  X(02).
   158             20  W-ARCH3-ACCOUNT PIC  X(10).
   159         16  W-ARCH3-ARCHIVE-NO  PIC S9(08) COMP.
   160
   161     12  W-ARCH4-KEY.
   162         16  W-ARCH4-COMPANY-CD  PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL690.cbl
   163         16  W-ARCH4-PCGSA-KEYLET.
   164             20  W-ARCH4-PROCESSOR
   165                                 PIC  X(04).
   166             20  W-ARCH4-CARRIER PIC  X(01).
   167             20  W-ARCH4-GROUPING
   168                                 PIC  X(06).
   169             20  W-ARCH4-STATE   PIC  X(02).
   170             20  W-ARCH4-ACCOUNT PIC  X(10).
   171         16  W-ARCH4-ARCHIVE-NO  PIC S9(08) COMP.
   172
   173     12  W-ARCH5-KEY.
   174         16  W-ARCH5-COMPANY-CD  PIC  X(01).
   175         16  W-ARCH5-CGSA-KEYLET.
   176             20  W-ARCH5-CARRIER PIC  X(01).
   177             20  W-ARCH5-GROUPING
   178                                 PIC  X(06).
   179             20  W-ARCH5-STATE   PIC  X(02).
   180             20  W-ARCH5-ACCOUNT PIC  X(10).
   181         16  W-ARCH5-ARCHIVE-NO  PIC S9(08) COMP.
   182
   183     12  W-ARCH6-KEY.
   184         16  W-ARCH6-COMPANY-CD  PIC  X(01).
   185         16  W-ARCH6-ENTRY.
   186             20  W-ARCH6-FILLER  PIC  X(02).
   187             20  W-ARCH6-QUE-CONTROL
   188                                 PIC S9(08) COMP.
   189         16  W-ARCH6-ARCHIVE-NO  PIC S9(08) COMP.
   190
   191     12  W-ARCT-KEY.
   192         16  W-ARCT-COMPANY-CD   PIC  X(01).
   193         16  W-ARCT-ARCHIVE-NO   PIC S9(08) COMP.
   194         16  W-ARCT-RECORD-TYPE  PIC  X(01).
   195             88  W-ARCT-ADDRESS-DATA   VALUE '1'.
   196             88  W-ARCT-TEXT-DATA      VALUE '2'.
   197         16  W-ARCT-LINE-SEQ-NO  PIC S9(04) COMP.
   198
   199     12  FILLER                      PIC  X(28).
   200     12  LT-NUM-LINES-ON-RECORD      PIC S9(04)    COMP.
   201
   202     12  LT-TEXT-RECORD.
   203         16  LT-LETTER-TEXT OCCURS 20 TIMES
   204                            INDEXED BY LT-NDX.
   205             20  LT-TEXT-LINE        PIC  X(70).
   206             20  LT-SKIP-CONTROL     PIC  X(02).
   207                 88  LT-NO-LINES-SKIPPED             VALUE SPACES.
   208                 88  LT-SKIP-TO-NEXT-PAGE            VALUE '99'.
   209             20  FILLER              PIC  X(08).
   210
   211
   212 01  W-PROGRAM-SWITCHES.
   213     12  FILLER                  PIC  X(09)
   214                                      VALUE 'SWITCHES:'.
   215     12  W-CHANGE-REQUESTED-IND  PIC  X(01)  VALUE SPACES.
   216         88  W-CHANGE-REQUESTED       VALUE 'Y'.
   217         88  W-NO-CHANGES-MADE        VALUE SPACES.
   218     12  W-FIRST-CHANGE-IND      PIC  9(02)  VALUE ZEROS.
   219         88  W-FIRST-CHANGE-FOUND     VALUES 01 THRU 12.
   220         88  W-NO-FIRST-CHANGE        VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL690.cbl
   221     12  W-READ-PREV-TWICE-IND   PIC  X(01)  VALUE SPACES.
   222         88  W-READ-PREV-TWICE        VALUE 'Y'.
   223     12  W-VALID-STATUS-SW       PIC  X(01).
   224         88  W-ALLOWED-ENTRIES        VALUE 'A' 'H' '+' '#' '@'
   225                                            'X' 'V'.
   226         88  W-VALID-STATUS           VALUE 'A' 'H'
   227                                            'P' 'X' 'V' 'C'.
   228         88  W-ACTIVE                 VALUE 'A'.
   229         88  W-COMPLETED              VALUE 'C'.
   230         88  W-VOIDED                 VALUE 'V'.
   231         88  W-TO-BE-PURGED-STATUS    VALUE 'X'.
   232         88  W-PURGED-STATUS          VALUE 'P'.
   233         88  W-SPECIAL-STATUS         VALUE '+'.
   234         88  W-CLEAR-INITIAL          VALUE '#'.
   235         88  W-CHECK-STATUS           VALUE '@'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL690.cbl
   237 01  FILLER                      PIC  X(14)
   238                                      VALUE 'PGRM MAP AREA:'.
   239*    COPY EL690S.
   240 01  EL690AI.
   241     05  FILLER            PIC  X(0012).
   242*    -------------------------------
   243     05  RUNDTEL PIC S9(0004) COMP.
   244     05  RUNDTEF PIC  X(0001).
   245     05  FILLER REDEFINES RUNDTEF.
   246         10  RUNDTEA PIC  X(0001).
   247     05  RUNDTEI PIC  X(0008).
   248*    -------------------------------
   249     05  RUNTIMEL PIC S9(0004) COMP.
   250     05  RUNTIMEF PIC  X(0001).
   251     05  FILLER REDEFINES RUNTIMEF.
   252         10  RUNTIMEA PIC  X(0001).
   253     05  RUNTIMEI PIC  X(0005).
   254*    -------------------------------
   255     05  COMPANYL PIC S9(0004) COMP.
   256     05  COMPANYF PIC  X(0001).
   257     05  FILLER REDEFINES COMPANYF.
   258         10  COMPANYA PIC  X(0001).
   259     05  COMPANYI PIC  X(0003).
   260*    -------------------------------
   261     05  USERIDL PIC S9(0004) COMP.
   262     05  USERIDF PIC  X(0001).
   263     05  FILLER REDEFINES USERIDF.
   264         10  USERIDA PIC  X(0001).
   265     05  USERIDI PIC  X(0004).
   266*    -------------------------------
   267     05  MAINTL PIC S9(0004) COMP.
   268     05  MAINTF PIC  X(0001).
   269     05  FILLER REDEFINES MAINTF.
   270         10  MAINTA PIC  X(0001).
   271     05  MAINTI PIC  X(0001).
   272*    -------------------------------
   273     05  TYPEBRL PIC S9(0004) COMP.
   274     05  TYPEBRF PIC  X(0001).
   275     05  FILLER REDEFINES TYPEBRF.
   276         10  TYPEBRA PIC  X(0001).
   277     05  TYPEBRI PIC  X(0001).
   278*    -------------------------------
   279     05  CERTRPL PIC S9(0004) COMP.
   280     05  CERTRPF PIC  X(0001).
   281     05  FILLER REDEFINES CERTRPF.
   282         10  CERTRPA PIC  X(0001).
   283     05  CERTRPI PIC  X(0010).
   284*    -------------------------------
   285     05  SUFFIXL PIC S9(0004) COMP.
   286     05  SUFFIXF PIC  X(0001).
   287     05  FILLER REDEFINES SUFFIXF.
   288         10  SUFFIXA PIC  X(0001).
   289     05  SUFFIXI PIC  X(0001).
   290*    -------------------------------
   291     05  FORML PIC S9(0004) COMP.
   292     05  FORMF PIC  X(0001).
   293     05  FILLER REDEFINES FORMF.
   294         10  FORMA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL690.cbl
   295     05  FORMI PIC  X(0004).
   296*    -------------------------------
   297     05  ENTRYL PIC S9(0004) COMP.
   298     05  ENTRYF PIC  X(0001).
   299     05  FILLER REDEFINES ENTRYF.
   300         10  ENTRYA PIC  X(0001).
   301     05  ENTRYI PIC  X(0006).
   302*    -------------------------------
   303     05  CKCNTLL PIC S9(0004) COMP.
   304     05  CKCNTLF PIC  X(0001).
   305     05  FILLER REDEFINES CKCNTLF.
   306         10  CKCNTLA PIC  X(0001).
   307     05  CKCNTLI PIC  9(8).
   308*    -------------------------------
   309     05  CARRIERL PIC S9(0004) COMP.
   310     05  CARRIERF PIC  X(0001).
   311     05  FILLER REDEFINES CARRIERF.
   312         10  CARRIERA PIC  X(0001).
   313     05  CARRIERI PIC  X(0001).
   314*    -------------------------------
   315     05  GROUPL PIC S9(0004) COMP.
   316     05  GROUPF PIC  X(0001).
   317     05  FILLER REDEFINES GROUPF.
   318         10  GROUPA PIC  X(0001).
   319     05  GROUPI PIC  X(0006).
   320*    -------------------------------
   321     05  STATEL PIC S9(0004) COMP.
   322     05  STATEF PIC  X(0001).
   323     05  FILLER REDEFINES STATEF.
   324         10  STATEA PIC  X(0001).
   325     05  STATEI PIC  X(0002).
   326*    -------------------------------
   327     05  ACCTL PIC S9(0004) COMP.
   328     05  ACCTF PIC  X(0001).
   329     05  FILLER REDEFINES ACCTF.
   330         10  ACCTA PIC  X(0001).
   331     05  ACCTI PIC  X(0010).
   332*    -------------------------------
   333     05  EFFDTEL PIC S9(0004) COMP.
   334     05  EFFDTEF PIC  X(0001).
   335     05  FILLER REDEFINES EFFDTEF.
   336         10  EFFDTEA PIC  X(0001).
   337     05  EFFDTEI PIC  X(0008).
   338*    -------------------------------
   339     05  PROCSRL PIC S9(0004) COMP.
   340     05  PROCSRF PIC  X(0001).
   341     05  FILLER REDEFINES PROCSRF.
   342         10  PROCSRA PIC  X(0001).
   343     05  PROCSRI PIC  X(0004).
   344*    -------------------------------
   345     05  CORRSELL PIC S9(0004) COMP.
   346     05  CORRSELF PIC  X(0001).
   347     05  FILLER REDEFINES CORRSELF.
   348         10  CORRSELA PIC  X(0001).
   349     05  CORRSELI PIC  X(0002).
   350*    -------------------------------
   351     05  STATSELL PIC S9(0004) COMP.
   352     05  STATSELF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL690.cbl
   353     05  FILLER REDEFINES STATSELF.
   354         10  STATSELA PIC  X(0001).
   355     05  STATSELI PIC  X(0001).
   356*    -------------------------------
   357     05  ARCNO1L PIC S9(0004) COMP.
   358     05  ARCNO1F PIC  X(0001).
   359     05  FILLER REDEFINES ARCNO1F.
   360         10  ARCNO1A PIC  X(0001).
   361     05  ARCNO1I PIC  X(0008).
   362*    -------------------------------
   363     05  FORM1L PIC S9(0004) COMP.
   364     05  FORM1F PIC  X(0001).
   365     05  FILLER REDEFINES FORM1F.
   366         10  FORM1A PIC  X(0001).
   367     05  FORM1I PIC  X(0004).
   368*    -------------------------------
   369     05  USRID1L PIC S9(0004) COMP.
   370     05  USRID1F PIC  X(0001).
   371     05  FILLER REDEFINES USRID1F.
   372         10  USRID1A PIC  X(0001).
   373     05  USRID1I PIC  X(0004).
   374*    -------------------------------
   375     05  PRINT1L PIC S9(0004) COMP.
   376     05  PRINT1F PIC  X(0001).
   377     05  FILLER REDEFINES PRINT1F.
   378         10  PRINT1A PIC  X(0001).
   379     05  PRINT1I PIC  X(0008).
   380*    -------------------------------
   381     05  STATS1L PIC S9(0004) COMP.
   382     05  STATS1F PIC  X(0001).
   383     05  FILLER REDEFINES STATS1F.
   384         10  STATS1A PIC  X(0001).
   385     05  STATS1I PIC  X(0008).
   386*    -------------------------------
   387     05  RSFRM1L PIC S9(0004) COMP.
   388     05  RSFRM1F PIC  X(0001).
   389     05  FILLER REDEFINES RSFRM1F.
   390         10  RSFRM1A PIC  X(0001).
   391     05  RSFRM1I PIC  X(0004).
   392*    -------------------------------
   393     05  RSDAT1L PIC S9(0004) COMP.
   394     05  RSDAT1F PIC  X(0001).
   395     05  FILLER REDEFINES RSDAT1F.
   396         10  RSDAT1A PIC  X(0001).
   397     05  RSDAT1I PIC  X(0008).
   398*    -------------------------------
   399     05  ARCNO2L PIC S9(0004) COMP.
   400     05  ARCNO2F PIC  X(0001).
   401     05  FILLER REDEFINES ARCNO2F.
   402         10  ARCNO2A PIC  X(0001).
   403     05  ARCNO2I PIC  X(0008).
   404*    -------------------------------
   405     05  FORM2L PIC S9(0004) COMP.
   406     05  FORM2F PIC  X(0001).
   407     05  FILLER REDEFINES FORM2F.
   408         10  FORM2A PIC  X(0001).
   409     05  FORM2I PIC  X(0004).
   410*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL690.cbl
   411     05  USRID2L PIC S9(0004) COMP.
   412     05  USRID2F PIC  X(0001).
   413     05  FILLER REDEFINES USRID2F.
   414         10  USRID2A PIC  X(0001).
   415     05  USRID2I PIC  X(0004).
   416*    -------------------------------
   417     05  PRINT2L PIC S9(0004) COMP.
   418     05  PRINT2F PIC  X(0001).
   419     05  FILLER REDEFINES PRINT2F.
   420         10  PRINT2A PIC  X(0001).
   421     05  PRINT2I PIC  X(0008).
   422*    -------------------------------
   423     05  STATS2L PIC S9(0004) COMP.
   424     05  STATS2F PIC  X(0001).
   425     05  FILLER REDEFINES STATS2F.
   426         10  STATS2A PIC  X(0001).
   427     05  STATS2I PIC  X(0008).
   428*    -------------------------------
   429     05  RSFRM2L PIC S9(0004) COMP.
   430     05  RSFRM2F PIC  X(0001).
   431     05  FILLER REDEFINES RSFRM2F.
   432         10  RSFRM2A PIC  X(0001).
   433     05  RSFRM2I PIC  X(0004).
   434*    -------------------------------
   435     05  RSDAT2L PIC S9(0004) COMP.
   436     05  RSDAT2F PIC  X(0001).
   437     05  FILLER REDEFINES RSDAT2F.
   438         10  RSDAT2A PIC  X(0001).
   439     05  RSDAT2I PIC  X(0008).
   440*    -------------------------------
   441     05  ARCNO3L PIC S9(0004) COMP.
   442     05  ARCNO3F PIC  X(0001).
   443     05  FILLER REDEFINES ARCNO3F.
   444         10  ARCNO3A PIC  X(0001).
   445     05  ARCNO3I PIC  X(0008).
   446*    -------------------------------
   447     05  FORM3L PIC S9(0004) COMP.
   448     05  FORM3F PIC  X(0001).
   449     05  FILLER REDEFINES FORM3F.
   450         10  FORM3A PIC  X(0001).
   451     05  FORM3I PIC  X(0004).
   452*    -------------------------------
   453     05  USRID3L PIC S9(0004) COMP.
   454     05  USRID3F PIC  X(0001).
   455     05  FILLER REDEFINES USRID3F.
   456         10  USRID3A PIC  X(0001).
   457     05  USRID3I PIC  X(0004).
   458*    -------------------------------
   459     05  PRINT3L PIC S9(0004) COMP.
   460     05  PRINT3F PIC  X(0001).
   461     05  FILLER REDEFINES PRINT3F.
   462         10  PRINT3A PIC  X(0001).
   463     05  PRINT3I PIC  X(0008).
   464*    -------------------------------
   465     05  STATS3L PIC S9(0004) COMP.
   466     05  STATS3F PIC  X(0001).
   467     05  FILLER REDEFINES STATS3F.
   468         10  STATS3A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL690.cbl
   469     05  STATS3I PIC  X(0008).
   470*    -------------------------------
   471     05  RSFRM3L PIC S9(0004) COMP.
   472     05  RSFRM3F PIC  X(0001).
   473     05  FILLER REDEFINES RSFRM3F.
   474         10  RSFRM3A PIC  X(0001).
   475     05  RSFRM3I PIC  X(0004).
   476*    -------------------------------
   477     05  RSDAT3L PIC S9(0004) COMP.
   478     05  RSDAT3F PIC  X(0001).
   479     05  FILLER REDEFINES RSDAT3F.
   480         10  RSDAT3A PIC  X(0001).
   481     05  RSDAT3I PIC  X(0008).
   482*    -------------------------------
   483     05  ARCNO4L PIC S9(0004) COMP.
   484     05  ARCNO4F PIC  X(0001).
   485     05  FILLER REDEFINES ARCNO4F.
   486         10  ARCNO4A PIC  X(0001).
   487     05  ARCNO4I PIC  X(0008).
   488*    -------------------------------
   489     05  FORM4L PIC S9(0004) COMP.
   490     05  FORM4F PIC  X(0001).
   491     05  FILLER REDEFINES FORM4F.
   492         10  FORM4A PIC  X(0001).
   493     05  FORM4I PIC  X(0004).
   494*    -------------------------------
   495     05  USRID4L PIC S9(0004) COMP.
   496     05  USRID4F PIC  X(0001).
   497     05  FILLER REDEFINES USRID4F.
   498         10  USRID4A PIC  X(0001).
   499     05  USRID4I PIC  X(0004).
   500*    -------------------------------
   501     05  PRINT4L PIC S9(0004) COMP.
   502     05  PRINT4F PIC  X(0001).
   503     05  FILLER REDEFINES PRINT4F.
   504         10  PRINT4A PIC  X(0001).
   505     05  PRINT4I PIC  X(0008).
   506*    -------------------------------
   507     05  STATS4L PIC S9(0004) COMP.
   508     05  STATS4F PIC  X(0001).
   509     05  FILLER REDEFINES STATS4F.
   510         10  STATS4A PIC  X(0001).
   511     05  STATS4I PIC  X(0008).
   512*    -------------------------------
   513     05  RSFRM4L PIC S9(0004) COMP.
   514     05  RSFRM4F PIC  X(0001).
   515     05  FILLER REDEFINES RSFRM4F.
   516         10  RSFRM4A PIC  X(0001).
   517     05  RSFRM4I PIC  X(0004).
   518*    -------------------------------
   519     05  RSDAT4L PIC S9(0004) COMP.
   520     05  RSDAT4F PIC  X(0001).
   521     05  FILLER REDEFINES RSDAT4F.
   522         10  RSDAT4A PIC  X(0001).
   523     05  RSDAT4I PIC  X(0008).
   524*    -------------------------------
   525     05  ARCNO5L PIC S9(0004) COMP.
   526     05  ARCNO5F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL690.cbl
   527     05  FILLER REDEFINES ARCNO5F.
   528         10  ARCNO5A PIC  X(0001).
   529     05  ARCNO5I PIC  X(0008).
   530*    -------------------------------
   531     05  FORM5L PIC S9(0004) COMP.
   532     05  FORM5F PIC  X(0001).
   533     05  FILLER REDEFINES FORM5F.
   534         10  FORM5A PIC  X(0001).
   535     05  FORM5I PIC  X(0004).
   536*    -------------------------------
   537     05  USRID5L PIC S9(0004) COMP.
   538     05  USRID5F PIC  X(0001).
   539     05  FILLER REDEFINES USRID5F.
   540         10  USRID5A PIC  X(0001).
   541     05  USRID5I PIC  X(0004).
   542*    -------------------------------
   543     05  PRINT5L PIC S9(0004) COMP.
   544     05  PRINT5F PIC  X(0001).
   545     05  FILLER REDEFINES PRINT5F.
   546         10  PRINT5A PIC  X(0001).
   547     05  PRINT5I PIC  X(0008).
   548*    -------------------------------
   549     05  STATS5L PIC S9(0004) COMP.
   550     05  STATS5F PIC  X(0001).
   551     05  FILLER REDEFINES STATS5F.
   552         10  STATS5A PIC  X(0001).
   553     05  STATS5I PIC  X(0008).
   554*    -------------------------------
   555     05  RSFRM5L PIC S9(0004) COMP.
   556     05  RSFRM5F PIC  X(0001).
   557     05  FILLER REDEFINES RSFRM5F.
   558         10  RSFRM5A PIC  X(0001).
   559     05  RSFRM5I PIC  X(0004).
   560*    -------------------------------
   561     05  RSDAT5L PIC S9(0004) COMP.
   562     05  RSDAT5F PIC  X(0001).
   563     05  FILLER REDEFINES RSDAT5F.
   564         10  RSDAT5A PIC  X(0001).
   565     05  RSDAT5I PIC  X(0008).
   566*    -------------------------------
   567     05  ARCNO6L PIC S9(0004) COMP.
   568     05  ARCNO6F PIC  X(0001).
   569     05  FILLER REDEFINES ARCNO6F.
   570         10  ARCNO6A PIC  X(0001).
   571     05  ARCNO6I PIC  X(0008).
   572*    -------------------------------
   573     05  FORM6L PIC S9(0004) COMP.
   574     05  FORM6F PIC  X(0001).
   575     05  FILLER REDEFINES FORM6F.
   576         10  FORM6A PIC  X(0001).
   577     05  FORM6I PIC  X(0004).
   578*    -------------------------------
   579     05  USRID6L PIC S9(0004) COMP.
   580     05  USRID6F PIC  X(0001).
   581     05  FILLER REDEFINES USRID6F.
   582         10  USRID6A PIC  X(0001).
   583     05  USRID6I PIC  X(0004).
   584*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL690.cbl
   585     05  PRINT6L PIC S9(0004) COMP.
   586     05  PRINT6F PIC  X(0001).
   587     05  FILLER REDEFINES PRINT6F.
   588         10  PRINT6A PIC  X(0001).
   589     05  PRINT6I PIC  X(0008).
   590*    -------------------------------
   591     05  STATS6L PIC S9(0004) COMP.
   592     05  STATS6F PIC  X(0001).
   593     05  FILLER REDEFINES STATS6F.
   594         10  STATS6A PIC  X(0001).
   595     05  STATS6I PIC  X(0008).
   596*    -------------------------------
   597     05  RSFRM6L PIC S9(0004) COMP.
   598     05  RSFRM6F PIC  X(0001).
   599     05  FILLER REDEFINES RSFRM6F.
   600         10  RSFRM6A PIC  X(0001).
   601     05  RSFRM6I PIC  X(0004).
   602*    -------------------------------
   603     05  RSDAT6L PIC S9(0004) COMP.
   604     05  RSDAT6F PIC  X(0001).
   605     05  FILLER REDEFINES RSDAT6F.
   606         10  RSDAT6A PIC  X(0001).
   607     05  RSDAT6I PIC  X(0008).
   608*    -------------------------------
   609     05  ARCNO7L PIC S9(0004) COMP.
   610     05  ARCNO7F PIC  X(0001).
   611     05  FILLER REDEFINES ARCNO7F.
   612         10  ARCNO7A PIC  X(0001).
   613     05  ARCNO7I PIC  X(0008).
   614*    -------------------------------
   615     05  FORM7L PIC S9(0004) COMP.
   616     05  FORM7F PIC  X(0001).
   617     05  FILLER REDEFINES FORM7F.
   618         10  FORM7A PIC  X(0001).
   619     05  FORM7I PIC  X(0004).
   620*    -------------------------------
   621     05  USRID7L PIC S9(0004) COMP.
   622     05  USRID7F PIC  X(0001).
   623     05  FILLER REDEFINES USRID7F.
   624         10  USRID7A PIC  X(0001).
   625     05  USRID7I PIC  X(0004).
   626*    -------------------------------
   627     05  PRINT7L PIC S9(0004) COMP.
   628     05  PRINT7F PIC  X(0001).
   629     05  FILLER REDEFINES PRINT7F.
   630         10  PRINT7A PIC  X(0001).
   631     05  PRINT7I PIC  X(0008).
   632*    -------------------------------
   633     05  STATS7L PIC S9(0004) COMP.
   634     05  STATS7F PIC  X(0001).
   635     05  FILLER REDEFINES STATS7F.
   636         10  STATS7A PIC  X(0001).
   637     05  STATS7I PIC  X(0008).
   638*    -------------------------------
   639     05  RSFRM7L PIC S9(0004) COMP.
   640     05  RSFRM7F PIC  X(0001).
   641     05  FILLER REDEFINES RSFRM7F.
   642         10  RSFRM7A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL690.cbl
   643     05  RSFRM7I PIC  X(0004).
   644*    -------------------------------
   645     05  RSDAT7L PIC S9(0004) COMP.
   646     05  RSDAT7F PIC  X(0001).
   647     05  FILLER REDEFINES RSDAT7F.
   648         10  RSDAT7A PIC  X(0001).
   649     05  RSDAT7I PIC  X(0008).
   650*    -------------------------------
   651     05  ARCNO8L PIC S9(0004) COMP.
   652     05  ARCNO8F PIC  X(0001).
   653     05  FILLER REDEFINES ARCNO8F.
   654         10  ARCNO8A PIC  X(0001).
   655     05  ARCNO8I PIC  X(0008).
   656*    -------------------------------
   657     05  FORM8L PIC S9(0004) COMP.
   658     05  FORM8F PIC  X(0001).
   659     05  FILLER REDEFINES FORM8F.
   660         10  FORM8A PIC  X(0001).
   661     05  FORM8I PIC  X(0004).
   662*    -------------------------------
   663     05  USRID8L PIC S9(0004) COMP.
   664     05  USRID8F PIC  X(0001).
   665     05  FILLER REDEFINES USRID8F.
   666         10  USRID8A PIC  X(0001).
   667     05  USRID8I PIC  X(0004).
   668*    -------------------------------
   669     05  PRINT8L PIC S9(0004) COMP.
   670     05  PRINT8F PIC  X(0001).
   671     05  FILLER REDEFINES PRINT8F.
   672         10  PRINT8A PIC  X(0001).
   673     05  PRINT8I PIC  X(0008).
   674*    -------------------------------
   675     05  STATS8L PIC S9(0004) COMP.
   676     05  STATS8F PIC  X(0001).
   677     05  FILLER REDEFINES STATS8F.
   678         10  STATS8A PIC  X(0001).
   679     05  STATS8I PIC  X(0008).
   680*    -------------------------------
   681     05  RSFRM8L PIC S9(0004) COMP.
   682     05  RSFRM8F PIC  X(0001).
   683     05  FILLER REDEFINES RSFRM8F.
   684         10  RSFRM8A PIC  X(0001).
   685     05  RSFRM8I PIC  X(0004).
   686*    -------------------------------
   687     05  RSDAT8L PIC S9(0004) COMP.
   688     05  RSDAT8F PIC  X(0001).
   689     05  FILLER REDEFINES RSDAT8F.
   690         10  RSDAT8A PIC  X(0001).
   691     05  RSDAT8I PIC  X(0008).
   692*    -------------------------------
   693     05  ARCNO9L PIC S9(0004) COMP.
   694     05  ARCNO9F PIC  X(0001).
   695     05  FILLER REDEFINES ARCNO9F.
   696         10  ARCNO9A PIC  X(0001).
   697     05  ARCNO9I PIC  X(0008).
   698*    -------------------------------
   699     05  FORM9L PIC S9(0004) COMP.
   700     05  FORM9F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL690.cbl
   701     05  FILLER REDEFINES FORM9F.
   702         10  FORM9A PIC  X(0001).
   703     05  FORM9I PIC  X(0004).
   704*    -------------------------------
   705     05  USRID9L PIC S9(0004) COMP.
   706     05  USRID9F PIC  X(0001).
   707     05  FILLER REDEFINES USRID9F.
   708         10  USRID9A PIC  X(0001).
   709     05  USRID9I PIC  X(0004).
   710*    -------------------------------
   711     05  PRINT9L PIC S9(0004) COMP.
   712     05  PRINT9F PIC  X(0001).
   713     05  FILLER REDEFINES PRINT9F.
   714         10  PRINT9A PIC  X(0001).
   715     05  PRINT9I PIC  X(0008).
   716*    -------------------------------
   717     05  STATS9L PIC S9(0004) COMP.
   718     05  STATS9F PIC  X(0001).
   719     05  FILLER REDEFINES STATS9F.
   720         10  STATS9A PIC  X(0001).
   721     05  STATS9I PIC  X(0008).
   722*    -------------------------------
   723     05  RSFRM9L PIC S9(0004) COMP.
   724     05  RSFRM9F PIC  X(0001).
   725     05  FILLER REDEFINES RSFRM9F.
   726         10  RSFRM9A PIC  X(0001).
   727     05  RSFRM9I PIC  X(0004).
   728*    -------------------------------
   729     05  RSDAT9L PIC S9(0004) COMP.
   730     05  RSDAT9F PIC  X(0001).
   731     05  FILLER REDEFINES RSDAT9F.
   732         10  RSDAT9A PIC  X(0001).
   733     05  RSDAT9I PIC  X(0008).
   734*    -------------------------------
   735     05  ARCNO10L PIC S9(0004) COMP.
   736     05  ARCNO10F PIC  X(0001).
   737     05  FILLER REDEFINES ARCNO10F.
   738         10  ARCNO10A PIC  X(0001).
   739     05  ARCNO10I PIC  X(0008).
   740*    -------------------------------
   741     05  FORM10L PIC S9(0004) COMP.
   742     05  FORM10F PIC  X(0001).
   743     05  FILLER REDEFINES FORM10F.
   744         10  FORM10A PIC  X(0001).
   745     05  FORM10I PIC  X(0004).
   746*    -------------------------------
   747     05  USRID10L PIC S9(0004) COMP.
   748     05  USRID10F PIC  X(0001).
   749     05  FILLER REDEFINES USRID10F.
   750         10  USRID10A PIC  X(0001).
   751     05  USRID10I PIC  X(0004).
   752*    -------------------------------
   753     05  PRINT10L PIC S9(0004) COMP.
   754     05  PRINT10F PIC  X(0001).
   755     05  FILLER REDEFINES PRINT10F.
   756         10  PRINT10A PIC  X(0001).
   757     05  PRINT10I PIC  X(0008).
   758*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL690.cbl
   759     05  STATS10L PIC S9(0004) COMP.
   760     05  STATS10F PIC  X(0001).
   761     05  FILLER REDEFINES STATS10F.
   762         10  STATS10A PIC  X(0001).
   763     05  STATS10I PIC  X(0008).
   764*    -------------------------------
   765     05  RSFRM10L PIC S9(0004) COMP.
   766     05  RSFRM10F PIC  X(0001).
   767     05  FILLER REDEFINES RSFRM10F.
   768         10  RSFRM10A PIC  X(0001).
   769     05  RSFRM10I PIC  X(0004).
   770*    -------------------------------
   771     05  RSDAT10L PIC S9(0004) COMP.
   772     05  RSDAT10F PIC  X(0001).
   773     05  FILLER REDEFINES RSDAT10F.
   774         10  RSDAT10A PIC  X(0001).
   775     05  RSDAT10I PIC  X(0008).
   776*    -------------------------------
   777     05  ARCNO11L PIC S9(0004) COMP.
   778     05  ARCNO11F PIC  X(0001).
   779     05  FILLER REDEFINES ARCNO11F.
   780         10  ARCNO11A PIC  X(0001).
   781     05  ARCNO11I PIC  X(0008).
   782*    -------------------------------
   783     05  FORM11L PIC S9(0004) COMP.
   784     05  FORM11F PIC  X(0001).
   785     05  FILLER REDEFINES FORM11F.
   786         10  FORM11A PIC  X(0001).
   787     05  FORM11I PIC  X(0004).
   788*    -------------------------------
   789     05  USRID11L PIC S9(0004) COMP.
   790     05  USRID11F PIC  X(0001).
   791     05  FILLER REDEFINES USRID11F.
   792         10  USRID11A PIC  X(0001).
   793     05  USRID11I PIC  X(0004).
   794*    -------------------------------
   795     05  PRINT11L PIC S9(0004) COMP.
   796     05  PRINT11F PIC  X(0001).
   797     05  FILLER REDEFINES PRINT11F.
   798         10  PRINT11A PIC  X(0001).
   799     05  PRINT11I PIC  X(0008).
   800*    -------------------------------
   801     05  STATS11L PIC S9(0004) COMP.
   802     05  STATS11F PIC  X(0001).
   803     05  FILLER REDEFINES STATS11F.
   804         10  STATS11A PIC  X(0001).
   805     05  STATS11I PIC  X(0008).
   806*    -------------------------------
   807     05  RSFRM11L PIC S9(0004) COMP.
   808     05  RSFRM11F PIC  X(0001).
   809     05  FILLER REDEFINES RSFRM11F.
   810         10  RSFRM11A PIC  X(0001).
   811     05  RSFRM11I PIC  X(0004).
   812*    -------------------------------
   813     05  RSDAT11L PIC S9(0004) COMP.
   814     05  RSDAT11F PIC  X(0001).
   815     05  FILLER REDEFINES RSDAT11F.
   816         10  RSDAT11A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL690.cbl
   817     05  RSDAT11I PIC  X(0008).
   818*    -------------------------------
   819     05  ARCNO12L PIC S9(0004) COMP.
   820     05  ARCNO12F PIC  X(0001).
   821     05  FILLER REDEFINES ARCNO12F.
   822         10  ARCNO12A PIC  X(0001).
   823     05  ARCNO12I PIC  X(0008).
   824*    -------------------------------
   825     05  FORM12L PIC S9(0004) COMP.
   826     05  FORM12F PIC  X(0001).
   827     05  FILLER REDEFINES FORM12F.
   828         10  FORM12A PIC  X(0001).
   829     05  FORM12I PIC  X(0004).
   830*    -------------------------------
   831     05  USRID12L PIC S9(0004) COMP.
   832     05  USRID12F PIC  X(0001).
   833     05  FILLER REDEFINES USRID12F.
   834         10  USRID12A PIC  X(0001).
   835     05  USRID12I PIC  X(0004).
   836*    -------------------------------
   837     05  PRINT12L PIC S9(0004) COMP.
   838     05  PRINT12F PIC  X(0001).
   839     05  FILLER REDEFINES PRINT12F.
   840         10  PRINT12A PIC  X(0001).
   841     05  PRINT12I PIC  X(0008).
   842*    -------------------------------
   843     05  STATS12L PIC S9(0004) COMP.
   844     05  STATS12F PIC  X(0001).
   845     05  FILLER REDEFINES STATS12F.
   846         10  STATS12A PIC  X(0001).
   847     05  STATS12I PIC  X(0008).
   848*    -------------------------------
   849     05  RSFRM12L PIC S9(0004) COMP.
   850     05  RSFRM12F PIC  X(0001).
   851     05  FILLER REDEFINES RSFRM12F.
   852         10  RSFRM12A PIC  X(0001).
   853     05  RSFRM12I PIC  X(0004).
   854*    -------------------------------
   855     05  RSDAT12L PIC S9(0004) COMP.
   856     05  RSDAT12F PIC  X(0001).
   857     05  FILLER REDEFINES RSDAT12F.
   858         10  RSDAT12A PIC  X(0001).
   859     05  RSDAT12I PIC  X(0008).
   860*    -------------------------------
   861     05  ERRMSG1L PIC S9(0004) COMP.
   862     05  ERRMSG1F PIC  X(0001).
   863     05  FILLER REDEFINES ERRMSG1F.
   864         10  ERRMSG1A PIC  X(0001).
   865     05  ERRMSG1I PIC  X(0079).
   866*    -------------------------------
   867     05  PFKEYL PIC S9(0004) COMP.
   868     05  PFKEYF PIC  X(0001).
   869     05  FILLER REDEFINES PFKEYF.
   870         10  PFKEYA PIC  X(0001).
   871     05  PFKEYI PIC  9(2).
   872 01  EL690AO REDEFINES EL690AI.
   873     05  FILLER            PIC  X(0012).
   874*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL690.cbl
   875     05  FILLER            PIC  X(0003).
   876     05  RUNDTEO PIC  X(0008).
   877*    -------------------------------
   878     05  FILLER            PIC  X(0003).
   879     05  RUNTIMEO PIC  99.99.
   880*    -------------------------------
   881     05  FILLER            PIC  X(0003).
   882     05  COMPANYO PIC  X(0003).
   883*    -------------------------------
   884     05  FILLER            PIC  X(0003).
   885     05  USERIDO PIC  X(0004).
   886*    -------------------------------
   887     05  FILLER            PIC  X(0003).
   888     05  MAINTO PIC  X(0001).
   889*    -------------------------------
   890     05  FILLER            PIC  X(0003).
   891     05  TYPEBRO PIC  X(0001).
   892*    -------------------------------
   893     05  FILLER            PIC  X(0003).
   894     05  CERTRPO PIC  X(0010).
   895*    -------------------------------
   896     05  FILLER            PIC  X(0003).
   897     05  SUFFIXO PIC  X(0001).
   898*    -------------------------------
   899     05  FILLER            PIC  X(0003).
   900     05  FORMO PIC  X(0004).
   901*    -------------------------------
   902     05  FILLER            PIC  X(0003).
   903     05  ENTRYO PIC  X(0006).
   904*    -------------------------------
   905     05  FILLER            PIC  X(0003).
   906     05  CKCNTLO PIC  ZZZZZZZ9.
   907*    -------------------------------
   908     05  FILLER            PIC  X(0003).
   909     05  CARRIERO PIC  X(0001).
   910*    -------------------------------
   911     05  FILLER            PIC  X(0003).
   912     05  GROUPO PIC  X(0006).
   913*    -------------------------------
   914     05  FILLER            PIC  X(0003).
   915     05  STATEO PIC  X(0002).
   916*    -------------------------------
   917     05  FILLER            PIC  X(0003).
   918     05  ACCTO PIC  X(0010).
   919*    -------------------------------
   920     05  FILLER            PIC  X(0003).
   921     05  EFFDTEO PIC  X(0008).
   922*    -------------------------------
   923     05  FILLER            PIC  X(0003).
   924     05  PROCSRO PIC  X(0004).
   925*    -------------------------------
   926     05  FILLER            PIC  X(0003).
   927     05  CORRSELO PIC  ZZ.
   928*    -------------------------------
   929     05  FILLER            PIC  X(0003).
   930     05  STATSELO PIC  X(0001).
   931*    -------------------------------
   932     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL690.cbl
   933     05  ARCNO1O PIC  X(0008).
   934*    -------------------------------
   935     05  FILLER            PIC  X(0003).
   936     05  FORM1O PIC  X(0004).
   937*    -------------------------------
   938     05  FILLER            PIC  X(0003).
   939     05  USRID1O PIC  X(0004).
   940*    -------------------------------
   941     05  FILLER            PIC  X(0003).
   942     05  PRINT1O PIC  X(0008).
   943*    -------------------------------
   944     05  FILLER            PIC  X(0003).
   945     05  STATS1O PIC  X(0008).
   946*    -------------------------------
   947     05  FILLER            PIC  X(0003).
   948     05  RSFRM1O PIC  X(0004).
   949*    -------------------------------
   950     05  FILLER            PIC  X(0003).
   951     05  RSDAT1O PIC  X(0008).
   952*    -------------------------------
   953     05  FILLER            PIC  X(0003).
   954     05  ARCNO2O PIC  X(0008).
   955*    -------------------------------
   956     05  FILLER            PIC  X(0003).
   957     05  FORM2O PIC  X(0004).
   958*    -------------------------------
   959     05  FILLER            PIC  X(0003).
   960     05  USRID2O PIC  X(0004).
   961*    -------------------------------
   962     05  FILLER            PIC  X(0003).
   963     05  PRINT2O PIC  X(0008).
   964*    -------------------------------
   965     05  FILLER            PIC  X(0003).
   966     05  STATS2O PIC  X(0008).
   967*    -------------------------------
   968     05  FILLER            PIC  X(0003).
   969     05  RSFRM2O PIC  X(0004).
   970*    -------------------------------
   971     05  FILLER            PIC  X(0003).
   972     05  RSDAT2O PIC  X(0008).
   973*    -------------------------------
   974     05  FILLER            PIC  X(0003).
   975     05  ARCNO3O PIC  X(0008).
   976*    -------------------------------
   977     05  FILLER            PIC  X(0003).
   978     05  FORM3O PIC  X(0004).
   979*    -------------------------------
   980     05  FILLER            PIC  X(0003).
   981     05  USRID3O PIC  X(0004).
   982*    -------------------------------
   983     05  FILLER            PIC  X(0003).
   984     05  PRINT3O PIC  X(0008).
   985*    -------------------------------
   986     05  FILLER            PIC  X(0003).
   987     05  STATS3O PIC  X(0008).
   988*    -------------------------------
   989     05  FILLER            PIC  X(0003).
   990     05  RSFRM3O PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL690.cbl
   991*    -------------------------------
   992     05  FILLER            PIC  X(0003).
   993     05  RSDAT3O PIC  X(0008).
   994*    -------------------------------
   995     05  FILLER            PIC  X(0003).
   996     05  ARCNO4O PIC  X(0008).
   997*    -------------------------------
   998     05  FILLER            PIC  X(0003).
   999     05  FORM4O PIC  X(0004).
  1000*    -------------------------------
  1001     05  FILLER            PIC  X(0003).
  1002     05  USRID4O PIC  X(0004).
  1003*    -------------------------------
  1004     05  FILLER            PIC  X(0003).
  1005     05  PRINT4O PIC  X(0008).
  1006*    -------------------------------
  1007     05  FILLER            PIC  X(0003).
  1008     05  STATS4O PIC  X(0008).
  1009*    -------------------------------
  1010     05  FILLER            PIC  X(0003).
  1011     05  RSFRM4O PIC  X(0004).
  1012*    -------------------------------
  1013     05  FILLER            PIC  X(0003).
  1014     05  RSDAT4O PIC  X(0008).
  1015*    -------------------------------
  1016     05  FILLER            PIC  X(0003).
  1017     05  ARCNO5O PIC  X(0008).
  1018*    -------------------------------
  1019     05  FILLER            PIC  X(0003).
  1020     05  FORM5O PIC  X(0004).
  1021*    -------------------------------
  1022     05  FILLER            PIC  X(0003).
  1023     05  USRID5O PIC  X(0004).
  1024*    -------------------------------
  1025     05  FILLER            PIC  X(0003).
  1026     05  PRINT5O PIC  X(0008).
  1027*    -------------------------------
  1028     05  FILLER            PIC  X(0003).
  1029     05  STATS5O PIC  X(0008).
  1030*    -------------------------------
  1031     05  FILLER            PIC  X(0003).
  1032     05  RSFRM5O PIC  X(0004).
  1033*    -------------------------------
  1034     05  FILLER            PIC  X(0003).
  1035     05  RSDAT5O PIC  X(0008).
  1036*    -------------------------------
  1037     05  FILLER            PIC  X(0003).
  1038     05  ARCNO6O PIC  X(0008).
  1039*    -------------------------------
  1040     05  FILLER            PIC  X(0003).
  1041     05  FORM6O PIC  X(0004).
  1042*    -------------------------------
  1043     05  FILLER            PIC  X(0003).
  1044     05  USRID6O PIC  X(0004).
  1045*    -------------------------------
  1046     05  FILLER            PIC  X(0003).
  1047     05  PRINT6O PIC  X(0008).
  1048*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL690.cbl
  1049     05  FILLER            PIC  X(0003).
  1050     05  STATS6O PIC  X(0008).
  1051*    -------------------------------
  1052     05  FILLER            PIC  X(0003).
  1053     05  RSFRM6O PIC  X(0004).
  1054*    -------------------------------
  1055     05  FILLER            PIC  X(0003).
  1056     05  RSDAT6O PIC  X(0008).
  1057*    -------------------------------
  1058     05  FILLER            PIC  X(0003).
  1059     05  ARCNO7O PIC  X(0008).
  1060*    -------------------------------
  1061     05  FILLER            PIC  X(0003).
  1062     05  FORM7O PIC  X(0004).
  1063*    -------------------------------
  1064     05  FILLER            PIC  X(0003).
  1065     05  USRID7O PIC  X(0004).
  1066*    -------------------------------
  1067     05  FILLER            PIC  X(0003).
  1068     05  PRINT7O PIC  X(0008).
  1069*    -------------------------------
  1070     05  FILLER            PIC  X(0003).
  1071     05  STATS7O PIC  X(0008).
  1072*    -------------------------------
  1073     05  FILLER            PIC  X(0003).
  1074     05  RSFRM7O PIC  X(0004).
  1075*    -------------------------------
  1076     05  FILLER            PIC  X(0003).
  1077     05  RSDAT7O PIC  X(0008).
  1078*    -------------------------------
  1079     05  FILLER            PIC  X(0003).
  1080     05  ARCNO8O PIC  X(0008).
  1081*    -------------------------------
  1082     05  FILLER            PIC  X(0003).
  1083     05  FORM8O PIC  X(0004).
  1084*    -------------------------------
  1085     05  FILLER            PIC  X(0003).
  1086     05  USRID8O PIC  X(0004).
  1087*    -------------------------------
  1088     05  FILLER            PIC  X(0003).
  1089     05  PRINT8O PIC  X(0008).
  1090*    -------------------------------
  1091     05  FILLER            PIC  X(0003).
  1092     05  STATS8O PIC  X(0008).
  1093*    -------------------------------
  1094     05  FILLER            PIC  X(0003).
  1095     05  RSFRM8O PIC  X(0004).
  1096*    -------------------------------
  1097     05  FILLER            PIC  X(0003).
  1098     05  RSDAT8O PIC  X(0008).
  1099*    -------------------------------
  1100     05  FILLER            PIC  X(0003).
  1101     05  ARCNO9O PIC  X(0008).
  1102*    -------------------------------
  1103     05  FILLER            PIC  X(0003).
  1104     05  FORM9O PIC  X(0004).
  1105*    -------------------------------
  1106     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL690.cbl
  1107     05  USRID9O PIC  X(0004).
  1108*    -------------------------------
  1109     05  FILLER            PIC  X(0003).
  1110     05  PRINT9O PIC  X(0008).
  1111*    -------------------------------
  1112     05  FILLER            PIC  X(0003).
  1113     05  STATS9O PIC  X(0008).
  1114*    -------------------------------
  1115     05  FILLER            PIC  X(0003).
  1116     05  RSFRM9O PIC  X(0004).
  1117*    -------------------------------
  1118     05  FILLER            PIC  X(0003).
  1119     05  RSDAT9O PIC  X(0008).
  1120*    -------------------------------
  1121     05  FILLER            PIC  X(0003).
  1122     05  ARCNO10O PIC  X(0008).
  1123*    -------------------------------
  1124     05  FILLER            PIC  X(0003).
  1125     05  FORM10O PIC  X(0004).
  1126*    -------------------------------
  1127     05  FILLER            PIC  X(0003).
  1128     05  USRID10O PIC  X(0004).
  1129*    -------------------------------
  1130     05  FILLER            PIC  X(0003).
  1131     05  PRINT10O PIC  X(0008).
  1132*    -------------------------------
  1133     05  FILLER            PIC  X(0003).
  1134     05  STATS10O PIC  X(0008).
  1135*    -------------------------------
  1136     05  FILLER            PIC  X(0003).
  1137     05  RSFRM10O PIC  X(0004).
  1138*    -------------------------------
  1139     05  FILLER            PIC  X(0003).
  1140     05  RSDAT10O PIC  X(0008).
  1141*    -------------------------------
  1142     05  FILLER            PIC  X(0003).
  1143     05  ARCNO11O PIC  X(0008).
  1144*    -------------------------------
  1145     05  FILLER            PIC  X(0003).
  1146     05  FORM11O PIC  X(0004).
  1147*    -------------------------------
  1148     05  FILLER            PIC  X(0003).
  1149     05  USRID11O PIC  X(0004).
  1150*    -------------------------------
  1151     05  FILLER            PIC  X(0003).
  1152     05  PRINT11O PIC  X(0008).
  1153*    -------------------------------
  1154     05  FILLER            PIC  X(0003).
  1155     05  STATS11O PIC  X(0008).
  1156*    -------------------------------
  1157     05  FILLER            PIC  X(0003).
  1158     05  RSFRM11O PIC  X(0004).
  1159*    -------------------------------
  1160     05  FILLER            PIC  X(0003).
  1161     05  RSDAT11O PIC  X(0008).
  1162*    -------------------------------
  1163     05  FILLER            PIC  X(0003).
  1164     05  ARCNO12O PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL690.cbl
  1165*    -------------------------------
  1166     05  FILLER            PIC  X(0003).
  1167     05  FORM12O PIC  X(0004).
  1168*    -------------------------------
  1169     05  FILLER            PIC  X(0003).
  1170     05  USRID12O PIC  X(0004).
  1171*    -------------------------------
  1172     05  FILLER            PIC  X(0003).
  1173     05  PRINT12O PIC  X(0008).
  1174*    -------------------------------
  1175     05  FILLER            PIC  X(0003).
  1176     05  STATS12O PIC  X(0008).
  1177*    -------------------------------
  1178     05  FILLER            PIC  X(0003).
  1179     05  RSFRM12O PIC  X(0004).
  1180*    -------------------------------
  1181     05  FILLER            PIC  X(0003).
  1182     05  RSDAT12O PIC  X(0008).
  1183*    -------------------------------
  1184     05  FILLER            PIC  X(0003).
  1185     05  ERRMSG1O PIC  X(0079).
  1186*    -------------------------------
  1187     05  FILLER            PIC  X(0003).
  1188     05  PFKEYO PIC  X(0002).
  1189*    -------------------------------
  1190 01  FILLER REDEFINES EL690AI.
  1191     16  FILLER                  PIC X(154).
  1192     16  W-ARCH-GROUPS.
  1193         20  W-ARCHGRP-DATA OCCURS 12 TIMES.
  1194             24  W-ARCNOL        PIC S9(04) COMP.
  1195             24  W-ARCNOA        PIC  X(01).
  1196             24  W-ARCNOO        PIC  9(08).
  1197             24  W-FORML         PIC S9(04) COMP.
  1198             24  W-FORMA         PIC  X(01).
  1199             24  W-FORMO         PIC  X(04).
  1200             24  W-USRIDL        PIC S9(04) COMP.
  1201             24  W-USRIDA        PIC  X(01).
  1202             24  W-USRIDO        PIC  X(04).
  1203             24  W-PRINTL        PIC S9(04) COMP.
  1204             24  W-PRINTA        PIC  X(01).
  1205             24  W-PRINTO        PIC  X(08).
  1206             24  W-STATUSL       PIC S9(04) COMP.
  1207             24  W-STATUSA       PIC  X(01).
  1208             24  W-STATUSO       PIC  X(08).
  1209             24  W-RSFRML        PIC S9(04) COMP.
  1210             24  W-RSFRMA        PIC  X(01).
  1211             24  W-RSFRMO        PIC  X(04).
  1212             24  W-RSDATL        PIC S9(04) COMP.
  1213             24  W-RSDATA        PIC  X(01).
  1214             24  W-RSDATO        PIC  X(08).
  1215     16  FILLER                  PIC  X(87).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL690.cbl
  1217
  1218 01  FILLER                      PIC  X(22)
  1219                                 VALUE 'PGRM INTERFACE STARTS:'.
  1220*    COPY ELCINTF.
  1221******************************************************************
  1222*                                                                *
  1223*                                                                *
  1224*                            ELCINTF.                            *
  1225*                            VMOD=2.017                          *
  1226*                                                                *
  1227*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1228*                                                                *
  1229*       LENGTH = 1024                                            *
  1230*                                                                *
  1231******************************************************************
  1232*                   C H A N G E   L O G
  1233*
  1234* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1235*-----------------------------------------------------------------
  1236*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1237* EFFECTIVE    NUMBER
  1238*-----------------------------------------------------------------
  1239* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1240******************************************************************
  1241 01  PROGRAM-INTERFACE-BLOCK.
  1242     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1243     12  PI-CALLING-PROGRAM              PIC X(8).
  1244     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1245     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1246     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1247     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1248     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1249     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1250     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1251     12  PI-COMPANY-ID                   PIC XXX.
  1252     12  PI-COMPANY-CD                   PIC X.
  1253
  1254     12  PI-COMPANY-PASSWORD             PIC X(8).
  1255
  1256     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1257
  1258     12  PI-CONTROL-IN-PROGRESS.
  1259         16  PI-CARRIER                  PIC X.
  1260         16  PI-GROUPING                 PIC X(6).
  1261         16  PI-STATE                    PIC XX.
  1262         16  PI-ACCOUNT                  PIC X(10).
  1263         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1264                                         PIC X(10).
  1265         16  PI-CLAIM-CERT-GRP.
  1266             20  PI-CLAIM-NO             PIC X(7).
  1267             20  PI-CERT-NO.
  1268                 25  PI-CERT-PRIME       PIC X(10).
  1269                 25  PI-CERT-SFX         PIC X.
  1270             20  PI-CERT-EFF-DT          PIC XX.
  1271         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1272             20  PI-PLAN-CODE            PIC X(2).
  1273             20  PI-REVISION-NUMBER      PIC X(3).
  1274             20  PI-PLAN-EFF-DT          PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL690.cbl
  1275             20  PI-PLAN-EXP-DT          PIC X(2).
  1276             20  FILLER                  PIC X(11).
  1277         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1278             20  PI-OE-REFERENCE-1.
  1279                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1280                 25  PI-OE-REF-1-SUFF    PIC XX.
  1281
  1282     12  PI-SESSION-IN-PROGRESS          PIC X.
  1283         88  CLAIM-SESSION                   VALUE '1'.
  1284         88  CREDIT-SESSION                  VALUE '2'.
  1285         88  WARRANTY-SESSION                VALUE '3'.
  1286         88  MORTGAGE-SESSION                VALUE '4'.
  1287         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1288
  1289
  1290*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1291
  1292     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1293     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1294
  1295     12  PI-CREDIT-USER                  PIC X.
  1296         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1297         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1298
  1299     12  PI-CLAIM-USER                   PIC X.
  1300         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1301         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1302
  1303     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1304         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1305         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1306         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1307         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1308         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1309
  1310     12  PI-PROCESSOR-ID                 PIC X(4).
  1311
  1312     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1313
  1314     12  PI-MEMBER-CAPTION               PIC X(10).
  1315
  1316     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1317         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1318
  1319     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1320     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1321     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1322     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1323
  1324     12  PI-AH-OVERRIDE-L1               PIC X.
  1325     12  PI-AH-OVERRIDE-L2               PIC XX.
  1326     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1327     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1328
  1329     12  PI-NEW-SYSTEM                   PIC X(2).
  1330
  1331     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1332     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL690.cbl
  1333         88  PI-USES-PAID-TO                 VALUE '1'.
  1334     12  PI-CRDTCRD-SYSTEM.
  1335         16  PI-CRDTCRD-USER             PIC X.
  1336             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1337             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1338         16  PI-CC-MONTH-END-DT          PIC XX.
  1339     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1340
  1341     12  PI-OE-REFERENCE-2.
  1342         16  PI-OE-REF-2-PRIME           PIC X(10).
  1343         16  PI-OE-REF-2-SUFF            PIC X.
  1344
  1345     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1346
  1347     12  PI-LANGUAGE-TYPE                PIC X.
  1348             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1349             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1350             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1351
  1352     12  PI-POLICY-LINKAGE-IND           PIC X.
  1353         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1354         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1355                                                   LOW-VALUES.
  1356
  1357     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1358     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1359         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1360         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1361
  1362     12  PI-PROCESSOR-CSR-IND            PIC X.
  1363         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1364         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1365
  1366     12  FILLER                          PIC X(3).
  1367
  1368     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1369
  1370     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1371         PI-SYSTEM-LEVEL.
  1372
  1373         16  PI-ENTRY-CODES.
  1374             20  PI-ENTRY-CD-1           PIC X.
  1375             20  PI-ENTRY-CD-2           PIC X.
  1376
  1377         16  PI-RETURN-CODES.
  1378             20  PI-RETURN-CD-1          PIC X.
  1379             20  PI-RETURN-CD-2          PIC X.
  1380
  1381         16  PI-UPDATE-STATUS-SAVE.
  1382             20  PI-UPDATE-BY            PIC X(4).
  1383             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1384
  1385         16  PI-LOWER-CASE-LETTERS       PIC X.
  1386             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1387
  1388*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1389*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1390*            88  CARRIER-CLM-CNTL            VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL690.cbl
  1391
  1392         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1393             88  ST-ACCNT-CNTL               VALUE ' '.
  1394             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1395             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1396             88  ACCNT-CNTL                  VALUE '3'.
  1397             88  CARR-ACCNT-CNTL             VALUE '4'.
  1398
  1399         16  PI-PROCESSOR-CAP-LIST.
  1400             20  PI-SYSTEM-CONTROLS.
  1401                24 PI-SYSTEM-DISPLAY     PIC X.
  1402                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1403                24 PI-SYSTEM-MODIFY      PIC X.
  1404                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1405             20  FILLER                  PIC XX.
  1406             20  PI-DISPLAY-CAP          PIC X.
  1407                 88  DISPLAY-CAP             VALUE 'Y'.
  1408             20  PI-MODIFY-CAP           PIC X.
  1409                 88  MODIFY-CAP              VALUE 'Y'.
  1410             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1411                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1412             20  PI-FORCE-CAP            PIC X.
  1413                 88  FORCE-CAP               VALUE 'Y'.
  1414
  1415         16  PI-PROGRAM-CONTROLS.
  1416             20  PI-PGM-PRINT-OPT        PIC X.
  1417             20  PI-PGM-FORMAT-OPT       PIC X.
  1418             20  PI-PGM-PROCESS-OPT      PIC X.
  1419             20  PI-PGM-TOTALS-OPT       PIC X.
  1420
  1421         16  PI-HELP-INTERFACE.
  1422             20  PI-LAST-ERROR-NO        PIC X(4).
  1423             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1424
  1425         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1426             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1427
  1428         16  PI-CR-CONTROL-IN-PROGRESS.
  1429             20  PI-CR-CARRIER           PIC X.
  1430             20  PI-CR-GROUPING          PIC X(6).
  1431             20  PI-CR-STATE             PIC XX.
  1432             20  PI-CR-ACCOUNT           PIC X(10).
  1433             20  PI-CR-FIN-RESP          PIC X(10).
  1434             20  PI-CR-TYPE              PIC X.
  1435
  1436         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1437
  1438         16  PI-CR-MONTH-END-DT          PIC XX.
  1439
  1440         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1441             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1442             88  PI-ZERO-CARRIER             VALUE '1'.
  1443             88  PI-ZERO-GROUPING            VALUE '2'.
  1444             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1445
  1446         16  PI-CARRIER-SECURITY         PIC X.
  1447             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1448
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL690.cbl
  1449         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1450             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1451             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1452
  1453         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1454             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1455                                         INDEXED BY PI-ACCESS-NDX
  1456                                         PIC X.
  1457
  1458         16  PI-GA-BILLING-CONTROL       PIC X.
  1459             88  PI-GA-BILLING               VALUE '1'.
  1460
  1461         16  PI-MAIL-PROCESSING          PIC X.
  1462             88  PI-MAIL-YES                 VALUE 'Y'.
  1463
  1464         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1465
  1466         16  PI-AR-SYSTEM.
  1467             20  PI-AR-PROCESSING-CNTL   PIC X.
  1468                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1469             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1470             20  PI-AR-MONTH-END-DT      PIC XX.
  1471
  1472         16  PI-MP-SYSTEM.
  1473             20  PI-MORTGAGE-USER            PIC X.
  1474                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1475                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1476             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1477                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1478                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1479                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1480                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1481                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1482             20  PI-MP-MONTH-END-DT          PIC XX.
  1483             20  PI-MP-REFERENCE-NO.
  1484                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1485                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1486
  1487         16  PI-LABEL-CONTROL            PIC X(01).
  1488             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1489             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1490
  1491         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1492             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1493
  1494         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1495             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1496             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1497
  1498         16  FILLER                      PIC X(14).
  1499
  1500     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1501******************************************************************
  1502     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  1503*    COPY ELC1042.
  1504******************************************************************
  1505*                                                                *
  1506*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL690.cbl
  1507*                           ELC1042                              *
  1508*                            VMOD=2.002                          *
  1509*                                                                *
  1510*    NOTE                                                        *
  1511*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  1512*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  1513*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  1514*        TO THESE PROGRAMS.                                      *
  1515*                                                                *
  1516*    NOTE                                                        *
  1517*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  1518*        USE ONLY!                                               *
  1519*                                                                *
  1520******************************************************************
  1521
  1522         16  PI-1042-WA.
  1523             20  PI-ACTION       PIC  X(01).
  1524                 88 PI-SHOW-MODE           VALUE '1'.
  1525                 88 PI-CLEAR-MODE          VALUE '2'.
  1526                 88 PI-CREATE-MODE         VALUE '3'.
  1527             20  PI-COMM-CONTROL PIC  X(12).
  1528             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  1529             20  PI-EOF-SW       PIC  X(01).
  1530                 88  PI-FILE-EOF           VALUE 'Y'.
  1531             20  PI-FILETYP      PIC  X(01).
  1532             20  PI-FORM-SQUEEZE-CONTROL
  1533                                 PIC  X(01).
  1534                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  1535                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  1536             20  PI-LAST-CONTROL PIC  X(12).
  1537             20  PI-TEMP-STOR-ITEMS
  1538                                 PIC S9(04) COMP.
  1539             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  1540             20  PI-UPDATE-SW    PIC  9(01).
  1541                 88 ANY-UPDATES            VALUE 1.
  1542             20  PI-104-SCREEN-SENT-IND
  1543                                 PIC  X(01).
  1544                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  1545                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  1546             20  PI-1042-SCREEN-SENT-IND
  1547                                 PIC  X(01).
  1548                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  1549                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  1550             20  PI-1042-ARCHIVE-IND
  1551                                 PIC  X(01).
  1552                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  1553             20  FILLER          PIC  X(29).
  1554*    COPY ELC689PI.
  1555******************************************************************
  1556*                                                                *
  1557*                            ELC689PI                            *
  1558*                            VMOD=2.003                          *
  1559*                                                                *
  1560*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  1561*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  1562*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  1563*                                                                *
  1564*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL690.cbl
  1565*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  1566*    BETWEEN PROGRAMS.                                           *
  1567*                                                                *
  1568*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  1569*                                                                *
  1570*               EL631 - EL689  - EL6891 - EL6892                 *
  1571*                                                                *
  1572******************************************************************
  1573*                   C H A N G E   L O G
  1574*
  1575* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1576*-----------------------------------------------------------------
  1577*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1578* EFFECTIVE    NUMBER
  1579*-----------------------------------------------------------------
  1580* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  1581* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  1582* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  1583******************************************************************
  1584
  1585
  1586         16  PI-689-WORK-AREA.
  1587             20  PI-689-ALT-PRINTER-ID
  1588                                 PIC  X(04).
  1589             20  PI-689-ARCHIVE-NUMBER
  1590                                 PIC  9(08).
  1591             20  PI-689-ARCHIVE-SW
  1592                                 PIC  X(01).
  1593                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  1594             20  PI-689-DATA-SOURCE
  1595                                 PIC  X(01).
  1596                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  1597                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  1598                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
  1599                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
  1600                 88  PI-689-SRC-CHECKS         VALUE '5'.
  1601             20  PI-689-ERROR-IND
  1602                                 PIC  X(01).
  1603                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  1604             20  PI-689-ERROR    PIC  9(04).
  1605                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  1606                 88  PI-689-FATAL-ERROR
  1607                     VALUES 0004 0006 0008 0013 0023 0029 0033
  1608                            0042 0047 0051 0066 0067 0070
  1609                            0168 0169 0174 0175 0176 0177 0179
  1610                            0180 0181 0182 0184 0185 0189 0190
  1611                            0191
  1612                            0215 0279 0280
  1613                            0412 0413 0454
  1614                            0533 0537
  1615                            2055 2114 2208 2209 2216 2232 2369
  1616                            2398 2433 2908 2999
  1617                            3000 3770 3771 3775
  1618                            7250 7365 7367 7368 7369 7370 7371
  1619                            7272 7373 7374 7376 7377 7378 7379
  1620                            7381 7388 7390 7393 7395 7396 7398
  1621                            9095 9096 9281 9298 9299 9320 9327
  1622                            9426 9427.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL690.cbl
  1623                 88  PI-689-STOP-ERROR
  1624                     VALUES 0004 0008 0013 0023 0029 0033
  1625                            0042 0047 0066 0067 0070
  1626                            0168 0169 0174 0175 0176 0177
  1627                            0181 0182 0184 0185 0189 0190
  1628                            0279 0280
  1629                            0412 0413 0454
  1630                            2055 2208 2209 2216 2232
  1631                            2398 2999
  1632                            3000 3770 3771 3775
  1633                            7250 7365 7369 7370 7371
  1634                            7272 7373 7374 7376 7377 7378 7379
  1635                            7381 7388 7390 7393 7396 7398
  1636                            9095 9096 9299 9320 9426.
  1637             20  PI-689-FOLLOW-UP-DATE
  1638                                 PIC  X(02).
  1639             20  PI-689-FORM-NUMBER
  1640                                 PIC  X(04).
  1641             20  PI-689-LABEL-SOURCE
  1642                                 PIC X(01).
  1643                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  1644                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  1645                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  1646                 88  PI-689-SOURCE-COMP     VALUE '4'.
  1647                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  1648                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  1649                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  1650             20  PI-689-NUMBER-COPIES
  1651                                 PIC  9(01).
  1652             20  PI-689-NUMBER-LABEL-LINES
  1653                                 PIC  9(01).
  1654             20  PI-689-NUMBER-TEXT-RECORDS
  1655                                 PIC  9(03).
  1656             20  PI-689-PRINT-ORDER-SW
  1657                                 PIC  X(01).
  1658                 88  PI-689-PRINT-FIRST     VALUE '1'.
  1659                 88  PI-689-PRINT-SECOND    VALUE '2'.
  1660                 88  PI-689-PRINT-LATER     VALUE '3'.
  1661                 88  PI-689-PRINT-ONLY      VALUE '4'.
  1662             20  PI-689-PRINT-RESTRICTION
  1663                                 PIC  X(01).
  1664                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  1665                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  1666                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  1667             20  PI-689-PRINT-SW PIC  X(01).
  1668                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  1669             20  PI-689-RESEND-DATE-1
  1670                                 PIC  X(02).
  1671             20  PI-689-RESEND-LETR-1
  1672                                 PIC X(4).
  1673             20  PI-689-TEMP-STOR-ID
  1674                                 PIC  X(08).
  1675             20  PI-689-USE-SCREEN-IND
  1676                                 PIC  X(01).
  1677                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  1678             20  PI-689-ARCH-POINTER
  1679                                 PIC S9(08) COMP.
  1680                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL690.cbl
  1681             20  PI-689-ARCT-POINTER
  1682                                 PIC S9(08) COMP.
  1683                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  1684             20  PI-689-VARIABLE-DATA-GRP.
  1685                 24  PI-689-VARIABLE-DATA-1
  1686                                 PIC  X(30).
  1687                 24  PI-689-VARIABLE-DATA-2
  1688                                 PIC  X(30).
  1689                 24  PI-689-VARIABLE-DATA-3
  1690                                 PIC  X(30).
  1691                 24  PI-689-VARIABLE-DATA-4
  1692                                 PIC  X(30).
  1693
  1694         16  PI-689-KEY-DATA-FIELDS.
  1695             20  PI-689-ACCOUNT  PIC  X(10).
  1696             20  PI-689-CARRIER  PIC  X(01).
  1697             20  PI-689-CERT-NO.
  1698                 24  PI-689-CERT-PRIME
  1699                                 PIC  X(10).
  1700                 24  PI-689-CERT-SFX
  1701                                 PIC  X(01).
  1702             20  PI-689-CHG-SEQ-NO
  1703                                 PIC S9(04)    COMP.
  1704             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  1705                                 PIC  X(02).
  1706             20  PI-689-ENTRY-BATCH
  1707                                 PIC  X(06).
  1708             20  PI-689-EFF-DATE PIC  X(02).
  1709             20  PI-689-EXP-DATE PIC  X(02).
  1710             20  PI-689-GROUPING PIC  X(06).
  1711             20  PI-689-RESP-PERSON
  1712                                 PIC  X(10).
  1713             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  1714             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
  1715                                 PIC  X(04).
  1716             20  PI-689-STATE    PIC  X(02).
  1717             20  PI-689-TYPE     PIC  X(01).
  1718             20  PI-689-CONTROL  PIC S9(08)    COMP.
  1719             20  PI-689-ALT-SEQ-NO
  1720                                 PIC S9(04)    COMP.
  1721         16  PI-689-DATE-EDIT    PIC  X(08).
  1722         16  PI-689-FOLLOW-UP-EDIT
  1723                                 PIC  X(08).
  1724         16  PI-689-RESEND1-EDIT PIC  X(08).
  1725         16  PI-689-SEQ-EDIT     PIC  X(08).
  1726         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  1727         16  PI-689-LBL-OVERRIDE PIC  X(01).
  1728             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  1729         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  1730         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
  1731         16  PI-690-WORK-AREA.
  1732             20  PI-690-ARCHIVE-TABLE.
  1733                 24  PI-690-ARCHIVE-NUM OCCURS 12 TIMES
  1734                                 PIC S9(08) COMP.
  1735             20  PI-690-CURSOR   PIC S9(04) COMP.
  1736             20  PI-690-FIRST-DATA.
  1737                 24  PI-690-FIRST-CERT-NO.
  1738                     28  PI-690-FIRST-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL690.cbl
  1739                                 PIC  X(10).
  1740                     28  PI-690-FIRST-SUFFIX
  1741                                 PIC  X(01).
  1742                 24  PI-690-FIRST-CARRIER
  1743                                 PIC  X(01).
  1744                 24  PI-690-FIRST-GROUPING
  1745                                 PIC  X(06).
  1746                 24  PI-690-FIRST-STATE
  1747                                 PIC  X(02).
  1748                 24  PI-690-FIRST-ACCOUNT
  1749                                 PIC  X(10).
  1750                 24  PI-690-FIRST-EFFECT-DATE
  1751                                 PIC  X(02).
  1752                 24  PI-690-FIRST-ENTRY.
  1753                     28  PI-690-FIRST-CONTROL-PREFIX
  1754                                 PIC  X(02).
  1755                     28  PI-690-FIRST-CONTROL
  1756                                 PIC S9(08) COMP.
  1757                 24  PI-690-FIRST-FORM
  1758                                 PIC  X(04).
  1759                 24  PI-690-FIRST-PROCESSOR
  1760                                 PIC  X(04).
  1761                 24  PI-690-FIRST-ARCHIVE-NO
  1762                                 PIC S9(08) COMP.
  1763             20  PI-690-INIT-DATA.
  1764                 24  PI-690-INIT-CERT-NO.
  1765                     28  PI-690-INIT-CERT-PRIME
  1766                                 PIC  X(10).
  1767                     28  PI-690-INIT-SUFFIX
  1768                                 PIC  X(01).
  1769                 24  PI-690-INIT-CARRIER
  1770                                 PIC  X(01).
  1771                 24  PI-690-INIT-GROUPING
  1772                                 PIC  X(06).
  1773                 24  PI-690-INIT-STATE
  1774                                 PIC  X(02).
  1775                 24  PI-690-INIT-ACCOUNT
  1776                                 PIC  X(10).
  1777                 24  PI-690-INIT-EFFECT-DATE
  1778                                 PIC  X(02).
  1779                 24  PI-690-INIT-EFF-DTE
  1780                                 PIC  X(08).
  1781                 24  PI-690-INIT-ENTRY.
  1782                     28  PI-690-INIT-CONTROL-PREFIX
  1783                                 PIC  X(02).
  1784                     28  PI-690-INIT-CONTROL
  1785                                 PIC S9(08) COMP.
  1786                 24  PI-690-INIT-FORM
  1787                                 PIC  X(04).
  1788                 24  PI-690-INIT-PROCESSOR
  1789                                 PIC  X(04).
  1790                 24  PI-690-INIT-ARCHIVE-NO
  1791                                 PIC S9(08) COMP.
  1792             20  PI-690-LAST-DATA.
  1793                 24  PI-690-LAST-CERT-NO.
  1794                     28  PI-690-LAST-CERT-PRIME
  1795                                 PIC  X(10).
  1796                     28  PI-690-LAST-SUFFIX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL690.cbl
  1797                                 PIC  X(01).
  1798                 24  PI-690-LAST-CARRIER
  1799                                 PIC  X(01).
  1800                 24  PI-690-LAST-GROUPING
  1801                                 PIC  X(06).
  1802                 24  PI-690-LAST-STATE
  1803                                 PIC  X(02).
  1804                 24  PI-690-LAST-ACCOUNT
  1805                                 PIC  X(10).
  1806                 24  PI-690-LAST-EFFECT-DATE
  1807                                 PIC  X(02).
  1808                 24  PI-690-LAST-ENTRY.
  1809                     28  PI-690-LAST-CONTROL-PREFIX
  1810                                 PIC  X(02).
  1811                     28  PI-690-LAST-CONTROL
  1812                                 PIC S9(08) COMP.
  1813                 24  PI-690-LAST-FORM
  1814                                 PIC  X(04).
  1815                 24  PI-690-LAST-PROCESSOR
  1816                                 PIC  X(04).
  1817                 24  PI-690-LAST-ARCHIVE-NO
  1818                                 PIC S9(08) COMP.
  1819             20  PI-690-LAST-ARCH-NDX
  1820                                 PIC S9(04) COMP.
  1821             20  PI-690-BRWS-TYPE-IND
  1822                                 PIC  9(01).
  1823                 88  PI-690-BRWS-CERTRP               VALUE 1.
  1824                 88  PI-690-BRWS-FORM                 VALUE 2.
  1825                 88  PI-690-BRWS-PROCESSOR            VALUE 3.
  1826                 88  PI-690-BRWS-ACCOUNT              VALUE 4.
  1827                 88  PI-690-BRWS-ENTRY-CNTL           VALUE 5.
  1828                 88  PI-690-BRWS-ARCHIVE              VALUE 6.
  1829             20  PI-690-LAST-BROWSE-IND
  1830                                 PIC  X(01).
  1831                 88  PI-690-LAST-BRWS-FWRD            VALUE '1'.
  1832                 88  PI-690-LAST-BRWS-BWRD            VALUE '2'.
  1833             20  PI-690-STATUS-SELECTION-IND
  1834                                 PIC  X(01).
  1835                 88  PI-690-SELECT-ALL       VALUE 'N'.
  1836                 88  PI-690-VALID-SELECTION  VALUE 'A' 'C' 'H'
  1837                                               'X' 'P' 'V' 'N'.
  1838         16  FILLER              PIC X(67).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL690.cbl
  1840 01  FILLER                      PIC  X(19)
  1841                                 VALUE ':END INTERFACE AREA'.
  1842
  1843 01  ERROR-MESSAGES.
  1844     12  ER-0000                 PIC  X(04)  VALUE '0000'.
  1845     12  ER-0004                 PIC  X(04)  VALUE '0004'.
  1846     12  ER-0023                 PIC  X(04)  VALUE '0023'.
  1847     12  ER-0029                 PIC  X(04)  VALUE '0029'.
  1848     12  ER-0050                 PIC  X(04)  VALUE '0050'.
  1849     12  ER-0068                 PIC  X(04)  VALUE '0068'.
  1850     12  ER-0074                 PIC  X(04)  VALUE '0074'.
  1851     12  ER-0085                 PIC  X(04)  VALUE '0085'.
  1852     12  ER-0130                 PIC  X(04)  VALUE '0130'.
  1853     12  ER-0131                 PIC  X(04)  VALUE '0131'.
  1854     12  ER-0185                 PIC  X(04)  VALUE '0185'.
  1855     12  ER-0190                 PIC  X(04)  VALUE '0190'.
  1856     12  ER-0314                 PIC  X(04)  VALUE '0314'.
  1857     12  ER-7008                 PIC  X(04)  VALUE '7008'.
  1858     12  ER-7244                 PIC  X(04)  VALUE '7244'.
  1859     12  ER-7357                 PIC  X(04)  VALUE '7357'.
  1860     12  ER-7358                 PIC  X(04)  VALUE '7358'.
  1861     12  ER-7359                 PIC  X(04)  VALUE '7359'.
  1862     12  ER-7360                 PIC  X(04)  VALUE '7360'.
  1863     12  ER-7361                 PIC  X(04)  VALUE '7361'.
  1864     12  ER-7362                 PIC  X(04)  VALUE '7362'.
  1865     12  ER-7366                 PIC  X(04)  VALUE '7366'.
  1866     12  ER-7384                 PIC  X(04)  VALUE '7384'.
  1867     12  ER-7385                 PIC  X(04)  VALUE '7385'.
  1868     12  ER-7386                 PIC  X(04)  VALUE '7386'.
  1869     12  ER-7387                 PIC  X(04)  VALUE '7387'.
  1870     12  ER-7388                 PIC  X(04)  VALUE '7388'.
  1871*    12  ER-7394                 PIC  X(04)  VALUE '7394'.
  1872     12  ER-7396                 PIC  X(04)  VALUE '7396'.
  1873     12  ER-7397                 PIC  X(04)  VALUE '7397'.
  1874     12  ER-7399                 PIC  X(04)  VALUE '7399'.
  1875     12  ER-9007                 PIC  X(04)  VALUE '9007'.
  1876     12  ER-9008                 PIC  X(04)  VALUE '9008'.
  1877     12  ER-9009                 PIC  X(04)  VALUE '9009'.
  1878     12  ER-9010                 PIC  X(04)  VALUE '9010'.
  1879     12  ER-9011                 PIC  X(04)  VALUE '9011'.
  1880     12  ER-9012                 PIC  X(04)  VALUE '9012'.
  1881     12  ER-9015                 PIC  X(04)  VALUE '9015'.
  1882     12  ER-9016                 PIC  X(04)  VALUE '9016'.
  1883     12  ER-9017                 PIC  X(04)  VALUE '9017'.
  1884     12  ER-9042                 PIC  X(04)  VALUE '9042'.
  1885     12  ER-9080                 PIC  X(04)  VALUE '9080'.
  1886     12  ER-9096                 PIC  X(04)  VALUE '9096'.
  1887     12  ER-9097                 PIC  X(04)  VALUE '9097'.
  1888     12  ER-9129                 PIC  X(04)  VALUE '9129'.
  1889     12  ER-9150                 PIC  X(04)  VALUE '9150'.
  1890     12  ER-9196                 PIC  X(04)  VALUE '9196'.
  1891     12  ER-9245                 PIC  X(04)  VALUE '9245'.
  1892     12  ER-9281                 PIC  X(04)  VALUE '9281'.
  1893     12  ER-9282                 PIC  X(04)  VALUE '9282'.
  1894     12  ER-9293                 PIC  X(04)  VALUE '9293'.
  1895     12  ER-9308                 PIC  X(04)  VALUE '9308'.
  1896     12  ER-9310                 PIC  X(04)  VALUE '9310'.
  1897     12  ER-9312                 PIC  X(04)  VALUE '9312'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL690.cbl
  1898     12  ER-9323                 PIC  X(04)  VALUE '9323'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL690.cbl
  1900*    COPY ELCAID REPLACING '01 DFHAID.' BY '01  DFHAID.'.
  1901******************************************************************
  1902*                                                                *
  1903*                            ELCAID.                             *
  1904*                            VMOD=2.001                          *
  1905*                                                                *
  1906*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1907*                                                                *
  1908*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1909*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1910******************************************************************
  1911
  1912 01  DFHAID.
  1913   02  DFHNULL   PIC  X  VALUE  ' '.
  1914   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1915   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1916   02  DFHPEN    PIC  X  VALUE  '='.
  1917   02  DFHOPID   PIC  X  VALUE  'W'.
  1918   02  DFHPA1    PIC  X  VALUE  '%'.
  1919   02  DFHPA2    PIC  X  VALUE  '>'.
  1920   02  DFHPA3    PIC  X  VALUE  ','.
  1921   02  DFHPF1    PIC  X  VALUE  '1'.
  1922   02  DFHPF2    PIC  X  VALUE  '2'.
  1923   02  DFHPF3    PIC  X  VALUE  '3'.
  1924   02  DFHPF4    PIC  X  VALUE  '4'.
  1925   02  DFHPF5    PIC  X  VALUE  '5'.
  1926   02  DFHPF6    PIC  X  VALUE  '6'.
  1927   02  DFHPF7    PIC  X  VALUE  '7'.
  1928   02  DFHPF8    PIC  X  VALUE  '8'.
  1929   02  DFHPF9    PIC  X  VALUE  '9'.
  1930   02  DFHPF10   PIC  X  VALUE  ':'.
  1931   02  DFHPF11   PIC  X  VALUE  '#'.
  1932   02  DFHPF12   PIC  X  VALUE  '@'.
  1933   02  DFHPF13   PIC  X  VALUE  'A'.
  1934   02  DFHPF14   PIC  X  VALUE  'B'.
  1935   02  DFHPF15   PIC  X  VALUE  'C'.
  1936   02  DFHPF16   PIC  X  VALUE  'D'.
  1937   02  DFHPF17   PIC  X  VALUE  'E'.
  1938   02  DFHPF18   PIC  X  VALUE  'F'.
  1939   02  DFHPF19   PIC  X  VALUE  'G'.
  1940   02  DFHPF20   PIC  X  VALUE  'H'.
  1941   02  DFHPF21   PIC  X  VALUE  'I'.
  1942*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1943   02  DFHPF22   PIC  X  VALUE  '['.
  1944   02  DFHPF23   PIC  X  VALUE  '.'.
  1945   02  DFHPF24   PIC  X  VALUE  '<'.
  1946   02  DFHMSRE   PIC  X  VALUE  'X'.
  1947   02  DFHSTRF   PIC  X  VALUE  'h'.
  1948   02  DFHTRIG   PIC  X  VALUE  '"'.
  1949 01  FILLER  REDEFINES  DFHAID.
  1950     12  FILLER                  PIC  X(08).
  1951     12  PF-VALUES               PIC  X(01)  OCCURS 2.
  1952
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL690.cbl
  1954*    COPY ELCATTR.
  1955******************************************************************
  1956*                                                                *
  1957*                            ELCATTR.                            *
  1958*                            VMOD=2.001                          *
  1959*                                                                *
  1960*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1961*                                                                *
  1962*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1963*                                                                *
  1964*                   POS 1   P=PROTECTED                          *
  1965*                           U=UNPROTECTED                        *
  1966*                           S=ASKIP                              *
  1967*                   POS 2   A=ALPHA/NUMERIC                      *
  1968*                           N=NUMERIC                            *
  1969*                   POS 3   N=NORMAL                             *
  1970*                           B=BRIGHT                             *
  1971*                           D=DARK                               *
  1972*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1973*                           OF=MODIFIED DATA TAG OFF             *
  1974*                                                                *
  1975*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1976******************************************************************
  1977 01  ATTRIBUTE-LIST.
  1978     12  AL-PABOF            PIC X       VALUE 'Y'.
  1979     12  AL-PABON            PIC X       VALUE 'Z'.
  1980     12  AL-PADOF            PIC X       VALUE '%'.
  1981     12  AL-PADON            PIC X       VALUE '_'.
  1982     12  AL-PANOF            PIC X       VALUE '-'.
  1983     12  AL-PANON            PIC X       VALUE '/'.
  1984     12  AL-SABOF            PIC X       VALUE '8'.
  1985     12  AL-SABON            PIC X       VALUE '9'.
  1986     12  AL-SADOF            PIC X       VALUE '@'.
  1987     12  AL-SADON            PIC X       VALUE QUOTE.
  1988     12  AL-SANOF            PIC X       VALUE '0'.
  1989     12  AL-SANON            PIC X       VALUE '1'.
  1990     12  AL-UABOF            PIC X       VALUE 'H'.
  1991     12  AL-UABON            PIC X       VALUE 'I'.
  1992     12  AL-UADOF            PIC X       VALUE '<'.
  1993     12  AL-UADON            PIC X       VALUE '('.
  1994     12  AL-UANOF            PIC X       VALUE ' '.
  1995     12  AL-UANON            PIC X       VALUE 'A'.
  1996     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1997     12  AL-UNBON            PIC X       VALUE 'R'.
  1998     12  AL-UNDOF            PIC X       VALUE '*'.
  1999     12  AL-UNDON            PIC X       VALUE ')'.
  2000     12  AL-UNNOF            PIC X       VALUE '&'.
  2001     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL690.cbl
  2003*    COPY ELCDATE.
  2004******************************************************************
  2005*                                                                *
  2006*                                                                *
  2007*                            ELCDATE.                            *
  2008*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2009*                            VMOD=2.003
  2010*                                                                *
  2011*                                                                *
  2012*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2013*                 LENGTH = 200                                   *
  2014******************************************************************
  2015
  2016 01  DATE-CONVERSION-DATA.
  2017     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2018     12  DC-OPTION-CODE                PIC X.
  2019         88  BIN-TO-GREG                VALUE ' '.
  2020         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2021         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2022         88  YMD-GREG-TO-BIN            VALUE '3'.
  2023         88  MDY-GREG-TO-BIN            VALUE '4'.
  2024         88  JULIAN-TO-BIN              VALUE '5'.
  2025         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2026         88  FIND-CENTURY               VALUE '7'.
  2027         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2028         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2029         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2030         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2031         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2032         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2033         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2034         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2035         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2036         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2037         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2038         88  BIN-3-TO-GREG              VALUE 'I'.
  2039         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2040         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2041         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2042         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2043         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2044         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2045         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2046         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2047         88  THREE-CHARACTER-BIN
  2048                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2049         88  GREGORIAN-TO-BIN
  2050                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2051         88  BIN-TO-GREGORIAN
  2052                  VALUES ' ' '1' 'I' '8' 'G'.
  2053         88  JULIAN-TO-BINARY
  2054                  VALUES '5' 'C' 'E' 'F'.
  2055     12  DC-ERROR-CODE                 PIC X.
  2056         88  NO-CONVERSION-ERROR        VALUE ' '.
  2057         88  DATE-CONVERSION-ERROR
  2058                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2059         88  DATE-IS-ZERO               VALUE '1'.
  2060         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL690.cbl
  2061         88  DATE-IS-INVALID            VALUE '3'.
  2062         88  DATE1-GREATER-DATE2        VALUE '4'.
  2063         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2064         88  DATE-INVALID-OPTION        VALUE '9'.
  2065         88  INVALID-CENTURY            VALUE 'A'.
  2066         88  ONLY-CENTURY               VALUE 'B'.
  2067         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2068         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2069     12  DC-END-OF-MONTH               PIC X.
  2070         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2071     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2072         88  USE-NORMAL-PROCESS         VALUE ' '.
  2073         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2074         88  ADJUST-UP-100-YRS          VALUE '2'.
  2075     12  FILLER                        PIC X.
  2076     12  DC-CONVERSION-DATES.
  2077         16  DC-BIN-DATE-1             PIC XX.
  2078         16  DC-BIN-DATE-2             PIC XX.
  2079         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2080         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2081                       DC-GREG-DATE-1-EDIT.
  2082             20  DC-EDIT1-MONTH        PIC 99.
  2083             20  SLASH1-1              PIC X.
  2084             20  DC-EDIT1-DAY          PIC 99.
  2085             20  SLASH1-2              PIC X.
  2086             20  DC-EDIT1-YEAR         PIC 99.
  2087         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2088         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2089                     DC-GREG-DATE-2-EDIT.
  2090             20  DC-EDIT2-MONTH        PIC 99.
  2091             20  SLASH2-1              PIC X.
  2092             20  DC-EDIT2-DAY          PIC 99.
  2093             20  SLASH2-2              PIC X.
  2094             20  DC-EDIT2-YEAR         PIC 99.
  2095         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2096         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2097                     DC-GREG-DATE-1-YMD.
  2098             20  DC-YMD-YEAR           PIC 99.
  2099             20  DC-YMD-MONTH          PIC 99.
  2100             20  DC-YMD-DAY            PIC 99.
  2101         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2102         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2103                      DC-GREG-DATE-1-MDY.
  2104             20  DC-MDY-MONTH          PIC 99.
  2105             20  DC-MDY-DAY            PIC 99.
  2106             20  DC-MDY-YEAR           PIC 99.
  2107         16  DC-GREG-DATE-1-ALPHA.
  2108             20  DC-ALPHA-MONTH        PIC X(10).
  2109             20  DC-ALPHA-DAY          PIC 99.
  2110             20  FILLER                PIC XX.
  2111             20  DC-ALPHA-CENTURY.
  2112                 24 DC-ALPHA-CEN-N     PIC 99.
  2113             20  DC-ALPHA-YEAR         PIC 99.
  2114         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2115         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2116         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2117         16  DC-JULIAN-DATE            PIC 9(05).
  2118         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL690.cbl
  2119                                       PIC 9(05).
  2120         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2121             20  DC-JULIAN-YEAR        PIC 99.
  2122             20  DC-JULIAN-DAYS        PIC 999.
  2123         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2124         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2125         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2126     12  DATE-CONVERSION-VARIBLES.
  2127         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2128         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2129             20  FILLER                PIC 9(3).
  2130             20  HOLD-CEN-1-CCYY.
  2131                 24  HOLD-CEN-1-CC     PIC 99.
  2132                 24  HOLD-CEN-1-YY     PIC 99.
  2133             20  HOLD-CEN-1-MO         PIC 99.
  2134             20  HOLD-CEN-1-DA         PIC 99.
  2135         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2136             20  HOLD-CEN-1-R-MO       PIC 99.
  2137             20  HOLD-CEN-1-R-DA       PIC 99.
  2138             20  HOLD-CEN-1-R-CCYY.
  2139                 24  HOLD-CEN-1-R-CC   PIC 99.
  2140                 24  HOLD-CEN-1-R-YY   PIC 99.
  2141             20  FILLER                PIC 9(3).
  2142         16  HOLD-CENTURY-1-X.
  2143             20  FILLER                PIC X(3)  VALUE SPACES.
  2144             20  HOLD-CEN-1-X-CCYY.
  2145                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2146                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2147             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2148             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2149         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2150             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2151             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2152             20  HOLD-CEN-1-R-X-CCYY.
  2153                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2154                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2155             20  FILLER                PIC XXX.
  2156         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2157         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2158         16  DC-JULIAN-DATE-1          PIC 9(07).
  2159         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2160             20  DC-JULIAN-1-CCYY.
  2161                 24  DC-JULIAN-1-CC    PIC 99.
  2162                 24  DC-JULIAN-1-YR    PIC 99.
  2163             20  DC-JULIAN-DA-1        PIC 999.
  2164         16  DC-JULIAN-DATE-2          PIC 9(07).
  2165         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2166             20  DC-JULIAN-2-CCYY.
  2167                 24  DC-JULIAN-2-CC    PIC 99.
  2168                 24  DC-JULIAN-2-YR    PIC 99.
  2169             20  DC-JULIAN-DA-2        PIC 999.
  2170         16  DC-GREG-DATE-A-EDIT.
  2171             20  DC-EDITA-MONTH        PIC 99.
  2172             20  SLASHA-1              PIC X VALUE '/'.
  2173             20  DC-EDITA-DAY          PIC 99.
  2174             20  SLASHA-2              PIC X VALUE '/'.
  2175             20  DC-EDITA-CCYY.
  2176                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL690.cbl
  2177                 24  DC-EDITA-YEAR     PIC 99.
  2178         16  DC-GREG-DATE-B-EDIT.
  2179             20  DC-EDITB-MONTH        PIC 99.
  2180             20  SLASHB-1              PIC X VALUE '/'.
  2181             20  DC-EDITB-DAY          PIC 99.
  2182             20  SLASHB-2              PIC X VALUE '/'.
  2183             20  DC-EDITB-CCYY.
  2184                 24  DC-EDITB-CENT     PIC 99.
  2185                 24  DC-EDITB-YEAR     PIC 99.
  2186         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2187         16  DC-GREG-DATE-CYMD-R REDEFINES
  2188                              DC-GREG-DATE-CYMD.
  2189             20  DC-CYMD-CEN           PIC 99.
  2190             20  DC-CYMD-YEAR          PIC 99.
  2191             20  DC-CYMD-MONTH         PIC 99.
  2192             20  DC-CYMD-DAY           PIC 99.
  2193         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2194         16  DC-GREG-DATE-MDCY-R REDEFINES
  2195                              DC-GREG-DATE-MDCY.
  2196             20  DC-MDCY-MONTH         PIC 99.
  2197             20  DC-MDCY-DAY           PIC 99.
  2198             20  DC-MDCY-CEN           PIC 99.
  2199             20  DC-MDCY-YEAR          PIC 99.
  2200    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2201        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2202    12  DC-EL310-DATE                  PIC X(21).
  2203    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL690.cbl
  2205*    COPY ELCEMIB.
  2206******************************************************************
  2207*                                                                *
  2208*                                                                *
  2209*                            ELCEMIB.                            *
  2210*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2211*                            VMOD=2.005                          *
  2212*                                                                *
  2213*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2214*                                                                *
  2215******************************************************************
  2216 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2217     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2218     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2219     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2220     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2221     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2222     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2223     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2224     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2225     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2226         88  EMI-NO-ERRORS                    VALUE '1'.
  2227         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2228         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2229     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2230         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2231     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2232         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2233         88  EMI-AREA1-FULL                   VALUE '2'.
  2234     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2235         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2236         88  EMI-AREA2-FULL                   VALUE '2'.
  2237     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2238         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2239         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2240         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2241         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2242         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2243     12  EMI-ERROR-LINES.
  2244         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2245         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2246         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2247         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2248             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2249                 24  EMI-ERR-NUM         PIC X(4).
  2250                 24  EMI-FILLER          PIC X.
  2251                 24  EMI-SEV             PIC X.
  2252                 24  FILLER              PIC X.
  2253             20  FILLER                  PIC X(02).
  2254     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2255         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2256             20  EMI-ERROR-NUMBER    PIC X(4).
  2257             20  EMI-FILL            PIC X.
  2258             20  EMI-SEVERITY        PIC X.
  2259             20  FILLER              PIC X.
  2260             20  EMI-ERROR-TEXT.
  2261                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2262                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL690.cbl
  2263     12  EMI-SEVERITY-SAVE           PIC X.
  2264         88  EMI-NOTE                    VALUE 'N'.
  2265         88  EMI-WARNING                 VALUE 'W'.
  2266         88  EMI-FORCABLE                VALUE 'F'.
  2267         88  EMI-FATAL                   VALUE 'X'.
  2268     12  EMI-MESSAGE-FLAG            PIC X.
  2269         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2270         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2271     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2272     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2273         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2274         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2275         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2276     12  FILLER                      PIC X(137)  VALUE SPACES.
  2277     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2278     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2279     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2280     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL690.cbl
  2282*    COPY ELCLOGOF.
  2283******************************************************************
  2284*                                                                *
  2285*                                                                *
  2286*                            ELCLOGOF.                           *
  2287*                            VMOD=2.001                          *
  2288*                                                                *
  2289*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2290*                                                                *
  2291******************************************************************
  2292 01  CLASIC-LOGOFF.
  2293     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2294     12  LOGOFF-TEXT.
  2295         16  FILLER          PIC X(5)    VALUE SPACES.
  2296         16  LOGOFF-MSG.
  2297             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2298             20  FILLER      PIC X       VALUE SPACES.
  2299             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2300         16  FILLER          PIC X(80)
  2301           VALUE '* YOU ARE NOW LOGGED OFF'.
  2302         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2303         16  FILLER          PIC X       VALUE QUOTE.
  2304         16  LOGOFF-SYS-MSG  PIC X(17)
  2305           VALUE 'S CLAS-IC SYSTEM '.
  2306     12  TEXT-MESSAGES.
  2307         16  UNACCESS-MSG    PIC X(29)
  2308             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2309         16  PGMIDERR-MSG    PIC X(17)
  2310             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL690.cbl
  2312*    COPY ELCSCTM.
  2313******************************************************************
  2314*                                                                *
  2315*                                                                *
  2316*                            ELCSCTM                             *
  2317*                            VMOD=2.001                          *
  2318*                                                                *
  2319*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
  2320*                                                                *
  2321******************************************************************
  2322 01  SECURITY-MESSAGE.
  2323     12  FILLER                          PIC X(30)
  2324            VALUE '** LOGIC SECURITY VIOLATION -'.
  2325     12  SM-READ                         PIC X(6).
  2326     12  FILLER                          PIC X(5)
  2327            VALUE ' PGM='.
  2328     12  SM-PGM                          PIC X(6).
  2329     12  FILLER                          PIC X(5)
  2330            VALUE ' OPR='.
  2331     12  SM-PROCESSOR-ID                 PIC X(4).
  2332     12  FILLER                          PIC X(6)
  2333            VALUE ' TERM='.
  2334     12  SM-TERMID                       PIC X(4).
  2335     12  FILLER                          PIC XX   VALUE SPACE.
  2336     12  SM-JUL-DATE                     PIC 9(5).
  2337     12  FILLER                          PIC X    VALUE SPACE.
  2338     12  SM-TIME                         PIC 99.99.
  2339
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL690.cbl
  2341*    COPY ELCSCRTY.
  2342******************************************************************
  2343*                                                                *
  2344*                                                                *
  2345*                            ELCSCRTY                            *
  2346*                            VMOD=2.001                          *
  2347*                                                                *
  2348*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
  2349*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
  2350*        SAVED IN PI-SECURITY-ADDRESS.                           *
  2351*                                                                *
  2352******************************************************************
  2353 01  SECURITY-CONTROL.
  2354     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
  2355     12  FILLER                       PIC XX    VALUE 'SC'.
  2356     12  SC-CREDIT-CODES.
  2357         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
  2358             20  SC-CREDIT-DISPLAY    PIC X.
  2359             20  SC-CREDIT-UPDATE     PIC X.
  2360     12  SC-CLAIMS-CODES.
  2361         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
  2362             20  SC-CLAIMS-DISPLAY    PIC X.
  2363             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL690.cbl
  2365****************************************************************
  2366*
  2367* Copyright (c) 2007 by Clerity Solutions, Inc.
  2368* All rights reserved.
  2369*
  2370****************************************************************
  2371 01  DFHEIV.
  2372   02  DFHEIV0               PIC X(35).
  2373   02  DFHEIV1               PIC X(08).
  2374   02  DFHEIV2               PIC X(08).
  2375   02  DFHEIV3               PIC X(08).
  2376   02  DFHEIV4               PIC X(06).
  2377   02  DFHEIV5               PIC X(04).
  2378   02  DFHEIV6               PIC X(04).
  2379   02  DFHEIV7               PIC X(02).
  2380   02  DFHEIV8               PIC X(02).
  2381   02  DFHEIV9               PIC X(01).
  2382   02  DFHEIV10              PIC S9(7) COMP-3.
  2383   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2384   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2385   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2386   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2387   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2388   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2389   02  DFHEIV17              PIC X(04).
  2390   02  DFHEIV18              PIC X(04).
  2391   02  DFHEIV19              PIC X(04).
  2392   02  DFHEIV20              USAGE IS POINTER.
  2393   02  DFHEIV21              USAGE IS POINTER.
  2394   02  DFHEIV22              USAGE IS POINTER.
  2395   02  DFHEIV23              USAGE IS POINTER.
  2396   02  DFHEIV24              USAGE IS POINTER.
  2397   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2398   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2399   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2400   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2401   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2402   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2403   02  FILLER                PIC X(02).
  2404   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2405   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2406   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2407   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2408   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2409 LINKAGE  SECTION.
  2410*****************************************************************
  2411*                                                               *
  2412* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2413* All rights reserved.                                          *
  2414*                                                               *
  2415*****************************************************************
  2416 01  dfheiblk.
  2417     02  eibtime          pic s9(7) comp-3.
  2418     02  eibdate          pic s9(7) comp-3.
  2419     02  eibtrnid         pic x(4).
  2420     02  eibtaskn         pic s9(7) comp-3.
  2421     02  eibtrmid         pic x(4).
  2422     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL690.cbl
  2423     02  eibcposn         pic s9(4) comp.
  2424     02  eibcalen         pic s9(4) comp.
  2425     02  eibaid           pic x(1).
  2426     02  eibfiller1       pic x(1).
  2427     02  eibfn            pic x(2).
  2428     02  eibfiller2       pic x(2).
  2429     02  eibrcode         pic x(6).
  2430     02  eibfiller3       pic x(2).
  2431     02  eibds            pic x(8).
  2432     02  eibreqid         pic x(8).
  2433     02  eibrsrce         pic x(8).
  2434     02  eibsync          pic x(1).
  2435     02  eibfree          pic x(1).
  2436     02  eibrecv          pic x(1).
  2437     02  eibsend          pic x(1).
  2438     02  eibatt           pic x(1).
  2439     02  eibeoc           pic x(1).
  2440     02  eibfmh           pic x(1).
  2441     02  eibcompl         pic x(1).
  2442     02  eibsig           pic x(1).
  2443     02  eibconf          pic x(1).
  2444     02  eiberr           pic x(1).
  2445     02  eibrldbk         pic x(1).
  2446     02  eiberrcd         pic x(4).
  2447     02  eibsynrb         pic x(1).
  2448     02  eibnodat         pic x(1).
  2449     02  eibfiller5       pic x(2).
  2450     02  eibresp          pic 9(09) comp.
  2451     02  eibresp2         pic 9(09) comp.
  2452     02  dfheigdj         pic s9(4) comp.
  2453     02  dfheigdk         pic s9(4) comp.
  2454 01  DFHCOMMAREA                 PIC X(1024).
  2455
  2456*01 PARMLIST .
  2457*    12  FILLER                  PIC S9(8)   COMP.
  2458*    12  L-ARCH-POINTER          PIC S9(8)   COMP.
  2459*    12  L-ARCT-POINTER          PIC S9(8)   COMP.
  2460*    12  L-CNTL-POINTER          PIC S9(8)   COMP.
  2461
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL690.cbl
  2463*    COPY ERCARCH.
  2464******************************************************************
  2465*                                                                *
  2466*                            ERCARCH.                            *
  2467*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2468*                            VMOD=2.002                          *
  2469*                                                                *
  2470*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  2471*                                                                *
  2472*   FILE TYPE = VSAM,KSDS                                        *
  2473*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2474*                                                                *
  2475*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  2476*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  2477*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  2478*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  2479*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  2480*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  2481*                                                                *
  2482*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2483******************************************************************
  2484*                   C H A N G E   L O G
  2485*
  2486* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2487*-----------------------------------------------------------------
  2488*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2489* EFFECTIVE    NUMBER
  2490*-----------------------------------------------------------------
  2491* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2492* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  2493******************************************************************
  2494 01  LETTER-ARCHIVE.
  2495     12  LA-RECORD-ID                PIC  X(02).
  2496         88  LA-VALID-ID                VALUE 'LA'.
  2497
  2498     12  LA-CONTROL-PRIMARY.
  2499         16  LA-COMPANY-CD           PIC  X(01).
  2500         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  2501
  2502     12  LA-CONTROL-BY-CERT-RESP.
  2503         16  LA-COMPANY-CD-A2        PIC  X(01).
  2504         16  LA-CERT-NO-A2.
  2505             20  LA-CERT-PRIME-A2    PIC  X(10).
  2506             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  2507         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  2508             20  LA-RESP-PERSON-A2   PIC  X(10).
  2509             20  LA-TYPE-A2          PIC  X(01).
  2510         16  LA-CARRIER-A2           PIC  X(01).
  2511         16  LA-GROUPING-A2          PIC  X(06).
  2512         16  LA-STATE-A2             PIC  X(02).
  2513         16  LA-ACCOUNT-A2           PIC  X(10).
  2514         16  LA-EFFECT-DATE-A2       PIC  X(02).
  2515         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  2516
  2517     12  LA-CONTROL-BY-FORM.
  2518         16  LA-COMPANY-CD-A3        PIC  X(01).
  2519         16  LA-FORM-A3              PIC  X(04).
  2520         16  LA-CARRIER-A3           PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL690.cbl
  2521         16  LA-GROUPING-A3          PIC  X(06).
  2522         16  LA-STATE-A3             PIC  X(02).
  2523         16  LA-ACCOUNT-A3           PIC  X(10).
  2524         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  2525
  2526     12  LA-CONTROL-BY-PROCESSOR.
  2527         16  LA-COMPANY-CD-A4        PIC  X(01).
  2528         16  LA-PROCESSOR-CD         PIC  X(04).
  2529         16  LA-CARRIER-A4           PIC  X(01).
  2530         16  LA-GROUPING-A4          PIC  X(06).
  2531         16  LA-STATE-A4             PIC  X(02).
  2532         16  LA-ACCOUNT-A4           PIC  X(10).
  2533         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  2534
  2535     12  LA-CONTROL-BY-KEY-FIELDS.
  2536         16  LA-COMPANY-CD-A5        PIC  X(01).
  2537         16  LA-CARRIER-A5           PIC  X(01).
  2538         16  LA-GROUPING-A5          PIC  X(06).
  2539         16  LA-STATE-A5             PIC  X(02).
  2540         16  LA-ACCOUNT-A5           PIC  X(10).
  2541         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  2542
  2543     12  LA-CONTROL-BY-GROUP-CODE.
  2544         16  LA-COMPANY-CD-A6        PIC  X(01).
  2545         16  LA-ENTRY-A6.
  2546             20  LA-FILLER           PIC  X(02).
  2547             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  2548         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  2549
  2550     12  FILLER                      PIC  X(09).
  2551
  2552     12  LA-HEADER-RECORD.
  2553         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  2554         16  LA-CREATION-DATE        PIC  X(02).
  2555         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  2556         16  LA-FINAL-ACT-DATE       REDEFINES
  2557               LA-FOLLOW-UP-DATE     PIC  X(02).
  2558         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  2559         16  LA-NO-OF-COPIES         PIC S9(01).
  2560         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  2561         16  LA-REPLY-DATE           PIC  X(02).
  2562         16  LA-RESEND-DATES.
  2563             20  LA-RESEND-DATE      PIC  X(02).
  2564             20  LA-SENT-DATE        PIC  X(02).
  2565             20  FILLER              PIC  X(08).
  2566         16  LA-SOURCE-INFORMATION.
  2567             20  LA-DATA-SOURCE      PIC  X(01).
  2568             20  LA-ADDR-SOURCE      PIC  X(01).
  2569         16  LA-STATUS               PIC  X(01).
  2570             88  LA-STATUS-ACTIVE         VALUE 'A'.
  2571             88  LA-STATUS-COMPLETED      VALUE 'C'.
  2572             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  2573             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  2574             88  LA-STATUS-PURGED         VALUE 'P'.
  2575             88  LA-STATUS-VOIDED         VALUE 'V'.
  2576         16  LA-LAST-RESENT-PRINT-DATE
  2577                                     PIC  X(02).
  2578         16  LA-PRINT-RESTRICTION    PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL690.cbl
  2579             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  2580                                          VALUE 'C'.
  2581             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  2582                                          VALUE 'F'.
  2583             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  2584                                          VALUE 'P'.
  2585         16  LA-PURGED-DATE          PIC  X(02).
  2586         16  LA-VOIDED-DATE          PIC  X(02).
  2587         16  LA-RESEND-LETR          PIC  X(4).
  2588         16  FILLER                  PIC  X(08).
  2589*        16  LA-RESEND-LETR-2        PIC  X(4).
  2590*        16  LA-RESEND-LETR-3        PIC  X(4).
  2591*        16  FILLER                  PIC  X(59).
  2592         16  LA-ARCHIVE-STATUS       PIC  X.
  2593             88  LA-TEMP                VALUE 'T'.
  2594             88  LA-QWS                 VALUE 'Q'.
  2595             88  LA-BATCH               VALUE 'B'.
  2596         16  LA-FINAL-ACT-IND        PIC  X(1).
  2597         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  2598         16  FILLER                  PIC  X(46).
  2599*        16  FILLER                  PIC  X(71).
  2600         16  LA-LAST-MAINT-DATE      PIC  X(2).
  2601         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  2602         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  2603                                     PIC  X(4).
  2604         16  LA-LAST-UPDATED-BY      PIC  X(4).
  2605
  2606******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL690.cbl
  2608*    COPY ERCARCT.
  2609******************************************************************
  2610*                                                                *
  2611*                            ERCARCT.                            *
  2612*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2613*                            VMOD=2.002                          *
  2614*                                                                *
  2615*   FILE DESCRIPTION = TEXT OF ARCHIVED LETTERDS                 *
  2616*                                                                *
  2617*   FILE TYPE = VSAM,KSDS                                        *
  2618*   RECORD SIZE = 1640  RECFORM = FIXED                          *
  2619*                                                                *
  2620*   BASE CLUSTER = ERARCT                        RKP=2,LEN=8     *
  2621*                                                                *
  2622*   LOG = NO                                                     *
  2623*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2624******************************************************************
  2625*                   C H A N G E   L O G
  2626*
  2627* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2628*-----------------------------------------------------------------
  2629*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2630* EFFECTIVE    NUMBER
  2631*-----------------------------------------------------------------
  2632* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  2633******************************************************************
  2634 01  LETTER-ARCHIVE-TEXT.
  2635     12  LT-RECORD-ID                PIC  X(02).
  2636         88  LT-VALID-ID                VALUE 'LT'.
  2637
  2638     12  LT-CONTROL-PRIMARY.
  2639         16  LT-COMPANY-CD           PIC  X(01).
  2640         16  LT-ARCHIVE-NO           PIC S9(08)    COMP.
  2641         16  LT-RECORD-TYPE          PIC  X(01).
  2642             88  LT-ADDRESS-DATA        VALUE '1'.
  2643             88  LT-TEXT-DATA           VALUE '2'.
  2644             88  LT-COMMENT-DATA        VALUE '3'.
  2645         16  LT-LINE-SEQ-NO          PIC S9(04)    COMP.
  2646
  2647     12  FILLER                      PIC  X(28).
  2648     12  LT-NUM-LINES-ON-RECORD      PIC S9(04)    COMP.
  2649
  2650     12  LT-TEXT-RECORD.
  2651         16  LT-LETTER-TEXT OCCURS 20 TIMES
  2652                            INDEXED BY LT-NDX.
  2653             20  LT-TEXT-LINE        PIC  X(70).
  2654             20  LT-SKIP-CONTROL     PIC  X(02).
  2655                 88  LT-NO-LINES-SKIPPED             VALUE SPACES.
  2656                 88  LT-SKIP-TO-NEXT-PAGE            VALUE '99'.
  2657             20  FILLER              PIC  X(08).
  2658
  2659     12  LT-COMMENT-RECORD  REDEFINES LT-TEXT-RECORD.
  2660         16  LT-LETTER-COMMENT OCCURS 20 TIMES INDEXED BY LC-NDX.
  2661             20  LT-COMMENT-LINE     PIC X(69).
  2662             20  LT-COMMENT-CHG-DT   PIC X(02).
  2663             20  LT-COMMENT-CHG-BY   PIC X(04).
  2664             20  FILLER              PIC X(05).
  2665
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL690.cbl
  2667*    COPY ELCCNTL.
  2668******************************************************************
  2669*                                                                *
  2670*                                                                *
  2671*                            ELCCNTL.                            *
  2672*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2673*                            VMOD=2.059                          *
  2674*                                                                *
  2675*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2676*                                                                *
  2677*   FILE TYPE = VSAM,KSDS                                        *
  2678*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2679*                                                                *
  2680*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2681*       ALTERNATE INDEX = NONE                                   *
  2682*                                                                *
  2683*   LOG = YES                                                    *
  2684*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2685******************************************************************
  2686*                   C H A N G E   L O G
  2687*
  2688* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2689*-----------------------------------------------------------------
  2690*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2691* EFFECTIVE    NUMBER
  2692*-----------------------------------------------------------------
  2693* 082503                   PEMA  ADD BENEFIT GROUP
  2694* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2695* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2696* 092705    2005050300006  PEMA  ADD SPP LEASES
  2697* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2698* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2699* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2700* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2701* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2702* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2703******************************************************************
  2704*
  2705 01  CONTROL-FILE.
  2706     12  CF-RECORD-ID                       PIC XX.
  2707         88  VALID-CF-ID                        VALUE 'CF'.
  2708
  2709     12  CF-CONTROL-PRIMARY.
  2710         16  CF-COMPANY-ID                  PIC XXX.
  2711         16  CF-RECORD-TYPE                 PIC X.
  2712             88  CF-COMPANY-MASTER              VALUE '1'.
  2713             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2714             88  CF-STATE-MASTER                VALUE '3'.
  2715             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2716             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2717             88  CF-CARRIER-MASTER              VALUE '6'.
  2718             88  CF-MORTALITY-MASTER            VALUE '7'.
  2719             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2720             88  CF-TERMINAL-MASTER             VALUE '9'.
  2721             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2722             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2723             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2724             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL690.cbl
  2725             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2726             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2727             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2728             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2729             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2730         16  CF-ACCESS-CD-GENL              PIC X(4).
  2731         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2732             20  CF-PROCESSOR               PIC X(4).
  2733         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2734             20  CF-STATE-CODE              PIC XX.
  2735             20  FILLER                     PIC XX.
  2736         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2737             20  FILLER                     PIC XX.
  2738             20  CF-HI-BEN-IN-REC           PIC XX.
  2739         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2740             20  FILLER                     PIC XXX.
  2741             20  CF-CARRIER-CNTL            PIC X.
  2742         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2743             20  FILLER                     PIC XX.
  2744             20  CF-HI-TYPE-IN-REC          PIC 99.
  2745         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2746             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2747                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2748             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2749             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2750         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2751             20  FILLER                     PIC X.
  2752             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2753         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2754             20  FILLER                     PIC XX.
  2755             20  CF-MORTGAGE-PLAN           PIC XX.
  2756         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2757
  2758     12  CF-LAST-MAINT-DT                   PIC XX.
  2759     12  CF-LAST-MAINT-BY                   PIC X(4).
  2760     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2761
  2762     12  CF-RECORD-BODY                     PIC X(728).
  2763
  2764
  2765****************************************************************
  2766*             COMPANY MASTER RECORD                            *
  2767****************************************************************
  2768
  2769     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2770         16  CF-COMPANY-ADDRESS.
  2771             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2772             20  CF-CL-IN-CARE-OF           PIC X(30).
  2773             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2774             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2775             20  CF-CL-CITY-STATE           PIC X(30).
  2776             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2777             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2778         16  CF-COMPANY-CD                  PIC X.
  2779         16  CF-COMPANY-PASSWORD            PIC X(8).
  2780         16  CF-SECURITY-OPTION             PIC X.
  2781             88  ALL-SECURITY                   VALUE '1'.
  2782             88  COMPANY-VERIFY                 VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL690.cbl
  2783             88  PROCESSOR-VERIFY               VALUE '3'.
  2784             88  NO-SECURITY                    VALUE '4'.
  2785             88  ALL-BUT-TERM                   VALUE '5'.
  2786         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2787             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2788         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2789             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2790         16  CF-INFORCE-LOCATION            PIC X.
  2791             88  CERTS-ARE-ONLINE               VALUE '1'.
  2792             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2793             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2794         16  CF-LOWER-CASE-LETTERS          PIC X.
  2795         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2796             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2797             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2798             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2799             88  CF-ACCNT-CNTL                  VALUE '3'.
  2800             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2801
  2802         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2803         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2804
  2805         16  CF-LGX-CREDIT-USER             PIC X.
  2806             88  CO-IS-NOT-USER                 VALUE 'N'.
  2807             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2808
  2809         16 CF-CREDIT-CALC-CODES.
  2810             20  CF-CR-REM-TERM-CALC PIC X.
  2811               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2812               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2813               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2814               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2815               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2816               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2817               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2818             20  CF-CR-R78-METHOD           PIC X.
  2819               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2820               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2821
  2822         16  CF-CLAIM-CONTROL-COUNTS.
  2823             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2824                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2825
  2826             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2827                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2828
  2829             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2830                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2831
  2832             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2833                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2834
  2835         16  CF-CURRENT-MONTH-END           PIC XX.
  2836
  2837         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2838             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2839             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2840             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL690.cbl
  2841             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2842                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2843                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2844             20  CF-CO-PREM-REJECT-SW       PIC X.
  2845                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2846                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2847             20  CF-CO-REF-REJECT-SW        PIC X.
  2848                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2849                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2850
  2851         16  CF-CO-REPORTING-DT             PIC XX.
  2852         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2853         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2854           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2855           88  CF-CO-MONTH-END                  VALUE '1'.
  2856
  2857         16  CF-LGX-CLAIM-USER              PIC X.
  2858             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2859             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2860
  2861         16  CF-CREDIT-EDIT-CONTROLS.
  2862             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2863             20  CF-MIN-AGE                 PIC 99.
  2864             20  CF-DEFAULT-AGE             PIC 99.
  2865             20  CF-MIN-TERM                PIC S999      COMP-3.
  2866             20  CF-MAX-TERM                PIC S999      COMP-3.
  2867             20  CF-DEFAULT-SEX             PIC X.
  2868             20  CF-JOINT-AGE-INPUT         PIC X.
  2869                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2870             20  CF-BIRTH-DATE-INPUT        PIC X.
  2871                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2872             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2873                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2874                 88  CF-ZERO-CARRIER            VALUE '1'.
  2875                 88  CF-ZERO-GROUPING           VALUE '2'.
  2876                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2877             20  CF-EDIT-SW                 PIC X.
  2878                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2879             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2880             20  CF-CR-PR-METHOD            PIC X.
  2881               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2882               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2883             20  FILLER                     PIC X.
  2884
  2885         16  CF-CREDIT-MISC-CONTROLS.
  2886             20  CF-REIN-TABLE-SW           PIC X.
  2887                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2888             20  CF-COMP-TABLE-SW           PIC X.
  2889                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2890             20  CF-EXPERIENCE-RETENTION-AGE
  2891                                            PIC S9        COMP-3.
  2892             20  CF-CONVERSION-DT           PIC XX.
  2893             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2894             20  CF-RUN-FREQUENCY-SW        PIC X.
  2895                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2896                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2897
  2898             20  CF-CR-CHECK-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL690.cbl
  2899                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2900                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2901                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2902                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2903                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2904                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2905
  2906                 24  CF-CR-CHECK-COUNT       REDEFINES
  2907                     CF-CR-CHECK-COUNTER      PIC X(4).
  2908
  2909                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2910                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2911
  2912                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2913                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2914                 24  CF-MAIL-PROCESSING       PIC X.
  2915                     88  MAIL-PROCESSING          VALUE 'Y'.
  2916
  2917         16  CF-MISC-SYSTEM-CONTROL.
  2918             20  CF-SYSTEM-C                 PIC X.
  2919                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2920             20  CF-SYSTEM-D                 PIC X.
  2921                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2922             20  CF-SOC-SEC-NO-SW            PIC X.
  2923                 88  SOC-SEC-NO-USED             VALUE '1'.
  2924             20  CF-MEMBER-NO-SW             PIC X.
  2925                 88  MEMBER-NO-USED              VALUE '1'.
  2926             20  CF-TAX-ID-NUMBER            PIC X(11).
  2927             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2928             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2929                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2930                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2931                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2932                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2933             20  CF-SYSTEM-E                 PIC X.
  2934                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2935
  2936         16  CF-LGX-LIFE-USER               PIC X.
  2937             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2938             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2939
  2940         16  CF-CR-MONTH-END-DT             PIC XX.
  2941
  2942         16  CF-FILE-MAINT-DATES.
  2943             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2944                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2945             20  CF-LAST-BATCH       REDEFINES
  2946                 CF-LAST-BATCH-NO               PIC X(4).
  2947             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2948             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2949             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2950             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2951             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2952             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2953             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2954             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2955             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2956             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL690.cbl
  2957
  2958         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2959         16  FILLER                         PIC X.
  2960
  2961         16  CF-ALT-MORT-CODE               PIC X(4).
  2962         16  CF-MEMBER-CAPTION              PIC X(10).
  2963
  2964         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2965             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2966             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2967             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2968             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2969             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2970
  2971         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2972
  2973         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2974         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2975         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2976         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2977
  2978         16  CF-AH-OVERRIDE-L1              PIC X.
  2979         16  CF-AH-OVERRIDE-L2              PIC XX.
  2980         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2981         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2982
  2983         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2984         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2985
  2986         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2987         16  CF-AR-LAST-EL860-DT            PIC XX.
  2988         16  CF-MP-MONTH-END-DT             PIC XX.
  2989
  2990         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2991         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2992             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2993
  2994         16  CF-AR-MONTH-END-DT             PIC XX.
  2995
  2996         16  CF-CRDTCRD-USER                PIC X.
  2997             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2998             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2999
  3000         16  CF-CC-MONTH-END-DT             PIC XX.
  3001
  3002         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3003
  3004         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3005             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3006             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3007             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3008         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3009         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3010         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3011         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3012             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3013             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3014         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL690.cbl
  3015         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3016         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3017             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3018         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3019
  3020         16  CF-CL-ZIP-CODE.
  3021             20  CF-CL-ZIP-PRIME.
  3022                 24  CF-CL-ZIP-1ST          PIC X.
  3023                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3024                 24  FILLER                 PIC X(4).
  3025             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3026         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3027             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3028             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3029             20  FILLER                     PIC XXX.
  3030
  3031         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3032         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3033         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3034         16  CF-CO-OPTION-START-DATE        PIC XX.
  3035         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3036           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3037                                                      '3' '4'.
  3038           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3039           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3040           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3041           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3042           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3043           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3044
  3045         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3046
  3047         16  CF-PAYMENT-APPROVAL-LEVELS.
  3048             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3049             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3050             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3051             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3052             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3053             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3054
  3055         16  CF-END-USER-REPORTING-USER     PIC X.
  3056             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3057             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3058
  3059         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3060             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3061             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3062
  3063         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3064
  3065         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3066         16  FILLER                         PIC X.
  3067
  3068         16  CF-CREDIT-ARCHIVE-CNTL.
  3069             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3070             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3071             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3072
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL690.cbl
  3073         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3074
  3075         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3076             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3077             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3078
  3079         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3080             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3081             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3082
  3083         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3084
  3085         16  CF-CO-ACH-ID-CODE              PIC  X.
  3086             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3087             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3088             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3089         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3090         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3091         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3092         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3093         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3094         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3095         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3096         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3097         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3098                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3099         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3100                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3101
  3102         16  CF-CO-OVER-SHORT.
  3103             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3104             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3105
  3106*         16  FILLER                         PIC X(102).
  3107         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3108             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3109             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3110
  3111         16  CF-AH-APPROVAL-DAYS.
  3112             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3113             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3114             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3115             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3116
  3117         16  FILLER                         PIC X(82).
  3118****************************************************************
  3119*             PROCESSOR/USER RECORD                            *
  3120****************************************************************
  3121
  3122     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3123         16  CF-PROCESSOR-NAME              PIC X(30).
  3124         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3125         16  CF-PROCESSOR-TITLE             PIC X(26).
  3126         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3127                 88  MESSAGE-YES                VALUE 'Y'.
  3128                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3129
  3130*****************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL690.cbl
  3131****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3132****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3133****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3134****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3135*****************************************************
  3136
  3137         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3138             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3139             20  CF-APPLICATION-FORCE       PIC X.
  3140             20  CF-INDIVIDUAL-APP.
  3141                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3142                     28  CF-BROWSE-APP      PIC X.
  3143                     28  CF-UPDATE-APP      PIC X.
  3144
  3145         16  CF-CURRENT-TERM-ON             PIC X(4).
  3146         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3147             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3148             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3149             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3150             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3151             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3152             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3153             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3154         16  CF-PROCESSOR-CARRIER           PIC X.
  3155             88  NO-CARRIER-SECURITY            VALUE ' '.
  3156         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3157             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3158         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3159             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3160         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3161             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3162
  3163         16  CF-PROC-SYS-ACCESS-SW.
  3164             20  CF-PROC-CREDIT-CLAIMS-SW.
  3165                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3166                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3167                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3168                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3169             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3170                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3171                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3172             20  CF-PROC-LIFE-GNRLDGR-SW.
  3173                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3174                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3175                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3176                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3177             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3178                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3179                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3180         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3181             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3182             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3183         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3184
  3185         16  CF-APPROVAL-LEVEL                  PIC X.
  3186             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3187             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3188             88  APPROVAL-LEVEL-3                   VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL690.cbl
  3189             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3190
  3191         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3192
  3193         16  CF-LANGUAGE-TYPE                   PIC X.
  3194             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3195             88  CF-LANG-IS-FR                      VALUE 'F'.
  3196
  3197         16  CF-CSR-IND                         PIC X.
  3198         16  FILLER                             PIC X(239).
  3199
  3200****************************************************************
  3201*             PROCESSOR/REMINDERS RECORD                       *
  3202****************************************************************
  3203
  3204     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3205         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3206             20  CF-START-REMIND-DT         PIC XX.
  3207             20  CF-END-REMIND-DT           PIC XX.
  3208             20  CF-REMINDER-TEXT           PIC X(50).
  3209         16  FILLER                         PIC X(296).
  3210
  3211
  3212****************************************************************
  3213*             STATE MASTER RECORD                              *
  3214****************************************************************
  3215
  3216     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3217         16  CF-STATE-ABBREVIATION          PIC XX.
  3218         16  CF-STATE-NAME                  PIC X(25).
  3219         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3220         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3221             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3222             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3223             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3224             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3225                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3226                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3227             20  CF-ST-PREM-REJECT-SW       PIC X.
  3228                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3229                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3230             20  CF-ST-REF-REJECT-SW        PIC X.
  3231                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3232                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3233         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3234         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3235         16  CF-ST-REFUND-RULES.
  3236             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3237             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3238             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3239         16  CF-ST-FST-PMT-EXTENSION.
  3240             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3241             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3242                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3243                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3244                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3245                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3246         16  CF-ST-STATE-CALL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL690.cbl
  3247             20  CF-ST-CALL-UNEARNED        PIC X.
  3248             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3249             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3250         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3251             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3252             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3253         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3254         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3255         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3256         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3257         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3258         16  FILLER                         PIC X.
  3259         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3260             20  CF-ST-BENEFIT-CD           PIC XX.
  3261             20  CF-ST-BENEFIT-KIND         PIC X.
  3262                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3263                 88  CF-ST-AH-KIND              VALUE 'A'.
  3264             20  CF-ST-REM-TERM-CALC        PIC X.
  3265                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3266                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3267                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3268                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3269                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3270                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3271                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3272                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3273
  3274             20  CF-ST-REFUND-CALC          PIC X.
  3275                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3276                 88  ST-REFD-BY-R78             VALUE '1'.
  3277                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3278                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3279                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3280                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3281                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3282                 88  ST-REFD-UTAH               VALUE '7'.
  3283                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3284                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3285                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3286
  3287             20  CF-ST-EARNING-CALC         PIC X.
  3288                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3289                 88  ST-EARN-BY-R78             VALUE '1'.
  3290                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3291                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3292                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3293                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3294                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3295                 88  ST-EARN-MEAN               VALUE '8'.
  3296                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3297
  3298             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3299                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3300                 88  ST-OVRD-BY-R78             VALUE '1'.
  3301                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3302                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3303                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3304                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL690.cbl
  3305                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3306                 88  ST-OVRD-MEAN               VALUE '8'.
  3307                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3308             20  FILLER                     PIC X.
  3309
  3310         16  CF-ST-COMMISSION-CAPS.
  3311             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3312             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3313             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3314             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3315         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3316                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3317
  3318         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3319
  3320         16  CF-ST-STATUTORY-INTEREST.
  3321             20  CF-ST-STAT-DATE-FROM       PIC X.
  3322                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3323                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3324             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3325             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3326             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3327             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3328             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3329
  3330         16  CF-ST-OVER-SHORT.
  3331             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3332             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3333
  3334         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3335
  3336         16  CF-ST-RT-CALC                  PIC X.
  3337
  3338         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3339         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3340         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3341         16  CF-ST-RF-LR-CALC               PIC X.
  3342         16  CF-ST-RF-LL-CALC               PIC X.
  3343         16  CF-ST-RF-LN-CALC               PIC X.
  3344         16  CF-ST-RF-AH-CALC               PIC X.
  3345         16  CF-ST-RF-CP-CALC               PIC X.
  3346*        16  FILLER                         PIC X(206).
  3347*CIDMOD         16  FILLER                         PIC X(192).
  3348         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3349             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3350         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3351         16  CF-ST-VFY-2ND-BENE             PIC X.
  3352         16  FILLER                         PIC X(186).
  3353
  3354****************************************************************
  3355*             BENEFIT MASTER RECORD                            *
  3356****************************************************************
  3357
  3358     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3359         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3360             20  CF-BENEFIT-CODE            PIC XX.
  3361             20  CF-BENEFIT-NUMERIC  REDEFINES
  3362                 CF-BENEFIT-CODE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL690.cbl
  3363             20  CF-BENEFIT-ALPHA           PIC XXX.
  3364             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3365             20  CF-BENEFIT-COMMENT         PIC X(10).
  3366
  3367             20  CF-LF-COVERAGE-TYPE        PIC X.
  3368                 88  CF-REDUCING                VALUE 'R'.
  3369                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3370
  3371             20  CF-SPECIAL-CALC-CD         PIC X.
  3372                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3373                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3374                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3375                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3376                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3377                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3378                 88  CF-FARM-PLAN               VALUE 'F'.
  3379                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3380                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3381                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3382                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3383                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3384                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3385                 88  CF-PRUDENTIAL              VALUE 'P'.
  3386                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3387                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3388                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3389                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3390                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3391                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3392
  3393             20  CF-JOINT-INDICATOR         PIC X.
  3394                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3395
  3396*            20  FILLER                     PIC X(12).
  3397             20  FILLER                     PIC X(11).
  3398             20  CF-BENEFIT-CATEGORY        PIC X.
  3399             20  CF-LOAN-TYPE               PIC X(8).
  3400
  3401             20  CF-CO-REM-TERM-CALC        PIC X.
  3402                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3403                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3404                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3405                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3406                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3407
  3408             20  CF-CO-EARNINGS-CALC        PIC X.
  3409                 88  CO-EARN-BY-R78             VALUE '1'.
  3410                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3411                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3412                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3413                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3414                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3415                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3416                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3417
  3418             20  CF-CO-REFUND-CALC          PIC X.
  3419                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3420                 88  CO-REFD-BY-R78             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL690.cbl
  3421                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3422                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3423                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3424                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3425                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3426                 88  CO-REFD-MEAN               VALUE '8'.
  3427                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3428                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3429                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3430
  3431             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3432                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3433                 88  CO-OVRD-BY-R78             VALUE '1'.
  3434                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3435                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3436                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3437                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3438                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3439                 88  CO-OVRD-MEAN               VALUE '8'.
  3440                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3441
  3442             20  CF-CO-BEN-I-G-CD           PIC X.
  3443                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3444                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3445                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3446
  3447         16  FILLER                         PIC X(304).
  3448
  3449
  3450****************************************************************
  3451*             CARRIER MASTER RECORD                            *
  3452****************************************************************
  3453
  3454     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3455         16  CF-ADDRESS-DATA.
  3456             20  CF-MAIL-TO-NAME            PIC X(30).
  3457             20  CF-IN-CARE-OF              PIC X(30).
  3458             20  CF-ADDRESS-LINE-1          PIC X(30).
  3459             20  CF-ADDRESS-LINE-2          PIC X(30).
  3460             20  CF-CITY-STATE              PIC X(30).
  3461             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3462             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3463
  3464         16  CF-CLAIM-NO-CONTROL.
  3465             20  CF-CLAIM-NO-METHOD         PIC X.
  3466                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3467                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3468                 88  CLAIM-NO-SEQ               VALUE '3'.
  3469                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3470             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3471                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3472                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3473                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3474
  3475         16  CF-CHECK-NO-CONTROL.
  3476             20  CF-CHECK-NO-METHOD         PIC X.
  3477                 88  CHECK-NO-MANUAL            VALUE '1'.
  3478                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL690.cbl
  3479                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3480                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3481             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3482                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3483
  3484         16  CF-DOMICILE-STATE              PIC XX.
  3485
  3486         16  CF-EXPENSE-CONTROLS.
  3487             20  CF-EXPENSE-METHOD          PIC X.
  3488                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3489                 88  DOLLARS-PER-PMT            VALUE '2'.
  3490                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3491                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3492             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3493             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3494
  3495         16  CF-CORRESPONDENCE-CONTROL.
  3496             20  CF-LETTER-RESEND-OPT       PIC X.
  3497                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3498                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3499             20  FILLER                     PIC X(4).
  3500
  3501         16  CF-RESERVE-CONTROLS.
  3502             20  CF-MANUAL-SW               PIC X.
  3503                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3504             20  CF-FUTURE-SW               PIC X.
  3505                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3506             20  CF-PTC-SW                  PIC X.
  3507                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3508             20  CF-IBNR-SW                 PIC X.
  3509                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3510             20  CF-PTC-LF-SW               PIC X.
  3511                 88  CF-LF-PTC-USED             VALUE '1'.
  3512             20  CF-CDT-ACCESS-METHOD       PIC X.
  3513                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3514                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3515                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3516             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3517
  3518         16  CF-CLAIM-CALC-METHOD           PIC X.
  3519             88  360-PLUS-MONTHS                VALUE '1'.
  3520             88  365-PLUS-MONTHS                VALUE '2'.
  3521             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3522             88  360-DAILY                      VALUE '4'.
  3523             88  365-DAILY                      VALUE '5'.
  3524
  3525         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3526         16  FILLER                         PIC X(11).
  3527
  3528         16  CF-LIMIT-AMOUNTS.
  3529             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3530             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3531             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3532             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3533             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3534             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3535             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3536             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL690.cbl
  3537             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3538             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3539
  3540         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3541         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3542         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3543
  3544         16  CF-ZIP-CODE.
  3545             20  CF-ZIP-PRIME.
  3546                 24  CF-ZIP-1ST             PIC X.
  3547                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3548                 24  FILLER                 PIC X(4).
  3549             20  CF-ZIP-PLUS4               PIC X(4).
  3550         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3551             20  CF-CAN-POSTAL-1            PIC XXX.
  3552             20  CF-CAN-POSTAL-2            PIC XXX.
  3553             20  FILLER                     PIC XXX.
  3554
  3555         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3556         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3557         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3558
  3559         16  CF-RATING-SWITCH               PIC X.
  3560             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3561             88  CF-NO-RATING                   VALUE 'N'.
  3562
  3563         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3564
  3565         16  CF-CARRIER-OVER-SHORT.
  3566             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3567             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3568
  3569         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3570         16  CF-SECPAY-SWITCH               PIC X.
  3571             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3572             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3573         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3574         16  FILLER                         PIC X(448).
  3575*        16  FILLER                         PIC X(452).
  3576
  3577
  3578****************************************************************
  3579*             MORTALITY MASTER RECORD                          *
  3580****************************************************************
  3581
  3582     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3583         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3584                                INDEXED BY CF-MORT-NDX.
  3585             20  CF-MORT-TABLE              PIC X(5).
  3586             20  CF-MORT-TABLE-TYPE         PIC X.
  3587                 88  CF-MORT-JOINT              VALUE 'J'.
  3588                 88  CF-MORT-SINGLE             VALUE 'S'.
  3589                 88  CF-MORT-COMBINED           VALUE 'C'.
  3590                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3591                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3592             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3593             20  CF-MORT-AGE-METHOD         PIC XX.
  3594                 88  CF-AGE-LAST                VALUE 'AL'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL690.cbl
  3595                 88  CF-AGE-NEAR                VALUE 'AN'.
  3596             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3597             20  CF-MORT-ADJUSTMENT-DIRECTION
  3598                                            PIC X.
  3599                 88  CF-MINUS                   VALUE '-'.
  3600                 88  CF-PLUS                    VALUE '+'.
  3601             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3602             20  CF-MORT-JOINT-CODE         PIC X.
  3603                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3604             20  CF-MORT-PC-Q               PIC X.
  3605                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3606             20  CF-MORT-TABLE-CODE         PIC X(4).
  3607             20  CF-MORT-COMMENTS           PIC X(15).
  3608             20  FILLER                     PIC X(14).
  3609
  3610         16  FILLER                         PIC X(251).
  3611
  3612
  3613****************************************************************
  3614*             BUSSINESS TYPE MASTER RECORD                     *
  3615****************************************************************
  3616
  3617     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3618* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3619* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3620* AND RECORD 05 IS TYPES 81-99
  3621         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3622             20  CF-BUSINESS-TITLE          PIC  X(19).
  3623             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3624                                            PIC S9V9(4) COMP-3.
  3625             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3626             20  FILLER                     PIC  X.
  3627         16  FILLER                         PIC  X(248).
  3628
  3629
  3630****************************************************************
  3631*             TERMINAL MASTER RECORD                           *
  3632****************************************************************
  3633
  3634     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3635
  3636         16  CF-COMPANY-TERMINALS.
  3637             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3638                                  PIC X(4).
  3639         16  FILLER               PIC X(248).
  3640
  3641
  3642****************************************************************
  3643*             LIFE EDIT MASTER RECORD                          *
  3644****************************************************************
  3645
  3646     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3647         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3648             20  CF-LIFE-CODE-IN            PIC XX.
  3649             20  CF-LIFE-CODE-OUT           PIC XX.
  3650         16  FILLER                         PIC X(248).
  3651
  3652
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL690.cbl
  3653****************************************************************
  3654*             AH EDIT MASTER RECORD                            *
  3655****************************************************************
  3656
  3657     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3658         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3659             20  CF-AH-CODE-IN              PIC XXX.
  3660             20  CF-AH-CODE-OUT             PIC XX.
  3661         16  FILLER                         PIC X(248).
  3662
  3663
  3664****************************************************************
  3665*             CREDIBILITY TABLES                               *
  3666****************************************************************
  3667
  3668     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3669         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3670                             INDEXED BY CF-CRDB-NDX.
  3671             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3672             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3673             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3674         16  FILLER                         PIC  X(332).
  3675
  3676
  3677****************************************************************
  3678*             REPORT CUSTOMIZATION RECORD                      *
  3679****************************************************************
  3680
  3681     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3682         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3683             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3684             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3685             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3686**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3687****       A T-TRANSFER.                                   ****
  3688             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3689
  3690         16  FILLER                         PIC XX.
  3691
  3692         16  CF-CARRIER-CNTL-OPT.
  3693             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3694                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3695                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3696             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3697                                            PIC X.
  3698         16  CF-GROUP-CNTL-OPT.
  3699             20  CF-GROUP-OPT-SEQ           PIC 9.
  3700                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3701                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3702             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3703                                            PIC X(6).
  3704         16  CF-STATE-CNTL-OPT.
  3705             20  CF-STATE-OPT-SEQ           PIC 9.
  3706                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3707                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3708             20  CF-STATE-SELECT OCCURS 3 TIMES
  3709                                            PIC XX.
  3710         16  CF-ACCOUNT-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL690.cbl
  3711             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3712                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3713                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3714             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3715                                            PIC X(10).
  3716         16  CF-BUS-TYP-CNTL-OPT.
  3717             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3718                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3719                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3720             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3721                                            PIC XX.
  3722         16  CF-LF-TYP-CNTL-OPT.
  3723             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3724                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3725                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3726             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3727                                            PIC XX.
  3728         16  CF-AH-TYP-CNTL-OPT.
  3729             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3730                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3731                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3732             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3733                                            PIC XX.
  3734         16  CF-REPTCD1-CNTL-OPT.
  3735             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3736                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3737                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3738             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3739                                            PIC X(10).
  3740         16  CF-REPTCD2-CNTL-OPT.
  3741             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3742                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3743                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3744             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3745                                            PIC X(10).
  3746         16  CF-USER1-CNTL-OPT.
  3747             20  CF-USER1-OPT-SEQ           PIC 9.
  3748                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3749                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3750             20  CF-USER1-SELECT OCCURS 3 TIMES
  3751                                            PIC X(10).
  3752         16  CF-USER2-CNTL-OPT.
  3753             20  CF-USER2-OPT-SEQ           PIC 9.
  3754                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3755                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3756             20  CF-USER2-SELECT OCCURS 3 TIMES
  3757                                            PIC X(10).
  3758         16  CF-USER3-CNTL-OPT.
  3759             20  CF-USER3-OPT-SEQ           PIC 9.
  3760                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3761                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3762             20  CF-USER3-SELECT OCCURS 3 TIMES
  3763                                            PIC X(10).
  3764         16  CF-USER4-CNTL-OPT.
  3765             20  CF-USER4-OPT-SEQ           PIC 9.
  3766                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3767                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3768             20  CF-USER4-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL690.cbl
  3769                                            PIC X(10).
  3770         16  CF-USER5-CNTL-OPT.
  3771             20  CF-USER5-OPT-SEQ           PIC 9.
  3772                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3773                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3774             20  CF-USER5-SELECT OCCURS 3 TIMES
  3775                                            PIC X(10).
  3776         16  CF-REINS-CNTL-OPT.
  3777             20  CF-REINS-OPT-SEQ           PIC 9.
  3778                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3779                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3780             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3781                 24  CF-REINS-PRIME         PIC XXX.
  3782                 24  CF-REINS-SUB           PIC XXX.
  3783
  3784         16  CF-AGENT-CNTL-OPT.
  3785             20  CF-AGENT-OPT-SEQ           PIC 9.
  3786                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3787                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3788             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3789                                            PIC X(10).
  3790
  3791         16  FILLER                         PIC X(43).
  3792
  3793         16  CF-LOSS-RATIO-SELECT.
  3794             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3795             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3796         16  CF-ENTRY-DATE-SELECT.
  3797             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3798             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3799         16  CF-EFFECTIVE-DATE-SELECT.
  3800             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3801             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3802
  3803         16  CF-EXCEPTION-LIST-IND          PIC X.
  3804             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3805
  3806         16  FILLER                         PIC X(318).
  3807
  3808****************************************************************
  3809*                  EXCEPTION REPORTING RECORD                  *
  3810****************************************************************
  3811
  3812     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3813         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3814             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3815
  3816         16  CF-COMBINED-LIFE-AH-OPT.
  3817             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3818             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3819             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3820             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3821
  3822         16  CF-LIFE-OPT.
  3823             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3824             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3825             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3826             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL690.cbl
  3827             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3828             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3829             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3830             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3831             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3832             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3833
  3834         16  CF-AH-OPT.
  3835             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3836             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3837             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3838             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3839             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3840             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3841             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3842             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3843             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3844             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3845
  3846         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3847             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3848             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3849             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3850
  3851         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3852
  3853         16  FILLER                         PIC X(673).
  3854
  3855
  3856****************************************************************
  3857*             MORTGAGE SYSTEM PLAN RECORD                      *
  3858****************************************************************
  3859
  3860     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3861         16  CF-PLAN-TYPE                   PIC X.
  3862             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3863             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3864             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3865         16  CF-PLAN-ABBREV                 PIC XXX.
  3866         16  CF-PLAN-DESCRIPT               PIC X(10).
  3867         16  CF-PLAN-NOTES                  PIC X(20).
  3868         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3869         16  CF-PLAN-UNDERWRITING.
  3870             20  CF-PLAN-TERM-DATA.
  3871                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3872                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3873             20  CF-PLAN-AGE-DATA.
  3874                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3875                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3876                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3877             20  CF-PLAN-BENEFIT-DATA.
  3878                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3879                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3880                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3881                                            PIC S9(7)V99  COMP-3.
  3882         16  CF-PLAN-POLICY-FORMS.
  3883             20  CF-POLICY-FORM             PIC X(12).
  3884             20  CF-MASTER-APPLICATION      PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL690.cbl
  3885             20  CF-MASTER-POLICY           PIC X(12).
  3886         16  CF-PLAN-RATING.
  3887             20  CF-RATE-CODE               PIC X(5).
  3888             20  CF-SEX-RATING              PIC X.
  3889                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3890                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3891             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3892             20  CF-SUB-STD-TYPE            PIC X.
  3893                 88  CF-PCT-OF-PREM            VALUE '1'.
  3894                 88  CF-PCT-OF-BENE            VALUE '2'.
  3895         16  CF-PLAN-PREM-TOLERANCES.
  3896             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3897             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3898         16  CF-PLAN-PYMT-TOLERANCES.
  3899             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3900             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3901         16  CF-PLAN-MISC-DATA.
  3902             20  FILLER                     PIC X.
  3903             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3904             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3905         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3906         16  CF-PLAN-IND-GRP                PIC X.
  3907             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3908                                                     '1'.
  3909             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3910                                                     '2'.
  3911         16  CF-MIB-SEARCH-SW               PIC X.
  3912             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3913             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3914             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3915             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3916         16  CF-ALPHA-SEARCH-SW             PIC X.
  3917             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3918             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3919             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3920             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3921             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3922             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3923             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3924             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3925             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3926             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3927                                                     'A' 'B' 'C'
  3928                                                     'X' 'Y' 'Z'.
  3929         16  CF-EFF-DT-RULE-SW              PIC X.
  3930             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3931             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3932             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3933             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3934             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3935         16  FILLER                         PIC X(4).
  3936         16  CF-HEALTH-QUESTIONS            PIC X.
  3937             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3938         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3939         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3940         16  CF-PLAN-SNGL-JNT               PIC X.
  3941             88  CF-COMBINED-PLAN              VALUE 'C'.
  3942             88  CF-JNT-PLAN                   VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL690.cbl
  3943             88  CF-SNGL-PLAN                  VALUE 'S'.
  3944         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3945         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3946         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3947         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3948         16  CF-RERATE-CNTL                 PIC  X.
  3949             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3950             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3951             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3952             88  CF-AUTO-RECALC                 VALUE '4'.
  3953         16  CF-BENEFIT-TYPE                PIC  X.
  3954             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3955             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3956         16  CF-POLICY-FEE                  PIC S999V99
  3957                                                    COMP-3.
  3958         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3959         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3960         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3961         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3962         16  FILLER                         PIC  X(32).
  3963         16  CF-TERMINATION-FORM            PIC  X(04).
  3964         16  FILLER                         PIC  X(08).
  3965         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3966                                                       COMP-3.
  3967         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3968         16  CF-ISSUE-LETTER                PIC  X(4).
  3969         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3970         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3971             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3972             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3973         16  CF-MP-REFUND-CALC              PIC X.
  3974             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3975             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3976             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3977             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3978             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3979             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3980             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3981             88  CF-MP-REFD-MEAN                VALUE '8'.
  3982         16  CF-ALT-RATE-CODE               PIC  X(5).
  3983
  3984
  3985         16  FILLER                         PIC X(498).
  3986****************************************************************
  3987*             MORTGAGE COMPANY MASTER RECORD                   *
  3988****************************************************************
  3989
  3990     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3991         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3992         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3993             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3994             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3995             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3996             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3997             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3998
  3999         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4000         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL690.cbl
  4001         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4002         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4003         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4004
  4005         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4006             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4007         16  CF-MP-RECON-USE-IND            PIC X(1).
  4008             88  CF-MP-USE-RECON             VALUE 'Y'.
  4009         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4010             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4011         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4012             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4013             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4014         16  FILLER                         PIC X(1).
  4015         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4016             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4017         16  CF-MORTG-MIB-VERSION           PIC X.
  4018             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4019             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4020             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4021         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4022             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4023                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4024             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4025                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4026             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4027                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4028             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4029                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4030             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4031                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4032             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4033                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4034         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4035         16  FILLER                         PIC X(7).
  4036         16  CF-MORTG-DESTINATION-SYMBOL.
  4037             20  CF-MORTG-MIB-COMM          PIC X(5).
  4038             20  CF-MORTG-MIB-TERM          PIC X(5).
  4039         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4040             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4041         16  FILLER                         PIC X(03).
  4042         16  CF-MP-CHECK-NO-CONTROL.
  4043             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4044                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4045                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4046                                                ' ' LOW-VALUES.
  4047                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4048                                               VALUE '3'.
  4049         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4050         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4051         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4052             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4053                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4054             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4055                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4056             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4057                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4058             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL690.cbl
  4059                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4060             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4061                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4062             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4063                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4064         16  CF-MORTG-BILLING-AREA.
  4065             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4066                                            PIC X.
  4067         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4068         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4069         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4070         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4071             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4072             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4073         16  FILLER                         PIC X.
  4074         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4075             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4076             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4077         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4078         16  FILLER                         PIC X(8).
  4079         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4080         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4081         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4082         16  CF-ACH-COMPANY-ID.
  4083             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4084                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4085                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4086                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4087             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4088         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4089             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4090         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4091             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4092             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4093         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4094         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4095         16  FILLER                         PIC X(536).
  4096
  4097****************************************************************
  4098*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4099****************************************************************
  4100
  4101     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4102         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4103             20  CF-FEMALE-HEIGHT.
  4104                 24  CF-FEMALE-FT           PIC 99.
  4105                 24  CF-FEMALE-IN           PIC 99.
  4106             20  CF-FEMALE-MIN-WT           PIC 999.
  4107             20  CF-FEMALE-MAX-WT           PIC 999.
  4108         16  FILLER                         PIC X(428).
  4109
  4110     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4111         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4112             20  CF-MALE-HEIGHT.
  4113                 24  CF-MALE-FT             PIC 99.
  4114                 24  CF-MALE-IN             PIC 99.
  4115             20  CF-MALE-MIN-WT             PIC 999.
  4116             20  CF-MALE-MAX-WT             PIC 999.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL690.cbl
  4117         16  FILLER                         PIC X(428).
  4118******************************************************************
  4119*             AUTOMATIC ACTIVITY RECORD                          *
  4120******************************************************************
  4121     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4122         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4123             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4124             20  CF-SYS-LETTER-ID           PIC X(04).
  4125             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4126             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4127             20  CF-SYS-RESET-SW            PIC X(01).
  4128             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4129             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4130
  4131         16  FILLER                         PIC X(50).
  4132
  4133         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4134             20  CF-USER-ACTIVE-SW          PIC X(01).
  4135             20  CF-USER-LETTER-ID          PIC X(04).
  4136             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4137             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4138             20  CF-USER-RESET-SW           PIC X(01).
  4139             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4140             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4141             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4142
  4143         16  FILLER                         PIC X(246).
  4144
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL690.cbl
  4146 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA LETTER-ARCHIVE
  4147                          LETTER-ARCHIVE-TEXT CONTROL-FILE.
  4148 0000-DFHEXIT SECTION.
  4149     MOVE '9#                    $   ' TO DFHEIV0.
  4150     MOVE 'EL690' TO DFHEIV1.
  4151     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  4152
  4153     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  4154
  4155
  4156* EXEC CICS HANDLE CONDITION
  4157*        QIDERR    (0110-PGM-INITIALIZATION)
  4158*        MAPFAIL   (0110-PGM-INITIALIZATION)
  4159*        NOTOPEN   (8070-NOTOPEN)
  4160*        NOTFND    (8080-ARCH-NOT-FOUND)
  4161*        PGMIDERR  (9700-PGMID-ERROR)
  4162*        ERROR     (9800-ABEND)
  4163*        END-EXEC.
  4164*    MOVE '"$N?JIL.              ! " #00004151' TO DFHEIV0
  4165     MOVE X'22244E3F4A494C2E20202020' TO DFHEIV0(1:12)
  4166     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4167     MOVE X'2220233030303034313531' TO DFHEIV0(25:11)
  4168     CALL 'kxdfhei1' USING DFHEIV0
  4169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4170
  4171
  4172     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  4173     MOVE '5'                    TO DC-OPTION-CODE.
  4174     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
  4175     MOVE DC-GREG-DATE-1-EDIT    TO W-SAVE-DATE.
  4176     MOVE DC-BIN-DATE-1          TO W-SAVE-BIN-DATE.
  4177
  4178     MOVE +1                     TO EMI-NUMBER-OF-LINES.
  4179     MOVE '2'                    TO EMI-SWITCH2.
  4180
  4181***************************************************************
  4182*       IF ATTEMPTING TO EXECUTE PROGRAM WITHOUT SIGNING ON   *
  4183*       (COMM LENGTH EQUAL ZERO), SEND ERROR MESSAGE.         *
  4184***************************************************************
  4185
  4186     IF  EIBCALEN EQUAL 0
  4187         GO TO 8000-UNAUTHORIZED-ACCESS.
  4188
  4189     IF  PI-RETURN-TO-PROGRAM EQUAL W-THIS-PGM
  4190         MOVE PI-CALLING-PROGRAM TO W-RETURNED-FROM
  4191
  4192     ELSE
  4193         MOVE SPACES             TO W-RETURNED-FROM.
  4194
  4195     IF  PI-CALLING-PROGRAM NOT EQUAL W-THIS-PGM
  4196
  4197         IF  PI-RETURN-TO-PROGRAM NOT EQUAL W-THIS-PGM
  4198             MOVE PI-SAVED-PROGRAM-5    TO PI-SAVED-PROGRAM-6
  4199             MOVE PI-SAVED-PROGRAM-4    TO PI-SAVED-PROGRAM-5
  4200             MOVE PI-SAVED-PROGRAM-3    TO PI-SAVED-PROGRAM-4
  4201             MOVE PI-SAVED-PROGRAM-2    TO PI-SAVED-PROGRAM-3
  4202             MOVE PI-SAVED-PROGRAM-1    TO PI-SAVED-PROGRAM-2
  4203             MOVE PI-RETURN-TO-PROGRAM  TO PI-SAVED-PROGRAM-1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL690.cbl
  4204             MOVE PI-CALLING-PROGRAM    TO PI-RETURN-TO-PROGRAM
  4205             MOVE W-THIS-PGM            TO PI-CALLING-PROGRAM
  4206             MOVE LOW-VALUES            TO PI-690-WORK-AREA
  4207             MOVE HIGH-VALUES           TO PI-690-FIRST-DATA
  4208             MOVE ZEROS                 TO PI-690-BRWS-TYPE-IND
  4209
  4210             IF  PI-RETURN-TO-PROGRAM EQUAL W-XCTL-626
  4211                 MOVE LOW-VALUES        TO PI-CARRIER
  4212                                           PI-GROUPING
  4213                                           PI-STATE
  4214                                           PI-ACCOUNT
  4215                                           PI-CERT-EFF-DT
  4216                                           PI-CERT-PRIME
  4217                                           PI-CERT-SFX
  4218                                           PI-689-WORK-AREA
  4219
  4220             ELSE
  4221                 PERFORM 9910-INITIALIZE-SECURITY THRU 9910-EXIT
  4222                 GO TO 1200-SET-UP-COMPLETE-SCREEN
  4223
  4224         ELSE
  4225             MOVE PI-RETURN-TO-PROGRAM  TO PI-CALLING-PROGRAM
  4226             MOVE PI-SAVED-PROGRAM-1    TO PI-RETURN-TO-PROGRAM
  4227             MOVE PI-SAVED-PROGRAM-2    TO PI-SAVED-PROGRAM-1
  4228             MOVE PI-SAVED-PROGRAM-3    TO PI-SAVED-PROGRAM-2
  4229             MOVE PI-SAVED-PROGRAM-4    TO PI-SAVED-PROGRAM-3
  4230             MOVE PI-SAVED-PROGRAM-5    TO PI-SAVED-PROGRAM-4
  4231             MOVE PI-SAVED-PROGRAM-6    TO PI-SAVED-PROGRAM-5
  4232             MOVE SPACES                TO PI-SAVED-PROGRAM-6.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL690.cbl
  4234 0100-ENTRY-LOGIC.
  4235
  4236     IF  EIBTRNID EQUAL W-TRANSACTION
  4237
  4238         IF  EIBAID EQUAL DFHCLEAR
  4239                 OR
  4240             NOT DISPLAY-CAP
  4241             MOVE PI-RETURN-TO-PROGRAM
  4242                                 TO W-CALL-PGM
  4243             PERFORM 9400-XCTL THRU 9400-EXIT
  4244
  4245         ELSE
  4246             GO TO 0200-RECEIVE
  4247
  4248     ELSE
  4249         IF  W-RETURNED-FROM NOT EQUAL SPACES
  4250             GO TO 1000-RECOVER-LAST-SCREEN.
  4251
  4252     MOVE LOW-VALUES             TO EL690AO.
  4253
  4254 0110-PGM-INITIALIZATION.
  4255
  4256     PERFORM 9910-INITIALIZE-SECURITY THRU 9910-EXIT.
  4257
  4258     MOVE LOW-VALUES             TO EL690AO.
  4259     MOVE -1                     TO TYPEBRL.
  4260     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL690.cbl
  4262 0200-RECEIVE.
  4263
  4264     IF  EIBAID EQUAL DFHPA1
  4265             OR
  4266         EIBAID EQUAL DFHPA2
  4267             OR
  4268         EIBAID EQUAL DFHPA3
  4269         MOVE ER-7008            TO EMI-ERROR
  4270         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4271         MOVE -1                 TO PFKEYL
  4272         GO TO 8200-SEND-DATAONLY.
  4273
  4274
  4275* EXEC CICS RECEIVE
  4276*        MAP     (W-MAP)
  4277*        MAPSET  (W-MAPSET)
  4278*        INTO    (EL690AI)
  4279*        END-EXEC.
  4280     MOVE LENGTH OF
  4281      EL690AI
  4282       TO DFHEIV11
  4283*    MOVE '8"T I  L              ''   #00004262' TO DFHEIV0
  4284     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  4285     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4286     MOVE X'2020233030303034323632' TO DFHEIV0(25:11)
  4287     CALL 'kxdfhei1' USING DFHEIV0,
  4288           W-MAP,
  4289           EL690AI,
  4290           DFHEIV11,
  4291           W-MAPSET,
  4292           DFHEIV99,
  4293           DFHEIV99
  4294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4295
  4296
  4297     IF  PFKEYL EQUAL ZERO
  4298         GO TO 0300-CHECK-PFKEYS.
  4299
  4300     IF  EIBAID NOT EQUAL DFHENTER
  4301         MOVE ER-0004            TO EMI-ERROR
  4302         GO TO 0310-INPUT-ERROR.
  4303
  4304     IF  PFKEYI GREATER 0 AND LESS 25
  4305         MOVE PF-VALUES (PFKEYI) TO EIBAID
  4306
  4307     ELSE
  4308         MOVE ER-0029            TO EMI-ERROR
  4309         GO TO 0310-INPUT-ERROR.
  4310
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL690.cbl
  4312 0300-CHECK-PFKEYS.
  4313
  4314     IF  EIBAID EQUAL DFHPF23
  4315         MOVE EIBAID             TO PI-ENTRY-CD-1
  4316         MOVE W-XCTL-005         TO W-CALL-PGM
  4317         PERFORM 9400-XCTL THRU 9400-EXIT.
  4318
  4319     IF  EIBAID EQUAL DFHPF24
  4320         MOVE W-XCTL-626         TO W-CALL-PGM
  4321         PERFORM 9400-XCTL THRU 9400-EXIT.
  4322
  4323     IF  EIBAID EQUAL DFHPF12
  4324         MOVE W-XCTL-010         TO W-CALL-PGM
  4325         PERFORM 9400-XCTL THRU 9400-EXIT.
  4326
  4327     IF  MAINTI EQUAL 'C'
  4328             AND
  4329         EIBAID EQUAL DFHENTER
  4330             AND
  4331         CORRSELL GREATER THAN ZEROS
  4332         MOVE -1                 TO CORRSELL
  4333         MOVE AL-UNBON           TO CORRSELA
  4334                                    MAINTA
  4335         MOVE ER-9323            TO EMI-ERROR
  4336         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4337         GO TO 8200-SEND-DATAONLY.
  4338
  4339     IF  EIBAID EQUAL DFHPF3
  4340*            OR
  4341*        (EIBAID EQUAL DFHENTER
  4342*            AND
  4343*        CORRSELL GREATER THAN ZEROS)
  4344         MOVE '3'                TO EIBAID
  4345         PERFORM 1500-SELECT-ARCHIVE-REC THRU 1500-EXIT
  4346         MOVE W-XCTL-689         TO W-CALL-PGM
  4347         GO TO 9400-XCTL.
  4348
  4349     IF  EIBAID EQUAL DFHPF4
  4350         MOVE LOW-VALUES         TO EL690AO
  4351                                    PI-690-WORK-AREA
  4352         MOVE -1                 TO TYPEBRL
  4353         GO TO 8100-SEND-INITIAL-MAP.
  4354
  4355     IF  EIBAID EQUAL DFHPF5
  4356             OR
  4357         (EIBAID EQUAL DFHENTER
  4358             AND
  4359         CORRSELL GREATER THAN ZEROS)
  4360         MOVE '5'                TO EIBAID
  4361         PERFORM 1500-SELECT-ARCHIVE-REC THRU 1500-EXIT
  4362         IF PI-689-ARCHIVE-NUMBER NOT GREATER ZERO
  4363             MOVE -1             TO CORRSELL
  4364             MOVE AL-UNBON       TO CORRSELA
  4365             MOVE ER-9293        TO EMI-ERROR
  4366             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4367             GO TO 8200-SEND-DATAONLY
  4368         ELSE
  4369             MOVE W-XCTL-691         TO W-CALL-PGM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL690.cbl
  4370             GO TO 9400-XCTL
  4371         END-IF
  4372     END-IF.
  4373
  4374     IF  MAINTI EQUAL 'C'
  4375             AND
  4376         EIBAID EQUAL DFHENTER
  4377         GO TO 0700-PROCESS-CHANGES.
  4378
  4379     IF  EIBAID EQUAL DFHPF1
  4380         PERFORM 0500-EDIT-SCREEN-DATA THRU 0500-EXIT
  4381         MOVE LOW-VALUES         TO PI-690-FIRST-DATA
  4382                                    W-ARCH-GROUPS
  4383         GO TO 2000-PAGE-FORWARD.
  4384
  4385     IF  EIBAID EQUAL DFHPF2
  4386
  4387         IF  PI-690-INIT-DATA EQUAL LOW-VALUES
  4388             MOVE HIGH-VALUES    TO PI-690-INIT-DATA
  4389             PERFORM 0500-EDIT-SCREEN-DATA THRU 0500-EXIT
  4390             MOVE HIGH-VALUES    TO PI-690-LAST-DATA
  4391             MOVE LOW-VALUES     TO W-ARCH-GROUPS
  4392             GO TO 3000-PAGE-BACKWARD
  4393
  4394         ELSE
  4395             PERFORM 0500-EDIT-SCREEN-DATA THRU 0500-EXIT
  4396             MOVE HIGH-VALUES    TO PI-690-LAST-DATA
  4397             MOVE LOW-VALUES     TO W-ARCH-GROUPS
  4398             GO TO 3000-PAGE-BACKWARD.
  4399
  4400     MOVE ER-0029                TO EMI-ERROR.
  4401
  4402 0310-INPUT-ERROR.
  4403
  4404     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4405     MOVE -1                     TO PFKEYL
  4406     MOVE AL-UNBON               TO PFKEYA
  4407     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL690.cbl
  4409 0500-EDIT-SCREEN-DATA.
  4410
  4411     IF  TYPEBRL NOT EQUAL ZEROS
  4412
  4413         IF  TYPEBRI NOT EQUAL PI-690-BRWS-TYPE-IND
  4414             MOVE 'Y'            TO W-CHANGE-REQUESTED-IND
  4415             MOVE TYPEBRI        TO PI-690-BRWS-TYPE-IND
  4416             MOVE AL-UNNON       TO TYPEBRA
  4417
  4418         ELSE
  4419             NEXT SENTENCE
  4420
  4421     ELSE
  4422         IF  PI-690-BRWS-TYPE-IND NOT NUMERIC
  4423                 OR
  4424             PI-690-BRWS-TYPE-IND LESS THAN 1
  4425                 OR
  4426             PI-690-BRWS-TYPE-IND GREATER THAN 6
  4427             MOVE 'Y'            TO W-CHANGE-REQUESTED-IND
  4428             MOVE 6              TO PI-690-BRWS-TYPE-IND
  4429             MOVE +1             TO TYPEBRL
  4430             MOVE AL-UNNON       TO TYPEBRA
  4431
  4432         ELSE
  4433             MOVE +1             TO TYPEBRL
  4434             MOVE AL-UNNON       TO TYPEBRA
  4435             MOVE PI-690-BRWS-TYPE-IND
  4436                                 TO TYPEBRO.
  4437
  4438     IF  CERTRPL GREATER THAN ZEROS
  4439
  4440         IF  CERTRPI NOT EQUAL PI-690-INIT-CERT-PRIME
  4441             MOVE 'Y'            TO W-CHANGE-REQUESTED-IND
  4442             MOVE CERTRPI        TO PI-690-INIT-CERT-PRIME
  4443             MOVE AL-UANON       TO CERTRPA
  4444
  4445             IF  SUFFIXL GREATER THAN ZEROS
  4446
  4447                 IF  SUFFIXI NOT EQUAL PI-690-INIT-SUFFIX
  4448                     MOVE 'Y'    TO W-CHANGE-REQUESTED-IND
  4449
  4450                     IF  SUFFIXI NOT GREATER THAN SPACES
  4451                         MOVE SPACES
  4452                                 TO SUFFIXI
  4453                                    PI-690-INIT-SUFFIX
  4454                         MOVE AL-UANON
  4455                                 TO SUFFIXA
  4456
  4457                     ELSE
  4458                         MOVE AL-UANON
  4459                                 TO SUFFIXA
  4460                         MOVE SUFFIXI
  4461                                 TO PI-690-INIT-SUFFIX
  4462
  4463                 ELSE
  4464                     NEXT SENTENCE
  4465
  4466             ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL690.cbl
  4467                 IF  PI-690-INIT-SUFFIX EQUAL LOW-VALUES
  4468                         OR
  4469                     PI-690-INIT-SUFFIX EQUAL HIGH-VALUES
  4470                     MOVE AL-UANON
  4471                                 TO SUFFIXA
  4472                     MOVE SPACES TO PI-690-INIT-SUFFIX
  4473
  4474                 ELSE
  4475                     NEXT SENTENCE
  4476
  4477         ELSE
  4478             NEXT SENTENCE
  4479
  4480     ELSE
  4481         IF  PI-690-INIT-CERT-PRIME GREATER THAN LOW-VALUES
  4482                 AND
  4483             PI-690-INIT-CERT-PRIME LESS THAN HIGH-VALUES
  4484             MOVE PI-690-INIT-CERT-PRIME
  4485                                 TO CERTRPI
  4486             MOVE PI-690-INIT-SUFFIX
  4487                                 TO SUFFIXI
  4488             MOVE AL-UANON       TO CERTRPA
  4489                                    SUFFIXA
  4490             MOVE +10            TO CERTRPL
  4491             MOVE +1             TO SUFFIXL.
  4492
  4493     IF  FORML GREATER THAN ZEROS
  4494
  4495         IF  FORMI NOT EQUAL PI-690-INIT-FORM
  4496             MOVE AL-UANON       TO FORMA
  4497             MOVE 'Y'            TO W-CHANGE-REQUESTED-IND
  4498             MOVE FORMI          TO PI-690-INIT-FORM
  4499
  4500         ELSE
  4501             NEXT SENTENCE
  4502
  4503     ELSE
  4504         IF  PI-690-INIT-FORM GREATER THAN LOW-VALUES
  4505                 AND
  4506             PI-690-INIT-FORM LESS THAN HIGH-VALUES
  4507             MOVE AL-UANON       TO FORMA
  4508             MOVE +4             TO FORML
  4509             MOVE PI-690-INIT-FORM
  4510                                 TO FORMI.
  4511
  4512     IF  ENTRYL GREATER THAN ZEROS
  4513             AND
  4514         CKCNTLL GREATER THAN ZEROS
  4515         MOVE -1                 TO CKCNTLL
  4516         MOVE AL-UABON           TO CKCNTLA
  4517         MOVE ER-7362            TO EMI-ERROR
  4518         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4519         GO TO 8100-SEND-INITIAL-MAP.
  4520
  4521     IF  ENTRYL GREATER THAN ZEROS
  4522
  4523         IF  ENTRYI NOT EQUAL PI-690-INIT-ENTRY
  4524             MOVE 'Y'            TO W-CHANGE-REQUESTED-IND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* EL690.cbl
  4525             MOVE ENTRYI         TO PI-690-INIT-ENTRY
  4526
  4527         ELSE
  4528             NEXT SENTENCE
  4529
  4530     ELSE
  4531         IF  PI-690-INIT-ENTRY GREATER THAN LOW-VALUES
  4532                 AND
  4533             PI-690-INIT-ENTRY LESS THAN HIGH-VALUES
  4534                 AND
  4535             PI-690-INIT-CONTROL-PREFIX NOT EQUAL 'CK'
  4536             MOVE AL-UANON       TO ENTRYA
  4537             MOVE +6             TO ENTRYL
  4538             MOVE PI-690-INIT-ENTRY
  4539                                 TO ENTRYI.
  4540
  4541     IF  CKCNTLL GREATER THAN ZEROS
  4542
  4543         IF  CKCNTLI NUMERIC
  4544
  4545             IF  CKCNTLI NOT EQUAL PI-690-INIT-CONTROL
  4546                 MOVE 'Y'        TO W-CHANGE-REQUESTED-IND
  4547                 MOVE 'CK'       TO PI-690-INIT-CONTROL-PREFIX
  4548                 MOVE CKCNTLI    TO PI-690-INIT-CONTROL
  4549
  4550             ELSE
  4551                 NEXT SENTENCE
  4552
  4553         ELSE
  4554             MOVE ZEROS          TO PI-690-INIT-CONTROL
  4555                                    CKCNTLO
  4556
  4557     ELSE
  4558         IF  PI-690-INIT-CONTROL GREATER THAN ZEROS
  4559                 AND
  4560             PI-690-INIT-CONTROL LESS THAN 99999999
  4561                 AND
  4562             PI-690-INIT-CONTROL-PREFIX EQUAL 'CK'
  4563             MOVE AL-UANON       TO CKCNTLA
  4564             MOVE +8             TO CKCNTLL
  4565             MOVE PI-690-INIT-CONTROL
  4566                                 TO CKCNTLI.
  4567
  4568     IF  CARRIERL GREATER THAN ZEROS
  4569
  4570         IF  CARRIERI NOT EQUAL  TO PI-690-INIT-CARRIER
  4571             MOVE 'Y'            TO W-CHANGE-REQUESTED-IND
  4572             MOVE CARRIERI       TO PI-690-INIT-CARRIER
  4573
  4574         ELSE
  4575             NEXT SENTENCE
  4576
  4577     ELSE
  4578         IF  PI-690-INIT-CARRIER GREATER THAN LOW-VALUES
  4579                 AND
  4580             PI-690-INIT-CARRIER LESS THAN HIGH-VALUES
  4581             MOVE AL-UANON       TO CARRIERA
  4582             MOVE +1             TO CARRIERL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* EL690.cbl
  4583             MOVE PI-690-INIT-CARRIER
  4584                                 TO CARRIERI.
  4585
  4586     IF  GROUPL GREATER THAN ZEROS
  4587
  4588         IF  GROUPI NOT EQUAL    TO PI-690-INIT-GROUPING
  4589             MOVE 'Y'            TO W-CHANGE-REQUESTED-IND
  4590             MOVE GROUPI         TO PI-690-INIT-GROUPING
  4591
  4592         ELSE
  4593             NEXT SENTENCE
  4594
  4595     ELSE
  4596         IF  PI-690-INIT-GROUPING GREATER THAN LOW-VALUES
  4597                 AND
  4598             PI-690-INIT-GROUPING LESS THAN HIGH-VALUES
  4599             MOVE AL-UANON       TO GROUPA
  4600             MOVE +6             TO GROUPL
  4601             MOVE PI-690-INIT-GROUPING
  4602                                 TO GROUPI.
  4603
  4604     IF  STATEL GREATER THAN ZEROS
  4605
  4606         IF  STATEI NOT EQUAL    TO PI-690-INIT-STATE
  4607             MOVE 'Y'            TO W-CHANGE-REQUESTED-IND
  4608             MOVE STATEI         TO PI-690-INIT-STATE
  4609
  4610         ELSE
  4611             NEXT SENTENCE
  4612
  4613     ELSE
  4614         IF  PI-690-INIT-STATE GREATER THAN LOW-VALUES
  4615                 AND
  4616             PI-690-INIT-STATE LESS THAN HIGH-VALUES
  4617             MOVE AL-UANON       TO STATEA
  4618             MOVE +2             TO STATEL
  4619             MOVE PI-690-INIT-STATE
  4620                                 TO STATEI.
  4621
  4622     IF  ACCTL GREATER THAN ZEROS
  4623
  4624         IF  ACCTI NOT EQUAL     TO PI-690-INIT-ACCOUNT
  4625             MOVE 'Y'            TO W-CHANGE-REQUESTED-IND
  4626             MOVE ACCTI          TO PI-690-INIT-ACCOUNT
  4627
  4628         ELSE
  4629             NEXT SENTENCE
  4630
  4631     ELSE
  4632         IF  PI-690-INIT-ACCOUNT GREATER THAN LOW-VALUES
  4633                 AND
  4634             PI-690-INIT-ACCOUNT LESS THAN HIGH-VALUES
  4635             MOVE AL-UANON       TO ACCTA
  4636             MOVE +10            TO ACCTL
  4637             MOVE PI-690-INIT-ACCOUNT
  4638                                 TO ACCTI.
  4639
  4640     IF  PROCSRL GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* EL690.cbl
  4641
  4642         IF  PROCSRI NOT EQUAL   TO PI-690-INIT-PROCESSOR
  4643             MOVE 'Y'            TO W-CHANGE-REQUESTED-IND
  4644             MOVE PROCSRI        TO PI-690-INIT-PROCESSOR
  4645
  4646         ELSE
  4647             NEXT SENTENCE
  4648
  4649     ELSE
  4650         IF  PI-690-INIT-PROCESSOR GREATER THAN LOW-VALUES
  4651                 AND
  4652             PI-690-INIT-PROCESSOR LESS THAN HIGH-VALUES
  4653             MOVE AL-UANON       TO PROCSRA
  4654             MOVE +4             TO PROCSRL
  4655             MOVE PI-690-INIT-PROCESSOR
  4656                                 TO PROCSRI.
  4657
  4658     IF  EFFDTEL GREATER THAN ZEROS
  4659         MOVE EFFDTEI            TO W-DEEDIT-FIELD
  4660
  4661         PERFORM 9200-DATE-EDIT THRU 9200-EXIT
  4662
  4663         IF  DC-ERROR-CODE NOT EQUAL SPACES
  4664             MOVE -1             TO EFFDTEL
  4665             MOVE AL-UABON       TO EFFDTEA
  4666             MOVE ER-0314        TO EMI-ERROR
  4667             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4668             GO TO 8100-SEND-INITIAL-MAP
  4669
  4670         ELSE
  4671             IF  DC-BIN-DATE-1 NOT = PI-690-INIT-EFFECT-DATE
  4672                 MOVE 'Y'        TO W-CHANGE-REQUESTED-IND
  4673                 MOVE DC-BIN-DATE-1
  4674                                 TO PI-690-INIT-EFFECT-DATE
  4675                 MOVE DC-GREG-DATE-1-EDIT
  4676                                 TO PI-690-INIT-EFF-DTE
  4677
  4678             ELSE
  4679                 IF  PI-690-INIT-EFFECT-DATE > LOW-VALUES
  4680                         AND
  4681                     PI-690-INIT-EFFECT-DATE < HIGH-VALUES
  4682                     MOVE AL-UANON
  4683                                 TO EFFDTEA
  4684                     MOVE +8     TO EFFDTEL
  4685                     MOVE PI-690-INIT-EFF-DTE
  4686                                 TO EFFDTEI.
  4687
  4688     IF  STATSELL GREATER THAN ZEROS
  4689         MOVE STATSELI           TO PI-690-STATUS-SELECTION-IND
  4690
  4691         IF  NOT PI-690-VALID-SELECTION
  4692             MOVE -1             TO STATSELL
  4693             MOVE AL-UABON       TO STATSELA
  4694             MOVE ER-7244        TO EMI-ERROR
  4695             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4696             GO TO 8100-SEND-INITIAL-MAP
  4697
  4698         ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* EL690.cbl
  4699             NEXT SENTENCE
  4700
  4701     ELSE
  4702         IF  PI-690-VALID-SELECTION
  4703             MOVE AL-UANON       TO STATSELA
  4704             MOVE +1             TO STATSELL
  4705             MOVE PI-690-STATUS-SELECTION-IND
  4706                                 TO STATSELI
  4707
  4708         ELSE
  4709             MOVE AL-UANON       TO STATSELA
  4710             MOVE +1             TO STATSELL
  4711             MOVE 'N'            TO PI-690-STATUS-SELECTION-IND
  4712                                    STATSELI.
  4713
  4714 0500-EXIT.
  4715     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* EL690.cbl
  4717 0700-PROCESS-CHANGES.
  4718
  4719     IF  NOT MODIFY-CAP
  4720         MOVE 'UPDATE'           TO SM-READ
  4721         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  4722         MOVE ER-9096            TO EMI-ERROR
  4723         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4724         MOVE AL-UANON           TO MAINTA
  4725         MOVE -1                 TO MAINTL
  4726         GO TO 8200-SEND-DATAONLY.
  4727
  4728
  4729* EXEC CICS HANDLE CONDITION
  4730*        NOTFND  (8080-ARCH-NOT-FOUND)
  4731*        ENDFILE (8080-ARCH-NOT-FOUND)
  4732*        END-EXEC.
  4733*    MOVE '"$I''                  ! # #00004699' TO DFHEIV0
  4734     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  4735     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4736     MOVE X'2320233030303034363939' TO DFHEIV0(25:11)
  4737     CALL 'kxdfhei1' USING DFHEIV0
  4738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4739
  4740
  4741     MOVE ZEROS                  TO W-FIRST-CHANGE-IND.
  4742
  4743     PERFORM 0720-SEARCH-FOR-CHANGES THRU 0720-EXIT
  4744             VARYING
  4745         W-ARCH-NDX FROM 1 BY 1
  4746             UNTIL
  4747         W-ARCH-NDX GREATER THAN 12
  4748             OR
  4749         PI-690-ARCHIVE-NUM (W-ARCH-NDX) EQUAL ZEROS.
  4750
  4751     IF  NOT EMI-NO-ERRORS
  4752         GO TO 8200-SEND-DATAONLY.
  4753
  4754     MOVE SPACES                 TO MAINTO
  4755     MOVE -1                     TO MAINTL
  4756     MOVE ER-9308                TO EMI-ERROR
  4757     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4758
  4759     MOVE LOW-VALUES             TO EL690AO.
  4760
  4761     IF  PI-690-LAST-BRWS-FWRD
  4762         MOVE '1'                TO EIBAID
  4763         GO TO 2000-PAGE-FORWARD.
  4764
  4765     IF  PI-690-LAST-BRWS-BWRD
  4766         MOVE '2'                TO EIBAID
  4767         GO TO 3000-PAGE-BACKWARD.
  4768
  4769 0700-EXIT.
  4770     EXIT.
  4771
  4772 0720-SEARCH-FOR-CHANGES.
  4773
  4774     MOVE SPACES                 TO W-REPLY-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* EL690.cbl
  4775                                    W-RESEND-DATE-1
  4776                                    W-RESEND-DATE-2
  4777                                    W-RESEND-DATE-3
  4778                                    W-STATUS
  4779                                    W-VALID-STATUS-SW.
  4780
  4781*    IF  W-STATSL (W-ARCH-NDX) GREATER THAN ZEROS
  4782*        MOVE W-STATSO (W-ARCH-NDX)
  4783*                                TO W-VALID-STATUS-SW
  4784*
  4785*        IF  W-ALLOWED-ENTRIES
  4786*            MOVE W-STATSO (W-ARCH-NDX)
  4787*                                TO W-STATUS
  4788*
  4789*        ELSE
  4790*            MOVE ER-7358        TO EMI-ERROR
  4791*            MOVE AL-UANON       TO W-STATSA (W-ARCH-NDX)
  4792*            MOVE -1             TO W-STATSL (W-ARCH-NDX)
  4793*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4794
  4795     IF  W-RSDATL (W-ARCH-NDX) GREATER THAN ZEROS
  4796
  4797         IF  W-RSDATO (W-ARCH-NDX) EQUAL SPACES
  4798                 OR
  4799             W-RSDATO (W-ARCH-NDX) EQUAL ZEROES
  4800             MOVE LOW-VALUES     TO W-RESEND-DATE-1
  4801
  4802         ELSE
  4803             MOVE W-RSDATO (W-ARCH-NDX)
  4804                                 TO W-DEEDIT-FIELD
  4805
  4806             PERFORM 9200-DATE-EDIT THRU 9200-EXIT
  4807
  4808             IF  DC-ERROR-CODE EQUAL SPACES
  4809                 MOVE DC-BIN-DATE-1
  4810                                 TO W-RESEND-DATE-1
  4811                 MOVE DC-GREG-DATE-1-EDIT
  4812                                 TO W-RSDATO (W-ARCH-NDX)
  4813
  4814             ELSE
  4815                 MOVE ER-0185    TO EMI-ERROR
  4816                 MOVE AL-UANON   TO W-RSDATA (W-ARCH-NDX)
  4817                 MOVE -1         TO W-RSDATL (W-ARCH-NDX)
  4818                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4819
  4820*    IF  W-RSFRML (W-ARCH-NDX) GREATER THAN ZEROS
  4821*
  4822*        IF  W-RSFRMO (W-ARCH-NDX) EQUAL SPACES
  4823*                OR
  4824*            W-RSFRMO (W-ARCH-NDX) EQUAL ZEROES
  4825*            MOVE LOW-VALUES     TO W-RESEND-DATE-2
  4826*
  4827*        ELSE
  4828*            MOVE W-RSFRMO (W-ARCH-NDX)
  4829*                                TO W-DEEDIT-FIELD
  4830*
  4831*            PERFORM 9200-DATE-EDIT THRU 9200-EXIT
  4832*
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* EL690.cbl
  4833*            IF  DC-ERROR-CODE EQUAL SPACES
  4834*                MOVE DC-BIN-DATE-1
  4835*                                TO W-RESEND-DATE-2
  4836*                MOVE DC-GREG-DATE-1-EDIT
  4837*                                TO W-RSFRMO (W-ARCH-NDX)
  4838*
  4839*            ELSE
  4840*                MOVE ER-0185    TO EMI-ERROR
  4841*                MOVE AL-UANON   TO W-RSFRMA (W-ARCH-NDX)
  4842*                MOVE -1         TO W-RSFRML (W-ARCH-NDX)
  4843*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4844*
  4845*    IF  W-RSSTSL (W-ARCH-NDX) GREATER THAN ZEROS
  4846*
  4847*        IF  W-RSSTSO (W-ARCH-NDX) EQUAL SPACES
  4848*                OR
  4849*            W-RSSTSO (W-ARCH-NDX) EQUAL ZEROES
  4850*            MOVE LOW-VALUES     TO W-RESEND-DATE-3
  4851*
  4852*        ELSE
  4853*            MOVE W-RSSTSO (W-ARCH-NDX)
  4854*                                TO W-DEEDIT-FIELD
  4855*
  4856*            PERFORM 9200-DATE-EDIT THRU 9200-EXIT
  4857*
  4858*            IF  DC-ERROR-CODE EQUAL SPACES
  4859*                MOVE DC-BIN-DATE-1
  4860*                                TO W-RESEND-DATE-3
  4861*                MOVE DC-GREG-DATE-1-EDIT
  4862*                                TO W-RSSTSO (W-ARCH-NDX)
  4863*
  4864*            ELSE
  4865*                MOVE ER-0185    TO EMI-ERROR
  4866*                MOVE AL-UANON   TO W-RSSTSA (W-ARCH-NDX)
  4867*                MOVE -1         TO W-RSSTSL (W-ARCH-NDX)
  4868*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4869
  4870*    IF  W-REPLYL (W-ARCH-NDX) GREATER THAN ZEROS
  4871*
  4872*        IF  W-REPLYO (W-ARCH-NDX) EQUAL SPACES
  4873*                OR
  4874*            W-REPLYO (W-ARCH-NDX) EQUAL ZEROES
  4875*            MOVE LOW-VALUES     TO W-REPLY-DATE
  4876*
  4877*        ELSE
  4878*            MOVE W-REPLYO (W-ARCH-NDX)
  4879*                                TO W-DEEDIT-FIELD
  4880*
  4881*            PERFORM 9200-DATE-EDIT THRU 9200-EXIT
  4882*
  4883*            IF  DC-ERROR-CODE EQUAL SPACES
  4884*                MOVE DC-BIN-DATE-1
  4885*                                TO W-REPLY-DATE
  4886*                MOVE DC-GREG-DATE-1-EDIT
  4887*                                TO W-REPLYO (W-ARCH-NDX)
  4888*
  4889*            ELSE
  4890*                MOVE ER-9245    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* EL690.cbl
  4891*                MOVE AL-UANON   TO W-REPLYA (W-ARCH-NDX)
  4892*                MOVE -1         TO W-REPLYL (W-ARCH-NDX)
  4893*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4894
  4895*    IF  (W-REPLY-DATE NOT EQUAL SPACES
  4896*            OR
  4897*        W-RESEND-DATE-1 NOT EQUAL SPACES
  4898*            OR
  4899*        W-RESEND-DATE-2 NOT EQUAL SPACES
  4900*            OR
  4901*        W-RESEND-DATE-3 NOT EQUAL SPACES
  4902*            OR
  4903*        W-STATUS GREATER THAN SPACES)
  4904*            AND
  4905*        PI-690-ARCHIVE-NUM (W-ARCH-NDX) NOT EQUAL ZEROS
  4906*        PERFORM 0740-UPDATE-ARCH-RECORD THRU 0740-EXIT.
  4907
  4908 0720-EXIT.
  4909     EXIT.
  4910
  4911 0740-UPDATE-ARCH-RECORD.
  4912
  4913     MOVE LOW-VALUES             TO W-ARCT-KEY.
  4914     MOVE PI-690-ARCHIVE-NUM (W-ARCH-NDX)
  4915                                 TO W-ARCH-ARCHIVE-NO
  4916                                    W-ARCT-ARCHIVE-NO
  4917                                    W-HOLD-ARCHIVE.
  4918     MOVE PI-COMPANY-CD          TO W-ARCH-COMPANY-CD
  4919                                    W-ARCT-COMPANY-CD.
  4920
  4921     IF  W-SPECIAL-STATUS
  4922         PERFORM 7800-DELETE-CYCLE THRU 7800-EXIT
  4923         GO TO 0740-EXIT.
  4924
  4925
  4926* EXEC CICS HANDLE CONDITION
  4927*        NOTFND  (8080-ARCH-NOT-FOUND)
  4928*        ENDFILE (8080-ARCH-NOT-FOUND)
  4929*        END-EXEC.
  4930*    MOVE '"$I''                  ! $ #00004888' TO DFHEIV0
  4931     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  4932     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4933     MOVE X'2420233030303034383838' TO DFHEIV0(25:11)
  4934     CALL 'kxdfhei1' USING DFHEIV0
  4935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4936
  4937
  4938     PERFORM 7600-READ-ARCH-FILE THRU 7600-EXIT.
  4939
  4940     IF  W-REPLY-DATE NOT EQUAL SPACES
  4941
  4942         IF  W-REPLY-DATE EQUAL LOW-VALUES
  4943             MOVE LOW-VALUES     TO LA-REPLY-DATE
  4944             MOVE 'A'            TO W-STATUS
  4945
  4946         ELSE
  4947             MOVE W-REPLY-DATE   TO LA-REPLY-DATE
  4948             MOVE 'C'            TO W-STATUS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* EL690.cbl
  4949
  4950     IF  W-RESEND-DATE-1 NOT EQUAL SPACES
  4951             AND
  4952         W-RESEND-DATE-1 NOT EQUAL LA-RESEND-DATE
  4953
  4954         IF  LA-SENT-DATE   GREATER THAN LOW-VALUES
  4955             MOVE ER-7396        TO EMI-ERROR
  4956             MOVE AL-UANON       TO W-RSDATA (W-ARCH-NDX)
  4957             MOVE -1             TO W-RSDATL (W-ARCH-NDX)
  4958             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4959
  4960         ELSE
  4961             MOVE 'A'            TO W-STATUS
  4962             MOVE LOW-VALUES     TO LA-SENT-DATE
  4963             MOVE W-RESEND-DATE-1
  4964                                 TO LA-RESEND-DATE.
  4965
  4966*    IF  W-RESEND-DATE-2 NOT EQUAL SPACES
  4967*            AND
  4968*        W-RESEND-DATE-2 NOT EQUAL LA-RESEND-DATE-2
  4969*
  4970*        IF  LA-SENT-DATE-2 GREATER THAN LOW-VALUES
  4971*            MOVE ER-7396        TO EMI-ERROR
  4972*            MOVE AL-UANON       TO W-RSFRMA (W-ARCH-NDX)
  4973*            MOVE -1             TO W-RSFRML (W-ARCH-NDX)
  4974*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4975*
  4976*        ELSE
  4977*            MOVE 'A'            TO W-STATUS
  4978*            MOVE LOW-VALUES     TO LA-SENT-DATE-2
  4979*            MOVE W-RESEND-DATE-2
  4980*                                TO LA-RESEND-DATE-2.
  4981
  4982*    IF  W-RESEND-DATE-3 NOT EQUAL SPACES
  4983*            AND
  4984*        W-RESEND-DATE-3 NOT EQUAL LA-RESEND-DATE-3
  4985*
  4986*        IF  LA-SENT-DATE-3 GREATER THAN LOW-VALUES
  4987*
  4988*            IF  PI-COMPANY-ID EQUAL 'LAP' OR 'RMC'
  4989*                MOVE ER-7396    TO EMI-ERROR
  4990*                MOVE AL-UANON   TO W-RSSTSA (W-ARCH-NDX)
  4991*                MOVE -1         TO W-RSSTSL (W-ARCH-NDX)
  4992*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4993*
  4994*            ELSE
  4995*                MOVE LOW-VALUES TO LA-SENT-DATE-3
  4996*                MOVE W-RESEND-DATE-3
  4997*                                TO LA-RESEND-DATE-3
  4998*                MOVE 'A'        TO W-STATUS
  4999*
  5000*        ELSE
  5001*            MOVE 'A'            TO W-STATUS
  5002*            MOVE LOW-VALUES     TO LA-SENT-DATE-3
  5003*            MOVE W-RESEND-DATE-3
  5004*                                TO LA-RESEND-DATE-3.
  5005
  5006*    IF  LA-RESEND-DATE-3 GREATER THAN LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* EL690.cbl
  5007*
  5008*        IF  LA-RESEND-DATE-3 GREATER THAN LA-RESEND-DATE-2
  5009*            NEXT SENTENCE
  5010*
  5011*        ELSE
  5012*            EXEC CICS UNLOCK
  5013*                DATASET (W-ARCH-FILE-ID)
  5014*            END-EXEC
  5015*            MOVE ER-9281        TO EMI-ERROR
  5016*            MOVE AL-UANON       TO W-RSFRMA (W-ARCH-NDX)
  5017*            MOVE -1             TO W-RSFRML (W-ARCH-NDX)
  5018*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5019*            GO TO 0740-EXIT.
  5020
  5021*    IF  LA-RESEND-DATE-2 GREATER THAN LOW-VALUES
  5022*
  5023*        IF  LA-RESEND-DATE-2 GREATER THAN LA-RESEND-DATE
  5024*            NEXT SENTENCE
  5025*
  5026*        ELSE
  5027*            EXEC CICS UNLOCK
  5028*                DATASET (W-ARCH-FILE-ID)
  5029*            END-EXEC
  5030*
  5031*            MOVE ER-9281        TO EMI-ERROR
  5032*            MOVE AL-UANON       TO W-RSDATA (W-ARCH-NDX)
  5033*            MOVE -1             TO W-RSDATL (W-ARCH-NDX)
  5034*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5035*            GO TO 0740-EXIT.
  5036
  5037     IF  LA-STATUS EQUAL 'X'
  5038             AND
  5039         W-ACTIVE
  5040
  5041         IF  LA-VOIDED-DATE GREATER THAN LOW-VALUES
  5042             MOVE 'V'            TO W-STATUS
  5043
  5044         ELSE
  5045             IF  LA-REPLY-DATE GREATER THAN LOW-VALUES
  5046                 MOVE 'C'        TO W-STATUS.
  5047
  5048     IF  LA-STATUS EQUAL 'V'
  5049             AND
  5050         W-ACTIVE
  5051         MOVE LOW-VALUES         TO LA-VOIDED-DATE.
  5052
  5053*    IF  LA-STATUS EQUAL 'C'
  5054*            AND
  5055*        W-ACTIVE
  5056*        MOVE ER-7399            TO EMI-ERROR
  5057*        MOVE AL-UANON           TO W-STATSA (W-ARCH-NDX)
  5058*        MOVE -1                 TO W-STATSL (W-ARCH-NDX)
  5059*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5060*        GO TO 0740-REWRITE.
  5061
  5062     IF  W-CLEAR-INITIAL
  5063         MOVE LOW-VALUES         TO LA-INITIAL-PRINT-DATE
  5064         MOVE 'A'                TO W-STATUS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* EL690.cbl
  5065
  5066     IF  W-CHECK-STATUS
  5067         PERFORM 0750-CHECK-STATUS THRU 0750-EXIT
  5068
  5069     ELSE
  5070         IF  W-VALID-STATUS
  5071                 AND
  5072             W-STATUS GREATER THAN SPACES
  5073             MOVE W-STATUS       TO LA-STATUS.
  5074
  5075     IF  W-VOIDED
  5076         MOVE W-SAVE-BIN-DATE    TO LA-VOIDED-DATE.
  5077
  5078     IF  LA-REPLY-DATE GREATER THAN LOW-VALUES
  5079             AND
  5080         LA-STATUS EQUAL 'A'
  5081         MOVE 'C'                TO LA-STATUS.
  5082
  5083 0740-REWRITE.
  5084
  5085
  5086* EXEC CICS REWRITE
  5087*        DATASET (W-ARCH-FILE-ID)
  5088*        FROM    (LETTER-ARCHIVE)
  5089*    END-EXEC.
  5090     MOVE LENGTH OF
  5091      LETTER-ARCHIVE
  5092       TO DFHEIV11
  5093*    MOVE '&& L                  %   #00005040' TO DFHEIV0
  5094     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5095     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5096     MOVE X'2020233030303035303430' TO DFHEIV0(25:11)
  5097     CALL 'kxdfhei1' USING DFHEIV0,
  5098           W-ARCH-FILE-ID,
  5099           LETTER-ARCHIVE,
  5100           DFHEIV11,
  5101           DFHEIV99
  5102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5103
  5104
  5105     IF  W-NO-FIRST-CHANGE
  5106         MOVE W-ARCH-NDX         TO W-FIRST-CHANGE-IND.
  5107
  5108 0740-EXIT.
  5109     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* EL690.cbl
  5111 0750-CHECK-STATUS.
  5112
  5113     IF  LA-STATUS EQUAL '#'
  5114         MOVE 'A'                TO LA-STATUS
  5115         GO TO 0750-EXIT.
  5116
  5117     IF  LA-STATUS NOT EQUAL 'A' OR 'C'
  5118         GO TO 0750-EXIT.
  5119
  5120     IF LA-INITIAL-PRINT-DATE > LOW-VALUES
  5121        IF LA-RESEND-DATE > LOW-VALUES
  5122           IF LA-SENT-DATE = LOW-VALUES
  5123              MOVE 'A'           TO LA-STATUS
  5124           ELSE
  5125              MOVE 'C'           TO LA-STATUS
  5126           END-IF
  5127        ELSE
  5128           MOVE 'C'              TO LA-STATUS
  5129        END-IF
  5130     ELSE
  5131        MOVE 'A'                  TO LA-STATUS
  5132     END-IF
  5133*    IF  LA-INITIAL-PRINT-DATE GREATER THAN LOW-VALUES
  5134*        IF  LA-RESEND-DATE GREATER THAN LOW-VALUES
  5135*            IF  LA-SENT-DATE   NOT GREATER THAN LOW-VALUES
  5136*                MOVE 'A'        TO LA-STATUS
  5137*
  5138*            ELSE
  5139*                IF  LA-RESEND-DATE-2 GREATER THAN LOW-VALUES
  5140*
  5141*                    IF  LA-SENT-DATE-2 NOT GREATER THAN
  5142*                            LOW-VALUES
  5143*                        MOVE 'A'        TO LA-STATUS
  5144*
  5145*                    ELSE
  5146*                        IF  LA-RESEND-DATE-3 GREATER THAN
  5147*                                LOW-VALUES
  5148*
  5149*                            IF  LA-SENT-DATE-3 NOT GREATER
  5150*                                    THAN LOW-VALUES
  5151*                                MOVE 'A' TO LA-STATUS
  5152*
  5153*                            ELSE
  5154*                                MOVE 'C' TO LA-STATUS
  5155*
  5156*                        ELSE
  5157*                            MOVE 'C'
  5158*                                TO LA-STATUS
  5159*
  5160*
  5161*                 ELSE
  5162*                     MOVE 'C'   TO LA-STATUS
  5163*
  5164*        ELSE
  5165*            MOVE 'C'            TO LA-STATUS
  5166*
  5167*    ELSE
  5168*        MOVE 'A'                TO LA-STATUS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* EL690.cbl
  5169
  5170     .
  5171 0750-EXIT.
  5172     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* EL690.cbl
  5174 0800-CONVERT-EFFECT-DATE.
  5175
  5176      IF  PI-CERT-EFF-DT > LOW-VALUES
  5177          MOVE PI-CERT-EFF-DT    TO DC-BIN-DATE-1
  5178                                    PI-690-INIT-EFFECT-DATE
  5179          MOVE ' '               TO DC-OPTION-CODE
  5180          PERFORM 9500-LINK-DATE-CONVERT
  5181              THRU 9500-EXIT
  5182
  5183          IF  DC-ERROR-CODE EQUAL SPACES
  5184              MOVE DC-GREG-DATE-1-EDIT
  5185                                 TO EFFDTEI
  5186                                    PI-690-INIT-EFF-DTE
  5187              MOVE +8            TO EFFDTEL
  5188
  5189          ELSE
  5190              MOVE LOW-VALUES    TO EFFDTEI
  5191              MOVE +8            TO EFFDTEL
  5192
  5193      ELSE
  5194          MOVE LOW-VALUES        TO EFFDTEI
  5195          MOVE +8                TO EFFDTEL.
  5196
  5197 0800-EXIT.
  5198     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 102
* EL690.cbl
  5200 1000-RECOVER-LAST-SCREEN.
  5201
  5202     MOVE LOW-VALUES             TO EL690AO.
  5203     MOVE 1                      TO W-FIRST-CHANGE-IND.
  5204
  5205     MOVE PI-690-BRWS-TYPE-IND   TO TYPEBRI.
  5206     MOVE +1                     TO TYPEBRL.
  5207
  5208     IF  PI-690-INIT-CERT-PRIME GREATER THAN LOW-VALUES
  5209             AND
  5210         PI-690-INIT-CERT-PRIME LESS THAN HIGH-VALUES
  5211         MOVE PI-690-INIT-CERT-PRIME
  5212                                 TO CERTRPI
  5213         MOVE +10                TO CERTRPL
  5214         MOVE PI-690-INIT-SUFFIX TO SUFFIXI
  5215         MOVE +1                 TO SUFFIXL.
  5216
  5217     IF  PI-690-INIT-CARRIER GREATER THAN LOW-VALUES
  5218             AND
  5219         PI-690-INIT-CARRIER LESS THAN HIGH-VALUES
  5220         MOVE PI-690-INIT-CARRIER
  5221                                 TO CARRIERI
  5222         MOVE +1                 TO CARRIERL.
  5223
  5224     IF  PI-690-INIT-GROUPING GREATER THAN LOW-VALUES
  5225             AND
  5226         PI-690-INIT-GROUPING LESS THAN HIGH-VALUES
  5227         MOVE PI-690-INIT-GROUPING
  5228                                 TO GROUPI
  5229         MOVE +6                 TO GROUPL.
  5230
  5231     IF  PI-690-INIT-STATE GREATER THAN LOW-VALUES
  5232             AND
  5233         PI-690-INIT-STATE LESS THAN HIGH-VALUES
  5234         MOVE PI-690-INIT-STATE  TO STATEI
  5235         MOVE +2                 TO STATEL.
  5236
  5237     IF  PI-690-INIT-ACCOUNT GREATER THAN LOW-VALUES
  5238             AND
  5239         PI-690-INIT-ACCOUNT LESS THAN HIGH-VALUES
  5240         MOVE PI-690-INIT-ACCOUNT
  5241                                 TO ACCTI
  5242         MOVE +10                TO ACCTL.
  5243
  5244     IF  PI-690-INIT-FORM GREATER THAN LOW-VALUES
  5245             AND
  5246         PI-690-INIT-FORM LESS THAN HIGH-VALUES
  5247         MOVE PI-690-INIT-FORM   TO FORMI
  5248         MOVE +04                TO FORML.
  5249
  5250     IF  PI-690-INIT-PROCESSOR GREATER THAN LOW-VALUES
  5251             AND
  5252         PI-690-INIT-PROCESSOR LESS THAN HIGH-VALUES
  5253         MOVE PI-690-INIT-PROCESSOR
  5254                                 TO PROCSRI
  5255         MOVE +04                TO PROCSRL.
  5256
  5257     IF  PI-690-INIT-EFFECT-DATE > LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 103
* EL690.cbl
  5258             AND
  5259         PI-690-INIT-EFFECT-DATE < HIGH-VALUES
  5260         MOVE PI-690-INIT-EFFECT-DATE
  5261                                 TO DC-BIN-DATE-1
  5262         MOVE ' '                TO DC-OPTION-CODE
  5263         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  5264
  5265         IF  DC-ERROR-CODE EQUAL SPACES
  5266             MOVE DC-GREG-DATE-1-EDIT
  5267                                 TO EFFDTEI
  5268             MOVE +8             TO EFFDTEL.
  5269
  5270     IF  PI-690-INIT-ENTRY GREATER THAN LOW-VALUES
  5271             AND
  5272         PI-690-INIT-ENTRY LESS THAN HIGH-VALUES
  5273             AND
  5274         PI-690-INIT-CONTROL-PREFIX NOT EQUAL 'CK'
  5275         MOVE PI-690-INIT-ENTRY  TO ENTRYI
  5276         MOVE +6                 TO ENTRYL
  5277
  5278     ELSE
  5279         IF  PI-690-INIT-CONTROL GREATER THAN ZEROS
  5280                 AND
  5281             PI-690-INIT-CONTROL LESS THAN 99999999
  5282                 AND
  5283             PI-690-INIT-CONTROL-PREFIX EQUAL 'CK'
  5284             MOVE PI-690-INIT-CONTROL
  5285                                 TO CKCNTLI
  5286             MOVE +8             TO CKCNTLL.
  5287
  5288     IF  PI-690-VALID-SELECTION
  5289         MOVE PI-690-STATUS-SELECTION-IND
  5290                                 TO STATSELI
  5291         MOVE +1                 TO STATSELL
  5292
  5293     ELSE
  5294         MOVE 'N'                TO STATSELI
  5295         MOVE +1                 TO STATSELL.
  5296
  5297     IF  PI-690-LAST-BRWS-FWRD
  5298         MOVE '1'                TO EIBAID
  5299         GO TO 2000-PAGE-FORWARD.
  5300
  5301     IF  PI-690-LAST-BRWS-BWRD
  5302         MOVE '2'                TO EIBAID
  5303         MOVE 'Y'                TO W-READ-PREV-TWICE-IND
  5304         GO TO 3000-PAGE-BACKWARD.
  5305
  5306     MOVE -1                     TO CORRSELL.
  5307     GO TO 8100-SEND-INITIAL-MAP.
  5308
  5309 1000-EXIT.
  5310     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 104
* EL690.cbl
  5312 1200-SET-UP-COMPLETE-SCREEN.
  5313
  5314     MOVE LOW-VALUES        TO EL690AO.
  5315
  5316     IF  PI-RETURN-TO-PROGRAM EQUAL 'EL6311'
  5317         GO TO 1220-COMING-FROM-EL6311.
  5318
  5319     IF  PI-RETURN-TO-PROGRAM EQUAL 'EL652'
  5320         GO TO 1240-COMING-FROM-EL652.
  5321
  5322     IF  PI-RETURN-TO-PROGRAM EQUAL 'EL1273'
  5323         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  5324         MOVE PI-CERT-PRIME      TO CERTRPI
  5325         MOVE +10                TO CERTRPL
  5326         MOVE PI-CERT-SFX        TO SUFFIXI
  5327         MOVE +1                 TO SUFFIXL
  5328         MOVE 1                  TO TYPEBRI
  5329         MOVE +1                 TO TYPEBRL
  5330
  5331     ELSE
  5332         IF  PI-RETURN-TO-PROGRAM EQUAL 'EL6501'
  5333             MOVE 4              TO TYPEBRI
  5334             MOVE +1             TO TYPEBRL.
  5335
  5336     MOVE PI-CARRIER             TO CARRIERI.
  5337     MOVE +1                     TO CARRIERL.
  5338     MOVE PI-GROUPING            TO GROUPI.
  5339     MOVE +6                     TO GROUPL.
  5340     MOVE PI-STATE               TO STATEI.
  5341     MOVE +2                     TO STATEL.
  5342     MOVE PI-ACCOUNT             TO ACCTI.
  5343     MOVE +10                    TO ACCTL.
  5344
  5345     IF  PI-CERT-EFF-DT NOT EQUAL LOW-VALUES
  5346             AND
  5347         PI-CERT-EFF-DT NOT EQUAL SPACES
  5348         MOVE PI-CERT-EFF-DT     TO DC-BIN-DATE-1
  5349         MOVE ' '                TO DC-OPTION-CODE
  5350         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  5351
  5352         IF  DC-ERROR-CODE EQUAL SPACES
  5353             MOVE DC-GREG-DATE-1-EDIT
  5354                                 TO EFFDTEI
  5355             MOVE +8             TO EFFDTEL.
  5356
  5357     MOVE '1'                    TO EIBAID.
  5358
  5359     PERFORM 0500-EDIT-SCREEN-DATA THRU 0500-EXIT.
  5360     MOVE ER-7397                TO EMI-ERROR.
  5361     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5362     GO TO 3000-PAGE-BACKWARD.
  5363*    GO TO 2000-PAGE-FORWARD.
  5364
  5365 1200-EXIT.
  5366     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 105
* EL690.cbl
  5368 1220-COMING-FROM-EL6311.
  5369
  5370     MOVE 1                      TO TYPEBRI.
  5371     MOVE +1                     TO TYPEBRL.
  5372*    MOVE PI-689-ENTRY-BATCH     TO ENTRYI.
  5373*    MOVE +6                     TO ENTRYL.
  5374     MOVE PI-689-CERT-PRIME      TO CERTRPI.
  5375     MOVE +10                    TO CERTRPL.
  5376     MOVE PI-689-CERT-SFX        TO SUFFIXI.
  5377     MOVE +1                     TO SUFFIXL.
  5378     MOVE PI-689-CARRIER         TO CARRIERI.
  5379     MOVE +1                     TO CARRIERL.
  5380     MOVE PI-689-GROUPING        TO GROUPI.
  5381     MOVE +6                     TO GROUPL.
  5382     MOVE PI-689-STATE           TO STATEI.
  5383     MOVE +2                     TO STATEL.
  5384     MOVE PI-689-ACCOUNT         TO ACCTI.
  5385     MOVE +10                    TO ACCTL.
  5386
  5387     IF  PI-689-EFF-DATE GREATER THAN LOW-VALUES
  5388         MOVE PI-689-EFF-DATE    TO DC-BIN-DATE-1
  5389         MOVE ' '                TO DC-OPTION-CODE
  5390         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  5391
  5392         IF  DC-ERROR-CODE EQUAL SPACES
  5393             MOVE DC-GREG-DATE-1-EDIT
  5394                                 TO EFFDTEI
  5395             MOVE +8             TO EFFDTEL
  5396
  5397         ELSE
  5398             MOVE LOW-VALUES     TO EFFDTEI
  5399             MOVE +8             TO EFFDTEL
  5400
  5401     ELSE
  5402         MOVE LOW-VALUES         TO EFFDTEI
  5403         MOVE +8                 TO EFFDTEL.
  5404
  5405     MOVE '1'                    TO EIBAID.
  5406
  5407     PERFORM 0500-EDIT-SCREEN-DATA THRU 0500-EXIT.
  5408     MOVE ER-7397                TO EMI-ERROR.
  5409     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5410     GO TO 3000-PAGE-BACKWARD.
  5411*    GO TO 2000-PAGE-FORWARD.
  5412
  5413 1220-EXIT.
  5414     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 106
* EL690.cbl
  5416 1240-COMING-FROM-EL652.
  5417
  5418     MOVE 1                      TO TYPEBRI.
  5419     MOVE +1                     TO TYPEBRL.
  5420     MOVE PI-CR-FIN-RESP         TO CERTRPI.
  5421     MOVE +10                    TO CERTRPL.
  5422     MOVE PI-CR-TYPE             TO SUFFIXI.
  5423     MOVE +1                     TO SUFFIXL.
  5424     MOVE PI-CR-CARRIER          TO CARRIERI.
  5425     MOVE +1                     TO CARRIERL.
  5426     MOVE PI-CR-GROUPING         TO GROUPI.
  5427     MOVE +6                     TO GROUPL.
  5428     MOVE PI-CR-ACCOUNT          TO ACCTI.
  5429     MOVE +10                    TO ACCTL.
  5430
  5431     MOVE AL-UANON               TO CARRIERA
  5432                                    GROUPA
  5433                                    ACCTA
  5434                                    TYPEBRA
  5435                                    CERTRPA.
  5436
  5437     PERFORM 0500-EDIT-SCREEN-DATA THRU 0500-EXIT.
  5438     MOVE ER-7397                TO EMI-ERROR.
  5439     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5440     GO TO 3000-PAGE-BACKWARD.
  5441*    GO TO 2000-PAGE-FORWARD.
  5442
  5443 1240-EXIT.
  5444     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 107
* EL690.cbl
  5446 1500-SELECT-ARCHIVE-REC.
  5447
  5448     MOVE ZEROS                  TO PI-689-ARCHIVE-NUMBER.
  5449
  5450     IF  CORRSELL GREATER THAN +0
  5451
  5452
  5453* EXEC CICS BIF DEEDIT
  5454*            FIELD   (CORRSELI)
  5455*            LENGTH  (2)
  5456*            END-EXEC
  5457     MOVE 2
  5458       TO DFHEIV11
  5459*    MOVE '@"L                   #   #00005392' TO DFHEIV0
  5460     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5461     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5462     MOVE X'2020233030303035333932' TO DFHEIV0(25:11)
  5463     CALL 'kxdfhei1' USING DFHEIV0,
  5464           CORRSELI,
  5465           DFHEIV11
  5466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5467
  5468         IF  CORRSELI NUMERIC
  5469
  5470             IF  CORRSELI NOT LESS THAN 01
  5471                     AND
  5472                 CORRSELI NOT GREATER THAN 12
  5473                 MOVE CORRSELI   TO W-ARCH-NDX
  5474
  5475                 IF  PI-690-ARCHIVE-NUM (W-ARCH-NDX)
  5476                          NOT EQUAL ZEROS
  5477                     MOVE PI-690-ARCHIVE-NUM (W-ARCH-NDX)
  5478                                 TO PI-689-ARCHIVE-NUMBER
  5479                     GO TO 1500-EXIT
  5480
  5481                 ELSE
  5482                     MOVE ER-9293
  5483                                 TO EMI-ERROR
  5484                     MOVE -1     TO CORRSELL
  5485                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5486                     GO TO 8200-SEND-DATAONLY
  5487
  5488         ELSE
  5489             MOVE ER-9293        TO EMI-ERROR
  5490             MOVE -1             TO CORRSELL
  5491             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5492             GO TO 8200-SEND-DATAONLY.
  5493
  5494 1500-EXIT.
  5495     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 108
* EL690.cbl
  5497 2000-PAGE-FORWARD.
  5498
  5499     MOVE '1'                    TO PI-690-LAST-BROWSE-IND.
  5500     MOVE +1                     TO W-ARCH-NDX.
  5501     MOVE ZEROS                  TO W-ARCH-NUMBER.
  5502
  5503     GO TO 2100-ARCH2-PROCESS
  5504           2200-ARCH3-PROCESS
  5505           2300-ARCH4-PROCESS
  5506           2400-ARCH5-PROCESS
  5507           2500-ARCH6-PROCESS
  5508           2600-ARCH-PROCESS DEPENDING ON PI-690-BRWS-TYPE-IND.
  5509
  5510     MOVE ER-7384                TO EMI-ERROR.
  5511     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5512     MOVE -1                     TO TYPEBRL.
  5513     MOVE AL-UABON               TO TYPEBRA.
  5514     GO TO 8100-SEND-INITIAL-MAP.
  5515
  5516 2000-EXIT.
  5517     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 109
* EL690.cbl
  5519 2100-ARCH2-PROCESS.
  5520
  5521     IF  W-CHANGE-REQUESTED
  5522         MOVE LOW-VALUES         TO W-ARCH2-KEY
  5523         MOVE PI-COMPANY-CD      TO W-ARCH2-COMPANY-CD
  5524         MOVE PI-690-INIT-CERT-PRIME
  5525                                 TO W-ARCH2-CERT-PRIME
  5526         MOVE PI-690-INIT-SUFFIX TO W-ARCH2-SUFFIX
  5527         MOVE PI-690-INIT-CARRIER
  5528                                 TO W-ARCH2-CARRIER
  5529         MOVE PI-690-INIT-GROUPING
  5530                                 TO W-ARCH2-GROUPING
  5531         MOVE PI-690-INIT-STATE  TO W-ARCH2-STATE
  5532         MOVE PI-690-INIT-ACCOUNT
  5533                                 TO W-ARCH2-ACCOUNT
  5534         MOVE PI-690-INIT-EFFECT-DATE
  5535                                 TO W-ARCH2-EFF-DTE
  5536         MOVE PI-690-INIT-ARCHIVE-NO
  5537                                 TO W-ARCH2-ARCHIVE-NO
  5538
  5539     ELSE
  5540         IF  W-FIRST-CHANGE-FOUND
  5541             MOVE LOW-VALUES     TO W-ARCH2-KEY
  5542             MOVE PI-COMPANY-CD  TO W-ARCH2-COMPANY-CD
  5543             MOVE PI-690-FIRST-CERT-PRIME
  5544                                 TO W-ARCH2-CERT-PRIME
  5545             MOVE PI-690-FIRST-SUFFIX
  5546                                 TO W-ARCH2-SUFFIX
  5547             MOVE PI-690-FIRST-CARRIER
  5548                                 TO W-ARCH2-CARRIER
  5549             MOVE PI-690-FIRST-GROUPING
  5550                                 TO W-ARCH2-GROUPING
  5551             MOVE PI-690-FIRST-STATE
  5552                                 TO W-ARCH2-STATE
  5553             MOVE PI-690-FIRST-ACCOUNT
  5554                                 TO W-ARCH2-ACCOUNT
  5555             MOVE PI-690-FIRST-EFFECT-DATE
  5556                                 TO W-ARCH2-EFF-DTE
  5557             MOVE PI-690-FIRST-ARCHIVE-NO
  5558                                 TO W-ARCH2-ARCHIVE-NO
  5559
  5560         ELSE
  5561             MOVE LOW-VALUES     TO W-ARCH2-KEY
  5562             MOVE PI-COMPANY-CD  TO W-ARCH2-COMPANY-CD
  5563             MOVE PI-690-LAST-CERT-PRIME
  5564                                 TO W-ARCH2-CERT-PRIME
  5565             MOVE PI-690-LAST-SUFFIX
  5566                                 TO W-ARCH2-SUFFIX
  5567             MOVE PI-690-LAST-CARRIER
  5568                                 TO W-ARCH2-CARRIER
  5569             MOVE PI-690-LAST-GROUPING
  5570                                 TO W-ARCH2-GROUPING
  5571             MOVE PI-690-LAST-STATE
  5572                                 TO W-ARCH2-STATE
  5573             MOVE PI-690-LAST-ACCOUNT
  5574                                 TO W-ARCH2-ACCOUNT
  5575             MOVE PI-690-LAST-EFFECT-DATE
  5576                                 TO W-ARCH2-EFF-DTE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 110
* EL690.cbl
  5577             MOVE PI-690-LAST-ARCHIVE-NO
  5578                                 TO W-ARCH2-ARCHIVE-NO.
  5579
  5580
  5581* EXEC CICS HANDLE CONDITION
  5582*        NOTFND  (8080-ARCH-NOT-FOUND)
  5583*        ENDFILE (8080-ARCH-NOT-FOUND)
  5584*        NOTOPEN (8000-ARCH2-NOT-OPEN)
  5585*        END-EXEC.
  5586*    MOVE '"$I''J                 ! % #00005509' TO DFHEIV0
  5587     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  5588     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5589     MOVE X'2520233030303035353039' TO DFHEIV0(25:11)
  5590     CALL 'kxdfhei1' USING DFHEIV0
  5591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5592
  5593
  5594
  5595* EXEC CICS STARTBR
  5596*        DATASET  (W-ARCH2-FILE-ID)
  5597*        RIDFLD   (W-ARCH2-KEY)
  5598*        GTEQ
  5599*        END-EXEC.
  5600     MOVE 0
  5601       TO DFHEIV11
  5602*    MOVE '&,         G          &   #00005515' TO DFHEIV0
  5603     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5604     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5605     MOVE X'2020233030303035353135' TO DFHEIV0(25:11)
  5606     CALL 'kxdfhei1' USING DFHEIV0,
  5607           W-ARCH2-FILE-ID,
  5608           W-ARCH2-KEY,
  5609           DFHEIV99,
  5610           DFHEIV11,
  5611           DFHEIV99
  5612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5613
  5614
  5615     PERFORM 7000-READ-ARCH2-FILE-NEXT THRU 7000-EXIT.
  5616
  5617
  5618* EXEC CICS HANDLE CONDITION
  5619*        NOTFND  (2100-END-BROWSE)
  5620*        ENDFILE (2100-END-BROWSE)
  5621*        END-EXEC.
  5622*    MOVE '"$I''                  ! & #00005523' TO DFHEIV0
  5623     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  5624     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5625     MOVE X'2620233030303035353233' TO DFHEIV0(25:11)
  5626     CALL 'kxdfhei1' USING DFHEIV0
  5627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5628
  5629
  5630 2100-BUILD-ARCH2-LIST.
  5631
  5632     IF  LA-COMPANY-CD-A2 NOT EQUAL PI-COMPANY-CD
  5633         GO TO 2100-END-BROWSE.
  5634
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 111
* EL690.cbl
  5635     IF  PI-690-INIT-CERT-NO EQUAL LOW-VALUES OR HIGH-VALUES
  5636         GO TO 2100-CONTINUE.
  5637
  5638     IF  LA-CERT-NO-A2 NOT EQUAL PI-690-INIT-CERT-NO
  5639         GO TO 2100-END-BROWSE.
  5640
  5641     IF  PI-690-INIT-CARRIER EQUAL LOW-VALUES OR HIGH-VALUES
  5642         GO TO 2100-CONTINUE.
  5643
  5644     IF  LA-CARRIER-A2 NOT EQUAL PI-690-INIT-CARRIER
  5645         GO TO 2100-END-BROWSE.
  5646
  5647     IF  PI-690-INIT-GROUPING EQUAL LOW-VALUES OR HIGH-VALUES
  5648         GO TO 2100-CONTINUE.
  5649
  5650     IF  LA-GROUPING-A2 NOT EQUAL PI-690-INIT-GROUPING
  5651         GO TO 2100-END-BROWSE.
  5652
  5653     IF  PI-690-INIT-STATE EQUAL LOW-VALUES OR HIGH-VALUES
  5654         GO TO 2100-CONTINUE.
  5655
  5656     IF  LA-STATE-A2 NOT EQUAL PI-690-INIT-STATE
  5657         GO TO 2100-END-BROWSE.
  5658
  5659     IF  PI-690-INIT-ACCOUNT EQUAL LOW-VALUES OR HIGH-VALUES
  5660         GO TO 2100-CONTINUE.
  5661
  5662     IF  LA-ACCOUNT-A2 NOT EQUAL PI-690-INIT-ACCOUNT
  5663         GO TO 2100-END-BROWSE.
  5664
  5665     IF  PI-690-INIT-EFFECT-DATE = LOW-VALUES OR HIGH-VALUES
  5666         GO TO 2100-CONTINUE.
  5667
  5668     IF  LA-EFFECT-DATE-A2 NOT EQUAL PI-690-INIT-EFFECT-DATE
  5669         GO TO 2100-END-BROWSE.
  5670
  5671 2100-CONTINUE.
  5672
  5673     IF  NOT PI-690-SELECT-ALL
  5674             AND
  5675         LA-STATUS NOT EQUAL PI-690-STATUS-SELECTION-IND
  5676         PERFORM 7000-READ-ARCH2-FILE-NEXT THRU 7000-EXIT
  5677         GO TO 2100-BUILD-ARCH2-LIST.
  5678
  5679     IF  PI-690-INIT-ENTRY NOT EQUAL LOW-VALUES
  5680                 AND
  5681         PI-690-INIT-ENTRY LESS THAN HIGH-VALUES
  5682         IF  PI-690-INIT-ENTRY NOT EQUAL LA-ENTRY-A6
  5683             PERFORM 7000-READ-ARCH2-FILE-NEXT THRU 7000-EXIT
  5684             GO TO 2100-BUILD-ARCH2-LIST.
  5685
  5686     IF  PI-690-INIT-FORM NOT EQUAL LOW-VALUES
  5687                 AND
  5688         PI-690-INIT-FORM LESS THAN HIGH-VALUES
  5689         IF  PI-690-INIT-FORM NOT EQUAL LA-FORM-A3
  5690             PERFORM 7000-READ-ARCH2-FILE-NEXT THRU 7000-EXIT
  5691             GO TO 2100-BUILD-ARCH2-LIST.
  5692
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 112
* EL690.cbl
  5693     IF  PI-690-INIT-PROCESSOR NOT EQUAL LOW-VALUES
  5694                 AND
  5695         PI-690-INIT-PROCESSOR LESS THAN HIGH-VALUES
  5696         IF  PI-690-INIT-PROCESSOR NOT EQUAL LA-PROCESSOR-CD
  5697             PERFORM 7000-READ-ARCH2-FILE-NEXT THRU 7000-EXIT
  5698             GO TO 2100-BUILD-ARCH2-LIST.
  5699
  5700     MOVE LA-ARCHIVE-NO          TO W-ARCH-NUMBER.
  5701
  5702     PERFORM 6000-SELECT-FOR-OUTPUT THRU 6000-EXIT.
  5703
  5704     IF  W-ARCH-NDX LESS THAN +13
  5705         PERFORM 7000-READ-ARCH2-FILE-NEXT THRU 7000-EXIT
  5706         GO TO 2100-BUILD-ARCH2-LIST.
  5707
  5708 2100-END.
  5709
  5710     MOVE -1                     TO CORRSELL.
  5711     MOVE ZEROS                  TO CORRSELO.
  5712     PERFORM 2100-END-BROWSE.
  5713     GO TO 8100-SEND-INITIAL-MAP.
  5714
  5715 2100-END-BROWSE.
  5716
  5717
  5718* EXEC CICS ENDBR
  5719*        DATASET (W-ARCH2-FILE-ID)
  5720*    END-EXEC.
  5721     MOVE 0
  5722       TO DFHEIV11
  5723*    MOVE '&2                    $   #00005615' TO DFHEIV0
  5724     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5725     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5726     MOVE X'2020233030303035363135' TO DFHEIV0(25:11)
  5727     CALL 'kxdfhei1' USING DFHEIV0,
  5728           W-ARCH2-FILE-ID,
  5729           DFHEIV11,
  5730           DFHEIV99
  5731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5732
  5733
  5734 2100-NOT-FOUND.
  5735
  5736     MOVE ER-0130                TO EMI-ERROR.
  5737     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5738     MOVE -1                     TO CORRSELL.
  5739     MOVE ZEROS                  TO CORRSELO.
  5740     GO TO 8100-SEND-INITIAL-MAP.
  5741
  5742 2100-EXIT.
  5743     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 113
* EL690.cbl
  5745 2200-ARCH3-PROCESS.
  5746
  5747     IF  W-CHANGE-REQUESTED
  5748         MOVE LOW-VALUES         TO W-ARCH3-KEY
  5749         MOVE PI-COMPANY-CD      TO W-ARCH3-COMPANY-CD
  5750         MOVE PI-690-INIT-FORM   TO W-ARCH3-FORM
  5751         MOVE PI-690-INIT-CARRIER
  5752                                 TO W-ARCH3-CARRIER
  5753         MOVE PI-690-INIT-GROUPING
  5754                                 TO W-ARCH3-GROUPING
  5755         MOVE PI-690-INIT-STATE  TO W-ARCH3-STATE
  5756         MOVE PI-690-INIT-ACCOUNT
  5757                                 TO W-ARCH3-ACCOUNT
  5758         MOVE PI-690-INIT-ARCHIVE-NO
  5759                                 TO W-ARCH3-ARCHIVE-NO
  5760
  5761     ELSE
  5762         IF  W-FIRST-CHANGE-FOUND
  5763             MOVE LOW-VALUES     TO W-ARCH3-KEY
  5764             MOVE PI-COMPANY-CD  TO W-ARCH3-COMPANY-CD
  5765             MOVE PI-690-FIRST-FORM
  5766                                 TO W-ARCH3-FORM
  5767             MOVE PI-690-FIRST-CARRIER
  5768                                 TO W-ARCH3-CARRIER
  5769             MOVE PI-690-FIRST-GROUPING
  5770                                 TO W-ARCH3-GROUPING
  5771             MOVE PI-690-FIRST-STATE
  5772                                 TO W-ARCH3-STATE
  5773             MOVE PI-690-FIRST-ACCOUNT
  5774                                 TO W-ARCH3-ACCOUNT
  5775             MOVE PI-690-FIRST-ARCHIVE-NO
  5776                                 TO W-ARCH3-ARCHIVE-NO
  5777
  5778         ELSE
  5779             MOVE LOW-VALUES     TO W-ARCH3-KEY
  5780             MOVE PI-COMPANY-CD  TO W-ARCH3-COMPANY-CD
  5781             MOVE PI-690-LAST-FORM
  5782                                 TO W-ARCH3-FORM
  5783             MOVE PI-690-LAST-CARRIER
  5784                                 TO W-ARCH3-CARRIER
  5785             MOVE PI-690-LAST-GROUPING
  5786                                 TO W-ARCH3-GROUPING
  5787             MOVE PI-690-LAST-STATE
  5788                                 TO W-ARCH3-STATE
  5789             MOVE PI-690-LAST-ACCOUNT
  5790                                 TO W-ARCH3-ACCOUNT
  5791             MOVE PI-690-LAST-ARCHIVE-NO
  5792                                 TO W-ARCH3-ARCHIVE-NO.
  5793
  5794
  5795* EXEC CICS HANDLE CONDITION
  5796*        NOTFND  (8080-ARCH-NOT-FOUND)
  5797*        ENDFILE (8080-ARCH-NOT-FOUND)
  5798*        NOTOPEN (8010-ARCH3-NOT-OPEN)
  5799*        END-EXEC.
  5800*    MOVE '"$I''J                 ! '' #00005679' TO DFHEIV0
  5801     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  5802     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 114
* EL690.cbl
  5803     MOVE X'2720233030303035363739' TO DFHEIV0(25:11)
  5804     CALL 'kxdfhei1' USING DFHEIV0
  5805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5806
  5807
  5808
  5809* EXEC CICS STARTBR
  5810*        DATASET  (W-ARCH3-FILE-ID)
  5811*        RIDFLD   (W-ARCH3-KEY)
  5812*        GTEQ
  5813*    END-EXEC.
  5814     MOVE 0
  5815       TO DFHEIV11
  5816*    MOVE '&,         G          &   #00005685' TO DFHEIV0
  5817     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5818     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5819     MOVE X'2020233030303035363835' TO DFHEIV0(25:11)
  5820     CALL 'kxdfhei1' USING DFHEIV0,
  5821           W-ARCH3-FILE-ID,
  5822           W-ARCH3-KEY,
  5823           DFHEIV99,
  5824           DFHEIV11,
  5825           DFHEIV99
  5826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5827
  5828
  5829     PERFORM 7100-READ-ARCH3-FILE-NEXT THRU 7100-EXIT.
  5830
  5831
  5832* EXEC CICS HANDLE CONDITION
  5833*        NOTFND  (2200-END-BROWSE)
  5834*        ENDFILE (2200-END-BROWSE)
  5835*        END-EXEC.
  5836*    MOVE '"$I''                  ! ( #00005693' TO DFHEIV0
  5837     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  5838     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5839     MOVE X'2820233030303035363933' TO DFHEIV0(25:11)
  5840     CALL 'kxdfhei1' USING DFHEIV0
  5841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5842
  5843
  5844 2200-BUILD-ARCH3-LIST.
  5845
  5846     IF  LA-COMPANY-CD-A3 NOT EQUAL PI-COMPANY-CD
  5847         GO TO 2200-END-BROWSE.
  5848
  5849     IF  PI-690-INIT-FORM EQUAL LOW-VALUES OR HIGH-VALUES
  5850         GO TO 2200-CONTINUE.
  5851
  5852     IF  LA-FORM-A3 NOT EQUAL PI-690-INIT-FORM
  5853         GO TO 2200-END-BROWSE.
  5854
  5855     IF  PI-690-INIT-CARRIER EQUAL LOW-VALUES OR HIGH-VALUES
  5856         GO TO 2200-CONTINUE.
  5857
  5858     IF  LA-CARRIER-A3 NOT EQUAL PI-690-INIT-CARRIER
  5859         GO TO 2200-END-BROWSE.
  5860
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 115
* EL690.cbl
  5861     IF  PI-690-INIT-GROUPING EQUAL LOW-VALUES OR HIGH-VALUES
  5862         GO TO 2200-CONTINUE.
  5863
  5864     IF  LA-GROUPING-A3 NOT EQUAL PI-690-INIT-GROUPING
  5865         GO TO 2200-END-BROWSE.
  5866
  5867     IF  PI-690-INIT-STATE EQUAL LOW-VALUES OR HIGH-VALUES
  5868         GO TO 2200-CONTINUE.
  5869
  5870     IF  LA-STATE-A3 NOT EQUAL PI-690-INIT-STATE
  5871         GO TO 2200-END-BROWSE.
  5872
  5873     IF  PI-690-INIT-ACCOUNT EQUAL LOW-VALUES OR HIGH-VALUES
  5874         GO TO 2200-CONTINUE.
  5875
  5876     IF  LA-ACCOUNT-A3 NOT EQUAL PI-690-INIT-ACCOUNT
  5877         GO TO 2200-END-BROWSE.
  5878
  5879 2200-CONTINUE.
  5880
  5881     IF  NOT PI-690-SELECT-ALL
  5882             AND
  5883         LA-STATUS NOT EQUAL PI-690-STATUS-SELECTION-IND
  5884         PERFORM 7100-READ-ARCH3-FILE-NEXT THRU 7100-EXIT
  5885         GO TO 2200-BUILD-ARCH3-LIST.
  5886
  5887     IF  PI-690-INIT-ENTRY NOT EQUAL LOW-VALUES
  5888                 AND
  5889         PI-690-INIT-ENTRY LESS THAN HIGH-VALUES
  5890         IF  PI-690-INIT-ENTRY NOT EQUAL LA-ENTRY-A6
  5891             PERFORM 7100-READ-ARCH3-FILE-NEXT THRU 7100-EXIT
  5892             GO TO 2200-BUILD-ARCH3-LIST.
  5893
  5894     IF  PI-690-INIT-PROCESSOR NOT EQUAL LOW-VALUES
  5895                 AND
  5896         PI-690-INIT-PROCESSOR LESS THAN HIGH-VALUES
  5897         IF  PI-690-INIT-PROCESSOR NOT EQUAL LA-PROCESSOR-CD
  5898             PERFORM 7100-READ-ARCH3-FILE-NEXT THRU 7100-EXIT
  5899             GO TO 2200-BUILD-ARCH3-LIST.
  5900
  5901     MOVE LA-ARCHIVE-NO          TO W-ARCH-NUMBER.
  5902
  5903     PERFORM 6000-SELECT-FOR-OUTPUT THRU 6000-EXIT.
  5904
  5905     IF  W-ARCH-NDX LESS THAN +13
  5906         PERFORM 7100-READ-ARCH3-FILE-NEXT THRU 7100-EXIT
  5907         GO TO 2200-BUILD-ARCH3-LIST.
  5908
  5909 2200-END.
  5910
  5911     MOVE -1                     TO CORRSELL.
  5912     MOVE ZEROS                  TO CORRSELO.
  5913     PERFORM 2200-END-BROWSE.
  5914     GO TO 8100-SEND-INITIAL-MAP.
  5915
  5916 2200-END-BROWSE.
  5917
  5918
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 116
* EL690.cbl
  5919* EXEC CICS ENDBR
  5920*        DATASET (W-ARCH3-FILE-ID)
  5921*    END-EXEC.
  5922     MOVE 0
  5923       TO DFHEIV11
  5924*    MOVE '&2                    $   #00005772' TO DFHEIV0
  5925     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5926     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5927     MOVE X'2020233030303035373732' TO DFHEIV0(25:11)
  5928     CALL 'kxdfhei1' USING DFHEIV0,
  5929           W-ARCH3-FILE-ID,
  5930           DFHEIV11,
  5931           DFHEIV99
  5932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5933
  5934
  5935 2200-ARCH3-NOT-FOUND.
  5936
  5937     MOVE ER-0130                TO EMI-ERROR.
  5938     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5939     MOVE -1                     TO CORRSELL.
  5940     MOVE ZEROS                  TO CORRSELO.
  5941     GO TO 8100-SEND-INITIAL-MAP.
  5942
  5943 2200-EXIT.
  5944     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 117
* EL690.cbl
  5946 2300-ARCH4-PROCESS.
  5947
  5948     IF  W-CHANGE-REQUESTED
  5949         MOVE LOW-VALUES         TO W-ARCH4-KEY
  5950         MOVE PI-COMPANY-CD      TO W-ARCH4-COMPANY-CD
  5951         MOVE PI-690-INIT-PROCESSOR
  5952                                 TO W-ARCH4-PROCESSOR
  5953         MOVE PI-690-INIT-CARRIER
  5954                                 TO W-ARCH4-CARRIER
  5955         MOVE PI-690-INIT-GROUPING
  5956                                 TO W-ARCH4-GROUPING
  5957         MOVE PI-690-INIT-STATE  TO W-ARCH4-STATE
  5958         MOVE PI-690-INIT-ACCOUNT
  5959                                 TO W-ARCH4-ACCOUNT
  5960         MOVE PI-690-INIT-ARCHIVE-NO
  5961                                 TO W-ARCH4-ARCHIVE-NO
  5962
  5963     ELSE
  5964         IF  W-FIRST-CHANGE-FOUND
  5965             MOVE LOW-VALUES     TO W-ARCH4-KEY
  5966             MOVE PI-COMPANY-CD  TO W-ARCH4-COMPANY-CD
  5967             MOVE PI-690-FIRST-PROCESSOR
  5968                                 TO W-ARCH4-PROCESSOR
  5969             MOVE PI-690-FIRST-CARRIER
  5970                                 TO W-ARCH4-CARRIER
  5971             MOVE PI-690-FIRST-GROUPING
  5972                                 TO W-ARCH4-GROUPING
  5973             MOVE PI-690-FIRST-STATE
  5974                                 TO W-ARCH4-STATE
  5975             MOVE PI-690-FIRST-ACCOUNT
  5976                                 TO W-ARCH4-ACCOUNT
  5977             MOVE PI-690-FIRST-ARCHIVE-NO
  5978                                 TO W-ARCH4-ARCHIVE-NO
  5979
  5980         ELSE
  5981             MOVE LOW-VALUES     TO W-ARCH4-KEY
  5982             MOVE PI-COMPANY-CD  TO W-ARCH4-COMPANY-CD
  5983             MOVE PI-690-LAST-PROCESSOR
  5984                                 TO W-ARCH4-PROCESSOR
  5985             MOVE PI-690-LAST-CARRIER
  5986                                 TO W-ARCH4-CARRIER
  5987             MOVE PI-690-LAST-GROUPING
  5988                                 TO W-ARCH4-GROUPING
  5989             MOVE PI-690-LAST-STATE
  5990                                 TO W-ARCH4-STATE
  5991             MOVE PI-690-LAST-ACCOUNT
  5992                                 TO W-ARCH4-ACCOUNT
  5993             MOVE PI-690-LAST-ARCHIVE-NO
  5994                                 TO W-ARCH4-ARCHIVE-NO.
  5995
  5996
  5997* EXEC CICS HANDLE CONDITION
  5998*        NOTFND  (8080-ARCH-NOT-FOUND)
  5999*        ENDFILE (8080-ARCH-NOT-FOUND)
  6000*        NOTOPEN (8020-ARCH4-NOT-OPEN)
  6001*        END-EXEC.
  6002*    MOVE '"$I''J                 ! ) #00005837' TO DFHEIV0
  6003     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 118
* EL690.cbl
  6004     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6005     MOVE X'2920233030303035383337' TO DFHEIV0(25:11)
  6006     CALL 'kxdfhei1' USING DFHEIV0
  6007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6008
  6009
  6010
  6011* EXEC CICS STARTBR
  6012*        DATASET  (W-ARCH4-FILE-ID)
  6013*        RIDFLD   (W-ARCH4-KEY)
  6014*        GTEQ
  6015*    END-EXEC.
  6016     MOVE 0
  6017       TO DFHEIV11
  6018*    MOVE '&,         G          &   #00005843' TO DFHEIV0
  6019     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6020     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6021     MOVE X'2020233030303035383433' TO DFHEIV0(25:11)
  6022     CALL 'kxdfhei1' USING DFHEIV0,
  6023           W-ARCH4-FILE-ID,
  6024           W-ARCH4-KEY,
  6025           DFHEIV99,
  6026           DFHEIV11,
  6027           DFHEIV99
  6028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6029
  6030
  6031     PERFORM 7200-READ-ARCH4-FILE-NEXT THRU 7200-EXIT.
  6032
  6033
  6034* EXEC CICS HANDLE CONDITION
  6035*        NOTFND  (2300-END-BROWSE)
  6036*        ENDFILE (2300-END-BROWSE)
  6037*        END-EXEC.
  6038*    MOVE '"$I''                  ! * #00005851' TO DFHEIV0
  6039     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6040     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6041     MOVE X'2A20233030303035383531' TO DFHEIV0(25:11)
  6042     CALL 'kxdfhei1' USING DFHEIV0
  6043     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6044
  6045
  6046 2300-BUILD-ARCH4-LIST.
  6047
  6048     IF  LA-COMPANY-CD-A4 NOT EQUAL PI-COMPANY-CD
  6049         GO TO 2300-END-BROWSE.
  6050
  6051     IF  PI-690-INIT-PROCESSOR EQUAL LOW-VALUES OR HIGH-VALUES
  6052         GO TO 2300-CONTINUE.
  6053
  6054     IF  LA-PROCESSOR-CD NOT EQUAL PI-690-INIT-PROCESSOR
  6055         GO TO 2300-END-BROWSE.
  6056
  6057     IF  PI-690-INIT-CARRIER EQUAL LOW-VALUES OR HIGH-VALUES
  6058         GO TO 2300-CONTINUE.
  6059
  6060     IF  LA-CARRIER-A4 NOT EQUAL PI-690-INIT-CARRIER
  6061         GO TO 2300-END-BROWSE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 119
* EL690.cbl
  6062
  6063     IF  PI-690-INIT-GROUPING EQUAL LOW-VALUES OR HIGH-VALUES
  6064         GO TO 2300-CONTINUE.
  6065
  6066     IF  LA-GROUPING-A4 NOT EQUAL PI-690-INIT-GROUPING
  6067         GO TO 2300-END-BROWSE.
  6068
  6069     IF  PI-690-INIT-STATE EQUAL LOW-VALUES OR HIGH-VALUES
  6070         GO TO 2300-CONTINUE.
  6071
  6072     IF  LA-STATE-A4 NOT EQUAL PI-690-INIT-STATE
  6073         GO TO 2300-END-BROWSE.
  6074
  6075     IF  PI-690-INIT-ACCOUNT EQUAL LOW-VALUES OR HIGH-VALUES
  6076         GO TO 2300-CONTINUE.
  6077
  6078     IF  LA-ACCOUNT-A4 NOT EQUAL PI-690-INIT-ACCOUNT
  6079         GO TO 2300-END-BROWSE.
  6080
  6081 2300-CONTINUE.
  6082
  6083     IF  NOT PI-690-SELECT-ALL
  6084             AND
  6085         LA-STATUS NOT EQUAL PI-690-STATUS-SELECTION-IND
  6086         PERFORM 7200-READ-ARCH4-FILE-NEXT THRU 7200-EXIT
  6087         GO TO 2300-BUILD-ARCH4-LIST.
  6088
  6089     IF  PI-690-INIT-ENTRY NOT EQUAL LOW-VALUES
  6090                 AND
  6091         PI-690-INIT-ENTRY LESS THAN HIGH-VALUES
  6092         IF  PI-690-INIT-ENTRY NOT EQUAL LA-ENTRY-A6
  6093             PERFORM 7200-READ-ARCH4-FILE-NEXT THRU 7200-EXIT
  6094             GO TO 2300-BUILD-ARCH4-LIST.
  6095
  6096     IF  PI-690-INIT-FORM NOT EQUAL LOW-VALUES
  6097                 AND
  6098         PI-690-INIT-FORM LESS THAN HIGH-VALUES
  6099         IF  PI-690-INIT-FORM NOT EQUAL LA-FORM-A3
  6100             PERFORM 7200-READ-ARCH4-FILE-NEXT THRU 7200-EXIT
  6101             GO TO 2300-BUILD-ARCH4-LIST.
  6102
  6103     MOVE LA-ARCHIVE-NO          TO W-ARCH-NUMBER.
  6104
  6105     PERFORM 6000-SELECT-FOR-OUTPUT THRU 6000-EXIT.
  6106
  6107     IF  W-ARCH-NDX LESS THAN +13
  6108         PERFORM 7200-READ-ARCH4-FILE-NEXT THRU 7200-EXIT
  6109         GO TO 2300-BUILD-ARCH4-LIST.
  6110
  6111 2300-END.
  6112
  6113     MOVE -1                     TO CORRSELL.
  6114     MOVE ZEROS                  TO CORRSELO.
  6115     PERFORM 2300-END-BROWSE.
  6116     GO TO 8100-SEND-INITIAL-MAP.
  6117
  6118 2300-END-BROWSE.
  6119
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 120
* EL690.cbl
  6120
  6121* EXEC CICS ENDBR
  6122*        DATASET (W-ARCH4-FILE-ID)
  6123*    END-EXEC.
  6124     MOVE 0
  6125       TO DFHEIV11
  6126*    MOVE '&2                    $   #00005930' TO DFHEIV0
  6127     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6128     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6129     MOVE X'2020233030303035393330' TO DFHEIV0(25:11)
  6130     CALL 'kxdfhei1' USING DFHEIV0,
  6131           W-ARCH4-FILE-ID,
  6132           DFHEIV11,
  6133           DFHEIV99
  6134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6135
  6136
  6137 2300-ARCH4-NOT-FOUND.
  6138
  6139     MOVE ER-0130                TO EMI-ERROR.
  6140     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6141     MOVE -1                     TO CORRSELL.
  6142     MOVE ZEROS                  TO CORRSELO.
  6143     GO TO 8100-SEND-INITIAL-MAP.
  6144
  6145 2300-EXIT.
  6146     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 121
* EL690.cbl
  6148 2400-ARCH5-PROCESS.
  6149
  6150     IF  W-CHANGE-REQUESTED
  6151         MOVE LOW-VALUES         TO W-ARCH5-KEY
  6152         MOVE PI-COMPANY-CD      TO W-ARCH5-COMPANY-CD
  6153         MOVE PI-690-INIT-CARRIER
  6154                                 TO W-ARCH5-CARRIER
  6155         MOVE PI-690-INIT-GROUPING
  6156                                 TO W-ARCH5-GROUPING
  6157         MOVE PI-690-INIT-STATE  TO W-ARCH5-STATE
  6158         MOVE PI-690-INIT-ACCOUNT
  6159                                 TO W-ARCH5-ACCOUNT
  6160         MOVE PI-690-INIT-ARCHIVE-NO
  6161                                 TO W-ARCH5-ARCHIVE-NO
  6162
  6163     ELSE
  6164         IF  W-FIRST-CHANGE-FOUND
  6165             MOVE LOW-VALUES     TO W-ARCH5-KEY
  6166             MOVE PI-COMPANY-CD  TO W-ARCH5-COMPANY-CD
  6167             MOVE PI-690-FIRST-CARRIER
  6168                                 TO W-ARCH5-CARRIER
  6169             MOVE PI-690-FIRST-GROUPING
  6170                                 TO W-ARCH5-GROUPING
  6171             MOVE PI-690-FIRST-STATE
  6172                                 TO W-ARCH5-STATE
  6173             MOVE PI-690-FIRST-ACCOUNT
  6174                                 TO W-ARCH5-ACCOUNT
  6175             MOVE PI-690-FIRST-ARCHIVE-NO
  6176                                 TO W-ARCH5-ARCHIVE-NO
  6177
  6178         ELSE
  6179             MOVE LOW-VALUES     TO W-ARCH5-KEY
  6180             MOVE PI-COMPANY-CD  TO W-ARCH5-COMPANY-CD
  6181             MOVE PI-690-LAST-CARRIER
  6182                                 TO W-ARCH5-CARRIER
  6183             MOVE PI-690-LAST-GROUPING
  6184                                 TO W-ARCH5-GROUPING
  6185             MOVE PI-690-LAST-STATE
  6186                                 TO W-ARCH5-STATE
  6187             MOVE PI-690-LAST-ACCOUNT
  6188                                 TO W-ARCH5-ACCOUNT
  6189             MOVE PI-690-LAST-ARCHIVE-NO
  6190                                 TO W-ARCH5-ARCHIVE-NO.
  6191
  6192
  6193* EXEC CICS HANDLE CONDITION
  6194*        NOTFND  (8080-ARCH-NOT-FOUND)
  6195*        ENDFILE (8080-ARCH-NOT-FOUND)
  6196*        NOTOPEN (8030-ARCH5-NOT-OPEN)
  6197*        END-EXEC.
  6198*    MOVE '"$I''J                 ! + #00005989' TO DFHEIV0
  6199     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  6200     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6201     MOVE X'2B20233030303035393839' TO DFHEIV0(25:11)
  6202     CALL 'kxdfhei1' USING DFHEIV0
  6203     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6204
  6205
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 122
* EL690.cbl
  6206
  6207* EXEC CICS STARTBR
  6208*        DATASET  (W-ARCH5-FILE-ID)
  6209*        RIDFLD   (W-ARCH5-KEY)
  6210*        GTEQ
  6211*    END-EXEC.
  6212     MOVE 0
  6213       TO DFHEIV11
  6214*    MOVE '&,         G          &   #00005995' TO DFHEIV0
  6215     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6216     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6217     MOVE X'2020233030303035393935' TO DFHEIV0(25:11)
  6218     CALL 'kxdfhei1' USING DFHEIV0,
  6219           W-ARCH5-FILE-ID,
  6220           W-ARCH5-KEY,
  6221           DFHEIV99,
  6222           DFHEIV11,
  6223           DFHEIV99
  6224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6225
  6226
  6227     PERFORM 7300-READ-ARCH5-FILE-NEXT THRU 7300-EXIT.
  6228
  6229
  6230* EXEC CICS HANDLE CONDITION
  6231*        NOTFND  (2400-END-BROWSE)
  6232*        ENDFILE (2400-END-BROWSE)
  6233*        END-EXEC.
  6234*    MOVE '"$I''                  ! , #00006003' TO DFHEIV0
  6235     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6236     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6237     MOVE X'2C20233030303036303033' TO DFHEIV0(25:11)
  6238     CALL 'kxdfhei1' USING DFHEIV0
  6239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6240
  6241
  6242 2400-BUILD-ARCH5-LIST.
  6243
  6244     IF  LA-COMPANY-CD-A5 NOT EQUAL PI-COMPANY-CD
  6245         GO TO 2400-END-BROWSE.
  6246
  6247     IF  PI-690-INIT-CARRIER EQUAL LOW-VALUES OR HIGH-VALUES
  6248         GO TO 2400-CONTINUE.
  6249
  6250     IF  LA-CARRIER-A5 NOT EQUAL PI-690-INIT-CARRIER
  6251         GO TO 2400-END-BROWSE.
  6252
  6253     IF  PI-690-INIT-GROUPING EQUAL LOW-VALUES OR HIGH-VALUES
  6254         GO TO 2400-CONTINUE.
  6255
  6256     IF  LA-GROUPING-A5 NOT EQUAL PI-690-INIT-GROUPING
  6257         GO TO 2400-END-BROWSE.
  6258
  6259     IF  PI-690-INIT-STATE EQUAL LOW-VALUES OR HIGH-VALUES
  6260         GO TO 2400-CONTINUE.
  6261
  6262     IF  LA-STATE-A5 NOT EQUAL PI-690-INIT-STATE
  6263         GO TO 2400-END-BROWSE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 123
* EL690.cbl
  6264
  6265     IF  PI-690-INIT-ACCOUNT EQUAL LOW-VALUES OR HIGH-VALUES
  6266         GO TO 2400-CONTINUE.
  6267
  6268     IF  LA-ACCOUNT-A5 NOT EQUAL PI-690-INIT-ACCOUNT
  6269         GO TO 2400-END-BROWSE.
  6270
  6271 2400-CONTINUE.
  6272
  6273     IF  NOT PI-690-SELECT-ALL
  6274             AND
  6275         LA-STATUS NOT EQUAL PI-690-STATUS-SELECTION-IND
  6276         PERFORM 7300-READ-ARCH5-FILE-NEXT THRU 7300-EXIT
  6277         GO TO 2400-BUILD-ARCH5-LIST.
  6278
  6279     IF  PI-690-INIT-ENTRY NOT EQUAL LOW-VALUES
  6280                 AND
  6281         PI-690-INIT-ENTRY LESS THAN HIGH-VALUES
  6282         IF  PI-690-INIT-ENTRY NOT EQUAL LA-ENTRY-A6
  6283             PERFORM 7300-READ-ARCH5-FILE-NEXT THRU 7300-EXIT
  6284             GO TO 2400-BUILD-ARCH5-LIST.
  6285
  6286     IF  PI-690-INIT-FORM NOT EQUAL LOW-VALUES
  6287                 AND
  6288         PI-690-INIT-FORM LESS THAN HIGH-VALUES
  6289         IF  PI-690-INIT-FORM NOT EQUAL LA-FORM-A3
  6290             PERFORM 7300-READ-ARCH5-FILE-NEXT THRU 7300-EXIT
  6291             GO TO 2400-BUILD-ARCH5-LIST.
  6292
  6293     IF  PI-690-INIT-PROCESSOR NOT EQUAL LOW-VALUES
  6294                 AND
  6295         PI-690-INIT-PROCESSOR LESS THAN HIGH-VALUES
  6296         IF  PI-690-INIT-PROCESSOR NOT EQUAL LA-PROCESSOR-CD
  6297             PERFORM 7300-READ-ARCH5-FILE-NEXT THRU 7300-EXIT
  6298             GO TO 2400-BUILD-ARCH5-LIST.
  6299
  6300     MOVE LA-ARCHIVE-NO          TO W-ARCH-NUMBER.
  6301
  6302     PERFORM 6000-SELECT-FOR-OUTPUT THRU 6000-EXIT.
  6303
  6304     IF  W-ARCH-NDX LESS THAN +13
  6305         PERFORM 7300-READ-ARCH5-FILE-NEXT THRU 7300-EXIT
  6306         GO TO 2400-BUILD-ARCH5-LIST.
  6307
  6308 2400-END.
  6309
  6310     MOVE -1                     TO CORRSELL.
  6311     MOVE ZEROS                  TO CORRSELO.
  6312     PERFORM 2400-END-BROWSE.
  6313     GO TO 8100-SEND-INITIAL-MAP.
  6314
  6315 2400-END-BROWSE.
  6316
  6317
  6318* EXEC CICS ENDBR
  6319*        DATASET (W-ARCH5-FILE-ID)
  6320*    END-EXEC.
  6321     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 124
* EL690.cbl
  6322       TO DFHEIV11
  6323*    MOVE '&2                    $   #00006083' TO DFHEIV0
  6324     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6325     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6326     MOVE X'2020233030303036303833' TO DFHEIV0(25:11)
  6327     CALL 'kxdfhei1' USING DFHEIV0,
  6328           W-ARCH5-FILE-ID,
  6329           DFHEIV11,
  6330           DFHEIV99
  6331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6332
  6333
  6334 2400-ARCH5-NOT-FOUND.
  6335
  6336     MOVE ER-0130                TO EMI-ERROR.
  6337     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6338     MOVE -1                     TO CORRSELL.
  6339     MOVE ZEROS                  TO CORRSELO.
  6340     GO TO 8100-SEND-INITIAL-MAP.
  6341
  6342 2400-EXIT.
  6343     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 125
* EL690.cbl
  6345 2500-ARCH6-PROCESS.
  6346
  6347     IF  W-CHANGE-REQUESTED
  6348         MOVE LOW-VALUES         TO W-ARCH6-KEY
  6349         MOVE PI-COMPANY-CD      TO W-ARCH6-COMPANY-CD
  6350         MOVE PI-690-INIT-ENTRY  TO W-ARCH6-ENTRY
  6351         MOVE PI-690-INIT-ARCHIVE-NO
  6352                                 TO W-ARCH6-ARCHIVE-NO
  6353
  6354     ELSE
  6355         IF  W-FIRST-CHANGE-FOUND
  6356             MOVE LOW-VALUES     TO W-ARCH6-KEY
  6357             MOVE PI-COMPANY-CD  TO W-ARCH6-COMPANY-CD
  6358             MOVE PI-690-FIRST-ENTRY
  6359                                 TO W-ARCH6-ENTRY
  6360             MOVE PI-690-FIRST-ARCHIVE-NO
  6361                                 TO W-ARCH6-ARCHIVE-NO
  6362
  6363         ELSE
  6364             MOVE LOW-VALUES     TO W-ARCH6-KEY
  6365             MOVE PI-COMPANY-CD  TO W-ARCH6-COMPANY-CD
  6366             MOVE PI-690-LAST-ENTRY
  6367                                 TO W-ARCH6-ENTRY
  6368             MOVE PI-690-LAST-ARCHIVE-NO
  6369                                 TO W-ARCH6-ARCHIVE-NO.
  6370
  6371
  6372* EXEC CICS HANDLE CONDITION
  6373*        NOTFND  (8080-ARCH-NOT-FOUND)
  6374*        ENDFILE (8080-ARCH-NOT-FOUND)
  6375*        NOTOPEN (8040-ARCH6-NOT-OPEN)
  6376*        END-EXEC.
  6377*    MOVE '"$I''J                 ! - #00006124' TO DFHEIV0
  6378     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  6379     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6380     MOVE X'2D20233030303036313234' TO DFHEIV0(25:11)
  6381     CALL 'kxdfhei1' USING DFHEIV0
  6382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6383
  6384
  6385
  6386* EXEC CICS STARTBR
  6387*        DATASET  (W-ARCH6-FILE-ID)
  6388*        RIDFLD   (W-ARCH6-KEY)
  6389*        GTEQ
  6390*    END-EXEC.
  6391     MOVE 0
  6392       TO DFHEIV11
  6393*    MOVE '&,         G          &   #00006130' TO DFHEIV0
  6394     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6395     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6396     MOVE X'2020233030303036313330' TO DFHEIV0(25:11)
  6397     CALL 'kxdfhei1' USING DFHEIV0,
  6398           W-ARCH6-FILE-ID,
  6399           W-ARCH6-KEY,
  6400           DFHEIV99,
  6401           DFHEIV11,
  6402           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 126
* EL690.cbl
  6403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6404
  6405
  6406     PERFORM 7400-READ-ARCH6-FILE-NEXT THRU 7400-EXIT.
  6407
  6408
  6409* EXEC CICS HANDLE CONDITION
  6410*        NOTFND  (2500-END-BROWSE)
  6411*        ENDFILE (2500-END-BROWSE)
  6412*        END-EXEC.
  6413*    MOVE '"$I''                  ! . #00006138' TO DFHEIV0
  6414     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6415     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6416     MOVE X'2E20233030303036313338' TO DFHEIV0(25:11)
  6417     CALL 'kxdfhei1' USING DFHEIV0
  6418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6419
  6420
  6421 2500-BUILD-ARCH6-LIST.
  6422
  6423     IF  LA-COMPANY-CD-A6 NOT EQUAL PI-COMPANY-CD
  6424         GO TO 2500-END-BROWSE.
  6425
  6426     IF  PI-690-INIT-ENTRY EQUAL LOW-VALUES OR HIGH-VALUES
  6427         GO TO 2500-CONTINUE.
  6428
  6429     IF  LA-ENTRY-A6 NOT EQUAL PI-690-INIT-ENTRY
  6430         GO TO 2500-END-BROWSE.
  6431
  6432 2500-CONTINUE.
  6433
  6434     IF  NOT PI-690-SELECT-ALL
  6435             AND
  6436         LA-STATUS NOT EQUAL PI-690-STATUS-SELECTION-IND
  6437         PERFORM 7400-READ-ARCH6-FILE-NEXT THRU 7400-EXIT
  6438         GO TO 2500-BUILD-ARCH6-LIST.
  6439
  6440     IF  PI-690-INIT-PROCESSOR NOT EQUAL LOW-VALUES
  6441             AND
  6442         PI-690-INIT-PROCESSOR NOT EQUAL HIGH-VALUES
  6443         IF  LA-ENTRY-A6 NOT EQUAL PI-690-INIT-PROCESSOR
  6444             PERFORM 7400-READ-ARCH6-FILE-NEXT THRU 7400-EXIT
  6445             GO TO 2500-BUILD-ARCH6-LIST.
  6446
  6447     IF  PI-690-INIT-FORM NOT EQUAL LOW-VALUES
  6448             AND
  6449         PI-690-INIT-FORM NOT EQUAL HIGH-VALUES
  6450         IF  LA-FORM-A3 NOT EQUAL PI-690-INIT-FORM
  6451             PERFORM 7400-READ-ARCH6-FILE-NEXT THRU 7400-EXIT
  6452             GO TO 2500-BUILD-ARCH6-LIST.
  6453
  6454     IF  PI-690-INIT-CARRIER NOT EQUAL LOW-VALUES
  6455             AND
  6456         PI-690-INIT-CARRIER NOT EQUAL HIGH-VALUES
  6457         IF  LA-CARRIER-A2 NOT EQUAL PI-690-INIT-CARRIER
  6458             PERFORM 7400-READ-ARCH6-FILE-NEXT THRU 7400-EXIT
  6459             GO TO 2500-BUILD-ARCH6-LIST.
  6460
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 127
* EL690.cbl
  6461     IF  PI-690-INIT-GROUPING NOT EQUAL LOW-VALUES
  6462             AND
  6463         PI-690-INIT-GROUPING NOT EQUAL HIGH-VALUES
  6464         IF  LA-GROUPING-A2 NOT EQUAL PI-690-INIT-GROUPING
  6465             PERFORM 7400-READ-ARCH6-FILE-NEXT THRU 7400-EXIT
  6466             GO TO 2500-BUILD-ARCH6-LIST.
  6467
  6468     IF  PI-690-INIT-STATE NOT EQUAL LOW-VALUES
  6469             AND
  6470         PI-690-INIT-STATE NOT EQUAL HIGH-VALUES
  6471         IF  LA-STATE-A2 NOT EQUAL PI-690-INIT-STATE
  6472             PERFORM 7400-READ-ARCH6-FILE-NEXT THRU 7400-EXIT
  6473             GO TO 2500-BUILD-ARCH6-LIST.
  6474
  6475     IF  PI-690-INIT-ACCOUNT NOT EQUAL LOW-VALUES
  6476             AND
  6477         PI-690-INIT-ACCOUNT NOT EQUAL HIGH-VALUES
  6478         IF  LA-ACCOUNT-A2 NOT EQUAL PI-690-INIT-ACCOUNT
  6479             PERFORM 7400-READ-ARCH6-FILE-NEXT THRU 7400-EXIT
  6480             GO TO 2500-BUILD-ARCH6-LIST.
  6481
  6482     MOVE LA-ARCHIVE-NO          TO W-ARCH-NUMBER.
  6483
  6484     PERFORM 6000-SELECT-FOR-OUTPUT THRU 6000-EXIT.
  6485
  6486     IF  W-ARCH-NDX LESS THAN +13
  6487         PERFORM 7400-READ-ARCH6-FILE-NEXT THRU 7400-EXIT
  6488         GO TO 2500-BUILD-ARCH6-LIST.
  6489
  6490 2500-END.
  6491
  6492     MOVE -1                     TO CORRSELL.
  6493     MOVE ZEROS                  TO CORRSELO.
  6494     PERFORM 2500-END-BROWSE.
  6495     GO TO 8100-SEND-INITIAL-MAP.
  6496
  6497 2500-END-BROWSE.
  6498
  6499
  6500* EXEC CICS ENDBR
  6501*        DATASET (W-ARCH6-FILE-ID)
  6502*    END-EXEC.
  6503     MOVE 0
  6504       TO DFHEIV11
  6505*    MOVE '&2                    $   #00006221' TO DFHEIV0
  6506     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6507     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6508     MOVE X'2020233030303036323231' TO DFHEIV0(25:11)
  6509     CALL 'kxdfhei1' USING DFHEIV0,
  6510           W-ARCH6-FILE-ID,
  6511           DFHEIV11,
  6512           DFHEIV99
  6513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6514
  6515
  6516 2500-ARCH6-NOT-FOUND.
  6517
  6518     MOVE ER-0130                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 128
* EL690.cbl
  6519     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6520     MOVE -1                     TO CORRSELL.
  6521     MOVE ZEROS                  TO CORRSELO.
  6522     GO TO 8100-SEND-INITIAL-MAP.
  6523
  6524 2500-EXIT.
  6525     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 129
* EL690.cbl
  6527 2600-ARCH-PROCESS.
  6528
  6529     IF  W-CHANGE-REQUESTED
  6530         MOVE LOW-VALUES         TO W-ARCH-KEY
  6531         MOVE PI-COMPANY-CD      TO W-ARCH-COMPANY-CD
  6532         MOVE PI-690-INIT-ARCHIVE-NO
  6533                                 TO W-ARCH-ARCHIVE-NO
  6534
  6535     ELSE
  6536         IF  W-FIRST-CHANGE-FOUND
  6537             MOVE LOW-VALUES     TO W-ARCH-KEY
  6538             MOVE PI-COMPANY-CD  TO W-ARCH-COMPANY-CD
  6539             MOVE PI-690-FIRST-ARCHIVE-NO
  6540                                 TO W-ARCH-ARCHIVE-NO
  6541
  6542         ELSE
  6543             MOVE LOW-VALUES     TO W-ARCH-KEY
  6544             MOVE PI-COMPANY-CD  TO W-ARCH-COMPANY-CD
  6545             MOVE PI-690-LAST-ARCHIVE-NO
  6546                                 TO W-ARCH-ARCHIVE-NO.
  6547
  6548
  6549* EXEC CICS HANDLE CONDITION
  6550*        NOTFND  (8080-ARCH-NOT-FOUND)
  6551*        ENDFILE (8080-ARCH-NOT-FOUND)
  6552*        NOTOPEN (8050-ARCH-NOT-OPEN)
  6553*        END-EXEC.
  6554*    MOVE '"$I''J                 ! / #00006257' TO DFHEIV0
  6555     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  6556     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6557     MOVE X'2F20233030303036323537' TO DFHEIV0(25:11)
  6558     CALL 'kxdfhei1' USING DFHEIV0
  6559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6560
  6561
  6562
  6563* EXEC CICS STARTBR
  6564*        DATASET  (W-ARCH-FILE-ID)
  6565*        RIDFLD   (W-ARCH-KEY)
  6566*        GTEQ
  6567*    END-EXEC.
  6568     MOVE 0
  6569       TO DFHEIV11
  6570*    MOVE '&,         G          &   #00006263' TO DFHEIV0
  6571     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6572     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6573     MOVE X'2020233030303036323633' TO DFHEIV0(25:11)
  6574     CALL 'kxdfhei1' USING DFHEIV0,
  6575           W-ARCH-FILE-ID,
  6576           W-ARCH-KEY,
  6577           DFHEIV99,
  6578           DFHEIV11,
  6579           DFHEIV99
  6580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6581
  6582
  6583     PERFORM 7500-READ-ARCH-FILE-NEXT THRU 7500-EXIT.
  6584
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 130
* EL690.cbl
  6585
  6586* EXEC CICS HANDLE CONDITION
  6587*        NOTFND  (2600-END-BROWSE)
  6588*        ENDFILE (2600-END-BROWSE)
  6589*        END-EXEC.
  6590*    MOVE '"$I''                  ! 0 #00006271' TO DFHEIV0
  6591     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6592     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6593     MOVE X'3020233030303036323731' TO DFHEIV0(25:11)
  6594     CALL 'kxdfhei1' USING DFHEIV0
  6595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6596
  6597
  6598 2600-BUILD-ARCH-LIST.
  6599
  6600     IF  LA-COMPANY-CD NOT EQUAL PI-COMPANY-CD
  6601         GO TO 2600-END-BROWSE.
  6602
  6603     IF  PI-690-INIT-PROCESSOR NOT EQUAL LOW-VALUES
  6604             AND
  6605         PI-690-INIT-PROCESSOR NOT EQUAL HIGH-VALUES
  6606         IF  LA-PROCESSOR-CD NOT EQUAL PI-690-INIT-PROCESSOR
  6607             PERFORM 7500-READ-ARCH-FILE-NEXT THRU 7500-EXIT
  6608             GO TO 2600-BUILD-ARCH-LIST.
  6609
  6610     IF  PI-690-INIT-FORM NOT EQUAL LOW-VALUES
  6611             AND
  6612         PI-690-INIT-FORM NOT EQUAL HIGH-VALUES
  6613         IF  LA-FORM-A3 NOT EQUAL PI-690-INIT-FORM
  6614             PERFORM 7500-READ-ARCH-FILE-NEXT THRU 7500-EXIT
  6615             GO TO 2600-BUILD-ARCH-LIST.
  6616
  6617     IF  PI-690-INIT-ENTRY NOT EQUAL LOW-VALUES
  6618             AND
  6619         PI-690-INIT-ENTRY NOT EQUAL HIGH-VALUES
  6620         IF  LA-ENTRY-A6 NOT EQUAL PI-690-INIT-ENTRY
  6621             PERFORM 7500-READ-ARCH-FILE-NEXT THRU 7500-EXIT
  6622             GO TO 2600-BUILD-ARCH-LIST.
  6623
  6624     IF  PI-690-INIT-CARRIER NOT EQUAL LOW-VALUES
  6625             AND
  6626         PI-690-INIT-CARRIER NOT EQUAL HIGH-VALUES
  6627         IF  LA-CARRIER-A2 NOT EQUAL PI-690-INIT-CARRIER
  6628             PERFORM 7500-READ-ARCH-FILE-NEXT THRU 7500-EXIT
  6629             GO TO 2600-BUILD-ARCH-LIST.
  6630
  6631     IF  PI-690-INIT-GROUPING NOT EQUAL LOW-VALUES
  6632             AND
  6633         PI-690-INIT-GROUPING NOT EQUAL HIGH-VALUES
  6634         IF  LA-GROUPING-A2 NOT EQUAL PI-690-INIT-GROUPING
  6635             PERFORM 7500-READ-ARCH-FILE-NEXT THRU 7500-EXIT
  6636             GO TO 2600-BUILD-ARCH-LIST.
  6637
  6638     IF  PI-690-INIT-STATE NOT EQUAL LOW-VALUES
  6639             AND
  6640         PI-690-INIT-STATE NOT EQUAL HIGH-VALUES
  6641         IF  LA-STATE-A2 NOT EQUAL PI-690-INIT-STATE
  6642             PERFORM 7500-READ-ARCH-FILE-NEXT THRU 7500-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 131
* EL690.cbl
  6643             GO TO 2600-BUILD-ARCH-LIST.
  6644
  6645     IF  PI-690-INIT-ACCOUNT NOT EQUAL LOW-VALUES
  6646             AND
  6647         PI-690-INIT-ACCOUNT NOT EQUAL HIGH-VALUES
  6648         IF  LA-ACCOUNT-A2 NOT EQUAL PI-690-INIT-ACCOUNT
  6649             PERFORM 7500-READ-ARCH-FILE-NEXT THRU 7500-EXIT
  6650             GO TO 2600-BUILD-ARCH-LIST.
  6651
  6652 2600-CONTINUE.
  6653
  6654     IF  NOT PI-690-SELECT-ALL
  6655             AND
  6656         LA-STATUS NOT EQUAL PI-690-STATUS-SELECTION-IND
  6657         PERFORM 7500-READ-ARCH-FILE-NEXT THRU 7500-EXIT
  6658         GO TO 2600-BUILD-ARCH-LIST.
  6659
  6660     MOVE LA-ARCHIVE-NO          TO W-ARCH-NUMBER.
  6661
  6662     PERFORM 6000-SELECT-FOR-OUTPUT THRU 6000-EXIT.
  6663
  6664     IF  W-ARCH-NDX LESS THAN +13
  6665         PERFORM 7500-READ-ARCH-FILE-NEXT THRU 7500-EXIT
  6666         GO TO 2600-BUILD-ARCH-LIST.
  6667
  6668 2600-END.
  6669
  6670     MOVE -1                     TO CORRSELL.
  6671     MOVE ZEROS                  TO CORRSELO.
  6672     PERFORM 2600-END-BROWSE.
  6673     GO TO 8100-SEND-INITIAL-MAP.
  6674
  6675 2600-END-BROWSE.
  6676
  6677
  6678* EXEC CICS ENDBR
  6679*        DATASET (W-ARCH-FILE-ID)
  6680*    END-EXEC.
  6681     MOVE 0
  6682       TO DFHEIV11
  6683*    MOVE '&2                    $   #00006355' TO DFHEIV0
  6684     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6685     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6686     MOVE X'2020233030303036333535' TO DFHEIV0(25:11)
  6687     CALL 'kxdfhei1' USING DFHEIV0,
  6688           W-ARCH-FILE-ID,
  6689           DFHEIV11,
  6690           DFHEIV99
  6691     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6692
  6693
  6694 2600-ARCH-NOT-FOUND.
  6695
  6696     MOVE ER-0130                TO EMI-ERROR.
  6697     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6698     MOVE -1                     TO CORRSELL.
  6699     MOVE ZEROS                  TO CORRSELO.
  6700     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 132
* EL690.cbl
  6701
  6702 2600-EXIT.
  6703     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 133
* EL690.cbl
  6705 3000-PAGE-BACKWARD.
  6706
  6707     MOVE '2'                    TO PI-690-LAST-BROWSE-IND.
  6708     MOVE +1                     TO W-ARCH-NDX
  6709                                    W-ARCH-NDX2.
  6710     MOVE ZEROS                  TO W-ARCH-NUMBER.
  6711
  6712     GO TO 3100-ARCH2-PROCESS
  6713           3200-ARCH3-PROCESS
  6714           3300-ARCH4-PROCESS
  6715           3400-ARCH5-PROCESS
  6716           3500-ARCH6-PROCESS
  6717           3600-ARCH-PROCESS DEPENDING ON PI-690-BRWS-TYPE-IND.
  6718
  6719     MOVE ER-7384                TO EMI-ERROR.
  6720     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6721     MOVE -1                     TO TYPEBRL.
  6722     MOVE AL-UABON               TO TYPEBRA.
  6723     GO TO 8100-SEND-INITIAL-MAP.
  6724
  6725 3000-EXIT.
  6726     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 134
* EL690.cbl
  6728 3100-ARCH2-PROCESS.
  6729
  6730     IF  W-CHANGE-REQUESTED
  6731         MOVE HIGH-VALUES        TO W-ARCH2-KEY
  6732         MOVE PI-COMPANY-CD      TO W-ARCH2-COMPANY-CD
  6733         MOVE PI-690-INIT-CERT-PRIME
  6734                                 TO W-ARCH2-CERT-PRIME
  6735         MOVE PI-690-INIT-SUFFIX TO W-ARCH2-SUFFIX
  6736         MOVE PI-690-INIT-CARRIER
  6737                                 TO W-ARCH2-CARRIER
  6738         MOVE PI-690-INIT-GROUPING
  6739                                 TO W-ARCH2-GROUPING
  6740         MOVE PI-690-INIT-STATE  TO W-ARCH2-STATE
  6741         MOVE PI-690-INIT-ACCOUNT
  6742                                 TO W-ARCH2-ACCOUNT
  6743         MOVE PI-690-INIT-EFFECT-DATE
  6744                                 TO W-ARCH2-EFF-DTE
  6745
  6746
  6747     ELSE
  6748         IF  W-FIRST-CHANGE-FOUND
  6749             MOVE HIGH-VALUES    TO W-ARCH2-KEY
  6750             MOVE PI-COMPANY-CD  TO W-ARCH2-COMPANY-CD
  6751             MOVE PI-690-LAST-CERT-PRIME
  6752                                 TO W-ARCH2-CERT-PRIME
  6753             MOVE PI-690-LAST-SUFFIX
  6754                                 TO W-ARCH2-SUFFIX
  6755             MOVE PI-690-LAST-CARRIER
  6756                                 TO W-ARCH2-CARRIER
  6757             MOVE PI-690-LAST-GROUPING
  6758                                 TO W-ARCH2-GROUPING
  6759             MOVE PI-690-LAST-STATE
  6760                                 TO W-ARCH2-STATE
  6761             MOVE PI-690-LAST-ACCOUNT
  6762                                 TO W-ARCH2-ACCOUNT
  6763             MOVE PI-690-LAST-EFFECT-DATE
  6764                                 TO W-ARCH2-EFF-DTE
  6765
  6766         ELSE
  6767             MOVE PI-COMPANY-CD  TO W-ARCH2-COMPANY-CD
  6768             MOVE PI-690-FIRST-CERT-PRIME
  6769                                 TO W-ARCH2-CERT-PRIME
  6770             MOVE PI-690-FIRST-SUFFIX
  6771                                 TO W-ARCH2-SUFFIX
  6772             MOVE PI-690-FIRST-CARRIER
  6773                                 TO W-ARCH2-CARRIER
  6774             MOVE PI-690-FIRST-GROUPING
  6775                                 TO W-ARCH2-GROUPING
  6776             MOVE PI-690-FIRST-STATE
  6777                                 TO W-ARCH2-STATE
  6778             MOVE PI-690-FIRST-ACCOUNT
  6779                                 TO W-ARCH2-ACCOUNT
  6780             MOVE PI-690-FIRST-EFFECT-DATE
  6781                                 TO W-ARCH2-EFF-DTE
  6782             MOVE PI-690-FIRST-ARCHIVE-NO
  6783                                 TO W-ARCH2-ARCHIVE-NO.
  6784
  6785
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 135
* EL690.cbl
  6786* EXEC CICS HANDLE CONDITION
  6787*        NOTFND  (8080-ARCH-NOT-FOUND)
  6788*        ENDFILE (8080-ARCH-NOT-FOUND)
  6789*        NOTOPEN (8000-ARCH2-NOT-OPEN)
  6790*        END-EXEC.
  6791*    MOVE '"$I''J                 ! 1 #00006450' TO DFHEIV0
  6792     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  6793     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6794     MOVE X'3120233030303036343530' TO DFHEIV0(25:11)
  6795     CALL 'kxdfhei1' USING DFHEIV0
  6796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6797
  6798
  6799
  6800* EXEC CICS STARTBR
  6801*        DATASET  (W-ARCH2-FILE-ID)
  6802*        RIDFLD   (W-ARCH2-KEY)
  6803*        GTEQ
  6804*        END-EXEC.
  6805     MOVE 0
  6806       TO DFHEIV11
  6807*    MOVE '&,         G          &   #00006456' TO DFHEIV0
  6808     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6809     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6810     MOVE X'2020233030303036343536' TO DFHEIV0(25:11)
  6811     CALL 'kxdfhei1' USING DFHEIV0,
  6812           W-ARCH2-FILE-ID,
  6813           W-ARCH2-KEY,
  6814           DFHEIV99,
  6815           DFHEIV11,
  6816           DFHEIV99
  6817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6818
  6819
  6820
  6821* EXEC CICS HANDLE CONDITION
  6822*        NOTFND  (3100-END-BROWSE)
  6823*        ENDFILE (3100-END-BROWSE)
  6824*        END-EXEC.
  6825*    MOVE '"$I''                  ! 2 #00006462' TO DFHEIV0
  6826     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6827     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6828     MOVE X'3220233030303036343632' TO DFHEIV0(25:11)
  6829     CALL 'kxdfhei1' USING DFHEIV0
  6830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6831
  6832
  6833     PERFORM 7000-READ-ARCH2-FILE-NEXT THRU 7000-EXIT.
  6834
  6835     IF  W-CHANGE-REQUESTED
  6836             OR
  6837         W-READ-PREV-TWICE
  6838         MOVE SPACES            TO W-READ-PREV-TWICE-IND
  6839         PERFORM 7050-READ-PREV-ARCH2 THRU 7050-EXIT.
  6840
  6841 3100-BUILD-ARCH2-LIST-BACKWARD.
  6842
  6843     PERFORM 7050-READ-PREV-ARCH2 THRU 7050-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 136
* EL690.cbl
  6844
  6845     IF  LA-COMPANY-CD-A2 NOT EQUAL PI-COMPANY-CD
  6846         GO TO 3100-END.
  6847
  6848     IF  PI-690-INIT-CERT-NO EQUAL HIGH-VALUES OR LOW-VALUES
  6849         GO TO 3100-CONTINUE.
  6850
  6851     IF  LA-CERT-NO-A2 NOT EQUAL PI-690-INIT-CERT-NO
  6852         GO TO 3100-END-BROWSE.
  6853
  6854     IF  PI-690-INIT-CARRIER EQUAL HIGH-VALUES OR LOW-VALUES
  6855         GO TO 3100-CONTINUE.
  6856
  6857     IF  LA-CARRIER-A2 NOT EQUAL PI-690-INIT-CARRIER
  6858         GO TO 3100-END-BROWSE.
  6859
  6860     IF  PI-690-INIT-GROUPING EQUAL HIGH-VALUES OR LOW-VALUES
  6861         GO TO 3100-CONTINUE.
  6862
  6863     IF  LA-GROUPING-A2 NOT EQUAL PI-690-INIT-GROUPING
  6864         GO TO 3100-END-BROWSE.
  6865
  6866     IF  PI-690-INIT-STATE EQUAL HIGH-VALUES OR LOW-VALUES
  6867         GO TO 3100-CONTINUE.
  6868
  6869     IF  LA-STATE-A2 NOT EQUAL PI-690-INIT-STATE
  6870         GO TO 3100-END-BROWSE.
  6871
  6872     IF  PI-690-INIT-ACCOUNT EQUAL HIGH-VALUES OR LOW-VALUES
  6873         GO TO 3100-CONTINUE.
  6874
  6875     IF  LA-ACCOUNT-A2 NOT EQUAL PI-690-INIT-ACCOUNT
  6876         GO TO 3100-END-BROWSE.
  6877
  6878     IF  PI-690-INIT-EFFECT-DATE = LOW-VALUES OR HIGH-VALUES
  6879         GO TO 3100-CONTINUE.
  6880
  6881     IF  LA-EFFECT-DATE-A2 NOT EQUAL PI-690-INIT-EFFECT-DATE
  6882         GO TO 3100-END-BROWSE.
  6883
  6884 3100-CONTINUE.
  6885
  6886     IF  NOT PI-690-SELECT-ALL
  6887             AND
  6888         LA-STATUS NOT EQUAL PI-690-STATUS-SELECTION-IND
  6889         GO TO 3100-BUILD-ARCH2-LIST-BACKWARD.
  6890
  6891     IF  PI-690-INIT-ENTRY NOT EQUAL HIGH-VALUES
  6892             AND
  6893         PI-690-INIT-ENTRY NOT EQUAL LOW-VALUES
  6894         IF  PI-690-INIT-ENTRY NOT EQUAL LA-ENTRY-A6
  6895             GO TO 3100-BUILD-ARCH2-LIST-BACKWARD.
  6896
  6897     IF  PI-690-INIT-FORM NOT EQUAL HIGH-VALUES
  6898             AND
  6899         PI-690-INIT-FORM NOT EQUAL LOW-VALUES
  6900         IF  PI-690-INIT-FORM NOT EQUAL LA-FORM-A3
  6901             GO TO 3100-BUILD-ARCH2-LIST-BACKWARD.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 137
* EL690.cbl
  6902
  6903     IF  PI-690-INIT-PROCESSOR NOT EQUAL HIGH-VALUES
  6904             AND
  6905         PI-690-INIT-PROCESSOR NOT EQUAL LOW-VALUES
  6906         IF  PI-690-INIT-PROCESSOR NOT EQUAL LA-PROCESSOR-CD
  6907             GO TO 3100-BUILD-ARCH2-LIST-BACKWARD.
  6908
  6909     MOVE LA-ARCHIVE-NO          TO W-ARCH-NUMBER.
  6910
  6911     PERFORM 6000-SELECT-FOR-OUTPUT THRU 6000-EXIT.
  6912
  6913     IF  W-ARCH-NDX LESS THAN +13
  6914         GO TO 3100-BUILD-ARCH2-LIST-BACKWARD.
  6915
  6916 3100-END.
  6917
  6918     MOVE -1                     TO CORRSELL.
  6919     MOVE ZEROS                  TO CORRSELO.
  6920     PERFORM 3100-END-BROWSE
  6921     GO TO 8100-SEND-INITIAL-MAP.
  6922
  6923 3100-END-BROWSE.
  6924
  6925     MOVE W-ARCH-NDX             TO W-ARCH-NDX3.
  6926     SUBTRACT +1 FROM W-ARCH-NDX3.
  6927
  6928     IF  W-ARCH-NDX3 GREATER THAN +1
  6929         MOVE +1 TO W-ARCH-NDX2
  6930         PERFORM 6500-REVERSE-TABLE-DATA THRU 6500-EXIT
  6931                 UNTIL
  6932             W-ARCH-NDX2 NOT LESS W-ARCH-NDX3.
  6933
  6934
  6935* EXEC CICS ENDBR
  6936*        DATASET (W-ARCH2-FILE-ID)
  6937*    END-EXEC.
  6938     MOVE 0
  6939       TO DFHEIV11
  6940*    MOVE '&2                    $   #00006568' TO DFHEIV0
  6941     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6942     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6943     MOVE X'2020233030303036353638' TO DFHEIV0(25:11)
  6944     CALL 'kxdfhei1' USING DFHEIV0,
  6945           W-ARCH2-FILE-ID,
  6946           DFHEIV11,
  6947           DFHEIV99
  6948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6949
  6950
  6951 3100-FRONT-OF-FILE.
  6952
  6953     MOVE ER-0131                TO EMI-ERROR.
  6954     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6955     MOVE -1                     TO CORRSELL.
  6956     MOVE ZEROS                  TO CORRSELO.
  6957     GO TO 8100-SEND-INITIAL-MAP.
  6958
  6959 3100-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 138
* EL690.cbl
  6960     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 139
* EL690.cbl
  6962 3200-ARCH3-PROCESS.
  6963
  6964     IF  W-CHANGE-REQUESTED
  6965         MOVE HIGH-VALUES        TO W-ARCH3-KEY
  6966         MOVE PI-COMPANY-CD      TO W-ARCH3-COMPANY-CD
  6967         MOVE PI-690-INIT-FORM   TO W-ARCH3-FORM
  6968         MOVE PI-690-INIT-CARRIER
  6969                                 TO W-ARCH3-CARRIER
  6970         MOVE PI-690-INIT-GROUPING
  6971                                 TO W-ARCH3-GROUPING
  6972         MOVE PI-690-INIT-STATE  TO W-ARCH3-STATE
  6973         MOVE PI-690-INIT-ACCOUNT
  6974                                 TO W-ARCH3-ACCOUNT
  6975
  6976     ELSE
  6977         IF  W-FIRST-CHANGE-FOUND
  6978             MOVE HIGH-VALUES    TO W-ARCH3-KEY
  6979             MOVE PI-COMPANY-CD  TO W-ARCH3-COMPANY-CD
  6980             MOVE PI-690-LAST-FORM
  6981                                 TO W-ARCH3-FORM
  6982             MOVE PI-690-LAST-CARRIER
  6983                                 TO W-ARCH3-CARRIER
  6984             MOVE PI-690-LAST-GROUPING
  6985                                 TO W-ARCH3-GROUPING
  6986             MOVE PI-690-LAST-STATE
  6987                                 TO W-ARCH3-STATE
  6988             MOVE PI-690-LAST-ACCOUNT
  6989                                 TO W-ARCH3-ACCOUNT
  6990
  6991         ELSE
  6992             MOVE PI-COMPANY-CD  TO W-ARCH3-COMPANY-CD
  6993             MOVE PI-690-FIRST-FORM
  6994                                 TO W-ARCH3-FORM
  6995             MOVE PI-690-FIRST-CARRIER
  6996                                 TO W-ARCH3-CARRIER
  6997             MOVE PI-690-FIRST-GROUPING
  6998                                 TO W-ARCH3-GROUPING
  6999             MOVE PI-690-FIRST-STATE
  7000                                 TO W-ARCH3-STATE
  7001             MOVE PI-690-FIRST-ACCOUNT
  7002                                 TO W-ARCH3-ACCOUNT
  7003             MOVE PI-690-FIRST-ARCHIVE-NO
  7004                                 TO W-ARCH3-ARCHIVE-NO.
  7005
  7006
  7007* EXEC CICS HANDLE CONDITION
  7008*        NOTFND  (8080-ARCH-NOT-FOUND)
  7009*        ENDFILE (8080-ARCH-NOT-FOUND)
  7010*        NOTOPEN (8010-ARCH3-NOT-OPEN)
  7011*        END-EXEC.
  7012*    MOVE '"$I''J                 ! 3 #00006627' TO DFHEIV0
  7013     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  7014     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7015     MOVE X'3320233030303036363237' TO DFHEIV0(25:11)
  7016     CALL 'kxdfhei1' USING DFHEIV0
  7017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7018
  7019
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 140
* EL690.cbl
  7020
  7021* EXEC CICS STARTBR
  7022*        DATASET  (W-ARCH3-FILE-ID)
  7023*        RIDFLD   (W-ARCH3-KEY)
  7024*        GTEQ
  7025*        END-EXEC.
  7026     MOVE 0
  7027       TO DFHEIV11
  7028*    MOVE '&,         G          &   #00006633' TO DFHEIV0
  7029     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7030     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7031     MOVE X'2020233030303036363333' TO DFHEIV0(25:11)
  7032     CALL 'kxdfhei1' USING DFHEIV0,
  7033           W-ARCH3-FILE-ID,
  7034           W-ARCH3-KEY,
  7035           DFHEIV99,
  7036           DFHEIV11,
  7037           DFHEIV99
  7038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7039
  7040
  7041
  7042* EXEC CICS HANDLE CONDITION
  7043*        NOTFND  (3200-END-BROWSE)
  7044*        ENDFILE (3200-END-BROWSE)
  7045*        END-EXEC.
  7046*    MOVE '"$I''                  ! 4 #00006639' TO DFHEIV0
  7047     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7048     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7049     MOVE X'3420233030303036363339' TO DFHEIV0(25:11)
  7050     CALL 'kxdfhei1' USING DFHEIV0
  7051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7052
  7053
  7054     PERFORM 7100-READ-ARCH3-FILE-NEXT THRU 7100-EXIT.
  7055
  7056     IF  W-CHANGE-REQUESTED
  7057             OR
  7058         W-READ-PREV-TWICE
  7059         MOVE SPACES            TO W-READ-PREV-TWICE-IND
  7060         PERFORM 7150-READ-PREV-ARCH3 THRU 7150-EXIT.
  7061
  7062 3200-BUILD-ARCH3-LIST-BACKWARD.
  7063
  7064     PERFORM 7150-READ-PREV-ARCH3 THRU 7150-EXIT.
  7065
  7066     IF  LA-COMPANY-CD-A3 NOT EQUAL PI-COMPANY-CD
  7067         GO TO 3200-END.
  7068
  7069     IF  PI-690-INIT-FORM EQUAL HIGH-VALUES OR LOW-VALUES
  7070         GO TO 3200-CONTINUE.
  7071
  7072     IF  LA-FORM-A3 NOT EQUAL PI-690-INIT-FORM
  7073         GO TO 3200-END-BROWSE.
  7074
  7075     IF  PI-690-INIT-CARRIER EQUAL HIGH-VALUES OR LOW-VALUES
  7076         GO TO 3200-CONTINUE.
  7077
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 141
* EL690.cbl
  7078     IF  LA-CARRIER-A3 NOT EQUAL PI-690-INIT-CARRIER
  7079         GO TO 3200-END-BROWSE.
  7080
  7081     IF  PI-690-INIT-GROUPING EQUAL HIGH-VALUES OR LOW-VALUES
  7082         GO TO 3200-CONTINUE.
  7083
  7084     IF  LA-GROUPING-A3 NOT EQUAL PI-690-INIT-GROUPING
  7085         GO TO 3200-END-BROWSE.
  7086
  7087     IF  PI-690-INIT-STATE EQUAL HIGH-VALUES OR LOW-VALUES
  7088         GO TO 3200-CONTINUE.
  7089
  7090     IF  LA-STATE-A3 NOT EQUAL PI-690-INIT-STATE
  7091         GO TO 3200-END-BROWSE.
  7092
  7093     IF  PI-690-INIT-ACCOUNT EQUAL HIGH-VALUES OR LOW-VALUES
  7094         GO TO 3200-CONTINUE.
  7095
  7096     IF  LA-ACCOUNT-A3 NOT EQUAL PI-690-INIT-ACCOUNT
  7097         GO TO 3200-END-BROWSE.
  7098
  7099 3200-CONTINUE.
  7100
  7101     IF  NOT PI-690-SELECT-ALL
  7102             AND
  7103         LA-STATUS NOT EQUAL PI-690-STATUS-SELECTION-IND
  7104         GO TO 3200-BUILD-ARCH3-LIST-BACKWARD.
  7105
  7106     IF  PI-690-INIT-ENTRY NOT EQUAL HIGH-VALUES
  7107             AND
  7108         PI-690-INIT-ENTRY NOT EQUAL LOW-VALUES
  7109         IF  PI-690-INIT-ENTRY NOT EQUAL LA-ENTRY-A6
  7110             GO TO 3200-BUILD-ARCH3-LIST-BACKWARD.
  7111
  7112     IF  PI-690-INIT-PROCESSOR NOT EQUAL HIGH-VALUES
  7113             AND
  7114         PI-690-INIT-PROCESSOR NOT EQUAL LOW-VALUES
  7115         IF  PI-690-INIT-PROCESSOR NOT EQUAL LA-PROCESSOR-CD
  7116             GO TO 3200-BUILD-ARCH3-LIST-BACKWARD.
  7117
  7118     MOVE LA-ARCHIVE-NO          TO W-ARCH-NUMBER.
  7119
  7120     PERFORM 6000-SELECT-FOR-OUTPUT THRU 6000-EXIT.
  7121
  7122     IF  W-ARCH-NDX LESS THAN +13
  7123         GO TO 3200-BUILD-ARCH3-LIST-BACKWARD.
  7124
  7125 3200-END.
  7126
  7127     MOVE -1                     TO CORRSELL.
  7128     MOVE ZEROS                  TO CORRSELO.
  7129     PERFORM 3200-END-BROWSE.
  7130     GO TO 8100-SEND-INITIAL-MAP.
  7131
  7132 3200-END-BROWSE.
  7133
  7134     MOVE W-ARCH-NDX             TO W-ARCH-NDX3.
  7135     SUBTRACT +1 FROM W-ARCH-NDX3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 142
* EL690.cbl
  7136
  7137     IF  W-ARCH-NDX3 GREATER THAN +1
  7138         MOVE +1 TO W-ARCH-NDX2
  7139         PERFORM 6500-REVERSE-TABLE-DATA THRU 6500-EXIT
  7140                 UNTIL
  7141             W-ARCH-NDX2 NOT LESS W-ARCH-NDX3.
  7142
  7143
  7144* EXEC CICS ENDBR
  7145*        DATASET (W-ARCH3-FILE-ID)
  7146*    END-EXEC.
  7147     MOVE 0
  7148       TO DFHEIV11
  7149*    MOVE '&2                    $   #00006733' TO DFHEIV0
  7150     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7151     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7152     MOVE X'2020233030303036373333' TO DFHEIV0(25:11)
  7153     CALL 'kxdfhei1' USING DFHEIV0,
  7154           W-ARCH3-FILE-ID,
  7155           DFHEIV11,
  7156           DFHEIV99
  7157     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7158
  7159
  7160 3200-FRONT-OF-FILE.
  7161
  7162     MOVE ER-0131                TO EMI-ERROR.
  7163     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7164     MOVE -1                     TO CORRSELL.
  7165     MOVE ZEROS                  TO CORRSELO.
  7166     GO TO 8100-SEND-INITIAL-MAP.
  7167
  7168 3200-EXIT.
  7169     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 143
* EL690.cbl
  7171 3300-ARCH4-PROCESS.
  7172
  7173     IF  W-CHANGE-REQUESTED
  7174         MOVE HIGH-VALUES        TO W-ARCH4-KEY
  7175         MOVE PI-COMPANY-CD      TO W-ARCH4-COMPANY-CD
  7176         MOVE PI-690-INIT-PROCESSOR
  7177                                 TO W-ARCH4-PROCESSOR
  7178         MOVE PI-690-INIT-CARRIER
  7179                                 TO W-ARCH4-CARRIER
  7180         MOVE PI-690-INIT-GROUPING
  7181                                 TO W-ARCH4-GROUPING
  7182         MOVE PI-690-INIT-STATE  TO W-ARCH4-STATE
  7183         MOVE PI-690-INIT-ACCOUNT
  7184                                 TO W-ARCH4-ACCOUNT
  7185
  7186     ELSE
  7187         IF  W-FIRST-CHANGE-FOUND
  7188             MOVE HIGH-VALUES    TO W-ARCH4-KEY
  7189             MOVE PI-COMPANY-CD  TO W-ARCH4-COMPANY-CD
  7190             MOVE PI-690-LAST-PROCESSOR
  7191                                 TO W-ARCH4-PROCESSOR
  7192             MOVE PI-690-LAST-CARRIER
  7193                                 TO W-ARCH4-CARRIER
  7194             MOVE PI-690-LAST-GROUPING
  7195                                 TO W-ARCH4-GROUPING
  7196             MOVE PI-690-LAST-STATE
  7197                                 TO W-ARCH4-STATE
  7198             MOVE PI-690-LAST-ACCOUNT
  7199                                 TO W-ARCH4-ACCOUNT
  7200
  7201         ELSE
  7202             MOVE PI-COMPANY-CD  TO W-ARCH4-COMPANY-CD
  7203             MOVE PI-690-FIRST-PROCESSOR
  7204                                 TO W-ARCH4-PROCESSOR
  7205             MOVE PI-690-FIRST-CARRIER
  7206                                 TO W-ARCH4-CARRIER
  7207             MOVE PI-690-FIRST-GROUPING
  7208                                 TO W-ARCH4-GROUPING
  7209             MOVE PI-690-FIRST-STATE
  7210                                 TO W-ARCH4-STATE
  7211             MOVE PI-690-FIRST-ACCOUNT
  7212                                 TO W-ARCH4-ACCOUNT
  7213             MOVE PI-690-FIRST-ARCHIVE-NO
  7214                                 TO W-ARCH4-ARCHIVE-NO.
  7215
  7216
  7217* EXEC CICS HANDLE CONDITION
  7218*        NOTFND  (8080-ARCH-NOT-FOUND)
  7219*        ENDFILE (8080-ARCH-NOT-FOUND)
  7220*        NOTOPEN (8020-ARCH4-NOT-OPEN)
  7221*        END-EXEC.
  7222*    MOVE '"$I''J                 ! 5 #00006793' TO DFHEIV0
  7223     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  7224     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7225     MOVE X'3520233030303036373933' TO DFHEIV0(25:11)
  7226     CALL 'kxdfhei1' USING DFHEIV0
  7227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7228
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 144
* EL690.cbl
  7229
  7230
  7231* EXEC CICS STARTBR
  7232*        DATASET  (W-ARCH4-FILE-ID)
  7233*        RIDFLD   (W-ARCH4-KEY)
  7234*        GTEQ
  7235*        END-EXEC.
  7236     MOVE 0
  7237       TO DFHEIV11
  7238*    MOVE '&,         G          &   #00006799' TO DFHEIV0
  7239     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7240     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7241     MOVE X'2020233030303036373939' TO DFHEIV0(25:11)
  7242     CALL 'kxdfhei1' USING DFHEIV0,
  7243           W-ARCH4-FILE-ID,
  7244           W-ARCH4-KEY,
  7245           DFHEIV99,
  7246           DFHEIV11,
  7247           DFHEIV99
  7248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7249
  7250
  7251
  7252* EXEC CICS HANDLE CONDITION
  7253*        NOTFND  (3300-END-BROWSE)
  7254*        ENDFILE (3300-END-BROWSE)
  7255*        END-EXEC.
  7256*    MOVE '"$I''                  ! 6 #00006805' TO DFHEIV0
  7257     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7258     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7259     MOVE X'3620233030303036383035' TO DFHEIV0(25:11)
  7260     CALL 'kxdfhei1' USING DFHEIV0
  7261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7262
  7263
  7264     PERFORM 7200-READ-ARCH4-FILE-NEXT THRU 7200-EXIT.
  7265
  7266     IF  W-CHANGE-REQUESTED
  7267             OR
  7268         W-READ-PREV-TWICE
  7269         MOVE SPACES            TO W-READ-PREV-TWICE-IND
  7270         PERFORM 7250-READ-PREV-ARCH4 THRU 7250-EXIT.
  7271
  7272 3300-BUILD-ARCH4-LIST-BACKWARD.
  7273
  7274     PERFORM 7250-READ-PREV-ARCH4 THRU 7250-EXIT.
  7275
  7276     IF  LA-COMPANY-CD-A3 NOT EQUAL PI-COMPANY-CD
  7277         GO TO 3300-END.
  7278
  7279     IF  PI-690-INIT-PROCESSOR EQUAL HIGH-VALUES OR LOW-VALUES
  7280         GO TO 3300-CONTINUE.
  7281
  7282     IF  LA-PROCESSOR-CD NOT EQUAL PI-690-INIT-PROCESSOR
  7283         GO TO 3300-END-BROWSE.
  7284
  7285     IF  PI-690-INIT-CARRIER EQUAL HIGH-VALUES OR LOW-VALUES
  7286         GO TO 3300-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 145
* EL690.cbl
  7287
  7288     IF  LA-CARRIER-A4 NOT EQUAL PI-690-INIT-CARRIER
  7289         GO TO 3300-END-BROWSE.
  7290
  7291     IF  PI-690-INIT-GROUPING EQUAL HIGH-VALUES OR LOW-VALUES
  7292         GO TO 3300-CONTINUE.
  7293
  7294     IF  LA-GROUPING-A4 NOT EQUAL PI-690-INIT-GROUPING
  7295         GO TO 3300-END-BROWSE.
  7296
  7297     IF  PI-690-INIT-STATE EQUAL HIGH-VALUES OR LOW-VALUES
  7298         GO TO 3300-CONTINUE.
  7299
  7300     IF  LA-STATE-A4 NOT EQUAL PI-690-INIT-STATE
  7301         GO TO 3300-END-BROWSE.
  7302
  7303     IF  PI-690-INIT-ACCOUNT EQUAL HIGH-VALUES OR LOW-VALUES
  7304         GO TO 3300-CONTINUE.
  7305
  7306     IF  LA-ACCOUNT-A4 NOT EQUAL PI-690-INIT-ACCOUNT
  7307         GO TO 3300-END-BROWSE.
  7308
  7309 3300-CONTINUE.
  7310
  7311     IF  NOT PI-690-SELECT-ALL
  7312             AND
  7313         LA-STATUS NOT EQUAL PI-690-STATUS-SELECTION-IND
  7314         GO TO 3300-BUILD-ARCH4-LIST-BACKWARD.
  7315
  7316     IF  PI-690-INIT-ENTRY NOT EQUAL HIGH-VALUES
  7317             AND
  7318         PI-690-INIT-ENTRY NOT EQUAL LOW-VALUES
  7319         IF  PI-690-INIT-ENTRY NOT EQUAL LA-ENTRY-A6
  7320             GO TO 3300-BUILD-ARCH4-LIST-BACKWARD.
  7321
  7322     IF  PI-690-INIT-FORM NOT EQUAL HIGH-VALUES
  7323             AND
  7324         PI-690-INIT-FORM NOT EQUAL LOW-VALUES
  7325         IF  PI-690-INIT-FORM NOT EQUAL LA-FORM-A3
  7326             GO TO 3300-BUILD-ARCH4-LIST-BACKWARD.
  7327
  7328     MOVE LA-ARCHIVE-NO          TO W-ARCH-NUMBER.
  7329
  7330     PERFORM 6000-SELECT-FOR-OUTPUT THRU 6000-EXIT.
  7331
  7332     IF  W-ARCH-NDX LESS THAN +13
  7333         GO TO 3300-BUILD-ARCH4-LIST-BACKWARD.
  7334
  7335 3300-END.
  7336
  7337     MOVE -1                     TO CORRSELL.
  7338     MOVE ZEROS                  TO CORRSELO.
  7339     PERFORM 3300-END-BROWSE
  7340     GO TO 8100-SEND-INITIAL-MAP.
  7341
  7342 3300-END-BROWSE.
  7343
  7344     MOVE W-ARCH-NDX             TO W-ARCH-NDX3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 146
* EL690.cbl
  7345     SUBTRACT +1 FROM W-ARCH-NDX3.
  7346
  7347     IF  W-ARCH-NDX3 GREATER THAN +1
  7348         MOVE +1 TO W-ARCH-NDX2
  7349         PERFORM 6500-REVERSE-TABLE-DATA THRU 6500-EXIT
  7350                 UNTIL
  7351             W-ARCH-NDX2 NOT LESS W-ARCH-NDX3.
  7352
  7353
  7354* EXEC CICS ENDBR
  7355*        DATASET (W-ARCH4-FILE-ID)
  7356*    END-EXEC.
  7357     MOVE 0
  7358       TO DFHEIV11
  7359*    MOVE '&2                    $   #00006899' TO DFHEIV0
  7360     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7361     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7362     MOVE X'2020233030303036383939' TO DFHEIV0(25:11)
  7363     CALL 'kxdfhei1' USING DFHEIV0,
  7364           W-ARCH4-FILE-ID,
  7365           DFHEIV11,
  7366           DFHEIV99
  7367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7368
  7369
  7370 3300-FRONT-OF-FILE.
  7371
  7372     MOVE ER-0131                TO EMI-ERROR.
  7373     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7374     MOVE -1                     TO CORRSELL.
  7375     MOVE ZEROS                  TO CORRSELO.
  7376     GO TO 8100-SEND-INITIAL-MAP.
  7377
  7378 3300-EXIT.
  7379     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 147
* EL690.cbl
  7381 3400-ARCH5-PROCESS.
  7382
  7383     IF  W-CHANGE-REQUESTED
  7384         MOVE HIGH-VALUES        TO W-ARCH5-KEY
  7385         MOVE PI-COMPANY-CD      TO W-ARCH5-COMPANY-CD
  7386         MOVE PI-690-INIT-CARRIER
  7387                                 TO W-ARCH5-CARRIER
  7388         MOVE PI-690-INIT-GROUPING
  7389                                 TO W-ARCH5-GROUPING
  7390         MOVE PI-690-INIT-STATE  TO W-ARCH5-STATE
  7391         MOVE PI-690-INIT-ACCOUNT
  7392                                 TO W-ARCH5-ACCOUNT
  7393
  7394     ELSE
  7395         IF  W-FIRST-CHANGE-FOUND
  7396             MOVE SPACES         TO W-READ-PREV-TWICE-IND
  7397             MOVE HIGH-VALUES    TO W-ARCH5-KEY
  7398             MOVE PI-COMPANY-CD  TO W-ARCH5-COMPANY-CD
  7399             MOVE PI-690-LAST-CARRIER
  7400                                 TO W-ARCH5-CARRIER
  7401             MOVE PI-690-LAST-GROUPING
  7402                                 TO W-ARCH5-GROUPING
  7403             MOVE PI-690-LAST-STATE
  7404                                 TO W-ARCH5-STATE
  7405             MOVE PI-690-LAST-ACCOUNT
  7406                                 TO W-ARCH5-ACCOUNT
  7407             MOVE PI-690-LAST-ARCHIVE-NO
  7408                                 TO W-ARCH5-ARCHIVE-NO
  7409
  7410         ELSE
  7411             MOVE PI-COMPANY-CD  TO W-ARCH5-COMPANY-CD
  7412             MOVE PI-690-FIRST-CARRIER
  7413                                 TO W-ARCH5-CARRIER
  7414             MOVE PI-690-FIRST-GROUPING
  7415                                 TO W-ARCH5-GROUPING
  7416             MOVE PI-690-FIRST-STATE
  7417                                 TO W-ARCH5-STATE
  7418             MOVE PI-690-FIRST-ACCOUNT
  7419                                 TO W-ARCH5-ACCOUNT
  7420             MOVE PI-690-FIRST-ARCHIVE-NO
  7421                                 TO W-ARCH5-ARCHIVE-NO.
  7422
  7423
  7424* EXEC CICS HANDLE CONDITION
  7425*        NOTFND  (8080-ARCH-NOT-FOUND)
  7426*        ENDFILE (8080-ARCH-NOT-FOUND)
  7427*        NOTOPEN (8030-ARCH5-NOT-OPEN)
  7428*        END-EXEC.
  7429*    MOVE '"$I''J                 ! 7 #00006956' TO DFHEIV0
  7430     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  7431     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7432     MOVE X'3720233030303036393536' TO DFHEIV0(25:11)
  7433     CALL 'kxdfhei1' USING DFHEIV0
  7434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7435
  7436
  7437
  7438* EXEC CICS STARTBR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 148
* EL690.cbl
  7439*        DATASET  (W-ARCH5-FILE-ID)
  7440*        RIDFLD   (W-ARCH5-KEY)
  7441*        GTEQ
  7442*        END-EXEC.
  7443     MOVE 0
  7444       TO DFHEIV11
  7445*    MOVE '&,         G          &   #00006962' TO DFHEIV0
  7446     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7447     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7448     MOVE X'2020233030303036393632' TO DFHEIV0(25:11)
  7449     CALL 'kxdfhei1' USING DFHEIV0,
  7450           W-ARCH5-FILE-ID,
  7451           W-ARCH5-KEY,
  7452           DFHEIV99,
  7453           DFHEIV11,
  7454           DFHEIV99
  7455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7456
  7457
  7458
  7459* EXEC CICS HANDLE CONDITION
  7460*        NOTFND  (3400-END-BROWSE)
  7461*        ENDFILE (3400-END-BROWSE)
  7462*        END-EXEC.
  7463*    MOVE '"$I''                  ! 8 #00006968' TO DFHEIV0
  7464     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7465     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7466     MOVE X'3820233030303036393638' TO DFHEIV0(25:11)
  7467     CALL 'kxdfhei1' USING DFHEIV0
  7468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7469
  7470
  7471     PERFORM 7300-READ-ARCH5-FILE-NEXT THRU 7300-EXIT.
  7472
  7473     IF  W-CHANGE-REQUESTED
  7474*            OR
  7475*        W-READ-PREV-TWICE
  7476*        MOVE SPACES            TO W-READ-PREV-TWICE-IND
  7477         PERFORM 7350-READ-PREV-ARCH5 THRU 7350-EXIT.
  7478
  7479 3400-BUILD-ARCH5-LIST-BACKWARD.
  7480
  7481     PERFORM 7350-READ-PREV-ARCH5 THRU 7350-EXIT.
  7482
  7483     IF  LA-COMPANY-CD-A5 NOT EQUAL PI-COMPANY-CD
  7484         GO TO 3400-END.
  7485
  7486     IF  PI-690-INIT-CARRIER EQUAL HIGH-VALUES OR LOW-VALUES
  7487         GO TO 3400-CONTINUE.
  7488
  7489     IF  LA-CARRIER-A5 NOT EQUAL PI-690-INIT-CARRIER
  7490         GO TO 3400-END-BROWSE.
  7491
  7492     IF  PI-690-INIT-GROUPING EQUAL HIGH-VALUES OR LOW-VALUES
  7493         GO TO 3400-CONTINUE.
  7494
  7495     IF  LA-GROUPING-A5 NOT EQUAL PI-690-INIT-GROUPING
  7496         GO TO 3400-END-BROWSE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 149
* EL690.cbl
  7497
  7498     IF  PI-690-INIT-STATE EQUAL HIGH-VALUES OR LOW-VALUES
  7499         GO TO 3400-CONTINUE.
  7500
  7501     IF  LA-STATE-A5 NOT EQUAL PI-690-INIT-STATE
  7502         GO TO 3400-END-BROWSE.
  7503
  7504     IF  PI-690-INIT-ACCOUNT EQUAL HIGH-VALUES OR LOW-VALUES
  7505         GO TO 3400-CONTINUE.
  7506
  7507     IF  LA-ACCOUNT-A5 NOT EQUAL PI-690-INIT-ACCOUNT
  7508         GO TO 3400-END-BROWSE.
  7509
  7510 3400-CONTINUE.
  7511
  7512     IF  NOT PI-690-SELECT-ALL
  7513             AND
  7514         LA-STATUS NOT EQUAL PI-690-STATUS-SELECTION-IND
  7515         GO TO 3400-BUILD-ARCH5-LIST-BACKWARD.
  7516
  7517     IF  PI-690-INIT-ENTRY NOT EQUAL HIGH-VALUES
  7518             AND
  7519         PI-690-INIT-ENTRY NOT EQUAL LOW-VALUES
  7520         IF  PI-690-INIT-ENTRY NOT EQUAL LA-ENTRY-A6
  7521             GO TO 3400-BUILD-ARCH5-LIST-BACKWARD.
  7522
  7523     IF  PI-690-INIT-PROCESSOR NOT EQUAL HIGH-VALUES
  7524             AND
  7525         PI-690-INIT-PROCESSOR NOT EQUAL LOW-VALUES
  7526         IF  PI-690-INIT-PROCESSOR NOT EQUAL LA-PROCESSOR-CD
  7527             GO TO 3400-BUILD-ARCH5-LIST-BACKWARD.
  7528
  7529     IF  PI-690-INIT-FORM NOT EQUAL HIGH-VALUES
  7530             AND
  7531         PI-690-INIT-FORM NOT EQUAL LOW-VALUES
  7532         IF  PI-690-INIT-FORM NOT EQUAL LA-FORM-A3
  7533             GO TO 3400-BUILD-ARCH5-LIST-BACKWARD.
  7534
  7535     MOVE LA-ARCHIVE-NO          TO W-ARCH-NUMBER.
  7536
  7537     PERFORM 6000-SELECT-FOR-OUTPUT THRU 6000-EXIT.
  7538
  7539     IF  W-ARCH-NDX LESS THAN +13
  7540         GO TO 3400-BUILD-ARCH5-LIST-BACKWARD.
  7541
  7542 3400-END.
  7543
  7544     MOVE -1                     TO CORRSELL.
  7545     MOVE ZEROS                  TO CORRSELO.
  7546     PERFORM 3400-END-BROWSE
  7547     GO TO 8100-SEND-INITIAL-MAP.
  7548
  7549 3400-END-BROWSE.
  7550
  7551     MOVE W-ARCH-NDX             TO W-ARCH-NDX3.
  7552     SUBTRACT +1 FROM W-ARCH-NDX3.
  7553
  7554     IF  W-ARCH-NDX3 GREATER THAN +1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 150
* EL690.cbl
  7555         MOVE +1 TO W-ARCH-NDX2
  7556         PERFORM 6500-REVERSE-TABLE-DATA THRU 6500-EXIT
  7557                 UNTIL
  7558             W-ARCH-NDX2 NOT LESS W-ARCH-NDX3.
  7559
  7560
  7561* EXEC CICS ENDBR
  7562*        DATASET (W-ARCH5-FILE-ID)
  7563*    END-EXEC.
  7564     MOVE 0
  7565       TO DFHEIV11
  7566*    MOVE '&2                    $   #00007062' TO DFHEIV0
  7567     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7568     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7569     MOVE X'2020233030303037303632' TO DFHEIV0(25:11)
  7570     CALL 'kxdfhei1' USING DFHEIV0,
  7571           W-ARCH5-FILE-ID,
  7572           DFHEIV11,
  7573           DFHEIV99
  7574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7575
  7576
  7577 3400-FRONT-OF-FILE.
  7578
  7579     MOVE ER-0131                TO EMI-ERROR.
  7580     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7581     MOVE -1                     TO CORRSELL.
  7582     MOVE ZEROS                  TO CORRSELO.
  7583     GO TO 8100-SEND-INITIAL-MAP.
  7584
  7585 3400-EXIT.
  7586     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 151
* EL690.cbl
  7588 3500-ARCH6-PROCESS.
  7589
  7590     IF  W-CHANGE-REQUESTED
  7591         MOVE HIGH-VALUES        TO W-ARCH6-KEY
  7592         MOVE PI-COMPANY-CD      TO W-ARCH6-COMPANY-CD
  7593         MOVE PI-690-INIT-ENTRY  TO W-ARCH6-ENTRY
  7594
  7595
  7596     ELSE
  7597         IF  W-FIRST-CHANGE-FOUND
  7598             MOVE HIGH-VALUES    TO W-ARCH6-KEY
  7599             MOVE PI-COMPANY-CD  TO W-ARCH6-COMPANY-CD
  7600             MOVE PI-690-LAST-ENTRY
  7601                                 TO W-ARCH6-ENTRY
  7602
  7603         ELSE
  7604             MOVE PI-COMPANY-CD  TO W-ARCH6-COMPANY-CD
  7605             MOVE PI-690-FIRST-ENTRY
  7606                                 TO W-ARCH6-ENTRY
  7607             MOVE PI-690-FIRST-ARCHIVE-NO
  7608                                 TO W-ARCH6-ARCHIVE-NO.
  7609
  7610
  7611* EXEC CICS HANDLE CONDITION
  7612*        NOTFND  (8080-ARCH-NOT-FOUND)
  7613*        ENDFILE (8080-ARCH-NOT-FOUND)
  7614*        NOTOPEN (8040-ARCH6-NOT-OPEN)
  7615*        END-EXEC.
  7616*    MOVE '"$I''J                 ! 9 #00007099' TO DFHEIV0
  7617     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  7618     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7619     MOVE X'3920233030303037303939' TO DFHEIV0(25:11)
  7620     CALL 'kxdfhei1' USING DFHEIV0
  7621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7622
  7623
  7624
  7625* EXEC CICS STARTBR
  7626*        DATASET  (W-ARCH6-FILE-ID)
  7627*        RIDFLD   (W-ARCH6-KEY)
  7628*        GTEQ
  7629*        END-EXEC.
  7630     MOVE 0
  7631       TO DFHEIV11
  7632*    MOVE '&,         G          &   #00007105' TO DFHEIV0
  7633     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7634     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7635     MOVE X'2020233030303037313035' TO DFHEIV0(25:11)
  7636     CALL 'kxdfhei1' USING DFHEIV0,
  7637           W-ARCH6-FILE-ID,
  7638           W-ARCH6-KEY,
  7639           DFHEIV99,
  7640           DFHEIV11,
  7641           DFHEIV99
  7642     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7643
  7644
  7645
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 152
* EL690.cbl
  7646* EXEC CICS HANDLE CONDITION
  7647*        NOTFND  (3500-END-BROWSE)
  7648*        ENDFILE (3500-END-BROWSE)
  7649*        END-EXEC.
  7650*    MOVE '"$I''                  ! : #00007111' TO DFHEIV0
  7651     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7652     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7653     MOVE X'3A20233030303037313131' TO DFHEIV0(25:11)
  7654     CALL 'kxdfhei1' USING DFHEIV0
  7655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7656
  7657
  7658     PERFORM 7400-READ-ARCH6-FILE-NEXT THRU 7400-EXIT.
  7659
  7660     IF  W-CHANGE-REQUESTED
  7661             OR
  7662         W-READ-PREV-TWICE
  7663         MOVE SPACES            TO W-READ-PREV-TWICE-IND
  7664         PERFORM 7450-READ-PREV-ARCH6 THRU 7450-EXIT.
  7665
  7666 3500-BUILD-ARCH6-LIST-BACKWARD.
  7667
  7668     PERFORM 7450-READ-PREV-ARCH6 THRU 7450-EXIT.
  7669
  7670     IF  LA-COMPANY-CD-A5 NOT EQUAL PI-COMPANY-CD
  7671         GO TO 3500-END.
  7672
  7673     IF  PI-690-INIT-ENTRY EQUAL HIGH-VALUES OR LOW-VALUES
  7674         GO TO 3500-CONTINUE.
  7675
  7676     IF  LA-ENTRY-A6 NOT EQUAL PI-690-INIT-ENTRY
  7677         GO TO 3500-END-BROWSE.
  7678
  7679 3500-CONTINUE.
  7680
  7681     IF  NOT PI-690-SELECT-ALL
  7682             AND
  7683         LA-STATUS NOT EQUAL PI-690-STATUS-SELECTION-IND
  7684         GO TO 3500-BUILD-ARCH6-LIST-BACKWARD.
  7685
  7686     IF  PI-690-INIT-FORM NOT EQUAL HIGH-VALUES
  7687             AND
  7688         PI-690-INIT-FORM NOT EQUAL LOW-VALUES
  7689         IF  LA-FORM-A3 NOT EQUAL PI-690-INIT-FORM
  7690             GO TO 3500-BUILD-ARCH6-LIST-BACKWARD.
  7691
  7692     IF  PI-690-INIT-PROCESSOR NOT EQUAL HIGH-VALUES
  7693             AND
  7694         PI-690-INIT-PROCESSOR NOT EQUAL LOW-VALUES
  7695         IF  LA-PROCESSOR-CD NOT EQUAL PI-690-INIT-PROCESSOR
  7696             GO TO 3500-BUILD-ARCH6-LIST-BACKWARD.
  7697
  7698     IF  PI-690-INIT-CARRIER NOT EQUAL HIGH-VALUES
  7699             AND
  7700         PI-690-INIT-CARRIER NOT EQUAL LOW-VALUES
  7701         IF  LA-CARRIER-A2 NOT EQUAL PI-690-INIT-CARRIER
  7702             GO TO 3500-BUILD-ARCH6-LIST-BACKWARD.
  7703
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 153
* EL690.cbl
  7704     IF  PI-690-INIT-GROUPING NOT EQUAL HIGH-VALUES
  7705             AND
  7706         PI-690-INIT-GROUPING NOT EQUAL LOW-VALUES
  7707         IF  LA-GROUPING-A2 NOT EQUAL PI-690-INIT-GROUPING
  7708             GO TO 3500-BUILD-ARCH6-LIST-BACKWARD.
  7709
  7710     IF  PI-690-INIT-STATE NOT EQUAL HIGH-VALUES
  7711             AND
  7712         PI-690-INIT-STATE NOT EQUAL LOW-VALUES
  7713         IF  LA-STATE-A2 NOT EQUAL PI-690-INIT-STATE
  7714             GO TO 3500-BUILD-ARCH6-LIST-BACKWARD.
  7715
  7716     IF  PI-690-INIT-ACCOUNT NOT EQUAL HIGH-VALUES
  7717             AND
  7718         PI-690-INIT-ACCOUNT NOT EQUAL LOW-VALUES
  7719         IF  LA-ACCOUNT-A2 NOT EQUAL PI-690-INIT-ACCOUNT
  7720             GO TO 3500-BUILD-ARCH6-LIST-BACKWARD.
  7721
  7722     MOVE LA-ARCHIVE-NO          TO W-ARCH-NUMBER.
  7723
  7724     PERFORM 6000-SELECT-FOR-OUTPUT THRU 6000-EXIT.
  7725
  7726     IF  W-ARCH-NDX LESS THAN +13
  7727         GO TO 3500-BUILD-ARCH6-LIST-BACKWARD.
  7728
  7729 3500-END.
  7730
  7731     MOVE -1                     TO CORRSELL.
  7732     MOVE ZEROS                  TO CORRSELO.
  7733     PERFORM 3500-END-BROWSE
  7734     GO TO 8100-SEND-INITIAL-MAP.
  7735
  7736 3500-END-BROWSE.
  7737
  7738     MOVE W-ARCH-NDX             TO W-ARCH-NDX3.
  7739     SUBTRACT +1 FROM W-ARCH-NDX3.
  7740
  7741     IF  W-ARCH-NDX3 GREATER THAN +1
  7742         MOVE +1 TO W-ARCH-NDX2
  7743         PERFORM 6500-REVERSE-TABLE-DATA THRU 6500-EXIT
  7744                 UNTIL
  7745             W-ARCH-NDX2 NOT LESS W-ARCH-NDX3.
  7746
  7747
  7748* EXEC CICS ENDBR
  7749*        DATASET (W-ARCH6-FILE-ID)
  7750*    END-EXEC.
  7751     MOVE 0
  7752       TO DFHEIV11
  7753*    MOVE '&2                    $   #00007205' TO DFHEIV0
  7754     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7755     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7756     MOVE X'2020233030303037323035' TO DFHEIV0(25:11)
  7757     CALL 'kxdfhei1' USING DFHEIV0,
  7758           W-ARCH6-FILE-ID,
  7759           DFHEIV11,
  7760           DFHEIV99
  7761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 154
* EL690.cbl
  7762
  7763
  7764 3500-FRONT-OF-FILE.
  7765
  7766     MOVE ER-0131                TO EMI-ERROR.
  7767     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7768     MOVE -1                     TO CORRSELL.
  7769     MOVE ZEROS                  TO CORRSELO.
  7770     GO TO 8100-SEND-INITIAL-MAP.
  7771
  7772 3500-EXIT.
  7773     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 155
* EL690.cbl
  7775 3600-ARCH-PROCESS.
  7776
  7777     IF  W-CHANGE-REQUESTED
  7778         MOVE HIGH-VALUES        TO W-ARCH-KEY
  7779         MOVE PI-COMPANY-CD      TO W-ARCH-COMPANY-CD
  7780
  7781     ELSE
  7782         IF  W-FIRST-CHANGE-FOUND
  7783             MOVE HIGH-VALUES    TO W-ARCH-KEY
  7784             MOVE PI-COMPANY-CD  TO W-ARCH-COMPANY-CD
  7785             MOVE PI-690-LAST-ARCHIVE-NO
  7786                                 TO W-ARCH-ARCHIVE-NO
  7787
  7788         ELSE
  7789             MOVE PI-COMPANY-CD  TO W-ARCH-COMPANY-CD
  7790             MOVE PI-690-FIRST-ARCHIVE-NO
  7791                                 TO W-ARCH-ARCHIVE-NO
  7792             MOVE PI-690-FIRST-ARCHIVE-NO
  7793                                 TO W-ARCH-ARCHIVE-NO.
  7794
  7795
  7796* EXEC CICS HANDLE CONDITION
  7797*        NOTFND  (8080-ARCH-NOT-FOUND)
  7798*        ENDFILE (8080-ARCH-NOT-FOUND)
  7799*        NOTOPEN (8050-ARCH-NOT-OPEN)
  7800*        END-EXEC.
  7801*    MOVE '"$I''J                 ! ; #00007240' TO DFHEIV0
  7802     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  7803     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7804     MOVE X'3B20233030303037323430' TO DFHEIV0(25:11)
  7805     CALL 'kxdfhei1' USING DFHEIV0
  7806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7807
  7808
  7809
  7810* EXEC CICS STARTBR
  7811*        DATASET  (W-ARCH-FILE-ID)
  7812*        RIDFLD   (W-ARCH-KEY)
  7813*        GTEQ
  7814*        END-EXEC.
  7815     MOVE 0
  7816       TO DFHEIV11
  7817*    MOVE '&,         G          &   #00007246' TO DFHEIV0
  7818     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7819     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7820     MOVE X'2020233030303037323436' TO DFHEIV0(25:11)
  7821     CALL 'kxdfhei1' USING DFHEIV0,
  7822           W-ARCH-FILE-ID,
  7823           W-ARCH-KEY,
  7824           DFHEIV99,
  7825           DFHEIV11,
  7826           DFHEIV99
  7827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7828
  7829
  7830
  7831* EXEC CICS HANDLE CONDITION
  7832*        NOTFND  (3600-END-BROWSE)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 156
* EL690.cbl
  7833*        ENDFILE (3600-END-BROWSE)
  7834*        END-EXEC.
  7835*    MOVE '"$I''                  ! < #00007252' TO DFHEIV0
  7836     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7837     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7838     MOVE X'3C20233030303037323532' TO DFHEIV0(25:11)
  7839     CALL 'kxdfhei1' USING DFHEIV0
  7840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7841
  7842
  7843     PERFORM 7500-READ-ARCH-FILE-NEXT THRU 7500-EXIT.
  7844
  7845     IF  W-CHANGE-REQUESTED
  7846             OR
  7847         W-READ-PREV-TWICE
  7848         MOVE SPACES            TO W-READ-PREV-TWICE-IND
  7849         PERFORM 7550-READ-PREV-ARCH THRU 7550-EXIT.
  7850
  7851 3600-BUILD-ARCH-LIST-BACKWARD.
  7852
  7853     PERFORM 7550-READ-PREV-ARCH THRU 7550-EXIT.
  7854
  7855     IF  LA-COMPANY-CD-A5 NOT EQUAL PI-COMPANY-CD
  7856         GO TO 3600-END.
  7857
  7858     IF  PI-690-INIT-ENTRY NOT EQUAL HIGH-VALUES
  7859             AND
  7860         PI-690-INIT-ENTRY NOT EQUAL LOW-VALUES
  7861         IF  PI-690-INIT-ENTRY NOT EQUAL LA-ENTRY-A6
  7862             GO TO 3600-BUILD-ARCH-LIST-BACKWARD.
  7863
  7864     IF  PI-690-INIT-PROCESSOR NOT EQUAL HIGH-VALUES
  7865             AND
  7866         PI-690-INIT-PROCESSOR NOT EQUAL LOW-VALUES
  7867         IF  PI-690-INIT-PROCESSOR NOT EQUAL LA-PROCESSOR-CD
  7868             GO TO 3600-BUILD-ARCH-LIST-BACKWARD.
  7869
  7870     IF  PI-690-INIT-FORM NOT EQUAL HIGH-VALUES
  7871             AND
  7872         PI-690-INIT-FORM NOT EQUAL LOW-VALUES
  7873         IF  PI-690-INIT-FORM NOT EQUAL LA-FORM-A3
  7874             GO TO 3600-BUILD-ARCH-LIST-BACKWARD.
  7875
  7876     IF  PI-690-INIT-CARRIER NOT EQUAL HIGH-VALUES
  7877             AND
  7878         PI-690-INIT-CARRIER NOT EQUAL LOW-VALUES
  7879         IF  LA-CARRIER-A2 NOT EQUAL PI-690-INIT-CARRIER
  7880             GO TO 3600-BUILD-ARCH-LIST-BACKWARD.
  7881
  7882     IF  PI-690-INIT-GROUPING NOT EQUAL HIGH-VALUES
  7883             AND
  7884         PI-690-INIT-GROUPING NOT EQUAL LOW-VALUES
  7885         IF  LA-GROUPING-A2 NOT EQUAL PI-690-INIT-GROUPING
  7886             GO TO 3600-BUILD-ARCH-LIST-BACKWARD.
  7887
  7888     IF  PI-690-INIT-STATE NOT EQUAL HIGH-VALUES
  7889             AND
  7890         PI-690-INIT-STATE NOT EQUAL LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 157
* EL690.cbl
  7891         IF  LA-STATE-A2 NOT EQUAL PI-690-INIT-STATE
  7892             GO TO 3600-BUILD-ARCH-LIST-BACKWARD.
  7893
  7894     IF  PI-690-INIT-ACCOUNT NOT EQUAL HIGH-VALUES
  7895             AND
  7896         PI-690-INIT-ACCOUNT NOT EQUAL LOW-VALUES
  7897         IF  LA-ACCOUNT-A2 NOT EQUAL PI-690-INIT-ACCOUNT
  7898             GO TO 3600-BUILD-ARCH-LIST-BACKWARD.
  7899
  7900     IF  NOT PI-690-SELECT-ALL
  7901             AND
  7902         LA-STATUS NOT EQUAL PI-690-STATUS-SELECTION-IND
  7903         GO TO 3600-BUILD-ARCH-LIST-BACKWARD.
  7904
  7905     MOVE LA-ARCHIVE-NO          TO W-ARCH-NUMBER.
  7906
  7907     PERFORM 6000-SELECT-FOR-OUTPUT THRU 6000-EXIT.
  7908
  7909     IF  W-ARCH-NDX LESS THAN +13
  7910         GO TO 3600-BUILD-ARCH-LIST-BACKWARD.
  7911
  7912 3600-END.
  7913
  7914     MOVE -1                     TO CORRSELL.
  7915     MOVE ZEROS                  TO CORRSELO.
  7916     PERFORM 3600-END-BROWSE
  7917     GO TO 8100-SEND-INITIAL-MAP.
  7918
  7919 3600-END-BROWSE.
  7920
  7921     MOVE W-ARCH-NDX             TO W-ARCH-NDX3.
  7922     SUBTRACT +1 FROM W-ARCH-NDX3.
  7923
  7924     IF  W-ARCH-NDX3 GREATER THAN +1
  7925         MOVE +1 TO W-ARCH-NDX2
  7926         PERFORM 6500-REVERSE-TABLE-DATA THRU 6500-EXIT
  7927                 UNTIL
  7928             W-ARCH-NDX2 NOT LESS W-ARCH-NDX3.
  7929
  7930
  7931* EXEC CICS ENDBR
  7932*        DATASET (W-ARCH-FILE-ID)
  7933*    END-EXEC.
  7934     MOVE 0
  7935       TO DFHEIV11
  7936*    MOVE '&2                    $   #00007344' TO DFHEIV0
  7937     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7938     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7939     MOVE X'2020233030303037333434' TO DFHEIV0(25:11)
  7940     CALL 'kxdfhei1' USING DFHEIV0,
  7941           W-ARCH-FILE-ID,
  7942           DFHEIV11,
  7943           DFHEIV99
  7944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7945
  7946
  7947 3600-FRONT-OF-FILE.
  7948
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 158
* EL690.cbl
  7949     MOVE ER-0131                TO EMI-ERROR.
  7950     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7951     MOVE -1                     TO CORRSELL.
  7952     MOVE ZEROS                  TO CORRSELO.
  7953     GO TO 8100-SEND-INITIAL-MAP.
  7954
  7955 3600-EXIT.
  7956     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 159
* EL690.cbl
  7958 6000-SELECT-FOR-OUTPUT.
  7959
  7960     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
  7961             AND
  7962         PI-CARRIER-SECURITY NOT EQUAL LA-CARRIER-A2
  7963
  7964         IF  EMI-ERROR NOT EQUAL ER-9150
  7965             MOVE ER-9150        TO EMI-ERROR
  7966             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7967             GO TO 6000-EXIT
  7968
  7969         ELSE
  7970             GO TO 6000-EXIT.
  7971
  7972     IF LA-TEMP
  7973         GO TO 6000-EXIT
  7974     END-IF.
  7975
  7976     PERFORM 6100-TABLE-LINE-CREATE  THRU 6100-EXIT.
  7977
  7978     MOVE W-ARCH-NDX             TO PI-690-LAST-ARCH-NDX.
  7979     ADD +1                      TO W-ARCH-NDX.
  7980
  7981
  7982     IF  EIBAID EQUAL DFHPF1
  7983         MOVE LA-CARRIER-A2      TO PI-690-LAST-CARRIER
  7984         MOVE LA-GROUPING-A2     TO PI-690-LAST-GROUPING
  7985         MOVE LA-STATE-A2        TO PI-690-LAST-STATE
  7986         MOVE LA-ACCOUNT-A2      TO PI-690-LAST-ACCOUNT
  7987         MOVE LA-CERT-PRIME-A2   TO PI-690-LAST-CERT-PRIME
  7988         MOVE LA-CERT-SUFFIX-A2  TO PI-690-LAST-SUFFIX
  7989         MOVE LA-EFFECT-DATE-A2  TO PI-690-LAST-EFFECT-DATE
  7990         MOVE LA-FORM-A3         TO PI-690-LAST-FORM
  7991         MOVE LA-PROCESSOR-CD    TO PI-690-LAST-PROCESSOR
  7992         MOVE LA-ENTRY-A6        TO PI-690-LAST-ENTRY
  7993         MOVE LA-ARCHIVE-NO      TO PI-690-LAST-ARCHIVE-NO
  7994
  7995         IF  PI-690-FIRST-DATA EQUAL LOW-VALUES
  7996                 OR
  7997             PI-690-FIRST-DATA EQUAL HIGH-VALUES
  7998             MOVE PI-690-LAST-DATA
  7999                                 TO PI-690-FIRST-DATA
  8000
  8001         ELSE
  8002             NEXT SENTENCE
  8003
  8004     ELSE
  8005         MOVE LA-CARRIER-A2      TO PI-690-FIRST-CARRIER
  8006         MOVE LA-GROUPING-A2     TO PI-690-FIRST-GROUPING
  8007         MOVE LA-STATE-A2        TO PI-690-FIRST-STATE
  8008         MOVE LA-ACCOUNT-A2      TO PI-690-FIRST-ACCOUNT
  8009         MOVE LA-CERT-PRIME-A2   TO PI-690-FIRST-CERT-PRIME
  8010         MOVE LA-CERT-SUFFIX-A2  TO PI-690-FIRST-SUFFIX
  8011         MOVE LA-EFFECT-DATE-A2  TO PI-690-FIRST-EFFECT-DATE
  8012         MOVE LA-FORM-A3         TO PI-690-FIRST-FORM
  8013         MOVE LA-PROCESSOR-CD    TO PI-690-FIRST-PROCESSOR
  8014         MOVE LA-ENTRY-A6        TO PI-690-FIRST-ENTRY
  8015         MOVE LA-ARCHIVE-NO      TO PI-690-FIRST-ARCHIVE-NO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 160
* EL690.cbl
  8016
  8017         IF  PI-690-LAST-DATA EQUAL LOW-VALUES
  8018                 OR
  8019             PI-690-LAST-DATA EQUAL HIGH-VALUES
  8020             MOVE PI-690-FIRST-DATA
  8021                                 TO PI-690-LAST-DATA.
  8022
  8023 6000-EXIT.
  8024     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 161
* EL690.cbl
  8026 6100-TABLE-LINE-CREATE.
  8027
  8028     MOVE LA-ARCHIVE-NO
  8029         TO W-ARCNOO (W-ARCH-NDX)
  8030            PI-690-ARCHIVE-NUM (W-ARCH-NDX).
  8031
  8032*    MOVE LA-STATUS              TO W-STATSO (W-ARCH-NDX).
  8033     MOVE LA-FORM-A3             TO W-FORMO (W-ARCH-NDX).
  8034     MOVE LA-PROCESSOR-CD        TO W-USRIDO (W-ARCH-NDX).
  8035
  8036*    IF  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  8037*        MOVE 'F'                TO W-PRRSTO (W-ARCH-NDX)
  8038*
  8039*    ELSE
  8040*        IF  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  8041*            MOVE 'P'            TO W-PRRSTO (W-ARCH-NDX)
  8042*
  8043*        ELSE
  8044*            IF  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  8045*                MOVE 'C'        TO W-PRRSTO (W-ARCH-NDX)
  8046*
  8047*            ELSE
  8048*                MOVE SPACES     TO W-PRRSTO (W-ARCH-NDX).
  8049
  8050     IF  LA-INITIAL-PRINT-DATE GREATER THAN LOW-VALUES
  8051*        MOVE AL-PABON           TO W-PRINTA (W-ARCH-NDX)
  8052         MOVE LA-INITIAL-PRINT-DATE
  8053                                 TO DC-BIN-DATE-1
  8054         MOVE ' '                TO DC-OPTION-CODE
  8055         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8056
  8057         IF  DC-ERROR-CODE EQUAL SPACES
  8058             MOVE DC-GREG-DATE-1-EDIT
  8059                                 TO W-PRINTO (W-ARCH-NDX)
  8060
  8061         ELSE
  8062             MOVE SPACES         TO W-PRINTO (W-ARCH-NDX)
  8063         END-IF
  8064     ELSE
  8065         MOVE SPACES             TO W-PRINTO (W-ARCH-NDX)
  8066     END-IF.
  8067
  8068*        IF  LA-CREATION-DATE GREATER THAN LOW-VALUES
  8069*            MOVE LA-CREATION-DATE
  8070*                                TO DC-BIN-DATE-1
  8071*            MOVE ' '            TO DC-OPTION-CODE
  8072*            PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8073*
  8074*            IF  DC-ERROR-CODE EQUAL SPACES
  8075*                MOVE DC-GREG-DATE-1-EDIT
  8076*                                TO W-CREATO (W-ARCH-NDX)
  8077*
  8078*            ELSE
  8079*                MOVE SPACES     TO W-CREATO (W-ARCH-NDX)
  8080*
  8081*        ELSE
  8082*            MOVE SPACES         TO W-CREATO (W-ARCH-NDX).
  8083
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 162
* EL690.cbl
  8084
  8085*    IF  LA-FOLLOW-UP-DATE GREATER THAN LOW-VALUES
  8086*        MOVE LA-FOLLOW-UP-DATE  TO DC-BIN-DATE-1
  8087*        MOVE ' '                TO DC-OPTION-CODE
  8088*        PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8089*
  8090*        IF  DC-ERROR-CODE EQUAL SPACES
  8091*            MOVE DC-GREG-DATE-1-EDIT
  8092*                                TO W-FOLUPO (W-ARCH-NDX)
  8093*
  8094*        ELSE
  8095*            MOVE SPACES         TO W-FOLUPO (W-ARCH-NDX)
  8096*
  8097*    ELSE
  8098*        MOVE SPACES             TO W-FOLUPO (W-ARCH-NDX).
  8099*
  8100
  8101*    IF  LA-SENT-DATE   GREATER THAN LOW-VALUES
  8102*        MOVE 'C'                TO W-RSSTSO (W-ARCH-NDX)
  8103*    ELSE
  8104*        MOVE 'A'                TO W-RSSTSO (W-ARCH-NDX)
  8105*    END-IF
  8106
  8107     IF  LA-RESEND-DATE   GREATER THAN LOW-VALUES
  8108         MOVE LA-RESEND-DATE
  8109                             TO DC-BIN-DATE-1
  8110         MOVE ' '            TO DC-OPTION-CODE
  8111         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8112
  8113         IF  DC-ERROR-CODE EQUAL SPACES
  8114             MOVE DC-GREG-DATE-1-EDIT
  8115                             TO W-RSDATO (W-ARCH-NDX)
  8116
  8117         ELSE
  8118             MOVE SPACES     TO W-RSDATO (W-ARCH-NDX)
  8119
  8120     ELSE
  8121         MOVE SPACES         TO W-RSDATO (W-ARCH-NDX)
  8122                                W-RSFRMO (W-ARCH-NDX)
  8123         GO TO 6100-CHECK-REPLY.
  8124
  8125
  8126     IF LA-RESEND-LETR NOT = SPACES
  8127        MOVE LA-RESEND-LETR      TO W-RSFRMO (W-ARCH-NDX)
  8128     ELSE
  8129        MOVE SPACES              TO W-RSFRMO (W-ARCH-NDX)
  8130     END-IF
  8131*    IF  LA-SENT-DATE-2 GREATER THAN LOW-VALUES
  8132*        MOVE AL-UABON           TO W-RSFRMA (W-ARCH-NDX)
  8133*        MOVE LA-SENT-DATE-2     TO DC-BIN-DATE-1
  8134*        MOVE ' '                TO DC-OPTION-CODE
  8135*        PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8136*
  8137*        IF  DC-ERROR-CODE EQUAL SPACES
  8138*            MOVE DC-GREG-DATE-1-EDIT
  8139*                                TO W-RSFRMO (W-ARCH-NDX)
  8140*
  8141*        ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 163
* EL690.cbl
  8142*            MOVE SPACES         TO W-RSFRMO (W-ARCH-NDX)
  8143*
  8144*    ELSE
  8145*        IF  LA-RESEND-DATE-2 GREATER THAN LOW-VALUES
  8146*            MOVE LA-RESEND-DATE-2
  8147*                                TO DC-BIN-DATE-1
  8148*            MOVE ' '            TO DC-OPTION-CODE
  8149*            PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8150*
  8151*            IF  DC-ERROR-CODE EQUAL SPACES
  8152*                MOVE DC-GREG-DATE-1-EDIT
  8153*                                TO W-RSFRMO (W-ARCH-NDX)
  8154*
  8155*            ELSE
  8156*                MOVE SPACES     TO W-RSFRMO (W-ARCH-NDX)
  8157*
  8158*        ELSE
  8159*            MOVE SPACES         TO W-RSFRMO (W-ARCH-NDX)
  8160*                                   W-RSSTSO (W-ARCH-NDX)
  8161*            GO TO 6100-CHECK-REPLY.
  8162*
  8163*
  8164*    IF  LA-SENT-DATE-3 GREATER THAN LOW-VALUES
  8165*        MOVE AL-UABON           TO W-RSSTSA (W-ARCH-NDX)
  8166*        MOVE LA-SENT-DATE-3     TO DC-BIN-DATE-1
  8167*        MOVE ' '                TO DC-OPTION-CODE
  8168*        PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8169*
  8170*        IF  DC-ERROR-CODE EQUAL SPACES
  8171*            MOVE DC-GREG-DATE-1-EDIT
  8172*                                TO W-RSSTSO (W-ARCH-NDX)
  8173*
  8174*        ELSE
  8175*            MOVE SPACES         TO W-RSSTSO (W-ARCH-NDX)
  8176*
  8177*    ELSE
  8178*        IF  LA-RESEND-DATE-3 GREATER THAN LOW-VALUES
  8179*            MOVE LA-RESEND-DATE-3
  8180*                                TO DC-BIN-DATE-1
  8181*            MOVE ' '            TO DC-OPTION-CODE
  8182*            PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8183*
  8184*            IF  DC-ERROR-CODE EQUAL SPACES
  8185*                MOVE DC-GREG-DATE-1-EDIT
  8186*                                TO W-RSSTSO (W-ARCH-NDX)
  8187*
  8188*            ELSE
  8189*                MOVE SPACES     TO W-RSSTSO (W-ARCH-NDX)
  8190*
  8191*        ELSE
  8192*            MOVE SPACES         TO W-RSSTSO (W-ARCH-NDX).
  8193     .
  8194 6100-CHECK-REPLY.
  8195
  8196     IF  LA-PURGED-DATE GREATER THAN LOW-VALUES
  8197             AND
  8198         LA-PURGED-DATE NOT EQUAL SPACES
  8199*        MOVE LA-PURGED-DATE     TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 164
* EL690.cbl
  8200*        MOVE ' '                TO DC-OPTION-CODE
  8201*        PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8202
  8203*        IF  DC-ERROR-CODE EQUAL SPACES
  8204*            MOVE DC-GREG-DATE-1-EDIT
  8205*                                TO W-REPLYO (W-ARCH-NDX)
  8206             MOVE 'PURGED'       TO W-STATUSO (W-ARCH-NDX)
  8207
  8208*        ELSE
  8209*            MOVE SPACES         TO W-REPLYO (W-ARCH-NDX)
  8210*                                   W-STOPO (W-ARCH-NDX)
  8211*
  8212*        END-IF
  8213     ELSE
  8214         IF  LA-VOIDED-DATE GREATER THAN LOW-VALUES
  8215                 AND
  8216             LA-VOIDED-DATE NOT EQUAL SPACES
  8217*            MOVE LA-VOIDED-DATE TO DC-BIN-DATE-1
  8218*            MOVE ' '            TO DC-OPTION-CODE
  8219*            PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8220
  8221*            IF  DC-ERROR-CODE EQUAL SPACES
  8222*                MOVE AL-PANOF   TO W-REPLYA (W-ARCH-NDX)
  8223*                MOVE DC-GREG-DATE-1-EDIT
  8224*                                TO W-REPLYO (W-ARCH-NDX)
  8225                 MOVE 'STOPPED'  TO W-STATUSO (W-ARCH-NDX)
  8226
  8227*            ELSE
  8228*                MOVE AL-PANOF   TO W-REPLYA (W-ARCH-NDX)
  8229*                MOVE SPACES     TO W-REPLYO (W-ARCH-NDX)
  8230*                                   W-STOPO (W-ARCH-NDX)
  8231*
  8232*
  8233*            END-IF
  8234         ELSE
  8235             IF  LA-REPLY-DATE GREATER THAN LOW-VALUES
  8236                     AND
  8237                 LA-REPLY-DATE NOT EQUAL SPACES
  8238*                MOVE LA-REPLY-DATE
  8239*                                TO DC-BIN-DATE-1
  8240*                MOVE ' '        TO DC-OPTION-CODE
  8241*                PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8242*
  8243*                IF  DC-ERROR-CODE EQUAL SPACES
  8244*                    MOVE DC-GREG-DATE-1-EDIT
  8245*                                TO W-REPLYO (W-ARCH-NDX)
  8246                     MOVE 'RECEIVED' TO W-STATUSO (W-ARCH-NDX)
  8247
  8248*                ELSE
  8249*                    MOVE SPACES TO W-REPLYO (W-ARCH-NDX)
  8250*                                   W-STOPO (W-ARCH-NDX)
  8251*
  8252*                END-IF
  8253             ELSE
  8254                 IF LA-STATUS = 'A'
  8255                     MOVE 'ACTIVE' TO W-STATUSO (W-ARCH-NDX)
  8256                 ELSE
  8257                     IF LA-STATUS = 'C'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 165
* EL690.cbl
  8258                        MOVE 'COMPLETE' TO W-STATUSO (W-ARCH-NDX)
  8259                     ELSE
  8260                        MOVE SPACES     TO W-STATUSO (W-ARCH-NDX)
  8261                     END-IF
  8262                 END-IF
  8263             END-IF
  8264         END-IF
  8265     END-IF.
  8266
  8267
  8268 6100-EXIT.
  8269     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 166
* EL690.cbl
  8271 6500-REVERSE-TABLE-DATA.
  8272
  8273     MOVE W-ARCHGRP-DATA (W-ARCH-NDX2)
  8274                                 TO W-HOLD-LINE.
  8275     MOVE W-ARCHGRP-DATA (W-ARCH-NDX3)
  8276                                 TO W-ARCHGRP-DATA (W-ARCH-NDX2).
  8277     MOVE W-HOLD-LINE            TO W-ARCHGRP-DATA (W-ARCH-NDX3).
  8278     MOVE PI-690-ARCHIVE-NUM (W-ARCH-NDX2)
  8279                                 TO W-HOLD-ARCHIVE.
  8280     MOVE PI-690-ARCHIVE-NUM (W-ARCH-NDX3)
  8281         TO PI-690-ARCHIVE-NUM (W-ARCH-NDX2).
  8282     MOVE W-HOLD-ARCHIVE
  8283         TO PI-690-ARCHIVE-NUM (W-ARCH-NDX3).
  8284
  8285     ADD +1                      TO W-ARCH-NDX2.
  8286     SUBTRACT +1 FROM W-ARCH-NDX3.
  8287
  8288 6500-EXIT.
  8289     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 167
* EL690.cbl
  8291 7000-READ-ARCH2-FILE-NEXT.
  8292
  8293
  8294* EXEC CICS READNEXT
  8295*        DATASET  (W-ARCH2-FILE-ID)
  8296*        SET      (ADDRESS OF LETTER-ARCHIVE)
  8297*        RIDFLD   (W-ARCH2-KEY)
  8298*        END-EXEC.
  8299     MOVE 0
  8300       TO DFHEIV11
  8301*    MOVE '&.S                   )   #00007694' TO DFHEIV0
  8302     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8303     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8304     MOVE X'2020233030303037363934' TO DFHEIV0(25:11)
  8305     CALL 'kxdfhei1' USING DFHEIV0,
  8306           W-ARCH2-FILE-ID,
  8307           DFHEIV20,
  8308           DFHEIV99,
  8309           W-ARCH2-KEY,
  8310           DFHEIV99,
  8311           DFHEIV11,
  8312           DFHEIV99,
  8313           DFHEIV99
  8314     SET ADDRESS OF LETTER-ARCHIVE TO
  8315         DFHEIV20
  8316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8317
  8318
  8319 7000-EXIT.
  8320     EXIT.
  8321
  8322 7050-READ-PREV-ARCH2.
  8323
  8324
  8325* EXEC CICS READPREV
  8326*        DATASET  (W-ARCH2-FILE-ID)
  8327*        SET      (ADDRESS OF LETTER-ARCHIVE)
  8328*        RIDFLD   (W-ARCH2-KEY)
  8329*        END-EXEC.
  8330     MOVE 0
  8331       TO DFHEIV11
  8332*    MOVE '&0S                   )   #00007705' TO DFHEIV0
  8333     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8334     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8335     MOVE X'2020233030303037373035' TO DFHEIV0(25:11)
  8336     CALL 'kxdfhei1' USING DFHEIV0,
  8337           W-ARCH2-FILE-ID,
  8338           DFHEIV20,
  8339           DFHEIV99,
  8340           W-ARCH2-KEY,
  8341           DFHEIV99,
  8342           DFHEIV11,
  8343           DFHEIV99,
  8344           DFHEIV99
  8345     SET ADDRESS OF LETTER-ARCHIVE TO
  8346         DFHEIV20
  8347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8348
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 168
* EL690.cbl
  8349
  8350 7050-EXIT.
  8351     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 169
* EL690.cbl
  8353 7100-READ-ARCH3-FILE-NEXT.
  8354
  8355
  8356* EXEC CICS READNEXT
  8357*        DATASET  (W-ARCH3-FILE-ID)
  8358*        SET      (ADDRESS OF LETTER-ARCHIVE)
  8359*        RIDFLD   (W-ARCH3-KEY)
  8360*        END-EXEC.
  8361     MOVE 0
  8362       TO DFHEIV11
  8363*    MOVE '&.S                   )   #00007716' TO DFHEIV0
  8364     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8365     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8366     MOVE X'2020233030303037373136' TO DFHEIV0(25:11)
  8367     CALL 'kxdfhei1' USING DFHEIV0,
  8368           W-ARCH3-FILE-ID,
  8369           DFHEIV20,
  8370           DFHEIV99,
  8371           W-ARCH3-KEY,
  8372           DFHEIV99,
  8373           DFHEIV11,
  8374           DFHEIV99,
  8375           DFHEIV99
  8376     SET ADDRESS OF LETTER-ARCHIVE TO
  8377         DFHEIV20
  8378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8379
  8380
  8381 7100-EXIT.
  8382     EXIT.
  8383
  8384 7150-READ-PREV-ARCH3.
  8385
  8386
  8387* EXEC CICS READPREV
  8388*        DATASET  (W-ARCH3-FILE-ID)
  8389*        SET      (ADDRESS OF LETTER-ARCHIVE)
  8390*        RIDFLD   (W-ARCH3-KEY)
  8391*    END-EXEC.
  8392     MOVE 0
  8393       TO DFHEIV11
  8394*    MOVE '&0S                   )   #00007727' TO DFHEIV0
  8395     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8396     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8397     MOVE X'2020233030303037373237' TO DFHEIV0(25:11)
  8398     CALL 'kxdfhei1' USING DFHEIV0,
  8399           W-ARCH3-FILE-ID,
  8400           DFHEIV20,
  8401           DFHEIV99,
  8402           W-ARCH3-KEY,
  8403           DFHEIV99,
  8404           DFHEIV11,
  8405           DFHEIV99,
  8406           DFHEIV99
  8407     SET ADDRESS OF LETTER-ARCHIVE TO
  8408         DFHEIV20
  8409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8410
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 170
* EL690.cbl
  8411
  8412 7150-EXIT.
  8413     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 171
* EL690.cbl
  8415 7200-READ-ARCH4-FILE-NEXT.
  8416
  8417
  8418* EXEC CICS READNEXT
  8419*        DATASET  (W-ARCH4-FILE-ID)
  8420*        SET      (ADDRESS OF LETTER-ARCHIVE)
  8421*        RIDFLD   (W-ARCH4-KEY)
  8422*        END-EXEC.
  8423     MOVE 0
  8424       TO DFHEIV11
  8425*    MOVE '&.S                   )   #00007738' TO DFHEIV0
  8426     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8427     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8428     MOVE X'2020233030303037373338' TO DFHEIV0(25:11)
  8429     CALL 'kxdfhei1' USING DFHEIV0,
  8430           W-ARCH4-FILE-ID,
  8431           DFHEIV20,
  8432           DFHEIV99,
  8433           W-ARCH4-KEY,
  8434           DFHEIV99,
  8435           DFHEIV11,
  8436           DFHEIV99,
  8437           DFHEIV99
  8438     SET ADDRESS OF LETTER-ARCHIVE TO
  8439         DFHEIV20
  8440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8441
  8442
  8443 7200-EXIT.
  8444     EXIT.
  8445
  8446 7250-READ-PREV-ARCH4.
  8447
  8448
  8449* EXEC CICS READPREV
  8450*        DATASET  (W-ARCH4-FILE-ID)
  8451*        SET      (ADDRESS OF LETTER-ARCHIVE)
  8452*        RIDFLD   (W-ARCH4-KEY)
  8453*    END-EXEC.
  8454     MOVE 0
  8455       TO DFHEIV11
  8456*    MOVE '&0S                   )   #00007749' TO DFHEIV0
  8457     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8458     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8459     MOVE X'2020233030303037373439' TO DFHEIV0(25:11)
  8460     CALL 'kxdfhei1' USING DFHEIV0,
  8461           W-ARCH4-FILE-ID,
  8462           DFHEIV20,
  8463           DFHEIV99,
  8464           W-ARCH4-KEY,
  8465           DFHEIV99,
  8466           DFHEIV11,
  8467           DFHEIV99,
  8468           DFHEIV99
  8469     SET ADDRESS OF LETTER-ARCHIVE TO
  8470         DFHEIV20
  8471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8472
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 172
* EL690.cbl
  8473
  8474 7250-EXIT.
  8475     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 173
* EL690.cbl
  8477 7300-READ-ARCH5-FILE-NEXT.
  8478
  8479
  8480* EXEC CICS READNEXT
  8481*        DATASET  (W-ARCH5-FILE-ID)
  8482*        SET      (ADDRESS OF LETTER-ARCHIVE)
  8483*        RIDFLD   (W-ARCH5-KEY)
  8484*        END-EXEC.
  8485     MOVE 0
  8486       TO DFHEIV11
  8487*    MOVE '&.S                   )   #00007760' TO DFHEIV0
  8488     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8489     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8490     MOVE X'2020233030303037373630' TO DFHEIV0(25:11)
  8491     CALL 'kxdfhei1' USING DFHEIV0,
  8492           W-ARCH5-FILE-ID,
  8493           DFHEIV20,
  8494           DFHEIV99,
  8495           W-ARCH5-KEY,
  8496           DFHEIV99,
  8497           DFHEIV11,
  8498           DFHEIV99,
  8499           DFHEIV99
  8500     SET ADDRESS OF LETTER-ARCHIVE TO
  8501         DFHEIV20
  8502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8503
  8504
  8505 7300-EXIT.
  8506     EXIT.
  8507
  8508 7350-READ-PREV-ARCH5.
  8509
  8510
  8511* EXEC CICS READPREV
  8512*        DATASET  (W-ARCH5-FILE-ID)
  8513*        SET      (ADDRESS OF LETTER-ARCHIVE)
  8514*        RIDFLD   (W-ARCH5-KEY)
  8515*    END-EXEC.
  8516     MOVE 0
  8517       TO DFHEIV11
  8518*    MOVE '&0S                   )   #00007771' TO DFHEIV0
  8519     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8520     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8521     MOVE X'2020233030303037373731' TO DFHEIV0(25:11)
  8522     CALL 'kxdfhei1' USING DFHEIV0,
  8523           W-ARCH5-FILE-ID,
  8524           DFHEIV20,
  8525           DFHEIV99,
  8526           W-ARCH5-KEY,
  8527           DFHEIV99,
  8528           DFHEIV11,
  8529           DFHEIV99,
  8530           DFHEIV99
  8531     SET ADDRESS OF LETTER-ARCHIVE TO
  8532         DFHEIV20
  8533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8534
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 174
* EL690.cbl
  8535
  8536 7350-EXIT.
  8537     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 175
* EL690.cbl
  8539 7400-READ-ARCH6-FILE-NEXT.
  8540
  8541
  8542* EXEC CICS READNEXT
  8543*        DATASET  (W-ARCH6-FILE-ID)
  8544*        SET      (ADDRESS OF LETTER-ARCHIVE)
  8545*        RIDFLD   (W-ARCH6-KEY)
  8546*        END-EXEC.
  8547     MOVE 0
  8548       TO DFHEIV11
  8549*    MOVE '&.S                   )   #00007782' TO DFHEIV0
  8550     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8551     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8552     MOVE X'2020233030303037373832' TO DFHEIV0(25:11)
  8553     CALL 'kxdfhei1' USING DFHEIV0,
  8554           W-ARCH6-FILE-ID,
  8555           DFHEIV20,
  8556           DFHEIV99,
  8557           W-ARCH6-KEY,
  8558           DFHEIV99,
  8559           DFHEIV11,
  8560           DFHEIV99,
  8561           DFHEIV99
  8562     SET ADDRESS OF LETTER-ARCHIVE TO
  8563         DFHEIV20
  8564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8565
  8566
  8567 7400-EXIT.
  8568     EXIT.
  8569
  8570 7450-READ-PREV-ARCH6.
  8571
  8572
  8573* EXEC CICS READPREV
  8574*        DATASET  (W-ARCH6-FILE-ID)
  8575*        SET      (ADDRESS OF LETTER-ARCHIVE)
  8576*        RIDFLD   (W-ARCH6-KEY)
  8577*    END-EXEC.
  8578     MOVE 0
  8579       TO DFHEIV11
  8580*    MOVE '&0S                   )   #00007793' TO DFHEIV0
  8581     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8582     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8583     MOVE X'2020233030303037373933' TO DFHEIV0(25:11)
  8584     CALL 'kxdfhei1' USING DFHEIV0,
  8585           W-ARCH6-FILE-ID,
  8586           DFHEIV20,
  8587           DFHEIV99,
  8588           W-ARCH6-KEY,
  8589           DFHEIV99,
  8590           DFHEIV11,
  8591           DFHEIV99,
  8592           DFHEIV99
  8593     SET ADDRESS OF LETTER-ARCHIVE TO
  8594         DFHEIV20
  8595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8596
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 176
* EL690.cbl
  8597
  8598 7450-EXIT.
  8599     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 177
* EL690.cbl
  8601 7500-READ-ARCH-FILE-NEXT.
  8602
  8603
  8604* EXEC CICS READNEXT
  8605*        DATASET  (W-ARCH-FILE-ID)
  8606*        SET      (ADDRESS OF LETTER-ARCHIVE)
  8607*        RIDFLD   (W-ARCH-KEY)
  8608*        END-EXEC.
  8609     MOVE 0
  8610       TO DFHEIV11
  8611*    MOVE '&.S                   )   #00007804' TO DFHEIV0
  8612     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8613     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8614     MOVE X'2020233030303037383034' TO DFHEIV0(25:11)
  8615     CALL 'kxdfhei1' USING DFHEIV0,
  8616           W-ARCH-FILE-ID,
  8617           DFHEIV20,
  8618           DFHEIV99,
  8619           W-ARCH-KEY,
  8620           DFHEIV99,
  8621           DFHEIV11,
  8622           DFHEIV99,
  8623           DFHEIV99
  8624     SET ADDRESS OF LETTER-ARCHIVE TO
  8625         DFHEIV20
  8626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8627
  8628
  8629 7500-EXIT.
  8630     EXIT.
  8631
  8632 7550-READ-PREV-ARCH.
  8633
  8634
  8635* EXEC CICS READPREV
  8636*        DATASET  (W-ARCH-FILE-ID)
  8637*        SET      (ADDRESS OF LETTER-ARCHIVE)
  8638*        RIDFLD   (W-ARCH-KEY)
  8639*    END-EXEC.
  8640     MOVE 0
  8641       TO DFHEIV11
  8642*    MOVE '&0S                   )   #00007815' TO DFHEIV0
  8643     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8644     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8645     MOVE X'2020233030303037383135' TO DFHEIV0(25:11)
  8646     CALL 'kxdfhei1' USING DFHEIV0,
  8647           W-ARCH-FILE-ID,
  8648           DFHEIV20,
  8649           DFHEIV99,
  8650           W-ARCH-KEY,
  8651           DFHEIV99,
  8652           DFHEIV11,
  8653           DFHEIV99,
  8654           DFHEIV99
  8655     SET ADDRESS OF LETTER-ARCHIVE TO
  8656         DFHEIV20
  8657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8658
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 178
* EL690.cbl
  8659
  8660 7550-EXIT.
  8661     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 179
* EL690.cbl
  8663 7600-READ-ARCH-FILE.
  8664
  8665
  8666* EXEC CICS READ
  8667*        DATASET  (W-ARCH-FILE-ID)
  8668*        SET      (ADDRESS OF LETTER-ARCHIVE)
  8669*        RIDFLD   (W-ARCH-KEY)
  8670*        UPDATE
  8671*        END-EXEC.
  8672*    MOVE '&"S        EU         (   #00007826' TO DFHEIV0
  8673     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8674     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8675     MOVE X'2020233030303037383236' TO DFHEIV0(25:11)
  8676     CALL 'kxdfhei1' USING DFHEIV0,
  8677           W-ARCH-FILE-ID,
  8678           DFHEIV20,
  8679           DFHEIV99,
  8680           W-ARCH-KEY,
  8681           DFHEIV99,
  8682           DFHEIV99,
  8683           DFHEIV99
  8684     SET ADDRESS OF LETTER-ARCHIVE TO
  8685         DFHEIV20
  8686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8687
  8688
  8689 7600-EXIT.
  8690     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 180
* EL690.cbl
  8692 7650-READ-ARCT-FILE.
  8693
  8694
  8695* EXEC CICS READ
  8696*        DATASET  (W-ARCT-FILE-ID)
  8697*        SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
  8698*        RIDFLD   (W-ARCT-KEY)
  8699*        UPDATE
  8700*        END-EXEC.
  8701*    MOVE '&"S        EU         (   #00007838' TO DFHEIV0
  8702     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8703     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8704     MOVE X'2020233030303037383338' TO DFHEIV0(25:11)
  8705     CALL 'kxdfhei1' USING DFHEIV0,
  8706           W-ARCT-FILE-ID,
  8707           DFHEIV20,
  8708           DFHEIV99,
  8709           W-ARCT-KEY,
  8710           DFHEIV99,
  8711           DFHEIV99,
  8712           DFHEIV99
  8713     SET ADDRESS OF LETTER-ARCHIVE-TEXT TO
  8714         DFHEIV20
  8715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8716
  8717
  8718 7650-EXIT.
  8719     EXIT.
  8720
  8721 7750-READ-ARCH-FILE-NUPDT.
  8722
  8723
  8724* EXEC CICS READ
  8725*        DATASET  (W-ARCH-FILE-ID)
  8726*        SET      (ADDRESS OF LETTER-ARCHIVE)
  8727*        RIDFLD   (W-ARCH-KEY)
  8728*        END-EXEC.
  8729*    MOVE '&"S        E          (   #00007850' TO DFHEIV0
  8730     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8731     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8732     MOVE X'2020233030303037383530' TO DFHEIV0(25:11)
  8733     CALL 'kxdfhei1' USING DFHEIV0,
  8734           W-ARCH-FILE-ID,
  8735           DFHEIV20,
  8736           DFHEIV99,
  8737           W-ARCH-KEY,
  8738           DFHEIV99,
  8739           DFHEIV99,
  8740           DFHEIV99
  8741     SET ADDRESS OF LETTER-ARCHIVE TO
  8742         DFHEIV20
  8743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8744
  8745
  8746 7750-EXIT.
  8747     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 181
* EL690.cbl
  8749 7800-DELETE-CYCLE.
  8750
  8751
  8752* EXEC CICS HANDLE CONDITION
  8753*        NOTFND  (7800-EXIT)
  8754*        ENDFILE (7800-EXIT)
  8755*        END-EXEC.
  8756*    MOVE '"$I''                  ! = #00007861' TO DFHEIV0
  8757     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8758     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8759     MOVE X'3D20233030303037383631' TO DFHEIV0(25:11)
  8760     CALL 'kxdfhei1' USING DFHEIV0
  8761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8762
  8763
  8764*    PERFORM 7650-READ-ARCT-FILE THRU 7650-EXIT.
  8765
  8766
  8767* EXEC CICS DELETE
  8768*        DATASET   (W-ARCT-FILE-ID)
  8769*        RIDFLD    (W-ARCT-KEY)
  8770*        KEYLENGTH (5)
  8771*        GENERIC
  8772*    END-EXEC.
  8773     MOVE 5
  8774       TO DFHEIV11
  8775*    MOVE '&(  RKG               &   #00007868' TO DFHEIV0
  8776     MOVE X'26282020524B472020202020' TO DFHEIV0(1:12)
  8777     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8778     MOVE X'2020233030303037383638' TO DFHEIV0(25:11)
  8779     CALL 'kxdfhei1' USING DFHEIV0,
  8780           W-ARCT-FILE-ID,
  8781           W-ARCT-KEY,
  8782           DFHEIV11,
  8783           DFHEIV99,
  8784           DFHEIV99
  8785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8786
  8787
  8788
  8789* EXEC CICS DELETE
  8790*        DATASET   (W-ARCH-FILE-ID)
  8791*        RIDFLD    (W-ARCH-KEY)
  8792*    END-EXEC.
  8793*    MOVE '&(  R                 &   #00007875' TO DFHEIV0
  8794     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  8795     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8796     MOVE X'2020233030303037383735' TO DFHEIV0(25:11)
  8797     CALL 'kxdfhei1' USING DFHEIV0,
  8798           W-ARCH-FILE-ID,
  8799           W-ARCH-KEY,
  8800           DFHEIV99,
  8801           DFHEIV99,
  8802           DFHEIV99
  8803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8804
  8805
  8806     MOVE +99999999            TO PI-690-ARCHIVE-NUM (W-ARCH-NDX).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 182
* EL690.cbl
  8807     MOVE 1                      TO W-FIRST-CHANGE-IND.
  8808
  8809 7800-EXIT.
  8810     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 183
* EL690.cbl
  8812 8000-UNAUTHORIZED-ACCESS.
  8813
  8814     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  8815     GO TO 8300-SEND-TEXT.
  8816
  8817 8000-ARCH2-NOT-OPEN.
  8818
  8819     MOVE ER-7357                TO EMI-ERROR.
  8820     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8821     MOVE -1                     TO TYPEBRL.
  8822
  8823     GO TO 8100-SEND-INITIAL-MAP.
  8824
  8825 8010-ARCH3-NOT-OPEN.
  8826
  8827     MOVE ER-7366                TO EMI-ERROR.
  8828     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8829     MOVE -1                     TO TYPEBRL.
  8830
  8831     GO TO 8100-SEND-INITIAL-MAP.
  8832
  8833 8020-ARCH4-NOT-OPEN.
  8834
  8835     MOVE ER-7385                TO EMI-ERROR.
  8836     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8837     MOVE -1                     TO TYPEBRL.
  8838
  8839     GO TO 8100-SEND-INITIAL-MAP.
  8840
  8841 8030-ARCH5-NOT-OPEN.
  8842
  8843     MOVE ER-7386                TO EMI-ERROR.
  8844     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8845     MOVE -1                     TO TYPEBRL.
  8846
  8847     GO TO 8100-SEND-INITIAL-MAP.
  8848
  8849 8040-ARCH6-NOT-OPEN.
  8850
  8851     MOVE ER-7387                TO EMI-ERROR.
  8852     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8853     MOVE -1                     TO TYPEBRL.
  8854
  8855     GO TO 8100-SEND-INITIAL-MAP.
  8856
  8857 8050-ARCH-NOT-OPEN.
  8858
  8859     MOVE ER-7388                TO EMI-ERROR.
  8860     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8861     MOVE -1                     TO TYPEBRL.
  8862
  8863     GO TO 8100-SEND-INITIAL-MAP.
  8864
  8865 8070-NOTOPEN.
  8866
  8867     MOVE ER-9282                TO EMI-ERROR.
  8868     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8869     MOVE -1                     TO CERTRPL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 184
* EL690.cbl
  8870
  8871     GO TO 8100-SEND-INITIAL-MAP.
  8872
  8873 8080-ARCH-NOT-FOUND.
  8874
  8875     MOVE ER-9010                TO EMI-ERROR.
  8876     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8877     MOVE -1                     TO CERTRPL.
  8878     MOVE AL-UABON               TO CERTRPA.
  8879     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 185
* EL690.cbl
  8881
  8882 8090-NOT-FOUND-CNTL.
  8883
  8884     MOVE ER-0190                TO EMI-ERROR.
  8885     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8886     MOVE -1                     TO MAINTL.
  8887     MOVE AL-UABON               TO MAINTA.
  8888     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 186
* EL690.cbl
  8890 8100-SEND-INITIAL-MAP.
  8891******************************************************************
  8892*                                                                *
  8893*       THIS LOGIC SENDS THE INITIAL MAP.  IT WILL LOOK FOR      *
  8894*       THE MAP DATA UNDER THE NAMES LISTED BELOW AND FOUND      *
  8895*       IN THE WORK AREA SECTION OF WORKING STORAGE.             *
  8896*                                                                *
  8897*       W-MAP          PIC  X(08)                                *
  8898*       W-MAPSET       PIC  X(08)                                *
  8899*       W-MAP-AREA     PIC  X(**)                                *
  8900* ** THIS AREA REDEFINES MAP AREA AND IS MAP DEPENDENT           *
  8901*    FOR SIZE.                                                   *
  8902*                                                                *
  8903******************************************************************
  8904
  8905     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
  8906
  8907     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  8908
  8909
  8910* EXEC CICS SEND
  8911*        MAP    (W-MAP)
  8912*        MAPSET (W-MAPSET)
  8913*        FROM   (EL690AI)
  8914*        ERASE
  8915*        FREEKB
  8916*        CURSOR
  8917*    END-EXEC.
  8918     MOVE LENGTH OF
  8919      EL690AI
  8920       TO DFHEIV12
  8921     MOVE -1
  8922       TO DFHEIV11
  8923*    MOVE '8$     CT  E F  H L F ,   #00007983' TO DFHEIV0
  8924     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  8925     MOVE X'2046202048204C2046202C20' TO DFHEIV0(13:12)
  8926     MOVE X'2020233030303037393833' TO DFHEIV0(25:11)
  8927     CALL 'kxdfhei1' USING DFHEIV0,
  8928           W-MAP,
  8929           EL690AI,
  8930           DFHEIV12,
  8931           W-MAPSET,
  8932           DFHEIV99,
  8933           DFHEIV99,
  8934           DFHEIV99,
  8935           DFHEIV11,
  8936           DFHEIV99,
  8937           DFHEIV99,
  8938           DFHEIV99
  8939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8940
  8941
  8942     GO TO 9000-RETURN-TRANS.
  8943
  8944 8100-EXIT.
  8945     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 187
* EL690.cbl
  8947 8200-SEND-DATAONLY.
  8948******************************************************************
  8949*                                                                *
  8950*       THIS LOGIC SENDS THE UPDATED VERSION OF THE MAP, USING   *
  8951*       THE FIELDS LISTED BELOW WHICH SHOULD BE FOUND IN THE     *
  8952*       WORK AREA OF WORKING STORAGE.                            *
  8953*                                                                *
  8954*       W-MAP           PIC  X(08)                               *
  8955*       W-MAPSET        PIC  X(08)                               *
  8956*       W-MAP-AREA      PIC  X(****)                             *
  8957*                                                                *
  8958* **** REDEFINES MAP AREA AND IS MAP DEPENDENT.                  *
  8959*                                                                *
  8960******************************************************************
  8961
  8962     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
  8963
  8964     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  8965
  8966
  8967* EXEC CICS SEND
  8968*        MAP    (W-MAP)
  8969*        MAPSET (W-MAPSET)
  8970*        FROM   (EL690AI)
  8971*        DATAONLY
  8972*        FREEKB
  8973*        CURSOR
  8974*    END-EXEC.
  8975     MOVE LENGTH OF
  8976      EL690AI
  8977       TO DFHEIV12
  8978     MOVE -1
  8979       TO DFHEIV11
  8980*    MOVE '8$D    CT    F  H L F ,   #00008016' TO DFHEIV0
  8981     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  8982     MOVE X'2046202048204C2046202C20' TO DFHEIV0(13:12)
  8983     MOVE X'2020233030303038303136' TO DFHEIV0(25:11)
  8984     CALL 'kxdfhei1' USING DFHEIV0,
  8985           W-MAP,
  8986           EL690AI,
  8987           DFHEIV12,
  8988           W-MAPSET,
  8989           DFHEIV99,
  8990           DFHEIV99,
  8991           DFHEIV99,
  8992           DFHEIV11,
  8993           DFHEIV99,
  8994           DFHEIV99,
  8995           DFHEIV99
  8996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8997
  8998
  8999     GO TO 9000-RETURN-TRANS.
  9000
  9001 8200-EXIT.
  9002     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 188
* EL690.cbl
  9004 8300-SEND-TEXT.
  9005*****************************************************************
  9006*    THIS PARAGRAPH SENDS THE COMMON LOGOFF MESSAGE.            *
  9007*****************************************************************
  9008
  9009
  9010* EXEC CICS SEND TEXT
  9011*        FROM    (LOGOFF-TEXT)
  9012*        LENGTH  (LOGOFF-LENGTH)
  9013*        ERASE
  9014*        FREEKB
  9015*    END-EXEC.
  9016*    MOVE '8&      T  E F  H   F -   #00008035' TO DFHEIV0
  9017     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  9018     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  9019     MOVE X'2020233030303038303335' TO DFHEIV0(25:11)
  9020     CALL 'kxdfhei1' USING DFHEIV0,
  9021           LOGOFF-TEXT,
  9022           LOGOFF-LENGTH,
  9023           DFHEIV99,
  9024           DFHEIV99,
  9025           DFHEIV99,
  9026           DFHEIV99,
  9027           DFHEIV99,
  9028           DFHEIV99,
  9029           DFHEIV99,
  9030           DFHEIV99,
  9031           DFHEIV99,
  9032           DFHEIV99
  9033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9034
  9035
  9036     GO TO 9000-RETURN-TRANS.
  9037
  9038 8300-EXIT.
  9039     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 189
* EL690.cbl
  9041 9000-RETURN-TRANS.
  9042*****************************************************************
  9043*     THIS PARAGRAPH CAUSES THE PROGRAM TO EXIT TO A            *
  9044*     TRANSACTION.                                              *
  9045*     THE FOLLOWING FIELDS ARE NEEDED IN WORKING-STORAGE        *
  9046*     W-TRANSACTION          PIC  X(04)  VALUE 'XXXX'.          *
  9047*****************************************************************
  9048
  9049     MOVE EMI-ERROR-NUMBER(1)    TO PI-LAST-ERROR-NO.
  9050
  9051
  9052* EXEC CICS RETURN
  9053*        TRANSID  (W-TRANSACTION)
  9054*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  9055*        LENGTH   (PI-COMM-LENGTH)
  9056*    END-EXEC.
  9057*    MOVE '.(CT                  &   #00008057' TO DFHEIV0
  9058     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  9059     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9060     MOVE X'2020233030303038303537' TO DFHEIV0(25:11)
  9061     CALL 'kxdfhei1' USING DFHEIV0,
  9062           W-TRANSACTION,
  9063           PROGRAM-INTERFACE-BLOCK,
  9064           PI-COMM-LENGTH,
  9065           DFHEIV99,
  9066           DFHEIV99
  9067     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9068
  9069
  9070 9000-EXIT.
  9071     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 190
* EL690.cbl
  9073 9200-DATE-EDIT.
  9074*****************************************************************
  9075*     THIS ROUTINE VALIDATES THE DATE PASSED IN THE             *
  9076*     'W-DEEDIT-FIELD' BY CALLING THE 'ELDATECV' PROGRAM.       *
  9077*     AFTER EXITING THIS COPY BOOK, 'DC-ERROR-CODE' CAN BE      *
  9078*     CHECKED FOR SPACES TO DETERMINE IF ERRORS WERE FOUND      *
  9079*     ELSE THE BINARY DATE CAN BE FOUND IN 'DC-BIN-DATE-1'.     *
  9080*****************************************************************
  9081
  9082
  9083* EXEC CICS BIF DEEDIT
  9084*        FIELD  (W-DEEDIT-FIELD)
  9085*        LENGTH (15)
  9086*    END-EXEC.
  9087     MOVE 15
  9088       TO DFHEIV11
  9089*    MOVE '@"L                   #   #00008075' TO DFHEIV0
  9090     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9091     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9092     MOVE X'2020233030303038303735' TO DFHEIV0(25:11)
  9093     CALL 'kxdfhei1' USING DFHEIV0,
  9094           W-DEEDIT-FIELD,
  9095           DFHEIV11
  9096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9097
  9098
  9099     IF  W-DEEDIT-FIELD-V0 NUMERIC
  9100         MOVE W-DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-EDIT
  9101                                    DC-GREG-DATE-1-MDY
  9102         INSPECT DC-GREG-DATE-1-EDIT CONVERTING ' ' TO '/'
  9103*        INSPECT DC-GREG-DATE-1-EDIT REPLACING ALL ' ' BY '/'
  9104         MOVE '4'                TO DC-OPTION-CODE
  9105
  9106         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9107
  9108     ELSE
  9109         MOVE HIGH-VALUES        TO  DC-ERROR-CODE.
  9110
  9111 9200-EXIT.
  9112     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 191
* EL690.cbl
  9114 9400-XCTL.
  9115*****************************************************************
  9116*    THIS PARAGRAPH TRANSFERS CONTROL TO INDICATED PROGRAM.     *
  9117*    PROGRAM MUST RESIDE IN W-CALL-PGM.                         *
  9118*****************************************************************
  9119
  9120
  9121* EXEC CICS XCTL
  9122*        PROGRAM  (W-CALL-PGM)
  9123*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  9124*        LENGTH   (PI-COMM-LENGTH)
  9125*    END-EXEC.
  9126*    MOVE '.$C                   $   #00008101' TO DFHEIV0
  9127     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9128     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9129     MOVE X'2020233030303038313031' TO DFHEIV0(25:11)
  9130     CALL 'kxdfhei1' USING DFHEIV0,
  9131           W-CALL-PGM,
  9132           PROGRAM-INTERFACE-BLOCK,
  9133           PI-COMM-LENGTH
  9134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9135
  9136
  9137 9400-EXIT.
  9138     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 192
* EL690.cbl
  9140 9500-LINK-DATE-CONVERT.
  9141*****************************************************************
  9142*    THIS PARAGRAPH 'CALLS' THE UTILITY DATE PROCESSOR.         *
  9143*****************************************************************
  9144
  9145
  9146* EXEC CICS LINK
  9147*        PROGRAM    ('ELDATCV')
  9148*        COMMAREA   (DATE-CONVERSION-DATA)
  9149*        LENGTH     (DC-COMM-LENGTH)
  9150*        END-EXEC.
  9151     MOVE 'ELDATCV' TO DFHEIV1
  9152*    MOVE '."C                   ''   #00008115' TO DFHEIV0
  9153     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9154     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9155     MOVE X'2020233030303038313135' TO DFHEIV0(25:11)
  9156     CALL 'kxdfhei1' USING DFHEIV0,
  9157           DFHEIV1,
  9158           DATE-CONVERSION-DATA,
  9159           DC-COMM-LENGTH,
  9160           DFHEIV99,
  9161           DFHEIV99,
  9162           DFHEIV99
  9163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9164
  9165
  9166 9500-EXIT.
  9167     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 193
* EL690.cbl
  9169 9600-FORMAT-DATE-TIME.
  9170*****************************************************************
  9171*     THIS LOGIC UPDATES THE DATE/TIME INFO ON GIVEN MAP        *
  9172*****************************************************************
  9173
  9174     MOVE W-SAVE-DATE            TO RUNDTEO.
  9175
  9176
  9177* EXEC CICS ASKTIME
  9178*    END-EXEC.
  9179*    MOVE '0"                    "   #00008131' TO DFHEIV0
  9180     MOVE X'302220202020202020202020' TO DFHEIV0(1:12)
  9181     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
  9182     MOVE X'2020233030303038313331' TO DFHEIV0(25:11)
  9183     CALL 'kxdfhei1' USING DFHEIV0,
  9184           DFHEIV99
  9185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9186
  9187
  9188     MOVE EIBTIME                TO W-TIME-IN.
  9189     MOVE W-TIME-OUT             TO RUNTIMEO.
  9190     MOVE PI-COMPANY-ID          TO COMPANYO.
  9191     MOVE PI-PROCESSOR-ID        TO USERIDO.
  9192     MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO.
  9193
  9194 9600-EXIT.
  9195     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 194
* EL690.cbl
  9197 9700-PGMID-ERROR.
  9198*****************************************************************
  9199*     THIS PARAGRAPH TRANSFERS CONTROL TO EL005 LOGOFF.         *
  9200*     THE FOLLOWING FIELDS ARE NEEDED IN WORKING-STORAGE        *
  9201*     W-CALL-PGM             PIC  X(08)  VALUE 'EL000   '.      *
  9202*     W-THIS-PGM             PIC  X(08).                        *
  9203*     W-XCTL-005             PIC  X(08)  VALUE 'EL005   '.      *
  9204*****************************************************************
  9205
  9206
  9207* EXEC CICS  HANDLE CONDITION
  9208*        PGMIDERR  (8300-SEND-TEXT)
  9209*        END-EXEC.
  9210*    MOVE '"$L                   ! > #00008152' TO DFHEIV0
  9211     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  9212     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9213     MOVE X'3E20233030303038313532' TO DFHEIV0(25:11)
  9214     CALL 'kxdfhei1' USING DFHEIV0
  9215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9216
  9217
  9218     MOVE W-THIS-PGM             TO PI-CALLING-PROGRAM.
  9219     MOVE ' '                    TO PI-ENTRY-CD-1.
  9220     MOVE W-XCTL-005             TO W-CALL-PGM
  9221                                    LOGOFF-PGM.
  9222     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  9223
  9224     PERFORM 9400-XCTL THRU 9400-EXIT.
  9225
  9226 9700-EXIT.
  9227     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 195
* EL690.cbl
  9229 9800-ABEND.
  9230*****************************************************************
  9231*     THIS PARAGRAPH LINKS TO A COMMON ABEND ROUTINE.           *
  9232*     THE FOLLOWING FIELDS ARE NEEDED IN WORKING-STORAGE        *
  9233*     W-LINK-004             PIC  X(08)  VALUE 'EL004   '.      *
  9234*****************************************************************
  9235
  9236     MOVE W-LINK-004             TO W-CALL-PGM.
  9237     MOVE DFHEIBLK               TO EMI-LINE1
  9238
  9239
  9240* EXEC CICS  LINK
  9241*        PROGRAM   (W-CALL-PGM)
  9242*        COMMAREA  (EMI-LINE1)
  9243*        LENGTH    (72)
  9244*        END-EXEC.
  9245     MOVE 72
  9246       TO DFHEIV11
  9247*    MOVE '."C                   ''   #00008177' TO DFHEIV0
  9248     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9249     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9250     MOVE X'2020233030303038313737' TO DFHEIV0(25:11)
  9251     CALL 'kxdfhei1' USING DFHEIV0,
  9252           W-CALL-PGM,
  9253           EMI-LINE1,
  9254           DFHEIV11,
  9255           DFHEIV99,
  9256           DFHEIV99,
  9257           DFHEIV99
  9258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9259
  9260
  9261     GO TO 8200-SEND-DATAONLY.
  9262
  9263 9800-EXIT.
  9264     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 196
* EL690.cbl
  9266 9900-ERROR-FORMAT.
  9267*****************************************************************
  9268*     THIS PARAGRAPH IS THE STANDARDIZED ERROR FORMAT ROUTINE.  *
  9269*     THE FIELDS W-LINK-001 AND W-CALL-PGM MUST BE DEFINED IN   *
  9270*     WORKING STORAGE.                                          *
  9271*****************************************************************
  9272
  9273     IF  NOT EMI-ERRORS-COMPLETE
  9274             AND
  9275         EMI-ERROR NOT EQUAL W-LAST-ERROR
  9276         MOVE W-LINK-001         TO W-CALL-PGM
  9277
  9278
  9279* EXEC CICS LINK
  9280*            PROGRAM    (W-CALL-PGM)
  9281*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  9282*            LENGTH     (EMI-COMM-LENGTH)
  9283*        END-EXEC
  9284*    MOVE '."C                   ''   #00008200' TO DFHEIV0
  9285     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9286     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9287     MOVE X'2020233030303038323030' TO DFHEIV0(25:11)
  9288     CALL 'kxdfhei1' USING DFHEIV0,
  9289           W-CALL-PGM,
  9290           ERROR-MESSAGE-INTERFACE-BLOCK,
  9291           EMI-COMM-LENGTH,
  9292           DFHEIV99,
  9293           DFHEIV99,
  9294           DFHEIV99
  9295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9296
  9297         MOVE EMI-ERROR TO W-LAST-ERROR.
  9298
  9299 9900-EXIT.
  9300     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 197
* EL690.cbl
  9302 9910-INITIALIZE-SECURITY.
  9303******************************************************************
  9304*                                                                *
  9305*       THIS LOGIC SETS UP AND READS THE TEMPORARY STORAGE       *
  9306*       USER SECURITY RECORD SET UP BY EL125.  BASED ON THE      *
  9307*       APPLICATION NUMBER FOUND IN WORKING STORAGE UNDER        *
  9308*       W-APPL-SECRTY-NDX (PIC  S9(04) COMP), THIS PROGRAM       *
  9309*       MOVES THE APPROPRIATE APPLICATION AUTHORIZATION INTO     *
  9310*       PI-DISPLAY-CAP AND PI-MODIFY-CAP.  IT THEN CHECKS FOR    *
  9311*       BROWSE AUTHORITY AND IF NOT AUTHORIZED WILL SET AN       *
  9312*       ERROR CONDITION AND EXITS THE PROGRAM.                   *
  9313*                                                                *
  9314*       NOTE:  THE CARRIER/GRP/STATE/PRODUCER SECURITY DATA      *
  9315*       IS ALSO PROVIDED BY THIS LOGIC.                          *
  9316*                                                                *
  9317******************************************************************
  9318
  9319     IF  PI-PROCESSOR-ID EQUAL 'LGXX'
  9320         MOVE 'Y'                TO PI-DISPLAY-CAP
  9321                                        PI-MODIFY-CAP
  9322
  9323     ELSE
  9324*        MOVE '125E'             TO W-SC-QUID-SYSTEM
  9325*        MOVE EIBTRMID           TO W-SC-QUID-TERMINAL
  9326
  9327
  9328* EXEC CICS READQ TS
  9329*            QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  9330*            INTO   (SECURITY-CONTROL)
  9331*            LENGTH (SC-COMM-LENGTH)
  9332*            ITEM   (1)
  9333*        END-EXEC
  9334     MOVE 1
  9335       TO DFHEIV11
  9336*    MOVE '*$II   L              ''   #00008236' TO DFHEIV0
  9337     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  9338     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9339     MOVE X'2020233030303038323336' TO DFHEIV0(25:11)
  9340     CALL 'kxdfhei1' USING DFHEIV0,
  9341           PI-SECURITY-TEMP-STORE-ID,
  9342           SECURITY-CONTROL,
  9343           SC-COMM-LENGTH,
  9344           DFHEIV11,
  9345           DFHEIV99,
  9346           DFHEIV99
  9347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9348
  9349         MOVE SC-CREDIT-DISPLAY (W-APPL-SCRTY-NDX)
  9350                                 TO PI-DISPLAY-CAP
  9351         MOVE SC-CREDIT-UPDATE (W-APPL-SCRTY-NDX)
  9352                                 TO PI-MODIFY-CAP
  9353
  9354         IF  NOT DISPLAY-CAP
  9355             MOVE 'READ'         TO SM-READ
  9356             PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  9357             MOVE ER-9097        TO EMI-ERROR
  9358             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9359             GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 198
* EL690.cbl
  9360
  9361 9910-EXIT.
  9362     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 199
* EL690.cbl
  9364 9995-SECURITY-VIOLATION.
  9365
  9366     MOVE EIBDATE          TO SM-JUL-DATE.
  9367     MOVE EIBTRMID         TO SM-TERMID.
  9368     MOVE W-THIS-PGM       TO SM-PGM.
  9369     MOVE EIBTIME          TO W-TIME-IN.
  9370     MOVE W-TIME-OUT       TO SM-TIME.
  9371     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  9372
  9373
  9374* EXEC CICS LINK
  9375*         PROGRAM  ('EL003')
  9376*         COMMAREA (SECURITY-MESSAGE)
  9377*         LENGTH   (80)
  9378*    END-EXEC.
  9379     MOVE 'EL003' TO DFHEIV1
  9380     MOVE 80
  9381       TO DFHEIV11
  9382*    MOVE '."C                   ''   #00008267' TO DFHEIV0
  9383     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9384     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9385     MOVE X'2020233030303038323637' TO DFHEIV0(25:11)
  9386     CALL 'kxdfhei1' USING DFHEIV0,
  9387           DFHEIV1,
  9388           SECURITY-MESSAGE,
  9389           DFHEIV11,
  9390           DFHEIV99,
  9391           DFHEIV99,
  9392           DFHEIV99
  9393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9394
  9395
  9396 9995-EXIT.
  9397     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 200
* EL690.cbl
  9399 9999-GOBACK.
  9400******************************************************************
  9401*                                                                *
  9402*       THIS PARAGRAPH FULFILL THE COMPILE REQUIRMENT FOR A      *
  9403*       COBOL RETURN COMMAND.  IN A SEPARATE PARAGRAPH IT        *
  9404*       PREVENTS AN COMPILE ERROR.                               *
  9405*                                                                *
  9406******************************************************************
  9407
  9408
  9409* GOBACK.
  9410     MOVE '9%                    "   ' TO DFHEIV0
  9411     MOVE 'EL690' TO DFHEIV1
  9412     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9413     GOBACK.
  9414
  9415 9999-EXIT.
  9416     EXIT.
  9417
  9418 9999-DFHBACK SECTION.
  9419     MOVE '9%                    "   ' TO DFHEIV0
  9420     MOVE 'EL690' TO DFHEIV1
  9421     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9422     GOBACK.
  9423 9999-DFHEXIT.
  9424     IF DFHEIGDJ EQUAL 0001
  9425         NEXT SENTENCE
  9426     ELSE IF DFHEIGDJ EQUAL 2
  9427         GO TO 0110-PGM-INITIALIZATION,
  9428               0110-PGM-INITIALIZATION,
  9429               8070-NOTOPEN,
  9430               8080-ARCH-NOT-FOUND,
  9431               9700-PGMID-ERROR,
  9432               9800-ABEND
  9433         DEPENDING ON DFHEIGDI
  9434     ELSE IF DFHEIGDJ EQUAL 3
  9435         GO TO 8080-ARCH-NOT-FOUND,
  9436               8080-ARCH-NOT-FOUND
  9437         DEPENDING ON DFHEIGDI
  9438     ELSE IF DFHEIGDJ EQUAL 4
  9439         GO TO 8080-ARCH-NOT-FOUND,
  9440               8080-ARCH-NOT-FOUND
  9441         DEPENDING ON DFHEIGDI
  9442     ELSE IF DFHEIGDJ EQUAL 5
  9443         GO TO 8080-ARCH-NOT-FOUND,
  9444               8080-ARCH-NOT-FOUND,
  9445               8000-ARCH2-NOT-OPEN
  9446         DEPENDING ON DFHEIGDI
  9447     ELSE IF DFHEIGDJ EQUAL 6
  9448         GO TO 2100-END-BROWSE,
  9449               2100-END-BROWSE
  9450         DEPENDING ON DFHEIGDI
  9451     ELSE IF DFHEIGDJ EQUAL 7
  9452         GO TO 8080-ARCH-NOT-FOUND,
  9453               8080-ARCH-NOT-FOUND,
  9454               8010-ARCH3-NOT-OPEN
  9455         DEPENDING ON DFHEIGDI
  9456     ELSE IF DFHEIGDJ EQUAL 8
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 201
* EL690.cbl
  9457         GO TO 2200-END-BROWSE,
  9458               2200-END-BROWSE
  9459         DEPENDING ON DFHEIGDI
  9460     ELSE IF DFHEIGDJ EQUAL 9
  9461         GO TO 8080-ARCH-NOT-FOUND,
  9462               8080-ARCH-NOT-FOUND,
  9463               8020-ARCH4-NOT-OPEN
  9464         DEPENDING ON DFHEIGDI
  9465     ELSE IF DFHEIGDJ EQUAL 10
  9466         GO TO 2300-END-BROWSE,
  9467               2300-END-BROWSE
  9468         DEPENDING ON DFHEIGDI
  9469     ELSE IF DFHEIGDJ EQUAL 11
  9470         GO TO 8080-ARCH-NOT-FOUND,
  9471               8080-ARCH-NOT-FOUND,
  9472               8030-ARCH5-NOT-OPEN
  9473         DEPENDING ON DFHEIGDI
  9474     ELSE IF DFHEIGDJ EQUAL 12
  9475         GO TO 2400-END-BROWSE,
  9476               2400-END-BROWSE
  9477         DEPENDING ON DFHEIGDI
  9478     ELSE IF DFHEIGDJ EQUAL 13
  9479         GO TO 8080-ARCH-NOT-FOUND,
  9480               8080-ARCH-NOT-FOUND,
  9481               8040-ARCH6-NOT-OPEN
  9482         DEPENDING ON DFHEIGDI
  9483     ELSE IF DFHEIGDJ EQUAL 14
  9484         GO TO 2500-END-BROWSE,
  9485               2500-END-BROWSE
  9486         DEPENDING ON DFHEIGDI
  9487     ELSE IF DFHEIGDJ EQUAL 15
  9488         GO TO 8080-ARCH-NOT-FOUND,
  9489               8080-ARCH-NOT-FOUND,
  9490               8050-ARCH-NOT-OPEN
  9491         DEPENDING ON DFHEIGDI
  9492     ELSE IF DFHEIGDJ EQUAL 16
  9493         GO TO 2600-END-BROWSE,
  9494               2600-END-BROWSE
  9495         DEPENDING ON DFHEIGDI
  9496     ELSE IF DFHEIGDJ EQUAL 17
  9497         GO TO 8080-ARCH-NOT-FOUND,
  9498               8080-ARCH-NOT-FOUND,
  9499               8000-ARCH2-NOT-OPEN
  9500         DEPENDING ON DFHEIGDI
  9501     ELSE IF DFHEIGDJ EQUAL 18
  9502         GO TO 3100-END-BROWSE,
  9503               3100-END-BROWSE
  9504         DEPENDING ON DFHEIGDI
  9505     ELSE IF DFHEIGDJ EQUAL 19
  9506         GO TO 8080-ARCH-NOT-FOUND,
  9507               8080-ARCH-NOT-FOUND,
  9508               8010-ARCH3-NOT-OPEN
  9509         DEPENDING ON DFHEIGDI
  9510     ELSE IF DFHEIGDJ EQUAL 20
  9511         GO TO 3200-END-BROWSE,
  9512               3200-END-BROWSE
  9513         DEPENDING ON DFHEIGDI
  9514     ELSE IF DFHEIGDJ EQUAL 21
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 202
* EL690.cbl
  9515         GO TO 8080-ARCH-NOT-FOUND,
  9516               8080-ARCH-NOT-FOUND,
  9517               8020-ARCH4-NOT-OPEN
  9518         DEPENDING ON DFHEIGDI
  9519     ELSE IF DFHEIGDJ EQUAL 22
  9520         GO TO 3300-END-BROWSE,
  9521               3300-END-BROWSE
  9522         DEPENDING ON DFHEIGDI
  9523     ELSE IF DFHEIGDJ EQUAL 23
  9524         GO TO 8080-ARCH-NOT-FOUND,
  9525               8080-ARCH-NOT-FOUND,
  9526               8030-ARCH5-NOT-OPEN
  9527         DEPENDING ON DFHEIGDI
  9528     ELSE IF DFHEIGDJ EQUAL 24
  9529         GO TO 3400-END-BROWSE,
  9530               3400-END-BROWSE
  9531         DEPENDING ON DFHEIGDI
  9532     ELSE IF DFHEIGDJ EQUAL 25
  9533         GO TO 8080-ARCH-NOT-FOUND,
  9534               8080-ARCH-NOT-FOUND,
  9535               8040-ARCH6-NOT-OPEN
  9536         DEPENDING ON DFHEIGDI
  9537     ELSE IF DFHEIGDJ EQUAL 26
  9538         GO TO 3500-END-BROWSE,
  9539               3500-END-BROWSE
  9540         DEPENDING ON DFHEIGDI
  9541     ELSE IF DFHEIGDJ EQUAL 27
  9542         GO TO 8080-ARCH-NOT-FOUND,
  9543               8080-ARCH-NOT-FOUND,
  9544               8050-ARCH-NOT-OPEN
  9545         DEPENDING ON DFHEIGDI
  9546     ELSE IF DFHEIGDJ EQUAL 28
  9547         GO TO 3600-END-BROWSE,
  9548               3600-END-BROWSE
  9549         DEPENDING ON DFHEIGDI
  9550     ELSE IF DFHEIGDJ EQUAL 29
  9551         GO TO 7800-EXIT,
  9552               7800-EXIT
  9553         DEPENDING ON DFHEIGDI
  9554     ELSE IF DFHEIGDJ EQUAL 30
  9555         GO TO 8300-SEND-TEXT
  9556         DEPENDING ON DFHEIGDI.
  9557     MOVE '9%                    "   ' TO DFHEIV0
  9558     MOVE 'EL690' TO DFHEIV1
  9559     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9560     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        6752     Code:       24821
