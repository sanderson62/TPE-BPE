* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page   1
* EL6318.cbl
* Options: int("EL6318.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6318.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6318.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6318.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                 EL6318.
     3*
     4*AUTHOR.        PABLO
     5*               OMAHA, NEBRASKA
     6*DATE-COMPILED.
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CENTRAL STATES  *
    10*            *   HEALTH AND LIFE                                 *
    11*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    12*            *   OF CSO.        IS EXPRESSLY PROHIBITED WITHOUT  *
    13*            *   THE PRIOR WRITTEN PERMISSION OF CENTRAL STATES. *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page   2
* EL6318.cbl
    14*            *                                                   *
    15*            *****************************************************
    16*-----------------------------------------------------------------
    17*                   C H A N G E   L O G
    18*
    19* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    20*-----------------------------------------------------------------
    21*  CHANGE  CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    22* EFFECTIVE    NUMBER
    23*-----------------------------------------------------------------
    24*          2011022800001  PEMA  NEW PROGRAM
    25* 012412   2011022800001  AJRA  NAPERSOFT
    26* 060612   2011022800001  AJRA  NAPERSOFT
    27* 062712   2011022800001  AJRA  REDEFINE ORIG DATA
    28* 072312   2011022800001  AJRA  NAPERSOFT MISC
    29* 102212   2012101700002  AJRA  SCREEN ID
    30* 103012   2012101700002  AJRA  ADD CERT NOTES TO TOP OF LIST
    31* 110612   2012101700002  AJRA  ADD NEW FIELDS
    32* 112612   2012101700002  AJRA  CHECK FOR PROMPT LETTER
    33* 121012   2012101700002  AJRA  HIGHLIGHT REASON CODES
    34* 121112   2012101700002  AJRA  CHANGE PF1, PF2 TO PF3, PF4
    35* 121212   2012101700002  AJRA  CHG LAST 2 CERT NOTES TO BILLING N
    36* 121712   2012101700002  AJRA  ADD DEFAULT AGE FLAG
    37* 122712   2012122700001  AJRA  FIX CERT PRINT FLAG
    38* 011413 IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    39* 091913   2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
    40* 120313   2013090300001  AJRA  NAPERSOFT PHASE 2
    41* 121713   2013090300001  AJRA  ADD ENCLOSURE CODE TO SCREEN
    42* 091615 CR2015082000001  PEMA  ADD XFR TO EL677
    43*-----------------------------------------------------------------
    44*REMARKS.
    45*        TRANSACTION - EXBE - GENERAL CHANGE ENDORSEMENT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page   3
* EL6318.cbl
    47 ENVIRONMENT DIVISION.
    48 DATA DIVISION.
    49 WORKING-STORAGE SECTION.
    50 01  DFH-START PIC X(04).
    51 77  FILLER  PIC X(32)  VALUE '********************************'.
    52 77  FILLER  PIC X(32)  VALUE '*    EL6318 WORKING STORAGE    *'.
    53 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.001 ************'.
    54 77  NOTE-SUB PIC S9(5) COMP-3 VALUE +0.
    55 77  WS-SEQ-NO                   PIC 9(4) BINARY.
    56 77  WS-SET-CODES-MDT            PIC X  VALUE SPACES.
    57 77  s1                          pic s999 comp-3 value +0.
    58 77  s2                          pic s999 comp-3 value +0.
    59 77  W-ARCH-NUMBER               PIC S9(08)      COMP value +0.
    60 77  WS-ERACCT-SW                PIC X  VALUE ' '.
    61     88  ACCT-FOUND                 VALUE 'Y'.
    62 77  WS-CHGBACK                 PIC 99  VALUE ZEROS.
    63 77  WS-CSO-PORTION              PIC S9(5)V99 COMP-3 VALUE +0.
    64 77  WS-ACCT-PORTION             PIC S9(5)V99 COMP-3 VALUE +0.
    65 77  WS-DIFF                     PIC 99 VALUE ZEROS.
    66 77  WS-SAVE-ERACCT-KEY          PIC X(20)  VALUE SPACES.
    67 77  WS-DUE-BORROWER             PIC S9(7)V99 COMP-3 VALUE +0.
    68 77  WS-REASON-SW                PIC X  VALUE ' '.
    69     88  REASONS-FOUND                  VALUE 'Y'.
    70     88  REASONS-NOT-FOUND              VALUE 'N'.
    71 77  WS-CERT-UPDATE-SW           PIC X  VALUE ' '.
    72     88  NO-CERT-RW                 VALUE 'N'.
    73     88  CERT-RW                    VALUE 'Y'.
    74 77  ws-el677-check-cut         pic x value 'N'.
    75 77  ws-el677-check-type        pic x value 'N'.
    76 01  P pointer.
    77 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    78 01  KIXHOST             pic x(9) value Z"HOSTNAME".
    79 01  var-ptr pointer.
    80 01  env-var-len                 pic 9(4)  binary.
    81 01  rc                          pic 9(9)  binary.
    82 01  WS-KIXHOST                  PIC X(10).
    83 01  WS-KIXSYS.
    84     05  WS-KIX-FIL1             PIC X(10).
    85     05  WS-KIX-APPS             PIC X(10).
    86     05  WS-KIX-ENV              PIC X(10).
    87     05  WS-KIX-MYENV            PIC X(10).
    88     05  WS-KIX-SYS              PIC X(10).
    89*                                COPY ELCSCTM.
    90******************************************************************
    91*                                                                *
    92*                                                                *
    93*                            ELCSCTM                             *
    94*                            VMOD=2.001                          *
    95*                                                                *
    96*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    97*                                                                *
    98******************************************************************
    99 01  SECURITY-MESSAGE.
   100     12  FILLER                          PIC X(30)
   101            VALUE '** LOGIC SECURITY VIOLATION -'.
   102     12  SM-READ                         PIC X(6).
   103     12  FILLER                          PIC X(5)
   104            VALUE ' PGM='.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page   4
* EL6318.cbl
   105     12  SM-PGM                          PIC X(6).
   106     12  FILLER                          PIC X(5)
   107            VALUE ' OPR='.
   108     12  SM-PROCESSOR-ID                 PIC X(4).
   109     12  FILLER                          PIC X(6)
   110            VALUE ' TERM='.
   111     12  SM-TERMID                       PIC X(4).
   112     12  FILLER                          PIC XX   VALUE SPACE.
   113     12  SM-JUL-DATE                     PIC 9(5).
   114     12  FILLER                          PIC X    VALUE SPACE.
   115     12  SM-TIME                         PIC 99.99.
   116
   117*                                COPY ELCSCRTY.
   118******************************************************************
   119*                                                                *
   120*                                                                *
   121*                            ELCSCRTY                            *
   122*                            VMOD=2.001                          *
   123*                                                                *
   124*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   125*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   126*        SAVED IN PI-SECURITY-ADDRESS.                           *
   127*                                                                *
   128******************************************************************
   129 01  SECURITY-CONTROL.
   130     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   131     12  FILLER                       PIC XX    VALUE 'SC'.
   132     12  SC-CREDIT-CODES.
   133         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   134             20  SC-CREDIT-DISPLAY    PIC X.
   135             20  SC-CREDIT-UPDATE     PIC X.
   136     12  SC-CLAIMS-CODES.
   137         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   138             20  SC-CLAIMS-DISPLAY    PIC X.
   139             20  SC-CLAIMS-UPDATE     PIC X.
   140 01 srch-commarea.
   141*                                copy ELCADLTRSPI.
   142******************************************************************
   143*                   C H A N G E   L O G
   144*
   145* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   146*-----------------------------------------------------------------
   147*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   148* EFFECTIVE    NUMBER
   149*-----------------------------------------------------------------
   150* 060611    2011022800001  PEMA  NEW COPYBOOK
   151* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   152* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   153******************************************************************
   154****************************************
   155*  commarea for NaperSoft On Demand Admin services letters
   156*  (business logic input & output)
   157****************************************
   158     03  BL-INPUT.
   159         05  BL-DATA-SRCE        PIC X.
   160         05  BL-LETTER-ID        PIC XXXX.
   161         05  BL-CARRIER          PIC X.
   162         05  BL-GROUP            PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page   5
* EL6318.cbl
   163         05  BL-STATE            PIC XX.
   164         05  BL-ACCOUNT          PIC X(10).
   165         05  BL-EFF-DT           PIC X(10).
   166         05  BL-CERT-NO          PIC X(11).
   167         05  BL-BATCH-NO         PIC X(6).
   168         05  BL-BATCH-SEQ        PIC 9(8).
   169         05  BL-RESP-NO          PIC X(10).
   170         05  BL-NO-OF-COPIES     PIC 99.
   171         05  BL-PROC-ID          PIC XXXX.
   172         05  BL-COMP-ID          PIC XXX.
   173         05  BL-PRINT-NOW-SW     PIC X.
   174         05  BL-ENC-CD           PIC XXX.
   175         05  BL-RESEND-DT        PIC X(10).
   176         05  BL-FOLLOW-UP-DT     PIC X(10).
   177         05  BL-ARCHIVE-NO       PIC 9(8).
   178         05  BL-FUNC             PIC X(8).
   179         05  BL-COMMENTS         PIC X(100).
   180         05  FILLER REDEFINES BL-COMMENTS.
   181             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   182             10  BL-LETTER-TO-ACCT PIC X.
   183             10  BL-LETTER-TO-BENE PIC X.
   184             10  BL-WRITE-ERARCH   PIC X.
   185                 88  ERARCH-QWS      VALUE 'Q'.
   186                 88  ERARCH-BATCH    VALUE 'B'.
   187                 88  ERARCH-TEMP     VALUE 'T'.
   188             10  BL-PROCESS-TYPE PIC X(07).
   189             10  BL-CERT-FORM-ID PIC X(05).
   190             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   191             10  BL-SOURCE-SCREEN PIC X(8).
   192             10  FILLER          PIC X(25).
   193     03  BL-OUTPUT.
   194         05  BL-STATUS                   PIC X.
   195             88  BL-OK                      VALUE "P".
   196             88  BL-FAIL                  VALUE "F".
   197         05  BL-MESSAGE          PIC X(50).
   198     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   199     03  FILLER                  PIC X(31).
   200
   201*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   202*                                COPY ELCZREC.
   203******************************************************************
   204*                                                                *
   205*                                                                *
   206*                            ELCZREC.                            *
   207*                                                                *
   208*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   209*                                                                *
   210******************************************************************
   211*-----------------------------------------------------------------
   212*                   C H A N G E   L O G
   213*
   214* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   215*-----------------------------------------------------------------
   216*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   217* EFFECTIVE    NUMBER
   218*-----------------------------------------------------------------
   219* 122011    2011022800001  AJRA  NEW FILE
   220* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page   6
* EL6318.cbl
   221* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   222* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   223* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   224*-----------------------------------------------------------------
   225 01  W-Z-CONTROL-DATA.
   226     05  W-NUMBER-OF-COPIES      PIC  9.
   227     05  FILLER                  PIC  X.
   228     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   229     05  FILLER                  PIC  X.
   230     05  W-DAYS-TO-RESEND        PIC  999.
   231     05  FILLER                  PIC  X.
   232     05  W-FORM-TO-RESEND        PIC  X(4).
   233     05  W-ADD-BAR-CODE          PIC  X.
   234     05  W-PROMPT-LETTER         PIC  X.
   235     05  W-HAS-RETURN-ENV        PIC  X.
   236     05  W-ENCLOSURE-CD          PIC  XXX.
   237     05  W-SIG-FLAG-DEFAULT      PIC  X.
   238     05  W-AUTO-CLOSE-IND        PIC  X.
   239     05  FILLER                  PIC  X.
   240     05  W-LETTER-TO-BENE        PIC  X.
   241     05  FILLER                  PIC  X.
   242     05  W-LETTER-TO-ACCT        PIC  X.
   243     05  FILLER                  PIC  X.
   244     05  W-LETTER-TYPE           PIC  X.
   245     05  FILLER                  PIC  X.
   246     05  W-PRINT-CERTIFICATE     PIC  X.
   247     05  FILLER                  PIC  X.
   248     05  W-REFUND-REQUIRED       PIC  X.
   249     05  FILLER                  PIC  X.
   250     05  W-ONBASE-CODE           PIC  XX.
   251     05  FILLER                  PIC  X.
   252     05  W-ACCT-SUMM             PIC  X.
   253     05  FILLER                  PIC  X.
   254     05  W-CSO-SUMM              PIC  X.
   255     05  FILLER                  PIC  X.
   256     05  W-REASONS-REQUIRED      PIC  X.
   257     05  FILLER                  PIC  X(29).
   258 01  WS-PASSED-REASON-CODES      PIC X(60)  VALUE SPACES.
   259 01  STANDARD-AREAS.
   260     12  W-ARCH-SUPPRESS         PIC ZZZZZZZ9.
   261     12  W-ARCH-EDIT REDEFINES W-ARCH-SUPPRESS
   262                                 PIC  X(08).
   263     12  W-ARCH-LENGTH           PIC S9(04)  COMP  VALUE +250.
   264     12  QID.
   265         16  QID-TERM        PIC X(4)    VALUE SPACES.
   266         16  FILLER          PIC X(4)    VALUE '631K'.
   267     12  MAP-LENGTH          PIC 9(4)   VALUE 359 BINARY.
   268     12  TIME-MT                 PIC S9(7).
   269     12  TIME-MT-R  REDEFINES TIME-MT.
   270         16  FILLER              PIC X.
   271         16  TIME-LMT            PIC 99V99.
   272         16  FILLER              PIC X(2).
   273     12  GETMAIN-SPACE           PIC X VALUE SPACES.
   274     12  ERENDT-LENGTH           PIC S9(04) VALUE +579 COMP.
   275     12  ERPNDB-LENGTH           PIC 9(04)  VALUE 585 COMP.
   276     12  ERCNOT-LENGTH           PIC S9(04) VALUE +150 COMP.
   277     12  ERNOTE-LENGTH           PIC S9(04) VALUE +825 COMP.
   278     12  ELEOBC-LENGTH           PIC S9(04) VALUE +350 COMP.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page   7
* EL6318.cbl
   279     12  ELCRTT-LENGTH           PIC S9(4) COMP VALUE +552.
   280     12  ELENCC-LENGTH           PIC S9(04) VALUE +400 COMP.
   281     12  W-CNTL-KEY.
   282         16  W-CNTL-COMPANY-ID   PIC  X(03).
   283         16  W-CNTL-RECORD-TYPE  PIC  X(01)   VALUE '1'.
   284         16  W-CNTL-GENL.
   285             20  W-CNTL-GEN1     PIC  X(02)   VALUE SPACES.
   286             20  W-CNTL-GEN2.
   287                 24 W-CNTL-GEN3  PIC  X(01)   VALUE SPACES.
   288                 24 W-CNTL-GEN4  PIC  X(01)   VALUE SPACES.
   289         16  W-CNTL-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
   290     12  WS-ELCERT-KEY.
   291         16  W-CERT-COMPANY-CD   PIC X.
   292         16  W-CERT-CARRIER      PIC X.
   293         16  W-CERT-GROUPING     PIC X(6).
   294         16  W-CERT-STATE        PIC XX.
   295         16  W-CERT-ACCOUNT      PIC X(10).
   296         16  W-CERT-CERT-EFF-DT  PIC XX.
   297         16  W-CERT-CERT-PRIME   PIC X(10).
   298         16  W-CERT-CERT-SFX     PIC X.
   299     12  WS-ELEOBC-KEY.
   300         16  WS-EOBC-COMPANY-CD  PIC X.
   301         16  WS-EOBC-REC-TYPE    PIC X.
   302         16  WS-EOBC-CODE        PIC X(4).
   303         16  FILLER              PIC X(9).
   304     12  WS-ERNOTE-KEY.
   305         16  W-NOTE-COMPANY-CD   PIC X.
   306         16  W-NOTE-CARRIER      PIC X.
   307         16  W-NOTE-GROUPING     PIC X(6).
   308         16  W-NOTE-STATE        PIC XX.
   309         16  W-NOTE-ACCOUNT      PIC X(10).
   310         16  W-NOTE-CERT-EFF-DT  PIC XX.
   311         16  W-NOTE-CERT-PRIME   PIC X(10).
   312         16  W-NOTE-CERT-SFX     PIC X.
   313     12  ELLETR-KEY.
   314         16  LETR-PART-KEY.
   315             20  LETR-COMPANY-CD PIC X.
   316             20  LETR-LETTER-ID  PIC X(4).
   317         16  LETR-FILLER         PIC X(8).
   318         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   319     12  ELLETR-SAVE-PART-KEY    PIC X(5).
   320     12  ERPNDB2-KEY.
   321         16  PNDB2-COMPANY-CD    PIC X.
   322         16  PNDB2-CARRIER       PIC X.
   323         16  PNDB2-GROUPING      PIC X(6).
   324         16  PNDB2-STATE         PIC XX.
   325         16  PNDB2-ACCOUNT       PIC X(10).
   326         16  PNDB2-CERT-EFF-DT   PIC XX.
   327         16  PNDB2-CERT-PRIME    PIC X(10).
   328         16  PNDB2-CERT-SFX      PIC X.
   329         16  PNDB2-CHG-SEQ-NO    PIC 9(4) BINARY.
   330         16  PNDB2-RECORD-TYPE   PIC X.
   331     12  ERPNDB-KEY.
   332         16  PNDB-COMPANY-CD     PIC X.
   333         16  PNDB-BATCH-NO       PIC X(6).
   334         16  PNDB-BATCH-SEQ-NO   PIC 9(4) BINARY.
   335         16  PNDB-CHG-SEQ-NO     PIC 9(4) BINARY.
   336     12  ERENDT-KEY.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page   8
* EL6318.cbl
   337         16  ENDT-COMPANY-CD       PIC X.
   338         16  ENDT-CARRIER          PIC X.
   339         16  ENDT-GROUPING         PIC X(6).
   340         16  ENDT-STATE            PIC XX.
   341         16  ENDT-ACCOUNT          PIC X(10).
   342         16  ENDT-CERT-EFF-DT      PIC XX.
   343         16  ENDT-CERT-PRIME       PIC X(10).
   344         16  ENDT-CERT-SFX         PIC X.
   345         16  ENDT-RECORD-TYPE      PIC X.
   346         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   347     12  ELCRTO-KEY.
   348         16  CRTO-COMPANY-CD     PIC X.
   349         16  CRTO-CARRIER        PIC X.
   350         16  CRTO-GROUPING       PIC X(6).
   351         16  CRTO-STATE          PIC XX.
   352         16  CRTO-ACCOUNT        PIC X(10).
   353         16  CRTO-CERT-EFF-DT    PIC XX.
   354         16  CRTO-CERT-PRIME     PIC X(10).
   355         16  CRTO-CERT-SFX       PIC X.
   356         16  CRTO-RECORD-TYPE    PIC X.
   357         16  CRTO-SEQ-NO         PIC 9(4) BINARY.
   358     12  WS-ELCRTT-KEY.
   359         16  WS-ELCRTT-PRIMARY   PIC X(33).
   360         16  WS-ELCRTT-REC-TYPE  PIC X(1).
   361     12  WS-ERMAIL-KEY.
   362         16  MAIL-COMPANY-CD     PIC X.
   363         16  MAIL-CARRIER        PIC X.
   364         16  MAIL-GROUPING       PIC X(6).
   365         16  MAIL-STATE          PIC XX.
   366         16  MAIL-ACCOUNT        PIC X(10).
   367         16  MAIL-CERT-EFF-DT    PIC XX.
   368         16  MAIL-CERT-PRIME     PIC X(10).
   369         16  MAIL-CERT-SFX       PIC X.
   370
   371     12  WS-ELENCC-KEY.
   372         16  WS-ENCC-COMPANY-CD  PIC X.
   373         16  WS-ENCC-REC-TYPE    PIC X.
   374         16  WS-ENCC-ENC-CODE    PIC X(5).
   375         16  FILLER              PIC X(09).
   376
   377     12  WS-LF-CANC-DT           PIC XX   VALUE LOW-VALUES.
   378     12  WS-AH-CANC-DT           PIC XX   VALUE LOW-VALUES.
   379     12  WS-CURRENT-DT.
   380         16  FILLER              PIC X(6)    VALUE SPACES.
   381         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   382     12  WS-CURRENT-BIN-DT       PIC XX    VALUE LOW-VALUES.
   383     12  WS-ISS-CAN-SW           PIC X     VALUE LOW-VALUES.
   384         88  CANCEL-REC            VALUE 'C'.
   385         88  ISSUE-REC             VALUE 'I'.
   386     12  WS-WORK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
   387     12  WS-HOLD-ACCT-KEY        PIC X(26) VALUE LOW-VALUES.
   388     12  ELCNTL-KEY.
   389         16  CNTL-COMP-ID        PIC X(3)  VALUE SPACES.
   390         16  CNTL-REC-TYPE       PIC X     VALUE SPACES.
   391         16  CNTL-ACCESS.
   392             20  CNTL-STATE      PIC XX    VALUE SPACES.
   393             20  FILLER          PIC X     VALUE SPACES.
   394             20  CNTL-CARRIER    PIC X     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page   9
* EL6318.cbl
   395         16  CNTL-SEQ            PIC S9(4) VALUE +0 COMP.
   396     12  WS-ERACCT-KEY.
   397         16  ACCT-COMPANY-CD     PIC X.
   398         16  ACCT-CARRIER        PIC X.
   399         16  ACCT-GROUPING       PIC X(6).
   400         16  ACCT-STATE          PIC XX.
   401         16  ACCT-ACCOUNT        PIC X(10).
   402         16  ACCT-EXP-DATE       PIC XX    VALUE SPACES.
   403         16  FILLER              PIC X(4)  VALUE LOW-VALUES.
   404     12  ERACCT-SAVE-KEY         PIC X(20) VALUE SPACES.
   405     12  WS-ELCERT-FILE-ID       PIC X(8) VALUE 'ELCERT'.
   406     12  WS-ELCNTL-FILE-ID       PIC X(8) VALUE 'ELCNTL'.
   407     12  WS-ERNOTE-FILE-ID       PIC X(8) VALUE 'ERNOTE'.
   408     12  WS-ELCRTO-FILE-ID       PIC X(8) VALUE 'ELCRTO'.
   409     12  WS-ERENDT-FILE-ID       PIC X(8) VALUE 'ERENDT'.
   410     12  WS-ERPNDB2-FILE-ID      PIC X(8) VALUE 'ERPNDB2'.
   411     12  WS-ERPNDB-FILE-ID       PIC X(8) VALUE 'ERPNDB'.
   412     12  WS-ERACCT2-FILE-ID      PIC X(8) VALUE 'ERACCT2'.
   413     12  WS-ERCNOT-FILE-ID       PIC X(8) VALUE 'ERCNOT'.
   414     12  WS-ELEOBC-FILE-ID       PIC X(8) VALUE 'ELEOBC'.
   415     12  WS-ELCRTT-FILE-ID       PIC X(8) VALUE 'ELCRTT'.
   416     12  WS-ELENCC-FILE-ID       PIC X(8) VALUE 'ELENCC'.
   417     12  WS-RESPONSE             PIC S9(8)   COMP.
   418         88  RESP-NORMAL                  VALUE +00.
   419         88  RESP-NOTFND                  VALUE +13.
   420         88  RESP-DUPREC                  VALUE +14.
   421         88  RESP-DUPKEY                  VALUE +15.
   422         88  RESP-NOTOPEN                 VALUE +19.
   423         88  RESP-ENDFILE                 VALUE +20.
   424     12  MAP-NAME            PIC X(8)    VALUE 'EL631K'.
   425     12  MAPSET-NAME         PIC X(8)    VALUE 'EL6318S'.
   426     12  SCREEN-NUMBER       PIC X(4)    VALUE '631K'.
   427     12  TRANS-ID            PIC X(4)    VALUE 'EXBE'.
   428     12  THIS-PGM            PIC X(8)    VALUE 'EL6318'.
   429     12  PGM-NAME            PIC X(8).
   430     12  TIME-IN             PIC S9(7).
   431     12  TIME-OUT-R  REDEFINES TIME-IN.
   432         16  FILLER          PIC X.
   433         16  TIME-OUT        PIC 99V99.
   434         16  FILLER          PIC X(2).
   435     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   436     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   437     12  XCTL-626            PIC X(8)    VALUE 'EL626'.
   438     12  XCTL-6311           PIC X(8)    VALUE 'EL6311'.
   439     12  XCTL-677            PIC X(8)    VALUE 'EL677'.
   440     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   441     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   442     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   443     12  WS-PHONE.
   444         16  WS-PH1              PIC XXX.
   445         16  WS-PH2              PIC XXX.
   446         16  WS-PH3              PIC XXXX.
   447     12  WS-PHONE-NUM REDEFINES WS-PHONE PIC 9(10).
   448     12  WS-DEV-RT               PIC S9V9(6) COMP-3.
   449
   450     12  WS-BILLING-NOTE.
   451         16  WS-BN-NOTE          PIC X(25).
   452         16  WS-BN-LTRID         PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  10
* EL6318.cbl
   453         16  FILLER              PIC X(3).
   454         16  WS-BN-DATE          PIC X(8).
   455         16  FILLER              PIC X(3).
   456         16  WS-BN-USERID        PIC X(4).
   457         16  FILLER              PIC X(30).
   458     12  WS-MANUAL-BILL-NOTE REDEFINES WS-BILLING-NOTE.
   459         16  WS-MAN-BN-NOTE      PIC X(63).
   460         16  FILLER              PIC X(14).
   461     12  WS-LEN                  PIC S9(5) COMP-3 VALUE +0.
   462
   463     12  WS-SAVE-REASON-CODE-IND PIC X(26).
   464
   465 01  NEW-ELCRTO-REC.
   466     12  NEW-ELCRTO-KEY.
   467         16  NCRTO-COMPANY-CD      PIC X.
   468         16  NCRTO-CARRIER         PIC X.
   469         16  NCRTO-GROUPING        PIC X(6).
   470         16  NCRTO-STATE           PIC XX.
   471         16  NCRTO-ACCOUNT         PIC X(10).
   472         16  NCRTO-CERT-EFF-DT     PIC XX.
   473         16  NCRTO-CERT-PRIME      PIC X(10).
   474         16  NCRTO-CERT-SFX        PIC X.
   475         16  NCRTO-RECORD-TYPE     PIC X.
   476         16  NCRTO-SEQ-NO          PIC 9(4) BINARY.
   477     12  NEW-ORIG-REC.
   478         16  NCRTO-INS-LAST-NAME   PIC X(15).
   479         16  NCRTO-INS-FIRST-NAME  PIC X(10).
   480         16  NCRTO-INS-MIDDLE-INIT PIC X.
   481         16  NCRTO-INS-AGE         PIC S999     COMP-3.
   482         16  NCRTO-JNT-LAST-NAME   PIC X(15).
   483         16  NCRTO-JNT-FIRST-NAME  PIC X(10).
   484         16  NCRTO-JNT-MIDDLE-INIT PIC X.
   485         16  NCRTO-JNT-AGE         PIC S999     COMP-3.
   486         16  NCRTO-LF-BENCD        PIC XX.
   487         16  NCRTO-LF-TERM         PIC S999      COMP-3.
   488         16  NCRTO-LF-BEN-AMT      PIC S9(9)V99  COMP-3.
   489         16  NCRTO-LF-PRM-AMT      PIC S9(7)V99  COMP-3.
   490         16  NCRTO-LF-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
   491         16  NCRTO-LF-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
   492         16  NCRTO-LF-EXP-DT       PIC XX.
   493         16  NCRTO-LF-COMM-PCT     PIC SV9(5)    COMP-3.
   494         16  NCRTO-LF-CANCEL-DT    PIC XX.
   495         16  NCRTO-LF-CANCEL-AMT   PIC S9(7)V99  COMP-3.
   496         16  NCRTO-LF-ITD-CANCEL-AMT PIC S9(7)V99 COMP-3.
   497         16  NCRTO-AH-BENCD        PIC XX.
   498         16  NCRTO-AH-TERM         PIC S999      COMP-3.
   499         16  NCRTO-AH-BEN-AMT      PIC S9(9)V99  COMP-3.
   500         16  NCRTO-AH-PRM-AMT      PIC S9(7)V99  COMP-3.
   501         16  NCRTO-AH-EXP-DT       PIC XX.
   502         16  NCRTO-AH-COMM-PCT     PIC SV9(5)    COMP-3.
   503         16  NCRTO-AH-CP           PIC 99.
   504         16  NCRTO-AH-CANCEL-DT    PIC XX.
   505         16  NCRTO-AH-CANCEL-AMT   PIC S9(7)V99  COMP-3.
   506         16  NCRTO-AH-ITD-CANCEL-AMT PIC S9(7)V99 COMP-3.
   507         16  NCRTO-CRED-BENE-NAME  PIC X(25).
   508         16  NCRTO-1ST-PMT-DT      PIC XX.
   509         16  NCRTO-INS-AGE-DEFAULT-FLAG PIC X.
   510         16  NCRTO-JNT-AGE-DEFAULT-FLAG PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  11
* EL6318.cbl
   511         16  NCRTO-ISSUE-TRAN-IND  PIC X.
   512         16  NCRTO-CANCEL-TRAN-IND PIC X.
   513         16  FILLER                PIC X(235).
   514
   515 01  CERT-NOTE-ENTRIES.
   516     12  CERT-NT OCCURS 300 TIMES INDEXED BY TB-INDX TB-INDX1.
   517         16  CERT-NT-TEXT                PIC X(63).
   518         16  CERT-NT-LAST-MAINT-BY       PIC XXXX.
   519         16  CERT-NT-LAST-MAINT-DT       PIC XX.
   520         16  CERT-NT-LAST-MAINT-HHMMSS   PIC S9(7) COMP-3.
   521
   522 01  ERCNOT-AREA.
   523     12  ERCNOT-KEY-LENGTH       PIC S9(4)   COMP VALUE +36.
   524     12  ERCNOT-START-LENGTH     PIC S9(4)   COMP VALUE +34.
   525     12  ERCNOT-KEY.
   526         16  ERCNOT-PARTIAL-KEY.
   527             20 ERCNOT-COMPANY-CD    PIC X.
   528             20 ERCNOT-CARRIER       PIC X.
   529             20 ERCNOT-GROUPING      PIC X(06).
   530             20 ERCNOT-STATE         PIC XX.
   531             20 ERCNOT-ACCOUNT       PIC X(10).
   532             20 ERCNOT-EFF-DT        PIC XX.
   533             20 ERCNOT-CERT-NO.
   534                25 ERCNOT-CERT-PRIME PIC X(10).
   535                25 ERCNOT-CERT-SFX   PIC X.
   536             20 ERCNOT-REC-TYP       PIC X.
   537         16 ERCNOT-SEQ           PIC S9(4) COMP.
   538     12  SV-PARTIAL-KEY.
   539         20 SV-COMPANY-CD            PIC X.
   540         20 SV-CARRIER               PIC X.
   541         20 SV-GROUPING              PIC X(06).
   542         20 SV-STATE                 PIC XX.
   543         20 SV-ACCOUNT               PIC X(10).
   544         20 SV-EFF-DT                PIC XX.
   545         20 SV-CERT-NO.
   546            25 SV-CERT-PRIME         PIC X(10).
   547            25 SV-CERT-SFX           PIC X(1).
   548         20 SV-REC-TYP               PIC X.
   549 01  ERROR-MESSAGES.
   550     12  ER-0000                 PIC X(4)  VALUE '0000'.
   551     12  ER-0004                 PIC X(4)  VALUE '0004'.
   552     12  ER-0008                 PIC X(4)  VALUE '0008'.
   553     12  ER-0023                 PIC X(4)  VALUE '0023'.
   554     12  ER-0029                 PIC X(4)  VALUE '0029'.
   555     12  ER-0068                 PIC X(4)  VALUE '0068'.
   556     12  ER-0132                 PIC X(4)  VALUE '0132'.
   557     12  ER-0142                 PIC X(4)  VALUE '0142'.
   558     12  ER-0148                 PIC X(4)  VALUE '0148'.
   559     12  ER-0215                 PIC X(4)  VALUE '0215'.
   560     12  ER-0280                 PIC X(4)  VALUE '0280'.
   561     12  ER-0348                 PIC X(4)  VALUE '0348'.
   562     12  ER-0419                 PIC X(4)  VALUE '0419'.
   563     12  ER-0715                 PIC X(4)  VALUE '0715'.
   564     12  ER-0894                 PIC X(4)  VALUE '0894'.
   565     12  ER-1101                 PIC X(4)  VALUE '1101'.
   566     12  ER-1236                 PIC X(4)  VALUE '1236'.
   567     12  ER-1560                 PIC X(4)  VALUE '1560'.
   568     12  ER-1664                 PIC X(4)  VALUE '1664'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  12
* EL6318.cbl
   569     12  ER-1778                 PIC X(4)  VALUE '1778'.
   570     12  ER-1818                 PIC X(4)  VALUE '1818'.
   571     12  ER-1820                 PIC X(4)  VALUE '1820'.
   572     12  ER-1821                 PIC X(4)  VALUE '1821'.
   573     12  ER-2056                 PIC X(4)  VALUE '2056'.
   574     12  ER-2079                 PIC X(4)  VALUE '2079'.
   575     12  ER-2208                 PIC X(4)  VALUE '2208'.
   576     12  ER-2209                 PIC X(4)  VALUE '2209'.
   577     12  ER-2237                 PIC X(4)  VALUE '2237'.
   578     12  ER-2238                 PIC X(4)  VALUE '2238'.
   579     12  ER-2253                 PIC X(4)  VALUE '2253'.
   580     12  ER-2619                 PIC X(4)  VALUE '2619'.
   581     12  ER-2651                 PIC X(4)  VALUE '2651'.
   582     12  ER-2784                 PIC X(4)  VALUE '2784'.
   583     12  ER-2785                 PIC X(4)  VALUE '2785'.
   584     12  ER-2786                 PIC X(4)  VALUE '2786'.
   585     12  ER-2791                 PIC X(4)  VALUE '2791'.
   586     12  ER-2845                 PIC X(4)  VALUE '2845'.
   587     12  ER-2848                 PIC X(4)  VALUE '2848'.
   588     12  ER-2851                 PIC X(4)  VALUE '2851'.
   589     12  ER-3830                 PIC X(4)  VALUE '3830'.
   590     12  ER-3833                 PIC X(4)  VALUE '3833'.
   591     12  ER-3844                 PIC X(4)  VALUE '3844'.
   592     12  ER-3845                 PIC X(4)  VALUE '3845'.
   593     12  ER-7345                 PIC X(4)  VALUE '7345'.
   594     12  ER-7638                 PIC X(4)  VALUE '7638'.
   595     12  ER-8888                 PIC X(4)  VALUE '8888'.
   596     12  ER-9999                 PIC X(4)  VALUE '9999'.
   597*    COPY ELCDATE.
   598******************************************************************
   599*                                                                *
   600*                                                                *
   601*                            ELCDATE.                            *
   602*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   603*                            VMOD=2.003
   604*                                                                *
   605*                                                                *
   606*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   607*                 LENGTH = 200                                   *
   608******************************************************************
   609
   610 01  DATE-CONVERSION-DATA.
   611     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   612     12  DC-OPTION-CODE                PIC X.
   613         88  BIN-TO-GREG                VALUE ' '.
   614         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   615         88  EDIT-GREG-TO-BIN           VALUE '2'.
   616         88  YMD-GREG-TO-BIN            VALUE '3'.
   617         88  MDY-GREG-TO-BIN            VALUE '4'.
   618         88  JULIAN-TO-BIN              VALUE '5'.
   619         88  BIN-PLUS-ELAPSED           VALUE '6'.
   620         88  FIND-CENTURY               VALUE '7'.
   621         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   622         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   623         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   624         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   625         88  JULIAN-TO-BIN-3            VALUE 'C'.
   626         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  13
* EL6318.cbl
   627         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   628         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   629         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   630         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   631         88  CHECK-LEAP-YEAR            VALUE 'H'.
   632         88  BIN-3-TO-GREG              VALUE 'I'.
   633         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   634         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   635         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   636         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   637         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   638         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   639         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   640         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   641         88  THREE-CHARACTER-BIN
   642                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   643         88  GREGORIAN-TO-BIN
   644                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   645         88  BIN-TO-GREGORIAN
   646                  VALUES ' ' '1' 'I' '8' 'G'.
   647         88  JULIAN-TO-BINARY
   648                  VALUES '5' 'C' 'E' 'F'.
   649     12  DC-ERROR-CODE                 PIC X.
   650         88  NO-CONVERSION-ERROR        VALUE ' '.
   651         88  DATE-CONVERSION-ERROR
   652                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   653         88  DATE-IS-ZERO               VALUE '1'.
   654         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   655         88  DATE-IS-INVALID            VALUE '3'.
   656         88  DATE1-GREATER-DATE2        VALUE '4'.
   657         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   658         88  DATE-INVALID-OPTION        VALUE '9'.
   659         88  INVALID-CENTURY            VALUE 'A'.
   660         88  ONLY-CENTURY               VALUE 'B'.
   661         88  ONLY-LEAP-YEAR             VALUE 'C'.
   662         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   663     12  DC-END-OF-MONTH               PIC X.
   664         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   665     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   666         88  USE-NORMAL-PROCESS         VALUE ' '.
   667         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   668         88  ADJUST-UP-100-YRS          VALUE '2'.
   669     12  FILLER                        PIC X.
   670     12  DC-CONVERSION-DATES.
   671         16  DC-BIN-DATE-1             PIC XX.
   672         16  DC-BIN-DATE-2             PIC XX.
   673         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   674         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   675                       DC-GREG-DATE-1-EDIT.
   676             20  DC-EDIT1-MONTH        PIC 99.
   677             20  SLASH1-1              PIC X.
   678             20  DC-EDIT1-DAY          PIC 99.
   679             20  SLASH1-2              PIC X.
   680             20  DC-EDIT1-YEAR         PIC 99.
   681         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   682         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   683                     DC-GREG-DATE-2-EDIT.
   684             20  DC-EDIT2-MONTH        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  14
* EL6318.cbl
   685             20  SLASH2-1              PIC X.
   686             20  DC-EDIT2-DAY          PIC 99.
   687             20  SLASH2-2              PIC X.
   688             20  DC-EDIT2-YEAR         PIC 99.
   689         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   690         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   691                     DC-GREG-DATE-1-YMD.
   692             20  DC-YMD-YEAR           PIC 99.
   693             20  DC-YMD-MONTH          PIC 99.
   694             20  DC-YMD-DAY            PIC 99.
   695         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   696         16  DC-GREG-DATE-1-MDY-R REDEFINES
   697                      DC-GREG-DATE-1-MDY.
   698             20  DC-MDY-MONTH          PIC 99.
   699             20  DC-MDY-DAY            PIC 99.
   700             20  DC-MDY-YEAR           PIC 99.
   701         16  DC-GREG-DATE-1-ALPHA.
   702             20  DC-ALPHA-MONTH        PIC X(10).
   703             20  DC-ALPHA-DAY          PIC 99.
   704             20  FILLER                PIC XX.
   705             20  DC-ALPHA-CENTURY.
   706                 24 DC-ALPHA-CEN-N     PIC 99.
   707             20  DC-ALPHA-YEAR         PIC 99.
   708         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   709         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   710         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   711         16  DC-JULIAN-DATE            PIC 9(05).
   712         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   713                                       PIC 9(05).
   714         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   715             20  DC-JULIAN-YEAR        PIC 99.
   716             20  DC-JULIAN-DAYS        PIC 999.
   717         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   718         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   719         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   720     12  DATE-CONVERSION-VARIBLES.
   721         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   722         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   723             20  FILLER                PIC 9(3).
   724             20  HOLD-CEN-1-CCYY.
   725                 24  HOLD-CEN-1-CC     PIC 99.
   726                 24  HOLD-CEN-1-YY     PIC 99.
   727             20  HOLD-CEN-1-MO         PIC 99.
   728             20  HOLD-CEN-1-DA         PIC 99.
   729         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   730             20  HOLD-CEN-1-R-MO       PIC 99.
   731             20  HOLD-CEN-1-R-DA       PIC 99.
   732             20  HOLD-CEN-1-R-CCYY.
   733                 24  HOLD-CEN-1-R-CC   PIC 99.
   734                 24  HOLD-CEN-1-R-YY   PIC 99.
   735             20  FILLER                PIC 9(3).
   736         16  HOLD-CENTURY-1-X.
   737             20  FILLER                PIC X(3)  VALUE SPACES.
   738             20  HOLD-CEN-1-X-CCYY.
   739                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   740                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   741             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   742             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  15
* EL6318.cbl
   743         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   744             20  HOLD-CEN-1-R-X-MO     PIC XX.
   745             20  HOLD-CEN-1-R-X-DA     PIC XX.
   746             20  HOLD-CEN-1-R-X-CCYY.
   747                 24  HOLD-CEN-1-R-X-CC PIC XX.
   748                 24  HOLD-CEN-1-R-X-YY PIC XX.
   749             20  FILLER                PIC XXX.
   750         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   751         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   752         16  DC-JULIAN-DATE-1          PIC 9(07).
   753         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   754             20  DC-JULIAN-1-CCYY.
   755                 24  DC-JULIAN-1-CC    PIC 99.
   756                 24  DC-JULIAN-1-YR    PIC 99.
   757             20  DC-JULIAN-DA-1        PIC 999.
   758         16  DC-JULIAN-DATE-2          PIC 9(07).
   759         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   760             20  DC-JULIAN-2-CCYY.
   761                 24  DC-JULIAN-2-CC    PIC 99.
   762                 24  DC-JULIAN-2-YR    PIC 99.
   763             20  DC-JULIAN-DA-2        PIC 999.
   764         16  DC-GREG-DATE-A-EDIT.
   765             20  DC-EDITA-MONTH        PIC 99.
   766             20  SLASHA-1              PIC X VALUE '/'.
   767             20  DC-EDITA-DAY          PIC 99.
   768             20  SLASHA-2              PIC X VALUE '/'.
   769             20  DC-EDITA-CCYY.
   770                 24  DC-EDITA-CENT     PIC 99.
   771                 24  DC-EDITA-YEAR     PIC 99.
   772         16  DC-GREG-DATE-B-EDIT.
   773             20  DC-EDITB-MONTH        PIC 99.
   774             20  SLASHB-1              PIC X VALUE '/'.
   775             20  DC-EDITB-DAY          PIC 99.
   776             20  SLASHB-2              PIC X VALUE '/'.
   777             20  DC-EDITB-CCYY.
   778                 24  DC-EDITB-CENT     PIC 99.
   779                 24  DC-EDITB-YEAR     PIC 99.
   780         16  DC-GREG-DATE-CYMD         PIC 9(08).
   781         16  DC-GREG-DATE-CYMD-R REDEFINES
   782                              DC-GREG-DATE-CYMD.
   783             20  DC-CYMD-CEN           PIC 99.
   784             20  DC-CYMD-YEAR          PIC 99.
   785             20  DC-CYMD-MONTH         PIC 99.
   786             20  DC-CYMD-DAY           PIC 99.
   787         16  DC-GREG-DATE-MDCY         PIC 9(08).
   788         16  DC-GREG-DATE-MDCY-R REDEFINES
   789                              DC-GREG-DATE-MDCY.
   790             20  DC-MDCY-MONTH         PIC 99.
   791             20  DC-MDCY-DAY           PIC 99.
   792             20  DC-MDCY-CEN           PIC 99.
   793             20  DC-MDCY-YEAR          PIC 99.
   794    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   795        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   796    12  DC-EL310-DATE                  PIC X(21).
   797    12  FILLER                         PIC X(28).
   798*    COPY ELCTEXT.
   799******************************************************************
   800*                                                                *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  16
* EL6318.cbl
   801*                                                                *
   802*                            ELCTEXT.                            *
   803*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   804*                            VMOD=2.008                          *
   805*                                                                *
   806*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
   807*                                     FORM LETTERS,              *
   808*                                     CERT FORM DISPLAY.
   809*                                                                *
   810*   FILE TYPE = VSAM,KSDS                                        *
   811*   RECORD SIZE = 100   RECFORM = FIXED                          *
   812*                                                                *
   813*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
   814*       ALTERNATE INDEX = NONE                                   *
   815*                                                                *
   816*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
   817*       ALTERNATE INDEX = NONE                                   *
   818*                                                                *
   819*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
   820*       ALTERNATE INDEX = NONE                                   *
   821*                                                                *
   822*   LOG = NO                                                     *
   823*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   824******************************************************************
   825 01  TEXT-FILES.
   826     12  TEXT-FILE-ID                PIC XX.
   827         88  FORMS-FILE-TEXT            VALUE 'TF'.
   828         88  LETTER-FILE-TEXT           VALUE 'TL'.
   829         88  HELP-FILE-TEXT             VALUE 'TH'.
   830
   831     12  TX-CONTROL-PRIMARY.
   832         16  TX-COMPANY-CD           PIC X.
   833             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
   834         16  TX-ACCESS-CD-GENL       PIC X(12).
   835
   836         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   837             20  TX-LETTER-NO        PIC X(4).
   838             20  FILLER              PIC X(8).
   839
   840         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   841             20  TX-FORM-NO          PIC X(12).
   842
   843         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   844             20  TX-HELP-TYPE        PIC X.
   845                 88  HELP-FOR-GENERAL   VALUE ' '.
   846                 88  HELP-BY-SCREEN     VALUE 'S'.
   847                 88  HELP-BY-ERROR      VALUE 'E'.
   848             20  TX-SCREEN-OR-ERROR  PIC X(4).
   849                 88  GENERAL-INFO-HELP  VALUE '0000'.
   850             20  TX-HELP-FOR-COMPANY  PIC XXX.
   851                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
   852             20  FILLER              PIC X(4).
   853
   854         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
   855
   856     12  TX-PROCESS-CONTROL          PIC XX.
   857         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
   858
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  17
* EL6318.cbl
   859     12  TX-TEXT-LINE                PIC X(70).
   860
   861     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
   862         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
   863         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
   864         88  TX-VALID-FORM-SQUEEZE-VALUE
   865                                        VALUE 'Y' ' '.
   866
   867     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
   868         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
   869         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
   870         88  TX-DO-NOT-ADJUST           VALUE 'N'.
   871         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
   872         88  TX-NEW-PARAGRAPH           VALUE 'P'.
   873         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
   874         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
   875                                              'K' 'N' ' '
   876                                              'Z'.
   877
   878     12  TX-ARCHIVE-SW               PIC X.
   879         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
   880         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
   881         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
   882
   883     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
   884     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
   885
   886     12  TX-BSR-CODE                 PIC X.
   887         88  TX-BSR-LETTER              VALUE 'B'.
   888         88  TX-NON-BSR-LETTER          VALUE ' '.
   889
   890     12  FILLER                      PIC X.
   891*****************************************************************
   892*    COPY ELCLOGOF.
   893******************************************************************
   894*                                                                *
   895*                                                                *
   896*                            ELCLOGOF.                           *
   897*                            VMOD=2.001                          *
   898*                                                                *
   899*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   900*                                                                *
   901******************************************************************
   902 01  CLASIC-LOGOFF.
   903     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   904     12  LOGOFF-TEXT.
   905         16  FILLER          PIC X(5)    VALUE SPACES.
   906         16  LOGOFF-MSG.
   907             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   908             20  FILLER      PIC X       VALUE SPACES.
   909             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   910         16  FILLER          PIC X(80)
   911           VALUE '* YOU ARE NOW LOGGED OFF'.
   912         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   913         16  FILLER          PIC X       VALUE QUOTE.
   914         16  LOGOFF-SYS-MSG  PIC X(17)
   915           VALUE 'S CLAS-IC SYSTEM '.
   916     12  TEXT-MESSAGES.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  18
* EL6318.cbl
   917         16  UNACCESS-MSG    PIC X(29)
   918             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   919         16  PGMIDERR-MSG    PIC X(17)
   920             VALUE 'PROGRAM NOT FOUND'.
   921*    COPY ELCATTR.
   922******************************************************************
   923*                                                                *
   924*                            ELCATTR.                            *
   925*                            VMOD=2.001                          *
   926*                                                                *
   927*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   928*                                                                *
   929*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   930*                                                                *
   931*                   POS 1   P=PROTECTED                          *
   932*                           U=UNPROTECTED                        *
   933*                           S=ASKIP                              *
   934*                   POS 2   A=ALPHA/NUMERIC                      *
   935*                           N=NUMERIC                            *
   936*                   POS 3   N=NORMAL                             *
   937*                           B=BRIGHT                             *
   938*                           D=DARK                               *
   939*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   940*                           OF=MODIFIED DATA TAG OFF             *
   941*                                                                *
   942*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   943******************************************************************
   944 01  ATTRIBUTE-LIST.
   945     12  AL-PABOF            PIC X       VALUE 'Y'.
   946     12  AL-PABON            PIC X       VALUE 'Z'.
   947     12  AL-PADOF            PIC X       VALUE '%'.
   948     12  AL-PADON            PIC X       VALUE '_'.
   949     12  AL-PANOF            PIC X       VALUE '-'.
   950     12  AL-PANON            PIC X       VALUE '/'.
   951     12  AL-SABOF            PIC X       VALUE '8'.
   952     12  AL-SABON            PIC X       VALUE '9'.
   953     12  AL-SADOF            PIC X       VALUE '@'.
   954     12  AL-SADON            PIC X       VALUE QUOTE.
   955     12  AL-SANOF            PIC X       VALUE '0'.
   956     12  AL-SANON            PIC X       VALUE '1'.
   957     12  AL-UABOF            PIC X       VALUE 'H'.
   958     12  AL-UABON            PIC X       VALUE 'I'.
   959     12  AL-UADOF            PIC X       VALUE '<'.
   960     12  AL-UADON            PIC X       VALUE '('.
   961     12  AL-UANOF            PIC X       VALUE ' '.
   962     12  AL-UANON            PIC X       VALUE 'A'.
   963     12  AL-UNBOF            PIC X       VALUE 'Q'.
   964     12  AL-UNBON            PIC X       VALUE 'R'.
   965     12  AL-UNDOF            PIC X       VALUE '*'.
   966     12  AL-UNDON            PIC X       VALUE ')'.
   967     12  AL-UNNOF            PIC X       VALUE '&'.
   968     12  AL-UNNON            PIC X       VALUE 'J'.
   969*    COPY ELCEMIB.
   970******************************************************************
   971*                                                                *
   972*                                                                *
   973*                            ELCEMIB.                            *
   974*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  19
* EL6318.cbl
   975*                            VMOD=2.005                          *
   976*                                                                *
   977*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   978*                                                                *
   979******************************************************************
   980 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   981     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   982     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   983     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   984     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   985     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   986     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   987     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   988     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   989     12  EMI-SWITCH1             PIC X        VALUE '1'.
   990         88  EMI-NO-ERRORS                    VALUE '1'.
   991         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   992         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   993     12  EMI-SWITCH2             PIC X        VALUE '1'.
   994         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   995     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   996         88  EMI-AREA1-EMPTY                  VALUE '1'.
   997         88  EMI-AREA1-FULL                   VALUE '2'.
   998     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   999         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1000         88  EMI-AREA2-FULL                   VALUE '2'.
  1001     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1002         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1003         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1004         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1005         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1006         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1007     12  EMI-ERROR-LINES.
  1008         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1009         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1010         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1011         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1012             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1013                 24  EMI-ERR-NUM         PIC X(4).
  1014                 24  EMI-FILLER          PIC X.
  1015                 24  EMI-SEV             PIC X.
  1016                 24  FILLER              PIC X.
  1017             20  FILLER                  PIC X(02).
  1018     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1019         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1020             20  EMI-ERROR-NUMBER    PIC X(4).
  1021             20  EMI-FILL            PIC X.
  1022             20  EMI-SEVERITY        PIC X.
  1023             20  FILLER              PIC X.
  1024             20  EMI-ERROR-TEXT.
  1025                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1026                 24  FILLER          PIC X(55).
  1027     12  EMI-SEVERITY-SAVE           PIC X.
  1028         88  EMI-NOTE                    VALUE 'N'.
  1029         88  EMI-WARNING                 VALUE 'W'.
  1030         88  EMI-FORCABLE                VALUE 'F'.
  1031         88  EMI-FATAL                   VALUE 'X'.
  1032     12  EMI-MESSAGE-FLAG            PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  20
* EL6318.cbl
  1033         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1034         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1035     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1036     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1037         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1038         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1039         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1040     12  emi-claim-no                pic x(7).
  1041     12  emi-claim-type              pic x(6).
  1042     12  FILLER                      PIC X(124)  VALUE SPACES.
  1043     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1044     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1045     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1046     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1047*    COPY ELCINTF.
  1048******************************************************************
  1049*                                                                *
  1050*                                                                *
  1051*                            ELCINTF.                            *
  1052*                            VMOD=2.017                          *
  1053*                                                                *
  1054*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1055*                                                                *
  1056*       LENGTH = 1024                                            *
  1057*                                                                *
  1058******************************************************************
  1059*                   C H A N G E   L O G
  1060*
  1061* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1062*-----------------------------------------------------------------
  1063*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1064* EFFECTIVE    NUMBER
  1065*-----------------------------------------------------------------
  1066* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1067******************************************************************
  1068 01  PROGRAM-INTERFACE-BLOCK.
  1069     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1070     12  PI-CALLING-PROGRAM              PIC X(8).
  1071     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1072     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1073     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1074     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1075     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1076     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1077     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1078     12  PI-COMPANY-ID                   PIC XXX.
  1079     12  PI-COMPANY-CD                   PIC X.
  1080
  1081     12  PI-COMPANY-PASSWORD             PIC X(8).
  1082
  1083     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1084
  1085     12  PI-CONTROL-IN-PROGRESS.
  1086         16  PI-CARRIER                  PIC X.
  1087         16  PI-GROUPING                 PIC X(6).
  1088         16  PI-STATE                    PIC XX.
  1089         16  PI-ACCOUNT                  PIC X(10).
  1090         16  PI-PRODUCER REDEFINES PI-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  21
* EL6318.cbl
  1091                                         PIC X(10).
  1092         16  PI-CLAIM-CERT-GRP.
  1093             20  PI-CLAIM-NO             PIC X(7).
  1094             20  PI-CERT-NO.
  1095                 25  PI-CERT-PRIME       PIC X(10).
  1096                 25  PI-CERT-SFX         PIC X.
  1097             20  PI-CERT-EFF-DT          PIC XX.
  1098         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1099             20  PI-PLAN-CODE            PIC X(2).
  1100             20  PI-REVISION-NUMBER      PIC X(3).
  1101             20  PI-PLAN-EFF-DT          PIC X(2).
  1102             20  PI-PLAN-EXP-DT          PIC X(2).
  1103             20  FILLER                  PIC X(11).
  1104         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1105             20  PI-OE-REFERENCE-1.
  1106                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1107                 25  PI-OE-REF-1-SUFF    PIC XX.
  1108
  1109     12  PI-SESSION-IN-PROGRESS          PIC X.
  1110         88  CLAIM-SESSION                   VALUE '1'.
  1111         88  CREDIT-SESSION                  VALUE '2'.
  1112         88  WARRANTY-SESSION                VALUE '3'.
  1113         88  MORTGAGE-SESSION                VALUE '4'.
  1114         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1115
  1116
  1117*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1118
  1119     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1120     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1121
  1122     12  PI-CREDIT-USER                  PIC X.
  1123         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1124         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1125
  1126     12  PI-CLAIM-USER                   PIC X.
  1127         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1128         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1129
  1130     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1131         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1132         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1133         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1134         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1135         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1136
  1137     12  PI-PROCESSOR-ID                 PIC X(4).
  1138
  1139     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1140
  1141     12  PI-MEMBER-CAPTION               PIC X(10).
  1142
  1143     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1144         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1145
  1146     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1147     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1148     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  22
* EL6318.cbl
  1149     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1150
  1151     12  PI-AH-OVERRIDE-L1               PIC X.
  1152     12  PI-AH-OVERRIDE-L2               PIC XX.
  1153     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1154     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1155
  1156     12  PI-NEW-SYSTEM                   PIC X(2).
  1157
  1158     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1159     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1160         88  PI-USES-PAID-TO                 VALUE '1'.
  1161     12  PI-CRDTCRD-SYSTEM.
  1162         16  PI-CRDTCRD-USER             PIC X.
  1163             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1164             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1165         16  PI-CC-MONTH-END-DT          PIC XX.
  1166     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1167
  1168     12  PI-OE-REFERENCE-2.
  1169         16  PI-OE-REF-2-PRIME           PIC X(10).
  1170         16  PI-OE-REF-2-SUFF            PIC X.
  1171
  1172     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1173
  1174     12  PI-LANGUAGE-TYPE                PIC X.
  1175             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1176             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1177             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1178
  1179     12  PI-POLICY-LINKAGE-IND           PIC X.
  1180         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1181         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1182                                                   LOW-VALUES.
  1183
  1184     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1185     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1186         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1187         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1188
  1189     12  PI-PROCESSOR-CSR-IND            PIC X.
  1190         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1191         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1192
  1193     12  FILLER                          PIC X(3).
  1194
  1195     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1196
  1197     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1198         PI-SYSTEM-LEVEL.
  1199
  1200         16  PI-ENTRY-CODES.
  1201             20  PI-ENTRY-CD-1           PIC X.
  1202             20  PI-ENTRY-CD-2           PIC X.
  1203
  1204         16  PI-RETURN-CODES.
  1205             20  PI-RETURN-CD-1          PIC X.
  1206             20  PI-RETURN-CD-2          PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  23
* EL6318.cbl
  1207
  1208         16  PI-UPDATE-STATUS-SAVE.
  1209             20  PI-UPDATE-BY            PIC X(4).
  1210             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1211
  1212         16  PI-LOWER-CASE-LETTERS       PIC X.
  1213             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1214
  1215*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1216*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1217*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1218
  1219         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1220             88  ST-ACCNT-CNTL               VALUE ' '.
  1221             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1222             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1223             88  ACCNT-CNTL                  VALUE '3'.
  1224             88  CARR-ACCNT-CNTL             VALUE '4'.
  1225
  1226         16  PI-PROCESSOR-CAP-LIST.
  1227             20  PI-SYSTEM-CONTROLS.
  1228                24 PI-SYSTEM-DISPLAY     PIC X.
  1229                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1230                24 PI-SYSTEM-MODIFY      PIC X.
  1231                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1232             20  FILLER                  PIC XX.
  1233             20  PI-DISPLAY-CAP          PIC X.
  1234                 88  DISPLAY-CAP             VALUE 'Y'.
  1235             20  PI-MODIFY-CAP           PIC X.
  1236                 88  MODIFY-CAP              VALUE 'Y'.
  1237             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1238                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1239             20  PI-FORCE-CAP            PIC X.
  1240                 88  FORCE-CAP               VALUE 'Y'.
  1241
  1242         16  PI-PROGRAM-CONTROLS.
  1243             20  PI-PGM-PRINT-OPT        PIC X.
  1244             20  PI-PGM-FORMAT-OPT       PIC X.
  1245             20  PI-PGM-PROCESS-OPT      PIC X.
  1246             20  PI-PGM-TOTALS-OPT       PIC X.
  1247
  1248         16  PI-HELP-INTERFACE.
  1249             20  PI-LAST-ERROR-NO        PIC X(4).
  1250             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1251
  1252         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1253             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1254
  1255         16  PI-CR-CONTROL-IN-PROGRESS.
  1256             20  PI-CR-CARRIER           PIC X.
  1257             20  PI-CR-GROUPING          PIC X(6).
  1258             20  PI-CR-STATE             PIC XX.
  1259             20  PI-CR-ACCOUNT           PIC X(10).
  1260             20  PI-CR-FIN-RESP          PIC X(10).
  1261             20  PI-CR-TYPE              PIC X.
  1262
  1263         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1264
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  24
* EL6318.cbl
  1265         16  PI-CR-MONTH-END-DT          PIC XX.
  1266
  1267         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1268             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1269             88  PI-ZERO-CARRIER             VALUE '1'.
  1270             88  PI-ZERO-GROUPING            VALUE '2'.
  1271             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1272
  1273         16  PI-CARRIER-SECURITY         PIC X.
  1274             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1275
  1276         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1277             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1278             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1279
  1280         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1281             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1282                                         INDEXED BY PI-ACCESS-NDX
  1283                                         PIC X.
  1284
  1285         16  PI-GA-BILLING-CONTROL       PIC X.
  1286             88  PI-GA-BILLING               VALUE '1'.
  1287
  1288         16  PI-MAIL-PROCESSING          PIC X.
  1289             88  PI-MAIL-YES                 VALUE 'Y'.
  1290
  1291         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1292
  1293         16  PI-AR-SYSTEM.
  1294             20  PI-AR-PROCESSING-CNTL   PIC X.
  1295                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1296             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1297             20  PI-AR-MONTH-END-DT      PIC XX.
  1298
  1299         16  PI-MP-SYSTEM.
  1300             20  PI-MORTGAGE-USER            PIC X.
  1301                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1302                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1303             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1304                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1305                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1306                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1307                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1308                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1309             20  PI-MP-MONTH-END-DT          PIC XX.
  1310             20  PI-MP-REFERENCE-NO.
  1311                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1312                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1313
  1314         16  PI-LABEL-CONTROL            PIC X(01).
  1315             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1316             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1317
  1318         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1319             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1320
  1321         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1322             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  25
* EL6318.cbl
  1323             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1324
  1325         16  FILLER                      PIC X(14).
  1326
  1327     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1328******************************************************************
  1329     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  1330        16  PI-ISS-CAN-SW           PIC X.
  1331        16  PI-ERENDT-KEY.  *>  36
  1332            20  PI-ENDT-COMPANY-CD  PIC X.
  1333            20  PI-ENDT-CARRIER     PIC X.
  1334            20  PI-ENDT-GROUPING    PIC X(6).
  1335            20  PI-ENDT-STATE       PIC XX.
  1336            20  PI-ENDT-ACCOUNT     PIC X(10).
  1337            20  PI-ENDT-CERT-EFF-DT PIC XX.
  1338            20  PI-ENDT-CERT-PRIME  PIC X(10).
  1339            20  PI-ENDT-CERT-SFX    PIC X.
  1340            20  PI-ENDT-RECORD-TYPE PIC X.
  1341            20  PI-ENDT-SEQ-NO      PIC 9(4) BINARY.
  1342        16  PI-ELCRTO-KEY.  *> 36
  1343            20  PI-CRTO-COMPANY-CD  PIC X.
  1344            20  PI-CRTO-CARRIER     PIC X.
  1345            20  PI-CRTO-GROUPING    PIC X(6).
  1346            20  PI-CRTO-STATE       PIC XX.
  1347            20  PI-CRTO-ACCOUNT     PIC X(10).
  1348            20  PI-CRTO-CERT-EFF-DT PIC XX.
  1349            20  PI-CRTO-CERT-PRIME  PIC X(10).
  1350            20  PI-CRTO-CERT-SFX    PIC X.
  1351            20  PI-CRTO-RECORD-TYPE PIC X.
  1352            20  PI-CRTO-SEQ-NO      PIC 9(4) BINARY.
  1353        16  PI-ERPNDB-KEY           PIC X(11).
  1354        16  PI-DOCUMENT-PROCESSED   PIC X.
  1355            88  PI-VERI-PROCESSED      VALUE 'V'.
  1356            88  PI-ENDO-PROCESSED      VALUE 'G'.
  1357        16  PI-PREV-ERENDT-KEY      PIC X(36).
  1358        16  PI-RES-REF-CLM-TYPE     PIC X.
  1359        16  PI-CLM-REFORM-IND       PIC X.
  1360            88  PI-CLAIM-REFORMATION   VALUE 'Y'.
  1361        16  PI-CLEAR-ERROR-SW       PIC X.
  1362            88  PI-CLEAR-ERROR         VALUE 'Y'.
  1363        16  PI-PRINT-CERTIFICATE    PIC X.
  1364        16  PI-ENTERED.  *> 233
  1365            20  PI-PRTSW-ENTERED    PIC X.
  1366            20  PI-SIGREQ-ENTERED   PIC X.
  1367            20  PI-LTRID-ENTERED    PIC X(4).
  1368            20  PI-VOUCHER-ENTERED  PIC X.
  1369            20  PI-HLTHAPP-ENTERED  PIC X.
  1370            20  PI-PAYEE-ENTERED    PIC X(10).
  1371            20  PI-CERTID-ENTERED   PIC X(5).
  1372            20  PI-REASONS-ENTERED  PIC X(84).
  1373            20  PI-CERTNT1-ENTERED  PIC X(63).
  1374            20  PI-CERTNT2-ENTERED  PIC X(63).
  1375        16  PI-FINALIZED-IND        PIC X.
  1376        16  PI-CERTNT3-ENTERED      PIC X(63).
  1377        16  PI-CERTNT4-ENTERED      PIC X(63).
  1378        16  PI-BILLNT1-ENTERED      PIC X(63).
  1379        16  PI-BILLNT2-ENTERED      PIC X(63).
  1380        16  PI-REASON-CODE-IND      PIC X(26).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  26
* EL6318.cbl
  1381        16  PI-ENCCODE              PIC X(3).
  1382    12  pi-el677-work-area redefines pi-program-work-area.
  1383        16  filler                  pic x(318).
  1384        16  pi-el677-prm-diff       pic s9(7)v99 comp-3.
  1385        16  pi-el677-com-diff       pic s9(5)v99 comp-3.
  1386        16  pi-el677-check-type     pic x.
  1387        16  pi-el677-check-cut      pic x.
  1388        16  filler                  pic x(311).
  1389    12  pi-endt-prm-diff            pic s9(7)v99 comp-3.
  1390    12  pi-endt-com-diff            pic s9(5)v99 comp-3.
  1391    12  pi-check-cut                pic x.
  1392    12  pi-check-type               pic x.
  1393    12  FILLER                      PIC X(265). *> was 276
  1394*    COPY ELCAID.
  1395******************************************************************
  1396*                                                                *
  1397*                            ELCAID.                             *
  1398*                            VMOD=2.001                          *
  1399*                                                                *
  1400*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1401*                                                                *
  1402*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1403*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1404******************************************************************
  1405
  1406 01  DFHAID.
  1407   02  DFHNULL   PIC  X  VALUE  ' '.
  1408   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1409   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1410   02  DFHPEN    PIC  X  VALUE  '='.
  1411   02  DFHOPID   PIC  X  VALUE  'W'.
  1412   02  DFHPA1    PIC  X  VALUE  '%'.
  1413   02  DFHPA2    PIC  X  VALUE  '>'.
  1414   02  DFHPA3    PIC  X  VALUE  ','.
  1415   02  DFHPF1    PIC  X  VALUE  '1'.
  1416   02  DFHPF2    PIC  X  VALUE  '2'.
  1417   02  DFHPF3    PIC  X  VALUE  '3'.
  1418   02  DFHPF4    PIC  X  VALUE  '4'.
  1419   02  DFHPF5    PIC  X  VALUE  '5'.
  1420   02  DFHPF6    PIC  X  VALUE  '6'.
  1421   02  DFHPF7    PIC  X  VALUE  '7'.
  1422   02  DFHPF8    PIC  X  VALUE  '8'.
  1423   02  DFHPF9    PIC  X  VALUE  '9'.
  1424   02  DFHPF10   PIC  X  VALUE  ':'.
  1425   02  DFHPF11   PIC  X  VALUE  '#'.
  1426   02  DFHPF12   PIC  X  VALUE  '@'.
  1427   02  DFHPF13   PIC  X  VALUE  'A'.
  1428   02  DFHPF14   PIC  X  VALUE  'B'.
  1429   02  DFHPF15   PIC  X  VALUE  'C'.
  1430   02  DFHPF16   PIC  X  VALUE  'D'.
  1431   02  DFHPF17   PIC  X  VALUE  'E'.
  1432   02  DFHPF18   PIC  X  VALUE  'F'.
  1433   02  DFHPF19   PIC  X  VALUE  'G'.
  1434   02  DFHPF20   PIC  X  VALUE  'H'.
  1435   02  DFHPF21   PIC  X  VALUE  'I'.
  1436*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1437   02  DFHPF22   PIC  X  VALUE  '['.
  1438   02  DFHPF23   PIC  X  VALUE  '.'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  27
* EL6318.cbl
  1439   02  DFHPF24   PIC  X  VALUE  '<'.
  1440   02  DFHMSRE   PIC  X  VALUE  'X'.
  1441   02  DFHSTRF   PIC  X  VALUE  'h'.
  1442   02  DFHTRIG   PIC  X  VALUE  '"'.
  1443 01  FILLER    REDEFINES DFHAID.
  1444     12  FILLER              PIC X(8).
  1445     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  1446     12  FILLER              PIC X(3).
  1447*   COPY EL6318S.
  1448 01  EL631KI.
  1449     05  FILLER            PIC  X(0012).
  1450*    -------------------------------
  1451     05  DATEL PIC S9(0004) COMP.
  1452     05  DATEF PIC  X(0001).
  1453     05  FILLER REDEFINES DATEF.
  1454         10  DATEA PIC  X(0001).
  1455     05  DATEI PIC  X(0008).
  1456*    -------------------------------
  1457     05  TIMEL PIC S9(0004) COMP.
  1458     05  TIMEF PIC  X(0001).
  1459     05  FILLER REDEFINES TIMEF.
  1460         10  TIMEA PIC  X(0001).
  1461     05  TIMEI PIC  X(0005).
  1462*    -------------------------------
  1463     05  PROCIDL PIC S9(0004) COMP.
  1464     05  PROCIDF PIC  X(0001).
  1465     05  FILLER REDEFINES PROCIDF.
  1466         10  PROCIDA PIC  X(0001).
  1467     05  PROCIDI PIC  X(0004).
  1468*    -------------------------------
  1469     05  HOSTL PIC S9(0004) COMP.
  1470     05  HOSTF PIC  X(0001).
  1471     05  FILLER REDEFINES HOSTF.
  1472         10  HOSTA PIC  X(0001).
  1473     05  HOSTI PIC  X(0009).
  1474*    -------------------------------
  1475     05  SYSL PIC S9(0004) COMP.
  1476     05  SYSF PIC  X(0001).
  1477     05  FILLER REDEFINES SYSF.
  1478         10  SYSA PIC  X(0001).
  1479     05  SYSI PIC  X(0005).
  1480*    -------------------------------
  1481     05  COMPANYL PIC S9(0004) COMP.
  1482     05  COMPANYF PIC  X(0001).
  1483     05  FILLER REDEFINES COMPANYF.
  1484         10  COMPANYA PIC  X(0001).
  1485     05  COMPANYI PIC  X(0003).
  1486*    -------------------------------
  1487     05  DATASORL PIC S9(0004) COMP.
  1488     05  DATASORF PIC  X(0001).
  1489     05  FILLER REDEFINES DATASORF.
  1490         10  DATASORA PIC  X(0001).
  1491     05  DATASORI PIC  X(0001).
  1492*    -------------------------------
  1493     05  BATCHNOL PIC S9(0004) COMP.
  1494     05  BATCHNOF PIC  X(0001).
  1495     05  FILLER REDEFINES BATCHNOF.
  1496         10  BATCHNOA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  28
* EL6318.cbl
  1497     05  BATCHNOI PIC  X(0006).
  1498*    -------------------------------
  1499     05  BSEQNOL PIC S9(0004) COMP.
  1500     05  BSEQNOF PIC  X(0001).
  1501     05  FILLER REDEFINES BSEQNOF.
  1502         10  BSEQNOA PIC  X(0001).
  1503     05  BSEQNOI PIC  X(0008).
  1504*    -------------------------------
  1505     05  ARCHNOL PIC S9(0004) COMP.
  1506     05  ARCHNOF PIC  X(0001).
  1507     05  FILLER REDEFINES ARCHNOF.
  1508         10  ARCHNOA PIC  X(0001).
  1509     05  ARCHNOI PIC  X(0008).
  1510*    -------------------------------
  1511     05  PRTSWL PIC S9(0004) COMP.
  1512     05  PRTSWF PIC  X(0001).
  1513     05  FILLER REDEFINES PRTSWF.
  1514         10  PRTSWA PIC  X(0001).
  1515     05  PRTSWI PIC  X(0001).
  1516*    -------------------------------
  1517     05  CARRL PIC S9(0004) COMP.
  1518     05  CARRF PIC  X(0001).
  1519     05  FILLER REDEFINES CARRF.
  1520         10  CARRA PIC  X(0001).
  1521     05  CARRI PIC  X(0001).
  1522*    -------------------------------
  1523     05  GROUPL PIC S9(0004) COMP.
  1524     05  GROUPF PIC  X(0001).
  1525     05  FILLER REDEFINES GROUPF.
  1526         10  GROUPA PIC  X(0001).
  1527     05  GROUPI PIC  X(0006).
  1528*    -------------------------------
  1529     05  STATEL PIC S9(0004) COMP.
  1530     05  STATEF PIC  X(0001).
  1531     05  FILLER REDEFINES STATEF.
  1532         10  STATEA PIC  X(0001).
  1533     05  STATEI PIC  X(0002).
  1534*    -------------------------------
  1535     05  ACCTL PIC S9(0004) COMP.
  1536     05  ACCTF PIC  X(0001).
  1537     05  FILLER REDEFINES ACCTF.
  1538         10  ACCTA PIC  X(0001).
  1539     05  ACCTI PIC  X(0010).
  1540*    -------------------------------
  1541     05  EFFDTL PIC S9(0004) COMP.
  1542     05  EFFDTF PIC  X(0001).
  1543     05  FILLER REDEFINES EFFDTF.
  1544         10  EFFDTA PIC  X(0001).
  1545     05  EFFDTI PIC  X(0008).
  1546*    -------------------------------
  1547     05  CERTNOL PIC S9(0004) COMP.
  1548     05  CERTNOF PIC  X(0001).
  1549     05  FILLER REDEFINES CERTNOF.
  1550         10  CERTNOA PIC  X(0001).
  1551     05  CERTNOI PIC  X(0010).
  1552*    -------------------------------
  1553     05  CRTSFXL PIC S9(0004) COMP.
  1554     05  CRTSFXF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  29
* EL6318.cbl
  1555     05  FILLER REDEFINES CRTSFXF.
  1556         10  CRTSFXA PIC  X(0001).
  1557     05  CRTSFXI PIC  X(0001).
  1558*    -------------------------------
  1559     05  SEQNOL PIC S9(0004) COMP.
  1560     05  SEQNOF PIC  X(0001).
  1561     05  FILLER REDEFINES SEQNOF.
  1562         10  SEQNOA PIC  X(0001).
  1563     05  SEQNOI PIC  X(0006).
  1564*    -------------------------------
  1565     05  SIGREQL PIC S9(0004) COMP.
  1566     05  SIGREQF PIC  X(0001).
  1567     05  FILLER REDEFINES SIGREQF.
  1568         10  SIGREQA PIC  X(0001).
  1569     05  SIGREQI PIC  X(0001).
  1570*    -------------------------------
  1571     05  LTRIDL PIC S9(0004) COMP.
  1572     05  LTRIDF PIC  X(0001).
  1573     05  FILLER REDEFINES LTRIDF.
  1574         10  LTRIDA PIC  X(0001).
  1575     05  LTRIDI PIC  X(0004).
  1576*    -------------------------------
  1577     05  HLTHAPPL PIC S9(0004) COMP.
  1578     05  HLTHAPPF PIC  X(0001).
  1579     05  FILLER REDEFINES HLTHAPPF.
  1580         10  HLTHAPPA PIC  X(0001).
  1581     05  HLTHAPPI PIC  X(0001).
  1582*    -------------------------------
  1583     05  VOUCHL PIC S9(0004) COMP.
  1584     05  VOUCHF PIC  X(0001).
  1585     05  FILLER REDEFINES VOUCHF.
  1586         10  VOUCHA PIC  X(0001).
  1587     05  VOUCHI PIC  X(0001).
  1588*    -------------------------------
  1589     05  PAYEEL PIC S9(0004) COMP.
  1590     05  PAYEEF PIC  X(0001).
  1591     05  FILLER REDEFINES PAYEEF.
  1592         10  PAYEEA PIC  X(0001).
  1593     05  PAYEEI PIC  X(0010).
  1594*    -------------------------------
  1595     05  CERTIDL PIC S9(0004) COMP.
  1596     05  CERTIDF PIC  X(0001).
  1597     05  FILLER REDEFINES CERTIDF.
  1598         10  CERTIDA PIC  X(0001).
  1599     05  CERTIDI PIC  X(0005).
  1600*    -------------------------------
  1601     05  ENCCODEL PIC S9(0004) COMP.
  1602     05  ENCCODEF PIC  X(0001).
  1603     05  FILLER REDEFINES ENCCODEF.
  1604         10  ENCCODEA PIC  X(0001).
  1605     05  ENCCODEI PIC  X(0003).
  1606*    -------------------------------
  1607     05  RCD01L PIC S9(0004) COMP.
  1608     05  RCD01F PIC  X(0001).
  1609     05  FILLER REDEFINES RCD01F.
  1610         10  RCD01A PIC  X(0001).
  1611     05  RCD01I PIC  X(0004).
  1612*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  30
* EL6318.cbl
  1613     05  RCD02L PIC S9(0004) COMP.
  1614     05  RCD02F PIC  X(0001).
  1615     05  FILLER REDEFINES RCD02F.
  1616         10  RCD02A PIC  X(0001).
  1617     05  RCD02I PIC  X(0004).
  1618*    -------------------------------
  1619     05  RCD03L PIC S9(0004) COMP.
  1620     05  RCD03F PIC  X(0001).
  1621     05  FILLER REDEFINES RCD03F.
  1622         10  RCD03A PIC  X(0001).
  1623     05  RCD03I PIC  X(0004).
  1624*    -------------------------------
  1625     05  RCD04L PIC S9(0004) COMP.
  1626     05  RCD04F PIC  X(0001).
  1627     05  FILLER REDEFINES RCD04F.
  1628         10  RCD04A PIC  X(0001).
  1629     05  RCD04I PIC  X(0004).
  1630*    -------------------------------
  1631     05  RCD05L PIC S9(0004) COMP.
  1632     05  RCD05F PIC  X(0001).
  1633     05  FILLER REDEFINES RCD05F.
  1634         10  RCD05A PIC  X(0001).
  1635     05  RCD05I PIC  X(0004).
  1636*    -------------------------------
  1637     05  RCD06L PIC S9(0004) COMP.
  1638     05  RCD06F PIC  X(0001).
  1639     05  FILLER REDEFINES RCD06F.
  1640         10  RCD06A PIC  X(0001).
  1641     05  RCD06I PIC  X(0004).
  1642*    -------------------------------
  1643     05  RCD07L PIC S9(0004) COMP.
  1644     05  RCD07F PIC  X(0001).
  1645     05  FILLER REDEFINES RCD07F.
  1646         10  RCD07A PIC  X(0001).
  1647     05  RCD07I PIC  X(0004).
  1648*    -------------------------------
  1649     05  RCD08L PIC S9(0004) COMP.
  1650     05  RCD08F PIC  X(0001).
  1651     05  FILLER REDEFINES RCD08F.
  1652         10  RCD08A PIC  X(0001).
  1653     05  RCD08I PIC  X(0004).
  1654*    -------------------------------
  1655     05  RCD09L PIC S9(0004) COMP.
  1656     05  RCD09F PIC  X(0001).
  1657     05  FILLER REDEFINES RCD09F.
  1658         10  RCD09A PIC  X(0001).
  1659     05  RCD09I PIC  X(0004).
  1660*    -------------------------------
  1661     05  RCD10L PIC S9(0004) COMP.
  1662     05  RCD10F PIC  X(0001).
  1663     05  FILLER REDEFINES RCD10F.
  1664         10  RCD10A PIC  X(0001).
  1665     05  RCD10I PIC  X(0004).
  1666*    -------------------------------
  1667     05  RCD11L PIC S9(0004) COMP.
  1668     05  RCD11F PIC  X(0001).
  1669     05  FILLER REDEFINES RCD11F.
  1670         10  RCD11A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  31
* EL6318.cbl
  1671     05  RCD11I PIC  X(0004).
  1672*    -------------------------------
  1673     05  RCD12L PIC S9(0004) COMP.
  1674     05  RCD12F PIC  X(0001).
  1675     05  FILLER REDEFINES RCD12F.
  1676         10  RCD12A PIC  X(0001).
  1677     05  RCD12I PIC  X(0004).
  1678*    -------------------------------
  1679     05  CRTNT1L PIC S9(0004) COMP.
  1680     05  CRTNT1F PIC  X(0001).
  1681     05  FILLER REDEFINES CRTNT1F.
  1682         10  CRTNT1A PIC  X(0001).
  1683     05  CRTNT1I PIC  X(0063).
  1684*    -------------------------------
  1685     05  CRTNT2L PIC S9(0004) COMP.
  1686     05  CRTNT2F PIC  X(0001).
  1687     05  FILLER REDEFINES CRTNT2F.
  1688         10  CRTNT2A PIC  X(0001).
  1689     05  CRTNT2I PIC  X(0063).
  1690*    -------------------------------
  1691     05  CRTNT3L PIC S9(0004) COMP.
  1692     05  CRTNT3F PIC  X(0001).
  1693     05  FILLER REDEFINES CRTNT3F.
  1694         10  CRTNT3A PIC  X(0001).
  1695     05  CRTNT3I PIC  X(0063).
  1696*    -------------------------------
  1697     05  CRTNT4L PIC S9(0004) COMP.
  1698     05  CRTNT4F PIC  X(0001).
  1699     05  FILLER REDEFINES CRTNT4F.
  1700         10  CRTNT4A PIC  X(0001).
  1701     05  CRTNT4I PIC  X(0063).
  1702*    -------------------------------
  1703     05  BILNT1L PIC S9(0004) COMP.
  1704     05  BILNT1F PIC  X(0001).
  1705     05  FILLER REDEFINES BILNT1F.
  1706         10  BILNT1A PIC  X(0001).
  1707     05  BILNT1I PIC  X(0063).
  1708*    -------------------------------
  1709     05  BILNT2L PIC S9(0004) COMP.
  1710     05  BILNT2F PIC  X(0001).
  1711     05  FILLER REDEFINES BILNT2F.
  1712         10  BILNT2A PIC  X(0001).
  1713     05  BILNT2I PIC  X(0063).
  1714*    -------------------------------
  1715     05  ERRMSG1L PIC S9(0004) COMP.
  1716     05  ERRMSG1F PIC  X(0001).
  1717     05  FILLER REDEFINES ERRMSG1F.
  1718         10  ERRMSG1A PIC  X(0001).
  1719     05  ERRMSG1I PIC  X(0075).
  1720*    -------------------------------
  1721     05  ERRMSG2L PIC S9(0004) COMP.
  1722     05  ERRMSG2F PIC  X(0001).
  1723     05  FILLER REDEFINES ERRMSG2F.
  1724         10  ERRMSG2A PIC  X(0001).
  1725     05  ERRMSG2I PIC  X(0075).
  1726*    -------------------------------
  1727     05  PFENTRL PIC S9(0004) COMP.
  1728     05  PFENTRF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  32
* EL6318.cbl
  1729     05  FILLER REDEFINES PFENTRF.
  1730         10  PFENTRA PIC  X(0001).
  1731     05  PFENTRI PIC  9(2).
  1732 01  EL631KO REDEFINES EL631KI.
  1733     05  FILLER            PIC  X(0012).
  1734*    -------------------------------
  1735     05  FILLER            PIC  X(0003).
  1736     05  DATEO PIC  X(0008).
  1737*    -------------------------------
  1738     05  FILLER            PIC  X(0003).
  1739     05  TIMEO PIC  99.99.
  1740*    -------------------------------
  1741     05  FILLER            PIC  X(0003).
  1742     05  PROCIDO PIC  X(0004).
  1743*    -------------------------------
  1744     05  FILLER            PIC  X(0003).
  1745     05  HOSTO PIC  X(0009).
  1746*    -------------------------------
  1747     05  FILLER            PIC  X(0003).
  1748     05  SYSO PIC  X(0005).
  1749*    -------------------------------
  1750     05  FILLER            PIC  X(0003).
  1751     05  COMPANYO PIC  X(0003).
  1752*    -------------------------------
  1753     05  FILLER            PIC  X(0003).
  1754     05  DATASORO PIC  X(0001).
  1755*    -------------------------------
  1756     05  FILLER            PIC  X(0003).
  1757     05  BATCHNOO PIC  X(0006).
  1758*    -------------------------------
  1759     05  FILLER            PIC  X(0003).
  1760     05  BSEQNOO PIC  X(0008).
  1761*    -------------------------------
  1762     05  FILLER            PIC  X(0003).
  1763     05  ARCHNOO PIC  X(0008).
  1764*    -------------------------------
  1765     05  FILLER            PIC  X(0003).
  1766     05  PRTSWO PIC  X(0001).
  1767*    -------------------------------
  1768     05  FILLER            PIC  X(0003).
  1769     05  CARRO PIC  X(0001).
  1770*    -------------------------------
  1771     05  FILLER            PIC  X(0003).
  1772     05  GROUPO PIC  X(0006).
  1773*    -------------------------------
  1774     05  FILLER            PIC  X(0003).
  1775     05  STATEO PIC  X(0002).
  1776*    -------------------------------
  1777     05  FILLER            PIC  X(0003).
  1778     05  ACCTO PIC  X(0010).
  1779*    -------------------------------
  1780     05  FILLER            PIC  X(0003).
  1781     05  EFFDTO PIC  X(0008).
  1782*    -------------------------------
  1783     05  FILLER            PIC  X(0003).
  1784     05  CERTNOO PIC  X(0010).
  1785*    -------------------------------
  1786     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  33
* EL6318.cbl
  1787     05  CRTSFXO PIC  X(0001).
  1788*    -------------------------------
  1789     05  FILLER            PIC  X(0003).
  1790     05  SEQNOO PIC  999999.
  1791*    -------------------------------
  1792     05  FILLER            PIC  X(0003).
  1793     05  SIGREQO PIC  X(0001).
  1794*    -------------------------------
  1795     05  FILLER            PIC  X(0003).
  1796     05  LTRIDO PIC  X(0004).
  1797*    -------------------------------
  1798     05  FILLER            PIC  X(0003).
  1799     05  HLTHAPPO PIC  X(0001).
  1800*    -------------------------------
  1801     05  FILLER            PIC  X(0003).
  1802     05  VOUCHO PIC  X(0001).
  1803*    -------------------------------
  1804     05  FILLER            PIC  X(0003).
  1805     05  PAYEEO PIC  X(0010).
  1806*    -------------------------------
  1807     05  FILLER            PIC  X(0003).
  1808     05  CERTIDO PIC  X(0005).
  1809*    -------------------------------
  1810     05  FILLER            PIC  X(0003).
  1811     05  ENCCODEO PIC  X(0003).
  1812*    -------------------------------
  1813     05  FILLER            PIC  X(0003).
  1814     05  RCD01O PIC  X(0004).
  1815*    -------------------------------
  1816     05  FILLER            PIC  X(0003).
  1817     05  RCD02O PIC  X(0004).
  1818*    -------------------------------
  1819     05  FILLER            PIC  X(0003).
  1820     05  RCD03O PIC  X(0004).
  1821*    -------------------------------
  1822     05  FILLER            PIC  X(0003).
  1823     05  RCD04O PIC  X(0004).
  1824*    -------------------------------
  1825     05  FILLER            PIC  X(0003).
  1826     05  RCD05O PIC  X(0004).
  1827*    -------------------------------
  1828     05  FILLER            PIC  X(0003).
  1829     05  RCD06O PIC  X(0004).
  1830*    -------------------------------
  1831     05  FILLER            PIC  X(0003).
  1832     05  RCD07O PIC  X(0004).
  1833*    -------------------------------
  1834     05  FILLER            PIC  X(0003).
  1835     05  RCD08O PIC  X(0004).
  1836*    -------------------------------
  1837     05  FILLER            PIC  X(0003).
  1838     05  RCD09O PIC  X(0004).
  1839*    -------------------------------
  1840     05  FILLER            PIC  X(0003).
  1841     05  RCD10O PIC  X(0004).
  1842*    -------------------------------
  1843     05  FILLER            PIC  X(0003).
  1844     05  RCD11O PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  34
* EL6318.cbl
  1845*    -------------------------------
  1846     05  FILLER            PIC  X(0003).
  1847     05  RCD12O PIC  X(0004).
  1848*    -------------------------------
  1849     05  FILLER            PIC  X(0003).
  1850     05  CRTNT1O PIC  X(0063).
  1851*    -------------------------------
  1852     05  FILLER            PIC  X(0003).
  1853     05  CRTNT2O PIC  X(0063).
  1854*    -------------------------------
  1855     05  FILLER            PIC  X(0003).
  1856     05  CRTNT3O PIC  X(0063).
  1857*    -------------------------------
  1858     05  FILLER            PIC  X(0003).
  1859     05  CRTNT4O PIC  X(0063).
  1860*    -------------------------------
  1861     05  FILLER            PIC  X(0003).
  1862     05  BILNT1O PIC  X(0063).
  1863*    -------------------------------
  1864     05  FILLER            PIC  X(0003).
  1865     05  BILNT2O PIC  X(0063).
  1866*    -------------------------------
  1867     05  FILLER            PIC  X(0003).
  1868     05  ERRMSG1O PIC  X(0075).
  1869*    -------------------------------
  1870     05  FILLER            PIC  X(0003).
  1871     05  ERRMSG2O PIC  X(0075).
  1872*    -------------------------------
  1873     05  FILLER            PIC  X(0003).
  1874     05  PFENTRO PIC  X(0002).
  1875*    -------------------------------
  1876 01  FILLER REDEFINES EL631KI.
  1877     12  FILLER             PIC X(217).
  1878     12  REASONCDS.
  1879         16  FILLER OCCURS 12.
  1880           20  REACDL       PIC S9(4) COMP.
  1881           20  REACDA       PIC X.
  1882           20  REACD-IN     PIC X(4).
  1883     12  FILLER             PIC X(557).
  1884****************************************************************
  1885*
  1886* Copyright (c) 2007-2013 Dell Inc.
  1887* All rights reserved.
  1888*
  1889****************************************************************
  1890 01  DFHEIV.
  1891   02  DFHEIV0               PIC X(35).
  1892   02  DFHEIV1               PIC X(08).
  1893   02  DFHEIV2               PIC X(08).
  1894   02  DFHEIV3               PIC X(08).
  1895   02  DFHEIV4               PIC X(06).
  1896   02  DFHEIV5               PIC X(04).
  1897   02  DFHEIV6               PIC X(04).
  1898   02  DFHEIV7               PIC X(02).
  1899   02  DFHEIV8               PIC X(02).
  1900   02  DFHEIV9               PIC X(01).
  1901   02  DFHEIV10              PIC S9(7) COMP-3.
  1902   02  DFHEIV11              PIC S9(4) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  35
* EL6318.cbl
  1903   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1904   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1905   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1906   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1907   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1908   02  DFHEIV17              PIC X(04).
  1909   02  DFHEIV18              PIC X(04).
  1910   02  DFHEIV19              PIC X(04).
  1911   02  DFHEIV20              USAGE IS POINTER.
  1912   02  DFHEIV21              USAGE IS POINTER.
  1913   02  DFHEIV22              USAGE IS POINTER.
  1914   02  DFHEIV23              USAGE IS POINTER.
  1915   02  DFHEIV24              USAGE IS POINTER.
  1916   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1917   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1918   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1919   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1920   02  DFHEIV29              PIC S9(9) COMP SYNC.
  1921   02  DFHEIV30              PIC S9(9) COMP SYNC.
  1922   02  DFHEIV31              PIC S9(9) COMP SYNC.
  1923   02  DFHEIV32              PIC S9(4) COMP SYNC.
  1924   02  DFHEIV33              PIC S9(4) COMP SYNC.
  1925   02  DFHEIV34              PIC S9(4) COMP SYNC.
  1926   02  DFHEIV35              PIC S9(4) COMP SYNC.
  1927   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1928   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1929   02  FILLER                PIC X(02).
  1930   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1931   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1932   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1933   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1934   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1935   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  1936   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  1937 LINKAGE  SECTION.
  1938*****************************************************************
  1939*                                                               *
  1940* Copyright (c) 2007-2013 Dell Inc.                             *
  1941* All rights reserved.                                          *
  1942*                                                               *
  1943*****************************************************************
  1944 01  dfheiblk.
  1945     02  eibtime          pic s9(7) comp-3.
  1946     02  eibdate          pic s9(7) comp-3.
  1947     02  eibtrnid         pic x(4).
  1948     02  eibtaskn         pic s9(7) comp-3.
  1949     02  eibtrmid         pic x(4).
  1950     02  dfheigdi         pic s9(4) comp.
  1951     02  eibcposn         pic s9(4) comp.
  1952     02  eibcalen         pic s9(4) comp.
  1953     02  eibaid           pic x(1).
  1954     02  eibfiller1       pic x(1).
  1955     02  eibfn            pic x(2).
  1956     02  eibfiller2       pic x(2).
  1957     02  eibrcode         pic x(6).
  1958     02  eibfiller3       pic x(2).
  1959     02  eibds            pic x(8).
  1960     02  eibreqid         pic x(8).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  36
* EL6318.cbl
  1961     02  eibrsrce         pic x(8).
  1962     02  eibsync          pic x(1).
  1963     02  eibfree          pic x(1).
  1964     02  eibrecv          pic x(1).
  1965     02  eibsend          pic x(1).
  1966     02  eibatt           pic x(1).
  1967     02  eibeoc           pic x(1).
  1968     02  eibfmh           pic x(1).
  1969     02  eibcompl         pic x(1).
  1970     02  eibsig           pic x(1).
  1971     02  eibconf          pic x(1).
  1972     02  eiberr           pic x(1).
  1973     02  eibrldbk         pic x(1).
  1974     02  eiberrcd         pic x(4).
  1975     02  eibsynrb         pic x(1).
  1976     02  eibnodat         pic x(1).
  1977     02  eibfiller5       pic x(2).
  1978     02  eibresp          pic s9(8) comp.
  1979     02  eibresp2         pic s9(8) comp.
  1980     02  dfheigdj         pic s9(4) comp.
  1981     02  dfheigdk         pic s9(4) comp.
  1982 01  DFHCOMMAREA                 PIC X(1300).
  1983 01  var  pic x(30).
  1984*                                COPY ERCACCT.
  1985******************************************************************
  1986*                                                                *
  1987*                                                                *
  1988*                            ERCACCT                             *
  1989*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1990*                            VMOD=2.031                          *
  1991*                                                                *
  1992*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1993*                                                                *
  1994*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1995*   VSAM ACCOUNT MASTER FILES.                                   *
  1996*                                                                *
  1997*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1998*                                                                *
  1999*   FILE TYPE = VSAM,KSDS                                        *
  2000*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2001*                                                                *
  2002*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2003*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2004*                                                                *
  2005*   LOG = NO                                                     *
  2006*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2007*                                                                *
  2008*                                                                *
  2009******************************************************************
  2010*                   C H A N G E   L O G
  2011*
  2012* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2013*-----------------------------------------------------------------
  2014*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2015* EFFECTIVE    NUMBER
  2016*-----------------------------------------------------------------
  2017* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2018* 092705    2005050300006  PEMA  ADD SPP LEASES
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  37
* EL6318.cbl
  2019* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2020* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2021* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2022* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2023* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  2024* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  2025******************************************************************
  2026
  2027 01  ACCOUNT-MASTER.
  2028     12  AM-RECORD-ID                      PIC XX.
  2029         88  VALID-AM-ID                      VALUE 'AM'.
  2030
  2031     12  AM-CONTROL-PRIMARY.
  2032         16  AM-COMPANY-CD                 PIC X.
  2033         16  AM-MSTR-CNTRL.
  2034             20  AM-CONTROL-A.
  2035                 24  AM-CARRIER            PIC X.
  2036                 24  AM-GROUPING.
  2037                     28 AM-GROUPING-PREFIX PIC XXX.
  2038                     28 AM-GROUPING-PRIME  PIC XXX.
  2039                 24  AM-STATE              PIC XX.
  2040                 24  AM-ACCOUNT.
  2041                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2042                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2043             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2044                                           PIC X(19).
  2045             20  AM-CNTRL-B.
  2046                 24  AM-EXPIRATION-DT      PIC XX.
  2047                 24  FILLER                PIC X(4).
  2048             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2049                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2050
  2051     12  AM-CONTROL-BY-VAR-GRP.
  2052         16  AM-COMPANY-CD-A1              PIC X.
  2053         16  AM-VG-CARRIER                 PIC X.
  2054         16  AM-VG-GROUPING                PIC X(6).
  2055         16  AM-VG-STATE                   PIC XX.
  2056         16  AM-VG-ACCOUNT                 PIC X(10).
  2057         16  AM-VG-DATE.
  2058             20  AM-VG-EXPIRATION-DT       PIC XX.
  2059             20  FILLER                    PIC X(4).
  2060         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2061                                           PIC 9(11)      COMP-3.
  2062     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2063         16  FILLER                        PIC X(10).
  2064         16  AM-VG-KEY3.
  2065             20  AM-VG3-ACCOUNT            PIC X(10).
  2066             20  AM-VG3-EXP-DT             PIC XX.
  2067         16  FILLER                        PIC X(4).
  2068     12  AM-MAINT-INFORMATION.
  2069         16  AM-LAST-MAINT-DT              PIC XX.
  2070         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2071         16  AM-LAST-MAINT-USER            PIC X(4).
  2072         16  FILLER                        PIC XX.
  2073
  2074     12  AM-EFFECTIVE-DT                   PIC XX.
  2075     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2076
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  38
* EL6318.cbl
  2077     12  AM-PREV-DATES  COMP-3.
  2078         16  AM-PREV-EXP-DT                PIC 9(11).
  2079         16  AM-PREV-EFF-DT                PIC 9(11).
  2080
  2081     12  AM-REPORT-CODE-1                  PIC X(10).
  2082     12  AM-REPORT-CODE-2                  PIC X(10).
  2083
  2084     12  AM-CITY-CODE                      PIC X(4).
  2085     12  AM-COUNTY-PARISH                  PIC X(6).
  2086
  2087     12  AM-NAME                           PIC X(30).
  2088     12  AM-PERSON                         PIC X(30).
  2089     12  AM-ADDRS                          PIC X(30).
  2090     12  AM-CITY.
  2091         16  AM-ADDR-CITY                  PIC X(28).
  2092         16  AM-ADDR-STATE                 PIC XX.
  2093     12  AM-ZIP.
  2094         16  AM-ZIP-PRIME.
  2095             20  AM-ZIP-PRI-1ST            PIC X.
  2096                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2097             20  FILLER                    PIC X(4).
  2098         16  AM-ZIP-PLUS4                  PIC X(4).
  2099     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2100         16  AM-CAN-POSTAL-1               PIC XXX.
  2101         16  AM-CAN-POSTAL-2               PIC XXX.
  2102         16  FILLER                        PIC XXX.
  2103     12  AM-TEL-NO.
  2104         16  AM-AREA-CODE                  PIC 999.
  2105         16  AM-TEL-PRE                    PIC 999.
  2106         16  AM-TEL-NBR                    PIC 9(4).
  2107     12  AM-TEL-LOC                        PIC X.
  2108         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2109         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2110
  2111     12  AM-COMM-STRUCTURE.
  2112         16  AM-DEFN-1.
  2113             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2114                 24  AM-AGT.
  2115                     28  AM-AGT-PREFIX     PIC X(4).
  2116                     28  AM-AGT-PRIME      PIC X(6).
  2117                 24  AM-COM-TYP            PIC X.
  2118                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2119                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2120                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2121                 24  AM-RECALC-LV-INDIC    PIC X.
  2122                 24  AM-RETRO-LV-INDIC     PIC X.
  2123                 24  AM-GL-CODES           PIC X.
  2124                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2125                 24  FILLER                PIC X(01).
  2126         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2127             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2128                 24  FILLER                PIC X(11).
  2129                 24  AM-L-COMA             PIC XXX.
  2130                 24  AM-J-COMA             PIC XXX.
  2131                 24  AM-A-COMA             PIC XXX.
  2132                 24  FILLER                PIC X(6).
  2133
  2134     12  AM-COMM-CHANGE-STATUS             PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  39
* EL6318.cbl
  2135         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2136
  2137     12  AM-CSR-CODE                       PIC X(4).
  2138
  2139     12  AM-BILLING-STATUS                 PIC X.
  2140         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2141         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2142     12  AM-AUTO-REFUND-SW                 PIC X.
  2143         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2144         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2145     12  AM-GPCD                           PIC 99.
  2146     12  AM-IG                             PIC X.
  2147         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2148         88  AM-HAS-GROUP                     VALUE '2'.
  2149     12  AM-STATUS                         PIC X.
  2150         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2151         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2152         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2153         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2154         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2155         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2156         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  2157         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  2158         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  2159         88  AM-ACCOUNT-PENDING               VALUE '9'.
  2160     12  AM-REMIT-TO                       PIC 99.
  2161     12  AM-ID-NO                          PIC X(11).
  2162
  2163     12  AM-CAL-TABLE                      PIC XX.
  2164     12  AM-LF-DEVIATION                   PIC XXX.
  2165     12  AM-AH-DEVIATION                   PIC XXX.
  2166     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2167     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2168     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2169     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2170     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2171     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2172
  2173     12  AM-USER-FIELDS.
  2174         16  AM-FLD-1                      PIC XX.
  2175         16  AM-FLD-2                      PIC XX.
  2176         16  AM-FLD-3                      PIC XX.
  2177         16  AM-FLD-4                      PIC XX.
  2178         16  AM-FLD-5                      PIC XX.
  2179
  2180     12  AM-1ST-PROD-DATE.
  2181         16  AM-1ST-PROD-YR                PIC XX.
  2182         16  AM-1ST-PROD-MO                PIC XX.
  2183         16  AM-1ST-PROD-DA                PIC XX.
  2184     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2185     12  AM-CERTS-PURGED-DATE.
  2186         16  AM-PUR-YR                     PIC XX.
  2187         16  AM-PUR-MO                     PIC XX.
  2188         16  AM-PUR-DA                     PIC XX.
  2189     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2190     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2191     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2192     12  AM-INACTIVE-DATE.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  40
* EL6318.cbl
  2193         16  AM-INA-MO                     PIC 99.
  2194         16  AM-INA-DA                     PIC 99.
  2195         16  AM-INA-YR                     PIC 99.
  2196     12  AM-AR-HI-CERT-DATE                PIC XX.
  2197
  2198     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2199     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2200
  2201     12  AM-OB-PAYMENT-MODE                PIC X.
  2202         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2203         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2204         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2205         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2206
  2207     12  AM-AH-ONLY-INDICATOR              PIC X.
  2208         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2209         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2210
  2211     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2212
  2213     12  AM-OVER-SHORT.
  2214         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2215         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2216
  2217     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2218     12  AM-DCC-CLP-STATE                  PIC XX.
  2219
  2220     12  AM-RECALC-COMM                    PIC X.
  2221     12  AM-RECALC-REIN                    PIC X.
  2222
  2223     12  AM-REI-TABLE                      PIC XXX.
  2224     12  AM-REI-ET-LF                      PIC X.
  2225     12  AM-REI-ET-AH                      PIC X.
  2226     12  AM-REI-PE-LF                      PIC X.
  2227     12  AM-REI-PE-AH                      PIC X.
  2228     12  AM-REI-PRT-ST                     PIC X.
  2229     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2230     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2231     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2232     12  AM-REI-GROUP-A                    PIC X(6).
  2233     12  AM-REI-MORT                       PIC X(4).
  2234     12  AM-REI-PRT-OW                     PIC X.
  2235     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2236     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2237     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2238     12  AM-REI-GROUP-B                    PIC X(6).
  2239
  2240     12  AM-TRUST-TYPE                     PIC X(2).
  2241
  2242     12  AM-EMPLOYER-STMT-USED             PIC X.
  2243     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2244
  2245     12  AM-STD-AH-TYPE                    PIC XX.
  2246     12  AM-EARN-METHODS.
  2247         16  AM-EARN-METHOD-R              PIC X.
  2248             88 AM-REF-RL-R78                 VALUE 'R'.
  2249             88 AM-REF-RL-PR                  VALUE 'P'.
  2250             88 AM-REF-RL-MEAN                VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  41
* EL6318.cbl
  2251             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2252         16  AM-EARN-METHOD-L              PIC X.
  2253             88 AM-REF-LL-R78                 VALUE 'R'.
  2254             88 AM-REF-LL-PR                  VALUE 'P'.
  2255             88 AM-REF-LL-MEAN                VALUE 'M'.
  2256             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2257         16  AM-EARN-METHOD-A              PIC X.
  2258             88 AM-REF-AH-R78                 VALUE 'R'.
  2259             88 AM-REF-AH-PR                  VALUE 'P'.
  2260             88 AM-REF-AH-MEAN                VALUE 'M'.
  2261             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2262             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2263             88 AM-REF-AH-NET                 VALUE 'N'.
  2264
  2265     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2266     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2267     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2268
  2269     12  AM-RET-Y-N                        PIC X.
  2270     12  AM-RET-P-E                        PIC X.
  2271     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2272     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2273     12  AM-RET-GRP                        PIC X(6).
  2274     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2275         16  AM-POOL-PRIME                 PIC XXX.
  2276         16  AM-POOL-SUB                   PIC XXX.
  2277     12  AM-RETRO-EARNINGS.
  2278         16  AM-RET-EARN-R                 PIC X.
  2279         16  AM-RET-EARN-L                 PIC X.
  2280         16  AM-RET-EARN-A                 PIC X.
  2281     12  AM-RET-ST-TAX-USE                 PIC X.
  2282         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2283         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2284     12  AM-RETRO-BEG-EARNINGS.
  2285         16  AM-RET-BEG-EARN-R             PIC X.
  2286         16  AM-RET-BEG-EARN-L             PIC X.
  2287         16  AM-RET-BEG-EARN-A             PIC X.
  2288     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2289     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2290
  2291     12  AM-USER-SELECT-OPTIONS.
  2292         16  AM-USER-SELECT-1              PIC X(10).
  2293         16  AM-USER-SELECT-2              PIC X(10).
  2294         16  AM-USER-SELECT-3              PIC X(10).
  2295         16  AM-USER-SELECT-4              PIC X(10).
  2296         16  AM-USER-SELECT-5              PIC X(10).
  2297
  2298     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2299
  2300     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2301
  2302     12  AM-RPT045A-SWITCH                 PIC X.
  2303         88  RPT045A-OFF                   VALUE 'N'.
  2304
  2305     12  AM-INSURANCE-LIMITS.
  2306         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2307         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2308
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  42
* EL6318.cbl
  2309     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2310         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2311
  2312     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2313         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2314         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2315
  2316     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2317
  2318     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2319     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2320     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2321     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2322     12  AM-DCC-UEF-STATE                  PIC XX.
  2323     12  FILLER                            PIC XXX.
  2324     12  AM-REPORT-CODE-3                  PIC X(10).
  2325*    12  FILLER                            PIC X(22).
  2326
  2327     12  AM-RESERVE-DATE.
  2328         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2329         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2330         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2331
  2332     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2333     12  AM-NOTIFICATION-TYPES.
  2334         16  AM-NOTIF-OF-LETTERS           PIC X.
  2335         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2336         16  AM-NOTIF-OF-REPORTS           PIC X.
  2337         16  AM-NOTIF-OF-STATUS            PIC X.
  2338
  2339     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2340         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2341         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2342         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2343         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2344
  2345     12  AM-BENEFIT-CONTROLS.
  2346         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2347             20  AM-BENEFIT-CODE           PIC XX.
  2348             20  AM-BENEFIT-TYPE           PIC X.
  2349             20  AM-BENEFIT-REVISION       PIC XXX.
  2350             20  AM-BENEFIT-REM-TERM       PIC X.
  2351             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2352             20  FILLER                    PIC XX.
  2353         16  FILLER                        PIC X(80).
  2354
  2355     12  AM-TRANSFER-DATA.
  2356         16  AM-TRANSFERRED-FROM.
  2357             20  AM-TRNFROM-CARRIER        PIC X.
  2358             20  AM-TRNFROM-GROUPING.
  2359                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2360                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2361             20  AM-TRNFROM-STATE          PIC XX.
  2362             20  AM-TRNFROM-ACCOUNT.
  2363                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2364                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2365             20  AM-TRNFROM-DTE            PIC XX.
  2366         16  AM-TRANSFERRED-TO.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  43
* EL6318.cbl
  2367             20  AM-TRNTO-CARRIER          PIC X.
  2368             20  AM-TRNTO-GROUPING.
  2369                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2370                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2371             20  AM-TRNTO-STATE            PIC XX.
  2372             20  AM-TRNTO-ACCOUNT.
  2373                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2374                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2375             20  AM-TRNTO-DTE              PIC XX.
  2376         16  FILLER                        PIC X(10).
  2377
  2378     12  AM-SAVED-REMIT-TO                 PIC 99.
  2379
  2380     12  AM-COMM-STRUCTURE-SAVED.
  2381         16  AM-DEFN-1-SAVED.
  2382             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2383                 24  AM-AGT-SV             PIC X(10).
  2384                 24  AM-COM-TYP-SV         PIC X.
  2385                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2386                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2387                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2388                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2389                 24  FILLER                PIC X.
  2390                 24  AM-GL-CODES-SV        PIC X.
  2391                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2392                 24  FILLER                PIC X.
  2393         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2394             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2395                 24  FILLER                PIC X(11).
  2396                 24  AM-L-COMA-SV          PIC XXX.
  2397                 24  AM-J-COMA-SV          PIC XXX.
  2398                 24  AM-A-COMA-SV          PIC XXX.
  2399                 24  FILLER                PIC X(6).
  2400
  2401     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2402         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2403            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2404            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2405            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2406
  2407     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2408     12  FILLER                            PIC X(120).
  2409
  2410     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2411         16  AM-CONTROL-NAME               PIC X(30).
  2412         16  AM-EXECUTIVE-ONE.
  2413             20  AM-EXEC1-NAME             PIC X(15).
  2414             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2415                                                          COMP-3.
  2416             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2417                                                          COMP-3.
  2418         16  AM-EXECUTIVE-TWO.
  2419             20  AM-EXEC2-NAME             PIC X(15).
  2420             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2421                                                          COMP-3.
  2422             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2423                                                          COMP-3.
  2424
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  44
* EL6318.cbl
  2425     12  AM-RETRO-ADDITIONAL-DATA.
  2426         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2427         16  AM-RETRO-PREM-P-E             PIC X.
  2428         16  AM-RETRO-CLMS-P-I             PIC X.
  2429         16  AM-RETRO-RET-BRACKET-LF.
  2430             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2431                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2432                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2433             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2434                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2435                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2436             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2437                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2438                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2439         16  AM-RETRO-RET-BRACKET-AH.
  2440             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2441                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2442                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2443                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2444             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2445                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2446                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2447             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2448                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2449                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2450
  2451     12  AM-COMMENTS.
  2452         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2453
  2454     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2455         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2456         16  AM-FLI-BILLING-CODE           PIC X.
  2457         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2458         16  AM-FLI-UNITED-IDENT           PIC X.
  2459         16  AM-FLI-INTEREST-LOST-DATA.
  2460             20  AM-FLI-BANK-NO            PIC X(5).
  2461             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2462             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2463             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2464         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2465             20  AM-FLI-AGT                PIC X(9).
  2466             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2467             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2468         16  FILLER                        PIC X(102).
  2469
  2470     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2471         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2472             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2473             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2474             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2475             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2476             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2477         16  FILLER                          PIC X(10).
  2478******************************************************************
  2479*                                COPY ELCCNTL.
  2480******************************************************************
  2481*                                                                *
  2482*                                                                *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  45
* EL6318.cbl
  2483*                            ELCCNTL.                            *
  2484*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2485*                            VMOD=2.059                          *
  2486*                                                                *
  2487*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2488*                                                                *
  2489*   FILE TYPE = VSAM,KSDS                                        *
  2490*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2491*                                                                *
  2492*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2493*       ALTERNATE INDEX = NONE                                   *
  2494*                                                                *
  2495*   LOG = YES                                                    *
  2496*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2497******************************************************************
  2498*                   C H A N G E   L O G
  2499*
  2500* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2501*-----------------------------------------------------------------
  2502*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2503* EFFECTIVE    NUMBER
  2504*-----------------------------------------------------------------
  2505* 082503                   PEMA  ADD BENEFIT GROUP
  2506* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2507* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2508* 092705    2005050300006  PEMA  ADD SPP LEASES
  2509* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2510* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2511* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2512* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2513* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2514* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2515* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2516* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2517* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2518* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2519******************************************************************
  2520*
  2521 01  CONTROL-FILE.
  2522     12  CF-RECORD-ID                       PIC XX.
  2523         88  VALID-CF-ID                        VALUE 'CF'.
  2524
  2525     12  CF-CONTROL-PRIMARY.
  2526         16  CF-COMPANY-ID                  PIC XXX.
  2527         16  CF-RECORD-TYPE                 PIC X.
  2528             88  CF-COMPANY-MASTER              VALUE '1'.
  2529             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2530             88  CF-STATE-MASTER                VALUE '3'.
  2531             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2532             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2533             88  CF-CARRIER-MASTER              VALUE '6'.
  2534             88  CF-MORTALITY-MASTER            VALUE '7'.
  2535             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2536             88  CF-TERMINAL-MASTER             VALUE '9'.
  2537             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2538             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2539             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2540             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  46
* EL6318.cbl
  2541             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2542             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2543             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2544             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2545             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2546         16  CF-ACCESS-CD-GENL              PIC X(4).
  2547         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2548             20  CF-PROCESSOR               PIC X(4).
  2549         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2550             20  CF-STATE-CODE              PIC XX.
  2551             20  FILLER                     PIC XX.
  2552         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2553             20  FILLER                     PIC XX.
  2554             20  CF-HI-BEN-IN-REC           PIC XX.
  2555         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2556             20  FILLER                     PIC XXX.
  2557             20  CF-CARRIER-CNTL            PIC X.
  2558         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2559             20  FILLER                     PIC XX.
  2560             20  CF-HI-TYPE-IN-REC          PIC 99.
  2561         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2562             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2563                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2564             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2565             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2566         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2567             20  FILLER                     PIC X.
  2568             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2569         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2570             20  FILLER                     PIC XX.
  2571             20  CF-MORTGAGE-PLAN           PIC XX.
  2572         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2573
  2574     12  CF-LAST-MAINT-DT                   PIC XX.
  2575     12  CF-LAST-MAINT-BY                   PIC X(4).
  2576     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2577
  2578     12  CF-RECORD-BODY                     PIC X(728).
  2579
  2580
  2581****************************************************************
  2582*             COMPANY MASTER RECORD                            *
  2583****************************************************************
  2584
  2585     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2586         16  CF-COMPANY-ADDRESS.
  2587             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2588             20  CF-CL-IN-CARE-OF           PIC X(30).
  2589             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2590             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2591             20  CF-CL-CITY-STATE           PIC X(30).
  2592             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2593             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2594         16  CF-COMPANY-CD                  PIC X.
  2595         16  CF-COMPANY-PASSWORD            PIC X(8).
  2596         16  CF-SECURITY-OPTION             PIC X.
  2597             88  ALL-SECURITY                   VALUE '1'.
  2598             88  COMPANY-VERIFY                 VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  47
* EL6318.cbl
  2599             88  PROCESSOR-VERIFY               VALUE '3'.
  2600             88  NO-SECURITY                    VALUE '4'.
  2601             88  ALL-BUT-TERM                   VALUE '5'.
  2602         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2603             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2604         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2605             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2606         16  CF-INFORCE-LOCATION            PIC X.
  2607             88  CERTS-ARE-ONLINE               VALUE '1'.
  2608             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2609             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2610         16  CF-LOWER-CASE-LETTERS          PIC X.
  2611         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2612             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2613             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2614             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2615             88  CF-ACCNT-CNTL                  VALUE '3'.
  2616             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2617
  2618         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2619         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2620
  2621         16  CF-LGX-CREDIT-USER             PIC X.
  2622             88  CO-IS-NOT-USER                 VALUE 'N'.
  2623             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2624
  2625         16 CF-CREDIT-CALC-CODES.
  2626             20  CF-CR-REM-TERM-CALC PIC X.
  2627               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2628               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2629               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2630               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2631               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2632               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2633               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2634             20  CF-CR-R78-METHOD           PIC X.
  2635               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2636               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2637
  2638         16  CF-CLAIM-CONTROL-COUNTS.
  2639             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2640                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2641
  2642             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2643                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2644
  2645             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2646                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2647
  2648             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2649                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2650
  2651         16  CF-CURRENT-MONTH-END           PIC XX.
  2652
  2653         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2654             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2655             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2656             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  48
* EL6318.cbl
  2657             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2658                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2659                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2660             20  CF-CO-PREM-REJECT-SW       PIC X.
  2661                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2662                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2663             20  CF-CO-REF-REJECT-SW        PIC X.
  2664                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2665                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2666
  2667         16  CF-CO-REPORTING-DT             PIC XX.
  2668         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2669         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2670           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2671           88  CF-CO-MONTH-END                  VALUE '1'.
  2672
  2673         16  CF-LGX-CLAIM-USER              PIC X.
  2674             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2675             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2676
  2677         16  CF-CREDIT-EDIT-CONTROLS.
  2678             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2679             20  CF-MIN-AGE                 PIC 99.
  2680             20  CF-DEFAULT-AGE             PIC 99.
  2681             20  CF-MIN-TERM                PIC S999      COMP-3.
  2682             20  CF-MAX-TERM                PIC S999      COMP-3.
  2683             20  CF-DEFAULT-SEX             PIC X.
  2684             20  CF-JOINT-AGE-INPUT         PIC X.
  2685                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2686             20  CF-BIRTH-DATE-INPUT        PIC X.
  2687                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2688             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2689                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2690                 88  CF-ZERO-CARRIER            VALUE '1'.
  2691                 88  CF-ZERO-GROUPING           VALUE '2'.
  2692                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2693             20  CF-EDIT-SW                 PIC X.
  2694                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2695             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2696             20  CF-CR-PR-METHOD            PIC X.
  2697               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2698               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2699             20  FILLER                     PIC X.
  2700
  2701         16  CF-CREDIT-MISC-CONTROLS.
  2702             20  CF-REIN-TABLE-SW           PIC X.
  2703                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2704             20  CF-COMP-TABLE-SW           PIC X.
  2705                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2706             20  CF-EXPERIENCE-RETENTION-AGE
  2707                                            PIC S9        COMP-3.
  2708             20  CF-CONVERSION-DT           PIC XX.
  2709             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2710             20  CF-RUN-FREQUENCY-SW        PIC X.
  2711                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2712                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2713
  2714             20  CF-CR-CHECK-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  49
* EL6318.cbl
  2715                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2716                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2717                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2718                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2719                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2720                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2721
  2722                 24  CF-CR-CHECK-COUNT       REDEFINES
  2723                     CF-CR-CHECK-COUNTER      PIC X(4).
  2724
  2725                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2726                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2727
  2728                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2729                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2730                 24  CF-MAIL-PROCESSING       PIC X.
  2731                     88  MAIL-PROCESSING          VALUE 'Y'.
  2732
  2733         16  CF-MISC-SYSTEM-CONTROL.
  2734             20  CF-SYSTEM-C                 PIC X.
  2735                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2736             20  CF-SYSTEM-D                 PIC X.
  2737                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2738             20  CF-SOC-SEC-NO-SW            PIC X.
  2739                 88  SOC-SEC-NO-USED             VALUE '1'.
  2740             20  CF-MEMBER-NO-SW             PIC X.
  2741                 88  MEMBER-NO-USED              VALUE '1'.
  2742             20  CF-TAX-ID-NUMBER            PIC X(11).
  2743             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2744             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2745                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2746                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2747                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2748                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2749             20  CF-SYSTEM-E                 PIC X.
  2750                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2751
  2752         16  CF-LGX-LIFE-USER               PIC X.
  2753             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2754             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2755
  2756         16  CF-CR-MONTH-END-DT             PIC XX.
  2757
  2758         16  CF-FILE-MAINT-DATES.
  2759             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2760                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2761             20  CF-LAST-BATCH       REDEFINES
  2762                 CF-LAST-BATCH-NO               PIC X(4).
  2763             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2764             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2765             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2766             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2767             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2768             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2769             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2770             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2771             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2772             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  50
* EL6318.cbl
  2773
  2774         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2775         16  FILLER                         PIC X.
  2776
  2777         16  CF-ALT-MORT-CODE               PIC X(4).
  2778         16  CF-MEMBER-CAPTION              PIC X(10).
  2779
  2780         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2781             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2782             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2783             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2784             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2785             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2786
  2787         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2788
  2789         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2790         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2791         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2792         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2793
  2794         16  CF-AH-OVERRIDE-L1              PIC X.
  2795         16  CF-AH-OVERRIDE-L2              PIC XX.
  2796         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2797         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2798
  2799         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2800         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2801
  2802         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2803         16  CF-AR-LAST-EL860-DT            PIC XX.
  2804         16  CF-MP-MONTH-END-DT             PIC XX.
  2805
  2806         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2807         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2808             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2809
  2810         16  CF-AR-MONTH-END-DT             PIC XX.
  2811
  2812         16  CF-CRDTCRD-USER                PIC X.
  2813             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2814             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2815
  2816         16  CF-CC-MONTH-END-DT             PIC XX.
  2817
  2818         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2819
  2820         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2821             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2822             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2823             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2824         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2825         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2826         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2827         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2828             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2829             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2830         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  51
* EL6318.cbl
  2831         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2832         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2833             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2834         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2835
  2836         16  CF-CL-ZIP-CODE.
  2837             20  CF-CL-ZIP-PRIME.
  2838                 24  CF-CL-ZIP-1ST          PIC X.
  2839                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2840                 24  FILLER                 PIC X(4).
  2841             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2842         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2843             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2844             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2845             20  FILLER                     PIC XXX.
  2846
  2847         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2848         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2849         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2850         16  CF-CO-OPTION-START-DATE        PIC XX.
  2851         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2852           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2853                                                      '3' '4'.
  2854           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2855           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2856           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2857           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2858           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2859           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2860
  2861         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2862
  2863         16  CF-PAYMENT-APPROVAL-LEVELS.
  2864             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2865             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2866             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2867             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2868             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2869             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2870
  2871         16  CF-END-USER-REPORTING-USER     PIC X.
  2872             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2873             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2874
  2875         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2876             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2877             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2878
  2879         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2880
  2881         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2882         16  FILLER                         PIC X.
  2883
  2884         16  CF-CREDIT-ARCHIVE-CNTL.
  2885             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2886             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2887             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2888
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  52
* EL6318.cbl
  2889         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2890
  2891         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2892             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2893             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2894
  2895         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2896             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2897             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2898
  2899         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2900
  2901         16  CF-CO-ACH-ID-CODE              PIC  X.
  2902             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2903             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2904             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2905         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2906         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2907         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2908         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2909         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2910         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2911         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2912         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2913         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2914                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2915         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2916                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2917
  2918         16  CF-CO-OVER-SHORT.
  2919             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2920             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2921
  2922*         16  FILLER                         PIC X(102).
  2923         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2924             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2925             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2926
  2927         16  CF-AH-APPROVAL-DAYS.
  2928             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2929             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2930             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2931             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2932
  2933         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2934
  2935         16  CF-APPROV-LEV-5.
  2936             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2937             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2938             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2939
  2940         16  FILLER                         PIC X(68).
  2941****************************************************************
  2942*             PROCESSOR/USER RECORD                            *
  2943****************************************************************
  2944
  2945     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2946         16  CF-PROCESSOR-NAME              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  53
* EL6318.cbl
  2947         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2948         16  CF-PROCESSOR-TITLE             PIC X(26).
  2949         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2950                 88  MESSAGE-YES                VALUE 'Y'.
  2951                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2952
  2953*****************************************************
  2954****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2955****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2956****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2957****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2958*****************************************************
  2959
  2960         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2961             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2962             20  CF-APPLICATION-FORCE       PIC X.
  2963             20  CF-INDIVIDUAL-APP.
  2964                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2965                     28  CF-BROWSE-APP      PIC X.
  2966                     28  CF-UPDATE-APP      PIC X.
  2967
  2968         16  CF-CURRENT-TERM-ON             PIC X(4).
  2969         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2970             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2971             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2972             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2973             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2974             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2975             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2976             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2977         16  CF-PROCESSOR-CARRIER           PIC X.
  2978             88  NO-CARRIER-SECURITY            VALUE ' '.
  2979         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2980             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2981         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2982             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2983         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2984             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2985
  2986         16  CF-PROC-SYS-ACCESS-SW.
  2987             20  CF-PROC-CREDIT-CLAIMS-SW.
  2988                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2989                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2990                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2991                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2992             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2993                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2994                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2995             20  CF-PROC-LIFE-GNRLDGR-SW.
  2996                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2997                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2998                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2999                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3000             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3001                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3002                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3003         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3004             CF-PROC-SYS-ACCESS-SW              PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  54
* EL6318.cbl
  3005             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3006         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3007
  3008         16  CF-APPROVAL-LEVEL                  PIC X.
  3009             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3010             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3011             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3012             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3013             88  APPROVAL-LEVEL-5                   VALUE '5'.
  3014
  3015         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3016
  3017         16  CF-LANGUAGE-TYPE                   PIC X.
  3018             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3019             88  CF-LANG-IS-FR                      VALUE 'F'.
  3020
  3021         16  CF-CSR-IND                         PIC X.
  3022         16  FILLER                             PIC X(239).
  3023
  3024****************************************************************
  3025*             PROCESSOR/REMINDERS RECORD                       *
  3026****************************************************************
  3027
  3028     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3029         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3030             20  CF-START-REMIND-DT         PIC XX.
  3031             20  CF-END-REMIND-DT           PIC XX.
  3032             20  CF-REMINDER-TEXT           PIC X(50).
  3033         16  FILLER                         PIC X(296).
  3034
  3035
  3036****************************************************************
  3037*             STATE MASTER RECORD                              *
  3038****************************************************************
  3039
  3040     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3041         16  CF-STATE-ABBREVIATION          PIC XX.
  3042         16  CF-STATE-NAME                  PIC X(25).
  3043         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3044         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3045             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3046             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3047             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3048             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3049                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3050                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3051             20  CF-ST-PREM-REJECT-SW       PIC X.
  3052                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3053                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3054             20  CF-ST-REF-REJECT-SW        PIC X.
  3055                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3056                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3057         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3058         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3059         16  CF-ST-REFUND-RULES.
  3060             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3061             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3062             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  55
* EL6318.cbl
  3063         16  CF-ST-FST-PMT-EXTENSION.
  3064             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3065             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3066                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3067                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3068                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3069                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3070         16  CF-ST-STATE-CALL.
  3071             20  CF-ST-CALL-UNEARNED        PIC X.
  3072             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3073             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3074         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3075             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3076             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3077         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3078         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3079         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3080         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3081         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3082         16  FILLER                         PIC X.
  3083         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3084             20  CF-ST-BENEFIT-CD           PIC XX.
  3085             20  CF-ST-BENEFIT-KIND         PIC X.
  3086                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3087                 88  CF-ST-AH-KIND              VALUE 'A'.
  3088             20  CF-ST-REM-TERM-CALC        PIC X.
  3089                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3090                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3091                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3092                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3093                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3094                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3095                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3096                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3097
  3098             20  CF-ST-REFUND-CALC          PIC X.
  3099                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3100                 88  ST-REFD-BY-R78             VALUE '1'.
  3101                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3102                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3103                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3104                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3105                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3106                 88  ST-REFD-UTAH               VALUE '7'.
  3107                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3108                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3109                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3110
  3111             20  CF-ST-EARNING-CALC         PIC X.
  3112                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3113                 88  ST-EARN-BY-R78             VALUE '1'.
  3114                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3115                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3116                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3117                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3118                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3119                 88  ST-EARN-MEAN               VALUE '8'.
  3120                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  56
* EL6318.cbl
  3121
  3122             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3123                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3124                 88  ST-OVRD-BY-R78             VALUE '1'.
  3125                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3126                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3127                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3128                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3129                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3130                 88  ST-OVRD-MEAN               VALUE '8'.
  3131                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3132             20  cf-st-extra-periods        pic 9.
  3133*            20  FILLER                     PIC X.
  3134
  3135         16  CF-ST-COMMISSION-CAPS.
  3136             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3137             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3138             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3139             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3140         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3141                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3142
  3143         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3144
  3145         16  CF-ST-STATUTORY-INTEREST.
  3146             20  CF-ST-STAT-DATE-FROM       PIC X.
  3147                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3148                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3149             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3150             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3151             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3152             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3153             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3154
  3155         16  CF-ST-OVER-SHORT.
  3156             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3157             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3158
  3159         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3160
  3161         16  CF-ST-RT-CALC                  PIC X.
  3162
  3163         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3164         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3165         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3166         16  CF-ST-RF-LR-CALC               PIC X.
  3167         16  CF-ST-RF-LL-CALC               PIC X.
  3168         16  CF-ST-RF-LN-CALC               PIC X.
  3169         16  CF-ST-RF-AH-CALC               PIC X.
  3170         16  CF-ST-RF-CP-CALC               PIC X.
  3171*        16  FILLER                         PIC X(206).
  3172*CIDMOD         16  FILLER                         PIC X(192).
  3173         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3174             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3175         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3176         16  CF-ST-VFY-2ND-BENE             PIC X.
  3177         16  CF-ST-CAUSAL-STATE             PIC X.
  3178         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  57
* EL6318.cbl
  3179         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  3180         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  3181             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  3182         16  CF-ST-NET-ONLY-STATE           PIC X.
  3183             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  3184         16  FILLER                         PIC X(181).
  3185
  3186****************************************************************
  3187*             BENEFIT MASTER RECORD                            *
  3188****************************************************************
  3189
  3190     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3191         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3192             20  CF-BENEFIT-CODE            PIC XX.
  3193             20  CF-BENEFIT-NUMERIC  REDEFINES
  3194                 CF-BENEFIT-CODE            PIC XX.
  3195             20  CF-BENEFIT-ALPHA           PIC XXX.
  3196             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3197             20  CF-BENEFIT-COMMENT         PIC X(10).
  3198
  3199             20  CF-LF-COVERAGE-TYPE        PIC X.
  3200                 88  CF-REDUCING                VALUE 'R'.
  3201                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3202
  3203             20  CF-SPECIAL-CALC-CD         PIC X.
  3204                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3205                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3206                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3207                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3208                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3209                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3210                 88  CF-FARM-PLAN               VALUE 'F'.
  3211                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3212                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3213                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3214                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3215                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3216                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3217                 88  CF-PRUDENTIAL              VALUE 'P'.
  3218                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3219                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3220                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3221                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3222                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3223                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3224
  3225             20  CF-JOINT-INDICATOR         PIC X.
  3226                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3227
  3228*            20  FILLER                     PIC X(12).
  3229             20  cf-maximum-benefits        pic s999 comp-3.
  3230             20  FILLER                     PIC X(09).
  3231             20  CF-BENEFIT-CATEGORY        PIC X.
  3232             20  CF-LOAN-TYPE               PIC X(8).
  3233
  3234             20  CF-CO-REM-TERM-CALC        PIC X.
  3235                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3236                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  58
* EL6318.cbl
  3237                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3238                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3239                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3240
  3241             20  CF-CO-EARNINGS-CALC        PIC X.
  3242                 88  CO-EARN-BY-R78             VALUE '1'.
  3243                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3244                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3245                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3246                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3247                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3248                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3249                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3250
  3251             20  CF-CO-REFUND-CALC          PIC X.
  3252                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3253                 88  CO-REFD-BY-R78             VALUE '1'.
  3254                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3255                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3256                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3257                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3258                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3259                 88  CO-REFD-MEAN               VALUE '8'.
  3260                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3261                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3262                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3263
  3264             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3265                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3266                 88  CO-OVRD-BY-R78             VALUE '1'.
  3267                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3268                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3269                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3270                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3271                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3272                 88  CO-OVRD-MEAN               VALUE '8'.
  3273                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3274
  3275             20  CF-CO-BEN-I-G-CD           PIC X.
  3276                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3277                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3278                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3279
  3280         16  FILLER                         PIC X(304).
  3281
  3282
  3283****************************************************************
  3284*             CARRIER MASTER RECORD                            *
  3285****************************************************************
  3286
  3287     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3288         16  CF-ADDRESS-DATA.
  3289             20  CF-MAIL-TO-NAME            PIC X(30).
  3290             20  CF-IN-CARE-OF              PIC X(30).
  3291             20  CF-ADDRESS-LINE-1          PIC X(30).
  3292             20  CF-ADDRESS-LINE-2          PIC X(30).
  3293             20  CF-CITY-STATE              PIC X(30).
  3294             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  59
* EL6318.cbl
  3295             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3296
  3297         16  CF-CLAIM-NO-CONTROL.
  3298             20  CF-CLAIM-NO-METHOD         PIC X.
  3299                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3300                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3301                 88  CLAIM-NO-SEQ               VALUE '3'.
  3302                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3303             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3304                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3305                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3306                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3307
  3308         16  CF-CHECK-NO-CONTROL.
  3309             20  CF-CHECK-NO-METHOD         PIC X.
  3310                 88  CHECK-NO-MANUAL            VALUE '1'.
  3311                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3312                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3313                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3314             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3315                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3316
  3317         16  CF-DOMICILE-STATE              PIC XX.
  3318
  3319         16  CF-EXPENSE-CONTROLS.
  3320             20  CF-EXPENSE-METHOD          PIC X.
  3321                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3322                 88  DOLLARS-PER-PMT            VALUE '2'.
  3323                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3324                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3325             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3326             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3327
  3328         16  CF-CORRESPONDENCE-CONTROL.
  3329             20  CF-LETTER-RESEND-OPT       PIC X.
  3330                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3331                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3332             20  FILLER                     PIC X(4).
  3333
  3334         16  CF-RESERVE-CONTROLS.
  3335             20  CF-MANUAL-SW               PIC X.
  3336                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3337             20  CF-FUTURE-SW               PIC X.
  3338                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3339             20  CF-PTC-SW                  PIC X.
  3340                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3341             20  CF-IBNR-SW                 PIC X.
  3342                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3343             20  CF-PTC-LF-SW               PIC X.
  3344                 88  CF-LF-PTC-USED             VALUE '1'.
  3345             20  CF-CDT-ACCESS-METHOD       PIC X.
  3346                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3347                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3348                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3349             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3350
  3351         16  CF-CLAIM-CALC-METHOD           PIC X.
  3352             88  360-PLUS-MONTHS                VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  60
* EL6318.cbl
  3353             88  365-PLUS-MONTHS                VALUE '2'.
  3354             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3355             88  360-DAILY                      VALUE '4'.
  3356             88  365-DAILY                      VALUE '5'.
  3357
  3358         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3359         16  FILLER                         PIC X(11).
  3360
  3361         16  CF-LIMIT-AMOUNTS.
  3362             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3363             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3364             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3365             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3366             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3367             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3368             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3369             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3370             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3371             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3372
  3373         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3374         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3375         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3376
  3377         16  CF-ZIP-CODE.
  3378             20  CF-ZIP-PRIME.
  3379                 24  CF-ZIP-1ST             PIC X.
  3380                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3381                 24  FILLER                 PIC X(4).
  3382             20  CF-ZIP-PLUS4               PIC X(4).
  3383         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3384             20  CF-CAN-POSTAL-1            PIC XXX.
  3385             20  CF-CAN-POSTAL-2            PIC XXX.
  3386             20  FILLER                     PIC XXX.
  3387
  3388         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3389         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3390         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3391
  3392         16  CF-RATING-SWITCH               PIC X.
  3393             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3394             88  CF-NO-RATING                   VALUE 'N'.
  3395
  3396         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3397
  3398         16  CF-CARRIER-OVER-SHORT.
  3399             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3400             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3401
  3402         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3403         16  CF-SECPAY-SWITCH               PIC X.
  3404             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3405             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3406         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3407         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3408         16  FILLER                         PIC X(444).
  3409*        16  FILLER                         PIC X(452).
  3410
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  61
* EL6318.cbl
  3411
  3412****************************************************************
  3413*             MORTALITY MASTER RECORD                          *
  3414****************************************************************
  3415
  3416     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3417         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3418                                INDEXED BY CF-MORT-NDX.
  3419             20  CF-MORT-TABLE              PIC X(5).
  3420             20  CF-MORT-TABLE-TYPE         PIC X.
  3421                 88  CF-MORT-JOINT              VALUE 'J'.
  3422                 88  CF-MORT-SINGLE             VALUE 'S'.
  3423                 88  CF-MORT-COMBINED           VALUE 'C'.
  3424                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3425                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3426             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3427             20  CF-MORT-AGE-METHOD         PIC XX.
  3428                 88  CF-AGE-LAST                VALUE 'AL'.
  3429                 88  CF-AGE-NEAR                VALUE 'AN'.
  3430             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3431             20  CF-MORT-ADJUSTMENT-DIRECTION
  3432                                            PIC X.
  3433                 88  CF-MINUS                   VALUE '-'.
  3434                 88  CF-PLUS                    VALUE '+'.
  3435             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3436             20  CF-MORT-JOINT-CODE         PIC X.
  3437                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3438             20  CF-MORT-PC-Q               PIC X.
  3439                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3440             20  CF-MORT-TABLE-CODE         PIC X(4).
  3441             20  CF-MORT-COMMENTS           PIC X(15).
  3442             20  FILLER                     PIC X(14).
  3443
  3444         16  FILLER                         PIC X(251).
  3445
  3446
  3447****************************************************************
  3448*             BUSSINESS TYPE MASTER RECORD                     *
  3449****************************************************************
  3450
  3451     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3452* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3453* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3454* AND RECORD 05 IS TYPES 81-99
  3455         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3456             20  CF-BUSINESS-TITLE          PIC  X(19).
  3457             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3458                                            PIC S9V9(4) COMP-3.
  3459             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3460             20  FILLER                     PIC  X.
  3461         16  FILLER                         PIC  X(248).
  3462
  3463
  3464****************************************************************
  3465*             TERMINAL MASTER RECORD                           *
  3466****************************************************************
  3467
  3468     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  62
* EL6318.cbl
  3469
  3470         16  CF-COMPANY-TERMINALS.
  3471             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3472                                  PIC X(4).
  3473         16  FILLER               PIC X(248).
  3474
  3475
  3476****************************************************************
  3477*             LIFE EDIT MASTER RECORD                          *
  3478****************************************************************
  3479
  3480     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3481         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3482             20  CF-LIFE-CODE-IN            PIC XX.
  3483             20  CF-LIFE-CODE-OUT           PIC XX.
  3484         16  FILLER                         PIC X(248).
  3485
  3486
  3487****************************************************************
  3488*             AH EDIT MASTER RECORD                            *
  3489****************************************************************
  3490
  3491     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3492         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3493             20  CF-AH-CODE-IN              PIC XXX.
  3494             20  CF-AH-CODE-OUT             PIC XX.
  3495         16  FILLER                         PIC X(248).
  3496
  3497
  3498****************************************************************
  3499*             CREDIBILITY TABLES                               *
  3500****************************************************************
  3501
  3502     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3503         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3504                             INDEXED BY CF-CRDB-NDX.
  3505             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3506             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3507             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3508         16  FILLER                         PIC  X(332).
  3509
  3510
  3511****************************************************************
  3512*             REPORT CUSTOMIZATION RECORD                      *
  3513****************************************************************
  3514
  3515     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3516         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3517             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3518             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3519             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3520**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3521****       A T-TRANSFER.                                   ****
  3522             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3523
  3524         16  FILLER                         PIC XX.
  3525
  3526         16  CF-CARRIER-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  63
* EL6318.cbl
  3527             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3528                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3529                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3530             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3531                                            PIC X.
  3532         16  CF-GROUP-CNTL-OPT.
  3533             20  CF-GROUP-OPT-SEQ           PIC 9.
  3534                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3535                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3536             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3537                                            PIC X(6).
  3538         16  CF-STATE-CNTL-OPT.
  3539             20  CF-STATE-OPT-SEQ           PIC 9.
  3540                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3541                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3542             20  CF-STATE-SELECT OCCURS 3 TIMES
  3543                                            PIC XX.
  3544         16  CF-ACCOUNT-CNTL-OPT.
  3545             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3546                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3547                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3548             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3549                                            PIC X(10).
  3550         16  CF-BUS-TYP-CNTL-OPT.
  3551             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3552                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3553                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3554             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3555                                            PIC XX.
  3556         16  CF-LF-TYP-CNTL-OPT.
  3557             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3558                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3559                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3560             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3561                                            PIC XX.
  3562         16  CF-AH-TYP-CNTL-OPT.
  3563             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3564                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3565                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3566             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3567                                            PIC XX.
  3568         16  CF-REPTCD1-CNTL-OPT.
  3569             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3570                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3571                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3572             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3573                                            PIC X(10).
  3574         16  CF-REPTCD2-CNTL-OPT.
  3575             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3576                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3577                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3578             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3579                                            PIC X(10).
  3580         16  CF-USER1-CNTL-OPT.
  3581             20  CF-USER1-OPT-SEQ           PIC 9.
  3582                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3583                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3584             20  CF-USER1-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  64
* EL6318.cbl
  3585                                            PIC X(10).
  3586         16  CF-USER2-CNTL-OPT.
  3587             20  CF-USER2-OPT-SEQ           PIC 9.
  3588                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3589                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3590             20  CF-USER2-SELECT OCCURS 3 TIMES
  3591                                            PIC X(10).
  3592         16  CF-USER3-CNTL-OPT.
  3593             20  CF-USER3-OPT-SEQ           PIC 9.
  3594                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3595                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3596             20  CF-USER3-SELECT OCCURS 3 TIMES
  3597                                            PIC X(10).
  3598         16  CF-USER4-CNTL-OPT.
  3599             20  CF-USER4-OPT-SEQ           PIC 9.
  3600                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3601                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3602             20  CF-USER4-SELECT OCCURS 3 TIMES
  3603                                            PIC X(10).
  3604         16  CF-USER5-CNTL-OPT.
  3605             20  CF-USER5-OPT-SEQ           PIC 9.
  3606                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3607                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3608             20  CF-USER5-SELECT OCCURS 3 TIMES
  3609                                            PIC X(10).
  3610         16  CF-REINS-CNTL-OPT.
  3611             20  CF-REINS-OPT-SEQ           PIC 9.
  3612                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3613                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3614             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3615                 24  CF-REINS-PRIME         PIC XXX.
  3616                 24  CF-REINS-SUB           PIC XXX.
  3617
  3618         16  CF-AGENT-CNTL-OPT.
  3619             20  CF-AGENT-OPT-SEQ           PIC 9.
  3620                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3621                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3622             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3623                                            PIC X(10).
  3624
  3625         16  FILLER                         PIC X(43).
  3626
  3627         16  CF-LOSS-RATIO-SELECT.
  3628             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3629             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3630         16  CF-ENTRY-DATE-SELECT.
  3631             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3632             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3633         16  CF-EFFECTIVE-DATE-SELECT.
  3634             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3635             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3636
  3637         16  CF-EXCEPTION-LIST-IND          PIC X.
  3638             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3639
  3640         16  FILLER                         PIC X(318).
  3641
  3642****************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  65
* EL6318.cbl
  3643*                  EXCEPTION REPORTING RECORD                  *
  3644****************************************************************
  3645
  3646     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3647         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3648             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3649
  3650         16  CF-COMBINED-LIFE-AH-OPT.
  3651             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3652             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3653             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3654             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3655
  3656         16  CF-LIFE-OPT.
  3657             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3658             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3659             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3660             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3661             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3662             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3663             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3664             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3665             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3666             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3667
  3668         16  CF-AH-OPT.
  3669             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3670             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3671             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3672             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3673             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3674             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3675             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3676             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3677             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3678             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3679
  3680         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3681             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3682             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3683             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3684
  3685         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3686
  3687         16  FILLER                         PIC X(673).
  3688
  3689
  3690****************************************************************
  3691*             MORTGAGE SYSTEM PLAN RECORD                      *
  3692****************************************************************
  3693
  3694     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3695         16  CF-PLAN-TYPE                   PIC X.
  3696             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3697             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3698             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3699         16  CF-PLAN-ABBREV                 PIC XXX.
  3700         16  CF-PLAN-DESCRIPT               PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  66
* EL6318.cbl
  3701         16  CF-PLAN-NOTES                  PIC X(20).
  3702         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3703         16  CF-PLAN-UNDERWRITING.
  3704             20  CF-PLAN-TERM-DATA.
  3705                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3706                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3707             20  CF-PLAN-AGE-DATA.
  3708                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3709                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3710                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3711             20  CF-PLAN-BENEFIT-DATA.
  3712                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3713                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3714                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3715                                            PIC S9(7)V99  COMP-3.
  3716         16  CF-PLAN-POLICY-FORMS.
  3717             20  CF-POLICY-FORM             PIC X(12).
  3718             20  CF-MASTER-APPLICATION      PIC X(12).
  3719             20  CF-MASTER-POLICY           PIC X(12).
  3720         16  CF-PLAN-RATING.
  3721             20  CF-RATE-CODE               PIC X(5).
  3722             20  CF-SEX-RATING              PIC X.
  3723                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3724                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3725             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3726             20  CF-SUB-STD-TYPE            PIC X.
  3727                 88  CF-PCT-OF-PREM            VALUE '1'.
  3728                 88  CF-PCT-OF-BENE            VALUE '2'.
  3729         16  CF-PLAN-PREM-TOLERANCES.
  3730             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3731             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3732         16  CF-PLAN-PYMT-TOLERANCES.
  3733             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3734             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3735         16  CF-PLAN-MISC-DATA.
  3736             20  FILLER                     PIC X.
  3737             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3738             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3739         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3740         16  CF-PLAN-IND-GRP                PIC X.
  3741             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3742                                                     '1'.
  3743             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3744                                                     '2'.
  3745         16  CF-MIB-SEARCH-SW               PIC X.
  3746             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3747             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3748             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3749             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3750         16  CF-ALPHA-SEARCH-SW             PIC X.
  3751             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3752             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3753             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3754             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3755             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3756             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3757             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3758             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  67
* EL6318.cbl
  3759             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3760             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3761                                                     'A' 'B' 'C'
  3762                                                     'X' 'Y' 'Z'.
  3763         16  CF-EFF-DT-RULE-SW              PIC X.
  3764             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3765             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3766             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3767             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3768             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3769         16  FILLER                         PIC X(4).
  3770         16  CF-HEALTH-QUESTIONS            PIC X.
  3771             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3772         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3773         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3774         16  CF-PLAN-SNGL-JNT               PIC X.
  3775             88  CF-COMBINED-PLAN              VALUE 'C'.
  3776             88  CF-JNT-PLAN                   VALUE 'J'.
  3777             88  CF-SNGL-PLAN                  VALUE 'S'.
  3778         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3779         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3780         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3781         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3782         16  CF-RERATE-CNTL                 PIC  X.
  3783             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3784             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3785             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3786             88  CF-AUTO-RECALC                 VALUE '4'.
  3787         16  CF-BENEFIT-TYPE                PIC  X.
  3788             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3789             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3790         16  CF-POLICY-FEE                  PIC S999V99
  3791                                                    COMP-3.
  3792         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3793         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3794         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3795         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3796         16  FILLER                         PIC  X(32).
  3797         16  CF-TERMINATION-FORM            PIC  X(04).
  3798         16  FILLER                         PIC  X(08).
  3799         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3800                                                       COMP-3.
  3801         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3802         16  CF-ISSUE-LETTER                PIC  X(4).
  3803         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3804         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3805             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3806             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3807         16  CF-MP-REFUND-CALC              PIC X.
  3808             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3809             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3810             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3811             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3812             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3813             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3814             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3815             88  CF-MP-REFD-MEAN                VALUE '8'.
  3816         16  CF-ALT-RATE-CODE               PIC  X(5).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  68
* EL6318.cbl
  3817
  3818
  3819         16  FILLER                         PIC X(498).
  3820****************************************************************
  3821*             MORTGAGE COMPANY MASTER RECORD                   *
  3822****************************************************************
  3823
  3824     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3825         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3826         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3827             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3828             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3829             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3830             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3831             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3832
  3833         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3834         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3835         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3836         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3837         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3838
  3839         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3840             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3841         16  CF-MP-RECON-USE-IND            PIC X(1).
  3842             88  CF-MP-USE-RECON             VALUE 'Y'.
  3843         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3844             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3845         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3846             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3847             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3848         16  FILLER                         PIC X(1).
  3849         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3850             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3851         16  CF-MORTG-MIB-VERSION           PIC X.
  3852             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3853             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3854             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3855         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3856             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3857                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3858             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3859                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3860             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3861                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3862             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3863                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3864             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3865                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3866             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3867                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3868         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3869         16  FILLER                         PIC X(7).
  3870         16  CF-MORTG-DESTINATION-SYMBOL.
  3871             20  CF-MORTG-MIB-COMM          PIC X(5).
  3872             20  CF-MORTG-MIB-TERM          PIC X(5).
  3873         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3874             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  69
* EL6318.cbl
  3875         16  FILLER                         PIC X(03).
  3876         16  CF-MP-CHECK-NO-CONTROL.
  3877             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3878                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3879                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3880                                                ' ' LOW-VALUES.
  3881                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3882                                               VALUE '3'.
  3883         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3884         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3885         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3886             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3887                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3888             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3889                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3890             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3891                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3892             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3893                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3894             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3895                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3896             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3897                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3898         16  CF-MORTG-BILLING-AREA.
  3899             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3900                                            PIC X.
  3901         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3902         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3903         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3904         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3905             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3906             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3907         16  FILLER                         PIC X.
  3908         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3909             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3910             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3911         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3912         16  FILLER                         PIC X(8).
  3913         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3914         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3915         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3916         16  CF-ACH-COMPANY-ID.
  3917             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3918                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3919                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3920                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3921             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3922         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3923             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3924         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3925             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3926             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3927         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3928         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3929         16  FILLER                         PIC X(536).
  3930
  3931****************************************************************
  3932*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  70
* EL6318.cbl
  3933****************************************************************
  3934
  3935     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3936         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3937             20  CF-FEMALE-HEIGHT.
  3938                 24  CF-FEMALE-FT           PIC 99.
  3939                 24  CF-FEMALE-IN           PIC 99.
  3940             20  CF-FEMALE-MIN-WT           PIC 999.
  3941             20  CF-FEMALE-MAX-WT           PIC 999.
  3942         16  FILLER                         PIC X(428).
  3943
  3944     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3945         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3946             20  CF-MALE-HEIGHT.
  3947                 24  CF-MALE-FT             PIC 99.
  3948                 24  CF-MALE-IN             PIC 99.
  3949             20  CF-MALE-MIN-WT             PIC 999.
  3950             20  CF-MALE-MAX-WT             PIC 999.
  3951         16  FILLER                         PIC X(428).
  3952******************************************************************
  3953*             AUTOMATIC ACTIVITY RECORD                          *
  3954******************************************************************
  3955     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3956         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3957             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3958             20  CF-SYS-LETTER-ID           PIC X(04).
  3959             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3960             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3961             20  CF-SYS-RESET-SW            PIC X(01).
  3962             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3963             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3964
  3965         16  FILLER                         PIC X(50).
  3966
  3967         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3968             20  CF-USER-ACTIVE-SW          PIC X(01).
  3969             20  CF-USER-LETTER-ID          PIC X(04).
  3970             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3971             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3972             20  CF-USER-RESET-SW           PIC X(01).
  3973             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3974             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3975             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3976
  3977         16  FILLER                         PIC X(246).
  3978*                                COPY ERCPNDB.
  3979******************************************************************
  3980*                                                                *
  3981*                                                                *
  3982*                            ERCPNDB.                            *
  3983*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3984*                            VMOD=2.025                          *
  3985*                                                                *
  3986*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3987*                                                                *
  3988******************************************************************
  3989*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3990*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  71
* EL6318.cbl
  3991******************************************************************
  3992*                                                                *
  3993*                                                                *
  3994*   FILE TYPE = VSAM,KSDS                                        *
  3995*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3996*                                                                *
  3997*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3998*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3999*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4000*                                                 RKP=13,LEN=36  *
  4001*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4002*                                      AND CHG-SEQ.)             *
  4003*                                                RKP=49,LEN=11   *
  4004*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4005*                                      AND CHG-SEQ.)             *
  4006*                                                RKP=60,LEN=15   *
  4007*                                                                *
  4008*   LOG = NO                                                     *
  4009*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4010******************************************************************
  4011******************************************************************
  4012*                   C H A N G E   L O G
  4013*
  4014* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4015*-----------------------------------------------------------------
  4016*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4017* EFFECTIVE    NUMBER
  4018*-----------------------------------------------------------------
  4019* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4020* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4021* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4022* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4023* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4024* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4025* 032306                   PEMA  ADD BOW LOAN NUMBER
  4026* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  4027* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4028* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4029* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4030* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4031* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4032* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4033* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4034* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4035* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4036* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  4037******************************************************************
  4038
  4039 01  PENDING-BUSINESS.
  4040     12  PB-RECORD-ID                     PIC XX.
  4041         88  VALID-PB-ID                        VALUE 'PB'.
  4042
  4043     12  PB-CONTROL-PRIMARY.
  4044         16  PB-COMPANY-CD                PIC X.
  4045         16  PB-ENTRY-BATCH               PIC X(6).
  4046         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4047         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4048
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  72
* EL6318.cbl
  4049     12  PB-CONTROL-BY-ACCOUNT.
  4050         16  PB-COMPANY-CD-A1             PIC X.
  4051         16  PB-CARRIER                   PIC X.
  4052         16  PB-GROUPING.
  4053             20  PB-GROUPING-PREFIX       PIC XXX.
  4054             20  PB-GROUPING-PRIME        PIC XXX.
  4055         16  PB-STATE                     PIC XX.
  4056         16  PB-ACCOUNT.
  4057             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4058             20  PB-ACCOUNT-PRIME         PIC X(6).
  4059         16  PB-CERT-EFF-DT               PIC XX.
  4060         16  PB-CERT-NO.
  4061             20  PB-CERT-PRIME            PIC X(10).
  4062             20  PB-CERT-SFX              PIC X.
  4063         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4064
  4065         16  PB-RECORD-TYPE               PIC X.
  4066             88  PB-MAILING-DATA                VALUE '0'.
  4067             88  PB-ISSUE                       VALUE '1'.
  4068             88  PB-CANCELLATION                VALUE '2'.
  4069             88  PB-BATCH-TRAILER               VALUE '9'.
  4070
  4071     12  PB-CONTROL-BY-ORIG-BATCH.
  4072         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4073         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4074         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4075         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4076
  4077     12  PB-CONTROL-BY-CSR.
  4078         16  PB-CSR-COMPANY-CD            PIC X.
  4079         16  PB-CSR-ID                    PIC X(4).
  4080         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4081         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4082         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4083******************************************************************
  4084*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4085******************************************************************
  4086
  4087     12  PB-LAST-MAINT-DT                 PIC XX.
  4088     12  PB-LAST-MAINT-BY                 PIC X(4).
  4089     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4090
  4091     12  PB-RECORD-BODY                   PIC X(375).
  4092
  4093     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4094         16  PB-CERT-ORIGIN               PIC X.
  4095             88  CLASIC-CREATED-CERT         VALUE '1'.
  4096         16  PB-I-NAME.
  4097             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4098             20  PB-I-INSURED-FIRST-NAME.
  4099                 24  PB-I-INSURED-1ST-INIT PIC X.
  4100                 24  FILLER                PIC X(9).
  4101             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4102         16  PB-I-AGE                     PIC S99   COMP-3.
  4103         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4104         16  PB-I-BIRTHDAY                PIC XX.
  4105         16  PB-I-INSURED-SEX             PIC X.
  4106             88  PB-SEX-MALE     VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  73
* EL6318.cbl
  4107             88  PB-SEX-FEMALE   VALUE 'F'.
  4108
  4109         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4110         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4111         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4112         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4113         16  PB-I-SKIP-CODE               PIC X.
  4114             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4115             88  PB-SKIP-JULY              VALUE '1'.
  4116             88  PB-SKIP-AUGUST            VALUE '2'.
  4117             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4118             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4119             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4120             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4121             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4122             88  PB-SKIP-JUNE              VALUE '8'.
  4123             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4124             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4125             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4126         16  PB-I-TERM-TYPE               PIC X.
  4127             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4128             88  PB-PAID-WEEKLY            VALUE 'W'.
  4129             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4130             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4131             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4132         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4133         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4134         16  PB-I-DATA-ENTRY-SW           PIC X.
  4135             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4136             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4137             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4138             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4139         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4140         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4141*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4142         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4143         16  FILLER                       PIC X.
  4144
  4145         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4146             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4147             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4148                                                   '90' THRU '99'.
  4149         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4150                                          PIC XX.
  4151         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4152         16  PB-I-AMOUNT-FINANCED REDEFINES
  4153                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4154         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4155         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4156                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4157         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4158         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4159         16  PB-I-CLP-AMOUNT REDEFINES
  4160                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4161         16  PB-I-LF-CALC-FLAG            PIC X.
  4162             88 PB-COMP-LF-PREM               VALUE '?'.
  4163         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4164         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  74
* EL6318.cbl
  4165         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4166         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4167         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4168         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4169         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4170         16  PB-I-LF-ABBR                 PIC XXX.
  4171         16  PB-I-LF-INPUT-CD             PIC XX.
  4172
  4173         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4174             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4175             88  PB-INVALID-AH               VALUE '  ' '00'
  4176                                                   '90' THRU '99'.
  4177         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4178         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4179         16  PB-I-AH-CALC-FLAG            PIC X.
  4180             88 PB-COMP-AH-PREM                  VALUE '?'.
  4181         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4182         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4183         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  4184         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4185         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4186         16  PB-I-AH-ABBR                 PIC XXX.
  4187         16  PB-I-AH-INPUT-CD             PIC XXX.
  4188
  4189         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4190         16  PB-I-REIN-TABLE              PIC XXX.
  4191         16  PB-I-BUSINESS-TYPE           PIC 99.
  4192         16  PB-I-INDV-GRP-CD             PIC X.
  4193         16  PB-I-MORT-CODE.
  4194             20  PB-I-TABLE               PIC X.
  4195             20  PB-I-INTEREST            PIC XX.
  4196             20  PB-I-MORT-TYP            PIC X.
  4197         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4198         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4199         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4200         16  PB-I-INDV-GRP-OVRD           PIC X.
  4201         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4202         16  PB-I-SIG-SW                  PIC X.
  4203             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4204         16  PB-I-RATE-CLASS              PIC XX.
  4205         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4206         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4207         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4208         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4209         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4210         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4211         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4212         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4213         16  PB-I-OB-FLAG                 PIC X.
  4214             88  PB-I-OB                      VALUE 'B'.
  4215             88  PB-I-SUMMARY                 VALUE 'Z'.
  4216         16  PB-I-ENTRY-STATUS            PIC X.
  4217             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4218                                              'M' '5' '9' '2'.
  4219             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4220             88  PB-I-POLICY-PENDING          VALUE '2'.
  4221             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4222             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  75
* EL6318.cbl
  4223             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4224             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4225             88  PB-I-REIN-ONLY               VALUE '9'.
  4226             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4227             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4228             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4229             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4230         16  PB-I-INT-CODE                PIC X.
  4231             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4232             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4233         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4234         16  PB-I-SOC-SEC-NO              PIC X(11).
  4235         16  PB-I-MEMBER-NO               PIC X(12).
  4236         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4237*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4238         16  PB-I-OLD-LOF                 PIC XXX.
  4239         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4240         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4241         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4242         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4243         16  PB-I-LIFE-INDICATOR          PIC X.
  4244             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4245         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4246         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4247                                          PIC S9(5)V99    COMP-3.
  4248         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4249             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4250             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4251         16  PB-I-1ST-PMT-DT              PIC XX.
  4252         16  PB-I-JOINT-INSURED.
  4253             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4254             20 PB-I-JOINT-FIRST-NAME.
  4255                24  PB-I-JOINT-FIRST-INIT PIC X.
  4256                24  FILLER                PIC X(9).
  4257             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4258*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4259         16  PB-I-BENEFICIARY-NAME.
  4260             20  PB-I-BANK-NUMBER         PIC X(10).
  4261             20  FILLER                   PIC X(15).
  4262         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4263         16  PB-I-REFERENCE               PIC X(12).
  4264         16  FILLER REDEFINES PB-I-REFERENCE.
  4265             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4266             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4267             20  PB-I-CLP-STATE           PIC XX.
  4268         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4269             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4270             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4271             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4272         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4273         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4274         16  PB-I-RESIDENT-STATE          PIC XX.
  4275         16  PB-I-RATE-CODE               PIC X(4).
  4276         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4277         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4278         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4279         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4280         16  PB-I-BANK-NOCHRGB            PIC 99.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  76
* EL6318.cbl
  4281         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4282         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4283
  4284     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4285         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4286             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4287         16  PB-C-CANCEL-ORIGIN           PIC X.
  4288             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4289         16  PB-C-LF-CANCEL-DT            PIC XX.
  4290         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4291         16  PB-C-LF-CALC-REQ             PIC X.
  4292             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4293         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4294         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4295         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4296             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4297         16  PB-C-AH-CANCEL-DT            PIC XX.
  4298         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4299         16  PB-C-AH-CALC-REQ             PIC X.
  4300             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4301         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4302         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4303         16  PB-C-LAST-NAME               PIC X(15).
  4304         16  PB-C-REFUND-SW               PIC X.
  4305             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4306             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4307         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4308         16  PB-C-PAYEE-CODE              PIC X(6).
  4309         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4310         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4311         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4312         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4313         16  PB-C-REFERENCE               PIC X(12).
  4314         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4315         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4316         16  PB-C-POST-CARD-IND           PIC X.
  4317         16  PB-C-CANCEL-REASON           PIC X.
  4318         16  PB-C-REF-INTERFACE-SW        PIC X.
  4319         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4320         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4321         16  FILLER                       PIC X(01).
  4322*        16  FILLER                       PIC X(18).
  4323         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4324*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4325         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4326         16  PB-CANCELED-CERT-DATA.
  4327             20  PB-CI-INSURED-NAME.
  4328                 24  PB-CI-LAST-NAME      PIC X(15).
  4329                 24  PB-CI-INITIALS       PIC XX.
  4330             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4331             20  PB-CI-INSURED-SEX        PIC X.
  4332             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4333             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4334             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4335             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4336             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4337             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4338             20  PB-CI-AH-TERM            PIC S999        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  77
* EL6318.cbl
  4339             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4340             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4341             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4342             20  PB-CI-RATE-CLASS         PIC XX.
  4343             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4344             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4345             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4346             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4347             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4348             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4349             20  PB-CI-LF-ABBR            PIC X(3).
  4350             20  PB-CI-AH-ABBR            PIC X(3).
  4351             20  PB-CI-OB-FLAG            PIC X.
  4352                 88  PB-CI-OB                VALUE 'B'.
  4353             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4354                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4355                                           'M' '4' '5' '9' '2'.
  4356                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4357                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4358                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4359                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4360                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4361                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4362                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4363                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4364                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4365                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4366                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4367                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4368                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4369             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4370                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4371                                           'M' '4' '5' '9' '2'.
  4372                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4373                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4374                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4375                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4376                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4377                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4378                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4379                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4380                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4381                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4382                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4383                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4384                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4385             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4386             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4387             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4388             20  PB-CI-MEMBER-NO          PIC X(12).
  4389             20  PB-CI-INT-CODE           PIC X.
  4390                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4391                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4392             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4393             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4394             20  PB-CI-COMP-EXCP-SW       PIC X.
  4395                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4396                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  78
* EL6318.cbl
  4397             20  PB-CI-ENTRY-STATUS       PIC X.
  4398             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4399             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4400             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4401             20  PB-CI-DEATH-DT           PIC XX.
  4402             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4403             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4404             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4405             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4406             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4407             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4408             20  PB-CI-ENTRY-DT              PIC XX.
  4409             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4410             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4411             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4412             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4413             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4414             20  PB-CI-OLD-LOF               PIC XXX.
  4415*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4416             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4417             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4418             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4419             20  PB-CI-INDV-GRP-CD           PIC X.
  4420             20  PB-CI-BENEFICIARY-NAME.
  4421                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4422                 24  FILLER                  PIC X(15).
  4423             20  PB-CI-NOTE-SW               PIC X.
  4424             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4425             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4426             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4427             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4428             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4429             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4430             20  PB-CI-FIRST-NAME            PIC X(10).
  4431             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4432
  4433         16  FILLER                       PIC X(13).
  4434*032306  16  FILLER                       PIC X(27).
  4435*        16  FILLER                       PIC X(46).
  4436
  4437     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4438         16  FILLER                       PIC X(10).
  4439         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4440         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4441         16  PB-M-INSURED-MID-INIT        PIC X.
  4442         16  PB-M-INSURED-AGE             PIC 99.
  4443         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4444         16  PB-M-INSURED-SEX             PIC X.
  4445         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4446         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4447         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4448         16  PB-M-INSURED-CITY-STATE.
  4449             20  PB-M-INSURED-CITY        PIC X(28).
  4450             20  PB-M-INSURED-STATE       PIC XX.
  4451         16  PB-M-INSURED-ZIP-CODE.
  4452             20  PB-M-INSURED-ZIP-PRIME.
  4453                 24  PB-M-INSURED-ZIP-1   PIC X.
  4454                     88  PB-M-CANADIAN-POST-CODE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  79
* EL6318.cbl
  4455                                             VALUE 'A' THRU 'Z'.
  4456                 24  FILLER               PIC X(4).
  4457             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4458         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4459                                        PB-M-INSURED-ZIP-CODE.
  4460             20  PM-M-INS-CAN-POST1       PIC XXX.
  4461             20  PM-M-INS-CAN-POST2       PIC XXX.
  4462             20  FILLER                   PIC XXX.
  4463         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4464         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4465         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4466         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4467         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4468         16  PB-M-CRED-BENE-CITYST.
  4469             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4470             20  PB-M-CRED-BENE-STATE     PIC XX.
  4471         16  FILLER                       PIC X(92).
  4472
  4473     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4474         16  FILLER                       PIC X(10).
  4475         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4476         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4477         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4478         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4479         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4480         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4481         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4482         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4483         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4484         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4485         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4486         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4487         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4488         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4489         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4490         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4491         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4492         16  PB-ACCOUNT-NAME              PIC X(30).
  4493         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4494         16  PB-REFERENCE                 PIC X(12).
  4495         16  PB-B-RECEIVED-DT             PIC XX.
  4496         16  FILLER                       PIC X(234).
  4497
  4498     12  PB-RECORD-STATUS.
  4499         16  PB-CREDIT-SELECT-DT          PIC XX.
  4500         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4501         16  PB-BILLED-DT                 PIC XX.
  4502         16  PB-BILLING-STATUS            PIC X.
  4503             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4504             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4505             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4506         16  PB-RECORD-BILL               PIC X.
  4507             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4508             88  PB-RECORD-RETURNED           VALUE 'R'.
  4509             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4510             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4511             88  PB-OVERRIDE-AH               VALUE 'A'.
  4512             88  PB-OVERRIDE-BOTH             VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  80
* EL6318.cbl
  4513         16  PB-BATCH-ENTRY               PIC X.
  4514             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4515             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4516             88  PB-REISSUED-CERT             VALUE 'E'.
  4517             88  PB-CASH-CERT                 VALUE 'C'.
  4518             88  PB-MONTHLY-CERT              VALUE 'M'.
  4519             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4520             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4521             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4522         16  PB-FORCE-CODE                PIC X.
  4523             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4524             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4525             88  PB-CANCEL-FORCE              VALUE '8'.
  4526             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4527             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4528             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4529             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4530             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4531             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4532             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  4533             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4534         16  PB-FATAL-FLAG                PIC X.
  4535             88  PB-FATAL-ERRORS              VALUE 'X'.
  4536         16  PB-FORCE-ER-CD               PIC X.
  4537             88  PB-FORCE-ERRORS              VALUE 'F'.
  4538             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4539         16  PB-WARN-ER-CD                PIC X.
  4540             88  PB-WARNING-ERRORS            VALUE 'W'.
  4541         16  FILLER                       PIC X.
  4542         16  PB-OUT-BAL-CD                PIC X.
  4543             88  PB-OUT-OF-BAL                VALUE 'O'.
  4544         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4545         16  PB-AH-OVERRIDE-L1            PIC X.
  4546         16  PB-INPUT-DT                  PIC XX.
  4547         16  PB-INPUT-BY                  PIC X(4).
  4548         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4549         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4550         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4551         16  PB-LF-EARNING-METHOD         PIC X.
  4552         16  PB-AH-EARNING-METHOD         PIC X.
  4553         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4554         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4555         16  PB-REIN-CD                   PIC XXX.
  4556         16  PB-LF-REFUND-TYPE            PIC X.
  4557         16  PB-AH-REFUND-TYPE            PIC X.
  4558         16  PB-ACCT-EFF-DT               PIC XX.
  4559         16  PB-ACCT-EXP-DT               PIC XX.
  4560         16  PB-COMPANY-ID                PIC X(3).
  4561         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4562         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4563         16  PB-SV-CARRIER                PIC X.
  4564         16  PB-SV-GROUPING               PIC X(6).
  4565         16  PB-SV-STATE                  PIC XX.
  4566         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4567         16  PB-GA-BILLING-INFO.
  4568             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4569                                          PIC XX.
  4570         16  PB-SV-REMIT-TO  REDEFINES
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  81
* EL6318.cbl
  4571             PB-GA-BILLING-INFO           PIC X(10).
  4572         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4573         16  PB-I-LOAN-OFFICER            PIC X(5).
  4574         16  PB-I-VIN                     PIC X(17).
  4575
  4576         16  FILLER                       PIC X(04).
  4577         16  IMNET-BYPASS-SW              PIC X.
  4578
  4579******************************************************************
  4580*                COMMON EDIT ERRORS                              *
  4581******************************************************************
  4582
  4583     12  PB-COMMON-ERRORS.
  4584         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4585                                           PIC S9(4)     COMP.
  4586
  4587******************************************************************
  4588*                                COPY ELCCERT.
  4589******************************************************************
  4590*                                                                *
  4591*                            ELCCERT.                            *
  4592*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4593*                            VMOD=2.013                          *
  4594*                                                                *
  4595*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4596*                                                                *
  4597*   FILE TYPE = VSAM,KSDS                                        *
  4598*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4599*                                                                *
  4600*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4601*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4602*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4603*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4604*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4605*                                                                *
  4606*   LOG = YES                                                    *
  4607*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4608******************************************************************
  4609*                   C H A N G E   L O G
  4610*
  4611* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4612*-----------------------------------------------------------------
  4613*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4614* EFFECTIVE    NUMBER
  4615*-----------------------------------------------------------------
  4616* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4617* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4618* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4619* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4620* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4621* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4622* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4623* 032612  CR2011110200001  PEMA  AHL CHANGES
  4624* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  4625* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4626******************************************************************
  4627
  4628 01  CERTIFICATE-MASTER.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  82
* EL6318.cbl
  4629     12  CM-RECORD-ID                      PIC XX.
  4630         88  VALID-CM-ID                      VALUE 'CM'.
  4631
  4632     12  CM-CONTROL-PRIMARY.
  4633         16  CM-COMPANY-CD                 PIC X.
  4634         16  CM-CARRIER                    PIC X.
  4635         16  CM-GROUPING.
  4636             20  CM-GROUPING-PREFIX        PIC X(3).
  4637             20  CM-GROUPING-PRIME         PIC X(3).
  4638         16  CM-STATE                      PIC XX.
  4639         16  CM-ACCOUNT.
  4640             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4641             20  CM-ACCOUNT-PRIME          PIC X(6).
  4642         16  CM-CERT-EFF-DT                PIC XX.
  4643         16  CM-CERT-NO.
  4644             20  CM-CERT-PRIME             PIC X(10).
  4645             20  CM-CERT-SFX               PIC X.
  4646
  4647     12  CM-CONTROL-BY-NAME.
  4648         16  CM-COMPANY-CD-A1              PIC X.
  4649         16  CM-INSURED-LAST-NAME          PIC X(15).
  4650         16  CM-INSURED-INITIALS.
  4651             20  CM-INSURED-INITIAL1       PIC X.
  4652             20  CM-INSURED-INITIAL2       PIC X.
  4653
  4654     12  CM-CONTROL-BY-SSN.
  4655         16  CM-COMPANY-CD-A2              PIC X.
  4656         16  CM-SOC-SEC-NO.
  4657             20  CM-SSN-STATE              PIC XX.
  4658             20  CM-SSN-ACCOUNT            PIC X(6).
  4659             20  CM-SSN-LN3.
  4660                 25  CM-INSURED-INITIALS-A2.
  4661                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4662                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4663                 25 CM-PART-LAST-NAME-A2         PIC X.
  4664
  4665     12  CM-CONTROL-BY-CERT-NO.
  4666         16  CM-COMPANY-CD-A4              PIC X.
  4667         16  CM-CERT-NO-A4                 PIC X(11).
  4668
  4669     12  CM-CONTROL-BY-MEMB.
  4670         16  CM-COMPANY-CD-A5              PIC X.
  4671         16  CM-MEMBER-NO.
  4672             20  CM-MEMB-STATE             PIC XX.
  4673             20  CM-MEMB-ACCOUNT           PIC X(6).
  4674             20  CM-MEMB-LN4.
  4675                 25  CM-INSURED-INITIALS-A5.
  4676                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4677                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4678                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4679
  4680     12  CM-INSURED-PROFILE-DATA.
  4681         16  CM-INSURED-FIRST-NAME.
  4682             20  CM-INSURED-1ST-INIT       PIC X.
  4683             20  FILLER                    PIC X(9).
  4684         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4685         16  CM-INSURED-SEX                PIC X.
  4686             88  CM-SEX-MALE                  VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  83
* EL6318.cbl
  4687             88  CM-SEX-FEMAL                 VALUE 'F'.
  4688         16  CM-INSURED-JOINT-AGE          PIC 99.
  4689         16  CM-JOINT-INSURED-NAME.
  4690             20  CM-JT-LAST-NAME           PIC X(15).
  4691             20  CM-JT-FIRST-NAME.
  4692                 24  CM-JT-1ST-INIT        PIC X.
  4693                 24  FILLER                PIC X(9).
  4694             20  CM-JT-INITIAL             PIC X.
  4695
  4696     12  CM-LIFE-DATA.
  4697         16  CM-LF-BENEFIT-CD              PIC XX.
  4698         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4699         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4700         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4701         16  CM-LF-DEV-CODE                PIC XXX.
  4702         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4703         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4704         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4705         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4706         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4707         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4708         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4709         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4710         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4711         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4712         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4713         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4714         16  cm-temp-epiq                  pic xx.
  4715             88  EPIQ-CLASS                  value 'EQ'.
  4716*        16  FILLER                        PIC XX.
  4717
  4718     12  CM-AH-DATA.
  4719         16  CM-AH-BENEFIT-CD              PIC XX.
  4720         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4721         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4722         16  CM-AH-DEV-CODE                PIC XXX.
  4723         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4724         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4725         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4726         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4727         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4728         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4729         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4730         16  CM-AH-PAID-THRU-DT            PIC XX.
  4731             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4732         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4733         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  4734         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4735         16  FILLER                        PIC X.
  4736
  4737     12  CM-LOAN-INFORMATION.
  4738         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4739         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4740                                           PIC S9(5)V99  COMP-3.
  4741         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4742         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4743         16  CM-PAY-FREQUENCY              PIC S99.
  4744         16  CM-LOAN-TERM                  PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  84
* EL6318.cbl
  4745         16  CM-RATE-CLASS                 PIC XX.
  4746         16  CM-BENEFICIARY                PIC X(25).
  4747         16  CM-POLICY-FORM-NO             PIC X(12).
  4748         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4749         16  CM-LAST-ADD-ON-DT             PIC XX.
  4750         16  CM-DEDUCTIBLE-AMOUNTS.
  4751             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4752             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4753         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4754             20  CM-RESIDENT-STATE         PIC XX.
  4755             20  CM-RATE-CODE              PIC X(4).
  4756             20  FILLER                    PIC XX.
  4757         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4758             20  CM-LOAN-OFFICER           PIC X(5).
  4759             20  FILLER                    PIC XXX.
  4760         16  CM-CSR-CODE                   PIC XXX.
  4761         16  CM-UNDERWRITING-CODE          PIC X.
  4762             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4763         16  CM-POST-CARD-IND              PIC X.
  4764         16  CM-NH-INTERFACE-SW            PIC X.
  4765         16  CM-PREMIUM-TYPE               PIC X.
  4766             88  CM-SING-PRM                  VALUE '1'.
  4767             88  CM-O-B-COVERAGE              VALUE '2'.
  4768             88  CM-OPEN-END                  VALUE '3'.
  4769         16  CM-IND-GRP-TYPE               PIC X.
  4770             88  CM-INDIVIDUAL                VALUE 'I'.
  4771             88  CM-GROUP                     VALUE 'G'.
  4772         16  CM-SKIP-CODE                  PIC X.
  4773             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4774             88  SKIP-JULY                    VALUE '1'.
  4775             88  SKIP-AUGUST                  VALUE '2'.
  4776             88  SKIP-SEPTEMBER               VALUE '3'.
  4777             88  SKIP-JULY-AUG                VALUE '4'.
  4778             88  SKIP-AUG-SEPT                VALUE '5'.
  4779             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4780             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4781             88  SKIP-JUNE                    VALUE '8'.
  4782             88  SKIP-JUNE-JULY               VALUE '9'.
  4783             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4784             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4785         16  CM-PAYMENT-MODE               PIC X.
  4786             88  PAY-MONTHLY                  VALUE SPACE.
  4787             88  PAY-WEEKLY                   VALUE '1'.
  4788             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4789             88  PAY-BI-WEEKLY                VALUE '3'.
  4790             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4791         16  CM-LOAN-NUMBER                PIC X(8).
  4792         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4793         16  CM-OLD-LOF                    PIC XXX.
  4794*        16  CM-LOAN-OFFICER               PIC XXX.
  4795         16  CM-REIN-TABLE                 PIC XXX.
  4796         16  CM-SPECIAL-REIN-CODE          PIC X.
  4797         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4798         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4799         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4800
  4801     12  CM-STATUS-DATA.
  4802         16  CM-ENTRY-STATUS               PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  85
* EL6318.cbl
  4803         16  CM-ENTRY-DT                   PIC XX.
  4804
  4805         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4806         16  CM-LF-CANCEL-DT               PIC XX.
  4807         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4808
  4809         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4810         16  CM-LF-DEATH-DT                PIC XX.
  4811         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4812
  4813         16  CM-LF-CURRENT-STATUS          PIC X.
  4814             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4815                                                'M' '4' '5' '9'.
  4816             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4817             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4818             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4819             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4820             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4821             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  4822             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4823             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4824             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4825             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4826             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4827             88  CM-LF-DECLINED               VALUE 'D'.
  4828             88  CM-LF-VOIDED                 VALUE 'V'.
  4829
  4830         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4831         16  CM-AH-CANCEL-DT               PIC XX.
  4832         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4833
  4834         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4835         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4836         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4837
  4838         16  CM-AH-CURRENT-STATUS          PIC X.
  4839             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4840                                                'M' '4' '5' '9'.
  4841             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4842             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4843             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4844             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4845             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4846             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  4847             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4848             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4849             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4850             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4851             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4852             88  CM-AH-DECLINED               VALUE 'D'.
  4853             88  CM-AH-VOIDED                 VALUE 'V'.
  4854
  4855         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4856             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4857             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4858             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4859         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4860
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  86
* EL6318.cbl
  4861         16  CM-ENTRY-BATCH                PIC X(6).
  4862         16  CM-LF-EXIT-BATCH              PIC X(6).
  4863         16  CM-AH-EXIT-BATCH              PIC X(6).
  4864         16  CM-LAST-MONTH-END             PIC XX.
  4865
  4866     12  CM-NOTE-SW                        PIC X.
  4867         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4868         88  CERT-NOTES-PRESENT               VALUE '1'.
  4869         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4870         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4871         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4872         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4873         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4874         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4875     12  CM-COMP-EXCP-SW                   PIC X.
  4876         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4877         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4878     12  CM-INSURED-ADDRESS-SW             PIC X.
  4879         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4880         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4881
  4882*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4883     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4884     12  FILLER                            PIC X.
  4885
  4886*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4887     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4888     12  FILLER                            PIC X.
  4889*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4890     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4891
  4892     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4893         88  CERT-ADDED-BATCH                 VALUE ' '.
  4894         88  CERT-ADDED-ONLINE                VALUE '1'.
  4895         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4896         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4897         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4898     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4899         88  CERT-AS-LOADED                   VALUE ' '.
  4900         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4901         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4902         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4903         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4904         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4905         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4906         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4907
  4908     12  CM-ACCOUNT-COMM-PCTS.
  4909         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4910         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4911
  4912     12  CM-USER-FIELD                     PIC X.
  4913     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4914     12  CM-CLP-STATE                      PIC XX.
  4915     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4916     12  CM-USER-RESERVED                  PIC XXX.
  4917     12  FILLER REDEFINES CM-USER-RESERVED.
  4918         16  CM-AH-CLASS-CD                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  87
* EL6318.cbl
  4919         16  F                             PIC X.
  4920******************************************************************
  4921*                                COPY ELCCRTO.
  4922******************************************************************
  4923*                                                                *
  4924*                            ELCCRTO.                            *
  4925*                                                                *
  4926*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  4927*                                                                *
  4928*   FILE TYPE = VSAM,KSDS                                        *
  4929*   RECORD SIZE = 524  RECFORM = FIXED                           *
  4930*                                                                *
  4931*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  4932*                                                                *
  4933*   LOG = YES                                                    *
  4934*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4935******************************************************************
  4936*                   C H A N G E   L O G
  4937*
  4938* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4939*-----------------------------------------------------------------
  4940*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4941* EFFECTIVE    NUMBER
  4942*-----------------------------------------------------------------
  4943* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  4944* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  4945* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  4946* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  4947* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  4948******************************************************************
  4949 01  ORIGINAL-CERTIFICATE.
  4950     12  OC-RECORD-ID                      PIC XX.
  4951         88  VALID-OC-ID                      VALUE 'OC'.
  4952     12  OC-CONTROL-PRIMARY.
  4953         16  OC-COMPANY-CD                 PIC X.
  4954         16  OC-CARRIER                    PIC X.
  4955         16  OC-GROUPING                   PIC X(6).
  4956         16  OC-STATE                      PIC XX.
  4957         16  OC-ACCOUNT                    PIC X(10).
  4958         16  OC-CERT-EFF-DT                PIC XX.
  4959         16  OC-CERT-NO.
  4960             20  OC-CERT-PRIME             PIC X(10).
  4961             20  OC-CERT-SFX               PIC X.
  4962         16  OC-RECORD-TYPE                PIC X.
  4963         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  4964     12  OC-LAST-MAINT-DT                  PIC XX.
  4965     12  OC-LAST-MAINT-BY                  PIC X(4).
  4966     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  4967     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  4968     12  FILLER                            PIC X(49).
  4969     12  OC-ORIG-REC.
  4970         16  OC-INS-LAST-NAME              PIC X(15).
  4971         16  OC-INS-FIRST-NAME             PIC X(10).
  4972         16  OC-INS-MIDDLE-INIT            PIC X.
  4973         16  OC-INS-AGE                    PIC S999     COMP-3.
  4974         16  OC-JNT-LAST-NAME              PIC X(15).
  4975         16  OC-JNT-FIRST-NAME             PIC X(10).
  4976         16  OC-JNT-MIDDLE-INIT            PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  88
* EL6318.cbl
  4977         16  OC-JNT-AGE                    PIC S999     COMP-3.
  4978         16  OC-LF-BENCD                   PIC XX.
  4979         16  OC-LF-TERM                    PIC S999      COMP-3.
  4980         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4981         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4982         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  4983         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  4984         16  OC-LF-EXP-DT                  PIC XX.
  4985         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  4986         16  OC-LF-CANCEL-DT               PIC XX.
  4987         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4988         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4989         16  OC-AH-BENCD                   PIC XX.
  4990         16  OC-AH-TERM                    PIC S999      COMP-3.
  4991         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4992         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4993         16  OC-AH-EXP-DT                  PIC XX.
  4994         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4995         16  OC-AH-CP                      PIC 99.
  4996         16  OC-AH-CANCEL-DT               PIC XX.
  4997         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4998         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4999         16  OC-CRED-BENE-NAME             PIC X(25).
  5000         16  OC-1ST-PMT-DT                 PIC XX.
  5001         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  5002         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  5003         16  OC-ISSUE-TRAN-IND             PIC X.
  5004         16  OC-CANCEL-TRAN-IND            PIC X.
  5005         16  FILLER                        PIC X(211).
  5006
  5007     12  FILLER                            PIC X(50).
  5008******************************************************************
  5009*                                COPY ERCENDT.
  5010******************************************************************
  5011*                                                                *
  5012*                                                                *
  5013*                            ERCENDT.                            *
  5014*                            VMOD=2.001                          *
  5015*                                                                *
  5016*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  5017*                                                                *
  5018*   FILE TYPE = VSAM,KSDS                                        *
  5019*   RECORD SIZE = 579  RECFORM = FIXED                           *
  5020*                                                                *
  5021*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  5022*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  5023*                                                                *
  5024*   LOG = NO                                                     *
  5025*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5026******************************************************************
  5027*-----------------------------------------------------------------
  5028*                   C H A N G E   L O G
  5029*
  5030* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5031*-----------------------------------------------------------------
  5032*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5033* EFFECTIVE    NUMBER
  5034*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  89
* EL6318.cbl
  5035* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  5036*                                WITH OPEN CLAIMS
  5037* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  5038* 110612    2012101700002  AJRA  ADD NEW FIELDS
  5039* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5040* 010616  CR2015082000001  PEMA  ADD ENDORSEMENT CHECK PROCESSING
  5041*-----------------------------------------------------------------
  5042 01  ENDORSEMENT-RECORD.
  5043     12  EN-RECORD-ID                PIC XX.
  5044         88  VALID-EN-ID                VALUE 'EN'.
  5045     12  EN-CONTROL-PRIMARY.
  5046         16  EN-COMPANY-CD           PIC X.
  5047         16  EN-CARRIER              PIC X.
  5048         16  EN-GROUPING             PIC X(6).
  5049         16  EN-STATE                PIC XX.
  5050         16  EN-ACCOUNT              PIC X(10).
  5051         16  EN-CERT-EFF-DT          PIC XX.
  5052         16  EN-CERT-NO.
  5053             20  EN-CERT-PRIME       PIC X(10).
  5054             20  EN-CERT-SFX         PIC X.
  5055         16  EN-REC-TYPE             PIC X.
  5056             88  EN-ISSUE               VALUE 'I'.
  5057             88  EN-CANCELLATION        VALUE 'C'.
  5058         16  EN-SEQ-NO               PIC 9(04) BINARY.
  5059     12  EN-CONTROL-BY-ARCH-NO.
  5060         16  EN-COMPANY-CD-A1              PIC X.
  5061         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  5062     12  EN-LAST-MAINT-DT            PIC XX.
  5063     12  EN-LAST-MAINT-BY            PIC X(4).
  5064     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  5065     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  5066     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  5067         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  5068         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  5069         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  5070         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  5071         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  5072         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  5073         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  5074         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  5075         16  EN-LF-ORIG-BENCD        PIC XX.
  5076         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  5077         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  5078         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  5079         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  5080         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  5081         16  EN-LF-ORIG-EXP-DT       PIC XX.
  5082*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  5083         16  EN-ORIG-CRED-BENE       PIC X(25).
  5084         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  5085         16  FILLER                  PIC X.
  5086         16  EN-AH-ORIG-BENCD        PIC XX.
  5087         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  5088         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  5089         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  5090         16  EN-AH-ORIG-EXP-DT       PIC XX.
  5091*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  5092*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  90
* EL6318.cbl
  5093         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  5094         16  F                       PIC X(09).
  5095         16  EN-AH-ORIG-CP           PIC 99.
  5096         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  5097         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  5098         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  5099         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  5100         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  5101         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  5102         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  5103         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  5104         16  EN-LF-NEW-BENCD         PIC XX.
  5105         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  5106         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  5107         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  5108         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  5109         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  5110         16  EN-LF-NEW-EXP-DT        PIC XX.
  5111         16  EN-NEW-CRED-BENE        PIC X(25).
  5112         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  5113         16  FILLER                  PIC X.
  5114         16  EN-AH-NEW-BENCD         PIC XX.
  5115         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  5116         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  5117         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  5118         16  EN-AH-NEW-EXP-DT        PIC XX.
  5119*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  5120*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  5121*        16  F                       PIC X(12).
  5122         16  EN-AH-NEW-CP            PIC 99.
  5123         16  EN-SIG-SW               PIC X.
  5124         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  5125         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  5126         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  5127         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  5128         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  5129         16  FILLER                  PIC X(33).
  5130     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  5131         16  EN-LF-ORIG-REF-DT       PIC XX.
  5132         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  5133         16  EN-AH-ORIG-REF-DT       PIC XX.
  5134         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  5135         16  EN-LF-NEW-REF-DT        PIC XX.
  5136         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  5137         16  EN-AH-NEW-REF-DT        PIC XX.
  5138         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  5139         16  EN-FLAG-CERT            PIC X.
  5140         16  EN-INS-LAST-NAME        PIC X(15).
  5141         16  EN-INS-FIRST-NAME       PIC X(10).
  5142         16  EN-INS-MIDDLE-INIT      PIC X.
  5143         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  5144         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  5145         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  5146         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  5147         16  FILLER                  PIC X(262).
  5148     12  EN-MONEY-SW             PIC X.
  5149     12  EN-HEALTH-APP           PIC X.
  5150     12  EN-VOUCHER-SW           PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  91
* EL6318.cbl
  5151     12  EN-PAYEE                PIC X(14).
  5152     12  EN-INPUT-DT             PIC XX.
  5153     12  EN-PROCESS-DT           PIC XX.
  5154     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  5155     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  5156     12  EN-REASON-CODES.
  5157         16  F OCCURS 12.
  5158             20  EN-REASON-CODE  PIC X(4).
  5159     12  EN-TEMPLATE-USED        PIC X(8).
  5160     12  EN-DOCU-TYPE            PIC X.
  5161         88  EN-VERI-DOCU          VALUE 'V'.
  5162         88  EN-GCE-DOCU           VALUE 'G'.
  5163         88  EN-CANC-DOCU          VALUE 'C'.
  5164     12  EN-COMMENTS1            PIC X(13).
  5165     12  EN-COMMENTS2            PIC X(70).
  5166     12  EN-COMM-CHGBK           PIC X.
  5167         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  5168         88  EN-CHG-ACCT           VALUE 'Y'.
  5169     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  5170     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  5171     12  EN-BATCH-NUMBER         PIC X(6).
  5172     12  EN-ACCT-SUMM            PIC X.
  5173     12  EN-CSO-SUMM             PIC X.
  5174     12  en-check-type           pic x.
  5175     12  FILLER                  PIC X(12).
  5176******************************************************************
  5177*                                COPY ERCNOTE.
  5178******************************************************************
  5179*                                                                *
  5180*                                                                *
  5181*                            ERCNOTE                             *
  5182*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5183*                            VMOD=2.003                          *
  5184*                                                                *
  5185*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  5186*                                                                *
  5187*        FILE TYPE= VSAM,KSDS                                    *
  5188*        RECORD SIZE = 825    RECFORM = FIXED                    *
  5189*                                                                *
  5190*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  5191*                                                                *
  5192*        LOG = YES                                               *
  5193*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5194*                                                                *
  5195******************************************************************
  5196*                   C H A N G E   L O G
  5197*
  5198* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5199*-----------------------------------------------------------------
  5200*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5201* EFFECTIVE    NUMBER
  5202*-----------------------------------------------------------------
  5203* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  5204*                                FILE WILL CONTAIN BILLING NOTES O
  5205******************************************************************
  5206
  5207 01  CERTIFICATE-NOTE.
  5208     12  CN-RECORD-ID                PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  92
* EL6318.cbl
  5209         88  VALID-CN-ID                  VALUE 'CN'.
  5210
  5211     12  CN-CONTROL-PRIMARY.
  5212         16  CN-COMPANY-CD           PIC X.
  5213         16  CN-CARRIER              PIC X.
  5214         16  CN-GROUPING.
  5215             20 CN-GROUPING-PREFIX   PIC XXX.
  5216             20 CN-GROUPING-PRIME    PIC XXX.
  5217         16  CN-STATE                PIC XX.
  5218         16  CN-ACCOUNT.
  5219             20 CN-ACCOUNT-PREFIX    PIC X(4).
  5220             20 CN-ACCOUNT-PRIME     PIC X(6).
  5221         16  CN-CERT-EFF-DT          PIC XX.
  5222         16  CN-CERT-NO.
  5223             20  CN-CERT-PRIME       PIC X(10).
  5224             20  CN-CERT-SFX         PIC X.
  5225
  5226     12  CN-BILLING-START-LINE-NO    PIC 99.
  5227     12  CN-BILLING-END-LINE-NO      PIC 99.
  5228
  5229     12  CN-LINES.
  5230         16  CN-LINE OCCURS 10       PIC X(77).
  5231
  5232     12  CN-LAST-MAINT-DT            PIC XX.
  5233     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5234     12  CN-LAST-MAINT-USER          PIC X(4).
  5235     12  FILLER                      PIC X(6).
  5236******************************************************************
  5237*                                COPY ERCMAIL.
  5238******************************************************************
  5239*                                                                *
  5240*                                                                *
  5241*                            ERCMAIL                             *
  5242*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5243*                            VMOD=2.003                          *
  5244*                                                                *
  5245*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5246*                                                                *
  5247*   FILE TYPE = VSAM,KSDS                                        *
  5248*   RECORD SIZE = 374   RECFORM = FIX                            *
  5249*                                                                *
  5250*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5251*   ALTERNATE PATH    = NOT USED                                 *
  5252*                                                                *
  5253*   LOG = YES                                                    *
  5254*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5255******************************************************************
  5256*                   C H A N G E   L O G
  5257*
  5258* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5259*-----------------------------------------------------------------
  5260*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5261* EFFECTIVE    NUMBER
  5262*-----------------------------------------------------------------
  5263* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5264* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5265* 111108                   PEMA  ADD CRED BENE ADDR2
  5266******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  93
* EL6318.cbl
  5267
  5268 01  MAILING-DATA.
  5269     12  MA-RECORD-ID                      PIC XX.
  5270         88  VALID-MA-ID                       VALUE 'MA'.
  5271
  5272     12  MA-CONTROL-PRIMARY.
  5273         16  MA-COMPANY-CD                 PIC X.
  5274         16  MA-CARRIER                    PIC X.
  5275         16  MA-GROUPING.
  5276             20  MA-GROUPING-PREFIX        PIC XXX.
  5277             20  MA-GROUPING-PRIME         PIC XXX.
  5278         16  MA-STATE                      PIC XX.
  5279         16  MA-ACCOUNT.
  5280             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5281             20  MA-ACCOUNT-PRIME          PIC X(6).
  5282         16  MA-CERT-EFF-DT                PIC XX.
  5283         16  MA-CERT-NO.
  5284             20  MA-CERT-PRIME             PIC X(10).
  5285             20  MA-CERT-SFX               PIC X.
  5286
  5287     12  FILLER                            PIC XX.
  5288
  5289     12  MA-ACCESS-CONTROL.
  5290         16  MA-SOURCE-SYSTEM              PIC XX.
  5291             88  MA-FROM-CREDIT                VALUE 'CR'.
  5292             88  MA-FROM-VSI                   VALUE 'VS'.
  5293             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5294             88  MA-FROM-OTHER                 VALUE 'OT'.
  5295         16  MA-RECORD-ADD-DT              PIC XX.
  5296         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5297         16  MA-LAST-MAINT-DT              PIC XX.
  5298         16  MA-LAST-MAINT-BY              PIC XXXX.
  5299         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5300
  5301     12  MA-PROFILE-INFO.
  5302         16  MA-QUALIFY-CODE-1             PIC XX.
  5303         16  MA-QUALIFY-CODE-2             PIC XX.
  5304         16  MA-QUALIFY-CODE-3             PIC XX.
  5305         16  MA-QUALIFY-CODE-4             PIC XX.
  5306         16  MA-QUALIFY-CODE-5             PIC XX.
  5307
  5308         16  MA-INSURED-LAST-NAME          PIC X(15).
  5309         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5310         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5311         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5312         16  MA-INSURED-BIRTH-DT           PIC XX.
  5313         16  MA-INSURED-SEX                PIC X.
  5314             88  MA-SEX-MALE                   VALUE 'M'.
  5315             88  MA-SEX-FEMALE                 VALUE 'F'.
  5316         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5317
  5318         16  MA-ADDRESS-CORRECTED          PIC X.
  5319         16  MA-JOINT-BIRTH-DT             PIC XX.
  5320*        16  FILLER                        PIC X(12).
  5321
  5322         16  MA-ADDRESS-LINE-1             PIC X(30).
  5323         16  MA-ADDRESS-LINE-2             PIC X(30).
  5324         16  MA-CITY-STATE.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  94
* EL6318.cbl
  5325             20  MA-CITY                   PIC X(28).
  5326             20  MA-ADDR-STATE             PIC XX.
  5327         16  MA-ZIP.
  5328             20  MA-ZIP-CODE.
  5329                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5330                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5331                 24  FILLER                PIC X(4).
  5332             20  MA-ZIP-PLUS4              PIC X(4).
  5333         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5334             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5335             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5336             20  FILLER                    PIC X(3).
  5337
  5338         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5339
  5340         16  FILLER                        PIC XXX.
  5341*        16  FILLER                        PIC X(10).
  5342
  5343     12  MA-CRED-BENE-INFO.
  5344         16  MA-CRED-BENE-NAME                 PIC X(25).
  5345         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5346         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5347         16  MA-CRED-BENE-CTYST.
  5348             20  MA-CRED-BENE-CITY             PIC X(28).
  5349             20  MA-CRED-BENE-STATE            PIC XX.
  5350         16  MA-CRED-BENE-ZIP.
  5351             20  MA-CB-ZIP-CODE.
  5352                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5353                     88  MA-CB-CANADIAN-POST-CODE
  5354                                           VALUE 'A' THRU 'Z'.
  5355                 24  FILLER                    PIC X(4).
  5356             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5357         16  MA-CB-CANADIAN-POSTAL-CODE
  5358                            REDEFINES MA-CRED-BENE-ZIP.
  5359             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5360             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5361             20  FILLER                        PIC X(3).
  5362     12  MA-POST-CARD-MAIL-DATA.
  5363         16  MA-MAIL-DATA OCCURS 7.
  5364             20  MA-MAIL-TYPE              PIC X.
  5365                 88  MA-12MO-MAILING           VALUE '1'.
  5366                 88  MA-EXP-MAILING            VALUE '2'.
  5367             20  MA-MAIL-STATUS            PIC X.
  5368                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5369                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5370                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5371             20  MA-MAIL-DATE              PIC XX.
  5372     12  FILLER                            PIC XX.
  5373     12  FILLER                            PIC XX.
  5374*    12  FILLER                            PIC X(30).
  5375******************************************************************
  5376*                                COPY ERCARCH.
  5377******************************************************************
  5378*                                                                *
  5379*                            ERCARCH.                            *
  5380*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5381*                            VMOD=2.002                          *
  5382*                                                                *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  95
* EL6318.cbl
  5383*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  5384*                                                                *
  5385*   FILE TYPE = VSAM,KSDS                                        *
  5386*   RECORD SIZE = 250  RECFORM = FIXED                           *
  5387*                                                                *
  5388*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  5389*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  5390*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  5391*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  5392*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  5393*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  5394*                                                                *
  5395*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5396******************************************************************
  5397*                   C H A N G E   L O G
  5398*
  5399* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5400*-----------------------------------------------------------------
  5401*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5402* EFFECTIVE    NUMBER
  5403*-----------------------------------------------------------------
  5404* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  5405* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  5406* 110612    2012101700002  AJRA  ADD NEW FIELDS
  5407******************************************************************
  5408 01  LETTER-ARCHIVE.
  5409     12  LA-RECORD-ID                PIC  X(02).
  5410         88  LA-VALID-ID                VALUE 'LA'.
  5411
  5412     12  LA-CONTROL-PRIMARY.
  5413         16  LA-COMPANY-CD           PIC  X(01).
  5414         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  5415
  5416     12  LA-CONTROL-BY-CERT-RESP.
  5417         16  LA-COMPANY-CD-A2        PIC  X(01).
  5418         16  LA-CERT-NO-A2.
  5419             20  LA-CERT-PRIME-A2    PIC  X(10).
  5420             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  5421         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  5422             20  LA-RESP-PERSON-A2   PIC  X(10).
  5423             20  LA-TYPE-A2          PIC  X(01).
  5424         16  LA-CARRIER-A2           PIC  X(01).
  5425         16  LA-GROUPING-A2          PIC  X(06).
  5426         16  LA-STATE-A2             PIC  X(02).
  5427         16  LA-ACCOUNT-A2           PIC  X(10).
  5428         16  LA-EFFECT-DATE-A2       PIC  X(02).
  5429         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  5430
  5431     12  LA-CONTROL-BY-FORM.
  5432         16  LA-COMPANY-CD-A3        PIC  X(01).
  5433         16  LA-FORM-A3              PIC  X(04).
  5434         16  LA-CARRIER-A3           PIC  X(01).
  5435         16  LA-GROUPING-A3          PIC  X(06).
  5436         16  LA-STATE-A3             PIC  X(02).
  5437         16  LA-ACCOUNT-A3           PIC  X(10).
  5438         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  5439
  5440     12  LA-CONTROL-BY-PROCESSOR.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  96
* EL6318.cbl
  5441         16  LA-COMPANY-CD-A4        PIC  X(01).
  5442         16  LA-PROCESSOR-CD         PIC  X(04).
  5443         16  LA-CARRIER-A4           PIC  X(01).
  5444         16  LA-GROUPING-A4          PIC  X(06).
  5445         16  LA-STATE-A4             PIC  X(02).
  5446         16  LA-ACCOUNT-A4           PIC  X(10).
  5447         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  5448
  5449     12  LA-CONTROL-BY-KEY-FIELDS.
  5450         16  LA-COMPANY-CD-A5        PIC  X(01).
  5451         16  LA-CARRIER-A5           PIC  X(01).
  5452         16  LA-GROUPING-A5          PIC  X(06).
  5453         16  LA-STATE-A5             PIC  X(02).
  5454         16  LA-ACCOUNT-A5           PIC  X(10).
  5455         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  5456
  5457     12  LA-CONTROL-BY-GROUP-CODE.
  5458         16  LA-COMPANY-CD-A6        PIC  X(01).
  5459         16  LA-ENTRY-A6.
  5460             20  LA-FILLER           PIC  X(02).
  5461             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  5462         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  5463
  5464     12  FILLER                      PIC  X(09).
  5465
  5466     12  LA-HEADER-RECORD.
  5467         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  5468         16  LA-CREATION-DATE        PIC  X(02).
  5469         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  5470         16  LA-FINAL-ACT-DATE       REDEFINES
  5471               LA-FOLLOW-UP-DATE     PIC  X(02).
  5472         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  5473         16  LA-NO-OF-COPIES         PIC S9(01).
  5474         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  5475         16  LA-REPLY-DATE           PIC  X(02).
  5476         16  LA-RESEND-DATES.
  5477             20  LA-RESEND-DATE      PIC  X(02).
  5478             20  LA-SENT-DATE        PIC  X(02).
  5479             20  FILLER              PIC  X(08).
  5480         16  LA-SOURCE-INFORMATION.
  5481             20  LA-DATA-SOURCE      PIC  X(01).
  5482             20  LA-ADDR-SOURCE      PIC  X(01).
  5483         16  LA-STATUS               PIC  X(01).
  5484             88  LA-STATUS-ACTIVE         VALUE 'A'.
  5485             88  LA-STATUS-COMPLETED      VALUE 'C'.
  5486             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  5487             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  5488             88  LA-STATUS-PURGED         VALUE 'P'.
  5489             88  LA-STATUS-VOIDED         VALUE 'V'.
  5490         16  LA-LAST-RESENT-PRINT-DATE
  5491                                     PIC  X(02).
  5492         16  LA-PRINT-RESTRICTION    PIC  X(01).
  5493             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  5494                                          VALUE 'C'.
  5495             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  5496                                          VALUE 'F'.
  5497             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  5498                                          VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  97
* EL6318.cbl
  5499         16  LA-PURGED-DATE          PIC  X(02).
  5500         16  LA-VOIDED-DATE          PIC  X(02).
  5501         16  LA-RESEND-LETR          PIC  X(4).
  5502         16  FILLER                  PIC  X(08).
  5503*        16  LA-RESEND-LETR-2        PIC  X(4).
  5504*        16  LA-RESEND-LETR-3        PIC  X(4).
  5505*        16  FILLER                  PIC  X(59).
  5506         16  LA-ARCHIVE-STATUS       PIC  X.
  5507             88  LA-TEMP                VALUE 'T'.
  5508             88  LA-QWS                 VALUE 'Q'.
  5509             88  LA-BATCH               VALUE 'B'.
  5510         16  LA-FINAL-ACT-IND        PIC  X(1).
  5511         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  5512         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  5513         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  5514                                     PIC X(4).
  5515         16  FILLER                  PIC  X(42).
  5516*        16  FILLER                  PIC  X(71).
  5517         16  LA-LAST-MAINT-DATE      PIC  X(2).
  5518         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  5519         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  5520                                     PIC  X(4).
  5521         16  LA-LAST-UPDATED-BY      PIC  X(4).
  5522
  5523******************************************************************
  5524*                                COPY ERCCNOT.
  5525******************************************************************
  5526*                                                                *
  5527*                            ERCCNOT                             *
  5528*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5529*                            VMOD=2.003                          *
  5530*                                                                *
  5531*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  5532*                                                                *
  5533*        FILE TYPE= VSAM,KSDS                                    *
  5534*        RECORD SIZE = 150    RECFORM = FIXED                    *
  5535*                                                                *
  5536*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  5537*                                                                *
  5538*        LOG = YES                                               *
  5539*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5540*                                                                *
  5541******************************************************************
  5542*                   C H A N G E   L O G
  5543*
  5544* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5545*-----------------------------------------------------------------
  5546*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5547* EFFECTIVE    NUMBER
  5548*-----------------------------------------------------------------
  5549* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  5550******************************************************************
  5551
  5552 01  CERT-NOTE-FILE.
  5553     12  CZ-RECORD-ID                PIC  XX.
  5554         88  VALID-CZ-ID                  VALUE 'CZ'.
  5555
  5556     12  CZ-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  98
* EL6318.cbl
  5557         16  CZ-COMPANY-CD           PIC X.
  5558         16  CZ-CARRIER              PIC X.
  5559         16  CZ-GROUPING.
  5560             20 CZ-GROUPING-PREFIX   PIC XXX.
  5561             20 CZ-GROUPING-PRIME    PIC XXX.
  5562         16  CZ-STATE                PIC XX.
  5563         16  CZ-ACCOUNT.
  5564             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  5565             20 CZ-ACCOUNT-PRIME     PIC X(6).
  5566         16  CZ-CERT-EFF-DT          PIC XX.
  5567         16  CZ-CERT-NO.
  5568             20  CZ-CERT-PRIME       PIC X(10).
  5569             20  CZ-CERT-SFX         PIC X.
  5570         16  CZ-RECORD-TYPE          PIC X.
  5571             88  CERT-NOTE           VALUE '1'.
  5572             88  CLAIM-CERT-NOTE     VALUE '2'.
  5573         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  5574
  5575     12  CZ-LAST-MAINT-DT            PIC XX.
  5576     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5577     12  CZ-LAST-MAINT-USER          PIC X(4).
  5578
  5579     12  CZ-NOTE-INFORMATION.
  5580         16  CZ-NOTE                 PIC X(63).
  5581         16  FILLER                  PIC X(39).
  5582******************************************************************
  5583*                                COPY ELCEOBC.
  5584******************************************************************
  5585*                                                                *
  5586*                                                                *
  5587*                            ELCEOBC                             *
  5588*                            VMOD=2.001                          *
  5589*                                                                *
  5590*   CLAIM SYSTEM EOB CODE TABLE                                  *
  5591*                                                                *
  5592*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5593*   VSAM EOB CODE TABLE                                          *
  5594*                                                                *
  5595*   FILE DESCRIPTION = EOB CODE TABLE                            *
  5596*                                                                *
  5597*   FILE TYPE = VSAM,KSDS                                        *
  5598*   RECORD SIZE = 350   RECFORM = FIX                            *
  5599*                                                                *
  5600*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
  5601*                                                                *
  5602*   LOG = NO                                                     *
  5603*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5604*                                                                *
  5605*                                                                *
  5606******************************************************************
  5607*                   C H A N G E   L O G
  5608*
  5609* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5610*-----------------------------------------------------------------
  5611*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5612* EFFECTIVE    NUMBER
  5613*-----------------------------------------------------------------
  5614* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page  99
* EL6318.cbl
  5615* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
  5616* 091913    2013090300001  AJRA  ADDITIONAL RECORD TYPES
  5617******************************************************************
  5618 01  EOB-CODES.
  5619     12  EO-RECORD-ID                      PIC XX.
  5620         88  VALID-DN-ID                      VALUE 'EO'.
  5621     12  EO-CONTROL-PRIMARY.
  5622         16  EO-COMPANY-CD                 PIC X.
  5623         16  EO-RECORD-TYPE                PIC X.
  5624             88  EO-EOB-RECS                  VALUE '1'.
  5625             88  EO-VERIF-RECS                VALUE '2'.
  5626             88  EO-GCE-RECS                  VALUE '3'.
  5627             88  EO-CANC-RECS                 VALUE '4'.
  5628             88  EO-BILL-NOTE-RECS            VALUE '5'.
  5629         16  EO-EOB-CODE                   PIC X(4).
  5630         16  FILLER                        PIC X(9).
  5631     12  EO-MAINT-INFORMATION.
  5632         16  EO-LAST-MAINT-DT              PIC XX.
  5633         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5634         16  EO-LAST-MAINT-USER            PIC X(4).
  5635         16  FILLER                        PIC XX.
  5636     12  EO-DESCRIPTION                    PIC X(275).
  5637     12  FILLER                            PIC X(46).
  5638******************************************************************
  5639*                                COPY ELCCRTT.
  5640******************************************************************
  5641*                                                                *
  5642*                            ELCCRTT.                            *
  5643*                                                                *
  5644*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  5645*                                                                *
  5646*   FILE TYPE = VSAM,KSDS                                        *
  5647*   RECORD SIZE = 552  RECFORM = FIXED                           *
  5648*                                                                *
  5649*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  5650*                                                                *
  5651*   LOG = YES                                                    *
  5652*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5653******************************************************************
  5654*                   C H A N G E   L O G
  5655*
  5656* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5657*-----------------------------------------------------------------
  5658*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5659* EFFECTIVE    NUMBER
  5660*-----------------------------------------------------------------
  5661* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  5662* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  5663* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  5664* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5665* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5666* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5667* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5668* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  5669* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  5670******************************************************************
  5671
  5672 01  CERTIFICATE-TRAILERS.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 100
* EL6318.cbl
  5673     12  CS-RECORD-ID                      PIC XX.
  5674         88  VALID-CS-ID                      VALUE 'CS'.
  5675
  5676     12  CS-CONTROL-PRIMARY.
  5677         16  CS-COMPANY-CD                 PIC X.
  5678         16  CS-CARRIER                    PIC X.
  5679         16  CS-GROUPING                   PIC X(6).
  5680         16  CS-STATE                      PIC XX.
  5681         16  CS-ACCOUNT                    PIC X(10).
  5682         16  CS-CERT-EFF-DT                PIC XX.
  5683         16  CS-CERT-NO.
  5684             20  CS-CERT-PRIME             PIC X(10).
  5685             20  CS-CERT-SFX               PIC X.
  5686         16  CS-TRAILER-TYPE               PIC X.
  5687             88  COMM-TRLR           VALUE 'A'.
  5688             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  5689             88  CERT-DATA-TRLR      VALUE 'C'.
  5690
  5691     12  CS-DATA-AREA                      PIC X(516).
  5692
  5693     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5694         16  CS-BANK-COMMISSION-AREA.
  5695             20  CS-BANK-COMMS       OCCURS 10.
  5696                 24  CS-AGT                PIC X(10).
  5697                 24  CS-COM-TYP            PIC X.
  5698                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5699                 24  CS-RECALC-LV-INDIC    PIC X.
  5700                 24  FILLER                PIC X(10).
  5701         16  FILLER                        PIC X(256).
  5702
  5703     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  5704****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  5705         16  CS-MB-CLAIM-DATA OCCURS 24.
  5706             20  CS-CLAIM-NO               PIC X(7).
  5707             20  CS-CLAIM-TYPE             PIC X.
  5708                 88  CS-AH-CLM               VALUE 'A'.
  5709                 88  CS-IU-CLM               VALUE 'I'.
  5710                 88  CS-GP-CLM               VALUE 'G'.
  5711                 88  CS-LF-CLM               VALUE 'L'.
  5712                 88  CS-PR-CLM               VALUE 'P'.
  5713                 88  CS-FL-CLM               VALUE 'F'.
  5714             20  CS-INSURED-TYPE           PIC X.
  5715                 88  CS-PRIM-INSURED          VALUE 'P'.
  5716                 88  CS-CO-BORROWER           VALUE 'C'.
  5717             20  CS-BENEFIT-PERIOD         PIC 99.
  5718             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  5719             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  5720             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  5721         16  FILLER                        PIC X(12).
  5722     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5723         16  CS-VIN-NUMBER                 PIC X(17).
  5724         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5725         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5726         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5727         16  cs-agent-name.
  5728             20  cs-agent-fname            pic x(20).
  5729             20  cs-agent-mi               pic x.
  5730             20  cs-agent-lname            pic x(25).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 101
* EL6318.cbl
  5731         16  cs-license-no                 pic x(15).
  5732         16  cs-npn-number                 pic x(10).
  5733         16  cs-agent-edit-status          pic x.
  5734             88  cs-ae-refer-to-manager      value 'M'.
  5735             88  cs-ae-cover-sheet           value 'C'.
  5736             88  cs-ae-sig-form              value 'S'.
  5737             88  cs-ae-verified              value 'V'.
  5738             88  cs-unidentified-signature   value 'U'.
  5739             88  cs-cert-returned            value 'R'.
  5740             88  cs-accept-no-commission     value 'N'.
  5741         16  cs-year                       pic 9999.
  5742         16  cs-make                       pic x(20).
  5743         16  cs-model                      pic x(20).
  5744         16  cs-future                     pic x(20).
  5745         16  cs-vehicle-odometer           pic s9(7) comp-3.
  5746         16  FILLER                        PIC X(356). *> was 420
  5747*        16  FILLER                        PIC X(496).
  5748*                                COPY ELCENCC.
  5749******************************************************************
  5750*                                                                *
  5751*                                                                *
  5752*                            ELCENCC                             *
  5753*                            VMOD=2.001                          *
  5754*                                                                *
  5755*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  5756*                                                                *
  5757*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  5758*   A NAPERSOFT DOCUMENT                                         *
  5759*                                                                *
  5760*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  5761*                                                                *
  5762*   FILE TYPE = VSAM,KSDS                                        *
  5763*   RECORD SIZE = 400   RECFORM = FIX                            *
  5764*                                                                *
  5765*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  5766*                                                                *
  5767*   LOG = NO                                                     *
  5768*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5769*                                                                *
  5770*                                                                *
  5771******************************************************************
  5772*                   C H A N G E   L O G
  5773*
  5774* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5775*-----------------------------------------------------------------
  5776*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5777* EFFECTIVE    NUMBER
  5778*-----------------------------------------------------------------
  5779* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  5780* 061217    2017060900001  TANA  INCREASE ATTACHMENTS FIELD SIZE
  5781******************************************************************
  5782 01  ENCLOSURE-CODES.
  5783     12  NC-RECORD-ID                      PIC XX.
  5784         88  VALID-NC-ID                      VALUE 'NC'.
  5785     12  NC-CONTROL-PRIMARY.
  5786         16  NC-COMPANY-CD                 PIC X.
  5787         16  NC-REC-TYPE                   PIC X.
  5788             88  NC-CLAIMS                   VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 102
* EL6318.cbl
  5789             88  NC-ADMIN                    VALUE '2'.
  5790         16  NC-ENC-CODE                   PIC X(5).
  5791         16  FILLER                        PIC X(09).
  5792     12  NC-MAINT-INFORMATION.
  5793         16  NC-LAST-MAINT-DT              PIC XX.
  5794         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5795         16  NC-LAST-MAINT-USER            PIC X(4).
  5796         16  FILLER                        PIC XX.
  5797     12  NC-OUTPUT-STACK                   PIC XXX.
  5798     12  NC-ENCLOSURE-LINE                 PIC X(100).
  5799     12  NC-ATTACHMENTS                    PIC X(255).
  5800     12  NC-FUTURE                         PIC X(12).
  5801******************************************************************
  5802 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR
  5803                          ACCOUNT-MASTER CONTROL-FILE
  5804                          PENDING-BUSINESS CERTIFICATE-MASTER
  5805                          ORIGINAL-CERTIFICATE
  5806                          ENDORSEMENT-RECORD CERTIFICATE-NOTE
  5807                          MAILING-DATA LETTER-ARCHIVE
  5808                          CERT-NOTE-FILE EOB-CODES
  5809                          CERTIFICATE-TRAILERS ENCLOSURE-CODES.
  5810 0000-DFHEXIT SECTION.
  5811     MOVE '9#                    $   ' TO DFHEIV0.
  5812     MOVE 'EL6318' TO DFHEIV1.
  5813     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5814     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK
  5815     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  5816     MOVE '5'                    TO DC-OPTION-CODE
  5817     PERFORM 9700-DATE-LINK
  5818     MOVE DC-GREG-DATE-1-EDIT    TO WS-CURRENT-DT
  5819     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT
  5820     MOVE EIBTRMID               TO QID-TERM
  5821     MOVE 2                      TO EMI-NUMBER-OF-LINES
  5822     IF EIBCALEN = 0
  5823        GO TO 8800-UNAUTHORIZED-ACCESS
  5824     END-IF
  5825     MOVE FUNCTION LENGTH(EL631KI) TO MAP-LENGTH
  5826     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5827        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5828           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5829           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5830           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5831           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5832           MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5833           MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5834           MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5835           MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5836           MOVE LOW-VALUES           TO EL631KI
  5837           MOVE 'Y'                  TO PI-CLEAR-ERROR-SW
  5838           GO TO 0350-BUILD-INIT-MAP
  5839        END-IF
  5840     END-IF
  5841     IF PI-CALLING-PROGRAM = 'EL614'
  5842        MOVE PI-PROGRAM-WORK-AREA (1:60)
  5843                                 TO WS-PASSED-REASON-CODES
  5844        IF WS-PASSED-REASON-CODES NOT = SPACES
  5845           MOVE 'Y'                TO WS-SET-CODES-MDT
  5846        ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 103
* EL6318.cbl
  5847           MOVE 'N'                TO WS-SET-CODES-MDT
  5848        END-IF
  5849        PERFORM 0600-RECOVER-TEMP-STORAGE
  5850                                 THRU 0600-EXIT
  5851        GO TO 0350-BUILD-INIT-MAP
  5852     END-IF
  5853     IF PI-CALLING-PROGRAM = 'EL677'
  5854        move pi-el677-check-cut  to ws-el677-check-cut
  5855        move pi-el677-check-type to ws-el677-check-type
  5856        PERFORM 0600-RECOVER-TEMP-STORAGE
  5857                                 THRU 0600-EXIT
  5858        move ws-el677-check-cut  to pi-check-cut
  5859        move ws-el677-check-type to pi-check-type
  5860        GO TO 0350-BUILD-INIT-MAP
  5861     END-IF
  5862     if (eibaid = dfhclear or dfhpf23 or dfhpf24)
  5863        and (pi-check-cut = 'Y')
  5864        MOVE ER-3844             TO EMI-ERROR
  5865        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5866        GO TO 0350-BUILD-INIT-MAP
  5867     end-if
  5868     IF EIBAID = DFHCLEAR
  5869        IF PI-CLEAR-ERROR
  5870           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5871           MOVE ER-3833           TO EMI-ERROR
  5872           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5873           GO TO 0350-BUILD-INIT-MAP
  5874        ELSE
  5875           GO TO 9400-CLEAR
  5876        END-IF
  5877     END-IF
  5878     .
  5879 0200-RECEIVE.
  5880     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5881        MOVE ER-0008             TO EMI-ERROR
  5882        PERFORM 9900-ERROR-FORMAT
  5883                                 THRU 9900-EXIT
  5884        MOVE -1                  TO PFENTRL
  5885        GO TO 8100-SEND-INITIAL-MAP
  5886     END-IF
  5887
  5888* EXEC CICS RECEIVE
  5889*        MAP      (MAP-NAME)
  5890*        MAPSET   (MAPSET-NAME)
  5891*        INTO     (EL631KI)
  5892*    END-EXEC
  5893     MOVE LENGTH OF
  5894      EL631KI
  5895       TO DFHEIV11
  5896*    MOVE '8"T I  L              ''   #00005883' TO DFHEIV0
  5897     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5898     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5899     MOVE X'2020233030303035383833' TO DFHEIV0(25:11)
  5900     CALL 'kxdfhei1' USING DFHEIV0,
  5901           MAP-NAME,
  5902           EL631KI,
  5903           DFHEIV11,
  5904           MAPSET-NAME,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 104
* EL6318.cbl
  5905           DFHEIV99,
  5906           DFHEIV99
  5907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5908     IF PFENTRL = 0
  5909         GO TO 0300-CHECK-PFKEYS
  5910     END-IF
  5911     IF EIBAID NOT = DFHENTER
  5912         MOVE ER-0004            TO EMI-ERROR
  5913         GO TO 0320-INPUT-ERROR
  5914     END-IF
  5915     IF (PFENTRI NUMERIC) AND (PFENTRI > 0 AND < 25)
  5916        MOVE PF-VALUES (PFENTRI) TO EIBAID
  5917     ELSE
  5918        MOVE ER-0029            TO EMI-ERROR
  5919        GO TO 0320-INPUT-ERROR
  5920     END-IF
  5921     .
  5922 0300-CHECK-PFKEYS.
  5923     IF EIBAID = DFHPF3
  5924        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5925        PERFORM 0325-EDIT-SCREEN THRU 0325-EXIT
  5926        PERFORM 0500-CREATE-TEMP-STORAGE THRU 0500-EXIT
  5927        MOVE 'EL614'             TO PGM-NAME
  5928        MOVE PI-REASON-CODE-IND  TO WS-SAVE-REASON-CODE-IND
  5929        MOVE SPACES              TO PI-PROGRAM-WORK-AREA
  5930        move +1                  to s2
  5931        perform varying s1 from +1 by +1 until s1 > +12
  5932           if reacd-in (s1) not = spaces and low-values
  5933              move reacd-in (s1)    to pi-program-work-area (s2:4)
  5934              add +5 to s2
  5935           end-if
  5936        END-perform
  5937        MOVE WS-SAVE-REASON-CODE-IND TO PI-REASON-CODE-IND
  5938        GO TO 9300-XCTL
  5939     END-IF
  5940     IF (EIBAID = DFHPF4 OR DFHPF8)
  5941        and (vouchi = 'Y')
  5942        and (pi-check-cut not = 'Y')
  5943        MOVE ER-3845             TO EMI-ERROR
  5944        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5945        GO TO 0350-BUILD-INIT-MAP
  5946     end-if
  5947     IF EIBAID = DFHPF4 OR DFHPF8
  5948        GO TO 0360-FINALIZE
  5949     END-IF
  5950     IF (EIBAID = DFHPF5)
  5951        and (pi-endt-prm-diff > zeros)
  5952        PERFORM 0500-CREATE-TEMP-STORAGE
  5953                                 THRU 0500-EXIT
  5954        MOVE 'EL677'             TO PGM-NAME
  5955        move pi-endt-prm-diff    to pi-el677-prm-diff
  5956        move pi-endt-com-diff    to pi-el677-com-diff
  5957        move pi-check-cut        to pi-el677-check-cut
  5958        GO TO 9300-XCTL
  5959     END-IF
  5960     IF EIBAID = DFHPF23
  5961        IF PI-CLEAR-ERROR
  5962           MOVE SPACES            TO PI-CLEAR-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 105
* EL6318.cbl
  5963           MOVE ER-3833           TO EMI-ERROR
  5964           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5965           GO TO 0350-BUILD-INIT-MAP
  5966        ELSE
  5967           GO TO 8810-PF23
  5968        END-IF
  5969     END-IF
  5970     IF EIBAID = DFHPF24
  5971        IF PI-CLEAR-ERROR
  5972           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5973           MOVE ER-3833           TO EMI-ERROR
  5974           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5975           GO TO 0350-BUILD-INIT-MAP
  5976        ELSE
  5977           GO TO 9200-RETURN-MAIN-MENU
  5978        END-IF
  5979     END-IF
  5980     IF EIBAID = DFHPF12
  5981        GO TO 9500-PF12
  5982     END-IF
  5983     IF EIBAID = DFHENTER
  5984        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5985        PERFORM 0325-EDIT-SCREEN THRU 0325-EXIT
  5986        GO TO 0330-CHECK-ERRORS
  5987     END-IF
  5988     MOVE ER-0029                TO EMI-ERROR
  5989     .
  5990 0320-INPUT-ERROR.
  5991     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5992     MOVE AL-UNBON               TO PFENTRA
  5993     MOVE -1                     TO PFENTRL
  5994     GO TO 8200-SEND-DATAONLY
  5995     .
  5996 0325-EDIT-SCREEN.
  5997     IF PRTSWL > ZEROS
  5998       IF PRTSWI = 'Y' OR 'N' OR 'P' OR ' '
  5999*          MOVE AL-UANON       TO PRTSWA
  6000*          IF PRTSWI = ' '
  6001*             MOVE 'N'         TO PRTSWI
  6002              MOVE 'P'         TO PRTSWI
  6003*          END-IF
  6004*          MOVE PRTSWI         TO PI-PRTSW-ENTERED
  6005        END-IF
  6006     END-IF
  6007     IF LTRIDL > ZEROS
  6008        AND LTRIDI > SPACES
  6009        MOVE PI-COMPANY-CD       TO LETR-COMPANY-CD
  6010        MOVE LTRIDI              TO LETR-LETTER-ID
  6011                                    PI-LTRID-ENTERED
  6012        MOVE LETR-PART-KEY       TO ELLETR-SAVE-PART-KEY
  6013        MOVE SPACES              TO LETR-FILLER
  6014        MOVE 0                   TO LETR-SEQ-NO
  6015        PERFORM 0326-GET-Z-RECORD THRU 0326-EXIT
  6016     ELSE
  6017        MOVE ER-1236          TO EMI-ERROR
  6018        MOVE -1               TO LTRIDL
  6019        MOVE AL-UABON         TO LTRIDA
  6020        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 106
* EL6318.cbl
  6021                                 THRU 9900-EXIT
  6022     END-IF
  6023
  6024     IF W-SIG-FLAG-DEFAULT > ' '
  6025        IF (SIGREQL > ZERO AND SIGREQI <> W-SIG-FLAG-DEFAULT)
  6026             MOVE W-SIG-FLAG-DEFAULT TO SIGREQI
  6027             MOVE +1 TO SIGREQL
  6028             MOVE ER-1664     TO EMI-ERROR
  6029             MOVE AL-UABON    TO SIGREQA
  6030             PERFORM 9900-ERROR-FORMAT
  6031                                 THRU 9900-EXIT
  6032        ELSE
  6033             MOVE W-SIG-FLAG-DEFAULT TO SIGREQI
  6034             MOVE +1 TO SIGREQL
  6035             MOVE AL-UANON    TO SIGREQA
  6036        END-IF
  6037     END-IF
  6038
  6039     IF (SIGREQL > ZEROS)
  6040        AND (SIGREQI = 'Y' OR 'N' OR ' ')
  6041        MOVE AL-UANON         TO SIGREQA
  6042        IF SIGREQI = ' '
  6043           MOVE 'N'           TO SIGREQI
  6044        END-IF
  6045        MOVE SIGREQI          TO PI-SIGREQ-ENTERED
  6046     ELSE
  6047        MOVE ER-2651          TO EMI-ERROR
  6048        MOVE -1               TO SIGREQL
  6049        MOVE AL-UABON         TO SIGREQA
  6050        PERFORM 9900-ERROR-FORMAT
  6051                                 THRU 9900-EXIT
  6052     END-IF
  6053
  6054     IF W-PROMPT-LETTER EQUAL 'Y'
  6055         MOVE ER-0894            TO EMI-ERROR
  6056         MOVE -1                 TO LTRIDL
  6057         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6058     END-IF
  6059     IF VOUCHL > ZEROS
  6060        IF VOUCHI = 'Y' OR 'N'
  6061           MOVE AL-UANON         TO VOUCHA
  6062           MOVE VOUCHI           TO PI-VOUCHER-ENTERED
  6063        ELSE
  6064           MOVE ER-9999          TO EMI-ERROR
  6065           MOVE -1               TO VOUCHL
  6066           MOVE AL-UABON         TO VOUCHA
  6067           PERFORM 9900-ERROR-FORMAT
  6068                                 THRU 9900-EXIT
  6069        END-IF
  6070     END-IF
  6071     IF HLTHAPPL > ZEROS
  6072        IF HLTHAPPI = 'Y' OR 'N'
  6073           MOVE AL-UANON         TO HLTHAPPA
  6074           MOVE HLTHAPPI         TO PI-HLTHAPP-ENTERED
  6075        ELSE
  6076           MOVE ER-9999          TO EMI-ERROR
  6077           MOVE -1               TO HLTHAPPL
  6078           MOVE AL-UABON         TO HLTHAPPA
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 107
* EL6318.cbl
  6079           PERFORM 9900-ERROR-FORMAT
  6080                                 THRU 9900-EXIT
  6081        END-IF
  6082     END-IF
  6083     IF PAYEEL > ZEROS
  6084        IF PAYEEI > SPACES
  6085           MOVE AL-UANON         TO PAYEEA
  6086           MOVE PAYEEI           TO PI-PAYEE-ENTERED
  6087        ELSE
  6088           MOVE ER-9999          TO EMI-ERROR
  6089           MOVE -1               TO PAYEEL
  6090           MOVE AL-UABON         TO PAYEEA
  6091           PERFORM 9900-ERROR-FORMAT
  6092                                 THRU 9900-EXIT
  6093        END-IF
  6094     END-IF
  6095     IF CERTIDL > ZEROS
  6096         IF CERTIDI NUMERIC
  6097            MOVE AL-UANON      TO CERTIDA
  6098            MOVE CERTIDI       TO PI-CERTID-ENTERED
  6099         ELSE
  6100            MOVE ER-1778       TO EMI-ERROR
  6101            MOVE -1            TO CERTIDL
  6102            MOVE AL-UABON      TO CERTIDA
  6103            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6104        END-IF
  6105     ELSE
  6106        IF PI-PRINT-CERTIFICATE = 'Y'
  6107            MOVE ER-0715       TO EMI-ERROR
  6108            MOVE -1            TO CERTIDL
  6109            MOVE AL-UABON      TO CERTIDA
  6110            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6111        END-IF
  6112     END-IF
  6113
  6114     IF ENCCODEL > ZEROS
  6115        MOVE FUNCTION UPPER-CASE(ENCCODEI) TO ENCCODEI
  6116                                              PI-ENCCODE
  6117        MOVE SPACES             TO WS-ELENCC-KEY
  6118        MOVE PI-COMPANY-CD      TO WS-ENCC-COMPANY-CD
  6119        MOVE '2'                TO WS-ENCC-REC-TYPE
  6120        MOVE ENCCODEI           TO WS-ENCC-ENC-CODE
  6121
  6122
  6123* EXEC CICS READ
  6124*           DATASET    (WS-ELENCC-FILE-ID)
  6125*           SET        (ADDRESS OF ENCLOSURE-CODES)
  6126*           RIDFLD     (WS-ELENCC-KEY)
  6127*           RESP       (WS-RESPONSE)
  6128*       END-EXEC
  6129*    MOVE '&"S        E          (  N#00006102' TO DFHEIV0
  6130     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6131     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6132     MOVE X'204E233030303036313032' TO DFHEIV0(25:11)
  6133     CALL 'kxdfhei1' USING DFHEIV0,
  6134           WS-ELENCC-FILE-ID,
  6135           DFHEIV20,
  6136           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 108
* EL6318.cbl
  6137           WS-ELENCC-KEY,
  6138           DFHEIV99,
  6139           DFHEIV99,
  6140           DFHEIV99
  6141     SET ADDRESS OF ENCLOSURE-CODES TO
  6142         DFHEIV20
  6143     MOVE EIBRESP  TO WS-RESPONSE
  6144     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6145
  6146        IF RESP-NORMAL
  6147           MOVE ENCCODEI         TO PI-ENCCODE
  6148                                    W-ENCLOSURE-CD
  6149           MOVE AL-UANON         TO ENCCODEA
  6150        ELSE
  6151           MOVE ER-1560          TO EMI-ERROR
  6152           MOVE -1               TO ENCCODEL
  6153           MOVE AL-UABON         TO ENCCODEA
  6154           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6155        END-IF
  6156     END-IF
  6157
  6158     SET REASONS-NOT-FOUND TO TRUE
  6159     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6160        IF REACDL (S1) = +4 OR
  6161          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  6162              MOVE AL-SANON     TO REACDA (S1)
  6163              SET REASONS-FOUND TO TRUE
  6164        END-IF
  6165     END-PERFORM
  6166
  6167     IF REASONS-NOT-FOUND
  6168        MOVE ER-1820             TO EMI-ERROR
  6169        MOVE -1                  TO PFENTRL
  6170        PERFORM 9900-ERROR-FORMAT
  6171                                 THRU 9900-EXIT
  6172     ELSE
  6173        MOVE REASONCDS           TO PI-REASONS-ENTERED
  6174     END-IF
  6175
  6176     IF CRTNT1L > ZEROS
  6177        IF CRTNT1I > SPACES
  6178           MOVE CRTNT1I          TO PI-CERTNT1-ENTERED
  6179        END-IF
  6180     END-IF
  6181
  6182     IF CRTNT2L > ZEROS
  6183        IF CRTNT2I > SPACES
  6184           MOVE CRTNT2I          TO PI-CERTNT2-ENTERED
  6185        END-IF
  6186     END-IF
  6187
  6188     IF CRTNT3L > ZEROS
  6189        IF CRTNT3I > SPACES
  6190           MOVE CRTNT3I          TO PI-CERTNT3-ENTERED
  6191        END-IF
  6192     END-IF
  6193
  6194     IF CRTNT4L > ZEROS
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 109
* EL6318.cbl
  6195        IF CRTNT4I > SPACES
  6196           MOVE CRTNT4I          TO PI-CERTNT4-ENTERED
  6197        END-IF
  6198     END-IF
  6199
  6200     IF BILNT1L > ZEROS
  6201        IF BILNT1I > SPACES
  6202           MOVE BILNT1I          TO PI-BILLNT1-ENTERED
  6203        END-IF
  6204     END-IF
  6205
  6206     IF BILNT2L > ZEROS
  6207        IF BILNT2I > SPACES
  6208           MOVE BILNT2I          TO PI-BILLNT2-ENTERED
  6209        END-IF
  6210     END-IF
  6211
  6212     .
  6213 0325-EXIT.
  6214     EXIT.
  6215
  6216 0326-GET-Z-RECORD.
  6217
  6218     MOVE SPACES  TO W-Z-CONTROL-DATA
  6219
  6220
  6221* EXEC CICS STARTBR
  6222*         DATASET    ('ELLETR')
  6223*         RIDFLD     (ELLETR-KEY)
  6224*         GTEQ
  6225*         RESP      (WS-RESPONSE)
  6226*    END-EXEC.
  6227     MOVE 'ELLETR' TO DFHEIV1
  6228     MOVE 0
  6229       TO DFHEIV11
  6230*    MOVE '&,         G          &  N#00006183' TO DFHEIV0
  6231     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6232     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6233     MOVE X'204E233030303036313833' TO DFHEIV0(25:11)
  6234     CALL 'kxdfhei1' USING DFHEIV0,
  6235           DFHEIV1,
  6236           ELLETR-KEY,
  6237           DFHEIV99,
  6238           DFHEIV11,
  6239           DFHEIV99
  6240     MOVE EIBRESP  TO WS-RESPONSE
  6241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6242
  6243     IF NOT RESP-NORMAL
  6244         MOVE ER-1236          TO EMI-ERROR
  6245         MOVE -1               TO LTRIDL
  6246         MOVE AL-UABON         TO LTRIDA
  6247         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6248         GO TO 0326-ENDBR
  6249     END-IF.
  6250
  6251 0326-READNEXT.
  6252
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 110
* EL6318.cbl
  6253
  6254* EXEC CICS READNEXT
  6255*        DATASET   ('ELLETR')
  6256*        INTO      (TEXT-FILES)
  6257*        RIDFLD    (ELLETR-KEY)
  6258*        RESP      (WS-RESPONSE)
  6259*    END-EXEC
  6260     MOVE LENGTH OF
  6261      TEXT-FILES
  6262       TO DFHEIV12
  6263     MOVE 'ELLETR' TO DFHEIV1
  6264     MOVE 0
  6265       TO DFHEIV11
  6266*    MOVE '&.IL                  )  N#00006199' TO DFHEIV0
  6267     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6268     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6269     MOVE X'204E233030303036313939' TO DFHEIV0(25:11)
  6270     CALL 'kxdfhei1' USING DFHEIV0,
  6271           DFHEIV1,
  6272           TEXT-FILES,
  6273           DFHEIV12,
  6274           ELLETR-KEY,
  6275           DFHEIV99,
  6276           DFHEIV11,
  6277           DFHEIV99,
  6278           DFHEIV99
  6279     MOVE EIBRESP  TO WS-RESPONSE
  6280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6281     IF RESP-NORMAL
  6282        IF TX-CONTROL-PRIMARY(1:5) NOT = ELLETR-SAVE-PART-KEY
  6283           MOVE ER-1236          TO EMI-ERROR
  6284           MOVE -1               TO LTRIDL
  6285           MOVE AL-UABON         TO LTRIDA
  6286           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6287           GO TO 0326-ENDBR
  6288        END-IF
  6289
  6290        MOVE AL-UANON         TO LTRIDA
  6291        IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  6292           MOVE TX-TEXT-LINE  TO W-Z-CONTROL-DATA
  6293        ELSE
  6294           GO TO 0326-READNEXT
  6295        END-IF
  6296     ELSE
  6297        MOVE ER-1236          TO EMI-ERROR
  6298        MOVE -1               TO LTRIDL
  6299        MOVE AL-UABON         TO LTRIDA
  6300        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6301        GO TO 0326-ENDBR
  6302     END-IF.
  6303
  6304     MOVE W-PRINT-CERTIFICATE TO PI-PRINT-CERTIFICATE.
  6305     IF PI-ENCCODE NOT GREATER THAN SPACES
  6306         MOVE W-ENCLOSURE-CD            TO PI-ENCCODE
  6307                                           ENCCODEO
  6308         MOVE AL-UANON                  TO ENCCODEA
  6309         MOVE +3                        TO ENCCODEL
  6310     END-IF.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 111
* EL6318.cbl
  6311
  6312 0326-ENDBR.
  6313
  6314
  6315* EXEC CICS ENDBR
  6316*        DATASET     ('ELLETR')
  6317*    END-EXEC.
  6318     MOVE 'ELLETR' TO DFHEIV1
  6319     MOVE 0
  6320       TO DFHEIV11
  6321*    MOVE '&2                    $   #00006238' TO DFHEIV0
  6322     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6323     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6324     MOVE X'2020233030303036323338' TO DFHEIV0(25:11)
  6325     CALL 'kxdfhei1' USING DFHEIV0,
  6326           DFHEIV1,
  6327           DFHEIV11,
  6328           DFHEIV99
  6329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6330
  6331
  6332 0326-EXIT.
  6333      EXIT.
  6334 0330-CHECK-ERRORS.
  6335     IF EMI-NO-ERRORS
  6336        GO TO 0350-BUILD-INIT-MAP
  6337     ELSE
  6338        GO TO 8200-SEND-DATAONLY
  6339     END-IF
  6340     .
  6341 0330-EXIT.
  6342     EXIT.
  6343 0350-BUILD-INIT-MAP.
  6344     IF PI-RETURN-TO-PROGRAM = 'EL6314'
  6345        MOVE PI-COMPANY-CD          TO CRTO-COMPANY-CD
  6346        MOVE PI-CARRIER             TO CRTO-CARRIER
  6347        MOVE PI-GROUPING            TO CRTO-GROUPING
  6348        MOVE PI-STATE               TO CRTO-STATE
  6349        MOVE PI-ACCOUNT             TO CRTO-ACCOUNT
  6350        MOVE PI-CERT-PRIME          TO CRTO-CERT-PRIME
  6351        MOVE PI-CERT-SFX            TO CRTO-CERT-SFX
  6352        MOVE PI-CERT-EFF-DT         TO CRTO-CERT-EFF-DT
  6353        MOVE 'I'                    TO CRTO-RECORD-TYPE
  6354        MOVE ZEROS                  TO CRTO-SEQ-NO
  6355        MOVE ELCRTO-KEY             TO PI-ELCRTO-KEY
  6356                                       PI-ERENDT-KEY
  6357     END-IF
  6358     MOVE PI-CRTO-CARRIER        TO CARRO
  6359     MOVE PI-CRTO-GROUPING       TO GROUPO
  6360     MOVE PI-CRTO-STATE          TO STATEO
  6361     MOVE PI-CRTO-ACCOUNT        TO ACCTO
  6362     MOVE PI-CRTO-CERT-PRIME     TO CERTNOO
  6363     MOVE PI-CRTO-CERT-SFX       TO CRTSFXO
  6364     MOVE PI-CRTO-SEQ-NO         TO SEQNOO
  6365     MOVE PI-CRTO-CERT-EFF-DT    TO DC-BIN-DATE-1
  6366     MOVE ' '                    TO DC-OPTION-CODE
  6367     PERFORM 9700-DATE-LINK
  6368     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 112
* EL6318.cbl
  6369        MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
  6370     END-IF
  6371*     IF PI-PRTSW-ENTERED > SPACES
  6372*        MOVE PI-PRTSW-ENTERED    TO PRTSWI
  6373*        MOVE AL-UANON            TO PRTSWA
  6374*        MOVE +1                  TO PRTSWL
  6375*     END-IF
  6376
  6377     IF PI-SIGREQ-ENTERED > SPACES
  6378        MOVE PI-SIGREQ-ENTERED   TO SIGREQI
  6379        MOVE AL-UANON            TO SIGREQA
  6380        MOVE +1                  TO SIGREQL
  6381     ELSE
  6382        IF PI-CLAIM-REFORMATION
  6383            MOVE 'Y'             TO SIGREQI
  6384            MOVE AL-UANON        TO SIGREQA
  6385            MOVE +1              TO SIGREQL
  6386        END-IF
  6387     END-IF
  6388
  6389     IF PI-LTRID-ENTERED > SPACES
  6390        MOVE PI-LTRID-ENTERED    TO LTRIDI
  6391        MOVE AL-UANON            TO LTRIDA
  6392        MOVE +4                  TO LTRIDL
  6393     ELSE
  6394        IF PI-CLAIM-REFORMATION
  6395            MOVE 'CLRF'          TO LTRIDI
  6396            MOVE AL-UANON        TO LTRIDA
  6397            MOVE +4              TO LTRIDL
  6398        END-IF
  6399     END-IF
  6400
  6401     if pi-endt-prm-diff > zeros
  6402        move 'Y'                 to vouchi
  6403        MOVE AL-UANON            TO VOUCHA
  6404        MOVE +1                  TO VOUCHL
  6405     END-IF
  6406     IF PI-VOUCHER-ENTERED > SPACES
  6407        MOVE PI-VOUCHER-ENTERED  TO VOUCHI
  6408        MOVE AL-UANON            TO VOUCHA
  6409        MOVE +1                  TO VOUCHL
  6410     END-IF
  6411     IF PI-HLTHAPP-ENTERED > SPACES
  6412        MOVE PI-HLTHAPP-ENTERED  TO HLTHAPPI
  6413        MOVE AL-UANON            TO HLTHAPPA
  6414        MOVE +1                  TO HLTHAPPL
  6415     END-IF
  6416
  6417     IF PI-PAYEE-ENTERED > SPACES
  6418        MOVE PI-PAYEE-ENTERED    TO PAYEEI
  6419        MOVE AL-UANON            TO PAYEEA
  6420        MOVE +10                 TO PAYEEL
  6421     END-IF
  6422
  6423     IF PI-CERTID-ENTERED > SPACES
  6424        MOVE PI-CERTID-ENTERED   TO CERTIDI
  6425        MOVE AL-UANON            TO CERTIDA
  6426        MOVE +5                  TO CERTIDL
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 113
* EL6318.cbl
  6427     END-IF
  6428
  6429     IF PI-ENCCODE > SPACES
  6430        MOVE PI-ENCCODE          TO ENCCODEI
  6431        MOVE AL-UANON            TO ENCCODEA
  6432        MOVE +3                  TO ENCCODEL
  6433     END-IF
  6434
  6435     SET REASONS-NOT-FOUND TO TRUE
  6436     MOVE PI-REASONS-ENTERED     TO REASONCDS
  6437     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6438        IF REACDL (S1) = +4 OR
  6439          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  6440              MOVE AL-SANON      TO REACDA (S1)
  6441              MOVE +4            TO REACDL (S1)
  6442              SET REASONS-FOUND  TO TRUE
  6443        END-IF
  6444     END-PERFORM
  6445
  6446     IF REASONS-NOT-FOUND
  6447         IF PI-CLAIM-REFORMATION
  6448            MOVE 'CRNA'          TO REACD-IN (1)
  6449            MOVE AL-SANON        TO REACDA (1)
  6450            MOVE +4              TO REACDL (1)
  6451            SET REASONS-FOUND    TO TRUE
  6452        END-IF
  6453     END-IF
  6454
  6455     IF PI-CERTNT1-ENTERED > SPACES
  6456        MOVE PI-CERTNT1-ENTERED  TO CRTNT1I
  6457        MOVE AL-UANON            TO CRTNT1A
  6458        MOVE +63                 TO CRTNT1L
  6459     END-IF
  6460
  6461     IF PI-CERTNT2-ENTERED > SPACES
  6462        MOVE PI-CERTNT2-ENTERED  TO CRTNT2I
  6463        MOVE AL-UANON            TO CRTNT2A
  6464        MOVE +63                 TO CRTNT2L
  6465     END-IF
  6466
  6467     IF PI-CERTNT3-ENTERED > SPACES
  6468        MOVE PI-CERTNT3-ENTERED  TO CRTNT3I
  6469        MOVE AL-UANON            TO CRTNT3A
  6470        MOVE +63                 TO CRTNT3L
  6471     END-IF
  6472
  6473     IF PI-CERTNT4-ENTERED > SPACES
  6474        MOVE PI-CERTNT4-ENTERED  TO CRTNT4I
  6475        MOVE AL-UANON            TO CRTNT4A
  6476        MOVE +63                 TO CRTNT4L
  6477     END-IF
  6478
  6479     IF PI-BILLNT1-ENTERED > SPACES
  6480        MOVE PI-BILLNT1-ENTERED  TO BILNT1I
  6481        MOVE AL-UANON            TO BILNT1A
  6482        MOVE +63                 TO BILNT1L
  6483     END-IF
  6484
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 114
* EL6318.cbl
  6485     IF PI-BILLNT2-ENTERED > SPACES
  6486        MOVE PI-BILLNT2-ENTERED  TO BILNT2I
  6487        MOVE AL-UANON            TO BILNT2A
  6488        MOVE +63                 TO BILNT2L
  6489     END-IF
  6490
  6491     GO TO 8100-SEND-INITIAL-MAP
  6492     .
  6493 0360-FINALIZE.
  6494     set P to address of KIXSYS
  6495     CALL "getenv" using by value P returning var-ptr
  6496     if var-ptr = null then
  6497        display ' kixsys not set '
  6498     else
  6499        set address of var to var-ptr
  6500        move 0 to env-var-len
  6501        inspect var tallying env-var-len
  6502          for characters before X'00'
  6503*       DISPLAY '  KIXSYS = ' var (1:env-var-len)
  6504        unstring var (1:env-var-len) delimited by '/'
  6505           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  6506              WS-KIX-SYS
  6507        end-unstring
  6508*       DISPLAY ' WS KIX SYS ' WS-KIXSYS
  6509*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  6510     end-if
  6511     set P to address of KIXHOST
  6512     CALL "getenv" using by value P returning var-ptr
  6513     if var-ptr = null then
  6514        display ' kixhost not set '
  6515     else
  6516        set address of var to var-ptr
  6517        move 0 to env-var-len
  6518        inspect var tallying env-var-len
  6519          for characters before X'00'
  6520*       DISPLAY '  KIXHOST = ' var (1:env-var-len)
  6521        MOVE var(1:env-var-len)  to ws-kixhost
  6522        DISPLAY ' WS KIX HOST ' WS-KIXhost
  6523     end-if
  6524     PERFORM 0325-EDIT-SCREEN    THRU 0325-EXIT
  6525     IF NOT EMI-NO-ERRORS
  6526       AND EIBAID = DFHPF4
  6527        GO TO 8200-SEND-DATAONLY
  6528     END-IF
  6529     MOVE LOW-VALUES             TO NEW-ELCRTO-REC
  6530     MOVE PI-ELCRTO-KEY          TO ELCRTO-KEY
  6531                                    NEW-ELCRTO-KEY
  6532     SUBTRACT +1               FROM NCRTO-SEQ-NO
  6533     PERFORM 0362-READ-ELCRTO    THRU 0362-EXIT
  6534     IF RESP-NORMAL
  6535       AND (PI-ELCRTO-KEY (1:33) = OC-CONTROL-PRIMARY (1:33))
  6536        MOVE OC-KEY-SEQ-NO       TO CRTO-SEQ-NO
  6537                                    PI-CRTO-SEQ-NO
  6538        MOVE LOW-VALUES          TO NEW-ELCRTO-REC
  6539        MOVE PI-ELCRTO-KEY       TO NEW-ELCRTO-KEY
  6540        SUBTRACT +1              FROM NCRTO-SEQ-NO
  6541        PERFORM 0400-ADD-ERENDT  THRU 0400-EXIT
  6542*       PERFORM 1000-BUILD-ERARCH THRU 1000-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 115
* EL6318.cbl
  6543        PERFORM 1100-CALL-NS-BUS-LOGIC
  6544                                 THRU 1100-EXIT
  6545        IF BL-OK
  6546           CONTINUE
  6547        ELSE
  6548           MOVE ER-8888          TO EMI-ERROR-NUMBER (1)
  6549           MOVE BL-MESSAGE       TO EMI-ERROR-TEXT (1)
  6550           MOVE -1               TO SIGREQL
  6551        END-IF
  6552     ELSE
  6553        MOVE ER-9999             TO EMI-ERROR
  6554        PERFORM 9900-ERROR-FORMAT
  6555                                 THRU 9900-EXIT
  6556        MOVE -1                  TO SIGREQL
  6557        GO TO 8100-SEND-INITIAL-MAP
  6558     END-IF
  6559     MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
  6560                                 TO SYSO
  6561     MOVE WS-KIXHOST             TO HOSTO
  6562     MOVE PI-COMPANY-ID          TO COMPANYO
  6563     IF PI-RETURN-TO-PROGRAM = 'EL6314'
  6564         MOVE '2'                TO DATASORO
  6565     ELSE
  6566         MOVE '4'                TO DATASORO
  6567     END-IF
  6568     MOVE BL-BATCH-NO            TO BATCHNOO
  6569     MOVE BL-BATCH-SEQ           TO BSEQNOO
  6570     MOVE BL-ARCHIVE-NO          TO ARCHNOO
  6571     MOVE PI-PROCESSOR-ID        TO PROCIDO
  6572*    MOVE 'N'                    TO PRTSWO
  6573*    MOVE -1                     TO PRTSWL
  6574*    MOVE AL-UANON               TO PRTSWA
  6575     MOVE -1                     TO SIGREQL
  6576     MOVE AL-UANON               TO SIGREQA
  6577     IF EIBAID = DFHPF4
  6578        MOVE SPACES              TO PI-CLEAR-ERROR-SW
  6579        MOVE ER-0280             TO EMI-ERROR
  6580        PERFORM 9900-ERROR-FORMAT
  6581                                 THRU 9900-EXIT
  6582        MOVE BL-ARCHIVE-NO       TO W-ARCH-SUPPRESS
  6583        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  6584        MOVE 'Y'                 TO PI-FINALIZED-IND
  6585        GO TO 9400-CLEAR
  6586     ELSE
  6587        MOVE ER-1818             TO EMI-ERROR
  6588        PERFORM 9900-ERROR-FORMAT
  6589                                 THRU 9900-EXIT
  6590     END-IF
  6591     GO TO 0350-BUILD-INIT-MAP
  6592     .
  6593 0360-EXIT.
  6594     EXIT.
  6595 0362-READ-ELCRTO.
  6596
  6597* EXEC CICS READ
  6598*        DATASET   (WS-ELCRTO-FILE-ID)
  6599*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  6600*        RIDFLD    (ELCRTO-KEY)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 116
* EL6318.cbl
  6601*        GTEQ
  6602*        RESP      (WS-RESPONSE)
  6603*    END-EXEC
  6604*    MOVE '&"S        G          (  N#00006506' TO DFHEIV0
  6605     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  6606     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6607     MOVE X'204E233030303036353036' TO DFHEIV0(25:11)
  6608     CALL 'kxdfhei1' USING DFHEIV0,
  6609           WS-ELCRTO-FILE-ID,
  6610           DFHEIV20,
  6611           DFHEIV99,
  6612           ELCRTO-KEY,
  6613           DFHEIV99,
  6614           DFHEIV99,
  6615           DFHEIV99
  6616     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  6617         DFHEIV20
  6618     MOVE EIBRESP  TO WS-RESPONSE
  6619     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6620     .
  6621 0362-EXIT.
  6622     EXIT.
  6623 0363-READ-ELCRTO-UPD.
  6624
  6625* EXEC CICS READ
  6626*        DATASET   (WS-ELCRTO-FILE-ID)
  6627*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  6628*        RIDFLD    (ELCRTO-KEY)
  6629*        UPDATE
  6630*        RESP      (WS-RESPONSE)
  6631*    END-EXEC
  6632*    MOVE '&"S        EU         (  N#00006517' TO DFHEIV0
  6633     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6634     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6635     MOVE X'204E233030303036353137' TO DFHEIV0(25:11)
  6636     CALL 'kxdfhei1' USING DFHEIV0,
  6637           WS-ELCRTO-FILE-ID,
  6638           DFHEIV20,
  6639           DFHEIV99,
  6640           ELCRTO-KEY,
  6641           DFHEIV99,
  6642           DFHEIV99,
  6643           DFHEIV99
  6644     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  6645         DFHEIV20
  6646     MOVE EIBRESP  TO WS-RESPONSE
  6647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6648     .
  6649 0363-EXIT.
  6650     EXIT.
  6651 0365-READ-ERENDT.
  6652
  6653* EXEC CICS READ
  6654*        DATASET   (WS-ERENDT-FILE-ID)
  6655*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
  6656*        RIDFLD    (ERENDT-KEY)
  6657*        RESP      (WS-RESPONSE)
  6658*    END-EXEC
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 117
* EL6318.cbl
  6659*    MOVE '&"S        E          (  N#00006528' TO DFHEIV0
  6660     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6661     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6662     MOVE X'204E233030303036353238' TO DFHEIV0(25:11)
  6663     CALL 'kxdfhei1' USING DFHEIV0,
  6664           WS-ERENDT-FILE-ID,
  6665           DFHEIV20,
  6666           DFHEIV99,
  6667           ERENDT-KEY,
  6668           DFHEIV99,
  6669           DFHEIV99,
  6670           DFHEIV99
  6671     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6672         DFHEIV20
  6673     MOVE EIBRESP  TO WS-RESPONSE
  6674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6675     .
  6676 0365-EXIT.
  6677     EXIT.
  6678 0400-ADD-ERENDT.
  6679     PERFORM 1500-GET-ARCH-NO    THRU 1500-EXIT
  6680
  6681* EXEC CICS GETMAIN
  6682*         SET      (ADDRESS OF ENDORSEMENT-RECORD)
  6683*         LENGTH   (ERENDT-LENGTH)
  6684*         INITIMG  (GETMAIN-SPACE)
  6685*    END-EXEC
  6686*    MOVE ',"IL                  $   #00006539' TO DFHEIV0
  6687     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6688     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6689     MOVE X'2020233030303036353339' TO DFHEIV0(25:11)
  6690     CALL 'kxdfhei1' USING DFHEIV0,
  6691           DFHEIV20,
  6692           ERENDT-LENGTH,
  6693           GETMAIN-SPACE
  6694     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6695         DFHEIV20
  6696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6697     PERFORM 0410-INIT-ERENDT    THRU 0410-EXIT
  6698     MOVE PI-PROCESSOR-ID        TO EN-LAST-MAINT-BY
  6699     MOVE EIBTIME                TO EN-LAST-MAINT-HHMMSS
  6700     MOVE WS-CURRENT-BIN-DT      TO EN-LAST-MAINT-DT
  6701                                    EN-INPUT-DT
  6702                                    EN-PROCESS-DT
  6703
  6704     MOVE OC-INS-FIRST-NAME    TO EN-INS-ORIG-FIRST-NAME
  6705     MOVE OC-INS-MIDDLE-INIT   TO EN-INS-ORIG-MIDDLE-INIT
  6706     MOVE OC-INS-LAST-NAME     TO EN-INS-ORIG-LAST-NAME
  6707     MOVE OC-INS-AGE           TO EN-INS-ORIG-AGE
  6708     MOVE OC-INS-AGE-DEFAULT-FLAG TO EN-INS-ORIG-AGE-DEF-FLAG
  6709     MOVE OC-JNT-FIRST-NAME    TO EN-JNT-ORIG-FIRST-NAME
  6710     MOVE OC-JNT-MIDDLE-INIT   TO EN-JNT-ORIG-MIDDLE-INIT
  6711     MOVE OC-JNT-LAST-NAME     TO EN-JNT-ORIG-LAST-NAME
  6712     MOVE OC-JNT-AGE           TO EN-JNT-ORIG-AGE
  6713     MOVE OC-JNT-AGE-DEFAULT-FLAG TO EN-JNT-ORIG-AGE-DEF-FLAG
  6714     MOVE OC-LF-BENCD          TO EN-LF-ORIG-BENCD
  6715     IF OC-LF-BENCD NOT = '00' AND '  '
  6716        MOVE OC-LF-BEN-AMT       TO EN-LF-ORIG-BEN-AMT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 118
* EL6318.cbl
  6717        MOVE OC-LF-PRM-AMT       TO EN-LF-ORIG-PRM-AMT
  6718        MOVE OC-LF-ALT-BEN-AMT   TO EN-LF-ORIG-ALT-BEN-AMT
  6719        MOVE OC-LF-ALT-PRM-AMT   TO EN-LF-ORIG-ALT-PRM-AMT
  6720        MOVE OC-LF-TERM          TO EN-LF-ORIG-TERM
  6721        MOVE OC-LF-EXP-DT        TO EN-LF-ORIG-EXP-DT
  6722        MOVE OC-LF-COMM-PCT      TO EN-LF-ORIG-COMM-PCT
  6723     END-IF
  6724     MOVE OC-AH-BENCD          TO EN-AH-ORIG-BENCD
  6725     IF OC-AH-BENCD NOT = '00' AND '  '
  6726        MOVE OC-AH-BEN-AMT       TO EN-AH-ORIG-BEN-AMT
  6727        MOVE OC-AH-PRM-AMT       TO EN-AH-ORIG-PRM-AMT
  6728        MOVE OC-AH-TERM          TO EN-AH-ORIG-TERM
  6729        MOVE OC-AH-EXP-DT        TO EN-AH-ORIG-EXP-DT
  6730        MOVE OC-AH-CP            TO EN-AH-ORIG-CP
  6731        MOVE OC-AH-COMM-PCT      TO EN-AH-ORIG-COMM-PCT
  6732     END-IF
  6733     MOVE OC-CRED-BENE-NAME      TO EN-ORIG-CRED-BENE
  6734
  6735     IF PI-RETURN-TO-PROGRAM EQUAL 'EL6314'
  6736
  6737         MOVE PI-COMPANY-CD       TO  W-CERT-COMPANY-CD
  6738         MOVE PI-CRTO-CARRIER     TO  W-CERT-CARRIER
  6739         MOVE PI-CRTO-GROUPING    TO  W-CERT-GROUPING
  6740         MOVE PI-CRTO-STATE       TO  W-CERT-STATE
  6741         MOVE PI-CRTO-ACCOUNT     TO  W-CERT-ACCOUNT
  6742         MOVE PI-CRTO-CERT-EFF-DT TO  W-CERT-CERT-EFF-DT
  6743         MOVE PI-CRTO-CERT-PRIME  TO  W-CERT-CERT-PRIME
  6744         MOVE PI-CRTO-CERT-SFX    TO  W-CERT-CERT-SFX
  6745
  6746
  6747* EXEC CICS READ
  6748*            DATASET  (WS-ELCERT-FILE-ID)
  6749*            RIDFLD   (WS-ELCERT-KEY)
  6750*            SET      (ADDRESS OF CERTIFICATE-MASTER)
  6751*            RESP     (WS-RESPONSE)
  6752*        END-EXEC
  6753*    MOVE '&"S        E          (  N#00006593' TO DFHEIV0
  6754     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6755     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6756     MOVE X'204E233030303036353933' TO DFHEIV0(25:11)
  6757     CALL 'kxdfhei1' USING DFHEIV0,
  6758           WS-ELCERT-FILE-ID,
  6759           DFHEIV20,
  6760           DFHEIV99,
  6761           WS-ELCERT-KEY,
  6762           DFHEIV99,
  6763           DFHEIV99,
  6764           DFHEIV99
  6765     SET ADDRESS OF CERTIFICATE-MASTER TO
  6766         DFHEIV20
  6767     MOVE EIBRESP  TO WS-RESPONSE
  6768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6769         IF NOT RESP-NORMAL
  6770            GO TO 0400-EXIT
  6771         END-IF
  6772
  6773         MOVE CM-INSURED-FIRST-NAME TO EN-INS-NEW-FIRST-NAME
  6774                                       NCRTO-INS-FIRST-NAME
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 119
* EL6318.cbl
  6775         MOVE CM-INSURED-INITIAL2   TO EN-INS-NEW-MIDDLE-INIT
  6776                                       NCRTO-INS-MIDDLE-INIT
  6777         MOVE CM-INSURED-LAST-NAME  TO EN-INS-NEW-LAST-NAME
  6778                                       NCRTO-INS-LAST-NAME
  6779         MOVE CM-INSURED-ISSUE-AGE  TO EN-INS-NEW-AGE
  6780                                       NCRTO-INS-AGE
  6781         MOVE CM-JT-FIRST-NAME      TO EN-JNT-NEW-FIRST-NAME
  6782                                       NCRTO-JNT-FIRST-NAME
  6783         MOVE CM-JT-INITIAL         TO EN-JNT-NEW-MIDDLE-INIT
  6784                                       NCRTO-JNT-MIDDLE-INIT
  6785         MOVE CM-JT-LAST-NAME       TO EN-JNT-NEW-LAST-NAME
  6786                                       NCRTO-JNT-LAST-NAME
  6787         MOVE CM-INSURED-JOINT-AGE  TO EN-JNT-NEW-AGE
  6788                                       NCRTO-JNT-AGE
  6789
  6790         MOVE CM-LF-BENEFIT-CD      TO EN-LF-NEW-BENCD
  6791                                       NCRTO-LF-BENCD
  6792         IF CM-LF-BENEFIT-CD NOT = '00' AND '  '
  6793            MOVE CM-LF-BENEFIT-AMT  TO EN-LF-NEW-BEN-AMT
  6794                                       NCRTO-LF-BEN-AMT
  6795            MOVE CM-LF-PREMIUM-AMT  TO EN-LF-NEW-PRM-AMT
  6796                                       NCRTO-LF-PRM-AMT
  6797            MOVE CM-LF-ALT-BENEFIT-AMT TO EN-LF-NEW-ALT-BEN-AMT
  6798                                       NCRTO-LF-ALT-BEN-AMT
  6799            MOVE CM-LF-ALT-PREMIUM-AMT TO EN-LF-NEW-ALT-PRM-AMT
  6800                                       NCRTO-LF-ALT-PRM-AMT
  6801            MOVE CM-LF-ORIG-TERM    TO EN-LF-NEW-TERM
  6802                                       NCRTO-LF-TERM
  6803            MOVE CM-LF-LOAN-EXPIRE-DT TO EN-LF-NEW-EXP-DT
  6804                                       NCRTO-LF-EXP-DT
  6805            MOVE CM-LIFE-COMM-PCT   TO EN-LF-NEW-COMM-PCT
  6806                                       NCRTO-LF-COMM-PCT
  6807         END-IF
  6808
  6809         MOVE CM-AH-BENEFIT-CD      TO EN-AH-NEW-BENCD
  6810                                       NCRTO-AH-BENCD
  6811         IF CM-AH-BENEFIT-CD NOT = '00' AND '  '
  6812            MOVE CM-AH-BENEFIT-AMT  TO EN-AH-NEW-BEN-AMT
  6813                                       NCRTO-AH-BEN-AMT
  6814            MOVE CM-AH-PREMIUM-AMT  TO EN-AH-NEW-PRM-AMT
  6815                                       NCRTO-AH-PRM-AMT
  6816            MOVE CM-AH-ORIG-TERM    TO EN-AH-NEW-TERM
  6817                                       NCRTO-AH-TERM
  6818            MOVE CM-AH-LOAN-EXPIRE-DT TO EN-AH-NEW-EXP-DT
  6819                                       NCRTO-AH-EXP-DT
  6820            MOVE CM-AH-CRITICAL-PERIOD TO EN-AH-NEW-CP
  6821                                       NCRTO-AH-CP
  6822            MOVE CM-AH-COMM-PCT     TO EN-AH-NEW-COMM-PCT
  6823                                       NCRTO-AH-COMM-PCT
  6824         END-IF
  6825
  6826         MOVE CM-LOAN-1ST-PMT-DT    TO NCRTO-1ST-PMT-DT
  6827         MOVE CM-ENTRY-BATCH        TO EN-BATCH-NUMBER
  6828
  6829         GO TO 0400-CONTINUE
  6830     END-IF.
  6831
  6832
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 120
* EL6318.cbl
  6833* EXEC CICS GETMAIN
  6834*         SET      (ADDRESS OF PENDING-BUSINESS)
  6835*         LENGTH   (ERPNDB-LENGTH)
  6836*         INITIMG  (GETMAIN-SPACE)
  6837*    END-EXEC
  6838*    MOVE ',"IL                  $   #00006662' TO DFHEIV0
  6839     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6840     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6841     MOVE X'2020233030303036363632' TO DFHEIV0(25:11)
  6842     CALL 'kxdfhei1' USING DFHEIV0,
  6843           DFHEIV20,
  6844           ERPNDB-LENGTH,
  6845           GETMAIN-SPACE
  6846     SET ADDRESS OF PENDING-BUSINESS TO
  6847         DFHEIV20
  6848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6849     MOVE PI-ERPNDB-KEY          TO ERPNDB-KEY
  6850
  6851* EXEC CICS READ
  6852*        DATASET   (WS-ERPNDB-FILE-ID)
  6853*        INTO      (PENDING-BUSINESS)
  6854*        RIDFLD    (ERPNDB-KEY)
  6855*        RESP      (WS-RESPONSE)
  6856*    END-EXEC
  6857     MOVE LENGTH OF
  6858      PENDING-BUSINESS
  6859       TO DFHEIV11
  6860*    MOVE '&"IL       E          (  N#00006668' TO DFHEIV0
  6861     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6862     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6863     MOVE X'204E233030303036363638' TO DFHEIV0(25:11)
  6864     CALL 'kxdfhei1' USING DFHEIV0,
  6865           WS-ERPNDB-FILE-ID,
  6866           PENDING-BUSINESS,
  6867           DFHEIV11,
  6868           ERPNDB-KEY,
  6869           DFHEIV99,
  6870           DFHEIV99,
  6871           DFHEIV99
  6872     MOVE EIBRESP  TO WS-RESPONSE
  6873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6874     IF NOT RESP-NORMAL
  6875        GO TO 0400-EXIT
  6876     END-IF
  6877*    set found-pndb to true
  6878     MOVE PB-I-INSURED-FIRST-NAME  TO EN-INS-NEW-FIRST-NAME
  6879                                      NCRTO-INS-FIRST-NAME
  6880     MOVE PB-I-INSURED-MIDDLE-INIT TO EN-INS-NEW-MIDDLE-INIT
  6881                                      NCRTO-INS-MIDDLE-INIT
  6882     MOVE PB-I-INSURED-LAST-NAME   TO EN-INS-NEW-LAST-NAME
  6883                                      NCRTO-INS-LAST-NAME
  6884     MOVE PB-I-AGE                 TO EN-INS-NEW-AGE
  6885                                      NCRTO-INS-AGE
  6886     MOVE PB-I-JOINT-FIRST-NAME    TO EN-JNT-NEW-FIRST-NAME
  6887                                      NCRTO-JNT-FIRST-NAME
  6888     MOVE PB-I-JOINT-MIDDLE-INIT   TO EN-JNT-NEW-MIDDLE-INIT
  6889                                      NCRTO-JNT-MIDDLE-INIT
  6890     MOVE PB-I-JOINT-LAST-NAME     TO EN-JNT-NEW-LAST-NAME
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 121
* EL6318.cbl
  6891                                      NCRTO-JNT-LAST-NAME
  6892     MOVE PB-I-JOINT-AGE           TO EN-JNT-NEW-AGE
  6893                                      NCRTO-JNT-AGE
  6894     MOVE PB-I-LF-BENEFIT-CD       TO EN-LF-NEW-BENCD
  6895                                      NCRTO-LF-BENCD
  6896     IF PB-I-LF-BENEFIT-CD NOT = '00' AND '  '
  6897        MOVE PB-I-LF-BENEFIT-AMT   TO EN-LF-NEW-BEN-AMT
  6898                                      NCRTO-LF-BEN-AMT
  6899        MOVE PB-I-LF-PREMIUM-AMT   TO EN-LF-NEW-PRM-AMT
  6900                                      NCRTO-LF-PRM-AMT
  6901        MOVE PB-I-LF-ALT-BENEFIT-AMT TO EN-LF-NEW-ALT-BEN-AMT
  6902                                      NCRTO-LF-ALT-BEN-AMT
  6903        MOVE PB-I-LF-ALT-PREMIUM-AMT TO EN-LF-NEW-ALT-PRM-AMT
  6904                                      NCRTO-LF-ALT-PRM-AMT
  6905        MOVE PB-I-LF-TERM          TO EN-LF-NEW-TERM
  6906                                      NCRTO-LF-TERM
  6907        MOVE PB-I-LF-EXPIRE-DT     TO EN-LF-NEW-EXP-DT
  6908                                      NCRTO-LF-EXP-DT
  6909        IF PB-I-JOINT-COMMISSION > +0
  6910           MOVE PB-I-JOINT-COMMISSION
  6911                                   TO EN-LF-NEW-COMM-PCT
  6912                                      NCRTO-LF-COMM-PCT
  6913        ELSE
  6914           MOVE PB-I-LIFE-COMMISSION
  6915                                   TO EN-LF-NEW-COMM-PCT
  6916                                      NCRTO-LF-COMM-PCT
  6917        END-IF
  6918     END-IF
  6919     MOVE PB-I-AH-BENEFIT-CD       TO EN-AH-NEW-BENCD
  6920                                      NCRTO-AH-BENCD
  6921     IF PB-I-AH-BENEFIT-CD NOT = '00' AND '  '
  6922        MOVE PB-I-AH-BENEFIT-AMT   TO EN-AH-NEW-BEN-AMT
  6923                                      NCRTO-AH-BEN-AMT
  6924        MOVE PB-I-AH-PREMIUM-AMT   TO EN-AH-NEW-PRM-AMT
  6925                                      NCRTO-AH-PRM-AMT
  6926        MOVE PB-I-AH-TERM          TO EN-AH-NEW-TERM
  6927                                      NCRTO-AH-TERM
  6928        MOVE PB-I-AH-EXPIRE-DT     TO EN-AH-NEW-EXP-DT
  6929                                      NCRTO-AH-EXP-DT
  6930        MOVE PB-I-AH-CRIT-PER      TO EN-AH-NEW-CP
  6931                                      NCRTO-AH-CP
  6932        MOVE PB-I-AH-COMMISSION    TO EN-AH-NEW-COMM-PCT
  6933                                      NCRTO-AH-COMM-PCT
  6934     END-IF
  6935     MOVE PB-I-1ST-PMT-DT          TO NCRTO-1ST-PMT-DT
  6936     MOVE PB-ENTRY-BATCH           TO EN-BATCH-NUMBER
  6937     .
  6938 0400-CONTINUE.
  6939
  6940     MOVE W-ACCT-SUMM              TO EN-ACCT-SUMM
  6941     MOVE W-CSO-SUMM               TO EN-CSO-SUMM
  6942*     PERFORM 0450-GET-ERACCT     THRU 0450-EXIT
  6943     MOVE 'Y'                    TO EN-COMM-CHGBK
  6944
  6945     COMPUTE WS-DUE-BORROWER = (EN-LF-ORIG-PRM-AMT
  6946        + EN-LF-ORIG-ALT-PRM-AMT + EN-AH-ORIG-PRM-AMT) -
  6947        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT +
  6948        EN-AH-NEW-PRM-AMT)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 122
* EL6318.cbl
  6949     COMPUTE EN-ACCT-PORTION ROUNDED =
  6950        (((EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT) -
  6951        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT))
  6952        * EN-LF-NEW-COMM-PCT)
  6953                       +
  6954        ((EN-AH-ORIG-PRM-AMT - EN-AH-NEW-PRM-AMT)
  6955        * EN-AH-NEW-COMM-PCT)
  6956     COMPUTE EN-CSO-PORTION = WS-DUE-BORROWER -
  6957        EN-ACCT-PORTION
  6958     IF PI-RETURN-TO-PROGRAM = 'EL6314'
  6959         MOVE CM-CONTROL-PRIMARY TO WS-ERMAIL-KEY
  6960     ELSE
  6961     move pb-control-by-account (1:33)
  6962                                 to ws-ermail-key
  6963     END-IF
  6964
  6965
  6966* EXEC CICS READ
  6967*        DATASET   ('ERMAIL')
  6968*        SET       (ADDRESS OF MAILING-DATA)
  6969*        RIDFLD    (WS-ERMAIL-KEY)
  6970*        RESP      (WS-RESPONSE)
  6971*    END-EXEC
  6972     MOVE 'ERMAIL' TO DFHEIV1
  6973*    MOVE '&"S        E          (  N#00006765' TO DFHEIV0
  6974     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6975     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6976     MOVE X'204E233030303036373635' TO DFHEIV0(25:11)
  6977     CALL 'kxdfhei1' USING DFHEIV0,
  6978           DFHEIV1,
  6979           DFHEIV20,
  6980           DFHEIV99,
  6981           WS-ERMAIL-KEY,
  6982           DFHEIV99,
  6983           DFHEIV99,
  6984           DFHEIV99
  6985     SET ADDRESS OF MAILING-DATA TO
  6986         DFHEIV20
  6987     MOVE EIBRESP  TO WS-RESPONSE
  6988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6989     IF RESP-NORMAL
  6990        MOVE MA-CRED-BENE-NAME   TO EN-NEW-CRED-BENE
  6991                                    NCRTO-CRED-BENE-NAME
  6992     ELSE
  6993        DISPLAY ' ERMAIL READ ' WS-RESPONSE
  6994     END-IF
  6995
  6996     IF PI-RETURN-TO-PROGRAM = 'EL6314'
  6997         MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
  6998     ELSE
  6999     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
  7000     END-IF
  7001
  7002     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
  7003
  7004
  7005* EXEC CICS READ
  7006*         DATASET  (WS-ELCRTT-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 123
* EL6318.cbl
  7007*         RIDFLD   (WS-ELCRTT-KEY)
  7008*         SET      (ADDRESS OF CERTIFICATE-TRAILERS)
  7009*         RESP     (WS-RESPONSE)
  7010*    END-EXEC
  7011*    MOVE '&"S        E          (  N#00006786' TO DFHEIV0
  7012     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7013     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7014     MOVE X'204E233030303036373836' TO DFHEIV0(25:11)
  7015     CALL 'kxdfhei1' USING DFHEIV0,
  7016           WS-ELCRTT-FILE-ID,
  7017           DFHEIV20,
  7018           DFHEIV99,
  7019           WS-ELCRTT-KEY,
  7020           DFHEIV99,
  7021           DFHEIV99,
  7022           DFHEIV99
  7023     SET ADDRESS OF CERTIFICATE-TRAILERS TO
  7024         DFHEIV20
  7025     MOVE EIBRESP  TO WS-RESPONSE
  7026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7027
  7028     IF RESP-NORMAL
  7029        MOVE CS-INS-AGE-DEFAULT-FLAG TO EN-INS-NEW-AGE-DEF-FLAG
  7030                                     NCRTO-INS-AGE-DEFAULT-FLAG
  7031        MOVE CS-JNT-AGE-DEFAULT-FLAG TO EN-JNT-NEW-AGE-DEF-FLAG
  7032                                     NCRTO-JNT-AGE-DEFAULT-FLAG
  7033     END-IF.
  7034     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  7035        IF REACD-IN (S1) NOT = LOW-VALUES
  7036           MOVE REACD-IN (S1)    TO EN-REASON-CODE (S1)
  7037        END-IF
  7038     END-PERFORM
  7039     MOVE LTRIDI                 TO EN-TEMPLATE-USED
  7040     MOVE 'G'                    TO EN-DOCU-TYPE
  7041     MOVE 'Y'                    TO EN-MONEY-SW
  7042     MOVE SIGREQI                TO EN-SIG-SW
  7043     MOVE VOUCHI                 TO EN-VOUCHER-SW
  7044     MOVE PAYEEI                 TO EN-PAYEE
  7045     MOVE HLTHAPPI               TO EN-HEALTH-APP
  7046     if pi-check-cut = 'Y' and pi-check-type = 'C'
  7047        move 'C'                 to en-check-type
  7048     end-if
  7049     PERFORM 0430-WRITE-ERENDT   THRU 0430-EXIT
  7050     .
  7051 0400-EXIT.
  7052     EXIT.
  7053 0410-INIT-ERENDT.
  7054     MOVE OC-CONTROL-PRIMARY     TO ERENDT-KEY
  7055     MOVE ZEROS                  TO ENDT-SEQ-NO
  7056
  7057* EXEC CICS READ
  7058*        DATASET    (WS-ERENDT-FILE-ID)
  7059*        RIDFLD     (ERENDT-KEY)
  7060*        INTO       (ENDORSEMENT-RECORD)
  7061*        RESP       (WS-RESPONSE)
  7062*        GTEQ
  7063*    END-EXEC
  7064     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 124
* EL6318.cbl
  7065      ENDORSEMENT-RECORD
  7066       TO DFHEIV11
  7067*    MOVE '&"IL       G          (  N#00006821' TO DFHEIV0
  7068     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  7069     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7070     MOVE X'204E233030303036383231' TO DFHEIV0(25:11)
  7071     CALL 'kxdfhei1' USING DFHEIV0,
  7072           WS-ERENDT-FILE-ID,
  7073           ENDORSEMENT-RECORD,
  7074           DFHEIV11,
  7075           ERENDT-KEY,
  7076           DFHEIV99,
  7077           DFHEIV99,
  7078           DFHEIV99
  7079     MOVE EIBRESP  TO WS-RESPONSE
  7080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7081     IF RESP-NORMAL
  7082        AND (EN-CONTROL-PRIMARY (1:34) =
  7083           OC-CONTROL-PRIMARY (1:34))
  7084        COMPUTE WS-SEQ-NO = EN-SEQ-NO - +1
  7085     ELSE
  7086        MOVE +4096               TO WS-SEQ-NO
  7087     END-IF
  7088     MOVE 'EN'                   TO ENDORSEMENT-RECORD
  7089     MOVE OC-CONTROL-PRIMARY     TO EN-CONTROL-PRIMARY
  7090     MOVE EN-COMPANY-CD          TO EN-COMPANY-CD-A1
  7091     MOVE WS-SEQ-NO              TO EN-SEQ-NO
  7092     INITIALIZE EN-ISSUE-RECORD
  7093     MOVE LOW-VALUES             TO EN-LF-ORIG-EXP-DT
  7094                                    EN-AH-ORIG-EXP-DT
  7095                                    EN-LF-NEW-EXP-DT
  7096                                    EN-AH-NEW-EXP-DT
  7097                                    EN-PROCESS-DT
  7098     .
  7099 0410-EXIT.
  7100     EXIT.
  7101 0420-UPDATE-ELCRTO.
  7102     PERFORM 0363-READ-ELCRTO-UPD THRU 0363-EXIT
  7103     IF RESP-NORMAL
  7104        MOVE WS-CURRENT-BIN-DT   TO OC-ENDORSEMENT-PROCESSED-DT
  7105                                    OC-LAST-MAINT-DT
  7106        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
  7107        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
  7108
  7109* EXEC CICS REWRITE
  7110*          FROM     (ORIGINAL-CERTIFICATE)
  7111*          DATASET  ('ELCRTO')
  7112*       END-EXEC
  7113     MOVE LENGTH OF
  7114      ORIGINAL-CERTIFICATE
  7115       TO DFHEIV11
  7116     MOVE 'ELCRTO' TO DFHEIV1
  7117*    MOVE '&& L                  %   #00006855' TO DFHEIV0
  7118     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7119     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7120     MOVE X'2020233030303036383535' TO DFHEIV0(25:11)
  7121     CALL 'kxdfhei1' USING DFHEIV0,
  7122           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 125
* EL6318.cbl
  7123           ORIGINAL-CERTIFICATE,
  7124           DFHEIV11,
  7125           DFHEIV99
  7126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7127     END-IF
  7128     .
  7129 0420-EXIT.
  7130     EXIT.
  7131
  7132 0425-ADD-NEW-ELCRTO.
  7133     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
  7134     MOVE 'OC'                   TO OC-RECORD-ID
  7135     MOVE NEW-ELCRTO-KEY         TO OC-CONTROL-PRIMARY
  7136     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
  7137     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  7138     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
  7139     MOVE NCRTO-INS-FIRST-NAME   TO OC-INS-FIRST-NAME
  7140     MOVE NCRTO-INS-MIDDLE-INIT  TO OC-INS-MIDDLE-INIT
  7141     MOVE NCRTO-INS-LAST-NAME    TO OC-INS-LAST-NAME
  7142     MOVE NCRTO-INS-AGE          TO OC-INS-AGE
  7143     MOVE NCRTO-JNT-FIRST-NAME   TO OC-JNT-FIRST-NAME
  7144     MOVE NCRTO-JNT-MIDDLE-INIT  TO OC-JNT-MIDDLE-INIT
  7145     MOVE NCRTO-JNT-LAST-NAME    TO OC-JNT-LAST-NAME
  7146     MOVE NCRTO-JNT-AGE          TO OC-JNT-AGE
  7147     MOVE NCRTO-LF-BENCD         TO OC-LF-BENCD
  7148     MOVE NCRTO-LF-BEN-AMT       TO OC-LF-BEN-AMT
  7149     MOVE NCRTO-LF-PRM-AMT       TO OC-LF-PRM-AMT
  7150     MOVE NCRTO-LF-ALT-BEN-AMT   TO OC-LF-ALT-BEN-AMT
  7151     MOVE NCRTO-LF-ALT-PRM-AMT   TO OC-LF-ALT-PRM-AMT
  7152     MOVE NCRTO-LF-TERM          TO OC-LF-TERM
  7153     MOVE NCRTO-LF-EXP-DT        TO OC-LF-EXP-DT
  7154     MOVE NCRTO-LF-COMM-PCT      TO OC-LF-COMM-PCT
  7155     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
  7156     MOVE +0                     TO OC-LF-CANCEL-AMT
  7157                                    OC-LF-ITD-CANCEL-AMT
  7158     MOVE NCRTO-AH-BENCD         TO OC-AH-BENCD
  7159     MOVE NCRTO-AH-BEN-AMT       TO OC-AH-BEN-AMT
  7160     MOVE NCRTO-AH-PRM-AMT       TO OC-AH-PRM-AMT
  7161     MOVE NCRTO-AH-TERM          TO OC-AH-TERM
  7162     MOVE NCRTO-AH-EXP-DT        TO OC-AH-EXP-DT
  7163     MOVE NCRTO-AH-CP            TO OC-AH-CP
  7164     MOVE NCRTO-AH-COMM-PCT      TO OC-AH-COMM-PCT
  7165     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
  7166     MOVE +0                     TO OC-AH-CANCEL-AMT
  7167                                    OC-AH-ITD-CANCEL-AMT
  7168     MOVE NCRTO-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
  7169     MOVE NCRTO-1ST-PMT-DT       TO OC-1ST-PMT-DT
  7170     MOVE NCRTO-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
  7171     MOVE NCRTO-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
  7172     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
  7173     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
  7174     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
  7175     .
  7176 0425-WRITE-ELCRTO.
  7177
  7178
  7179* EXEC CICS WRITE
  7180*       DATASET   ('ELCRTO')
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 126
* EL6318.cbl
  7181*       FROM      (ORIGINAL-CERTIFICATE)
  7182*       RIDFLD    (OC-CONTROL-PRIMARY)
  7183*       RESP      (WS-RESPONSE)
  7184*    END-EXEC
  7185     MOVE LENGTH OF
  7186      ORIGINAL-CERTIFICATE
  7187       TO DFHEIV11
  7188     MOVE 'ELCRTO' TO DFHEIV1
  7189*    MOVE '&$ L                  ''  N#00006910' TO DFHEIV0
  7190     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7191     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7192     MOVE X'204E233030303036393130' TO DFHEIV0(25:11)
  7193     CALL 'kxdfhei1' USING DFHEIV0,
  7194           DFHEIV1,
  7195           ORIGINAL-CERTIFICATE,
  7196           DFHEIV11,
  7197           OC-CONTROL-PRIMARY,
  7198           DFHEIV99,
  7199           DFHEIV99
  7200     MOVE EIBRESP  TO WS-RESPONSE
  7201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7202
  7203     IF RESP-DUPKEY
  7204        SUBTRACT +1              FROM OC-KEY-SEQ-NO
  7205        GO TO 0425-WRITE-ELCRTO
  7206     ELSE
  7207        IF NOT RESP-NORMAL
  7208           MOVE -1               TO SIGREQL
  7209           MOVE ER-3830          TO EMI-ERROR
  7210           PERFORM 9900-ERROR-FORMAT
  7211                                 THRU 9900-EXIT
  7212        ELSE
  7213           MOVE OC-CONTROL-PRIMARY TO PI-ELCRTO-KEY
  7214        END-IF
  7215     END-IF
  7216
  7217     .
  7218 0425-EXIT.
  7219     EXIT.
  7220
  7221 0426-ADD-CERT-NOTES.
  7222
  7223     MOVE LOW-VALUES TO CERT-NOTE-ENTRIES
  7224     SET TB-INDX TO 1
  7225
  7226     IF PI-CERTNT1-ENTERED > SPACES
  7227         MOVE PI-CERTNT1-ENTERED TO CERT-NT-TEXT (TB-INDX)
  7228         MOVE PI-PROCESSOR-ID    TO
  7229                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  7230         MOVE EIBTIME            TO
  7231                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7232         MOVE WS-CURRENT-BIN-DT  TO
  7233                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  7234         SET TB-INDX UP BY +1
  7235     END-IF
  7236
  7237     IF PI-CERTNT2-ENTERED > SPACES
  7238         MOVE PI-CERTNT2-ENTERED TO CERT-NT-TEXT (TB-INDX)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 127
* EL6318.cbl
  7239         MOVE PI-PROCESSOR-ID    TO
  7240                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  7241         MOVE EIBTIME            TO
  7242                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7243         MOVE WS-CURRENT-BIN-DT  TO
  7244                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  7245         SET TB-INDX UP BY +1
  7246     END-IF
  7247
  7248     IF PI-CERTNT3-ENTERED > SPACES
  7249         MOVE PI-CERTNT3-ENTERED TO CERT-NT-TEXT (TB-INDX)
  7250         MOVE PI-PROCESSOR-ID    TO
  7251                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  7252         MOVE EIBTIME            TO
  7253                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7254         MOVE WS-CURRENT-BIN-DT  TO
  7255                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  7256         SET TB-INDX UP BY +1
  7257     END-IF
  7258
  7259     IF PI-CERTNT4-ENTERED > SPACES
  7260         MOVE PI-CERTNT4-ENTERED TO CERT-NT-TEXT (TB-INDX)
  7261         MOVE PI-PROCESSOR-ID    TO
  7262                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  7263         MOVE EIBTIME            TO
  7264                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7265         MOVE WS-CURRENT-BIN-DT  TO
  7266                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  7267         SET TB-INDX UP BY +1
  7268     END-IF
  7269
  7270     IF CERT-NOTE-ENTRIES > SPACES
  7271         PERFORM 0427-LOAD-CURRENT-CERT-NOTES THRU 0427-EXIT
  7272         PERFORM 1700-WRITE-CERT-NOTE THRU 1799-EXIT
  7273     END-IF
  7274
  7275     IF PI-BILLNT1-ENTERED > SPACES
  7276         MOVE SPACES             TO WS-MANUAL-BILL-NOTE
  7277         MOVE PI-BILLNT1-ENTERED TO WS-MAN-BN-NOTE
  7278         MOVE +63 TO WS-LEN
  7279         PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  7280     END-IF
  7281
  7282     IF PI-BILLNT2-ENTERED > SPACES
  7283         MOVE SPACES             TO WS-MANUAL-BILL-NOTE
  7284         MOVE PI-BILLNT2-ENTERED TO WS-MAN-BN-NOTE
  7285         MOVE +63 TO WS-LEN
  7286         PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  7287     END-IF
  7288
  7289     .
  7290 0426-EXIT.
  7291     EXIT.
  7292
  7293 0427-LOAD-CURRENT-CERT-NOTES.
  7294
  7295     MOVE PI-CRTO-COMPANY-CD  TO ERCNOT-COMPANY-CD
  7296     MOVE PI-CRTO-CARRIER     TO ERCNOT-CARRIER
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 128
* EL6318.cbl
  7297     MOVE PI-CRTO-GROUPING    TO ERCNOT-GROUPING
  7298     MOVE PI-CRTO-STATE       TO ERCNOT-STATE
  7299     MOVE PI-CRTO-ACCOUNT     TO ERCNOT-ACCOUNT
  7300     MOVE PI-CRTO-CERT-EFF-DT TO ERCNOT-EFF-DT
  7301     MOVE PI-CRTO-CERT-PRIME  TO ERCNOT-CERT-PRIME
  7302     MOVE PI-CRTO-CERT-SFX    TO ERCNOT-CERT-SFX
  7303     MOVE '1'                 TO ERCNOT-REC-TYP
  7304     MOVE +0                  TO ERCNOT-SEQ
  7305     MOVE ERCNOT-PARTIAL-KEY  TO SV-PARTIAL-KEY
  7306
  7307
  7308* EXEC CICS STARTBR
  7309*         DATASET(WS-ERCNOT-FILE-ID)
  7310*         RIDFLD(ERCNOT-KEY)
  7311*         KEYLENGTH(ERCNOT-START-LENGTH)
  7312*         RESP      (WS-RESPONSE)
  7313*         GENERIC
  7314*         GTEQ
  7315*    END-EXEC.
  7316     MOVE 0
  7317       TO DFHEIV11
  7318*    MOVE '&,   KG    G          &  N#00007021' TO DFHEIV0
  7319     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  7320     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7321     MOVE X'204E233030303037303231' TO DFHEIV0(25:11)
  7322     CALL 'kxdfhei1' USING DFHEIV0,
  7323           WS-ERCNOT-FILE-ID,
  7324           ERCNOT-KEY,
  7325           ERCNOT-START-LENGTH,
  7326           DFHEIV11,
  7327           DFHEIV99
  7328     MOVE EIBRESP  TO WS-RESPONSE
  7329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7330
  7331
  7332     IF NOT RESP-NORMAL
  7333        GO TO 0427-ENDBR
  7334     END-IF.
  7335
  7336 0427-LOOP.
  7337
  7338* EXEC CICS READNEXT
  7339*         SET(ADDRESS OF CERT-NOTE-FILE)
  7340*         DATASET(WS-ERCNOT-FILE-ID)
  7341*         RIDFLD(ERCNOT-KEY)
  7342*    END-EXEC.
  7343     MOVE 0
  7344       TO DFHEIV11
  7345*    MOVE '&.S                   )   #00007035' TO DFHEIV0
  7346     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7347     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7348     MOVE X'2020233030303037303335' TO DFHEIV0(25:11)
  7349     CALL 'kxdfhei1' USING DFHEIV0,
  7350           WS-ERCNOT-FILE-ID,
  7351           DFHEIV20,
  7352           DFHEIV99,
  7353           ERCNOT-KEY,
  7354           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 129
* EL6318.cbl
  7355           DFHEIV11,
  7356           DFHEIV99,
  7357           DFHEIV99
  7358     SET ADDRESS OF CERT-NOTE-FILE TO
  7359         DFHEIV20
  7360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7361
  7362
  7363     IF CZ-COMPANY-CD NOT = PI-CRTO-COMPANY-CD
  7364         GO TO 0427-ENDBR
  7365     END-IF.
  7366
  7367     IF (CZ-CARRIER = SV-CARRIER)
  7368        AND (CZ-GROUPING = SV-GROUPING)
  7369        AND (CZ-STATE = SV-STATE)
  7370        AND (CZ-ACCOUNT = SV-ACCOUNT)
  7371        AND (CZ-CERT-EFF-DT = SV-EFF-DT)
  7372        AND (CZ-CERT-NO = SV-CERT-NO)
  7373        AND (CZ-RECORD-TYPE = '1')
  7374          MOVE CZ-NOTE TO CERT-NT-TEXT (TB-INDX)
  7375          MOVE CZ-LAST-MAINT-USER TO
  7376                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  7377          MOVE CZ-LAST-MAINT-DT TO
  7378                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  7379          MOVE CZ-LAST-MAINT-HHMMSS TO
  7380                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7381          SET TB-INDX UP BY 1
  7382          GO TO 0427-LOOP
  7383     END-IF.
  7384
  7385 0427-ENDBR.
  7386
  7387
  7388* EXEC CICS ENDBR
  7389*         DATASET(WS-ERCNOT-FILE-ID)
  7390*    END-EXEC.
  7391     MOVE 0
  7392       TO DFHEIV11
  7393*    MOVE '&2                    $   #00007065' TO DFHEIV0
  7394     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7395     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7396     MOVE X'2020233030303037303635' TO DFHEIV0(25:11)
  7397     CALL 'kxdfhei1' USING DFHEIV0,
  7398           WS-ERCNOT-FILE-ID,
  7399           DFHEIV11,
  7400           DFHEIV99
  7401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7402
  7403
  7404     .
  7405 0427-EXIT.
  7406     EXIT.
  7407
  7408 0430-WRITE-ERENDT.
  7409     MOVE EN-CONTROL-PRIMARY     TO PI-ERENDT-KEY
  7410     MOVE W-ARCH-NUMBER          TO EN-ARCHIVE-NO
  7411
  7412* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 130
* EL6318.cbl
  7413*         DATASET   (WS-ERENDT-FILE-ID)
  7414*         FROM      (ENDORSEMENT-RECORD)
  7415*         RIDFLD    (EN-CONTROL-PRIMARY)
  7416*         RESP      (WS-RESPONSE)
  7417*    END-EXEC
  7418     MOVE LENGTH OF
  7419      ENDORSEMENT-RECORD
  7420       TO DFHEIV11
  7421*    MOVE '&$ L                  ''  N#00007076' TO DFHEIV0
  7422     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7423     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7424     MOVE X'204E233030303037303736' TO DFHEIV0(25:11)
  7425     CALL 'kxdfhei1' USING DFHEIV0,
  7426           WS-ERENDT-FILE-ID,
  7427           ENDORSEMENT-RECORD,
  7428           DFHEIV11,
  7429           EN-CONTROL-PRIMARY,
  7430           DFHEIV99,
  7431           DFHEIV99
  7432     MOVE EIBRESP  TO WS-RESPONSE
  7433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7434     IF RESP-NORMAL
  7435        MOVE 'G'                 TO PI-DOCUMENT-PROCESSED
  7436        IF EIBAID = DFHPF4
  7437           PERFORM 0420-UPDATE-ELCRTO THRU 0420-EXIT
  7438           PERFORM 0425-ADD-NEW-ELCRTO THRU 0425-EXIT
  7439           PERFORM 0426-ADD-CERT-NOTES THRU 0426-EXIT
  7440           PERFORM 0440-ADD-BILLING-NOTE THRU 0440-EXIT
  7441        END-IF
  7442     ELSE
  7443        DISPLAY ' NOT A GOOD WRITE ERENDT ' WS-RESPONSE
  7444        MOVE -1                  TO SIGREQL
  7445        MOVE ER-0132             TO EMI-ERROR
  7446        MOVE AL-UABON            TO SIGREQA
  7447        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7448     END-IF
  7449     .
  7450 0430-EXIT.
  7451     EXIT.
  7452
  7453
  7454 0440-ADD-BILLING-NOTE.
  7455
  7456* EXEC CICS GETMAIN
  7457*         SET      (ADDRESS OF EOB-CODES)
  7458*         LENGTH   (ELEOBC-LENGTH)
  7459*         INITIMG  (GETMAIN-SPACE)
  7460*    END-EXEC
  7461*    MOVE ',"IL                  $   #00007103' TO DFHEIV0
  7462     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7463     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7464     MOVE X'2020233030303037313033' TO DFHEIV0(25:11)
  7465     CALL 'kxdfhei1' USING DFHEIV0,
  7466           DFHEIV20,
  7467           ELEOBC-LENGTH,
  7468           GETMAIN-SPACE
  7469     SET ADDRESS OF EOB-CODES TO
  7470         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 131
* EL6318.cbl
  7471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7472
  7473     MOVE LOW-VALUES             TO WS-ELEOBC-KEY
  7474     MOVE PI-COMPANY-CD          TO WS-EOBC-COMPANY-CD
  7475     MOVE '5'                    TO WS-EOBC-REC-TYPE
  7476
  7477
  7478* EXEC CICS STARTBR
  7479*        DATASET   ('ELEOBC')
  7480*        RIDFLD    (WS-ELEOBC-KEY)
  7481*        GTEQ
  7482*        RESP      (WS-RESPONSE)
  7483*    END-EXEC
  7484     MOVE 'ELEOBC' TO DFHEIV1
  7485     MOVE 0
  7486       TO DFHEIV11
  7487*    MOVE '&,         G          &  N#00007113' TO DFHEIV0
  7488     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7489     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7490     MOVE X'204E233030303037313133' TO DFHEIV0(25:11)
  7491     CALL 'kxdfhei1' USING DFHEIV0,
  7492           DFHEIV1,
  7493           WS-ELEOBC-KEY,
  7494           DFHEIV99,
  7495           DFHEIV11,
  7496           DFHEIV99
  7497     MOVE EIBRESP  TO WS-RESPONSE
  7498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7499
  7500     IF NOT RESP-NORMAL
  7501        GO TO 0440-EXIT
  7502     END-IF
  7503      .
  7504 0440-READNEXT-ELEOBC.
  7505
  7506
  7507* EXEC CICS READNEXT
  7508*       INTO    (EOB-CODES)
  7509*       DATASET ('ELEOBC')
  7510*       RIDFLD  (WS-ELEOBC-KEY)
  7511*       RESP    (WS-RESPONSE)
  7512*    END-EXEC
  7513     MOVE LENGTH OF
  7514      EOB-CODES
  7515       TO DFHEIV12
  7516     MOVE 'ELEOBC' TO DFHEIV1
  7517     MOVE 0
  7518       TO DFHEIV11
  7519*    MOVE '&.IL                  )  N#00007126' TO DFHEIV0
  7520     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  7521     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7522     MOVE X'204E233030303037313236' TO DFHEIV0(25:11)
  7523     CALL 'kxdfhei1' USING DFHEIV0,
  7524           DFHEIV1,
  7525           EOB-CODES,
  7526           DFHEIV12,
  7527           WS-ELEOBC-KEY,
  7528           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 132
* EL6318.cbl
  7529           DFHEIV11,
  7530           DFHEIV99,
  7531           DFHEIV99
  7532     MOVE EIBRESP  TO WS-RESPONSE
  7533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7534
  7535     IF RESP-NORMAL
  7536         IF EO-RECORD-TYPE NOT = '5'
  7537             GO TO 0440-EXIT
  7538         END-IF
  7539     ELSE
  7540         GO TO 0440-EXIT
  7541     END-IF
  7542
  7543     IF EO-RECORD-TYPE = '5' AND
  7544        EO-EOB-CODE = PI-LTRID-ENTERED
  7545           CONTINUE
  7546     ELSE
  7547         GO TO 0440-READNEXT-ELEOBC
  7548     END-IF
  7549
  7550     MOVE SPACES TO WS-BILLING-NOTE
  7551     MOVE EO-DESCRIPTION TO WS-BN-NOTE
  7552     MOVE PI-LTRID-ENTERED TO WS-BN-LTRID
  7553     MOVE WS-CURRENT-DT TO WS-BN-DATE
  7554     MOVE PI-PROCESSOR-ID TO WS-BN-USERID
  7555     MOVE +25 TO WS-LEN
  7556
  7557     PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  7558     .
  7559 0440-EXIT.
  7560     EXIT.
  7561
  7562 0441-UPDATE-BILLING-NOTE.
  7563
  7564* EXEC CICS GETMAIN
  7565*         SET      (ADDRESS OF CERTIFICATE-NOTE)
  7566*         LENGTH   (ERNOTE-LENGTH)
  7567*         INITIMG  (GETMAIN-SPACE)
  7568*    END-EXEC
  7569*    MOVE ',"IL                  $   #00007161' TO DFHEIV0
  7570     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7571     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7572     MOVE X'2020233030303037313631' TO DFHEIV0(25:11)
  7573     CALL 'kxdfhei1' USING DFHEIV0,
  7574           DFHEIV20,
  7575           ERNOTE-LENGTH,
  7576           GETMAIN-SPACE
  7577     SET ADDRESS OF CERTIFICATE-NOTE TO
  7578         DFHEIV20
  7579     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7580
  7581     MOVE PI-ERENDT-KEY (1:33) TO WS-ERNOTE-KEY
  7582
  7583
  7584* EXEC CICS READ
  7585*       DATASET    (WS-ERNOTE-FILE-ID)
  7586*       RIDFLD     (WS-ERNOTE-KEY)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 133
* EL6318.cbl
  7587*       INTO       (CERTIFICATE-NOTE)
  7588*       RESP       (WS-RESPONSE)
  7589*       UPDATE
  7590*    END-EXEC
  7591     MOVE LENGTH OF
  7592      CERTIFICATE-NOTE
  7593       TO DFHEIV11
  7594*    MOVE '&"IL       EU         (  N#00007169' TO DFHEIV0
  7595     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7596     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7597     MOVE X'204E233030303037313639' TO DFHEIV0(25:11)
  7598     CALL 'kxdfhei1' USING DFHEIV0,
  7599           WS-ERNOTE-FILE-ID,
  7600           CERTIFICATE-NOTE,
  7601           DFHEIV11,
  7602           WS-ERNOTE-KEY,
  7603           DFHEIV99,
  7604           DFHEIV99,
  7605           DFHEIV99
  7606     MOVE EIBRESP  TO WS-RESPONSE
  7607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7608
  7609     IF RESP-NORMAL
  7610       IF CN-BILLING-START-LINE-NO NOT NUMERIC
  7611          MOVE ZEROS            TO CN-BILLING-START-LINE-NO
  7612       END-IF
  7613       IF CN-BILLING-END-LINE-NO NOT NUMERIC
  7614          MOVE ZEROS            TO CN-BILLING-END-LINE-NO
  7615       END-IF
  7616       PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  7617           (NOTE-SUB > +10) OR
  7618           (CN-LINE (NOTE-SUB) (1:WS-LEN) =
  7619                             WS-BILLING-NOTE (1:WS-LEN))
  7620       END-PERFORM
  7621       IF CN-LINE (NOTE-SUB) (1:WS-LEN) =
  7622                              WS-BILLING-NOTE (1:WS-LEN)
  7623
  7624* EXEC CICS UNLOCK
  7625*           DATASET    (WS-ERNOTE-FILE-ID)
  7626*        END-EXEC
  7627*    MOVE '&*                    #   #00007191' TO DFHEIV0
  7628     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7629     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7630     MOVE X'2020233030303037313931' TO DFHEIV0(25:11)
  7631     CALL 'kxdfhei1' USING DFHEIV0,
  7632           WS-ERNOTE-FILE-ID,
  7633           DFHEIV99
  7634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7635       ELSE
  7636         PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  7637           (NOTE-SUB > +10) OR
  7638           (CN-LINE (NOTE-SUB) = SPACES OR LOW-VALUES)
  7639         END-PERFORM
  7640         IF (NOTE-SUB < +11)
  7641           IF NOTE-SUB >= CN-BILLING-START-LINE-NO AND
  7642              NOTE-SUB <= CN-BILLING-END-LINE-NO
  7643                MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  7644           ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 134
* EL6318.cbl
  7645             IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
  7646              (NOTE-SUB = (CN-BILLING-END-LINE-NO + +1))
  7647                MOVE WS-BILLING-NOTE   TO CN-LINE (NOTE-SUB)
  7648                MOVE NOTE-SUB     TO CN-BILLING-END-LINE-NO
  7649             ELSE
  7650               IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
  7651                  (NOTE-SUB = (CN-BILLING-START-LINE-NO - +1))
  7652                     MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  7653                     MOVE NOTE-SUB  TO CN-BILLING-START-LINE-NO
  7654               ELSE
  7655                 IF (CN-BILLING-END-LINE-NO = ZEROS)
  7656                   MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB)
  7657                   MOVE NOTE-SUB    TO CN-BILLING-END-LINE-NO
  7658                                       CN-BILLING-START-LINE-NO
  7659                 ELSE
  7660                    PERFORM 0442-SQUEEZE-IT-IN THRU 0442-EXIT
  7661                 END-IF
  7662               END-IF
  7663             END-IF
  7664           END-IF
  7665           MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  7666           MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  7667           MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  7668
  7669* EXEC CICS REWRITE
  7670*             DATASET    (WS-ERNOTE-FILE-ID)
  7671*             FROM       (CERTIFICATE-NOTE)
  7672*             RESP       (WS-RESPONSE)
  7673*          END-EXEC
  7674     MOVE LENGTH OF
  7675      CERTIFICATE-NOTE
  7676       TO DFHEIV11
  7677*    MOVE '&& L                  %  N#00007227' TO DFHEIV0
  7678     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7679     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7680     MOVE X'204E233030303037323237' TO DFHEIV0(25:11)
  7681     CALL 'kxdfhei1' USING DFHEIV0,
  7682           WS-ERNOTE-FILE-ID,
  7683           CERTIFICATE-NOTE,
  7684           DFHEIV11,
  7685           DFHEIV99
  7686     MOVE EIBRESP  TO WS-RESPONSE
  7687     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7688           PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  7689         END-IF
  7690       END-IF
  7691     ELSE
  7692        MOVE SPACES              TO CERTIFICATE-NOTE
  7693        MOVE 'CN'                TO CN-RECORD-ID
  7694        MOVE PI-ERENDT-KEY (1:33) TO CN-CONTROL-PRIMARY
  7695                                     WS-ERNOTE-KEY
  7696        MOVE 01                  TO CN-BILLING-START-LINE-NO
  7697                                    CN-BILLING-END-LINE-NO
  7698        MOVE WS-BILLING-NOTE     TO CN-LINE (01)
  7699        MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  7700        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  7701        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  7702
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 135
* EL6318.cbl
  7703* EXEC CICS WRITE
  7704*          DATASET    (WS-ERNOTE-FILE-ID)
  7705*          FROM       (CERTIFICATE-NOTE)
  7706*          RIDFLD     (WS-ERNOTE-KEY)
  7707*          RESP       (WS-RESPONSE)
  7708*       END-EXEC
  7709     MOVE LENGTH OF
  7710      CERTIFICATE-NOTE
  7711       TO DFHEIV11
  7712*    MOVE '&$ L                  ''  N#00007246' TO DFHEIV0
  7713     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7714     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7715     MOVE X'204E233030303037323436' TO DFHEIV0(25:11)
  7716     CALL 'kxdfhei1' USING DFHEIV0,
  7717           WS-ERNOTE-FILE-ID,
  7718           CERTIFICATE-NOTE,
  7719           DFHEIV11,
  7720           WS-ERNOTE-KEY,
  7721           DFHEIV99,
  7722           DFHEIV99
  7723     MOVE EIBRESP  TO WS-RESPONSE
  7724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7725
  7726        PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  7727     END-IF
  7728
  7729     .
  7730 0441-EXIT.
  7731     EXIT.
  7732
  7733
  7734 0442-SQUEEZE-IT-IN.
  7735
  7736     IF NOTE-SUB < CN-BILLING-START-LINE-NO
  7737        PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
  7738           NOTE-SUB = +10
  7739           MOVE CN-LINE (NOTE-SUB + 1) TO CN-LINE (NOTE-SUB)
  7740           IF (NOTE-SUB + 1) = (CN-BILLING-START-LINE-NO - 1)
  7741             MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB + 1)
  7742             COMPUTE CN-BILLING-START-LINE-NO = NOTE-SUB + 1
  7743             MOVE +9 TO NOTE-SUB
  7744           END-IF
  7745        END-PERFORM
  7746     ELSE
  7747        IF NOTE-SUB > CN-BILLING-END-LINE-NO
  7748           PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY -1
  7749             UNTIL NOTE-SUB = +1
  7750             MOVE CN-LINE (NOTE-SUB - 1) TO CN-LINE (NOTE-SUB)
  7751             IF (NOTE-SUB - 1) = (CN-BILLING-END-LINE-NO + 1)
  7752                MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB - 1)
  7753                COMPUTE CN-BILLING-END-LINE-NO = NOTE-SUB - 1
  7754                MOVE +2          TO NOTE-SUB
  7755             END-IF
  7756           END-PERFORM
  7757        END-IF
  7758     END-IF
  7759
  7760     .
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 136
* EL6318.cbl
  7761 0442-EXIT.
  7762     EXIT.
  7763
  7764 0445-CERTIFICATE-UPDATE.
  7765     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  7766     IF RESP-NORMAL
  7767        EVALUATE CM-NOTE-SW
  7768           WHEN '2'
  7769           WHEN '3'
  7770           WHEN '6'
  7771           WHEN '7'
  7772              SET NO-CERT-RW     TO TRUE
  7773           WHEN ' '
  7774              MOVE '2'           TO CM-NOTE-SW
  7775           WHEN '1'
  7776              MOVE '3'           TO CM-NOTE-SW
  7777           WHEN '4'
  7778              MOVE '6'           TO CM-NOTE-SW
  7779           WHEN '5'
  7780              MOVE '7'           TO CM-NOTE-SW
  7781        END-EVALUATE
  7782     END-IF
  7783     IF NOT NO-CERT-RW
  7784        PERFORM 1810-REWRITE-ELCERT
  7785                                 THRU 1810-EXIT
  7786     ELSE
  7787
  7788* EXEC CICS UNLOCK
  7789*          DATASET    (WS-ELCERT-FILE-ID)
  7790*       END-EXEC
  7791*    MOVE '&*                    #   #00007314' TO DFHEIV0
  7792     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7793     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7794     MOVE X'2020233030303037333134' TO DFHEIV0(25:11)
  7795     CALL 'kxdfhei1' USING DFHEIV0,
  7796           WS-ELCERT-FILE-ID,
  7797           DFHEIV99
  7798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7799     END-IF
  7800
  7801     .
  7802 0445-EXIT.
  7803     EXIT.
  7804
  7805 0450-GET-ERACCT.
  7806     MOVE ' '                    TO WS-ERACCT-SW
  7807     MOVE ZEROS                  TO WS-CHGBACK
  7808                                    WS-CSO-PORTION
  7809                                    WS-ACCT-PORTION
  7810                                    WS-DIFF
  7811     PERFORM 0460-STARTBR-ERACCT THRU 0460-EXIT
  7812     IF RESP-NORMAL
  7813        PERFORM 0470-READNEXT-ERACCT
  7814                                 THRU 0470-EXIT
  7815     END-IF
  7816     IF RESP-NORMAL
  7817        IF AM-CONTROL-PRIMARY (1:20) = EN-CONTROL-PRIMARY (1:20)
  7818           IF EN-CERT-EFF-DT < AM-EXPIRATION-DT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 137
* EL6318.cbl
  7819              AND >= AM-EFFECTIVE-DT
  7820              SET ACCT-FOUND TO TRUE
  7821           ELSE
  7822              PERFORM 0470-READNEXT-ERACCT
  7823                                 THRU 0470-EXIT
  7824              IF RESP-NORMAL
  7825                 IF AM-CONTROL-PRIMARY (1:20)
  7826                    = EN-CONTROL-PRIMARY (1:20)
  7827                    IF EN-CERT-EFF-DT < AM-EXPIRATION-DT
  7828                       AND >= AM-EFFECTIVE-DT
  7829                       SET ACCT-FOUND TO TRUE
  7830                    END-IF
  7831                 END-IF
  7832              END-IF
  7833           END-IF
  7834        END-IF
  7835     END-IF
  7836     IF ACCT-FOUND
  7837        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  7838           (AM-COM-TYP (S1) = 'C' OR 'D')
  7839           OR (S1 > +10)
  7840        END-PERFORM
  7841        IF S1 < +11
  7842           MOVE AM-COMM-CHARGEBACK (S1)
  7843                                 TO WS-CHGBACK
  7844        END-IF
  7845     END-IF
  7846    .
  7847 0450-EXIT.
  7848     EXIT.
  7849 0460-STARTBR-ERACCT.
  7850     MOVE LOW-VALUES             TO WS-ERACCT-KEY
  7851     MOVE EN-CONTROL-PRIMARY     TO WS-ERACCT-KEY (1:22)
  7852     MOVE WS-ERACCT-KEY          TO WS-SAVE-ERACCT-KEY
  7853
  7854* EXEC CICS STARTBR
  7855*        DATASET   ('ERACCT')
  7856*        RIDFLD    (WS-ERACCT-KEY)
  7857*        GTEQ
  7858*        RESP      (WS-RESPONSE)
  7859*    END-EXEC
  7860     MOVE 'ERACCT' TO DFHEIV1
  7861     MOVE 0
  7862       TO DFHEIV11
  7863*    MOVE '&,         G          &  N#00007371' TO DFHEIV0
  7864     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7865     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7866     MOVE X'204E233030303037333731' TO DFHEIV0(25:11)
  7867     CALL 'kxdfhei1' USING DFHEIV0,
  7868           DFHEIV1,
  7869           WS-ERACCT-KEY,
  7870           DFHEIV99,
  7871           DFHEIV11,
  7872           DFHEIV99
  7873     MOVE EIBRESP  TO WS-RESPONSE
  7874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7875     .
  7876 0460-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 138
* EL6318.cbl
  7877     EXIT.
  7878 0470-READNEXT-ERACCT.
  7879
  7880* EXEC CICS READNEXT
  7881*       INTO    (ACCOUNT-MASTER)
  7882*       DATASET ('ERACCT')
  7883*       RIDFLD  (WS-ERACCT-KEY)
  7884*       RESP    (WS-RESPONSE)
  7885*    END-EXEC
  7886     MOVE LENGTH OF
  7887      ACCOUNT-MASTER
  7888       TO DFHEIV12
  7889     MOVE 'ERACCT' TO DFHEIV1
  7890     MOVE 0
  7891       TO DFHEIV11
  7892*    MOVE '&.IL                  )  N#00007381' TO DFHEIV0
  7893     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  7894     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7895     MOVE X'204E233030303037333831' TO DFHEIV0(25:11)
  7896     CALL 'kxdfhei1' USING DFHEIV0,
  7897           DFHEIV1,
  7898           ACCOUNT-MASTER,
  7899           DFHEIV12,
  7900           WS-ERACCT-KEY,
  7901           DFHEIV99,
  7902           DFHEIV11,
  7903           DFHEIV99,
  7904           DFHEIV99
  7905     MOVE EIBRESP  TO WS-RESPONSE
  7906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7907     .
  7908 0470-EXIT.
  7909     EXIT.
  7910 0500-CREATE-TEMP-STORAGE.
  7911*    display ' about to write pi ' program-interface-block
  7912
  7913* EXEC CICS WRITEQ TS
  7914*        QUEUE (QID)
  7915*        FROM  (PROGRAM-INTERFACE-BLOCK)
  7916*        LENGTH(1300)
  7917*    END-EXEC
  7918     MOVE 1300
  7919       TO DFHEIV11
  7920*    MOVE '*"     L              ''   #00007392' TO DFHEIV0
  7921     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  7922     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7923     MOVE X'2020233030303037333932' TO DFHEIV0(25:11)
  7924     CALL 'kxdfhei1' USING DFHEIV0,
  7925           QID,
  7926           PROGRAM-INTERFACE-BLOCK,
  7927           DFHEIV11,
  7928           DFHEIV99,
  7929           DFHEIV99,
  7930           DFHEIV99
  7931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7932*    display ' about to write map ' el631ki
  7933
  7934* EXEC CICS WRITEQ TS
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 139
* EL6318.cbl
  7935*        QUEUE (QID)
  7936*        FROM  (EL631KI)
  7937*        LENGTH(MAP-LENGTH)
  7938*    END-EXEC.
  7939*    MOVE '*"     L              ''   #00007398' TO DFHEIV0
  7940     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  7941     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7942     MOVE X'2020233030303037333938' TO DFHEIV0(25:11)
  7943     CALL 'kxdfhei1' USING DFHEIV0,
  7944           QID,
  7945           EL631KI,
  7946           MAP-LENGTH,
  7947           DFHEIV99,
  7948           DFHEIV99,
  7949           DFHEIV99
  7950     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7951
  7952 0500-EXIT.
  7953      EXIT.
  7954 0600-RECOVER-TEMP-STORAGE.
  7955
  7956* EXEC CICS READQ TS
  7957*        QUEUE (QID)
  7958*        INTO  (PROGRAM-INTERFACE-BLOCK)
  7959*        LENGTH(1300)
  7960*    END-EXEC
  7961     MOVE 1300
  7962       TO DFHEIV11
  7963*    MOVE '*$I    L              ''   #00007406' TO DFHEIV0
  7964     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7965     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7966     MOVE X'2020233030303037343036' TO DFHEIV0(25:11)
  7967     CALL 'kxdfhei1' USING DFHEIV0,
  7968           QID,
  7969           PROGRAM-INTERFACE-BLOCK,
  7970           DFHEIV11,
  7971           DFHEIV99,
  7972           DFHEIV99,
  7973           DFHEIV99
  7974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7975
  7976* EXEC CICS READQ TS
  7977*        QUEUE (QID)
  7978*        INTO  (EL631KI)
  7979*        LENGTH(MAP-LENGTH)
  7980*    END-EXEC
  7981*    MOVE '*$I    L              ''   #00007411' TO DFHEIV0
  7982     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7983     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7984     MOVE X'2020233030303037343131' TO DFHEIV0(25:11)
  7985     CALL 'kxdfhei1' USING DFHEIV0,
  7986           QID,
  7987           EL631KI,
  7988           MAP-LENGTH,
  7989           DFHEIV99,
  7990           DFHEIV99,
  7991           DFHEIV99
  7992     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 140
* EL6318.cbl
  7993     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  7994     MOVE AL-UANON            TO SIGREQA
  7995     MOVE AL-UANON            TO LTRIDA
  7996     MOVE AL-UANON            TO VOUCHA
  7997     MOVE AL-UANON            TO HLTHAPPA
  7998     MOVE AL-UANON            TO PAYEEA
  7999     IF WS-SET-CODES-MDT = 'Y'
  8000        move +1                  to s2
  8001        perform varying s1 from +1 by +5 until s1 > +60
  8002           MOVE WS-PASSED-REASON-CODES (s1:4)
  8003                                 TO reacd-in (s2)
  8004           IF REACD-IN (S2) NOT EQUAL SPACES AND LOW-VALUES
  8005               MOVE AL-SANON     TO REACDA (S2)
  8006               MOVE +4           TO REACDL (S2)
  8007           END-IF
  8008           add +1                to s2
  8009        end-perform
  8010        MOVE REASONCDS       TO PI-REASONS-ENTERED
  8011     END-IF
  8012     IF CERTIDI > SPACES
  8013         MOVE AL-UANON       TO CERTIDA
  8014     END-IF
  8015
  8016     IF ENCCODEI > SPACES
  8017         MOVE AL-UANON       TO ENCCODEA
  8018     END-IF
  8019
  8020     IF CRTNT1I > SPACES
  8021         MOVE AL-UANON       TO CRTNT1A
  8022     END-IF
  8023
  8024     IF CRTNT2I > SPACES
  8025         MOVE AL-UANON       TO CRTNT2A
  8026     END-IF
  8027
  8028     IF CRTNT3I > SPACES
  8029         MOVE AL-UANON       TO CRTNT3A
  8030     END-IF
  8031
  8032     IF CRTNT4I > SPACES
  8033         MOVE AL-UANON       TO CRTNT4A
  8034     END-IF
  8035
  8036     IF BILNT1I > SPACES
  8037         MOVE AL-UANON       TO BILNT1A
  8038     END-IF
  8039
  8040     IF BILNT2I > SPACES
  8041         MOVE AL-UANON       TO BILNT2A
  8042     END-IF
  8043     .
  8044 0600-EXIT.
  8045      EXIT.
  8046 0800-DELETE-TS.
  8047
  8048* EXEC CICS DELETEQ TS
  8049*        QUEUE(QID)
  8050*    END-EXEC
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 141
* EL6318.cbl
  8051*    MOVE '*&                    #   #00007470' TO DFHEIV0
  8052     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  8053     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8054     MOVE X'2020233030303037343730' TO DFHEIV0(25:11)
  8055     CALL 'kxdfhei1' USING DFHEIV0,
  8056           QID,
  8057           DFHEIV99
  8058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8059     .
  8060 0800-EXIT.
  8061      EXIT.
  8062 1000-BUILD-ERARCH.
  8063     MOVE SPACES                 TO W-CNTL-KEY
  8064     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID
  8065     MOVE '1'                    TO W-CNTL-RECORD-TYPE
  8066     MOVE ZEROS                  TO W-CNTL-SEQ-NO
  8067
  8068* EXEC CICS READ
  8069*         DATASET    (WS-ELCNTL-FILE-ID)
  8070*         SET        (ADDRESS OF CONTROL-FILE)
  8071*         RIDFLD     (W-CNTL-KEY)
  8072*         UPDATE
  8073*         RESP       (WS-RESPONSE)
  8074*    END-EXEC
  8075*    MOVE '&"S        EU         (  N#00007481' TO DFHEIV0
  8076     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8077     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8078     MOVE X'204E233030303037343831' TO DFHEIV0(25:11)
  8079     CALL 'kxdfhei1' USING DFHEIV0,
  8080           WS-ELCNTL-FILE-ID,
  8081           DFHEIV20,
  8082           DFHEIV99,
  8083           W-CNTL-KEY,
  8084           DFHEIV99,
  8085           DFHEIV99,
  8086           DFHEIV99
  8087     SET ADDRESS OF CONTROL-FILE TO
  8088         DFHEIV20
  8089     MOVE EIBRESP  TO WS-RESPONSE
  8090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8091     IF RESP-NORMAL
  8092        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
  8093           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  8094        END-IF
  8095        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
  8096        MOVE CF-CREDIT-LAST-ARCH-NUM
  8097                                 TO W-ARCH-NUMBER
  8098
  8099* EXEC CICS REWRITE
  8100*          FROM      (CONTROL-FILE)
  8101*          DATASET   (WS-ELCNTL-FILE-ID)
  8102*       END-EXEC
  8103     MOVE LENGTH OF
  8104      CONTROL-FILE
  8105       TO DFHEIV11
  8106*    MOVE '&& L                  %   #00007495' TO DFHEIV0
  8107     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8108     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 142
* EL6318.cbl
  8109     MOVE X'2020233030303037343935' TO DFHEIV0(25:11)
  8110     CALL 'kxdfhei1' USING DFHEIV0,
  8111           WS-ELCNTL-FILE-ID,
  8112           CONTROL-FILE,
  8113           DFHEIV11,
  8114           DFHEIV99
  8115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8116     END-IF
  8117
  8118* EXEC CICS GETMAIN
  8119*       SET      (ADDRESS OF LETTER-ARCHIVE)
  8120*       LENGTH   (W-ARCH-LENGTH)
  8121*    END-EXEC
  8122*    MOVE '," L                  $   #00007500' TO DFHEIV0
  8123     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  8124     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8125     MOVE X'2020233030303037353030' TO DFHEIV0(25:11)
  8126     CALL 'kxdfhei1' USING DFHEIV0,
  8127           DFHEIV20,
  8128           W-ARCH-LENGTH,
  8129           DFHEIV99
  8130     SET ADDRESS OF LETTER-ARCHIVE TO
  8131         DFHEIV20
  8132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8133     MOVE 'LA'                   TO LETTER-ARCHIVE
  8134     MOVE W-ARCH-NUMBER          TO LA-ARCHIVE-NO
  8135                                    LA-ARCHIVE-NO-A2
  8136                                    LA-ARCHIVE-NO-A3
  8137                                    LA-ARCHIVE-NO-A4
  8138                                    LA-ARCHIVE-NO-A5
  8139                                    LA-ARCHIVE-NO-A6
  8140     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
  8141                                    LA-COMPANY-CD-A2
  8142                                    LA-COMPANY-CD-A3
  8143                                    LA-COMPANY-CD-A4
  8144                                    LA-COMPANY-CD-A5
  8145                                    LA-COMPANY-CD-A6
  8146     MOVE PB-CARRIER             TO LA-CARRIER-A2
  8147                                    LA-CARRIER-A3
  8148                                    LA-CARRIER-A4
  8149                                    LA-CARRIER-A5
  8150     MOVE Pb-cert-eff-dt         TO LA-EFFECT-DATE-A2
  8151     MOVE PB-GROUPING            TO LA-GROUPING-A2
  8152                                    LA-GROUPING-A3
  8153                                    LA-GROUPING-A4
  8154                                    LA-GROUPING-A5
  8155     MOVE PB-ACCOUNT             TO LA-ACCOUNT-A2
  8156                                    LA-ACCOUNT-A3
  8157                                    LA-ACCOUNT-A4
  8158                                    LA-ACCOUNT-A5
  8159     MOVE PB-STATE               TO LA-STATE-A2
  8160                                    LA-STATE-A3
  8161                                    LA-STATE-A4
  8162                                    LA-STATE-A5
  8163     MOVE PB-CERT-PRIME          TO LA-CERT-PRIME-A2
  8164     MOVE PB-CERT-SFX            TO LA-CERT-SUFFIX-A2
  8165     MOVE PB-ENTRY-BATCH         TO LA-ENTRY-A6
  8166     MOVE PI-PROCESSOR-ID        TO LA-PROCESSOR-CD
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 143
* EL6318.cbl
  8167     MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
  8168                                    LA-INITIAL-PRINT-DATE
  8169                                    LA-SENT-DATE
  8170                                    LA-REPLY-DATE
  8171                                    LA-RESEND-DATE
  8172                                    LA-FOLLOW-UP-DATE
  8173     MOVE 'A'                    TO LA-STATUS
  8174     MOVE W-NUMBER-OF-COPIES     TO LA-NO-OF-COPIES
  8175     MOVE W-AUTO-CLOSE-IND       TO LA-FINAL-ACT-IND
  8176     MOVE LTRIDI                 TO LA-FORM-A3
  8177     MOVE '4'                    TO LA-DATA-SOURCE
  8178     MOVE WS-CURRENT-BIN-DT      TO LA-CREATION-DATE
  8179     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES
  8180                                    LA-NO-OF-TEXT-RECORDS
  8181
  8182* EXEC CICS WRITE
  8183*         DATASET   ('ERARCH')
  8184*         FROM      (LETTER-ARCHIVE)
  8185*         RIDFLD    (LA-CONTROL-PRIMARY)
  8186*         RESP      (WS-RESPONSE)
  8187*    END-EXEC
  8188     MOVE LENGTH OF
  8189      LETTER-ARCHIVE
  8190       TO DFHEIV11
  8191     MOVE 'ERARCH' TO DFHEIV1
  8192*    MOVE '&$ L                  ''  N#00007552' TO DFHEIV0
  8193     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8194     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8195     MOVE X'204E233030303037353532' TO DFHEIV0(25:11)
  8196     CALL 'kxdfhei1' USING DFHEIV0,
  8197           DFHEIV1,
  8198           LETTER-ARCHIVE,
  8199           DFHEIV11,
  8200           LA-CONTROL-PRIMARY,
  8201           DFHEIV99,
  8202           DFHEIV99
  8203     MOVE EIBRESP  TO WS-RESPONSE
  8204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8205     IF RESP-NORMAL
  8206        MOVE ER-0280             TO EMI-ERROR
  8207        MOVE -1                  TO SIGREQL
  8208        PERFORM 9900-ERROR-FORMAT
  8209                                 THRU 9900-EXIT
  8210        MOVE W-ARCH-NUMBER       TO W-ARCH-SUPPRESS
  8211        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  8212     ELSE
  8213        MOVE ER-7345             TO EMI-ERROR
  8214        MOVE -1                  TO SIGREQL
  8215        PERFORM 9900-ERROR-FORMAT
  8216                                 THRU 9900-EXIT
  8217     END-IF
  8218     .
  8219 1000-EXIT.
  8220     EXIT.
  8221 1100-CALL-NS-BUS-LOGIC.
  8222     MOVE SPACES                 TO BL-INPUT
  8223     MOVE W-ARCH-NUMBER          TO BL-ARCHIVE-NO
  8224     IF PI-RETURN-TO-PROGRAM EQUAL 'EL6314'
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 144
* EL6318.cbl
  8225         MOVE '2'                TO BL-DATA-SRCE
  8226         MOVE SPACES             TO BL-BATCH-NO
  8227         MOVE ZEROS              TO BL-BATCH-SEQ
  8228     ELSE
  8229         MOVE '4'                TO BL-DATA-SRCE
  8230         MOVE PB-ENTRY-BATCH     TO BL-BATCH-NO
  8231         MOVE PB-BATCH-SEQ-NO    TO BL-BATCH-SEQ
  8232     END-IF
  8233     MOVE PI-CARRIER             TO BL-CARRIER
  8234     MOVE PI-GROUPING            TO BL-GROUP
  8235     MOVE PI-STATE               TO BL-STATE
  8236     MOVE PI-ACCOUNT             TO BL-ACCOUNT
  8237     IF PI-CERT-EFF-DT NOT = LOW-VALUES
  8238        MOVE PI-CERT-EFF-DT      TO DC-BIN-DATE-1
  8239        MOVE ' '                 TO DC-OPTION-CODE
  8240        PERFORM 9700-date-link
  8241        IF NO-CONVERSION-ERROR
  8242           MOVE DC-GREG-DATE-B-EDIT
  8243                                 TO BL-EFF-DT
  8244        END-IF
  8245     END-IF
  8246     MOVE PI-CERT-NO             TO BL-CERT-NO
  8247     MOVE SPACES                 TO BL-RESP-NO
  8248     MOVE LTRIDI                 TO BL-LETTER-ID
  8249     MOVE W-NUMBER-OF-COPIES     TO BL-NO-OF-COPIES
  8250     MOVE PI-PROCESSOR-ID        TO BL-PROC-ID
  8251*    MOVE 'ALWA'                 TO BL-PROC-ID
  8252     MOVE PI-COMPANY-ID          TO BL-COMP-ID
  8253*    MOVE IFF-PRINT-NOW-SW       TO BL-PRINT-NOW-SW
  8254*    MOVE IFF-ENC-CD             TO BL-ENC-CD
  8255     MOVE PI-ENCCODE             TO BL-ENC-CD
  8256     IF EIBAID = DFHPF4
  8257        MOVE 'B'                 TO BL-WRITE-ERARCH
  8258     ELSE
  8259        MOVE 'T'                 TO BL-WRITE-ERARCH
  8260     END-IF
  8261     MOVE CERTIDI                TO BL-CERT-FORM-ID
  8262     MOVE W-ARCH-NUMBER          TO BL-ENDT-ARCH-NO
  8263     MOVE 'ISS ENDT'             TO BL-SOURCE-SCREEN
  8264     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  8265        IF REACD-IN (S1) NOT = LOW-VALUES
  8266           MOVE REACD-IN (S1)    TO BL-REASON-CODE (S1)
  8267        END-IF
  8268     END-PERFORM
  8269*****************************************
  8270* Invoke the LETTER business logic
  8271*****************************************
  8272
  8273* exec cics link
  8274*       program('NSRASBL')
  8275*       commarea(srch-commarea)
  8276*    end-exec.
  8277     MOVE LENGTH OF
  8278      srch-commarea
  8279       TO DFHEIV11
  8280     MOVE 'NSRASBL' TO DFHEIV1
  8281*    MOVE '."C                   (   #00007625' TO DFHEIV0
  8282     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 145
* EL6318.cbl
  8283     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8284     MOVE X'2020233030303037363235' TO DFHEIV0(25:11)
  8285     CALL 'kxdfhei1' USING DFHEIV0,
  8286           DFHEIV1,
  8287           srch-commarea,
  8288           DFHEIV11,
  8289           DFHEIV99,
  8290           DFHEIV99,
  8291           DFHEIV99,
  8292           DFHEIV99
  8293     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8294
  8295     .
  8296 1100-EXIT.
  8297     EXIT.
  8298 1500-GET-ARCH-NO.
  8299     MOVE SPACES                 TO ELCNTL-KEY
  8300     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  8301     MOVE '1'                    TO CNTL-REC-TYPE
  8302     MOVE ZEROS                  TO CNTL-SEQ
  8303
  8304* EXEC CICS READ
  8305*         DATASET    (WS-ELCNTL-FILE-ID)
  8306*         SET        (ADDRESS OF CONTROL-FILE)
  8307*         RIDFLD     (ELCNTL-KEY)
  8308*         UPDATE
  8309*         RESP       (WS-RESPONSE)
  8310*    END-EXEC
  8311*    MOVE '&"S        EU         (  N#00007637' TO DFHEIV0
  8312     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8313     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8314     MOVE X'204E233030303037363337' TO DFHEIV0(25:11)
  8315     CALL 'kxdfhei1' USING DFHEIV0,
  8316           WS-ELCNTL-FILE-ID,
  8317           DFHEIV20,
  8318           DFHEIV99,
  8319           ELCNTL-KEY,
  8320           DFHEIV99,
  8321           DFHEIV99,
  8322           DFHEIV99
  8323     SET ADDRESS OF CONTROL-FILE TO
  8324         DFHEIV20
  8325     MOVE EIBRESP  TO WS-RESPONSE
  8326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8327     IF RESP-NORMAL
  8328        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
  8329           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  8330        END-IF
  8331        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
  8332        MOVE CF-CREDIT-LAST-ARCH-NUM
  8333                                 TO W-ARCH-NUMBER
  8334
  8335* EXEC CICS REWRITE
  8336*          FROM      (CONTROL-FILE)
  8337*          DATASET   (WS-ELCNTL-FILE-ID)
  8338*       END-EXEC
  8339     MOVE LENGTH OF
  8340      CONTROL-FILE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 146
* EL6318.cbl
  8341       TO DFHEIV11
  8342*    MOVE '&& L                  %   #00007651' TO DFHEIV0
  8343     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8344     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8345     MOVE X'2020233030303037363531' TO DFHEIV0(25:11)
  8346     CALL 'kxdfhei1' USING DFHEIV0,
  8347           WS-ELCNTL-FILE-ID,
  8348           CONTROL-FILE,
  8349           DFHEIV11,
  8350           DFHEIV99
  8351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8352     END-IF
  8353     .
  8354 1500-EXIT.
  8355     EXIT.
  8356
  8357
  8358 1700-WRITE-CERT-NOTE      SECTION.
  8359
  8360     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY.
  8361     MOVE ZERO           TO ERCNOT-SEQ.
  8362     SET TB-INDX         DOWN BY 1.
  8363     SET TB-INDX1        TO TB-INDX.
  8364
  8365****DELETE CURRENT CERT NOTES
  8366 1700-LOOP.
  8367
  8368* EXEC CICS READ
  8369*        DATASET (WS-ERCNOT-FILE-ID)
  8370*        RIDFLD  (ERCNOT-KEY)
  8371*        SET     (ADDRESS OF CERT-NOTE-FILE)
  8372*        RESP    (WS-RESPONSE)
  8373*        GTEQ
  8374*    END-EXEC.
  8375*    MOVE '&"S        G          (  N#00007670' TO DFHEIV0
  8376     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8377     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8378     MOVE X'204E233030303037363730' TO DFHEIV0(25:11)
  8379     CALL 'kxdfhei1' USING DFHEIV0,
  8380           WS-ERCNOT-FILE-ID,
  8381           DFHEIV20,
  8382           DFHEIV99,
  8383           ERCNOT-KEY,
  8384           DFHEIV99,
  8385           DFHEIV99,
  8386           DFHEIV99
  8387     SET ADDRESS OF CERT-NOTE-FILE TO
  8388         DFHEIV20
  8389     MOVE EIBRESP  TO WS-RESPONSE
  8390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8391
  8392
  8393     IF NOT RESP-NORMAL
  8394        GO TO 1700-ENDDEL
  8395     END-IF
  8396
  8397     MOVE CZ-CONTROL-PRIMARY     TO ERCNOT-KEY.
  8398
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 147
* EL6318.cbl
  8399     IF ERCNOT-PARTIAL-KEY NOT = SV-PARTIAL-KEY
  8400         GO TO 1700-ENDDEL
  8401     END-IF.
  8402
  8403
  8404* EXEC CICS DELETE
  8405*        DATASET (WS-ERCNOT-FILE-ID)
  8406*        RIDFLD  (ERCNOT-KEY)
  8407*    END-EXEC.
  8408*    MOVE '&(  R                 &   #00007688' TO DFHEIV0
  8409     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  8410     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8411     MOVE X'2020233030303037363838' TO DFHEIV0(25:11)
  8412     CALL 'kxdfhei1' USING DFHEIV0,
  8413           WS-ERCNOT-FILE-ID,
  8414           ERCNOT-KEY,
  8415           DFHEIV99,
  8416           DFHEIV99,
  8417           DFHEIV99
  8418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8419
  8420
  8421     GO TO 1700-LOOP.
  8422
  8423 1700-ENDDEL.
  8424
  8425
  8426* EXEC CICS GETMAIN
  8427*         LENGTH(ERCNOT-LENGTH)
  8428*         SET(ADDRESS OF CERT-NOTE-FILE)
  8429*         INITIMG(GETMAIN-SPACE)
  8430*    END-EXEC.
  8431*    MOVE ',"IL                  $   #00007697' TO DFHEIV0
  8432     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8433     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8434     MOVE X'2020233030303037363937' TO DFHEIV0(25:11)
  8435     CALL 'kxdfhei1' USING DFHEIV0,
  8436           DFHEIV20,
  8437           ERCNOT-LENGTH,
  8438           GETMAIN-SPACE
  8439     SET ADDRESS OF CERT-NOTE-FILE TO
  8440         DFHEIV20
  8441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8442
  8443
  8444     SET TB-INDX TO 1.
  8445     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY
  8446     MOVE +0             TO ERCNOT-SEQ
  8447
  8448     PERFORM VARYING TB-INDX FROM 1 BY 1
  8449             UNTIL TB-INDX > TB-INDX1
  8450        MOVE SPACES                 TO  CERT-NOTE-FILE
  8451        ADD 1                       TO  ERCNOT-SEQ
  8452        MOVE ERCNOT-KEY             TO  CZ-CONTROL-PRIMARY
  8453        MOVE  'CZ'                  TO  CZ-RECORD-ID
  8454        MOVE CERT-NT-TEXT (TB-INDX) TO  CZ-NOTE
  8455        MOVE CERT-NT-LAST-MAINT-BY (TB-INDX)
  8456                                    TO  CZ-LAST-MAINT-USER
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 148
* EL6318.cbl
  8457        MOVE CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  8458                                    TO  CZ-LAST-MAINT-HHMMSS
  8459        MOVE CERT-NT-LAST-MAINT-DT (TB-INDX)
  8460                                    TO  CZ-LAST-MAINT-DT
  8461
  8462
  8463* EXEC CICS WRITE
  8464*            DATASET(WS-ERCNOT-FILE-ID)
  8465*            FROM(CERT-NOTE-FILE)
  8466*            RIDFLD(ERCNOT-KEY)
  8467*       END-EXEC
  8468     MOVE LENGTH OF
  8469      CERT-NOTE-FILE
  8470       TO DFHEIV11
  8471*    MOVE '&$ L                  ''   #00007721' TO DFHEIV0
  8472     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8473     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8474     MOVE X'2020233030303037373231' TO DFHEIV0(25:11)
  8475     CALL 'kxdfhei1' USING DFHEIV0,
  8476           WS-ERCNOT-FILE-ID,
  8477           CERT-NOTE-FILE,
  8478           DFHEIV11,
  8479           ERCNOT-KEY,
  8480           DFHEIV99,
  8481           DFHEIV99
  8482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8483     END-PERFORM
  8484
  8485     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  8486     IF RESP-NORMAL
  8487        EVALUATE CM-NOTE-SW
  8488           WHEN '1'
  8489           WHEN '3'
  8490           WHEN '5'
  8491           WHEN '7'
  8492              SET NO-CERT-RW     TO TRUE
  8493           WHEN ' '
  8494              MOVE '1'           TO CM-NOTE-SW
  8495           WHEN '2'
  8496              MOVE '3'           TO CM-NOTE-SW
  8497           WHEN '4'
  8498              MOVE '5'           TO CM-NOTE-SW
  8499           WHEN '6'
  8500              MOVE '7'           TO CM-NOTE-SW
  8501        END-EVALUATE
  8502     END-IF
  8503     IF NOT NO-CERT-RW
  8504        PERFORM 1810-REWRITE-ELCERT
  8505                                 THRU 1810-EXIT
  8506     ELSE
  8507
  8508* EXEC CICS UNLOCK
  8509*          DATASET    (WS-ELCERT-FILE-ID)
  8510*       END-EXEC
  8511*    MOVE '&*                    #   #00007750' TO DFHEIV0
  8512     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  8513     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8514     MOVE X'2020233030303037373530' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 149
* EL6318.cbl
  8515     CALL 'kxdfhei1' USING DFHEIV0,
  8516           WS-ELCERT-FILE-ID,
  8517           DFHEIV99
  8518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8519     END-IF
  8520
  8521     .
  8522 1799-EXIT.
  8523     EXIT.
  8524
  8525 1800-READ-ELCERT-UPDATE.
  8526
  8527     MOVE PI-COMPANY-CD          TO  W-CERT-COMPANY-CD.
  8528     MOVE PI-CRTO-CARRIER        TO  W-CERT-CARRIER.
  8529     MOVE PI-CRTO-GROUPING       TO  W-CERT-GROUPING.
  8530     MOVE PI-CRTO-STATE          TO  W-CERT-STATE.
  8531     MOVE PI-CRTO-ACCOUNT        TO  W-CERT-ACCOUNT.
  8532     MOVE PI-CRTO-CERT-EFF-DT    TO  W-CERT-CERT-EFF-DT.
  8533     MOVE PI-CRTO-CERT-PRIME     TO  W-CERT-CERT-PRIME.
  8534     MOVE PI-CRTO-CERT-SFX       TO  W-CERT-CERT-SFX.
  8535
  8536
  8537* EXEC CICS READ
  8538*        UPDATE
  8539*        DATASET  (WS-ELCERT-FILE-ID)
  8540*        RIDFLD   (WS-ELCERT-KEY)
  8541*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8542*        RESP     (WS-RESPONSE)
  8543*    END-EXEC
  8544*    MOVE '&"S        EU         (  N#00007770' TO DFHEIV0
  8545     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8546     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8547     MOVE X'204E233030303037373730' TO DFHEIV0(25:11)
  8548     CALL 'kxdfhei1' USING DFHEIV0,
  8549           WS-ELCERT-FILE-ID,
  8550           DFHEIV20,
  8551           DFHEIV99,
  8552           WS-ELCERT-KEY,
  8553           DFHEIV99,
  8554           DFHEIV99,
  8555           DFHEIV99
  8556     SET ADDRESS OF CERTIFICATE-MASTER TO
  8557         DFHEIV20
  8558     MOVE EIBRESP  TO WS-RESPONSE
  8559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8560
  8561     .
  8562 1800-EXIT.
  8563     EXIT.
  8564
  8565 1810-REWRITE-ELCERT.
  8566
  8567
  8568* EXEC CICS REWRITE
  8569*        FROM     (CERTIFICATE-MASTER)
  8570*        DATASET  (WS-ELCERT-FILE-ID)
  8571*        RESP     (WS-RESPONSE)
  8572*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 150
* EL6318.cbl
  8573     MOVE LENGTH OF
  8574      CERTIFICATE-MASTER
  8575       TO DFHEIV11
  8576*    MOVE '&& L                  %  N#00007784' TO DFHEIV0
  8577     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8578     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8579     MOVE X'204E233030303037373834' TO DFHEIV0(25:11)
  8580     CALL 'kxdfhei1' USING DFHEIV0,
  8581           WS-ELCERT-FILE-ID,
  8582           CERTIFICATE-MASTER,
  8583           DFHEIV11,
  8584           DFHEIV99
  8585     MOVE EIBRESP  TO WS-RESPONSE
  8586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8587
  8588
  8589     .
  8590 1810-EXIT.
  8591     EXIT.
  8592
  8593 8100-SEND-INITIAL-MAP.
  8594     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8595     MOVE '5'                    TO DC-OPTION-CODE.
  8596     PERFORM 9700-DATE-LINK.
  8597     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  8598     MOVE EIBTIME                TO TIME-IN.
  8599     MOVE TIME-OUT               TO TIMEO.
  8600     MOVE -1                     TO SIGREQL
  8601     IF PI-PROCESSOR-IS-CSR-SUPER
  8602        perform varying s1 from +1 by +1 until
  8603           s1 > +12
  8604           MOVE AL-UANON            TO reacda (s1)
  8605        end-perform
  8606     END-IF
  8607     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  8608     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O.
  8609
  8610* EXEC CICS SEND
  8611*        MAP      (MAP-NAME)
  8612*        MAPSET   (MAPSET-NAME)
  8613*        FROM     (EL631KO)
  8614*        ERASE
  8615*        CURSOR
  8616*    END-EXEC.
  8617     MOVE LENGTH OF
  8618      EL631KO
  8619       TO DFHEIV12
  8620     MOVE -1
  8621       TO DFHEIV11
  8622*    MOVE '8$     CT  E    H L F ,   #00007810' TO DFHEIV0
  8623     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  8624     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8625     MOVE X'2020233030303037383130' TO DFHEIV0(25:11)
  8626     CALL 'kxdfhei1' USING DFHEIV0,
  8627           MAP-NAME,
  8628           EL631KO,
  8629           DFHEIV12,
  8630           MAPSET-NAME,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 151
* EL6318.cbl
  8631           DFHEIV99,
  8632           DFHEIV99,
  8633           DFHEIV99,
  8634           DFHEIV11,
  8635           DFHEIV99,
  8636           DFHEIV99,
  8637           DFHEIV99
  8638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8639
  8640     GO TO 9100-RETURN-TRAN.
  8641 8200-SEND-DATAONLY.
  8642     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8643     MOVE '5'                    TO DC-OPTION-CODE.
  8644     PERFORM 9700-DATE-LINK.
  8645     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  8646     MOVE EIBTIME                TO TIME-IN.
  8647     MOVE TIME-OUT               TO TIMEO.
  8648     MOVE -1                     TO PFENTRL
  8649     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O
  8650     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O
  8651
  8652* EXEC CICS SEND
  8653*        MAP      (MAP-NAME)
  8654*        MAPSET   (MAPSET-NAME)
  8655*        FROM     (EL631KO)
  8656*        DATAONLY
  8657*        ERASEAUP
  8658*        CURSOR
  8659*    END-EXEC.
  8660     MOVE LENGTH OF
  8661      EL631KO
  8662       TO DFHEIV12
  8663     MOVE -1
  8664       TO DFHEIV11
  8665*    MOVE '8$D    CT  A    H L F ,   #00007828' TO DFHEIV0
  8666     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  8667     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8668     MOVE X'2020233030303037383238' TO DFHEIV0(25:11)
  8669     CALL 'kxdfhei1' USING DFHEIV0,
  8670           MAP-NAME,
  8671           EL631KO,
  8672           DFHEIV12,
  8673           MAPSET-NAME,
  8674           DFHEIV99,
  8675           DFHEIV99,
  8676           DFHEIV99,
  8677           DFHEIV11,
  8678           DFHEIV99,
  8679           DFHEIV99,
  8680           DFHEIV99
  8681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8682
  8683     GO TO 9100-RETURN-TRAN.
  8684 8300-SEND-TEXT.
  8685
  8686* EXEC CICS SEND TEXT
  8687*        FROM     (LOGOFF-TEXT)
  8688*        LENGTH   (LOGOFF-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 152
* EL6318.cbl
  8689*        ERASE
  8690*        FREEKB
  8691*    END-EXEC.
  8692*    MOVE '8&      T  E F  H   F -   #00007838' TO DFHEIV0
  8693     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  8694     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  8695     MOVE X'2020233030303037383338' TO DFHEIV0(25:11)
  8696     CALL 'kxdfhei1' USING DFHEIV0,
  8697           LOGOFF-TEXT,
  8698           LOGOFF-LENGTH,
  8699           DFHEIV99,
  8700           DFHEIV99,
  8701           DFHEIV99,
  8702           DFHEIV99,
  8703           DFHEIV99,
  8704           DFHEIV99,
  8705           DFHEIV99,
  8706           DFHEIV99,
  8707           DFHEIV99,
  8708           DFHEIV99
  8709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8710
  8711
  8712* EXEC CICS RETURN
  8713*    END-EXEC.
  8714*    MOVE '.(                    ''   #00007844' TO DFHEIV0
  8715     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8716     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8717     MOVE X'2020233030303037383434' TO DFHEIV0(25:11)
  8718     CALL 'kxdfhei1' USING DFHEIV0,
  8719           DFHEIV99,
  8720           DFHEIV99,
  8721           DFHEIV99,
  8722           DFHEIV99,
  8723           DFHEIV99,
  8724           DFHEIV99
  8725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8726
  8727 8800-UNAUTHORIZED-ACCESS.
  8728     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  8729     GO TO 8300-SEND-TEXT.
  8730 8810-PF23.
  8731     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  8732     MOVE XCTL-005               TO PGM-NAME.
  8733     GO TO 9300-XCTL.
  8734 9000-RETURN-CICS.
  8735
  8736* EXEC CICS RETURN
  8737*    END-EXEC.
  8738*    MOVE '.(                    ''   #00007854' TO DFHEIV0
  8739     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8740     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8741     MOVE X'2020233030303037383534' TO DFHEIV0(25:11)
  8742     CALL 'kxdfhei1' USING DFHEIV0,
  8743           DFHEIV99,
  8744           DFHEIV99,
  8745           DFHEIV99,
  8746           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 153
* EL6318.cbl
  8747           DFHEIV99,
  8748           DFHEIV99
  8749     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8750
  8751 9100-RETURN-TRAN.
  8752     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  8753     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
  8754
  8755* EXEC CICS RETURN
  8756*        TRANSID    (TRANS-ID)
  8757*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8758*        LENGTH     (1300)
  8759*        LENGTH     (PI-COMM-LENGTH)
  8760*    END-EXEC.
  8761     MOVE 1300
  8762       TO DFHEIV11
  8763*    MOVE '.(CT                  ''   #00007859' TO DFHEIV0
  8764     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  8765     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8766     MOVE X'2020233030303037383539' TO DFHEIV0(25:11)
  8767     CALL 'kxdfhei1' USING DFHEIV0,
  8768           TRANS-ID,
  8769           PROGRAM-INTERFACE-BLOCK,
  8770           DFHEIV11,
  8771           DFHEIV99,
  8772           DFHEIV99,
  8773           DFHEIV99
  8774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8775
  8776 9200-RETURN-MAIN-MENU.
  8777     MOVE XCTL-626               TO PGM-NAME.
  8778     GO TO 9300-XCTL.
  8779 9300-XCTL.
  8780
  8781* EXEC CICS XCTL
  8782*        PROGRAM    (PGM-NAME)
  8783*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8784*        LENGTH     (PI-COMM-LENGTH)
  8785*    END-EXEC.
  8786*    MOVE '.$C                   %   #00007869' TO DFHEIV0
  8787     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8788     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8789     MOVE X'2020233030303037383639' TO DFHEIV0(25:11)
  8790     CALL 'kxdfhei1' USING DFHEIV0,
  8791           PGM-NAME,
  8792           PROGRAM-INTERFACE-BLOCK,
  8793           PI-COMM-LENGTH,
  8794           DFHEIV99
  8795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8796
  8797 9400-CLEAR.
  8798     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  8799
  8800* EXEC CICS XCTL
  8801*        PROGRAM    (PGM-NAME)
  8802*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8803*        LENGTH     (PI-COMM-LENGTH)
  8804*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 154
* EL6318.cbl
  8805*    MOVE '.$C                   %   #00007876' TO DFHEIV0
  8806     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8807     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8808     MOVE X'2020233030303037383736' TO DFHEIV0(25:11)
  8809     CALL 'kxdfhei1' USING DFHEIV0,
  8810           PGM-NAME,
  8811           PROGRAM-INTERFACE-BLOCK,
  8812           PI-COMM-LENGTH,
  8813           DFHEIV99
  8814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8815
  8816 9500-PF12.
  8817     MOVE XCTL-010               TO PGM-NAME.
  8818     GO TO 9300-XCTL.
  8819 9600-PGMID-ERROR.
  8820
  8821* EXEC CICS HANDLE CONDITION
  8822*        PGMIDERR    (8300-SEND-TEXT)
  8823*    END-EXEC.
  8824*    MOVE '"$L                   ! " #00007885' TO DFHEIV0
  8825     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  8826     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8827     MOVE X'2220233030303037383835' TO DFHEIV0(25:11)
  8828     CALL 'kxdfhei1' USING DFHEIV0
  8829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8830
  8831     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  8832     MOVE ' '                    TO PI-ENTRY-CD-1.
  8833     MOVE XCTL-005               TO PGM-NAME.
  8834     MOVE PGM-NAME               TO LOGOFF-PGM.
  8835     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  8836     GO TO 9300-XCTL.
  8837 9700-DATE-LINK.
  8838     MOVE LINK-ELDATCV           TO PGM-NAME.
  8839
  8840* EXEC CICS LINK
  8841*        PROGRAM    (PGM-NAME)
  8842*        COMMAREA   (DATE-CONVERSION-DATA)
  8843*        LENGTH     (DC-COMM-LENGTH)
  8844*    END-EXEC.
  8845*    MOVE '."C                   (   #00007896' TO DFHEIV0
  8846     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8847     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8848     MOVE X'2020233030303037383936' TO DFHEIV0(25:11)
  8849     CALL 'kxdfhei1' USING DFHEIV0,
  8850           PGM-NAME,
  8851           DATE-CONVERSION-DATA,
  8852           DC-COMM-LENGTH,
  8853           DFHEIV99,
  8854           DFHEIV99,
  8855           DFHEIV99,
  8856           DFHEIV99
  8857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8858
  8859 9900-ERROR-FORMAT.
  8860     IF NOT EMI-ERRORS-COMPLETE
  8861        MOVE LINK-001            TO PGM-NAME
  8862
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 155
* EL6318.cbl
  8863* EXEC CICS LINK
  8864*           PROGRAM    (PGM-NAME)
  8865*           COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  8866*           LENGTH     (EMI-COMM-LENGTH)
  8867*       END-EXEC
  8868*    MOVE '."C                   (   #00007904' TO DFHEIV0
  8869     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8870     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8871     MOVE X'2020233030303037393034' TO DFHEIV0(25:11)
  8872     CALL 'kxdfhei1' USING DFHEIV0,
  8873           PGM-NAME,
  8874           ERROR-MESSAGE-INTERFACE-BLOCK,
  8875           EMI-COMM-LENGTH,
  8876           DFHEIV99,
  8877           DFHEIV99,
  8878           DFHEIV99,
  8879           DFHEIV99
  8880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8881     END-IF
  8882     .
  8883 9900-EXIT.
  8884     EXIT.
  8885 9990-ABEND.
  8886     MOVE LINK-004               TO PGM-NAME.
  8887     MOVE DFHEIBLK               TO EMI-LINE1.
  8888
  8889* EXEC CICS LINK
  8890*        PROGRAM   (PGM-NAME)
  8891*        COMMAREA  (EMI-LINE1)
  8892*        LENGTH    (72)
  8893*    END-EXEC.
  8894     MOVE 72
  8895       TO DFHEIV11
  8896*    MOVE '."C                   (   #00007916' TO DFHEIV0
  8897     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8898     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8899     MOVE X'2020233030303037393136' TO DFHEIV0(25:11)
  8900     CALL 'kxdfhei1' USING DFHEIV0,
  8901           PGM-NAME,
  8902           EMI-LINE1,
  8903           DFHEIV11,
  8904           DFHEIV99,
  8905           DFHEIV99,
  8906           DFHEIV99,
  8907           DFHEIV99
  8908     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8909
  8910     GO TO 8200-SEND-DATAONLY.
  8911
  8912* GOBACK.
  8913     MOVE '9%                    "   ' TO DFHEIV0
  8914     MOVE 'EL6318' TO DFHEIV1
  8915     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8916     GOBACK.
  8917 9995-SECURITY-VIOLATION.
  8918*                            COPY ELCSCTP.
  8919******************************************************************
  8920*                                                                *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 156
* EL6318.cbl
  8921*                            ELCSCTP                             *
  8922*                            VMOD=2.001                          *
  8923*                                                                *
  8924*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  8925******************************************************************
  8926
  8927
  8928     MOVE EIBDATE          TO SM-JUL-DATE.
  8929     MOVE EIBTRMID         TO SM-TERMID.
  8930     MOVE THIS-PGM         TO SM-PGM.
  8931     MOVE EIBTIME          TO TIME-IN.
  8932     MOVE TIME-OUT         TO SM-TIME.
  8933     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  8934
  8935
  8936* EXEC CICS LINK
  8937*         PROGRAM  ('EL003')
  8938*         COMMAREA (SECURITY-MESSAGE)
  8939*         LENGTH   (80)
  8940*    END-EXEC.
  8941     MOVE 'EL003' TO DFHEIV1
  8942     MOVE 80
  8943       TO DFHEIV11
  8944*    MOVE '."C                   (   #00007941' TO DFHEIV0
  8945     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8946     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8947     MOVE X'2020233030303037393431' TO DFHEIV0(25:11)
  8948     CALL 'kxdfhei1' USING DFHEIV0,
  8949           DFHEIV1,
  8950           SECURITY-MESSAGE,
  8951           DFHEIV11,
  8952           DFHEIV99,
  8953           DFHEIV99,
  8954           DFHEIV99,
  8955           DFHEIV99
  8956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8957
  8958
  8959******************************************************************
  8960
  8961 9995-EXIT.
  8962     EXIT.
  8963
  8964 9999-DFHBACK SECTION.
  8965     MOVE '9%                    "   ' TO DFHEIV0
  8966     MOVE 'EL6318' TO DFHEIV1
  8967     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8968     GOBACK.
  8969 9999-DFHEXIT.
  8970     IF DFHEIGDJ EQUAL 0001
  8971         NEXT SENTENCE
  8972     ELSE IF DFHEIGDJ EQUAL 2
  8973         GO TO 8300-SEND-TEXT
  8974         DEPENDING ON DFHEIGDI.
  8975     MOVE '9%                    "   ' TO DFHEIV0
  8976     MOVE 'EL6318' TO DFHEIV1
  8977     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8978     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:24 Page 157
* EL6318.cbl
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       35420     Code:       20433
