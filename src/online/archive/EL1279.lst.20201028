* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page   1
* EL1279.cbl
* Options: int("EL1279.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL1279.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL1279.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL1279.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL1279.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/06/95 08:37:08.
     7*                            VMOD=2.005.
     8*
     9*AUTHOR.           LOGIC,INC.
    10*                  DALLAS,TEXAS.
    11
    12*DATE-COMPILED.
    13*SECURITY.   *****************************************************
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page   2
* EL1279.cbl
    14*            *                                                   *
    15*            * THIS PROGRAM IS THE PROPERTY OF LOCIC, INC. *
    16*            *                                                   *
    17*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    18*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    19*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    20*            *                                                   *
    21*            *****************************************************
    22*
    23*REMARKS.     TRANSACTION - EXXF - CERTIFICATE NOTE MAINTENANCE.
    24*
    25******************************************************************
    26*                   C H A N G E   L O G
    27*
    28* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    29*-----------------------------------------------------------------
    30*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    31* EFFECTIVE    NUMBER
    32*-----------------------------------------------------------------
    33* 100109   2008101400003   AJRA  NEW CERT NOTE SCREEN
    34* 010416   2015072900002   TANA  ADD PF7 TO CLAIM MEMO SCREEN
    35******************************************************************
    36*
    37 ENVIRONMENT DIVISION.
    38
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page   3
* EL1279.cbl
    40 DATA DIVISION.
    41 WORKING-STORAGE SECTION.
    42 01  DFH-START PIC X(04).
    43 77  FILLER  PIC X(32)  VALUE '********************************'.
    44 77  FILLER  PIC X(32)  VALUE '*     EL1279 WORKING STORAGE   *'.
    45 77  FILLER  PIC X(32)  VALUE '********* VMOD=2.005 ***********'.
    46
    47*    COPY ELCSCTM.
    48******************************************************************
    49*                                                                *
    50*                                                                *
    51*                            ELCSCTM                             *
    52*                            VMOD=2.001                          *
    53*                                                                *
    54*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    55*                                                                *
    56******************************************************************
    57 01  SECURITY-MESSAGE.
    58     12  FILLER                          PIC X(30)
    59            VALUE '** LOGIC SECURITY VIOLATION -'.
    60     12  SM-READ                         PIC X(6).
    61     12  FILLER                          PIC X(5)
    62            VALUE ' PGM='.
    63     12  SM-PGM                          PIC X(6).
    64     12  FILLER                          PIC X(5)
    65            VALUE ' OPR='.
    66     12  SM-PROCESSOR-ID                 PIC X(4).
    67     12  FILLER                          PIC X(6)
    68            VALUE ' TERM='.
    69     12  SM-TERMID                       PIC X(4).
    70     12  FILLER                          PIC XX   VALUE SPACE.
    71     12  SM-JUL-DATE                     PIC 9(5).
    72     12  FILLER                          PIC X    VALUE SPACE.
    73     12  SM-TIME                         PIC 99.99.
    74
    75*    COPY ELCSCRTY.
    76******************************************************************
    77*                                                                *
    78*                                                                *
    79*                            ELCSCRTY                            *
    80*                            VMOD=2.001                          *
    81*                                                                *
    82*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    83*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    84*        SAVED IN PI-SECURITY-ADDRESS.                           *
    85*                                                                *
    86******************************************************************
    87 01  SECURITY-CONTROL.
    88     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    89     12  FILLER                       PIC XX    VALUE 'SC'.
    90     12  SC-CREDIT-CODES.
    91         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    92             20  SC-CREDIT-DISPLAY    PIC X.
    93             20  SC-CREDIT-UPDATE     PIC X.
    94     12  SC-CLAIMS-CODES.
    95         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
    96             20  SC-CLAIMS-DISPLAY    PIC X.
    97             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page   4
* EL1279.cbl
    98
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page   5
* EL1279.cbl
   100 01  STANDARD-AREAS.
   101     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   102     12  MAP-NAME                PIC X(8)    VALUE 'EL1279A'.
   103     12  MAPSET-NAME             PIC X(8)    VALUE 'EL1279S '.
   104     12  SCRN-NUMBER             PIC X(4)    VALUE '127I'.
   105     12  TRANS-ID                PIC X(4)    VALUE 'EXXF'.
   106     12  THIS-PGM                PIC X(8)    VALUE 'EL1279'.
   107     12  PGM-NAME                PIC X(8).
   108     12  PGM-EL1276              PIC X(8)    VALUE 'EL1276'.
   109
   110     12  PGM-EL1284              PIC X(8)    VALUE 'EL1284'.
   111     12  ERCNOT-FILE-ID          PIC X(8)    VALUE 'ERCNOT'.
   112     12  ELCERT-FILE-ID          PIC X(8)    VALUE 'ELCERT'.
   113     12  QID.
   114         16  QID-TERM            PIC X(4).
   115         16  FILLER              PIC X(4)    VALUE '127I'.
   116     12  QID-ITEM                PIC S9(4)   COMP VALUE +0.
   117     12  SC-ITEM                 PIC S9(4)   COMP VALUE +1.
   118     12  WS-LINE                 PIC 9(3)    VALUE 0.
   119     12  WS-BLANK-LINES          PIC S9(4)   COMP VALUE +0.
   120
   121 01  WORK-AREA.
   122     12  SAVE-DATE           PIC X(8)    VALUE SPACES.
   123     12  SAVE-BIN-DATE       PIC X(2)    VALUE SPACES.
   124
   125     12  ERCNOT-LENGTH           PIC S9(4)   COMP VALUE +150.
   126     12  ERCNOT-KEY-LENGTH       PIC S9(4)   COMP VALUE +36.
   127     12  ERCNOT-START-LENGTH     PIC S9(4)   COMP VALUE +34.
   128     12  ERCNOT-KEY.
   129         16  ERCNOT-PARTIAL-KEY.
   130             20 ERCNOT-COMPANY-CD    PIC X.
   131             20 ERCNOT-CARRIER       PIC X.
   132             20 ERCNOT-GROUPING      PIC X(06).
   133             20 ERCNOT-STATE         PIC XX.
   134             20 ERCNOT-ACCOUNT       PIC X(10).
   135             20 ERCNOT-EFF-DT        PIC XX.
   136             20 ERCNOT-CERT-NO.
   137                25 ERCNOT-CERT-PRIME PIC X(10).
   138                25 ERCNOT-CERT-SFX   PIC X.
   139             20 ERCNOT-REC-TYP       PIC X.
   140         16 ERCNOT-SEQ           PIC S9(4) COMP.
   141     12  SV-PRIOR-KEY.
   142         20 SV-COMPANY-CD            PIC X.
   143         20 SV-CARRIER               PIC X.
   144         20 SV-GROUPING              PIC X(06).
   145         20 SV-STATE                 PIC XX.
   146         20 SV-ACCOUNT               PIC X(10).
   147         20 SV-EFF-DT                PIC XX.
   148         20 SV-CERT-NO.
   149            25 SV-CERT-PRIME         PIC X(10).
   150            25 SV-CERT-SFX           PIC X(1).
   151         20 SV-REC-TYP               PIC X.
   152     12  ELCERT-KEY.
   153         16  ELCERT-COMPANY-CD        PIC X.
   154         16  ELCERT-CARRIER           PIC X.
   155         16  ELCERT-GROUPING          PIC X(6).
   156         16  ELCERT-STATE             PIC XX.
   157         16  ELCERT-ACCOUNT           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page   6
* EL1279.cbl
   158         16  ELCERT-EFF-DT            PIC XX.
   159         16  ELCERT-CERT-NO.
   160             20  ELCERT-CERT-PRIME    PIC X(10).
   161             20  ELCERT-CERT-SFX      PIC X.
   162
   163     12  TIME-IN                 PIC S9(7).
   164     12  TIME-SPLIT REDEFINES TIME-IN.
   165         16  FILLER              PIC X.
   166         16  TIME-OUT            PIC 99V99.
   167         16  FILLER              PIC X(2).
   168     12  XCTL-005                PIC X(8)    VALUE 'EL005'.
   169     12  XCTL-126                PIC X(8)    VALUE 'EL126'.
   170     12  LINK-001                PIC X(8)    VALUE 'EL001'.
   171     12  LINK-004                PIC X(8)    VALUE 'EL004'.
   172     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   173     12  MAX-LINES               PIC 999     VALUE 300.
   174     12  NUM-LINES-PER-SCREEN    PIC 99      VALUE 10.
   175     12  TS-NUM-REC-IN-GROUP     PIC 99      VALUE 50.
   176     12  TS-GROUP-WORK           PIC 9(5)    VALUE 0  COMP-3.
   177     12  TS-LENGTH               PIC S9(4)   VALUE +3650 COMP.
   178     12  ROLL-COUNTER            PIC S999    VALUE +0 COMP-3.
   179     12  TEMP-CURR-LINE          PIC S9(3)   COMP-3.
   180     12  WS-SUB                  PIC S9(3)   COMP-3.
   181     12  WS-SUB1                 PIC S9(3)   COMP-3.
   182     12  WS-SCREEN-LINE          PIC X       VALUE 'N'.
   183         88 SCREEN-LINE-FOUND                VALUE 'Y'.
   184
   185     12  SCR-CLAIM-NOTE-TYPE.
   186         16  FILLER              PIC X(50)   VALUE
   187         '***********    C L A I M   C E R T   N O T E S    '.
   188         16  FILLER              PIC X(13)   VALUE
   189         '*************'.
   190     12  SCR-CERT-NOTE-TYPE.
   191         16  FILLER              PIC X(50)   VALUE
   192         '***********  C E R T I F I C A T E     N O T E S  '.
   193         16  FILLER              PIC X(13)   VALUE
   194         '*************'.
   195     12  SCR-PF6-CLAIM           PIC X(15)   VALUE
   196         'PF6=CLAIM NOTES'.
   197     12  SCR-PF6-CERT            PIC X(15)   VALUE
   198         'PF6=CERT NOTES'.
   199     12  SCR-CLAIM-YN            PIC X(12)   VALUE
   200         'CLAIM NOTES:'.
   201     12  SCR-CERT-YN             PIC X(12)   VALUE
   202         ' CERT NOTES:'.
   203
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page   7
* EL1279.cbl
   205 01  ERROR-MESSAGES.
   206     12  ER-0000             PIC X(04)       VALUE '0000'.
   207     12  ER-0004             PIC X(04)       VALUE '0004'.
   208     12  ER-0006             PIC X(04)       VALUE '0006'.
   209     12  ER-0008             PIC X(04)       VALUE '0008'.
   210     12  ER-0023             PIC X(04)       VALUE '0023'.
   211     12  ER-0029             PIC X(04)       VALUE '0029'.
   212     12  ER-0030             PIC X(04)       VALUE '0030'.
   213     12  ER-0031             PIC X(04)       VALUE '0031'.
   214     12  ER-0032             PIC X(04)       VALUE '0032'.
   215     12  ER-0033             PIC X(04)       VALUE '0033'.
   216     12  ER-0041             PIC X(04)       VALUE '0041'.
   217     12  ER-0044             PIC X(04)       VALUE '0044'.
   218     12  ER-0045             PIC X(04)       VALUE '0045'.
   219     12  ER-0047             PIC X(04)       VALUE '0047'.
   220     12  ER-0048             PIC X(04)       VALUE '0048'.
   221     12  ER-0049             PIC X(04)       VALUE '0049'.
   222     12  ER-0050             PIC X(04)       VALUE '0050'.
   223     12  ER-0051             PIC X(04)       VALUE '0051'.
   224     12  ER-0066             PIC X(04)       VALUE '0066'.
   225     12  ER-0067             PIC X(04)       VALUE '0067'.
   226     12  ER-0069             PIC X(04)       VALUE '0069'.
   227     12  ER-0070             PIC X(04)       VALUE '0070'.
   228     12  ER-0140             PIC X(04)       VALUE '0140'.
   229     12  ER-2954             PIC X(04)       VALUE '2954'.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page   8
* EL1279.cbl
   231*                       COPY ELCLOGOF.
   232******************************************************************
   233*                                                                *
   234*                                                                *
   235*                            ELCLOGOF.                           *
   236*                            VMOD=2.001                          *
   237*                                                                *
   238*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   239*                                                                *
   240******************************************************************
   241 01  CLASIC-LOGOFF.
   242     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   243     12  LOGOFF-TEXT.
   244         16  FILLER          PIC X(5)    VALUE SPACES.
   245         16  LOGOFF-MSG.
   246             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   247             20  FILLER      PIC X       VALUE SPACES.
   248             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   249         16  FILLER          PIC X(80)
   250           VALUE '* YOU ARE NOW LOGGED OFF'.
   251         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   252         16  FILLER          PIC X       VALUE QUOTE.
   253         16  LOGOFF-SYS-MSG  PIC X(17)
   254           VALUE 'S CLAS-IC SYSTEM '.
   255     12  TEXT-MESSAGES.
   256         16  UNACCESS-MSG    PIC X(29)
   257             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   258         16  PGMIDERR-MSG    PIC X(17)
   259             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page   9
* EL1279.cbl
   261*                       COPY ELCAID.
   262******************************************************************
   263*                                                                *
   264*                            ELCAID.                             *
   265*                            VMOD=2.001                          *
   266*                                                                *
   267*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   268*                                                                *
   269*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   270*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   271******************************************************************
   272
   273 01  DFHAID.
   274   02  DFHNULL   PIC  X  VALUE  ' '.
   275   02  DFHENTER  PIC  X  VALUE  QUOTE.
   276   02  DFHCLEAR  PIC  X  VALUE  '_'.
   277   02  DFHPEN    PIC  X  VALUE  '='.
   278   02  DFHOPID   PIC  X  VALUE  'W'.
   279   02  DFHPA1    PIC  X  VALUE  '%'.
   280   02  DFHPA2    PIC  X  VALUE  '>'.
   281   02  DFHPA3    PIC  X  VALUE  ','.
   282   02  DFHPF1    PIC  X  VALUE  '1'.
   283   02  DFHPF2    PIC  X  VALUE  '2'.
   284   02  DFHPF3    PIC  X  VALUE  '3'.
   285   02  DFHPF4    PIC  X  VALUE  '4'.
   286   02  DFHPF5    PIC  X  VALUE  '5'.
   287   02  DFHPF6    PIC  X  VALUE  '6'.
   288   02  DFHPF7    PIC  X  VALUE  '7'.
   289   02  DFHPF8    PIC  X  VALUE  '8'.
   290   02  DFHPF9    PIC  X  VALUE  '9'.
   291   02  DFHPF10   PIC  X  VALUE  ':'.
   292   02  DFHPF11   PIC  X  VALUE  '#'.
   293   02  DFHPF12   PIC  X  VALUE  '@'.
   294   02  DFHPF13   PIC  X  VALUE  'A'.
   295   02  DFHPF14   PIC  X  VALUE  'B'.
   296   02  DFHPF15   PIC  X  VALUE  'C'.
   297   02  DFHPF16   PIC  X  VALUE  'D'.
   298   02  DFHPF17   PIC  X  VALUE  'E'.
   299   02  DFHPF18   PIC  X  VALUE  'F'.
   300   02  DFHPF19   PIC  X  VALUE  'G'.
   301   02  DFHPF20   PIC  X  VALUE  'H'.
   302   02  DFHPF21   PIC  X  VALUE  'I'.
   303*00039    02  DFHPF22   PIC  X  VALUE  'Õ'.
   304   02  DFHPF22   PIC  X  VALUE  '['.
   305   02  DFHPF23   PIC  X  VALUE  '.'.
   306   02  DFHPF24   PIC  X  VALUE  '<'.
   307   02  DFHMSRE   PIC  X  VALUE  'X'.
   308   02  DFHSTRF   PIC  X  VALUE  'h'.
   309   02  DFHTRIG   PIC  X  VALUE  '"'.
   310 01  FILLER  REDEFINES DFHAID.
   311     12  FILLER                  PIC X(8).
   312     12  PF-VALUES OCCURS 24 TIMES       PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  10
* EL1279.cbl
   314*                       COPY ELCEMIB.
   315******************************************************************
   316*                                                                *
   317*                                                                *
   318*                            ELCEMIB.                            *
   319*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   320*                            VMOD=2.005                          *
   321*                                                                *
   322*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   323*                                                                *
   324******************************************************************
   325 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   326     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   327     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   328     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   329     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   330     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   331     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   332     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   333     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   334     12  EMI-SWITCH1             PIC X        VALUE '1'.
   335         88  EMI-NO-ERRORS                    VALUE '1'.
   336         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   337         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   338     12  EMI-SWITCH2             PIC X        VALUE '1'.
   339         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   340     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   341         88  EMI-AREA1-EMPTY                  VALUE '1'.
   342         88  EMI-AREA1-FULL                   VALUE '2'.
   343     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   344         88  EMI-AREA2-EMPTY                  VALUE '1'.
   345         88  EMI-AREA2-FULL                   VALUE '2'.
   346     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   347         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   348         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   349         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   350         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   351         88  EMI-BYPASS-FATALS                VALUE 'X'.
   352     12  EMI-ERROR-LINES.
   353         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   354         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   355         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   356         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   357             20  EMI-ERR-CODES OCCURS 10 TIMES.
   358                 24  EMI-ERR-NUM         PIC X(4).
   359                 24  EMI-FILLER          PIC X.
   360                 24  EMI-SEV             PIC X.
   361                 24  FILLER              PIC X.
   362             20  FILLER                  PIC X(02).
   363     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   364         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   365             20  EMI-ERROR-NUMBER    PIC X(4).
   366             20  EMI-FILL            PIC X.
   367             20  EMI-SEVERITY        PIC X.
   368             20  FILLER              PIC X.
   369             20  EMI-ERROR-TEXT.
   370                 24  EMI-TEXT-VARIABLE   PIC X(10).
   371                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  11
* EL1279.cbl
   372     12  EMI-SEVERITY-SAVE           PIC X.
   373         88  EMI-NOTE                    VALUE 'N'.
   374         88  EMI-WARNING                 VALUE 'W'.
   375         88  EMI-FORCABLE                VALUE 'F'.
   376         88  EMI-FATAL                   VALUE 'X'.
   377     12  EMI-MESSAGE-FLAG            PIC X.
   378         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   379         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   380     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   381     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   382         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   383         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   384         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   385     12  emi-claim-no                pic x(7).
   386     12  emi-claim-type              pic x(6).
   387     12  FILLER                      PIC X(124)  VALUE SPACES.
   388     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   389     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   390     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   391     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  12
* EL1279.cbl
   393*                       COPY ELCINTF.
   394******************************************************************
   395*                                                                *
   396*                                                                *
   397*                            ELCINTF.                            *
   398*                            VMOD=2.017                          *
   399*                                                                *
   400*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   401*                                                                *
   402*       LENGTH = 1024                                            *
   403*                                                                *
   404******************************************************************
   405*                   C H A N G E   L O G
   406*
   407* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   408*-----------------------------------------------------------------
   409*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   410* EFFECTIVE    NUMBER
   411*-----------------------------------------------------------------
   412* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   413******************************************************************
   414 01  PROGRAM-INTERFACE-BLOCK.
   415     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   416     12  PI-CALLING-PROGRAM              PIC X(8).
   417     12  PI-SAVED-PROGRAM-1              PIC X(8).
   418     12  PI-SAVED-PROGRAM-2              PIC X(8).
   419     12  PI-SAVED-PROGRAM-3              PIC X(8).
   420     12  PI-SAVED-PROGRAM-4              PIC X(8).
   421     12  PI-SAVED-PROGRAM-5              PIC X(8).
   422     12  PI-SAVED-PROGRAM-6              PIC X(8).
   423     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   424     12  PI-COMPANY-ID                   PIC XXX.
   425     12  PI-COMPANY-CD                   PIC X.
   426
   427     12  PI-COMPANY-PASSWORD             PIC X(8).
   428
   429     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   430
   431     12  PI-CONTROL-IN-PROGRESS.
   432         16  PI-CARRIER                  PIC X.
   433         16  PI-GROUPING                 PIC X(6).
   434         16  PI-STATE                    PIC XX.
   435         16  PI-ACCOUNT                  PIC X(10).
   436         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   437                                         PIC X(10).
   438         16  PI-CLAIM-CERT-GRP.
   439             20  PI-CLAIM-NO             PIC X(7).
   440             20  PI-CERT-NO.
   441                 25  PI-CERT-PRIME       PIC X(10).
   442                 25  PI-CERT-SFX         PIC X.
   443             20  PI-CERT-EFF-DT          PIC XX.
   444         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   445             20  PI-PLAN-CODE            PIC X(2).
   446             20  PI-REVISION-NUMBER      PIC X(3).
   447             20  PI-PLAN-EFF-DT          PIC X(2).
   448             20  PI-PLAN-EXP-DT          PIC X(2).
   449             20  FILLER                  PIC X(11).
   450         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  13
* EL1279.cbl
   451             20  PI-OE-REFERENCE-1.
   452                 25  PI-OE-REF-1-PRIME   PIC X(18).
   453                 25  PI-OE-REF-1-SUFF    PIC XX.
   454
   455     12  PI-SESSION-IN-PROGRESS          PIC X.
   456         88  CLAIM-SESSION                   VALUE '1'.
   457         88  CREDIT-SESSION                  VALUE '2'.
   458         88  WARRANTY-SESSION                VALUE '3'.
   459         88  MORTGAGE-SESSION                VALUE '4'.
   460         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   461
   462
   463*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   464
   465     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   466     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   467
   468     12  PI-CREDIT-USER                  PIC X.
   469         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   470         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   471
   472     12  PI-CLAIM-USER                   PIC X.
   473         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   474         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   475
   476     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   477         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   478         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   479         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   480         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   481         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   482
   483     12  PI-PROCESSOR-ID                 PIC X(4).
   484
   485     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   486
   487     12  PI-MEMBER-CAPTION               PIC X(10).
   488
   489     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   490         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   491
   492     12  PI-LIFE-OVERRIDE-L1             PIC X.
   493     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   494     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   495     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   496
   497     12  PI-AH-OVERRIDE-L1               PIC X.
   498     12  PI-AH-OVERRIDE-L2               PIC XX.
   499     12  PI-AH-OVERRIDE-L6               PIC X(6).
   500     12  PI-AH-OVERRIDE-L12              PIC X(12).
   501
   502     12  PI-NEW-SYSTEM                   PIC X(2).
   503
   504     12  PI-PRIMARY-CERT-NO              PIC X(11).
   505     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   506         88  PI-USES-PAID-TO                 VALUE '1'.
   507     12  PI-CRDTCRD-SYSTEM.
   508         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  14
* EL1279.cbl
   509             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   510             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   511         16  PI-CC-MONTH-END-DT          PIC XX.
   512     12  PI-PROCESSOR-PRINTER            PIC X(4).
   513
   514     12  PI-OE-REFERENCE-2.
   515         16  PI-OE-REF-2-PRIME           PIC X(10).
   516         16  PI-OE-REF-2-SUFF            PIC X.
   517
   518     12  PI-REM-TRM-CALC-OPTION          PIC X.
   519
   520     12  PI-LANGUAGE-TYPE                PIC X.
   521             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   522             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   523             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   524
   525     12  PI-POLICY-LINKAGE-IND           PIC X.
   526         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   527         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   528                                                   LOW-VALUES.
   529
   530     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   531     12  PI-CLAIM-PW-SESSION             PIC X(1).
   532         88  PI-CLAIM-CREDIT                 VALUE '1'.
   533         88  PI-CLAIM-CONVEN                 VALUE '2'.
   534
   535     12  PI-PROCESSOR-CSR-IND            PIC X.
   536         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   537         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   538
   539     12  FILLER                          PIC X(3).
   540
   541     12  PI-SYSTEM-LEVEL                 PIC X(145).
   542
   543     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   544         PI-SYSTEM-LEVEL.
   545
   546         16  PI-ENTRY-CODES.
   547             20  PI-ENTRY-CD-1           PIC X.
   548             20  PI-ENTRY-CD-2           PIC X.
   549
   550         16  PI-RETURN-CODES.
   551             20  PI-RETURN-CD-1          PIC X.
   552             20  PI-RETURN-CD-2          PIC X.
   553
   554         16  PI-UPDATE-STATUS-SAVE.
   555             20  PI-UPDATE-BY            PIC X(4).
   556             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   557
   558         16  PI-LOWER-CASE-LETTERS       PIC X.
   559             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   560
   561*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   562*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   563*            88  CARRIER-CLM-CNTL            VALUE '2'.
   564
   565         16  PI-CERT-ACCESS-CONTROL      PIC X.
   566             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  15
* EL1279.cbl
   567             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   568             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   569             88  ACCNT-CNTL                  VALUE '3'.
   570             88  CARR-ACCNT-CNTL             VALUE '4'.
   571
   572         16  PI-PROCESSOR-CAP-LIST.
   573             20  PI-SYSTEM-CONTROLS.
   574                24 PI-SYSTEM-DISPLAY     PIC X.
   575                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   576                24 PI-SYSTEM-MODIFY      PIC X.
   577                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   578             20  FILLER                  PIC XX.
   579             20  PI-DISPLAY-CAP          PIC X.
   580                 88  DISPLAY-CAP             VALUE 'Y'.
   581             20  PI-MODIFY-CAP           PIC X.
   582                 88  MODIFY-CAP              VALUE 'Y'.
   583             20  PI-MSG-AT-LOGON-CAP     PIC X.
   584                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   585             20  PI-FORCE-CAP            PIC X.
   586                 88  FORCE-CAP               VALUE 'Y'.
   587
   588         16  PI-PROGRAM-CONTROLS.
   589             20  PI-PGM-PRINT-OPT        PIC X.
   590             20  PI-PGM-FORMAT-OPT       PIC X.
   591             20  PI-PGM-PROCESS-OPT      PIC X.
   592             20  PI-PGM-TOTALS-OPT       PIC X.
   593
   594         16  PI-HELP-INTERFACE.
   595             20  PI-LAST-ERROR-NO        PIC X(4).
   596             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   597
   598         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   599             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   600
   601         16  PI-CR-CONTROL-IN-PROGRESS.
   602             20  PI-CR-CARRIER           PIC X.
   603             20  PI-CR-GROUPING          PIC X(6).
   604             20  PI-CR-STATE             PIC XX.
   605             20  PI-CR-ACCOUNT           PIC X(10).
   606             20  PI-CR-FIN-RESP          PIC X(10).
   607             20  PI-CR-TYPE              PIC X.
   608
   609         16  PI-CR-BATCH-NUMBER          PIC X(6).
   610
   611         16  PI-CR-MONTH-END-DT          PIC XX.
   612
   613         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   614             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   615             88  PI-ZERO-CARRIER             VALUE '1'.
   616             88  PI-ZERO-GROUPING            VALUE '2'.
   617             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   618
   619         16  PI-CARRIER-SECURITY         PIC X.
   620             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   621
   622         16  PI-ACCOUNT-SECURITY         PIC X(10).
   623             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   624             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  16
* EL1279.cbl
   625
   626         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   627             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   628                                         INDEXED BY PI-ACCESS-NDX
   629                                         PIC X.
   630
   631         16  PI-GA-BILLING-CONTROL       PIC X.
   632             88  PI-GA-BILLING               VALUE '1'.
   633
   634         16  PI-MAIL-PROCESSING          PIC X.
   635             88  PI-MAIL-YES                 VALUE 'Y'.
   636
   637         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   638
   639         16  PI-AR-SYSTEM.
   640             20  PI-AR-PROCESSING-CNTL   PIC X.
   641                 88  PI-AR-PROCESSING        VALUE 'Y'.
   642             20  PI-AR-SUMMARY-CODE      PIC X(6).
   643             20  PI-AR-MONTH-END-DT      PIC XX.
   644
   645         16  PI-MP-SYSTEM.
   646             20  PI-MORTGAGE-USER            PIC X.
   647                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   648                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   649             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   650                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   651                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   652                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   653                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   654                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   655             20  PI-MP-MONTH-END-DT          PIC XX.
   656             20  PI-MP-REFERENCE-NO.
   657                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   658                 24  PI-MP-REFERENCE-SFX     PIC XX.
   659
   660         16  PI-LABEL-CONTROL            PIC X(01).
   661             88  PI-CREATE-LABELS                    VALUE 'Y'.
   662             88  PI-BYPASS-LABELS                    VALUE 'N'.
   663
   664         16  PI-BILL-GROUPING-CODE       PIC X(01).
   665             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   666
   667         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   668             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   669             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   670
   671         16  FILLER                      PIC X(14).
   672
   673     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   674******************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  17
* EL1279.cbl
   676     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
   677         16  FILLER              PIC X(318).
   678         16  PI-TOTAL-LINES      PIC S9(3).
   679         16  PI-CURRENT-LINE     PIC S9(3)   COMP-3.
   680         16  PI-TEMP-STOR-ITEMS  PIC S9(4)   COMP.
   681         16  PI-UPDATE-SW        PIC X.
   682             88  PI-CHANGES-MADE             VALUE '1'.
   683         16  PI-PF5-PRESSED      PIC X.
   684             88 PF5-PRESSED                  VALUE 'Y'.
   685         16  PI-PF6-PRESSED      PIC X.
   686             88 PF6-PRESSED                  VALUE 'Y'.
   687         16  PI-CURR-NOTE-REC-TYPE PIC X.
   688             88 PI-CERT-NOTE                 VALUE '1'.
   689             88 PI-CLAIM-NOTE                VALUE '2'.
   690         16  PI-BILLING-NOTES-EXIST PIC X.
   691         16  PI-CERT-NOTES-EXIST    PIC X.
   692         16  PI-CLAIM-NOTES-EXIST   PIC X.
   693         16  PI-SET-NOTE-CHANGE  PIC X.
   694             88 PI-CHANGE-IN-NOTE-TYPE       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  18
* EL1279.cbl
   696*                          COPY ELCATTR.
   697******************************************************************
   698*                                                                *
   699*                            ELCATTR.                            *
   700*                            VMOD=2.001                          *
   701*                                                                *
   702*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   703*                                                                *
   704*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   705*                                                                *
   706*                   POS 1   P=PROTECTED                          *
   707*                           U=UNPROTECTED                        *
   708*                           S=ASKIP                              *
   709*                   POS 2   A=ALPHA/NUMERIC                      *
   710*                           N=NUMERIC                            *
   711*                   POS 3   N=NORMAL                             *
   712*                           B=BRIGHT                             *
   713*                           D=DARK                               *
   714*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   715*                           OF=MODIFIED DATA TAG OFF             *
   716*                                                                *
   717*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   718******************************************************************
   719 01  ATTRIBUTE-LIST.
   720     12  AL-PABOF            PIC X       VALUE 'Y'.
   721     12  AL-PABON            PIC X       VALUE 'Z'.
   722     12  AL-PADOF            PIC X       VALUE '%'.
   723     12  AL-PADON            PIC X       VALUE '_'.
   724     12  AL-PANOF            PIC X       VALUE '-'.
   725     12  AL-PANON            PIC X       VALUE '/'.
   726     12  AL-SABOF            PIC X       VALUE '8'.
   727     12  AL-SABON            PIC X       VALUE '9'.
   728     12  AL-SADOF            PIC X       VALUE '@'.
   729     12  AL-SADON            PIC X       VALUE QUOTE.
   730     12  AL-SANOF            PIC X       VALUE '0'.
   731     12  AL-SANON            PIC X       VALUE '1'.
   732     12  AL-UABOF            PIC X       VALUE 'H'.
   733     12  AL-UABON            PIC X       VALUE 'I'.
   734     12  AL-UADOF            PIC X       VALUE '<'.
   735     12  AL-UADON            PIC X       VALUE '('.
   736     12  AL-UANOF            PIC X       VALUE ' '.
   737     12  AL-UANON            PIC X       VALUE 'A'.
   738     12  AL-UNBOF            PIC X       VALUE 'Q'.
   739     12  AL-UNBON            PIC X       VALUE 'R'.
   740     12  AL-UNDOF            PIC X       VALUE '*'.
   741     12  AL-UNDON            PIC X       VALUE ')'.
   742     12  AL-UNNOF            PIC X       VALUE '&'.
   743     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  19
* EL1279.cbl
   745*                          COPY ELCDATE.
   746******************************************************************
   747*                                                                *
   748*                                                                *
   749*                            ELCDATE.                            *
   750*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   751*                            VMOD=2.003
   752*                                                                *
   753*                                                                *
   754*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   755*                 LENGTH = 200                                   *
   756******************************************************************
   757
   758 01  DATE-CONVERSION-DATA.
   759     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   760     12  DC-OPTION-CODE                PIC X.
   761         88  BIN-TO-GREG                VALUE ' '.
   762         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   763         88  EDIT-GREG-TO-BIN           VALUE '2'.
   764         88  YMD-GREG-TO-BIN            VALUE '3'.
   765         88  MDY-GREG-TO-BIN            VALUE '4'.
   766         88  JULIAN-TO-BIN              VALUE '5'.
   767         88  BIN-PLUS-ELAPSED           VALUE '6'.
   768         88  FIND-CENTURY               VALUE '7'.
   769         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   770         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   771         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   772         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   773         88  JULIAN-TO-BIN-3            VALUE 'C'.
   774         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   775         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   776         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   777         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   778         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   779         88  CHECK-LEAP-YEAR            VALUE 'H'.
   780         88  BIN-3-TO-GREG              VALUE 'I'.
   781         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   782         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   783         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   784         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   785         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   786         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   787         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   788         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   789         88  THREE-CHARACTER-BIN
   790                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   791         88  GREGORIAN-TO-BIN
   792                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   793         88  BIN-TO-GREGORIAN
   794                  VALUES ' ' '1' 'I' '8' 'G'.
   795         88  JULIAN-TO-BINARY
   796                  VALUES '5' 'C' 'E' 'F'.
   797     12  DC-ERROR-CODE                 PIC X.
   798         88  NO-CONVERSION-ERROR        VALUE ' '.
   799         88  DATE-CONVERSION-ERROR
   800                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   801         88  DATE-IS-ZERO               VALUE '1'.
   802         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  20
* EL1279.cbl
   803         88  DATE-IS-INVALID            VALUE '3'.
   804         88  DATE1-GREATER-DATE2        VALUE '4'.
   805         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   806         88  DATE-INVALID-OPTION        VALUE '9'.
   807         88  INVALID-CENTURY            VALUE 'A'.
   808         88  ONLY-CENTURY               VALUE 'B'.
   809         88  ONLY-LEAP-YEAR             VALUE 'C'.
   810         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   811     12  DC-END-OF-MONTH               PIC X.
   812         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   813     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   814         88  USE-NORMAL-PROCESS         VALUE ' '.
   815         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   816         88  ADJUST-UP-100-YRS          VALUE '2'.
   817     12  FILLER                        PIC X.
   818     12  DC-CONVERSION-DATES.
   819         16  DC-BIN-DATE-1             PIC XX.
   820         16  DC-BIN-DATE-2             PIC XX.
   821         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   822         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   823                       DC-GREG-DATE-1-EDIT.
   824             20  DC-EDIT1-MONTH        PIC 99.
   825             20  SLASH1-1              PIC X.
   826             20  DC-EDIT1-DAY          PIC 99.
   827             20  SLASH1-2              PIC X.
   828             20  DC-EDIT1-YEAR         PIC 99.
   829         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   830         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   831                     DC-GREG-DATE-2-EDIT.
   832             20  DC-EDIT2-MONTH        PIC 99.
   833             20  SLASH2-1              PIC X.
   834             20  DC-EDIT2-DAY          PIC 99.
   835             20  SLASH2-2              PIC X.
   836             20  DC-EDIT2-YEAR         PIC 99.
   837         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   838         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   839                     DC-GREG-DATE-1-YMD.
   840             20  DC-YMD-YEAR           PIC 99.
   841             20  DC-YMD-MONTH          PIC 99.
   842             20  DC-YMD-DAY            PIC 99.
   843         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   844         16  DC-GREG-DATE-1-MDY-R REDEFINES
   845                      DC-GREG-DATE-1-MDY.
   846             20  DC-MDY-MONTH          PIC 99.
   847             20  DC-MDY-DAY            PIC 99.
   848             20  DC-MDY-YEAR           PIC 99.
   849         16  DC-GREG-DATE-1-ALPHA.
   850             20  DC-ALPHA-MONTH        PIC X(10).
   851             20  DC-ALPHA-DAY          PIC 99.
   852             20  FILLER                PIC XX.
   853             20  DC-ALPHA-CENTURY.
   854                 24 DC-ALPHA-CEN-N     PIC 99.
   855             20  DC-ALPHA-YEAR         PIC 99.
   856         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   857         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   858         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   859         16  DC-JULIAN-DATE            PIC 9(05).
   860         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  21
* EL1279.cbl
   861                                       PIC 9(05).
   862         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   863             20  DC-JULIAN-YEAR        PIC 99.
   864             20  DC-JULIAN-DAYS        PIC 999.
   865         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   866         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   867         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   868     12  DATE-CONVERSION-VARIBLES.
   869         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   870         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   871             20  FILLER                PIC 9(3).
   872             20  HOLD-CEN-1-CCYY.
   873                 24  HOLD-CEN-1-CC     PIC 99.
   874                 24  HOLD-CEN-1-YY     PIC 99.
   875             20  HOLD-CEN-1-MO         PIC 99.
   876             20  HOLD-CEN-1-DA         PIC 99.
   877         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   878             20  HOLD-CEN-1-R-MO       PIC 99.
   879             20  HOLD-CEN-1-R-DA       PIC 99.
   880             20  HOLD-CEN-1-R-CCYY.
   881                 24  HOLD-CEN-1-R-CC   PIC 99.
   882                 24  HOLD-CEN-1-R-YY   PIC 99.
   883             20  FILLER                PIC 9(3).
   884         16  HOLD-CENTURY-1-X.
   885             20  FILLER                PIC X(3)  VALUE SPACES.
   886             20  HOLD-CEN-1-X-CCYY.
   887                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   888                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   889             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   890             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   891         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   892             20  HOLD-CEN-1-R-X-MO     PIC XX.
   893             20  HOLD-CEN-1-R-X-DA     PIC XX.
   894             20  HOLD-CEN-1-R-X-CCYY.
   895                 24  HOLD-CEN-1-R-X-CC PIC XX.
   896                 24  HOLD-CEN-1-R-X-YY PIC XX.
   897             20  FILLER                PIC XXX.
   898         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   899         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   900         16  DC-JULIAN-DATE-1          PIC 9(07).
   901         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   902             20  DC-JULIAN-1-CCYY.
   903                 24  DC-JULIAN-1-CC    PIC 99.
   904                 24  DC-JULIAN-1-YR    PIC 99.
   905             20  DC-JULIAN-DA-1        PIC 999.
   906         16  DC-JULIAN-DATE-2          PIC 9(07).
   907         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   908             20  DC-JULIAN-2-CCYY.
   909                 24  DC-JULIAN-2-CC    PIC 99.
   910                 24  DC-JULIAN-2-YR    PIC 99.
   911             20  DC-JULIAN-DA-2        PIC 999.
   912         16  DC-GREG-DATE-A-EDIT.
   913             20  DC-EDITA-MONTH        PIC 99.
   914             20  SLASHA-1              PIC X VALUE '/'.
   915             20  DC-EDITA-DAY          PIC 99.
   916             20  SLASHA-2              PIC X VALUE '/'.
   917             20  DC-EDITA-CCYY.
   918                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  22
* EL1279.cbl
   919                 24  DC-EDITA-YEAR     PIC 99.
   920         16  DC-GREG-DATE-B-EDIT.
   921             20  DC-EDITB-MONTH        PIC 99.
   922             20  SLASHB-1              PIC X VALUE '/'.
   923             20  DC-EDITB-DAY          PIC 99.
   924             20  SLASHB-2              PIC X VALUE '/'.
   925             20  DC-EDITB-CCYY.
   926                 24  DC-EDITB-CENT     PIC 99.
   927                 24  DC-EDITB-YEAR     PIC 99.
   928         16  DC-GREG-DATE-CYMD         PIC 9(08).
   929         16  DC-GREG-DATE-CYMD-R REDEFINES
   930                              DC-GREG-DATE-CYMD.
   931             20  DC-CYMD-CEN           PIC 99.
   932             20  DC-CYMD-YEAR          PIC 99.
   933             20  DC-CYMD-MONTH         PIC 99.
   934             20  DC-CYMD-DAY           PIC 99.
   935         16  DC-GREG-DATE-MDCY         PIC 9(08).
   936         16  DC-GREG-DATE-MDCY-R REDEFINES
   937                              DC-GREG-DATE-MDCY.
   938             20  DC-MDCY-MONTH         PIC 99.
   939             20  DC-MDCY-DAY           PIC 99.
   940             20  DC-MDCY-CEN           PIC 99.
   941             20  DC-MDCY-YEAR          PIC 99.
   942    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   943        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   944    12  DC-EL310-DATE                  PIC X(21).
   945    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  23
* EL1279.cbl
   947*                          COPY EL1279S.
   948 01  EL1279AI.
   949     05  FILLER            PIC  X(0012).
   950*    -------------------------------
   951     05  DATEL PIC S9(0004) COMP.
   952     05  DATEF PIC  X(0001).
   953     05  FILLER REDEFINES DATEF.
   954         10  DATEA PIC  X(0001).
   955     05  DATEI PIC  X(0008).
   956*    -------------------------------
   957     05  TIMEL PIC S9(0004) COMP.
   958     05  TIMEF PIC  X(0001).
   959     05  FILLER REDEFINES TIMEF.
   960         10  TIMEA PIC  X(0001).
   961     05  TIMEI PIC  X(0005).
   962*    -------------------------------
   963     05  CMPNYIDL PIC S9(0004) COMP.
   964     05  CMPNYIDF PIC  X(0001).
   965     05  FILLER REDEFINES CMPNYIDF.
   966         10  CMPNYIDA PIC  X(0001).
   967     05  CMPNYIDI PIC  X(0003).
   968*    -------------------------------
   969     05  USERIDL PIC S9(0004) COMP.
   970     05  USERIDF PIC  X(0001).
   971     05  FILLER REDEFINES USERIDF.
   972         10  USERIDA PIC  X(0001).
   973     05  USERIDI PIC  X(0004).
   974*    -------------------------------
   975     05  FCERTL PIC S9(0004) COMP.
   976     05  FCERTF PIC  X(0001).
   977     05  FILLER REDEFINES FCERTF.
   978         10  FCERTA PIC  X(0001).
   979     05  FCERTI PIC  X(0010).
   980*    -------------------------------
   981     05  FCRTSFXL PIC S9(0004) COMP.
   982     05  FCRTSFXF PIC  X(0001).
   983     05  FILLER REDEFINES FCRTSFXF.
   984         10  FCRTSFXA PIC  X(0001).
   985     05  FCRTSFXI PIC  X(0001).
   986*    -------------------------------
   987     05  FACOUNTL PIC S9(0004) COMP.
   988     05  FACOUNTF PIC  X(0001).
   989     05  FILLER REDEFINES FACOUNTF.
   990         10  FACOUNTA PIC  X(0001).
   991     05  FACOUNTI PIC  X(0010).
   992*    -------------------------------
   993     05  FSTL PIC S9(0004) COMP.
   994     05  FSTF PIC  X(0001).
   995     05  FILLER REDEFINES FSTF.
   996         10  FSTA PIC  X(0001).
   997     05  FSTI PIC  X(0002).
   998*    -------------------------------
   999     05  FCARRIRL PIC S9(0004) COMP.
  1000     05  FCARRIRF PIC  X(0001).
  1001     05  FILLER REDEFINES FCARRIRF.
  1002         10  FCARRIRA PIC  X(0001).
  1003     05  FCARRIRI PIC  X(0001).
  1004*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  24
* EL1279.cbl
  1005     05  FGROUPL PIC S9(0004) COMP.
  1006     05  FGROUPF PIC  X(0001).
  1007     05  FILLER REDEFINES FGROUPF.
  1008         10  FGROUPA PIC  X(0001).
  1009     05  FGROUPI PIC  X(0006).
  1010*    -------------------------------
  1011     05  FEFFDTL PIC S9(0004) COMP.
  1012     05  FEFFDTF PIC  X(0001).
  1013     05  FILLER REDEFINES FEFFDTF.
  1014         10  FEFFDTA PIC  X(0001).
  1015     05  FEFFDTI PIC  X(0008).
  1016*    -------------------------------
  1017     05  TOTL PIC S9(0004) COMP.
  1018     05  TOTF PIC  X(0001).
  1019     05  FILLER REDEFINES TOTF.
  1020         10  TOTA PIC  X(0001).
  1021     05  TOTI PIC  X(0003).
  1022*    -------------------------------
  1023     05  FBILLYNL PIC S9(0004) COMP.
  1024     05  FBILLYNF PIC  X(0001).
  1025     05  FILLER REDEFINES FBILLYNF.
  1026         10  FBILLYNA PIC  X(0001).
  1027     05  FBILLYNI PIC  X(0003).
  1028*    -------------------------------
  1029     05  FTYPEYNL PIC S9(0004) COMP.
  1030     05  FTYPEYNF PIC  X(0001).
  1031     05  FILLER REDEFINES FTYPEYNF.
  1032         10  FTYPEYNA PIC  X(0001).
  1033     05  FTYPEYNI PIC  X(0012).
  1034*    -------------------------------
  1035     05  FCERTYNL PIC S9(0004) COMP.
  1036     05  FCERTYNF PIC  X(0001).
  1037     05  FILLER REDEFINES FCERTYNF.
  1038         10  FCERTYNA PIC  X(0001).
  1039     05  FCERTYNI PIC  X(0003).
  1040*    -------------------------------
  1041     05  FTYPEL PIC S9(0004) COMP.
  1042     05  FTYPEF PIC  X(0001).
  1043     05  FILLER REDEFINES FTYPEF.
  1044         10  FTYPEA PIC  X(0001).
  1045     05  FTYPEI PIC  X(0063).
  1046*    -------------------------------
  1047     05  LN1L PIC S9(0004) COMP.
  1048     05  LN1F PIC  X(0001).
  1049     05  FILLER REDEFINES LN1F.
  1050         10  LN1A PIC  X(0001).
  1051     05  LN1I PIC  X(0003).
  1052*    -------------------------------
  1053     05  FNLINE1L PIC S9(0004) COMP.
  1054     05  FNLINE1F PIC  X(0001).
  1055     05  FILLER REDEFINES FNLINE1F.
  1056         10  FNLINE1A PIC  X(0001).
  1057     05  FNLINE1I PIC  X(0063).
  1058*    -------------------------------
  1059     05  MTBY1L PIC S9(0004) COMP.
  1060     05  MTBY1F PIC  X(0001).
  1061     05  FILLER REDEFINES MTBY1F.
  1062         10  MTBY1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  25
* EL1279.cbl
  1063     05  MTBY1I PIC  X(0004).
  1064*    -------------------------------
  1065     05  MTDT1L PIC S9(0004) COMP.
  1066     05  MTDT1F PIC  X(0001).
  1067     05  FILLER REDEFINES MTDT1F.
  1068         10  MTDT1A PIC  X(0001).
  1069     05  MTDT1I PIC  X(0006).
  1070*    -------------------------------
  1071     05  LN2L PIC S9(0004) COMP.
  1072     05  LN2F PIC  X(0001).
  1073     05  FILLER REDEFINES LN2F.
  1074         10  LN2A PIC  X(0001).
  1075     05  LN2I PIC  X(0003).
  1076*    -------------------------------
  1077     05  FNLINE2L PIC S9(0004) COMP.
  1078     05  FNLINE2F PIC  X(0001).
  1079     05  FILLER REDEFINES FNLINE2F.
  1080         10  FNLINE2A PIC  X(0001).
  1081     05  FNLINE2I PIC  X(0063).
  1082*    -------------------------------
  1083     05  MTBY2L PIC S9(0004) COMP.
  1084     05  MTBY2F PIC  X(0001).
  1085     05  FILLER REDEFINES MTBY2F.
  1086         10  MTBY2A PIC  X(0001).
  1087     05  MTBY2I PIC  X(0004).
  1088*    -------------------------------
  1089     05  MTDT2L PIC S9(0004) COMP.
  1090     05  MTDT2F PIC  X(0001).
  1091     05  FILLER REDEFINES MTDT2F.
  1092         10  MTDT2A PIC  X(0001).
  1093     05  MTDT2I PIC  X(0006).
  1094*    -------------------------------
  1095     05  LN3L PIC S9(0004) COMP.
  1096     05  LN3F PIC  X(0001).
  1097     05  FILLER REDEFINES LN3F.
  1098         10  LN3A PIC  X(0001).
  1099     05  LN3I PIC  X(0003).
  1100*    -------------------------------
  1101     05  FNLINE3L PIC S9(0004) COMP.
  1102     05  FNLINE3F PIC  X(0001).
  1103     05  FILLER REDEFINES FNLINE3F.
  1104         10  FNLINE3A PIC  X(0001).
  1105     05  FNLINE3I PIC  X(0063).
  1106*    -------------------------------
  1107     05  MTBY3L PIC S9(0004) COMP.
  1108     05  MTBY3F PIC  X(0001).
  1109     05  FILLER REDEFINES MTBY3F.
  1110         10  MTBY3A PIC  X(0001).
  1111     05  MTBY3I PIC  X(0004).
  1112*    -------------------------------
  1113     05  MTDT3L PIC S9(0004) COMP.
  1114     05  MTDT3F PIC  X(0001).
  1115     05  FILLER REDEFINES MTDT3F.
  1116         10  MTDT3A PIC  X(0001).
  1117     05  MTDT3I PIC  X(0006).
  1118*    -------------------------------
  1119     05  LN4L PIC S9(0004) COMP.
  1120     05  LN4F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  26
* EL1279.cbl
  1121     05  FILLER REDEFINES LN4F.
  1122         10  LN4A PIC  X(0001).
  1123     05  LN4I PIC  X(0003).
  1124*    -------------------------------
  1125     05  FNLINE4L PIC S9(0004) COMP.
  1126     05  FNLINE4F PIC  X(0001).
  1127     05  FILLER REDEFINES FNLINE4F.
  1128         10  FNLINE4A PIC  X(0001).
  1129     05  FNLINE4I PIC  X(0063).
  1130*    -------------------------------
  1131     05  MTBY4L PIC S9(0004) COMP.
  1132     05  MTBY4F PIC  X(0001).
  1133     05  FILLER REDEFINES MTBY4F.
  1134         10  MTBY4A PIC  X(0001).
  1135     05  MTBY4I PIC  X(0004).
  1136*    -------------------------------
  1137     05  MTDT4L PIC S9(0004) COMP.
  1138     05  MTDT4F PIC  X(0001).
  1139     05  FILLER REDEFINES MTDT4F.
  1140         10  MTDT4A PIC  X(0001).
  1141     05  MTDT4I PIC  X(0006).
  1142*    -------------------------------
  1143     05  LN5L PIC S9(0004) COMP.
  1144     05  LN5F PIC  X(0001).
  1145     05  FILLER REDEFINES LN5F.
  1146         10  LN5A PIC  X(0001).
  1147     05  LN5I PIC  X(0003).
  1148*    -------------------------------
  1149     05  FNLINE5L PIC S9(0004) COMP.
  1150     05  FNLINE5F PIC  X(0001).
  1151     05  FILLER REDEFINES FNLINE5F.
  1152         10  FNLINE5A PIC  X(0001).
  1153     05  FNLINE5I PIC  X(0063).
  1154*    -------------------------------
  1155     05  MTBY5L PIC S9(0004) COMP.
  1156     05  MTBY5F PIC  X(0001).
  1157     05  FILLER REDEFINES MTBY5F.
  1158         10  MTBY5A PIC  X(0001).
  1159     05  MTBY5I PIC  X(0004).
  1160*    -------------------------------
  1161     05  MTDT5L PIC S9(0004) COMP.
  1162     05  MTDT5F PIC  X(0001).
  1163     05  FILLER REDEFINES MTDT5F.
  1164         10  MTDT5A PIC  X(0001).
  1165     05  MTDT5I PIC  X(0006).
  1166*    -------------------------------
  1167     05  LN6L PIC S9(0004) COMP.
  1168     05  LN6F PIC  X(0001).
  1169     05  FILLER REDEFINES LN6F.
  1170         10  LN6A PIC  X(0001).
  1171     05  LN6I PIC  X(0003).
  1172*    -------------------------------
  1173     05  FNLINE6L PIC S9(0004) COMP.
  1174     05  FNLINE6F PIC  X(0001).
  1175     05  FILLER REDEFINES FNLINE6F.
  1176         10  FNLINE6A PIC  X(0001).
  1177     05  FNLINE6I PIC  X(0063).
  1178*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  27
* EL1279.cbl
  1179     05  MTBY6L PIC S9(0004) COMP.
  1180     05  MTBY6F PIC  X(0001).
  1181     05  FILLER REDEFINES MTBY6F.
  1182         10  MTBY6A PIC  X(0001).
  1183     05  MTBY6I PIC  X(0004).
  1184*    -------------------------------
  1185     05  MTDT6L PIC S9(0004) COMP.
  1186     05  MTDT6F PIC  X(0001).
  1187     05  FILLER REDEFINES MTDT6F.
  1188         10  MTDT6A PIC  X(0001).
  1189     05  MTDT6I PIC  X(0006).
  1190*    -------------------------------
  1191     05  LN7L PIC S9(0004) COMP.
  1192     05  LN7F PIC  X(0001).
  1193     05  FILLER REDEFINES LN7F.
  1194         10  LN7A PIC  X(0001).
  1195     05  LN7I PIC  X(0003).
  1196*    -------------------------------
  1197     05  FNLINE7L PIC S9(0004) COMP.
  1198     05  FNLINE7F PIC  X(0001).
  1199     05  FILLER REDEFINES FNLINE7F.
  1200         10  FNLINE7A PIC  X(0001).
  1201     05  FNLINE7I PIC  X(0063).
  1202*    -------------------------------
  1203     05  MTBY7L PIC S9(0004) COMP.
  1204     05  MTBY7F PIC  X(0001).
  1205     05  FILLER REDEFINES MTBY7F.
  1206         10  MTBY7A PIC  X(0001).
  1207     05  MTBY7I PIC  X(0004).
  1208*    -------------------------------
  1209     05  MTDT7L PIC S9(0004) COMP.
  1210     05  MTDT7F PIC  X(0001).
  1211     05  FILLER REDEFINES MTDT7F.
  1212         10  MTDT7A PIC  X(0001).
  1213     05  MTDT7I PIC  X(0006).
  1214*    -------------------------------
  1215     05  LN8L PIC S9(0004) COMP.
  1216     05  LN8F PIC  X(0001).
  1217     05  FILLER REDEFINES LN8F.
  1218         10  LN8A PIC  X(0001).
  1219     05  LN8I PIC  X(0003).
  1220*    -------------------------------
  1221     05  FNLINE8L PIC S9(0004) COMP.
  1222     05  FNLINE8F PIC  X(0001).
  1223     05  FILLER REDEFINES FNLINE8F.
  1224         10  FNLINE8A PIC  X(0001).
  1225     05  FNLINE8I PIC  X(0063).
  1226*    -------------------------------
  1227     05  MTBY8L PIC S9(0004) COMP.
  1228     05  MTBY8F PIC  X(0001).
  1229     05  FILLER REDEFINES MTBY8F.
  1230         10  MTBY8A PIC  X(0001).
  1231     05  MTBY8I PIC  X(0004).
  1232*    -------------------------------
  1233     05  MTDT8L PIC S9(0004) COMP.
  1234     05  MTDT8F PIC  X(0001).
  1235     05  FILLER REDEFINES MTDT8F.
  1236         10  MTDT8A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  28
* EL1279.cbl
  1237     05  MTDT8I PIC  X(0006).
  1238*    -------------------------------
  1239     05  LN9L PIC S9(0004) COMP.
  1240     05  LN9F PIC  X(0001).
  1241     05  FILLER REDEFINES LN9F.
  1242         10  LN9A PIC  X(0001).
  1243     05  LN9I PIC  X(0003).
  1244*    -------------------------------
  1245     05  FNLINE9L PIC S9(0004) COMP.
  1246     05  FNLINE9F PIC  X(0001).
  1247     05  FILLER REDEFINES FNLINE9F.
  1248         10  FNLINE9A PIC  X(0001).
  1249     05  FNLINE9I PIC  X(0063).
  1250*    -------------------------------
  1251     05  MTBY9L PIC S9(0004) COMP.
  1252     05  MTBY9F PIC  X(0001).
  1253     05  FILLER REDEFINES MTBY9F.
  1254         10  MTBY9A PIC  X(0001).
  1255     05  MTBY9I PIC  X(0004).
  1256*    -------------------------------
  1257     05  MTDT9L PIC S9(0004) COMP.
  1258     05  MTDT9F PIC  X(0001).
  1259     05  FILLER REDEFINES MTDT9F.
  1260         10  MTDT9A PIC  X(0001).
  1261     05  MTDT9I PIC  X(0006).
  1262*    -------------------------------
  1263     05  LN10L PIC S9(0004) COMP.
  1264     05  LN10F PIC  X(0001).
  1265     05  FILLER REDEFINES LN10F.
  1266         10  LN10A PIC  X(0001).
  1267     05  LN10I PIC  X(0003).
  1268*    -------------------------------
  1269     05  FNLIN10L PIC S9(0004) COMP.
  1270     05  FNLIN10F PIC  X(0001).
  1271     05  FILLER REDEFINES FNLIN10F.
  1272         10  FNLIN10A PIC  X(0001).
  1273     05  FNLIN10I PIC  X(0063).
  1274*    -------------------------------
  1275     05  MTBY10L PIC S9(0004) COMP.
  1276     05  MTBY10F PIC  X(0001).
  1277     05  FILLER REDEFINES MTBY10F.
  1278         10  MTBY10A PIC  X(0001).
  1279     05  MTBY10I PIC  X(0004).
  1280*    -------------------------------
  1281     05  MTDT10L PIC S9(0004) COMP.
  1282     05  MTDT10F PIC  X(0001).
  1283     05  FILLER REDEFINES MTDT10F.
  1284         10  MTDT10A PIC  X(0001).
  1285     05  MTDT10I PIC  X(0006).
  1286*    -------------------------------
  1287     05  ERRMSGBL PIC S9(0004) COMP.
  1288     05  ERRMSGBF PIC  X(0001).
  1289     05  FILLER REDEFINES ERRMSGBF.
  1290         10  ERRMSGBA PIC  X(0001).
  1291     05  ERRMSGBI PIC  X(0072).
  1292*    -------------------------------
  1293     05  FUNCTL PIC S9(0004) COMP.
  1294     05  FUNCTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  29
* EL1279.cbl
  1295     05  FILLER REDEFINES FUNCTF.
  1296         10  FUNCTA PIC  X(0001).
  1297     05  FUNCTI PIC  X(0001).
  1298*    -------------------------------
  1299     05  LINE1L PIC S9(0004) COMP.
  1300     05  LINE1F PIC  X(0001).
  1301     05  FILLER REDEFINES LINE1F.
  1302         10  LINE1A PIC  X(0001).
  1303     05  LINE1I PIC  999.
  1304*    -------------------------------
  1305     05  LINE2L PIC S9(0004) COMP.
  1306     05  LINE2F PIC  X(0001).
  1307     05  FILLER REDEFINES LINE2F.
  1308         10  LINE2A PIC  X(0001).
  1309     05  LINE2I PIC  999.
  1310*    -------------------------------
  1311     05  PFENTERL PIC S9(0004) COMP.
  1312     05  PFENTERF PIC  X(0001).
  1313     05  FILLER REDEFINES PFENTERF.
  1314         10  PFENTERA PIC  X(0001).
  1315     05  PFENTERI PIC  99.
  1316*    -------------------------------
  1317     05  PF6NOTEL PIC S9(0004) COMP.
  1318     05  PF6NOTEF PIC  X(0001).
  1319     05  FILLER REDEFINES PF6NOTEF.
  1320         10  PF6NOTEA PIC  X(0001).
  1321     05  PF6NOTEI PIC  X(0014).
  1322 01  EL1279AO REDEFINES EL1279AI.
  1323     05  FILLER            PIC  X(0012).
  1324*    -------------------------------
  1325     05  FILLER            PIC  X(0003).
  1326     05  DATEO PIC  X(0008).
  1327*    -------------------------------
  1328     05  FILLER            PIC  X(0003).
  1329     05  TIMEO PIC  99.99.
  1330*    -------------------------------
  1331     05  FILLER            PIC  X(0003).
  1332     05  CMPNYIDO PIC  X(0003).
  1333*    -------------------------------
  1334     05  FILLER            PIC  X(0003).
  1335     05  USERIDO PIC  X(0004).
  1336*    -------------------------------
  1337     05  FILLER            PIC  X(0003).
  1338     05  FCERTO PIC  X(0010).
  1339*    -------------------------------
  1340     05  FILLER            PIC  X(0003).
  1341     05  FCRTSFXO PIC  X(0001).
  1342*    -------------------------------
  1343     05  FILLER            PIC  X(0003).
  1344     05  FACOUNTO PIC  X(0010).
  1345*    -------------------------------
  1346     05  FILLER            PIC  X(0003).
  1347     05  FSTO PIC  X(0002).
  1348*    -------------------------------
  1349     05  FILLER            PIC  X(0003).
  1350     05  FCARRIRO PIC  X(0001).
  1351*    -------------------------------
  1352     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  30
* EL1279.cbl
  1353     05  FGROUPO PIC  X(0006).
  1354*    -------------------------------
  1355     05  FILLER            PIC  X(0003).
  1356     05  FEFFDTO PIC  X(0008).
  1357*    -------------------------------
  1358     05  FILLER            PIC  X(0003).
  1359     05  TOTO PIC  ZZ9.
  1360*    -------------------------------
  1361     05  FILLER            PIC  X(0003).
  1362     05  FBILLYNO PIC  X(0003).
  1363*    -------------------------------
  1364     05  FILLER            PIC  X(0003).
  1365     05  FTYPEYNO PIC  X(0012).
  1366*    -------------------------------
  1367     05  FILLER            PIC  X(0003).
  1368     05  FCERTYNO PIC  X(0003).
  1369*    -------------------------------
  1370     05  FILLER            PIC  X(0003).
  1371     05  FTYPEO PIC  X(0063).
  1372*    -------------------------------
  1373     05  FILLER            PIC  X(0003).
  1374     05  LN1O PIC  ZZ9.
  1375*    -------------------------------
  1376     05  FILLER            PIC  X(0003).
  1377     05  FNLINE1O PIC  X(0063).
  1378*    -------------------------------
  1379     05  FILLER            PIC  X(0003).
  1380     05  MTBY1O PIC  X(0004).
  1381*    -------------------------------
  1382     05  FILLER            PIC  X(0003).
  1383     05  MTDT1O PIC  X(0006).
  1384*    -------------------------------
  1385     05  FILLER            PIC  X(0003).
  1386     05  LN2O PIC  ZZ9.
  1387*    -------------------------------
  1388     05  FILLER            PIC  X(0003).
  1389     05  FNLINE2O PIC  X(0063).
  1390*    -------------------------------
  1391     05  FILLER            PIC  X(0003).
  1392     05  MTBY2O PIC  X(0004).
  1393*    -------------------------------
  1394     05  FILLER            PIC  X(0003).
  1395     05  MTDT2O PIC  X(0006).
  1396*    -------------------------------
  1397     05  FILLER            PIC  X(0003).
  1398     05  LN3O PIC  ZZ9.
  1399*    -------------------------------
  1400     05  FILLER            PIC  X(0003).
  1401     05  FNLINE3O PIC  X(0063).
  1402*    -------------------------------
  1403     05  FILLER            PIC  X(0003).
  1404     05  MTBY3O PIC  X(0004).
  1405*    -------------------------------
  1406     05  FILLER            PIC  X(0003).
  1407     05  MTDT3O PIC  X(0006).
  1408*    -------------------------------
  1409     05  FILLER            PIC  X(0003).
  1410     05  LN4O PIC  ZZ9.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  31
* EL1279.cbl
  1411*    -------------------------------
  1412     05  FILLER            PIC  X(0003).
  1413     05  FNLINE4O PIC  X(0063).
  1414*    -------------------------------
  1415     05  FILLER            PIC  X(0003).
  1416     05  MTBY4O PIC  X(0004).
  1417*    -------------------------------
  1418     05  FILLER            PIC  X(0003).
  1419     05  MTDT4O PIC  X(0006).
  1420*    -------------------------------
  1421     05  FILLER            PIC  X(0003).
  1422     05  LN5O PIC  ZZ9.
  1423*    -------------------------------
  1424     05  FILLER            PIC  X(0003).
  1425     05  FNLINE5O PIC  X(0063).
  1426*    -------------------------------
  1427     05  FILLER            PIC  X(0003).
  1428     05  MTBY5O PIC  X(0004).
  1429*    -------------------------------
  1430     05  FILLER            PIC  X(0003).
  1431     05  MTDT5O PIC  X(0006).
  1432*    -------------------------------
  1433     05  FILLER            PIC  X(0003).
  1434     05  LN6O PIC  ZZ9.
  1435*    -------------------------------
  1436     05  FILLER            PIC  X(0003).
  1437     05  FNLINE6O PIC  X(0063).
  1438*    -------------------------------
  1439     05  FILLER            PIC  X(0003).
  1440     05  MTBY6O PIC  X(0004).
  1441*    -------------------------------
  1442     05  FILLER            PIC  X(0003).
  1443     05  MTDT6O PIC  X(0006).
  1444*    -------------------------------
  1445     05  FILLER            PIC  X(0003).
  1446     05  LN7O PIC  ZZ9.
  1447*    -------------------------------
  1448     05  FILLER            PIC  X(0003).
  1449     05  FNLINE7O PIC  X(0063).
  1450*    -------------------------------
  1451     05  FILLER            PIC  X(0003).
  1452     05  MTBY7O PIC  X(0004).
  1453*    -------------------------------
  1454     05  FILLER            PIC  X(0003).
  1455     05  MTDT7O PIC  X(0006).
  1456*    -------------------------------
  1457     05  FILLER            PIC  X(0003).
  1458     05  LN8O PIC  ZZ9.
  1459*    -------------------------------
  1460     05  FILLER            PIC  X(0003).
  1461     05  FNLINE8O PIC  X(0063).
  1462*    -------------------------------
  1463     05  FILLER            PIC  X(0003).
  1464     05  MTBY8O PIC  X(0004).
  1465*    -------------------------------
  1466     05  FILLER            PIC  X(0003).
  1467     05  MTDT8O PIC  X(0006).
  1468*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  32
* EL1279.cbl
  1469     05  FILLER            PIC  X(0003).
  1470     05  LN9O PIC  ZZ9.
  1471*    -------------------------------
  1472     05  FILLER            PIC  X(0003).
  1473     05  FNLINE9O PIC  X(0063).
  1474*    -------------------------------
  1475     05  FILLER            PIC  X(0003).
  1476     05  MTBY9O PIC  X(0004).
  1477*    -------------------------------
  1478     05  FILLER            PIC  X(0003).
  1479     05  MTDT9O PIC  X(0006).
  1480*    -------------------------------
  1481     05  FILLER            PIC  X(0003).
  1482     05  LN10O PIC  ZZ9.
  1483*    -------------------------------
  1484     05  FILLER            PIC  X(0003).
  1485     05  FNLIN10O PIC  X(0063).
  1486*    -------------------------------
  1487     05  FILLER            PIC  X(0003).
  1488     05  MTBY10O PIC  X(0004).
  1489*    -------------------------------
  1490     05  FILLER            PIC  X(0003).
  1491     05  MTDT10O PIC  X(0006).
  1492*    -------------------------------
  1493     05  FILLER            PIC  X(0003).
  1494     05  ERRMSGBO PIC  X(0072).
  1495*    -------------------------------
  1496     05  FILLER            PIC  X(0003).
  1497     05  FUNCTO PIC  X(0001).
  1498*    -------------------------------
  1499     05  FILLER            PIC  X(0003).
  1500     05  LINE1O PIC  X(0003).
  1501*    -------------------------------
  1502     05  FILLER            PIC  X(0003).
  1503     05  LINE2O PIC  X(0003).
  1504*    -------------------------------
  1505     05  FILLER            PIC  X(0003).
  1506     05  PFENTERO PIC  X(0002).
  1507*    -------------------------------
  1508     05  FILLER            PIC  X(0003).
  1509     05  PF6NOTEO PIC  X(0014).
  1510*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  33
* EL1279.cbl
  1512 01  EL1279R REDEFINES EL1279AI.
  1513     12  FILLER                  PIC X(202).
  1514     12  SC-ALL-LINES.
  1515      14 SC-LINES OCCURS 10 TIMES INDEXED BY SC-INDX.
  1516         16  SC-LINL             PIC S9(4)   COMP.
  1517         16  SC-LINA             PIC X.
  1518         16  SC-LIN              PIC ZZ9.
  1519         16  SC-TEXTL            PIC S9(4)   COMP.
  1520         16  SC-TEXTA            PIC X.
  1521         16  SC-TEXT             PIC X(63).
  1522         16  SC-MTBYL            PIC S9(4)   COMP.
  1523         16  SC-MTBYA            PIC X.
  1524         16  SC-MTBY             PIC X(4).
  1525         16  SC-MTDTL            PIC S9(4)   COMP.
  1526         16  SC-MTDTA            PIC X.
  1527         16  SC-MTDT             PIC X(6).
  1528     12  FILLER                  PIC X(116).
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  34
* EL1279.cbl
  1530 01  RECORD-TABLE                PIC X(21900) VALUE SPACES.
  1531 01  REC-TABLE  REDEFINES RECORD-TABLE.
  1532     12  TS-GROUP OCCURS 6 TIMES INDEXED BY TS-INDX PIC X(3650).
  1533 01  REC-ENTRIES REDEFINES RECORD-TABLE.
  1534     12  REC-ENT OCCURS 300 TIMES INDEXED BY TB-INDX TB-INDX1.
  1535         16  REC-TEXT                    PIC X(63).
  1536         16  REC-LAST-MAINT-BY           PIC XXXX.
  1537         16  REC-LAST-MAINT-DT           PIC XX.
  1538         16  REC-LAST-MAINT-HHMMSS       PIC S9(7) COMP-3.
  1539
  1540 01  TS-WORK-AREA                        PIC X(3650).
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  35
* EL1279.cbl
  1542
  1543****************************************************************
  1544*
  1545* Copyright (c) 2007 by Clerity Solutions, Inc.
  1546* All rights reserved.
  1547*
  1548****************************************************************
  1549 01  DFHEIV.
  1550   02  DFHEIV0               PIC X(35).
  1551   02  DFHEIV1               PIC X(08).
  1552   02  DFHEIV2               PIC X(08).
  1553   02  DFHEIV3               PIC X(08).
  1554   02  DFHEIV4               PIC X(06).
  1555   02  DFHEIV5               PIC X(04).
  1556   02  DFHEIV6               PIC X(04).
  1557   02  DFHEIV7               PIC X(02).
  1558   02  DFHEIV8               PIC X(02).
  1559   02  DFHEIV9               PIC X(01).
  1560   02  DFHEIV10              PIC S9(7) COMP-3.
  1561   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1562   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1563   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1564   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1565   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1566   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1567   02  DFHEIV17              PIC X(04).
  1568   02  DFHEIV18              PIC X(04).
  1569   02  DFHEIV19              PIC X(04).
  1570   02  DFHEIV20              USAGE IS POINTER.
  1571   02  DFHEIV21              USAGE IS POINTER.
  1572   02  DFHEIV22              USAGE IS POINTER.
  1573   02  DFHEIV23              USAGE IS POINTER.
  1574   02  DFHEIV24              USAGE IS POINTER.
  1575   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1576   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1577   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1578   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1579   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1580   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1581   02  FILLER                PIC X(02).
  1582   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1583   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1584   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1585   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1586   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1587 LINKAGE  SECTION.
  1588*****************************************************************
  1589*                                                               *
  1590* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1591* All rights reserved.                                          *
  1592*                                                               *
  1593*****************************************************************
  1594 01  dfheiblk.
  1595     02  eibtime          pic s9(7) comp-3.
  1596     02  eibdate          pic s9(7) comp-3.
  1597     02  eibtrnid         pic x(4).
  1598     02  eibtaskn         pic s9(7) comp-3.
  1599     02  eibtrmid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  36
* EL1279.cbl
  1600     02  dfheigdi         pic s9(4) comp.
  1601     02  eibcposn         pic s9(4) comp.
  1602     02  eibcalen         pic s9(4) comp.
  1603     02  eibaid           pic x(1).
  1604     02  eibfiller1       pic x(1).
  1605     02  eibfn            pic x(2).
  1606     02  eibfiller2       pic x(2).
  1607     02  eibrcode         pic x(6).
  1608     02  eibfiller3       pic x(2).
  1609     02  eibds            pic x(8).
  1610     02  eibreqid         pic x(8).
  1611     02  eibrsrce         pic x(8).
  1612     02  eibsync          pic x(1).
  1613     02  eibfree          pic x(1).
  1614     02  eibrecv          pic x(1).
  1615     02  eibsend          pic x(1).
  1616     02  eibatt           pic x(1).
  1617     02  eibeoc           pic x(1).
  1618     02  eibfmh           pic x(1).
  1619     02  eibcompl         pic x(1).
  1620     02  eibsig           pic x(1).
  1621     02  eibconf          pic x(1).
  1622     02  eiberr           pic x(1).
  1623     02  eibrldbk         pic x(1).
  1624     02  eiberrcd         pic x(4).
  1625     02  eibsynrb         pic x(1).
  1626     02  eibnodat         pic x(1).
  1627     02  eibfiller5       pic x(2).
  1628     02  eibresp          pic 9(09) comp.
  1629     02  eibresp2         pic 9(09) comp.
  1630     02  dfheigdj         pic s9(4) comp.
  1631     02  dfheigdk         pic s9(4) comp.
  1632 01  DFHCOMMAREA                 PIC X(1500).
  1633
  1634*         COPY ERCCNOT.
  1635******************************************************************
  1636*                                                                *
  1637*                            ERCCNOT                             *
  1638*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1639*                            VMOD=2.003                          *
  1640*                                                                *
  1641*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  1642*                                                                *
  1643*        FILE TYPE= VSAM,KSDS                                    *
  1644*        RECORD SIZE = 150    RECFORM = FIXED                    *
  1645*                                                                *
  1646*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  1647*                                                                *
  1648*        LOG = YES                                               *
  1649*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  1650*                                                                *
  1651******************************************************************
  1652*                   C H A N G E   L O G
  1653*
  1654* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1655*-----------------------------------------------------------------
  1656*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1657* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  37
* EL1279.cbl
  1658*-----------------------------------------------------------------
  1659* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  1660******************************************************************
  1661
  1662 01  CERT-NOTE-FILE.
  1663     12  CZ-RECORD-ID                PIC  XX.
  1664         88  VALID-CZ-ID                  VALUE 'CZ'.
  1665
  1666     12  CZ-CONTROL-PRIMARY.
  1667         16  CZ-COMPANY-CD           PIC X.
  1668         16  CZ-CARRIER              PIC X.
  1669         16  CZ-GROUPING.
  1670             20 CZ-GROUPING-PREFIX   PIC XXX.
  1671             20 CZ-GROUPING-PRIME    PIC XXX.
  1672         16  CZ-STATE                PIC XX.
  1673         16  CZ-ACCOUNT.
  1674             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  1675             20 CZ-ACCOUNT-PRIME     PIC X(6).
  1676         16  CZ-CERT-EFF-DT          PIC XX.
  1677         16  CZ-CERT-NO.
  1678             20  CZ-CERT-PRIME       PIC X(10).
  1679             20  CZ-CERT-SFX         PIC X.
  1680         16  CZ-RECORD-TYPE          PIC X.
  1681             88  CERT-NOTE           VALUE '1'.
  1682             88  CLAIM-CERT-NOTE     VALUE '2'.
  1683         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  1684
  1685     12  CZ-LAST-MAINT-DT            PIC XX.
  1686     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  1687     12  CZ-LAST-MAINT-USER          PIC X(4).
  1688
  1689     12  CZ-NOTE-INFORMATION.
  1690         16  CZ-NOTE                 PIC X(63).
  1691         16  FILLER                  PIC X(39).
  1692******************************************************************
  1693
  1694*         COPY ELCCERT.
  1695******************************************************************
  1696*                                                                *
  1697*                            ELCCERT.                            *
  1698*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1699*                            VMOD=2.013                          *
  1700*                                                                *
  1701*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  1702*                                                                *
  1703*   FILE TYPE = VSAM,KSDS                                        *
  1704*   RECORD SIZE = 450  RECFORM = FIXED                           *
  1705*                                                                *
  1706*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  1707*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  1708*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  1709*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  1710*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  1711*                                                                *
  1712*   LOG = YES                                                    *
  1713*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1714******************************************************************
  1715*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  38
* EL1279.cbl
  1716*
  1717* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1718*-----------------------------------------------------------------
  1719*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1720* EFFECTIVE    NUMBER
  1721*-----------------------------------------------------------------
  1722* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  1723* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1724* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  1725* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  1726* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  1727* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  1728* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1729* 032612  CR2011110200001  PEMA  AHL CHANGES
  1730* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  1731******************************************************************
  1732
  1733 01  CERTIFICATE-MASTER.
  1734     12  CM-RECORD-ID                      PIC XX.
  1735         88  VALID-CM-ID                      VALUE 'CM'.
  1736
  1737     12  CM-CONTROL-PRIMARY.
  1738         16  CM-COMPANY-CD                 PIC X.
  1739         16  CM-CARRIER                    PIC X.
  1740         16  CM-GROUPING.
  1741             20  CM-GROUPING-PREFIX        PIC X(3).
  1742             20  CM-GROUPING-PRIME         PIC X(3).
  1743         16  CM-STATE                      PIC XX.
  1744         16  CM-ACCOUNT.
  1745             20  CM-ACCOUNT-PREFIX         PIC X(4).
  1746             20  CM-ACCOUNT-PRIME          PIC X(6).
  1747         16  CM-CERT-EFF-DT                PIC XX.
  1748         16  CM-CERT-NO.
  1749             20  CM-CERT-PRIME             PIC X(10).
  1750             20  CM-CERT-SFX               PIC X.
  1751
  1752     12  CM-CONTROL-BY-NAME.
  1753         16  CM-COMPANY-CD-A1              PIC X.
  1754         16  CM-INSURED-LAST-NAME          PIC X(15).
  1755         16  CM-INSURED-INITIALS.
  1756             20  CM-INSURED-INITIAL1       PIC X.
  1757             20  CM-INSURED-INITIAL2       PIC X.
  1758
  1759     12  CM-CONTROL-BY-SSN.
  1760         16  CM-COMPANY-CD-A2              PIC X.
  1761         16  CM-SOC-SEC-NO.
  1762             20  CM-SSN-STATE              PIC XX.
  1763             20  CM-SSN-ACCOUNT            PIC X(6).
  1764             20  CM-SSN-LN3.
  1765                 25  CM-INSURED-INITIALS-A2.
  1766                     30 CM-INSURED-INITIAL1-A2   PIC X.
  1767                     30 CM-INSURED-INITIAL2-A2   PIC X.
  1768                 25 CM-PART-LAST-NAME-A2         PIC X.
  1769
  1770     12  CM-CONTROL-BY-CERT-NO.
  1771         16  CM-COMPANY-CD-A4              PIC X.
  1772         16  CM-CERT-NO-A4                 PIC X(11).
  1773
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  39
* EL1279.cbl
  1774     12  CM-CONTROL-BY-MEMB.
  1775         16  CM-COMPANY-CD-A5              PIC X.
  1776         16  CM-MEMBER-NO.
  1777             20  CM-MEMB-STATE             PIC XX.
  1778             20  CM-MEMB-ACCOUNT           PIC X(6).
  1779             20  CM-MEMB-LN4.
  1780                 25  CM-INSURED-INITIALS-A5.
  1781                     30 CM-INSURED-INITIAL1-A5   PIC X.
  1782                     30 CM-INSURED-INITIAL2-A5   PIC X.
  1783                 25 CM-PART-LAST-NAME-A5         PIC XX.
  1784
  1785     12  CM-INSURED-PROFILE-DATA.
  1786         16  CM-INSURED-FIRST-NAME.
  1787             20  CM-INSURED-1ST-INIT       PIC X.
  1788             20  FILLER                    PIC X(9).
  1789         16  CM-INSURED-ISSUE-AGE          PIC 99.
  1790         16  CM-INSURED-SEX                PIC X.
  1791             88  CM-SEX-MALE                  VALUE 'M'.
  1792             88  CM-SEX-FEMAL                 VALUE 'F'.
  1793         16  CM-INSURED-JOINT-AGE          PIC 99.
  1794         16  CM-JOINT-INSURED-NAME.
  1795             20  CM-JT-LAST-NAME           PIC X(15).
  1796             20  CM-JT-FIRST-NAME.
  1797                 24  CM-JT-1ST-INIT        PIC X.
  1798                 24  FILLER                PIC X(9).
  1799             20  CM-JT-INITIAL             PIC X.
  1800
  1801     12  CM-LIFE-DATA.
  1802         16  CM-LF-BENEFIT-CD              PIC XX.
  1803         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  1804         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  1805         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  1806         16  CM-LF-DEV-CODE                PIC XXX.
  1807         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1808         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  1809         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1810         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  1811         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1812         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1813         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  1814         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1815         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  1816         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1817         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  1818         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  1819         16  cm-temp-epiq                  pic xx.
  1820             88  EPIQ-CLASS                  value 'EQ'.
  1821*        16  FILLER                        PIC XX.
  1822
  1823     12  CM-AH-DATA.
  1824         16  CM-AH-BENEFIT-CD              PIC XX.
  1825         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  1826         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  1827         16  CM-AH-DEV-CODE                PIC XXX.
  1828         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1829         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  1830         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1831         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  40
* EL1279.cbl
  1832         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1833         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  1834         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  1835         16  CM-AH-PAID-THRU-DT            PIC XX.
  1836             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  1837         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1838         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  1839         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  1840         16  FILLER                        PIC X.
  1841
  1842     12  CM-LOAN-INFORMATION.
  1843         16  CM-LIVES                      PIC S9(7)     COMP-3.
  1844         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  1845                                           PIC S9(5)V99  COMP-3.
  1846         16  CM-BILLED                     PIC S9(7)     COMP-3.
  1847         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  1848         16  CM-PAY-FREQUENCY              PIC S99.
  1849         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  1850         16  CM-RATE-CLASS                 PIC XX.
  1851         16  CM-BENEFICIARY                PIC X(25).
  1852         16  CM-POLICY-FORM-NO             PIC X(12).
  1853         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  1854         16  CM-LAST-ADD-ON-DT             PIC XX.
  1855         16  CM-DEDUCTIBLE-AMOUNTS.
  1856             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  1857             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  1858         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1859             20  CM-RESIDENT-STATE         PIC XX.
  1860             20  CM-RATE-CODE              PIC X(4).
  1861             20  FILLER                    PIC XX.
  1862         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1863             20  CM-LOAN-OFFICER           PIC X(5).
  1864             20  FILLER                    PIC XXX.
  1865         16  CM-CSR-CODE                   PIC XXX.
  1866         16  CM-UNDERWRITING-CODE          PIC X.
  1867             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  1868         16  CM-POST-CARD-IND              PIC X.
  1869         16  CM-NH-INTERFACE-SW            PIC X.
  1870         16  CM-PREMIUM-TYPE               PIC X.
  1871             88  CM-SING-PRM                  VALUE '1'.
  1872             88  CM-O-B-COVERAGE              VALUE '2'.
  1873             88  CM-OPEN-END                  VALUE '3'.
  1874         16  CM-IND-GRP-TYPE               PIC X.
  1875             88  CM-INDIVIDUAL                VALUE 'I'.
  1876             88  CM-GROUP                     VALUE 'G'.
  1877         16  CM-SKIP-CODE                  PIC X.
  1878             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  1879             88  SKIP-JULY                    VALUE '1'.
  1880             88  SKIP-AUGUST                  VALUE '2'.
  1881             88  SKIP-SEPTEMBER               VALUE '3'.
  1882             88  SKIP-JULY-AUG                VALUE '4'.
  1883             88  SKIP-AUG-SEPT                VALUE '5'.
  1884             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  1885             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  1886             88  SKIP-JUNE                    VALUE '8'.
  1887             88  SKIP-JUNE-JULY               VALUE '9'.
  1888             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  1889             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  41
* EL1279.cbl
  1890         16  CM-PAYMENT-MODE               PIC X.
  1891             88  PAY-MONTHLY                  VALUE SPACE.
  1892             88  PAY-WEEKLY                   VALUE '1'.
  1893             88  PAY-SEMI-MONTHLY             VALUE '2'.
  1894             88  PAY-BI-WEEKLY                VALUE '3'.
  1895             88  PAY-SEMI-ANUALLY             VALUE '4'.
  1896         16  CM-LOAN-NUMBER                PIC X(8).
  1897         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  1898         16  CM-OLD-LOF                    PIC XXX.
  1899*        16  CM-LOAN-OFFICER               PIC XXX.
  1900         16  CM-REIN-TABLE                 PIC XXX.
  1901         16  CM-SPECIAL-REIN-CODE          PIC X.
  1902         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  1903         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  1904         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  1905
  1906     12  CM-STATUS-DATA.
  1907         16  CM-ENTRY-STATUS               PIC X.
  1908         16  CM-ENTRY-DT                   PIC XX.
  1909
  1910         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  1911         16  CM-LF-CANCEL-DT               PIC XX.
  1912         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  1913
  1914         16  CM-LF-STATUS-AT-DEATH         PIC X.
  1915         16  CM-LF-DEATH-DT                PIC XX.
  1916         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  1917
  1918         16  CM-LF-CURRENT-STATUS          PIC X.
  1919             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1920                                                'M' '4' '5' '9'.
  1921             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  1922             88  CM-LF-POLICY-PENDING         VALUE '2'.
  1923             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  1924             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  1925             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  1926             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  1927             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  1928             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  1929             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  1930             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  1931             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  1932             88  CM-LF-DECLINED               VALUE 'D'.
  1933             88  CM-LF-VOIDED                 VALUE 'V'.
  1934
  1935         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  1936         16  CM-AH-CANCEL-DT               PIC XX.
  1937         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  1938
  1939         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  1940         16  CM-AH-SETTLEMENT-DT           PIC XX.
  1941         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  1942
  1943         16  CM-AH-CURRENT-STATUS          PIC X.
  1944             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1945                                                'M' '4' '5' '9'.
  1946             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  1947             88  CM-AH-POLICY-PENDING         VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  42
* EL1279.cbl
  1948             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  1949             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  1950             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  1951             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  1952             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  1953             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  1954             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  1955             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  1956             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  1957             88  CM-AH-DECLINED               VALUE 'D'.
  1958             88  CM-AH-VOIDED                 VALUE 'V'.
  1959
  1960         16  CM-CLAIM-INTERFACE-SW         PIC X.
  1961             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  1962             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  1963             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  1964         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  1965
  1966         16  CM-ENTRY-BATCH                PIC X(6).
  1967         16  CM-LF-EXIT-BATCH              PIC X(6).
  1968         16  CM-AH-EXIT-BATCH              PIC X(6).
  1969         16  CM-LAST-MONTH-END             PIC XX.
  1970
  1971     12  CM-NOTE-SW                        PIC X.
  1972         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  1973         88  CERT-NOTES-PRESENT               VALUE '1'.
  1974         88  BILLING-NOTES-PRESENT            VALUE '2'.
  1975         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  1976         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  1977         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  1978         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  1979         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  1980     12  CM-COMP-EXCP-SW                   PIC X.
  1981         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  1982         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  1983     12  CM-INSURED-ADDRESS-SW             PIC X.
  1984         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  1985         88  INSURED-ADDR-PRESENT             VALUE '1'.
  1986
  1987*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  1988     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  1989     12  FILLER                            PIC X.
  1990
  1991*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  1992     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  1993     12  FILLER                            PIC X.
  1994*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  1995     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  1996
  1997     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  1998         88  CERT-ADDED-BATCH                 VALUE ' '.
  1999         88  CERT-ADDED-ONLINE                VALUE '1'.
  2000         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2001         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2002         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2003     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2004         88  CERT-AS-LOADED                   VALUE ' '.
  2005         88  CERT-CANCELLED-ONLINE            VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  43
* EL1279.cbl
  2006         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2007         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2008         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2009         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2010         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2011         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2012
  2013     12  CM-ACCOUNT-COMM-PCTS.
  2014         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2015         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2016
  2017     12  CM-USER-FIELD                     PIC X.
  2018     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2019     12  CM-CLP-STATE                      PIC XX.
  2020     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2021     12  CM-USER-RESERVED                  PIC XXX.
  2022     12  FILLER REDEFINES CM-USER-RESERVED.
  2023         16  CM-AH-CLASS-CD                PIC XX.
  2024         16  F                             PIC X.
  2025******************************************************************
  2026
  2027 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CERT-NOTE-FILE
  2028                          CERTIFICATE-MASTER.
  2029 0000-DFHEXIT SECTION.
  2030     MOVE '9#                    $   ' TO DFHEIV0.
  2031     MOVE 'EL1279' TO DFHEIV1.
  2032     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2033
  2034     MOVE EIBTRMID               TO QID-TERM.
  2035     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  2036     MOVE '5'                    TO DC-OPTION-CODE.
  2037     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  2038     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  2039     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  2040
  2041     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK
  2042     IF EIBCALEN = ZEROS
  2043         GO TO 8800-UNAUTHORIZED-ACCESS
  2044     END-IF.
  2045
  2046     IF PI-CALLING-PROGRAM NOT = THIS-PGM AND PGM-EL1276
  2047         PERFORM 4900-SET-NOTES-FLAG THRU 4900-EXIT
  2048         IF CLAIM-SESSION
  2049             SET PI-CLAIM-NOTE TO TRUE
  2050         ELSE
  2051             SET PI-CERT-NOTE TO TRUE
  2052         END-IF
  2053     END-IF.
  2054
  2055     IF PI-CALLING-PROGRAM = PGM-EL1276
  2056         MOVE THIS-PGM           TO PI-CALLING-PROGRAM
  2057         MOVE 'N'                TO PI-PF5-PRESSED
  2058         MOVE 'N'                TO PI-PF6-PRESSED
  2059     END-IF.
  2060
  2061     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  2062        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  2063           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  44
* EL1279.cbl
  2064           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  2065           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  2066           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  2067           MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  2068           MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  2069           MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  2070           MOVE THIS-PGM TO PI-CALLING-PROGRAM
  2071        ELSE
  2072           MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  2073           MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  2074           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  2075           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  2076           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  2077           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  2078           MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  2079           MOVE SPACES               TO PI-SAVED-PROGRAM-6
  2080        END-IF
  2081     END-IF.
  2082
  2083 1000-START.
  2084
  2085     MOVE LOW-VALUES TO EL1279AI.
  2086     MOVE SPACES                 TO  ERCNOT-KEY
  2087                                     ELCERT-KEY.
  2088
  2089     MOVE PI-COMPANY-CD          TO  ERCNOT-COMPANY-CD
  2090                                     ELCERT-COMPANY-CD.
  2091     MOVE PI-CARRIER             TO  ERCNOT-CARRIER
  2092                                     ELCERT-CARRIER.
  2093     MOVE PI-GROUPING            TO  ERCNOT-GROUPING
  2094                                     ELCERT-GROUPING.
  2095     MOVE PI-STATE               TO  ERCNOT-STATE
  2096                                     ELCERT-STATE.
  2097     MOVE PI-ACCOUNT             TO  ERCNOT-ACCOUNT
  2098                                     ELCERT-ACCOUNT.
  2099     MOVE PI-CERT-EFF-DT         TO  ERCNOT-EFF-DT
  2100                                     ELCERT-EFF-DT.
  2101     MOVE PI-CERT-PRIME          TO  ERCNOT-CERT-PRIME
  2102                                     ELCERT-CERT-PRIME.
  2103     MOVE PI-CERT-SFX            TO  ERCNOT-CERT-SFX
  2104                                     ELCERT-CERT-SFX.
  2105     MOVE PI-CURR-NOTE-REC-TYPE  TO  ERCNOT-REC-TYP
  2106     MOVE ZEROS                  TO  ERCNOT-SEQ.
  2107     MOVE ERCNOT-PARTIAL-KEY     TO  SV-PRIOR-KEY.
  2108
  2109     IF EIBTRNID NOT = TRANS-ID
  2110        MOVE '0'                 TO  PI-UPDATE-SW
  2111        IF PI-PROCESSOR-ID NOT = 'LGXX'
  2112
  2113* EXEC CICS READQ TS
  2114*                    QUEUE (PI-SECURITY-TEMP-STORE-ID)
  2115*                    INTO (SECURITY-CONTROL)
  2116*                    LENGTH (SC-COMM-LENGTH)
  2117*                    ITEM  (SC-ITEM)
  2118*           END-EXEC
  2119*    MOVE '*$II   L              ''   #00002108' TO DFHEIV0
  2120     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  2121     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  45
* EL1279.cbl
  2122     MOVE X'2020233030303032313038' TO DFHEIV0(25:11)
  2123     CALL 'kxdfhei1' USING DFHEIV0,
  2124           PI-SECURITY-TEMP-STORE-ID,
  2125           SECURITY-CONTROL,
  2126           SC-COMM-LENGTH,
  2127           SC-ITEM,
  2128           DFHEIV99,
  2129           DFHEIV99
  2130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2131          MOVE SC-CREDIT-DISPLAY (32) TO PI-DISPLAY-CAP
  2132          MOVE SC-CREDIT-UPDATE (32)  TO PI-MODIFY-CAP
  2133        END-IF
  2134     END-IF.
  2135
  2136     IF NOT DISPLAY-CAP
  2137         MOVE 'READ'             TO  SM-READ
  2138         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  2139         MOVE ER-0070            TO  EMI-ERROR
  2140         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2141         GO TO 8100-SEND-INITIAL-MAP
  2142     END-IF.
  2143
  2144
  2145* EXEC CICS HANDLE AID
  2146*         CLEAR(9400-CLEAR)
  2147*    END-EXEC.
  2148*    MOVE '"&=                  V! " #00002127' TO DFHEIV0
  2149     MOVE X'22263D202020202020202020' TO DFHEIV0(1:12)
  2150     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  2151     MOVE X'2220233030303032313237' TO DFHEIV0(25:11)
  2152     CALL 'kxdfhei1' USING DFHEIV0
  2153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2154
  2155
  2156
  2157* EXEC CICS HANDLE CONDITION
  2158*         ERROR(9990-ABEND)
  2159*         PGMIDERR(9600-PGMID-ERROR)
  2160*    END-EXEC.
  2161*    MOVE '"$.L                  ! # #00002131' TO DFHEIV0
  2162     MOVE X'22242E4C2020202020202020' TO DFHEIV0(1:12)
  2163     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2164     MOVE X'2320233030303032313331' TO DFHEIV0(25:11)
  2165     CALL 'kxdfhei1' USING DFHEIV0
  2166     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2167
  2168
  2169     IF EIBTRNID NOT = TRANS-ID
  2170         GO TO 7000-BUILD-TABLE
  2171     END-IF.
  2172
  2173     IF PI-CHANGE-IN-NOTE-TYPE
  2174         GO TO 7000-BUILD-TABLE
  2175     END-IF.
  2176
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  46
* EL1279.cbl
  2178 2000-RECEIVE.
  2179     IF EIBAID = DFHPA1 OR
  2180        EIBAID = DFHPA2 OR
  2181        EIBAID = DFHPA3
  2182           MOVE ER-0008 TO EMI-ERROR
  2183           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2184           GO TO 8200-SEND-DATAONLY
  2185     END-IF.
  2186
  2187
  2188* EXEC CICS RECEIVE
  2189*         MAP(MAP-NAME)
  2190*         MAPSET(MAPSET-NAME)
  2191*         INTO(EL1279AI)
  2192*    END-EXEC.
  2193     MOVE LENGTH OF
  2194      EL1279AI
  2195       TO DFHEIV11
  2196*    MOVE '8"T I  L              ''   #00002154' TO DFHEIV0
  2197     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  2198     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2199     MOVE X'2020233030303032313534' TO DFHEIV0(25:11)
  2200     CALL 'kxdfhei1' USING DFHEIV0,
  2201           MAP-NAME,
  2202           EL1279AI,
  2203           DFHEIV11,
  2204           MAPSET-NAME,
  2205           DFHEIV99,
  2206           DFHEIV99
  2207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2208
  2209
  2210     IF PFENTERL = ZEROS
  2211        GO TO 2001-CHECK-PFKEYS
  2212     END-IF.
  2213
  2214     IF EIBAID NOT = DFHENTER
  2215        MOVE ER-0004             TO EMI-ERROR
  2216        GO TO 2002-INPUT-ERROR
  2217     END-IF.
  2218
  2219     IF PFENTERI NUMERIC AND
  2220        (PFENTERI > 00 AND  < 25)
  2221        MOVE PF-VALUES (PFENTERI) TO EIBAID
  2222     ELSE
  2223        MOVE ER-0029 TO EMI-ERROR
  2224        GO TO 2002-INPUT-ERROR
  2225     END-IF.
  2226
  2227 2001-CHECK-PFKEYS.
  2228     IF EIBAID = DFHPF23
  2229        GO TO 9000-RETURN-CICS
  2230     END-IF.
  2231
  2232     IF EIBAID = DFHPF24
  2233        GO TO 9200-RETURN-MAIN-MENU
  2234     END-IF.
  2235
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  47
* EL1279.cbl
  2236     IF EIBAID = DFHPF12
  2237        GO TO 9500-PF12
  2238     END-IF.
  2239
  2240     IF EIBAID = DFHPF5
  2241        IF PI-CHANGES-MADE
  2242            SET PF5-PRESSED          TO TRUE
  2243            MOVE -1                  TO FUNCTL
  2244            MOVE SPACES              TO PFENTERO
  2245            MOVE AL-UNNOF            TO PFENTERA
  2246            MOVE ER-0045             TO EMI-ERROR
  2247            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2248            GO TO 8200-SEND-DATAONLY
  2249         ELSE
  2250            MOVE PGM-EL1276         TO PGM-NAME
  2251            GO TO 9300-XCTL
  2252         END-IF
  2253     END-IF.
  2254
  2255     IF EIBAID = DFHPF6
  2256        IF PI-CHANGES-MADE
  2257            SET PF6-PRESSED          TO TRUE
  2258            MOVE -1                  TO FUNCTL
  2259            MOVE SPACES              TO PFENTERO
  2260            MOVE AL-UNNOF            TO PFENTERA
  2261            MOVE ER-0045             TO EMI-ERROR
  2262            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2263            GO TO 8200-SEND-DATAONLY
  2264         ELSE
  2265            IF PI-CLAIM-NOTE
  2266                SET PI-CERT-NOTE    TO TRUE
  2267            ELSE
  2268                SET PI-CLAIM-NOTE   TO TRUE
  2269            END-IF
  2270            SET PI-CHANGE-IN-NOTE-TYPE TO TRUE
  2271            GO TO 1000-START
  2272         END-IF
  2273     END-IF.
  2274
  2275     IF EIBAID = DFHPF7
  2276         MOVE PGM-EL1284          TO PGM-NAME
  2277         GO TO 9300-XCTL.
  2278
  2279     IF FUNCTL NOT = ZEROS AND EIBAID NOT = DFHENTER
  2280        IF FUNCTI = 'A' OR = SPACES
  2281           NEXT SENTENCE
  2282        ELSE
  2283           MOVE ER-0050          TO EMI-ERROR
  2284           MOVE -1 TO FUNCTL
  2285           MOVE AL-UABON TO FUNCTA PFENTERA
  2286           GO TO 2002-INPUT-ERROR
  2287        END-IF
  2288     END-IF.
  2289
  2290     IF EIBAID = DFHPF1
  2291        MOVE NUM-LINES-PER-SCREEN TO ROLL-COUNTER
  2292        GO TO 7400-PAGE-ROUTINE
  2293     END-IF.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  48
* EL1279.cbl
  2294
  2295     IF EIBAID = DFHPF2
  2296        SUBTRACT NUM-LINES-PER-SCREEN FROM ROLL-COUNTER
  2297        GO TO 7400-PAGE-ROUTINE
  2298     END-IF.
  2299
  2300     IF EIBAID = DFHPF3
  2301        MOVE 5                   TO ROLL-COUNTER
  2302        GO TO 7400-PAGE-ROUTINE
  2303     END-IF.
  2304
  2305     IF EIBAID = DFHPF4
  2306        MOVE -5                  TO ROLL-COUNTER
  2307        GO TO 7400-PAGE-ROUTINE
  2308     END-IF.
  2309
  2310     IF EIBAID = DFHENTER
  2311        GO TO 2003-EDIT-DATA
  2312     END-IF.
  2313
  2314     MOVE ER-0029                TO EMI-ERROR.
  2315
  2316 2002-INPUT-ERROR.
  2317     MOVE -1                     TO PFENTERL
  2318     MOVE AL-UNBON               TO PFENTERA
  2319     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2320     GO TO 8200-SEND-DATAONLY.
  2321
  2322 2003-EDIT-DATA.
  2323
  2324     IF FUNCTI = 'L'
  2325         NEXT SENTENCE
  2326     ELSE
  2327         IF NOT MODIFY-CAP
  2328             MOVE 'UPDATE'       TO  SM-READ
  2329             PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  2330             MOVE ER-0070        TO  EMI-ERROR
  2331             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2332             GO TO 8100-SEND-INITIAL-MAP
  2333         END-IF
  2334     END-IF.
  2335
  2336     IF FUNCTL = ZEROS OR FUNCTI = SPACES
  2337        GO TO 4000-CHANGE-ROUTINE
  2338     END-IF.
  2339
  2340     IF (FUNCTI = 'S' OR = 'D' OR = 'Q' OR
  2341                = 'I' OR = 'A' OR = 'L')
  2342         NEXT SENTENCE
  2343     ELSE
  2344         MOVE ER-0023            TO EMI-ERROR
  2345         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2346         MOVE AL-UABON           TO FUNCTA
  2347         MOVE -1                 TO FUNCTL
  2348         GO TO 8200-SEND-DATAONLY
  2349     END-IF.
  2350
  2351     IF FUNCTI = 'D'  OR = 'I' OR = 'L'
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  49
* EL1279.cbl
  2352        PERFORM 2500-LINE-CHECK THRU 2599-EXIT
  2353     ELSE
  2354        IF LINE1L NOT = ZEROS OR
  2355           LINE2L NOT = ZEROS
  2356           MOVE ER-0030          TO EMI-ERROR
  2357           MOVE -1               TO LINE1L
  2358           MOVE AL-UNBON         TO LINE1A LINE2A
  2359           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2360           GO TO 8200-SEND-DATAONLY
  2361        END-IF
  2362     END-IF.
  2363
  2364     IF FUNCTI = 'A'
  2365        GO TO 5000-ADD-NEW-LINES
  2366     END-IF.
  2367     IF FUNCTI = 'Q'
  2368        GO TO 9410-RETURN
  2369     END-IF.
  2370     IF FUNCTI = 'S'
  2371        GO TO 4500-SAVE-DATA
  2372     END-IF.
  2373     IF PI-TOTAL-LINES = 0
  2374        MOVE ER-0048             TO EMI-ERROR
  2375        MOVE -1                  TO FUNCTL
  2376        MOVE AL-UNBON            TO FUNCTA
  2377        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2378        GO TO 8200-SEND-DATAONLY
  2379     END-IF.
  2380     IF FUNCTI = 'L'
  2381        GO TO 5500-LOOKUP
  2382     END-IF.
  2383     IF FUNCTI = 'D'
  2384        GO TO 3000-DELETE-LINES
  2385     END-IF.
  2386
  2387     GO TO 3500-INSERT-LINES.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  50
* EL1279.cbl
  2389 2500-LINE-CHECK.
  2390     IF LINE1L = ZEROS AND
  2391        LINE2L = ZEROS
  2392        MOVE ER-0069             TO EMI-ERROR
  2393        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2394        MOVE -1                  TO LINE1L
  2395        GO TO 8200-SEND-DATAONLY
  2396     END-IF.
  2397
  2398     IF LINE1L NOT = ZEROS
  2399        IF LINE1I = ZERO AND FUNCTI EQUAL 'L'
  2400            MOVE 1               TO LINE1I
  2401        END-IF
  2402        IF LINE1I = ZERO AND FUNCTI EQUAL 'D'
  2403           MOVE ER-0049          TO EMI-ERROR
  2404           MOVE AL-UNBON         TO LINE1A
  2405           MOVE -1               TO LINE1L
  2406           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2407           GO TO 8200-SEND-DATAONLY
  2408        END-IF
  2409        IF LINE1I NOT NUMERIC OR
  2410           LINE1I > PI-TOTAL-LINES
  2411           MOVE ER-0031          TO EMI-ERROR
  2412           MOVE AL-UNBON         TO LINE1A
  2413           MOVE -1               TO LINE1L
  2414           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2415           GO TO 8200-SEND-DATAONLY
  2416        ELSE
  2417           IF LINE2L = ZEROS
  2418              MOVE 1             TO LINE2I
  2419              IF FUNCTI = 'I'
  2420                  GO TO 2510-MAX-CHECK
  2421              ELSE
  2422                  NEXT SENTENCE
  2423              END-IF
  2424           ELSE
  2425              IF FUNCTI = 'I'
  2426                 GO TO 2510-MAX-CHECK
  2427              ELSE
  2428                 IF LINE2I NOT NUMERIC
  2429                    MOVE AL-UNBON TO LINE2A
  2430                    MOVE ER-0032  TO EMI-ERROR
  2431                    MOVE -1       TO LINE2L
  2432                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2433                    GO TO 8200-SEND-DATAONLY
  2434                 ELSE
  2435                    NEXT SENTENCE
  2436                 END-IF
  2437              END-IF
  2438           END-IF
  2439        END-IF
  2440     ELSE
  2441        IF LINE2L = ZEROS
  2442           NEXT SENTENCE
  2443        ELSE
  2444           MOVE -1               TO LINE2L
  2445           MOVE ER-0041          TO EMI-ERROR
  2446           MOVE AL-UNBON         TO LINE2A
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  51
* EL1279.cbl
  2447           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2448           GO TO 8200-SEND-DATAONLY
  2449        END-IF
  2450     END-IF.
  2451     GO TO 2599-EXIT.
  2452 2510-MAX-CHECK.
  2453     IF LINE2I NOT NUMERIC
  2454        MOVE -1                  TO LINE2L
  2455        MOVE ER-0032             TO EMI-ERROR
  2456        MOVE AL-UNBON            TO LINE2A
  2457        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2458        GO TO 8200-SEND-DATAONLY
  2459     ELSE
  2460        COMPUTE ROLL-COUNTER = LINE2I + PI-TOTAL-LINES
  2461        IF ROLL-COUNTER GREATER THAN MAX-LINES
  2462           MOVE -1               TO LINE2L
  2463           MOVE ER-0044          TO EMI-ERROR
  2464           MOVE AL-UNBON         TO LINE2A
  2465           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2466           GO TO 8200-SEND-DATAONLY
  2467        END-IF
  2468     END-IF.
  2469 2599-EXIT.
  2470      EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  52
* EL1279.cbl
  2472 3000-DELETE-LINES.
  2473     IF LINE2L = ZEROS AND LINE2I = 1
  2474        MOVE LINE1I              TO LINE2I
  2475     END-IF.
  2476
  2477     IF LINE2I > PI-TOTAL-LINES OR < LINE1I
  2478        MOVE ER-0049             TO EMI-ERROR
  2479        MOVE AL-UNBON            TO LINE2A
  2480        MOVE -1                  TO LINE2L
  2481        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2482        GO TO 8200-SEND-DATAONLY
  2483     END-IF.
  2484
  2485     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  2486     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  2487             VARYING SC-INDX FROM 1 BY 1 UNTIL
  2488             SC-INDX > NUM-LINES-PER-SCREEN
  2489     SET TB-INDX TO LINE1I.
  2490
  2491     IF NOT EMI-NO-ERRORS
  2492        GO TO 8200-SEND-DATAONLY
  2493     END-IF.
  2494
  2495     SET TB-INDX TO LINE1I
  2496     COMPUTE ROLL-COUNTER = LINE2I - LINE1I + 1.
  2497
  2498     IF LINE2I NOT = PI-TOTAL-LINES
  2499        SET TB-INDX1 TO LINE2I
  2500        SET TB-INDX1 UP BY 1
  2501        PERFORM 3100-DELETE-TABLE-ENTRIES
  2502                UNTIL TB-INDX1 > PI-TOTAL-LINES
  2503     END-IF.
  2504
  2505     PERFORM 3150-BLANK-TABLE-ENTRIES
  2506             ROLL-COUNTER TIMES.
  2507     SUBTRACT ROLL-COUNTER FROM PI-TOTAL-LINES.
  2508
  2509     IF PI-CURRENT-LINE > PI-TOTAL-LINES
  2510        MOVE PI-TOTAL-LINES      TO PI-CURRENT-LINE
  2511        SUBTRACT 1 FROM PI-CURRENT-LINE
  2512     END-IF.
  2513
  2514     SET TB-INDX  TO PI-CURRENT-LINE
  2515     MOVE LOW-VALUES             TO EL1279AI
  2516
  2517     IF PI-CURRENT-LINE > ZERO
  2518         PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  2519             VARYING SC-INDX FROM 1 BY 1 UNTIL
  2520             SC-INDX > NUM-LINES-PER-SCREEN
  2521         PERFORM 7200-PUT-TEMP-STOR  THRU 7249-EXIT
  2522     END-IF.
  2523
  2524     MOVE '1'                    TO PI-UPDATE-SW.
  2525     IF PI-TOTAL-LINES = ZEROS
  2526        MOVE ZEROS               TO PI-CURRENT-LINE
  2527     END-IF.
  2528     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  53
* EL1279.cbl
  2530
  2531 3100-DELETE-TABLE-ENTRIES.
  2532     MOVE REC-ENT (TB-INDX1)     TO REC-ENT (TB-INDX)
  2533     SET TB-INDX TB-INDX1 UP BY 1.
  2534
  2535 3150-BLANK-TABLE-ENTRIES.
  2536     MOVE SPACES               TO REC-ENT (TB-INDX).
  2537     MOVE SAVE-BIN-DATE        TO REC-LAST-MAINT-DT (TB-INDX).
  2538     MOVE EIBTIME              TO REC-LAST-MAINT-HHMMSS (TB-INDX).
  2539     MOVE PI-PROCESSOR-ID      TO REC-LAST-MAINT-BY (TB-INDX).
  2540     SET TB-INDX UP BY 1.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  54
* EL1279.cbl
  2542 3500-INSERT-LINES.
  2543
  2544     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  2545     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  2546             VARYING SC-INDX FROM 1 BY 1 UNTIL
  2547             SC-INDX > NUM-LINES-PER-SCREEN.
  2548
  2549     IF NOT EMI-NO-ERRORS
  2550        GO TO 8200-SEND-DATAONLY
  2551     END-IF.
  2552
  2553     SET TB-INDX TO PI-TOTAL-LINES.
  2554     ADD LINE2I TO PI-TOTAL-LINES.
  2555     SET TB-INDX1 TO PI-TOTAL-LINES.
  2556     PERFORM 3600-INSERT-TABLE-ENTRIES
  2557             UNTIL TB-INDX = LINE1I.
  2558     SET TB-INDX UP BY 1.
  2559
  2560     IF LINE1I EQUAL ZERO
  2561         SET PI-CURRENT-LINE TO 1
  2562     ELSE
  2563         SET PI-CURRENT-LINE TO LINE1I
  2564     END-IF.
  2565
  2566     COMPUTE ROLL-COUNTER = PI-CURRENT-LINE +
  2567                            NUM-LINES-PER-SCREEN.
  2568     IF TB-INDX NOT LESS THAN ROLL-COUNTER OR
  2569                    LESS THAN PI-CURRENT-LINE
  2570        SET SC-INDX TO 1
  2571        SET SC-INDX DOWN BY 1
  2572     ELSE
  2573        SET ROLL-COUNTER TO TB-INDX
  2574        COMPUTE ROLL-COUNTER = ROLL-COUNTER - PI-CURRENT-LINE
  2575                  + 1
  2576        SET SC-INDX TO ROLL-COUNTER
  2577     END-IF.
  2578
  2579     PERFORM 3150-BLANK-TABLE-ENTRIES LINE2I TIMES.
  2580     SET TB-INDX TO PI-CURRENT-LINE.
  2581     MOVE LOW-VALUES             TO EL1279AI.
  2582
  2583     IF SC-INDX NOT = ZERO
  2584        MOVE -1 TO SC-TEXTL (SC-INDX)
  2585     END-IF.
  2586
  2587     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  2588            VARYING SC-INDX FROM 1 BY 1 UNTIL
  2589            SC-INDX > NUM-LINES-PER-SCREEN.
  2590     PERFORM 7200-PUT-TEMP-STOR  THRU 7249-EXIT.
  2591     MOVE '1'                    TO PI-UPDATE-SW.
  2592     GO TO 8100-SEND-INITIAL-MAP.
  2593
  2594 3600-INSERT-TABLE-ENTRIES.
  2595     MOVE REC-ENT (TB-INDX)      TO REC-ENT (TB-INDX1).
  2596     SET TB-INDX TB-INDX1 DOWN BY 1.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  55
* EL1279.cbl
  2598
  2599 4000-CHANGE-ROUTINE.
  2600     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  2601     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  2602             VARYING SC-INDX FROM 1 BY 1 UNTIL
  2603             SC-INDX > NUM-LINES-PER-SCREEN.
  2604
  2605     IF NOT EMI-NO-ERRORS
  2606        GO TO 8200-SEND-DATAONLY
  2607     END-IF.
  2608
  2609     PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT.
  2610     MOVE SPACES                 TO ERRMSGBO.
  2611     GO TO 8200-SEND-DATAONLY.
  2612
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  56
* EL1279.cbl
  2614 4500-SAVE-DATA.
  2615     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  2616     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  2617             VARYING SC-INDX FROM 1 BY 1 UNTIL
  2618             SC-INDX > NUM-LINES-PER-SCREEN.
  2619     IF NOT EMI-NO-ERRORS
  2620        GO TO 8200-SEND-DATAONLY
  2621     END-IF.
  2622
  2623
  2624* EXEC CICS HANDLE CONDITION
  2625*         NOTFND(4610-ENDBR)
  2626*         NOTOPEN(6000-NOT-OPEN)
  2627*         ENDFILE(4610-ENDBR)
  2628*    END-EXEC.
  2629*    MOVE '"$IJ''                 ! $ #00002573' TO DFHEIV0
  2630     MOVE X'2224494A2720202020202020' TO DFHEIV0(1:12)
  2631     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2632     MOVE X'2420233030303032353733' TO DFHEIV0(25:11)
  2633     CALL 'kxdfhei1' USING DFHEIV0
  2634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2635
  2636
  2637 4610-LOOP.
  2638
  2639* EXEC CICS READ
  2640*        DATASET (ERCNOT-FILE-ID)
  2641*        RIDFLD  (ERCNOT-KEY)
  2642*        SET     (ADDRESS OF CERT-NOTE-FILE)
  2643*        GTEQ
  2644*    END-EXEC.
  2645*    MOVE '&"S        G          (   #00002580' TO DFHEIV0
  2646     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  2647     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2648     MOVE X'2020233030303032353830' TO DFHEIV0(25:11)
  2649     CALL 'kxdfhei1' USING DFHEIV0,
  2650           ERCNOT-FILE-ID,
  2651           DFHEIV20,
  2652           DFHEIV99,
  2653           ERCNOT-KEY,
  2654           DFHEIV99,
  2655           DFHEIV99,
  2656           DFHEIV99
  2657     SET ADDRESS OF CERT-NOTE-FILE TO
  2658         DFHEIV20
  2659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2660
  2661
  2662     MOVE CZ-CONTROL-PRIMARY     TO ERCNOT-KEY.
  2663
  2664     IF ERCNOT-PARTIAL-KEY NOT = SV-PRIOR-KEY
  2665         MOVE SV-PRIOR-KEY       TO ERCNOT-PARTIAL-KEY
  2666         GO TO 4610-ENDBR
  2667     END-IF.
  2668
  2669
  2670* EXEC CICS DELETE
  2671*        DATASET (ERCNOT-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  57
* EL1279.cbl
  2672*        RIDFLD  (ERCNOT-KEY)
  2673*    END-EXEC.
  2674*    MOVE '&(  R                 &   #00002594' TO DFHEIV0
  2675     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  2676     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2677     MOVE X'2020233030303032353934' TO DFHEIV0(25:11)
  2678     CALL 'kxdfhei1' USING DFHEIV0,
  2679           ERCNOT-FILE-ID,
  2680           ERCNOT-KEY,
  2681           DFHEIV99,
  2682           DFHEIV99,
  2683           DFHEIV99
  2684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2685
  2686
  2687     GO TO 4610-LOOP.
  2688 4610-ENDBR.
  2689
  2690* EXEC CICS GETMAIN
  2691*         LENGTH(ERCNOT-LENGTH)
  2692*         SET(ADDRESS OF CERT-NOTE-FILE)
  2693*         INITIMG(GETMAIN-SPACE)
  2694*    END-EXEC.
  2695*    MOVE ',"IL                  $   #00002601' TO DFHEIV0
  2696     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  2697     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2698     MOVE X'2020233030303032363031' TO DFHEIV0(25:11)
  2699     CALL 'kxdfhei1' USING DFHEIV0,
  2700           DFHEIV20,
  2701           ERCNOT-LENGTH,
  2702           GETMAIN-SPACE
  2703     SET ADDRESS OF CERT-NOTE-FILE TO
  2704         DFHEIV20
  2705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2706
  2707
  2708     MOVE ZERO                   TO  ERCNOT-SEQ.
  2709     MOVE ZERO                   TO  WS-BLANK-LINES.
  2710
  2711     PERFORM 4700-WRITE-FILE THRU 4799-EXIT
  2712             VARYING TB-INDX FROM 1 BY 1 UNTIL
  2713             TB-INDX > PI-TOTAL-LINES.
  2714
  2715     SUBTRACT WS-BLANK-LINES FROM PI-TOTAL-LINES.
  2716
  2717     PERFORM 4800-CERTIFICATE-UPDATE THRU 4899-EXIT.
  2718
  2719     GO TO 9410-RETURN.
  2720
  2721 4700-WRITE-FILE.
  2722     IF PI-CERT-NOTE AND REC-TEXT (TB-INDX)  EQUAL SPACES
  2723         ADD +1                  TO  WS-BLANK-LINES
  2724         GO TO 4799-EXIT
  2725     END-IF.
  2726
  2727     MOVE SPACES                 TO  CERT-NOTE-FILE.
  2728     ADD 1                       TO  ERCNOT-SEQ.
  2729     MOVE ERCNOT-KEY             TO  CZ-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  58
* EL1279.cbl
  2730     MOVE  'CZ'                  TO  CZ-RECORD-ID.
  2731     MOVE REC-TEXT (TB-INDX)     TO  CZ-NOTE.
  2732     MOVE REC-LAST-MAINT-BY (TB-INDX)
  2733                                 TO  CZ-LAST-MAINT-USER.
  2734     MOVE REC-LAST-MAINT-HHMMSS (TB-INDX)
  2735                                 TO  CZ-LAST-MAINT-HHMMSS.
  2736     MOVE REC-LAST-MAINT-DT (TB-INDX)
  2737                                 TO  CZ-LAST-MAINT-DT.
  2738
  2739
  2740* EXEC CICS WRITE
  2741*         DATASET(ERCNOT-FILE-ID)
  2742*         FROM(CERT-NOTE-FILE)
  2743*         RIDFLD(ERCNOT-KEY)
  2744*    END-EXEC.
  2745     MOVE LENGTH OF
  2746      CERT-NOTE-FILE
  2747       TO DFHEIV11
  2748*    MOVE '&$ L                  ''   #00002638' TO DFHEIV0
  2749     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  2750     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2751     MOVE X'2020233030303032363338' TO DFHEIV0(25:11)
  2752     CALL 'kxdfhei1' USING DFHEIV0,
  2753           ERCNOT-FILE-ID,
  2754           CERT-NOTE-FILE,
  2755           DFHEIV11,
  2756           ERCNOT-KEY,
  2757           DFHEIV99,
  2758           DFHEIV99
  2759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2760
  2761 4799-EXIT.
  2762      EXIT.
  2763
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  59
* EL1279.cbl
  2765 4800-CERTIFICATE-UPDATE.
  2766
  2767
  2768* EXEC CICS HANDLE CONDITION
  2769*        NOTFND   (4899-EXIT)
  2770*    END-EXEC.
  2771*    MOVE '"$I                   ! % #00002649' TO DFHEIV0
  2772     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  2773     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2774     MOVE X'2520233030303032363439' TO DFHEIV0(25:11)
  2775     CALL 'kxdfhei1' USING DFHEIV0
  2776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2777
  2778
  2779
  2780* EXEC CICS READ
  2781*    EQUAL
  2782*    DATASET   (ELCERT-FILE-ID)
  2783*    SET       (ADDRESS OF CERTIFICATE-MASTER)
  2784*    RIDFLD    (ELCERT-KEY)
  2785*    UPDATE
  2786*    END-EXEC.
  2787*    MOVE '&"S        EU         (   #00002653' TO DFHEIV0
  2788     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2789     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2790     MOVE X'2020233030303032363533' TO DFHEIV0(25:11)
  2791     CALL 'kxdfhei1' USING DFHEIV0,
  2792           ELCERT-FILE-ID,
  2793           DFHEIV20,
  2794           DFHEIV99,
  2795           ELCERT-KEY,
  2796           DFHEIV99,
  2797           DFHEIV99,
  2798           DFHEIV99
  2799     SET ADDRESS OF CERTIFICATE-MASTER TO
  2800         DFHEIV20
  2801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2802
  2803
  2804     IF PI-TOTAL-LINES > 0
  2805        IF PI-CERT-NOTE
  2806           MOVE 'Y'           TO PI-CERT-NOTES-EXIST
  2807           IF CM-NOTE-SW = ' '
  2808              MOVE '1'        TO CM-NOTE-SW
  2809           ELSE
  2810             IF CM-NOTE-SW = '2'
  2811                MOVE '3'      TO CM-NOTE-SW
  2812             ELSE
  2813               IF CM-NOTE-SW = '4'
  2814                  MOVE '5'    TO CM-NOTE-SW
  2815               ELSE
  2816                 IF CM-NOTE-SW = '6'
  2817                    MOVE '7'  TO CM-NOTE-SW
  2818                 END-IF
  2819               END-IF
  2820             END-IF
  2821           END-IF
  2822        ELSE
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  60
* EL1279.cbl
  2823           MOVE 'Y'           TO PI-CLAIM-NOTES-EXIST
  2824           IF CM-NOTE-SW = ' '
  2825              MOVE '4'        TO CM-NOTE-SW
  2826           ELSE
  2827             IF CM-NOTE-SW = '1'
  2828                MOVE '5'      TO CM-NOTE-SW
  2829             ELSE
  2830               IF CM-NOTE-SW = '2'
  2831                  MOVE '6'    TO CM-NOTE-SW
  2832               ELSE
  2833                 IF CM-NOTE-SW = '3'
  2834                    MOVE '7'  TO CM-NOTE-SW
  2835                 END-IF
  2836               END-IF
  2837             END-IF
  2838           END-IF
  2839        END-IF
  2840     ELSE
  2841        IF PI-CERT-NOTE
  2842           MOVE 'N'           TO PI-CERT-NOTES-EXIST
  2843           IF CM-NOTE-SW = '1'
  2844              MOVE ' '        TO CM-NOTE-SW
  2845           ELSE
  2846             IF CM-NOTE-SW = '3'
  2847                MOVE '2'      TO CM-NOTE-SW
  2848             ELSE
  2849               IF CM-NOTE-SW = '5'
  2850                  MOVE '4'    TO CM-NOTE-SW
  2851               ELSE
  2852                 IF CM-NOTE-SW = '7'
  2853                    MOVE '6'  TO CM-NOTE-SW
  2854                 END-IF
  2855               END-IF
  2856             END-IF
  2857           END-IF
  2858        ELSE
  2859           MOVE 'N'           TO PI-CLAIM-NOTES-EXIST
  2860           IF CM-NOTE-SW = '4'
  2861              MOVE ' '        TO CM-NOTE-SW
  2862           ELSE
  2863             IF CM-NOTE-SW = '5'
  2864                MOVE '1'      TO CM-NOTE-SW
  2865             ELSE
  2866               IF CM-NOTE-SW = '6'
  2867                  MOVE '2'    TO CM-NOTE-SW
  2868               ELSE
  2869                 IF CM-NOTE-SW = '7'
  2870                    MOVE '3'  TO CM-NOTE-SW
  2871                 END-IF
  2872               END-IF
  2873             END-IF
  2874           END-IF
  2875        END-IF
  2876     END-IF.
  2877
  2878
  2879
  2880* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  61
* EL1279.cbl
  2881*        FROM      (CERTIFICATE-MASTER)
  2882*        DATASET   (ELCERT-FILE-ID)
  2883*    END-EXEC.
  2884     MOVE LENGTH OF
  2885      CERTIFICATE-MASTER
  2886       TO DFHEIV11
  2887*    MOVE '&& L                  %   #00002736' TO DFHEIV0
  2888     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2889     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2890     MOVE X'2020233030303032373336' TO DFHEIV0(25:11)
  2891     CALL 'kxdfhei1' USING DFHEIV0,
  2892           ELCERT-FILE-ID,
  2893           CERTIFICATE-MASTER,
  2894           DFHEIV11,
  2895           DFHEIV99
  2896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2897
  2898
  2899 4899-EXIT.
  2900      EXIT.
  2901
  2902 4900-SET-NOTES-FLAG.
  2903
  2904
  2905* EXEC CICS HANDLE CONDITION
  2906*        NOTFND   (4900-EXIT)
  2907*    END-EXEC.
  2908*    MOVE '"$I                   ! & #00002746' TO DFHEIV0
  2909     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  2910     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2911     MOVE X'2620233030303032373436' TO DFHEIV0(25:11)
  2912     CALL 'kxdfhei1' USING DFHEIV0
  2913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2914
  2915
  2916     MOVE SPACES                 TO  ELCERT-KEY.
  2917     MOVE PI-COMPANY-CD          TO  ELCERT-COMPANY-CD.
  2918     MOVE PI-CARRIER             TO  ELCERT-CARRIER.
  2919     MOVE PI-GROUPING            TO  ELCERT-GROUPING.
  2920     MOVE PI-STATE               TO  ELCERT-STATE.
  2921     MOVE PI-ACCOUNT             TO  ELCERT-ACCOUNT.
  2922     MOVE PI-CERT-EFF-DT         TO  ELCERT-EFF-DT.
  2923     MOVE PI-CERT-PRIME          TO  ELCERT-CERT-PRIME.
  2924     MOVE PI-CERT-SFX            TO  ELCERT-CERT-SFX.
  2925
  2926
  2927* EXEC CICS READ
  2928*    EQUAL
  2929*    DATASET   (ELCERT-FILE-ID)
  2930*    SET       (ADDRESS OF CERTIFICATE-MASTER)
  2931*    RIDFLD    (ELCERT-KEY)
  2932*    END-EXEC.
  2933*    MOVE '&"S        E          (   #00002760' TO DFHEIV0
  2934     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2935     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2936     MOVE X'2020233030303032373630' TO DFHEIV0(25:11)
  2937     CALL 'kxdfhei1' USING DFHEIV0,
  2938           ELCERT-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  62
* EL1279.cbl
  2939           DFHEIV20,
  2940           DFHEIV99,
  2941           ELCERT-KEY,
  2942           DFHEIV99,
  2943           DFHEIV99,
  2944           DFHEIV99
  2945     SET ADDRESS OF CERTIFICATE-MASTER TO
  2946         DFHEIV20
  2947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2948
  2949
  2950     MOVE 'N'                    TO PI-BILLING-NOTES-EXIST
  2951                                    PI-CERT-NOTES-EXIST
  2952                                    PI-CLAIM-NOTES-EXIST.
  2953     IF CM-NOTE-SW EQUAL '2' OR '3' OR '6' OR '7'
  2954          MOVE 'Y'               TO PI-BILLING-NOTES-EXIST
  2955     END-IF.
  2956     IF CM-NOTE-SW EQUAL '1' OR '3' OR '5' OR '7'
  2957          MOVE 'Y'               TO PI-CERT-NOTES-EXIST
  2958     END-IF.
  2959     IF CM-NOTE-SW EQUAL '4' OR '5' OR '6' OR '7'
  2960          MOVE 'Y'               TO PI-CLAIM-NOTES-EXIST
  2961     END-IF.
  2962
  2963
  2964 4900-EXIT.
  2965      EXIT.
  2966
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  63
* EL1279.cbl
  2968 5000-ADD-NEW-LINES.
  2969     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  2970     MOVE 'N'                    TO WS-SCREEN-LINE.
  2971     MOVE 1                      TO WS-SUB.
  2972     MOVE ZERO                   TO WS-SUB1.
  2973     PERFORM VARYING SC-INDX FROM NUM-LINES-PER-SCREEN BY -1
  2974             UNTIL SCREEN-LINE-FOUND OR SC-INDX < 1
  2975         IF SC-TEXT (SC-INDX) >  SPACES
  2976             SET WS-SUB          TO SC-INDX
  2977             MOVE 'Y'            TO WS-SCREEN-LINE
  2978         END-IF
  2979     END-PERFORM.
  2980     IF PI-TOTAL-LINES = 0
  2981         MOVE 1                  TO WS-SUB1
  2982     ELSE
  2983         MOVE 2                  TO WS-SUB1
  2984     END-IF.
  2985     PERFORM VARYING SC-INDX FROM WS-SUB1 BY 1
  2986             UNTIL SC-INDX GREATER THAN WS-SUB
  2987         IF SC-TEXTL (SC-INDX) EQUAL ZEROS
  2988             MOVE 1      TO SC-TEXTL (SC-INDX)
  2989             MOVE SPACES TO SC-TEXT (SC-INDX)
  2990             MOVE LOW-VALUES TO SC-MTBY (SC-INDX)
  2991                                SC-MTDT (SC-INDX)
  2992         END-IF
  2993     END-PERFORM.
  2994     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  2995             VARYING SC-INDX FROM 1 BY 1 UNTIL
  2996             SC-INDX > NUM-LINES-PER-SCREEN.
  2997
  2998     IF NOT EMI-NO-ERRORS
  2999        GO TO 8200-SEND-DATAONLY
  3000     END-IF.
  3001
  3002     MOVE PI-TOTAL-LINES         TO  PI-CURRENT-LINE.
  3003     PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT.
  3004     MOVE LOW-VALUES             TO  EL1279AI.
  3005     SET TB-INDX TO PI-CURRENT-LINE.
  3006     MOVE 'A'                    TO FUNCTI.
  3007     MOVE -1                     TO  SC-TEXTL (2).
  3008     MOVE AL-UANON               TO  FUNCTA.
  3009     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  3010             VARYING SC-INDX FROM 1 BY 1 UNTIL
  3011             SC-INDX > NUM-LINES-PER-SCREEN.
  3012     MOVE '1'                    TO PI-UPDATE-SW.
  3013     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  64
* EL1279.cbl
  3015 5500-LOOKUP.
  3016     PERFORM 7500-READ-TS THRU 7599-EXIT.
  3017     SET TB-INDX TO PI-CURRENT-LINE.
  3018     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  3019             VARYING SC-INDX FROM 1 BY 1 UNTIL
  3020             SC-INDX > NUM-LINES-PER-SCREEN.
  3021
  3022     IF NOT EMI-NO-ERRORS
  3023        GO TO 8200-SEND-DATAONLY
  3024     END-IF.
  3025
  3026     MOVE LINE1I                 TO  PI-CURRENT-LINE.
  3027     SET TB-INDX                 TO PI-CURRENT-LINE.
  3028     MOVE LOW-VALUES             TO  EL1279AI.
  3029     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  3030             VARYING SC-INDX FROM 1 BY 1
  3031             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  3032     PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT.
  3033     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  65
* EL1279.cbl
  3035 6000-NOT-OPEN.
  3036     MOVE ER-2954                TO  EMI-ERROR.
  3037     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3038
  3039     IF EIBAID = DFHCLEAR
  3040         GO TO 9410-RETURN
  3041     ELSE
  3042         GO TO 8100-SEND-INITIAL-MAP
  3043     END-IF.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  66
* EL1279.cbl
  3045 7000-BUILD-TABLE.
  3046
  3047     SET TB-INDX TO 1.
  3048     MOVE ZEROS                  TO  PI-TOTAL-LINES
  3049                                     PI-CURRENT-LINE
  3050                                     PI-TEMP-STOR-ITEMS
  3051                                     PI-UPDATE-SW.
  3052     MOVE LOW-VALUES             TO  EL1279AI.
  3053
  3054****IF TEMP STORAGE EXISTS, DELETE IT.
  3055     IF PI-CHANGE-IN-NOTE-TYPE
  3056         MOVE 'N' TO PI-SET-NOTE-CHANGE
  3057     ELSE
  3058         PERFORM 7500-READ-TS THRU 7599-EXIT
  3059     END-IF.
  3060
  3061     IF PI-TEMP-STOR-ITEMS NOT = ZERO
  3062        PERFORM 7250-DELETE-TEMP-STOR THRU 7299-EXIT
  3063     END-IF.
  3064
  3065
  3066* EXEC CICS HANDLE CONDITION
  3067*         NOTFND(7010-ENDBR)
  3068*         NOTOPEN(6000-NOT-OPEN)
  3069*         ENDFILE(7010-ENDBR)
  3070*    END-EXEC.
  3071*    MOVE '"$IJ''                 ! '' #00002882' TO DFHEIV0
  3072     MOVE X'2224494A2720202020202020' TO DFHEIV0(1:12)
  3073     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3074     MOVE X'2720233030303032383832' TO DFHEIV0(25:11)
  3075     CALL 'kxdfhei1' USING DFHEIV0
  3076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3077
  3078
  3079
  3080* EXEC CICS STARTBR
  3081*         DATASET(ERCNOT-FILE-ID)
  3082*         RIDFLD(ERCNOT-KEY)
  3083*         KEYLENGTH(ERCNOT-START-LENGTH)
  3084*         GENERIC
  3085*         GTEQ
  3086*    END-EXEC.
  3087     MOVE 0
  3088       TO DFHEIV11
  3089*    MOVE '&,   KG    G          &   #00002888' TO DFHEIV0
  3090     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  3091     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3092     MOVE X'2020233030303032383838' TO DFHEIV0(25:11)
  3093     CALL 'kxdfhei1' USING DFHEIV0,
  3094           ERCNOT-FILE-ID,
  3095           ERCNOT-KEY,
  3096           ERCNOT-START-LENGTH,
  3097           DFHEIV11,
  3098           DFHEIV99
  3099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3100
  3101
  3102 7001-LOOP.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  67
* EL1279.cbl
  3103
  3104* EXEC CICS READNEXT
  3105*         SET(ADDRESS OF CERT-NOTE-FILE)
  3106*         DATASET(ERCNOT-FILE-ID)
  3107*         RIDFLD(ERCNOT-KEY)
  3108*    END-EXEC.
  3109     MOVE 0
  3110       TO DFHEIV11
  3111*    MOVE '&.S                   )   #00002897' TO DFHEIV0
  3112     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  3113     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3114     MOVE X'2020233030303032383937' TO DFHEIV0(25:11)
  3115     CALL 'kxdfhei1' USING DFHEIV0,
  3116           ERCNOT-FILE-ID,
  3117           DFHEIV20,
  3118           DFHEIV99,
  3119           ERCNOT-KEY,
  3120           DFHEIV99,
  3121           DFHEIV11,
  3122           DFHEIV99,
  3123           DFHEIV99
  3124     SET ADDRESS OF CERT-NOTE-FILE TO
  3125         DFHEIV20
  3126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3127
  3128
  3129     IF CZ-COMPANY-CD NOT = SV-COMPANY-CD
  3130         GO TO 7010-ENDBR
  3131     END-IF.
  3132
  3133     IF (CZ-CARRIER = SV-CARRIER)
  3134        AND (CZ-GROUPING = SV-GROUPING)
  3135        AND (CZ-STATE = SV-STATE)
  3136        AND (CZ-ACCOUNT = SV-ACCOUNT)
  3137        AND (CZ-CERT-EFF-DT = SV-EFF-DT)
  3138        AND (CZ-CERT-NO = SV-CERT-NO)
  3139        AND (CZ-RECORD-TYPE = PI-CURR-NOTE-REC-TYPE)
  3140          MOVE CZ-NOTE TO REC-TEXT (TB-INDX)
  3141          MOVE CZ-LAST-MAINT-USER TO REC-LAST-MAINT-BY (TB-INDX)
  3142          MOVE CZ-LAST-MAINT-DT TO REC-LAST-MAINT-DT (TB-INDX)
  3143          MOVE CZ-LAST-MAINT-HHMMSS TO
  3144                         REC-LAST-MAINT-HHMMSS (TB-INDX)
  3145          SET TB-INDX UP BY 1
  3146          GO TO 7001-LOOP
  3147     END-IF.
  3148 7010-ENDBR.
  3149     IF TB-INDX = 1
  3150         MOVE ER-0006            TO EMI-ERROR
  3151         MOVE 'A'                TO FUNCTI
  3152         MOVE -1                 TO SC-TEXTL (1)
  3153         MOVE AL-UANON           TO FUNCTA
  3154         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3155         MOVE ZEROS              TO PI-TOTAL-LINES
  3156         GO TO 8100-SEND-INITIAL-MAP
  3157     END-IF.
  3158
  3159
  3160* EXEC CICS ENDBR
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  68
* EL1279.cbl
  3161*         DATASET(ERCNOT-FILE-ID)
  3162*    END-EXEC.
  3163     MOVE 0
  3164       TO DFHEIV11
  3165*    MOVE '&2                    $   #00002933' TO DFHEIV0
  3166     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3167     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3168     MOVE X'2020233030303032393333' TO DFHEIV0(25:11)
  3169     CALL 'kxdfhei1' USING DFHEIV0,
  3170           ERCNOT-FILE-ID,
  3171           DFHEIV11,
  3172           DFHEIV99
  3173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3174
  3175
  3176     SET TB-INDX DOWN BY 1.
  3177     SET PI-TOTAL-LINES TO TB-INDX.
  3178     MOVE 1                      TO PI-CURRENT-LINE.
  3179
  3180 7050-FORMAT-LINES.
  3181     SET TB-INDX TO PI-CURRENT-LINE.
  3182     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  3183             VARYING SC-INDX FROM 1
  3184             BY 1 UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  3185     PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT.
  3186     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  69
* EL1279.cbl
  3188 7100-FORMAT-SCREEN.
  3189     IF TB-INDX > PI-TOTAL-LINES
  3190        IF FUNCTI NOT = 'A'
  3191           MOVE AL-PANON         TO SC-TEXTA (SC-INDX)
  3192        END-IF
  3193     END-IF.
  3194
  3195     IF TB-INDX > PI-TOTAL-LINES
  3196         GO TO 7100-EXIT
  3197     END-IF.
  3198
  3199     SET WS-LINE TO TB-INDX.
  3200     MOVE WS-LINE TO SC-LIN (SC-INDX).
  3201     MOVE REC-TEXT (TB-INDX)     TO SC-TEXT (SC-INDX).
  3202     MOVE REC-LAST-MAINT-BY (TB-INDX) TO SC-MTBY (SC-INDX).
  3203     MOVE REC-LAST-MAINT-DT (TB-INDX) TO DC-BIN-DATE-1.
  3204     MOVE ' '                    TO DC-OPTION-CODE.
  3205     PERFORM 9700-LINK-DATE-CONVERT.
  3206     MOVE DC-GREG-DATE-1-MDY     TO SC-MTDT (SC-INDX).
  3207     SET ROLL-COUNTER TO TB-INDX.
  3208
  3209     IF NOT MODIFY-CAP
  3210         MOVE AL-PANOF           TO SC-TEXTA (SC-INDX)
  3211         SET TB-INDX UP BY 1
  3212         GO TO 7100-EXIT
  3213     END-IF.
  3214
  3215     SET TB-INDX UP BY 1.
  3216
  3217 7100-EXIT.
  3218      EXIT.
  3219
  3220 7200-PUT-TEMP-STOR.
  3221     PERFORM 7250-DELETE-TEMP-STOR THRU 7299-EXIT.
  3222     SET TS-INDX TO 1.
  3223     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
  3224     PERFORM 7300-WRITE-TS THRU 7399-EXIT
  3225             VARYING TS-GROUP-WORK FROM 0 BY TS-NUM-REC-IN-GROUP
  3226             UNTIL TS-GROUP-WORK NOT LESS THAN PI-TOTAL-LINES.
  3227 7249-EXIT.
  3228      EXIT.
  3229 7250-DELETE-TEMP-STOR.
  3230
  3231* EXEC CICS HANDLE CONDITION
  3232*         QIDERR(7299-EXIT)
  3233*    END-EXEC.
  3234*    MOVE '"$N                   ! ( #00002991' TO DFHEIV0
  3235     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  3236     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3237     MOVE X'2820233030303032393931' TO DFHEIV0(25:11)
  3238     CALL 'kxdfhei1' USING DFHEIV0
  3239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3240
  3241
  3242* EXEC CICS DELETEQ TS
  3243*         QUEUE(QID)
  3244*    END-EXEC.
  3245*    MOVE '*&                    #   #00002994' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  70
* EL1279.cbl
  3246     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  3247     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3248     MOVE X'2020233030303032393934' TO DFHEIV0(25:11)
  3249     CALL 'kxdfhei1' USING DFHEIV0,
  3250           QID,
  3251           DFHEIV99
  3252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3253
  3254 7299-EXIT.
  3255     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  71
* EL1279.cbl
  3257 7300-WRITE-TS.
  3258     MOVE TS-GROUP (TS-INDX)     TO TS-WORK-AREA.
  3259     SET TS-INDX UP BY 1.
  3260     ADD 1 TO PI-TEMP-STOR-ITEMS.
  3261
  3262* EXEC CICS WRITEQ TS
  3263*         FROM(TS-WORK-AREA)
  3264*         QUEUE(QID)
  3265*         LENGTH(TS-LENGTH)
  3266*         ITEM(PI-TEMP-STOR-ITEMS)
  3267*    END-EXEC.
  3268*    MOVE '*" I                  ''   #00003004' TO DFHEIV0
  3269     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
  3270     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3271     MOVE X'2020233030303033303034' TO DFHEIV0(25:11)
  3272     CALL 'kxdfhei1' USING DFHEIV0,
  3273           QID,
  3274           TS-WORK-AREA,
  3275           TS-LENGTH,
  3276           PI-TEMP-STOR-ITEMS,
  3277           DFHEIV99,
  3278           DFHEIV99
  3279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3280
  3281 7399-EXIT.
  3282     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  72
* EL1279.cbl
  3284 7400-PAGE-ROUTINE.
  3285
  3286     IF PFENTERL NOT = ZEROS
  3287        MOVE -1                  TO PFENTERL
  3288        ELSE
  3289        MOVE -1                  TO FUNCTL
  3290     END-IF.
  3291
  3292     IF PI-TOTAL-LINES = 0
  3293        MOVE ER-0047             TO EMI-ERROR
  3294        MOVE -1                  TO FUNCTL
  3295        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3296        GO TO 8200-SEND-DATAONLY
  3297     END-IF.
  3298
  3299     COMPUTE TEMP-CURR-LINE = PI-CURRENT-LINE + ROLL-COUNTER.
  3300
  3301     IF TEMP-CURR-LINE NEGATIVE OR TEMP-CURR-LINE = ZEROS
  3302        MOVE ER-0067             TO EMI-ERROR
  3303        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3304        MOVE 1 TO TEMP-CURR-LINE
  3305     END-IF.
  3306
  3307     IF TEMP-CURR-LINE GREATER THAN PI-TOTAL-LINES
  3308        MOVE ER-0066             TO EMI-ERROR
  3309        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3310        COMPUTE TEMP-CURR-LINE = PI-TOTAL-LINES + 1
  3311                               - NUM-LINES-PER-SCREEN
  3312        IF TEMP-CURR-LINE NEGATIVE OR TEMP-CURR-LINE = ZEROS
  3313           MOVE 1                TO TEMP-CURR-LINE
  3314        END-IF
  3315     END-IF.
  3316
  3317     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  3318     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  3319             VARYING SC-INDX FROM 1 BY 1 UNTIL
  3320             SC-INDX > NUM-LINES-PER-SCREEN.
  3321
  3322     IF EMI-ERROR = ER-0066 OR = ER-0067 OR = ZEROS
  3323        NEXT SENTENCE
  3324     ELSE
  3325        GO TO 8200-SEND-DATAONLY
  3326     END-IF.
  3327
  3328     MOVE TEMP-CURR-LINE         TO PI-CURRENT-LINE.
  3329     SET TB-INDX TO PI-CURRENT-LINE.
  3330     MOVE LOW-VALUES             TO EL1279AI.
  3331     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  3332             VARYING SC-INDX FROM 1 BY 1
  3333             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  3334     PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT.
  3335     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  73
* EL1279.cbl
  3337
  3338 7450-SET-INDX.
  3339     IF PI-CURRENT-LINE = 0 AND PI-TOTAL-LINES = 0
  3340        SET TB-INDX TO 1
  3341     ELSE
  3342        PERFORM 7500-READ-TS THRU 7599-EXIT
  3343        IF PI-CURRENT-LINE = 0
  3344           SET TB-INDX TO 1
  3345        ELSE
  3346           SET TB-INDX TO PI-CURRENT-LINE
  3347        END-IF
  3348     END-IF.
  3349 7450-EXIT.
  3350      EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  74
* EL1279.cbl
  3352 7500-READ-TS.
  3353
  3354* EXEC CICS HANDLE CONDITION
  3355*         QIDERR(7590-TS-QIDERR)
  3356*         ITEMERR(7585-QID-ITEMERR)
  3357*    END-EXEC.
  3358*    MOVE '"$N<                  ! ) #00003082' TO DFHEIV0
  3359     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
  3360     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3361     MOVE X'2920233030303033303832' TO DFHEIV0(25:11)
  3362     CALL 'kxdfhei1' USING DFHEIV0
  3363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3364
  3365     SET TS-INDX TO 1.
  3366     MOVE 1                      TO QID-ITEM.
  3367 7501-LOOP.
  3368
  3369* EXEC CICS READQ TS
  3370*         INTO(TS-WORK-AREA)
  3371*         QUEUE(QID)
  3372*         LENGTH(TS-LENGTH)
  3373*         ITEM(QID-ITEM)
  3374*    END-EXEC.
  3375*    MOVE '*$II   L              ''   #00003089' TO DFHEIV0
  3376     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  3377     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3378     MOVE X'2020233030303033303839' TO DFHEIV0(25:11)
  3379     CALL 'kxdfhei1' USING DFHEIV0,
  3380           QID,
  3381           TS-WORK-AREA,
  3382           TS-LENGTH,
  3383           QID-ITEM,
  3384           DFHEIV99,
  3385           DFHEIV99
  3386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3387
  3388     MOVE TS-WORK-AREA           TO TS-GROUP (TS-INDX).
  3389     SET TS-INDX UP BY 1.
  3390     ADD 1 TO QID-ITEM.
  3391     GO TO 7501-LOOP.
  3392
  3393 7585-QID-ITEMERR.
  3394     IF EIBTRNID NOT = TRANS-ID
  3395        SUBTRACT 1 FROM QID-ITEM
  3396        MOVE QID-ITEM            TO PI-TEMP-STOR-ITEMS
  3397     END-IF.
  3398     GO TO 7599-EXIT.
  3399
  3400 7590-TS-QIDERR.
  3401     IF EIBTRNID = TRANS-ID
  3402        AND EIBAID = DFHCLEAR
  3403           GO TO 9410-RETURN
  3404     END-IF.
  3405     IF EIBTRNID = TRANS-ID
  3406        MOVE ER-0033             TO EMI-ERROR
  3407        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3408        GO TO 8100-SEND-INITIAL-MAP
  3409     END-IF.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  75
* EL1279.cbl
  3410
  3411 7599-EXIT.
  3412      EXIT.
  3413
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  76
* EL1279.cbl
  3415 7600-UPDATE-TABLE-FROM-SCREEN.
  3416
  3417     IF SC-TEXTL (SC-INDX) NOT = ZEROS
  3418         IF TB-INDX NOT > PI-TOTAL-LINES
  3419             PERFORM 7700-MOVE-DATA THRU 7700-EXIT
  3420             SET TB-INDX UP BY 1
  3421         ELSE
  3422             IF PI-TOTAL-LINES = MAX-LINES
  3423                 MOVE ER-0051    TO EMI-ERROR
  3424                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3425                 GO TO 8200-SEND-DATAONLY
  3426             ELSE
  3427                 PERFORM 7700-MOVE-DATA THRU 7700-EXIT
  3428                 SET TB-INDX UP BY 1
  3429                 ADD 1 TO PI-TOTAL-LINES
  3430             END-IF
  3431         END-IF
  3432     ELSE
  3433        IF TB-INDX NOT > PI-TOTAL-LINES
  3434           SET TB-INDX UP BY 1
  3435        END-IF
  3436     END-IF.
  3437
  3438 7699-EXIT.
  3439      EXIT.
  3440
  3441 7700-MOVE-DATA.
  3442     MOVE '1'                    TO PI-UPDATE-SW.
  3443
  3444     IF SC-TEXTL (SC-INDX) NOT = ZEROS
  3445        MOVE SC-TEXT (SC-INDX)  TO REC-TEXT (TB-INDX)
  3446        MOVE PI-PROCESSOR-ID    TO REC-LAST-MAINT-BY (TB-INDX)
  3447        MOVE EIBTIME            TO REC-LAST-MAINT-HHMMSS (TB-INDX)
  3448        MOVE SAVE-BIN-DATE      TO REC-LAST-MAINT-DT (TB-INDX)
  3449     END-IF.
  3450
  3451 7700-EXIT.
  3452      EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  77
* EL1279.cbl
  3454 8100-SEND-INITIAL-MAP.
  3455     MOVE SAVE-DATE              TO DATEO.
  3456     MOVE EIBTIME                TO TIME-IN.
  3457     MOVE TIME-OUT               TO TIMEO.
  3458     MOVE PI-COMPANY-ID          TO CMPNYIDO.
  3459     MOVE PI-PROCESSOR-ID        TO USERIDO.
  3460     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGBO.
  3461     MOVE PI-CARRIER             TO FCARRIRO.
  3462     MOVE PI-GROUPING            TO FGROUPO.
  3463     MOVE PI-STATE               TO FSTO.
  3464     MOVE PI-ACCOUNT             TO FACOUNTO.
  3465     MOVE PI-CERT-PRIME          TO FCERTO.
  3466     MOVE PI-CERT-SFX            TO FCRTSFXO.
  3467     MOVE  ' '                   TO DC-OPTION-CODE.
  3468     MOVE PI-CERT-EFF-DT         TO DC-BIN-DATE-1.
  3469     PERFORM 9700-LINK-DATE-CONVERT.
  3470     MOVE DC-GREG-DATE-1-EDIT    TO FEFFDTO.
  3471     MOVE PI-TOTAL-LINES         TO TOTO.
  3472     IF PI-CLAIM-NOTE
  3473         MOVE SCR-CLAIM-NOTE-TYPE TO FTYPEO
  3474         MOVE SCR-PF6-CERT        TO PF6NOTEO
  3475         MOVE SCR-CERT-YN         TO FTYPEYNO
  3476         IF PI-CERT-NOTES-EXIST = 'Y'
  3477             MOVE 'YES'           TO FCERTYNO
  3478         ELSE
  3479             MOVE 'NO '           TO FCERTYNO
  3480         END-IF
  3481     ELSE
  3482         MOVE SCR-CERT-NOTE-TYPE TO FTYPEO
  3483         MOVE SCR-PF6-CLAIM      TO PF6NOTEO
  3484         MOVE SCR-CLAIM-YN       TO FTYPEYNO
  3485         IF PI-CLAIM-NOTES-EXIST = 'Y'
  3486             MOVE 'YES'           TO FCERTYNO
  3487         ELSE
  3488             MOVE 'NO '           TO FCERTYNO
  3489         END-IF
  3490     END-IF.
  3491     IF PI-BILLING-NOTES-EXIST = 'Y'
  3492         MOVE 'YES'           TO FBILLYNO
  3493     ELSE
  3494         MOVE 'NO '           TO FBILLYNO
  3495     END-IF
  3496
  3497     MOVE -1                     TO FUNCTL.
  3498
  3499
  3500* EXEC CICS SEND
  3501*         MAP(MAP-NAME)
  3502*         MAPSET(MAPSET-NAME)
  3503*         FROM(EL1279AO)
  3504*         ERASE
  3505*         CURSOR
  3506*    END-EXEC.
  3507     MOVE LENGTH OF
  3508      EL1279AO
  3509       TO DFHEIV12
  3510     MOVE -1
  3511       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  78
* EL1279.cbl
  3512*    MOVE '8$     CT  E    H L F ,   #00003206' TO DFHEIV0
  3513     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  3514     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3515     MOVE X'2020233030303033323036' TO DFHEIV0(25:11)
  3516     CALL 'kxdfhei1' USING DFHEIV0,
  3517           MAP-NAME,
  3518           EL1279AO,
  3519           DFHEIV12,
  3520           MAPSET-NAME,
  3521           DFHEIV99,
  3522           DFHEIV99,
  3523           DFHEIV99,
  3524           DFHEIV11,
  3525           DFHEIV99,
  3526           DFHEIV99,
  3527           DFHEIV99
  3528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3529
  3530
  3531     GO TO 9100-RETURN-TRAN.
  3532
  3533 8200-SEND-DATAONLY.
  3534     MOVE EIBTIME                TO TIME-IN.
  3535     MOVE TIME-OUT               TO TIMEO.
  3536     MOVE PI-COMPANY-ID          TO CMPNYIDO.
  3537     MOVE PI-PROCESSOR-ID        TO USERIDO.
  3538     MOVE PI-TOTAL-LINES         TO TOTO.
  3539
  3540     IF NOT EMI-NO-ERRORS
  3541        MOVE EMI-MESSAGE-AREA (1) TO ERRMSGBO
  3542     ELSE
  3543        MOVE -1                  TO FUNCTL
  3544     END-IF.
  3545
  3546
  3547* EXEC CICS SEND
  3548*         MAP(MAP-NAME)
  3549*         MAPSET(MAPSET-NAME)
  3550*         FROM(EL1279AO)
  3551*         DATAONLY
  3552*         CURSOR
  3553*    END-EXEC.
  3554     MOVE LENGTH OF
  3555      EL1279AO
  3556       TO DFHEIV12
  3557     MOVE -1
  3558       TO DFHEIV11
  3559*    MOVE '8$D    CT       H L F ,   #00003229' TO DFHEIV0
  3560     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  3561     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3562     MOVE X'2020233030303033323239' TO DFHEIV0(25:11)
  3563     CALL 'kxdfhei1' USING DFHEIV0,
  3564           MAP-NAME,
  3565           EL1279AO,
  3566           DFHEIV12,
  3567           MAPSET-NAME,
  3568           DFHEIV99,
  3569           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  79
* EL1279.cbl
  3570           DFHEIV99,
  3571           DFHEIV11,
  3572           DFHEIV99,
  3573           DFHEIV99,
  3574           DFHEIV99
  3575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3576
  3577
  3578     GO TO 9100-RETURN-TRAN.
  3579
  3580 8300-SEND-TEXT.
  3581
  3582* EXEC CICS SEND TEXT
  3583*         FROM(LOGOFF-TEXT)
  3584*         ERASE
  3585*         FREEKB
  3586*         LENGTH(LOGOFF-LENGTH)
  3587*    END-EXEC.
  3588*    MOVE '8&      T  E F  H   F -   #00003240' TO DFHEIV0
  3589     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  3590     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  3591     MOVE X'2020233030303033323430' TO DFHEIV0(25:11)
  3592     CALL 'kxdfhei1' USING DFHEIV0,
  3593           LOGOFF-TEXT,
  3594           LOGOFF-LENGTH,
  3595           DFHEIV99,
  3596           DFHEIV99,
  3597           DFHEIV99,
  3598           DFHEIV99,
  3599           DFHEIV99,
  3600           DFHEIV99,
  3601           DFHEIV99,
  3602           DFHEIV99,
  3603           DFHEIV99,
  3604           DFHEIV99
  3605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3606
  3607
  3608     PERFORM 7250-DELETE-TEMP-STOR THRU 7299-EXIT.
  3609
  3610
  3611* EXEC CICS RETURN
  3612*    END-EXEC.
  3613*    MOVE '.(                    ''   #00003249' TO DFHEIV0
  3614     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3615     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3616     MOVE X'2020233030303033323439' TO DFHEIV0(25:11)
  3617     CALL 'kxdfhei1' USING DFHEIV0,
  3618           DFHEIV99,
  3619           DFHEIV99,
  3620           DFHEIV99,
  3621           DFHEIV99,
  3622           DFHEIV99,
  3623           DFHEIV99
  3624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3625
  3626
  3627 8800-UNAUTHORIZED-ACCESS.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  80
* EL1279.cbl
  3628     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  3629     GO TO 8300-SEND-TEXT.
  3630
  3631 9000-RETURN-CICS.
  3632     IF PI-CHANGES-MADE
  3633        MOVE ER-0045             TO EMI-ERROR
  3634        MOVE -1                  TO FUNCTL
  3635        MOVE SPACES              TO PFENTERO
  3636        MOVE AL-UNNOF            TO PFENTERA
  3637        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3638        GO TO 8200-SEND-DATAONLY
  3639     END-IF.
  3640
  3641     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  3642     MOVE XCTL-005               TO PGM-NAME.
  3643     GO TO 9300-XCTL.
  3644
  3645 9100-RETURN-TRAN.
  3646     MOVE SCRN-NUMBER            TO PI-CURRENT-SCREEN-NO.
  3647     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  3648
  3649* EXEC CICS RETURN
  3650*         TRANSID(TRANS-ID)
  3651*         COMMAREA(PROGRAM-INTERFACE-BLOCK)
  3652*         LENGTH(PI-COMM-LENGTH)
  3653*    END-EXEC.
  3654*    MOVE '.(CT                  ''   #00003273' TO DFHEIV0
  3655     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  3656     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3657     MOVE X'2020233030303033323733' TO DFHEIV0(25:11)
  3658     CALL 'kxdfhei1' USING DFHEIV0,
  3659           TRANS-ID,
  3660           PROGRAM-INTERFACE-BLOCK,
  3661           PI-COMM-LENGTH,
  3662           DFHEIV99,
  3663           DFHEIV99,
  3664           DFHEIV99
  3665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3666
  3667
  3668
  3669 9200-RETURN-MAIN-MENU.
  3670     IF PI-CHANGES-MADE
  3671        MOVE -1                  TO FUNCTL
  3672        MOVE SPACES              TO PFENTERO
  3673        MOVE AL-UNNOF            TO PFENTERA
  3674        MOVE ER-0045             TO EMI-ERROR
  3675        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3676        GO TO 8200-SEND-DATAONLY
  3677     END-IF.
  3678
  3679     MOVE XCTL-126               TO PGM-NAME.
  3680
  3681 9300-XCTL.
  3682     PERFORM 7250-DELETE-TEMP-STOR THRU 7299-EXIT.
  3683
  3684* EXEC CICS XCTL
  3685*         PROGRAM  (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  81
* EL1279.cbl
  3686*         COMMAREA (PROGRAM-INTERFACE-BLOCK)
  3687*         LENGTH   (PI-COMM-LENGTH)
  3688*    END-EXEC.
  3689*    MOVE '.$C                   %   #00003294' TO DFHEIV0
  3690     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  3691     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3692     MOVE X'2020233030303033323934' TO DFHEIV0(25:11)
  3693     CALL 'kxdfhei1' USING DFHEIV0,
  3694           PGM-NAME,
  3695           PROGRAM-INTERFACE-BLOCK,
  3696           PI-COMM-LENGTH,
  3697           DFHEIV99
  3698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3699
  3700
  3701 9400-CLEAR.
  3702
  3703     IF PI-CHANGES-MADE
  3704         MOVE ER-0045            TO EMI-ERROR
  3705         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3706         IF PI-CURRENT-LINE GREATER THAN ZERO
  3707             PERFORM 7500-READ-TS THRU 7599-EXIT
  3708             SET TB-INDX TO PI-CURRENT-LINE
  3709             PERFORM 7100-FORMAT-SCREEN  THRU  7100-EXIT
  3710                 VARYING SC-INDX FROM 1 BY 1 UNTIL
  3711                 SC-INDX GREATER NUM-LINES-PER-SCREEN
  3712         END-IF
  3713         GO TO 8100-SEND-INITIAL-MAP
  3714     END-IF.
  3715
  3716 9410-RETURN.
  3717     IF PF5-PRESSED
  3718         MOVE PGM-EL1276           TO PGM-NAME
  3719     ELSE
  3720         IF PF6-PRESSED
  3721             IF PI-CLAIM-NOTE
  3722                 SET PI-CERT-NOTE  TO TRUE
  3723             ELSE
  3724                 SET PI-CLAIM-NOTE TO TRUE
  3725             END-IF
  3726             SET PI-CHANGE-IN-NOTE-TYPE TO TRUE
  3727             MOVE 'N'              TO PI-PF6-PRESSED
  3728             GO TO 1000-START
  3729         ELSE
  3730             MOVE PI-RETURN-TO-PROGRAM TO PGM-NAME
  3731         END-IF
  3732     END-IF.
  3733     GO TO 9300-XCTL.
  3734
  3735 9500-PF12.
  3736     IF PI-CHANGES-MADE
  3737        MOVE -1                  TO FUNCTL
  3738        MOVE SPACES              TO PFENTERO
  3739        MOVE AL-UNNOF            TO PFENTERA
  3740        MOVE ER-0045             TO EMI-ERROR
  3741        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3742        GO TO 8200-SEND-DATAONLY
  3743     END-IF.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  82
* EL1279.cbl
  3744
  3745     MOVE 'EL010'                TO PGM-NAME.
  3746     GO TO 9300-XCTL.
  3747
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  83
* EL1279.cbl
  3749
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  84
* EL1279.cbl
  3751 9600-PGMID-ERROR.
  3752
  3753* EXEC CICS HANDLE CONDITION
  3754*         PGMIDERR(8300-SEND-TEXT)
  3755*    END-EXEC.
  3756*    MOVE '"$L                   ! * #00003351' TO DFHEIV0
  3757     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  3758     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3759     MOVE X'2A20233030303033333531' TO DFHEIV0(25:11)
  3760     CALL 'kxdfhei1' USING DFHEIV0
  3761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3762
  3763
  3764     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  3765     MOVE SPACES                 TO  PI-ENTRY-CD-1.
  3766     MOVE XCTL-005               TO  PGM-NAME.
  3767     MOVE PGM-NAME               TO  LOGOFF-PGM.
  3768     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  3769
  3770     GO TO 9300-XCTL.
  3771
  3772 9700-LINK-DATE-CONVERT.
  3773
  3774     MOVE LINK-ELDATCV           TO  PGM-NAME.
  3775
  3776* EXEC CICS LINK
  3777*        PROGRAM    (PGM-NAME)
  3778*        COMMAREA   (DATE-CONVERSION-DATA)
  3779*        LENGTH     (DC-COMM-LENGTH)
  3780*    END-EXEC.
  3781*    MOVE '."C                   (   #00003366' TO DFHEIV0
  3782     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3783     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3784     MOVE X'2020233030303033333636' TO DFHEIV0(25:11)
  3785     CALL 'kxdfhei1' USING DFHEIV0,
  3786           PGM-NAME,
  3787           DATE-CONVERSION-DATA,
  3788           DC-COMM-LENGTH,
  3789           DFHEIV99,
  3790           DFHEIV99,
  3791           DFHEIV99,
  3792           DFHEIV99
  3793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3794
  3795
  3796 9700-EXIT.
  3797     EXIT.
  3798
  3799 9900-ERROR-FORMAT.
  3800     IF NOT EMI-ERRORS-COMPLETE
  3801        MOVE LINK-001            TO  PGM-NAME
  3802
  3803* EXEC CICS LINK
  3804*            PROGRAM(PGM-NAME)
  3805*            COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
  3806*            LENGTH(EMI-COMM-LENGTH)
  3807*       END-EXEC
  3808*    MOVE '."C                   (   #00003378' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  85
* EL1279.cbl
  3809     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3810     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3811     MOVE X'2020233030303033333738' TO DFHEIV0(25:11)
  3812     CALL 'kxdfhei1' USING DFHEIV0,
  3813           PGM-NAME,
  3814           ERROR-MESSAGE-INTERFACE-BLOCK,
  3815           EMI-COMM-LENGTH,
  3816           DFHEIV99,
  3817           DFHEIV99,
  3818           DFHEIV99,
  3819           DFHEIV99
  3820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3821     END-IF.
  3822 9900-EXIT.
  3823     EXIT.
  3824
  3825 9990-ABEND.
  3826     MOVE LINK-004               TO  PGM-NAME.
  3827     MOVE DFHEIBLK               TO  EMI-LINE1.
  3828
  3829
  3830* EXEC CICS LINK
  3831*        PROGRAM   (PGM-NAME)
  3832*        COMMAREA  (EMI-LINE1)
  3833*        LENGTH    (72)
  3834*    END-EXEC.
  3835     MOVE 72
  3836       TO DFHEIV11
  3837*    MOVE '."C                   (   #00003391' TO DFHEIV0
  3838     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3839     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3840     MOVE X'2020233030303033333931' TO DFHEIV0(25:11)
  3841     CALL 'kxdfhei1' USING DFHEIV0,
  3842           PGM-NAME,
  3843           EMI-LINE1,
  3844           DFHEIV11,
  3845           DFHEIV99,
  3846           DFHEIV99,
  3847           DFHEIV99,
  3848           DFHEIV99
  3849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3850
  3851
  3852     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSGBO.
  3853     MOVE -1                     TO  FUNCTL.
  3854
  3855     GO TO 8100-SEND-INITIAL-MAP.
  3856
  3857
  3858* GOBACK.
  3859     MOVE '9%                    "   ' TO DFHEIV0
  3860     MOVE 'EL1279' TO DFHEIV1
  3861     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3862     GOBACK.
  3863
  3864 9995-SECURITY-VIOLATION.
  3865*                                COPY ELCSCTP.
  3866******************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  86
* EL1279.cbl
  3867*                                                                *
  3868*                            ELCSCTP                             *
  3869*                            VMOD=2.001                          *
  3870*                                                                *
  3871*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  3872******************************************************************
  3873
  3874
  3875     MOVE EIBDATE          TO SM-JUL-DATE.
  3876     MOVE EIBTRMID         TO SM-TERMID.
  3877     MOVE THIS-PGM         TO SM-PGM.
  3878     MOVE EIBTIME          TO TIME-IN.
  3879     MOVE TIME-OUT         TO SM-TIME.
  3880     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  3881
  3882
  3883* EXEC CICS LINK
  3884*         PROGRAM  ('EL003')
  3885*         COMMAREA (SECURITY-MESSAGE)
  3886*         LENGTH   (80)
  3887*    END-EXEC.
  3888     MOVE 'EL003' TO DFHEIV1
  3889     MOVE 80
  3890       TO DFHEIV11
  3891*    MOVE '."C                   (   #00003422' TO DFHEIV0
  3892     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3893     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3894     MOVE X'2020233030303033343232' TO DFHEIV0(25:11)
  3895     CALL 'kxdfhei1' USING DFHEIV0,
  3896           DFHEIV1,
  3897           SECURITY-MESSAGE,
  3898           DFHEIV11,
  3899           DFHEIV99,
  3900           DFHEIV99,
  3901           DFHEIV99,
  3902           DFHEIV99
  3903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3904
  3905
  3906******************************************************************
  3907
  3908
  3909 9995-EXIT.
  3910     EXIT.
  3911
  3912 9999-DFHBACK SECTION.
  3913     MOVE '9%                    "   ' TO DFHEIV0
  3914     MOVE 'EL1279' TO DFHEIV1
  3915     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3916     GOBACK.
  3917 9999-DFHEXIT.
  3918     IF DFHEIGDJ EQUAL 0001
  3919         NEXT SENTENCE
  3920     ELSE IF DFHEIGDJ EQUAL 2
  3921         GO TO 9400-CLEAR
  3922         DEPENDING ON DFHEIGDI
  3923     ELSE IF DFHEIGDJ EQUAL 3
  3924         GO TO 9990-ABEND,
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:13 Page  87
* EL1279.cbl
  3925               9600-PGMID-ERROR
  3926         DEPENDING ON DFHEIGDI
  3927     ELSE IF DFHEIGDJ EQUAL 4
  3928         GO TO 4610-ENDBR,
  3929               6000-NOT-OPEN,
  3930               4610-ENDBR
  3931         DEPENDING ON DFHEIGDI
  3932     ELSE IF DFHEIGDJ EQUAL 5
  3933         GO TO 4899-EXIT
  3934         DEPENDING ON DFHEIGDI
  3935     ELSE IF DFHEIGDJ EQUAL 6
  3936         GO TO 4900-EXIT
  3937         DEPENDING ON DFHEIGDI
  3938     ELSE IF DFHEIGDJ EQUAL 7
  3939         GO TO 7010-ENDBR,
  3940               6000-NOT-OPEN,
  3941               7010-ENDBR
  3942         DEPENDING ON DFHEIGDI
  3943     ELSE IF DFHEIGDJ EQUAL 8
  3944         GO TO 7299-EXIT
  3945         DEPENDING ON DFHEIGDI
  3946     ELSE IF DFHEIGDJ EQUAL 9
  3947         GO TO 7590-TS-QIDERR,
  3948               7585-QID-ITEMERR
  3949         DEPENDING ON DFHEIGDI
  3950     ELSE IF DFHEIGDJ EQUAL 10
  3951         GO TO 8300-SEND-TEXT
  3952         DEPENDING ON DFHEIGDI.
  3953     MOVE '9%                    "   ' TO DFHEIV0
  3954     MOVE 'EL1279' TO DFHEIV1
  3955     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3956     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       30592     Code:       12409
