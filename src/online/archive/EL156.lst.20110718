* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   1
* EL156.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"EL156.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL156.lst" LISTPATH""
*          LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL156 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/17/94 13:55:56.
     7*                            VMOD=2.098
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX29 - PAYMENT PROCESSING
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   2
* EL156.cbl
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    23* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST CALC
    24* 052506    2006030600001  AJRA  ADD PROOF DATE
    25* 071806    2004040700004  PEMA  ADD TONYS PROOF DATE TO INT CALC
    26* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
    27* 110807  IR2007110700001  AJRA  DO NOT CALC INT ON MANUAL PMTS
    28* 022208    2008021500001  AJRA  DO NOT DEFAULT PROOF DATE,FORCE E
    29* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
    30* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
    31* 091808    2008022800002  AJRA  GET CHECK NUMBER FROM STATE CNTL
    32* 012810    2007111300001  AJRA  EXPAND EDIT PATTERN
    33* 041710    2007111300001  AJRA  ADD MSG AND CALC PMT FOR SC NET P
    34* 092310  IR2010090900001  PEMA  CHANGE CRIT PERIOD EDIT
    35* 112210    2010091000003  AJRA  MICHIGAN FULL MONTH ON 1ST PAYMEN
    36******************************************************************
    37
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   3
* EL156.cbl
    39 ENVIRONMENT DIVISION.
    40
    41 DATA DIVISION.
    42
    43 WORKING-STORAGE SECTION.
    44 01  DFH-START PIC X(04).
    45
    46 77  FILLER  PIC X(32)  VALUE '********************************'.
    47 77  FILLER  PIC X(32)  VALUE '*    EL156 WORKING STORAGE     *'.
    48 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.098 **********'.
    49 77  WS-SSN  PIC X(9) VALUE ZEROS.
    50 77  WS-SET-NOTE2-MDT            PIC X  VALUE SPACES.
    51
    52*    COPY ELCSCTM.
    53******************************************************************
    54*                                                                *
    55*                                                                *
    56*                            ELCSCTM                             *
    57*                            VMOD=2.001                          *
    58*                                                                *
    59*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    60*                                                                *
    61******************************************************************
    62 01  SECURITY-MESSAGE.
    63     12  FILLER                          PIC X(30)
    64            VALUE '** LOGIC SECURITY VIOLATION -'.
    65     12  SM-READ                         PIC X(6).
    66     12  FILLER                          PIC X(5)
    67            VALUE ' PGM='.
    68     12  SM-PGM                          PIC X(6).
    69     12  FILLER                          PIC X(5)
    70            VALUE ' OPR='.
    71     12  SM-PROCESSOR-ID                 PIC X(4).
    72     12  FILLER                          PIC X(6)
    73            VALUE ' TERM='.
    74     12  SM-TERMID                       PIC X(4).
    75     12  FILLER                          PIC XX   VALUE SPACE.
    76     12  SM-JUL-DATE                     PIC 9(5).
    77     12  FILLER                          PIC X    VALUE SPACE.
    78     12  SM-TIME                         PIC 99.99.
    79
    80
    81*    COPY ELCSCRTY.
    82******************************************************************
    83*                                                                *
    84*                                                                *
    85*                            ELCSCRTY                            *
    86*                            VMOD=2.001                          *
    87*                                                                *
    88*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    89*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    90*        SAVED IN PI-SECURITY-ADDRESS.                           *
    91*                                                                *
    92******************************************************************
    93 01  SECURITY-CONTROL.
    94     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    95     12  FILLER                       PIC XX    VALUE 'SC'.
    96     12  SC-CREDIT-CODES.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   4
* EL156.cbl
    97         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    98             20  SC-CREDIT-DISPLAY    PIC X.
    99             20  SC-CREDIT-UPDATE     PIC X.
   100     12  SC-CLAIMS-CODES.
   101         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   102             20  SC-CLAIMS-DISPLAY    PIC X.
   103             20  SC-CLAIMS-UPDATE     PIC X.
   104
   105 01  WS-BIN-PROOF-DT             PIC XX  VALUE LOW-VALUES.
   106 01  WS-DATE-AREA.
   107     12  SAVE-DATE           PIC X(8)    VALUE SPACES.
   108     12  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   109     12  SAVE-DATE-CCYYMMDD.
   110         16  SAVE-DATE-CC            PIC XX      VALUE SPACES.
   111         16  SAVE-DATE-YMD.
   112             20  SAVE-DATE-YY        PIC XX      VALUE SPACES.
   113             20  FILLER              PIC X(04)   VALUE SPACES.
   114
   115 01  WS-SAVED-EOB-CODES          PIC X(60) VALUE SPACES.
   116 01  STANDARD-AREAS.
   117     12  WS-RESPONSE         PIC S9(8)   COMP.
   118         88  WS-RESP-NORMAL              VALUE +00.
   119         88  WS-RESP-ERROR               VALUE +01.
   120         88  WS-RESP-NOTFND              VALUE +13.
   121         88  WS-RESP-DUPREC              VALUE +14.
   122         88  WS-RESP-ENDFILE             VALUE +20.
   123     12  PMT-HEAD-A.
   124         16  FILLER          PIC X(09)   VALUE 'PAY-FROM '.
   125         16  HDGA-VRBLE      PIC X(10)   VALUE 'PAY THRU  '.
   126         16  FILLER          PIC X(47)   VALUE 'DAYS   PAYMENT AMT
   127-        '     RESERVES  TYPE    AMOUNT'.
   128     12  PMT-HEAD-B.
   129         16  FILLER          PIC X(12)   VALUE 'PAYS FROM   '.
   130         16  HDGB-VRBLE      PIC X(12)   VALUE 'PAYS THRU   '.
   131         16  FILLER          PIC X(10)   VALUE 'DAYS   BY '.
   132     12  SC-ITEM             PIC S9(4)   VALUE +0001  COMP.
   133     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   134     12  MAP-NAME            PIC X(8)    VALUE 'EL156A'.
   135     12  MAP-NAMEA           PIC X(8)    VALUE 'EL156A'.
   136     12  MAP-NAMEB           PIC X(8)    VALUE 'EL156B'.
   137     12  MAPSET-NAME         PIC X(8)    VALUE 'EL156S'.
   138     12  TRANS-ID            PIC X(4)    VALUE 'EX29'.
   139     12  THIS-PGM            PIC X(8)    VALUE 'EL156'.
   140     12  PGM-NAME            PIC X(8).
   141     12  TIME-IN             PIC S9(7).
   142     12  TIME-OUT-R  REDEFINES TIME-IN.
   143         16  FILLER          PIC X.
   144         16  TIME-OUT        PIC 99V99.
   145         16  FILLER          PIC XX.
   146     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   147     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   148     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   149     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   150     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   151     12  XCTL-155            PIC X(8)    VALUE 'EL155'.
   152     12  XCTL-130            PIC X(8)    VALUE 'EL130'.
   153     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   154     12  LINK-001            PIC X(8)    VALUE 'EL001'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   5
* EL156.cbl
   155     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   156     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   157     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   158     12  LINK-REMTERM        PIC X(8)    VALUE 'ELRTRM'.
   159     12  LINK-REMAMT         PIC X(8)    VALUE 'ELRAMT'.
   160     12  ELARCH-LENGTH       PIC S9(4)   VALUE +90     COMP.
   161     12  WS-BLANK            PIC X       VALUE ' '.
   162
   163 01  MISC-WORK-AREAS.
   164     12  W-INTEREST              PIC S9(7)V99  COMP-3 VALUE +0.
   165     12  W-PAYMENT-TOTAL         PIC S9(7)V99  COMP-3 VALUE +0.
   166     12  W-PERCENT               PIC S9V9(4)   COMP-3 VALUE +0.
   167     12  W-TOTAL-INTEREST        PIC S9(7)V99  COMP-3 VALUE +0.
   168     12  W-PAID-DAYS             PIC S999      COMP-3 VALUE +0.
   169     12  W-PAID-MONTHS           PIC S999      COMP-3 VALUE +0.
   170     12  W-REM                   PIC S999      COMP-3 VALUE +0.
   171     12  W-REM-DAYS              PIC S999      COMP-3 VALUE +0.
   172     12  W-TERM-IN-DAYS          PIC S9(4)     COMP-3.
   173     12  W-REM-TERM-IN-DAYS      PIC S9(4)     COMP-3.
   174     12  W-CALLED-NAME           PIC X(08).
   175     12  W-EOB-CODES.
   176         16  W-EOB-CODE-GRP OCCURS 5 TIMES.
   177             20  W-EOB-CODE      PIC XXX.
   178             20  W-EOB-FILLER    PIC X.
   179     12  W-EOB-NDX               PIC S9        VALUE ZERO.
   180     12  W-NAME-LAST             PIC X(15).
   181     12  W-NAME-FIRST            PIC X(15).
   182     12  W-NAME-MIDDLE.
   183         16  FILLER              PIC X.
   184         16  W-NAME-MIDDLE-2     PIC X.
   185         16  FILLER              PIC X(13).
   186     12  W-DMD-CHECK-NO.
   187         16  W-DMD-CHECK-NO-1    PIC X(4).
   188         16  W-DMD-CHECK-NO-2    PIC X.
   189         16  W-DMD-CHECK-NO-3    PIC XX.
   190
   191     12  WS-COMPUTE-FROM-DT  PIC XX.
   192     12  WS-PMT-MOS          PIC 999V99        VALUE ZEROS.
   193     12  WS-HER-PART-DAYS    PIC 999V99        VALUE ZEROS.
   194     12  WS-HER-MO-PMT-AMT   PIC 9(07)V99      VALUE ZEROS.
   195     12  WS-FORM-CTL-SEQ-NO  PIC S9(4)   COMP  VALUE +0.
   196     12  WS-HOLD-ELMSTR-KEY  PIC X(20) VALUE LOW-VALUES.
   197     12  WS-PRINTED-SW       PIC X VALUE SPACES.
   198         88  PAYMENT-HAS-BEEN-PRINTED  VALUE 'Y'.
   199         88  PAYMENT-NOT-PRINTED       VALUE 'N'.
   200     12  WS-RELEASED-SW      PIC X VALUE SPACES.
   201         88  PAYMENT-NOT-RELEASED      VALUE 'N'.
   202     12  WS-UPDATE-SW        PIC X VALUE ' '.
   203     12  WS-GROUPING.
   204         16  WS-GROUP-1      PIC X VALUE SPACES.
   205         16  FILLER          PIC X(05) VALUE SPACES.
   206     12  WS-BROWSE-TRLR-SW   PIC X VALUE ' '.
   207     12  WS-BROWSE-START-SW  PIC X VALUE ' '.
   208     12  WS-WORK-STATE-ACCT.
   209         16  WS-WORK-ACCT    PIC X(10)   VALUE SPACES.
   210         16  FILLER          PIC X       VALUE '/'.
   211         16  WS-WORK-STATE   PIC XX      VALUE SPACES.
   212     12  WS-CHECK-WRITTEN-DT PIC XX      VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   6
* EL156.cbl
   213     12  WS-PMT-APPROVAL-SW  PIC X       VALUE SPACES.
   214     12  WS-SPECIAL-CALC-CD  PIC X       VALUE SPACES.
   215     12  QID.
   216         16  QID-TERM        PIC X(4)    VALUE SPACES.
   217         16  FILLER          PIC X(4)    VALUE '156A'.
   218     12  MAP-LENGTH          PIC S9(4)   VALUE +1098 COMP.
   219     12  SUB-1               PIC S9(4)   VALUE +0     COMP.
   220     12  FIRST-ENTRY         PIC X       VALUE 'N'.
   221     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   222     12  BENE-FOUND-SW       PIC X       VALUE SPACE.
   223     12  FOUND-TOL-SW        PIC X       VALUE 'N'.
   224     12  RETURNED-FROM-B     PIC X       VALUE 'N'.
   225     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   226     12  WS-STATUS           PIC X       VALUE SPACES.
   227     12  WS-TODAY-DATE       PIC XX      VALUE LOW-VALUES.
   228     12  WS-RETRO-ELIM-DATE  PIC XX      VALUE LOW-VALUES.
   229     12  WS-EXP-DT           PIC XX      VALUE LOW-VALUES.
   230     12  WS-SV-EPYFROM       PIC XX      VALUE LOW-VALUES.
   231     12  WS-SV-AIGFROM       PIC XX      VALUE LOW-VALUES.
   232     12  WS-SV-EPYTHRU       PIC XX      VALUE LOW-VALUES.
   233     12  WS-SV-PREV-PD-THRU  PIC XX      VALUE LOW-VALUES.
   234     12  WS-STATE-ABBREV     PIC XX      VALUE SPACES.
   235     12  WS-BEN-DAYS         PIC 99      VALUE ZEROS.
   236     12  WS-PMT-UNAPPROVED-CNT PIC S9(3)   VALUE +0      COMP-3.
   237     12  WS-DAYS-TOL         PIC S9(3)     VALUE +0      COMP-3.
   238     12  WS-PMT-TOL          PIC S9(3)V99  VALUE +0      COMP-3.
   239     12  WS-MAX-DAYS-TOL     PIC S9(3)     VALUE +0      COMP-3.
   240     12  WS-MAX-PMT-TOL      PIC S9(7)V99  VALUE +0      COMP-3.
   241     12  WS-MAX-LF-PMT-TOL   PIC S9(7)V99  VALUE +0      COMP-3.
   242     12  WS-AH-BEN-AMT       PIC S9(7)V999 VALUE +0      COMP-3.
   243     12  WS-BEN-AMT-LEFT     PIC S9(7)V99  VALUE +0.
   244     12  WS-REMAINING-AMT    PIC S9(9)V99  VALUE +0.
   245     12  WS-TOL-SEVERITY     PIC X         VALUE ' '.
   246     12  WS-LF-COVERAGE-TYPE PIC X         VALUE ' '.
   247     12  WS-EARNING-METHOD   PIC X         VALUE ' '.
   248     12  WS-CALC-METHOD      PIC X         VALUE ' '.
   249     12  WS-PAY-TYPE         PIC X         VALUE ' '.
   250     12  EXPENSE-MONTH-SAVE      PIC S9(4)     COMP-3 VALUE +0.
   251     12  WS-RESERVE-WORK         PIC S9(6)V99  COMP-3 VALUE +0.
   252     12  WS-EDIT-PATTERN         PIC Z(7).99  VALUE ZEROS.
   253     12  WS-EDIT REDEFINES WS-EDIT-PATTERN PIC X(10).
   254     12  WORK-DATE-FROM.
   255         16  WDF-MONTH       PIC 99        VALUE ZERO.
   256         16  WDF-DAY         PIC 99        VALUE ZERO.
   257         16  WDF-YEAR        PIC 99        VALUE ZERO.
   258     12  WORK-DATE-THRU.
   259         16  WDT-MONTH       PIC 99        VALUE ZERO.
   260         16  WDT-DAY         PIC 99        VALUE ZERO.
   261         16  WDT-YEAR        PIC 99        VALUE ZERO.
   262     12  FROM-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   263     12  THRU-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   264     12  FROM-PMT-DAYS       PIC 99        VALUE ZERO.
   265     12  THRU-PMT-DAYS       PIC 99        VALUE ZERO.
   266     12  SAVE-ELAPSED-MONTHS PIC 999       VALUE ZERO.
   267     12  SAVE-ELAPSED-DAYS   PIC 9(04)     VALUE ZERO.
   268     12  WS-SAVE-ODD-DAYS    PIC S9(04)    VALUE ZERO.
   269     12  SAVE-ODD-DAYS-OVER  PIC 999       VALUE ZERO.
   270     12  WS-DAILY-RATE       PIC S999V99999  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   7
* EL156.cbl
   271     12  WS-PY-WORK          PIC S9(8)V99 VALUE +0.
   272     12  WS-PY-WK REDEFINES WS-PY-WORK.
   273         16  WS-PY-NUM       PIC S9(7)V99.
   274         16  WS-PY-SIGN      PIC X.
   275     12  WS-DY-WORK          PIC S9(5).
   276     12  WS-DY-WK REDEFINES WS-DY-WORK.
   277         16  WS-DY-NUM       PIC S9(4).
   278         16  WS-DY-SIGN      PIC X.
   279     12  WS-COMP-MSTR-SW     PIC X       VALUE 'N'.
   280         88  COMP-REC-FOUND              VALUE 'Y'.
   281     12  WS-BEN-SEARCH-SW    PIC X       VALUE 'N'.
   282         88  BENEFIT-FOUND       VALUE 'Y'.
   283         88  NO-BENEFIT-FOUND    VALUE 'N'.
   284     12  WS-TERMS.
   285         16  WST-ORIG        PIC --9     VALUE ZEROS.
   286         16  FILLER          PIC X       VALUE '/'.
   287         16  WST-REM         PIC --9     VALUE ZEROS.
   288         16  WST-REM-DAYS-GRP.
   289             20  WST-SLASH   PIC X       VALUE '/'.
   290             20  WST-REM-DAYS
   291                             PIC --9.
   292     12  WS-ACCESS.
   293         16  FILLER          PIC XX      VALUE SPACES.
   294         16  WS-BEN-CD       PIC XX      VALUE SPACES.
   295     12  WS-STATE-ACCESS.
   296         16  WS-ST-ACCESS    PIC XX      VALUE SPACES.
   297         16  FILLER          PIC XX      VALUE SPACES.
   298     12  WS-CARR-ACCESS.
   299         16  FILLER          PIC X(3)    VALUE SPACES.
   300         16  WS-CARR         PIC X       VALUE SPACES.
   301     12  DATE-WORK.
   302         16  FILLER          PIC XX      VALUE SPACES.
   303         16  NUM-WORK        PIC X(6)    VALUE SPACES.
   304     12  WS-SAVE-INPUT.
   305         16  WS-PMTTYPE      PIC X       VALUE SPACE.
   306         16  WS-PAYEE        PIC XX      VALUE SPACE.
   307         16  WS-PMTNOTE1     PIC X(60)   VALUE SPACES.
   308         16  WS-PMTNOTE2     PIC X(60)   VALUE SPACES.
   309         16  WS-OFFLINE      PIC X       VALUE SPACE.
   310         16  WS-CHECKNO      PIC X(7)    VALUE SPACES.
   311         16  WS-HOLDTIL      PIC 9(6)    VALUE 0.
   312         16  WS-EPYFROM      PIC 9(6)    VALUE 0.
   313         16  WS-EPYTHRU      PIC 9(6)    VALUE 0.
   314         16  WS-EDAYS        PIC S9(5)    VALUE +0.
   315         16  WS-EPYAMT       PIC S9(7)V99 VALUE +0.
   316         16  WS-ERESV        PIC S9(7)V99 VALUE +0.
   317         16  WS-EEXPENS      PIC 9(6)V99  VALUE 0.
   318         16  WS-ETYPE        PIC X       VALUE SPACE.
   319         16  WS-CASH         PIC X       VALUE SPACE.
   320         16  WS-GROUPED      PIC X       VALUE SPACE.
   321         16  WS-INT-RATE     PIC S99V9(5) VALUE +0.
   322         16  WS-AIGFROM      PIC 9(6)    VALUE 0.
   323         16  WS-LOAN-NO      PIC X(20)   VALUE SPACES.
   324         16  WS-PROOF-DATE   PIC 9(6)    VALUE 0.
   325         16  WS-PRINT-EOB-YN PIC X       VALUE ' '.
   326     12  LAST-ERROR-LINE.
   327         16  WS-FATAL-CTR        PIC ZZ9  VALUE ZEROS.
   328         16  FILLER              PIC X(30)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   8
* EL156.cbl
   329             VALUE ' FATAL ERRORS ENCOUNTERED'.
   330         16  WS-FORCE-CTR        PIC ZZ9   VALUE ZEROS.
   331         16  FILLER              PIC X(28)
   332             VALUE ' FORCIBLE ERRORS ENCOUNTERED'.
   333     12  WS-CHECK-AREA.
   334         16  WS-CHECK-CARR       PIC X   VALUE SPACES.
   335         16  WS-CHECK-NUM        PIC 9(6) VALUE ZEROS.
   336     12  WS-CHECK-NUMERIC REDEFINES WS-CHECK-AREA PIC 9(7).
   337     12  WS-CHECK-AREA-RDF REDEFINES WS-CHECK-AREA.
   338         16  FILLER              PIC XX.
   339         16  WS-A-CHECK-NUM-5    PIC 9(5).
   340     12  WS-CHECK-AREA-RDF1 REDEFINES WS-CHECK-AREA.
   341         16  FILLER              PIC X.
   342         16  WS-A-CHECK-NUM-6    PIC 9(6).
   343     12  OPTION-1-SAVE-AREA.
   344         16  SAVE1-FROM-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   345         16  SAVE1-THRU-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   346     12  WS-WORK-ZIP.
   347         16  WS-ZIP              PIC X(5)  VALUE ZEROS.
   348         16  WS-ZIP-EXT          PIC X(4)  VALUE ZEROS.
   349     12  WS-NUMERIC-ZIP REDEFINES WS-WORK-ZIP
   350                                 PIC 9(9).
   351     12  WS-FLI-PMTNOTE.
   352         16  WS-PMTOPTION        PIC XX.
   353         16  WS-DOCNAME          PIC X(28).
   354         16  WS-AMOUNT-LINE REDEFINES WS-DOCNAME.
   355             20  WS-AMOUNT       PIC X(8).
   356             20  FILLER          PIC X(20).
   357         16  WS-NUMERIC-LINE REDEFINES WS-DOCNAME.
   358             20  WS-NUM-AMT      PIC 9(6)V99.
   359             20  FILLER          PIC X(20).
   360
   361     12  WS-HAN-PMTNOTE.
   362         16  WS-HAN-PMT-CODE     PIC X.
   363         16  WS-HAN-PMT-NOTE     PIC X(39).
   364
   365     12  WS-NCL-PMT-OPTION       PIC XX.
   366         88  WS-VALID-NCL-OPTION           VALUE '00' THRU '19'.
   367
   368     12  WS-CLAIM-SEQUENCE.
   369         16  FILLER              PIC X VALUE '('.
   370         16  WS-CUR-SEQU         PIC Z9    VALUE ZEROS.
   371         16  FILLER              PIC X(04) VALUE ' OF '.
   372         16  WS-OF-SEQU          PIC Z9    VALUE ZEROS.
   373         16  FILLER              PIC X VALUE ')'.
   374
   375     12  WS-REFUND-AMT           PIC Z(7).99.
   376     12  WS-CALC-INT             PIC S9(7)V99.
   377     12  WS-CRIT-PERIOD-DAYS     PIC S9(4)V999 VALUE +0  COMP-3.
   378
   379     12  SUB                     PIC 99 VALUE ZEROS.
   380
   381     12  WS-BOANOTE1.
   382         16  WS-BOANOTE1-DESC    PIC X(11).
   383         16  WS-BOANOTE1-EPYAMT  PIC Z,ZZZ,ZZZ.99.
   384         16  FILLER              PIC X(17).
   385     12  WS-BOANOTE2.
   386         16  WS-BOANOTE2-DESC    PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   9
* EL156.cbl
   387         16  WS-BOANOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   388         16  FILLER              PIC X(17).
   389
   390     12  WS-NCLNOTE1.
   391         16  WS-NCLNOTE1-DESC    PIC X(11).
   392         16  WS-NCLNOTE1-CPYAMT  PIC Z,ZZZ,ZZZ.99.
   393         16  FILLER              PIC X(17).
   394     12  WS-NCLNOTE2.
   395         16  WS-NCLNOTE2-DESC    PIC X(11).
   396         16  WS-NCLNOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   397         16  FILLER              PIC X(17).
   398
   399     12  WS-MAX-LETTER-ANSWER-DT PIC XX         VALUE LOW-VALUES.
   400     12  WS-SAVE-APPROVAL-LEVEL-REQD  PIC X.
   401     12  WS-SAVE-APPROVED-LEVEL  PIC X.
   402     12  WS-MAX-EXP-PMT          PIC S9(07)V99  VALUE +0.
   403     12  WS-ACTIVITY-CODE        PIC 99         VALUE ZEROS.
   404     12  WS-LETTER-SW            PIC X          VALUE 'N'.
   405     12  WS-ACT-REC-FOUND-SW     PIC X          VALUE 'N'.
   406     12  WS-BROWSE-SW            PIC X          VALUE 'N'.
   407     12  WS-APPROVAL-LEVEL       PIC X          VALUE ' '.
   408     12  WS-OPEN-CLOSE-SW        PIC X          VALUE ' '.
   409
   410     12  WS-AIG-WORK-AREAS.
   411         16  WS-RECALC-PAYFROM-SW  PIC X VALUE 'N'.
   412             88  WS-AIG-RECALC-PAYFROM   VALUE 'Y'.
   413         16  WS-AIG-PAYFROM-SW PIC X     VALUE 'N'.
   414             88  WS-USE-AIG-PAYFROM      VALUE 'Y'.
   415         16  WS-FROM-DATE-MDY.
   416             20  WS-FROM-MO      PIC 99.
   417             20  WS-FROM-DA      PIC 99.
   418             20  WS-FROM-YR      PIC 99.
   419         16  WS-TEMP-DATE-MDY.
   420             20  WS-TEMP-MO      PIC 99.
   421             20  WS-TEMP-DA      PIC 99.
   422             20  WS-TEMP-YR      PIC 99.
   423         16  WS-BIN-FROM-DT      PIC XX.
   424         16  WS-TEMP-INC-MDY.
   425             20  WS-TEMP-INC-MO  PIC 99.
   426             20  WS-TEMP-INC-DA  PIC 99.
   427             20  WS-TEMP-INC-YR  PIC 99.
   428         16  WS-PMT-DUE-MDY.
   429             20  WS-PMT-DUE-MO   PIC 99.
   430             20  WS-PMT-DUE-DA   PIC 99.
   431             20  WS-PMT-DUE-YR   PIC 99.
   432         16  WS-PMT-DUE-DT       PIC XX.
   433         16  WS-NEXT-PMT-DUE-DT  PIC XX.
   434         16  WS-RETRO-ELIM-DT    PIC XX.
   435         16  WS-DUE-DAY-SW               PIC X       VALUE 'N'.
   436             88 WS-RESTORE-DUE-DAY                   VALUE 'Y'.
   437         16  WS-SAVE-DUE-DA      PIC 99.
   438         16  WS-CDAYS            PIC S9(05).
   439         16  WS-DAYS-OFF         PIC S9(05).
   440         16  WS-ELIMINATION-SW   PIC X     VALUE 'N'.
   441             88  ELIM-SATISFIED            VALUE 'Y'.
   442         16  WS-AIG-CHECKNO.
   443             20  WS-A-CHECKNO-1-2        PIC XX      VALUE SPACES.
   444             20  WS-A-CHECKNO-3-7.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  10
* EL156.cbl
   445                 24  FILLER              PIC X(3)    VALUE SPACES.
   446                 24  WS-A-CHECKNO-6-7    PIC XX      VALUE SPACES.
   447                     88  WS-AIG-CREDIT-ENTERED       VALUE 'CR'.
   448         16  WS-AIG-GROUPING.
   449             20  WS-A-BENE               PIC XXX.
   450             20  FILLER                  PIC XXX.
   451         16  WS-PAYMENT-TRAILER-SW       PIC X       VALUE ' '.
   452             88  WS-1ST-SPECIAL-PMT                  VALUE '1'.
   453             88  WS-2ND-SPECIAL-PMT                  VALUE '2'.
   454         16  WS-AIG-UNEMPLY-DESC         PIC X(60)
   455                 VALUE 'UNEMPLOYMENT PAYMENT'.
   456         16  WS-CHK-THRU-DT              PIC XX.
   457         16  WS-HOLD-BIN-DATE-1          PIC XX.
   458
   459 01  MISC-CSO-AREA.
   460     12  WS-NEED-APPROVAL                PIC X(1)   VALUE 'N'.
   461         88  APPROVAL-NEEDED                        VALUE 'Y'.
   462     12  WS-APPROV-NOTE                  PIC X(43)
   463         VALUE 'REFERRED FOR CLAIM PAYMENT APPROVAL REVIEW.'.
   464     12  WS-CALC-PMT-MONTHS      PIC S9(2)V9(8)  VALUE +0.
   465     12  WS-CALC-MO-AH-AMT       PIC S9(07)V99   VALUE +0.
   466     12  WS-SUB                  PIC S9(3) COMP-3 VALUE +0.
   467     12  WS-BEG-SUB              PIC S9(3) COMP-3 VALUE +0.
   468     12  WS-END-SUB              PIC S9(3) COMP-3 VALUE +0.
   469     12  WS-STATE-LENGTH         PIC S9(3) COMP-3 VALUE +0.
   470     12  WS-PAYEE-STATE-FOUND    PIC X(01)        VALUE 'N'.
   471         88 PAYEE-STATE-FOUND                     VALUE 'Y'.
   472     12  WS-PAYEE-CITY-STATE     PIC X(30).
   473     12  FILLER  REDEFINES WS-PAYEE-CITY-STATE.
   474         16  WS-PAYEE-CITY-ST OCCURS 30 TIMES PIC X(1).
   475     12  WS-PD-DAYS              PIC S9(5) VALUE +0.
   476
   477 01  ERROR-MESSAGES.
   478     12  ER-0000                 PIC X(4)  VALUE '0000'.
   479     12  ER-0004                 PIC X(4)  VALUE '0004'.
   480     12  ER-0008                 PIC X(4)  VALUE '0008'.
   481     12  ER-0019                 PIC X(4)  VALUE '0019'.
   482     12  ER-0029                 PIC X(4)  VALUE '0029'.
   483     12  ER-0042                 PIC X(4)  VALUE '0042'.
   484     12  ER-0070                 PIC X(4)  VALUE '0070'.
   485     12  ER-0130                 PIC X(4)  VALUE '0130'.
   486     12  ER-0149                 PIC X(4)  VALUE '0149'.
   487     12  ER-0154                 PIC X(4)  VALUE '0154'.
   488     12  ER-0168                 PIC X(4)  VALUE '0168'.
   489     12  ER-0169                 PIC X(4)  VALUE '0169'.
   490     12  ER-0172                 PIC X(4)  VALUE '0174'.
   491     12  ER-0198                 PIC X(4)  VALUE '0198'.
   492     12  ER-0204                 PIC X(4)  VALUE '0204'.
   493     12  ER-0206                 PIC X(4)  VALUE '0206'.
   494     12  ER-0252                 PIC X(4)  VALUE '0252'.
   495     12  ER-0254                 PIC X(4)  VALUE '0254'.
   496     12  ER-0282                 PIC X(4)  VALUE '0282'.
   497     12  ER-0283                 PIC X(4)  VALUE '0283'.
   498     12  ER-0294                 PIC X(4)  VALUE '0294'.
   499     12  ER-0338                 PIC X(4)  VALUE '0338'.
   500     12  ER-0419                 PIC X(4)  VALUE '0419'.
   501     12  ER-0420                 PIC X(4)  VALUE '0420'.
   502     12  ER-0421                 PIC X(4)  VALUE '0421'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  11
* EL156.cbl
   503     12  ER-0422                 PIC X(4)  VALUE '0422'.
   504     12  ER-0433                 PIC X(4)  VALUE '0433'.
   505     12  ER-0436                 PIC X(4)  VALUE '0436'.
   506     12  ER-0437                 PIC X(4)  VALUE '0437'.
   507     12  ER-0438                 PIC X(4)  VALUE '0438'.
   508     12  ER-0439                 PIC X(4)  VALUE '0439'.
   509     12  ER-0440                 PIC X(4)  VALUE '0440'.
   510     12  ER-0441                 PIC X(4)  VALUE '0441'.
   511     12  ER-0442                 PIC X(4)  VALUE '0442'.
   512     12  ER-0443                 PIC X(4)  VALUE '0443'.
   513     12  ER-0444                 PIC X(4)  VALUE '0444'.
   514     12  ER-0445                 PIC X(4)  VALUE '0445'.
   515     12  ER-0446                 PIC X(4)  VALUE '0446'.
   516     12  ER-0447                 PIC X(4)  VALUE '0447'.
   517     12  ER-0448                 PIC X(4)  VALUE '0448'.
   518     12  ER-0449                 PIC X(4)  VALUE '0449'.
   519     12  ER-0452                 PIC X(4)  VALUE '0452'.
   520     12  ER-0458                 PIC X(4)  VALUE '0458'.
   521     12  ER-0459                 PIC X(4)  VALUE '0459'.
   522     12  ER-0460                 PIC X(4)  VALUE '0460'.
   523     12  ER-0461                 PIC X(4)  VALUE '0461'.
   524     12  ER-0462                 PIC X(4)  VALUE '0462'.
   525     12  ER-0463                 PIC X(4)  VALUE '0463'.
   526     12  ER-0464                 PIC X(4)  VALUE '0464'.
   527     12  ER-0465                 PIC X(4)  VALUE '0465'.
   528     12  ER-0466                 PIC X(4)  VALUE '0466'.
   529     12  ER-0467                 PIC X(4)  VALUE '0467'.
   530     12  ER-0468                 PIC X(4)  VALUE '0468'.
   531     12  ER-0469                 PIC X(4)  VALUE '0469'.
   532     12  ER-0473                 PIC X(4)  VALUE '0473'.
   533     12  ER-0474                 PIC X(4)  VALUE '0474'.
   534     12  ER-0475                 PIC X(4)  VALUE '0475'.
   535     12  ER-0476                 PIC X(4)  VALUE '0476'.
   536     12  ER-0477                 PIC X(4)  VALUE '0477'.
   537     12  ER-0478                 PIC X(4)  VALUE '0478'.
   538     12  ER-0479                 PIC X(4)  VALUE '0479'.
   539     12  ER-0481                 PIC X(4)  VALUE '0481'.
   540     12  ER-0491                 PIC X(4)  VALUE '0491'.
   541     12  ER-0492                 PIC X(4)  VALUE '0492'.
   542     12  ER-0493                 PIC X(4)  VALUE '0493'.
   543     12  ER-0494                 PIC X(4)  VALUE '0494'.
   544     12  ER-0495                 PIC X(4)  VALUE '0495'.
   545     12  ER-0499                 PIC X(4)  VALUE '0499'.
   546     12  ER-0500                 PIC X(4)  VALUE '0500'.
   547     12  ER-0501                 PIC X(4)  VALUE '0501'.
   548     12  ER-0502                 PIC X(4)  VALUE '0502'.
   549     12  ER-0508                 PIC X(4)  VALUE '0508'.
   550     12  ER-0513                 PIC X(4)  VALUE '0513'.
   551     12  ER-0518                 PIC X(4)  VALUE '0518'.
   552     12  ER-0524                 PIC X(4)  VALUE '0524'.
   553     12  ER-0525                 PIC X(4)  VALUE '0525'.
   554     12  ER-0526                 PIC X(4)  VALUE '0526'.
   555     12  ER-0530                 PIC X(4)  VALUE '0530'.
   556     12  ER-0540                 PIC X(4)  VALUE '0540'.
   557     12  ER-0541                 PIC X(4)  VALUE '0541'.
   558     12  ER-0542                 PIC X(4)  VALUE '0542'.
   559     12  ER-0543                 PIC X(4)  VALUE '0543'.
   560     12  ER-0545                 PIC X(4)  VALUE '0545'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  12
* EL156.cbl
   561     12  ER-0552                 PIC X(4)  VALUE '0552'.
   562     12  ER-0555                 PIC X(4)  VALUE '0555'.
   563     12  ER-0556                 PIC X(4)  VALUE '0556'.
   564     12  ER-0557                 PIC X(4)  VALUE '0557'.
   565     12  ER-0572                 PIC X(4)  VALUE '0572'.
   566     12  ER-0573                 PIC X(4)  VALUE '0573'.
   567     12  ER-0594                 PIC X(4)  VALUE '0594'.
   568     12  ER-0616                 PIC X(4)  VALUE '0616'.
   569     12  ER-0617                 PIC X(4)  VALUE '0617'.
   570     12  ER-0618                 PIC X(4)  VALUE '0618'.
   571     12  ER-0657                 PIC X(4)  VALUE '0657'.
   572     12  ER-0658                 PIC X(4)  VALUE '0658'.
   573     12  ER-0699                 PIC X(4)  VALUE '0699'.
   574     12  ER-0730                 PIC X(4)  VALUE '0730'.
   575     12  ER-0737                 PIC X(4)  VALUE '0737'.
   576     12  ER-0760                 PIC X(4)  VALUE '0760'.
   577     12  ER-0768                 PIC X(4)  VALUE '0768'.
   578     12  ER-0769                 PIC X(4)  VALUE '0769'.
   579     12  ER-0770                 PIC X(4)  VALUE '0770'.
   580     12  ER-0802                 PIC X(4)  VALUE '0802'.
   581     12  ER-0803                 PIC X(4)  VALUE '0803'.
   582     12  ER-0819                 PIC X(4)  VALUE '0819'.
   583     12  ER-0834                 PIC X(4)  VALUE '0834'.
   584     12  ER-0836                 PIC X(4)  VALUE '0836'.
   585     12  ER-0844                 PIC X(4)  VALUE '0844'.
   586     12  ER-0845                 PIC X(4)  VALUE '0845'.
   587     12  ER-0846                 PIC X(4)  VALUE '0846'.
   588     12  ER-0849                 PIC X(4)  VALUE '0849'.
   589     12  ER-0851                 PIC X(4)  VALUE '0851'.
   590     12  ER-0872                 PIC X(4)  VALUE '0872'.
   591     12  ER-0873                 PIC X(4)  VALUE '0873'.
   592     12  ER-0874                 PIC X(4)  VALUE '0874'.
   593     12  ER-0879                 PIC X(4)  VALUE '0879'.
   594     12  ER-0919                 PIC X(4)  VALUE '0919'.
   595     12  ER-0921                 PIC X(4)  VALUE '0921'.
   596     12  ER-0923                 PIC X(4)  VALUE '0923'.
   597     12  ER-0925                 PIC X(4)  VALUE '0925'.
   598     12  ER-0944                 PIC X(4)  VALUE '0944'.
   599     12  ER-0945                 PIC X(4)  VALUE '0945'.
   600     12  ER-0946                 PIC X(4)  VALUE '0946'.
   601     12  ER-0947                 PIC X(4)  VALUE '0947'.
   602     12  ER-0948                 PIC X(4)  VALUE '0948'.
   603     12  ER-0949                 PIC X(4)  VALUE '0949'.
   604     12  ER-0950                 PIC X(4)  VALUE '0950'.
   605     12  ER-0951                 PIC X(4)  VALUE '0951'.
   606     12  ER-0954                 PIC X(4)  VALUE '0954'.
   607     12  ER-0956                 PIC X(4)  VALUE '0956'.
   608     12  ER-0967                 PIC X(4)  VALUE '0967'.
   609     12  ER-0968                 PIC X(4)  VALUE '0968'.
   610     12  ER-0974                 PIC X(4)  VALUE '0974'.
   611     12  ER-0975                 PIC X(4)  VALUE '0975'.
   612     12  ER-1561                 PIC X(4)  VALUE '1561'.
   613     12  ER-1775                 PIC X(4)  VALUE '1775'.
   614     12  ER-1880                 PIC X(4)  VALUE '1880'.
   615     12  ER-2044                 PIC X(4)  VALUE '2044'.
   616     12  ER-3140                 PIC X(4)  VALUE '3140'.
   617     12  ER-3141                 PIC X(4)  VALUE '3141'.
   618     12  ER-3255                 PIC X(4)  VALUE '3255'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  13
* EL156.cbl
   619     12  ER-3516                 PIC X(4)  VALUE '3516'.
   620     12  ER-3527                 PIC X(4)  VALUE '3527'.
   621     12  ER-3528                 PIC X(4)  VALUE '3528'.
   622     12  ER-3529                 PIC X(4)  VALUE '3529'.
   623     12  ER-3530                 PIC X(4)  VALUE '3530'.
   624     12  ER-3531                 PIC X(4)  VALUE '3531'.
   625     12  ER-3532                 PIC X(4)  VALUE '3532'.
   626     12  ER-3533                 PIC X(4)  VALUE '3533'.
   627     12  ER-3534                 PIC X(4)  VALUE '3534'.
   628     12  ER-3535                 PIC X(4)  VALUE '3535'.
   629     12  ER-3536                 PIC X(4)  VALUE '3536'.
   630     12  ER-3537                 PIC X(4)  VALUE '3537'.
   631     12  ER-3538                 PIC X(4)  VALUE '3538'.
   632     12  ER-3539                 PIC X(4)  VALUE '3539'.
   633     12  ER-3540                 PIC X(4)  VALUE '3540'.
   634     12  ER-3541                 PIC X(4)  VALUE '3541'.
   635     12  ER-3542                 PIC X(4)  VALUE '3542'.
   636     12  ER-3543                 PIC X(4)  VALUE '3543'.
   637     12  ER-3546                 PIC X(4)  VALUE '3546'.
   638     12  ER-3549                 PIC X(4)  VALUE '3549'.
   639     12  ER-3818                 PIC X(4)  VALUE '3818'.
   640     12  ER-7540                 PIC X(4)  VALUE '7540'.
   641     12  ER-7830                 PIC X(4)  VALUE '7830'.
   642     12  ER-7831                 PIC X(4)  VALUE '7831'.
   643     12  ER-7832                 PIC X(4)  VALUE '7832'.
   644     12  ER-7833                 PIC X(4)  VALUE '7833'.
   645     12  ER-7834                 PIC X(4)  VALUE '7834'.
   646     12  ER-7835                 PIC X(4)  VALUE '7835'.
   647     12  ER-7836                 PIC X(4)  VALUE '7836'.
   648     12  ER-7837                 PIC X(4)  VALUE '7837'.
   649     12  ER-7838                 PIC X(4)  VALUE '7838'.
   650     12  ER-7841                 PIC X(4)  VALUE '7841'.
   651     12  ER-7844                 PIC X(4)  VALUE '7844'.
   652     12  ER-7845                 PIC X(4)  VALUE '7845'.
   653     12  ER-8000                 PIC X(4)  VALUE '8000'.
   654     12  ER-8051                 PIC X(4)  VALUE '8051'.
   655     12  ER-8052                 PIC X(4)  VALUE '8052'.
   656     12  ER-8053                 PIC X(4)  VALUE '8053'.
   657     12  ER-8054                 PIC X(4)  VALUE '8054'.
   658     12  ER-8055                 PIC X(4)  VALUE '8055'.
   659     12  ER-8056                 PIC X(4)  VALUE '8056'.
   660     12  ER-8057                 PIC X(4)  VALUE '8057'.
   661     12  ER-8058                 PIC X(4)  VALUE '8058'.
   662     12  ER-8059                 PIC X(4)  VALUE '8059'.
   663     12  ER-8060                 PIC X(4)  VALUE '8060'.
   664     12  ER-8061                 PIC X(4)  VALUE '8061'.
   665     12  ER-8062                 PIC X(4)  VALUE '8062'.
   666     12  ER-8063                 PIC X(4)  VALUE '8063'.
   667     12  ER-8064                 PIC X(4)  VALUE '8064'.
   668     12  ER-8065                 PIC X(4)  VALUE '8065'.
   669     12  ER-8066                 PIC X(4)  VALUE '8066'.
   670     12  ER-8146                 PIC X(4)  VALUE '8146'.
   671     12  ER-8147                 PIC X(4)  VALUE '8147'.
   672     12  ER-8152                 PIC X(4)  VALUE '8152'.
   673     12  ER-8153                 PIC X(4)  VALUE '8153'.
   674     12  ER-8154                 PIC X(4)  VALUE '8154'.
   675     12  ER-8155                 PIC X(4)  VALUE '8155'.
   676     12  ER-8310                 PIC X(4)  VALUE '8310'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  14
* EL156.cbl
   677     12  ER-8311                 PIC X(4)  VALUE '8311'.
   678     12  ER-8312                 PIC X(4)  VALUE '8312'.
   679     12  ER-8313                 PIC X(4)  VALUE '8313'.
   680     12  ER-8314                 PIC X(4)  VALUE '8314'.
   681     12  ER-8315                 PIC X(4)  VALUE '8315'.
   682     12  ER-8316                 PIC X(4)  VALUE '8316'.
   683     12  ER-8317                 PIC X(4)  VALUE '8317'.
   684
   685 01  CSO-WORK-FIELDS.
   686     05  ERROR-ON-OUTPUT-SW  PIC X     VALUE 'N'.
   687       88  ERROR-ON-OUTPUT             VALUE 'Y'.
   688
   689     05  WRK-6MO                 PIC S9(7)V99 VALUE +0.
   690     05  WRK-CERT-NOTE-ADD       PIC X VALUE SPACES.
   691         88  CERT-NOTE-ADDED           VALUE 'Y'.
   692     05  WRK-ORIG-NOTE-ADD       PIC X VALUE SPACES.
   693         88  ORIG-NOTE-ADDED           VALUE 'Y'.
   694     05  WRK-NOTE-SEQ            PIC S9(4) COMP  VALUE +0.
   695
   696 01  SC-NP6-CERT-NOTE.
   697     12  FILLER                  PIC X(12)
   698               VALUE 'REM BENEFIT '.
   699     12  SC-NP6-REM-BEN          PIC ZZZ,ZZZ.99.
   700     12  FILLER                  PIC X(8)
   701               VALUE ' + 6 MO '.
   702     12  SC-NP6-6-MO             PIC ZZZ,ZZZ.99.
   703     12  FILLER                  PIC X(12)
   704               VALUE ' = AMT PAID '.
   705     12  SC-NP6-AMT-PAID         PIC ZZZ,ZZZ.99.
   706
   707 01  SC-NP6-ORIG-NOTE.
   708     12  FILLER                  PIC X(63)  VALUE
   709         'BENEFITS PAID CANNOT EXCEED ORIGINAL LIFE BENEFIT'.
   710
   711 01  ACCESS-KEYS.
   712     12  ELARCH-KEY.
   713         16  ARCH-CO             PIC X.
   714         16  ARCH-NUMBER         PIC S9(08) COMP.
   715         16  ARCH-REC-TYPE       PIC X.
   716         16  ARCH-SEQ            PIC S9(04) COMP.
   717     12  ELMSTR-KEY.
   718         16  MSTR-COMP-CD        PIC X.
   719         16  MSTR-CARRIER        PIC X.
   720         16  MSTR-CLAIM-NO       PIC X(7).
   721         16  MSTR-CERT-NO        PIC X(11).
   722     12  ELCNTL-KEY.
   723         16  CNTL-COMP-ID        PIC X(3).
   724         16  CNTL-REC-TYPE       PIC X.
   725         16  CNTL-ACCESS         PIC X(4).
   726         16  CNTL-SEQ-NO         PIC S9(4)    COMP.
   727     12  ELCERT-KEY.
   728         16  CERT-COMP-CD        PIC X.
   729         16  CERT-CARRIER        PIC X.
   730         16  CERT-GROUPING       PIC X(6).
   731         16  CERT-STATE          PIC XX.
   732         16  CERT-ACCOUNT        PIC X(10).
   733         16  CERT-EFF-DT         PIC XX.
   734         16  CERT-CERT-NO        PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  15
* EL156.cbl
   735     12  ELTRLR-KEY.
   736         16  TRLR-COMP-CD        PIC X.
   737         16  TRLR-CARRIER        PIC X.
   738         16  TRLR-CLAIM-NO       PIC X(7).
   739         16  TRLR-CERT-NO        PIC X(11).
   740         16  TRLR-SEQ-NO         PIC S9(4)   COMP.
   741     12  ELACTQ-KEY.
   742         16  ACTQ-COMP-CD        PIC X.
   743         16  ACTQ-CARRIER        PIC X.
   744         16  ACTQ-CLAIM-NO       PIC X(7).
   745         16  ACTQ-CERT-NO        PIC X(11).
   746     12  W-NOTE-KEY.
   747         16  W-NOTE-COMP-CD      PIC X.
   748         16  W-NOTE-CERT-KEY.
   749             20  W-NOTE-CARRIER  PIC X.
   750             20  W-NOTE-GROUPING PIC X(6).
   751             20  W-NOTE-STATE    PIC XX.
   752             20  W-NOTE-ACCOUNT  PIC X(10).
   753             20  W-NOTE-EFF-DT   PIC XX.
   754             20  W-NOTE-CERT-NO  PIC X(11).
   755     12  WS-ERACCT-SAVE-KEY      PIC X(20).
   756     12  WS-ERACCT-HOLD-RECORD   PIC X(2000).
   757     12  ERACCT-KEY.
   758         16  ERACCT-PARTIAL-KEY.
   759             20  ACCT-COMP-CD    PIC X.
   760             20  ACCT-CARRIER    PIC X.
   761             20  ACCT-GROUPING   PIC X(6).
   762             20  ACCT-STATE      PIC XX.
   763             20  ACCT-ACCOUNT    PIC X(10).
   764         16  ACCT-EXP-DT         PIC XX.
   765         16  FILLER              PIC X(4) VALUE SPACES.
   766     12  ELCHKQ-KEY.
   767         16  CHKQ-COMP-CD        PIC X.
   768         16  CHKQ-CONTROL        PIC S9(8) COMP.
   769         16  CHKQ-SEQ-NO         PIC S9(4) COMP.
   770     12  ELBENE-KEY.
   771         16  BENE-COMP-CD         PIC X.
   772         16  BENE-RECORD-TYPE     PIC X.
   773         16  BENE-NUMBER          PIC X(10).
   774     12  ERCOMP-KEY.
   775         16  COMP-COMP-CD        PIC X.
   776         16  COMP-CARRIER        PIC X.
   777         16  COMP-GROUP          PIC X(06).
   778         16  COMP-FIN-RESP       PIC X(10).
   779         16  COMP-ACCOUNT        PIC X(10).
   780         16  COMP-TYPE           PIC X.
   781
   782     12  DLO035-KEY.
   783         16  DL35-PROCESS-TYPE   PIC X.
   784         16  DL35-CREDIT-CARD    PIC X(20).
   785         16  DL35-BEN-TYPE       PIC XX.
   786         16  DL35-PAYMENT-AMT    PIC 9(7)V99.
   787         16  DL35-RETURN-CODE    PIC XX.
   788
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  16
* EL156.cbl
   790*    COPY ELCDATE.
   791******************************************************************
   792*                                                                *
   793*                                                                *
   794*                            ELCDATE.                            *
   795*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   796*                            VMOD=2.003
   797*                                                                *
   798*                                                                *
   799*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   800*                 LENGTH = 200                                   *
   801******************************************************************
   802
   803 01  DATE-CONVERSION-DATA.
   804     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   805     12  DC-OPTION-CODE                PIC X.
   806         88  BIN-TO-GREG                VALUE ' '.
   807         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   808         88  EDIT-GREG-TO-BIN           VALUE '2'.
   809         88  YMD-GREG-TO-BIN            VALUE '3'.
   810         88  MDY-GREG-TO-BIN            VALUE '4'.
   811         88  JULIAN-TO-BIN              VALUE '5'.
   812         88  BIN-PLUS-ELAPSED           VALUE '6'.
   813         88  FIND-CENTURY               VALUE '7'.
   814         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   815         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   816         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   817         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   818         88  JULIAN-TO-BIN-3            VALUE 'C'.
   819         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   820         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   821         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   822         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   823         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   824         88  CHECK-LEAP-YEAR            VALUE 'H'.
   825         88  BIN-3-TO-GREG              VALUE 'I'.
   826         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   827         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   828         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   829         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   830         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   831         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   832         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   833         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   834         88  THREE-CHARACTER-BIN
   835                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   836         88  GREGORIAN-TO-BIN
   837                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   838         88  BIN-TO-GREGORIAN
   839                  VALUES ' ' '1' 'I' '8' 'G'.
   840         88  JULIAN-TO-BINARY
   841                  VALUES '5' 'C' 'E' 'F'.
   842     12  DC-ERROR-CODE                 PIC X.
   843         88  NO-CONVERSION-ERROR        VALUE ' '.
   844         88  DATE-CONVERSION-ERROR
   845                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   846         88  DATE-IS-ZERO               VALUE '1'.
   847         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  17
* EL156.cbl
   848         88  DATE-IS-INVALID            VALUE '3'.
   849         88  DATE1-GREATER-DATE2        VALUE '4'.
   850         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   851         88  DATE-INVALID-OPTION        VALUE '9'.
   852         88  INVALID-CENTURY            VALUE 'A'.
   853         88  ONLY-CENTURY               VALUE 'B'.
   854         88  ONLY-LEAP-YEAR             VALUE 'C'.
   855         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   856     12  DC-END-OF-MONTH               PIC X.
   857         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   858     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   859         88  USE-NORMAL-PROCESS         VALUE ' '.
   860         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   861         88  ADJUST-UP-100-YRS          VALUE '2'.
   862     12  FILLER                        PIC X.
   863     12  DC-CONVERSION-DATES.
   864         16  DC-BIN-DATE-1             PIC XX.
   865         16  DC-BIN-DATE-2             PIC XX.
   866         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   867         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   868                       DC-GREG-DATE-1-EDIT.
   869             20  DC-EDIT1-MONTH        PIC 99.
   870             20  SLASH1-1              PIC X.
   871             20  DC-EDIT1-DAY          PIC 99.
   872             20  SLASH1-2              PIC X.
   873             20  DC-EDIT1-YEAR         PIC 99.
   874         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   875         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   876                     DC-GREG-DATE-2-EDIT.
   877             20  DC-EDIT2-MONTH        PIC 99.
   878             20  SLASH2-1              PIC X.
   879             20  DC-EDIT2-DAY          PIC 99.
   880             20  SLASH2-2              PIC X.
   881             20  DC-EDIT2-YEAR         PIC 99.
   882         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   883         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   884                     DC-GREG-DATE-1-YMD.
   885             20  DC-YMD-YEAR           PIC 99.
   886             20  DC-YMD-MONTH          PIC 99.
   887             20  DC-YMD-DAY            PIC 99.
   888         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   889         16  DC-GREG-DATE-1-MDY-R REDEFINES
   890                      DC-GREG-DATE-1-MDY.
   891             20  DC-MDY-MONTH          PIC 99.
   892             20  DC-MDY-DAY            PIC 99.
   893             20  DC-MDY-YEAR           PIC 99.
   894         16  DC-GREG-DATE-1-ALPHA.
   895             20  DC-ALPHA-MONTH        PIC X(10).
   896             20  DC-ALPHA-DAY          PIC 99.
   897             20  FILLER                PIC XX.
   898             20  DC-ALPHA-CENTURY.
   899                 24 DC-ALPHA-CEN-N     PIC 99.
   900             20  DC-ALPHA-YEAR         PIC 99.
   901         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   902         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   903         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   904         16  DC-JULIAN-DATE            PIC 9(05).
   905         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  18
* EL156.cbl
   906                                       PIC 9(05).
   907         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   908             20  DC-JULIAN-YEAR        PIC 99.
   909             20  DC-JULIAN-DAYS        PIC 999.
   910         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   911         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   912         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   913     12  DATE-CONVERSION-VARIBLES.
   914         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   915         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   916             20  FILLER                PIC 9(3).
   917             20  HOLD-CEN-1-CCYY.
   918                 24  HOLD-CEN-1-CC     PIC 99.
   919                 24  HOLD-CEN-1-YY     PIC 99.
   920             20  HOLD-CEN-1-MO         PIC 99.
   921             20  HOLD-CEN-1-DA         PIC 99.
   922         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   923             20  HOLD-CEN-1-R-MO       PIC 99.
   924             20  HOLD-CEN-1-R-DA       PIC 99.
   925             20  HOLD-CEN-1-R-CCYY.
   926                 24  HOLD-CEN-1-R-CC   PIC 99.
   927                 24  HOLD-CEN-1-R-YY   PIC 99.
   928             20  FILLER                PIC 9(3).
   929         16  HOLD-CENTURY-1-X.
   930             20  FILLER                PIC X(3)  VALUE SPACES.
   931             20  HOLD-CEN-1-X-CCYY.
   932                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   933                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   934             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   935             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   936         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   937             20  HOLD-CEN-1-R-X-MO     PIC XX.
   938             20  HOLD-CEN-1-R-X-DA     PIC XX.
   939             20  HOLD-CEN-1-R-X-CCYY.
   940                 24  HOLD-CEN-1-R-X-CC PIC XX.
   941                 24  HOLD-CEN-1-R-X-YY PIC XX.
   942             20  FILLER                PIC XXX.
   943         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   944         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   945         16  DC-JULIAN-DATE-1          PIC 9(07).
   946         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   947             20  DC-JULIAN-1-CCYY.
   948                 24  DC-JULIAN-1-CC    PIC 99.
   949                 24  DC-JULIAN-1-YR    PIC 99.
   950             20  DC-JULIAN-DA-1        PIC 999.
   951         16  DC-JULIAN-DATE-2          PIC 9(07).
   952         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   953             20  DC-JULIAN-2-CCYY.
   954                 24  DC-JULIAN-2-CC    PIC 99.
   955                 24  DC-JULIAN-2-YR    PIC 99.
   956             20  DC-JULIAN-DA-2        PIC 999.
   957         16  DC-GREG-DATE-A-EDIT.
   958             20  DC-EDITA-MONTH        PIC 99.
   959             20  SLASHA-1              PIC X VALUE '/'.
   960             20  DC-EDITA-DAY          PIC 99.
   961             20  SLASHA-2              PIC X VALUE '/'.
   962             20  DC-EDITA-CCYY.
   963                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  19
* EL156.cbl
   964                 24  DC-EDITA-YEAR     PIC 99.
   965         16  DC-GREG-DATE-B-EDIT.
   966             20  DC-EDITB-MONTH        PIC 99.
   967             20  SLASHB-1              PIC X VALUE '/'.
   968             20  DC-EDITB-DAY          PIC 99.
   969             20  SLASHB-2              PIC X VALUE '/'.
   970             20  DC-EDITB-CCYY.
   971                 24  DC-EDITB-CENT     PIC 99.
   972                 24  DC-EDITB-YEAR     PIC 99.
   973         16  DC-GREG-DATE-CYMD         PIC 9(08).
   974         16  DC-GREG-DATE-CYMD-R REDEFINES
   975                              DC-GREG-DATE-CYMD.
   976             20  DC-CYMD-CEN           PIC 99.
   977             20  DC-CYMD-YEAR          PIC 99.
   978             20  DC-CYMD-MONTH         PIC 99.
   979             20  DC-CYMD-DAY           PIC 99.
   980         16  DC-GREG-DATE-MDCY         PIC 9(08).
   981         16  DC-GREG-DATE-MDCY-R REDEFINES
   982                              DC-GREG-DATE-MDCY.
   983             20  DC-MDCY-MONTH         PIC 99.
   984             20  DC-MDCY-DAY           PIC 99.
   985             20  DC-MDCY-CEN           PIC 99.
   986             20  DC-MDCY-YEAR          PIC 99.
   987    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   988        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   989    12  DC-EL310-DATE                  PIC X(21).
   990    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  20
* EL156.cbl
   992*    COPY ELCLOGOF.
   993******************************************************************
   994*                                                                *
   995*                                                                *
   996*                            ELCLOGOF.                           *
   997*                            VMOD=2.001                          *
   998*                                                                *
   999*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1000*                                                                *
  1001******************************************************************
  1002 01  CLASIC-LOGOFF.
  1003     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1004     12  LOGOFF-TEXT.
  1005         16  FILLER          PIC X(5)    VALUE SPACES.
  1006         16  LOGOFF-MSG.
  1007             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1008             20  FILLER      PIC X       VALUE SPACES.
  1009             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1010         16  FILLER          PIC X(80)
  1011           VALUE '* YOU ARE NOW LOGGED OFF'.
  1012         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1013         16  FILLER          PIC X       VALUE QUOTE.
  1014         16  LOGOFF-SYS-MSG  PIC X(17)
  1015           VALUE 'S CLAS-IC SYSTEM '.
  1016     12  TEXT-MESSAGES.
  1017         16  UNACCESS-MSG    PIC X(29)
  1018             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1019         16  PGMIDERR-MSG    PIC X(17)
  1020             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  21
* EL156.cbl
  1022*    COPY ELCCALC.
  1023******************************************************************
  1024*                                                                *
  1025*                           ELCCALC.                            *
  1026*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1027*                            VMOD=2.025                          *
  1028*                                                                *
  1029*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1030*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1031*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1032*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  1033*                                                                *
  1034*  PASSED TO ELRTRM                                              *
  1035*  -----------------                                             *
  1036*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  1037*  ORIGINAL TERM                                                 *
  1038*  BEGINNING DATE                                                *
  1039*  ENDING DATE                                                   *
  1040*  COMPANY I.D.                                                  *
  1041*  ACCOUNT MASTER USER FIELD                                     *
  1042*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  1043*  FREE LOOK DAYS                                                *
  1044*                                                                *
  1045*  RETURNED FROM ELRTRM                                          *
  1046*  ---------------------                                         *
  1047*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  1048*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  1049*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  1050*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  1051*----------------------------------------------------------------*
  1052*  PASSED TO ELRAMT                                              *
  1053*  ----------------                                              *
  1054*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  1055*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1056*  ORIGINAL AMOUNT                                               *
  1057*  ALTERNATE BENEFIT (BALLON)                                    *
  1058*  A.P.R. - NET PAY ONLY                                         *
  1059*  METHOD
  1060*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  1061*  COMPANY I.D.                                                  *
  1062*  BENEFIT TYPE                                                  *
  1063*                                                                *
  1064*  RETURNED FROM ELRAMT                                          *
  1065*  --------------------                                          *
  1066*  REMAINING AMOUNT 1 - CURRENT                                  *
  1067*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  1068*  REMAINING AMOUNT FACTOR
  1069*----------------------------------------------------------------*
  1070*  PASSED TO ELRESV                                              *
  1071*  -----------------                                             *
  1072*  CERTIFICATE EFFECTIVE DATE                                    *
  1073*  VALUATION DATE                                                *
  1074*  PAID THRU DATE                                                *
  1075*  BENEFIT                                                       *
  1076*  INCURRED DATE                                                 *
  1077*  REPORTED DATE                                                 *
  1078*  ISSUE AGE                                                     *
  1079*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  22
* EL156.cbl
  1080*  CDT PERCENT                                                   *
  1081*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  1082* *CLAIM TYPE (LIFE, A/H)                                        *
  1083* *REMAINING BENEFIT (FROM ELRAMT)                               *
  1084* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  1085*                                                                *
  1086*  RETURNED FROM ELRESV                                          *
  1087*  --------------------                                          *
  1088*  CDT TABLE USED                                                *
  1089*  CDT FACTOR USED                                               *
  1090*  PAY TO CURRENT RESERVE                                        *
  1091*  I.B.N.R. - A/H ONLY                                           *
  1092*  FUTURE (ACCRUED) AH ONLY                                      *
  1093*----------------------------------------------------------------*
  1094*  PASSED TO ELRATE                                              *
  1095*  ----------------                                              *
  1096*  CERT ISSUE DATE                                               *
  1097*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1098*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1099*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  1100*  STATE CODE (CLIENT DEFINED)                                   *
  1101*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1102*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1103*  DEVIATION CODE                                                *
  1104*  ISSUE AGE                                                     *
  1105*  ORIGINAL BENEFIT AMOUNT                                       *
  1106*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1107*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  1108*  BENEFIT KIND (LIFE OR A/H)                                    *
  1109*  A.P.R.                                                        *
  1110*  METHOD
  1111*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1112*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1113*  COMPANY I.D. (3 CHARACTER)                                    *
  1114*  BENEFIT CODE                                                  *
  1115*  BENEFIT OVERRIDE CODE                                         *
  1116*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  1117*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  1118*  JOINT INDICATOR (CSL ONLY)                                    *
  1119*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  1120*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  1121*                                                                *
  1122*  RETURNED FROM ELRATE                                          *
  1123*  --------------------                                          *
  1124*  CALCULATED PREMIUM                                            *
  1125*  PREMIUM RATE                                                  *
  1126*  MORTALITY CODE                                                *
  1127*  MAX ATTAINED AGE                                              *
  1128*  MAX AGE                                                       *
  1129*  MAX TERM                                                      *
  1130*  MAX MONTHLY BENEFIT                                           *
  1131*  MAX TOTAL BENIFIT                                             *
  1132*  COMPOSITE RATE (OPEN-END ONLY)                                *
  1133*----------------------------------------------------------------*
  1134*  PASSED TO ELRFND                                              *
  1135*  ----------------                                              *
  1136*  CERT ISSUE DATE                                               *
  1137*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  23
* EL156.cbl
  1138*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1139*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1140*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1141*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1142*  STATE CODE (CLIENT DEFINED)                                   *
  1143*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1144*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1145*  DEVIATION CODE                                                *
  1146*  ISSUE AGE                                                     *
  1147*  ORIGINAL BENEFIT AMOUNT                                       *
  1148*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1149*  PROCESS TYPE (CANCEL)                                         *
  1150*  BENEFIT KIND (LIFE OR A/H)                                    *
  1151*  A.P.R.                                                        *
  1152*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  1153*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  1154*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1155*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1156*  COMPANY I.D. (3 CHARACTER)                                    *
  1157*  BENEFIT CODE                                                  *
  1158*  BENEFIT OVERRIDE CODE                                         *
  1159*                                                                *
  1160*  RETURNED FROM ELRFND                                          *
  1161*  --------------------                                          *
  1162*  CALCULATED REFUND                                             *
  1163*----------------------------------------------------------------*
  1164*  PASSED TO ELEARN                                              *
  1165*  ----------------                                              *
  1166*  CERT ISSUE DATE                                               *
  1167*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1168*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1169*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1170*  STATE CODE (CLIENT DEFINED)                                   *
  1171*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1172*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1173*  DEVIATION CODE                                                *
  1174*  ISSUE AGE                                                     *
  1175*  ORIGINAL BENEFIT AMOUNT                                       *
  1176*  BENEFIT KIND (LIFE OR A/H)                                    *
  1177*  A.P.R.                                                        *
  1178*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  1179*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1180*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1181*  COMPANY I.D. (3 CHARACTER)                                    *
  1182*  BENEFIT CODE                                                  *
  1183*  BENEFIT OVERRIDE CODE                                         *
  1184*                                                                *
  1185*  RETURNED FROM ELEARN                                          *
  1186*  --------------------                                          *
  1187*  INDICATED  EARNINGS                                           *
  1188*----------------------------------------------------------------*
  1189*                 LENGTH = 450                                   *
  1190*                                                                *
  1191******************************************************************
  1192******************************************************************
  1193*                   C H A N G E   L O G
  1194*
  1195* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  24
* EL156.cbl
  1196*-----------------------------------------------------------------
  1197*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1198* EFFECTIVE    NUMBER
  1199*-----------------------------------------------------------------
  1200* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1201* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1202* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1203* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1204* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1205* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1206* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1207******************************************************************
  1208
  1209 01  CALCULATION-PASS-AREA.
  1210     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  1211                                     COMP.
  1212
  1213     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  1214       88  NO-CP-ERROR                             VALUE ZERO.
  1215       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  1216                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  1217       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  1218       88  CP-ERROR-IN-DATES                       VALUE '2'.
  1219       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  1220       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  1221       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  1222       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  1223       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  1224       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  1225       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  1226       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  1227       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  1228       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  1229       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  1230       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  1231       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  1232       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  1233       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  1234
  1235     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  1236       88  NO-CP-ERROR-2                           VALUE ZERO.
  1237***********************  INPUT AREAS ****************************
  1238
  1239     12  CP-CALCULATION-AREA.
  1240         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  1241         16  CP-CERT-EFF-DT        PIC XX.
  1242         16  CP-VALUATION-DT       PIC XX.
  1243         16  CP-PAID-THRU-DT       PIC XX.
  1244         16  CP-BENEFIT-TYPE       PIC X.
  1245           88  CP-AH                               VALUE 'A' 'D'
  1246                                                   'I' 'U'.
  1247           88  CP-REDUCING-LIFE                    VALUE 'R'.
  1248           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  1249         16  CP-INCURRED-DT        PIC XX.
  1250         16  CP-REPORTED-DT        PIC XX.
  1251         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  1252         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  1253         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  25
* EL156.cbl
  1254                                     COMP-3.
  1255         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  1256                                     COMP-3.
  1257         16  CP-CDT-METHOD         PIC X.
  1258           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  1259           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  1260           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  1261         16  CP-CLAIM-TYPE         PIC X.
  1262           88  CP-AH-CLAIM                         VALUE 'A'.
  1263           88  CP-LIFE-CLAIM                       VALUE 'L'.
  1264         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  1265                                     COMP-3.
  1266         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  1267                                     COMP-3.
  1268         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  1269                                     COMP-3.
  1270         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  1271                                     COMP-3.
  1272         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1273                                     COMP-3.
  1274         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  1275                                     COMP-3.
  1276         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  1277                                     COMP-3.
  1278         16  CP-REM-TERM-METHOD    PIC X.
  1279           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  1280           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  1281           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  1282           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  1283           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  1284           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  1285           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  1286         16  CP-EARNING-METHOD     PIC X.
  1287           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  1288           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  1289           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  1290           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  1291           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  1292           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  1293           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  1294           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  1295           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  1296           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  1297           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1298           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1299         16  CP-PROCESS-TYPE       PIC X.
  1300           88  CP-CLAIM                            VALUE '1'.
  1301           88  CP-CANCEL                           VALUE '2'.
  1302           88  CP-ISSUE                            VALUE '3'.
  1303         16  CP-SPECIAL-CALC-CD    PIC X.
  1304           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  1305           88  CP-1-MTH-INTEREST               VALUE ' '.
  1306           88  CP-0-MTH-INTEREST               VALUE 'A'.
  1307           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  1308           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  1309           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  1310           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  1311           88  CP-FARM-PLAN                    VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  26
* EL156.cbl
  1312           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  1313           88  CP-2-MTH-INTEREST               VALUE 'I'.
  1314           88  CP-3-MTH-INTEREST               VALUE 'J'.
  1315           88  CP-4-MTH-INTEREST               VALUE 'K'.
  1316           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  1317           88  CP-MORTGAGE-REC                 VALUE 'M'.
  1318           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  1319           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  1320           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  1321           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  1322                                                     'W' 'X'.
  1323           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  1324           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  1325           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  1326           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  1327           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  1328           88  CP-SUMMARY-REC                  VALUE 'Z'.
  1329           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  1330           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  1331           88  CP-AD-D-BENEFIT                 VALUE '4'.
  1332           88  CP-CSL-METH-1                   VALUE '5'.
  1333           88  CP-CSL-METH-2                   VALUE '6'.
  1334           88  CP-CSL-METH-3                   VALUE '7'.
  1335           88  CP-CSL-METH-4                   VALUE '8'.
  1336
  1337         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  1338                                     COMP-3.
  1339         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  1340         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  1341         16  CP-STATE              PIC XX          VALUE SPACE.
  1342         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  1343         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  1344           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  1345               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  1346         16  CP-R78-OPTION         PIC X.
  1347           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  1348           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  1349
  1350         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  1351         16  CP-IBNR-RESERVE-SW    PIC X.
  1352         16  CP-CLAIM-STATUS       PIC X.
  1353         16  CP-RATE-FILE          PIC X.
  1354         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  1355                                     COMP-3.
  1356
  1357         16  CP-LIFE-OVERRIDE-CODE PIC X.
  1358         16  CP-AH-OVERRIDE-CODE   PIC X.
  1359
  1360         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  1361                                     COMP-3.
  1362         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  1363                                     COMP-3.
  1364         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1365                                     COMP-3.
  1366         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  1367                                     COMP-3.
  1368
  1369         16  CP-PAID-FROM-DATE     PIC X(02).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  27
* EL156.cbl
  1370         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  1371         16  CP-EXT-DAYS-CALC      PIC X.
  1372           88  CP-EXT-NO-CHG                   VALUE ' '.
  1373           88  CP-EXT-CHG-LF                   VALUE '1'.
  1374           88  CP-EXT-CHG-AH                   VALUE '2'.
  1375           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  1376         16  CP-DOMICILE-STATE     PIC XX.
  1377         16  CP-CARRIER            PIC X.
  1378         16  CP-REIN-FLAG          PIC X.
  1379         16  CP-REM-TRM-CALC-OPTION PIC X.
  1380           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  1381                      '2' '3' '4' '5'.
  1382           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  1383           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  1384           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  1385           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  1386           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  1387           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  1388           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  1389           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1390         16  CP-SIG-SWITCH         PIC X.
  1391         16  CP-RATING-METHOD      PIC X.
  1392           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  1393           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  1394           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  1395           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  1396           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  1397           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  1398           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  1399           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  1400           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  1401         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  1402                                     COMP-3.
  1403         16  CP-BEN-CATEGORY       PIC X.
  1404         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1405         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1406                                   PIC S99V9(5) COMP-3.
  1407         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1408         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1409                                   PIC S99V9(5) COMP-3.
  1410         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1411         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1412         16  CP-EXPIRE-DT          PIC XX.
  1413         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1414         16  FILLER                PIC X(35).
  1415*        16  FILLER                PIC X(50).
  1416
  1417***************    OUTPUT FROM ELRESV   ************************
  1418
  1419         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  1420
  1421         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  1422                                     COMP-3.
  1423         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  1424                                     COMP-3.
  1425         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  1426                                     COMP-3.
  1427         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  28
* EL156.cbl
  1428                                     COMP-3.
  1429         16  FILLER                PIC X(09).
  1430***************    OUTPUT FROM ELRTRM   *************************
  1431
  1432         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  1433                                     COMP-3.
  1434         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  1435                                     COMP-3.
  1436         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  1437                                     COMP-3.
  1438         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1439                                     COMP-3.
  1440         16  FILLER                PIC X(12).
  1441
  1442***************    OUTPUT FROM ELRAMT   *************************
  1443
  1444         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1445                                     COMP-3.
  1446         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1447                                     COMP-3.
  1448         16  FILLER                PIC X(12).
  1449
  1450***************    OUTPUT FROM ELRATE   *************************
  1451
  1452         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1453                                     COMP-3.
  1454         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1455                                     COMP-3.
  1456         16  CP-MORTALITY-CODE     PIC X(4).
  1457         16  CP-RATE-EDIT-FLAG     PIC X.
  1458             88  CP-RATES-NEED-APR                  VALUE '1'.
  1459         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1460                                     COMP-3.
  1461         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1462         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1463         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1464                                   PIC S9(7)V99 COMP-3.
  1465         16  FILLER                PIC X(07).
  1466
  1467***************    OUTPUT FROM ELRFND   *************************
  1468
  1469         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1470                                     COMP-3.
  1471         16  CP-REFUND-TYPE-USED   PIC X.
  1472           88  CP-R-AS-R78                         VALUE '1'.
  1473           88  CP-R-AS-PRORATA                     VALUE '2'.
  1474           88  CP-R-AS-CALIF                       VALUE '3'.
  1475           88  CP-R-AS-TEXAS                       VALUE '4'.
  1476           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1477           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1478           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1479           88  CP-R-AS-MEAN                        VALUE '8'.
  1480           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1481           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1482           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1483         16  FILLER                PIC X(12).
  1484
  1485***************    OUTPUT FROM ELEARN   *************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  29
* EL156.cbl
  1486
  1487         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1488                                     COMP-3.
  1489         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1490                                     COMP-3.
  1491         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1492                                     COMP-3.
  1493         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1494                                     COMP-3.
  1495         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1496                                     COMP-3.
  1497         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1498                                     COMP-3.
  1499         16  CP-EARNING-TYPE-USED  PIC X.
  1500           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1501           88  CP-E-AS-R78                         VALUE '1'.
  1502           88  CP-E-AS-PRORATA                     VALUE '2'.
  1503           88  CP-E-AS-TEXAS                       VALUE '4'.
  1504           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1505           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1506           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1507           88  CP-E-AS-MEAN                        VALUE '8'.
  1508           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1509         16  FILLER                PIC X(12).
  1510
  1511***************    OUTPUT FROM ELPMNT   *************************
  1512
  1513         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1514                                     COMP-3.
  1515         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1516                                     COMP-3.
  1517         16  FILLER                PIC X(12).
  1518
  1519***************   MISC WORK AREAS    *****************************
  1520         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1521                                     COMP-3.
  1522         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1523                                     COMP-3.
  1524         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1525                                     COMP-3.
  1526         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1527                                     COMP-3.
  1528         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1529                                     COMP-3.
  1530         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1531                                     COMP-3.
  1532         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1533             88  OPEN-RATE-FILE                   VALUE 'O'.
  1534             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1535             88  IO-ERROR                         VALUE 'E'.
  1536
  1537         16  CP-FIRST-PAY-DATE     PIC XX.
  1538
  1539         16  CP-JOINT-INDICATOR    PIC X.
  1540
  1541         16  CP-RESERVE-REMAINING-TERM
  1542                                   PIC S9(4)V9    VALUE ZERO
  1543                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  30
* EL156.cbl
  1544
  1545         16  CP-INSURED-BIRTH-DT   PIC XX.
  1546
  1547         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1548                                     COMP-3.
  1549
  1550         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1551                                     COMP-3.
  1552
  1553         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1554                                     COMP-3.
  1555
  1556         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1557                                     COMP-3.
  1558
  1559         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1560                                     COMP-3.
  1561
  1562         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1563                                     COMP-3.
  1564
  1565         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1566                                     COMP-3.
  1567
  1568         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1569             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1570
  1571         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1572                                     COMP-3.
  1573         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1574                                     COMP-3.
  1575         16  FILLER                PIC X(17).
  1576******************************************************************
  1577*    COPY ELCICALC.
  1578******************************************************************
  1579*                                                                *
  1580*                           ELCCICALC.                           *
  1581*                            VMOD=2.001                          *
  1582*                                                                *
  1583*   DESCRIPTION:  DATA TO BE PASSED TO THE CLAIM INTEREST        *
  1584*                 CALCULATION MODULE                             *
  1585*                                                                *
  1586*  PASSED TO ELCLMI                                              *
  1587*  -----------------                                             *
  1588*  STATE                                                         *
  1589*  PRODUCT                                                       *
  1590*  COVERAGE                                                      *
  1591*  EFFECTIVE DATE                                                *
  1592*  INCURRED DATE                                                 *
  1593*  ESTABLISHED DATE                                              *
  1594*  LAST PAID DATE                                                *
  1595*  REPORTED DATE                                                 *
  1596*  CLAIM PAYMENT AMOUNT                                          *
  1597*                                                                *
  1598*  RETURNED FROM ELRTRM                                          *
  1599*  ---------------------                                         *
  1600*  RETURN CODE                                                   *
  1601*  CLAIM INTEREST DUE SWITCH Y/N                                 *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  31
* EL156.cbl
  1602*  CLAIM INTEREST AMOUNT                                         *
  1603*----------------------------------------------------------------*
  1604*----------------------------------------------------------------*
  1605*                 LENGTH = 100                                   *
  1606*                                                                *
  1607******************************************************************
  1608******************************************************************
  1609*                   C H A N G E   L O G
  1610*
  1611* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1612*-----------------------------------------------------------------
  1613*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1614* EFFECTIVE    NUMBER
  1615*-----------------------------------------------------------------
  1616* 120905    2004040700004  PEMA  NEW COPYBOOK
  1617* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
  1618******************************************************************
  1619
  1620 01  CLAIM-INT-PASS-AREA.
  1621     12  CP-CLAIM-LENGTH           PIC S9(4)         VALUE +100
  1622                                     COMP.
  1623
  1624     12  CI-RETURN-CODE            PIC X             VALUE ZERO.
  1625       88  NO-CI-ERROR                             VALUE ZERO.
  1626       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'.
  1627       88  CP-ERROR-IN-SEL-CRITERIA                VALUE '1'.
  1628       88  CP-NOT-QUAL-LEVEL-1                     VALUE '2'.
  1629       88  CP-NOT-QUAL-LEVEL-2                     VALUE '3'.
  1630       88  CP-AMT-LT-5000                          VALUE '4'.
  1631       88  CP-ERROR-IN-DATES                       VALUE '5'.
  1632       88  CP-ERROR-IN-ST-BREAKOUT                 VALUE '6'.
  1633       88  CP-ERROR-IN-SCHEDULES                   VALUE '7'.
  1634       88  CP-INTEREST-RATE-IS-ZERO                VALUE '8'.
  1635***********************  INPUT AREAS ****************************
  1636
  1637     12  CP-CALCULATION-AREA.
  1638         16  CP-COMPANY-CD         PIC X.
  1639         16  CP-STATE              PIC XX.
  1640         16  CP-PRODUCT            PIC XX.
  1641         16  CP-COVERAGE           PIC XX.
  1642         16  CP-INC-DT             PIC XX.
  1643         16  CP-EST-DT             PIC XX.
  1644         16  CP-LSTPD-DT           PIC XX.
  1645         16  CP-RPT-DT             PIC XX.
  1646         16  CP-PRF-DT             PIC XX.
  1647         16  CP-EFF-DT             PIC XX.
  1648         16  CP-CLAIM-AMT          PIC S9(7)V99 COMP-3.
  1649         16  CP-INT-RATE           PIC S99V9(5) COMP-3.
  1650         16  FILLER                PIC X(37).
  1651
  1652***************    OUTPUT FROM ELCLMI   ************************
  1653
  1654         16  CP-CLM-INT-SW         PIC X         VALUE SPACES.
  1655
  1656         16  CP-CLM-INT-AMT        PIC S9(7)V99  VALUE +0 COMP-3.
  1657         16  CP-CLM-INT-RATE       PIC S99V9(5)  VALUE +0 COMP-3.
  1658         16  CP-CLM-INT-NODAYS     PIC S9(5)     VALUE +0 COMP-3.
  1659         16  FILLER                PIC X(19).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  32
* EL156.cbl
  1660******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  33
* EL156.cbl
  1662*    COPY ELCATTR.
  1663******************************************************************
  1664*                                                                *
  1665*                            ELCATTR.                            *
  1666*                            VMOD=2.001                          *
  1667*                                                                *
  1668*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1669*                                                                *
  1670*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1671*                                                                *
  1672*                   POS 1   P=PROTECTED                          *
  1673*                           U=UNPROTECTED                        *
  1674*                           S=ASKIP                              *
  1675*                   POS 2   A=ALPHA/NUMERIC                      *
  1676*                           N=NUMERIC                            *
  1677*                   POS 3   N=NORMAL                             *
  1678*                           B=BRIGHT                             *
  1679*                           D=DARK                               *
  1680*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1681*                           OF=MODIFIED DATA TAG OFF             *
  1682*                                                                *
  1683*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1684******************************************************************
  1685 01  ATTRIBUTE-LIST.
  1686     12  AL-PABOF            PIC X       VALUE 'Y'.
  1687     12  AL-PABON            PIC X       VALUE 'Z'.
  1688     12  AL-PADOF            PIC X       VALUE '%'.
  1689     12  AL-PADON            PIC X       VALUE '_'.
  1690     12  AL-PANOF            PIC X       VALUE '-'.
  1691     12  AL-PANON            PIC X       VALUE '/'.
  1692     12  AL-SABOF            PIC X       VALUE '8'.
  1693     12  AL-SABON            PIC X       VALUE '9'.
  1694     12  AL-SADOF            PIC X       VALUE '@'.
  1695     12  AL-SADON            PIC X       VALUE QUOTE.
  1696     12  AL-SANOF            PIC X       VALUE '0'.
  1697     12  AL-SANON            PIC X       VALUE '1'.
  1698     12  AL-UABOF            PIC X       VALUE 'H'.
  1699     12  AL-UABON            PIC X       VALUE 'I'.
  1700     12  AL-UADOF            PIC X       VALUE '<'.
  1701     12  AL-UADON            PIC X       VALUE '('.
  1702     12  AL-UANOF            PIC X       VALUE ' '.
  1703     12  AL-UANON            PIC X       VALUE 'A'.
  1704     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1705     12  AL-UNBON            PIC X       VALUE 'R'.
  1706     12  AL-UNDOF            PIC X       VALUE '*'.
  1707     12  AL-UNDON            PIC X       VALUE ')'.
  1708     12  AL-UNNOF            PIC X       VALUE '&'.
  1709     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  34
* EL156.cbl
  1711*    COPY ELCEMIB.
  1712******************************************************************
  1713*                                                                *
  1714*                                                                *
  1715*                            ELCEMIB.                            *
  1716*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1717*                            VMOD=2.005                          *
  1718*                                                                *
  1719*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1720*                                                                *
  1721******************************************************************
  1722 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1723     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1724     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1725     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1726     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1727     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1728     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1729     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1730     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1731     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1732         88  EMI-NO-ERRORS                    VALUE '1'.
  1733         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1734         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1735     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1736         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1737     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1738         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1739         88  EMI-AREA1-FULL                   VALUE '2'.
  1740     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1741         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1742         88  EMI-AREA2-FULL                   VALUE '2'.
  1743     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1744         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1745         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1746         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1747         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1748         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1749     12  EMI-ERROR-LINES.
  1750         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1751         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1752         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1753         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1754             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1755                 24  EMI-ERR-NUM         PIC X(4).
  1756                 24  EMI-FILLER          PIC X.
  1757                 24  EMI-SEV             PIC X.
  1758                 24  FILLER              PIC X.
  1759             20  FILLER                  PIC X(02).
  1760     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1761         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1762             20  EMI-ERROR-NUMBER    PIC X(4).
  1763             20  EMI-FILL            PIC X.
  1764             20  EMI-SEVERITY        PIC X.
  1765             20  FILLER              PIC X.
  1766             20  EMI-ERROR-TEXT.
  1767                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1768                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  35
* EL156.cbl
  1769     12  EMI-SEVERITY-SAVE           PIC X.
  1770         88  EMI-NOTE                    VALUE 'N'.
  1771         88  EMI-WARNING                 VALUE 'W'.
  1772         88  EMI-FORCABLE                VALUE 'F'.
  1773         88  EMI-FATAL                   VALUE 'X'.
  1774     12  EMI-MESSAGE-FLAG            PIC X.
  1775         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1776         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1777     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1778     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1779         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1780         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1781         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1782     12  FILLER                      PIC X(137)  VALUE SPACES.
  1783     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1784     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1785     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1786     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  36
* EL156.cbl
  1788*    COPY ELCLNKLT.
  1789******************************************************************
  1790*                                                                *
  1791*                                                                *
  1792*                           ELCLNKLT                             *
  1793*                            VMOD=2.003                          *
  1794*                                                                *
  1795*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
  1796*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
  1797*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
  1798*                                                                *
  1799*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
  1800*   COMPLETING THE REQUIRED FIELDS.                              *
  1801*                                                                *
  1802*   THE CALLING PROGRAM SHOULD CHECK:                            *
  1803*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
  1804*                              9999 INDICATES AN UNKNOWN ABEND   *
  1805*                                   WAS DETECTED.                *
  1806*                              ALL OTHER VALUES ARE NORMAL ERROR *
  1807*                              CODES FOUND IN THE ERROR FILE.    *
  1808******************************************************************
  1809 01  W-1523-LINKDATA.
  1810     12  W-1523-COMMON-PI-DATA.
  1811         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
  1812         16  FILLER              PIC  X(67).
  1813         16  W-1523-COMPANY-CD   PIC  X(01).
  1814         16  FILLER              PIC  X(10).
  1815         16  W-1523-CONTROL-IN-PROGRESS.
  1816             20  W-1523-CARRIER  PIC  X(01).
  1817             20  W-1523-GROUPING PIC  X(06).
  1818             20  W-1523-STATE    PIC  X(02).
  1819             20  W-1523-ACCOUNT  PIC  X(10).
  1820             20  W-1523-CLAIM-CERT-GRP.
  1821                 24  W-1523-CLAIM-NO
  1822                                 PIC  X(07).
  1823                 24  W-1523-CERT-NO.
  1824                     28  W-1523-CERT-PRIME
  1825                                 PIC  X(10).
  1826                     28  W-1523-CERT-SFX
  1827                                 PIC  X(01).
  1828                 24  W-1523-CERT-EFF-DT
  1829                                 PIC  X(02).
  1830         16  FILLER              PIC X(265).
  1831
  1832     12  W-1523-WORK-AREA.
  1833         16  W-1523-FORM-NUMBER  PIC  X(04).
  1834         16  W-1523-NUMBER-COPIES
  1835                                 PIC  9(01).
  1836         16  W-1523-ADDR-TYPE    PIC  X(02).
  1837         16  W-1523-FOLLOW-UP-DATE
  1838                                 PIC  X(02).
  1839         16  W-1523-RESEND-DATE  PIC  X(02).
  1840         16  W-1523-ERROR-CODE   PIC  9(04).
  1841             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
  1842             88  W-1523-FATAL-ERROR
  1843                                    VALUES  0006 0013 0042
  1844                                            0154 0168 0169
  1845                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  37
* EL156.cbl
  1846                                            0179 0186 0281
  1847                                            0332 2055 3697
  1848                                            3698 3699 3770
  1849                                            3771 3772 7675
  1850                                            9106 9808 9883
  1851                                            9887.
  1852             88  W-1523-STOP-ERRORS
  1853                                    VALUES  0013 0042 0154
  1854                                            0168 0169 0172
  1855                                            0281 0332 2055
  1856                                            3698 3699 7675
  1857                                            9106 9808 9883
  1858                                            9999.
  1859         16  W-1523-REASON       PIC  X(70).
  1860         16  W-1523-ARCHIVE-NUMBER
  1861                                 PIC  9(08).
  1862     12  W-1523-POINTER-AREA.
  1863         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
  1864         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
  1865         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
  1866         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
  1867         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  38
* EL156.cbl
  1869*    COPY ELCNWA.
  1870*****************************************************************
  1871*                                                               *
  1872*                                                               *
  1873*                            ELCNWA.                            *
  1874*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1875*                            VMOD=2.003                         *
  1876*                                                               *
  1877*            M O V E   N A M E   W O R K   A R E A.             *
  1878*                                                               *
  1879*****************************************************************.
  1880
  1881 01  WS-NAME-WORK-AREA.
  1882     05  WS-INSURED-LAST-NAME        PIC X(15).
  1883     05  WS-INSURED-1ST-NAME         PIC X(12).
  1884     05  WS-INSURED-MID-INIT         PIC X.
  1885
  1886     05  WS-NAME-WORK.
  1887         10  WS-NW                   PIC X
  1888             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  1889
  1890     05  WS-NAME-WORK2.
  1891         10  WS-NW2                  PIC X
  1892             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  1893                                        NWA-INDEX0.
  1894
  1895     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  1896                                     COMP-3.
  1897
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  39
* EL156.cbl
  1899*    COPY ELCDMO.
  1900******************************************************************
  1901*                                                                *
  1902*                                                                *
  1903*                            ELCDMO.                             *
  1904*                            VMOD=2.004                          *
  1905*                                                                *
  1906*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  1907*        COMMUNICATION AREA                                      *
  1908*   FILE TYPE = NA                                               *
  1909*   RECORD SIZE = 110    RECFORM = FIXED                         *
  1910*                                                                *
  1911******************************************************************
  1912 01  DMO-COMMUNICATION-AREA.
  1913     12  DM-RECORD-TYPE                  PIC  X(02).
  1914             88  DM-ISSUE-TRAN                VALUE 'CC'.
  1915             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  1916             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  1917     12  DM-DIST-CODE                    PIC  X(04).
  1918     12  DM-MAIL-CODE                    PIC  X(05).
  1919     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  1920     12  DM-INSURED-NAME                 PIC  X(30).
  1921     12  DM-CLAIM-NO                     PIC  X(07).
  1922     12  DM-CLAIM-TYPE                   PIC  X.
  1923
  1924     12  DM-STATUS-DATA-AREA.
  1925         16  DM-CLAIM-STATUS             PIC  X.
  1926             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  1927             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  1928             88  DM-CLOSED                        VALUE '3'.
  1929             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  1930             88  DM-DEFAULT                       VALUE '9'.
  1931         16  DM-STATUS-DATE              PIC  X(08).
  1932******YYYYMMDD
  1933         16  DM-STAT-CHANGE-TYPE         PIC  X.
  1934             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  1935             88  DM-CLAIM-DENIED                  VALUE 'D'.
  1936             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  1937             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  1938             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  1939             88  DM-RE-OPENED                     VALUE 'R'.
  1940             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  1941             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  1942             88  DM-CLAIM-DELETED                 VALUE 'X'.
  1943         16  DM-STAT-CARRIER             PIC X.
  1944
  1945     12  DM-DRAFT-DATA-AREA.
  1946         16  DM-PAYMENT-TYPE             PIC  X.
  1947             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  1948         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  1949         16  DM-PAYMENT-DATE             PIC  X(08).
  1950******YYYYMMDD
  1951         16  DM-CERT-NO                  PIC  X(11).
  1952         16  DM-TRLR-SEQ-NO              PIC  9(04).
  1953         16  DM-CARRIER                  PIC  X.
  1954
  1955     12  DM-RETURN-CODE                  PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  40
* EL156.cbl
  1957*    COPY ELCDMDCD.
  1958******************************************************************
  1959*                                                                *
  1960*                                                                *
  1961*                            ELCDMDCD.                           *
  1962*                            VMOD=2.001                          *
  1963*                                                                *
  1964*   DESCRIPTION = CODES VALIDATION PROGRAM (DLO023)              *
  1965*       COMMUNICATIONS AREA                                      *
  1966*                                                                *
  1967******************************************************************
  1968 01  CD-COMMUNICATION-AREA.
  1969     12  CD-SYSTEM-ID            PIC  X(02).
  1970         88 CD-CLAIMS                      VALUE 'CL'.
  1971         88 CD-CREDIT                      VALUE 'CR'.
  1972     12  CD-RECORD-TYPE          PIC  X(02).
  1973         88 CD-DENIAL-CODE                 VALUE 'DN'.
  1974         88 CD-EOB-CODE                    VALUE 'EO'.
  1975         88 CD-ICD9-CODE                   VALUE 'I9'.
  1976         88 CD-OCCUPATION-CODE             VALUE 'OC'.
  1977         88 CD-PAYMENT-NOT-CODE            VALUE 'PN'.
  1978         88 CD-CAUSE-CODE                  VALUE 'CS'.
  1979         88 CD-COVERAGE-CAT-CODE           VALUE 'CV'.
  1980         88 CD-RESIDENT-STATE-CODE         VALUE 'RS'.
  1981     12  CD-RECORD-KEY           PIC  X(06).
  1982         88 CD-SUCCESSFUL                  VALUE 'OK'.
  1983     12  CD-RETURN-CODE          PIC  X(02).
  1984     12  CD-CODE-DESCRIPTION     PIC  X(60).
  1985     12  CD-GENERAL-DESCRIPTION1 PIC  X(20).
  1986     12  CD-GENERAL-DESCRIPTION2 PIC  X(20).
  1987     12  CD-GENERAL-DESCRIPTION3 PIC  X(20).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  41
* EL156.cbl
  1989*    COPY ELCDCTB.
  1990******************************************************************
  1991*                                                                *
  1992*                                                                *
  1993*                            ELCDCTB.                            *
  1994*                            VMOD=2.002                          *
  1995*                                                                *
  1996*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
  1997*       COMMUNICATIONS AREA                                      *
  1998*                                                                *
  1999******************************************************************
  2000 01  DCT-COMMUNICATION-AREA.
  2001     12  DCT-BILLING-BANK-ID      PIC  X(05).
  2002     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
  2003     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
  2004     12  DCT-PRODUCT-CODE         PIC  X(02).
  2005     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
  2006     12  DCT-RETURN-CODE          PIC  X(02).
  2007     12  DCT-MAIL-CODE            PIC  X(05).
  2008     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
  2009     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  42
* EL156.cbl
  2011 01  CD-RCRD-LENGTH                  PIC S9(4)  COMP VALUE +132.
  2012 01  DCT-RCRD-LENGTH                 PIC S9(4)  COMP VALUE +53.
  2013 01  DM-DMO-LENGTH                   PIC S9(4)  COMP VALUE +108.
  2014 01  DL35-LENGTH                     PIC S9(4)  COMP VALUE +34.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  43
* EL156.cbl
  2016*    COPY ELCINTF.
  2017******************************************************************
  2018*                                                                *
  2019*                                                                *
  2020*                            ELCINTF.                            *
  2021*                            VMOD=2.017                          *
  2022*                                                                *
  2023*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2024*                                                                *
  2025*       LENGTH = 1024                                            *
  2026*                                                                *
  2027******************************************************************
  2028 01  PROGRAM-INTERFACE-BLOCK.
  2029     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2030     12  PI-CALLING-PROGRAM              PIC X(8).
  2031     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2032     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2033     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2034     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2035     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2036     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2037     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2038     12  PI-COMPANY-ID                   PIC XXX.
  2039     12  PI-COMPANY-CD                   PIC X.
  2040
  2041     12  PI-COMPANY-PASSWORD             PIC X(8).
  2042
  2043     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2044
  2045     12  PI-CONTROL-IN-PROGRESS.
  2046         16  PI-CARRIER                  PIC X.
  2047         16  PI-GROUPING                 PIC X(6).
  2048         16  PI-STATE                    PIC XX.
  2049         16  PI-ACCOUNT                  PIC X(10).
  2050         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2051                                         PIC X(10).
  2052         16  PI-CLAIM-CERT-GRP.
  2053             20  PI-CLAIM-NO             PIC X(7).
  2054             20  PI-CERT-NO.
  2055                 25  PI-CERT-PRIME       PIC X(10).
  2056                 25  PI-CERT-SFX         PIC X.
  2057             20  PI-CERT-EFF-DT          PIC XX.
  2058         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2059             20  PI-PLAN-CODE            PIC X(2).
  2060             20  PI-REVISION-NUMBER      PIC X(3).
  2061             20  PI-PLAN-EFF-DT          PIC X(2).
  2062             20  PI-PLAN-EXP-DT          PIC X(2).
  2063             20  FILLER                  PIC X(11).
  2064         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  2065             20  PI-OE-REFERENCE-1.
  2066                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2067                 25  PI-OE-REF-1-SUFF    PIC XX.
  2068
  2069     12  PI-SESSION-IN-PROGRESS          PIC X.
  2070         88  CLAIM-SESSION                   VALUE '1'.
  2071         88  CREDIT-SESSION                  VALUE '2'.
  2072         88  WARRANTY-SESSION                VALUE '3'.
  2073         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  44
* EL156.cbl
  2074         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2075
  2076
  2077*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2078
  2079     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2080     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2081
  2082     12  PI-CREDIT-USER                  PIC X.
  2083         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2084         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2085
  2086     12  PI-CLAIM-USER                   PIC X.
  2087         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2088         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2089
  2090     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2091         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2092         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2093         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2094         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2095         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2096
  2097     12  PI-PROCESSOR-ID                 PIC X(4).
  2098
  2099     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2100
  2101     12  PI-MEMBER-CAPTION               PIC X(10).
  2102
  2103     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2104         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2105
  2106     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2107     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2108     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2109     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2110
  2111     12  PI-AH-OVERRIDE-L1               PIC X.
  2112     12  PI-AH-OVERRIDE-L2               PIC XX.
  2113     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2114     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2115
  2116     12  PI-NEW-SYSTEM                   PIC X(2).
  2117
  2118     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2119     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2120         88  PI-USES-PAID-TO                 VALUE '1'.
  2121     12  PI-CRDTCRD-SYSTEM.
  2122         16  PI-CRDTCRD-USER             PIC X.
  2123             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2124             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2125         16  PI-CC-MONTH-END-DT          PIC XX.
  2126     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2127
  2128     12  PI-OE-REFERENCE-2.
  2129         16  PI-OE-REF-2-PRIME           PIC X(10).
  2130         16  PI-OE-REF-2-SUFF            PIC X.
  2131
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  45
* EL156.cbl
  2132     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2133
  2134     12  PI-LANGUAGE-TYPE                PIC X.
  2135             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2136             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2137             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2138
  2139     12  PI-POLICY-LINKAGE-IND           PIC X.
  2140         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2141         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2142                                                   LOW-VALUES.
  2143
  2144     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2145     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2146         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2147         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2148     12  FILLER                          PIC X(4).
  2149
  2150     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2151
  2152     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2153         PI-SYSTEM-LEVEL.
  2154
  2155         16  PI-ENTRY-CODES.
  2156             20  PI-ENTRY-CD-1           PIC X.
  2157             20  PI-ENTRY-CD-2           PIC X.
  2158
  2159         16  PI-RETURN-CODES.
  2160             20  PI-RETURN-CD-1          PIC X.
  2161             20  PI-RETURN-CD-2          PIC X.
  2162
  2163         16  PI-UPDATE-STATUS-SAVE.
  2164             20  PI-UPDATE-BY            PIC X(4).
  2165             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2166
  2167         16  PI-LOWER-CASE-LETTERS       PIC X.
  2168             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2169
  2170*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2171*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2172*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2173
  2174         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2175             88  ST-ACCNT-CNTL               VALUE ' '.
  2176             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2177             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2178             88  ACCNT-CNTL                  VALUE '3'.
  2179             88  CARR-ACCNT-CNTL             VALUE '4'.
  2180
  2181         16  PI-PROCESSOR-CAP-LIST.
  2182             20  PI-SYSTEM-CONTROLS.
  2183                24 PI-SYSTEM-DISPLAY     PIC X.
  2184                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2185                24 PI-SYSTEM-MODIFY      PIC X.
  2186                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2187             20  FILLER                  PIC XX.
  2188             20  PI-DISPLAY-CAP          PIC X.
  2189                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  46
* EL156.cbl
  2190             20  PI-MODIFY-CAP           PIC X.
  2191                 88  MODIFY-CAP              VALUE 'Y'.
  2192             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2193                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2194             20  PI-FORCE-CAP            PIC X.
  2195                 88  FORCE-CAP               VALUE 'Y'.
  2196
  2197         16  PI-PROGRAM-CONTROLS.
  2198             20  PI-PGM-PRINT-OPT        PIC X.
  2199             20  PI-PGM-FORMAT-OPT       PIC X.
  2200             20  PI-PGM-PROCESS-OPT      PIC X.
  2201             20  PI-PGM-TOTALS-OPT       PIC X.
  2202
  2203         16  PI-HELP-INTERFACE.
  2204             20  PI-LAST-ERROR-NO        PIC X(4).
  2205             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2206
  2207         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2208             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2209
  2210         16  PI-CR-CONTROL-IN-PROGRESS.
  2211             20  PI-CR-CARRIER           PIC X.
  2212             20  PI-CR-GROUPING          PIC X(6).
  2213             20  PI-CR-STATE             PIC XX.
  2214             20  PI-CR-ACCOUNT           PIC X(10).
  2215             20  PI-CR-FIN-RESP          PIC X(10).
  2216             20  PI-CR-TYPE              PIC X.
  2217
  2218         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2219
  2220         16  PI-CR-MONTH-END-DT          PIC XX.
  2221
  2222         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2223             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2224             88  PI-ZERO-CARRIER             VALUE '1'.
  2225             88  PI-ZERO-GROUPING            VALUE '2'.
  2226             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2227
  2228         16  PI-CARRIER-SECURITY         PIC X.
  2229             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2230
  2231         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2232             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2233             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  2234
  2235         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2236             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2237                                         INDEXED BY PI-ACCESS-NDX
  2238                                         PIC X.
  2239
  2240         16  PI-GA-BILLING-CONTROL       PIC X.
  2241             88  PI-GA-BILLING               VALUE '1'.
  2242
  2243         16  PI-MAIL-PROCESSING          PIC X.
  2244             88  PI-MAIL-YES                 VALUE 'Y'.
  2245
  2246         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2247
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  47
* EL156.cbl
  2248         16  PI-AR-SYSTEM.
  2249             20  PI-AR-PROCESSING-CNTL   PIC X.
  2250                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2251             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2252             20  PI-AR-MONTH-END-DT      PIC XX.
  2253
  2254         16  PI-MP-SYSTEM.
  2255             20  PI-MORTGAGE-USER            PIC X.
  2256                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2257                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2258             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2259                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2260                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2261                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2262                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2263                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2264             20  PI-MP-MONTH-END-DT          PIC XX.
  2265             20  PI-MP-REFERENCE-NO.
  2266                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2267                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2268
  2269         16  PI-LABEL-CONTROL            PIC X(01).
  2270             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2271             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2272
  2273         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2274             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2275
  2276         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2277             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2278             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2279
  2280         16  FILLER                      PIC X(14).
  2281
  2282     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2283******************************************************************
  2284     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  2285         16  PI-SAVE-FORM        PIC X(12).
  2286         16  PI-ACCT-KEY         PIC X(26).
  2287         16  PI-PAYEE-NAME       PIC X(30).
  2288         16  PI-DAILY-RATE       PIC S9(3)V99.
  2289         16  PI-MONTH-END-SAVE   PIC XX.
  2290         16  PI-BENEFIT-SAVE.
  2291             20  PI-BEN-DAYS     PIC 99.
  2292             20  PI-BEN-TYPE     PIC X.
  2293         16  PI-MANUAL-SW        PIC 9.
  2294         16  PI-SAVE-CURSOR      PIC S9(4) COMP.
  2295         16  PI-PASS-SW          PIC X.
  2296         16  PI-PFKEY-USED       PIC X.
  2297         16  PI-CK-ASSIGN        PIC X.
  2298         16  PI-FATAL-COUNT      PIC 99.
  2299         16  PI-FORCE-COUNT      PIC 99.
  2300         16  PI-SAVE-INPUT.
  2301             20  PI-PMTTYPE      PIC X.
  2302             20  PI-PAYEE.
  2303                 24  PI-PAYEE-TYPE PIC X.
  2304                 24  PI-PAYEE-SEQ  PIC X.
  2305                 24  PI-PAYEE-SEQ-NUM REDEFINES
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  48
* EL156.cbl
  2306                   PI-PAYEE-SEQ    PIC S9.
  2307             20  PI-PMTNOTE1     PIC X(60).
  2308             20  PI-PMTNOTE2     PIC X(60).
  2309             20  PI-OFFLINE      PIC X.
  2310             20  PI-ECHECKNO     PIC X(7).
  2311             20  PI-ECHECKNO-RDF REDEFINES PI-ECHECKNO.
  2312                 28  PI-ECHECKNO-N     PIC X.
  2313                 28  PI-ECHECKNO-6     PIC X(6).
  2314             20  PI-ECHECKNO-RDF1 REDEFINES PI-ECHECKNO.
  2315                 24  PI-ECHECKNO-CR    PIC XX.
  2316                 24  PI-ECHECKNO-5     PIC X(5).
  2317             20  PI-HOLDTIL      PIC 9(6).
  2318             20  PI-EPYFROM      PIC 9(6).
  2319             20  PI-EPYTHRU      PIC 9(6).
  2320             20  PI-EDAYS        PIC S9(5).
  2321             20  PI-EPYAMT       PIC S9(7)V99.
  2322             20  PI-ERESV        PIC S9(7)V99.
  2323             20  PI-EEXPENS      PIC 9(6)V99.
  2324             20  PI-ETYPE        PIC X.
  2325             20  PI-CASH         PIC X.
  2326             20  PI-GROUPED      PIC X.
  2327             20  PI-INT-RATE     PIC S99V9(5).
  2328             20  PI-AIGFROM      PIC 9(6).
  2329             20  PI-LOAN-NO      PIC X(20).
  2330             20  PI-PROOF-DATE   PIC 9(6).
  2331             20  PI-PRINT-EOB-YN PIC X.
  2332         16  PI-SAVE-COMPUTED.
  2333             20  PI-CCHECKNO     PIC X(7).
  2334             20  PI-CCHECKNO-RDF REDEFINES PI-CCHECKNO.
  2335                 28  PI-CCHECKNO-N     PIC X.
  2336                 28  PI-CCHECKNO-6     PIC X(6).
  2337             20  PI-CCHECKNO-RDF1 REDEFINES PI-CCHECKNO.
  2338                 24  PI-CCHECKNO-CR    PIC XX.
  2339                 24  PI-CCHECKNO-5     PIC X(5).
  2340             20  PI-CPYFROM      PIC XX.
  2341             20  PI-CPYTHRU      PIC XX.
  2342             20  PI-CDAYS        PIC S9(5).
  2343             20  PI-CPYAMT       PIC S9(7)V99.
  2344             20  PI-CRESV        PIC 9(6)V99.
  2345             20  PI-CEXPENS      PIC 9(6)V99.
  2346             20  PI-PMT-APPR-SW  PIC X.
  2347                 88 PI-PMT-APPROVED    VALUE 'G' 'Y'.
  2348                 88 PI-PMT-GRADUATED   VALUE 'G'.
  2349                 88 PI-PMT-NO-APPROVAL VALUE ' ' 'N'.
  2350         16  PI-PREV-CLMNO       PIC X(7).
  2351         16  PI-LF-COVERAGE-TYPE PIC X.
  2352         16  PI-MAX-PMT-TOL      PIC S9(7)V99  COMP-3.
  2353         16  PI-MAX-LF-PMT-TOL   PIC S9(7)V99  COMP-3.
  2354         16  PI-PROVISIONAL-IND  PIC X.
  2355             88 PI-PROV-PMT      VALUE 'P'.
  2356         16  PI-PREV-TRLR-KEY    PIC X(22).
  2357         16  PI-SPLIT-PMT-SW     PIC X.
  2358         16  PI-MAX-EXP-PMT      PIC S9(7)V99 COMP-3.
  2359         16  PI-ACTIVITY-CODE    PIC 99.
  2360         16  PI-RESET-SW         PIC X.
  2361         16  PI-SPECIAL-BEN-SW   PIC X.
  2362             88 PI-AIG-SPECIAL-BENEFIT VALUE 'Y'.
  2363         16  PI-REDUND-PMTAMT    PIC S9(7)V99.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  49
* EL156.cbl
  2364         16  PI-EXP-DT           PIC XX.
  2365         16  PI-LOAN-DUE-DAY     PIC 99.
  2366         16  PI-3RD-PARTY-SW     PIC X.
  2367         16  PI-LOAN-UPDATE-SW   PIC X.
  2368
  2369         16  PI-DMD-DATA.
  2370             20  PI-SV-CERT-KEY       PIC X(21).
  2371             20  PI-SV-CERT-NO        PIC X(11).
  2372             20  PI-SV-BEN            PIC X(10).
  2373             20  PI-SV-CCN            PIC X(16).
  2374             20  PI-INTEREST-PAID-IND PIC X.
  2375                 88  PI-INTEREST-PAID  VALUE 'Y'.
  2376             20  PI-MAX-BENEFIT-AMT   PIC S9(5)V99 COMP-3.
  2377             20  PI-MAX-BENEFIT-PYMT  PIC S9(5)V99 COMP-3.
  2378             20  PI-MIN-PAYMENT-AMT   PIC S9(5)V99 COMP-3.
  2379             20  PI-TIME-OF-LOSS-BAL  PIC S9(5)V99 COMP-3.
  2380         16  PI-AT-EOB-CODES.
  2381             20 PI-AT-EOB-CODE        PIC XXX   OCCURS 5.
  2382         16  PI-INT-AMT               PIC S9(5)V99 COMP-3.
  2383         16  PI-INT-DAYS              PIC S9(5) COMP-3.
  2384         16  PI-INT-RATE-USED         PIC S99V9(5) COMP-3.
  2385         16  PI-SAVE-ELAPSED-MONTHS   PIC 9(03).
  2386         16  PI-SAVE-ODD-DAYS-OVER    PIC S9(04).
  2387         16  PI-CHECK-STATE-FOR-AK    PIC X(02).
  2388         16  PI-ORIG-BEN-AMT          PIC S9(7)V99 COMP-3.
  2389         16  PI-REM-BEN-AMT           PIC S9(7)V99 COMP-3.
  2390         16  PI-MO-BEN-AMT            PIC S9(7)V99 COMP-3.
  2391         16  PI-LF-BENEFIT-CD         PIC X(2).
  2392         16  PI-EOB-CODES-EXIST PIC X.
  2393         16  PI-SET-NOTE2-MDT   PIC X.
  2394*00781          16  FILLER                   PIC X(176).
  2395*052506         16  FILLER                   PIC X(161).
  2396*031808         16  FILLER                   PIC X(154).
  2397*091808         16  FILLER                   PIC X(152).
  2398         16  FILLER                   PIC X(94).
  2399
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  50
* EL156.cbl
  2401*    COPY ELCJPFX.
  2402******************************************************************
  2403*                                                                *
  2404*                                                                *
  2405*                            ELCJPFX.                            *
  2406*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2407*                            VMOD=2.002                          *
  2408*                                                                *
  2409*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2410*                                                                *
  2411*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2412*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2413*        ELCNTL - CONTROL FILE                                   *
  2414*        ELMSTR - CLAIM MASTERS                                  *
  2415*        ELTRLR - ACTIVITY TRAILERS                              *
  2416*        ELCHKQ - CHECK QUE                                      *
  2417******************************************************************
  2418 01  JOURNAL-RECORD.
  2419     12  JP-USER-ID                  PIC X(4).
  2420     12  JP-FILE-ID                  PIC X(8).
  2421     12  JP-PROGRAM-ID               PIC X(8).
  2422     12  JP-RECORD-TYPE              PIC X.
  2423         88 JP-ADD              VALUE 'A'.
  2424         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2425         88 JP-AFTER-CHANGE     VALUE 'C'.
  2426         88 JP-DELETE           VALUE 'D'.
  2427         88 JP-GENERIC-DELETE   VALUE 'G'.
  2428         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2429         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2430     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2431     12  JP-RECORD-AREA
  2432
  2433
  2434                             PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  51
* EL156.cbl
  2436*    COPY ELCAID.
  2437******************************************************************
  2438*                                                                *
  2439*                            ELCAID.                             *
  2440*                            VMOD=2.001                          *
  2441*                                                                *
  2442*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2443*                                                                *
  2444*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2445*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2446******************************************************************
  2447
  2448 01  DFHAID.
  2449   02  DFHNULL   PIC  X  VALUE  ' '.
  2450   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2451   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2452   02  DFHPEN    PIC  X  VALUE  '='.
  2453   02  DFHOPID   PIC  X  VALUE  'W'.
  2454   02  DFHPA1    PIC  X  VALUE  '%'.
  2455   02  DFHPA2    PIC  X  VALUE  '>'.
  2456   02  DFHPA3    PIC  X  VALUE  ','.
  2457   02  DFHPF1    PIC  X  VALUE  '1'.
  2458   02  DFHPF2    PIC  X  VALUE  '2'.
  2459   02  DFHPF3    PIC  X  VALUE  '3'.
  2460   02  DFHPF4    PIC  X  VALUE  '4'.
  2461   02  DFHPF5    PIC  X  VALUE  '5'.
  2462   02  DFHPF6    PIC  X  VALUE  '6'.
  2463   02  DFHPF7    PIC  X  VALUE  '7'.
  2464   02  DFHPF8    PIC  X  VALUE  '8'.
  2465   02  DFHPF9    PIC  X  VALUE  '9'.
  2466   02  DFHPF10   PIC  X  VALUE  ':'.
  2467   02  DFHPF11   PIC  X  VALUE  '#'.
  2468   02  DFHPF12   PIC  X  VALUE  '@'.
  2469   02  DFHPF13   PIC  X  VALUE  'A'.
  2470   02  DFHPF14   PIC  X  VALUE  'B'.
  2471   02  DFHPF15   PIC  X  VALUE  'C'.
  2472   02  DFHPF16   PIC  X  VALUE  'D'.
  2473   02  DFHPF17   PIC  X  VALUE  'E'.
  2474   02  DFHPF18   PIC  X  VALUE  'F'.
  2475   02  DFHPF19   PIC  X  VALUE  'G'.
  2476   02  DFHPF20   PIC  X  VALUE  'H'.
  2477   02  DFHPF21   PIC  X  VALUE  'I'.
  2478*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2479   02  DFHPF22   PIC  X  VALUE  '['.
  2480   02  DFHPF23   PIC  X  VALUE  '.'.
  2481   02  DFHPF24   PIC  X  VALUE  '<'.
  2482   02  DFHMSRE   PIC  X  VALUE  'X'.
  2483   02  DFHSTRF   PIC  X  VALUE  'h'.
  2484   02  DFHTRIG   PIC  X  VALUE  '"'.
  2485 01  FILLER    REDEFINES DFHAID.
  2486     12  FILLER              PIC X(8).
  2487     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  52
* EL156.cbl
  2489*    COPY EL156S.
  2490 01  EL156AI.
  2491     05  FILLER            PIC  X(0012).
  2492*    -------------------------------
  2493     05  RUNDTEAL PIC S9(0004) COMP.
  2494     05  RUNDTEAF PIC  X(0001).
  2495     05  FILLER REDEFINES RUNDTEAF.
  2496         10  RUNDTEAA PIC  X(0001).
  2497     05  RUNDTEAI PIC  X(0008).
  2498*    -------------------------------
  2499     05  RUNTIMAL PIC S9(0004) COMP.
  2500     05  RUNTIMAF PIC  X(0001).
  2501     05  FILLER REDEFINES RUNTIMAF.
  2502         10  RUNTIMAA PIC  X(0001).
  2503     05  RUNTIMAI PIC  X(0005).
  2504*    -------------------------------
  2505     05  SEQUL PIC S9(0004) COMP.
  2506     05  SEQUF PIC  X(0001).
  2507     05  FILLER REDEFINES SEQUF.
  2508         10  SEQUA PIC  X(0001).
  2509     05  SEQUI PIC  X(0010).
  2510*    -------------------------------
  2511     05  CLMNOL PIC S9(0004) COMP.
  2512     05  CLMNOF PIC  X(0001).
  2513     05  FILLER REDEFINES CLMNOF.
  2514         10  CLMNOA PIC  X(0001).
  2515     05  CLMNOI PIC  X(0007).
  2516*    -------------------------------
  2517     05  CARRL PIC S9(0004) COMP.
  2518     05  CARRF PIC  X(0001).
  2519     05  FILLER REDEFINES CARRF.
  2520         10  CARRA PIC  X(0001).
  2521     05  CARRI PIC  X(0001).
  2522*    -------------------------------
  2523     05  CERTNOL PIC S9(0004) COMP.
  2524     05  CERTNOF PIC  X(0001).
  2525     05  FILLER REDEFINES CERTNOF.
  2526         10  CERTNOA PIC  X(0001).
  2527     05  CERTNOI PIC  X(0010).
  2528*    -------------------------------
  2529     05  SUFXL PIC S9(0004) COMP.
  2530     05  SUFXF PIC  X(0001).
  2531     05  FILLER REDEFINES SUFXF.
  2532         10  SUFXA PIC  X(0001).
  2533     05  SUFXI PIC  X(0001).
  2534*    -------------------------------
  2535     05  CLMTYPL PIC S9(0004) COMP.
  2536     05  CLMTYPF PIC  X(0001).
  2537     05  FILLER REDEFINES CLMTYPF.
  2538         10  CLMTYPA PIC  X(0001).
  2539     05  CLMTYPI PIC  X(0006).
  2540*    -------------------------------
  2541     05  CLMSTATL PIC S9(0004) COMP.
  2542     05  CLMSTATF PIC  X(0001).
  2543     05  FILLER REDEFINES CLMSTATF.
  2544         10  CLMSTATA PIC  X(0001).
  2545     05  CLMSTATI PIC  X(0006).
  2546*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  53
* EL156.cbl
  2547     05  LSTNMEL PIC S9(0004) COMP.
  2548     05  LSTNMEF PIC  X(0001).
  2549     05  FILLER REDEFINES LSTNMEF.
  2550         10  LSTNMEA PIC  X(0001).
  2551     05  LSTNMEI PIC  X(0015).
  2552*    -------------------------------
  2553     05  FSTNMEL PIC S9(0004) COMP.
  2554     05  FSTNMEF PIC  X(0001).
  2555     05  FILLER REDEFINES FSTNMEF.
  2556         10  FSTNMEA PIC  X(0001).
  2557     05  FSTNMEI PIC  X(0012).
  2558*    -------------------------------
  2559     05  MINITL PIC S9(0004) COMP.
  2560     05  MINITF PIC  X(0001).
  2561     05  FILLER REDEFINES MINITF.
  2562         10  MINITA PIC  X(0001).
  2563     05  MINITI PIC  X(0001).
  2564*    -------------------------------
  2565     05  PRIMHDGL PIC S9(0004) COMP.
  2566     05  PRIMHDGF PIC  X(0001).
  2567     05  FILLER REDEFINES PRIMHDGF.
  2568         10  PRIMHDGA PIC  X(0001).
  2569     05  PRIMHDGI PIC  X(0012).
  2570*    -------------------------------
  2571     05  PCERTNOL PIC S9(0004) COMP.
  2572     05  PCERTNOF PIC  X(0001).
  2573     05  FILLER REDEFINES PCERTNOF.
  2574         10  PCERTNOA PIC  X(0001).
  2575     05  PCERTNOI PIC  X(0010).
  2576*    -------------------------------
  2577     05  PSUFXL PIC S9(0004) COMP.
  2578     05  PSUFXF PIC  X(0001).
  2579     05  FILLER REDEFINES PSUFXF.
  2580         10  PSUFXA PIC  X(0001).
  2581     05  PSUFXI PIC  X(0001).
  2582*    -------------------------------
  2583     05  STATUSL PIC S9(0004) COMP.
  2584     05  STATUSF PIC  X(0001).
  2585     05  FILLER REDEFINES STATUSF.
  2586         10  STATUSA PIC  X(0001).
  2587     05  STATUSI PIC  X(0010).
  2588*    -------------------------------
  2589     05  LOANHL PIC S9(0004) COMP.
  2590     05  LOANHF PIC  X(0001).
  2591     05  FILLER REDEFINES LOANHF.
  2592         10  LOANHA PIC  X(0001).
  2593     05  LOANHI PIC  X(0014).
  2594*    -------------------------------
  2595     05  LOANNOL PIC S9(0004) COMP.
  2596     05  LOANNOF PIC  X(0001).
  2597     05  FILLER REDEFINES LOANNOF.
  2598         10  LOANNOA PIC  X(0001).
  2599     05  LOANNOI PIC  X(0025).
  2600*    -------------------------------
  2601     05  DUEDAYHL PIC S9(0004) COMP.
  2602     05  DUEDAYHF PIC  X(0001).
  2603     05  FILLER REDEFINES DUEDAYHF.
  2604         10  DUEDAYHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  54
* EL156.cbl
  2605     05  DUEDAYHI PIC  X(0008).
  2606*    -------------------------------
  2607     05  DUEDAYL PIC S9(0004) COMP.
  2608     05  DUEDAYF PIC  X(0001).
  2609     05  FILLER REDEFINES DUEDAYF.
  2610         10  DUEDAYA PIC  X(0001).
  2611     05  DUEDAYI PIC  X(0002).
  2612*    -------------------------------
  2613     05  ZINTHL PIC S9(0004) COMP.
  2614     05  ZINTHF PIC  X(0001).
  2615     05  FILLER REDEFINES ZINTHF.
  2616         10  ZINTHA PIC  X(0001).
  2617     05  ZINTHI PIC  X(0009).
  2618*    -------------------------------
  2619     05  ZINTL PIC S9(0004) COMP.
  2620     05  ZINTF PIC  X(0001).
  2621     05  FILLER REDEFINES ZINTF.
  2622         10  ZINTA PIC  X(0001).
  2623     05  ZINTI PIC  99V99999.
  2624*    -------------------------------
  2625     05  PTHRHDGL PIC S9(0004) COMP.
  2626     05  PTHRHDGF PIC  X(0001).
  2627     05  FILLER REDEFINES PTHRHDGF.
  2628         10  PTHRHDGA PIC  X(0001).
  2629     05  PTHRHDGI PIC  X(0014).
  2630*    -------------------------------
  2631     05  PDTHRUL PIC S9(0004) COMP.
  2632     05  PDTHRUF PIC  X(0001).
  2633     05  FILLER REDEFINES PDTHRUF.
  2634         10  PDTHRUA PIC  X(0001).
  2635     05  PDTHRUI PIC  X(0008).
  2636*    -------------------------------
  2637     05  TOTPAIDL PIC S9(0004) COMP.
  2638     05  TOTPAIDF PIC  X(0001).
  2639     05  FILLER REDEFINES TOTPAIDF.
  2640         10  TOTPAIDA PIC  X(0001).
  2641     05  TOTPAIDI PIC  X(0010).
  2642*    -------------------------------
  2643     05  COVERL PIC S9(0004) COMP.
  2644     05  COVERF PIC  X(0001).
  2645     05  FILLER REDEFINES COVERF.
  2646         10  COVERA PIC  X(0001).
  2647     05  COVERI PIC  X(0010).
  2648*    -------------------------------
  2649     05  INCURL PIC S9(0004) COMP.
  2650     05  INCURF PIC  X(0001).
  2651     05  FILLER REDEFINES INCURF.
  2652         10  INCURA PIC  X(0001).
  2653     05  INCURI PIC  X(0008).
  2654*    -------------------------------
  2655     05  LSTDTEL PIC S9(0004) COMP.
  2656     05  LSTDTEF PIC  X(0001).
  2657     05  FILLER REDEFINES LSTDTEF.
  2658         10  LSTDTEA PIC  X(0001).
  2659     05  LSTDTEI PIC  X(0008).
  2660*    -------------------------------
  2661     05  CRTSTATL PIC S9(0004) COMP.
  2662     05  CRTSTATF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  55
* EL156.cbl
  2663     05  FILLER REDEFINES CRTSTATF.
  2664         10  CRTSTATA PIC  X(0001).
  2665     05  CRTSTATI PIC  X(0010).
  2666*    -------------------------------
  2667     05  EFFECTL PIC S9(0004) COMP.
  2668     05  EFFECTF PIC  X(0001).
  2669     05  FILLER REDEFINES EFFECTF.
  2670         10  EFFECTA PIC  X(0001).
  2671     05  EFFECTI PIC  X(0008).
  2672*    -------------------------------
  2673     05  TERMSL PIC S9(0004) COMP.
  2674     05  TERMSF PIC  X(0001).
  2675     05  FILLER REDEFINES TERMSF.
  2676         10  TERMSA PIC  X(0001).
  2677     05  TERMSI PIC  X(0011).
  2678*    -------------------------------
  2679     05  STACCTL PIC S9(0004) COMP.
  2680     05  STACCTF PIC  X(0001).
  2681     05  FILLER REDEFINES STACCTF.
  2682         10  STACCTA PIC  X(0001).
  2683     05  STACCTI PIC  X(0013).
  2684*    -------------------------------
  2685     05  EXPDTEHL PIC S9(0004) COMP.
  2686     05  EXPDTEHF PIC  X(0001).
  2687     05  FILLER REDEFINES EXPDTEHF.
  2688         10  EXPDTEHA PIC  X(0001).
  2689     05  EXPDTEHI PIC  X(0014).
  2690*    -------------------------------
  2691     05  EXPDTEL PIC S9(0004) COMP.
  2692     05  EXPDTEF PIC  X(0001).
  2693     05  FILLER REDEFINES EXPDTEF.
  2694         10  EXPDTEA PIC  X(0001).
  2695     05  EXPDTEI PIC  X(0008).
  2696*    -------------------------------
  2697     05  BENECAPL PIC S9(0004) COMP.
  2698     05  BENECAPF PIC  X(0001).
  2699     05  FILLER REDEFINES BENECAPF.
  2700         10  BENECAPA PIC  X(0001).
  2701     05  BENECAPI PIC  X(0013).
  2702*    -------------------------------
  2703     05  BENEL PIC S9(0004) COMP.
  2704     05  BENEF PIC  X(0001).
  2705     05  FILLER REDEFINES BENEF.
  2706         10  BENEA PIC  X(0001).
  2707     05  BENEI PIC  X(0009).
  2708*    -------------------------------
  2709     05  FORMTYPL PIC S9(0004) COMP.
  2710     05  FORMTYPF PIC  X(0001).
  2711     05  FILLER REDEFINES FORMTYPF.
  2712         10  FORMTYPA PIC  X(0001).
  2713     05  FORMTYPI PIC  X(0001).
  2714*    -------------------------------
  2715     05  PMTTYPEL PIC S9(0004) COMP.
  2716     05  PMTTYPEF PIC  X(0001).
  2717     05  FILLER REDEFINES PMTTYPEF.
  2718         10  PMTTYPEA PIC  X(0001).
  2719     05  PMTTYPEI PIC  X(0001).
  2720*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  56
* EL156.cbl
  2721     05  PAYEEL PIC S9(0004) COMP.
  2722     05  PAYEEF PIC  X(0001).
  2723     05  FILLER REDEFINES PAYEEF.
  2724         10  PAYEEA PIC  X(0001).
  2725     05  PAYEEI PIC  X(0002).
  2726*    -------------------------------
  2727     05  CHECKNOL PIC S9(0004) COMP.
  2728     05  CHECKNOF PIC  X(0001).
  2729     05  FILLER REDEFINES CHECKNOF.
  2730         10  CHECKNOA PIC  X(0001).
  2731     05  CHECKNOI PIC  X(0007).
  2732*    -------------------------------
  2733     05  OFFLINEL PIC S9(0004) COMP.
  2734     05  OFFLINEF PIC  X(0001).
  2735     05  FILLER REDEFINES OFFLINEF.
  2736         10  OFFLINEA PIC  X(0001).
  2737     05  OFFLINEI PIC  X(0001).
  2738*    -------------------------------
  2739     05  HOLDTILL PIC S9(0004) COMP.
  2740     05  HOLDTILF PIC  X(0001).
  2741     05  FILLER REDEFINES HOLDTILF.
  2742         10  HOLDTILA PIC  X(0001).
  2743     05  HOLDTILI PIC  X(0008).
  2744*    -------------------------------
  2745     05  NOTE1L PIC S9(0004) COMP.
  2746     05  NOTE1F PIC  X(0001).
  2747     05  FILLER REDEFINES NOTE1F.
  2748         10  NOTE1A PIC  X(0001).
  2749     05  NOTE1I PIC  X(0060).
  2750*    -------------------------------
  2751     05  NOTE2L PIC S9(0004) COMP.
  2752     05  NOTE2F PIC  X(0001).
  2753     05  FILLER REDEFINES NOTE2F.
  2754         10  NOTE2A PIC  X(0001).
  2755     05  NOTE2I PIC  X(0060).
  2756*    -------------------------------
  2757     05  EOBYNL PIC S9(0004) COMP.
  2758     05  EOBYNF PIC  X(0001).
  2759     05  FILLER REDEFINES EOBYNF.
  2760         10  EOBYNA PIC  X(0001).
  2761     05  EOBYNI PIC  X(0001).
  2762*    -------------------------------
  2763     05  CASHHL PIC S9(0004) COMP.
  2764     05  CASHHF PIC  X(0001).
  2765     05  FILLER REDEFINES CASHHF.
  2766         10  CASHHA PIC  X(0001).
  2767     05  CASHHI PIC  X(0011).
  2768*    -------------------------------
  2769     05  CASHL PIC S9(0004) COMP.
  2770     05  CASHF PIC  X(0001).
  2771     05  FILLER REDEFINES CASHF.
  2772         10  CASHA PIC  X(0001).
  2773     05  CASHI PIC  X(0001).
  2774*    -------------------------------
  2775     05  GROUPHL PIC S9(0004) COMP.
  2776     05  GROUPHF PIC  X(0001).
  2777     05  FILLER REDEFINES GROUPHF.
  2778         10  GROUPHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  57
* EL156.cbl
  2779     05  GROUPHI PIC  X(0010).
  2780*    -------------------------------
  2781     05  GROUPEDL PIC S9(0004) COMP.
  2782     05  GROUPEDF PIC  X(0001).
  2783     05  FILLER REDEFINES GROUPEDF.
  2784         10  GROUPEDA PIC  X(0001).
  2785     05  GROUPEDI PIC  X(0001).
  2786*    -------------------------------
  2787     05  PINTHL PIC S9(0004) COMP.
  2788     05  PINTHF PIC  X(0001).
  2789     05  FILLER REDEFINES PINTHF.
  2790         10  PINTHA PIC  X(0001).
  2791     05  PINTHI PIC  X(0004).
  2792*    -------------------------------
  2793     05  PINTL PIC S9(0004) COMP.
  2794     05  PINTF PIC  X(0001).
  2795     05  FILLER REDEFINES PINTF.
  2796         10  PINTA PIC  X(0001).
  2797     05  PINTI PIC  X(0008).
  2798*    -------------------------------
  2799     05  PROOFDTL PIC S9(0004) COMP.
  2800     05  PROOFDTF PIC  X(0001).
  2801     05  FILLER REDEFINES PROOFDTF.
  2802         10  PROOFDTA PIC  X(0001).
  2803     05  PROOFDTI PIC  X(0008).
  2804*    -------------------------------
  2805     05  AIGFRMHL PIC S9(0004) COMP.
  2806     05  AIGFRMHF PIC  X(0001).
  2807     05  FILLER REDEFINES AIGFRMHF.
  2808         10  AIGFRMHA PIC  X(0001).
  2809     05  AIGFRMHI PIC  X(0012).
  2810*    -------------------------------
  2811     05  AIGFROML PIC S9(0004) COMP.
  2812     05  AIGFROMF PIC  X(0001).
  2813     05  FILLER REDEFINES AIGFROMF.
  2814         10  AIGFROMA PIC  X(0001).
  2815     05  AIGFROMI PIC  X(0008).
  2816*    -------------------------------
  2817     05  PMTHDGAL PIC S9(0004) COMP.
  2818     05  PMTHDGAF PIC  X(0001).
  2819     05  FILLER REDEFINES PMTHDGAF.
  2820         10  PMTHDGAA PIC  X(0001).
  2821     05  PMTHDGAI PIC  X(0066).
  2822*    -------------------------------
  2823     05  EPYFROML PIC S9(0004) COMP.
  2824     05  EPYFROMF PIC  X(0001).
  2825     05  FILLER REDEFINES EPYFROMF.
  2826         10  EPYFROMA PIC  X(0001).
  2827     05  EPYFROMI PIC  X(0008).
  2828*    -------------------------------
  2829     05  EPYTHRUL PIC S9(0004) COMP.
  2830     05  EPYTHRUF PIC  X(0001).
  2831     05  FILLER REDEFINES EPYTHRUF.
  2832         10  EPYTHRUA PIC  X(0001).
  2833     05  EPYTHRUI PIC  X(0008).
  2834*    -------------------------------
  2835     05  EDAYSL PIC S9(0004) COMP.
  2836     05  EDAYSF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  58
* EL156.cbl
  2837     05  FILLER REDEFINES EDAYSF.
  2838         10  EDAYSA PIC  X(0001).
  2839     05  EDAYSI PIC  S9(6).
  2840*    -------------------------------
  2841     05  EPYAMTL PIC S9(0004) COMP.
  2842     05  EPYAMTF PIC  X(0001).
  2843     05  FILLER REDEFINES EPYAMTF.
  2844         10  EPYAMTA PIC  X(0001).
  2845     05  EPYAMTI PIC  S9(8)V99.
  2846*    -------------------------------
  2847     05  ERESVL PIC S9(0004) COMP.
  2848     05  ERESVF PIC  X(0001).
  2849     05  FILLER REDEFINES ERESVF.
  2850         10  ERESVA PIC  X(0001).
  2851     05  ERESVI PIC  S9(7)V99.
  2852*    -------------------------------
  2853     05  ETYPEL PIC S9(0004) COMP.
  2854     05  ETYPEF PIC  X(0001).
  2855     05  FILLER REDEFINES ETYPEF.
  2856         10  ETYPEA PIC  X(0001).
  2857     05  ETYPEI PIC  X(0001).
  2858*    -------------------------------
  2859     05  EEXPENSL PIC S9(0004) COMP.
  2860     05  EEXPENSF PIC  X(0001).
  2861     05  FILLER REDEFINES EEXPENSF.
  2862         10  EEXPENSA PIC  X(0001).
  2863     05  EEXPENSI PIC  9(6)V99.
  2864*    -------------------------------
  2865     05  CPYFROML PIC S9(0004) COMP.
  2866     05  CPYFROMF PIC  X(0001).
  2867     05  FILLER REDEFINES CPYFROMF.
  2868         10  CPYFROMA PIC  X(0001).
  2869     05  CPYFROMI PIC  X(0008).
  2870*    -------------------------------
  2871     05  CPYTHRUL PIC S9(0004) COMP.
  2872     05  CPYTHRUF PIC  X(0001).
  2873     05  FILLER REDEFINES CPYTHRUF.
  2874         10  CPYTHRUA PIC  X(0001).
  2875     05  CPYTHRUI PIC  X(0008).
  2876*    -------------------------------
  2877     05  CDAYSL PIC S9(0004) COMP.
  2878     05  CDAYSF PIC  X(0001).
  2879     05  FILLER REDEFINES CDAYSF.
  2880         10  CDAYSA PIC  X(0001).
  2881     05  CDAYSI PIC  9(6).
  2882*    -------------------------------
  2883     05  CPYAMTL PIC S9(0004) COMP.
  2884     05  CPYAMTF PIC  X(0001).
  2885     05  FILLER REDEFINES CPYAMTF.
  2886         10  CPYAMTA PIC  X(0001).
  2887     05  CPYAMTI PIC  S9(8)V99.
  2888*    -------------------------------
  2889     05  CRESVL PIC S9(0004) COMP.
  2890     05  CRESVF PIC  X(0001).
  2891     05  FILLER REDEFINES CRESVF.
  2892         10  CRESVA PIC  X(0001).
  2893     05  CRESVI PIC  9(6)V99.
  2894*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  59
* EL156.cbl
  2895     05  CEXPENSL PIC S9(0004) COMP.
  2896     05  CEXPENSF PIC  X(0001).
  2897     05  FILLER REDEFINES CEXPENSF.
  2898         10  CEXPENSA PIC  X(0001).
  2899     05  CEXPENSI PIC  9(6)V99.
  2900*    -------------------------------
  2901     05  ERRMSG0L PIC S9(0004) COMP.
  2902     05  ERRMSG0F PIC  X(0001).
  2903     05  FILLER REDEFINES ERRMSG0F.
  2904         10  ERRMSG0A PIC  X(0001).
  2905     05  ERRMSG0I PIC  X(0072).
  2906*    -------------------------------
  2907     05  ERRMSG1L PIC S9(0004) COMP.
  2908     05  ERRMSG1F PIC  X(0001).
  2909     05  FILLER REDEFINES ERRMSG1F.
  2910         10  ERRMSG1A PIC  X(0001).
  2911     05  ERRMSG1I PIC  X(0072).
  2912*    -------------------------------
  2913     05  ERRMSG2L PIC S9(0004) COMP.
  2914     05  ERRMSG2F PIC  X(0001).
  2915     05  FILLER REDEFINES ERRMSG2F.
  2916         10  ERRMSG2A PIC  X(0001).
  2917     05  ERRMSG2I PIC  X(0072).
  2918*    -------------------------------
  2919     05  ENTERPFL PIC S9(0004) COMP.
  2920     05  ENTERPFF PIC  X(0001).
  2921     05  FILLER REDEFINES ENTERPFF.
  2922         10  ENTERPFA PIC  X(0001).
  2923     05  ENTERPFI PIC  99.
  2924*    -------------------------------
  2925     05  PF6TITL PIC S9(0004) COMP.
  2926     05  PF6TITF PIC  X(0001).
  2927     05  FILLER REDEFINES PF6TITF.
  2928         10  PF6TITA PIC  X(0001).
  2929     05  PF6TITI PIC  X(0016).
  2930 01  EL156AO REDEFINES EL156AI.
  2931     05  FILLER            PIC  X(0012).
  2932*    -------------------------------
  2933     05  FILLER            PIC  X(0003).
  2934     05  RUNDTEAO PIC  X(0008).
  2935*    -------------------------------
  2936     05  FILLER            PIC  X(0003).
  2937     05  RUNTIMAO PIC  99.99.
  2938*    -------------------------------
  2939     05  FILLER            PIC  X(0003).
  2940     05  SEQUO PIC  X(0010).
  2941*    -------------------------------
  2942     05  FILLER            PIC  X(0003).
  2943     05  CLMNOO PIC  X(0007).
  2944*    -------------------------------
  2945     05  FILLER            PIC  X(0003).
  2946     05  CARRO PIC  X(0001).
  2947*    -------------------------------
  2948     05  FILLER            PIC  X(0003).
  2949     05  CERTNOO PIC  X(0010).
  2950*    -------------------------------
  2951     05  FILLER            PIC  X(0003).
  2952     05  SUFXO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  60
* EL156.cbl
  2953*    -------------------------------
  2954     05  FILLER            PIC  X(0003).
  2955     05  CLMTYPO PIC  X(0006).
  2956*    -------------------------------
  2957     05  FILLER            PIC  X(0003).
  2958     05  CLMSTATO PIC  X(0006).
  2959*    -------------------------------
  2960     05  FILLER            PIC  X(0003).
  2961     05  LSTNMEO PIC  X(0015).
  2962*    -------------------------------
  2963     05  FILLER            PIC  X(0003).
  2964     05  FSTNMEO PIC  X(0012).
  2965*    -------------------------------
  2966     05  FILLER            PIC  X(0003).
  2967     05  MINITO PIC  X(0001).
  2968*    -------------------------------
  2969     05  FILLER            PIC  X(0003).
  2970     05  PRIMHDGO PIC  X(0012).
  2971*    -------------------------------
  2972     05  FILLER            PIC  X(0003).
  2973     05  PCERTNOO PIC  X(0010).
  2974*    -------------------------------
  2975     05  FILLER            PIC  X(0003).
  2976     05  PSUFXO PIC  X(0001).
  2977*    -------------------------------
  2978     05  FILLER            PIC  X(0003).
  2979     05  STATUSO PIC  X(0010).
  2980*    -------------------------------
  2981     05  FILLER            PIC  X(0003).
  2982     05  LOANHO PIC  X(0014).
  2983*    -------------------------------
  2984     05  FILLER            PIC  X(0003).
  2985     05  LOANNOO PIC  X(0025).
  2986*    -------------------------------
  2987     05  FILLER            PIC  X(0003).
  2988     05  DUEDAYHO PIC  X(0008).
  2989*    -------------------------------
  2990     05  FILLER            PIC  X(0003).
  2991     05  DUEDAYO PIC  X(0002).
  2992*    -------------------------------
  2993     05  FILLER            PIC  X(0003).
  2994     05  ZINTHO PIC  X(0009).
  2995*    -------------------------------
  2996     05  FILLER            PIC  X(0003).
  2997     05  ZINTO PIC  9.99999.
  2998*    -------------------------------
  2999     05  FILLER            PIC  X(0003).
  3000     05  PTHRHDGO PIC  X(0014).
  3001*    -------------------------------
  3002     05  FILLER            PIC  X(0003).
  3003     05  PDTHRUO PIC  X(0008).
  3004*    -------------------------------
  3005     05  FILLER            PIC  X(0003).
  3006     05  TOTPAIDO PIC  Z(6).99-.
  3007*    -------------------------------
  3008     05  FILLER            PIC  X(0003).
  3009     05  COVERO PIC  X(0010).
  3010*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  61
* EL156.cbl
  3011     05  FILLER            PIC  X(0003).
  3012     05  INCURO PIC  X(0008).
  3013*    -------------------------------
  3014     05  FILLER            PIC  X(0003).
  3015     05  LSTDTEO PIC  X(0008).
  3016*    -------------------------------
  3017     05  FILLER            PIC  X(0003).
  3018     05  CRTSTATO PIC  X(0010).
  3019*    -------------------------------
  3020     05  FILLER            PIC  X(0003).
  3021     05  EFFECTO PIC  X(0008).
  3022*    -------------------------------
  3023     05  FILLER            PIC  X(0003).
  3024     05  TERMSO PIC  X(0011).
  3025*    -------------------------------
  3026     05  FILLER            PIC  X(0003).
  3027     05  STACCTO PIC  X(0013).
  3028*    -------------------------------
  3029     05  FILLER            PIC  X(0003).
  3030     05  EXPDTEHO PIC  X(0014).
  3031*    -------------------------------
  3032     05  FILLER            PIC  X(0003).
  3033     05  EXPDTEO PIC  X(0008).
  3034*    -------------------------------
  3035     05  FILLER            PIC  X(0003).
  3036     05  BENECAPO PIC  X(0013).
  3037*    -------------------------------
  3038     05  FILLER            PIC  X(0003).
  3039     05  BENEO PIC  Z(6).99.
  3040*    -------------------------------
  3041     05  FILLER            PIC  X(0003).
  3042     05  FORMTYPO PIC  X(0001).
  3043*    -------------------------------
  3044     05  FILLER            PIC  X(0003).
  3045     05  PMTTYPEO PIC  X(0001).
  3046*    -------------------------------
  3047     05  FILLER            PIC  X(0003).
  3048     05  PAYEEO PIC  X(0002).
  3049*    -------------------------------
  3050     05  FILLER            PIC  X(0003).
  3051     05  CHECKNOO PIC  X(0007).
  3052*    -------------------------------
  3053     05  FILLER            PIC  X(0003).
  3054     05  OFFLINEO PIC  X(0001).
  3055*    -------------------------------
  3056     05  FILLER            PIC  X(0003).
  3057     05  HOLDTILO PIC  99B99B99.
  3058*    -------------------------------
  3059     05  FILLER            PIC  X(0003).
  3060     05  NOTE1O PIC  X(0060).
  3061*    -------------------------------
  3062     05  FILLER            PIC  X(0003).
  3063     05  NOTE2O PIC  X(0060).
  3064*    -------------------------------
  3065     05  FILLER            PIC  X(0003).
  3066     05  EOBYNO PIC  X(0001).
  3067*    -------------------------------
  3068     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  62
* EL156.cbl
  3069     05  CASHHO PIC  X(0011).
  3070*    -------------------------------
  3071     05  FILLER            PIC  X(0003).
  3072     05  CASHO PIC  X(0001).
  3073*    -------------------------------
  3074     05  FILLER            PIC  X(0003).
  3075     05  GROUPHO PIC  X(0010).
  3076*    -------------------------------
  3077     05  FILLER            PIC  X(0003).
  3078     05  GROUPEDO PIC  X(0001).
  3079*    -------------------------------
  3080     05  FILLER            PIC  X(0003).
  3081     05  PINTHO PIC  X(0004).
  3082*    -------------------------------
  3083     05  FILLER            PIC  X(0003).
  3084     05  PINTO PIC  Z,ZZ9.99.
  3085*    -------------------------------
  3086     05  FILLER            PIC  X(0003).
  3087     05  PROOFDTO PIC  99B99B99.
  3088*    -------------------------------
  3089     05  FILLER            PIC  X(0003).
  3090     05  AIGFRMHO PIC  X(0012).
  3091*    -------------------------------
  3092     05  FILLER            PIC  X(0003).
  3093     05  AIGFROMO PIC  99B99B99.
  3094*    -------------------------------
  3095     05  FILLER            PIC  X(0003).
  3096     05  PMTHDGAO PIC  X(0066).
  3097*    -------------------------------
  3098     05  FILLER            PIC  X(0003).
  3099     05  EPYFROMO PIC  99B99B99.
  3100*    -------------------------------
  3101     05  FILLER            PIC  X(0003).
  3102     05  EPYTHRUO PIC  99B99B99.
  3103*    -------------------------------
  3104     05  FILLER            PIC  X(0003).
  3105     05  EDAYSO PIC  Z(4)9-.
  3106*    -------------------------------
  3107     05  FILLER            PIC  X(0003).
  3108     05  EPYAMTO PIC  Z(6).99-.
  3109*    -------------------------------
  3110     05  FILLER            PIC  X(0003).
  3111     05  ERESVO PIC  Z(5).99-.
  3112*    -------------------------------
  3113     05  FILLER            PIC  X(0003).
  3114     05  ETYPEO PIC  X(0001).
  3115*    -------------------------------
  3116     05  FILLER            PIC  X(0003).
  3117     05  EEXPENSO PIC  Z(5).99.
  3118*    -------------------------------
  3119     05  FILLER            PIC  X(0003).
  3120     05  CPYFROMO PIC  99B99B99.
  3121*    -------------------------------
  3122     05  FILLER            PIC  X(0003).
  3123     05  CPYTHRUO PIC  99B99B99.
  3124*    -------------------------------
  3125     05  FILLER            PIC  X(0003).
  3126     05  CDAYSO PIC  Z(4)9-.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  63
* EL156.cbl
  3127*    -------------------------------
  3128     05  FILLER            PIC  X(0003).
  3129     05  CPYAMTO PIC  Z(6).99-.
  3130*    -------------------------------
  3131     05  FILLER            PIC  X(0003).
  3132     05  CRESVO PIC  Z(5).99.
  3133*    -------------------------------
  3134     05  FILLER            PIC  X(0003).
  3135     05  CEXPENSO PIC  Z(5).99.
  3136*    -------------------------------
  3137     05  FILLER            PIC  X(0003).
  3138     05  ERRMSG0O PIC  X(0072).
  3139*    -------------------------------
  3140     05  FILLER            PIC  X(0003).
  3141     05  ERRMSG1O PIC  X(0072).
  3142*    -------------------------------
  3143     05  FILLER            PIC  X(0003).
  3144     05  ERRMSG2O PIC  X(0072).
  3145*    -------------------------------
  3146     05  FILLER            PIC  X(0003).
  3147     05  ENTERPFO PIC  X(0002).
  3148*    -------------------------------
  3149     05  FILLER            PIC  X(0003).
  3150     05  PF6TITO PIC  X(0016).
  3151*    -------------------------------
  3152 01  EL156BI REDEFINES EL156AI.
  3153     05  FILLER            PIC  X(0012).
  3154*    -------------------------------
  3155     05  RUNDTEBL PIC S9(0004) COMP.
  3156     05  RUNDTEBF PIC  X(0001).
  3157     05  FILLER REDEFINES RUNDTEBF.
  3158         10  RUNDTEBA PIC  X(0001).
  3159     05  RUNDTEBI PIC  X(0008).
  3160*    -------------------------------
  3161     05  RUNTIMBL PIC S9(0004) COMP.
  3162     05  RUNTIMBF PIC  X(0001).
  3163     05  FILLER REDEFINES RUNTIMBF.
  3164         10  RUNTIMBA PIC  X(0001).
  3165     05  RUNTIMBI PIC  X(0005).
  3166*    -------------------------------
  3167     05  PAYDTBL PIC S9(0004) COMP.
  3168     05  PAYDTBF PIC  X(0001).
  3169     05  FILLER REDEFINES PAYDTBF.
  3170         10  PAYDTBA PIC  X(0001).
  3171     05  PAYDTBI PIC  X(0008).
  3172*    -------------------------------
  3173     05  PAYTYPBL PIC S9(0004) COMP.
  3174     05  PAYTYPBF PIC  X(0001).
  3175     05  FILLER REDEFINES PAYTYPBF.
  3176         10  PAYTYPBA PIC  X(0001).
  3177     05  PAYTYPBI PIC  X(0015).
  3178*    -------------------------------
  3179     05  PAYAMTBL PIC S9(0004) COMP.
  3180     05  PAYAMTBF PIC  X(0001).
  3181     05  FILLER REDEFINES PAYAMTBF.
  3182         10  PAYAMTBA PIC  X(0001).
  3183     05  PAYAMTBI PIC  X(0011).
  3184*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  64
* EL156.cbl
  3185     05  LOANHBL PIC S9(0004) COMP.
  3186     05  LOANHBF PIC  X(0001).
  3187     05  FILLER REDEFINES LOANHBF.
  3188         10  LOANHBA PIC  X(0001).
  3189     05  LOANHBI PIC  X(0012).
  3190*    -------------------------------
  3191     05  LOANNBL PIC S9(0004) COMP.
  3192     05  LOANNBF PIC  X(0001).
  3193     05  FILLER REDEFINES LOANNBF.
  3194         10  LOANNBA PIC  X(0001).
  3195     05  LOANNBI PIC  X(0025).
  3196*    -------------------------------
  3197     05  CKNUMHDL PIC S9(0004) COMP.
  3198     05  CKNUMHDF PIC  X(0001).
  3199     05  FILLER REDEFINES CKNUMHDF.
  3200         10  CKNUMHDA PIC  X(0001).
  3201     05  CKNUMHDI PIC  X(0012).
  3202*    -------------------------------
  3203     05  CKNUMBL PIC S9(0004) COMP.
  3204     05  CKNUMBF PIC  X(0001).
  3205     05  FILLER REDEFINES CKNUMBF.
  3206         10  CKNUMBA PIC  X(0001).
  3207     05  CKNUMBI PIC  X(0007).
  3208*    -------------------------------
  3209     05  AGTHDGL PIC S9(0004) COMP.
  3210     05  AGTHDGF PIC  X(0001).
  3211     05  FILLER REDEFINES AGTHDGF.
  3212         10  AGTHDGA PIC  X(0001).
  3213     05  AGTHDGI PIC  X(0016).
  3214*    -------------------------------
  3215     05  NAMEBL PIC S9(0004) COMP.
  3216     05  NAMEBF PIC  X(0001).
  3217     05  FILLER REDEFINES NAMEBF.
  3218         10  NAMEBA PIC  X(0001).
  3219     05  NAMEBI PIC  X(0030).
  3220*    -------------------------------
  3221     05  NAMEB2L PIC S9(0004) COMP.
  3222     05  NAMEB2F PIC  X(0001).
  3223     05  FILLER REDEFINES NAMEB2F.
  3224         10  NAMEB2A PIC  X(0001).
  3225     05  NAMEB2I PIC  X(0030).
  3226*    -------------------------------
  3227     05  ADDR1BL PIC S9(0004) COMP.
  3228     05  ADDR1BF PIC  X(0001).
  3229     05  FILLER REDEFINES ADDR1BF.
  3230         10  ADDR1BA PIC  X(0001).
  3231     05  ADDR1BI PIC  X(0030).
  3232*    -------------------------------
  3233     05  ADDR1B2L PIC S9(0004) COMP.
  3234     05  ADDR1B2F PIC  X(0001).
  3235     05  FILLER REDEFINES ADDR1B2F.
  3236         10  ADDR1B2A PIC  X(0001).
  3237     05  ADDR1B2I PIC  X(0030).
  3238*    -------------------------------
  3239     05  ADDR2BL PIC S9(0004) COMP.
  3240     05  ADDR2BF PIC  X(0001).
  3241     05  FILLER REDEFINES ADDR2BF.
  3242         10  ADDR2BA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  65
* EL156.cbl
  3243     05  ADDR2BI PIC  X(0030).
  3244*    -------------------------------
  3245     05  ADDR2B2L PIC S9(0004) COMP.
  3246     05  ADDR2B2F PIC  X(0001).
  3247     05  FILLER REDEFINES ADDR2B2F.
  3248         10  ADDR2B2A PIC  X(0001).
  3249     05  ADDR2B2I PIC  X(0030).
  3250*    -------------------------------
  3251     05  CITYSTBL PIC S9(0004) COMP.
  3252     05  CITYSTBF PIC  X(0001).
  3253     05  FILLER REDEFINES CITYSTBF.
  3254         10  CITYSTBA PIC  X(0001).
  3255     05  CITYSTBI PIC  X(0030).
  3256*    -------------------------------
  3257     05  CITYST2L PIC S9(0004) COMP.
  3258     05  CITYST2F PIC  X(0001).
  3259     05  FILLER REDEFINES CITYST2F.
  3260         10  CITYST2A PIC  X(0001).
  3261     05  CITYST2I PIC  X(0030).
  3262*    -------------------------------
  3263     05  ZIPBL PIC S9(0004) COMP.
  3264     05  ZIPBF PIC  X(0001).
  3265     05  FILLER REDEFINES ZIPBF.
  3266         10  ZIPBA PIC  X(0001).
  3267     05  ZIPBI PIC  X(0009).
  3268*    -------------------------------
  3269     05  ZIPB2L PIC S9(0004) COMP.
  3270     05  ZIPB2F PIC  X(0001).
  3271     05  FILLER REDEFINES ZIPB2F.
  3272         10  ZIPB2A PIC  X(0001).
  3273     05  ZIPB2I PIC  X(0009).
  3274*    -------------------------------
  3275     05  INTHDBL PIC S9(0004) COMP.
  3276     05  INTHDBF PIC  X(0001).
  3277     05  FILLER REDEFINES INTHDBF.
  3278         10  INTHDBA PIC  X(0001).
  3279     05  INTHDBI PIC  X(0012).
  3280*    -------------------------------
  3281     05  INTAMTBL PIC S9(0004) COMP.
  3282     05  INTAMTBF PIC  X(0001).
  3283     05  FILLER REDEFINES INTAMTBF.
  3284         10  INTAMTBA PIC  X(0001).
  3285     05  INTAMTBI PIC  X(0011).
  3286*    -------------------------------
  3287     05  PMTHDGBL PIC S9(0004) COMP.
  3288     05  PMTHDGBF PIC  X(0001).
  3289     05  FILLER REDEFINES PMTHDGBF.
  3290         10  PMTHDGBA PIC  X(0001).
  3291     05  PMTHDGBI PIC  X(0034).
  3292*    -------------------------------
  3293     05  CLMNOBL PIC S9(0004) COMP.
  3294     05  CLMNOBF PIC  X(0001).
  3295     05  FILLER REDEFINES CLMNOBF.
  3296         10  CLMNOBA PIC  X(0001).
  3297     05  CLMNOBI PIC  X(0007).
  3298*    -------------------------------
  3299     05  CARRBL PIC S9(0004) COMP.
  3300     05  CARRBF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  66
* EL156.cbl
  3301     05  FILLER REDEFINES CARRBF.
  3302         10  CARRBA PIC  X(0001).
  3303     05  CARRBI PIC  X(0001).
  3304*    -------------------------------
  3305     05  CERTNOBL PIC S9(0004) COMP.
  3306     05  CERTNOBF PIC  X(0001).
  3307     05  FILLER REDEFINES CERTNOBF.
  3308         10  CERTNOBA PIC  X(0001).
  3309     05  CERTNOBI PIC  X(0010).
  3310*    -------------------------------
  3311     05  SUFXBL PIC S9(0004) COMP.
  3312     05  SUFXBF PIC  X(0001).
  3313     05  FILLER REDEFINES SUFXBF.
  3314         10  SUFXBA PIC  X(0001).
  3315     05  SUFXBI PIC  X(0001).
  3316*    -------------------------------
  3317     05  CLMTYPBL PIC S9(0004) COMP.
  3318     05  CLMTYPBF PIC  X(0001).
  3319     05  FILLER REDEFINES CLMTYPBF.
  3320         10  CLMTYPBA PIC  X(0001).
  3321     05  CLMTYPBI PIC  X(0006).
  3322*    -------------------------------
  3323     05  INCURBL PIC S9(0004) COMP.
  3324     05  INCURBF PIC  X(0001).
  3325     05  FILLER REDEFINES INCURBF.
  3326         10  INCURBA PIC  X(0001).
  3327     05  INCURBI PIC  X(0008).
  3328*    -------------------------------
  3329     05  PYFROMBL PIC S9(0004) COMP.
  3330     05  PYFROMBF PIC  X(0001).
  3331     05  FILLER REDEFINES PYFROMBF.
  3332         10  PYFROMBA PIC  X(0001).
  3333     05  PYFROMBI PIC  X(0008).
  3334*    -------------------------------
  3335     05  PYTHRUBL PIC S9(0004) COMP.
  3336     05  PYTHRUBF PIC  X(0001).
  3337     05  FILLER REDEFINES PYTHRUBF.
  3338         10  PYTHRUBA PIC  X(0001).
  3339     05  PYTHRUBI PIC  X(0008).
  3340*    -------------------------------
  3341     05  DAYSBL PIC S9(0004) COMP.
  3342     05  DAYSBF PIC  X(0001).
  3343     05  FILLER REDEFINES DAYSBF.
  3344         10  DAYSBA PIC  X(0001).
  3345     05  DAYSBI PIC  X(0005).
  3346*    -------------------------------
  3347     05  BYBL PIC S9(0004) COMP.
  3348     05  BYBF PIC  X(0001).
  3349     05  FILLER REDEFINES BYBF.
  3350         10  BYBA PIC  X(0001).
  3351     05  BYBI PIC  X(0004).
  3352*    -------------------------------
  3353     05  PROOFDBL PIC S9(0004) COMP.
  3354     05  PROOFDBF PIC  X(0001).
  3355     05  FILLER REDEFINES PROOFDBF.
  3356         10  PROOFDBA PIC  X(0001).
  3357     05  PROOFDBI PIC  X(0008).
  3358*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  67
* EL156.cbl
  3359     05  ACCTBL PIC S9(0004) COMP.
  3360     05  ACCTBF PIC  X(0001).
  3361     05  FILLER REDEFINES ACCTBF.
  3362         10  ACCTBA PIC  X(0001).
  3363     05  ACCTBI PIC  X(0010).
  3364*    -------------------------------
  3365     05  STATEBL PIC S9(0004) COMP.
  3366     05  STATEBF PIC  X(0001).
  3367     05  FILLER REDEFINES STATEBF.
  3368         10  STATEBA PIC  X(0001).
  3369     05  STATEBI PIC  X(0002).
  3370*    -------------------------------
  3371     05  GROUPBL PIC S9(0004) COMP.
  3372     05  GROUPBF PIC  X(0001).
  3373     05  FILLER REDEFINES GROUPBF.
  3374         10  GROUPBA PIC  X(0001).
  3375     05  GROUPBI PIC  X(0006).
  3376*    -------------------------------
  3377     05  ACARRBL PIC S9(0004) COMP.
  3378     05  ACARRBF PIC  X(0001).
  3379     05  FILLER REDEFINES ACARRBF.
  3380         10  ACARRBA PIC  X(0001).
  3381     05  ACARRBI PIC  X(0001).
  3382*    -------------------------------
  3383     05  ACCTNMBL PIC S9(0004) COMP.
  3384     05  ACCTNMBF PIC  X(0001).
  3385     05  FILLER REDEFINES ACCTNMBF.
  3386         10  ACCTNMBA PIC  X(0001).
  3387     05  ACCTNMBI PIC  X(0030).
  3388*    -------------------------------
  3389     05  UNDISBL PIC S9(0004) COMP.
  3390     05  UNDISBF PIC  X(0001).
  3391     05  FILLER REDEFINES UNDISBF.
  3392         10  UNDISBA PIC  X(0001).
  3393     05  UNDISBI PIC  X(0010).
  3394*    -------------------------------
  3395     05  RATEBL PIC S9(0004) COMP.
  3396     05  RATEBF PIC  X(0001).
  3397     05  FILLER REDEFINES RATEBF.
  3398         10  RATEBA PIC  X(0001).
  3399     05  RATEBI PIC  X(0006).
  3400*    -------------------------------
  3401     05  ERMSG1BL PIC S9(0004) COMP.
  3402     05  ERMSG1BF PIC  X(0001).
  3403     05  FILLER REDEFINES ERMSG1BF.
  3404         10  ERMSG1BA PIC  X(0001).
  3405     05  ERMSG1BI PIC  X(0072).
  3406*    -------------------------------
  3407     05  ENTPFBL PIC S9(0004) COMP.
  3408     05  ENTPFBF PIC  X(0001).
  3409     05  FILLER REDEFINES ENTPFBF.
  3410         10  ENTPFBA PIC  X(0001).
  3411     05  ENTPFBI PIC  99.
  3412 01  EL156BO REDEFINES EL156AI.
  3413     05  FILLER            PIC  X(0012).
  3414*    -------------------------------
  3415     05  FILLER            PIC  X(0003).
  3416     05  RUNDTEBO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  68
* EL156.cbl
  3417*    -------------------------------
  3418     05  FILLER            PIC  X(0003).
  3419     05  RUNTIMBO PIC  99.99.
  3420*    -------------------------------
  3421     05  FILLER            PIC  X(0003).
  3422     05  PAYDTBO PIC  99B99B99.
  3423*    -------------------------------
  3424     05  FILLER            PIC  X(0003).
  3425     05  PAYTYPBO PIC  X(0015).
  3426*    -------------------------------
  3427     05  FILLER            PIC  X(0003).
  3428     05  PAYAMTBO PIC  ZZZZ,ZZ9.99.
  3429*    -------------------------------
  3430     05  FILLER            PIC  X(0003).
  3431     05  LOANHBO PIC  X(0012).
  3432*    -------------------------------
  3433     05  FILLER            PIC  X(0003).
  3434     05  LOANNBO PIC  X(0025).
  3435*    -------------------------------
  3436     05  FILLER            PIC  X(0003).
  3437     05  CKNUMHDO PIC  X(0012).
  3438*    -------------------------------
  3439     05  FILLER            PIC  X(0003).
  3440     05  CKNUMBO PIC  X(0007).
  3441*    -------------------------------
  3442     05  FILLER            PIC  X(0003).
  3443     05  AGTHDGO PIC  X(0016).
  3444*    -------------------------------
  3445     05  FILLER            PIC  X(0003).
  3446     05  NAMEBO PIC  X(0030).
  3447*    -------------------------------
  3448     05  FILLER            PIC  X(0003).
  3449     05  NAMEB2O PIC  X(0030).
  3450*    -------------------------------
  3451     05  FILLER            PIC  X(0003).
  3452     05  ADDR1BO PIC  X(0030).
  3453*    -------------------------------
  3454     05  FILLER            PIC  X(0003).
  3455     05  ADDR1B2O PIC  X(0030).
  3456*    -------------------------------
  3457     05  FILLER            PIC  X(0003).
  3458     05  ADDR2BO PIC  X(0030).
  3459*    -------------------------------
  3460     05  FILLER            PIC  X(0003).
  3461     05  ADDR2B2O PIC  X(0030).
  3462*    -------------------------------
  3463     05  FILLER            PIC  X(0003).
  3464     05  CITYSTBO PIC  X(0030).
  3465*    -------------------------------
  3466     05  FILLER            PIC  X(0003).
  3467     05  CITYST2O PIC  X(0030).
  3468*    -------------------------------
  3469     05  FILLER            PIC  X(0003).
  3470     05  ZIPBO PIC  ZZZZ99999.
  3471*    -------------------------------
  3472     05  FILLER            PIC  X(0003).
  3473     05  ZIPB2O PIC  ZZZZZZZZZ.
  3474*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  69
* EL156.cbl
  3475     05  FILLER            PIC  X(0003).
  3476     05  INTHDBO PIC  X(0012).
  3477*    -------------------------------
  3478     05  FILLER            PIC  X(0003).
  3479     05  INTAMTBO PIC  ZZZZ,ZZZ.ZZ.
  3480*    -------------------------------
  3481     05  FILLER            PIC  X(0003).
  3482     05  PMTHDGBO PIC  X(0034).
  3483*    -------------------------------
  3484     05  FILLER            PIC  X(0003).
  3485     05  CLMNOBO PIC  X(0007).
  3486*    -------------------------------
  3487     05  FILLER            PIC  X(0003).
  3488     05  CARRBO PIC  X(0001).
  3489*    -------------------------------
  3490     05  FILLER            PIC  X(0003).
  3491     05  CERTNOBO PIC  X(0010).
  3492*    -------------------------------
  3493     05  FILLER            PIC  X(0003).
  3494     05  SUFXBO PIC  X(0001).
  3495*    -------------------------------
  3496     05  FILLER            PIC  X(0003).
  3497     05  CLMTYPBO PIC  X(0006).
  3498*    -------------------------------
  3499     05  FILLER            PIC  X(0003).
  3500     05  INCURBO PIC  X(0008).
  3501*    -------------------------------
  3502     05  FILLER            PIC  X(0003).
  3503     05  PYFROMBO PIC  99B99B99.
  3504*    -------------------------------
  3505     05  FILLER            PIC  X(0003).
  3506     05  PYTHRUBO PIC  99B99B99.
  3507*    -------------------------------
  3508     05  FILLER            PIC  X(0003).
  3509     05  DAYSBO PIC  X(0005).
  3510*    -------------------------------
  3511     05  FILLER            PIC  X(0003).
  3512     05  BYBO PIC  X(0004).
  3513*    -------------------------------
  3514     05  FILLER            PIC  X(0003).
  3515     05  PROOFDBO PIC  99B99B99.
  3516*    -------------------------------
  3517     05  FILLER            PIC  X(0003).
  3518     05  ACCTBO PIC  X(0010).
  3519*    -------------------------------
  3520     05  FILLER            PIC  X(0003).
  3521     05  STATEBO PIC  X(0002).
  3522*    -------------------------------
  3523     05  FILLER            PIC  X(0003).
  3524     05  GROUPBO PIC  X(0006).
  3525*    -------------------------------
  3526     05  FILLER            PIC  X(0003).
  3527     05  ACARRBO PIC  X(0001).
  3528*    -------------------------------
  3529     05  FILLER            PIC  X(0003).
  3530     05  ACCTNMBO PIC  X(0030).
  3531*    -------------------------------
  3532     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  70
* EL156.cbl
  3533     05  UNDISBO PIC  ZZZ,Z99.99.
  3534*    -------------------------------
  3535     05  FILLER            PIC  X(0003).
  3536     05  RATEBO PIC  ZZZ.99.
  3537*    -------------------------------
  3538     05  FILLER            PIC  X(0003).
  3539     05  ERMSG1BO PIC  X(0072).
  3540*    -------------------------------
  3541     05  FILLER            PIC  X(0003).
  3542     05  ENTPFBO PIC  X(0002).
  3543*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  71
* EL156.cbl
  3545****************************************************************
  3546*
  3547* Copyright (c) 2007 by Clerity Solutions, Inc.
  3548* All rights reserved.
  3549*
  3550****************************************************************
  3551 01  DFHEIV.
  3552   02  DFHEIV0               PIC X(35).
  3553   02  DFHEIV1               PIC X(08).
  3554   02  DFHEIV2               PIC X(08).
  3555   02  DFHEIV3               PIC X(08).
  3556   02  DFHEIV4               PIC X(06).
  3557   02  DFHEIV5               PIC X(04).
  3558   02  DFHEIV6               PIC X(04).
  3559   02  DFHEIV7               PIC X(02).
  3560   02  DFHEIV8               PIC X(02).
  3561   02  DFHEIV9               PIC X(01).
  3562   02  DFHEIV10              PIC S9(7) COMP-3.
  3563   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3564   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3565   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3566   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3567   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3568   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3569   02  DFHEIV17              PIC X(04).
  3570   02  DFHEIV18              PIC X(04).
  3571   02  DFHEIV19              PIC X(04).
  3572   02  DFHEIV20              USAGE IS POINTER.
  3573   02  DFHEIV21              USAGE IS POINTER.
  3574   02  DFHEIV22              USAGE IS POINTER.
  3575   02  DFHEIV23              USAGE IS POINTER.
  3576   02  DFHEIV24              USAGE IS POINTER.
  3577   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3578   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3579   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3580   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3581   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3582   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3583   02  FILLER                PIC X(02).
  3584   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3585   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3586   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3587   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3588   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3589 LINKAGE  SECTION.
  3590*****************************************************************
  3591*                                                               *
  3592* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3593* All rights reserved.                                          *
  3594*                                                               *
  3595*****************************************************************
  3596 01  dfheiblk.
  3597     02  eibtime          pic s9(7) comp-3.
  3598     02  eibdate          pic s9(7) comp-3.
  3599     02  eibtrnid         pic x(4).
  3600     02  eibtaskn         pic s9(7) comp-3.
  3601     02  eibtrmid         pic x(4).
  3602     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  72
* EL156.cbl
  3603     02  eibcposn         pic s9(4) comp.
  3604     02  eibcalen         pic s9(4) comp.
  3605     02  eibaid           pic x(1).
  3606     02  eibfiller1       pic x(1).
  3607     02  eibfn            pic x(2).
  3608     02  eibfiller2       pic x(2).
  3609     02  eibrcode         pic x(6).
  3610     02  eibfiller3       pic x(2).
  3611     02  eibds            pic x(8).
  3612     02  eibreqid         pic x(8).
  3613     02  eibrsrce         pic x(8).
  3614     02  eibsync          pic x(1).
  3615     02  eibfree          pic x(1).
  3616     02  eibrecv          pic x(1).
  3617     02  eibsend          pic x(1).
  3618     02  eibatt           pic x(1).
  3619     02  eibeoc           pic x(1).
  3620     02  eibfmh           pic x(1).
  3621     02  eibcompl         pic x(1).
  3622     02  eibsig           pic x(1).
  3623     02  eibconf          pic x(1).
  3624     02  eiberr           pic x(1).
  3625     02  eibrldbk         pic x(1).
  3626     02  eiberrcd         pic x(4).
  3627     02  eibsynrb         pic x(1).
  3628     02  eibnodat         pic x(1).
  3629     02  eibfiller5       pic x(2).
  3630     02  eibresp          pic 9(09) comp.
  3631     02  eibresp2         pic 9(09) comp.
  3632     02  dfheigdj         pic s9(4) comp.
  3633     02  dfheigdk         pic s9(4) comp.
  3634 01  DFHCOMMAREA             PIC X(1024).
  3635
  3636*    COPY ELCMSTR.
  3637******************************************************************
  3638*                                                                *
  3639*                            ELCMSTR.                            *
  3640*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3641*                            VMOD=2.012                          *
  3642*                                                                *
  3643*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3644*                                                                *
  3645*   FILE TYPE = VSAM,KSDS                                        *
  3646*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3647*                                                                *
  3648*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3649*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3650*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3651*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3652*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3653*                                                 RKP=75,LEN=21  *
  3654*                                                                *
  3655*   **** NOTE ****                                               *
  3656*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3657*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3658*                                                                *
  3659*   LOG = YES                                                    *
  3660*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  73
* EL156.cbl
  3661******************************************************************
  3662*                   C H A N G E   L O G
  3663*
  3664* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3665*-----------------------------------------------------------------
  3666*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3667* EFFECTIVE    NUMBER
  3668*-----------------------------------------------------------------
  3669* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3670* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3671******************************************************************
  3672 01  CLAIM-MASTER.
  3673     12  CL-RECORD-ID                PIC XX.
  3674         88  VALID-CL-ID         VALUE 'CL'.
  3675
  3676     12  CL-CONTROL-PRIMARY.
  3677         16  CL-COMPANY-CD           PIC X.
  3678         16  CL-CARRIER              PIC X.
  3679         16  CL-CLAIM-NO             PIC X(7).
  3680         16  CL-CERT-NO.
  3681             20  CL-CERT-PRIME       PIC X(10).
  3682             20  CL-CERT-SFX         PIC X.
  3683
  3684     12  CL-CONTROL-BY-NAME.
  3685         16  CL-COMPANY-CD-A1        PIC X.
  3686         16  CL-INSURED-LAST-NAME    PIC X(15).
  3687         16  CL-INSURED-NAME.
  3688             20  CL-INSURED-1ST-NAME PIC X(12).
  3689             20  CL-INSURED-MID-INIT PIC X.
  3690
  3691     12  CL-CONTROL-BY-SSN.
  3692         16  CL-COMPANY-CD-A2        PIC X.
  3693         16  CL-SOC-SEC-NO.
  3694             20  CL-SSN-STATE        PIC XX.
  3695             20  CL-SSN-ACCOUNT      PIC X(6).
  3696             20  CL-SSN-LN3          PIC X(3).
  3697
  3698     12  CL-CONTROL-BY-CERT-NO.
  3699         16  CL-COMPANY-CD-A4        PIC X.
  3700         16  CL-CERT-NO-A4.
  3701             20  CL-CERT-A4-PRIME    PIC X(10).
  3702             20  CL-CERT-A4-SFX      PIC X.
  3703
  3704     12  CL-CONTROL-BY-CCN.
  3705         16  CL-COMPANY-CD-A5        PIC X.
  3706         16  CL-CCN-A5.
  3707             20  CL-CCN.
  3708                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3709                 24  CL-CCN-PRIME-A5 PIC X(12).
  3710             20  CL-CCN-FILLER-A5    PIC X(4).
  3711
  3712     12  CL-INSURED-PROFILE-DATA.
  3713         16  CL-INSURED-BIRTH-DT     PIC XX.
  3714         16  CL-INSURED-SEX-CD       PIC X.
  3715             88  INSURED-IS-MALE        VALUE 'M'.
  3716             88  INSURED-IS-FEMALE      VALUE 'F'.
  3717             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3718         16  CL-INSURED-OCC-CD       PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  74
* EL156.cbl
  3719         16  FILLER                  PIC X(5).
  3720
  3721     12  CL-PROCESSING-INFO.
  3722         16  CL-PROCESSOR-ID         PIC X(4).
  3723         16  CL-CLAIM-STATUS         PIC X.
  3724             88  CLAIM-IS-OPEN          VALUE 'O'.
  3725             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3726         16  CL-CLAIM-TYPE           PIC X.
  3727*            88  AH-CLAIM               VALUE 'A'.
  3728*            88  LIFE-CLAIM             VALUE 'L'.
  3729*            88  PROPERTY-CLAIM         VALUE 'P'.
  3730*            88  IUI-CLAIM              VALUE 'I'.
  3731*            88  GAP-CLAIM              VALUE 'G'.
  3732         16  CL-CLAIM-PREM-TYPE      PIC X.
  3733             88  SINGLE-PREMIUM         VALUE '1'.
  3734             88  O-B-COVERAGE           VALUE '2'.
  3735             88  OPEN-END-COVERAGE      VALUE '3'.
  3736         16  CL-INCURRED-DT          PIC XX.
  3737         16  CL-REPORTED-DT          PIC XX.
  3738         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3739         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3740         16  CL-LAST-PMT-DT          PIC XX.
  3741         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3742         16  CL-PAID-THRU-DT         PIC XX.
  3743         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3744         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3745         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3746         16  CL-PMT-CALC-METHOD      PIC X.
  3747             88  CL-360-DAY-YR          VALUE '1'.
  3748             88  CL-365-DAY-YR          VALUE '2'.
  3749             88  CL-FULL-MONTHS         VALUE '3'.
  3750         16  CL-CAUSE-CD             PIC X(6).
  3751
  3752         16  CL-PRIME-CERT-NO.
  3753             20  CL-PRIME-CERT-PRIME PIC X(10).
  3754             20  CL-PRIME-CERT-SFX   PIC X.
  3755
  3756         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3757             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3758             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3759
  3760         16  CL-MICROFILM-NO         PIC X(10).
  3761         16  CL-PROG-FORM-TYPE       PIC X.
  3762         16  CL-LAST-ADD-ON-DT       PIC XX.
  3763
  3764         16  CL-LAST-REOPEN-DT       PIC XX.
  3765         16  CL-LAST-CLOSE-DT        PIC XX.
  3766         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3767             88  FINAL-PAID             VALUE '1'.
  3768             88  CLAIM-DENIED           VALUE '2'.
  3769             88  AUTO-CLOSE             VALUE '3'.
  3770             88  MANUAL-CLOSE           VALUE '4'.
  3771             88  BENEFITS-CHANGED       VALUE 'C'.
  3772             88  SETUP-ERRORS           VALUE 'E'.
  3773         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3774         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3775         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3776             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  75
* EL156.cbl
  3777         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3778         16  FILLER                  PIC X.
  3779
  3780     12  CL-CERTIFICATE-DATA.
  3781         16  CL-CERT-ORIGIN          PIC X.
  3782             88  CERT-WAS-ONLINE        VALUE '1'.
  3783             88  CERT-WAS-CREATED       VALUE '2'.
  3784             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3785         16  CL-CERT-KEY-DATA.
  3786             20  CL-CERT-CARRIER     PIC X.
  3787             20  CL-CERT-GROUPING    PIC X(6).
  3788             20  CL-CERT-STATE       PIC XX.
  3789             20  CL-CERT-ACCOUNT.
  3790                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3791                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3792             20  CL-CERT-EFF-DT      PIC XX.
  3793
  3794     12  CL-STATUS-CONTROLS.
  3795         16  CL-PRIORITY-CD          PIC X.
  3796             88  CONFIDENTIAL-DATA      VALUE '8'.
  3797             88  HIGHEST-PRIORITY       VALUE '9'.
  3798         16  CL-SUPV-ATTN-CD         PIC X.
  3799             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3800             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3801         16  CL-PURGED-DT            PIC XX.
  3802         16  CL-RESTORED-DT          PIC XX.
  3803         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3804         16  CL-NEXT-RESEND-DT       PIC XX.
  3805         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3806         16  FILLER                  PIC XX.
  3807         16  CL-LAST-MAINT-DT        PIC XX.
  3808         16  CL-LAST-MAINT-USER      PIC X(4).
  3809         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3810         16  CL-LAST-MAINT-TYPE      PIC X.
  3811             88  CLAIM-SET-UP           VALUE ' '.
  3812             88  PAYMENT-MADE           VALUE '1'.
  3813             88  LETTER-SENT            VALUE '2'.
  3814             88  MASTER-WAS-ALTERED     VALUE '3'.
  3815             88  MASTER-WAS-RESTORED    VALUE '4'.
  3816             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3817             88  FILE-CONVERTED         VALUE '6'.
  3818             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3819             88  ERROR-CORRECTION       VALUE 'E'.
  3820         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3821         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3822         16  CL-BENEFICIARY          PIC X(10).
  3823         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3824         16  CL-DENIAL-TYPE          PIC X.
  3825             88  CL-TYPE-DENIAL          VALUE '1'.
  3826             88  CL-TYPE-RESCISSION      VALUE '2'.
  3827             88  CL-TYPE-REFORMATION     VALUE '3'.
  3828             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3829             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3830         16  FILLER                  PIC X(5).
  3831
  3832     12  CL-TRAILER-CONTROLS.
  3833         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3834             88  CL-1ST-TRL-AVAIL       VALUE +4095.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  76
* EL156.cbl
  3835             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3836             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3837         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3838         16  FILLER                  PIC XX.
  3839         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3840         16  CL-ADDRESS-TRAILER-CNT.
  3841             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3842                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3843             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3844                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3845             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3846                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3847             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3848                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3849             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3850                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3851             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3852                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3853             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3854                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3855
  3856     12  CL-CV-REFERENCE-NO.
  3857         16  CL-CV-REFNO-PRIME       PIC X(18).
  3858         16  CL-CV-REFNO-SFX         PIC XX.
  3859
  3860     12  CL-FILE-LOCATION            PIC X(4).
  3861
  3862     12  CL-PROCESS-ERRORS.
  3863         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3864             88  NO-FATAL-ERRORS        VALUE ZERO.
  3865         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3866             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3867
  3868     12  CL-PRODUCT-CD               PIC X.
  3869
  3870     12  CL-CURRENT-KEY-DATA.
  3871         16  CL-CURRENT-CARRIER      PIC X.
  3872         16  CL-CURRENT-GROUPING     PIC X(6).
  3873         16  CL-CURRENT-STATE        PIC XX.
  3874         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3875
  3876     12  CL-ASSOCIATES               PIC X.
  3877         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3878         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3879         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3880         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3881
  3882     12  CL-ACTIVITY-CODE            PIC 99.
  3883     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3884     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3885
  3886     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3887     12  CL-LAG-REPORT-CODE          PIC 9.
  3888     12  CL-LOAN-TYPE                PIC XX.
  3889     12  CL-LEGAL-STATE              PIC XX.
  3890
  3891*    12  FILLER                      PIC X(5).
  3892     12  CL-YESNOSW                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  77
* EL156.cbl
  3893     12  FILLER                      PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  78
* EL156.cbl
  3895*    COPY ELCCNTL.
  3896******************************************************************
  3897*                                                                *
  3898*                                                                *
  3899*                            ELCCNTL.                            *
  3900*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3901*                            VMOD=2.059                          *
  3902*                                                                *
  3903*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3904*                                                                *
  3905*   FILE TYPE = VSAM,KSDS                                        *
  3906*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3907*                                                                *
  3908*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3909*       ALTERNATE INDEX = NONE                                   *
  3910*                                                                *
  3911*   LOG = YES                                                    *
  3912*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3913******************************************************************
  3914*                   C H A N G E   L O G
  3915*
  3916* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3917*-----------------------------------------------------------------
  3918*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3919* EFFECTIVE    NUMBER
  3920*-----------------------------------------------------------------
  3921* 082503                   PEMA  ADD BENEFIT GROUP
  3922* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3923* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3924* 092705    2005050300006  PEMA  ADD SPP LEASES
  3925* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3926* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3927* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3928* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3929******************************************************************
  3930*
  3931 01  CONTROL-FILE.
  3932     12  CF-RECORD-ID                       PIC XX.
  3933         88  VALID-CF-ID                        VALUE 'CF'.
  3934
  3935     12  CF-CONTROL-PRIMARY.
  3936         16  CF-COMPANY-ID                  PIC XXX.
  3937         16  CF-RECORD-TYPE                 PIC X.
  3938             88  CF-COMPANY-MASTER              VALUE '1'.
  3939             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3940             88  CF-STATE-MASTER                VALUE '3'.
  3941             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3942             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3943             88  CF-CARRIER-MASTER              VALUE '6'.
  3944             88  CF-MORTALITY-MASTER            VALUE '7'.
  3945             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3946             88  CF-TERMINAL-MASTER             VALUE '9'.
  3947             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3948             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3949             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3950             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3951             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  3952             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  79
* EL156.cbl
  3953             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3954             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3955             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3956         16  CF-ACCESS-CD-GENL              PIC X(4).
  3957         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3958             20  CF-PROCESSOR               PIC X(4).
  3959         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3960             20  CF-STATE-CODE              PIC XX.
  3961             20  FILLER                     PIC XX.
  3962         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3963             20  FILLER                     PIC XX.
  3964             20  CF-HI-BEN-IN-REC           PIC XX.
  3965         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3966             20  FILLER                     PIC XXX.
  3967             20  CF-CARRIER-CNTL            PIC X.
  3968         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3969             20  FILLER                     PIC XX.
  3970             20  CF-HI-TYPE-IN-REC          PIC 99.
  3971         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3972             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3973                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3974             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3975             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3976         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3977             20  FILLER                     PIC X.
  3978             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3979         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3980             20  FILLER                     PIC XX.
  3981             20  CF-MORTGAGE-PLAN           PIC XX.
  3982         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3983
  3984     12  CF-LAST-MAINT-DT                   PIC XX.
  3985     12  CF-LAST-MAINT-BY                   PIC X(4).
  3986     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3987
  3988     12  CF-RECORD-BODY                     PIC X(728).
  3989
  3990
  3991****************************************************************
  3992*             COMPANY MASTER RECORD                            *
  3993****************************************************************
  3994
  3995     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3996         16  CF-COMPANY-ADDRESS.
  3997             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3998             20  CF-CL-IN-CARE-OF           PIC X(30).
  3999             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4000             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4001             20  CF-CL-CITY-STATE           PIC X(30).
  4002             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4003             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4004         16  CF-COMPANY-CD                  PIC X.
  4005         16  CF-COMPANY-PASSWORD            PIC X(8).
  4006         16  CF-SECURITY-OPTION             PIC X.
  4007             88  ALL-SECURITY                   VALUE '1'.
  4008             88  COMPANY-VERIFY                 VALUE '2'.
  4009             88  PROCESSOR-VERIFY               VALUE '3'.
  4010             88  NO-SECURITY                    VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  80
* EL156.cbl
  4011             88  ALL-BUT-TERM                   VALUE '5'.
  4012         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4013             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4014         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4015             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4016         16  CF-INFORCE-LOCATION            PIC X.
  4017             88  CERTS-ARE-ONLINE               VALUE '1'.
  4018             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4019             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4020         16  CF-LOWER-CASE-LETTERS          PIC X.
  4021         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4022             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4023             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4024             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4025             88  CF-ACCNT-CNTL                  VALUE '3'.
  4026             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4027
  4028         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4029         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4030
  4031         16  CF-LGX-CREDIT-USER             PIC X.
  4032             88  CO-IS-NOT-USER                 VALUE 'N'.
  4033             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4034
  4035         16 CF-CREDIT-CALC-CODES.
  4036             20  CF-CR-REM-TERM-CALC PIC X.
  4037               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4038               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4039               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4040               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4041               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4042               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4043               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4044             20  CF-CR-R78-METHOD           PIC X.
  4045               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4046               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4047
  4048         16  CF-CLAIM-CONTROL-COUNTS.
  4049             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4050                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4051
  4052             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4053                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4054
  4055             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4056                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4057
  4058             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4059                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4060
  4061         16  CF-CURRENT-MONTH-END           PIC XX.
  4062
  4063         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4064             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4065             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4066             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4067             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4068                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  81
* EL156.cbl
  4069                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4070             20  CF-CO-PREM-REJECT-SW       PIC X.
  4071                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4072                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4073             20  CF-CO-REF-REJECT-SW        PIC X.
  4074                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4075                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4076
  4077         16  CF-CO-REPORTING-DT             PIC XX.
  4078         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4079         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4080           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4081           88  CF-CO-MONTH-END                  VALUE '1'.
  4082
  4083         16  CF-LGX-CLAIM-USER              PIC X.
  4084             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4085             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4086
  4087         16  CF-CREDIT-EDIT-CONTROLS.
  4088             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4089             20  CF-MIN-AGE                 PIC 99.
  4090             20  CF-DEFAULT-AGE             PIC 99.
  4091             20  CF-MIN-TERM                PIC S999      COMP-3.
  4092             20  CF-MAX-TERM                PIC S999      COMP-3.
  4093             20  CF-DEFAULT-SEX             PIC X.
  4094             20  CF-JOINT-AGE-INPUT         PIC X.
  4095                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4096             20  CF-BIRTH-DATE-INPUT        PIC X.
  4097                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4098             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4099                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4100                 88  CF-ZERO-CARRIER            VALUE '1'.
  4101                 88  CF-ZERO-GROUPING           VALUE '2'.
  4102                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4103             20  CF-EDIT-SW                 PIC X.
  4104                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4105             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4106             20  CF-CR-PR-METHOD            PIC X.
  4107               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4108               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4109             20  FILLER                     PIC X.
  4110
  4111         16  CF-CREDIT-MISC-CONTROLS.
  4112             20  CF-REIN-TABLE-SW           PIC X.
  4113                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4114             20  CF-COMP-TABLE-SW           PIC X.
  4115                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4116             20  CF-EXPERIENCE-RETENTION-AGE
  4117                                            PIC S9        COMP-3.
  4118             20  CF-CONVERSION-DT           PIC XX.
  4119             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4120             20  CF-RUN-FREQUENCY-SW        PIC X.
  4121                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4122                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4123
  4124             20  CF-CR-CHECK-NO-CONTROL.
  4125                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4126                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  82
* EL156.cbl
  4127                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4128                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4129                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4130                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4131
  4132                 24  CF-CR-CHECK-COUNT       REDEFINES
  4133                     CF-CR-CHECK-COUNTER      PIC X(4).
  4134
  4135                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4136                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4137
  4138                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4139                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4140                 24  CF-MAIL-PROCESSING       PIC X.
  4141                     88  MAIL-PROCESSING          VALUE 'Y'.
  4142
  4143         16  CF-MISC-SYSTEM-CONTROL.
  4144             20  CF-SYSTEM-C                 PIC X.
  4145                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4146             20  CF-SYSTEM-D                 PIC X.
  4147                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4148             20  CF-SOC-SEC-NO-SW            PIC X.
  4149                 88  SOC-SEC-NO-USED             VALUE '1'.
  4150             20  CF-MEMBER-NO-SW             PIC X.
  4151                 88  MEMBER-NO-USED              VALUE '1'.
  4152             20  CF-TAX-ID-NUMBER            PIC X(11).
  4153             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4154             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4155                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4156                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4157                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4158                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4159             20  CF-SYSTEM-E                 PIC X.
  4160                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4161
  4162         16  CF-LGX-LIFE-USER               PIC X.
  4163             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4164             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4165
  4166         16  CF-CR-MONTH-END-DT             PIC XX.
  4167
  4168         16  CF-FILE-MAINT-DATES.
  4169             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4170                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4171             20  CF-LAST-BATCH       REDEFINES
  4172                 CF-LAST-BATCH-NO               PIC X(4).
  4173             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4174             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4175             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4176             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4177             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4178             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  4179             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4180             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4181             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4182             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4183
  4184         16  CF-NEXT-COMPANY-ID             PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  83
* EL156.cbl
  4185         16  FILLER                         PIC X.
  4186
  4187         16  CF-ALT-MORT-CODE               PIC X(4).
  4188         16  CF-MEMBER-CAPTION              PIC X(10).
  4189
  4190         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4191             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4192             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4193             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4194             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4195             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4196
  4197         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4198
  4199         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4200         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4201         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4202         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4203
  4204         16  CF-AH-OVERRIDE-L1              PIC X.
  4205         16  CF-AH-OVERRIDE-L2              PIC XX.
  4206         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4207         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4208
  4209         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4210         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4211
  4212         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4213         16  CF-AR-LAST-EL860-DT            PIC XX.
  4214         16  CF-MP-MONTH-END-DT             PIC XX.
  4215
  4216         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4217         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4218             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4219
  4220         16  CF-AR-MONTH-END-DT             PIC XX.
  4221
  4222         16  CF-CRDTCRD-USER                PIC X.
  4223             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4224             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4225
  4226         16  CF-CC-MONTH-END-DT             PIC XX.
  4227
  4228         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4229
  4230         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4231             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4232             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4233             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4234         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4235         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  4236         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  4237         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  4238             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4239             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4240         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4241         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4242         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  84
* EL156.cbl
  4243             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4244         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4245
  4246         16  CF-CL-ZIP-CODE.
  4247             20  CF-CL-ZIP-PRIME.
  4248                 24  CF-CL-ZIP-1ST          PIC X.
  4249                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4250                 24  FILLER                 PIC X(4).
  4251             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4252         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4253             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4254             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4255             20  FILLER                     PIC XXX.
  4256
  4257         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4258         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4259         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4260         16  CF-CO-OPTION-START-DATE        PIC XX.
  4261         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4262           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4263                                                      '3' '4'.
  4264           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4265           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4266           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4267           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4268           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4269           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4270
  4271         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4272
  4273         16  CF-PAYMENT-APPROVAL-LEVELS.
  4274             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4275             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4276             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4277             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  4278             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4279             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4280
  4281         16  CF-END-USER-REPORTING-USER     PIC X.
  4282             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4283             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4284
  4285         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4286             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4287             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4288
  4289         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4290
  4291         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4292         16  FILLER                         PIC X.
  4293
  4294         16  CF-CREDIT-ARCHIVE-CNTL.
  4295             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  4296             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4297             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4298
  4299         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  4300
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  85
* EL156.cbl
  4301         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4302             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4303             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4304
  4305         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4306             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4307             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4308
  4309         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4310
  4311         16  CF-CO-ACH-ID-CODE              PIC  X.
  4312             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4313             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4314             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4315         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4316         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  4317         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4318         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  4319         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  4320         16  CF-CO-ACH-RECV-NO              PIC X(08).
  4321         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  4322         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  4323         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  4324                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  4325         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  4326                 CF-CO-ACH-TRACE-NO         PIC X(4).
  4327
  4328         16  CF-CO-OVER-SHORT.
  4329             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4330             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4331
  4332*         16  FILLER                         PIC X(102).
  4333         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  4334             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  4335             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  4336
  4337         16  CF-AH-APPROVAL-DAYS.
  4338             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  4339             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  4340             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  4341             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  4342
  4343         16  FILLER                         PIC X(82).
  4344****************************************************************
  4345*             PROCESSOR/USER RECORD                            *
  4346****************************************************************
  4347
  4348     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4349         16  CF-PROCESSOR-NAME              PIC X(30).
  4350         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4351         16  CF-PROCESSOR-TITLE             PIC X(26).
  4352         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4353                 88  MESSAGE-YES                VALUE 'Y'.
  4354                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4355
  4356*****************************************************
  4357****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4358****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  86
* EL156.cbl
  4359****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4360****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4361*****************************************************
  4362
  4363         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4364             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4365             20  CF-APPLICATION-FORCE       PIC X.
  4366             20  CF-INDIVIDUAL-APP.
  4367                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4368                     28  CF-BROWSE-APP      PIC X.
  4369                     28  CF-UPDATE-APP      PIC X.
  4370
  4371         16  CF-CURRENT-TERM-ON             PIC X(4).
  4372         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4373             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4374             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4375             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4376             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4377             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4378             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4379             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4380         16  CF-PROCESSOR-CARRIER           PIC X.
  4381             88  NO-CARRIER-SECURITY            VALUE ' '.
  4382         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4383             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4384         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4385             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4386         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4387             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4388
  4389         16  CF-PROC-SYS-ACCESS-SW.
  4390             20  CF-PROC-CREDIT-CLAIMS-SW.
  4391                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4392                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4393                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4394                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4395             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4396                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4397                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4398             20  CF-PROC-LIFE-GNRLDGR-SW.
  4399                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4400                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4401                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4402                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  4403             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  4404                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4405                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4406         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4407             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4408             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4409         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4410
  4411         16  CF-APPROVAL-LEVEL                  PIC X.
  4412             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4413             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4414             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4415             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4416
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  87
* EL156.cbl
  4417         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4418
  4419         16  CF-LANGUAGE-TYPE                   PIC X.
  4420             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4421             88  CF-LANG-IS-FR                      VALUE 'F'.
  4422         16  FILLER                             PIC  X(240).
  4423
  4424****************************************************************
  4425*             PROCESSOR/REMINDERS RECORD                       *
  4426****************************************************************
  4427
  4428     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4429         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4430             20  CF-START-REMIND-DT         PIC XX.
  4431             20  CF-END-REMIND-DT           PIC XX.
  4432             20  CF-REMINDER-TEXT           PIC X(50).
  4433         16  FILLER                         PIC X(296).
  4434
  4435
  4436****************************************************************
  4437*             STATE MASTER RECORD                              *
  4438****************************************************************
  4439
  4440     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4441         16  CF-STATE-ABBREVIATION          PIC XX.
  4442         16  CF-STATE-NAME                  PIC X(25).
  4443         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4444         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4445             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4446             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4447             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4448             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4449                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4450                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4451             20  CF-ST-PREM-REJECT-SW       PIC X.
  4452                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4453                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4454             20  CF-ST-REF-REJECT-SW        PIC X.
  4455                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4456                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4457         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4458         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  4459         16  CF-ST-REFUND-RULES.
  4460             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4461             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4462             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4463         16  CF-ST-FST-PMT-EXTENSION.
  4464             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4465             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4466                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4467                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4468                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4469                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4470         16  CF-ST-STATE-CALL.
  4471             20  CF-ST-CALL-UNEARNED        PIC X.
  4472             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4473             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4474         16  CF-REPLACEMENT-LAW-SW          PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  88
* EL156.cbl
  4475             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4476             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4477         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4478         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4479         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4480         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4481         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4482         16  FILLER                         PIC X.
  4483         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4484             20  CF-ST-BENEFIT-CD           PIC XX.
  4485             20  CF-ST-BENEFIT-KIND         PIC X.
  4486                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4487                 88  CF-ST-AH-KIND              VALUE 'A'.
  4488             20  CF-ST-REM-TERM-CALC        PIC X.
  4489                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4490                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4491                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4492                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4493                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4494                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4495                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4496                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4497
  4498             20  CF-ST-REFUND-CALC          PIC X.
  4499                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4500                 88  ST-REFD-BY-R78             VALUE '1'.
  4501                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4502                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4503                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4504                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4505                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4506                 88  ST-REFD-UTAH               VALUE '7'.
  4507                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4508                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4509                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4510
  4511             20  CF-ST-EARNING-CALC         PIC X.
  4512                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4513                 88  ST-EARN-BY-R78             VALUE '1'.
  4514                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4515                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4516                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  4517                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4518                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4519                 88  ST-EARN-MEAN               VALUE '8'.
  4520                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4521
  4522             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4523                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4524                 88  ST-OVRD-BY-R78             VALUE '1'.
  4525                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4526                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4527                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4528                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4529                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4530                 88  ST-OVRD-MEAN               VALUE '8'.
  4531                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4532             20  FILLER                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  89
* EL156.cbl
  4533
  4534         16  CF-ST-COMMISSION-CAPS.
  4535             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4536             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4537             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4538             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4539         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4540                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4541
  4542         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4543
  4544         16  CF-ST-STATUTORY-INTEREST.
  4545             20  CF-ST-STAT-DATE-FROM       PIC X.
  4546                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4547                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4548             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4549             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4550             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4551             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4552             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4553
  4554         16  CF-ST-OVER-SHORT.
  4555             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4556             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4557
  4558         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4559
  4560         16  CF-ST-RT-CALC                  PIC X.
  4561
  4562         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4563         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4564         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4565         16  CF-ST-RF-LR-CALC               PIC X.
  4566         16  CF-ST-RF-LL-CALC               PIC X.
  4567         16  CF-ST-RF-LN-CALC               PIC X.
  4568         16  CF-ST-RF-AH-CALC               PIC X.
  4569         16  CF-ST-RF-CP-CALC               PIC X.
  4570*        16  FILLER                         PIC X(206).
  4571*CIDMOD         16  FILLER                         PIC X(192).
  4572         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4573             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4574         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4575         16  FILLER                         PIC X(187).
  4576
  4577****************************************************************
  4578*             BENEFIT MASTER RECORD                            *
  4579****************************************************************
  4580
  4581     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4582         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4583             20  CF-BENEFIT-CODE            PIC XX.
  4584             20  CF-BENEFIT-NUMERIC  REDEFINES
  4585                 CF-BENEFIT-CODE            PIC XX.
  4586             20  CF-BENEFIT-ALPHA           PIC XXX.
  4587             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4588             20  CF-BENEFIT-COMMENT         PIC X(10).
  4589
  4590             20  CF-LF-COVERAGE-TYPE        PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  90
* EL156.cbl
  4591                 88  CF-REDUCING                VALUE 'R'.
  4592                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4593
  4594             20  CF-SPECIAL-CALC-CD         PIC X.
  4595                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4596                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4597                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4598                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4599                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4600                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4601                 88  CF-FARM-PLAN               VALUE 'F'.
  4602                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4603                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4604                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4605                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4606                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4607                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4608                 88  CF-PRUDENTIAL              VALUE 'P'.
  4609                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4610                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4611                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4612                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4613                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4614                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4615
  4616             20  CF-JOINT-INDICATOR         PIC X.
  4617                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4618
  4619*            20  FILLER                     PIC X(12).
  4620             20  FILLER                     PIC X(11).
  4621             20  CF-BENEFIT-CATEGORY        PIC X.
  4622             20  CF-LOAN-TYPE               PIC X(8).
  4623
  4624             20  CF-CO-REM-TERM-CALC        PIC X.
  4625                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4626                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4627                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4628                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4629                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4630
  4631             20  CF-CO-EARNINGS-CALC        PIC X.
  4632                 88  CO-EARN-BY-R78             VALUE '1'.
  4633                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4634                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4635                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4636                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4637                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4638                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4639                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4640
  4641             20  CF-CO-REFUND-CALC          PIC X.
  4642                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4643                 88  CO-REFD-BY-R78             VALUE '1'.
  4644                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4645                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4646                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4647                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4648                 88  CO-REFD-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  91
* EL156.cbl
  4649                 88  CO-REFD-MEAN               VALUE '8'.
  4650                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4651                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4652                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4653
  4654             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4655                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4656                 88  CO-OVRD-BY-R78             VALUE '1'.
  4657                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4658                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4659                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4660                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4661                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4662                 88  CO-OVRD-MEAN               VALUE '8'.
  4663                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4664
  4665             20  CF-CO-BEN-I-G-CD           PIC X.
  4666                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4667                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4668                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4669
  4670         16  FILLER                         PIC X(304).
  4671
  4672
  4673****************************************************************
  4674*             CARRIER MASTER RECORD                            *
  4675****************************************************************
  4676
  4677     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4678         16  CF-ADDRESS-DATA.
  4679             20  CF-MAIL-TO-NAME            PIC X(30).
  4680             20  CF-IN-CARE-OF              PIC X(30).
  4681             20  CF-ADDRESS-LINE-1          PIC X(30).
  4682             20  CF-ADDRESS-LINE-2          PIC X(30).
  4683             20  CF-CITY-STATE              PIC X(30).
  4684             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4685             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4686
  4687         16  CF-CLAIM-NO-CONTROL.
  4688             20  CF-CLAIM-NO-METHOD         PIC X.
  4689                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4690                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4691                 88  CLAIM-NO-SEQ               VALUE '3'.
  4692                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4693             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4694                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4695                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4696                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4697
  4698         16  CF-CHECK-NO-CONTROL.
  4699             20  CF-CHECK-NO-METHOD         PIC X.
  4700                 88  CHECK-NO-MANUAL            VALUE '1'.
  4701                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4702                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4703                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4704             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4705                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4706
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  92
* EL156.cbl
  4707         16  CF-DOMICILE-STATE              PIC XX.
  4708
  4709         16  CF-EXPENSE-CONTROLS.
  4710             20  CF-EXPENSE-METHOD          PIC X.
  4711                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4712                 88  DOLLARS-PER-PMT            VALUE '2'.
  4713                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4714                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4715             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4716             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4717
  4718         16  CF-CORRESPONDENCE-CONTROL.
  4719             20  CF-LETTER-RESEND-OPT       PIC X.
  4720                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4721                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4722             20  FILLER                     PIC X(4).
  4723
  4724         16  CF-RESERVE-CONTROLS.
  4725             20  CF-MANUAL-SW               PIC X.
  4726                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4727             20  CF-FUTURE-SW               PIC X.
  4728                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4729             20  CF-PTC-SW                  PIC X.
  4730                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4731             20  CF-IBNR-SW                 PIC X.
  4732                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4733             20  CF-PTC-LF-SW               PIC X.
  4734                 88  CF-LF-PTC-USED             VALUE '1'.
  4735             20  CF-CDT-ACCESS-METHOD       PIC X.
  4736                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4737                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4738                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4739             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4740
  4741         16  CF-CLAIM-CALC-METHOD           PIC X.
  4742             88  360-PLUS-MONTHS                VALUE '1'.
  4743             88  365-PLUS-MONTHS                VALUE '2'.
  4744             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4745             88  360-DAILY                      VALUE '4'.
  4746             88  365-DAILY                      VALUE '5'.
  4747
  4748         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4749         16  FILLER                         PIC X(11).
  4750
  4751         16  CF-LIMIT-AMOUNTS.
  4752             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4753             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4754             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4755             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4756             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4757             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4758             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4759             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4760             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4761             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4762
  4763         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4764         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  93
* EL156.cbl
  4765         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4766
  4767         16  CF-ZIP-CODE.
  4768             20  CF-ZIP-PRIME.
  4769                 24  CF-ZIP-1ST             PIC X.
  4770                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4771                 24  FILLER                 PIC X(4).
  4772             20  CF-ZIP-PLUS4               PIC X(4).
  4773         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4774             20  CF-CAN-POSTAL-1            PIC XXX.
  4775             20  CF-CAN-POSTAL-2            PIC XXX.
  4776             20  FILLER                     PIC XXX.
  4777
  4778         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4779         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4780         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4781
  4782         16  CF-RATING-SWITCH               PIC X.
  4783             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4784             88  CF-NO-RATING                   VALUE 'N'.
  4785
  4786         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4787
  4788         16  CF-CARRIER-OVER-SHORT.
  4789             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4790             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4791
  4792         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4793         16  CF-SECPAY-SWITCH               PIC X.
  4794             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4795             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4796         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4797         16  FILLER                         PIC X(448).
  4798*        16  FILLER                         PIC X(452).
  4799
  4800
  4801****************************************************************
  4802*             MORTALITY MASTER RECORD                          *
  4803****************************************************************
  4804
  4805     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4806         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4807                                INDEXED BY CF-MORT-NDX.
  4808             20  CF-MORT-TABLE              PIC X(5).
  4809             20  CF-MORT-TABLE-TYPE         PIC X.
  4810                 88  CF-MORT-JOINT              VALUE 'J'.
  4811                 88  CF-MORT-SINGLE             VALUE 'S'.
  4812                 88  CF-MORT-COMBINED           VALUE 'C'.
  4813                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4814                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4815             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4816             20  CF-MORT-AGE-METHOD         PIC XX.
  4817                 88  CF-AGE-LAST                VALUE 'AL'.
  4818                 88  CF-AGE-NEAR                VALUE 'AN'.
  4819             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4820             20  CF-MORT-ADJUSTMENT-DIRECTION
  4821                                            PIC X.
  4822                 88  CF-MINUS                   VALUE '-'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  94
* EL156.cbl
  4823                 88  CF-PLUS                    VALUE '+'.
  4824             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4825             20  CF-MORT-JOINT-CODE         PIC X.
  4826                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4827             20  CF-MORT-PC-Q               PIC X.
  4828                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4829             20  CF-MORT-TABLE-CODE         PIC X(4).
  4830             20  CF-MORT-COMMENTS           PIC X(15).
  4831             20  FILLER                     PIC X(14).
  4832
  4833         16  FILLER                         PIC X(251).
  4834
  4835
  4836****************************************************************
  4837*             BUSSINESS TYPE MASTER RECORD                     *
  4838****************************************************************
  4839
  4840     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4841* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4842* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4843* AND RECORD 05 IS TYPES 81-99
  4844         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4845             20  CF-BUSINESS-TITLE          PIC  X(19).
  4846             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4847                                            PIC S9V9(4) COMP-3.
  4848             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4849             20  FILLER                     PIC  X.
  4850         16  FILLER                         PIC  X(248).
  4851
  4852
  4853****************************************************************
  4854*             TERMINAL MASTER RECORD                           *
  4855****************************************************************
  4856
  4857     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4858
  4859         16  CF-COMPANY-TERMINALS.
  4860             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4861                                  PIC X(4).
  4862         16  FILLER               PIC X(248).
  4863
  4864
  4865****************************************************************
  4866*             LIFE EDIT MASTER RECORD                          *
  4867****************************************************************
  4868
  4869     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4870         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4871             20  CF-LIFE-CODE-IN            PIC XX.
  4872             20  CF-LIFE-CODE-OUT           PIC XX.
  4873         16  FILLER                         PIC X(248).
  4874
  4875
  4876****************************************************************
  4877*             AH EDIT MASTER RECORD                            *
  4878****************************************************************
  4879
  4880     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  95
* EL156.cbl
  4881         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4882             20  CF-AH-CODE-IN              PIC XXX.
  4883             20  CF-AH-CODE-OUT             PIC XX.
  4884         16  FILLER                         PIC X(248).
  4885
  4886
  4887****************************************************************
  4888*             CREDIBILITY TABLES                               *
  4889****************************************************************
  4890
  4891     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4892         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4893                             INDEXED BY CF-CRDB-NDX.
  4894             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4895             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4896             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4897         16  FILLER                         PIC  X(332).
  4898
  4899
  4900****************************************************************
  4901*             REPORT CUSTOMIZATION RECORD                      *
  4902****************************************************************
  4903
  4904     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4905         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4906             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4907             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4908             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4909**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4910****       A T-TRANSFER.                                   ****
  4911             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4912
  4913         16  FILLER                         PIC XX.
  4914
  4915         16  CF-CARRIER-CNTL-OPT.
  4916             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4917                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4918                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4919             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4920                                            PIC X.
  4921         16  CF-GROUP-CNTL-OPT.
  4922             20  CF-GROUP-OPT-SEQ           PIC 9.
  4923                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4924                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4925             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4926                                            PIC X(6).
  4927         16  CF-STATE-CNTL-OPT.
  4928             20  CF-STATE-OPT-SEQ           PIC 9.
  4929                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4930                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4931             20  CF-STATE-SELECT OCCURS 3 TIMES
  4932                                            PIC XX.
  4933         16  CF-ACCOUNT-CNTL-OPT.
  4934             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4935                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4936                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4937             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4938                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  96
* EL156.cbl
  4939         16  CF-BUS-TYP-CNTL-OPT.
  4940             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4941                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4942                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4943             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4944                                            PIC XX.
  4945         16  CF-LF-TYP-CNTL-OPT.
  4946             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4947                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4948                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4949             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4950                                            PIC XX.
  4951         16  CF-AH-TYP-CNTL-OPT.
  4952             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4953                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4954                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4955             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4956                                            PIC XX.
  4957         16  CF-REPTCD1-CNTL-OPT.
  4958             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4959                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4960                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4961             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4962                                            PIC X(10).
  4963         16  CF-REPTCD2-CNTL-OPT.
  4964             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4965                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4966                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4967             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4968                                            PIC X(10).
  4969         16  CF-USER1-CNTL-OPT.
  4970             20  CF-USER1-OPT-SEQ           PIC 9.
  4971                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4972                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4973             20  CF-USER1-SELECT OCCURS 3 TIMES
  4974                                            PIC X(10).
  4975         16  CF-USER2-CNTL-OPT.
  4976             20  CF-USER2-OPT-SEQ           PIC 9.
  4977                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4978                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4979             20  CF-USER2-SELECT OCCURS 3 TIMES
  4980                                            PIC X(10).
  4981         16  CF-USER3-CNTL-OPT.
  4982             20  CF-USER3-OPT-SEQ           PIC 9.
  4983                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4984                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4985             20  CF-USER3-SELECT OCCURS 3 TIMES
  4986                                            PIC X(10).
  4987         16  CF-USER4-CNTL-OPT.
  4988             20  CF-USER4-OPT-SEQ           PIC 9.
  4989                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4990                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4991             20  CF-USER4-SELECT OCCURS 3 TIMES
  4992                                            PIC X(10).
  4993         16  CF-USER5-CNTL-OPT.
  4994             20  CF-USER5-OPT-SEQ           PIC 9.
  4995                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4996                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  97
* EL156.cbl
  4997             20  CF-USER5-SELECT OCCURS 3 TIMES
  4998                                            PIC X(10).
  4999         16  CF-REINS-CNTL-OPT.
  5000             20  CF-REINS-OPT-SEQ           PIC 9.
  5001                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5002                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5003             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5004                 24  CF-REINS-PRIME         PIC XXX.
  5005                 24  CF-REINS-SUB           PIC XXX.
  5006
  5007         16  CF-AGENT-CNTL-OPT.
  5008             20  CF-AGENT-OPT-SEQ           PIC 9.
  5009                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5010                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5011             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5012                                            PIC X(10).
  5013
  5014         16  FILLER                         PIC X(43).
  5015
  5016         16  CF-LOSS-RATIO-SELECT.
  5017             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5018             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5019         16  CF-ENTRY-DATE-SELECT.
  5020             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5021             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5022         16  CF-EFFECTIVE-DATE-SELECT.
  5023             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5024             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5025
  5026         16  CF-EXCEPTION-LIST-IND          PIC X.
  5027             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5028
  5029         16  FILLER                         PIC X(318).
  5030
  5031****************************************************************
  5032*                  EXCEPTION REPORTING RECORD                  *
  5033****************************************************************
  5034
  5035     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5036         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5037             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5038
  5039         16  CF-COMBINED-LIFE-AH-OPT.
  5040             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5041             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5042             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5043             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5044
  5045         16  CF-LIFE-OPT.
  5046             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5047             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5048             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5049             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5050             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5051             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5052             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5053             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5054             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  98
* EL156.cbl
  5055             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5056
  5057         16  CF-AH-OPT.
  5058             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5059             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5060             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5061             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5062             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5063             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5064             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5065             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5066             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5067             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5068
  5069         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5070             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5071             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5072             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5073
  5074         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5075
  5076         16  FILLER                         PIC X(673).
  5077
  5078
  5079****************************************************************
  5080*             MORTGAGE SYSTEM PLAN RECORD                      *
  5081****************************************************************
  5082
  5083     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5084         16  CF-PLAN-TYPE                   PIC X.
  5085             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5086             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5087             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5088         16  CF-PLAN-ABBREV                 PIC XXX.
  5089         16  CF-PLAN-DESCRIPT               PIC X(10).
  5090         16  CF-PLAN-NOTES                  PIC X(20).
  5091         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5092         16  CF-PLAN-UNDERWRITING.
  5093             20  CF-PLAN-TERM-DATA.
  5094                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5095                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5096             20  CF-PLAN-AGE-DATA.
  5097                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5098                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5099                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5100             20  CF-PLAN-BENEFIT-DATA.
  5101                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5102                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5103                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5104                                            PIC S9(7)V99  COMP-3.
  5105         16  CF-PLAN-POLICY-FORMS.
  5106             20  CF-POLICY-FORM             PIC X(12).
  5107             20  CF-MASTER-APPLICATION      PIC X(12).
  5108             20  CF-MASTER-POLICY           PIC X(12).
  5109         16  CF-PLAN-RATING.
  5110             20  CF-RATE-CODE               PIC X(5).
  5111             20  CF-SEX-RATING              PIC X.
  5112                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  99
* EL156.cbl
  5113                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5114             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5115             20  CF-SUB-STD-TYPE            PIC X.
  5116                 88  CF-PCT-OF-PREM            VALUE '1'.
  5117                 88  CF-PCT-OF-BENE            VALUE '2'.
  5118         16  CF-PLAN-PREM-TOLERANCES.
  5119             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5120             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5121         16  CF-PLAN-PYMT-TOLERANCES.
  5122             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5123             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5124         16  CF-PLAN-MISC-DATA.
  5125             20  FILLER                     PIC X.
  5126             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5127             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5128         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5129         16  CF-PLAN-IND-GRP                PIC X.
  5130             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5131                                                     '1'.
  5132             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5133                                                     '2'.
  5134         16  CF-MIB-SEARCH-SW               PIC X.
  5135             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5136             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5137             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5138             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5139         16  CF-ALPHA-SEARCH-SW             PIC X.
  5140             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5141             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5142             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5143             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5144             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5145             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5146             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5147             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5148             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5149             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5150                                                     'A' 'B' 'C'
  5151                                                     'X' 'Y' 'Z'.
  5152         16  CF-EFF-DT-RULE-SW              PIC X.
  5153             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5154             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5155             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5156             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5157             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5158         16  FILLER                         PIC X(4).
  5159         16  CF-HEALTH-QUESTIONS            PIC X.
  5160             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5161         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5162         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5163         16  CF-PLAN-SNGL-JNT               PIC X.
  5164             88  CF-COMBINED-PLAN              VALUE 'C'.
  5165             88  CF-JNT-PLAN                   VALUE 'J'.
  5166             88  CF-SNGL-PLAN                  VALUE 'S'.
  5167         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5168         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5169         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5170         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 100
* EL156.cbl
  5171         16  CF-RERATE-CNTL                 PIC  X.
  5172             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5173             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5174             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5175             88  CF-AUTO-RECALC                 VALUE '4'.
  5176         16  CF-BENEFIT-TYPE                PIC  X.
  5177             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5178             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5179         16  CF-POLICY-FEE                  PIC S999V99
  5180                                                    COMP-3.
  5181         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5182         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5183         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5184         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5185         16  FILLER                         PIC  X(32).
  5186         16  CF-TERMINATION-FORM            PIC  X(04).
  5187         16  FILLER                         PIC  X(08).
  5188         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5189                                                       COMP-3.
  5190         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5191         16  CF-ISSUE-LETTER                PIC  X(4).
  5192         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5193         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5194             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5195             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5196         16  CF-MP-REFUND-CALC              PIC X.
  5197             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5198             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5199             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5200             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5201             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  5202             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5203             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5204             88  CF-MP-REFD-MEAN                VALUE '8'.
  5205         16  CF-ALT-RATE-CODE               PIC  X(5).
  5206
  5207
  5208         16  FILLER                         PIC X(498).
  5209****************************************************************
  5210*             MORTGAGE COMPANY MASTER RECORD                   *
  5211****************************************************************
  5212
  5213     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5214         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5215         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5216             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5217             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5218             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5219             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5220             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5221
  5222         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5223         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5224         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5225         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5226         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  5227
  5228         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 101
* EL156.cbl
  5229             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5230         16  CF-MP-RECON-USE-IND            PIC X(1).
  5231             88  CF-MP-USE-RECON             VALUE 'Y'.
  5232         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5233             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5234         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5235             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5236             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5237         16  FILLER                         PIC X(1).
  5238         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5239             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5240         16  CF-MORTG-MIB-VERSION           PIC X.
  5241             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5242             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5243             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5244         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5245             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  5246                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5247             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5248                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5249             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5250                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5251             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5252                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5253             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5254                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5255             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5256                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  5257         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5258         16  FILLER                         PIC X(7).
  5259         16  CF-MORTG-DESTINATION-SYMBOL.
  5260             20  CF-MORTG-MIB-COMM          PIC X(5).
  5261             20  CF-MORTG-MIB-TERM          PIC X(5).
  5262         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5263             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5264         16  FILLER                         PIC X(03).
  5265         16  CF-MP-CHECK-NO-CONTROL.
  5266             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  5267                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5268                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  5269                                                ' ' LOW-VALUES.
  5270                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5271                                               VALUE '3'.
  5272         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5273         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5274         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5275             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5276                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5277             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5278                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5279             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5280                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5281             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5282                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5283             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5284                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  5285             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5286                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 102
* EL156.cbl
  5287         16  CF-MORTG-BILLING-AREA.
  5288             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5289                                            PIC X.
  5290         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5291         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5292         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5293         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5294             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5295             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5296         16  FILLER                         PIC X.
  5297         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5298             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5299             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5300         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5301         16  FILLER                         PIC X(8).
  5302         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5303         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  5304         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5305         16  CF-ACH-COMPANY-ID.
  5306             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5307                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5308                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5309                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5310             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5311         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5312             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  5313         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5314             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  5315             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5316         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5317         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  5318         16  FILLER                         PIC X(536).
  5319
  5320****************************************************************
  5321*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5322****************************************************************
  5323
  5324     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  5325         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5326             20  CF-FEMALE-HEIGHT.
  5327                 24  CF-FEMALE-FT           PIC 99.
  5328                 24  CF-FEMALE-IN           PIC 99.
  5329             20  CF-FEMALE-MIN-WT           PIC 999.
  5330             20  CF-FEMALE-MAX-WT           PIC 999.
  5331         16  FILLER                         PIC X(428).
  5332
  5333     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5334         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5335             20  CF-MALE-HEIGHT.
  5336                 24  CF-MALE-FT             PIC 99.
  5337                 24  CF-MALE-IN             PIC 99.
  5338             20  CF-MALE-MIN-WT             PIC 999.
  5339             20  CF-MALE-MAX-WT             PIC 999.
  5340         16  FILLER                         PIC X(428).
  5341******************************************************************
  5342*             AUTOMATIC ACTIVITY RECORD                          *
  5343******************************************************************
  5344     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 103
* EL156.cbl
  5345         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5346             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5347             20  CF-SYS-LETTER-ID           PIC X(04).
  5348             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5349             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5350             20  CF-SYS-RESET-SW            PIC X(01).
  5351             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5352             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5353
  5354         16  FILLER                         PIC X(50).
  5355
  5356         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5357             20  CF-USER-ACTIVE-SW          PIC X(01).
  5358             20  CF-USER-LETTER-ID          PIC X(04).
  5359             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5360             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5361             20  CF-USER-RESET-SW           PIC X(01).
  5362             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5363             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5364             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5365
  5366         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 104
* EL156.cbl
  5368*    COPY ELCCERT.
  5369******************************************************************
  5370*                                                                *
  5371*                            ELCCERT.                            *
  5372*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5373*                            VMOD=2.013                          *
  5374*                                                                *
  5375*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5376*                                                                *
  5377*   FILE TYPE = VSAM,KSDS                                        *
  5378*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5379*                                                                *
  5380*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5381*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5382*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5383*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5384*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5385*                                                                *
  5386*   LOG = YES                                                    *
  5387*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5388******************************************************************
  5389*                   C H A N G E   L O G
  5390*
  5391* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5392*-----------------------------------------------------------------
  5393*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5394* EFFECTIVE    NUMBER
  5395*-----------------------------------------------------------------
  5396* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5397* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5398* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5399* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5400* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5401* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5402* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5403******************************************************************
  5404
  5405 01  CERTIFICATE-MASTER.
  5406     12  CM-RECORD-ID                      PIC XX.
  5407         88  VALID-CM-ID                      VALUE 'CM'.
  5408
  5409     12  CM-CONTROL-PRIMARY.
  5410         16  CM-COMPANY-CD                 PIC X.
  5411         16  CM-CARRIER                    PIC X.
  5412         16  CM-GROUPING.
  5413             20  CM-GROUPING-PREFIX        PIC X(3).
  5414             20  CM-GROUPING-PRIME         PIC X(3).
  5415         16  CM-STATE                      PIC XX.
  5416         16  CM-ACCOUNT.
  5417             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5418             20  CM-ACCOUNT-PRIME          PIC X(6).
  5419         16  CM-CERT-EFF-DT                PIC XX.
  5420         16  CM-CERT-NO.
  5421             20  CM-CERT-PRIME             PIC X(10).
  5422             20  CM-CERT-SFX               PIC X.
  5423
  5424     12  CM-CONTROL-BY-NAME.
  5425         16  CM-COMPANY-CD-A1              PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 105
* EL156.cbl
  5426         16  CM-INSURED-LAST-NAME          PIC X(15).
  5427         16  CM-INSURED-INITIALS.
  5428             20  CM-INSURED-INITIAL1       PIC X.
  5429             20  CM-INSURED-INITIAL2       PIC X.
  5430
  5431     12  CM-CONTROL-BY-SSN.
  5432         16  CM-COMPANY-CD-A2              PIC X.
  5433         16  CM-SOC-SEC-NO.
  5434             20  CM-SSN-STATE              PIC XX.
  5435             20  CM-SSN-ACCOUNT            PIC X(6).
  5436             20  CM-SSN-LN3.
  5437                 25  CM-INSURED-INITIALS-A2.
  5438                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5439                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5440                 25 CM-PART-LAST-NAME-A2         PIC X.
  5441
  5442     12  CM-CONTROL-BY-CERT-NO.
  5443         16  CM-COMPANY-CD-A4              PIC X.
  5444         16  CM-CERT-NO-A4                 PIC X(11).
  5445
  5446     12  CM-CONTROL-BY-MEMB.
  5447         16  CM-COMPANY-CD-A5              PIC X.
  5448         16  CM-MEMBER-NO.
  5449             20  CM-MEMB-STATE             PIC XX.
  5450             20  CM-MEMB-ACCOUNT           PIC X(6).
  5451             20  CM-MEMB-LN4.
  5452                 25  CM-INSURED-INITIALS-A5.
  5453                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5454                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5455                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5456
  5457     12  CM-INSURED-PROFILE-DATA.
  5458         16  CM-INSURED-FIRST-NAME.
  5459             20  CM-INSURED-1ST-INIT       PIC X.
  5460             20  FILLER                    PIC X(9).
  5461         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5462         16  CM-INSURED-SEX                PIC X.
  5463             88  CM-SEX-MALE                  VALUE 'M'.
  5464             88  CM-SEX-FEMAL                 VALUE 'F'.
  5465         16  CM-INSURED-JOINT-AGE          PIC 99.
  5466         16  CM-JOINT-INSURED-NAME.
  5467             20  CM-JT-LAST-NAME           PIC X(15).
  5468             20  CM-JT-FIRST-NAME.
  5469                 24  CM-JT-1ST-INIT        PIC X.
  5470                 24  FILLER                PIC X(9).
  5471             20  CM-JT-INITIAL             PIC X.
  5472
  5473     12  CM-LIFE-DATA.
  5474         16  CM-LF-BENEFIT-CD              PIC XX.
  5475         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5476         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5477         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5478         16  CM-LF-DEV-CODE                PIC XXX.
  5479         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5480         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  5481         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5482         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  5483         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 106
* EL156.cbl
  5484         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5485         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5486         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5487         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5488         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5489         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5490         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5491         16  FILLER                        PIC XX.
  5492
  5493     12  CM-AH-DATA.
  5494         16  CM-AH-BENEFIT-CD              PIC XX.
  5495         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5496         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5497         16  CM-AH-DEV-CODE                PIC XXX.
  5498         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5499         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5500         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5501         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5502         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5503         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5504         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5505         16  CM-AH-PAID-THRU-DT            PIC XX.
  5506             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5507         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5508         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5509         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5510         16  FILLER                        PIC X.
  5511
  5512     12  CM-LOAN-INFORMATION.
  5513         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5514         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5515         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5516         16  CM-PAY-FREQUENCY              PIC S99.
  5517         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5518         16  CM-RATE-CLASS                 PIC XX.
  5519         16  CM-BENEFICIARY                PIC X(25).
  5520         16  CM-POLICY-FORM-NO             PIC X(12).
  5521         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5522         16  CM-LAST-ADD-ON-DT             PIC XX.
  5523         16  CM-DEDUCTIBLE-AMOUNTS.
  5524             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5525             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5526         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5527             20  CM-RESIDENT-STATE         PIC XX.
  5528             20  CM-RATE-CODE              PIC X(4).
  5529             20  FILLER                    PIC XX.
  5530         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5531             20  CM-LOAN-OFFICER           PIC X(5).
  5532             20  FILLER                    PIC XXX.
  5533         16  CM-CSR-CODE                   PIC XXX.
  5534         16  CM-UNDERWRITING-CODE          PIC X.
  5535             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5536         16  CM-POST-CARD-IND              PIC X.
  5537         16  CM-NH-INTERFACE-SW            PIC X.
  5538         16  CM-PREMIUM-TYPE               PIC X.
  5539             88  CM-SING-PRM                  VALUE '1'.
  5540             88  CM-O-B-COVERAGE              VALUE '2'.
  5541             88  CM-OPEN-END                  VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 107
* EL156.cbl
  5542         16  CM-IND-GRP-TYPE               PIC X.
  5543             88  CM-INDIVIDUAL                VALUE 'I'.
  5544             88  CM-GROUP                     VALUE 'G'.
  5545         16  CM-SKIP-CODE                  PIC X.
  5546             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5547             88  SKIP-JULY                    VALUE '1'.
  5548             88  SKIP-AUGUST                  VALUE '2'.
  5549             88  SKIP-SEPTEMBER               VALUE '3'.
  5550             88  SKIP-JULY-AUG                VALUE '4'.
  5551             88  SKIP-AUG-SEPT                VALUE '5'.
  5552             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5553             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5554             88  SKIP-JUNE                    VALUE '8'.
  5555             88  SKIP-JUNE-JULY               VALUE '9'.
  5556             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5557             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5558         16  CM-PAYMENT-MODE               PIC X.
  5559             88  PAY-MONTHLY                  VALUE SPACE.
  5560             88  PAY-WEEKLY                   VALUE '1'.
  5561             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5562             88  PAY-BI-WEEKLY                VALUE '3'.
  5563             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5564         16  CM-LOAN-NUMBER                PIC X(8).
  5565         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5566         16  CM-OLD-LOF                    PIC XXX.
  5567*        16  CM-LOAN-OFFICER               PIC XXX.
  5568         16  CM-REIN-TABLE                 PIC XXX.
  5569         16  CM-SPECIAL-REIN-CODE          PIC X.
  5570         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5571         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5572         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5573
  5574     12  CM-STATUS-DATA.
  5575         16  CM-ENTRY-STATUS               PIC X.
  5576         16  CM-ENTRY-DT                   PIC XX.
  5577
  5578         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5579         16  CM-LF-CANCEL-DT               PIC XX.
  5580         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5581
  5582         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5583         16  CM-LF-DEATH-DT                PIC XX.
  5584         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5585
  5586         16  CM-LF-CURRENT-STATUS          PIC X.
  5587             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5588                                                'M' '4' '5' '9'.
  5589             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5590             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5591             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5592             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5593             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5594             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5595             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5596             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5597             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5598             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5599             88  CM-LF-DECLINED               VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 108
* EL156.cbl
  5600             88  CM-LF-VOIDED                 VALUE 'V'.
  5601
  5602         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5603         16  CM-AH-CANCEL-DT               PIC XX.
  5604         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5605
  5606         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5607         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5608         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5609
  5610         16  CM-AH-CURRENT-STATUS          PIC X.
  5611             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5612                                                'M' '4' '5' '9'.
  5613             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5614             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5615             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5616             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5617             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5618             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5619             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5620             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5621             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5622             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5623             88  CM-AH-DECLINED               VALUE 'D'.
  5624             88  CM-AH-VOIDED                 VALUE 'V'.
  5625
  5626         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5627             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5628             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5629             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5630         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5631
  5632         16  CM-ENTRY-BATCH                PIC X(6).
  5633         16  CM-LF-EXIT-BATCH              PIC X(6).
  5634         16  CM-AH-EXIT-BATCH              PIC X(6).
  5635         16  CM-LAST-MONTH-END             PIC XX.
  5636
  5637     12  CM-NOTE-SW                        PIC X.
  5638         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5639         88  CERT-NOTES-PRESENT               VALUE '1'.
  5640         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5641         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5642         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5643         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5644         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5645         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5646     12  CM-COMP-EXCP-SW                   PIC X.
  5647         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5648         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5649     12  CM-INSURED-ADDRESS-SW             PIC X.
  5650         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5651         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5652
  5653*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5654     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5655     12  FILLER                            PIC X.
  5656
  5657*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 109
* EL156.cbl
  5658     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5659     12  FILLER                            PIC X.
  5660*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5661     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5662
  5663     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5664         88  CERT-ADDED-BATCH                 VALUE ' '.
  5665         88  CERT-ADDED-ONLINE                VALUE '1'.
  5666         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5667         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5668         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5669     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5670         88  CERT-AS-LOADED                   VALUE ' '.
  5671         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5672         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5673         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5674         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5675         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5676         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5677         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5678
  5679     12  CM-ACCOUNT-COMM-PCTS.
  5680         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5681         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5682
  5683     12  CM-USER-FIELD                     PIC X.
  5684     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5685     12  CM-CLP-STATE                      PIC XX.
  5686     12  CM-USER-RESERVED                  PIC XXX.
  5687******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 110
* EL156.cbl
  5689*    COPY ELCTRLR.
  5690******************************************************************
  5691*                                                                *
  5692*                            ELCTRLR.                            *
  5693*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5694*                            VMOD=2.014                          *
  5695*                                                                *
  5696*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5697*                                                                *
  5698*   FILE TYPE = VSAM,KSDS                                        *
  5699*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5700*                                                                *
  5701*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5702*       ALTERNATE INDEX = NONE                                   *
  5703*                                                                *
  5704*   LOG = YES                                                    *
  5705*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5706******************************************************************
  5707*                   C H A N G E   L O G
  5708*
  5709* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5710*-----------------------------------------------------------------
  5711*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5712* EFFECTIVE    NUMBER
  5713*-----------------------------------------------------------------
  5714* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5715* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5716* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5717* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5718* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5719* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5720* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5721* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5722* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5723* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5724* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5725* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5726******************************************************************
  5727 01  ACTIVITY-TRAILERS.
  5728     12  AT-RECORD-ID                    PIC XX.
  5729         88  VALID-AT-ID                       VALUE 'AT'.
  5730
  5731     12  AT-CONTROL-PRIMARY.
  5732         16  AT-COMPANY-CD               PIC X.
  5733         16  AT-CARRIER                  PIC X.
  5734         16  AT-CLAIM-NO                 PIC X(7).
  5735         16  AT-CERT-NO.
  5736             20  AT-CERT-PRIME           PIC X(10).
  5737             20  AT-CERT-SFX             PIC X.
  5738         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  5739             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5740             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5741             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5742             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5743             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5744             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5745             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  5746             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 111
* EL156.cbl
  5747             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5748             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5749             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5750             88  AT-BENEFICIARY-TRL           VALUE +91.
  5751             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5752
  5753     12  AT-TRAILER-TYPE                 PIC X.
  5754         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5755         88  PAYMENT-TR                       VALUE '2'.
  5756         88  AUTO-PAY-TR                      VALUE '3'.
  5757         88  CORRESPONDENCE-TR                VALUE '4'.
  5758         88  ADDRESS-TR                       VALUE '5'.
  5759         88  GENERAL-INFO-TR                  VALUE '6'.
  5760         88  AUTO-PROMPT-TR                   VALUE '7'.
  5761         88  DENIAL-TR                        VALUE '8'.
  5762         88  INCURRED-CHG-TR                  VALUE '9'.
  5763         88  FORM-CONTROL-TR                  VALUE 'A'.
  5764
  5765     12  AT-RECORDED-DT                  PIC XX.
  5766     12  AT-RECORDED-BY                  PIC X(4).
  5767     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5768
  5769     12  AT-TRAILER-BODY                 PIC X(165).
  5770
  5771     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5772         16  AT-RESERVE-CONTROLS.
  5773             20  AT-MANUAL-SW            PIC X.
  5774                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5775             20  AT-FUTURE-SW            PIC X.
  5776                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  5777             20  AT-PTC-SW               PIC X.
  5778                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  5779             20  AT-IBNR-SW              PIC X.
  5780                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  5781             20  AT-PTC-LF-SW            PIC X.
  5782                 88  AT-LF-PTC-USED          VALUE '1'.
  5783             20  AT-CDT-ACCESS-METHOD    PIC X.
  5784                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  5785                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  5786                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  5787             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  5788         16  AT-LAST-COMPUTED-DT         PIC XX.
  5789         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  5790         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  5791         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  5792         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5793         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5794         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  5795         16  AT-EXPENSE-CONTROLS.
  5796             20  AT-EXPENSE-METHOD       PIC X.
  5797                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  5798                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  5799                 88  PERCENT-OF-PMT           VALUE '3'.
  5800                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  5801             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  5802             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  5803         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  5804         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 112
* EL156.cbl
  5805
  5806         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  5807         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  5808
  5809*        16  FILLER                      PIC X(53).
  5810         16  FILLER                      PIC X(47).
  5811
  5812         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  5813         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  5814
  5815         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  5816             20  AT-OPEN-CLOSE-DATE      PIC XX.
  5817             20  AT-OPEN-CLOSE-TYPE      PIC X.
  5818*                    C = CLOSED
  5819*                    O = OPEN
  5820             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  5821*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  5822
  5823     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  5824         16  AT-PAYMENT-TYPE             PIC X.
  5825             88  PARTIAL-PAYMENT                VALUE '1'.
  5826             88  FINAL-PAYMENT                  VALUE '2'.
  5827             88  LUMP-SUM-PAYMENT               VALUE '3'.
  5828             88  ADDITIONAL-PAYMENT             VALUE '4'.
  5829             88  CHARGEABLE-EXPENSE             VALUE '5'.
  5830             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  5831             88  VOIDED-PAYMENT                 VALUE '9'.
  5832             88  TRANSFER                       VALUE 'T'.
  5833             88  LIFE-INTEREST                  VALUE 'I'.
  5834
  5835         16  AT-CLAIM-TYPE               PIC X.
  5836             88  PAID-FOR-AH                    VALUE 'A'.
  5837             88  PAID-FOR-LIFE                  VALUE 'L'.
  5838             88  PAID-FOR-IUI                   VALUE 'I'.
  5839             88  PAID-FOR-GAP                   VALUE 'G'.
  5840         16  AT-CLAIM-PREM-TYPE          PIC X.
  5841             88  AT-SINGLE-PREMIUM              VALUE '1'.
  5842             88  AT-O-B-COVERAGE                VALUE '2'.
  5843             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  5844         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  5845         16  AT-CHECK-NO                 PIC X(7).
  5846         16  AT-PAID-FROM-DT             PIC XX.
  5847         16  AT-PAID-THRU-DT             PIC XX.
  5848         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  5849         16  FILLER                      PIC X.
  5850         16  AT-PAYEES-NAME              PIC X(30).
  5851         16  AT-PAYMENT-ORIGIN           PIC X.
  5852             88  ONLINE-MANUAL-PMT              VALUE '1'.
  5853             88  ONLINE-AUTO-PMT                VALUE '2'.
  5854             88  OFFLINE-PMT                    VALUE '3'.
  5855         16  AT-CHECK-WRITTEN-DT         PIC XX.
  5856         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  5857         16  AT-VOID-DATA.
  5858             20  AT-VOID-DT              PIC XX.
  5859*00144       20  AT-VOID-REASON          PIC X(30).
  5860             20  AT-VOID-REASON          PIC X(26).
  5861         16  AT-PMT-APPROVED-BY          PIC X(04).
  5862         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 113
* EL156.cbl
  5863         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  5864         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  5865                                         PIC S99V9(5)  COMP-3.
  5866         16  AT-CREDIT-INTERFACE.
  5867             20  AT-PMT-SELECT-DT        PIC XX.
  5868                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  5869             20  AT-PMT-ACCEPT-DT        PIC XX.
  5870                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  5871             20  AT-VOID-SELECT-DT       PIC XX.
  5872                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  5873             20  AT-VOID-ACCEPT-DT       PIC XX.
  5874                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  5875
  5876         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  5877                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  5878                 88  CONVERSION-PAYMENT           VALUE +99999999.
  5879         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  5880
  5881         16  AT-FORCE-CONTROL            PIC X.
  5882             88  PAYMENT-WAS-FORCED           VALUE '1'.
  5883         16  AT-PREV-LAST-PMT-DT         PIC XX.
  5884         16  AT-PREV-PAID-THRU-DT        PIC XX.
  5885         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  5886         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  5887         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  5888         16  AT-BENEFIT-TYPE             PIC X.
  5889
  5890         16  AT-EXPENSE-TYPE             PIC X.
  5891         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  5892
  5893         16  AT-PAYEE-TYPE-CD.
  5894             20  AT-PAYEE-TYPE           PIC X.
  5895                 88  INSURED-PAID           VALUE 'I'.
  5896                 88  BENEFICIARY-PAID       VALUE 'B'.
  5897                 88  ACCOUNT-PAID           VALUE 'A'.
  5898                 88  OTHER-1-PAID           VALUE 'O'.
  5899                 88  OTHER-2-PAID           VALUE 'Q'.
  5900                 88  DOCTOR-PAID            VALUE 'P'.
  5901                 88  EMPLOYER-PAID          VALUE 'E'.
  5902             20  AT-PAYEE-SEQ            PIC X.
  5903
  5904         16  AT-CASH-PAYMENT             PIC X.
  5905         16  AT-GROUPED-PAYMENT          PIC X.
  5906         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  5907         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  5908         16  AT-APPROVED-LEVEL           PIC X.
  5909         16  AT-VOID-TYPE                PIC X.
  5910             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  5911             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  5912         16  AT-AIG-UNEMP-IND            PIC X.
  5913             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  5914         16  AT-ASSOCIATES               PIC X.
  5915             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  5916             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  5917
  5918         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  5919         16  AT-CV-PMT-CODE              PIC X.
  5920             88  FULL-DEATH-PAYMENT         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 114
* EL156.cbl
  5921             88  HALF-DEATH-PAYMENT         VALUE '2'.
  5922             88  FULL-ADD-PAYMENT           VALUE '3'.
  5923             88  HALF-ADD-PAYMENT           VALUE '4'.
  5924             88  FULL-RIDER-PAYMENT         VALUE '5'.
  5925             88  HALF-RIDER-PAYMENT         VALUE '6'.
  5926             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  5927             88  ADDL-PAYMENT               VALUE '8'.
  5928
  5929         16  AT-EOB-CODE1                PIC XXX.
  5930         16  AT-EOB-CODE2                PIC XXX.
  5931         16  AT-EOB-CODE3                PIC XXX.
  5932         16  AT-EOB-CODE4                PIC XXX.
  5933         16  FILLER REDEFINES AT-EOB-CODE4.
  5934             20  AT-INT-PMT-SELECT-DT    PIC XX.
  5935             20  FILLER                  PIC X.
  5936         16  AT-EOB-CODE5                PIC XXX.
  5937         16  FILLER REDEFINES AT-EOB-CODE5.
  5938             20  AT-PMT-PROOF-DT         PIC XX.
  5939             20  FILLER                  PIC X.
  5940
  5941         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  5942             88  AT-PRINT-EOB            VALUE 'Y'.
  5943
  5944         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  5945         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  5946
  5947     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  5948         16  AT-SCHEDULE-START-DT        PIC XX.
  5949         16  AT-SCHEDULE-END-DT          PIC XX.
  5950         16  AT-TERMINATED-DT            PIC XX.
  5951         16  AT-LAST-PMT-TYPE            PIC X.
  5952             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  5953             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  5954         16  AT-FIRST-PMT-DATA.
  5955             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  5956             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  5957             20  AT-1ST-PAY-THRU-DT      PIC XX.
  5958         16  AT-REGULAR-PMT-DATA.
  5959             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  5960             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  5961             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  5962         16  AT-AUTO-PAYEE-CD.
  5963             20  AT-AUTO-PAYEE-TYPE      PIC X.
  5964                 88  INSURED-PAID-AUTO      VALUE 'I'.
  5965                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  5966                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  5967                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  5968                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  5969             20  AT-AUTO-PAYEE-SEQ       PIC X.
  5970         16  AT-AUTO-PAY-DAY             PIC 99.
  5971         16  AT-AUTO-CASH                PIC X.
  5972             88  AT-CASH                      VALUE 'Y'.
  5973             88  AT-NON-CASH                  VALUE 'N'.
  5974*        16  FILLER                      PIC X(129).
  5975         16  AT-AUTO-END-LETTER          PIC X(4).
  5976         16  FILLER                      PIC X(125).
  5977
  5978         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 115
* EL156.cbl
  5979         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  5980
  5981     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  5982         16  AT-LETTER-SENT-DT           PIC XX.
  5983         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  5984         16  AT-AUTO-RE-SEND-DT          PIC XX.
  5985         16  AT-LETTER-ANSWERED-DT       PIC XX.
  5986         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  5987         16  AT-LETTER-ORIGIN            PIC X.
  5988             88  ONLINE-CREATION              VALUE '1' '3'.
  5989             88  OFFLINE-CREATION             VALUE '2' '4'.
  5990             88  NAPER-ONLINE-CREATION        VALUE '3'.
  5991             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  5992         16  AT-STD-LETTER-FORM          PIC X(4).
  5993         16  AT-REASON-TEXT              PIC X(70).
  5994         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  5995         16  AT-ADDRESEE-TYPE            PIC X.
  5996              88  INSURED-ADDRESEE            VALUE 'I'.
  5997              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  5998              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  5999              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6000              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6001              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6002              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6003         16  AT-ADDRESSEE-NAME           PIC X(30).
  6004         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6005         16  AT-RESEND-PRINT-DATE        PIC XX.
  6006         16  AT-CORR-SOL-UNSOL           PIC X.
  6007         16  AT-LETTER-PURGED-DT         PIC XX.
  6008*
  6009*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6010*
  6011         16  AT-CSO-REDEFINITION.
  6012             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6013             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6014             20  AT-LETTER-TO-BENE       PIC X(1).
  6015             20  AT-STOP-LETTER-DT       PIC X(2).
  6016             20  FILLER                  PIC X(19).
  6017*             20  FILLER                  PIC X(27).
  6018             20  AT-CSO-LETTER-STATUS    PIC X.
  6019                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6020                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  6021                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6022             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6023             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6024*
  6025*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6026*
  6027*        16  FILLER                      PIC X(26).
  6028*
  6029*        16  AT-DMD-BSR-CODE             PIC X.
  6030*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6031*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6032*
  6033*        16  AT-DMD-LETTER-STATUS        PIC X.
  6034*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6035*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6036*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 116
* EL156.cbl
  6037*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6038*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6039
  6040         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6041         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6042
  6043     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6044         16  AT-ADDRESS-TYPE             PIC X.
  6045             88  INSURED-ADDRESS               VALUE 'I'.
  6046             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6047             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6048             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6049             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6050             88  OTHER-ADDRESS-1               VALUE 'O'.
  6051             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6052         16  AT-MAIL-TO-NAME             PIC X(30).
  6053         16  AT-ADDRESS-LINE-1           PIC X(30).
  6054         16  AT-ADDRESS-LINE-2           PIC X(30).
  6055         16  AT-CITY-STATE.
  6056             20  AT-CITY                 PIC X(28).
  6057             20  AT-STATE                PIC XX.
  6058         16  AT-ZIP.
  6059             20  AT-ZIP-CODE.
  6060                 24  AT-ZIP-1ST          PIC X.
  6061                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6062                 24  FILLER              PIC X(4).
  6063             20  AT-ZIP-PLUS4            PIC X(4).
  6064         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6065             20  AT-CAN-POSTAL-1         PIC XXX.
  6066             20  AT-CAN-POSTAL-2         PIC XXX.
  6067             20  FILLER                  PIC XXX.
  6068         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6069         16  FILLER                      PIC X(23).
  6070         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6071         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6072
  6073     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6074         16  AT-INFO-LINE-1              PIC X(60).
  6075         16  AT-INFO-LINE-2              PIC X(60).
  6076         16  AT-INFO-TRAILER-TYPE        PIC X.
  6077             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6078             88  AT-CALL-NOTE            VALUE 'C'.
  6079             88  AT-MAINT-NOTE           VALUE 'M'.
  6080             88  AT-CERT-CHANGE          VALUE 'X'.
  6081             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6082             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6083         16  AT-CALL-TYPE                PIC X.
  6084             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6085             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6086         16  AT-NOTE-CONTINUATION        PIC X.
  6087             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6088         16  AT-EOB-CODES-EXIST          PIC X.
  6089             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6090         16  FILLER                      PIC X(35).
  6091         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6092         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6093
  6094     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 117
* EL156.cbl
  6095         16  AT-PROMPT-LINE-1            PIC X(60).
  6096         16  AT-PROMPT-LINE-2            PIC X(60).
  6097         16  AT-PROMPT-START-DT          PIC XX.
  6098         16  AT-PROMPT-END-DT            PIC XX.
  6099         16  FILLER                      PIC X(35).
  6100         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6101         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6102
  6103     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6104         16  AT-DENIAL-INFO-1            PIC X(60).
  6105         16  AT-DENIAL-INFO-2            PIC X(60).
  6106         16  AT-DENIAL-DT                PIC XX.
  6107         16  AT-RETRACTION-DT            PIC XX.
  6108         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6109*         16  FILLER                      PIC X(31).
  6110         16  AT-DENIAL-PROOF-DT          PIC XX.
  6111         16  FILLER                      PIC X(29).
  6112         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6113         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6114
  6115     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6116         16  AT-OLD-INCURRED-DT          PIC XX.
  6117         16  AT-OLD-REPORTED-DT          PIC XX.
  6118         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6119         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6120         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6121         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6122         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6123         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6124         16  FILLER                      PIC X(26).
  6125         16  AT-OLD-DIAG-CODE            PIC X(6).
  6126         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6127         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6128         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6129         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6130         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6131         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6132         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6133         16  FILLER                      PIC X(25).
  6134         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6135
  6136     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6137         16  AT-FORM-SEND-ON-DT          PIC XX.
  6138         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6139         16  AT-FORM-RE-SEND-DT          PIC XX.
  6140         16  AT-FORM-ANSWERED-DT         PIC XX.
  6141         16  AT-FORM-PRINTED-DT          PIC XX.
  6142         16  AT-FORM-REPRINT-DT          PIC XX.
  6143         16  AT-FORM-TYPE                PIC X.
  6144             88  INITIAL-FORM                  VALUE '1'.
  6145             88  PROGRESS-FORM                 VALUE '2'.
  6146         16  AT-INSTRUCT-LN-1            PIC X(28).
  6147         16  AT-INSTRUCT-LN-2            PIC X(28).
  6148         16  AT-INSTRUCT-LN-3            PIC X(28).
  6149         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6150         16  AT-FORM-ADDRESS             PIC X.
  6151             88  FORM-TO-INSURED              VALUE 'I'.
  6152             88  FORM-TO-ACCOUNT              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 118
* EL156.cbl
  6153             88  FORM-TO-OTHER-1              VALUE 'O'.
  6154             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6155         16  AT-RELATED-1.
  6156             20 AT-REL-CARR-1            PIC X.
  6157             20 AT-REL-CLAIM-1           PIC X(7).
  6158             20 AT-REL-CERT-1            PIC X(11).
  6159         16  AT-RELATED-2.
  6160             20 AT-REL-CARR-2            PIC X.
  6161             20 AT-REL-CLAIM-2           PIC X(7).
  6162             20 AT-REL-CERT-2            PIC X(11).
  6163         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6164         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6165         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6166         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6167         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6168         16  AT-STOP-FORM-DT             PIC X(2).
  6169
  6170         16  FILLER                      PIC X(09).
  6171         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6172         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6173******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 119
* EL156.cbl
  6175*    COPY ELCACTQ.
  6176******************************************************************
  6177*                                                                *
  6178*                            ELCACTQ.                            *
  6179*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6180*                            VMOD=2.004                          *
  6181*                                                                *
  6182*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6183*                                                                *
  6184*   FILE TYPE = VSAM,KSDS                                        *
  6185*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6186*                                                                *
  6187*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6188*       ALTERNATE INDEX = NONE                                   *
  6189*                                                                *
  6190*   LOG = YES                                                    *
  6191*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6192*                                                                *
  6193*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6194******************************************************************
  6195
  6196 01  ACTIVITY-QUE.
  6197     12  AQ-RECORD-ID                PIC XX.
  6198         88  VALID-AQ-ID                VALUE 'AQ'.
  6199
  6200     12  AQ-CONTROL-PRIMARY.
  6201         16  AQ-COMPANY-CD           PIC X.
  6202         16  AQ-CARRIER              PIC X.
  6203         16  AQ-CLAIM-NO             PIC X(7).
  6204         16  AQ-CERT-NO.
  6205             20  AQ-CERT-PRIME       PIC X(10).
  6206             20  AQ-CERT-SFX         PIC X.
  6207
  6208     12  AQ-PENDING-ACTIVITY-FLAGS.
  6209         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6210         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6211             88  PENDING-PAYMENTS       VALUE '1'.
  6212         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6213             88  PENDING-FULL-PRINT     VALUE '1'.
  6214             88  PENDING-PART-PRINT     VALUE '2'.
  6215         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6216             88  PENDING-LETTERS        VALUE '1'.
  6217         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6218             88  PENDING-RESTORE        VALUE 'C'.
  6219             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6220
  6221     12  FILLER                      PIC X(20).
  6222
  6223     12  AQ-RESEND-DATE              PIC XX.
  6224     12  AQ-FOLLOWUP-DATE            PIC XX.
  6225     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6226     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6227     12  AQ-AUTO-LETTER              PIC X(4).
  6228     12  FILLER                      PIC XX.
  6229     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6230*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 120
* EL156.cbl
  6232*    COPY ERCACCT.
  6233******************************************************************
  6234*                                                                *
  6235*                                                                *
  6236*                            ERCACCT                             *
  6237*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6238*                            VMOD=2.031                          *
  6239*                                                                *
  6240*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6241*                                                                *
  6242*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6243*   VSAM ACCOUNT MASTER FILES.                                   *
  6244*                                                                *
  6245*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6246*                                                                *
  6247*   FILE TYPE = VSAM,KSDS                                        *
  6248*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6249*                                                                *
  6250*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6251*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6252*                                                                *
  6253*   LOG = NO                                                     *
  6254*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6255*                                                                *
  6256*                                                                *
  6257******************************************************************
  6258*                   C H A N G E   L O G
  6259*
  6260* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6261*-----------------------------------------------------------------
  6262*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6263* EFFECTIVE    NUMBER
  6264*-----------------------------------------------------------------
  6265* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6266* 092705    2005050300006  PEMA  ADD SPP LEASES
  6267* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6268* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6269******************************************************************
  6270
  6271 01  ACCOUNT-MASTER.
  6272     12  AM-RECORD-ID                      PIC XX.
  6273         88  VALID-AM-ID                      VALUE 'AM'.
  6274
  6275     12  AM-CONTROL-PRIMARY.
  6276         16  AM-COMPANY-CD                 PIC X.
  6277         16  AM-MSTR-CNTRL.
  6278             20  AM-CONTROL-A.
  6279                 24  AM-CARRIER            PIC X.
  6280                 24  AM-GROUPING.
  6281                     28 AM-GROUPING-PREFIX PIC XXX.
  6282                     28 AM-GROUPING-PRIME  PIC XXX.
  6283                 24  AM-STATE              PIC XX.
  6284                 24  AM-ACCOUNT.
  6285                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6286                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6287             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6288                                           PIC X(19).
  6289             20  AM-CNTRL-B.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 121
* EL156.cbl
  6290                 24  AM-EXPIRATION-DT      PIC XX.
  6291                 24  FILLER                PIC X(4).
  6292             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6293                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6294
  6295     12  AM-CONTROL-BY-VAR-GRP.
  6296         16  AM-COMPANY-CD-A1              PIC X.
  6297         16  AM-VG-CARRIER                 PIC X.
  6298         16  AM-VG-GROUPING                PIC X(6).
  6299         16  AM-VG-STATE                   PIC XX.
  6300         16  AM-VG-ACCOUNT                 PIC X(10).
  6301         16  AM-VG-DATE.
  6302             20  AM-VG-EXPIRATION-DT       PIC XX.
  6303             20  FILLER                    PIC X(4).
  6304         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6305                                           PIC 9(11)      COMP-3.
  6306     12  AM-MAINT-INFORMATION.
  6307         16  AM-LAST-MAINT-DT              PIC XX.
  6308         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6309         16  AM-LAST-MAINT-USER            PIC X(4).
  6310         16  FILLER                        PIC XX.
  6311
  6312     12  AM-EFFECTIVE-DT                   PIC XX.
  6313     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6314
  6315     12  AM-PREV-DATES  COMP-3.
  6316         16  AM-PREV-EXP-DT                PIC 9(11).
  6317         16  AM-PREV-EFF-DT                PIC 9(11).
  6318
  6319     12  AM-REPORT-CODE-1                  PIC X(10).
  6320     12  AM-REPORT-CODE-2                  PIC X(10).
  6321
  6322     12  AM-CITY-CODE                      PIC X(4).
  6323     12  AM-COUNTY-PARISH                  PIC X(6).
  6324
  6325     12  AM-NAME                           PIC X(30).
  6326     12  AM-PERSON                         PIC X(30).
  6327     12  AM-ADDRS                          PIC X(30).
  6328     12  AM-CITY.
  6329         16  AM-ADDR-CITY                  PIC X(28).
  6330         16  AM-ADDR-STATE                 PIC XX.
  6331     12  AM-ZIP.
  6332         16  AM-ZIP-PRIME.
  6333             20  AM-ZIP-PRI-1ST            PIC X.
  6334                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6335             20  FILLER                    PIC X(4).
  6336         16  AM-ZIP-PLUS4                  PIC X(4).
  6337     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6338         16  AM-CAN-POSTAL-1               PIC XXX.
  6339         16  AM-CAN-POSTAL-2               PIC XXX.
  6340         16  FILLER                        PIC XXX.
  6341     12  AM-TEL-NO.
  6342         16  AM-AREA-CODE                  PIC 999.
  6343         16  AM-TEL-PRE                    PIC 999.
  6344         16  AM-TEL-NBR                    PIC 9(4).
  6345     12  AM-TEL-LOC                        PIC X.
  6346         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6347         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 122
* EL156.cbl
  6348
  6349     12  AM-COMM-STRUCTURE.
  6350         16  AM-DEFN-1.
  6351             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6352                 24  AM-AGT.
  6353                     28  AM-AGT-PREFIX     PIC X(4).
  6354                     28  AM-AGT-PRIME      PIC X(6).
  6355                 24  AM-COM-TYP            PIC X.
  6356                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6357                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6358                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6359                 24  AM-RECALC-LV-INDIC    PIC X.
  6360                 24  AM-RETRO-LV-INDIC     PIC X.
  6361                 24  AM-GL-CODES           PIC X.
  6362                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6363                 24  FILLER                PIC X(01).
  6364         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6365             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6366                 24  FILLER                PIC X(11).
  6367                 24  AM-L-COMA             PIC XXX.
  6368                 24  AM-J-COMA             PIC XXX.
  6369                 24  AM-A-COMA             PIC XXX.
  6370                 24  FILLER                PIC X(6).
  6371
  6372     12  AM-COMM-CHANGE-STATUS             PIC X.
  6373         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6374
  6375     12  AM-CSR-CODE                       PIC X(4).
  6376
  6377     12  AM-BILLING-STATUS                 PIC X.
  6378         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6379         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6380     12  AM-AUTO-REFUND-SW                 PIC X.
  6381         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6382         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6383     12  AM-GPCD                           PIC 99.
  6384     12  AM-IG                             PIC X.
  6385         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6386         88  AM-HAS-GROUP                     VALUE '2'.
  6387     12  AM-STATUS                         PIC X.
  6388         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6389         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6390         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6391         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6392         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6393     12  AM-REMIT-TO                       PIC 99.
  6394     12  AM-ID-NO                          PIC X(11).
  6395
  6396     12  AM-CAL-TABLE                      PIC XX.
  6397     12  AM-LF-DEVIATION                   PIC XXX.
  6398     12  AM-AH-DEVIATION                   PIC XXX.
  6399     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6400     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6401     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6402     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6403     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6404     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6405
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 123
* EL156.cbl
  6406     12  AM-USER-FIELDS.
  6407         16  AM-FLD-1                      PIC XX.
  6408         16  AM-FLD-2                      PIC XX.
  6409         16  AM-FLD-3                      PIC XX.
  6410         16  AM-FLD-4                      PIC XX.
  6411         16  AM-FLD-5                      PIC XX.
  6412
  6413     12  AM-1ST-PROD-DATE.
  6414         16  AM-1ST-PROD-YR                PIC XX.
  6415         16  AM-1ST-PROD-MO                PIC XX.
  6416         16  AM-1ST-PROD-DA                PIC XX.
  6417     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6418     12  AM-CERTS-PURGED-DATE.
  6419         16  AM-PUR-YR                     PIC XX.
  6420         16  AM-PUR-MO                     PIC XX.
  6421         16  AM-PUR-DA                     PIC XX.
  6422     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6423     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6424     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6425     12  AM-INACTIVE-DATE.
  6426         16  AM-INA-MO                     PIC 99.
  6427         16  AM-INA-DA                     PIC 99.
  6428         16  AM-INA-YR                     PIC 99.
  6429     12  AM-AR-HI-CERT-DATE                PIC XX.
  6430
  6431     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6432     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6433
  6434     12  AM-OB-PAYMENT-MODE                PIC X.
  6435         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6436         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6437         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6438         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6439
  6440     12  AM-AH-ONLY-INDICATOR              PIC X.
  6441         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6442         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6443
  6444     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6445
  6446     12  AM-OVER-SHORT.
  6447         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6448         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6449
  6450     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6451     12  AM-DCC-CLP-STATE                  PIC XX.
  6452
  6453     12  AM-RECALC-COMM                    PIC X.
  6454     12  AM-RECALC-REIN                    PIC X.
  6455
  6456     12  AM-REI-TABLE                      PIC XXX.
  6457     12  AM-REI-ET-LF                      PIC X.
  6458     12  AM-REI-ET-AH                      PIC X.
  6459     12  AM-REI-PE-LF                      PIC X.
  6460     12  AM-REI-PE-AH                      PIC X.
  6461     12  AM-REI-PRT-ST                     PIC X.
  6462     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6463     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 124
* EL156.cbl
  6464     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6465     12  AM-REI-GROUP-A                    PIC X(6).
  6466     12  AM-REI-MORT                       PIC X(4).
  6467     12  AM-REI-PRT-OW                     PIC X.
  6468     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6469     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6470     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6471     12  AM-REI-GROUP-B                    PIC X(6).
  6472
  6473     12  AM-TRUST-TYPE                     PIC X(2).
  6474
  6475     12  AM-EMPLOYER-STMT-USED             PIC X.
  6476     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6477
  6478     12  AM-STD-AH-TYPE                    PIC XX.
  6479     12  AM-EARN-METHODS.
  6480         16  AM-EARN-METHOD-R              PIC X.
  6481             88 AM-REF-RL-R78                 VALUE 'R'.
  6482             88 AM-REF-RL-PR                  VALUE 'P'.
  6483             88 AM-REF-RL-MEAN                VALUE 'M'.
  6484             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6485         16  AM-EARN-METHOD-L              PIC X.
  6486             88 AM-REF-LL-R78                 VALUE 'R'.
  6487             88 AM-REF-LL-PR                  VALUE 'P'.
  6488             88 AM-REF-LL-MEAN                VALUE 'M'.
  6489             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6490         16  AM-EARN-METHOD-A              PIC X.
  6491             88 AM-REF-AH-R78                 VALUE 'R'.
  6492             88 AM-REF-AH-PR                  VALUE 'P'.
  6493             88 AM-REF-AH-MEAN                VALUE 'M'.
  6494             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6495             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6496             88 AM-REF-AH-NET                 VALUE 'N'.
  6497
  6498     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6499     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6500     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6501
  6502     12  AM-RET-Y-N                        PIC X.
  6503     12  AM-RET-P-E                        PIC X.
  6504     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6505     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6506     12  AM-RET-GRP                        PIC X(6).
  6507     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6508         16  AM-POOL-PRIME                 PIC XXX.
  6509         16  AM-POOL-SUB                   PIC XXX.
  6510     12  AM-RETRO-EARNINGS.
  6511         16  AM-RET-EARN-R                 PIC X.
  6512         16  AM-RET-EARN-L                 PIC X.
  6513         16  AM-RET-EARN-A                 PIC X.
  6514     12  AM-RET-ST-TAX-USE                 PIC X.
  6515         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6516         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6517     12  AM-RETRO-BEG-EARNINGS.
  6518         16  AM-RET-BEG-EARN-R             PIC X.
  6519         16  AM-RET-BEG-EARN-L             PIC X.
  6520         16  AM-RET-BEG-EARN-A             PIC X.
  6521     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 125
* EL156.cbl
  6522     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6523
  6524     12  AM-USER-SELECT-OPTIONS.
  6525         16  AM-USER-SELECT-1              PIC X(10).
  6526         16  AM-USER-SELECT-2              PIC X(10).
  6527         16  AM-USER-SELECT-3              PIC X(10).
  6528         16  AM-USER-SELECT-4              PIC X(10).
  6529         16  AM-USER-SELECT-5              PIC X(10).
  6530
  6531     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6532
  6533     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6534
  6535     12  AM-RPT045A-SWITCH                 PIC X.
  6536         88  RPT045A-OFF                   VALUE 'N'.
  6537
  6538     12  AM-INSURANCE-LIMITS.
  6539         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6540         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6541
  6542     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6543         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6544
  6545     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6546         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6547         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6548
  6549     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6550
  6551     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6552     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6553     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6554     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6555     12  FILLER                            PIC X(5).
  6556     12  AM-REPORT-CODE-3                  PIC X(10).
  6557*    12  FILLER                            PIC X(22).
  6558
  6559     12  AM-RESERVE-DATE.
  6560         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6561         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6562         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6563
  6564     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6565     12  AM-NOTIFICATION-TYPES.
  6566         16  AM-NOTIF-OF-LETTERS           PIC X.
  6567         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6568         16  AM-NOTIF-OF-REPORTS           PIC X.
  6569         16  AM-NOTIF-OF-STATUS            PIC X.
  6570
  6571     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6572         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6573         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6574         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6575         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6576
  6577     12  AM-BENEFIT-CONTROLS.
  6578         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6579             20  AM-BENEFIT-CODE           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 126
* EL156.cbl
  6580             20  AM-BENEFIT-TYPE           PIC X.
  6581             20  AM-BENEFIT-REVISION       PIC XXX.
  6582             20  AM-BENEFIT-REM-TERM       PIC X.
  6583             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6584             20  FILLER                    PIC XX.
  6585         16  FILLER                        PIC X(80).
  6586
  6587     12  AM-TRANSFER-DATA.
  6588         16  AM-TRANSFERRED-FROM.
  6589             20  AM-TRNFROM-CARRIER        PIC X.
  6590             20  AM-TRNFROM-GROUPING.
  6591                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6592                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6593             20  AM-TRNFROM-STATE          PIC XX.
  6594             20  AM-TRNFROM-ACCOUNT.
  6595                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6596                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6597             20  AM-TRNFROM-DTE            PIC XX.
  6598         16  AM-TRANSFERRED-TO.
  6599             20  AM-TRNTO-CARRIER          PIC X.
  6600             20  AM-TRNTO-GROUPING.
  6601                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6602                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6603             20  AM-TRNTO-STATE            PIC XX.
  6604             20  AM-TRNTO-ACCOUNT.
  6605                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6606                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6607             20  AM-TRNTO-DTE              PIC XX.
  6608         16  FILLER                        PIC X(10).
  6609
  6610     12  AM-SAVED-REMIT-TO                 PIC 99.
  6611
  6612     12  AM-COMM-STRUCTURE-SAVED.
  6613         16  AM-DEFN-1-SAVED.
  6614             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6615                 24  AM-AGT-SV             PIC X(10).
  6616                 24  AM-COM-TYP-SV         PIC X.
  6617                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6618                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6619                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6620                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6621                 24  FILLER                PIC X.
  6622                 24  AM-GL-CODES-SV        PIC X.
  6623                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6624                 24  FILLER                PIC X.
  6625         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6626             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6627                 24  FILLER                PIC X(11).
  6628                 24  AM-L-COMA-SV          PIC XXX.
  6629                 24  AM-J-COMA-SV          PIC XXX.
  6630                 24  AM-A-COMA-SV          PIC XXX.
  6631                 24  FILLER                PIC X(6).
  6632
  6633     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6634         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6635            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6636            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6637            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 127
* EL156.cbl
  6638
  6639     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6640     12  FILLER                            PIC X(120).
  6641
  6642     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6643         16  AM-CONTROL-NAME               PIC X(30).
  6644         16  AM-EXECUTIVE-ONE.
  6645             20  AM-EXEC1-NAME             PIC X(15).
  6646             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6647                                                          COMP-3.
  6648             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6649                                                          COMP-3.
  6650         16  AM-EXECUTIVE-TWO.
  6651             20  AM-EXEC2-NAME             PIC X(15).
  6652             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6653                                                          COMP-3.
  6654             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6655                                                          COMP-3.
  6656
  6657     12  AM-RETRO-ADDITIONAL-DATA.
  6658         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6659         16  AM-RETRO-PREM-P-E             PIC X.
  6660         16  AM-RETRO-CLMS-P-I             PIC X.
  6661         16  AM-RETRO-RET-BRACKET-LF.
  6662             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6663                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6664                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6665             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6666                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6667                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6668             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6669                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6670                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6671         16  AM-RETRO-RET-BRACKET-AH.
  6672             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6673                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6674                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6675                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6676             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6677                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6678                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6679             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6680                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6681                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6682
  6683     12  AM-COMMENTS.
  6684         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  6685
  6686     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6687         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6688         16  AM-FLI-BILLING-CODE           PIC X.
  6689         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6690         16  AM-FLI-UNITED-IDENT           PIC X.
  6691         16  AM-FLI-INTEREST-LOST-DATA.
  6692             20  AM-FLI-BANK-NO            PIC X(5).
  6693             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6694             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6695             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 128
* EL156.cbl
  6696         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6697             20  AM-FLI-AGT                PIC X(9).
  6698             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6699             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6700         16  FILLER                        PIC X(102).
  6701
  6702     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6703         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6704             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6705             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6706             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6707             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6708             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6709         16  FILLER                          PIC X(10).
  6710******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 129
* EL156.cbl
  6712*    COPY ELCCHKQ.
  6713******************************************************************
  6714*                                                                *
  6715*                                                                *
  6716*                            ELCCHKQ.                            *
  6717*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6718*                            VMOD=2.007                          *
  6719*                                                                *
  6720*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6721*                                                                *
  6722*   FILE TYPE = VSAM,KSDS                                        *
  6723*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6724*                                                                *
  6725*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6726*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6727*                                                                *
  6728*   LOG = YES                                                    *
  6729*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6730******************************************************************
  6731 01  CHECK-QUE.
  6732     12  CQ-RECORD-ID                PIC XX.
  6733         88  VALID-CQ-ID         VALUE 'CQ'.
  6734
  6735     12  CQ-CONTROL-PRIMARY.
  6736         16  CQ-COMPANY-CD           PIC X.
  6737         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6738         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6739
  6740     12  CQ-CONTROL-BY-PAYEE.
  6741         16  CQ-CONTROL-BY-NUMBER.
  6742             20  CQ-COMPANY-CD-A1     PIC X.
  6743             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6744         16  CQ-PAYEE-CARRIER        PIC X.
  6745         16  CQ-PAYEE-GROUPING       PIC X(6).
  6746         16  CQ-PAYEE-STATE          PIC XX.
  6747         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  6748         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  6749
  6750     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  6751         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  6752         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  6753         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  6754         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  6755         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  6756         16  FILLER                  PIC X(3).
  6757
  6758     12  CQ-ENTRY-TYPE               PIC X.
  6759             88  CHECK-ON-QUE           VALUE 'Q'.
  6760             88  ALIGNMENT-CHECK        VALUE 'A'.
  6761             88  SPOILED-CHECK          VALUE 'S'.
  6762             88  PAYMENT-ABORTED        VALUE 'X'.
  6763
  6764     12  CQ-CLAIM-MAST-CNTL.
  6765         16  CQ-CARRIER              PIC X.
  6766         16  CQ-CLAIM-NO             PIC X(7).
  6767         16  CQ-CERT-NO.
  6768             20  CQ-CERT-PRIME       PIC X(10).
  6769             20  CQ-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 130
* EL156.cbl
  6770         16  CQ-CLAIM-TYPE           PIC X.
  6771             88  CQ-LIFE-CLAIM          VALUE 'L'.
  6772             88  CQ-AH-CLAIM            VALUE 'A'.
  6773         16  CQ-CLAIM-SUB-TYPE       PIC X.
  6774             88  CQ-FIXED-COVERAGE      VALUE '1'.
  6775             88  CQ-O-B-COVERAGE        VALUE '2'.
  6776             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  6777
  6778     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  6779     12  CQ-CHECK-NUMBER             PIC X(7).
  6780     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  6781     12  CQ-PAYMENT-TYPE             PIC X.
  6782             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  6783             88  CQ-FINAL-PAYMENT          VALUE '2'.
  6784             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  6785             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  6786             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  6787             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  6788             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  6789             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  6790     12  CQ-VOID-INDICATOR           PIC X.
  6791             88  CHECK-IS-STOPPED          VALUE 'S'.
  6792             88  CHECK-IS-VOID             VALUE 'V'.
  6793     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  6794     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  6795     12  CQ-CHECK-BY-USER            PIC X(4).
  6796     12  CQ-PRE-NUMBERING-SW         PIC X.
  6797       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  6798       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  6799
  6800     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  6801     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  6802     12  CQ-LEDGER-FLAG              PIC X(01).
  6803     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  6804     12  CQ-LAST-UPDATED-DT          PIC XX.
  6805     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  6806     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  6807
  6808     12  FILLER                      PIC X(04).
  6809
  6810******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 131
* EL156.cbl
  6812*    COPY ELCBENE.
  6813******************************************************************
  6814*                                                                *
  6815*                            ELCBENE.                            *
  6816*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6817*                            VMOD=2.006                          *
  6818*                                                                *
  6819*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6820*                                                                *
  6821*   FILE TYPE = VSAM,KSDS                                        *
  6822*   RECORD SIZE = 500   RECFORM = FIX                            *
  6823*                                                                *
  6824*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6825*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6826*                                                                *
  6827*   LOG = YES                                                    *
  6828*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6829*                                                                *
  6830*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6831******************************************************************
  6832
  6833 01  BENEFICIARY-MASTER.
  6834     12  BE-RECORD-ID                PIC XX.
  6835         88  VALID-BE-ID                VALUE 'BE'.
  6836
  6837     12  BE-CONTROL-PRIMARY.
  6838         16  BE-COMPANY-CD           PIC X.
  6839         16  BE-RECORD-TYPE          PIC X.
  6840             88  BENEFICIARY-RECORD  VALUE 'B'.
  6841             88  ADJUSTOR-RECORD     VALUE 'A'.
  6842         16  BE-BENEFICIARY          PIC X(10).
  6843     12  BE-CONTROL-BY-NAME.
  6844         16  BE-COMPANY-CD-A1        PIC X.
  6845         16  BE-RECORD-TYPE-A1       PIC X.
  6846         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6847         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6848
  6849     12  BE-LAST-MAINT-DT            PIC XX.
  6850     12  BE-LAST-MAINT-BY            PIC X(4).
  6851     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6852
  6853     12  BE-ADDRESS-DATA.
  6854         16  BE-MAIL-TO-NAME         PIC X(30).
  6855         16  BE-ADDRESS-LINE-1       PIC X(30).
  6856         16  BE-ADDRESS-LINE-2       PIC X(30).
  6857         16  BE-ADDRESS-LINE-3       PIC X(30).
  6858         16  BE-CITY-STATE.
  6859             20  BE-CITY             PIC X(28).
  6860             20  BE-STATE            PIC XX.
  6861         16  BE-ZIP-CODE.
  6862             20  BE-ZIP-PRIME.
  6863                 24  BE-ZIP-1ST      PIC X.
  6864                     88  BE-CANADIAN-POST-CODE
  6865                                         VALUE 'A' THRU 'Z'.
  6866                 24  FILLER          PIC X(4).
  6867             20  BE-ZIP-PLUS4        PIC X(4).
  6868         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6869             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 132
* EL156.cbl
  6870             20  BE-CAN-POSTAL-2     PIC XXX.
  6871             20  FILLER              PIC XXX.
  6872         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6873         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6874
  6875******************************************************************
  6876*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6877*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6878******************************************************************
  6879     12  BE-CARRIER                  PIC X.
  6880
  6881     12  BE-ADDRESS-DATA2.
  6882         16  BE-MAIL-TO-NAME2        PIC X(30).
  6883         16  BE-ADDRESS-LINE-12      PIC X(30).
  6884         16  BE-ADDRESS-LINE-22      PIC X(30).
  6885         16  BE-ADDRESS-LINE-32      PIC X(30).
  6886         16  BE-CITY-STATE2.
  6887             20  BE-CITY2            PIC X(28).
  6888             20  BE-STATE2           PIC XX.
  6889         16  BE-ZIP-CODE2.
  6890             20  BE-ZIP-PRIME2.
  6891                 24  BE-ZIP-1ST2     PIC X.
  6892                     88  BE-CANADIAN-POST-CODE2
  6893                                         VALUE 'A' THRU 'Z'.
  6894                 24  FILLER          PIC X(4).
  6895             20  BE-ZIP-PLUS42       PIC X(4).
  6896         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6897             20  BE-CAN-POSTAL-12    PIC XXX.
  6898             20  BE-CAN-POSTAL-22    PIC XXX.
  6899             20  FILLER              PIC XXX.
  6900         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6901         16  BE-BILLING-STMT-DATA.
  6902             20  BE-BSR              PIC X.
  6903                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  6904                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  6905             20  BE-BSR-FROM         PIC X(30).
  6906             20  BE-BSR-DEPT         PIC X(30).
  6907             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  6908             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  6909             20  BE-OUTPUT-TYPE      PIC X.
  6910                 88  BE-FAX-OUTPUT         VALUE 'F'.
  6911                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  6912
  6913     12  FILLER                      PIC X(28).
  6914******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 133
* EL156.cbl
  6916*    COPY ELCARCH.
  6917******************************************************************
  6918*                                                                *
  6919*                            ELCARCH.                            *
  6920*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6921*                            VMOD=2.007                          *
  6922*                                                                *
  6923*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6924*                                                                *
  6925*   FILE TYPE = VSAM,KSDS                                        *
  6926*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6927*                                                                *
  6928*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6929*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6930*                                                                *
  6931*   LOG = NO                                                     *
  6932*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6933*                                                                *
  6934*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6935******************************************************************
  6936 01  LETTER-ARCHIVE.
  6937     12  LA-RECORD-ID                PIC XX.
  6938         88  VALID-LA-ID                VALUE 'LA'.
  6939
  6940     12  LA-CONTROL-PRIMARY.
  6941         16  LA-COMPANY-CD           PIC X.
  6942         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6943         16  LA-RECORD-TYPE          PIC X.
  6944             88  LA-HEADER-DATA         VALUE '1'.
  6945             88  LA-ADDRESS-DATA        VALUE '2'.
  6946             88  LA-TEXT-DATA           VALUE '3'.
  6947             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6948         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6949
  6950     12  LA-CONTROL-BY-TYPE.
  6951         16  LA-COMPANY-CD-A1        PIC X.
  6952         16  LA-RECORD-TYPE-A1       PIC X.
  6953         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6954         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6955
  6956     12  LA-TEXT-RECORD.
  6957         16  LA-SKIP-CONTROL         PIC XX.
  6958             88  NO-LINES-SKIPPED       VALUE SPACES.
  6959             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6960         16  LA-TEXT-LINE            PIC X(70).
  6961
  6962     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6963         16  FILLER                  PIC XX.
  6964         16  LA-ADDRESS-LINE         PIC X(30).
  6965         16  FILLER                  PIC X(40).
  6966
  6967     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6968         16  FILLER                  PIC XX.
  6969         16  LA-CARRIER              PIC X.
  6970         16  LA-CLAIM-NO             PIC X(7).
  6971         16  LA-CERT-NO.
  6972             20  LA-CERT-PRIME       PIC X(10).
  6973             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 134
* EL156.cbl
  6974         16  LA-NO-OF-COPIES         PIC S9.
  6975         16  LA-RESEND-DATE          PIC XX.
  6976         16  LA-PROCESSOR-CD         PIC X(4).
  6977         16  LA-CREATION-DT          PIC XX.
  6978         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6979         16  LA-RESEND-PRINT-DATE    PIC XX.
  6980         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6981         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6982*
  6983* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6984*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6985*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6986*   I        20  LA-DMD-RES-ST           PIC XX.
  6987*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6988*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6989*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6990*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6991*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6992*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6993*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6994*   I        20  LA-DMD-UND-CODE         PIC XX.
  6995*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6996*   V    16  FILLER                  PIC X(15).
  6997* -----
  6998*
  6999* REINSERTED  CSO  MODS
  7000*
  7001         16  FILLER.
  7002             20  FILLER                  PIC X(29).
  7003             20  LA-CSO-LETTER-STATUS    PIC X.
  7004                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  7005                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  7006                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  7007             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  7008             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  7009*
  7010
  7011     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  7012         16  FILLER                  PIC XX.
  7013         16  LA4-CARRIER             PIC X.
  7014         16  LA4-CLAIM-NO            PIC X(7).
  7015         16  LA4-CERT-NO.
  7016             20  LA4-CERT-PRIME      PIC X(10).
  7017             20  LA4-CERT-SFX        PIC X.
  7018         16  LA4-NO-OF-COPIES        PIC S9.
  7019         16  LA4-RESEND-DATE         PIC XX.
  7020         16  LA4-PROCESSOR-CD        PIC X(4).
  7021         16  LA4-CREATION-DT         PIC XX.
  7022         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  7023         16  LA4-RESEND-PRINT-DATE   PIC XX.
  7024         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  7025         16  LA4-FORM-TYPE           PIC X.
  7026             88  LA4-INITIAL-FORM    VALUE '1'.
  7027             88  LA4-PROGRESS-FORM   VALUE '2'.
  7028         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  7029         16  LA4-STATE               PIC X(02).
  7030         16  FILLER                  PIC X(31).
  7031******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 135
* EL156.cbl
  7033*    COPY ELCDAR.
  7034******************************************************************
  7035*                                                                *
  7036*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7037*   FILE TYPE = VSAM,KSDS                                        *
  7038*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7039*   BASE CLUSTER = DLYACTV                                       *
  7040*   LOG = YES                                                    *
  7041*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7042*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7043*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7044*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7045*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7046*               BY PROGRAM "LGINFCE".                            *
  7047*                                                                *
  7048******************************************************************
  7049 01  DAILY-ACTIVITY-RECORD.
  7050     05  DA-KEY.
  7051         10  DA-COMP-CD          PIC X.
  7052         10  DA-CARRIER          PIC X.
  7053         10  DA-CLAIM-NO         PIC X(7).
  7054         10  DA-CERT-NO.
  7055             15  DA-CERT-PRIME   PIC X(10).
  7056             15  DA-CERT-SFX     PIC X.
  7057     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7058     05  DA-RECORD-TYPE          PIC X.
  7059     05  FILLER                  PIC X(2).
  7060******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 136
* EL156.cbl
  7062*    COPY ERCCOMP.
  7063******************************************************************
  7064*                                                                *
  7065*                                                                *
  7066*                            ERCCOMP                             *
  7067*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7068*                            VMOD=2.019                          *
  7069*                                                                *
  7070*   ONLINE CREDIT SYSTEM                                         *
  7071*                                                                *
  7072*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  7073*                                                                *
  7074*   FILE TYPE = VSAM,KSDS                                        *
  7075*   RECORD SIZE = 700   RECFORM = FIXED                          *
  7076*                                                                *
  7077*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  7078*       ALTERNATE PATH = NONE                                    *
  7079*                                                                *
  7080*   LOG = NO                                                     *
  7081*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7082*                                                                *
  7083******************************************************************
  7084*                   C H A N G E   L O G
  7085*
  7086* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7087*-----------------------------------------------------------------
  7088*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7089* EFFECTIVE    NUMBER
  7090*-----------------------------------------------------------------
  7091* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7092* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  7093* 092205    2005050300006  PEMA  ADD LEASE FEE
  7094* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  7095* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  7096* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  7097* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7098* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  7099******************************************************************
  7100
  7101 01  COMPENSATION-MASTER.
  7102     12  CO-RECORD-ID                          PIC XX.
  7103         88  VALID-CO-ID                          VALUE 'CO'.
  7104
  7105     12  CO-CONTROL-PRIMARY.
  7106         16  CO-COMPANY-CD                     PIC X.
  7107         16  CO-CONTROL.
  7108             20  CO-CTL-1.
  7109                 24  CO-CARR-GROUP.
  7110                     28  CO-CARRIER            PIC X.
  7111                     28  CO-GROUPING.
  7112                         32  CO-GROUP-PREFIX   PIC XXX.
  7113                         32  CO-GROUP-PRIME    PIC XXX.
  7114                 24  CO-RESP-NO.
  7115                     28  CO-RESP-PREFIX        PIC X(4).
  7116                     28  CO-RESP-PRIME         PIC X(6).
  7117             20  CO-CTL-2.
  7118                 24  CO-ACCOUNT.
  7119                     28  CO-ACCT-PREFIX        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 137
* EL156.cbl
  7120                     28  CO-ACCT-PRIME         PIC X(6).
  7121         16  CO-TYPE                           PIC X.
  7122             88  CO-COMPANY-TYPE                  VALUE 'C'.
  7123             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  7124             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  7125
  7126     12  CO-MAINT-INFORMATION.
  7127         16  CO-LAST-MAINT-DT                  PIC XX.
  7128         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7129         16  CO-LAST-MAINT-USER                PIC X(4).
  7130     12  FILLER                                PIC XX.
  7131     12  CO-STMT-TYPE                          PIC XXX.
  7132     12  CO-COMP-TYPE                          PIC X.
  7133         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  7134     12  CO-STMT-OWNER                         PIC X(4).
  7135     12  CO-BALANCE-CONTROL                    PIC X.
  7136         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  7137         88  CO-NO-BALANCE                        VALUE 'N'.
  7138
  7139     12  CO-INTERNAL-CONTROL-1                 PIC X.
  7140         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  7141         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  7142         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  7143
  7144     12  CO-INTERNAL-CONTROL-2                 PIC X.
  7145         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  7146         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  7147
  7148     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  7149     12  CO-GA-DIRECT-DEP                      PIC X.
  7150     12  CO-FUTURE-SPACE                       PIC X.
  7151         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  7152
  7153     12  CO-ACCT-NAME                          PIC X(30).
  7154     12  CO-MAIL-NAME                          PIC X(30).
  7155     12  CO-ADDR-1                             PIC X(30).
  7156     12  CO-ADDR-2                             PIC X(30).
  7157     12  CO-ADDR-3.
  7158         16  CO-ADDR-CITY                      PIC X(27).
  7159         16  CO-ADDR-STATE                     PIC XX.
  7160     12  CO-CSO-1099                           PIC X.
  7161     12  CO-ZIP.
  7162         16  CO-ZIP-PRIME.
  7163             20  CO-ZIP-PRI-1ST                PIC X.
  7164                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  7165             20  FILLER                        PIC X(4).
  7166         16  CO-ZIP-PLUS4                      PIC X(4).
  7167     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  7168         16  CO-CAN-POSTAL-1                   PIC XXX.
  7169         16  CO-CAN-POSTAL-2                   PIC XXX.
  7170         16  FILLER                            PIC XXX.
  7171     12  CO-SOC-SEC                            PIC X(13).
  7172     12  CO-TELEPHONE.
  7173         16  CO-AREA-CODE                      PIC XXX.
  7174         16  CO-PREFIX                         PIC XXX.
  7175         16  CO-PHONE                          PIC X(4).
  7176
  7177     12  CO-ROLADEX-PRINT-DT                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 138
* EL156.cbl
  7178
  7179     12  CO-AR-BAL-LEVEL                       PIC X.
  7180         88  CO-AR-REF-LVL                        VALUE '1'.
  7181         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  7182         88  CO-AR-BILL-LVL                       VALUE '2'.
  7183         88  CO-AR-AGT-LVL                        VALUE '3'.
  7184         88  CO-AR-FR-LVL                         VALUE '4'.
  7185
  7186     12  CO-AR-NORMAL-PRINT                    PIC X.
  7187         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  7188         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  7189
  7190     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  7191
  7192     12  CO-AR-REPORTING                       PIC X.
  7193         88  CO-AR-NET-REPORT                     VALUE 'N'.
  7194         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  7195
  7196     12  CO-AR-PULL-CHECK                      PIC X.
  7197         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  7198         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  7199
  7200     12  CO-AR-BALANCE-PRINT                   PIC X.
  7201         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  7202
  7203     12  CO-AR-LAST-RUN-CODE                   PIC X.
  7204         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  7205         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  7206         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  7207
  7208     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  7209
  7210     12  CO-USER-CODE                          PIC X.
  7211     12  CO-REPORT-GROUP-ID                    PIC X(12).
  7212
  7213******************************************************************
  7214*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  7215*    THE LAST MONTH END RUN.
  7216******************************************************************
  7217
  7218     12  CO-LAST-ACTIVITY-DATE.
  7219         16  CO-ACT-YEAR                       PIC 99.
  7220         16  CO-ACT-MONTH                      PIC 99.
  7221         16  CO-ACT-DAY                        PIC 99.
  7222
  7223     12  CO-LAST-STMT-DT.
  7224         16  CO-LAST-STMT-YEAR                 PIC 99.
  7225         16  CO-LAST-STMT-MONTH                PIC 99.
  7226         16  CO-LAST-STMT-DAY                  PIC 99.
  7227
  7228     12  CO-MO-END-TOTALS.
  7229         16  CO-MONTHLY-TOTALS.
  7230             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  7231             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  7232             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  7233             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  7234             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  7235
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 139
* EL156.cbl
  7236         16  CO-AGING-TOTALS.
  7237             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  7238             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  7239             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  7240             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  7241
  7242         16  CO-YTD-TOTALS.
  7243             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  7244             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  7245
  7246         16  CO-OVER-UNDER-TOTALS.
  7247             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7248             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7249
  7250     12  CO-MISCELLANEOUS-TOTALS.
  7251         16  CO-FICA-TOTALS.
  7252             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  7253             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  7254
  7255         16  CO-CLAIM-TOTALS.
  7256             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  7257             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  7258
  7259******************************************************************
  7260*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  7261*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  7262******************************************************************
  7263
  7264     12  CO-CURRENT-TOTALS.
  7265         16  CO-CURRENT-LAST-STMT-DT.
  7266             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  7267             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  7268             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  7269
  7270         16  CO-CURRENT-MONTHLY-TOTALS.
  7271             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  7272             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  7273             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  7274             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  7275             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  7276
  7277         16  CO-CURRENT-AGING-TOTALS.
  7278             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  7279             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  7280             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  7281             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  7282
  7283         16  CO-CURRENT-YTD-TOTALS.
  7284             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  7285             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  7286
  7287     12  CO-PAID-COMM-TOTALS.
  7288         16  CO-YTD-PAID-COMMS.
  7289             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  7290             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  7291
  7292     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  7293         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 140
* EL156.cbl
  7294         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  7295
  7296     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  7297         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  7298         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  7299         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  7300         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  7301         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  7302         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  7303         88  CO-FINAL-LETTER                  VALUE 'F'.
  7304         88  CO-RECONCILING                   VALUE 'R'.
  7305         88  CO-PHONE-CALL                    VALUE 'P'.
  7306         88  CO-LEGAL                         VALUE 'L'.
  7307         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  7308         88  CO-WRITE-OFF                     VALUE 'W'.
  7309         88  CO-NO-ACTION                     VALUE 'N' ' '.
  7310
  7311     12  CO-CSR-CODE                       PIC X(4).
  7312
  7313     12  CO-GA-STATUS-INFO.
  7314         16  CO-GA-EFFECTIVE-DT            PIC XX.
  7315         16  CO-GA-TERMINATION-DT          PIC XX.
  7316         16  CO-GA-STATUS-CODE             PIC X.
  7317             88  CO-GA-ACTIVE                 VALUE 'A'.
  7318             88  CO-GA-INACTIVE               VALUE 'I'.
  7319             88  CO-GA-PENDING                VALUE 'P'.
  7320         16  CO-GA-COMMENTS.
  7321             20  CO-GA-COMMENT-1           PIC X(40).
  7322             20  CO-GA-COMMENT-2           PIC X(40).
  7323             20  CO-GA-COMMENT-3           PIC X(40).
  7324             20  CO-GA-COMMENT-4           PIC X(40).
  7325
  7326     12  CO-RPTCD2                         PIC X(10).
  7327
  7328     12  CO-TYPE-AGENT                     PIC X(01).
  7329         88  CO-CORPORATION                   VALUE 'C'.
  7330         88  CO-PARTNERSHIP                   VALUE 'P'.
  7331         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  7332         88  CO-TRUST                         VALUE 'T'.
  7333         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  7334
  7335     12  CO-FAXNO.
  7336         16  CO-FAX-AREA-CODE                  PIC XXX.
  7337         16  CO-FAX-PREFIX                     PIC XXX.
  7338         16  CO-FAX-PHONE                      PIC X(4).
  7339
  7340     12  CO-BANK-INFORMATION.
  7341         16  CO-BANK-TRANSIT-NO                PIC X(8).
  7342         16  CO-BANK-TRANSIT-NON REDEFINES
  7343             CO-BANK-TRANSIT-NO                PIC 9(8).
  7344
  7345         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  7346     12  CO-MISC-DEDUCT-INFO REDEFINES
  7347                  CO-BANK-INFORMATION.
  7348         16  CO-MD-GL-ACCT                     PIC X(10).
  7349         16  CO-MD-DIV                         PIC XX.
  7350         16  CO-MD-CENTER                      PIC X(4).
  7351         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 141
* EL156.cbl
  7352         16  CO-CREATE-AP-CHECK                PIC X.
  7353         16  CO-DELIVER-CK-TO-MEL              PIC X.
  7354         16  FILLER                            PIC XXX.
  7355     12  CO-ACH-STATUS                         PIC X.
  7356         88  CO-ACH-ACTIVE                         VALUE 'A'.
  7357         88  CO-ACH-PENDING                        VALUE 'P'.
  7358
  7359     12  CO-BILL-SW                            PIC X.
  7360     12  CO-CONTROL-NAME                       PIC X(30).
  7361     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  7362     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  7363     12  CO-CLP-STATE                          PIC XX.
  7364     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  7365     12  CO-SPP-REFUND-EDIT                    PIC X.
  7366
  7367******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 142
* EL156.cbl
  7369*    COPY ERCDMDNT.
  7370******************************************************************
  7371*                                                                *
  7372*                            ERCDMDNT                            *
  7373*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7374*                            VMOD=2.005                          *
  7375*                                                                *
  7376*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7377*                                                                *
  7378*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7379*                                                                *
  7380*        FILE TYPE= VSAM,KSDS                                    *
  7381*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7382*                                                                *
  7383*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7384*                                                                *
  7385*        LOG = YES                                               *
  7386*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7387*                                                                *
  7388******************************************************************
  7389
  7390 01  CERTIFICATE-NOTE.
  7391     12  CN-RECORD-ID                     PIC  XX.
  7392         88  VALID-CN-ID                      VALUE 'CN'.
  7393
  7394     12  CN-CONTROL-PRIMARY.
  7395         16  CN-COMPANY-CD                PIC X.
  7396         16  CN-CERT-KEY.
  7397             20  CN-CARRIER               PIC X.
  7398             20  CN-GROUPING.
  7399                 24  CN-GROUPING-PREFIX   PIC XXX.
  7400                 24  CN-GROUPING-PRIME    PIC XXX.
  7401             20  CN-STATE                 PIC XX.
  7402             20  CN-ACCOUNT.
  7403                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7404                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7405             20  CN-CERT-EFF-DT           PIC XX.
  7406             20  CN-CERT-NO.
  7407                 24  CN-CERT-PRIME        PIC X(10).
  7408                 24  CN-CERT-SFX          PIC X.
  7409
  7410     12  CN-BILLING-START-LINE-NO         PIC 99.
  7411     12  CN-BILLING-END-LINE-NO           PIC 99.
  7412
  7413     12  CN-LINES.
  7414         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7415
  7416     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7417         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7418         16  CN-CSI-GENERAL-DATA-AREA.
  7419             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7420
  7421         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7422             CN-CSI-GENERAL-DATA-AREA.
  7423             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7424             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7425             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7426             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 143
* EL156.cbl
  7427             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7428             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7429             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7430             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7431             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7432             20  FILLER                       PIC XX.
  7433             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7434             20  FILLER                       PIC X(38).
  7435
  7436         16  CN-CSI-PRODUCT-DATA-AREA.
  7437             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7438
  7439         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7440             CN-CSI-PRODUCT-DATA-AREA.
  7441             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7442             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7443             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7444             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7445             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7446             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7447             20  FILLER                   PIC XX.
  7448             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7449             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7450             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7451             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7452             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7453             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7454             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7455             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7456             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7457             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7458             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7459             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7460             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7461             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7462             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7463             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7464             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7465             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7466             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7467             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7468             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7469             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7470             20  FILLER                   PIC X(25).
  7471
  7472         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7473             CN-CSI-CREDIT-CARD-DATA.
  7474             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7475             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7476             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7477             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7478             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7479             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7480             20  FILLER                   PIC XX.
  7481             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7482             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7483             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7484             20  CN-CSI-FL-ISSUE-ST       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 144
* EL156.cbl
  7485             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7486             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7487             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7488             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7489             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7490             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7491             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7492             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7493             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7494             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7495             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7496             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7497             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7498             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7499             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7500             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7501             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7502             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7503             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7504             20  FILLER                   PIC X(17).
  7505
  7506         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7507             CN-CSI-FAMILY-LEAVE-DATA.
  7508             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7509             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7510             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7511             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7512             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7513             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7514             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7515             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7516             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7517             20  CN-CSI-SL-INT-ON-PROCEEDS
  7518                                          PIC S9(5)V99  COMP-3.
  7519             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7520             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7521             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7522             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7523             20  CN-CSI-SL-POLICY-BENEFITS
  7524                                          PIC S9(5)V99  COMP-3.
  7525             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7526             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7527             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7528             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7529             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7530             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7531             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7532             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7533             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7534             20  CN-CSI-SL-STATE-NOT      PIC X.
  7535             20  FILLER                   PIC XX.
  7536
  7537         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7538             CN-CSI-SENIOR-LIFE-DATA.
  7539             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7540             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7541             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7542                                          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 145
* EL156.cbl
  7543             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7544             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7545             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7546             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7547             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7548             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7549             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7550             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7551             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7552             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7553             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7554             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7555             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7556             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7557             20  CN-CSI-PP-REPAIR         PIC X.
  7558             20  CN-CSI-PP-REPLACE        PIC X.
  7559             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7560             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7561             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7562             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7563             20  FILLER                   PIC X(5).
  7564
  7565         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7566             CN-CSI-PURCH-PROP-DATA.
  7567             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7568             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7569             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7570             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7571             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7572             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7573             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7574             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7575             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7576             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7577             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7578             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7579             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7580             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7581             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7582             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7583             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7584             20  CN-CSI-EW-REPLACE        PIC X.
  7585             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7586             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7587             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7588             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7589             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7590             20  FILLER                   PIC X(4).
  7591
  7592     12  CN-LAST-MAINT-DT                 PIC XX.
  7593     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7594     12  CN-LAST-MAINT-USER               PIC X(4).
  7595     12  FILLER                           PIC X(6).
  7596
  7597******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 146
* EL156.cbl
  7599*    COPY ERCCNOT.
  7600******************************************************************
  7601*                                                                *
  7602*                            ERCCNOT                             *
  7603*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7604*                            VMOD=2.003                          *
  7605*                                                                *
  7606*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7607*                                                                *
  7608*        FILE TYPE= VSAM,KSDS                                    *
  7609*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7610*                                                                *
  7611*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7612*                                                                *
  7613*        LOG = YES                                               *
  7614*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7615*                                                                *
  7616******************************************************************
  7617*                   C H A N G E   L O G
  7618*
  7619* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7620*-----------------------------------------------------------------
  7621*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7622* EFFECTIVE    NUMBER
  7623*-----------------------------------------------------------------
  7624* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7625******************************************************************
  7626
  7627 01  CERT-NOTE-FILE.
  7628     12  CZ-RECORD-ID                PIC  XX.
  7629         88  VALID-CZ-ID                  VALUE 'CZ'.
  7630
  7631     12  CZ-CONTROL-PRIMARY.
  7632         16  CZ-COMPANY-CD           PIC X.
  7633         16  CZ-CARRIER              PIC X.
  7634         16  CZ-GROUPING.
  7635             20 CZ-GROUPING-PREFIX   PIC XXX.
  7636             20 CZ-GROUPING-PRIME    PIC XXX.
  7637         16  CZ-STATE                PIC XX.
  7638         16  CZ-ACCOUNT.
  7639             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7640             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7641         16  CZ-CERT-EFF-DT          PIC XX.
  7642         16  CZ-CERT-NO.
  7643             20  CZ-CERT-PRIME       PIC X(10).
  7644             20  CZ-CERT-SFX         PIC X.
  7645         16  CZ-RECORD-TYPE          PIC X.
  7646             88  CERT-NOTE           VALUE '1'.
  7647             88  CLAIM-CERT-NOTE     VALUE '2'.
  7648         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7649
  7650     12  CZ-LAST-MAINT-DT            PIC XX.
  7651     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7652     12  CZ-LAST-MAINT-USER          PIC X(4).
  7653
  7654     12  CZ-NOTE-INFORMATION.
  7655         16  CZ-NOTE                 PIC X(63).
  7656         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 147
* EL156.cbl
  7657******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 148
* EL156.cbl
  7659 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7660                          CONTROL-FILE CERTIFICATE-MASTER
  7661                          ACTIVITY-TRAILERS ACTIVITY-QUE
  7662                          ACCOUNT-MASTER CHECK-QUE
  7663                          BENEFICIARY-MASTER LETTER-ARCHIVE
  7664                          DAILY-ACTIVITY-RECORD
  7665                          COMPENSATION-MASTER CERTIFICATE-NOTE
  7666                          CERT-NOTE-FILE.
  7667 0000-DFHEXIT SECTION.
  7668     MOVE '9#                    $   ' TO DFHEIV0.
  7669     MOVE 'EL156' TO DFHEIV1.
  7670     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7671
  7672     IF EIBCALEN = 0
  7673         GO TO 8800-UNAUTHORIZED-ACCESS.
  7674
  7675     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  7676     MOVE EIBTRMID               TO QID-TERM.
  7677     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  7678     MOVE '2'                    TO EMI-SWITCH2.
  7679     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7680     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7681
  7682     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7683     MOVE '5'                    TO DC-OPTION-CODE.
  7684     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  7685     MOVE DC-BIN-DATE-1          TO WS-TODAY-DATE
  7686                                    SAVE-BIN-DATE.
  7687     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE.
  7688     MOVE DC-GREG-DATE-1-YMD     TO SAVE-DATE-YMD.
  7689
  7690     IF SAVE-DATE-YY > 70
  7691         MOVE 19                 TO SAVE-DATE-CC
  7692     ELSE
  7693         MOVE 20                 TO SAVE-DATE-CC.
  7694
  7695     IF PI-PROOF-DATE NOT = 0 AND LOW-VALUES
  7696         MOVE PI-PROOF-DATE TO WS-PROOF-DATE
  7697     END-IF.
  7698
  7699     IF PI-PRINT-EOB-YN = 'Y'
  7700        MOVE 'Y'                 TO WS-PRINT-EOB-YN
  7701     ELSE
  7702        MOVE 'N'                 TO WS-PRINT-EOB-YN
  7703     END-IF
  7704
  7705* EXEC CICS HANDLE CONDITION
  7706*        NOTOPEN   (9990-ABEND)
  7707*        PGMIDERR  (8600-PGRM-NOT-FOUND)
  7708*        MAPFAIL   (0400-FIRST-TIME)
  7709*        DUPREC    (6180-DUPREC)
  7710*        ERROR     (9990-ABEND)
  7711*    END-EXEC.
  7712*    MOVE '"$JL?%.               ! " #00007700' TO DFHEIV0
  7713     MOVE X'22244A4C3F252E2020202020' TO DFHEIV0(1:12)
  7714     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7715     MOVE X'2220233030303037373030' TO DFHEIV0(25:11)
  7716     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 149
* EL156.cbl
  7717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7718
  7719
  7720     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  7721         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  7722
  7723     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  7724         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  7725             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  7726             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  7727             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  7728             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  7729             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  7730             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  7731             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  7732             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  7733             MOVE LOW-VALUES           TO EL156AI
  7734             MOVE 'Y'                  TO FIRST-ENTRY
  7735         ELSE
  7736             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  7737             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  7738             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  7739             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  7740             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  7741             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  7742             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  7743             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  7744
  7745     IF RETURNED-FROM NOT = SPACES
  7746        IF (RETURNED-FROM = 'EL614')
  7747           MOVE PI-PROGRAM-WORK-AREA (1:60) TO WS-SAVED-EOB-CODES
  7748           IF WS-SAVED-EOB-CODES NOT = SPACES
  7749              MOVE 'Y'                TO WS-SET-NOTE2-MDT
  7750           ELSE
  7751              MOVE 'N'                TO WS-SET-NOTE2-MDT
  7752           END-IF
  7753        END-IF
  7754         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  7755            MOVE 'Y'             TO FIRST-ENTRY
  7756            IF RETURNED-FROM = 'EL614'
  7757               AND (PI-PASS-SW NOT = 'C')
  7758               IF WS-SAVED-EOB-CODES NOT = SPACES
  7759                  MOVE WS-SAVED-EOB-CODES
  7760                                 TO PI-PMTNOTE2
  7761                                    WS-PMTNOTE2
  7762                  MOVE 'Y'       TO PI-EOB-CODES-EXIST
  7763               ELSE
  7764                  MOVE SPACES    TO PI-PMTNOTE2
  7765                                    WS-PMTNOTE2
  7766                                    PI-EOB-CODES-EXIST
  7767               END-IF
  7768            END-IF
  7769            PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
  7770            PERFORM 7010-BUILD-MAP THRU 7023-BYPASS-REMAINING-TERM
  7771            IF RETURNED-FROM = 'EL614'
  7772               GO TO 1000-EDIT-DATA
  7773            END-IF
  7774            IF (PMTTYPEI = LOW-VALUES OR SPACES) AND
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 150
* EL156.cbl
  7775               (PAYEEI   = LOW-VALUES OR SPACES)
  7776               GO TO 8100-SEND-INITIAL-MAP
  7777            ELSE
  7778               GO TO 1000-EDIT-DATA.
  7779
  7780     IF EIBTRNID NOT = TRANS-ID
  7781         GO TO 0400-FIRST-TIME.
  7782
  7783     IF EIBAID = DFHCLEAR
  7784        IF PI-PASS-SW = 'C'
  7785           PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  7786           PERFORM 3050-REBUILD-ENTERED      THRU 3059-EXIT
  7787           PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
  7788           MOVE 'Y'            TO RETURNED-FROM-B
  7789           GO TO 1000-EDIT-DATA
  7790        ELSE
  7791           GO TO 9400-CLEAR.
  7792
  7793     IF PI-PASS-SW = 'C'
  7794         MOVE MAP-NAMEB          TO MAP-NAME
  7795         IF EIBAID = DFHPF1 OR DFHPF13
  7796             GO TO 5000-UPDATE
  7797           ELSE
  7798             IF EIBAID NOT = DFHENTER
  7799                 MOVE LOW-VALUES TO EL156BI
  7800                 MOVE MAP-NAMEB  TO MAP-NAME
  7801                 MOVE ER-0029    TO EMI-ERROR
  7802                 MOVE -1         TO  ENTPFBL
  7803                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7804                 GO TO 8200-SEND-DATAONLY.
  7805
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 151
* EL156.cbl
  7807 0200-RECEIVE.
  7808     MOVE LOW-VALUES             TO EL156AI.
  7809     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7810         MOVE ER-0008            TO EMI-ERROR
  7811         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7812         IF PI-PASS-SW = 'C'
  7813             MOVE -1             TO ENTPFBL
  7814             GO TO 8200-SEND-DATAONLY
  7815         ELSE
  7816             MOVE -1             TO PMTTYPEL
  7817             GO TO 8200-SEND-DATAONLY.
  7818
  7819     IF PI-COMPANY-ID = 'DMD'
  7820         PERFORM 7700-GET-DCT THRU 7700-EXIT.
  7821
  7822     IF PI-PASS-SW = 'C'
  7823         MOVE MAP-NAMEB          TO MAP-NAME.
  7824
  7825
  7826* EXEC CICS RECEIVE
  7827*        MAP   (MAP-NAME)
  7828*        MAPSET(MAPSET-NAME)
  7829*        ASIS
  7830*        INTO  (EL156AI)
  7831*    END-EXEC.
  7832     MOVE LENGTH OF
  7833      EL156AI
  7834       TO DFHEIV11
  7835*    MOVE '8"TAI  L              ''   #00007813' TO DFHEIV0
  7836     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  7837     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7838     MOVE X'2020233030303037383133' TO DFHEIV0(25:11)
  7839     CALL 'kxdfhei1' USING DFHEIV0,
  7840           MAP-NAME,
  7841           EL156AI,
  7842           DFHEIV11,
  7843           MAPSET-NAME,
  7844           DFHEIV99,
  7845           DFHEIV99
  7846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7847
  7848
  7849     IF PI-PASS-SW NOT = 'C'
  7850         GO TO 0250-MAPA.
  7851
  7852     IF ENTPFBL NOT > ZERO
  7853         MOVE MAP-NAMEB          TO MAP-NAME
  7854         MOVE ER-0029            TO EMI-ERROR
  7855         MOVE -1                 TO  ENTPFBL
  7856         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7857         GO TO 8200-SEND-DATAONLY.
  7858
  7859     IF (ENTPFBI NUMERIC) AND (ENTPFBI > 0 AND < 25)
  7860         MOVE PF-VALUES (ENTPFBI) TO EIBAID
  7861       ELSE
  7862         MOVE MAP-NAMEB           TO MAP-NAME
  7863         MOVE ER-0029             TO EMI-ERROR
  7864         MOVE -1                  TO ENTPFBL
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 152
* EL156.cbl
  7865         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7866         GO TO 8200-SEND-DATAONLY.
  7867
  7868     IF EIBAID = DFHPF1 OR DFHPF13
  7869         IF MODIFY-CAP
  7870            GO TO 5000-UPDATE
  7871          ELSE
  7872            MOVE 'UPDATE'           TO SM-READ
  7873            PERFORM 9995-SECURITY-VIOLATION
  7874            MOVE MAP-NAMEB          TO MAP-NAME
  7875            MOVE ER-0070            TO EMI-ERROR
  7876            MOVE -1                 TO  ENTPFBL
  7877            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7878            GO TO 8200-SEND-DATAONLY.
  7879
  7880 0250-MAPA.
  7881     IF ENTERPFL = 0
  7882         GO TO 0300-CHECK-PFKEYS.
  7883
  7884     IF EIBAID NOT = DFHENTER
  7885         MOVE ER-0004            TO EMI-ERROR
  7886         GO TO 0320-INPUT-ERROR.
  7887
  7888     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  7889         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  7890     ELSE
  7891         MOVE ER-0029            TO EMI-ERROR
  7892         GO TO 0320-INPUT-ERROR.
  7893
  7894 0300-CHECK-PFKEYS.
  7895     IF EIBAID = DFHPF7 OR DFHPF8
  7896         GO TO 8820-PF7-8.
  7897
  7898     IF EIBAID = DFHPF23
  7899         GO TO 8810-PF23.
  7900
  7901     IF EIBAID = DFHPF24
  7902         GO TO 9200-RETURN-MAIN-MENU.
  7903
  7904     IF EIBAID = DFHPF12
  7905         GO TO 9500-PF12.
  7906
  7907     IF EIBAID = DFHPF1
  7908        IF PI-PASS-SW = 'A' OR 'B'
  7909          GO TO 0330-BROWSE-FORWARD.
  7910
  7911     IF EIBAID = DFHPF2
  7912        IF PI-PASS-SW = 'A' OR 'B'
  7913          GO TO 0350-BROWSE-BACKWARD.
  7914
  7915     IF EIBAID = DFHPF6
  7916        IF PI-EOB-CODES-EXIST = 'Y'
  7917           MOVE PI-PMTNOTE2         TO WS-PMTNOTE2
  7918        ELSE
  7919           MOVE SPACES              TO WS-PMTNOTE2
  7920        END-IF
  7921         PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT
  7922         IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 153
* EL156.cbl
  7923            MOVE WS-SAVE-INPUT   TO PI-SAVE-INPUT
  7924         END-IF
  7925         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7926         IF PI-COMPANY-ID = 'CID' OR 'DCC'
  7927             MOVE 'EL614'        TO PGM-NAME
  7928             MOVE WS-PMTNOTE2    TO PI-PROGRAM-WORK-AREA
  7929             GO TO 9300-XCTL
  7930         ELSE
  7931             MOVE XCTL-157       TO PGM-NAME
  7932             GO TO 9300-XCTL.
  7933
  7934     IF EIBAID = DFHPF9
  7935        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  7936        MOVE XCTL-141            TO PGM-NAME
  7937        GO TO 9300-XCTL.
  7938
  7939     IF EIBAID = DFHPF10
  7940        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  7941        MOVE XCTL-155            TO PGM-NAME
  7942        GO TO 9300-XCTL.
  7943
  7944     MOVE SPACES                 TO ERRMSG0O
  7945                                    ERRMSG1O
  7946                                    ERRMSG2O.
  7947
  7948     IF EIBAID = DFHPF3 OR DFHPF4 OR DFHPF5
  7949         IF PI-PASS-SW NOT = 'B'
  7950             MOVE ER-0422        TO EMI-ERROR
  7951             GO TO 0320-INPUT-ERROR
  7952           ELSE
  7953             GO TO 0700-TEST-FOR-CHANGES.
  7954
  7955     IF EIBAID = DFHPF11
  7956        IF PI-PASS-SW = 'C'
  7957           MOVE ER-0029          TO EMI-ERROR
  7958           GO TO 0320-INPUT-ERROR.
  7959
  7960     IF EIBAID = DFHENTER OR DFHPF11
  7961        NEXT SENTENCE
  7962     ELSE
  7963        MOVE ER-0029             TO EMI-ERROR
  7964        GO TO 0320-INPUT-ERROR.
  7965
  7966     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  7967
  7968     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  7969         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  7970         GO TO 1000-EDIT-DATA
  7971     ELSE
  7972         IF PI-FATAL-COUNT NOT = 0 OR
  7973            PI-FORCE-COUNT NOT = 0
  7974             GO TO 1000-EDIT-DATA
  7975         ELSE
  7976             GO TO 2000-EDIT-DONE.
  7977
  7978 0320-INPUT-ERROR.
  7979     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7980
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 154
* EL156.cbl
  7981     IF ENTERPFL = 0
  7982         MOVE -1                 TO PMTTYPEL
  7983     ELSE
  7984         MOVE AL-UNBON           TO ENTERPFA
  7985         MOVE -1                 TO ENTERPFL.
  7986
  7987     GO TO 8200-SEND-DATAONLY.
  7988
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 155
* EL156.cbl
  7990 0330-BROWSE-FORWARD.
  7991
  7992     MOVE CLMNOI            TO PI-CLAIM-NO.
  7993     MOVE CARRI             TO PI-CARRIER.
  7994     MOVE CERTNOI           TO PI-CERT-PRIME.
  7995     MOVE SUFXI             TO PI-CERT-SFX.
  7996
  7997     MOVE PI-CARRIER        TO MSTR-CARRIER.
  7998     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  7999     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8000     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8001
  8002     MOVE ELMSTR-KEY        TO WS-HOLD-ELMSTR-KEY.
  8003
  8004
  8005* EXEC CICS HANDLE CONDITION
  8006*         NOTFND   (0380-CLAIM-END-FILE)
  8007*         ENDFILE  (0380-CLAIM-END-FILE)
  8008*    END-EXEC.
  8009*    MOVE '"$I''                  ! # #00007975' TO DFHEIV0
  8010     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8011     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8012     MOVE X'2320233030303037393735' TO DFHEIV0(25:11)
  8013     CALL 'kxdfhei1' USING DFHEIV0
  8014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8015
  8016
  8017
  8018* EXEC CICS STARTBR
  8019*         DATASET    ('ELMSTR')
  8020*         RIDFLD     (ELMSTR-KEY)
  8021*         GTEQ
  8022*    END-EXEC.
  8023     MOVE 'ELMSTR' TO DFHEIV1
  8024     MOVE 0
  8025       TO DFHEIV11
  8026*    MOVE '&,         G          &   #00007980' TO DFHEIV0
  8027     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8028     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8029     MOVE X'2020233030303037393830' TO DFHEIV0(25:11)
  8030     CALL 'kxdfhei1' USING DFHEIV0,
  8031           DFHEIV1,
  8032           ELMSTR-KEY,
  8033           DFHEIV99,
  8034           DFHEIV11,
  8035           DFHEIV99
  8036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8037
  8038
  8039     MOVE 'Y' TO WS-BROWSE-START-SW.
  8040
  8041 0335-READNEXT.
  8042
  8043
  8044* EXEC CICS READNEXT
  8045*         DATASET    ('ELMSTR')
  8046*         RIDFLD     (ELMSTR-KEY)
  8047*         SET        (ADDRESS OF CLAIM-MASTER)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 156
* EL156.cbl
  8048*    END-EXEC.
  8049     MOVE 'ELMSTR' TO DFHEIV1
  8050     MOVE 0
  8051       TO DFHEIV11
  8052*    MOVE '&.S                   )   #00007990' TO DFHEIV0
  8053     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8054     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8055     MOVE X'2020233030303037393930' TO DFHEIV0(25:11)
  8056     CALL 'kxdfhei1' USING DFHEIV0,
  8057           DFHEIV1,
  8058           DFHEIV20,
  8059           DFHEIV99,
  8060           ELMSTR-KEY,
  8061           DFHEIV99,
  8062           DFHEIV11,
  8063           DFHEIV99,
  8064           DFHEIV99
  8065     SET ADDRESS OF CLAIM-MASTER TO
  8066         DFHEIV20
  8067     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8068
  8069
  8070     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8071        GO TO 0380-CLAIM-END-FILE.
  8072
  8073     IF ELMSTR-KEY = WS-HOLD-ELMSTR-KEY
  8074        MOVE CL-CLAIM-NO         TO  PI-PREV-CLMNO
  8075        GO TO 0335-READNEXT.
  8076
  8077     IF PI-COMPANY-ID = 'CRI'
  8078         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8079            GO TO 0380-CLAIM-END-FILE.
  8080
  8081     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8082         GO TO 0335-READNEXT.
  8083
  8084     IF PI-CARRIER-SECURITY > SPACES
  8085         IF CL-CARRIER = PI-CARRIER-SECURITY
  8086             NEXT SENTENCE
  8087         ELSE
  8088             GO TO 0335-READNEXT.
  8089
  8090     IF PI-ACCOUNT-SECURITY > SPACES
  8091         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8092             NEXT SENTENCE
  8093         ELSE
  8094             GO TO 0335-READNEXT.
  8095
  8096     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8097     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8098     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8099
  8100     GO TO 0400-FIRST-TIME.
  8101
  8102 0350-BROWSE-BACKWARD.
  8103
  8104     MOVE CLMNOI            TO PI-CLAIM-NO
  8105                               PI-PREV-CLMNO.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 157
* EL156.cbl
  8106     MOVE CARRI             TO PI-CARRIER.
  8107     MOVE CERTNOI           TO PI-CERT-PRIME.
  8108     MOVE SUFXI             TO PI-CERT-SFX.
  8109
  8110     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8111
  8112     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8113     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8114     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8115
  8116
  8117* EXEC CICS HANDLE CONDITION
  8118*         NOTFND   (0380-CLAIM-END-FILE)
  8119*         ENDFILE  (0380-CLAIM-END-FILE)
  8120*    END-EXEC.
  8121*    MOVE '"$I''                  ! $ #00008042' TO DFHEIV0
  8122     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8123     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8124     MOVE X'2420233030303038303432' TO DFHEIV0(25:11)
  8125     CALL 'kxdfhei1' USING DFHEIV0
  8126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8127
  8128
  8129
  8130* EXEC CICS STARTBR
  8131*         DATASET    ('ELMSTR')
  8132*         RIDFLD     (ELMSTR-KEY)
  8133*         GTEQ
  8134*    END-EXEC.
  8135     MOVE 'ELMSTR' TO DFHEIV1
  8136     MOVE 0
  8137       TO DFHEIV11
  8138*    MOVE '&,         G          &   #00008047' TO DFHEIV0
  8139     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8140     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8141     MOVE X'2020233030303038303437' TO DFHEIV0(25:11)
  8142     CALL 'kxdfhei1' USING DFHEIV0,
  8143           DFHEIV1,
  8144           ELMSTR-KEY,
  8145           DFHEIV99,
  8146           DFHEIV11,
  8147           DFHEIV99
  8148     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8149
  8150
  8151     MOVE 'Y' TO WS-BROWSE-START-SW.
  8152
  8153
  8154* EXEC CICS READNEXT
  8155*         DATASET    ('ELMSTR')
  8156*         RIDFLD     (ELMSTR-KEY)
  8157*         SET        (ADDRESS OF CLAIM-MASTER)
  8158*    END-EXEC.
  8159     MOVE 'ELMSTR' TO DFHEIV1
  8160     MOVE 0
  8161       TO DFHEIV11
  8162*    MOVE '&.S                   )   #00008055' TO DFHEIV0
  8163     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 158
* EL156.cbl
  8164     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8165     MOVE X'2020233030303038303535' TO DFHEIV0(25:11)
  8166     CALL 'kxdfhei1' USING DFHEIV0,
  8167           DFHEIV1,
  8168           DFHEIV20,
  8169           DFHEIV99,
  8170           ELMSTR-KEY,
  8171           DFHEIV99,
  8172           DFHEIV11,
  8173           DFHEIV99,
  8174           DFHEIV99
  8175     SET ADDRESS OF CLAIM-MASTER TO
  8176         DFHEIV20
  8177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8178
  8179
  8180
  8181* EXEC CICS READPREV
  8182*         DATASET    ('ELMSTR')
  8183*         RIDFLD     (ELMSTR-KEY)
  8184*         SET        (ADDRESS OF CLAIM-MASTER)
  8185*    END-EXEC.
  8186     MOVE 'ELMSTR' TO DFHEIV1
  8187     MOVE 0
  8188       TO DFHEIV11
  8189*    MOVE '&0S                   )   #00008061' TO DFHEIV0
  8190     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8191     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8192     MOVE X'2020233030303038303631' TO DFHEIV0(25:11)
  8193     CALL 'kxdfhei1' USING DFHEIV0,
  8194           DFHEIV1,
  8195           DFHEIV20,
  8196           DFHEIV99,
  8197           ELMSTR-KEY,
  8198           DFHEIV99,
  8199           DFHEIV11,
  8200           DFHEIV99,
  8201           DFHEIV99
  8202     SET ADDRESS OF CLAIM-MASTER TO
  8203         DFHEIV20
  8204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8205
  8206
  8207 0360-BROWSE-BACKWARD.
  8208
  8209
  8210* EXEC CICS READPREV
  8211*         DATASET    ('ELMSTR')
  8212*         RIDFLD     (ELMSTR-KEY)
  8213*         SET        (ADDRESS OF CLAIM-MASTER)
  8214*    END-EXEC.
  8215     MOVE 'ELMSTR' TO DFHEIV1
  8216     MOVE 0
  8217       TO DFHEIV11
  8218*    MOVE '&0S                   )   #00008069' TO DFHEIV0
  8219     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8220     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8221     MOVE X'2020233030303038303639' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 159
* EL156.cbl
  8222     CALL 'kxdfhei1' USING DFHEIV0,
  8223           DFHEIV1,
  8224           DFHEIV20,
  8225           DFHEIV99,
  8226           ELMSTR-KEY,
  8227           DFHEIV99,
  8228           DFHEIV11,
  8229           DFHEIV99,
  8230           DFHEIV99
  8231     SET ADDRESS OF CLAIM-MASTER TO
  8232         DFHEIV20
  8233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8234
  8235
  8236     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8237        GO TO 0380-CLAIM-END-FILE.
  8238
  8239     IF PI-COMPANY-ID = 'CRI'
  8240         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8241            GO TO 0380-CLAIM-END-FILE.
  8242
  8243     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8244         GO TO 0360-BROWSE-BACKWARD.
  8245
  8246     IF PI-CARRIER-SECURITY > SPACES
  8247         IF CL-CARRIER = PI-CARRIER-SECURITY
  8248             NEXT SENTENCE
  8249         ELSE
  8250             GO TO 0360-BROWSE-BACKWARD.
  8251
  8252     IF PI-ACCOUNT-SECURITY > SPACES
  8253         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8254             NEXT SENTENCE
  8255         ELSE
  8256             GO TO 0360-BROWSE-BACKWARD.
  8257
  8258     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8259     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8260     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8261
  8262     GO TO 0400-FIRST-TIME.
  8263
  8264 0380-CLAIM-END-FILE.
  8265
  8266     MOVE ER-0130     TO EMI-ERROR.
  8267     MOVE -1          TO CLMNOL.
  8268     MOVE AL-UABON    TO CARRA
  8269                         CLMNOA
  8270                         CERTNOA
  8271                         SUFXA.
  8272
  8273     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8274
  8275     GO TO 8200-SEND-DATAONLY.
  8276
  8277 0400-FIRST-TIME.
  8278
  8279     IF WS-BROWSE-START-SW = 'Y'
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 160
* EL156.cbl
  8280        MOVE 'N'         TO WS-BROWSE-START-SW
  8281
  8282* EXEC CICS ENDBR
  8283*            DATASET    ('ELMSTR')
  8284*       END-EXEC.
  8285     MOVE 'ELMSTR' TO DFHEIV1
  8286     MOVE 0
  8287       TO DFHEIV11
  8288*    MOVE '&2                    $   #00008120' TO DFHEIV0
  8289     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8290     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8291     MOVE X'2020233030303038313230' TO DFHEIV0(25:11)
  8292     CALL 'kxdfhei1' USING DFHEIV0,
  8293           DFHEIV1,
  8294           DFHEIV11,
  8295           DFHEIV99
  8296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8297
  8298
  8299     IF PI-PROCESSOR-ID = 'LGXX'
  8300         NEXT SENTENCE
  8301     ELSE
  8302
  8303* EXEC CICS READQ TS
  8304*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  8305*            INTO    (SECURITY-CONTROL)
  8306*            LENGTH  (SC-COMM-LENGTH)
  8307*            ITEM    (SC-ITEM)
  8308*        END-EXEC
  8309*    MOVE '*$II   L              ''   #00008127' TO DFHEIV0
  8310     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8311     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8312     MOVE X'2020233030303038313237' TO DFHEIV0(25:11)
  8313     CALL 'kxdfhei1' USING DFHEIV0,
  8314           PI-SECURITY-TEMP-STORE-ID,
  8315           SECURITY-CONTROL,
  8316           SC-COMM-LENGTH,
  8317           SC-ITEM,
  8318           DFHEIV99,
  8319           DFHEIV99
  8320     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8321         MOVE SC-CLAIMS-DISPLAY (10)  TO  PI-DISPLAY-CAP
  8322         MOVE SC-CLAIMS-UPDATE  (10)  TO  PI-MODIFY-CAP.
  8323
  8324     MOVE LOW-VALUES             TO EL156AI.
  8325     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8326     MOVE 'Y'                    TO FIRST-ENTRY.
  8327     GO TO 7000-SHOW-CLAIM.
  8328
  8329 0500-CREATE-TEMP-STORAGE.
  8330     MOVE EIBCPOSN               TO PI-SAVE-CURSOR.
  8331
  8332
  8333* EXEC CICS WRITEQ TS
  8334*        QUEUE (QID)
  8335*        FROM  (PROGRAM-INTERFACE-BLOCK)
  8336*        LENGTH(PI-COMM-LENGTH)
  8337*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 161
* EL156.cbl
  8338*    MOVE '*"                    ''   #00008144' TO DFHEIV0
  8339     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8340     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8341     MOVE X'2020233030303038313434' TO DFHEIV0(25:11)
  8342     CALL 'kxdfhei1' USING DFHEIV0,
  8343           QID,
  8344           PROGRAM-INTERFACE-BLOCK,
  8345           PI-COMM-LENGTH,
  8346           DFHEIV99,
  8347           DFHEIV99,
  8348           DFHEIV99
  8349     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8350
  8351
  8352
  8353* EXEC CICS WRITEQ TS
  8354*        QUEUE (QID)
  8355*        FROM  (EL156AI)
  8356*        LENGTH(MAP-LENGTH)
  8357*    END-EXEC.
  8358*    MOVE '*"                    ''   #00008150' TO DFHEIV0
  8359     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8360     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8361     MOVE X'2020233030303038313530' TO DFHEIV0(25:11)
  8362     CALL 'kxdfhei1' USING DFHEIV0,
  8363           QID,
  8364           EL156AI,
  8365           MAP-LENGTH,
  8366           DFHEIV99,
  8367           DFHEIV99,
  8368           DFHEIV99
  8369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8370
  8371
  8372 0599-EXIT.
  8373      EXIT.
  8374
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 162
* EL156.cbl
  8376 0600-RECOVER-TEMP-STORAGE.
  8377
  8378* EXEC CICS READQ TS
  8379*        QUEUE (QID)
  8380*        INTO  (PROGRAM-INTERFACE-BLOCK)
  8381*        LENGTH(PI-COMM-LENGTH)
  8382*    END-EXEC.
  8383*    MOVE '*$I    L              ''   #00008161' TO DFHEIV0
  8384     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8385     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8386     MOVE X'2020233030303038313631' TO DFHEIV0(25:11)
  8387     CALL 'kxdfhei1' USING DFHEIV0,
  8388           QID,
  8389           PROGRAM-INTERFACE-BLOCK,
  8390           PI-COMM-LENGTH,
  8391           DFHEIV99,
  8392           DFHEIV99,
  8393           DFHEIV99
  8394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8395
  8396
  8397
  8398* EXEC CICS READQ TS
  8399*        QUEUE (QID)
  8400*        INTO  (EL156AI)
  8401*        LENGTH(MAP-LENGTH)
  8402*    END-EXEC.
  8403*    MOVE '*$I    L              ''   #00008167' TO DFHEIV0
  8404     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8405     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8406     MOVE X'2020233030303038313637' TO DFHEIV0(25:11)
  8407     CALL 'kxdfhei1' USING DFHEIV0,
  8408           QID,
  8409           EL156AI,
  8410           MAP-LENGTH,
  8411           DFHEIV99,
  8412           DFHEIV99,
  8413           DFHEIV99
  8414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8415
  8416
  8417     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8418
  8419     IF PMTTYPEI NOT = LOW-VALUES
  8420         MOVE AL-UANON           TO PMTTYPEA.
  8421
  8422     IF PAYEEI NOT = LOW-VALUES
  8423         MOVE AL-UANON           TO PAYEEA.
  8424
  8425     IF NOTE1I NOT = LOW-VALUES
  8426         MOVE AL-UANON           TO NOTE1A.
  8427
  8428     IF (RETURNED-FROM = 'EL614')
  8429        MOVE WS-SET-NOTE2-MDT    TO PI-SET-NOTE2-MDT
  8430     END-IF
  8431*    IF (NOTE2I NOT = LOW-VALUES AND SPACES)
  8432*       AND (PI-EOB-CODES-EXIST = 'Y')
  8433*       AND (PI-SET-NOTE2-MDT = 'Y')
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 163
* EL156.cbl
  8434*       MOVE ' '                 TO PI-SET-NOTE2-MDT
  8435     IF PI-SET-NOTE2-MDT = 'Y'
  8436         MOVE AL-SANON           TO NOTE2A
  8437     END-IF
  8438
  8439     IF OFFLINEI NOT = LOW-VALUES
  8440         MOVE AL-UANON           TO OFFLINEA.
  8441
  8442     IF GROUPEDI NOT = LOW-VALUES
  8443         MOVE AL-UANON           TO GROUPEDA.
  8444
  8445     IF CASHI NOT = LOW-VALUES
  8446         MOVE AL-UANON           TO CASHA.
  8447
  8448     IF CHECKNOI NOT = LOW-VALUES
  8449         MOVE AL-UANON           TO CHECKNOA.
  8450
  8451     IF HOLDTILI NOT = LOW-VALUES
  8452         MOVE AL-UANON           TO HOLDTILA.
  8453
  8454     IF EPYFROMI NOT = LOW-VALUES
  8455         MOVE AL-UANON           TO EPYFROMA.
  8456
  8457     IF AIGFROMI NOT = LOW-VALUES
  8458         MOVE AL-UANON           TO AIGFROMA.
  8459
  8460     IF EPYTHRUI NOT = LOW-VALUES
  8461         MOVE AL-UANON           TO EPYTHRUA.
  8462
  8463     IF EDAYSI NOT = LOW-VALUES
  8464         MOVE AL-UNNON           TO EDAYSA.
  8465
  8466     IF EPYAMTL NOT = +0
  8467         MOVE AL-UNNON           TO EPYAMTA.
  8468
  8469     IF ERESVL NOT = +0
  8470         MOVE AL-UNNON           TO ERESVA.
  8471
  8472     IF EEXPENSL NOT = +0
  8473         MOVE AL-UNNON           TO EEXPENSA.
  8474
  8475     IF ETYPEI NOT = LOW-VALUES
  8476         MOVE AL-UNNON           TO ETYPEA.
  8477
  8478     IF PROOFDTI NOT = 0
  8479         MOVE AL-UNNON           TO PROOFDTA.
  8480
  8481     IF EOBYNI = 'Y' OR 'N'
  8482        MOVE AL-UANON            TO EOBYNA
  8483     END-IF
  8484     .
  8485 0699-EXIT.
  8486      EXIT.
  8487
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 164
* EL156.cbl
  8489 0700-TEST-FOR-CHANGES.
  8490     IF (EIBAID = DFHPF4) AND (NOT FORCE-CAP)
  8491         MOVE ER-0433            TO EMI-ERROR
  8492         GO TO 0750-FUNCTION-ERROR.
  8493
  8494     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8495
  8496     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  8497         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8498         MOVE 'A'                TO PI-PASS-SW
  8499         GO TO 1000-EDIT-DATA.
  8500
  8501     IF PI-FATAL-COUNT NOT = 0
  8502         MOVE ER-0499            TO EMI-ERROR
  8503         GO TO 0750-FUNCTION-ERROR.
  8504
  8505     IF (PI-FORCE-COUNT NOT = 0) AND (EIBAID NOT = DFHPF4)
  8506         MOVE ER-0500            TO EMI-ERROR
  8507         GO TO 0750-FUNCTION-ERROR.
  8508
  8509     IF (EIBAID  = DFHPF5 AND PI-CPYAMT = ZEROS) OR
  8510        ((EIBAID = DFHPF3 OR DFHPF4) AND PI-EPYAMT = ZEROS)
  8511           MOVE ER-0542          TO EMI-ERROR
  8512           MOVE -1               TO EPYAMTL
  8513           GO TO 0750-FUNCTION-ERROR.
  8514
  8515     IF PI-OFFLINE = 'Y'  OR
  8516        (PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE)
  8517        MOVE EIBAID              TO PI-PFKEY-USED
  8518        GO TO 5000-UPDATE.
  8519
  8520     GO TO 6000-BUILD-SCREEN-B.
  8521
  8522 0750-FUNCTION-ERROR.
  8523     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8524
  8525     IF ENTERPFL > 0
  8526         MOVE -1                 TO ENTERPFL
  8527         MOVE AL-UNBON           TO ENTERPFA
  8528         GO TO 8200-SEND-DATAONLY
  8529     ELSE
  8530         MOVE -1                 TO ENTERPFL
  8531         MOVE AL-UNNOF           TO ENTERPFA
  8532         GO TO 8200-SEND-DATAONLY.
  8533
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 165
* EL156.cbl
  8535 0800-DELETE-TS.
  8536
  8537* EXEC CICS HANDLE CONDITION
  8538*        QIDERR(0800-EXIT)
  8539*    END-EXEC.
  8540*    MOVE '"$N                   ! % #00008292' TO DFHEIV0
  8541     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  8542     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8543     MOVE X'2520233030303038323932' TO DFHEIV0(25:11)
  8544     CALL 'kxdfhei1' USING DFHEIV0
  8545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8546
  8547
  8548
  8549* EXEC CICS DELETEQ TS
  8550*        QUEUE(QID)
  8551*    END-EXEC.
  8552*    MOVE '*&                    #   #00008296' TO DFHEIV0
  8553     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  8554     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8555     MOVE X'2020233030303038323936' TO DFHEIV0(25:11)
  8556     CALL 'kxdfhei1' USING DFHEIV0,
  8557           QID,
  8558           DFHEIV99
  8559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8560
  8561
  8562 0800-EXIT.
  8563      EXIT.
  8564
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 166
* EL156.cbl
  8566 1000-EDIT-DATA.
  8567
  8568     MOVE 0 TO PI-FATAL-COUNT  PI-FORCE-COUNT  PI-BEN-DAYS
  8569         PI-CDAYS  PI-CPYAMT  PI-CRESV  PI-CEXPENS PI-MANUAL-SW
  8570         PI-INT-AMT PI-INT-DAYS PI-INT-RATE-USED
  8571
  8572     MOVE LOW-VALUES TO PI-CPYFROM  PI-CPYTHRU.
  8573
  8574     IF NOT MODIFY-CAP
  8575         MOVE ER-0070            TO EMI-ERROR
  8576         MOVE -1                 TO PMTTYPEL
  8577         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8578         GO TO 2000-EDIT-DONE.
  8579
  8580     IF PI-PMTTYPE NOT = '1' AND '2' AND '3' AND '4' AND
  8581                         '5' AND '6'
  8582         MOVE ER-0420            TO EMI-ERROR
  8583         MOVE -1                 TO PMTTYPEL
  8584         MOVE AL-UABON           TO PMTTYPEA
  8585         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8586     ELSE
  8587         MOVE AL-UANON           TO PMTTYPEA.
  8588
  8589     IF PI-OFFLINE = 'Y'
  8590        IF PI-GROUPED = 'Y'
  8591           MOVE ER-1880         TO EMI-ERROR
  8592           MOVE -1              TO GROUPEDL
  8593           MOVE AL-UABON        TO GROUPEDA
  8594           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8595
  8596     IF GROUPEDL > +0
  8597        IF PI-GROUPED = 'Y' OR 'N'
  8598           MOVE AL-UANON TO GROUPEDA
  8599        ELSE
  8600           MOVE ER-3140            TO EMI-ERROR
  8601           MOVE -1                 TO GROUPEDL
  8602           MOVE AL-UABON           TO GROUPEDA
  8603           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8604
  8605     IF CASHL > +0
  8606        IF PI-CASH = 'Y' OR 'N'
  8607           MOVE AL-UANON           TO CASHA
  8608        ELSE
  8609           MOVE ER-3141            TO EMI-ERROR
  8610           MOVE -1                 TO CASHL
  8611           MOVE AL-UABON           TO CASHA
  8612           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8613
  8614     IF LOANNOL > +0
  8615         MOVE 'Y'                TO  PI-LOAN-UPDATE-SW.
  8616
  8617 1000-EDIT-PAYEE.
  8618
  8619     IF PI-PAYEE-SEQ NOT NUMERIC
  8620         MOVE ER-0294            TO  EMI-ERROR
  8621         MOVE -1                 TO  PAYEEL
  8622         MOVE AL-UABON           TO  PAYEEA
  8623         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 167
* EL156.cbl
  8624         GO TO 1000-CONT-EDIT.
  8625
  8626     IF PI-PAYEE-TYPE =  'I' OR 'B' OR 'A' OR 'P' OR
  8627                         'E' OR 'O' OR 'Q'
  8628         NEXT SENTENCE
  8629     ELSE
  8630         MOVE ER-0294            TO  EMI-ERROR
  8631         MOVE -1                 TO  PAYEEL
  8632         MOVE AL-UABON           TO  PAYEEA
  8633         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8634         GO TO 1000-CONT-EDIT.
  8635
  8636     IF ((PI-PAYEE-TYPE = 'I' OR 'E' OR 'O' OR 'P' OR 'Q')  AND
  8637        (PI-PAYEE-SEQ NOT < '1' AND
  8638         PI-PAYEE-SEQ NOT > '9'))
  8639      OR
  8640        ((PI-PAYEE-TYPE = 'A' OR 'B')  AND
  8641         (PI-PAYEE-SEQ NOT > '9'))
  8642         MOVE AL-UANON            TO PAYEEA
  8643     ELSE
  8644         MOVE ER-0294            TO EMI-ERROR
  8645         MOVE -1                 TO PAYEEL
  8646         MOVE AL-UABON           TO PAYEEA
  8647         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8648
  8649     IF PI-COMPANY-ID = 'DMD'
  8650         IF PI-PAYEE-TYPE = 'B' AND
  8651            PI-PAYEE-SEQ NOT = '0'
  8652               MOVE ER-7841            TO EMI-ERROR
  8653               MOVE -1                 TO PAYEEL
  8654               MOVE AL-UABON           TO PAYEEA
  8655               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8656
  8657     IF PI-COMPANY-ID = 'JHL'
  8658         IF PI-PAYEE = 'B0'
  8659             NEXT SENTENCE
  8660           ELSE
  8661
  8662* EXEC CICS HANDLE CONDITION
  8663*            ENDFILE(1950-NOT-FOUND)
  8664*            NOTFND (1950-NOT-FOUND)
  8665*        END-EXEC
  8666*    MOVE '"$''I                  ! & #00008399' TO DFHEIV0
  8667     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  8668     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8669     MOVE X'2620233030303038333939' TO DFHEIV0(25:11)
  8670     CALL 'kxdfhei1' USING DFHEIV0
  8671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8672         MOVE 'N'                    TO FOUND-TOL-SW
  8673         MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  8674         MOVE '2'                    TO CNTL-REC-TYPE
  8675         MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS
  8676         MOVE +0                     TO CNTL-SEQ-NO
  8677         MOVE 'PROC'                 TO FILE-SWITCH
  8678         PERFORM 7930-READ-CONTROL THRU 7930-EXIT
  8679         IF PI-PAYEE = 'I1' AND
  8680            APPROVAL-LEVEL-2
  8681             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 168
* EL156.cbl
  8682           ELSE
  8683         IF NOT PI-USER-ALMIGHTY-YES
  8684             MOVE ER-3546        TO EMI-ERROR
  8685             MOVE -1             TO PAYEEL
  8686             MOVE AL-UABON       TO PAYEEA
  8687             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8688
  8689     IF PI-PAYEE-TYPE = 'E'
  8690        IF PI-PMTTYPE = '5' OR '6'
  8691            NEXT SENTENCE
  8692        ELSE
  8693            MOVE ER-3539            TO EMI-ERROR
  8694            MOVE -1                 TO PAYEEL
  8695            MOVE AL-UABON           TO PAYEEA
  8696            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8697
  8698 1000-CONT-EDIT.
  8699
  8700     IF PI-OFFLINE NOT = 'Y' AND 'N'
  8701        IF PI-EPYAMT NOT NEGATIVE
  8702            MOVE ER-0421         TO EMI-ERROR
  8703            MOVE -1              TO OFFLINEL
  8704            MOVE AL-UABON        TO OFFLINEA
  8705            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8706        ELSE
  8707            MOVE AL-UANON        TO OFFLINEA.
  8708
  8709     IF PI-COMPANY-ID = 'CID' OR 'DCC'
  8710        IF PI-PRINT-EOB-YN = 'Y' OR 'N'
  8711           CONTINUE
  8712        ELSE
  8713           MOVE ER-1561          TO EMI-ERROR
  8714           MOVE -1               TO EOBYNL
  8715           MOVE AL-UABON         TO EOBYNA
  8716           PERFORM 9900-ERROR-FORMAT
  8717                                 THRU 9900-EXIT
  8718        END-IF
  8719     END-IF
  8720     IF PI-EPYAMT IS NEGATIVE
  8721         IF PI-OFFLINE NOT = 'Y'
  8722             MOVE ER-0836        TO  EMI-ERROR
  8723             MOVE -1             TO  OFFLINEL
  8724             MOVE AL-UABON       TO  OFFLINEA
  8725             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8726
  8727     IF PI-PROOF-DATE = ZEROS OR LOW-VALUES OR SPACES
  8728        MOVE ER-0872             TO EMI-ERROR
  8729        MOVE -1                  TO PROOFDTL
  8730        MOVE AL-UABON            TO PROOFDTA
  8731        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8732     ELSE
  8733        MOVE '4'                TO DC-OPTION-CODE
  8734        MOVE PI-PROOF-DATE      TO DC-GREG-DATE-1-MDY
  8735        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  8736        IF DATE-CONVERSION-ERROR
  8737            MOVE ER-0873        TO EMI-ERROR
  8738            MOVE -1                  TO PROOFDTL
  8739            MOVE AL-UABON            TO PROOFDTA
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 169
* EL156.cbl
  8740            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8741        ELSE
  8742            MOVE DC-BIN-DATE-1   TO WS-BIN-PROOF-DT
  8743            IF DC-BIN-DATE-1 > WS-TODAY-DATE
  8744                MOVE ER-0873    TO EMI-ERROR
  8745                MOVE -1                  TO PROOFDTL
  8746                MOVE AL-UABON            TO PROOFDTA
  8747                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8748            END-IF
  8749        END-IF
  8750     END-IF.
  8751
  8752     IF PI-COMPANY-ID = 'DMD'
  8753        IF NOTE1L NOT = ZEROS
  8754            MOVE ER-7844        TO  EMI-ERROR
  8755            MOVE -1             TO  NOTE1L
  8756            MOVE AL-UABON       TO  NOTE1A
  8757            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8758
  8759     IF PI-COMPANY-ID = 'DMD'
  8760        IF NOTE2L NOT = ZEROS
  8761          GO TO 1004-DMD-EOB-CHECKS.
  8762
  8763     IF NOTE1L NOT > +0
  8764         GO TO 1005-CHECK-ERRORS.
  8765
  8766     IF PI-COMPANY-ID NOT = 'FLI' AND 'FLU' AND 'HAN' AND 'JHL'
  8767         GO TO 1005-CHECK-ERRORS.
  8768
  8769     IF PI-COMPANY-ID = 'HAN' OR 'JHL'
  8770         GO TO 1003-HAN-PMT-NOTES.
  8771
  8772     MOVE NOTE1I                 TO WS-FLI-PMTNOTE.
  8773
  8774     IF WS-PMTOPTION NUMERIC
  8775        IF WS-PMTOPTION > '00' AND < '17'
  8776           NEXT SENTENCE
  8777        ELSE
  8778           MOVE ER-0618          TO EMI-ERROR
  8779           MOVE -1               TO NOTE1L
  8780           MOVE AL-UABON         TO NOTE1A
  8781           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8782     ELSE
  8783        GO TO 1005-CHECK-ERRORS.
  8784
  8785     IF WS-PMTOPTION = '05' AND
  8786        WS-DOCNAME = SPACES
  8787          MOVE ER-0616             TO EMI-ERROR
  8788          MOVE -1                  TO NOTE1L
  8789          MOVE AL-UABON            TO NOTE1A
  8790          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8791
  8792     IF WS-PMTOPTION = '15' OR '16'
  8793
  8794* EXEC CICS BIF DEEDIT
  8795*            FIELD (WS-AMOUNT)
  8796*            LENGTH(08)
  8797*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 170
* EL156.cbl
  8798     MOVE 08
  8799       TO DFHEIV11
  8800*    MOVE '@"L                   #   #00008524' TO DFHEIV0
  8801     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8802     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8803     MOVE X'2020233030303038353234' TO DFHEIV0(25:11)
  8804     CALL 'kxdfhei1' USING DFHEIV0,
  8805           WS-AMOUNT,
  8806           DFHEIV11
  8807     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8808        IF (WS-NUM-AMT = ZEROS) OR
  8809           (WS-AMOUNT NOT NUMERIC)
  8810           MOVE ER-0617          TO EMI-ERROR
  8811           MOVE -1               TO NOTE1L
  8812           MOVE AL-UABON         TO NOTE1A
  8813           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8814
  8815     MOVE WS-FLI-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  8816
  8817     GO TO 1005-CHECK-ERRORS.
  8818
  8819 1003-HAN-PMT-NOTES.
  8820
  8821     MOVE NOTE1I                 TO WS-HAN-PMTNOTE.
  8822
  8823     IF WS-HAN-PMT-CODE = SPACE
  8824         MOVE SPACES             TO WS-HAN-PMT-NOTE
  8825     ELSE
  8826     IF WS-HAN-PMT-CODE = 'A'
  8827         MOVE ':FINAL PAYMENT / MAXIMUM BENEFIT-PAID'
  8828                                 TO WS-HAN-PMT-NOTE
  8829     ELSE
  8830     IF WS-HAN-PMT-CODE = 'B'
  8831         MOVE ':FINAL PAYMENT / DECEASED'
  8832                                 TO WS-HAN-PMT-NOTE
  8833     ELSE
  8834     IF WS-HAN-PMT-CODE = 'C'
  8835         MOVE ':FINAL PAYMENT / NO LONGER DISABLED'
  8836                                 TO WS-HAN-PMT-NOTE
  8837     ELSE
  8838     IF WS-HAN-PMT-CODE = 'D'
  8839         MOVE ':FINAL PAYMENT / ADDL INFO NOT PROVIDED'
  8840                                 TO WS-HAN-PMT-NOTE
  8841     ELSE
  8842     IF WS-HAN-PMT-CODE = 'E'
  8843         MOVE ':FINAL PAYMENT / RETURNED TO WORK'
  8844                                 TO WS-HAN-PMT-NOTE
  8845     ELSE
  8846     IF WS-HAN-PMT-CODE = 'F'
  8847         MOVE ':FINAL PAYMENT / PAID TO MATURITY DATE'
  8848                                 TO WS-HAN-PMT-NOTE
  8849     ELSE
  8850     IF WS-HAN-PMT-CODE = 'P'
  8851         MOVE ':PARTIAL PAYMENT' TO WS-HAN-PMT-NOTE.
  8852
  8853     MOVE WS-HAN-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  8854     GO TO 1005-CHECK-ERRORS.
  8855
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 171
* EL156.cbl
  8856 1004-DMD-EOB-CHECKS.
  8857
  8858     INITIALIZE PI-AT-EOB-CODES.
  8859
  8860     IF NOTE2I (20:21) > SPACES
  8861         MOVE ER-7845          TO EMI-ERROR
  8862         MOVE -1               TO NOTE2L
  8863         MOVE AL-UABON         TO NOTE2A
  8864         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8865         GO TO 1005-CHECK-ERRORS
  8866      ELSE
  8867         MOVE NOTE2I             TO W-EOB-CODES.
  8868
  8869     MOVE +1                     TO W-EOB-NDX.
  8870
  8871 1004-CHECK-EACH-EOB.
  8872
  8873     IF W-EOB-NDX > +5
  8874             OR
  8875        W-EOB-CODE (W-EOB-NDX) = SPACES
  8876         GO TO 1004-CHECK-DUP-EOB.
  8877
  8878     IF W-EOB-FILLER (W-EOB-NDX) NOT = SPACES
  8879         MOVE ER-0956            TO EMI-ERROR
  8880         MOVE -1                 TO NOTE2L
  8881         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8882         GO TO 1005-CHECK-ERRORS.
  8883
  8884     MOVE 'CL'                   TO CD-SYSTEM-ID.
  8885     MOVE 'EO'                   TO CD-RECORD-TYPE.
  8886     MOVE W-EOB-CODE (W-EOB-NDX) TO CD-RECORD-KEY.
  8887     MOVE 'DLO023'               TO PGM-NAME.
  8888
  8889
  8890* EXEC CICS LINK
  8891*        PROGRAM    (PGM-NAME)
  8892*        COMMAREA   (CD-COMMUNICATION-AREA)
  8893*        LENGTH     (CD-RCRD-LENGTH)
  8894*    END-EXEC.
  8895*    MOVE '."C                   ''   #00008609' TO DFHEIV0
  8896     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8897     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8898     MOVE X'2020233030303038363039' TO DFHEIV0(25:11)
  8899     CALL 'kxdfhei1' USING DFHEIV0,
  8900           PGM-NAME,
  8901           CD-COMMUNICATION-AREA,
  8902           CD-RCRD-LENGTH,
  8903           DFHEIV99,
  8904           DFHEIV99,
  8905           DFHEIV99
  8906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8907
  8908
  8909     IF CD-RETURN-CODE = 'OK'
  8910         GO TO 1004-CONT.
  8911
  8912     MOVE -1                     TO NOTE2L.
  8913
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 172
* EL156.cbl
  8914     IF CD-RETURN-CODE = '01'
  8915         MOVE ER-8310            TO EMI-ERROR
  8916         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8917         GO TO 1005-CHECK-ERRORS.
  8918
  8919     IF CD-RETURN-CODE = '02'
  8920         MOVE ER-8311            TO EMI-ERROR
  8921         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8922         GO TO 1005-CHECK-ERRORS.
  8923
  8924     IF CD-RETURN-CODE = '03'
  8925         MOVE ER-8312            TO EMI-ERROR
  8926         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8927         GO TO 1005-CHECK-ERRORS.
  8928
  8929     IF CD-RETURN-CODE = '04'
  8930         MOVE ER-8313            TO EMI-ERROR
  8931         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8932         GO TO 1005-CHECK-ERRORS.
  8933
  8934     IF CD-RETURN-CODE = '05'
  8935         MOVE ER-8314            TO EMI-ERROR
  8936         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8937         GO TO 1005-CHECK-ERRORS.
  8938
  8939     IF CD-RETURN-CODE = '06'
  8940         MOVE ER-8315            TO EMI-ERROR
  8941         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8942         GO TO 1005-CHECK-ERRORS.
  8943
  8944     IF CD-RETURN-CODE = 'E1'
  8945         MOVE ER-8316            TO EMI-ERROR
  8946         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8947         GO TO 1005-CHECK-ERRORS.
  8948
  8949     IF CD-RETURN-CODE = 'N1'
  8950         MOVE ER-8317            TO EMI-ERROR
  8951         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8952         GO TO 1005-CHECK-ERRORS.
  8953
  8954 1004-CONT.
  8955     MOVE W-EOB-CODE (W-EOB-NDX) TO PI-AT-EOB-CODE (W-EOB-NDX).
  8956
  8957     ADD +1 TO W-EOB-NDX.
  8958     GO TO 1004-CHECK-EACH-EOB.
  8959
  8960 1004-CHECK-DUP-EOB.
  8961     IF ((PI-AT-EOB-CODE (1) NOT = SPACE) AND
  8962         (PI-AT-EOB-CODE (1) = PI-AT-EOB-CODE (2) OR
  8963                               PI-AT-EOB-CODE (3) OR
  8964                               PI-AT-EOB-CODE (4) OR
  8965                               PI-AT-EOB-CODE (5)))
  8966                  OR
  8967        ((PI-AT-EOB-CODE (2) NOT = SPACE) AND
  8968         (PI-AT-EOB-CODE (2) = PI-AT-EOB-CODE (3) OR
  8969                               PI-AT-EOB-CODE (4) OR
  8970                               PI-AT-EOB-CODE (5)))
  8971                  OR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 173
* EL156.cbl
  8972        ((PI-AT-EOB-CODE (3) NOT = SPACE) AND
  8973         (PI-AT-EOB-CODE (3) = PI-AT-EOB-CODE (4) OR
  8974                               PI-AT-EOB-CODE (5)))
  8975                  OR
  8976        ((PI-AT-EOB-CODE (4) NOT = SPACE) AND
  8977         (PI-AT-EOB-CODE (4) = PI-AT-EOB-CODE (5)))
  8978            MOVE ER-8000            TO EMI-ERROR
  8979            MOVE AL-UABON           TO NOTE2A
  8980            MOVE -1                 TO NOTE2L
  8981            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8982            GO TO 1005-CHECK-ERRORS.
  8983
  8984 1005-CHECK-ERRORS.
  8985*    IF PI-COMPANY-ID NOT = 'DMD'
  8986        GO TO 1006-CHECK-ERRORS.
  8987
  8988*********  DMD CODE START ******************
  8989*    IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
  8990*       GO TO 1006-CHECK-ERRORS.
  8991*
  8992*    PERFORM 7700-GET-DCT THRU 7700-EXIT.
  8993*
  8994*    COMPUTE W-PAYMENT-TOTAL
  8995*         = CL-TOTAL-PAID-AMT + PI-EPYAMT
  8996*    IF (W-PAYMENT-TOTAL > PI-MAX-BENEFIT-PYMT)
  8997*               AND
  8998*       (PI-MAX-BENEFIT-PYMT > ZEROS)
  8999*          EXEC CICS SYNCPOINT ROLLBACK END-EXEC
  9000*          MOVE ER-0967    TO EMI-ERROR
  9001*          MOVE -1         TO PMTTYPEL
  9002*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9003*
  9004*    GO TO 1006-CHECK-ERRORS.
  9005*********  DMD CODE END ******************
  9006
  9007 1006-CHECK-ERRORS.
  9008     IF NOT EMI-NO-ERRORS
  9009        GO TO 2000-EDIT-DONE.
  9010
  9011
  9012* EXEC CICS HANDLE CONDITION
  9013*        NOTFND(1950-NOT-FOUND)
  9014*    END-EXEC.
  9015*    MOVE '"$I                   ! '' #00008717' TO DFHEIV0
  9016     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9017     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9018     MOVE X'2720233030303038373137' TO DFHEIV0(25:11)
  9019     CALL 'kxdfhei1' USING DFHEIV0
  9020     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9021
  9022
  9023     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9024     MOVE PI-CARRIER             TO MSTR-CARRIER.
  9025     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
  9026     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  9027     MOVE 'MSTR'                 TO FILE-SWITCH.
  9028
  9029     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 174
* EL156.cbl
  9030
  9031     IF PI-COMPANY-ID = 'DMD'
  9032         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
  9033
  9034     IF WS-BIN-PROOF-DT NOT = LOW-VALUES
  9035        IF WS-BIN-PROOF-DT < CL-INCURRED-DT
  9036           MOVE ER-0873    TO EMI-ERROR
  9037           MOVE -1                  TO PROOFDTL
  9038           MOVE AL-UABON            TO PROOFDTA
  9039           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9040        END-IF
  9041     END-IF
  9042     IF CL-AUTO-PAY-SEQ NOT = ZEROS
  9043         IF PI-PMTTYPE = '5' OR '6'
  9044             NEXT SENTENCE
  9045         ELSE
  9046             MOVE ER-0555             TO EMI-ERROR
  9047             MOVE -1                  TO PMTTYPEL
  9048             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9049
  9050     IF CL-LAST-CLOSE-REASON = '2'
  9051         IF CL-CLAIM-STATUS = 'C'
  9052             MOVE ER-0760        TO  EMI-ERROR
  9053             MOVE -1             TO  PMTTYPEL
  9054             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9055
  9056     IF PI-ACTIVITY-CODE = 9
  9057         MOVE ER-3538            TO  EMI-ERROR
  9058         MOVE -1                 TO  PMTTYPEL
  9059         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9060
  9061     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
  9062         GO TO 1008-READ-CERT.
  9063**********************AIG LOGIC STARTS *********************
  9064     IF CL-CERT-PRIME = 'INCOMPLETE'
  9065         MOVE ER-3540            TO  EMI-ERROR
  9066         MOVE -1                 TO  PMTTYPEL
  9067         MOVE AL-UABON           TO  PMTTYPEA
  9068         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9069         GO TO 2000-EDIT-DONE.
  9070
  9071     IF PI-PMTTYPE = '4'
  9072         IF PI-EPYAMT IS NEGATIVE
  9073             IF PI-ECHECKNO-CR = 'CR'
  9074                 NEXT SENTENCE
  9075             ELSE
  9076                 MOVE 'CR'       TO  PI-ECHECKNO-CR.
  9077
  9078     IF PI-PMTTYPE = '4'
  9079         IF PI-ECHECKNO-CR = 'CR'
  9080             IF PI-EPYAMT IS NEGATIVE
  9081                 NEXT SENTENCE
  9082             ELSE
  9083                 MOVE ER-0834    TO  EMI-ERROR
  9084                 MOVE -1         TO  EPYAMTL
  9085                 MOVE AL-UNBON   TO  EPYAMTA
  9086                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9087
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 175
* EL156.cbl
  9088     IF PI-PMTTYPE = '4'
  9089         IF PI-EPYAMT IS NEGATIVE
  9090             IF PI-OFFLINE = 'Y'
  9091                 NEXT SENTENCE
  9092             ELSE
  9093                 MOVE 'Y'        TO  PI-OFFLINE
  9094                                     WS-OFFLINE
  9095                                     OFFLINEO
  9096                 MOVE AL-UANON   TO  OFFLINEA.
  9097
  9098     IF PI-PMTTYPE = '4'
  9099         IF PI-EPYAMT IS NEGATIVE
  9100             IF PI-CASH = 'Y'
  9101                 NEXT SENTENCE
  9102             ELSE
  9103                 MOVE 'Y'        TO  CASHI PI-CASH WS-CASH
  9104                 MOVE AL-UANON   TO  CASHA
  9105                 GO TO 1007-DEFAULT-AIG-CHECKNO.
  9106
  9107     IF PI-CASH NOT = 'Y' AND 'N'
  9108          IF PI-OFFLINE = 'Y'  AND
  9109             PI-ECHECKNO-CR = 'CR'
  9110               MOVE 'Y'          TO  CASHI PI-CASH WS-CASH
  9111               MOVE AL-UANON     TO  CASHA
  9112               GO TO 1007-DEFAULT-AIG-CHECKNO.
  9113
  9114     IF PI-CASH NOT = 'Y' AND 'N'
  9115         IF PI-PMTTYPE = '5' OR '6'
  9116             MOVE 'Y'            TO  CASHI PI-CASH WS-CASH
  9117             MOVE AL-UANON       TO  CASHA
  9118             GO TO 1007-DEFAULT-AIG-CHECKNO.
  9119
  9120     IF PI-CASH NOT = 'Y' AND 'N'
  9121        IF CL-ASSOCIATES = 'N' OR 'A'
  9122            MOVE 'Y'             TO  CASHI PI-CASH WS-CASH
  9123            MOVE AL-UANON        TO  CASHA
  9124        ELSE
  9125            MOVE 'N'             TO  CASHI PI-CASH WS-CASH
  9126            MOVE AL-UANON        TO  CASHA.
  9127
  9128     IF PI-PMTTYPE = '5' OR '6'
  9129         IF PI-CASH = 'N'
  9130             MOVE ER-0819        TO  EMI-ERROR
  9131             MOVE AL-UANON       TO  CASHA
  9132             MOVE -1             TO  CASHL
  9133             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9134
  9135     IF CL-ASSOCIATES = 'N' OR 'A'
  9136        IF CASHI = 'N'
  9137         MOVE ER-3537            TO  EMI-ERROR
  9138         MOVE AL-UANON           TO  CASHA
  9139         MOVE -1                 TO  CASHL
  9140         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9141
  9142 1007-DEFAULT-AIG-CHECKNO.
  9143
  9144     IF CL-CAUSE-CD = SPACES OR LOW-VALUES
  9145         MOVE ER-3532            TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 176
* EL156.cbl
  9146         MOVE -1                 TO  PMTTYPEL
  9147         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9148**********************AIG LOGIC ENDS ***********************
  9149
  9150 1008-READ-CERT.
  9151
  9152     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9153     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  9154     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  9155     MOVE CL-CERT-STATE          TO CERT-STATE.
  9156     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  9157     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  9158     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  9159     MOVE 'CERT'                 TO FILE-SWITCH.
  9160
  9161     PERFORM 7970-READ-CERT THRU 7970-EXIT.
  9162
  9163     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9164         MOVE CM-LF-LOAN-EXPIRE-DT  TO WS-EXP-DT PI-EXP-DT
  9165     ELSE
  9166         MOVE CM-AH-LOAN-EXPIRE-DT  TO WS-EXP-DT PI-EXP-DT.
  9167
  9168*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9169*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT.
  9170
  9171     IF CL-INCURRED-DT < CM-CERT-EFF-DT
  9172         MOVE ER-0458            TO EMI-ERROR
  9173         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9174
  9175     IF CL-INCURRED-DT NOT < WS-EXP-DT
  9176         MOVE ER-0459            TO EMI-ERROR
  9177         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9178
  9179     IF CL-REPORTED-DT = LOW-VALUES
  9180        MOVE ER-0530             TO EMI-ERROR
  9181        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9182
  9183     IF PI-COMPANY-ID = 'NCL'
  9184        IF CM-CREDIT-INTERFACE-SW-1 = '2'
  9185            MOVE ER-0770            TO EMI-ERROR
  9186            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9187
  9188     IF PI-COMPANY-ID = 'NCL'
  9189        IF (CM-SING-PRM AND CERT-WAS-CREATED-FOR-CLAIM)
  9190            MOVE ER-0737            TO EMI-ERROR
  9191            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9192
  9193     IF CM-ENTRY-STATUS = 'D' OR 'V'
  9194         MOVE ER-0768            TO  EMI-ERROR
  9195         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9196
  9197     IF CM-CREDIT-INTERFACE-SW-1 = '4'
  9198         MOVE ER-0769            TO  EMI-ERROR
  9199         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9200
  9201     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9202         GO TO 1020-DO-LIFE-EDITS
  9203     ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 177
* EL156.cbl
  9204         GO TO 1030-DO-AH-EDITS.
  9205
  9206 1010-GENERAL-ERROR.
  9207     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9208
  9209     IF EMI-MESSAGE-FORMATTED
  9210         MOVE -1                 TO PMTTYPEL.
  9211
  9212 1010-EXIT.
  9213     EXIT.
  9214
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 178
* EL156.cbl
  9216 1020-DO-LIFE-EDITS.
  9217     IF CM-LF-BENEFIT-CD = '00'
  9218         IF PI-PMTTYPE = '5' OR '6'
  9219             MOVE ER-0658        TO EMI-ERROR
  9220             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9221         ELSE
  9222             MOVE ER-1775        TO EMI-ERROR
  9223             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9224
  9225     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  9226         MOVE ER-0460            TO EMI-ERROR
  9227         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9228
  9229     MOVE CM-LF-BENEFIT-CD      TO PI-LF-BENEFIT-CD.
  9230     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
  9231     MOVE WS-ACCESS              TO  CNTL-ACCESS.
  9232     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9233     MOVE '4'                    TO  CNTL-REC-TYPE.
  9234     MOVE ZEROS                  TO  CNTL-SEQ-NO.
  9235     MOVE 'BENE'                 TO  FILE-SWITCH.
  9236     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9237     IF NO-BENEFIT-FOUND
  9238         GO TO 1950-NOT-FOUND.
  9239
  9240     MOVE CF-LF-COVERAGE-TYPE (SUB-1)   TO  PI-LF-COVERAGE-TYPE.
  9241
  9242     IF CM-LF-DEATH-EXIT-DT = LOW-VALUES
  9243         IF PI-PMTTYPE = '4'
  9244             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9245                PI-LF-COVERAGE-TYPE = 'P'
  9246                 NEXT SENTENCE
  9247             ELSE
  9248                 MOVE ER-0461        TO EMI-ERROR
  9249                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9250         ELSE
  9251            NEXT SENTENCE
  9252     ELSE
  9253         IF PI-PMTTYPE = '2'
  9254            IF NOT CM-O-B-COVERAGE
  9255              AND CM-LF-CURRENT-STATUS = '7'
  9256                MOVE ER-0462     TO EMI-ERROR
  9257                PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9258
  9259     IF PI-PMTTYPE = '2'
  9260         IF (CM-LF-CANCEL-DT      NOT = LOW-VALUES AND SPACES) OR
  9261            (CM-LF-CANCEL-EXIT-DT NOT = LOW-VALUES AND SPACES)
  9262             MOVE CM-LF-ITD-CANCEL-AMT  TO  WS-REFUND-AMT
  9263             MOVE ER-0730            TO  EMI-ERROR
  9264             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9265             MOVE WS-REFUND-AMT      TO  EMI-TEXT-VARIABLE (1).
  9266
  9267     IF PI-PMTTYPE = '2'
  9268         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9269            PI-LF-COVERAGE-TYPE = 'P'
  9270             IF CL-PAID-THRU-DT = CL-INCURRED-DT
  9271                 MOVE ER-0462    TO  EMI-ERROR
  9272                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9273
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 179
* EL156.cbl
  9274     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
  9275       AND CL-INCURRED-DT > CM-LF-CANCEL-DT
  9276         MOVE ER-0466            TO EMI-ERROR
  9277         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9278
  9279     IF PI-COMPANY-ID = 'FLI' OR 'FLU'
  9280         IF PI-PMTTYPE = '3'
  9281             MOVE 0436           TO EMI-ERROR
  9282             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9283             GO TO 1045-EDIT-PAYEE-ADDR
  9284         ELSE
  9285             GO TO 1045-EDIT-PAYEE-ADDR.
  9286
  9287     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9288        PI-LF-COVERAGE-TYPE = 'P'
  9289         IF PI-PMTTYPE = '3'
  9290             MOVE ER-0436          TO  EMI-ERROR
  9291             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9292         ELSE
  9293             NEXT SENTENCE
  9294     ELSE
  9295         IF PI-PMTTYPE = '1' OR '3'
  9296             MOVE ER-0436            TO EMI-ERROR
  9297             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9298*
  9299     IF PI-COMPANY-ID = 'CID' AND
  9300        CL-CERT-STATE = 'SC'  AND
  9301        (CM-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  9302           MOVE ER-0879    TO  EMI-ERROR
  9303           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9304     END-IF.
  9305
  9306     GO TO 1045-EDIT-PAYEE-ADDR.
  9307
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 180
* EL156.cbl
  9309 1030-DO-AH-EDITS.
  9310     IF CM-AH-BENEFIT-CD = '00'
  9311         IF PI-PMTTYPE = '5' OR '6'
  9312             MOVE ER-0658        TO EMI-ERROR
  9313             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9314         ELSE
  9315             MOVE ER-1775        TO EMI-ERROR
  9316             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9317
  9318     IF CL-TOTAL-PAID-AMT = ZEROS
  9319         IF PI-PMTTYPE = '4'
  9320             MOVE ER-0438        TO EMI-ERROR
  9321             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9322
  9323     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
  9324         IF PI-PMTTYPE = '3'
  9325             MOVE ER-0463        TO EMI-ERROR
  9326             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9327         ELSE
  9328             IF (CL-INCURRED-DT NOT < CM-LF-DEATH-EXIT-DT)
  9329              AND CM-LF-CURRENT-STATUS = '7'
  9330                 MOVE ER-0465    TO EMI-ERROR
  9331                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9332
  9333     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  9334         IF PI-PMTTYPE = '3'
  9335             MOVE ER-0464        TO EMI-ERROR
  9336             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9337         ELSE
  9338             IF CL-INCURRED-DT > CM-AH-SETTLEMENT-DT
  9339                 MOVE ER-0469    TO EMI-ERROR
  9340                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9341
  9342     IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  9343         IF PI-PMTTYPE = '3'
  9344             IF CL-INCURRED-DT NOT = CM-AH-CANCEL-DT
  9345                 MOVE ER-0467    TO EMI-ERROR
  9346                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9347             ELSE
  9348                 NEXT SENTENCE
  9349         ELSE
  9350             IF CL-INCURRED-DT NOT < CM-AH-CANCEL-DT
  9351                 MOVE ER-0468    TO EMI-ERROR
  9352                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9353
  9354     GO TO 1045-EDIT-PAYEE-ADDR.
  9355
  9356 1040-PMTTYPE-ERROR.
  9357     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9358
  9359     IF EMI-MESSAGE-FORMATTED
  9360         MOVE -1                 TO PMTTYPEL
  9361         MOVE AL-UABON           TO PMTTYPEA.
  9362
  9363 1040-EXIT.
  9364     EXIT.
  9365
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 181
* EL156.cbl
  9367 1045-EDIT-PAYEE-ADDR.
  9368
  9369     IF PI-OFFLINE = 'N' AND
  9370        ((PI-PAYEE-TYPE = 'A' AND CL-ACCOUNT-ADDR-CNT
  9371           < PI-PAYEE-SEQ-NUM)
  9372        OR
  9373         (PI-COMPANY-ID NOT = 'AIG' AND 'AUK') AND
  9374         (PI-PAYEE-TYPE = 'B')                 AND
  9375         (CL-BENIF-ADDR-CNT < PI-PAYEE-SEQ-NUM)
  9376        OR
  9377         (PI-PAYEE-TYPE = 'I' AND CL-INSURED-ADDR-CNT
  9378           < PI-PAYEE-SEQ-NUM)
  9379        OR
  9380         (PI-PAYEE-TYPE = 'O' AND CL-OTHER-1-ADDR-CNT
  9381           < PI-PAYEE-SEQ-NUM)
  9382        OR
  9383         (PI-PAYEE-TYPE = 'Q' AND CL-OTHER-2-ADDR-CNT
  9384           < PI-PAYEE-SEQ-NUM)
  9385        OR
  9386         (PI-PAYEE-TYPE = 'P' AND CL-DOCTOR-ADDR-CNT
  9387           < PI-PAYEE-SEQ-NUM)
  9388        OR
  9389         (PI-PAYEE-TYPE = 'E' AND CL-EMPLOYER-ADDR-CNT
  9390           < PI-PAYEE-SEQ-NUM))
  9391             MOVE ER-0437        TO EMI-ERROR
  9392             MOVE -1             TO PAYEEL
  9393             MOVE AL-UABON       TO PAYEEA
  9394             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9395
  9396     IF PI-OFFLINE    = 'N' AND
  9397        PI-PAYEE-TYPE = 'B' AND
  9398        PI-PAYEE-SEQ  = '0'
  9399         PERFORM 7920-READ-BENE THRU 7920-EXIT
  9400         IF BENE-FOUND-SW = 'N'
  9401             MOVE ER-0437        TO EMI-ERROR
  9402             MOVE -1             TO PAYEEL
  9403             MOVE AL-UABON       TO PAYEEA
  9404             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9405
  9406     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9407        IF PI-OFFLINE    = 'N'  AND
  9408           PI-PAYEE-TYPE = 'B'  AND
  9409           PI-PAYEE-SEQ  = '9'
  9410             PERFORM 7920-READ-BENE THRU 7920-EXIT
  9411             IF BENE-FOUND-SW = 'N'
  9412                MOVE ER-0437        TO EMI-ERROR
  9413                MOVE -1             TO PAYEEL
  9414                MOVE AL-UABON       TO PAYEEA
  9415                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9416
  9417*    IF PI-COMPANY-ID = 'CRI'
  9418*        IF CL-CLAIM-TYPE = 'L'
  9419*            MOVE 'N'                TO  WS-GROUPED
  9420*                                        PI-GROUPED
  9421*                                        GROUPEDI
  9422*            MOVE AL-UANON           TO  GROUPEDA
  9423*            GO TO 1050-EDIT-CHECK-NO
  9424*        ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 182
* EL156.cbl
  9425*            MOVE CL-CERT-GROUPING   TO  WS-GROUPING
  9426*            IF WS-GROUP-1 = 'C'
  9427*                NEXT SENTENCE
  9428*            ELSE
  9429*                MOVE 'N'            TO  WS-GROUPED
  9430*                                        PI-GROUPED
  9431*                                        GROUPEDI
  9432*                MOVE AL-UANON       TO  GROUPEDA
  9433*                GO TO 1050-EDIT-CHECK-NO.
  9434
  9435     IF PI-GROUPED = 'Y'
  9436        IF PI-PAYEE-TYPE = 'B' OR 'A'
  9437           NEXT SENTENCE
  9438        ELSE
  9439           MOVE ER-0437        TO EMI-ERROR
  9440           MOVE -1             TO PAYEEL
  9441           MOVE AL-UABON       TO PAYEEA
  9442           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9443
  9444     IF (PI-PAYEE-TYPE = 'B' OR 'A') AND
  9445        (PI-GROUPED    = ' ')
  9446        NEXT SENTENCE
  9447     ELSE
  9448        GO TO 1050-EDIT-CHECK-NO.
  9449
  9450     IF PI-COMPANY-ID = 'CRI'
  9451        MOVE 'N'           TO GROUPEDI
  9452                              PI-GROUPED
  9453                              WS-GROUPED
  9454        MOVE AL-UANON      TO GROUPEDA.
  9455
  9456     IF PI-COMPANY-ID = 'CRI'
  9457        IF PI-PAYEE-TYPE = 'B'
  9458           IF BENE-FOUND-SW = 'Y'
  9459              IF BE-GROUP-CHECKS-Y-N = 'Y'
  9460                 MOVE 'Y'           TO GROUPEDI
  9461                                       PI-GROUPED
  9462                                       WS-GROUPED
  9463                 MOVE AL-UANON      TO GROUPEDA
  9464              ELSE
  9465                 NEXT SENTENCE
  9466           ELSE
  9467              PERFORM 7920-READ-BENE THRU 7920-EXIT
  9468              IF BENE-FOUND-SW = 'Y'
  9469                 IF BE-GROUP-CHECKS-Y-N = 'Y'
  9470                    MOVE 'Y'      TO GROUPEDI
  9471                                     PI-GROUPED
  9472                                     WS-GROUPED
  9473                    MOVE AL-UANON TO GROUPEDA.
  9474
  9475     IF PI-COMPANY-ID NOT = 'CRI'
  9476        GO TO 1050-EDIT-CHECK-NO.
  9477
  9478*************** CRI CODE START ******************
  9479     IF PI-PAYEE-TYPE NOT = 'A'
  9480        GO TO 1050-EDIT-CHECK-NO.
  9481
  9482     MOVE LOW-VALUES             TO ERACCT-KEY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 183
* EL156.cbl
  9483     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
  9484     MOVE PI-CARRIER             TO ACCT-CARRIER.
  9485     MOVE PI-GROUPING            TO ACCT-GROUPING.
  9486     MOVE PI-STATE               TO ACCT-STATE.
  9487     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
  9488     MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
  9489     MOVE 'ACCT'                 TO FILE-SWITCH.
  9490
  9491     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
  9492     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
  9493
  9494
  9495* EXEC CICS HANDLE CONDITION
  9496*         NOTFND   (1950-NOT-FOUND)
  9497*         ENDFILE  (1950-NOT-FOUND)
  9498*    END-EXEC.
  9499*    MOVE '"$I''                  ! ( #00009192' TO DFHEIV0
  9500     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9501     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9502     MOVE X'2820233030303039313932' TO DFHEIV0(25:11)
  9503     CALL 'kxdfhei1' USING DFHEIV0
  9504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9505
  9506
  9507
  9508* EXEC CICS STARTBR
  9509*         DATASET   ('ERACCT')
  9510*         RIDFLD    (ERACCT-KEY)
  9511*         GTEQ
  9512*    END-EXEC.
  9513     MOVE 'ERACCT' TO DFHEIV1
  9514     MOVE 0
  9515       TO DFHEIV11
  9516*    MOVE '&,         G          &   #00009197' TO DFHEIV0
  9517     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9518     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9519     MOVE X'2020233030303039313937' TO DFHEIV0(25:11)
  9520     CALL 'kxdfhei1' USING DFHEIV0,
  9521           DFHEIV1,
  9522           ERACCT-KEY,
  9523           DFHEIV99,
  9524           DFHEIV11,
  9525           DFHEIV99
  9526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9527
  9528
  9529 1046-READNEXT-ERACCT.
  9530
  9531
  9532* EXEC CICS READNEXT
  9533*         DATASET   ('ERACCT')
  9534*         RIDFLD    (ERACCT-KEY)
  9535*         SET       (ADDRESS OF ACCOUNT-MASTER)
  9536*    END-EXEC.
  9537     MOVE 'ERACCT' TO DFHEIV1
  9538     MOVE 0
  9539       TO DFHEIV11
  9540*    MOVE '&.S                   )   #00009205' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 184
* EL156.cbl
  9541     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9542     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9543     MOVE X'2020233030303039323035' TO DFHEIV0(25:11)
  9544     CALL 'kxdfhei1' USING DFHEIV0,
  9545           DFHEIV1,
  9546           DFHEIV20,
  9547           DFHEIV99,
  9548           ERACCT-KEY,
  9549           DFHEIV99,
  9550           DFHEIV11,
  9551           DFHEIV99,
  9552           DFHEIV99
  9553     SET ADDRESS OF ACCOUNT-MASTER TO
  9554         DFHEIV20
  9555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9556
  9557
  9558     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
  9559        IF WS-ERACCT-HOLD-RECORD = SPACES
  9560           GO TO 1950-NOT-FOUND
  9561        ELSE
  9562           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
  9563           GO TO 1048-CONTINUE.
  9564
  9565     IF ACCT-EXP-DT = HIGH-VALUES
  9566        NEXT SENTENCE
  9567     ELSE
  9568        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
  9569        GO TO 1046-READNEXT-ERACCT.
  9570
  9571 1048-CONTINUE.
  9572
  9573     IF AM-GROUPED-CHECKS-Y-N = 'Y'
  9574        MOVE 'Y'                 TO GROUPEDI
  9575                                    PI-GROUPED
  9576                                    WS-GROUPED
  9577        MOVE AL-UANON            TO GROUPEDA.
  9578*************** CRI CODE END ******************
  9579
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 185
* EL156.cbl
  9581 1050-EDIT-CHECK-NO.
  9582
  9583     IF PI-OFFLINE = 'Y'
  9584         IF PI-ECHECKNO = SPACES
  9585              MOVE ER-0439        TO EMI-ERROR
  9586              GO TO 1090-CHECK-NO-ERROR
  9587           ELSE
  9588         IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9589            IF PI-ECHECKNO-N = 'N' AND
  9590               PI-CASH       = 'Y'
  9591                 MOVE ER-3535        TO EMI-ERROR
  9592                 GO TO 1090-CHECK-NO-ERROR
  9593              ELSE
  9594                 MOVE AL-UANON    TO CHECKNOA
  9595                 GO TO 1100-EDIT-HOLDTIL
  9596          ELSE
  9597            MOVE AL-UANON    TO CHECKNOA
  9598            GO TO 1100-EDIT-HOLDTIL.
  9599
  9600     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9601     MOVE '6'                    TO CNTL-REC-TYPE.
  9602
  9603     IF CONTROL-IS-ACTUAL-CARRIER
  9604         MOVE PI-CARRIER         TO WS-CARR
  9605     ELSE
  9606         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
  9607
  9608     IF PI-COMPANY-ID = 'FIA'
  9609         MOVE PI-CARRIER         TO WS-CARR.
  9610
  9611     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9612     MOVE 0                      TO CNTL-SEQ-NO.
  9613     MOVE 'CARR'                 TO FILE-SWITCH.
  9614
  9615     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
  9616
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 186
* EL156.cbl
  9618     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
  9619         GO TO 1051-EDIT-CHECKNO-CONT.
  9620
  9621**********************AIG LOGIC STARTS**********************
  9622     IF PI-ECHECKNO = SPACES
  9623         IF CHECK-NO-MANUAL
  9624             MOVE ER-0441        TO EMI-ERROR
  9625             GO TO 1090-CHECK-NO-ERROR
  9626         ELSE
  9627             MOVE AL-UANOF       TO CHECKNOA
  9628             GO TO 1100-EDIT-HOLDTIL.
  9629
  9630     IF PI-ECHECKNO NOT = SPACES
  9631         IF CHECK-NO-MANUAL
  9632             MOVE AL-UANON       TO CHECKNOA
  9633             GO TO 1100-EDIT-HOLDTIL.
  9634
  9635     IF PI-ECHECKNO-CR = 'CR'
  9636        IF PI-OFFLINE = 'Y'
  9637            MOVE AL-UANON       TO CHECKNOA
  9638            GO TO 1100-EDIT-HOLDTIL
  9639        ELSE
  9640            MOVE ER-3534        TO EMI-ERROR
  9641            GO TO 1090-CHECK-NO-ERROR.
  9642
  9643     IF PI-ECHECKNO-N = 'N'
  9644        IF PI-CASH = 'N'
  9645            MOVE AL-UANON       TO CHECKNOA
  9646            GO TO 1100-EDIT-HOLDTIL
  9647        ELSE
  9648            MOVE ER-3535          TO EMI-ERROR
  9649            GO TO 1090-CHECK-NO-ERROR.
  9650
  9651     MOVE ER-0442        TO EMI-ERROR
  9652     GO TO 1090-CHECK-NO-ERROR.
  9653**********************AIG LOGIC ENDS************************
  9654
  9655 1051-EDIT-CHECKNO-CONT.
  9656
  9657     IF PI-COMPANY-ID = 'DMD'
  9658        IF PI-ECHECKNO NOT = SPACES
  9659           IF PI-ECHECKNO (6:2) NOT = 'TP'
  9660              MOVE ER-0442        TO EMI-ERROR
  9661              GO TO 1090-CHECK-NO-ERROR
  9662            ELSE
  9663              GO TO 1100-EDIT-HOLDTIL
  9664          ELSE
  9665           GO TO 1100-EDIT-HOLDTIL.
  9666
  9667     IF PI-ECHECKNO = SPACES
  9668         IF CHECK-NO-MANUAL
  9669             MOVE ER-0441        TO EMI-ERROR
  9670             GO TO 1090-CHECK-NO-ERROR
  9671         ELSE
  9672             MOVE AL-UANOF       TO CHECKNOA
  9673             GO TO 1100-EDIT-HOLDTIL
  9674     ELSE
  9675         IF CHECK-NO-MANUAL
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 187
* EL156.cbl
  9676             MOVE AL-UANON       TO CHECKNOA
  9677             GO TO 1100-EDIT-HOLDTIL
  9678         ELSE
  9679             MOVE ER-0442        TO EMI-ERROR
  9680             GO TO 1090-CHECK-NO-ERROR.
  9681
  9682 1090-CHECK-NO-ERROR.
  9683     MOVE -1                     TO CHECKNOL.
  9684     MOVE AL-UABON               TO CHECKNOA.
  9685     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9686
  9687     GO TO 2000-EDIT-DONE.
  9688
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 188
* EL156.cbl
  9690 1100-EDIT-HOLDTIL.
  9691     MOVE AL-UANON               TO HOLDTILA.
  9692
  9693     IF PI-HOLDTIL = ZEROS
  9694        IF PI-OFFLINE = 'Y'
  9695           MOVE ER-0572          TO EMI-ERROR
  9696           GO TO 1105-HOLDTIL-ERROR
  9697        ELSE
  9698           GO TO 1110-EDIT-PAID-FROM.
  9699
  9700     MOVE '4'                    TO DC-OPTION-CODE.
  9701     MOVE PI-HOLDTIL             TO DC-GREG-DATE-1-MDY.
  9702     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9703
  9704     IF DATE-CONVERSION-ERROR
  9705         MOVE ER-0446            TO EMI-ERROR
  9706         GO TO 1105-HOLDTIL-ERROR
  9707     END-IF
  9708     IF PI-OFFLINE = 'Y'
  9709        IF DC-BIN-DATE-1 < SAVE-BIN-DATE
  9710           MOVE ER-0446            TO EMI-ERROR
  9711           GO TO 1105-HOLDTIL-ERROR
  9712        END-IF
  9713     END-IF
  9714
  9715     IF PI-OFFLINE = 'Y'
  9716        GO TO 1110-EDIT-PAID-FROM.
  9717
  9718     MOVE DC-BIN-DATE-1          TO DC-BIN-DATE-2.
  9719     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
  9720     MOVE '1'                    TO DC-OPTION-CODE.
  9721     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9722
  9723     IF DC-ELAPSED-DAYS > 30 OR DATE-CONVERSION-ERROR
  9724         MOVE ER-0447            TO EMI-ERROR
  9725         GO TO 1105-HOLDTIL-ERROR.
  9726
  9727     GO TO 1110-EDIT-PAID-FROM.
  9728
  9729 1105-HOLDTIL-ERROR.
  9730     MOVE -1                     TO HOLDTILL.
  9731     MOVE AL-UNBON               TO HOLDTILA.
  9732     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9733
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 189
* EL156.cbl
  9735 1110-EDIT-PAID-FROM.
  9736     MOVE AL-UANON               TO EPYFROMA.
  9737
  9738     IF PI-EPYFROM = ZEROS
  9739         GO TO 1120-CALCULATE-PAID-FROM.
  9740
  9741     IF PI-PMTTYPE = '5' OR '6'
  9742         MOVE ER-0448            TO EMI-ERROR
  9743         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9744         MOVE AL-UNBON           TO EPYFROMA
  9745         MOVE -1                 TO EPYFROML
  9746         GO TO 1150-EDIT-PAID-THRU.
  9747
  9748     MOVE '4'                    TO DC-OPTION-CODE.
  9749     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
  9750     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9751
  9752     IF DATE-CONVERSION-ERROR
  9753         MOVE ER-0449            TO EMI-ERROR
  9754         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9755         MOVE AL-UNBON           TO EPYFROMA
  9756         MOVE -1                 TO EPYFROML
  9757     ELSE
  9758         MOVE DC-BIN-DATE-1      TO WS-SV-EPYFROM.
  9759
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 190
* EL156.cbl
  9761 1120-CALCULATE-PAID-FROM.
  9762     IF PI-PMTTYPE = '5' OR '6'
  9763         GO TO 1150-EDIT-PAID-THRU.
  9764
  9765*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9766*       IF PI-PMTTYPE = '4'
  9767*         GO TO 1150-EDIT-PAID-THRU.
  9768
  9769     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9770         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
  9771         MOVE ' '                TO DC-OPTION-CODE
  9772         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9773         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
  9774         GO TO 1145-TEST-PAID-FROM.
  9775
  9776     IF PI-PMTTYPE = '4'
  9777        GO TO 1150-EDIT-PAID-THRU.
  9778
  9779     MOVE CM-AH-BENEFIT-CD       TO WS-BEN-CD.
  9780     MOVE WS-ACCESS              TO CNTL-ACCESS.
  9781     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9782     MOVE '5'                    TO CNTL-REC-TYPE.
  9783     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9784     MOVE 'BENE'                 TO FILE-SWITCH.
  9785
  9786     IF WS-BEN-CD = ZEROS
  9787         GO TO 1950-NOT-FOUND.
  9788
  9789     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9790
  9791     IF NO-BENEFIT-FOUND
  9792         GO TO 1950-NOT-FOUND.
  9793
  9794     MOVE CF-BENEFIT-ALPHA   (SUB-1) TO PI-BENEFIT-SAVE.
  9795     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
  9796
  9797     IF PI-BEN-DAYS NOT NUMERIC
  9798        MOVE ZEROS               TO PI-BEN-DAYS.
  9799
  9800     MOVE PI-BEN-DAYS            TO WS-BEN-DAYS.
  9801
  9802     IF (CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES)  AND
  9803        (CL-TOTAL-PAID-AMT > ZEROS)
  9804         MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
  9805         MOVE '6'                 TO DC-OPTION-CODE
  9806         MOVE +0                  TO DC-ELAPSED-MONTHS
  9807         MOVE +1                  TO DC-ELAPSED-DAYS
  9808         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9809         MOVE DC-BIN-DATE-2       TO PI-CPYFROM
  9810         GO TO 1145-TEST-PAID-FROM.
  9811
  9812******************************************************************
  9813****** ON FIRST PAYMENTS, ELIM/RETRO EDITS TO BE MADE AGAINST THE
  9814****** SPECIAL ENTERED DATE.
  9815******************************************************************
  9816
  9817     IF PI-AIGFROM = ZEROS
  9818         GO TO 1130-CONTINUE-PAID-FROM.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 191
* EL156.cbl
  9819
  9820     MOVE AL-UANON TO AIGFROMA.
  9821
  9822     MOVE '4'                    TO DC-OPTION-CODE.
  9823     MOVE PI-AIGFROM             TO DC-GREG-DATE-1-MDY.
  9824     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9825
  9826     IF DATE-CONVERSION-ERROR
  9827         MOVE ER-0449            TO EMI-ERROR
  9828         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9829         MOVE AL-UNBON           TO AIGFROMA
  9830         MOVE -1                 TO AIGFROML
  9831         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1
  9832     ELSE
  9833         MOVE 'Y'                TO WS-AIG-PAYFROM-SW
  9834         MOVE DC-BIN-DATE-1      TO WS-SV-AIGFROM.
  9835
  9836     GO TO 1140-CONTINUE-PAID-FROM.
  9837
  9838 1130-CONTINUE-PAID-FROM.
  9839
  9840     IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
  9841        (CL-TOTAL-PAID-AMT = ZEROS)
  9842           MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
  9843
  9844 1140-CONTINUE-PAID-FROM.
  9845
  9846     IF PI-BEN-TYPE = 'R'
  9847         IF PI-BEN-DAYS = ZEROS
  9848             NEXT SENTENCE
  9849         ELSE
  9850         IF PI-COMPANY-ID NOT = 'DMD'
  9851             SUBTRACT 1 FROM PI-BEN-DAYS.
  9852
  9853     MOVE DC-BIN-DATE-1          TO WS-HOLD-BIN-DATE-1.
  9854
  9855     IF PI-COMPANY-ID = 'DMD'
  9856         MOVE -1                 TO DC-ELAPSED-DAYS
  9857         MOVE +0                 TO DC-ELAPSED-MONTHS
  9858         MOVE '6'                TO DC-OPTION-CODE
  9859         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9860         MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
  9861         DIVIDE PI-BEN-DAYS BY 30 GIVING DC-ELAPSED-MONTHS
  9862                               REMAINDER DC-ELAPSED-DAYS
  9863      ELSE
  9864         MOVE PI-BEN-DAYS        TO DC-ELAPSED-DAYS
  9865         MOVE +0                 TO DC-ELAPSED-MONTHS.
  9866
  9867     MOVE '6'                    TO DC-OPTION-CODE.
  9868     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9869     MOVE DC-BIN-DATE-2          TO WS-RETRO-ELIM-DATE.
  9870
  9871     MOVE WS-HOLD-BIN-DATE-1     TO DC-BIN-DATE-1.
  9872
  9873     IF WS-RETRO-ELIM-DATE > WS-TODAY-DATE
  9874         MOVE ER-0541            TO EMI-ERROR
  9875         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9876         MOVE -1                 TO EPYFROML
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 192
* EL156.cbl
  9877         MOVE AL-UNBON           TO EPYFROMA.
  9878
  9879     IF (PI-COMPANY-ID = 'AIG' OR 'AUK')  AND
  9880        (PI-BENEFIT-SAVE = '60E')
  9881        IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
  9882           (CL-TOTAL-PAID-AMT = ZEROS)
  9883             MOVE WS-HOLD-BIN-DATE-1  TO DC-BIN-DATE-1
  9884             MOVE 30                  TO DC-ELAPSED-DAYS
  9885             MOVE +0                  TO DC-ELAPSED-MONTHS
  9886             MOVE '6'                 TO DC-OPTION-CODE
  9887             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9888
  9889     IF PI-BEN-TYPE = 'R'
  9890         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
  9891     ELSE
  9892         MOVE DC-BIN-DATE-2      TO PI-CPYFROM
  9893         IF WS-SV-EPYFROM = LOW-VALUES
  9894            MOVE DC-BIN-DATE-2   TO WS-SV-EPYFROM.
  9895
  9896     IF CL-PAID-THRU-DT = LOW-VALUES OR SPACES
  9897         IF WS-USE-AIG-PAYFROM   OR
  9898            WS-AIG-RECALC-PAYFROM
  9899              MOVE PI-CPYFROM     TO  WS-SV-EPYFROM
  9900                                      DC-BIN-DATE-1
  9901              MOVE ' '            TO  DC-OPTION-CODE
  9902              MOVE +0             TO  DC-ELAPSED-MONTHS
  9903                                      DC-ELAPSED-DAYS
  9904              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9905              IF NO-CONVERSION-ERROR
  9906                  MOVE DC-GREG-DATE-1-MDY TO PI-EPYFROM.
  9907
  9908     IF PI-CPYFROM < CL-INCURRED-DT
  9909        MOVE -1                  TO EPYFROML
  9910        MOVE ER-3542             TO EMI-ERROR
  9911        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9912
  9913     IF CM-ENTRY-DT < CL-INCURRED-DT
  9914        MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
  9915        MOVE CL-INCURRED-DT         TO DC-BIN-DATE-2
  9916        MOVE +0                     TO DC-ELAPSED-DAYS
  9917        MOVE +0                     TO DC-ELAPSED-MONTHS
  9918        MOVE '1'                    TO DC-OPTION-CODE
  9919        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9920        ELSE
  9921        MOVE ZEROS TO DC-ELAPSED-MONTHS.
  9922
  9923     IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
  9924         NEXT SENTENCE
  9925     ELSE
  9926         IF DC-ELAPSED-MONTHS < 2
  9927             MOVE ER-3255        TO EMI-ERROR
  9928             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9929
  9930 1145-TEST-PAID-FROM.
  9931     IF LOW-VALUES = WS-SV-EPYFROM OR PI-CPYFROM
  9932         GO TO 1150-EDIT-PAID-THRU.
  9933
  9934     IF WS-SV-EPYFROM NOT = PI-CPYFROM
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 193
* EL156.cbl
  9935         MOVE PI-CPYFROM         TO DC-BIN-DATE-1
  9936         MOVE ' '                TO DC-OPTION-CODE
  9937         MOVE +0                 TO DC-ELAPSED-MONTHS
  9938                                    DC-ELAPSED-DAYS
  9939         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9940         IF NO-CONVERSION-ERROR
  9941             MOVE DC-GREG-DATE-1-MDY TO EMI-DATE-FIELD
  9942         ELSE
  9943             MOVE SPACES             TO EMI-DATE-FIELD.
  9944
  9945     IF WS-SV-EPYFROM NOT = PI-CPYFROM
  9946         IF CL-TOTAL-PAID-AMT = ZEROS
  9947             MOVE ER-3543            TO EMI-ERROR
  9948             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
  9949             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9950             IF EMI-MESSAGE-FORMATTED
  9951                MOVE -1             TO EPYFROML
  9952                MOVE AL-UNBON       TO EPYFROMA
  9953             ELSE
  9954                NEXT SENTENCE
  9955         ELSE
  9956             MOVE ER-0452            TO EMI-ERROR
  9957             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
  9958             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9959             IF EMI-MESSAGE-FORMATTED
  9960                MOVE -1             TO EPYFROML
  9961                MOVE AL-UNBON       TO EPYFROMA.
  9962
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 194
* EL156.cbl
  9964 1150-EDIT-PAID-THRU.
  9965
  9966     MOVE AL-UANON               TO EPYTHRUA.
  9967
  9968     IF PI-EPYTHRU = ZEROS
  9969         IF PI-PMTTYPE = '4' OR '5' OR '6'
  9970             GO TO 1200-EDIT-FIND-TOLERANCES
  9971         ELSE
  9972            IF (PI-PMTTYPE = '3') OR
  9973               (PI-PMTTYPE = '2' AND
  9974                PI-LIFE-OVERRIDE-L1 = CL-CLAIM-TYPE)
  9975               GO TO 1152-CHECK-TYPE
  9976            ELSE
  9977               MOVE ER-0473      TO EMI-ERROR
  9978               GO TO 1170-PAID-THRU-FATAL-ERROR
  9979     ELSE
  9980         IF PI-PMTTYPE = '5' OR '6'
  9981             MOVE ER-0474        TO EMI-ERROR
  9982             GO TO 1170-PAID-THRU-FATAL-ERROR.
  9983
  9984     MOVE '4'                    TO DC-OPTION-CODE.
  9985     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
  9986     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9987
  9988     IF DATE-CONVERSION-ERROR
  9989         MOVE ER-0475            TO EMI-ERROR
  9990         GO TO 1170-PAID-THRU-FATAL-ERROR.
  9991
  9992     MOVE DC-BIN-DATE-1       TO WS-SV-EPYTHRU.
  9993
  9994     IF PI-COMPANY-ID = 'DMD'
  9995         IF PI-PMTTYPE NOT = '2'
  9996                 AND
  9997            WS-EXP-DT > WS-SV-EPYTHRU
  9998             MOVE WS-SV-EPYTHRU    TO DC-BIN-DATE-1
  9999             MOVE WS-EXP-DT        TO DC-BIN-DATE-2
 10000             MOVE '1'              TO DC-OPTION-CODE
 10001             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10002             IF DATE-CONVERSION-ERROR
 10003                 MOVE ER-0944      TO EMI-ERROR
 10004                 GO TO 1170-PAID-THRU-FATAL-ERROR
 10005             ELSE
 10006                 IF DC-ELAPSED-MONTHS = ZEROS AND
 10007                    DC-ELAPSED-DAYS   = 1
 10008                     MOVE ER-0945  TO EMI-ERROR
 10009                     MOVE -1       TO EPYTHRUL
 10010                     MOVE AL-UABON TO EPYTHRUA
 10011                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10012
 10013     IF PI-PMTTYPE = '4'
 10014         NEXT SENTENCE
 10015     ELSE
 10016         IF WS-SV-EPYTHRU = WS-EXP-DT
 10017             IF PI-PMTTYPE NOT = '2' AND '3'
 10018                 MOVE ER-3541    TO EMI-ERROR
 10019                 MOVE -1         TO PMTTYPEL
 10020                 MOVE AL-UABON   TO PMTTYPEA
 10021                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 195
* EL156.cbl
 10022
 10023     IF WS-SV-EPYTHRU < WS-SV-EPYFROM
 10024         MOVE ER-0501            TO EMI-ERROR
 10025         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10026
 10027     IF WS-SV-EPYTHRU > WS-TODAY-DATE
 10028        IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 10029*          IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10030*              MOVE ER-0540         TO EMI-ERROR
 10031*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10032*              MOVE -1              TO EPYTHRUL
 10033*              MOVE AL-UNBON        TO EPYTHRUA
 10034*          ELSE
 10035*          IF PI-COMPANY-ID = 'DMD'
 10036*              MOVE ER-7540         TO EMI-ERROR
 10037*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10038*              MOVE -1              TO EPYTHRUL
 10039*              MOVE AL-UNBON        TO EPYTHRUA
 10040*          ELSE
 10041               IF PI-PMTTYPE NOT = '2' AND '3'
 10042                  IF PI-COMPANY-ID = '???'
 10043                      MOVE ER-7540  TO EMI-ERROR
 10044                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10045                      MOVE -1       TO EPYTHRUL
 10046                      MOVE AL-UNBON TO EPYTHRUA
 10047                  ELSE
 10048                      MOVE ER-0540  TO EMI-ERROR
 10049                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10050                      MOVE -1       TO EPYTHRUL
 10051                      MOVE AL-UNBON TO EPYTHRUA.
 10052
 10053     IF (WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10054            OR
 10055        (WS-SV-EPYTHRU NOT = LOW-VALUES AND
 10056         WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10057            OR
 10058        (PI-CPYFROM NOT = LOW-VALUES AND
 10059         PI-CPYFROM < CL-PAID-THRU-DT)
 10060        PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.
 10061
 10062 1152-CHECK-TYPE.
 10063     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 10064        OR (PI-PMTTYPE = '5' OR '6')
 10065         GO TO 1160-EDIT-PAID-THRU-AH.
 10066
 10067 1155-EDIT-PAID-THRU-LIFE.
 10068     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 10069     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10070     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10071     MOVE '4'                    TO CNTL-REC-TYPE.
 10072     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10073     MOVE 'BENE'                 TO FILE-SWITCH.
 10074
 10075     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10076
 10077     IF NO-BENEFIT-FOUND
 10078         GO TO 1950-NOT-FOUND.
 10079
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 196
* EL156.cbl
 10080     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10081
 10082     MOVE WS-EXP-DT              TO PI-CPYTHRU.
 10083
 10084     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10085        PI-LF-COVERAGE-TYPE = 'P'
 10086         MOVE CL-INCURRED-DT     TO  PI-CPYTHRU
 10087         GO TO 1200-EDIT-FIND-TOLERANCES.
 10088
 10089     IF PI-EPYTHRU = ZEROS
 10090        MOVE PI-CPYTHRU          TO WS-SV-EPYTHRU.
 10091
 10092     IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10093         MOVE ER-0476            TO EMI-ERROR
 10094         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10095
 10096     MOVE CM-CERT-EFF-DT        TO DC-BIN-DATE-1.
 10097     MOVE CM-LF-CRITICAL-PERIOD TO DC-ELAPSED-MONTHS.
 10098     MOVE +0                    TO DC-ELAPSED-DAYS.
 10099     MOVE '6'                   TO DC-OPTION-CODE.
 10100     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10101
 10102     IF (NO-CONVERSION-ERROR AND
 10103         WS-SPECIAL-CALC-CD = 'C')
 10104        IF CL-INCURRED-DT > DC-BIN-DATE-2
 10105            MOVE ER-0657 TO EMI-ERROR
 10106            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10107
 10108     IF PI-COMPANY-ID = 'NCL'
 10109         IF WS-SPECIAL-CALC-CD = 'C' AND
 10110            CM-LF-CRITICAL-PERIOD = +0
 10111             MOVE ER-0844       TO EMI-ERROR
 10112             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10113
 10114     GO TO 1200-EDIT-FIND-TOLERANCES.
 10115
 10116 1160-EDIT-PAID-THRU-AH.
 10117     IF PI-EPYTHRU = ZEROS
 10118        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10119                                    WS-SV-EPYTHRU
 10120     ELSE
 10121        MOVE WS-SV-EPYTHRU       TO PI-CPYTHRU.
 10122
 10123     IF WS-SV-EPYTHRU < PI-CPYFROM
 10124         MOVE ER-0508            TO EMI-ERROR
 10125         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10126
 10127     IF PI-PMTTYPE = '3'
 10128        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10129         IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10130             MOVE ER-0477        TO EMI-ERROR
 10131             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT
 10132         ELSE
 10133             NEXT SENTENCE
 10134     ELSE
 10135         IF WS-SV-EPYTHRU > WS-EXP-DT
 10136             MOVE ER-0557        TO EMI-ERROR
 10137             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 197
* EL156.cbl
 10138
 10139     IF (WS-RETRO-ELIM-DATE > WS-SV-EPYTHRU) AND
 10140         PI-PMTTYPE NOT = '3'
 10141         MOVE ER-0541        TO EMI-ERROR
 10142         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10143
 10144     IF (CM-AH-CANCEL-DT NOT = LOW-VALUES) AND
 10145        (PI-PMTTYPE NOT = '3')
 10146         IF WS-SV-EPYTHRU > CM-AH-CANCEL-DT
 10147             MOVE ER-0478        TO EMI-ERROR
 10148             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10149
 10150     IF (CM-AH-SETTLEMENT-DT NOT = LOW-VALUES) AND
 10151        (PI-PMTTYPE NOT = '4')
 10152         IF WS-SV-EPYTHRU > CM-AH-SETTLEMENT-DT
 10153             MOVE ER-0479        TO EMI-ERROR
 10154             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10155
 10156     IF (CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES) AND
 10157         WS-SV-EPYTHRU > CL-EST-END-OF-DISAB-DT
 10158             MOVE ER-0545        TO EMI-ERROR
 10159             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10160
 10161     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 10162         IF WS-SV-EPYTHRU > CM-LF-DEATH-EXIT-DT
 10163             MOVE ER-0481        TO EMI-ERROR
 10164             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10165
 10166*    IF PI-COMPANY-ID = 'NCL'
 10167*        IF WS-SPECIAL-CALC-CD = 'C' AND
 10168*           CM-AH-CRITICAL-PERIOD = +0
 10169*            MOVE ER-0844        TO  EMI-ERROR
 10170*            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10171
 10172     IF (CM-AH-CRITICAL-PERIOD = ZEROS) OR
 10173        (WS-SPECIAL-CALC-CD NOT = 'C')
 10174          GO TO 1200-EDIT-FIND-TOLERANCES.
 10175
 10176     MOVE PI-CPYFROM TO DC-BIN-DATE-1.
 10177     MOVE PI-CPYTHRU TO DC-BIN-DATE-2.
 10178     MOVE '1'        TO DC-OPTION-CODE.
 10179     MOVE +0         TO DC-ELAPSED-DAYS
 10180                        DC-ELAPSED-MONTHS.
 10181     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10182
 10183*    IF NO-CONVERSION-ERROR
 10184*       COMPUTE WS-CRIT-PERIOD-DAYS =
 10185*           (DC-ELAPSED-DAYS + CL-NO-OF-DAYS-PAID) / 30.5
 10186*       IF WS-CRIT-PERIOD-DAYS > CM-AH-CRITICAL-PERIOD
 10187*           MOVE ER-0657 TO EMI-ERROR
 10188*           PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10189
 10190     GO TO 1200-EDIT-FIND-TOLERANCES.
 10191
 10192 1165-PAID-THRU-ERROR.
 10193     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10194
 10195     IF EMI-MESSAGE-FORMATTED
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 198
* EL156.cbl
 10196         MOVE -1                 TO EPYTHRUL
 10197         MOVE AL-UNBON           TO EPYTHRUA.
 10198
 10199 1165-EXIT.
 10200     EXIT.
 10201
 10202 1166-CHECK-ALL-TRLRS.
 10203
 10204     IF PI-PMTTYPE = '4'
 10205        GO TO 1166-TRLR-EXIT.
 10206
 10207     MOVE ' ' TO WS-BROWSE-TRLR-SW.
 10208
 10209     IF WS-SV-EPYTHRU = LOW-VALUES  AND
 10210        WS-SV-EPYFROM = LOW-VALUES
 10211          GO TO 1166-END-CHECK.
 10212
 10213
 10214* EXEC CICS HANDLE CONDITION
 10215*        ENDFILE   (1166-END-CHECK)
 10216*        NOTFND    (1166-END-CHECK)
 10217*    END-EXEC.
 10218*    MOVE '"$''I                  ! ) #00009866' TO DFHEIV0
 10219     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10220     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10221     MOVE X'2920233030303039383636' TO DFHEIV0(25:11)
 10222     CALL 'kxdfhei1' USING DFHEIV0
 10223     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10224
 10225
 10226     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 10227     MOVE +100                   TO TRLR-SEQ-NO.
 10228
 10229
 10230* EXEC CICS STARTBR
 10231*         DATASET    ('ELTRLR')
 10232*         RIDFLD     (ELTRLR-KEY)
 10233*         GTEQ
 10234*    END-EXEC.
 10235     MOVE 'ELTRLR' TO DFHEIV1
 10236     MOVE 0
 10237       TO DFHEIV11
 10238*    MOVE '&,         G          &   #00009874' TO DFHEIV0
 10239     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10240     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10241     MOVE X'2020233030303039383734' TO DFHEIV0(25:11)
 10242     CALL 'kxdfhei1' USING DFHEIV0,
 10243           DFHEIV1,
 10244           ELTRLR-KEY,
 10245           DFHEIV99,
 10246           DFHEIV11,
 10247           DFHEIV99
 10248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10249
 10250
 10251     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 10252
 10253 1166-READ-TRLR-NEXT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 199
* EL156.cbl
 10254
 10255
 10256* EXEC CICS READNEXT
 10257*         DATASET    ('ELTRLR')
 10258*         RIDFLD     (ELTRLR-KEY)
 10259*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10260*    END-EXEC.
 10261     MOVE 'ELTRLR' TO DFHEIV1
 10262     MOVE 0
 10263       TO DFHEIV11
 10264*    MOVE '&.S                   )   #00009884' TO DFHEIV0
 10265     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10266     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10267     MOVE X'2020233030303039383834' TO DFHEIV0(25:11)
 10268     CALL 'kxdfhei1' USING DFHEIV0,
 10269           DFHEIV1,
 10270           DFHEIV20,
 10271           DFHEIV99,
 10272           ELTRLR-KEY,
 10273           DFHEIV99,
 10274           DFHEIV11,
 10275           DFHEIV99,
 10276           DFHEIV99
 10277     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10278         DFHEIV20
 10279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10280
 10281
 10282     IF TRLR-COMP-CD  = MSTR-COMP-CD  AND
 10283        TRLR-CARRIER  = MSTR-CARRIER  AND
 10284        TRLR-CLAIM-NO = MSTR-CLAIM-NO AND
 10285        TRLR-CERT-NO  = MSTR-CERT-NO
 10286          NEXT SENTENCE
 10287      ELSE
 10288          GO TO 1166-END-CHECK.
 10289
 10290* **  BYPASS ALL NON-PAYMENT TRAILERS
 10291
 10292     IF AT-TRAILER-TYPE = '2'
 10293        NEXT SENTENCE
 10294     ELSE
 10295        GO TO 1166-READ-TRLR-NEXT.
 10296
 10297* **  BYPASS ALL NON-PARTIAL PAYMENTS
 10298
 10299     IF AT-PAYMENT-TYPE = '1' OR '2'
 10300        NEXT SENTENCE
 10301     ELSE
 10302        GO TO 1166-READ-TRLR-NEXT.
 10303
 10304* **  BYPASS ALL VOID PAYMENTS
 10305
 10306     IF AT-VOID-DT NOT = LOW-VALUES
 10307        GO TO 1166-READ-TRLR-NEXT.
 10308
 10309     IF (AT-PAID-FROM-DT = LOW-VALUES OR SPACES) OR
 10310        (AT-PAID-THRU-DT = LOW-VALUES OR SPACES)
 10311          GO TO 1166-READ-TRLR-NEXT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 200
* EL156.cbl
 10312
 10313     IF ((WS-SV-EPYTHRU < AT-PAID-FROM-DT) AND
 10314         (WS-SV-EPYFROM < AT-PAID-FROM-DT))
 10315            OR
 10316        ((WS-SV-EPYTHRU > AT-PAID-THRU-DT) AND
 10317         (WS-SV-EPYFROM > AT-PAID-THRU-DT))
 10318        NEXT SENTENCE
 10319     ELSE
 10320         IF CL-TOTAL-PAID-AMT > ZEROS
 10321             MOVE ER-0502            TO EMI-ERROR
 10322             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10323             MOVE -1                 TO EPYTHRUL
 10324             MOVE AL-UNBON           TO EPYTHRUA.
 10325
 10326     GO TO 1166-READ-TRLR-NEXT.
 10327
 10328 1166-END-CHECK.
 10329
 10330     IF WS-BROWSE-TRLR-SW = 'Y'
 10331
 10332* EXEC CICS ENDBR
 10333*            DATASET   ('ELTRLR')
 10334*       END-EXEC.
 10335     MOVE 'ELTRLR' TO DFHEIV1
 10336     MOVE 0
 10337       TO DFHEIV11
 10338*    MOVE '&2                    $   #00009939' TO DFHEIV0
 10339     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10340     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10341     MOVE X'2020233030303039393339' TO DFHEIV0(25:11)
 10342     CALL 'kxdfhei1' USING DFHEIV0,
 10343           DFHEIV1,
 10344           DFHEIV11,
 10345           DFHEIV99
 10346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10347
 10348
 10349     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 10350
 10351 1166-TRLR-EXIT.
 10352     EXIT.
 10353
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 201
* EL156.cbl
 10355 1170-PAID-THRU-FATAL-ERROR.
 10356     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10357
 10358     MOVE -1                     TO EPYTHRUL.
 10359     MOVE AL-UNBON               TO EPYTHRUA.
 10360
 10361 1200-EDIT-FIND-TOLERANCES.
 10362
 10363* EXEC CICS HANDLE CONDITION
 10364*        ENDFILE(1950-NOT-FOUND)
 10365*        NOTFND (1950-NOT-FOUND)
 10366*    END-EXEC.
 10367*    MOVE '"$''I                  ! * #00009956' TO DFHEIV0
 10368     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10369     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10370     MOVE X'2A20233030303039393536' TO DFHEIV0(25:11)
 10371     CALL 'kxdfhei1' USING DFHEIV0
 10372     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10373
 10374
 10375     IF PI-PROCESSOR-ID = 'LGXX'
 10376        GO TO 1240-FIND-ACCT-TOLERANCES.
 10377
 10378     MOVE 'N'                    TO FOUND-TOL-SW.
 10379     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10380     MOVE '2'                    TO CNTL-REC-TYPE.
 10381     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 10382     MOVE +0                     TO CNTL-SEQ-NO.
 10383     MOVE 'PROC'                 TO FILE-SWITCH.
 10384
 10385     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10386
 10387     MOVE CF-PROC-CALC-AMT-TOL   TO WS-PMT-TOL.
 10388     MOVE CF-PROC-MAX-REG-PMT    TO WS-MAX-PMT-TOL
 10389                                    PI-MAX-PMT-TOL.
 10390     MOVE CF-PROC-MAX-REG-DAYS   TO WS-MAX-DAYS-TOL.
 10391
 10392     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 10393         MOVE CF-PROC-MAX-REG-PMT   TO  WS-HER-MO-PMT-AMT.
 10394
 10395     MOVE CF-PROC-CALC-DAYS-TOL  TO WS-DAYS-TOL.
 10396     MOVE CF-PROC-MAX-LF-PMT     TO WS-MAX-LF-PMT-TOL
 10397                                    PI-MAX-LF-PMT-TOL.
 10398
 10399     IF CF-PROC-MAX-EXP-PMT NOT NUMERIC
 10400         MOVE ZEROS              TO CF-PROC-MAX-EXP-PMT.
 10401
 10402     MOVE CF-PROC-MAX-EXP-PMT    TO WS-MAX-EXP-PMT
 10403                                    PI-MAX-EXP-PMT.
 10404
 10405 1240-FIND-ACCT-TOLERANCES.
 10406
 10407     IF WS-PMT-TOL NOT = +0
 10408         MOVE 'Y'                TO FOUND-TOL-SW.
 10409
 10410     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10411         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 10412         MOVE CL-CURRENT-CARRIER     TO ACCT-CARRIER
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 202
* EL156.cbl
 10413         MOVE CL-CURRENT-GROUPING    TO ACCT-GROUPING
 10414         MOVE CL-CURRENT-STATE       TO ACCT-STATE
 10415         MOVE CL-CURRENT-ACCOUNT     TO ACCT-ACCOUNT
 10416         MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DT
 10417     ELSE
 10418         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 10419         MOVE PI-CARRIER             TO ACCT-CARRIER
 10420         MOVE PI-GROUPING            TO ACCT-GROUPING
 10421         MOVE PI-STATE               TO ACCT-STATE
 10422         MOVE PI-ACCOUNT             TO ACCT-ACCOUNT
 10423         MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 10424
 10425     MOVE 'ACCT'                 TO FILE-SWITCH.
 10426
 10427     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 10428     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 10429
 10430
 10431* EXEC CICS HANDLE CONDITION
 10432*         NOTFND   (1950-NOT-FOUND)
 10433*         ENDFILE  (1950-NOT-FOUND)
 10434*    END-EXEC.
 10435*    MOVE '"$I''                  ! + #00010016' TO DFHEIV0
 10436     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10437     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10438     MOVE X'2B20233030303130303136' TO DFHEIV0(25:11)
 10439     CALL 'kxdfhei1' USING DFHEIV0
 10440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10441
 10442
 10443
 10444* EXEC CICS STARTBR
 10445*        DATASET('ERACCT')
 10446*        RIDFLD (ERACCT-KEY)
 10447*        GTEQ
 10448*    END-EXEC.
 10449     MOVE 'ERACCT' TO DFHEIV1
 10450     MOVE 0
 10451       TO DFHEIV11
 10452*    MOVE '&,         G          &   #00010021' TO DFHEIV0
 10453     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10454     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10455     MOVE X'2020233030303130303231' TO DFHEIV0(25:11)
 10456     CALL 'kxdfhei1' USING DFHEIV0,
 10457           DFHEIV1,
 10458           ERACCT-KEY,
 10459           DFHEIV99,
 10460           DFHEIV11,
 10461           DFHEIV99
 10462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10463
 10464
 10465 1245-FIND-ACCT-TOLERANCES-LOOP.
 10466
 10467
 10468* EXEC CICS READNEXT
 10469*        DATASET('ERACCT')
 10470*        SET    (ADDRESS OF ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 203
* EL156.cbl
 10471*        RIDFLD (ERACCT-KEY)
 10472*    END-EXEC.
 10473     MOVE 'ERACCT' TO DFHEIV1
 10474     MOVE 0
 10475       TO DFHEIV11
 10476*    MOVE '&.S                   )   #00010029' TO DFHEIV0
 10477     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10478     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10479     MOVE X'2020233030303130303239' TO DFHEIV0(25:11)
 10480     CALL 'kxdfhei1' USING DFHEIV0,
 10481           DFHEIV1,
 10482           DFHEIV20,
 10483           DFHEIV99,
 10484           ERACCT-KEY,
 10485           DFHEIV99,
 10486           DFHEIV11,
 10487           DFHEIV99,
 10488           DFHEIV99
 10489     SET ADDRESS OF ACCOUNT-MASTER TO
 10490         DFHEIV20
 10491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10492
 10493
 10494     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 10495        IF WS-ERACCT-HOLD-RECORD = SPACES
 10496           GO TO 1950-NOT-FOUND
 10497        ELSE
 10498           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 10499           GO TO 1250-CONTINUE.
 10500
 10501     IF ACCT-EXP-DT = HIGH-VALUES
 10502        NEXT SENTENCE
 10503     ELSE
 10504        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 10505        GO TO 1245-FIND-ACCT-TOLERANCES-LOOP.
 10506
 10507 1250-CONTINUE.
 10508
 10509     MOVE AM-CONTROL-PRIMARY     TO PI-ACCT-KEY.
 10510
 10511     IF FOUND-TOL-SW = 'N'
 10512         MOVE AM-TOL-CLM         TO WS-PMT-TOL.
 10513
 10514********* 1260-FIND-STATE-TOLERANCES.
 10515
 10516     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10517     MOVE PI-STATE               TO WS-ST-ACCESS.
 10518     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 10519     MOVE '3'                    TO CNTL-REC-TYPE.
 10520     MOVE +0                     TO CNTL-SEQ-NO.
 10521     MOVE 'STAT'                 TO FILE-SWITCH.
 10522
 10523     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10524
 10525     IF WS-PMT-TOL = +0
 10526         MOVE CF-ST-TOL-CLAIM    TO WS-PMT-TOL.
 10527
 10528     MOVE CF-ST-CLAIM-REJECT-SW  TO WS-TOL-SEVERITY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 204
* EL156.cbl
 10529     MOVE CF-ST-SPLIT-PAYMENT    TO PI-SPLIT-PMT-SW.
 10530     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 10531     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 10532
 10533     IF PI-PMTTYPE      = '2'  AND
 10534        PI-SPLIT-PMT-SW = 'Y'  AND
 10535        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 10536          MOVE ER-3530                TO EMI-ERROR
 10537          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10538
 10539********* 1280-FIND-BENEFIT-TOLERANCES.
 10540
 10541     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 10542        OR (PI-PMTTYPE = '5' OR '6')
 10543         GO TO 1300-FIND-CARR-TOLERANCES.
 10544
 10545     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10546     MOVE '4'                    TO CNTL-REC-TYPE.
 10547     MOVE +0                     TO CNTL-SEQ-NO.
 10548     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 10549     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10550     MOVE 'BENE'                 TO FILE-SWITCH.
 10551
 10552     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10553
 10554     IF NO-BENEFIT-FOUND
 10555         GO TO 1950-NOT-FOUND.
 10556
 10557     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 10558     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 10559     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 10560
 10561
 10562* EXEC CICS HANDLE CONDITION
 10563*        NOTFND(1950-NOT-FOUND)
 10564*    END-EXEC.
 10565*    MOVE '"$I                   ! , #00010102' TO DFHEIV0
 10566     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10567     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10568     MOVE X'2C20233030303130313032' TO DFHEIV0(25:11)
 10569     CALL 'kxdfhei1' USING DFHEIV0
 10570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10571
 10572
 10573 1300-FIND-CARR-TOLERANCES.
 10574     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10575     MOVE '6'                    TO CNTL-REC-TYPE.
 10576
 10577     IF CONTROL-IS-ACTUAL-CARRIER
 10578         MOVE PI-CARRIER               TO WS-CARR
 10579     ELSE
 10580         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 10581
 10582     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 10583     MOVE +0                     TO CNTL-SEQ-NO.
 10584     MOVE 'CARR'                 TO FILE-SWITCH.
 10585
 10586     PERFORM 7930-READ-CONTROL   THRU 7930-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 205
* EL156.cbl
 10587
 10588     IF WS-DAYS-TOL = +0
 10589         MOVE CF-CALC-DAYS-TOL   TO WS-DAYS-TOL.
 10590
 10591     IF WS-PMT-TOL = +0
 10592         MOVE CF-CALC-AMT-TOL    TO WS-PMT-TOL.
 10593
 10594     IF WS-MAX-DAYS-TOL = +0
 10595         MOVE CF-MAX-REG-DAYS    TO WS-MAX-DAYS-TOL.
 10596
 10597     IF WS-MAX-PMT-TOL = +0
 10598         MOVE CF-MAX-REG-PMT     TO WS-MAX-PMT-TOL
 10599                                    PI-MAX-PMT-TOL.
 10600
 10601     IF WS-MAX-LF-PMT-TOL = +0
 10602        MOVE CF-MAX-REG-PMT      TO WS-MAX-LF-PMT-TOL
 10603                                    PI-MAX-LF-PMT-TOL.
 10604
 10605     MOVE CF-CLAIM-CALC-METHOD   TO WS-CALC-METHOD.
 10606
 10607********* 1320-FIND-COMP-TOLERANCES.
 10608
 10609     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10610     MOVE '1'                    TO CNTL-REC-TYPE.
 10611     MOVE SPACES                 TO CNTL-ACCESS.
 10612     MOVE +0                     TO CNTL-SEQ-NO.
 10613     MOVE 'COMP'                 TO FILE-SWITCH.
 10614
 10615     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10616
 10617     MOVE CF-CURRENT-MONTH-END   TO PI-MONTH-END-SAVE.
 10618     MOVE CF-PAYMENT-APPROVAL-SW TO PI-PMT-APPR-SW.
 10619
 10620     IF WS-PMT-TOL NOT = +0
 10621        IF WS-TOL-SEVERITY NOT = ' '
 10622         GO TO 1360-EDIT-DAYS.
 10623
 10624     IF WS-PMT-TOL = +0
 10625         MOVE CF-CO-TOL-CLAIM    TO WS-PMT-TOL.
 10626
 10627     IF WS-TOL-SEVERITY = ' '
 10628         MOVE CF-CO-CLAIM-REJECT-SW TO WS-TOL-SEVERITY.
 10629
 10630 1360-EDIT-DAYS.
 10631     IF PI-PMTTYPE NOT = '4'
 10632        IF PI-EDAYS NEGATIVE OR
 10633           PI-EPYAMT NEGATIVE
 10634          MOVE ER-0513             TO EMI-ERROR
 10635          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10636          MOVE -1                  TO PMTTYPEL.
 10637
 10638     IF PI-PMTTYPE = '5' OR '6'
 10639        GO TO 1380-EDIT-EXPENSE-PMT-AMT.
 10640
 10641     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10642        IF PI-PMTTYPE = '4'
 10643          MOVE PI-EDAYS          TO PI-CDAYS.
 10644
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 206
* EL156.cbl
 10645     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10646         GO TO 1440-COMPUTE-LIFE-REMAINING.
 10647
 10648     IF PI-PMTTYPE = '4'
 10649        MOVE PI-EDAYS            TO PI-CDAYS
 10650        GO TO 1400-EDIT-PAYMENT.
 10651
 10652     IF LOW-VALUES = PI-CPYFROM OR PI-CPYTHRU
 10653        GO TO 1500-EDIT-EXPENSES.
 10654
 10655*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10656*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1 AND
 10657*          CM-AH-BENEFIT-CD = '23'              AND
 10658*          CL-CERT-STATE    = '04'              AND
 10659*         (PI-PMTTYPE = '1' OR '2' OR '3')
 10660*            PERFORM 3200-CALC-AIG-DAYS THRU 3299-EXIT
 10661*            GO TO 1362-CHECK-MAX-DAYS.
 10662
 10663     IF PI-EDAYS = ZEROS
 10664*        IF PI-COMPANY-ID = 'DMD'
 10665*            MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 10666*            MOVE -1             TO DC-ELAPSED-DAYS
 10667*            MOVE ZEROS          TO DC-ELAPSED-MONTHS
 10668*            MOVE '6'            TO DC-OPTION-CODE
 10669*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10670*            MOVE DC-BIN-DATE-2  TO DC-BIN-DATE-1
 10671*            MOVE WS-SV-EPYTHRU  TO DC-BIN-DATE-2
 10672*            MOVE '1'            TO DC-OPTION-CODE
 10673*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10674*            IF NO-CONVERSION-ERROR
 10675*                COMPUTE PI-EDAYS = DC-ELAPSED-MONTHS * 30
 10676*                                 + DC-ODD-DAYS-OVER
 10677*               MOVE 6           TO EDAYSL
 10678*               MOVE AL-UNNON    TO EDAYSA
 10679*            ELSE
 10680*                NEXT SENTENCE
 10681*       ELSE
 10682            MOVE WS-SV-EPYFROM   TO DC-BIN-DATE-1
 10683            MOVE WS-SV-EPYTHRU   TO DC-BIN-DATE-2
 10684            MOVE '1'             TO DC-OPTION-CODE
 10685            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10686            IF NO-CONVERSION-ERROR
 10687                MOVE DC-ELAPSED-DAYS  TO PI-EDAYS
 10688                ADD 1                 TO PI-EDAYS
 10689                MOVE AL-UNNON         TO EDAYSA.
 10690
 10691*    IF PI-COMPANY-ID = 'DMD'
 10692*        MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 10693*        MOVE -1                 TO DC-ELAPSED-DAYS
 10694*        MOVE ZEROS              TO DC-ELAPSED-MONTHS
 10695*        MOVE '6'                TO DC-OPTION-CODE
 10696*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10697*        MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 10698*        MOVE PI-CPYTHRU         TO DC-BIN-DATE-2
 10699*        MOVE '1'                TO DC-OPTION-CODE
 10700*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10701*    ELSE
 10702         MOVE PI-CPYFROM         TO DC-BIN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 207
* EL156.cbl
 10703         MOVE PI-CPYTHRU         TO DC-BIN-DATE-2.
 10704         MOVE '1'                TO DC-OPTION-CODE.
 10705         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10706
 10707     IF NO-CONVERSION-ERROR
 10708        IF PI-COMPANY-ID = 'DMD'
 10709            COMPUTE PI-CDAYS = DC-ELAPSED-MONTHS * 30
 10710                             + DC-ODD-DAYS-OVER
 10711        ELSE
 10712            MOVE DC-ELAPSED-DAYS TO PI-CDAYS
 10713            ADD 1                TO PI-CDAYS.
 10714
 10715     IF DC-ODD-DAYS-OVER NOT = ZEROS
 10716        MOVE DC-ELAPSED-MONTHS   TO EXPENSE-MONTH-SAVE
 10717        ADD 1                    TO EXPENSE-MONTH-SAVE.
 10718
 10719     IF PI-EDAYS NOT NUMERIC
 10720         MOVE ER-0491            TO EMI-ERROR
 10721         GO TO 1370-DAYS-ERROR.
 10722
 10723     IF CL-NO-OF-PMTS-MADE = 0
 10724        AND PI-COMPANY-ID = 'CID'
 10725        AND CL-CERT-STATE = 'MI'
 10726        AND (CM-AH-BENEFIT-CD = '20' OR '21' OR '22' OR '23')
 10727            PERFORM 1390-CHECK-PAYMENT-DAYS THRU 1390-EXIT
 10728     END-IF.
 10729
 10730 1362-CHECK-MAX-DAYS.
 10731
 10732     IF WS-MAX-DAYS-TOL = +999
 10733         GO TO 1365-SKIP-MAX-DAYS-EDIT.
 10734
 10735     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 10736         IF PI-EDAYS = ZEROS
 10737             COMPUTE WS-PMT-MOS ROUNDED = (PI-CDAYS / +30) + .005
 10738         ELSE
 10739             COMPUTE WS-PMT-MOS ROUNDED = (PI-EDAYS / +30) + .005.
 10740
 10741     IF WS-MAX-DAYS-TOL NOT = ZERO
 10742        IF PI-EDAYS > WS-MAX-DAYS-TOL OR
 10743           PI-CDAYS > WS-MAX-DAYS-TOL
 10744             MOVE ER-0492          TO EMI-ERROR
 10745             GO TO 1370-DAYS-ERROR.
 10746
 10747 1365-SKIP-MAX-DAYS-EDIT.
 10748     IF PI-EDAYS = ZEROS
 10749        GO TO 1400-EDIT-PAYMENT.
 10750
 10751     IF WS-DAYS-TOL NOT = ZERO
 10752        IF ((PI-CDAYS - WS-DAYS-TOL) > PI-EDAYS) OR
 10753           ((PI-CDAYS + WS-DAYS-TOL) < PI-EDAYS)
 10754                MOVE ER-0493     TO EMI-ERROR
 10755                GO TO 1370-DAYS-ERROR.
 10756
 10757     GO TO 1400-EDIT-PAYMENT.
 10758
 10759 1370-DAYS-ERROR.
 10760     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 208
* EL156.cbl
 10761
 10762     IF EMI-MESSAGE-FORMATTED
 10763         MOVE -1                 TO EDAYSL
 10764         MOVE AL-UABON           TO EDAYSA.
 10765
 10766     GO TO 1400-EDIT-PAYMENT.
 10767
 10768 1380-EDIT-EXPENSE-PMT-AMT.
 10769     IF PI-PMTTYPE = '5' OR '6'
 10770         NEXT SENTENCE
 10771     ELSE
 10772         GO TO 1400-EDIT-PAYMENT.
 10773
 10774     IF WS-MAX-EXP-PMT NOT = ZEROS
 10775        IF PI-EPYAMT > WS-MAX-EXP-PMT
 10776            MOVE ER-3529            TO EMI-ERROR
 10777            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 10778
 10779     GO TO 1500-EDIT-EXPENSES.
 10780
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 209
* EL156.cbl
 10782
 10783 1390-CHECK-PAYMENT-DAYS.
 10784
 10785     IF PI-EDAYS = 0
 10786         MOVE PI-CDAYS TO WS-PD-DAYS
 10787     ELSE
 10788         MOVE PI-EDAYS TO WS-PD-DAYS
 10789     END-IF.
 10790
 10791     IF CM-AH-BENEFIT-CD = '20' OR '21'
 10792         IF WS-PD-DAYS = 14
 10793            GO TO 1390-EXIT
 10794         END-IF
 10795     END-IF.
 10796
 10797     IF WS-PD-DAYS < 30
 10798         MOVE ER-3549              TO EMI-ERROR
 10799         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 10800     END-IF.
 10801
 10802 1390-EXIT.
 10803      EXIT.
 10804
 10805 1400-EDIT-PAYMENT.
 10806*    IF PI-COMPANY-ID = 'DMD'
 10807*       IF CL-CERT-NO (5:2) = '69' OR '70'
 10808*           PERFORM 6500-READ-DLO035 THRU 6500-EXIT.
 10809
 10810     IF PI-PMTTYPE NOT = '4'
 10811        GO TO 1405-CALC-PAYMENT.
 10812
 10813     IF PI-EDAYS NOT NUMERIC
 10814         MOVE PI-EPYAMT           TO PI-CPYAMT
 10815         MOVE SPACES              TO PI-SPECIAL-BEN-SW
 10816         GO TO 1430-CHECK-AH-TOLERANCE.
 10817
 10818*    IF PI-COMPANY-ID = 'FIA'
 10819*       IF CERT-ACCOUNT = '0000011043'
 10820*        COMPUTE PI-DAILY-RATE ROUNDED =
 10821*                      (CM-AH-BENEFIT-AMT * 13) / 365
 10822*        COMPUTE PI-CPYAMT ROUNDED =
 10823*                          PI-DAILY-RATE * PI-EDAYS
 10824*        MOVE SPACES TO PI-SPECIAL-BEN-SW
 10825*        GO TO 1430-CHECK-AH-TOLERANCE.
 10826
 10827     IF WS-CALC-METHOD = '1' OR '4' OR '6'
 10828         COMPUTE PI-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 10829         COMPUTE PI-CPYAMT     ROUNDED = PI-DAILY-RATE * PI-EDAYS
 10830         GO TO 1420-CHECK-AIG-BENEFIT.
 10831
 10832     IF WS-CALC-METHOD = '2' OR  '5'
 10833         COMPUTE PI-DAILY-RATE ROUNDED =
 10834                        (CM-AH-BENEFIT-AMT * 12) / 365
 10835         COMPUTE PI-CPYAMT ROUNDED =
 10836                           PI-DAILY-RATE * PI-EDAYS
 10837        GO TO 1420-CHECK-AIG-BENEFIT.
 10838
 10839     IF WS-CALC-METHOD = '3'
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 210
* EL156.cbl
 10840         COMPUTE PI-DAILY-RATE =
 10841                         (CM-AH-BENEFIT-AMT * 12) / 365
 10842         COMPUTE PI-CPYAMT ROUNDED =
 10843                           PI-DAILY-RATE * PI-EDAYS
 10844        GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 211
* EL156.cbl
 10846*    SAMPLE DATE RANGES AND DAYS PAID FOR OPTION 1 AND 6
 10847
 10848****************************************************************
 10849****************************************************************
 10850*                  CALCULATED FROM      PAYMENT      PAYMENT
 10851*   DATES           DATE ROUTINE        OPT  1       OPT  6
 10852* FROM    THRU    MONTHS ODD ELAPSED   DAYS-PAID    DAYS-PAID
 10853*1-01-83  1-15-83    0    15     15        15           15
 10854*1-01-83  1-30-83    0    30     30        30           30
 10855*1-01-83  1-31-83    1     0     31        30           30
 10856*1-01-83  2-01-83    1     1     32        31           31
 10857*1-01-83  2-15-83    1    15     46        45           45
 10858*1-01-83  2-28-83    2     0     59        60           60
 10859*1-01-83  3-01-83    2     1     60        61           61
 10860*1-01-83  3-31-83    3     0     90        90           90
 10861*1-15-83  1-31-83    0    17     17        17           16
 10862*1-15-83  2-01-83    0    18     18        18           17
 10863*1-15-83  2-28-83    1    14     45        44           46
 10864*1-21-83  3-09-83    1    20     48        50           49
 10865*2-05-83  3-06-83    1     2     30        32           32
 10866*2-05-83  3-23-83    1    19     47        49           49
 10867*2-15-83  2-28-83    0    14     14        14           16
 10868*2-15-83  3-01-83    0    15     15        15           17
 10869*2-21-83  3-19-83    0    27     27        27           29
 10870*2-21-83  3-20-83    1     0     28        30           30
 10871*2-21-83  4-10-83    1    18     49        30           50
 10872*2-21-83  5-19-83    2    27     88        87           89
 10873*2-21-83  5-22-83    3     2     91        92           92
 10874*3-21-83  5-19-83    1    30     60        60           59
 10875****************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 212
* EL156.cbl
 10877 1405-CALC-PAYMENT.
 10878     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 10879     MOVE ' '                    TO DC-OPTION-CODE.
 10880     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10881     MOVE DC-DAYS-IN-MONTH       TO FROM-DAYS-IN-MONTH.
 10882     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-FROM.
 10883
 10884     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 10885     MOVE ' '                    TO DC-OPTION-CODE.
 10886     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10887     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-THRU.
 10888     MOVE DC-DAYS-IN-MONTH       TO THRU-DAYS-IN-MONTH.
 10889
 10890     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 10891     MOVE -1                     TO DC-ELAPSED-DAYS.
 10892     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 10893     MOVE '6'                    TO DC-OPTION-CODE.
 10894     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10895     MOVE DC-DAYS-IN-MONTH       TO SAVE1-FROM-DAYS-IN-MONTH.
 10896
 10897     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 10898     MOVE PI-CPYTHRU             TO DC-BIN-DATE-2.
 10899     MOVE '1'                    TO DC-OPTION-CODE.
 10900     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10901
 10902     MOVE DC-ELAPSED-MONTHS      TO SAVE-ELAPSED-MONTHS.
 10903     MOVE DC-ODD-DAYS-OVER       TO SAVE-ODD-DAYS-OVER.
 10904     MOVE DC-ELAPSED-DAYS        TO SAVE-ELAPSED-DAYS.
 10905
 10906******************************************************************
 10907*   THE FOLLOWING STATEMENT ADJUSTS THE ODD DAYS OVER BY THE     *
 10908*     DIFFERENCE BETWEEN DAYS IN MONTH (FROM MONTH) AND          *
 10909*     DAYS IN MONTH (ONE MONTH PRIOR TO THRU MONTH)              *
 10910******************************************************************
 10911
 10912     IF WS-CALC-METHOD = '1'           AND
 10913        DC-ELAPSED-MONTHS > ZERO AND
 10914        DC-ODD-DAYS-OVER NOT = ZEROS   AND
 10915        WDF-DAY > WDT-DAY
 10916          MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 10917          MOVE ZEROS               TO DC-ELAPSED-DAYS
 10918          MOVE -1                  TO DC-ELAPSED-MONTHS
 10919          MOVE '6'                 TO DC-OPTION-CODE
 10920          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10921          MOVE DC-DAYS-IN-MONTH    TO SAVE1-THRU-DAYS-IN-MONTH
 10922          COMPUTE WS-SAVE-ODD-DAYS =
 10923          (SAVE1-THRU-DAYS-IN-MONTH - SAVE1-FROM-DAYS-IN-MONTH)
 10924          ADD WS-SAVE-ODD-DAYS     TO SAVE-ODD-DAYS-OVER.
 10925
 10926     MOVE SAVE-ELAPSED-MONTHS    TO DC-ELAPSED-MONTHS.
 10927     MOVE SAVE-ODD-DAYS-OVER     TO DC-ODD-DAYS-OVER
 10928     MOVE SAVE-ELAPSED-DAYS      TO DC-ELAPSED-DAYS.
 10929
 10930     MOVE SAVE-ELAPSED-MONTHS TO PI-SAVE-ELAPSED-MONTHS.
 10931     MOVE SAVE-ODD-DAYS-OVER  TO PI-SAVE-ODD-DAYS-OVER.
 10932
 10933*    IF PI-COMPANY-ID = 'FIA'
 10934*       IF CERT-ACCOUNT = '0000011043'
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 213
* EL156.cbl
 10935*        COMPUTE PI-DAILY-RATE ROUNDED =
 10936*                          (CM-AH-BENEFIT-AMT * 13) / 365
 10937*        COMPUTE PI-CPYAMT ROUNDED =
 10938*                          PI-DAILY-RATE * DC-ELAPSED-DAYS
 10939*        GO TO 1420-CHECK-AIG-BENEFIT.
 10940
 10941*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10942*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1  AND
 10943*          CM-AH-BENEFIT-CD = '23'               AND
 10944*          CL-CERT-STATE    = '04'               AND
 10945*         (PI-PMTTYPE = '1' OR '2' OR '3')
 10946*            COMPUTE WS-DAILY-RATE ROUNDED =
 10947*                               CM-AH-BENEFIT-AMT / 30
 10948*            COMPUTE PI-CPYAMT ROUNDED =
 10949*                               (WS-DAILY-RATE * PI-CDAYS)
 10950*            MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 10951*            GO TO 1420-CHECK-AIG-BENEFIT.
 10952
 10953     IF WS-CALC-METHOD = '1'
 10954         COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 10955         COMPUTE PI-CPYAMT ROUNDED =
 10956             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 10957             (WS-DAILY-RATE     * DC-ODD-DAYS-OVER)
 10958         MOVE WS-DAILY-RATE    TO PI-DAILY-RATE
 10959         GO TO 1420-CHECK-AIG-BENEFIT.
 10960
 10961     IF WS-CALC-METHOD = '2'
 10962         COMPUTE PI-DAILY-RATE ROUNDED =
 10963                          (CM-AH-BENEFIT-AMT * 12) / 365
 10964         COMPUTE PI-CPYAMT ROUNDED =
 10965             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 10966             (PI-DAILY-RATE     * DC-ODD-DAYS-OVER)
 10967         GO TO 1420-CHECK-AIG-BENEFIT.
 10968
 10969     IF WS-CALC-METHOD = '4'
 10970         MOVE CM-AH-BENEFIT-AMT   TO  WS-AH-BEN-AMT
 10971         COMPUTE WS-DAILY-RATE ROUNDED = (WS-AH-BEN-AMT / 30)
 10972         MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 10973         COMPUTE PI-CPYAMT ROUNDED =
 10974                           WS-DAILY-RATE * DC-ELAPSED-DAYS
 10975         GO TO 1420-CHECK-AIG-BENEFIT.
 10976
 10977     IF WS-CALC-METHOD = '5'
 10978         COMPUTE PI-DAILY-RATE ROUNDED =
 10979                            (CM-AH-BENEFIT-AMT * 12) / 365
 10980         COMPUTE PI-CPYAMT ROUNDED =
 10981                           PI-DAILY-RATE * DC-ELAPSED-DAYS
 10982         GO TO 1420-CHECK-AIG-BENEFIT.
 10983
 10984     IF WS-CALC-METHOD NOT = '3'
 10985        GO TO 1410-CHECK-PAYMENT.
 10986
 10987******   CALCULATION METHOD  3  ROUTINE
 10988     COMPUTE PI-DAILY-RATE =
 10989                 CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH.
 10990
 10991******CHECK TO SEE IF WITHIN SAME MONTH
 10992     IF (WDF-MONTH = WDT-MONTH) AND (WDF-YEAR = WDT-YEAR)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 214
* EL156.cbl
 10993        COMPUTE PI-CPYAMT ROUNDED = SAVE-ELAPSED-DAYS    *
 10994                     (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)
 10995         GO TO 1420-CHECK-AIG-BENEFIT.
 10996
 10997******CHECK TO SEE IF EVEN MONTHS AND NO ODD DAYS
 10998     IF SAVE-ELAPSED-MONTHS NOT = ZEROS   AND
 10999             SAVE-ODD-DAYS-OVER = ZEROS
 11000      COMPUTE PI-CPYAMT  ROUNDED =
 11001                  CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS
 11002      GO TO 1420-CHECK-AIG-BENEFIT.
 11003
 11004******BUMP THE FROM DATE WITH THE NUMBER OF MONTHS
 11005******AND FIND THE NUMBER OF DAYS LEFT IN THIS MONTH.
 11006     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11007        ADD SAVE-ELAPSED-MONTHS  TO WDF-MONTH
 11008        IF WDF-MONTH > 12
 11009           ADD 1                 TO WDF-YEAR
 11010           SUBTRACT 12         FROM WDF-MONTH.
 11011
 11012******CONVERT THE NEW FROM MONTH TO BINARY
 11013     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11014        MOVE WORK-DATE-FROM   TO DC-GREG-DATE-1-MDY
 11015        MOVE '4'              TO DC-OPTION-CODE
 11016        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11017        MOVE DC-DAYS-IN-MONTH TO FROM-DAYS-IN-MONTH.
 11018
 11019     IF WDF-MONTH = WDT-MONTH AND
 11020        WDF-YEAR  = WDT-YEAR
 11021          COMPUTE PI-CPYAMT ROUNDED = ((WDT-DAY  -  WDF-DAY)  *
 11022                    (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)) +
 11023                    (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS)
 11024        ELSE
 11025          COMPUTE FROM-PMT-DAYS = FROM-DAYS-IN-MONTH - WDF-DAY
 11026          MOVE WDT-DAY              TO THRU-PMT-DAYS
 11027          COMPUTE PI-CPYAMT ROUNDED =
 11028       (FROM-PMT-DAYS * (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH))
 11029       +
 11030       (THRU-PMT-DAYS * (CM-AH-BENEFIT-AMT / THRU-DAYS-IN-MONTH))
 11031       +
 11032       (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS).
 11033
 11034     GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 215
* EL156.cbl
 11036 1410-CHECK-PAYMENT.
 11037******PAYMENT OPTION 6
 11038******CHECK TO SEE IF LESS THAN 1 MONTH AND WITHIN SAME MONTH
 11039     IF SAVE-ELAPSED-MONTHS > ZERO
 11040        IF SAVE-ODD-DAYS-OVER = ZEROS
 11041           GO TO 1412-CHECK-TO-DAY
 11042        ELSE
 11043           IF WDF-DAY > WDT-DAY
 11044              IF WDF-MONTH = 02
 11045                  PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 11046                  ADD 2  TO  SAVE-ODD-DAYS-OVER
 11047                  GO TO 1412-CHECK-TO-DAY
 11048              ELSE
 11049                  IF FROM-DAYS-IN-MONTH = 31
 11050                     SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER
 11051                     GO TO 1412-CHECK-TO-DAY
 11052                  ELSE
 11053                     GO TO 1412-CHECK-TO-DAY
 11054           ELSE
 11055               GO TO 1412-CHECK-TO-DAY.
 11056
 11057     IF WDF-MONTH NOT = WDT-MONTH
 11058        IF WDF-MONTH = 02
 11059           PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 11060           IF WDF-DAY = 29
 11061              ADD 1              TO SAVE-ODD-DAYS-OVER
 11062           ELSE
 11063              ADD 2              TO SAVE-ODD-DAYS-OVER
 11064        ELSE
 11065           IF FROM-DAYS-IN-MONTH = 31
 11066              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 11067
 11068 1412-CHECK-TO-DAY.
 11069        IF WDT-MONTH = 02 AND SAVE-ODD-DAYS-OVER NOT = 0
 11070           IF WDT-DAY = 28
 11071              ADD 2              TO SAVE-ODD-DAYS-OVER
 11072           ELSE
 11073              IF WDT-DAY = 29
 11074                 ADD 1           TO SAVE-ODD-DAYS-OVER
 11075              ELSE
 11076                 NEXT SENTENCE
 11077        ELSE
 11078           IF WDT-DAY = 31 AND SAVE-ODD-DAYS-OVER NOT = 0
 11079              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 11080
 11081     COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30.
 11082     MOVE WS-DAILY-RATE          TO PI-DAILY-RATE.
 11083     COMPUTE PI-CPYAMT ROUNDED =
 11084         (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS) +
 11085         (WS-DAILY-RATE     * SAVE-ODD-DAYS-OVER).
 11086
 11087     GO TO 1420-CHECK-AIG-BENEFIT.
 11088
 11089 1415-CHECK-LEAP-YEAR.
 11090     IF FROM-DAYS-IN-MONTH = 29
 11091        SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER.
 11092
 11093 1415-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 216
* EL156.cbl
 11094     EXIT.
 11095
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 217
* EL156.cbl
 11097 1420-CHECK-AIG-BENEFIT.
 11098
 11099     IF WS-SPECIAL-CALC-CD = 'Q'
 11100         GO TO 1425-CHECK-WHOLE-MONTH.
 11101
 11102*    IF (PI-COMPANY-ID = 'AIG' OR 'AUK')   AND
 11103*       (CM-AH-BENEFIT-CD = '63' OR '66')  AND
 11104*       (CL-NO-OF-PMTS-MADE < +6)          AND
 11105*       (PI-PMTTYPE = '1' OR '2')
 11106*        NEXT SENTENCE
 11107*    ELSE
 11108         MOVE SPACES TO PI-SPECIAL-BEN-SW.
 11109         GO TO 1430-CHECK-AH-TOLERANCE.
 11110
 11111******************AIG LOGIC STARTS**********************
 11112*    MOVE 'Y'          TO PI-SPECIAL-BEN-SW.
 11113*    COMPUTE PI-CPYAMT = PI-CPYAMT * 1.5.
 11114*    MOVE ER-3533      TO EMI-ERROR.
 11115*    PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11116*    GO TO 1430-CHECK-AH-TOLERANCE.
 11117******************AIG LOGIC ENDS************************
 11118
 11119 1425-CHECK-WHOLE-MONTH.
 11120******************************************************************
 11121****    THIS PARAGRAPH COMPUTES THE 1ST PAYMENT FOR WHOLE     ****
 11122****    MONTH DISABILITY CLAIMS.  THE PROCESS IS AS FOLLOWS:  ****
 11123****      1.  IF THE PERIOD BEING PAID IS THE RETRO PERIOD    ****
 11124****          A WHOLE MONTHS BENEFIT IS PAID.                 ****
 11125****      2.  IF MORE THAN THE RETRO PERIOD IS BEING PAID THE ****
 11126****          ADDITIONAL DAYS MUST BE IN WHOLE CALENDAR       ****
 11127****          MONTHS.  PAYMENT = 1 MONTH (RETRO               ****
 11128****          PERIOD) + NUMBER OF ADDITIONAL MONTHS BEING     ****
 11129****          PAID * MONTHLY BENEFIT.                         ****
 11130******************************************************************
 11131
 11132     MOVE SPACES                     TO  PI-SPECIAL-BEN-SW.
 11133
 11134     IF CL-NO-OF-PMTS-MADE > +0
 11135         GO TO 1425-CONT-WHOLE-MONTH-PMTS.
 11136
 11137     IF PI-CDAYS < WS-BEN-DAYS
 11138         GO TO 1430-CHECK-AH-TOLERANCE.
 11139
 11140     IF PI-CDAYS = WS-BEN-DAYS
 11141         MOVE CM-AH-BENEFIT-AMT      TO  PI-CPYAMT
 11142         GO TO 1430-CHECK-AH-TOLERANCE.
 11143
 11144*    IF PI-COMPANY-ID = 'ACM'
 11145*       NEXT SENTENCE
 11146*    ELSE
 11147        GO TO 1425-NOT-ACM-W15C.
 11148
 11149*    MOVE PI-CPYFROM             TO  DC-BIN-DATE-1.
 11150*    MOVE -1                     TO  DC-ELAPSED-DAYS.
 11151*    MOVE +0                     TO  DC-ELAPSED-MONTHS.
 11152*    MOVE '6'                    TO  DC-OPTION-CODE.
 11153*    PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11154*    IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 218
* EL156.cbl
 11155*       MOVE DC-BIN-DATE-2       TO  DC-BIN-DATE-1
 11156*       MOVE PI-CPYTHRU          TO  DC-BIN-DATE-2
 11157*       MOVE '1'                 TO  DC-OPTION-CODE
 11158*       MOVE +0                  TO  DC-ELAPSED-DAYS
 11159*       MOVE +0                  TO  DC-ELAPSED-MONTHS
 11160*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11161*       IF NO-CONVERSION-ERROR
 11162*          IF (DC-ELAPSED-MONTHS > +0) OR
 11163*             (DC-ELAPSED-DAYS NOT < WS-BEN-DAYS)
 11164*             NEXT SENTENCE
 11165*          ELSE
 11166*             MOVE +0            TO  PI-CPYAMT
 11167*             MOVE ER-0846       TO  EMI-ERROR
 11168*             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11169*             GO TO 1430-CHECK-AH-TOLERANCE
 11170*       ELSE
 11171*           MOVE ER-0846         TO  EMI-ERROR
 11172*           PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11173*           GO TO 1430-CHECK-AH-TOLERANCE.
 11174*
 11175*    IF DC-ODD-DAYS-OVER NOT < WS-BEN-DAYS
 11176*       ADD +1 TO DC-ELAPSED-MONTHS.
 11177*
 11178*    COMPUTE PI-CPYAMT ROUNDED =
 11179*                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 11180*
 11181*    GO TO 1430-CHECK-AH-TOLERANCE.
 11182
 11183 1425-NOT-ACM-W15C.
 11184
 11185     MOVE PI-CPYFROM                 TO  DC-BIN-DATE-1.
 11186     MOVE '6'                        TO  DC-OPTION-CODE.
 11187     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 11188     COMPUTE DC-ELAPSED-DAYS = WS-BEN-DAYS - 1.
 11189
 11190     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11191     IF NO-CONVERSION-ERROR
 11192         MOVE DC-BIN-DATE-2          TO  DC-BIN-DATE-1
 11193     ELSE
 11194         MOVE ER-0846                TO  EMI-ERROR
 11195         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11196         GO TO 1430-CHECK-AH-TOLERANCE.
 11197
 11198     MOVE PI-CPYTHRU                 TO  DC-BIN-DATE-2.
 11199     MOVE '1'                        TO  DC-OPTION-CODE.
 11200     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 11201     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11202     IF NO-CONVERSION-ERROR
 11203         IF DC-ODD-DAYS-OVER = +0
 11204             NEXT SENTENCE
 11205         ELSE
 11206             MOVE ER-0846            TO  EMI-ERROR
 11207             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11208             GO TO 1430-CHECK-AH-TOLERANCE
 11209     ELSE
 11210         MOVE ER-0846                TO  EMI-ERROR
 11211         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11212         GO TO 1430-CHECK-AH-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 219
* EL156.cbl
 11213
 11214     COMPUTE PI-CPYAMT ROUNDED = CM-AH-BENEFIT-AMT +
 11215         (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS).
 11216
 11217     GO TO 1430-CHECK-AH-TOLERANCE.
 11218
 11219 1425-CONT-WHOLE-MONTH-PMTS.
 11220******************************************************************
 11221****    WHOLE MONTH DISABILITY EDIT.  IN ORDER TO QUALIFY     ****
 11222****    FOR A PAYMENT TO BE MADE THE PAYMENT PERIOD MUST      ****
 11223****    BE IN CALENDAR MONTH INCREMENTS.                      ****
 11224******************************************************************
 11225
 11226     IF PI-COMPANY-ID = 'ACM'
 11227        NEXT SENTENCE
 11228     ELSE
 11229        IF DC-ODD-DAYS-OVER = +0
 11230            NEXT SENTENCE
 11231        ELSE
 11232            MOVE ER-0845            TO  EMI-ERROR
 11233            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11234            GO TO 1430-CHECK-AH-TOLERANCE.
 11235
 11236     COMPUTE PI-CPYAMT ROUNDED =
 11237                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 11238
 11239 1430-CHECK-AH-TOLERANCE.
 11240     IF PI-PMT-APPR-SW = 'G'
 11241         GO TO 1430-CONT-CHECK-AH-TOLERANCE.
 11242
 11243*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11244*        COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL * WS-PMT-MOS
 11245*        MOVE WS-MAX-PMT-TOL         TO  PI-MAX-PMT-TOL.
 11246*
 11247*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11248*      IF WDF-MONTH = 02
 11249*        IF SAVE-ELAPSED-MONTHS = 0
 11250*          NEXT SENTENCE
 11251*        ELSE
 11252*          IF SAVE-ODD-DAYS-OVER > 0
 11253*            MOVE +0                     TO  WS-MAX-PMT-TOL
 11254*            COMPUTE WS-PMT-MOS ROUNDED =
 11255*                (SAVE-ODD-DAYS-OVER / +30) + .005
 11256*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 11257*                                     WS-PMT-MOS
 11258*            COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL +
 11259*                (WS-HER-MO-PMT-AMT * SAVE-ELAPSED-MONTHS)
 11260*          ELSE
 11261*            MOVE +0                     TO  WS-MAX-PMT-TOL
 11262*            MOVE SAVE-ELAPSED-MONTHS    TO  WS-PMT-MOS
 11263*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 11264*                                     WS-PMT-MOS.
 11265
 11266     IF WS-MAX-PMT-TOL NOT = ZERO
 11267        IF (PI-EPYAMT > WS-MAX-PMT-TOL) OR
 11268           (PI-CPYAMT > WS-MAX-PMT-TOL)
 11269            MOVE ER-0494         TO  EMI-ERROR
 11270            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 220
* EL156.cbl
 11271            GO TO 1500-EDIT-EXPENSES.
 11272
 11273 1430-CONT-CHECK-AH-TOLERANCE.
 11274
 11275     IF PI-EPYAMT = ZEROS OR   PI-EPYAMT NEGATIVE
 11276        GO TO 1500-EDIT-EXPENSES.
 11277
 11278     IF CM-O-B-COVERAGE
 11279        GO TO 1500-EDIT-EXPENSES.
 11280
 11281     IF PI-COMPANY-ID = 'NCL'
 11282       IF FOUND-TOL-SW = 'Y'
 11283         IF WS-PMT-TOL NOT = ZERO
 11284           IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT) OR
 11285              ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 11286                  MOVE PI-PMTNOTE1 TO WS-NCL-PMT-OPTION
 11287                  IF WS-NCL-PMT-OPTION = SPACES
 11288                      MOVE ER-0699 TO EMI-ERROR
 11289                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11290                  ELSE
 11291                  IF WS-NCL-PMT-OPTION ALPHABETIC-UPPER
 11292                      NEXT SENTENCE
 11293                  ELSE
 11294                  IF NOT WS-VALID-NCL-OPTION
 11295                      MOVE ER-0699 TO EMI-ERROR
 11296                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11297
 11298     IF WS-PMT-TOL NOT = ZERO
 11299        IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT) OR
 11300           ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 11301                MOVE ER-0495     TO EMI-ERROR
 11302                PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11303
 11304     GO TO 1500-EDIT-EXPENSES.
 11305
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 221
* EL156.cbl
 11307 1440-COMPUTE-LIFE-REMAINING.
 11308
 11309     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11310        IF PI-PMTTYPE = '4'
 11311          MOVE PI-EPYAMT TO PI-CPYAMT
 11312          GO TO 1460-TEST-TYPE.
 11313
 11314     IF WS-LF-COVERAGE-TYPE = 'L'
 11315        COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT
 11316                          - CL-TOTAL-PAID-AMT
 11317        GO TO 1450-CHECK-MAX.
 11318
 11319     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 11320        PI-LF-COVERAGE-TYPE = 'P'
 11321          COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT -
 11322                              CM-LF-ITD-DEATH-AMT
 11323          GO TO 1450-CHECK-MAX.
 11324
 11325     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 11326     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 11327     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 11328     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 11329     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 11330     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 11331     MOVE '4'                    TO CP-REM-TERM-METHOD.
 11332     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 11333     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 11334
 11335     PERFORM 9800-LINK-REM-TERM.
 11336
 11337     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 11338     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 11339     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 11340     MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT.
 11341     MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT.
 11342     MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM.
 11343     MOVE CM-LOAN-APR            TO CP-LOAN-APR.
 11344     MOVE CM-LOAN-TERM           TO CP-LOAN-TERM.
 11345     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY.
 11346     MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV.
 11347     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 11348     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 11349     MOVE CM-RATE-CLASS          TO CP-CLASS-CODE
 11350     MOVE CM-LF-BENEFIT-CD       TO CP-BENEFIT-CD.
 11351     MOVE CM-PMT-EXTENSION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 11352     MOVE 'Y'                    TO CP-LF-CLAIM-CALC-SW.
 11353
 11354
 11355* EXEC CICS LINK
 11356*       PROGRAM  (LINK-REMAMT)
 11357*       COMMAREA (CALCULATION-PASS-AREA)
 11358*       LENGTH   (CP-COMM-LENGTH)
 11359*    END-EXEC.
 11360*    MOVE '."C                   ''   #00010887' TO DFHEIV0
 11361     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 11362     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11363     MOVE X'2020233030303130383837' TO DFHEIV0(25:11)
 11364     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 222
* EL156.cbl
 11365           LINK-REMAMT,
 11366           CALCULATION-PASS-AREA,
 11367           CP-COMM-LENGTH,
 11368           DFHEIV99,
 11369           DFHEIV99,
 11370           DFHEIV99
 11371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11372
 11373
 11374     COMPUTE PI-CPYAMT = CP-REMAINING-AMT - CL-TOTAL-PAID-AMT.
 11375
 11376     MOVE ' '                    TO CP-LF-CLAIM-CALC-SW.
 11377     MOVE CP-SCNP-6MO-AMT        TO PI-MO-BEN-AMT.
 11378
 11379     IF PI-COMPANY-ID = 'BOA' AND
 11380        PI-PMTTYPE    = '2'   AND
 11381        PI-OFFLINE    = 'N'
 11382           GO TO 1441-COMPUTE-BOA-INTEREST.
 11383
 11384     IF PI-COMPANY-ID = 'NCL' AND
 11385        PI-PMTTYPE    = '2'   AND
 11386        PI-OFFLINE    = 'N'
 11387          GO TO 1442-COMPUTE-NCL-INTEREST
 11388       ELSE
 11389          GO TO 1445-CONTINUE.
 11390
 11391 1441-COMPUTE-BOA-INTEREST.
 11392     MOVE +0             TO WS-CALC-INT.
 11393
 11394     MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 11395     MOVE WS-TODAY-DATE  TO DC-BIN-DATE-2.
 11396     MOVE +0             TO DC-ELAPSED-MONTHS
 11397                            DC-ELAPSED-DAYS.
 11398     MOVE '1'            TO DC-OPTION-CODE.
 11399     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11400     IF NO-CONVERSION-ERROR
 11401         NEXT SENTENCE
 11402     ELSE
 11403         GO TO 1445-CONTINUE.
 11404
 11405     IF (PI-INT-RATE NOT > ZEROS)  AND
 11406        (DC-ELAPSED-DAYS > +30)
 11407         MOVE ER-3531            TO EMI-ERROR
 11408         MOVE -1                 TO PINTL
 11409         MOVE AL-UNBON           TO PINTA
 11410         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11411
 11412     IF PI-EPYAMT NOT > ZEROS
 11413         GO TO 1445-CONTINUE.
 11414
 11415     IF (PI-INT-RATE NOT > ZEROS)  OR
 11416        (DC-ELAPSED-DAYS NOT > +30)
 11417         MOVE PI-EPYAMT TO PI-CPYAMT
 11418         GO TO 1441-FORMAT-NOTE.
 11419
 11420     COMPUTE WS-CALC-INT ROUNDED =  PI-EPYAMT
 11421                                 *  PI-INT-RATE
 11422                                 *  DC-ELAPSED-DAYS
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 223
* EL156.cbl
 11423                                 /  365
 11424                                 /  100.
 11425
 11426     COMPUTE PI-CPYAMT = PI-EPYAMT + WS-CALC-INT.
 11427
 11428 1441-FORMAT-NOTE.
 11429
 11430     MOVE SPACES        TO WS-BOANOTE1.
 11431     MOVE 'BENEFIT -  ' TO WS-BOANOTE1-DESC.
 11432     MOVE PI-EPYAMT     TO WS-BOANOTE1-EPYAMT.
 11433     MOVE WS-BOANOTE1   TO WS-PMTNOTE1 PI-PMTNOTE1 NOTE1I.
 11434     MOVE AL-UANON      TO NOTE1A.
 11435
 11436     IF WS-CALC-INT > ZEROS
 11437         MOVE SPACES        TO WS-BOANOTE2
 11438         MOVE 'INTEREST - ' TO WS-BOANOTE2-DESC
 11439         MOVE WS-CALC-INT   TO WS-BOANOTE2-INT
 11440         MOVE WS-BOANOTE2   TO WS-PMTNOTE2 PI-PMTNOTE2 NOTE2I
 11441         MOVE AL-UANON      TO NOTE2A.
 11442
 11443     GO TO 1445-CONTINUE.
 11444
 11445 1442-COMPUTE-NCL-INTEREST.
 11446     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11447     MOVE PI-STATE               TO WS-ST-ACCESS.
 11448     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 11449     MOVE '3'                    TO CNTL-REC-TYPE.
 11450     MOVE +0                     TO CNTL-SEQ-NO.
 11451     MOVE 'STAT'                 TO FILE-SWITCH.
 11452
 11453     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11454
 11455     MOVE +0                 TO WS-CALC-INT.
 11456
 11457     IF ST-STAT-FROM-INCURRED
 11458         MOVE CL-INCURRED-DT TO WS-COMPUTE-FROM-DT
 11459       ELSE
 11460     IF ST-STAT-FROM-REPORTED
 11461         MOVE CL-REPORTED-DT TO WS-COMPUTE-FROM-DT
 11462       ELSE
 11463         GO TO 1445-CONTINUE.
 11464
 11465     MOVE WS-COMPUTE-FROM-DT TO DC-BIN-DATE-1.
 11466     MOVE WS-TODAY-DATE      TO DC-BIN-DATE-2.
 11467     MOVE +0                 TO DC-ELAPSED-MONTHS
 11468                                DC-ELAPSED-DAYS.
 11469     MOVE '1'                TO DC-OPTION-CODE.
 11470     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11471     IF NO-CONVERSION-ERROR
 11472         NEXT SENTENCE
 11473     ELSE
 11474         GO TO 1445-CONTINUE.
 11475
 11476     IF (CF-ST-STAT-INTEREST NOT > ZEROS) OR
 11477        (DC-ELAPSED-DAYS NOT > CF-ST-NO-DAYS-ELAPSED)
 11478         GO TO 1445-CONTINUE.
 11479
 11480     COMPUTE WS-CALC-INT ROUNDED =  PI-CPYAMT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 224
* EL156.cbl
 11481                                 *  CF-ST-STAT-INTEREST.
 11482
 11483     MOVE SPACES              TO WS-NCLNOTE1.
 11484     MOVE 'BENEFIT -  '       TO WS-NCLNOTE1-DESC.
 11485     MOVE PI-CPYAMT           TO WS-NCLNOTE1-CPYAMT.
 11486     MOVE WS-NCLNOTE1         TO WS-PMTNOTE1
 11487                                 PI-PMTNOTE1
 11488                                 NOTE1I.
 11489     MOVE AL-UANON            TO NOTE1A.
 11490
 11491     IF WS-CALC-INT > ZEROS
 11492         MOVE SPACES          TO WS-NCLNOTE2
 11493         MOVE 'INTEREST - '   TO WS-NCLNOTE2-DESC
 11494         MOVE WS-CALC-INT     TO WS-NCLNOTE2-INT
 11495         MOVE WS-NCLNOTE2     TO WS-PMTNOTE2
 11496                                 PI-PMTNOTE2
 11497                                 NOTE2I
 11498         MOVE AL-UANON        TO NOTE2A.
 11499
 11500     COMPUTE PI-CPYAMT = PI-CPYAMT + WS-CALC-INT.
 11501
 11502 1445-CONTINUE.
 11503
 11504     IF PI-EPYAMT = ZEROS OR PI-PMTTYPE = '4'
 11505        GO TO 1460-TEST-TYPE.
 11506
 11507     IF CM-O-B-COVERAGE
 11508        GO TO 1460-TEST-TYPE.
 11509
 11510     IF PI-COMPANY-ID = 'BOA' OR 'NCL'
 11511         GO TO 1450-CHECK-MAX.
 11512
 11513     IF (PI-CPYAMT - (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 11514                      > PI-EPYAMT)
 11515                      OR
 11516        (PI-CPYAMT + (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 11517                      < PI-EPYAMT)
 11518         MOVE ER-0594            TO EMI-ERROR
 11519         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11520         GO TO 1460-TEST-TYPE.
 11521
 11522 1450-CHECK-MAX.
 11523
 11524     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 11525        PI-LF-COVERAGE-TYPE = 'P'
 11526         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 11527                                   CM-LF-ITD-DEATH-AMT
 11528     ELSE
 11529         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 11530                                   CL-TOTAL-PAID-AMT.
 11531
 11532     IF PI-EPYAMT > WS-BEN-AMT-LEFT
 11533          MOVE ER-0543           TO EMI-ERROR
 11534          PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11535
 11536 1460-TEST-TYPE.
 11537
 11538     IF PI-PMT-APPR-SW = 'G'
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 225
* EL156.cbl
 11539       NEXT SENTENCE
 11540     ELSE
 11541       IF WS-MAX-LF-PMT-TOL NOT = ZERO
 11542         IF PI-EPYAMT = ZERO
 11543             IF PI-CPYAMT > WS-MAX-LF-PMT-TOL
 11544                 MOVE ER-0494    TO  EMI-ERROR
 11545                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11546                 GO TO 1500-EDIT-EXPENSES
 11547             ELSE
 11548                 NEXT SENTENCE
 11549         ELSE
 11550             IF PI-EPYAMT > WS-MAX-LF-PMT-TOL
 11551                 MOVE ER-0494    TO  EMI-ERROR
 11552                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11553                 GO TO 1500-EDIT-EXPENSES.
 11554
 11555     IF PI-PMTTYPE NOT = '2' OR
 11556        (WS-LF-COVERAGE-TYPE = 'L' OR 'P')
 11557         GO TO 1500-EDIT-EXPENSES.
 11558
 11559     MOVE CP-REMAINING-AMT-PRV   TO WS-EDIT-PATTERN.
 11560     MOVE ER-0526                TO EMI-ERROR.
 11561     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11562
 11563     IF EMI-ERROR-NUMBER (1) = '0526'
 11564        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (1).
 11565
 11566     IF EMI-ERROR-NUMBER (2) = '0526'
 11567        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (2).
 11568
 11569     GO TO 1500-EDIT-EXPENSES.
 11570
 11571 1490-PAYMENT-ERROR.
 11572     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11573
 11574     IF EMI-MESSAGE-FORMATTED
 11575         MOVE -1                 TO EPYAMTL
 11576         MOVE AL-UNBON           TO EPYAMTA.
 11577
 11578 1490-EXIT.
 11579      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 226
* EL156.cbl
 11581 1500-EDIT-EXPENSES.
 11582     IF PI-COMPANY-ID = 'MET' OR 'AIG' OR 'AUK' OR 'DMD'
 11583         GO TO 1500-SKIP-ERROR-0556.
 11584
 11585 1500-CONTINUE-ON.
 11586
 11587     IF CM-O-B-COVERAGE
 11588        MOVE ER-0556             TO EMI-ERROR
 11589        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11590
 11591 1500-SKIP-ERROR-0556.
 11592     IF PI-PMTTYPE = '4' OR '5' OR '6'
 11593        IF PI-EEXPENS NOT = ZEROS
 11594           MOVE ER-0524          TO EMI-ERROR
 11595           GO TO 1590-EXPENSE-ERROR
 11596        ELSE
 11597           GO TO 1600-EDIT-RESERVES.
 11598
 11599     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11600     MOVE '6'                    TO CNTL-REC-TYPE.
 11601
 11602     IF CONTROL-IS-ACTUAL-CARRIER
 11603         MOVE PI-CARRIER         TO WS-CARR
 11604     ELSE
 11605         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 11606
 11607     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 11608     MOVE +0                     TO CNTL-SEQ-NO.
 11609     MOVE 'CARR'                 TO FILE-SWITCH.
 11610
 11611     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11612
 11613     IF EXPENSE-CALC-MANUAL
 11614        GO TO 1600-EDIT-RESERVES.
 11615
 11616     IF DOLLARS-PER-PMT
 11617        MOVE CF-EXPENSE-DOLLAR   TO PI-CEXPENS
 11618        GO TO 1600-EDIT-RESERVES.
 11619
 11620     IF DOLLARS-PER-MONTH AND
 11621        (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 11622       COMPUTE PI-CEXPENS = CF-EXPENSE-DOLLAR * EXPENSE-MONTH-SAVE
 11623       GO TO 1600-EDIT-RESERVES.
 11624
 11625     IF PERCENT-OF-PAYMENT
 11626        COMPUTE PI-CEXPENS = PI-CPYAMT * CF-EXPENSE-PERCENT.
 11627
 11628     GO TO 1600-EDIT-RESERVES.
 11629
 11630 1590-EXPENSE-ERROR.
 11631     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11632
 11633     IF EMI-MESSAGE-FORMATTED
 11634        MOVE -1                  TO EEXPENSL
 11635        MOVE AL-UNBON            TO EEXPENSA.
 11636
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 227
* EL156.cbl
 11638 1600-EDIT-RESERVES.
 11639     IF PI-PMTTYPE = '4' OR '5' OR '6'
 11640        IF PI-ERESV = ZEROS
 11641           GO TO 1700-EDIT-EXPENSE-TYPE
 11642        ELSE
 11643           MOVE ER-0525          TO EMI-ERROR
 11644           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT
 11645           GO TO 1700-EDIT-EXPENSE-TYPE.
 11646
 11647     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 11648     MOVE ZEROS                  TO TRLR-SEQ-NO.
 11649     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 11650
 11651     IF NOT AT-MANUAL-RESERVES-USED
 11652        IF PI-ERESV NOT = ZEROS
 11653           MOVE ER-0518          TO EMI-ERROR
 11654           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT.
 11655
 11656     IF AT-MANUAL-RESERVES-USED
 11657        MOVE AT-CURRENT-MANUAL-RESERVE  TO PI-CRESV
 11658        GO TO 1700-EDIT-EXPENSE-TYPE.
 11659
 11660     IF AT-FUTURE-RESERVES-USED
 11661        ADD AT-CURRENT-MANUAL-RESERVE   TO WS-RESERVE-WORK.
 11662
 11663     IF AT-FUTURE-RESERVES-USED
 11664        ADD AT-FUTURE-RESERVE    TO WS-RESERVE-WORK.
 11665
 11666     IF AT-PAY-TO-CURRENT-USED OR AT-LF-PTC-USED
 11667        ADD AT-PAY-CURRENT-RESERVE TO WS-RESERVE-WORK.
 11668
 11669     IF AT-IBNR-RESERVES-USED
 11670        ADD AT-IBNR-RESERVE      TO WS-RESERVE-WORK.
 11671
 11672     MOVE WS-RESERVE-WORK        TO PI-CRESV.
 11673     GO TO 1700-EDIT-EXPENSE-TYPE.
 11674
 11675 1690-RESERVE-ERROR.
 11676     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11677
 11678     IF EMI-MESSAGE-FORMATTED
 11679        MOVE AL-UNBON            TO ERESVA
 11680        MOVE -1                  TO ERESVL.
 11681
 11682 1690-EXIT.
 11683      EXIT.
 11684
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 228
* EL156.cbl
 11686 1700-EDIT-EXPENSE-TYPE.
 11687     IF PI-PMTTYPE NOT = '5' AND '6'
 11688        GO TO 2000-EDIT-DONE.
 11689
 11690     IF PI-ETYPE = ' ' OR '1' OR '2' OR '3' OR '4' OR '5' OR
 11691                   '6' OR '7' OR '8' OR '9'
 11692        GO TO 2000-EDIT-DONE.
 11693
 11694 1705-EXPENSE-ERROR.
 11695     MOVE ER-0573                TO EMI-ERROR.
 11696     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11697
 11698     IF EMI-MESSAGE-FORMATTED
 11699        MOVE AL-UABON            TO ETYPEA
 11700        MOVE -1                  TO ETYPEL.
 11701
 11702     GO TO 2000-EDIT-DONE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 229
* EL156.cbl
 11704 1950-NOT-FOUND.
 11705     IF FILE-SWITCH = 'MSTR'
 11706        MOVE ER-0204             TO EMI-ERROR.
 11707
 11708     IF FILE-SWITCH = 'CARR'
 11709        MOVE ER-0252             TO EMI-ERROR.
 11710
 11711     IF FILE-SWITCH = 'COMP'
 11712        MOVE ER-0254             TO EMI-ERROR.
 11713
 11714     IF FILE-SWITCH = 'STAT'
 11715        MOVE ER-0149             TO EMI-ERROR.
 11716
 11717     IF FILE-SWITCH = 'PROC'
 11718        MOVE ER-0019             TO EMI-ERROR.
 11719
 11720     IF FILE-SWITCH = 'ACCT'
 11721        MOVE ER-0198             TO EMI-ERROR.
 11722
 11723     IF FILE-SWITCH = 'BENE'
 11724        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 11725           MOVE ER-0282          TO EMI-ERROR
 11726        ELSE
 11727           MOVE ER-0283          TO EMI-ERROR.
 11728
 11729     MOVE -1                     TO PMTTYPEL.
 11730     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11731
 11732     MOVE EMI-FORCABLE-CTR       TO  PI-FORCE-COUNT
 11733                                     WS-FORCE-CTR.
 11734
 11735     MOVE EMI-FATAL-CTR          TO  PI-FATAL-COUNT
 11736                                     WS-FATAL-CTR.
 11737
 11738     GO TO 8200-SEND-DATAONLY.
 11739
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 230
* EL156.cbl
 11741 2000-EDIT-DONE.
 11742     IF (WS-SPECIAL-CALC-CD = 'C')
 11743        AND (CM-AH-CRITICAL-PERIOD) > 0
 11744        IF CM-AH-BENEFIT-AMT NOT = ZERO
 11745           IF PI-EPYAMT > ZEROS
 11746              COMPUTE WS-CRIT-PERIOD-DAYS = (CL-TOTAL-PAID-AMT +
 11747                 PI-EPYAMT) / CM-AH-BENEFIT-AMT
 11748           ELSE
 11749              COMPUTE WS-CRIT-PERIOD-DAYS = (CL-TOTAL-PAID-AMT +
 11750                 PI-CPYAMT) / CM-AH-BENEFIT-AMT
 11751           END-IF
 11752           IF WS-CRIT-PERIOD-DAYS > CM-AH-CRITICAL-PERIOD
 11753              MOVE ER-0657          TO EMI-ERROR
 11754              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11755           END-IF
 11756        END-IF
 11757     END-IF
 11758     IF PI-HOLDTIL NOT = ZEROS
 11759        MOVE PI-HOLDTIL          TO HOLDTILO
 11760        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 11761
 11762     IF PI-EPYFROM NOT = ZEROS
 11763        MOVE PI-EPYFROM          TO EPYFROMO
 11764        INSPECT EPYFROMI REPLACING ALL SPACES BY '/'.
 11765
 11766     IF PI-EPYTHRU NOT = ZEROS
 11767        MOVE PI-EPYTHRU            TO EPYTHRUO
 11768        INSPECT EPYTHRUI REPLACING ALL SPACES BY '/'
 11769        IF PI-USES-PAID-TO
 11770           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 11771           MOVE '4'                TO DC-OPTION-CODE
 11772           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11773           IF NO-CONVERSION-ERROR
 11774              MOVE +1              TO DC-ELAPSED-DAYS
 11775              MOVE +0              TO DC-ELAPSED-MONTHS
 11776              MOVE '6'             TO DC-OPTION-CODE
 11777              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11778              IF NO-CONVERSION-ERROR
 11779                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 11780
 11781     MOVE PI-EDAYS               TO EDAYSO.
 11782
 11783     IF PI-AIGFROM NOT = ZEROS
 11784        MOVE PI-AIGFROM          TO AIGFROMO
 11785        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 11786
 11787     MOVE PI-EPYAMT              TO EPYAMTO.
 11788     MOVE PI-ERESV               TO ERESVO.
 11789     MOVE PI-EEXPENS             TO EEXPENSO.
 11790
 11791     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11792     MOVE SPACES                 TO DC-OPTION-CODE.
 11793     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11794
 11795     IF DATE-CONVERSION-ERROR
 11796        MOVE SPACES              TO CPYFROMI
 11797     ELSE
 11798        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 231
* EL156.cbl
 11799        IF PI-EPYFROM = ZEROS
 11800           MOVE AL-UANON             TO EPYFROMA
 11801           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYFROM
 11802           MOVE DC-GREG-DATE-1-EDIT  TO EPYFROMI.
 11803
 11804     IF PI-USES-PAID-TO
 11805        MOVE PI-CPYTHRU                    TO DC-BIN-DATE-1
 11806        MOVE +1                            TO DC-ELAPSED-DAYS
 11807        MOVE +0                            TO DC-ELAPSED-MONTHS
 11808        MOVE '6'                           TO DC-OPTION-CODE
 11809        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11810        IF NO-CONVERSION-ERROR
 11811           MOVE DC-GREG-DATE-1-EDIT        TO CPYTHRUI
 11812           IF PI-EPYTHRU = ZEROS
 11813              MOVE AL-UANON                TO EPYTHRUA
 11814              MOVE DC-GREG-DATE-1-EDIT     TO EPYTHRUI
 11815              MOVE ' '                     TO DC-OPTION-CODE
 11816              MOVE +0                      TO DC-ELAPSED-DAYS
 11817                                              DC-ELAPSED-MONTHS
 11818              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11819              IF NO-CONVERSION-ERROR
 11820                  MOVE DC-GREG-DATE-1-MDY  TO  PI-EPYTHRU
 11821                  GO TO 2001-CONTINUE
 11822              ELSE
 11823                  GO TO 2001-CONTINUE
 11824           ELSE
 11825              GO TO 2001-CONTINUE.
 11826
 11827     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 11828     MOVE SPACES                 TO DC-OPTION-CODE.
 11829     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11830
 11831     IF DATE-CONVERSION-ERROR
 11832        MOVE SPACES              TO CPYTHRUI
 11833     ELSE
 11834        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 11835        IF PI-EPYTHRU = ZEROS
 11836           MOVE AL-UANON TO EPYTHRUA
 11837           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYTHRU
 11838           MOVE DC-GREG-DATE-1-EDIT  TO EPYTHRUI.
 11839
 11840 2001-CONTINUE.
 11841
 11842     MOVE PI-CDAYS               TO CDAYSO.
 11843
 11844     IF PI-EDAYS = ZEROS
 11845        MOVE AL-UNNON TO EDAYSA
 11846        MOVE PI-CDAYS            TO EDAYSO PI-EDAYS.
 11847
 11848     MOVE PI-CPYAMT              TO CPYAMTO.
 11849
 11850     IF PI-EPYAMT = ZEROS
 11851        MOVE AL-UNNON            TO EPYAMTA
 11852        MOVE PI-CPYAMT           TO EPYAMTO  PI-EPYAMT.
 11853
 11854     MOVE PI-CRESV               TO CRESVO.
 11855     MOVE PI-CEXPENS             TO CEXPENSO.
 11856
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 232
* EL156.cbl
 11857     IF PI-EEXPENS = ZEROS
 11858        MOVE AL-UNNON TO EEXPENSA
 11859        MOVE PI-CEXPENS          TO EEXPENSO  PI-EEXPENS.
 11860
 11861     IF (PI-COMPANY-ID = 'CID')
 11862        AND (CL-CLAIM-TYPE = 'L')
 11863        AND (PI-OFFLINE NOT EQUAL 'Y')
 11864        IF PI-PMTTYPE = '2' OR '4'
 11865           PERFORM 2200-CALC-INTEREST
 11866                                 THRU 2200-EXIT
 11867        END-IF
 11868     END-IF
 11869     MOVE EMI-FORCABLE-CTR       TO PI-FORCE-COUNT WS-FORCE-CTR.
 11870     MOVE EMI-FATAL-CTR          TO PI-FATAL-COUNT WS-FATAL-CTR.
 11871     MOVE LAST-ERROR-LINE        TO ERRMSG0O.
 11872
 11873     IF EMI-FATAL-CTR = ZEROS
 11874        MOVE 'B'                 TO PI-PASS-SW.
 11875
 11876     IF NOT EMI-MESSAGE-FORMATTED
 11877         MOVE -1                 TO EPYFROML
 11878     ELSE
 11879         IF EMI-ERROR-NUMBER (1) = '0526' AND
 11880            EMI-ERROR-NUMBER (2) = SPACES
 11881             MOVE -1             TO EPYFROML.
 11882
 11883     GO TO 8200-SEND-DATAONLY.
 11884
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 233
* EL156.cbl
 11886 2200-CALC-INTEREST.
 11887     IF PI-PROOF-DATE NOT = ZEROS AND LOW-VALUES
 11888        MOVE PI-PROOF-DATE       TO DC-GREG-DATE-1-MDY
 11889        MOVE '4'                 TO DC-OPTION-CODE
 11890        PERFORM 9700-LINK-DATE-CONVERT
 11891        IF DATE-CONVERSION-ERROR
 11892            MOVE LOW-VALUES      TO CP-PRF-DT
 11893        ELSE
 11894           MOVE DC-BIN-DATE-1    TO CP-PRF-DT
 11895        END-IF
 11896     END-IF
 11897     MOVE PI-COMPANY-CD          TO CP-COMPANY-CD
 11898        IN CLAIM-INT-PASS-AREA
 11899     MOVE CL-CERT-STATE          TO CP-STATE
 11900        IN CLAIM-INT-PASS-AREA
 11901     MOVE CM-LF-BENEFIT-CD       TO CP-PRODUCT
 11902     MOVE 'LF'                   TO CP-COVERAGE
 11903     MOVE CL-INCURRED-DT         TO CP-INC-DT
 11904     MOVE CL-FILE-ESTABLISH-DT   TO CP-EST-DT
 11905     MOVE LOW-VALUES             TO CP-LSTPD-DT
 11906     MOVE CL-REPORTED-DT         TO CP-RPT-DT
 11907     MOVE CL-CERT-EFF-DT         TO CP-EFF-DT
 11908     MOVE PI-EPYAMT              TO CP-CLAIM-AMT
 11909
 11910* EXEC CICS LINK
 11911*       PROGRAM   ('ELCLMI')
 11912*       COMMAREA  (CLAIM-INT-PASS-AREA)
 11913*       LENGTH    (CP-CLAIM-LENGTH)
 11914*    END-EXEC
 11915     MOVE 'ELCLMI' TO DFHEIV1
 11916*    MOVE '."C                   ''   #00011428' TO DFHEIV0
 11917     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 11918     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11919     MOVE X'2020233030303131343238' TO DFHEIV0(25:11)
 11920     CALL 'kxdfhei1' USING DFHEIV0,
 11921           DFHEIV1,
 11922           CLAIM-INT-PASS-AREA,
 11923           CP-CLAIM-LENGTH,
 11924           DFHEIV99,
 11925           DFHEIV99,
 11926           DFHEIV99
 11927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11928     MOVE AL-PANOF               TO PINTHA
 11929                                    PINTA
 11930     IF NO-CI-ERROR
 11931        MOVE CP-CLM-INT-AMT      TO PINTO
 11932                                    PI-INT-AMT
 11933        MOVE CP-CLM-INT-NODAYS   TO PI-INT-DAYS
 11934        MOVE CP-CLM-INT-RATE     TO PI-INT-RATE-USED
 11935        MOVE AL-PANOF            TO PINTHA
 11936                                    PINTA
 11937     ELSE
 11938        IF CI-RETURN-CODE = '8'
 11939           MOVE ER-3818          TO EMI-ERROR
 11940           MOVE -1               TO ZINTL
 11941           PERFORM 9900-ERROR-FORMAT
 11942                                 THRU 9900-EXIT
 11943           GO TO 2200-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 234
* EL156.cbl
 11944        ELSE
 11945           MOVE ZEROS            TO PINTO
 11946                                    PI-INT-AMT
 11947                                    PI-INT-DAYS
 11948                                    PI-INT-RATE-USED
 11949        END-IF
 11950     END-IF
 11951     IF PI-INT-AMT NOT = ZEROS
 11952        IF (CL-SOC-SEC-NO (1:9) NUMERIC)
 11953           AND (CL-SOC-SEC-NO NOT = ZEROS)
 11954           CONTINUE
 11955        ELSE
 11956           MOVE CL-SOC-SEC-NO (1:3)
 11957                                 TO WS-SSN (1:3)
 11958           MOVE CL-SOC-SEC-NO (5:2)
 11959                                 TO WS-SSN (4:2)
 11960           MOVE CL-SOC-SEC-NO (8:4)
 11961                                 TO WS-SSN (6:4)
 11962           IF (WS-SSN NUMERIC)
 11963              AND (WS-SSN NOT = ZEROS)
 11964              CONTINUE
 11965           ELSE
 11966              MOVE ER-2044       TO EMI-ERROR
 11967              PERFORM 9900-ERROR-FORMAT
 11968                                 THRU 9900-EXIT
 11969           END-IF
 11970        END-IF
 11971        MOVE ELMSTR-KEY          TO ELTRLR-KEY
 11972        MOVE +51                 TO TRLR-SEQ-NO
 11973
 11974* EXEC CICS READ
 11975*          DATASET  ('ELTRLR')
 11976*          SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11977*          RIDFLD   (ELTRLR-KEY)
 11978*          RESP     (WS-RESPONSE)
 11979*       END-EXEC
 11980     MOVE 'ELTRLR' TO DFHEIV1
 11981*    MOVE '&"S        E          (  N#00011478' TO DFHEIV0
 11982     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11983     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11984     MOVE X'204E233030303131343738' TO DFHEIV0(25:11)
 11985     CALL 'kxdfhei1' USING DFHEIV0,
 11986           DFHEIV1,
 11987           DFHEIV20,
 11988           DFHEIV99,
 11989           ELTRLR-KEY,
 11990           DFHEIV99,
 11991           DFHEIV99,
 11992           DFHEIV99
 11993     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11994         DFHEIV20
 11995     MOVE EIBRESP  TO WS-RESPONSE
 11996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11997        IF (NOT WS-RESP-NORMAL)
 11998                    OR
 11999           ((WS-RESP-NORMAL)
 12000           AND ((AT-ADDRESS-LINE-1 = SPACES)
 12001           OR (AT-CITY-STATE = SPACES)))
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 235
* EL156.cbl
 12002           MOVE ER-0874          TO EMI-ERROR
 12003           PERFORM 9900-ERROR-FORMAT
 12004                                 THRU 9900-EXIT
 12005        END-IF
 12006     END-IF
 12007     .
 12008 2200-EXIT.
 12009     EXIT.
 12010 3000-MOVE-INPUT-TO-SAVE-AREA.
 12011     IF PMTTYPEL > 0
 12012         MOVE PMTTYPEI           TO WS-PMTTYPE.
 12013
 12014     MOVE SPACES                 TO PI-PROVISIONAL-IND.
 12015
 12016     IF WS-PMTTYPE = '9'
 12017         MOVE 'P'                TO PI-PROVISIONAL-IND
 12018         MOVE '1'                TO WS-PMTTYPE.
 12019
 12020     IF PAYEEL > 0
 12021         MOVE FUNCTION UPPER-CASE(PAYEEI) TO PAYEEI
 12022         MOVE PAYEEI             TO WS-PAYEE.
 12023
 12024     IF NOTE1L > +0
 12025         MOVE NOTE1I             TO WS-PMTNOTE1
 12026                                    WS-FLI-PMTNOTE
 12027                                    WS-HAN-PMTNOTE.
 12028
 12029     IF NOTE2L > +0
 12030         MOVE NOTE2I             TO WS-PMTNOTE2.
 12031
 12032     IF OFFLINEL > 0
 12033         MOVE OFFLINEI           TO WS-OFFLINE.
 12034
 12035     IF PROOFDTL > 0
 12036         MOVE PROOFDTI            TO DATE-WORK
 12037         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 12038         MOVE NUM-WORK            TO DC-GREG-DATE-1-MDY
 12039         MOVE '4'                 TO DC-OPTION-CODE
 12040         PERFORM 9700-LINK-DATE-CONVERT THRU  9700-EXIT
 12041         IF NO-CONVERSION-ERROR
 12042            MOVE NUM-WORK         TO PROOFDTO
 12043            INSPECT PROOFDTI REPLACING ALL ' ' BY '/'
 12044            MOVE NUM-WORK         TO WS-PROOF-DATE
 12045         ELSE
 12046            MOVE ZEROS            TO WS-PROOF-DATE
 12047         END-IF
 12048     END-IF.
 12049
 12050     IF EOBYNL > +0
 12051        MOVE EOBYNI              TO WS-PRINT-EOB-YN
 12052     END-IF
 12053     IF GROUPEDL > +0
 12054         MOVE GROUPEDI           TO WS-GROUPED.
 12055
 12056     IF CASHL > +0
 12057        MOVE CASHI               TO WS-CASH.
 12058
 12059     IF LOANNOL > +0
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 236
* EL156.cbl
 12060         MOVE LOANNOI            TO WS-LOAN-NO.
 12061
 12062     IF CHECKNOL > 0
 12063         MOVE CHECKNOI           TO WS-CHECKNO, WS-AIG-CHECKNO.
 12064
 12065     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12066         IF WS-AIG-CREDIT-ENTERED
 12067             MOVE WS-A-CHECKNO-6-7 TO WS-A-CHECKNO-1-2
 12068             MOVE ZEROS            TO WS-A-CHECKNO-3-7
 12069             MOVE WS-AIG-CHECKNO   TO WS-CHECKNO CHECKNOO
 12070             MOVE AL-UANON         TO CHECKNOA.
 12071
 12072     IF HOLDTILL > 0
 12073         MOVE HOLDTILI           TO DATE-WORK
 12074         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 12075         MOVE NUM-WORK           TO WS-HOLDTIL.
 12076
 12077     IF ZINTL > +0
 12078
 12079* EXEC CICS BIF DEEDIT
 12080*           FIELD   (ZINTI)
 12081*           LENGTH  (07)
 12082*       END-EXEC
 12083     MOVE 07
 12084       TO DFHEIV11
 12085*    MOVE '@"L                   #   #00011565' TO DFHEIV0
 12086     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12087     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12088     MOVE X'2020233030303131353635' TO DFHEIV0(25:11)
 12089     CALL 'kxdfhei1' USING DFHEIV0,
 12090           ZINTI,
 12091           DFHEIV11
 12092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12093        IF ZINTI NOT NUMERIC
 12094           MOVE ER-0419          TO EMI-ERROR
 12095           PERFORM 9900-ERROR-FORMAT
 12096           MOVE AL-UABON         TO ZINTA
 12097           MOVE -1               TO ZINTL
 12098        ELSE
 12099           MOVE ZINTI            TO CP-INT-RATE
 12100                                    WS-INT-RATE
 12101           MOVE CP-INT-RATE      TO ZINTO
 12102           MOVE AL-UNNON         TO ZINTA
 12103        END-IF
 12104     ELSE
 12105        MOVE ZEROS               TO CP-INT-RATE
 12106     END-IF
 12107     IF EPYFROML > 0
 12108         MOVE EPYFROMI           TO DATE-WORK
 12109         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 12110         MOVE NUM-WORK           TO WS-EPYFROM.
 12111
 12112     IF AIGFROML > 0
 12113         MOVE AIGFROMI           TO DATE-WORK
 12114         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 12115         MOVE NUM-WORK           TO WS-AIGFROM
 12116     ELSE
 12117         IF (AIGFROMI = LOW-VALUES) AND
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 237
* EL156.cbl
 12118            (PI-AIGFROM NOT = ZEROS)
 12119              MOVE 'Y' TO WS-RECALC-PAYFROM-SW.
 12120
 12121     IF EPYTHRUL > +0
 12122        MOVE EPYTHRUI           TO DATE-WORK
 12123        PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 12124        MOVE NUM-WORK           TO WS-EPYTHRU
 12125        MOVE WS-EPYTHRU         TO DC-GREG-DATE-1-MDY
 12126        MOVE '4'                TO DC-OPTION-CODE
 12127        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12128        IF NO-CONVERSION-ERROR
 12129           IF PI-USES-PAID-TO
 12130              MOVE '6'                TO DC-OPTION-CODE
 12131              MOVE -1                 TO DC-ELAPSED-DAYS
 12132              MOVE +0                 TO DC-ELAPSED-MONTHS
 12133              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12134              IF NO-CONVERSION-ERROR
 12135                 MOVE DC-BIN-DATE-2   TO DC-BIN-DATE-1
 12136                 MOVE ' '             TO DC-OPTION-CODE
 12137                 MOVE +0              TO DC-ELAPSED-DAYS
 12138                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12139              IF NO-CONVERSION-ERROR
 12140                 MOVE DC-GREG-DATE-1-MDY TO WS-EPYTHRU.
 12141
 12142*****DEEDIT DAYS AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 12143*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 12144     IF EDAYSL > 0
 12145
 12146* EXEC CICS BIF DEEDIT
 12147*            FIELD(EDAYSI)
 12148*            LENGTH(6)
 12149*        END-EXEC
 12150     MOVE 6
 12151       TO DFHEIV11
 12152*    MOVE '@"L                   #   #00011621' TO DFHEIV0
 12153     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12154     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12155     MOVE X'2020233030303131363231' TO DFHEIV0(25:11)
 12156     CALL 'kxdfhei1' USING DFHEIV0,
 12157           EDAYSI,
 12158           DFHEIV11
 12159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12160         MOVE EDAYSI             TO WS-DY-WORK
 12161         IF WS-DY-SIGN = SPACES
 12162            MOVE WS-DY-NUM       TO WS-EDAYS
 12163            ADD 0                TO WS-EDAYS
 12164         ELSE
 12165            MOVE EDAYSI          TO WS-EDAYS
 12166            ADD 0                TO WS-EDAYS.
 12167
 12168*****DEEDIT PAYMENT AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 12169*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 12170     IF EPYAMTL > 0
 12171
 12172* EXEC CICS BIF DEEDIT
 12173*            FIELD(EPYAMTI)
 12174*            LENGTH(10)
 12175*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 238
* EL156.cbl
 12176     MOVE 10
 12177       TO DFHEIV11
 12178*    MOVE '@"L                   #   #00011636' TO DFHEIV0
 12179     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12180     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12181     MOVE X'2020233030303131363336' TO DFHEIV0(25:11)
 12182     CALL 'kxdfhei1' USING DFHEIV0,
 12183           EPYAMTI,
 12184           DFHEIV11
 12185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12186         MOVE EPYAMTI            TO WS-PY-WORK
 12187         IF WS-PY-SIGN = SPACES
 12188            MOVE WS-PY-NUM       TO WS-EPYAMT
 12189            ADD 0                TO WS-EPYAMT
 12190         ELSE
 12191            MOVE EPYAMTI         TO WS-EPYAMT
 12192            ADD 0                TO WS-EPYAMT.
 12193
 12194     IF ERESVL > 0
 12195
 12196* EXEC CICS BIF DEEDIT
 12197*            FIELD(ERESVI)
 12198*            LENGTH(9)
 12199*        END-EXEC
 12200     MOVE 9
 12201       TO DFHEIV11
 12202*    MOVE '@"L                   #   #00011649' TO DFHEIV0
 12203     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12204     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12205     MOVE X'2020233030303131363439' TO DFHEIV0(25:11)
 12206     CALL 'kxdfhei1' USING DFHEIV0,
 12207           ERESVI,
 12208           DFHEIV11
 12209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12210         MOVE ERESVI TO WS-ERESV.
 12211
 12212     IF EEXPENSL > 0
 12213
 12214* EXEC CICS BIF DEEDIT
 12215*            FIELD(EEXPENSI)
 12216*            LENGTH(8)
 12217*        END-EXEC
 12218     MOVE 8
 12219       TO DFHEIV11
 12220*    MOVE '@"L                   #   #00011656' TO DFHEIV0
 12221     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12222     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12223     MOVE X'2020233030303131363536' TO DFHEIV0(25:11)
 12224     CALL 'kxdfhei1' USING DFHEIV0,
 12225           EEXPENSI,
 12226           DFHEIV11
 12227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12228         MOVE EEXPENSI           TO WS-EEXPENS.
 12229
 12230     IF ETYPEL > ZEROS
 12231         MOVE ETYPEI             TO WS-ETYPE.
 12232
 12233     IF PI-COMPANY-ID = 'BOA'
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 239
* EL156.cbl
 12234        IF PINTL > ZEROS
 12235
 12236* EXEC CICS BIF DEEDIT
 12237*            FIELD (PINTI)
 12238*            LENGTH(05)
 12239*          END-EXEC
 12240     MOVE 05
 12241       TO DFHEIV11
 12242*    MOVE '@"L                   #   #00011667' TO DFHEIV0
 12243     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12244     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12245     MOVE X'2020233030303131363637' TO DFHEIV0(25:11)
 12246     CALL 'kxdfhei1' USING DFHEIV0,
 12247           PINTI,
 12248           DFHEIV11
 12249     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12250           IF PINTI NUMERIC
 12251               MOVE AL-UNNON     TO PINTA
 12252               MOVE PINTI        TO WS-INT-RATE
 12253               MOVE WS-INT-RATE  TO PINTO.
 12254
 12255 3000-EXIT.
 12256     EXIT.
 12257
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 240
* EL156.cbl
 12259 3050-REBUILD-ENTERED.
 12260
 12261     MOVE PI-SAVE-INPUT TO WS-SAVE-INPUT.
 12262
 12263     IF PI-PROV-PMT
 12264         MOVE '9'           TO PMTTYPEO
 12265     ELSE
 12266         MOVE PI-PMTTYPE    TO PMTTYPEO.
 12267
 12268     MOVE PI-PAYEE          TO PAYEEO.
 12269     MOVE PI-PMTNOTE1       TO NOTE1O.
 12270     MOVE PI-PMTNOTE2       TO NOTE2O.
 12271     MOVE PI-OFFLINE        TO OFFLINEO.
 12272     IF PI-PROOF-DATE NOT = ZEROS
 12273         MOVE PI-PROOF-DATE TO PROOFDTO
 12274         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 12275     END-IF.
 12276     MOVE PI-GROUPED        TO GROUPEDO.
 12277
 12278     MOVE PI-CASH           TO CASHO.
 12279
 12280     IF PI-INT-RATE > ZEROS
 12281         MOVE PI-INT-RATE   TO PINTO.
 12282
 12283     IF PI-COMPANY-ID = 'CID'
 12284        IF PI-INT-AMT > ZEROS
 12285           MOVE PI-INT-AMT       TO PINTO
 12286           MOVE AL-PANOF         TO PINTA
 12287                                    PINTHA
 12288        END-IF
 12289     END-IF
 12290     MOVE PI-PRINT-EOB-YN        TO EOBYNI
 12291     IF PI-HOLDTIL NOT = ZEROS
 12292        MOVE PI-HOLDTIL          TO HOLDTILO
 12293        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 12294
 12295     IF PI-EPYFROM NOT = ZEROS
 12296        MOVE PI-EPYFROM          TO EPYFROMO
 12297        INSPECT EPYFROMO REPLACING ALL SPACES BY '/'.
 12298
 12299     IF PI-AIGFROM NOT = ZEROS
 12300        MOVE PI-AIGFROM          TO AIGFROMO
 12301        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 12302
 12303     IF PI-EPYTHRU NOT = ZEROS
 12304        MOVE PI-EPYTHRU          TO EPYTHRUO
 12305        INSPECT EPYTHRUO REPLACING ALL SPACES BY '/'
 12306        IF PI-USES-PAID-TO
 12307           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 12308           MOVE '4'                TO DC-OPTION-CODE
 12309           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12310           IF NO-CONVERSION-ERROR
 12311              MOVE +1 TO DC-ELAPSED-DAYS
 12312              MOVE +0 TO DC-ELAPSED-MONTHS
 12313              MOVE '6' TO DC-OPTION-CODE
 12314              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12315              IF NO-CONVERSION-ERROR
 12316                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 241
* EL156.cbl
 12317
 12318     IF PI-EDAYS NOT = ZEROS
 12319        MOVE PI-EDAYS TO EDAYSO.
 12320
 12321     IF PI-EPYAMT NOT = ZEROS
 12322        MOVE PI-EPYAMT TO EPYAMTO.
 12323
 12324     IF PI-ERESV NOT = ZEROS
 12325        MOVE PI-ERESV TO ERESVO.
 12326
 12327     IF PI-EEXPENS NOT = ZEROS
 12328        MOVE PI-EEXPENS TO EEXPENSO.
 12329
 12330     MOVE PI-ETYPE TO ETYPEO.
 12331
 12332     IF PI-ECHECKNO NOT = SPACES
 12333        MOVE PI-ECHECKNO         TO CHECKNOO
 12334     ELSE
 12335        MOVE PI-CCHECKNO         TO CHECKNOO.
 12336
 12337     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 12338     MOVE SPACES                 TO DC-OPTION-CODE.
 12339     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12340
 12341     IF DATE-CONVERSION-ERROR
 12342        MOVE SPACES              TO CPYFROMI
 12343     ELSE
 12344        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI.
 12345
 12346     IF PI-USES-PAID-TO
 12347        MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 12348        MOVE +1                  TO DC-ELAPSED-DAYS
 12349        MOVE +0                  TO DC-ELAPSED-MONTHS
 12350        MOVE '6'                 TO DC-OPTION-CODE
 12351        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12352        IF NO-CONVERSION-ERROR
 12353           MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 12354           GO TO 3051-CONTINUE.
 12355
 12356     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 12357     MOVE SPACES                 TO DC-OPTION-CODE.
 12358     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12359
 12360     IF DATE-CONVERSION-ERROR
 12361        MOVE SPACES              TO CPYTHRUI
 12362     ELSE
 12363        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI.
 12364
 12365 3051-CONTINUE.
 12366
 12367     IF PI-CDAYS NOT = ZEROS
 12368        MOVE PI-CDAYS TO CDAYSO.
 12369
 12370     IF PI-CPYAMT NOT = ZEROS
 12371        MOVE PI-CPYAMT TO CPYAMTO.
 12372
 12373     IF PI-CRESV NOT = ZEROS
 12374        MOVE PI-CRESV TO CRESVO.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 242
* EL156.cbl
 12375
 12376     IF PI-CEXPENS NOT = ZEROS
 12377        MOVE PI-CEXPENS TO CEXPENSO.
 12378
 12379 3059-EXIT.
 12380     EXIT.
 12381
 12382 3100-DEEDIT-DATE.
 12383
 12384* EXEC CICS BIF DEEDIT
 12385*        FIELD(DATE-WORK)
 12386*        LENGTH(8)
 12387*    END-EXEC.
 12388     MOVE 8
 12389       TO DFHEIV11
 12390*    MOVE '@"L                   #   #00011804' TO DFHEIV0
 12391     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12392     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12393     MOVE X'2020233030303131383034' TO DFHEIV0(25:11)
 12394     CALL 'kxdfhei1' USING DFHEIV0,
 12395           DATE-WORK,
 12396           DFHEIV11
 12397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12398
 12399
 12400 3100-EXIT.
 12401     EXIT.
 12402
 12403 3200-CALC-AIG-DAYS.
 12404
 12405     MOVE 'N'                    TO WS-DUE-DAY-SW.
 12406
 12407     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 12408     MOVE ' '                    TO DC-OPTION-CODE.
 12409     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12410     IF NO-CONVERSION-ERROR
 12411         MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-INC-MDY
 12412     ELSE
 12413         GO TO 3290-ERROR.
 12414
 12415     IF WS-SV-AIGFROM NOT = LOW-VALUES
 12416         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 12417                                WS-BIN-FROM-DT
 12418     ELSE
 12419         IF CL-TOTAL-PAID-AMT > ZEROS
 12420             IF WS-SV-EPYFROM = LOW-VALUES
 12421                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 12422                                        WS-BIN-FROM-DT
 12423             ELSE
 12424                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 12425                                        WS-BIN-FROM-DT
 12426         ELSE
 12427             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 12428                                        WS-BIN-FROM-DT.
 12429
 12430 3210-CONTINUE.
 12431
 12432     MOVE ' '                    TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 243
* EL156.cbl
 12433     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12434     IF DATE-CONVERSION-ERROR
 12435         GO TO 3290-ERROR.
 12436
 12437     MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY.
 12438
 12439     IF PI-LOAN-DUE-DAY = 31
 12440         MOVE 30              TO WS-PMT-DUE-DA
 12441                                 WS-SAVE-DUE-DA
 12442     ELSE
 12443         MOVE PI-LOAN-DUE-DAY TO WS-PMT-DUE-DA
 12444                                 WS-SAVE-DUE-DA.
 12445
 12446     IF (PI-LOAN-DUE-DAY > 28) AND
 12447        (WS-PMT-DUE-MO = 2)
 12448         MOVE 'Y'                TO WS-DUE-DAY-SW
 12449         MOVE 28                 TO WS-PMT-DUE-DA.
 12450
 12451     MOVE WS-PMT-DUE-MDY         TO DC-GREG-DATE-1-MDY.
 12452     MOVE '4'                    TO DC-OPTION-CODE.
 12453     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12454     IF NO-CONVERSION-ERROR
 12455         MOVE DC-BIN-DATE-1      TO WS-PMT-DUE-DT
 12456     ELSE
 12457         GO TO 3290-ERROR.
 12458
 12459*--------------------------------------------------------------*
 12460*    IF THE 1ST LOAN PMT DATE LESS THAN INCURRED DATE          *
 12461*    AND THE EFFECTIVE DAY LESS THAN INCURRED DAY              *
 12462*    ADD ONE MONTH TO THE CURRENT PAYMENT DUE DATE             *
 12463*                                                              *
 12464*    EXAMPLE: CERT LOAN PMT DUE  - 05/03/87                    *
 12465*             INCURRED DATE      - 04/15/91                    *
 12466*             PMT DUE DATE       - 04/03/91                    *
 12467*             PMT DUE DATE       - 05/03/91                    *
 12468*--------------------------------------------------------------*
 12469
 12470     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 12471        (WS-SV-AIGFROM = LOW-VALUES)
 12472         IF (WS-PMT-DUE-MO = WS-TEMP-INC-MO) AND
 12473            (WS-PMT-DUE-DA < WS-TEMP-INC-DA)
 12474             MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 12475             PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 12476             IF NO-CONVERSION-ERROR
 12477                 MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 12478                 MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 12479             ELSE
 12480                 GO TO 3290-ERROR.
 12481
 12482     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 12483        (WS-SV-AIGFROM = LOW-VALUES)
 12484         GO TO 3205-CONT-CALC-PMT.
 12485
 12486     MOVE WS-BIN-FROM-DT         TO DC-BIN-DATE-1.
 12487     MOVE ' '                    TO DC-OPTION-CODE.
 12488     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12489     IF NO-CONVERSION-ERROR
 12490         MOVE DC-GREG-DATE-1-MDY     TO WS-FROM-DATE-MDY
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 244
* EL156.cbl
 12491     ELSE
 12492         GO TO 3290-ERROR.
 12493
 12494     IF (WS-PMT-DUE-MO = WS-FROM-MO) AND
 12495        (WS-PMT-DUE-DA < WS-FROM-DA)
 12496          MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 12497          PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 12498          IF NO-CONVERSION-ERROR
 12499              MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 12500              MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 12501          ELSE
 12502              GO TO 3290-ERROR.
 12503
 12504 3205-CONT-CALC-PMT.
 12505
 12506*--------------------------------------------------------------*
 12507*    VERIFY THAT THE SYSTEM CALCULATED LOAN PAYMENT DATE FALLS *
 12508*    BETWEEN THE PAY FROM / THRU DATES.                        *
 12509*--------------------------------------------------------------*
 12510
 12511     IF CL-TOTAL-PAID-AMT = ZEROS AND
 12512        PI-PMTTYPE = '2'
 12513          NEXT SENTENCE
 12514     ELSE
 12515        IF (WS-PMT-DUE-DT < WS-BIN-FROM-DT) OR
 12516           (WS-PMT-DUE-DT > WS-SV-EPYTHRU)
 12517             MOVE WS-PMT-DUE-MDY     TO EMI-DATE-FIELD
 12518             MOVE ER-3527            TO EMI-ERROR
 12519             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12520             MOVE -1                 TO EPYTHRUL
 12521             MOVE AL-UNBON           TO EPYTHRUA
 12522                                        EPYFROMA
 12523             GO TO 3299-EXIT.
 12524
 12525*--------------------------------------------------------------*
 12526*    CALCULATE RETRO ELIMINATION DATE                          *
 12527*--------------------------------------------------------------*
 12528
 12529     IF WS-SV-AIGFROM NOT = LOW-VALUES
 12530         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 12531     ELSE
 12532         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 12533
 12534     MOVE PI-BEN-DAYS    TO DC-ELAPSED-DAYS.
 12535     MOVE +0             TO DC-ELAPSED-MONTHS.
 12536     MOVE '6'            TO DC-OPTION-CODE.
 12537     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12538     IF NO-CONVERSION-ERROR
 12539         MOVE DC-BIN-DATE-2 TO WS-RETRO-ELIM-DT
 12540     ELSE
 12541         GO TO 3290-ERROR.
 12542
 12543 3210-CHECK-PMT-DATE.
 12544
 12545*--------------------------------------------------------------*
 12546*    VERIFY THAT THE CALCULATED LOAN DUE DATE FALLS AFTER      *
 12547*    THE ENTERED PAY FROM DATE                                 *
 12548*--------------------------------------------------------------*
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 245
* EL156.cbl
 12549
 12550     IF WS-PMT-DUE-DT < WS-SV-EPYFROM
 12551         NEXT SENTENCE
 12552     ELSE
 12553         GO TO 3220-COMPUTE-DAYS.
 12554
 12555     MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1.
 12556     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 12557     IF NO-CONVERSION-ERROR
 12558         MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 12559         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 12560         GO TO 3210-CHECK-PMT-DATE
 12561     ELSE
 12562         GO TO 3290-ERROR.
 12563
 12564 3220-COMPUTE-DAYS.
 12565
 12566     MOVE WS-PMT-DUE-DT TO WS-NEXT-PMT-DUE-DT.
 12567     MOVE ZEROS         TO WS-CDAYS.
 12568     MOVE 'N'           TO WS-ELIMINATION-SW.
 12569
 12570*--------------------------------------------------------------*
 12571*    COMPUTE CALIFORNIA DUE DAYS                               *
 12572*--------------------------------------------------------------*
 12573
 12574     IF CL-TOTAL-PAID-AMT > ZEROS
 12575         MOVE 'Y' TO WS-ELIMINATION-SW
 12576         GO TO 3240-FIRST-PMT-DUE
 12577     ELSE
 12578        IF WS-RETRO-ELIM-DT > WS-PMT-DUE-DT
 12579            NEXT SENTENCE
 12580        ELSE
 12581            GO TO 3240-FIRST-PMT-DUE.
 12582
 12583 3230-NEXT-PMT-DUE.
 12584
 12585     MOVE WS-NEXT-PMT-DUE-DT TO DC-BIN-DATE-1.
 12586     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 12587     IF NO-CONVERSION-ERROR
 12588         MOVE DC-BIN-DATE-2 TO WS-NEXT-PMT-DUE-DT
 12589         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 12590     ELSE
 12591         GO TO 3290-ERROR.
 12592
 12593 3240-FIRST-PMT-DUE.
 12594
 12595     IF CL-TOTAL-PAID-AMT > ZEROS
 12596         NEXT SENTENCE
 12597     ELSE
 12598        IF WS-RETRO-ELIM-DT > WS-NEXT-PMT-DUE-DT
 12599            GO TO 3230-NEXT-PMT-DUE.
 12600
 12601     IF WS-NEXT-PMT-DUE-DT > WS-SV-EPYTHRU
 12602         GO TO 3250-VERIFY-ELIMINATION.
 12603
 12604     ADD +30 TO WS-CDAYS.
 12605     MOVE 'Y' TO WS-ELIMINATION-SW.
 12606     GO TO 3230-NEXT-PMT-DUE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 246
* EL156.cbl
 12607
 12608 3250-VERIFY-ELIMINATION.
 12609
 12610     IF ELIM-SATISFIED
 12611         GO TO 3260-END-CALC.
 12612
 12613     IF PI-PMTTYPE = '1'
 12614         MOVE ZEROS TO WS-CDAYS
 12615         GO TO 3260-END-CALC.
 12616
 12617     IF WS-SV-AIGFROM NOT = LOW-VALUES
 12618         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 12619     ELSE
 12620         IF CL-TOTAL-PAID-AMT > ZEROS
 12621             IF WS-SV-EPYFROM = LOW-VALUES
 12622                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 12623             ELSE
 12624                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 12625         ELSE
 12626             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1.
 12627
 12628     MOVE WS-SV-EPYTHRU          TO DC-BIN-DATE-2.
 12629     MOVE '1'                    TO DC-OPTION-CODE.
 12630     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12631     IF NO-CONVERSION-ERROR
 12632         COMPUTE WS-DAYS-OFF =  DC-ELAPSED-DAYS + 1
 12633     ELSE
 12634         GO TO 3290-ERROR.
 12635
 12636     IF CL-TOTAL-PAID-AMT > ZEROS
 12637         MOVE WS-DAYS-OFF TO WS-CDAYS
 12638     ELSE
 12639         IF PI-BEN-DAYS > WS-DAYS-OFF
 12640             MOVE ZEROS TO WS-CDAYS
 12641         ELSE
 12642             COMPUTE WS-CDAYS = WS-DAYS-OFF - PI-BEN-DAYS.
 12643
 12644 3260-END-CALC.
 12645
 12646     MOVE WS-CDAYS TO PI-CDAYS.
 12647
 12648     IF PI-EDAYS = ZEROS
 12649         MOVE PI-CDAYS TO PI-EDAYS
 12650         MOVE AL-UNNON TO EDAYSA.
 12651
 12652     GO TO 3299-EXIT.
 12653
 12654 3290-ERROR.
 12655
 12656     MOVE ER-3528            TO EMI-ERROR.
 12657     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12658     MOVE -1                 TO CDAYSL.
 12659     MOVE AL-UNBON           TO CDAYSA.
 12660
 12661 3299-EXIT.
 12662     EXIT.
 12663
 12664 3300-BUMP-DATE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 247
* EL156.cbl
 12665
 12666     IF WS-RESTORE-DUE-DAY
 12667         MOVE 'N'              TO WS-DUE-DAY-SW
 12668         MOVE WS-SAVE-DUE-DA   TO WS-PMT-DUE-DA
 12669         ADD 1                 TO WS-PMT-DUE-MO
 12670         MOVE WS-PMT-DUE-MDY   TO DC-GREG-DATE-1-MDY
 12671         MOVE '4'              TO DC-OPTION-CODE
 12672         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12673         IF NO-CONVERSION-ERROR
 12674             MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 12675             MOVE DC-BIN-DATE-1      TO DC-BIN-DATE-2
 12676             GO TO 3399-EXIT
 12677         ELSE
 12678             MOVE '9'          TO DC-ERROR-CODE
 12679             GO TO 3399-EXIT.
 12680
 12681     IF (WS-PMT-DUE-MO = 1) AND
 12682        (WS-SAVE-DUE-DA > 28)
 12683           MOVE 'Y' TO WS-DUE-DAY-SW.
 12684
 12685     MOVE +0                 TO DC-ELAPSED-DAYS.
 12686     MOVE +1                 TO DC-ELAPSED-MONTHS.
 12687     MOVE '6'                TO DC-OPTION-CODE.
 12688     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12689
 12690 3399-EXIT.
 12691     EXIT.
 12692
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 248
* EL156.cbl
 12694 3400-COMPUTE-EXPIRY.
 12695
 12696     MOVE CM-LOAN-1ST-PMT-DT    TO DC-BIN-DATE-1.
 12697     MOVE +0                    TO DC-ELAPSED-DAYS
 12698                                   DC-ODD-DAYS-OVER.
 12699     MOVE '1'                   TO DC-END-OF-MONTH.
 12700     MOVE '6'                   TO DC-OPTION-CODE.
 12701
 12702     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12703         COMPUTE DC-ELAPSED-MONTHS = CM-LF-ORIG-TERM - +1
 12704     ELSE
 12705         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1.
 12706
 12707     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12708     IF NO-CONVERSION-ERROR
 12709         MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT
 12710     ELSE
 12711         GO TO 3390-CONTINUE.
 12712
 12713     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 12714         GO TO 3390-CONTINUE.
 12715
 12716     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12717     MOVE '4'                    TO CNTL-REC-TYPE.
 12718     MOVE +0                     TO CNTL-SEQ-NO.
 12719     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 12720     MOVE WS-ACCESS              TO CNTL-ACCESS.
 12721     MOVE 'BENE'                 TO FILE-SWITCH.
 12722
 12723     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 12724
 12725     IF NO-BENEFIT-FOUND
 12726         GO TO 3390-CONTINUE.
 12727
 12728     IF PI-COMPANY-ID EQUAL 'CID' OR 'DCC'
 12729        IF (PI-OFFLINE = 'Y') OR
 12730           (PI-PMTTYPE = '7')
 12731           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 12732                                     THRU 9870-EXIT
 12733           IF ERROR-ON-OUTPUT
 12734             MOVE -1                 TO ENTERPFL
 12735             MOVE AL-UANON           TO ENTERPFA
 12736             MOVE MAP-NAMEA          TO MAP-NAME
 12737             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12738             GO TO 8200-SEND-DATAONLY.
 12739
 12740     IF (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)  AND
 12741        (CF-CO-EARNINGS-CALC (SUB-1) = 'B' OR 'K' OR 'L') AND
 12742        (CF-SPECIAL-CALC-CD  (SUB-1) = 'L')
 12743          MOVE WS-EXP-DT TO DC-BIN-DATE-1
 12744          MOVE +0        TO DC-ELAPSED-DAYS
 12745          MOVE +1        TO DC-ELAPSED-MONTHS
 12746          MOVE 6         TO DC-OPTION-CODE
 12747          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12748          IF NO-CONVERSION-ERROR
 12749              MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT.
 12750
 12751 3390-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 249
* EL156.cbl
 12752
 12753      IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 12754         MOVE CM-AH-LOAN-EXPIRE-DT
 12755                                 TO DC-BIN-DATE-1
 12756      ELSE
 12757         MOVE CM-LF-LOAN-EXPIRE-DT
 12758                                 TO DC-BIN-DATE-1
 12759      END-IF
 12760
 12761      MOVE ' '                    TO DC-OPTION-CODE.
 12762      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12763      MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-DATE-MDY.
 12764      MOVE WS-TEMP-DA             TO PI-LOAN-DUE-DAY.
 12765
 12766 3499-EXIT.
 12767     EXIT.
 12768
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 250
* EL156.cbl
 12770 5000-UPDATE.
 12771
 12772     PERFORM 7300-CHECK-AUTO-ACTIVITY THRU 7399-EXIT.
 12773
 12774     PERFORM 6200-UPDATE-CLAIM-MSTR THRU 6299-EXIT.
 12775
 12776     IF PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE  OR
 12777        PI-OFFLINE = 'Y'
 12778        NEXT SENTENCE
 12779     ELSE
 12780        PERFORM 6700-UPDATE-ACTQ THRU 6799-EXIT.
 12781
 12782*    IF PI-COMPANY-ID = 'CRI'
 12783*       IF PI-PMTTYPE = '1' OR  '2'
 12784*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 12785*             PERFORM 6800-BUILD-FORM-TRAILER   THRU 6899-EXIT
 12786*             PERFORM 6900-BUILD-ARCHIVE-HEADER THRU 6999-EXIT.
 12787
 12788*    IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 12789*       IF PI-PMTTYPE = '1'
 12790*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 12791*             PERFORM 6800-BUILD-FORM-TRAILER THRU 6899-EXIT.
 12792
 12793     IF PI-PMTTYPE      = '2' AND
 12794        PI-SPLIT-PMT-SW = 'Y' AND
 12795        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 12796          MOVE ER-3530                TO EMI-ERROR
 12797          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12798
 12799     IF (PI-COMPANY-ID = 'CID')
 12800        AND (CL-CLAIM-TYPE = 'L')
 12801        IF PI-PMTTYPE = '2' OR '4'
 12802           IF PI-INT-AMT NOT = ZEROS
 12803              PERFORM 7110-BUILD-PMT-TRLR
 12804                                 THRU 7130-EXIT
 12805           ELSE
 12806              IF PI-PMTTYPE = '2'
 12807                 PERFORM 7140-BUILD-NOTE-TRLR
 12808                                 THRU 7170-EXIT
 12809              END-IF
 12810           END-IF
 12811        END-IF
 12812     END-IF
 12813*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12814*        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12815*            MOVE 'N'                 TO  WS-LETTER-SW.
 12816
 12817*    IF PI-COMPANY-ID = 'DMD'
 12818*        IF CL-NO-OF-PMTS-MADE = +1
 12819*                OR
 12820*           PI-PMTTYPE = '2'
 12821*            PERFORM 5300-CREATE-DMO THRU 5300-EXIT.
 12822
 12823     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
 12824
 12825*    IF PI-COMPANY-ID = 'DMD'
 12826*       IF CL-CERT-NO (5:2) = '69' OR '70'
 12827*           PERFORM 6600-UPDATE-DLO035 THRU 6600-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 251
* EL156.cbl
 12828
 12829
 12830* EXEC CICS REWRITE
 12831*         DATASET('ELMSTR')
 12832*         FROM(CLAIM-MASTER)
 12833*     END-EXEC.
 12834     MOVE LENGTH OF
 12835      CLAIM-MASTER
 12836       TO DFHEIV11
 12837     MOVE 'ELMSTR' TO DFHEIV1
 12838*    MOVE '&& L                  %   #00012238' TO DFHEIV0
 12839     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12840     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12841     MOVE X'2020233030303132323338' TO DFHEIV0(25:11)
 12842     CALL 'kxdfhei1' USING DFHEIV0,
 12843           DFHEIV1,
 12844           CLAIM-MASTER,
 12845           DFHEIV11,
 12846           DFHEIV99
 12847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12848
 12849
 12850     IF WS-LETTER-SW = 'N'
 12851         GO TO 5000-END-UPDATE.
 12852
 12853 5000-GENERATE-AUTO-LETTER.
 12854
 12855
 12856* EXEC CICS LINK
 12857*        PROGRAM    (LINK-1523)
 12858*        COMMAREA   (W-1523-LINKDATA)
 12859*        LENGTH     (W-1523-COMM-LENGTH)
 12860*    END-EXEC.
 12861*    MOVE '."C                   ''   #00012248' TO DFHEIV0
 12862     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12863     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12864     MOVE X'2020233030303132323438' TO DFHEIV0(25:11)
 12865     CALL 'kxdfhei1' USING DFHEIV0,
 12866           LINK-1523,
 12867           W-1523-LINKDATA,
 12868           W-1523-COMM-LENGTH,
 12869           DFHEIV99,
 12870           DFHEIV99,
 12871           DFHEIV99
 12872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12873
 12874
 12875     IF W-1523-FATAL-ERROR
 12876         MOVE W-1523-ERROR-CODE      TO  EMI-ERROR
 12877         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12878         MOVE ER-0802                TO  EMI-ERROR
 12879         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12880
 12881     IF W-1523-ERROR-CODE = 0191
 12882         MOVE ER-0803                TO  EMI-ERROR
 12883         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12884
 12885     IF PI-COMPANY-ID      = 'HAN' AND
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 252
* EL156.cbl
 12886        PI-PMTTYPE         = '1'   AND
 12887        PI-3RD-PARTY-SW    = 'Y'   AND
 12888        W-1523-FORM-NUMBER = 'EOB1'
 12889           MOVE LOW-VALUES              TO W-1523-LINKDATA
 12890           MOVE PROGRAM-INTERFACE-BLOCK TO W-1523-COMMON-PI-DATA
 12891           MOVE 'EOB3'                  TO W-1523-FORM-NUMBER
 12892           GO TO 5000-GENERATE-AUTO-LETTER.
 12893
 12894 5000-END-UPDATE.
 12895
 12896     MOVE ER-0000                TO EMI-ERROR.
 12897     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12898     GO TO 7000-SHOW-CLAIM.
 12899
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 253
* EL156.cbl
 12901 5000-MOVE-NAME.
 12902     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 12903     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 12904     MOVE CL-INSURED-MID-INIT    TO MINITO.
 12905
 12906 5000-EXIT.
 12907     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 254
* EL156.cbl
 12909 5300-CREATE-DMO.
 12910
 12911     MOVE CL-CERT-KEY-DATA       TO W-NOTE-CERT-KEY.
 12912     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 12913     MOVE CL-CERT-NO             TO W-NOTE-CERT-NO.
 12914
 12915
 12916* EXEC CICS HANDLE CONDITION
 12917*         NOTFND   (5300-NOTE-NOT-FOUND)
 12918*    END-EXEC.
 12919*    MOVE '"$I                   ! - #00012294' TO DFHEIV0
 12920     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12921     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12922     MOVE X'2D20233030303132323934' TO DFHEIV0(25:11)
 12923     CALL 'kxdfhei1' USING DFHEIV0
 12924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12925
 12926
 12927
 12928* EXEC CICS READ
 12929*         DATASET('ERNOTE')
 12930*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 12931*         RIDFLD (W-NOTE-KEY)
 12932*    END-EXEC.
 12933     MOVE 'ERNOTE' TO DFHEIV1
 12934*    MOVE '&"S        E          (   #00012298' TO DFHEIV0
 12935     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12936     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12937     MOVE X'2020233030303132323938' TO DFHEIV0(25:11)
 12938     CALL 'kxdfhei1' USING DFHEIV0,
 12939           DFHEIV1,
 12940           DFHEIV20,
 12941           DFHEIV99,
 12942           W-NOTE-KEY,
 12943           DFHEIV99,
 12944           DFHEIV99,
 12945           DFHEIV99
 12946     SET ADDRESS OF CERTIFICATE-NOTE TO
 12947         DFHEIV20
 12948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12949
 12950
 12951     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 12952     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 12953     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 12954
 12955     IF CL-CERT-GROUPING (5:2) = ZEROS OR SPACES
 12956         MOVE 'CC'                   TO DCT-PRODUCT-CODE
 12957     ELSE
 12958         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 12959
 12960     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 12961     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 12962     MOVE 'DLO006'               TO PGM-NAME.
 12963
 12964
 12965* EXEC CICS LINK
 12966*        PROGRAM    (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 255
* EL156.cbl
 12967*        COMMAREA   (DCT-COMMUNICATION-AREA)
 12968*        LENGTH     (DCT-RCRD-LENGTH)
 12969*    END-EXEC.
 12970*    MOVE '."C                   ''   #00012317' TO DFHEIV0
 12971     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12972     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12973     MOVE X'2020233030303132333137' TO DFHEIV0(25:11)
 12974     CALL 'kxdfhei1' USING DFHEIV0,
 12975           PGM-NAME,
 12976           DCT-COMMUNICATION-AREA,
 12977           DCT-RCRD-LENGTH,
 12978           DFHEIV99,
 12979           DFHEIV99,
 12980           DFHEIV99
 12981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12982
 12983
 12984     IF DCT-RETURN-CODE = 'OK'
 12985         GO TO 5300-CONT.
 12986
 12987     IF DCT-RETURN-CODE = '01' OR '02'
 12988         GO TO 5300-EXIT.
 12989
 12990     IF DCT-RETURN-CODE = '03'
 12991         MOVE ER-0951            TO EMI-ERROR
 12992         GO TO 5300-BAD-EXIT.
 12993
 12994     IF DCT-RETURN-CODE = '04'
 12995         MOVE ER-0946            TO EMI-ERROR
 12996         GO TO 5300-BAD-EXIT.
 12997
 12998     IF DCT-RETURN-CODE = '05'
 12999         MOVE ER-0947            TO EMI-ERROR
 13000         GO TO 5300-BAD-EXIT.
 13001
 13002     IF DCT-RETURN-CODE = '06'
 13003         MOVE ER-0921            TO EMI-ERROR
 13004         GO TO 5300-BAD-EXIT.
 13005
 13006     IF DCT-RETURN-CODE = '07'
 13007         MOVE ER-0849            TO EMI-ERROR
 13008         GO TO 5300-BAD-EXIT.
 13009
 13010     IF DCT-RETURN-CODE = '08'
 13011         MOVE ER-0948            TO EMI-ERROR
 13012         GO TO 5300-BAD-EXIT.
 13013
 13014     IF DCT-RETURN-CODE = 'N1'
 13015         MOVE ER-0950            TO EMI-ERROR
 13016         GO TO 5300-BAD-EXIT.
 13017
 13018     IF DCT-RETURN-CODE = 'E1'
 13019         MOVE ER-0974            TO EMI-ERROR
 13020         GO TO 5300-BAD-EXIT.
 13021
 13022     IF DCT-RETURN-CODE = 'E2'
 13023         MOVE ER-0975            TO EMI-ERROR
 13024         GO TO 5300-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 256
* EL156.cbl
 13025
 13026     IF DCT-RETURN-CODE NOT = 'OK'
 13027         MOVE ER-0949            TO EMI-ERROR
 13028         GO TO 5300-BAD-EXIT.
 13029
 13030 5300-CONT.
 13031
 13032     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 13033     MOVE 'CS'                   TO DM-RECORD-TYPE.
 13034     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 13035     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 13036     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 13037     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 13038     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 13039     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 13040
 13041     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 13042     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 13043     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 13044     PERFORM 5350-FORMAT-LAST-NAME-1ST THRU 5350-EXIT.
 13045     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 13046
 13047     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 13048
 13049     IF PI-PMTTYPE = '2'
 13050         MOVE 'F'                TO DM-STAT-CHANGE-TYPE
 13051         MOVE '4'                TO DM-CLAIM-STATUS
 13052     ELSE
 13053         MOVE 'I'                TO DM-STAT-CHANGE-TYPE
 13054         MOVE '2'                TO DM-CLAIM-STATUS.
 13055
 13056     MOVE 'DLO025'               TO PGM-NAME.
 13057
 13058
 13059* EXEC CICS LINK
 13060*        PROGRAM    (PGM-NAME)
 13061*        COMMAREA   (DMO-COMMUNICATION-AREA)
 13062*        LENGTH     (DM-DMO-LENGTH)
 13063*    END-EXEC.
 13064*    MOVE '."C                   ''   #00012397' TO DFHEIV0
 13065     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13066     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13067     MOVE X'2020233030303132333937' TO DFHEIV0(25:11)
 13068     CALL 'kxdfhei1' USING DFHEIV0,
 13069           PGM-NAME,
 13070           DMO-COMMUNICATION-AREA,
 13071           DM-DMO-LENGTH,
 13072           DFHEIV99,
 13073           DFHEIV99,
 13074           DFHEIV99
 13075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13076
 13077
 13078     IF DM-RETURN-CODE = 'OK'
 13079         GO TO 5300-EXIT.
 13080
 13081     IF DM-RETURN-CODE = '01'
 13082         MOVE ER-8051            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 257
* EL156.cbl
 13083         GO TO 5300-BAD-EXIT.
 13084
 13085     IF DM-RETURN-CODE = '02'
 13086         MOVE ER-8052            TO EMI-ERROR
 13087         GO TO 5300-BAD-EXIT.
 13088
 13089     IF DM-RETURN-CODE = '03'
 13090         MOVE ER-8053            TO EMI-ERROR
 13091         GO TO 5300-BAD-EXIT.
 13092
 13093     IF DM-RETURN-CODE = '04'
 13094         MOVE ER-8054            TO EMI-ERROR
 13095         GO TO 5300-BAD-EXIT.
 13096
 13097     IF DM-RETURN-CODE = '05'
 13098         MOVE ER-8055            TO EMI-ERROR
 13099         GO TO 5300-BAD-EXIT.
 13100
 13101     IF DM-RETURN-CODE = '06'
 13102         MOVE ER-8056            TO EMI-ERROR
 13103         GO TO 5300-BAD-EXIT.
 13104
 13105     IF DM-RETURN-CODE = '07'
 13106         MOVE ER-8057            TO EMI-ERROR
 13107         GO TO 5300-BAD-EXIT.
 13108
 13109     IF DM-RETURN-CODE = '08'
 13110         MOVE ER-8058            TO EMI-ERROR
 13111         GO TO 5300-BAD-EXIT.
 13112
 13113     IF DM-RETURN-CODE = '09'
 13114         MOVE ER-8059            TO EMI-ERROR
 13115         GO TO 5300-BAD-EXIT.
 13116
 13117     IF DM-RETURN-CODE = '10'
 13118         MOVE ER-8060            TO EMI-ERROR
 13119         GO TO 5300-BAD-EXIT.
 13120
 13121     IF DM-RETURN-CODE = '11'
 13122         MOVE ER-8061            TO EMI-ERROR
 13123         GO TO 5300-BAD-EXIT.
 13124
 13125     IF DM-RETURN-CODE = '12'
 13126         MOVE ER-8062            TO EMI-ERROR
 13127         GO TO 5300-BAD-EXIT.
 13128
 13129     IF DM-RETURN-CODE = '13'
 13130         MOVE ER-8063            TO EMI-ERROR
 13131         GO TO 5300-BAD-EXIT.
 13132
 13133     IF DM-RETURN-CODE = '14'
 13134         MOVE ER-8064            TO EMI-ERROR
 13135         GO TO 5300-BAD-EXIT.
 13136
 13137     IF DM-RETURN-CODE = '15'
 13138         MOVE ER-8065            TO EMI-ERROR
 13139         GO TO 5300-BAD-EXIT.
 13140
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 258
* EL156.cbl
 13141     IF DM-RETURN-CODE = '16'
 13142         MOVE ER-8154            TO EMI-ERROR
 13143         GO TO 5300-BAD-EXIT.
 13144
 13145     IF DM-RETURN-CODE = '17'
 13146         MOVE ER-8155            TO EMI-ERROR
 13147         GO TO 5300-BAD-EXIT.
 13148
 13149     IF DM-RETURN-CODE = 'N1'
 13150         MOVE ER-8152            TO EMI-ERROR
 13151         GO TO 5300-BAD-EXIT.
 13152
 13153     IF DM-RETURN-CODE = 'E1'
 13154         MOVE ER-8153            TO EMI-ERROR
 13155         GO TO 5300-BAD-EXIT.
 13156
 13157     MOVE ER-8066            TO EMI-ERROR.
 13158     GO TO 5300-BAD-EXIT.
 13159
 13160 5300-NOTE-NOT-FOUND.
 13161
 13162     MOVE ER-0954                TO EMI-ERROR.
 13163     GO TO 5300-BAD-EXIT.
 13164
 13165 5300-BAD-EXIT.
 13166
 13167* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 13168*    MOVE '6"R                   !   #00012491' TO DFHEIV0
 13169     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 13170     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13171     MOVE X'2020233030303132343931' TO DFHEIV0(25:11)
 13172     CALL 'kxdfhei1' USING DFHEIV0
 13173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13174
 13175     IF MAP-NAME = 'EL156A'
 13176         MOVE -1             TO ENTERPFL
 13177       ELSE
 13178         MOVE LOW-VALUES     TO EL156BI
 13179         MOVE -1             TO ENTPFBL.
 13180
 13181     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13182     GO TO 8200-SEND-DATAONLY.
 13183
 13184 5300-EXIT.
 13185     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 259
* EL156.cbl
 13187 5350-FORMAT-LAST-NAME-1ST.
 13188*****************************************************************
 13189*             M O V E   N A M E   R O U T I N E                 *
 13190*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 13191*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 13192*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 13193*                  FIELD                   VALUE                *
 13194*           W-NAME-LAST    (CL15)      SMITH                    *
 13195*           W-NAME-FIRST   (CL15)      JOHN                     *
 13196*           W-NAME-MIDDLE  (CL15)      ALLEN                    *
 13197*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 13198*     CONTAIN                                                   *
 13199*                SMITH, JOHN ALLEN                              *
 13200*     OR                                                        *
 13201*                SMITH, JOHN A.                                 *
 13202*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 13203*     COPYBOOK, ELCNWA.                                         *
 13204*****************************************************************.
 13205
 13206     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
 13207     MOVE ZERO                   TO  WS-NAME-SW.
 13208     SET NWA-INDEX               TO +1.
 13209
 13210     IF W-NAME-LAST   = SPACES AND
 13211        W-NAME-MIDDLE = SPACES
 13212         MOVE +1                 TO WS-NAME-SW.
 13213
 13214     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 13215     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 13216
 13217     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 13218     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 13219
 13220     SET NWA-INDEX UP BY +1.
 13221
 13222     IF W-NAME-MIDDLE NOT = SPACES
 13223         IF W-NAME-MIDDLE-2 = SPACES
 13224             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 13225             SET NWA-INDEX UP BY +1
 13226             MOVE '.'            TO WS-NW (NWA-INDEX)
 13227             SET NWA-INDEX UP BY +2
 13228         ELSE
 13229             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 13230             PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 13231
 13232 5350-EXIT.
 13233     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 260
* EL156.cbl
 13235 5360-MOVE-NAME.
 13236
 13237     IF WS-NAME-SW > +1
 13238         GO TO 5360-EXIT.
 13239
 13240     IF WS-NAME-WORK2 = SPACES
 13241         GO TO 5360-EXIT.
 13242
 13243     SET NWA-INDEX2            TO +1.
 13244     SET NWA-INDEX3            TO +2.
 13245
 13246 5360-MOVE-NAME-CYCLE.
 13247
 13248     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
 13249
 13250     IF NWA-INDEX < +30
 13251         SET NWA-INDEX UP BY +1
 13252     ELSE
 13253         ADD +2                TO  WS-NAME-SW
 13254         GO TO 5360-EXIT.
 13255
 13256     IF NWA-INDEX2 < +20
 13257         SET NWA-INDEX3 UP BY +1
 13258         SET NWA-INDEX2 UP BY +1.
 13259
 13260     IF WS-NW2 (NWA-INDEX2) = SPACES AND
 13261        WS-NW2 (NWA-INDEX3) = SPACES
 13262         IF WS-NAME-SW = ZERO
 13263             MOVE ','            TO  WS-NW (NWA-INDEX)
 13264             SET NWA-INDEX UP BY +2
 13265             MOVE +1             TO  WS-NAME-SW
 13266             GO TO 5360-EXIT
 13267         ELSE
 13268             GO TO 5360-EXIT.
 13269
 13270     GO TO 5360-MOVE-NAME-CYCLE.
 13271
 13272 5360-EXIT.
 13273     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 261
* EL156.cbl
 13275 6000-BUILD-SCREEN-B.
 13276     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 13277     MOVE PI-CARRIER             TO MSTR-CARRIER.
 13278     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 13279     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 13280
 13281     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 13282
 13283 6050-BUILD-SCREEN.
 13284     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
 13285     MOVE LOW-VALUES             TO EL156BI.
 13286     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 13287
 13288     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 13289
 13290     IF PI-PAYEE-TYPE = 'I'
 13291        GO TO 6060-READ-TRAILER.
 13292
 13293     IF PI-PAYEE-TYPE = 'B'
 13294        ADD +10                  TO TRLR-SEQ-NO
 13295        GO TO 6060-READ-TRAILER.
 13296
 13297     IF PI-PAYEE-TYPE = 'A'
 13298        ADD +20                  TO TRLR-SEQ-NO
 13299        GO TO 6060-READ-TRAILER.
 13300
 13301     IF PI-PAYEE-TYPE = 'O'
 13302        ADD +50                  TO TRLR-SEQ-NO
 13303        GO TO 6060-READ-TRAILER.
 13304
 13305     IF PI-PAYEE-TYPE = 'Q'
 13306        ADD +60                  TO TRLR-SEQ-NO
 13307        GO TO 6060-READ-TRAILER.
 13308
 13309     IF PI-PAYEE-TYPE = 'P'
 13310        ADD +30                  TO TRLR-SEQ-NO
 13311        GO TO 6060-READ-TRAILER.
 13312
 13313     IF PI-PAYEE-TYPE = 'E'
 13314        ADD +40                  TO TRLR-SEQ-NO.
 13315
 13316 6060-READ-TRAILER.
 13317
 13318     IF PI-PAYEE-TYPE    = 'A' AND
 13319        PI-PAYEE-SEQ-NUM = 0
 13320          GO TO 6061-READ-ACCOUNT.
 13321
 13322     IF (PI-COMPANY-ID    = 'AIG' OR 'AUK')  AND
 13323        (PI-PAYEE-TYPE    = 'B')             AND
 13324        (PI-PAYEE-SEQ-NUM = 9)
 13325          PERFORM 7920-READ-BENE THRU 7920-EXIT
 13326          IF BENE-FOUND-SW = 'N'
 13327            GO TO 6065-NOT-FOUND
 13328          ELSE
 13329            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 13330            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 13331            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 13332*           MOVE BE-CITY-STATE     TO CITYSTBO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 262
* EL156.cbl
 13333            STRING BE-CITY ' ' BE-STATE
 13334               DELIMITED BY '  ' INTO CITYSTBO
 13335            END-STRING
 13336            MOVE BE-ZIP-CODE       TO ZIPBO
 13337            GO TO 6061-READ-ACCOUNT.
 13338
 13339     IF PI-PAYEE-TYPE    = 'B' AND
 13340        PI-PAYEE-SEQ-NUM = 0
 13341          PERFORM 7920-READ-BENE THRU 7920-EXIT
 13342          IF BENE-FOUND-SW = 'N'
 13343            GO TO 6065-NOT-FOUND
 13344          ELSE
 13345            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 13346            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 13347            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 13348*           MOVE BE-CITY-STATE     TO CITYSTBO
 13349            STRING BE-CITY ' ' BE-STATE
 13350               DELIMITED BY '  ' INTO CITYSTBO
 13351            END-STRING
 13352            MOVE BE-ZIP-CODE       TO ZIPBO
 13353            GO TO 6061-READ-ACCOUNT.
 13354
 13355
 13356* EXEC CICS HANDLE CONDITION
 13357*         NOTFND(6065-NOT-FOUND)
 13358*     END-EXEC.
 13359*    MOVE '"$I                   ! . #00012672' TO DFHEIV0
 13360     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13361     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13362     MOVE X'2E20233030303132363732' TO DFHEIV0(25:11)
 13363     CALL 'kxdfhei1' USING DFHEIV0
 13364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13365
 13366
 13367     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 13368
 13369     MOVE AT-MAIL-TO-NAME        TO PI-PAYEE-NAME.
 13370     MOVE AT-MAIL-TO-NAME        TO NAMEBO.
 13371     MOVE AT-ADDRESS-LINE-1      TO ADDR1BO.
 13372     MOVE AT-ADDRESS-LINE-2      TO ADDR2BO.
 13373*    MOVE AT-CITY-STATE          TO CITYSTBO.
 13374     STRING AT-CITY ' ' AT-STATE
 13375        DELIMITED BY '  ' INTO CITYSTBO
 13376     END-STRING
 13377     MOVE AT-ZIP-CODE            TO ZIPBO.
 13378
 13379 6061-READ-ACCOUNT.
 13380
 13381* EXEC CICS HANDLE CONDITION
 13382*         NOTFND(6068-ACCT-NOT-FND)
 13383*     END-EXEC.
 13384*    MOVE '"$I                   ! / #00012689' TO DFHEIV0
 13385     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13386     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13387     MOVE X'2F20233030303132363839' TO DFHEIV0(25:11)
 13388     CALL 'kxdfhei1' USING DFHEIV0
 13389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13390
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 263
* EL156.cbl
 13391
 13392
 13393* EXEC CICS READ
 13394*         DATASET('ERACCT')
 13395*         SET    (ADDRESS OF ACCOUNT-MASTER)
 13396*         RIDFLD (PI-ACCT-KEY)
 13397*     END-EXEC.
 13398     MOVE 'ERACCT' TO DFHEIV1
 13399*    MOVE '&"S        E          (   #00012693' TO DFHEIV0
 13400     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13401     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13402     MOVE X'2020233030303132363933' TO DFHEIV0(25:11)
 13403     CALL 'kxdfhei1' USING DFHEIV0,
 13404           DFHEIV1,
 13405           DFHEIV20,
 13406           DFHEIV99,
 13407           PI-ACCT-KEY,
 13408           DFHEIV99,
 13409           DFHEIV99,
 13410           DFHEIV99
 13411     SET ADDRESS OF ACCOUNT-MASTER TO
 13412         DFHEIV20
 13413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13414
 13415
 13416     MOVE AM-CARRIER             TO ACARRBO.
 13417     MOVE AM-GROUPING            TO GROUPBO.
 13418     MOVE AM-STATE               TO STATEBO.
 13419     MOVE AM-ACCOUNT             TO ACCTBO.
 13420     MOVE AM-NAME                TO ACCTNMBO.
 13421
 13422     IF PI-PAYEE-TYPE = 'A' AND
 13423        PI-PAYEE-SEQ-NUM = 0
 13424          MOVE AM-NAME             TO NAMEBO
 13425                                      PI-PAYEE-NAME
 13426          MOVE AM-ADDRS            TO ADDR1BO
 13427          MOVE SPACES              TO ADDR2BO
 13428*         MOVE AM-CITY             TO CITYSTBO
 13429          STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 13430             DELIMITED BY '  ' INTO CITYSTBO
 13431          END-STRING
 13432          MOVE AM-ZIP-PRIME        TO WS-ZIP
 13433          MOVE AM-ZIP-PLUS4        TO WS-ZIP-EXT
 13434          INSPECT WS-WORK-ZIP REPLACING ALL SPACES BY '0'
 13435          MOVE WS-NUMERIC-ZIP      TO ZIPBO.
 13436
 13437     IF CITYSTBO EQUAL SPACES
 13438         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 13439         GO TO 6070-FORMAT-DATA
 13440     END-IF.
 13441
 13442     MOVE CITYSTBO TO WS-PAYEE-CITY-STATE.
 13443     MOVE 'N' TO WS-PAYEE-STATE-FOUND.
 13444     MOVE 0 TO WS-BEG-SUB WS-END-SUB.
 13445     PERFORM VARYING WS-SUB FROM 30 BY -1
 13446          UNTIL WS-SUB = 0 OR PAYEE-STATE-FOUND
 13447        IF WS-END-SUB = 0  AND
 13448           (WS-PAYEE-CITY-ST (WS-SUB) EQUAL SPACES OR '.')
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 264
* EL156.cbl
 13449            CONTINUE
 13450        ELSE
 13451            IF WS-END-SUB = 0
 13452                MOVE WS-SUB TO WS-END-SUB
 13453            ELSE
 13454                IF WS-PAYEE-CITY-ST (WS-SUB) = SPACES
 13455                    COMPUTE WS-BEG-SUB = WS-SUB + 1
 13456                    MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 13457                END-IF
 13458            END-IF
 13459        END-IF
 13460        IF WS-PAYEE-CITY-ST (WS-SUB) EQUAL ','
 13461            COMPUTE WS-BEG-SUB = WS-SUB + 1
 13462            MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 13463        END-IF
 13464     END-PERFORM.
 13465
 13466     IF WS-BEG-SUB > 0
 13467         COMPUTE WS-STATE-LENGTH = WS-END-SUB - WS-BEG-SUB + 1
 13468         IF WS-STATE-LENGTH = 2
 13469             MOVE WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH)
 13470                  TO PI-CHECK-STATE-FOR-AK
 13471         ELSE
 13472             IF WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH) =
 13473                'ALASKA'
 13474                 MOVE 'AK' TO PI-CHECK-STATE-FOR-AK
 13475             ELSE
 13476                 MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 13477             END-IF
 13478         END-IF
 13479     ELSE
 13480         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 13481     END-IF.
 13482
 13483     GO TO 6070-FORMAT-DATA.
 13484
 13485 6065-NOT-FOUND.
 13486     MOVE 'NO ADDRESS RECORD FOUND'  TO ADDR1BO.
 13487     GO TO 6061-READ-ACCOUNT.
 13488
 13489 6068-ACCT-NOT-FND.
 13490     MOVE 'NO ACCOUNT RECORD FOUND'  TO ACCTNMBO.
 13491
 13492 6070-FORMAT-DATA.
 13493     IF PI-HOLDTIL = ZEROS
 13494        MOVE SAVE-DATE           TO PAYDTBI
 13495       ELSE
 13496        MOVE PI-HOLDTIL          TO PAYDTBO
 13497        INSPECT PAYDTBI REPLACING ALL SPACES BY '/'.
 13498
 13499     MOVE PI-PROOF-DATE          TO PROOFDBO.
 13500     INSPECT PROOFDBI REPLACING ALL SPACES BY '/'.
 13501
 13502     IF EIBAID = DFHPF3 OR DFHPF4
 13503        NEXT SENTENCE
 13504     ELSE
 13505       GO TO 6071-CONTINUE.
 13506
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 265
* EL156.cbl
 13507     MOVE PI-EPYFROM          TO PYFROMBO.
 13508     INSPECT PYFROMBI REPLACING ALL SPACES BY '/'.
 13509
 13510     IF NOT PI-USES-PAID-TO
 13511        MOVE PI-EPYTHRU          TO PYTHRUBO
 13512        INSPECT PYTHRUBI REPLACING ALL SPACES BY '/'
 13513     ELSE
 13514        MOVE PI-EPYTHRU       TO DC-GREG-DATE-1-MDY
 13515        MOVE '4'              TO DC-OPTION-CODE
 13516        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13517        IF NO-CONVERSION-ERROR
 13518           MOVE +1            TO DC-ELAPSED-DAYS
 13519           MOVE +0            TO DC-ELAPSED-MONTHS
 13520           MOVE '6'           TO DC-OPTION-CODE
 13521           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13522           IF NO-CONVERSION-ERROR
 13523              MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 13524
 13525     MOVE PI-EDAYS            TO DAYSBO.
 13526     MOVE PI-EPYAMT           TO PAYAMTBO.
 13527     IF PI-COMPANY-ID = 'CID'
 13528        IF PI-INT-AMT > ZEROS
 13529           MOVE PI-INT-AMT       TO INTAMTBO
 13530        END-IF
 13531     END-IF
 13532     GO TO 6072-SET-TYPE.
 13533
 13534 6071-CONTINUE.
 13535
 13536     IF PI-CPYFROM NOT = LOW-VALUES
 13537        MOVE PI-CPYFROM          TO DC-BIN-DATE-1
 13538        MOVE SPACES              TO DC-OPTION-CODE
 13539        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13540        MOVE DC-GREG-DATE-1-EDIT TO PYFROMBI.
 13541
 13542     IF PI-CPYTHRU NOT = LOW-VALUES
 13543        IF NOT PI-USES-PAID-TO
 13544           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 13545           MOVE SPACES             TO DC-OPTION-CODE
 13546           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13547           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI
 13548        ELSE
 13549           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 13550           MOVE '6'                TO DC-OPTION-CODE
 13551           MOVE +1                 TO DC-ELAPSED-DAYS
 13552           MOVE +0                 TO DC-ELAPSED-MONTHS
 13553           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13554           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 13555
 13556     MOVE PI-CDAYS               TO DAYSBO.
 13557     MOVE PI-CPYAMT              TO PAYAMTBO.
 13558     IF PI-COMPANY-ID = 'CID'
 13559        IF PI-INT-AMT > ZEROS
 13560           MOVE PI-INT-AMT       TO INTAMTBO
 13561        END-IF
 13562     END-IF
 13563     .
 13564 6072-SET-TYPE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 266
* EL156.cbl
 13565     IF PI-PMTTYPE = '1'
 13566        MOVE 'PARTIAL'           TO PAYTYPBO.
 13567
 13568     IF PI-PMTTYPE = '2'
 13569        MOVE 'FINAL'             TO PAYTYPBO.
 13570
 13571     IF PI-PMTTYPE = '3'
 13572        MOVE 'LUMP SUM'          TO PAYTYPBO.
 13573
 13574     IF PI-PMTTYPE = '4'
 13575        MOVE 'ADDITIONAL'        TO PAYTYPBO.
 13576
 13577     IF PI-PMTTYPE = '5'
 13578        MOVE 'CHARGEABLE'        TO PAYTYPBO.
 13579
 13580     IF PI-PMTTYPE = '6'
 13581        MOVE 'NON-CHARGEABLE'    TO PAYTYPBO.
 13582
 13583     IF PI-PROV-PMT
 13584        MOVE 'PROVISIONAL   '    TO PAYTYPBO.
 13585
 13586     IF PI-ECHECKNO NOT = SPACES
 13587        MOVE PI-ECHECKNO         TO CKNUMBO
 13588     ELSE
 13589        MOVE PI-CCHECKNO         TO CKNUMBO.
 13590
 13591     IF PI-COMPANY-ID = 'CID' OR 'DCC'
 13592        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 13593        MOVE +91                 TO  TRLR-SEQ-NO
 13594
 13595* EXEC CICS READ
 13596*           DATASET  ('ELTRLR')
 13597*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13598*           RIDFLD   (ELTRLR-KEY)
 13599*           RESP     (WS-RESPONSE)
 13600*       END-EXEC
 13601     MOVE 'ELTRLR' TO DFHEIV1
 13602*    MOVE '&"S        E          (  N#00012877' TO DFHEIV0
 13603     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13604     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13605     MOVE X'204E233030303132383737' TO DFHEIV0(25:11)
 13606     CALL 'kxdfhei1' USING DFHEIV0,
 13607           DFHEIV1,
 13608           DFHEIV20,
 13609           DFHEIV99,
 13610           ELTRLR-KEY,
 13611           DFHEIV99,
 13612           DFHEIV99,
 13613           DFHEIV99
 13614     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13615         DFHEIV20
 13616     MOVE EIBRESP  TO WS-RESPONSE
 13617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13618
 13619        IF WS-RESP-NORMAL
 13620           MOVE AT-INFO-LINE-1   TO  LOANNBO
 13621        ELSE
 13622           MOVE SPACES           TO  LOANNBO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 267
* EL156.cbl
 13623        END-IF
 13624     END-IF
 13625
 13626*       MOVE PI-LOAN-NO          TO LOANNBO
 13627
 13628     IF CKNUMBO = SPACES
 13629         MOVE SPACES             TO CKNUMHDO.
 13630
 13631     MOVE CL-CLAIM-NO            TO CLMNOBO.
 13632     MOVE CL-CARRIER             TO CARRBO.
 13633     MOVE CL-CERT-PRIME          TO CERTNOBO.
 13634     MOVE CL-CERT-SFX            TO SUFXBO.
 13635
 13636     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 13637        EVALUATE CL-CLAIM-TYPE
 13638           WHEN 'I'
 13639              MOVE '  IU  '      TO CLMTYPBO
 13640           WHEN 'G'
 13641              MOVE ' GAP  '      TO CLMTYPBO
 13642           WHEN OTHER
 13643              MOVE PI-AH-OVERRIDE-L6
 13644                                 TO CLMTYPBO
 13645        END-EVALUATE
 13646        MOVE ZEROS               TO UNDISBO
 13647*       MOVE PI-AH-OVERRIDE-L6   TO CLMTYPBO
 13648        IF PI-PMTTYPE = '5' OR '6'
 13649           GO TO 6073-GET-NOTIFY-DATA
 13650        ELSE
 13651           MOVE PI-DAILY-RATE    TO RATEBO
 13652           GO TO 6073-GET-NOTIFY-DATA.
 13653
 13654     MOVE PI-LIFE-OVERRIDE-L6    TO CLMTYPBO.
 13655
 13656     IF (PI-PMTTYPE = '5' OR '6') OR EIBAID = DFHPF5
 13657        MOVE ZEROS               TO UNDISBO
 13658     ELSE
 13659        COMPUTE UNDISBO = PI-CPYAMT - PI-EPYAMT.
 13660
 13661 6073-GET-NOTIFY-DATA.
 13662
 13663     MOVE 'N'                    TO  PI-3RD-PARTY-SW.
 13664
 13665     IF AM-NOTIF-OF-PAYMENTS NOT = 'Y'
 13666         MOVE SPACES             TO  NAMEB2O
 13667                                     ADDR1B2O
 13668                                     ADDR2B2O
 13669                                     CITYST2O
 13670                                     AGTHDGO
 13671         MOVE ZEROS              TO  ZIPB2O
 13672         GO TO 6080-SET-INCURRED.
 13673
 13674     MOVE ELMSTR-KEY             TO  ELTRLR-KEY.
 13675     MOVE +29                    TO  TRLR-SEQ-NO.
 13676
 13677
 13678* EXEC CICS HANDLE CONDITION
 13679*        NOTFND   (6074-GET-COMP-DATA)
 13680*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 268
* EL156.cbl
 13681*    MOVE '"$I                   ! 0 #00012942' TO DFHEIV0
 13682     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13683     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13684     MOVE X'3020233030303132393432' TO DFHEIV0(25:11)
 13685     CALL 'kxdfhei1' USING DFHEIV0
 13686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13687
 13688
 13689     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 13690
 13691     MOVE AT-MAIL-TO-NAME        TO  NAMEB2O.
 13692     MOVE AT-ADDRESS-LINE-1      TO  ADDR1B2O.
 13693     MOVE AT-ADDRESS-LINE-2      TO  ADDR2B2O.
 13694*    MOVE AT-CITY-STATE          TO  CITYST2O.
 13695     STRING AT-CITY ' ' AT-STATE
 13696        DELIMITED BY '  ' INTO CITYST2O
 13697     END-STRING
 13698     MOVE AT-ZIP-CODE            TO  ZIPB2O.
 13699     GO TO 6080-SET-INCURRED.
 13700
 13701 6074-GET-COMP-DATA.
 13702
 13703     IF AM-3RD-PARTY-NOTIF-LEVEL IS NOT NUMERIC
 13704         MOVE ZEROS              TO  AM-3RD-PARTY-NOTIF-LEVEL.
 13705
 13706     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = ZEROS OR SPACES
 13707         MOVE 'NO ADDRESS AVAILABLE' TO  NAMEB2O
 13708                                         ADDR1B2O
 13709                                         ADDR2B2O
 13710                                         CITYST2O
 13711         MOVE ZEROS                  TO  ZIPB2O
 13712         GO TO 6080-SET-INCURRED.
 13713
 13714     MOVE 'Y'                    TO  PI-3RD-PARTY-SW.
 13715     MOVE AM-COMPANY-CD          TO  COMP-COMP-CD.
 13716     MOVE AM-CARRIER             TO  COMP-CARRIER.
 13717     MOVE AM-GROUPING            TO  COMP-GROUP.
 13718     MOVE 'A'                    TO  COMP-TYPE.
 13719     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 13720                                 TO  COMP-FIN-RESP.
 13721
 13722     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
 13723         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
 13724                                       'G' OR 'B'
 13725             MOVE 'G'            TO  COMP-TYPE
 13726             MOVE LOW-VALUES     TO  COMP-ACCOUNT
 13727         ELSE
 13728             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 13729                                 TO  COMP-ACCOUNT
 13730     ELSE
 13731         MOVE 'G'                TO  COMP-TYPE
 13732         MOVE LOW-VALUES         TO  COMP-ACCOUNT.
 13733
 13734     PERFORM 7800-READ-COMP-MSTR THRU 7800-COMP-EXIT.
 13735
 13736     IF COMP-REC-FOUND
 13737         MOVE CO-ACCT-NAME       TO  NAMEB2O
 13738         MOVE CO-ADDR-1          TO  ADDR1B2O
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 269
* EL156.cbl
 13739         MOVE CO-ADDR-2          TO  ADDR2B2O
 13740*        MOVE CO-ADDR-3          TO  CITYST2O
 13741         STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 13742            DELIMITED BY '  ' INTO CITYST2O
 13743         END-STRING
 13744         MOVE CO-ZIP             TO  ZIPB2O
 13745     ELSE
 13746         MOVE 'NO COMP ADDRESS AVAILABLE'
 13747                                 TO  NAMEB2O
 13748                                     ADDR1B2O
 13749                                     ADDR2B2O
 13750                                     CITYST2O
 13751         MOVE ZEROS               TO ZIPB2O.
 13752
 13753 6080-SET-INCURRED.
 13754     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 13755     MOVE SPACES                 TO DC-OPTION-CODE.
 13756     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13757     MOVE DC-GREG-DATE-1-EDIT    TO INCURBO.
 13758     MOVE PI-PROCESSOR-ID        TO BYBO.
 13759     MOVE MAP-NAMEB              TO MAP-NAME.
 13760     MOVE 'C'                    TO PI-PASS-SW.
 13761     MOVE EIBAID                 TO PI-PFKEY-USED.
 13762     MOVE -1                     TO ENTPFBL.
 13763     GO TO 8100-SEND-INITIAL-MAP.
 13764
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 270
* EL156.cbl
 13766 6100-BUILD-PAYMENT-TRAILER.
 13767
 13768     IF PI-CHECK-STATE-FOR-AK = 'AK' AND PI-COMPANY-ID = 'CID'
 13769         GO TO 6105-STATE-CHECK-NUMBER
 13770     END-IF.
 13771
 13772     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13773     MOVE '6'                    TO CNTL-REC-TYPE.
 13774
 13775     IF CONTROL-IS-ACTUAL-CARRIER
 13776         MOVE PI-CARRIER         TO WS-CARR
 13777     ELSE
 13778         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 13779
 13780     IF PI-COMPANY-ID = 'FIA'
 13781         MOVE PI-CARRIER         TO  WS-CARR.
 13782
 13783     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 13784     MOVE 0                      TO CNTL-SEQ-NO.
 13785     MOVE 'CARR'                 TO FILE-SWITCH.
 13786
 13787     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 13788
 13789     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 13790         IF PI-OFFLINE     = 'Y' AND
 13791            PI-ECHECKNO-CR = 'CR'
 13792              GO TO 6110-READ-CONTROL
 13793         ELSE
 13794            IF PI-CASH = 'N'
 13795                GO TO 6110-READ-CONTROL.
 13796
 13797     IF CHECK-NO-MANUAL    OR
 13798        CHECK-NO-AT-PRINT  OR
 13799        PI-OFFLINE = 'Y'
 13800          GO TO 6130-BUILD-TRAILER.
 13801
 13802     IF PI-COMPANY-ID = 'FIA'
 13803         NEXT SENTENCE
 13804     ELSE
 13805         IF NOT CONTROL-IS-ACTUAL-CARRIER
 13806             GO TO 6110-READ-CONTROL.
 13807
 13808     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 13809
 13810     IF CHECK-CNT-RESET-VALUE
 13811        MOVE +1                  TO CF-CHECK-COUNTER
 13812     ELSE
 13813        ADD +1                   TO CF-CHECK-COUNTER.
 13814
 13815     MOVE CF-CHECK-COUNTER       TO WS-CHECK-NUMERIC.
 13816
 13817     IF CHECK-NO-CARR-SEQ
 13818        MOVE PI-CARRIER          TO WS-CHECK-CARR.
 13819
 13820     MOVE WS-CHECK-AREA          TO PI-CCHECKNO.
 13821     GO TO 6120-REWRITE.
 13822
 13823 6105-STATE-CHECK-NUMBER.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 271
* EL156.cbl
 13824     IF CHECK-NO-MANUAL    OR
 13825        CHECK-NO-AT-PRINT  OR
 13826        PI-OFFLINE = 'Y'
 13827           GO TO 6130-BUILD-TRAILER
 13828     END-IF.
 13829
 13830     MOVE PI-COMPANY-ID      TO CNTL-COMP-ID.
 13831     MOVE PI-CHECK-STATE-FOR-AK TO WS-ST-ACCESS.
 13832     MOVE WS-STATE-ACCESS    TO CNTL-ACCESS.
 13833     MOVE '3'                TO CNTL-REC-TYPE.
 13834     MOVE +0                 TO CNTL-SEQ-NO.
 13835     MOVE 'STAT'             TO FILE-SWITCH.
 13836     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 13837
 13838     IF CF-ST-CHECK-CNT-RESET
 13839         MOVE +1             TO CF-ST-CHECK-COUNTER
 13840     ELSE
 13841         ADD +1              TO CF-ST-CHECK-COUNTER
 13842     END-IF.
 13843
 13844     MOVE CF-ST-CHECK-COUNTER TO WS-CHECK-NUMERIC.
 13845     MOVE WS-CHECK-AREA       TO PI-CCHECKNO.
 13846     GO TO 6120-REWRITE.
 13847
 13848 6110-READ-CONTROL.
 13849     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13850     MOVE '1'                    TO CNTL-REC-TYPE.
 13851     MOVE SPACES                 TO CNTL-ACCESS.
 13852     MOVE 0                      TO CNTL-SEQ-NO.
 13853
 13854     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 13855
 13856     IF CO-CHECK-COUNT-RESET
 13857        MOVE +1                  TO CF-CO-CHECK-COUNTER
 13858     ELSE
 13859        ADD +1                   TO CF-CO-CHECK-COUNTER.
 13860
 13861     MOVE CF-CO-CHECK-COUNTER    TO WS-CHECK-NUMERIC.
 13862
 13863     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 13864         IF PI-OFFLINE     = 'Y'  AND
 13865            PI-ECHECKNO-CR = 'CR'
 13866              MOVE WS-A-CHECK-NUM-5   TO PI-ECHECKNO-5
 13867              MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 13868              MOVE AL-UANON           TO CHECKNOA
 13869              GO TO 6120-REWRITE
 13870         ELSE
 13871         IF PI-CASH = 'N'
 13872             MOVE 'N'                TO PI-ECHECKNO-N
 13873             MOVE WS-A-CHECK-NUM-6   TO PI-ECHECKNO-6
 13874             MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 13875             MOVE AL-UANON           TO CHECKNOA
 13876             GO TO 6120-REWRITE.
 13877
 13878     MOVE WS-CHECK-NUMERIC       TO PI-CCHECKNO.
 13879
 13880 6120-REWRITE.
 13881
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 272
* EL156.cbl
 13882* EXEC CICS REWRITE
 13883*         DATASET('ELCNTL')
 13884*         FROM(CONTROL-FILE)
 13885*     END-EXEC.
 13886     MOVE LENGTH OF
 13887      CONTROL-FILE
 13888       TO DFHEIV11
 13889     MOVE 'ELCNTL' TO DFHEIV1
 13890*    MOVE '&& L                  %   #00013138' TO DFHEIV0
 13891     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13892     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13893     MOVE X'2020233030303133313338' TO DFHEIV0(25:11)
 13894     CALL 'kxdfhei1' USING DFHEIV0,
 13895           DFHEIV1,
 13896           CONTROL-FILE,
 13897           DFHEIV11,
 13898           DFHEIV99
 13899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13900
 13901
 13902     MOVE 'Y'                    TO PI-CK-ASSIGN.
 13903
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 273
* EL156.cbl
 13905 6130-BUILD-TRAILER.
 13906
 13907
 13908* EXEC CICS GETMAIN
 13909*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 13910*         LENGTH    (200)
 13911*         INITIMG   (GETMAIN-SPACE)
 13912*     END-EXEC.
 13913     MOVE 200
 13914       TO DFHEIV11
 13915*    MOVE ',"IL                  $   #00013148' TO DFHEIV0
 13916     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13917     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13918     MOVE X'2020233030303133313438' TO DFHEIV0(25:11)
 13919     CALL 'kxdfhei1' USING DFHEIV0,
 13920           DFHEIV20,
 13921           DFHEIV11,
 13922           GETMAIN-SPACE
 13923     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13924         DFHEIV20
 13925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13926
 13927
 13928     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 13929                                    AT-PREV-PAID-THRU-DT.
 13930     MOVE LOW-VALUES             TO AT-PMT-PROOF-DT.
 13931     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT.
 13932     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 13933     MOVE 'AT'                   TO AT-RECORD-ID.
 13934     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 13935
 13936     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 13937        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 13938           MOVE +0               TO AT-PAYMENT-NOTE-SEQ-NO
 13939     ELSE
 13940           MOVE AT-SEQUENCE-NO   TO AT-PAYMENT-NOTE-SEQ-NO
 13941           SUBTRACT +1         FROM AT-PAYMENT-NOTE-SEQ-NO.
 13942
 13943     IF PI-COMPANY-ID = 'LAP' OR 'RMC'
 13944         IF AT-PAYMENT-NOTE-SEQ-NO = ZERO
 13945             MOVE AT-SEQUENCE-NO TO AT-FORM-CTL-SEQ-NO
 13946             SUBTRACT +1       FROM AT-FORM-CTL-SEQ-NO
 13947           ELSE
 13948             MOVE AT-PAYMENT-NOTE-SEQ-NO TO AT-FORM-CTL-SEQ-NO
 13949             SUBTRACT +1               FROM AT-FORM-CTL-SEQ-NO.
 13950
 13951     MOVE '2'                    TO AT-TRAILER-TYPE.
 13952     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 13953                                    AT-PAYMENT-LAST-MAINT-DT.
 13954     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 13955                                    AT-PAYMENT-LAST-UPDATED-BY.
 13956     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 13957     MOVE PI-PMTTYPE             TO AT-PAYMENT-TYPE.
 13958     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE.
 13959     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE.
 13960
 13961     IF PI-PMT-APPROVED
 13962        IF PI-OFFLINE  = 'N'
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 274
* EL156.cbl
 13963           MOVE 'U'              TO AT-PAYMENT-APPROVAL-SW.
 13964
 13965     IF PI-PFKEY-USED = DFHPF5
 13966        GO TO 6140-PF5-ENTERED.
 13967
 13968     MOVE PI-EEXPENS             TO AT-EXPENSE-PER-PMT.
 13969     MOVE PI-EPYAMT              TO AT-AMOUNT-PAID.
 13970
 13971     IF PI-AIG-SPECIAL-BENEFIT
 13972         IF WS-1ST-SPECIAL-PMT
 13973             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-EPYAMT / 1.5
 13974             COMPUTE PI-REDUND-PMTAMT = PI-EPYAMT -
 13975                                        AT-AMOUNT-PAID
 13976         ELSE
 13977             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 13978
 13979     MOVE PI-ETYPE               TO AT-EXPENSE-TYPE.
 13980
 13981     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 13982     MOVE '4'                    TO DC-OPTION-CODE.
 13983     PERFORM 9700-LINK-DATE-CONVERT.
 13984
 13985     IF DATE-CONVERSION-ERROR
 13986        MOVE LOW-VALUES          TO AT-PAID-FROM-DT
 13987     ELSE
 13988        MOVE DC-BIN-DATE-1       TO AT-PAID-FROM-DT.
 13989
 13990     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 13991     MOVE '4'                    TO DC-OPTION-CODE.
 13992     PERFORM 9700-LINK-DATE-CONVERT.
 13993
 13994     IF DATE-CONVERSION-ERROR
 13995        MOVE LOW-VALUES          TO AT-PAID-THRU-DT
 13996     ELSE
 13997        MOVE DC-BIN-DATE-1       TO AT-PAID-THRU-DT.
 13998
 13999     MOVE PI-EDAYS               TO AT-DAYS-IN-PERIOD.
 14000     GO TO 6150-FINISH-MOVE.
 14001
 14002 6140-PF5-ENTERED.
 14003     MOVE PI-CEXPENS             TO AT-EXPENSE-PER-PMT.
 14004     MOVE PI-CPYAMT              TO AT-AMOUNT-PAID.
 14005
 14006     IF PI-AIG-SPECIAL-BENEFIT
 14007         IF WS-1ST-SPECIAL-PMT
 14008             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-CPYAMT / 1.5
 14009             COMPUTE PI-REDUND-PMTAMT = PI-CPYAMT -
 14010                                        AT-AMOUNT-PAID
 14011         ELSE
 14012             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 14013
 14014     MOVE PI-CPYFROM             TO AT-PAID-FROM-DT.
 14015     MOVE PI-CPYTHRU             TO AT-PAID-THRU-DT.
 14016     MOVE PI-CDAYS               TO AT-DAYS-IN-PERIOD.
 14017
 14018 6150-FINISH-MOVE.
 14019
 14020     IF PI-ECHECKNO = SPACES
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 275
* EL156.cbl
 14021         MOVE PI-CCHECKNO    TO AT-CHECK-NO
 14022     ELSE
 14023         MOVE PI-ECHECKNO    TO AT-CHECK-NO.
 14024
 14025     MOVE PI-PAYEE               TO AT-PAYEE-TYPE-CD.
 14026     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME.
 14027
 14028     MOVE PI-GROUPED             TO AT-GROUPED-PAYMENT.
 14029     MOVE PI-CASH                TO AT-CASH-PAYMENT.
 14030
 14031     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14032         MOVE CL-ASSOCIATES      TO AT-ASSOCIATES.
 14033
 14034     IF PI-OFFLINE = 'N'
 14035        MOVE '1'                 TO AT-PAYMENT-ORIGIN
 14036        MOVE LOW-VALUES          TO AT-PMT-SELECT-DT
 14037     ELSE
 14038        MOVE PI-MONTH-END-SAVE   TO AT-PMT-SELECT-DT
 14039        MOVE '3'                 TO AT-PAYMENT-ORIGIN.
 14040
 14041     MOVE SPACES                 TO AT-AIG-UNEMP-IND.
 14042
 14043     IF WS-2ND-SPECIAL-PMT
 14044         MOVE 'Y'                TO AT-CASH-PAYMENT
 14045         MOVE SPACES             TO AT-CHECK-NO
 14046         MOVE '3'                TO AT-PAYMENT-ORIGIN
 14047         MOVE PI-MONTH-END-SAVE  TO AT-PMT-SELECT-DT
 14048         MOVE 'U'                TO AT-AIG-UNEMP-IND
 14049         MOVE 'I'                TO AT-PAYEE-TYPE-CD.
 14050
 14051     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 14052                                    AT-TO-BE-WRITTEN-DT.
 14053
 14054     IF PI-HOLDTIL NOT = ZEROS
 14055        MOVE PI-HOLDTIL          TO DC-GREG-DATE-1-MDY
 14056        MOVE '4'                 TO DC-OPTION-CODE
 14057        PERFORM 9700-LINK-DATE-CONVERT
 14058        IF PI-OFFLINE = 'N'
 14059           MOVE DC-BIN-DATE-1    TO AT-TO-BE-WRITTEN-DT
 14060        ELSE
 14061           MOVE DC-BIN-DATE-1    TO AT-CHECK-WRITTEN-DT.
 14062
 14063     MOVE PI-ERESV               TO AT-ADDL-RESERVE.
 14064     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 14065                                    AT-CHECK-QUE-SEQUENCE.
 14066
 14067     IF PI-PFKEY-USED = DFHPF4
 14068        MOVE '1'                 TO AT-FORCE-CONTROL.
 14069
 14070     IF PI-PMTTYPE NOT = '4' AND '5' AND '6'
 14071        MOVE CL-LAST-PMT-DT      TO AT-PREV-LAST-PMT-DT
 14072        MOVE CL-PAID-THRU-DT     TO AT-PREV-PAID-THRU-DT
 14073        MOVE CL-LAST-PMT-AMT     TO AT-PREV-LAST-PMT-AMT.
 14074
 14075     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 14076                                    AT-VOID-SELECT-DT
 14077                                    AT-VOID-ACCEPT-DT
 14078                                    AT-VOID-DT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 276
* EL156.cbl
 14079     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 14080        AND (PI-PMTTYPE NOT = '4' AND '5' AND '6')
 14081        MOVE PI-DAILY-RATE       TO AT-DAILY-RATE
 14082        MOVE PI-BEN-DAYS         TO AT-ELIMINATION-DAYS
 14083        MOVE PI-BEN-TYPE         TO AT-BENEFIT-TYPE
 14084     ELSE
 14085        MOVE ZEROS               TO AT-DAILY-RATE
 14086                                    AT-ELIMINATION-DAYS
 14087        MOVE SPACES              TO AT-BENEFIT-TYPE
 14088     END-IF
 14089     MOVE PI-PROOF-DATE          TO DC-GREG-DATE-1-MDY.
 14090     MOVE '4'                    TO DC-OPTION-CODE.
 14091     PERFORM 9700-LINK-DATE-CONVERT.
 14092     IF DATE-CONVERSION-ERROR
 14093         MOVE LOW-VALUES          TO AT-PMT-PROOF-DT
 14094     ELSE
 14095         MOVE DC-BIN-DATE-1       TO AT-PMT-PROOF-DT
 14096     END-IF.
 14097     MOVE PI-PRINT-EOB-YN        TO AT-PRINT-EOB-WITH-CHECK
 14098*******************************************************
 14099     IF NOT PI-PMT-GRADUATED
 14100         GO TO 6170-WRITE.
 14101
 14102     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14103     MOVE '1'                    TO CNTL-REC-TYPE.
 14104     MOVE SPACES                 TO CNTL-ACCESS.
 14105     MOVE +0                     TO CNTL-SEQ-NO.
 14106     MOVE 'COMP'                 TO FILE-SWITCH.
 14107
 14108     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 14109
 14110     IF PAID-FOR-LIFE
 14111         IF AT-AMOUNT-PAID < PI-MAX-LF-PMT-TOL
 14112             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 14113                                     WS-PMT-APPROVAL-SW
 14114             GO TO 6170-WRITE.
 14115
 14116*05999      IF PAID-FOR-AH
 14117     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 14118         IF AT-AMOUNT-PAID < PI-MAX-PMT-TOL
 14119             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 14120                                     WS-PMT-APPROVAL-SW
 14121             GO TO 6170-WRITE.
 14122
 14123     MOVE '1'                    TO AT-APPROVED-LEVEL.
 14124
 14125******A&H Limits are set as a monthly payment.  Calculate the mont
 14126******equivalent of the amount paid today
 14127     IF PI-SAVE-ELAPSED-MONTHS > 0 OR
 14128        PI-SAVE-ODD-DAYS-OVER > 0
 14129           COMPUTE WS-CALC-PMT-MONTHS = (PI-SAVE-ODD-DAYS-OVER
 14130                               / 30) + PI-SAVE-ELAPSED-MONTHS
 14131           COMPUTE WS-CALC-MO-AH-AMT ROUNDED = AT-AMOUNT-PAID /
 14132                                  WS-CALC-PMT-MONTHS
 14133     ELSE
 14134           MOVE AT-AMOUNT-PAID TO WS-CALC-MO-AH-AMT
 14135     END-IF.
 14136*06007      IF ((PAID-FOR-AH) AND
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 277
* EL156.cbl
 14137     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 14138*06008         (CF-AH-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 14139        (CF-AH-PAY-APP-LEVEL-1 >= WS-CALC-MO-AH-AMT))
 14140              OR
 14141        ((PAID-FOR-LIFE) AND
 14142        (CF-LIFE-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 14143            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 14144       ELSE
 14145*06014      IF ((PAID-FOR-AH)  AND
 14146         IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 14147*06015         (CF-AH-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 14148           (CF-AH-PAY-APP-LEVEL-2 >= WS-CALC-MO-AH-AMT))
 14149              OR
 14150        ((PAID-FOR-LIFE) AND
 14151        (CF-LIFE-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 14152            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 14153         ELSE
 14154*06021             MOVE '3'         TO AT-APPROVAL-LEVEL-REQD.
 14155           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 14156               (CF-AH-PAY-APP-LEVEL-3 >= WS-CALC-MO-AH-AMT))
 14157              OR
 14158          ((PAID-FOR-LIFE) AND
 14159          (CF-LIFE-PAY-APP-LEVEL-3 >= AT-AMOUNT-PAID))
 14160            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 14161       ELSE
 14162            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD.
 14163
 14164     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 14165        (CF-AH-APP-DAY-LEVEL-1 >= AT-DAYS-IN-PERIOD))
 14166        IF ('1' >= AT-APPROVAL-LEVEL-REQD)
 14167            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 14168        END-IF
 14169     ELSE
 14170     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 14171        (CF-AH-APP-DAY-LEVEL-2 >= AT-DAYS-IN-PERIOD))
 14172        IF ('2' >= AT-APPROVAL-LEVEL-REQD)
 14173            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 14174        END-IF
 14175     ELSE
 14176     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 14177        (CF-AH-APP-DAY-LEVEL-3 >= AT-DAYS-IN-PERIOD))
 14178        IF ('3' >= AT-APPROVAL-LEVEL-REQD)
 14179            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 14180        END-IF
 14181     ELSE
 14182     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 14183            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD.
 14184
 14185     MOVE AT-APPROVAL-LEVEL-REQD TO WS-SAVE-APPROVAL-LEVEL-REQD.
 14186
 14187     IF NOT PI-PMT-GRADUATED
 14188         GO TO 6170-WRITE.
 14189
 14190
 14191* EXEC CICS HANDLE CONDITION
 14192*        NOTFND   (6170-WRITE)
 14193*    END-EXEC.
 14194*    MOVE '"$I                   ! 1 #00013416' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 278
* EL156.cbl
 14195     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14196     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14197     MOVE X'3120233030303133343136' TO DFHEIV0(25:11)
 14198     CALL 'kxdfhei1' USING DFHEIV0
 14199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14200
 14201
 14202     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14203     MOVE '2'                    TO CNTL-REC-TYPE.
 14204     MOVE +0                     TO CNTL-SEQ-NO.
 14205     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 14206
 14207
 14208* EXEC CICS READ
 14209*         DATASET  ('ELCNTL')
 14210*         SET      (ADDRESS OF CONTROL-FILE)
 14211*         RIDFLD   (ELCNTL-KEY)
 14212*    END-EXEC.
 14213     MOVE 'ELCNTL' TO DFHEIV1
 14214*    MOVE '&"S        E          (   #00013425' TO DFHEIV0
 14215     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14216     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14217     MOVE X'2020233030303133343235' TO DFHEIV0(25:11)
 14218     CALL 'kxdfhei1' USING DFHEIV0,
 14219           DFHEIV1,
 14220           DFHEIV20,
 14221           DFHEIV99,
 14222           ELCNTL-KEY,
 14223           DFHEIV99,
 14224           DFHEIV99,
 14225           DFHEIV99
 14226     SET ADDRESS OF CONTROL-FILE TO
 14227         DFHEIV20
 14228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14229
 14230
 14231     MOVE CF-APPROVAL-LEVEL TO WS-APPROVAL-LEVEL.
 14232
 14233     IF WS-APPROVAL-LEVEL = '1' OR '2' OR '3'
 14234                         OR '4'
 14235         NEXT SENTENCE
 14236     ELSE
 14237         MOVE 'Y' TO WS-NEED-APPROVAL
 14238         GO TO 6170-WRITE.
 14239
 14240     IF WS-APPROVAL-LEVEL < AT-APPROVAL-LEVEL-REQD
 14241         MOVE 'Y' TO WS-NEED-APPROVAL
 14242         IF WS-APPROVAL-LEVEL = '1'
 14243             MOVE '2'        TO  AT-APPROVED-LEVEL
 14244                            WS-SAVE-APPROVED-LEVEL
 14245             GO TO 6170-WRITE
 14246         ELSE
 14247             IF WS-APPROVAL-LEVEL = '2'
 14248                 MOVE '3'        TO  AT-APPROVED-LEVEL
 14249                                WS-SAVE-APPROVED-LEVEL
 14250                 GO TO 6170-WRITE
 14251             ELSE IF WS-APPROVAL-LEVEL = '3'
 14252                 MOVE '4'        TO  AT-APPROVED-LEVEL
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 279
* EL156.cbl
 14253                                WS-SAVE-APPROVED-LEVEL
 14254                 GO TO 6170-WRITE.
 14255
 14256     MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 14257                             WS-PMT-APPROVAL-SW.
 14258     MOVE SPACES         TO  AT-APPROVED-LEVEL
 14259                             AT-APPROVAL-LEVEL-REQD.
 14260
 14261*******************************************************
 14262
 14263 6170-WRITE.
 14264
 14265     IF PI-COMPANY-ID = 'DMD'
 14266        IF PI-AT-EOB-CODES NOT = SPACES
 14267           MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 14268           MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 14269           MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 14270           MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 14271           MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 14272
 14273
 14274* EXEC CICS HANDLE CONDITION
 14275*        DUPREC    (6180-DUPREC)
 14276*    END-EXEC.
 14277*    MOVE '"$%                   ! 2 #00013473' TO DFHEIV0
 14278     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14279     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14280     MOVE X'3220233030303133343733' TO DFHEIV0(25:11)
 14281     CALL 'kxdfhei1' USING DFHEIV0
 14282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14283
 14284
 14285
 14286* EXEC CICS WRITE
 14287*         DATASET       ('ELTRLR')
 14288*         FROM          (ACTIVITY-TRAILERS)
 14289*         RIDFLD        (AT-CONTROL-PRIMARY)
 14290*     END-EXEC.
 14291     MOVE LENGTH OF
 14292      ACTIVITY-TRAILERS
 14293       TO DFHEIV11
 14294     MOVE 'ELTRLR' TO DFHEIV1
 14295*    MOVE '&$ L                  ''   #00013477' TO DFHEIV0
 14296     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14297     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14298     MOVE X'2020233030303133343737' TO DFHEIV0(25:11)
 14299     CALL 'kxdfhei1' USING DFHEIV0,
 14300           DFHEIV1,
 14301           ACTIVITY-TRAILERS,
 14302           DFHEIV11,
 14303           AT-CONTROL-PRIMARY,
 14304           DFHEIV99,
 14305           DFHEIV99
 14306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14307
 14308
 14309     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 14310        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 280
* EL156.cbl
 14311*06088           GO TO 6199-EXIT.
 14312           GO TO 6176-APPROVAL-NOTE.
 14313
 14314
 14315* EXEC CICS GETMAIN
 14316*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 14317*         LENGTH    (200)
 14318*         INITIMG   (GETMAIN-SPACE)
 14319*     END-EXEC.
 14320     MOVE 200
 14321       TO DFHEIV11
 14322*    MOVE ',"IL                  $   #00013488' TO DFHEIV0
 14323     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14324     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14325     MOVE X'2020233030303133343838' TO DFHEIV0(25:11)
 14326     CALL 'kxdfhei1' USING DFHEIV0,
 14327           DFHEIV20,
 14328           DFHEIV11,
 14329           GETMAIN-SPACE
 14330     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14331         DFHEIV20
 14332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14333
 14334
 14335     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 14336
 14337     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 14338     MOVE 'AT'                   TO AT-RECORD-ID.
 14339     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 14340     MOVE '6'                    TO AT-TRAILER-TYPE.
 14341     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 14342                                    AT-GEN-INFO-LAST-MAINT-DT
 14343     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 14344                                    AT-GEN-INFO-LAST-UPDATED-BY
 14345     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 14346
 14347     MOVE PI-PMTNOTE1            TO AT-INFO-LINE-1.
 14348     MOVE PI-PMTNOTE2            TO AT-INFO-LINE-2
 14349     MOVE PI-EOB-CODES-EXIST     TO AT-EOB-CODES-EXIST
 14350
 14351     MOVE 'P'                    TO AT-INFO-TRAILER-TYPE.
 14352
 14353 6175-WRITE.
 14354
 14355
 14356* EXEC CICS HANDLE CONDITION
 14357*        DUPREC    (6190-DUPREC)
 14358*    END-EXEC.
 14359*    MOVE '"$%                   ! 3 #00013514' TO DFHEIV0
 14360     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14361     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14362     MOVE X'3320233030303133353134' TO DFHEIV0(25:11)
 14363     CALL 'kxdfhei1' USING DFHEIV0
 14364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14365
 14366
 14367
 14368* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 281
* EL156.cbl
 14369*         DATASET     ('ELTRLR')
 14370*         FROM        (ACTIVITY-TRAILERS)
 14371*         RIDFLD      (AT-CONTROL-PRIMARY)
 14372*     END-EXEC.
 14373     MOVE LENGTH OF
 14374      ACTIVITY-TRAILERS
 14375       TO DFHEIV11
 14376     MOVE 'ELTRLR' TO DFHEIV1
 14377*    MOVE '&$ L                  ''   #00013518' TO DFHEIV0
 14378     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14379     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14380     MOVE X'2020233030303133353138' TO DFHEIV0(25:11)
 14381     CALL 'kxdfhei1' USING DFHEIV0,
 14382           DFHEIV1,
 14383           ACTIVITY-TRAILERS,
 14384           DFHEIV11,
 14385           AT-CONTROL-PRIMARY,
 14386           DFHEIV99,
 14387           DFHEIV99
 14388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14389
 14390
 14391 6176-APPROVAL-NOTE.
 14392
 14393     IF NOT APPROVAL-NEEDED
 14394         GO TO 6199-EXIT.
 14395
 14396
 14397* EXEC CICS GETMAIN
 14398*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 14399*        LENGTH    (200)
 14400*        INITIMG   (GETMAIN-SPACE)
 14401*    END-EXEC.
 14402     MOVE 200
 14403       TO DFHEIV11
 14404*    MOVE ',"IL                  $   #00013529' TO DFHEIV0
 14405     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14406     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14407     MOVE X'2020233030303133353239' TO DFHEIV0(25:11)
 14408     CALL 'kxdfhei1' USING DFHEIV0,
 14409           DFHEIV20,
 14410           DFHEIV11,
 14411           GETMAIN-SPACE
 14412     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14413         DFHEIV20
 14414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14415
 14416
 14417     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT
 14418
 14419     MOVE ELMSTR-KEY         TO AT-CONTROL-PRIMARY
 14420     MOVE 'AT'               TO AT-RECORD-ID
 14421     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO
 14422     MOVE '6'                TO AT-TRAILER-TYPE
 14423     MOVE WS-TODAY-DATE      TO AT-RECORDED-DT
 14424                                AT-GEN-INFO-LAST-MAINT-DT
 14425     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 14426                                AT-GEN-INFO-LAST-UPDATED-BY
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 282
* EL156.cbl
 14427     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS
 14428
 14429     MOVE WS-APPROV-NOTE     TO AT-INFO-LINE-1
 14430     MOVE SPACES             TO AT-INFO-LINE-2
 14431
 14432     MOVE 'R'                TO AT-INFO-TRAILER-TYPE.
 14433 6177-WRITE.
 14434
 14435
 14436* EXEC CICS HANDLE CONDITION
 14437*        DUPREC    (6185-DUPREC)
 14438*    END-EXEC.
 14439*    MOVE '"$%                   ! 4 #00013553' TO DFHEIV0
 14440     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14441     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14442     MOVE X'3420233030303133353533' TO DFHEIV0(25:11)
 14443     CALL 'kxdfhei1' USING DFHEIV0
 14444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14445
 14446
 14447
 14448* EXEC CICS WRITE
 14449*         DATASET     ('ELTRLR')
 14450*         FROM        (ACTIVITY-TRAILERS)
 14451*         RIDFLD      (AT-CONTROL-PRIMARY)
 14452*     END-EXEC.
 14453     MOVE LENGTH OF
 14454      ACTIVITY-TRAILERS
 14455       TO DFHEIV11
 14456     MOVE 'ELTRLR' TO DFHEIV1
 14457*    MOVE '&$ L                  ''   #00013557' TO DFHEIV0
 14458     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14459     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14460     MOVE X'2020233030303133353537' TO DFHEIV0(25:11)
 14461     CALL 'kxdfhei1' USING DFHEIV0,
 14462           DFHEIV1,
 14463           ACTIVITY-TRAILERS,
 14464           DFHEIV11,
 14465           AT-CONTROL-PRIMARY,
 14466           DFHEIV99,
 14467           DFHEIV99
 14468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14469
 14470
 14471
 14472     GO TO 6199-EXIT.
 14473
 14474 6180-DUPREC.
 14475
 14476     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 14477     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 14478     GO TO 6170-WRITE.
 14479
 14480 6185-DUPREC.
 14481     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 14482     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 14483     GO TO 6177-WRITE.
 14484
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 283
* EL156.cbl
 14485 6190-DUPREC.
 14486     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 14487     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 14488     GO TO 6175-WRITE.
 14489
 14490 6199-EXIT.
 14491      EXIT.
 14492
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 284
* EL156.cbl
 14494 6200-UPDATE-CLAIM-MSTR.
 14495     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 14496     MOVE PI-CARRIER             TO MSTR-CARRIER.
 14497     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 14498     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 14499
 14500     PERFORM 7910-READ-CLAIM-UPDATE THRU 7910-EXIT.
 14501
 14502     MOVE ZEROS                  TO W-INTEREST.
 14503
 14504     IF PI-COMPANY-ID EQUAL 'CID' OR 'DCC'
 14505        IF (PI-OFFLINE = 'Y') OR
 14506           (PI-PMTTYPE = '7')
 14507           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 14508                                 THRU 9870-EXIT
 14509        END-IF
 14510     END-IF
 14511     IF NOT ERROR-ON-OUTPUT
 14512        CONTINUE
 14513     ELSE
 14514
 14515* EXEC CICS REWRITE
 14516*          DATASET('ELMSTR')
 14517*          FROM(CLAIM-MASTER)
 14518*       END-EXEC
 14519     MOVE LENGTH OF
 14520      CLAIM-MASTER
 14521       TO DFHEIV11
 14522     MOVE 'ELMSTR' TO DFHEIV1
 14523*    MOVE '&& L                  %   #00013606' TO DFHEIV0
 14524     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14525     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14526     MOVE X'2020233030303133363036' TO DFHEIV0(25:11)
 14527     CALL 'kxdfhei1' USING DFHEIV0,
 14528           DFHEIV1,
 14529           CLAIM-MASTER,
 14530           DFHEIV11,
 14531           DFHEIV99
 14532     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14533
 14534        MOVE -1                  TO ENTPFBL
 14535        MOVE AL-UANON            TO ENTPFBA
 14536        MOVE MAP-NAMEB           TO MAP-NAME
 14537        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14538        GO TO 8200-SEND-DATAONLY
 14539     END-IF
 14540
 14541     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 14542
 14543     MOVE SPACES TO WS-PAYMENT-TRAILER-SW.
 14544
 14545     IF PI-AIG-SPECIAL-BENEFIT
 14546         MOVE '1' TO WS-PAYMENT-TRAILER-SW.
 14547
 14548     PERFORM 6100-BUILD-PAYMENT-TRAILER THRU 6199-EXIT.
 14549
 14550     IF PI-SPECIAL-BEN-SW = 'Y'
 14551         MOVE '2' TO WS-PAYMENT-TRAILER-SW
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 285
* EL156.cbl
 14552         PERFORM 6130-BUILD-TRAILER THRU 6199-EXIT.
 14553
 14554     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14555         PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT
 14556     ELSE
 14557         IF PI-PMTTYPE NOT = '4'
 14558            PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT.
 14559
 14560     IF PI-PMTTYPE = '5' OR '6'
 14561        GO TO  6250-SET-MAINT.
 14562
 14563     MOVE ZEROS                      TO  CL-LAPSE-REPORT-CODE
 14564                                         CL-LAG-REPORT-CODE.
 14565
 14566     IF CL-ACTIVITY-CODE = 09
 14567         GO TO 6200-CONT-UPDATE.
 14568
 14569     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14570         IF CL-ACTIVITY-CODE = 11
 14571             GO TO 6200-CONT-UPDATE.
 14572
 14573     IF WS-ACT-REC-FOUND-SW = 'N'
 14574         GO TO 6200-CONT-UPDATE.
 14575
 14576     IF PI-RESET-SW = 'Y' OR PI-PROV-PMT
 14577         MOVE WS-TODAY-DATE          TO  CL-ACTIVITY-MAINT-DT
 14578         MOVE 'PMT'                  TO  CL-ACTIVITY-MAINT-TYPE
 14579         MOVE WS-ACTIVITY-CODE       TO  CL-ACTIVITY-CODE.
 14580
 14581     IF WS-UPDATE-SW = 'Y'
 14582         MOVE LOW-VALUES             TO  CL-NEXT-RESEND-DT
 14583                                         CL-NEXT-FOLLOWUP-DT.
 14584
 14585 6200-CONT-UPDATE.
 14586
 14587     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14588       IF CLAIM-IS-CLOSED
 14589         IF PI-PMTTYPE = '2' OR '3' OR '4'
 14590           IF WS-OPEN-CLOSE-SW = '2'
 14591             MOVE WS-TODAY-DATE     TO  CL-LAST-REOPEN-DT
 14592                                        CL-LAST-CLOSE-DT.
 14593
 14594     IF CLAIM-IS-CLOSED AND PI-PMTTYPE = '1'
 14595        MOVE WS-TODAY-DATE       TO CL-LAST-REOPEN-DT
 14596        MOVE 'O'                 TO CL-CLAIM-STATUS.
 14597
 14598     IF PI-PMTTYPE = ('2' OR '3') AND CLAIM-IS-OPEN
 14599        MOVE WS-TODAY-DATE       TO CL-LAST-CLOSE-DT
 14600        MOVE '1'                 TO CL-LAST-CLOSE-REASON
 14601        MOVE 'C'                 TO CL-CLAIM-STATUS
 14602        IF PI-PMTTYPE = '2'
 14603           AND (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 14604           CONTINUE
 14605        ELSE
 14606           PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 14607        END-IF
 14608     ELSE
 14609        IF PI-PMTTYPE = '2' OR '3'
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 286
* EL156.cbl
 14610           IF PI-PMTTYPE = '2' AND
 14611              (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 14612              CONTINUE
 14613           ELSE
 14614              PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 14615           END-IF
 14616        END-IF
 14617     END-IF
 14618
 14619     IF PI-PMTTYPE = '4'
 14620        PERFORM 6300-UPDATE-CERT THRU 6399-EXIT.
 14621
 14622     IF PI-COMPANY-ID = 'CVL'
 14623         IF PI-LOAN-UPDATE-SW = 'Y'
 14624             MOVE PI-COMPANY-CD      TO  CERT-COMP-CD
 14625             MOVE CL-CERT-CARRIER    TO  CERT-CARRIER
 14626             MOVE CL-CERT-GROUPING   TO  CERT-GROUPING
 14627             MOVE CL-CERT-STATE      TO  CERT-STATE
 14628             MOVE CL-CERT-ACCOUNT    TO  CERT-ACCOUNT
 14629             MOVE CL-CERT-EFF-DT     TO  CERT-EFF-DT
 14630             MOVE CL-CERT-NO         TO  CERT-CERT-NO
 14631             MOVE 'CERT'             TO  FILE-SWITCH
 14632             PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT
 14633             MOVE PI-LOAN-NO         TO  CM-BENEFICIARY
 14634             PERFORM 6350-REWRITE-CERT THRU 6399-EXIT.
 14635
 14636     IF PI-PFKEY-USED = DFHPF5 AND PI-PROCESSOR-ID NOT = 'FIX '
 14637        GO TO 6220-USE-COMPUTED.
 14638
 14639     IF (PI-PMTTYPE = '4')  AND
 14640        (PI-EPYAMT < ZEROS)
 14641          COMPUTE CL-NO-OF-DAYS-PAID =
 14642                       CL-NO-OF-DAYS-PAID - PI-EDAYS
 14643          IF CL-NO-OF-DAYS-PAID < +0
 14644              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 14645          ELSE
 14646              NEXT SENTENCE
 14647     ELSE
 14648          ADD PI-EDAYS           TO CL-NO-OF-DAYS-PAID.
 14649
 14650     IF PI-PROCESSOR-ID = 'FIX '
 14651        IF CL-TOTAL-PAID-AMT NOT = ZEROS
 14652           NEXT SENTENCE
 14653        ELSE
 14654           ADD PI-EPYAMT         TO CL-TOTAL-PAID-AMT
 14655     ELSE
 14656        ADD PI-EPYAMT            TO CL-TOTAL-PAID-AMT.
 14657
 14658     IF PI-PMTTYPE = '4'
 14659        GO TO 6250-SET-MAINT.
 14660
 14661     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 14662
 14663     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 14664     MOVE '4'                    TO DC-OPTION-CODE.
 14665     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14666     IF DATE-CONVERSION-ERROR
 14667        MOVE LOW-VALUES          TO CL-PAID-THRU-DT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 287
* EL156.cbl
 14668     ELSE
 14669        IF DC-BIN-DATE-1 > CL-PAID-THRU-DT
 14670           MOVE DC-BIN-DATE-1    TO CL-PAID-THRU-DT
 14671           IF PI-AIG-SPECIAL-BENEFIT
 14672               COMPUTE CL-LAST-PMT-AMT = PI-EPYAMT / 1.5
 14673           ELSE
 14674               MOVE PI-EPYAMT        TO CL-LAST-PMT-AMT.
 14675
 14676     GO TO 6250-SET-MAINT.
 14677
 14678 6220-USE-COMPUTED.
 14679
 14680     IF (PI-PMTTYPE = '4')  AND
 14681        (PI-CPYAMT < ZEROS)
 14682          COMPUTE CL-NO-OF-DAYS-PAID =
 14683                       CL-NO-OF-DAYS-PAID - PI-CDAYS
 14684          IF CL-NO-OF-DAYS-PAID < +0
 14685              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 14686          ELSE
 14687              NEXT SENTENCE
 14688     ELSE
 14689          ADD PI-CDAYS           TO CL-NO-OF-DAYS-PAID.
 14690
 14691     ADD PI-CPYAMT               TO CL-TOTAL-PAID-AMT.
 14692
 14693     IF PI-PMTTYPE = '4'
 14694        GO TO 6250-SET-MAINT.
 14695
 14696     IF PI-AIG-SPECIAL-BENEFIT
 14697         COMPUTE CL-LAST-PMT-AMT = PI-CPYAMT / 1.5
 14698     ELSE
 14699         MOVE PI-CPYAMT        TO CL-LAST-PMT-AMT.
 14700
 14701     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 14702
 14703     IF PI-CPYTHRU > CL-PAID-THRU-DT
 14704        MOVE PI-CPYTHRU          TO CL-PAID-THRU-DT.
 14705
 14706 6250-SET-MAINT.
 14707     MOVE WS-TODAY-DATE          TO CL-LAST-MAINT-DT.
 14708
 14709     IF PI-PROCESSOR-ID = 'FIX '
 14710        IF DC-BIN-DATE-1 = CL-PAID-THRU-DT
 14711           MOVE WS-TODAY-DATE    TO CL-LAST-PMT-DT
 14712        ELSE
 14713           NEXT SENTENCE
 14714     ELSE
 14715        MOVE WS-TODAY-DATE       TO CL-LAST-PMT-DT.
 14716
 14717     MOVE PI-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 14718     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 14719     MOVE '1'                    TO CL-LAST-MAINT-TYPE.
 14720
 14721 6299-EXIT.
 14722      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 288
* EL156.cbl
 14724 6300-UPDATE-CERT.
 14725
 14726*  ADD CERTNOTE FOR SC NP+6
 14727     IF PI-COMPANY-ID = 'CID' AND
 14728       (PI-PMTTYPE = '2' OR '3') AND
 14729        CL-CERT-STATE = 'SC'  AND
 14730        (PI-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 14731           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 14732     END-IF.
 14733
 14734     MOVE PI-COMPANY-CD    TO CERT-COMP-CD.
 14735     MOVE CL-CERT-CARRIER  TO CERT-CARRIER.
 14736     MOVE CL-CERT-GROUPING TO CERT-GROUPING.
 14737     MOVE CL-CERT-STATE    TO CERT-STATE.
 14738     MOVE CL-CERT-ACCOUNT  TO CERT-ACCOUNT.
 14739     MOVE CL-CERT-EFF-DT   TO CERT-EFF-DT.
 14740     MOVE CL-CERT-NO       TO CERT-CERT-NO.
 14741     MOVE 'CERT'           TO FILE-SWITCH.
 14742
 14743     PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT.
 14744
 14745     IF CERT-NOTE-ADDED
 14746        IF CM-NOTE-SW = ' '
 14747           MOVE '4'             TO CM-NOTE-SW
 14748        ELSE
 14749           IF CM-NOTE-SW = '1'
 14750               MOVE '5'           TO CM-NOTE-SW
 14751           ELSE
 14752              IF CM-NOTE-SW = '2'
 14753                 MOVE '6'         TO CM-NOTE-SW
 14754              ELSE
 14755                 IF CM-NOTE-SW = '3'
 14756                    MOVE '7'      TO CM-NOTE-SW
 14757                 END-IF
 14758              END-IF
 14759           END-IF
 14760        END-IF
 14761     END-IF.
 14762
 14763     IF PI-COMPANY-ID = 'CVL'
 14764         MOVE PI-LOAN-NO   TO  CM-BENEFICIARY
 14765         MOVE 'N'          TO  PI-LOAN-UPDATE-SW.
 14766
 14767     IF PI-PMTTYPE NOT = '4'
 14768        GO TO 6340-UPDATE-CERT.
 14769
 14770     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14771        IF PI-PFKEY-USED = DFHPF5
 14772           ADD PI-CPYAMT         TO CM-LF-ITD-DEATH-AMT
 14773        ELSE
 14774           ADD PI-EPYAMT         TO CM-LF-ITD-DEATH-AMT.
 14775
 14776*    IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14777*        IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 14778*            IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 14779*               PI-LF-COVERAGE-TYPE = 'P'
 14780*                GO TO 6350-REWRITE-CERT.
 14781
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 289
* EL156.cbl
 14782     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14783       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 14784          PI-LF-COVERAGE-TYPE = 'P'
 14785           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 14786                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 14787                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 14788                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 14789                MOVE '7'                  TO CM-LF-CURRENT-STATUS
 14790                GO TO 6350-REWRITE-CERT
 14791            ELSE
 14792                GO TO 6350-REWRITE-CERT.
 14793
 14794     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14795         GO TO 6350-REWRITE-CERT.
 14796
 14797     IF NOT CM-AH-LUMP-SUM-DISAB
 14798        GO TO 6380-UNLOCK-CERT.
 14799
 14800     IF PI-PFKEY-USED = DFHPF5
 14801        ADD PI-CPYAMT            TO CM-AH-ITD-LUMP-PMT
 14802                                    CM-AH-ITD-AH-PMT
 14803        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 14804        GO TO 6350-REWRITE-CERT
 14805     ELSE
 14806        ADD PI-EPYAMT            TO CM-AH-ITD-LUMP-PMT
 14807                                    CM-AH-ITD-AH-PMT
 14808        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 14809        GO TO 6350-REWRITE-CERT.
 14810
 14811 6340-UPDATE-CERT.
 14812
 14813     IF CL-CLAIM-TYPE = 'L'
 14814         IF PI-PFKEY-USED = DFHPF5
 14815             ADD PI-CPYAMT          TO CM-LF-ITD-DEATH-AMT
 14816         ELSE
 14817             ADD PI-EPYAMT          TO CM-LF-ITD-DEATH-AMT.
 14818
 14819     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14820         IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 14821             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 14822                PI-LF-COVERAGE-TYPE = 'P'
 14823                 GO TO 6350-REWRITE-CERT.
 14824
 14825     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14826       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 14827          PI-LF-COVERAGE-TYPE = 'P'
 14828           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 14829                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 14830                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 14831                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 14832                MOVE '7'                  TO CM-LF-CURRENT-STATUS
 14833                GO TO 6350-REWRITE-CERT.
 14834
 14835     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14836         IF PI-LIFE-OVERRIDE-L1 = 'L' AND
 14837            PI-LF-COVERAGE-TYPE NOT = 'P'
 14838             MOVE CL-INCURRED-DT         TO CM-LF-DEATH-DT
 14839             MOVE PI-MONTH-END-SAVE      TO CM-LF-DEATH-EXIT-DT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 290
* EL156.cbl
 14840             MOVE CM-LF-CURRENT-STATUS   TO CM-LF-STATUS-AT-DEATH
 14841             MOVE '7'                    TO CM-LF-CURRENT-STATUS
 14842             GO TO 6350-REWRITE-CERT.
 14843
 14844     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14845         MOVE CL-INCURRED-DT         TO CM-AH-SETTLEMENT-DT
 14846         MOVE PI-MONTH-END-SAVE      TO CM-AH-SETTLEMENT-EXIT-DT
 14847         MOVE CM-AH-CURRENT-STATUS   TO CM-AH-STATUS-AT-SETTLEMENT
 14848         MOVE '6'                    TO CM-AH-CURRENT-STATUS
 14849         MOVE PI-EPYTHRU             TO CM-AH-PAID-THRU-DT
 14850         IF PI-PFKEY-USED = DFHPF5
 14851             ADD PI-CPYAMT           TO CM-AH-ITD-LUMP-PMT
 14852                                        CM-AH-ITD-AH-PMT
 14853             GO TO 6350-REWRITE-CERT
 14854         ELSE
 14855             ADD PI-EPYAMT           TO CM-AH-ITD-LUMP-PMT
 14856                                        CM-AH-ITD-AH-PMT
 14857             GO TO 6350-REWRITE-CERT.
 14858
 14859 6350-REWRITE-CERT.
 14860
 14861
 14862* EXEC CICS REWRITE
 14863*         DATASET  ('ELCERT')
 14864*         FROM(CERTIFICATE-MASTER)
 14865*     END-EXEC.
 14866     MOVE LENGTH OF
 14867      CERTIFICATE-MASTER
 14868       TO DFHEIV11
 14869     MOVE 'ELCERT' TO DFHEIV1
 14870*    MOVE '&& L                  %   #00013938' TO DFHEIV0
 14871     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14872     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14873     MOVE X'2020233030303133393338' TO DFHEIV0(25:11)
 14874     CALL 'kxdfhei1' USING DFHEIV0,
 14875           DFHEIV1,
 14876           CERTIFICATE-MASTER,
 14877           DFHEIV11,
 14878           DFHEIV99
 14879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14880
 14881
 14882     GO TO 6399-EXIT.
 14883
 14884 6380-UNLOCK-CERT.
 14885
 14886* EXEC CICS UNLOCK
 14887*         DATASET  ('ELCERT')
 14888*     END-EXEC.
 14889     MOVE 'ELCERT' TO DFHEIV1
 14890*    MOVE '&*                    #   #00013946' TO DFHEIV0
 14891     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 14892     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14893     MOVE X'2020233030303133393436' TO DFHEIV0(25:11)
 14894     CALL 'kxdfhei1' USING DFHEIV0,
 14895           DFHEIV1,
 14896           DFHEIV99
 14897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 291
* EL156.cbl
 14898
 14899
 14900 6399-EXIT.
 14901      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 292
* EL156.cbl
 14903 6400-UPDATE-ZERO-TRAILER.
 14904     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 14905     MOVE ZEROS                  TO TRLR-SEQ-NO.
 14906
 14907     PERFORM 7960-READ-TRAILER-UPDATE THRU 7960-EXIT.
 14908
 14909     IF PI-EPYAMT NOT = ZEROS
 14910         SUBTRACT PI-EPYAMT    FROM AT-CURRENT-MANUAL-RESERVE
 14911     ELSE
 14912         SUBTRACT PI-CPYAMT    FROM AT-CURRENT-MANUAL-RESERVE.
 14913
 14914     IF PI-ERESV NOT = ZEROS
 14915        ADD PI-ERESV             TO AT-CURRENT-MANUAL-RESERVE.
 14916
 14917     IF AT-CURRENT-MANUAL-RESERVE NEGATIVE
 14918        MOVE ZEROS               TO AT-CURRENT-MANUAL-RESERVE.
 14919
 14920     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 14921        ADD PI-EEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE
 14922     ELSE
 14923        ADD PI-CEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE.
 14924
 14925     IF PI-PMTTYPE = '5'
 14926        IF PI-EPYAMT = ZEROS
 14927           ADD PI-CPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE
 14928        ELSE
 14929           ADD PI-EPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE.
 14930
 14931     IF PI-PMTTYPE = '6'
 14932        IF PI-EPYAMT = ZEROS
 14933           ADD PI-CPYAMT         TO AT-ITD-PAID-EXPENSES
 14934        ELSE
 14935           ADD PI-EPYAMT         TO AT-ITD-PAID-EXPENSES.
 14936
 14937 6420-CHECK-OPEN-CLOSE.
 14938     IF PI-PMTTYPE = '5' OR '6'
 14939        GO TO 6450-REWRITE.
 14940
 14941     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14942         IF PI-PMTTYPE = '2' OR '3' OR '4'
 14943             IF CLAIM-IS-CLOSED
 14944                 MOVE '1'        TO  WS-OPEN-CLOSE-SW
 14945                 MOVE 1          TO  SUB-1
 14946                 GO TO 6440-AIG-LOOP.
 14947
 14948     IF (PI-PMTTYPE = '1' OR '4') AND CLAIM-IS-OPEN
 14949        GO TO 6450-REWRITE.
 14950
 14951     IF (PI-PMTTYPE = '2' OR '3') AND CLAIM-IS-CLOSED
 14952        GO TO 6450-REWRITE.
 14953
 14954     MOVE 1                      TO SUB-1.
 14955
 14956 6430-LOOP.
 14957     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 14958        MOVE WS-TODAY-DATE       TO AT-OPEN-CLOSE-DATE (SUB-1)
 14959        IF PI-PMTTYPE = '1' OR '4'
 14960           MOVE 'O'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 293
* EL156.cbl
 14961           MOVE 'FORCE'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 14962           GO TO 6450-REWRITE
 14963        ELSE
 14964           MOVE 'C'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
 14965           MOVE 'FINAL'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 14966           GO TO 6450-REWRITE.
 14967
 14968     IF SUB-1 = 6
 14969      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 14970      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 14971      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 14972      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 14973      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 14974      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 14975      GO TO 6430-LOOP.
 14976
 14977     ADD 1                       TO SUB-1.
 14978     GO TO 6430-LOOP.
 14979
 14980
 14981 6440-AIG-LOOP.
 14982
 14983     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 14984       MOVE WS-TODAY-DATE        TO AT-OPEN-CLOSE-DATE (SUB-1)
 14985       IF WS-OPEN-CLOSE-SW = '1'
 14986         MOVE 'O'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 14987         IF PI-PMTTYPE = '2'
 14988           MOVE 'FINAL'          TO  AT-OPEN-CLOSE-REASON (SUB-1)
 14989           MOVE '2'              TO  WS-OPEN-CLOSE-SW
 14990         ELSE
 14991           IF PI-PMTTYPE = '3'
 14992             MOVE 'SETTL'        TO  AT-OPEN-CLOSE-REASON (SUB-1)
 14993             MOVE '2'            TO  WS-OPEN-CLOSE-SW
 14994           ELSE
 14995             IF PI-PMTTYPE = '4'
 14996               MOVE 'ADDL'       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 14997               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 14998             ELSE
 14999               MOVE 'UNK '       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 15000               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 15001       ELSE
 15002         MOVE 'C'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 15003         MOVE 'FORCE'            TO  AT-OPEN-CLOSE-REASON (SUB-1)
 15004         GO TO 6450-REWRITE.
 15005
 15006     IF SUB-1 = 6
 15007      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 15008      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 15009      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 15010      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 15011      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 15012      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 15013      GO TO 6440-AIG-LOOP.
 15014
 15015     ADD 1                       TO SUB-1.
 15016     GO TO 6440-AIG-LOOP.
 15017
 15018 6450-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 294
* EL156.cbl
 15019     MOVE PI-PROCESSOR-ID     TO AT-RESERVES-LAST-UPDATED-BY.
 15020     MOVE EIBTIME             TO AT-LAST-MAINT-HHMMSS.
 15021     MOVE WS-TODAY-DATE       TO AT-RESERVES-LAST-MAINT-DT.
 15022
 15023     IF PI-COMPANY-ID = 'DMD'
 15024         MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 15025         MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 15026         MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 15027         MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 15028         MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 15029
 15030
 15031* EXEC CICS REWRITE
 15032*         DATASET  ('ELTRLR')
 15033*         FROM     (ACTIVITY-TRAILERS)
 15034*     END-EXEC.
 15035     MOVE LENGTH OF
 15036      ACTIVITY-TRAILERS
 15037       TO DFHEIV11
 15038     MOVE 'ELTRLR' TO DFHEIV1
 15039*    MOVE '&& L                  %   #00014080' TO DFHEIV0
 15040     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15041     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15042     MOVE X'2020233030303134303830' TO DFHEIV0(25:11)
 15043     CALL 'kxdfhei1' USING DFHEIV0,
 15044           DFHEIV1,
 15045           ACTIVITY-TRAILERS,
 15046           DFHEIV11,
 15047           DFHEIV99
 15048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15049
 15050
 15051 6499-EXIT.
 15052      EXIT.
 15053
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 295
* EL156.cbl
 15055 6500-READ-DLO035.
 15056     MOVE 'E'                    TO DL35-PROCESS-TYPE.
 15057     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 15058     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 15059     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 15060
 15061
 15062* EXEC CICS LINK
 15063*        PROGRAM    ('DLO035')
 15064*        COMMAREA   (DLO035-KEY)
 15065*        LENGTH     (DL35-LENGTH)
 15066*    END-EXEC.
 15067     MOVE 'DLO035' TO DFHEIV1
 15068*    MOVE '."C                   ''   #00014095' TO DFHEIV0
 15069     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15070     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15071     MOVE X'2020233030303134303935' TO DFHEIV0(25:11)
 15072     CALL 'kxdfhei1' USING DFHEIV0,
 15073           DFHEIV1,
 15074           DLO035-KEY,
 15075           DL35-LENGTH,
 15076           DFHEIV99,
 15077           DFHEIV99,
 15078           DFHEIV99
 15079     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15080
 15081
 15082     IF DL35-RETURN-CODE = 'OK'
 15083         GO TO 6500-EXIT.
 15084
 15085     IF DL35-RETURN-CODE = '01'
 15086         MOVE ER-7830            TO EMI-ERROR
 15087         GO TO 6500-BAD-EXIT.
 15088
 15089     IF DL35-RETURN-CODE = '02'
 15090         MOVE ER-7831            TO EMI-ERROR
 15091         GO TO 6500-BAD-EXIT.
 15092
 15093     IF DL35-RETURN-CODE = '03'
 15094         MOVE ER-7832            TO EMI-ERROR
 15095         GO TO 6500-BAD-EXIT.
 15096
 15097     IF DL35-RETURN-CODE = '04'
 15098         MOVE ER-7833            TO EMI-ERROR
 15099         GO TO 6500-BAD-EXIT.
 15100
 15101     IF DL35-RETURN-CODE = '05'
 15102         MOVE ER-7834            TO EMI-ERROR
 15103         GO TO 6500-BAD-EXIT.
 15104
 15105     IF DL35-RETURN-CODE = '06'
 15106         MOVE ER-7835            TO EMI-ERROR
 15107         GO TO 6500-BAD-EXIT.
 15108
 15109     IF DL35-RETURN-CODE = '07'
 15110         MOVE ER-7836            TO EMI-ERROR
 15111         GO TO 6500-BAD-EXIT.
 15112
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 296
* EL156.cbl
 15113     IF DL35-RETURN-CODE = 'E1'
 15114         MOVE ER-7837            TO EMI-ERROR
 15115         GO TO 6500-BAD-EXIT.
 15116
 15117     IF DL35-RETURN-CODE NOT = 'OK'
 15118         MOVE ER-7838            TO EMI-ERROR
 15119         GO TO 6500-BAD-EXIT.
 15120
 15121 6500-EXIT.
 15122      EXIT.
 15123
 15124 6500-BAD-EXIT.
 15125
 15126* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 15127*    MOVE '6"R                   !   #00014144' TO DFHEIV0
 15128     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15129     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15130     MOVE X'2020233030303134313434' TO DFHEIV0(25:11)
 15131     CALL 'kxdfhei1' USING DFHEIV0
 15132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15133
 15134     MOVE -1                 TO PMTTYPEL.
 15135     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15136     GO TO 8200-SEND-DATAONLY.
 15137
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 297
* EL156.cbl
 15139 6600-UPDATE-DLO035.
 15140     MOVE 'U'                    TO DL35-PROCESS-TYPE.
 15141     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 15142     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 15143     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 15144
 15145
 15146* EXEC CICS LINK
 15147*        PROGRAM    ('DLO035')
 15148*        COMMAREA   (DLO035-KEY)
 15149*        LENGTH     (DL35-LENGTH)
 15150*    END-EXEC.
 15151     MOVE 'DLO035' TO DFHEIV1
 15152*    MOVE '."C                   ''   #00014156' TO DFHEIV0
 15153     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15154     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15155     MOVE X'2020233030303134313536' TO DFHEIV0(25:11)
 15156     CALL 'kxdfhei1' USING DFHEIV0,
 15157           DFHEIV1,
 15158           DLO035-KEY,
 15159           DL35-LENGTH,
 15160           DFHEIV99,
 15161           DFHEIV99,
 15162           DFHEIV99
 15163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15164
 15165
 15166     IF DL35-RETURN-CODE = 'OK'
 15167         GO TO 6600-EXIT.
 15168
 15169     IF DL35-RETURN-CODE = '01'
 15170         MOVE ER-7830            TO EMI-ERROR
 15171         GO TO 6500-BAD-EXIT.
 15172
 15173     IF DL35-RETURN-CODE = '02'
 15174         MOVE ER-7831            TO EMI-ERROR
 15175         GO TO 6500-BAD-EXIT.
 15176
 15177     IF DL35-RETURN-CODE = '03'
 15178         MOVE ER-7832            TO EMI-ERROR
 15179         GO TO 6500-BAD-EXIT.
 15180
 15181     IF DL35-RETURN-CODE = '04'
 15182         MOVE ER-7833            TO EMI-ERROR
 15183         GO TO 6500-BAD-EXIT.
 15184
 15185     IF DL35-RETURN-CODE = '05'
 15186         MOVE ER-7834            TO EMI-ERROR
 15187         GO TO 6500-BAD-EXIT.
 15188
 15189     IF DL35-RETURN-CODE = '06'
 15190         MOVE ER-7835            TO EMI-ERROR
 15191         GO TO 6500-BAD-EXIT.
 15192
 15193     IF DL35-RETURN-CODE = '07'
 15194         MOVE ER-7836            TO EMI-ERROR
 15195         GO TO 6500-BAD-EXIT.
 15196
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 298
* EL156.cbl
 15197     IF DL35-RETURN-CODE = 'E1'
 15198         MOVE ER-7837            TO EMI-ERROR
 15199         GO TO 6500-BAD-EXIT.
 15200
 15201     IF DL35-RETURN-CODE NOT = 'OK'
 15202         MOVE ER-7838            TO EMI-ERROR
 15203         GO TO 6500-BAD-EXIT.
 15204
 15205 6600-EXIT.
 15206      EXIT.
 15207
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 299
* EL156.cbl
 15209 6700-UPDATE-ACTQ.
 15210***************************************************************
 15211*    THE ACTIVITY QUE FILE IS READ TO GET THE RECORD FOR      *
 15212*    THIS CLAIM.  A NEW RECORD WILL BE BUILT IF THERE ISNT    *
 15213*    ONE ALREADY THERE.                                       *
 15214***************************************************************
 15215
 15216
 15217* EXEC CICS HANDLE CONDITION
 15218*         NOTFND(6720-BUILD-NEW-RECORD)
 15219*     END-EXEC.
 15220*    MOVE '"$I                   ! 5 #00014212' TO DFHEIV0
 15221     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15222     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15223     MOVE X'3520233030303134323132' TO DFHEIV0(25:11)
 15224     CALL 'kxdfhei1' USING DFHEIV0
 15225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15226
 15227
 15228
 15229* EXEC CICS READ
 15230*         DATASET('ELACTQ')
 15231*         RIDFLD (ELMSTR-KEY)
 15232*         SET    (ADDRESS OF ACTIVITY-QUE)
 15233*         UPDATE
 15234*     END-EXEC.
 15235     MOVE 'ELACTQ' TO DFHEIV1
 15236*    MOVE '&"S        EU         (   #00014216' TO DFHEIV0
 15237     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15238     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15239     MOVE X'2020233030303134323136' TO DFHEIV0(25:11)
 15240     CALL 'kxdfhei1' USING DFHEIV0,
 15241           DFHEIV1,
 15242           DFHEIV20,
 15243           DFHEIV99,
 15244           ELMSTR-KEY,
 15245           DFHEIV99,
 15246           DFHEIV99,
 15247           DFHEIV99
 15248     SET ADDRESS OF ACTIVITY-QUE TO
 15249         DFHEIV20
 15250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15251
 15252
 15253     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 15254
 15255     IF PI-AIG-SPECIAL-BENEFIT AND
 15256        PI-CASH = 'Y'
 15257         ADD 2                   TO AQ-PAYMENT-COUNTER
 15258     ELSE
 15259         ADD 1                   TO AQ-PAYMENT-COUNTER.
 15260
 15261     IF AQ-PMT-UNAPPROVED-COUNT IS NOT NUMERIC
 15262         MOVE +0                 TO  AQ-PMT-UNAPPROVED-COUNT.
 15263
 15264     MOVE +0                     TO  WS-PMT-UNAPPROVED-CNT.
 15265
 15266     IF PI-PMT-GRADUATED
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 300
* EL156.cbl
 15267         IF WS-PMT-APPROVAL-SW = 'A'
 15268             NEXT SENTENCE
 15269         ELSE
 15270            IF PI-AIG-SPECIAL-BENEFIT AND
 15271               PI-CASH = 'Y'
 15272                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 15273                                     WS-PMT-UNAPPROVED-CNT
 15274            ELSE
 15275                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 15276                                     WS-PMT-UNAPPROVED-CNT
 15277     ELSE
 15278         IF PI-PMT-APPR-SW = 'Y'
 15279            IF PI-AIG-SPECIAL-BENEFIT AND
 15280               PI-CASH = 'Y'
 15281                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 15282                                     WS-PMT-UNAPPROVED-CNT
 15283            ELSE
 15284                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 15285                                     WS-PMT-UNAPPROVED-CNT.
 15286
 15287     IF WS-PMT-UNAPPROVED-CNT > ZERO
 15288         MOVE ER-3536 TO EMI-ERROR
 15289         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15290
 15291     MOVE +156                   TO  AQ-LAST-UPDATED-BY.
 15292
 15293
 15294* EXEC CICS REWRITE
 15295*         DATASET('ELACTQ')
 15296*         FROM   (ACTIVITY-QUE)
 15297*     END-EXEC.
 15298     MOVE LENGTH OF
 15299      ACTIVITY-QUE
 15300       TO DFHEIV11
 15301     MOVE 'ELACTQ' TO DFHEIV1
 15302*    MOVE '&& L                  %   #00014263' TO DFHEIV0
 15303     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15304     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15305     MOVE X'2020233030303134323633' TO DFHEIV0(25:11)
 15306     CALL 'kxdfhei1' USING DFHEIV0,
 15307           DFHEIV1,
 15308           ACTIVITY-QUE,
 15309           DFHEIV11,
 15310           DFHEIV99
 15311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15312
 15313
 15314     GO TO 6799-EXIT.
 15315
 15316 6720-BUILD-NEW-RECORD.
 15317
 15318* EXEC CICS GETMAIN
 15319*         SET    (ADDRESS OF ACTIVITY-QUE)
 15320*         LENGTH (60)
 15321*         INITIMG(GETMAIN-SPACE)
 15322*     END-EXEC.
 15323     MOVE 60
 15324       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 301
* EL156.cbl
 15325*    MOVE ',"IL                  $   #00014271' TO DFHEIV0
 15326     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15327     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15328     MOVE X'2020233030303134323731' TO DFHEIV0(25:11)
 15329     CALL 'kxdfhei1' USING DFHEIV0,
 15330           DFHEIV20,
 15331           DFHEIV11,
 15332           GETMAIN-SPACE
 15333     SET ADDRESS OF ACTIVITY-QUE TO
 15334         DFHEIV20
 15335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15336
 15337
 15338     MOVE ZEROS                  TO AQ-PMT-UNAPPROVED-COUNT.
 15339
 15340     IF PI-AIG-SPECIAL-BENEFIT AND
 15341        PI-CASH = 'Y'
 15342         MOVE 2                  TO AQ-PAYMENT-COUNTER
 15343     ELSE
 15344         MOVE 1                  TO AQ-PAYMENT-COUNTER.
 15345
 15346     MOVE ELMSTR-KEY             TO AQ-CONTROL-PRIMARY.
 15347     MOVE 'AQ'                   TO AQ-RECORD-ID.
 15348     MOVE SPACES                 TO AQ-PENDING-ACTIVITY-FLAGS.
 15349     MOVE LOW-VALUES             TO AQ-RESEND-DATE
 15350                                    AQ-FOLLOWUP-DATE.
 15351     MOVE +156                   TO AQ-LAST-UPDATED-BY.
 15352     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 15353
 15354     IF PI-PMT-GRADUATED
 15355         IF WS-PMT-APPROVAL-SW = 'A'
 15356             NEXT SENTENCE
 15357         ELSE
 15358            IF PI-AIG-SPECIAL-BENEFIT AND
 15359               PI-CASH = 'Y'
 15360                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 15361            ELSE
 15362                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 15363     ELSE
 15364         IF PI-PMT-APPR-SW = 'Y'
 15365            IF PI-AIG-SPECIAL-BENEFIT AND
 15366               PI-CASH = 'Y'
 15367                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 15368            ELSE
 15369                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT.
 15370
 15371     IF AQ-PMT-UNAPPROVED-COUNT > ZERO
 15372         MOVE ER-3536 TO EMI-ERROR
 15373         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15374
 15375
 15376* EXEC CICS WRITE
 15377*         DATASET('ELACTQ')
 15378*         RIDFLD (ELMSTR-KEY)
 15379*         FROM   (ACTIVITY-QUE)
 15380*     END-EXEC.
 15381     MOVE LENGTH OF
 15382      ACTIVITY-QUE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 302
* EL156.cbl
 15383       TO DFHEIV11
 15384     MOVE 'ELACTQ' TO DFHEIV1
 15385*    MOVE '&$ L                  ''   #00014314' TO DFHEIV0
 15386     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15387     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15388     MOVE X'2020233030303134333134' TO DFHEIV0(25:11)
 15389     CALL 'kxdfhei1' USING DFHEIV0,
 15390           DFHEIV1,
 15391           ACTIVITY-QUE,
 15392           DFHEIV11,
 15393           ELMSTR-KEY,
 15394           DFHEIV99,
 15395           DFHEIV99
 15396     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15397
 15398
 15399 6799-EXIT.
 15400      EXIT.
 15401
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 303
* EL156.cbl
 15403 6800-BUILD-FORM-TRAILER.
 15404
 15405
 15406* EXEC CICS GETMAIN
 15407*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 15408*         LENGTH   (200)
 15409*         INITIMG  (GETMAIN-SPACE)
 15410*    END-EXEC.
 15411     MOVE 200
 15412       TO DFHEIV11
 15413*    MOVE ',"IL                  $   #00014326' TO DFHEIV0
 15414     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15415     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15416     MOVE X'2020233030303134333236' TO DFHEIV0(25:11)
 15417     CALL 'kxdfhei1' USING DFHEIV0,
 15418           DFHEIV20,
 15419           DFHEIV11,
 15420           GETMAIN-SPACE
 15421     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15422         DFHEIV20
 15423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15424
 15425
 15426     SUBTRACT +1               FROM CL-TRAILER-SEQ-CNT.
 15427
 15428     MOVE CL-CONTROL-PRIMARY     TO AT-CONTROL-PRIMARY.
 15429     MOVE 'AT'                   TO AT-RECORD-ID.
 15430     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15431
 15432     MOVE 'A'                    TO AT-TRAILER-TYPE.
 15433     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15434                                    AT-FORM-LAST-MAINT-DT
 15435                                    AT-FORM-SEND-ON-DT.
 15436     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15437                                    AT-FORM-LAST-UPDATED-BY.
 15438     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15439     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 15440     MOVE '6'                    TO DC-OPTION-CODE.
 15441     MOVE +29                    TO DC-ELAPSED-DAYS.
 15442     MOVE +0                     TO DC-ELAPSED-MONTHS.
 15443     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 15444     MOVE DC-BIN-DATE-2          TO AT-FORM-FOLLOW-UP-DT.
 15445
 15446     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 15447         MOVE  LOW-VALUES        TO AT-FORM-FOLLOW-UP-DT.
 15448
 15449     MOVE LOW-VALUES             TO AT-FORM-ANSWERED-DT
 15450                                    AT-FORM-RE-SEND-DT
 15451                                    AT-EMP-FORM-ANSWERED-DT
 15452                                    AT-PHY-FORM-ANSWERED-DT
 15453                                    AT-EMP-FORM-SEND-ON-DT
 15454                                    AT-PHY-FORM-SEND-ON-DT
 15455                                    AT-FORM-PRINTED-DT
 15456                                    AT-FORM-REPRINT-DT.
 15457     MOVE '2'                    TO AT-FORM-TYPE.
 15458
 15459     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 15460     MOVE 'I'                    TO AT-FORM-ADDRESS.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 304
* EL156.cbl
 15461
 15462     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 15463         NEXT SENTENCE
 15464     ELSE
 15465         IF CL-PROG-FORM-TYPE NOT = 'S'
 15466            MOVE WS-TODAY-DATE   TO AT-PHY-FORM-SEND-ON-DT.
 15467
 15468
 15469* EXEC CICS WRITE
 15470*         DATASET  ('ELTRLR')
 15471*         FROM     (ACTIVITY-TRAILERS)
 15472*         RIDFLD   (AT-CONTROL-PRIMARY)
 15473*     END-EXEC.
 15474     MOVE LENGTH OF
 15475      ACTIVITY-TRAILERS
 15476       TO DFHEIV11
 15477     MOVE 'ELTRLR' TO DFHEIV1
 15478*    MOVE '&$ L                  ''   #00014374' TO DFHEIV0
 15479     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15480     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15481     MOVE X'2020233030303134333734' TO DFHEIV0(25:11)
 15482     CALL 'kxdfhei1' USING DFHEIV0,
 15483           DFHEIV1,
 15484           ACTIVITY-TRAILERS,
 15485           DFHEIV11,
 15486           AT-CONTROL-PRIMARY,
 15487           DFHEIV99,
 15488           DFHEIV99
 15489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15490
 15491
 15492 6899-EXIT.
 15493      EXIT.
 15494
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 305
* EL156.cbl
 15496 6900-BUILD-ARCHIVE-HEADER.
 15497
 15498     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15499     MOVE '1'                    TO CNTL-REC-TYPE.
 15500     MOVE +0                     TO CNTL-SEQ-NO.
 15501     MOVE SPACES                 TO CNTL-ACCESS.
 15502
 15503
 15504* EXEC CICS READ
 15505*         DATASET  ('ELCNTL')
 15506*         SET      (ADDRESS OF CONTROL-FILE)
 15507*         RIDFLD   (ELCNTL-KEY)
 15508*         UPDATE
 15509*    END-EXEC.
 15510     MOVE 'ELCNTL' TO DFHEIV1
 15511*    MOVE '&"S        EU         (   #00014391' TO DFHEIV0
 15512     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15513     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15514     MOVE X'2020233030303134333931' TO DFHEIV0(25:11)
 15515     CALL 'kxdfhei1' USING DFHEIV0,
 15516           DFHEIV1,
 15517           DFHEIV20,
 15518           DFHEIV99,
 15519           ELCNTL-KEY,
 15520           DFHEIV99,
 15521           DFHEIV99,
 15522           DFHEIV99
 15523     SET ADDRESS OF CONTROL-FILE TO
 15524         DFHEIV20
 15525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15526
 15527
 15528     ADD +1                      TO CF-CO-ARCHIVE-COUNTER.
 15529     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 15530
 15531
 15532* EXEC CICS REWRITE
 15533*         FROM     (CONTROL-FILE)
 15534*         DATASET  ('ELCNTL')
 15535*    END-EXEC.
 15536     MOVE LENGTH OF
 15537      CONTROL-FILE
 15538       TO DFHEIV11
 15539     MOVE 'ELCNTL' TO DFHEIV1
 15540*    MOVE '&& L                  %   #00014401' TO DFHEIV0
 15541     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15542     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15543     MOVE X'2020233030303134343031' TO DFHEIV0(25:11)
 15544     CALL 'kxdfhei1' USING DFHEIV0,
 15545           DFHEIV1,
 15546           CONTROL-FILE,
 15547           DFHEIV11,
 15548           DFHEIV99
 15549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15550
 15551
 15552
 15553* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 306
* EL156.cbl
 15554*         DUPKEY   (6900-BUILD-ARCHIVE-HEADER)
 15555*         DUPREC   (6900-BUILD-ARCHIVE-HEADER)
 15556*    END-EXEC.
 15557*    MOVE '"$$%                  ! 6 #00014406' TO DFHEIV0
 15558     MOVE X'222424252020202020202020' TO DFHEIV0(1:12)
 15559     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15560     MOVE X'3620233030303134343036' TO DFHEIV0(25:11)
 15561     CALL 'kxdfhei1' USING DFHEIV0
 15562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15563
 15564
 15565
 15566* EXEC CICS GETMAIN
 15567*         SET     (ADDRESS OF LETTER-ARCHIVE)
 15568*         LENGTH  (ELARCH-LENGTH)
 15569*         INITIMG (GETMAIN-SPACE)
 15570*    END-EXEC.
 15571*    MOVE ',"IL                  $   #00014411' TO DFHEIV0
 15572     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15573     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15574     MOVE X'2020233030303134343131' TO DFHEIV0(25:11)
 15575     CALL 'kxdfhei1' USING DFHEIV0,
 15576           DFHEIV20,
 15577           ELARCH-LENGTH,
 15578           GETMAIN-SPACE
 15579     SET ADDRESS OF LETTER-ARCHIVE TO
 15580         DFHEIV20
 15581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15582
 15583
 15584     MOVE 'LA'                   TO LA-RECORD-ID.
 15585     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 15586                                    LA-ARCHIVE-NO-A1.
 15587     MOVE '4'                    TO LA-RECORD-TYPE
 15588                                    LA-RECORD-TYPE-A1.
 15589     MOVE +0                     TO LA-LINE-SEQ-NO
 15590                                    LA-LINE-SEQ-NO-A1.
 15591     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 15592                                    LA-COMPANY-CD-A1.
 15593     MOVE CL-CARRIER             TO LA4-CARRIER.
 15594     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 15595     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 15596     MOVE CL-CERT-STATE          TO LA4-STATE.
 15597     MOVE +0                     TO LA4-NO-OF-COPIES.
 15598     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 15599     MOVE WS-TODAY-DATE          TO LA4-CREATION-DT.
 15600     MOVE LOW-VALUES             TO LA4-RESEND-DATE
 15601                                    LA4-INITIAL-PRINT-DATE
 15602                                    LA4-RESEND-PRINT-DATE
 15603                                    LA4-FORM-REM-PRINT-DT.
 15604     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 15605     MOVE '2'                    TO LA4-FORM-TYPE.
 15606
 15607
 15608* EXEC CICS WRITE
 15609*         DATASET  ('ELARCH')
 15610*         FROM     (LETTER-ARCHIVE)
 15611*         RIDFLD   (LA-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 307
* EL156.cbl
 15612*    END-EXEC.
 15613     MOVE LENGTH OF
 15614      LETTER-ARCHIVE
 15615       TO DFHEIV11
 15616     MOVE 'ELARCH' TO DFHEIV1
 15617*    MOVE '&$ L                  ''   #00014440' TO DFHEIV0
 15618     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15619     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15620     MOVE X'2020233030303134343430' TO DFHEIV0(25:11)
 15621     CALL 'kxdfhei1' USING DFHEIV0,
 15622           DFHEIV1,
 15623           LETTER-ARCHIVE,
 15624           DFHEIV11,
 15625           LA-CONTROL-PRIMARY,
 15626           DFHEIV99,
 15627           DFHEIV99
 15628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15629
 15630
 15631 6999-EXIT.
 15632      EXIT.
 15633
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 308
* EL156.cbl
 15635 7000-SHOW-CLAIM.
 15636     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
 15637     MOVE 'A'                    TO PI-PASS-SW.
 15638     MOVE LOW-VALUES             TO PI-CPYFROM
 15639                                    PI-MONTH-END-SAVE
 15640                                    PI-CPYTHRU.
 15641
 15642     MOVE ZEROS                  TO PI-FATAL-COUNT
 15643                                    PI-DAILY-RATE
 15644                                    PI-BEN-DAYS
 15645                                    PI-MANUAL-SW
 15646                                    PI-SAVE-CURSOR
 15647                                    PI-FORCE-COUNT
 15648                                    PI-HOLDTIL
 15649                                    PI-EPYFROM
 15650                                    PI-EPYTHRU
 15651                                    PI-EDAYS
 15652                                    PI-EPYAMT
 15653                                    PI-ERESV
 15654                                    PI-EEXPENS
 15655                                    PI-CDAYS
 15656                                    PI-CPYAMT
 15657                                    PI-CRESV
 15658                                    PI-CEXPENS
 15659                                    PI-INT-RATE
 15660                                    PI-AIGFROM.
 15661     MOVE ZEROS                  TO PI-PROOF-DATE.
 15662     MOVE ZEROS                  TO PI-ORIG-BEN-AMT
 15663                                    PI-REM-BEN-AMT
 15664                                    PI-MO-BEN-AMT.
 15665
 15666     MOVE LOW-VALUES             TO EL156AI.
 15667     MOVE MAP-NAMEA              TO MAP-NAME.
 15668
 15669 7010-BUILD-MAP.
 15670
 15671
 15672* EXEC CICS HANDLE CONDITION
 15673*        NOTFND(7100-SHOW-RECORD-NOT-FOUND)
 15674*    END-EXEC.
 15675*    MOVE '"$I                   ! 7 #00014486' TO DFHEIV0
 15676     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15677     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15678     MOVE X'3720233030303134343836' TO DFHEIV0(25:11)
 15679     CALL 'kxdfhei1' USING DFHEIV0
 15680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15681
 15682
 15683     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 15684     MOVE PI-CARRIER             TO MSTR-CARRIER.
 15685     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 15686     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 15687     MOVE 'MSTR'                 TO FILE-SWITCH.
 15688
 15689     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 15690
 15691     MOVE CL-CERT-KEY-DATA       TO PI-SV-CERT-KEY.
 15692     MOVE CL-CERT-NO             TO PI-SV-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 309
* EL156.cbl
 15693     MOVE CL-BENEFICIARY         TO PI-SV-BEN.
 15694     MOVE CL-CCN                 TO PI-SV-CCN.
 15695
 15696     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 15697     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 15698     MOVE CL-CLAIM-NO            TO CLMNOO.
 15699     MOVE CL-CARRIER             TO CARRO.
 15700     MOVE CL-CERT-PRIME          TO CERTNOO.
 15701     MOVE CL-CERT-SFX            TO SUFXO.
 15702
 15703     IF (PI-COMPANY-ID = 'CID')
 15704        AND (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)
 15705        CONTINUE
 15706     ELSE
 15707        MOVE AL-SADOF            TO ZINTHA
 15708                                    ZINTA
 15709                                    PINTHA
 15710                                    PINTA
 15711     END-IF
 15712     EVALUATE TRUE
 15713     WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
 15714         MOVE PI-AH-OVERRIDE-L6   TO CLMTYPO
 15715     WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15716         MOVE PI-LIFE-OVERRIDE-L6 TO CLMTYPO
 15717
 15718     WHEN CL-CLAIM-TYPE = 'I'
 15719         MOVE '  IU  '           TO CLMTYPO
 15720     WHEN CL-CLAIM-TYPE = 'G'
 15721         MOVE ' GAP  '           TO CLMTYPO
 15722     END-EVALUATE.
 15723     IF CLAIM-IS-OPEN
 15724         MOVE ' OPEN'            TO CLMSTATO
 15725     ELSE
 15726         MOVE 'CLOSED'           TO CLMSTATO.
 15727
 15728     PERFORM 5000-MOVE-NAME  THRU 5000-EXIT.
 15729
 15730     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 15731         MOVE SPACES             TO  PCERTNOO
 15732                                     PSUFXO
 15733                                     PRIMHDGO
 15734                                     SEQUO
 15735         MOVE AL-SADOF           TO  PCERTNOA
 15736                                     PSUFXA
 15737                                     PRIMHDGA
 15738                                     SEQUA
 15739     ELSE
 15740         MOVE CL-ASSOC-CERT-SEQU     TO  WS-CUR-SEQU
 15741         MOVE CL-ASSOC-CERT-TOTAL    TO  WS-OF-SEQU
 15742         MOVE WS-CLAIM-SEQUENCE      TO  SEQUO
 15743         MOVE CL-PRIME-CERT-PRIME    TO  PCERTNOO
 15744         MOVE CL-PRIME-CERT-SFX      TO  PSUFXO
 15745         MOVE 'PRIME CERT :'         TO  PRIMHDGO
 15746         MOVE AL-SANON               TO  PCERTNOA
 15747                                         PSUFXA
 15748                                         PRIMHDGA
 15749         MOVE AL-SABON               TO  SEQUA.
 15750
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 310
* EL156.cbl
 15751     MOVE CL-ACTIVITY-CODE           TO  PI-ACTIVITY-CODE.
 15752
 15753     IF CL-NO-OF-PMTS-MADE = 0 AND
 15754        CL-TOTAL-PAID-AMT = 0
 15755         NEXT SENTENCE
 15756     ELSE
 15757         IF CL-PAID-THRU-DT NOT = LOW-VALUES
 15758             IF NOT PI-USES-PAID-TO
 15759                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 15760                 MOVE ' '                 TO DC-OPTION-CODE
 15761                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15762                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 15763             ELSE
 15764                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 15765                 MOVE '6'                 TO DC-OPTION-CODE
 15766                 MOVE +1                  TO DC-ELAPSED-DAYS
 15767                 MOVE +0                  TO DC-ELAPSED-MONTHS
 15768                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15769                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO.
 15770
 15771     IF MAP-NAME = 'EL156A'
 15772     IF CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES
 15773        IF CL-TOTAL-PAID-AMT NOT = ZEROS
 15774          MOVE AL-SADOF TO    AIGFRMHA AIGFROMA.
 15775
 15776     IF CL-LAST-PMT-DT NOT = LOW-VALUES
 15777         MOVE CL-LAST-PMT-DT     TO DC-BIN-DATE-1
 15778         MOVE ' '                TO DC-OPTION-CODE
 15779         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15780         MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO.
 15781
 15782     IF CL-INCURRED-DT NOT = LOW-VALUES
 15783         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 15784         MOVE ' '                TO DC-OPTION-CODE
 15785         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15786         MOVE DC-GREG-DATE-1-EDIT    TO INCURO.
 15787
 15788     MOVE CL-TOTAL-PAID-AMT      TO TOTPAIDO.
 15789
 15790     IF CL-CERT-EFF-DT NOT = LOW-VALUES
 15791         MOVE CL-CERT-EFF-DT     TO DC-BIN-DATE-1
 15792         MOVE ' '                TO DC-OPTION-CODE
 15793         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15794         MOVE DC-GREG-DATE-1-EDIT    TO EFFECTO.
 15795
 15796     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15797         MOVE CL-CURRENT-ACCOUNT TO WS-WORK-ACCT
 15798         MOVE CL-CURRENT-STATE   TO WS-WORK-STATE
 15799     ELSE
 15800         MOVE CL-CERT-ACCOUNT    TO WS-WORK-ACCT
 15801         MOVE CL-CERT-STATE      TO WS-WORK-STATE.
 15802
 15803     MOVE WS-WORK-STATE-ACCT     TO STACCTO.
 15804     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 15805     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 15806     MOVE CL-CERT-GROUPING       TO CERT-GROUPING
 15807                                    PI-GROUPING.
 15808     MOVE CL-CERT-STATE          TO CERT-STATE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 311
* EL156.cbl
 15809                                    PI-STATE.
 15810     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
 15811                                    PI-ACCOUNT.
 15812     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 15813     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 15814     MOVE 'CERT'                 TO FILE-SWITCH.
 15815
 15816     PERFORM 7970-READ-CERT THRU 7970-EXIT.
 15817
 15818     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15819     MOVE PI-STATE               TO WS-ST-ACCESS.
 15820     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 15821     MOVE '3'                    TO CNTL-REC-TYPE.
 15822     MOVE +0                     TO CNTL-SEQ-NO.
 15823     MOVE 'STAT'                 TO FILE-SWITCH.
 15824
 15825     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15826
 15827     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 15828     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 15829
 15830     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 15831        GO TO 7020-BYPASS-BENEFIT.
 15832
 15833     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15834     MOVE '4'                    TO CNTL-REC-TYPE.
 15835     MOVE +0                     TO CNTL-SEQ-NO.
 15836     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 15837     MOVE WS-ACCESS              TO CNTL-ACCESS.
 15838     MOVE 'BENE'                 TO FILE-SWITCH.
 15839
 15840     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 15841
 15842     IF NO-BENEFIT-FOUND
 15843        GO TO 7020-BYPASS-BENEFIT.
 15844
 15845     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 15846     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 15847     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 15848
 15849 7020-BYPASS-BENEFIT.
 15850
 15851*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15852*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT
 15853*        MOVE PI-LOAN-DUE-DAY TO DUEDAYO.
 15854
 15855     IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
 15856         GO TO 7021-GO-TO-LIFE.
 15857
 15858     MOVE 'A'                    TO CP-BENEFIT-TYPE.
 15859     MOVE 'MO. BENEFIT :'        TO BENECAPO.
 15860     MOVE CM-AH-BENEFIT-AMT      TO BENEO.
 15861     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 15862     MOVE CM-AH-ORIG-TERM        TO WST-ORIG
 15863                                    CP-ORIGINAL-TERM.
 15864     MOVE CM-AH-CURRENT-STATUS   TO WS-STATUS.
 15865
 15866*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 312
* EL156.cbl
 15867*        MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 15868*    ELSE
 15869         MOVE CM-AH-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 15870
 15871     MOVE ' '                    TO DC-OPTION-CODE.
 15872     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 15873     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 15874
 15875     IF PI-COMPANY-ID = 'DMD'
 15876         PERFORM 9830-DMD-REMAINING-TERM THRU 9830-EXIT
 15877         GO TO 7023-BYPASS-REMAINING-TERM.
 15878
 15879     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 15880     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 15881     GO TO 7022-AROUND-LIFE.
 15882
 15883 7021-GO-TO-LIFE.
 15884
 15885     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15886     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 15887     MOVE CM-LF-ORIG-TERM        TO WST-ORIG
 15888                                    CP-ORIGINAL-TERM.
 15889     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 15890     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 15891     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 15892     MOVE CM-LF-CURRENT-STATUS   TO WS-STATUS.
 15893
 15894     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15895         MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 15896     ELSE
 15897         MOVE CM-LF-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 15898
 15899     MOVE ' '                    TO DC-OPTION-CODE.
 15900     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 15901     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 15902
 15903 7022-AROUND-LIFE.
 15904
 15905     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 15906     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15907     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 15908     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 15909     MOVE '4'                    TO CP-REM-TERM-METHOD.
 15910     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 15911     MOVE CP-REMAINING-TERM-3    TO WST-REM.
 15912
 15913     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 15914
 15915     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 15916        IF CP-REMAINING-TERM-3 > CM-AH-ORIG-TERM
 15917           MOVE CM-AH-ORIG-TERM  TO WST-REM.
 15918
 15919     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15920        IF CP-REMAINING-TERM-3 > CM-LF-ORIG-TERM
 15921           MOVE CM-LF-ORIG-TERM  TO WST-REM.
 15922
 15923 7023-BYPASS-REMAINING-TERM.
 15924
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 313
* EL156.cbl
 15925     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15926       IF CM-LF-CURRENT-STATUS = '6' OR '7' OR '8'
 15927          MOVE ZEROS                  TO BENEO
 15928       ELSE
 15929          MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE
 15930          MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 15931          MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
 15932          MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT
 15933          MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT
 15934          MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM
 15935          MOVE CM-LOAN-APR            TO CP-LOAN-APR
 15936          MOVE CM-LOAN-TERM           TO CP-LOAN-TERM
 15937          MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
 15938          MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD
 15939          MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD
 15940          MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV
 15941
 15942* EXEC CICS LINK
 15943*            PROGRAM  (LINK-REMAMT)
 15944*            COMMAREA (CALCULATION-PASS-AREA)
 15945*            LENGTH   (CP-COMM-LENGTH)
 15946*         END-EXEC
 15947*    MOVE '."C                   ''   #00014748' TO DFHEIV0
 15948     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15949     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15950     MOVE X'2020233030303134373438' TO DFHEIV0(25:11)
 15951     CALL 'kxdfhei1' USING DFHEIV0,
 15952           LINK-REMAMT,
 15953           CALCULATION-PASS-AREA,
 15954           CP-COMM-LENGTH,
 15955           DFHEIV99,
 15956           DFHEIV99,
 15957           DFHEIV99
 15958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15959          MOVE CP-REMAINING-AMT       TO BENEO.
 15960
 15961     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15962         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 15963            WS-LF-COVERAGE-TYPE = 'P'
 15964             COMPUTE WS-REMAINING-AMT = CM-LF-BENEFIT-AMT -
 15965                                        CM-LF-ITD-DEATH-AMT
 15966             MOVE WS-REMAINING-AMT  TO  BENEO.
 15967
 15968     MOVE CM-LF-BENEFIT-AMT      TO PI-ORIG-BEN-AMT.
 15969     MOVE BENEO                  TO PI-REM-BEN-AMT.
 15970     MOVE WS-TERMS               TO TERMSO.
 15971
 15972     IF WS-STATUS = '6' OR '7' OR '8'
 15973         MOVE AL-SABOF           TO CRTSTATA.
 15974
 15975     IF WS-STATUS = '1' OR '4'
 15976        IF CP-REMAINING-TERM-3 = ZEROS
 15977           MOVE 'EXPIRED'        TO CRTSTATO
 15978        ELSE
 15979           MOVE 'ACTIVE  '       TO CRTSTATO.
 15980
 15981     IF WS-STATUS = '2'
 15982         MOVE 'PEND    '         TO CRTSTATO.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 314
* EL156.cbl
 15983
 15984     IF WS-STATUS = '3'
 15985         MOVE 'RESTORE '         TO CRTSTATO.
 15986
 15987     IF WS-STATUS = '5'
 15988         MOVE 'REISSUE '         TO CRTSTATO.
 15989
 15990     IF WS-STATUS = '6'
 15991         MOVE 'LMP DIS'          TO CRTSTATO.
 15992
 15993     IF WS-STATUS = '7'
 15994         MOVE 'DEATH'            TO CRTSTATO.
 15995
 15996     IF WS-STATUS = '8'
 15997         MOVE 'CANCEL'           TO CRTSTATO.
 15998
 15999     IF WS-STATUS = '9'
 16000         MOVE 'RE-ONLY '         TO CRTSTATO.
 16001
 16002     IF WS-STATUS = 'V'
 16003         MOVE 'VOID  '           TO CRTSTATO.
 16004
 16005     IF WS-STATUS = 'D'
 16006         MOVE 'DECLINE '         TO CRTSTATO.
 16007
 16008     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16009         MOVE CM-AH-BENEFIT-CD   TO WS-BEN-CD
 16010         MOVE '5'                TO CNTL-REC-TYPE
 16011     ELSE
 16012         MOVE CM-LF-BENEFIT-CD   TO WS-BEN-CD
 16013         MOVE '4'                TO CNTL-REC-TYPE.
 16014
 16015     MOVE '** NONE **'           TO COVERO.
 16016     MOVE AL-SABON               TO COVERA.
 16017
 16018     IF PI-COMPANY-ID = 'CVL'
 16019         IF CM-BENEFICIARY NOT = SPACES AND LOW-VALUES
 16020             MOVE CM-BENEFICIARY TO LOANNOO
 16021             MOVE AL-UANON       TO LOANNOA.
 16022
 16023     IF PI-COMPANY-ID = 'CID' OR 'DCC'
 16024        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 16025        MOVE +91                 TO  TRLR-SEQ-NO
 16026
 16027* EXEC CICS READ
 16028*           DATASET  ('ELTRLR')
 16029*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 16030*           RIDFLD   (ELTRLR-KEY)
 16031*           RESP     (WS-RESPONSE)
 16032*       END-EXEC
 16033     MOVE 'ELTRLR' TO DFHEIV1
 16034*    MOVE '&"S        E          (  N#00014820' TO DFHEIV0
 16035     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16036     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16037     MOVE X'204E233030303134383230' TO DFHEIV0(25:11)
 16038     CALL 'kxdfhei1' USING DFHEIV0,
 16039           DFHEIV1,
 16040           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 315
* EL156.cbl
 16041           DFHEIV99,
 16042           ELTRLR-KEY,
 16043           DFHEIV99,
 16044           DFHEIV99,
 16045           DFHEIV99
 16046     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16047         DFHEIV20
 16048     MOVE EIBRESP  TO WS-RESPONSE
 16049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16050
 16051        IF WS-RESP-NORMAL
 16052           MOVE AT-INFO-LINE-1   TO  LOANNOO
 16053        ELSE
 16054           MOVE SPACES           TO  LOANNOO
 16055        END-IF
 16056*052506
 16057*052506        PERFORM 7250-FIND-LETTER-TRLR THRU 7250-EXIT
 16058*052506
 16059     END-IF
 16060
 16061     IF CL-PROG-FORM-TYPE = 'S' OR 'L'
 16062        MOVE CL-PROG-FORM-TYPE   TO FORMTYPO.
 16063
 16064     IF WS-BEN-CD = ZEROS
 16065         GO TO 7050-SHOW-CONTINUE.
 16066
 16067     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16068     MOVE WS-ACCESS              TO CNTL-ACCESS.
 16069     MOVE +0                     TO CNTL-SEQ-NO.
 16070     MOVE 'BENE'                 TO FILE-SWITCH.
 16071
 16072     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 16073
 16074     IF BENEFIT-FOUND
 16075         MOVE CF-BENEFIT-DESCRIP (SUB-1)  TO COVERO
 16076         MOVE AL-SANON                    TO COVERA.
 16077
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 316
* EL156.cbl
 16079 7050-SHOW-CONTINUE.
 16080
 16081     IF PI-COMPANY-ID = 'DMD'
 16082         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
 16083
 16084     MOVE -1                     TO PMTTYPEL.
 16085     GO TO 8100-SEND-INITIAL-MAP.
 16086
 16087 7100-SHOW-RECORD-NOT-FOUND.
 16088     IF FILE-SWITCH = 'MSTR'
 16089         MOVE ER-0204            TO EMI-ERROR.
 16090
 16091     IF FILE-SWITCH = 'CERT'
 16092         MOVE ER-0206            TO EMI-ERROR.
 16093
 16094     IF FILE-SWITCH = 'STAT'
 16095         MOVE ER-0149            TO EMI-ERROR.
 16096
 16097     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16098
 16099     MOVE -1                     TO PMTTYPEL.
 16100     GO TO 8100-SEND-INITIAL-MAP
 16101
 16102     .
 16103 7110-BUILD-PMT-TRLR.
 16104     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 16105     MOVE +51                    TO TRLR-SEQ-NO
 16106
 16107* EXEC CICS READ
 16108*        DATASET  ('ELTRLR')
 16109*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 16110*        RIDFLD   (ELTRLR-KEY)
 16111*        RESP     (WS-RESPONSE)
 16112*    END-EXEC
 16113     MOVE 'ELTRLR' TO DFHEIV1
 16114*    MOVE '&"S        E          (  N#00014882' TO DFHEIV0
 16115     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16116     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16117     MOVE X'204E233030303134383832' TO DFHEIV0(25:11)
 16118     CALL 'kxdfhei1' USING DFHEIV0,
 16119           DFHEIV1,
 16120           DFHEIV20,
 16121           DFHEIV99,
 16122           ELTRLR-KEY,
 16123           DFHEIV99,
 16124           DFHEIV99,
 16125           DFHEIV99
 16126     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16127         DFHEIV20
 16128     MOVE EIBRESP  TO WS-RESPONSE
 16129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16130     IF WS-RESP-NORMAL
 16131        MOVE AT-MAIL-TO-NAME     TO PI-PAYEE-NAME
 16132     END-IF
 16133     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT
 16134
 16135* EXEC CICS GETMAIN
 16136*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 317
* EL156.cbl
 16137*         LENGTH    (200)
 16138*         INITIMG   (GETMAIN-SPACE)
 16139*     END-EXEC
 16140     MOVE 200
 16141       TO DFHEIV11
 16142*    MOVE ',"IL                  $   #00014892' TO DFHEIV0
 16143     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16144     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16145     MOVE X'2020233030303134383932' TO DFHEIV0(25:11)
 16146     CALL 'kxdfhei1' USING DFHEIV0,
 16147           DFHEIV20,
 16148           DFHEIV11,
 16149           GETMAIN-SPACE
 16150     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16151         DFHEIV20
 16152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16153     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 16154                                    AT-PREV-PAID-THRU-DT
 16155     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT
 16156     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 16157     MOVE 'AT'                   TO AT-RECORD-ID
 16158     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 16159     MOVE +0                     TO AT-PAYMENT-NOTE-SEQ-NO
 16160     MOVE '2'                    TO AT-TRAILER-TYPE
 16161     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 16162                                    AT-PAYMENT-LAST-MAINT-DT
 16163     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 16164                                    AT-PAYMENT-LAST-UPDATED-BY
 16165     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 16166     MOVE 'I'                    TO AT-PAYMENT-TYPE
 16167     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE
 16168     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE
 16169     MOVE +0                     TO AT-EXPENSE-PER-PMT
 16170     MOVE PI-INT-AMT             TO AT-AMOUNT-PAID
 16171     MOVE LOW-VALUES             TO AT-PAID-FROM-DT
 16172     MOVE LOW-VALUES             TO AT-PAID-THRU-DT
 16173     MOVE PI-INT-DAYS            TO AT-DAYS-IN-PERIOD
 16174     MOVE PI-INT-RATE-USED       TO AT-INT-RATE
 16175     MOVE 'O1'                   TO AT-PAYEE-TYPE-CD
 16176     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME
 16177     MOVE PI-MONTH-END-SAVE      TO AT-PMT-SELECT-DT
 16178     MOVE '3'                    TO AT-PAYMENT-ORIGIN
 16179     MOVE SPACES                 TO AT-AIG-UNEMP-IND
 16180     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 16181                                    AT-TO-BE-WRITTEN-DT
 16182     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 16183                                    AT-CHECK-QUE-SEQUENCE
 16184                                    AT-ADDL-RESERVE
 16185     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 16186                                    AT-VOID-SELECT-DT
 16187                                    AT-VOID-ACCEPT-DT
 16188                                    AT-VOID-DT
 16189                                    AT-PMT-PROOF-DT
 16190                                    AT-INT-PMT-SELECT-DT
 16191     MOVE ZEROS                  TO AT-DAILY-RATE
 16192                                    AT-ELIMINATION-DAYS
 16193     MOVE SPACES                 TO AT-BENEFIT-TYPE
 16194*    EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 318
* EL156.cbl
 16195*        DUPREC    (7120-DUPREC)
 16196*    END-EXEC
 16197     .
 16198 7115-WRITE-INT-TRLR.
 16199
 16200* EXEC CICS WRITE
 16201*         DATASET       ('ELTRLR')
 16202*         FROM          (ACTIVITY-TRAILERS)
 16203*         RIDFLD        (AT-CONTROL-PRIMARY)
 16204*         RESP          (WS-RESPONSE)
 16205*     END-EXEC
 16206     MOVE LENGTH OF
 16207      ACTIVITY-TRAILERS
 16208       TO DFHEIV11
 16209     MOVE 'ELTRLR' TO DFHEIV1
 16210*    MOVE '&$ L                  ''  N#00014943' TO DFHEIV0
 16211     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16212     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16213     MOVE X'204E233030303134393433' TO DFHEIV0(25:11)
 16214     CALL 'kxdfhei1' USING DFHEIV0,
 16215           DFHEIV1,
 16216           ACTIVITY-TRAILERS,
 16217           DFHEIV11,
 16218           AT-CONTROL-PRIMARY,
 16219           DFHEIV99,
 16220           DFHEIV99
 16221     MOVE EIBRESP  TO WS-RESPONSE
 16222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16223      IF WS-RESP-DUPREC
 16224         GO TO 7120-DUPREC
 16225      END-IF
 16226     GO TO 7130-EXIT
 16227     .
 16228 7120-DUPREC.
 16229     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 16230     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 16231     GO TO 7115-WRITE-INT-TRLR
 16232     .
 16233 7130-EXIT.
 16234      EXIT.
 16235 7140-BUILD-NOTE-TRLR.
 16236
 16237
 16238* EXEC CICS GETMAIN
 16239*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16240*         LENGTH    (200)
 16241*         INITIMG   (GETMAIN-SPACE)
 16242*     END-EXEC
 16243     MOVE 200
 16244       TO DFHEIV11
 16245*    MOVE ',"IL                  $   #00014963' TO DFHEIV0
 16246     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16247     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16248     MOVE X'2020233030303134393633' TO DFHEIV0(25:11)
 16249     CALL 'kxdfhei1' USING DFHEIV0,
 16250           DFHEIV20,
 16251           DFHEIV11,
 16252           GETMAIN-SPACE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 319
* EL156.cbl
 16253     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16254         DFHEIV20
 16255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16256     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 16257     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 16258     MOVE 'AT'                   TO AT-RECORD-ID
 16259     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 16260     MOVE '6'                    TO AT-TRAILER-TYPE
 16261     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 16262                                    AT-GEN-INFO-LAST-MAINT-DT
 16263     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 16264                                    AT-GEN-INFO-LAST-UPDATED-BY
 16265     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 16266     MOVE 'NO INTEREST DUE'      TO AT-INFO-LINE-1
 16267     .
 16268 7150-WRITE.
 16269
 16270* EXEC CICS HANDLE CONDITION
 16271*        DUPREC    (7160-DUPREC)
 16272*    END-EXEC
 16273*    MOVE '"$%                   ! 8 #00014981' TO DFHEIV0
 16274     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16275     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16276     MOVE X'3820233030303134393831' TO DFHEIV0(25:11)
 16277     CALL 'kxdfhei1' USING DFHEIV0
 16278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16279
 16280* EXEC CICS WRITE
 16281*         DATASET     ('ELTRLR')
 16282*         FROM        (ACTIVITY-TRAILERS)
 16283*         RIDFLD      (AT-CONTROL-PRIMARY)
 16284*         RESP        (WS-RESPONSE)
 16285*     END-EXEC
 16286     MOVE LENGTH OF
 16287      ACTIVITY-TRAILERS
 16288       TO DFHEIV11
 16289     MOVE 'ELTRLR' TO DFHEIV1
 16290*    MOVE '&$ L                  ''  N#00014984' TO DFHEIV0
 16291     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16292     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16293     MOVE X'204E233030303134393834' TO DFHEIV0(25:11)
 16294     CALL 'kxdfhei1' USING DFHEIV0,
 16295           DFHEIV1,
 16296           ACTIVITY-TRAILERS,
 16297           DFHEIV11,
 16298           AT-CONTROL-PRIMARY,
 16299           DFHEIV99,
 16300           DFHEIV99
 16301     MOVE EIBRESP  TO WS-RESPONSE
 16302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16303      IF WS-RESP-DUPREC
 16304         GO TO 7160-DUPREC
 16305      END-IF
 16306     GO TO 7170-EXIT
 16307     .
 16308 7160-DUPREC.
 16309     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 16310     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 320
* EL156.cbl
 16311     GO TO 7150-WRITE
 16312     .
 16313 7170-EXIT.
 16314      EXIT.
 16315
 16316 7180-ADD-CERT-NOTE.
 16317*ADD CERT NOTE FOR SC NP+6
 16318
 16319
 16320* EXEC CICS GETMAIN
 16321*         SET       (ADDRESS OF CERT-NOTE-FILE)
 16322*         LENGTH    (150)
 16323*         INITIMG   (GETMAIN-SPACE)
 16324*     END-EXEC.
 16325     MOVE 150
 16326       TO DFHEIV11
 16327*    MOVE ',"IL                  $   #00015006' TO DFHEIV0
 16328     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16329     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16330     MOVE X'2020233030303135303036' TO DFHEIV0(25:11)
 16331     CALL 'kxdfhei1' USING DFHEIV0,
 16332           DFHEIV20,
 16333           DFHEIV11,
 16334           GETMAIN-SPACE
 16335     SET ADDRESS OF CERT-NOTE-FILE TO
 16336         DFHEIV20
 16337     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16338
 16339
 16340     MOVE SPACES                 TO WRK-CERT-NOTE-ADD.
 16341     MOVE SPACES                 TO WRK-ORIG-NOTE-ADD.
 16342     MOVE +1                     TO WRK-NOTE-SEQ.
 16343     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 16344     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 16345     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 16346     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 16347     MOVE CL-CERT-STATE          TO CZ-STATE.
 16348     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 16349     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 16350     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 16351     MOVE '2'                    TO CZ-RECORD-TYPE.
 16352     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 16353     MOVE 'CZ'                   TO CZ-RECORD-ID.
 16354     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 16355     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 16356     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 16357     MOVE PI-REM-BEN-AMT         TO SC-NP6-REM-BEN.
 16358     MOVE PI-MO-BEN-AMT          TO SC-NP6-6-MO.
 16359     MOVE PI-CPYAMT              TO SC-NP6-AMT-PAID.
 16360     MOVE SC-NP6-CERT-NOTE       TO CZ-NOTE.
 16361
 16362 7181-WRITE.
 16363
 16364
 16365* EXEC CICS WRITE
 16366*         DATASET     ('ERCNOT')
 16367*         FROM        (CERT-NOTE-FILE)
 16368*         RIDFLD      (CZ-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 321
* EL156.cbl
 16369*         RESP        (WS-RESPONSE)
 16370*    END-EXEC.
 16371     MOVE LENGTH OF
 16372      CERT-NOTE-FILE
 16373       TO DFHEIV11
 16374     MOVE 'ERCNOT' TO DFHEIV1
 16375*    MOVE '&$ L                  ''  N#00015036' TO DFHEIV0
 16376     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16377     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16378     MOVE X'204E233030303135303336' TO DFHEIV0(25:11)
 16379     CALL 'kxdfhei1' USING DFHEIV0,
 16380           DFHEIV1,
 16381           CERT-NOTE-FILE,
 16382           DFHEIV11,
 16383           CZ-CONTROL-PRIMARY,
 16384           DFHEIV99,
 16385           DFHEIV99
 16386     MOVE EIBRESP  TO WS-RESPONSE
 16387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16388
 16389
 16390     IF WS-RESP-DUPREC
 16391         GO TO 7182-DUPREC
 16392     END-IF.
 16393
 16394     SET CERT-NOTE-ADDED TO TRUE.
 16395
 16396     IF PI-CPYAMT EQUAL PI-ORIG-BEN-AMT
 16397         PERFORM 7190-ADD-ORIG-NOTE THRU 7199-EXIT
 16398     END-IF.
 16399
 16400     GO TO 7189-EXIT.
 16401
 16402 7182-DUPREC.
 16403
 16404     ADD +1                      TO  WRK-NOTE-SEQ.
 16405     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 16406     GO TO 7181-WRITE.
 16407
 16408 7189-EXIT.
 16409      EXIT.
 16410
 16411 7190-ADD-ORIG-NOTE.
 16412
 16413
 16414* EXEC CICS GETMAIN
 16415*         SET       (ADDRESS OF CERT-NOTE-FILE)
 16416*         LENGTH    (150)
 16417*         INITIMG   (GETMAIN-SPACE)
 16418*     END-EXEC.
 16419     MOVE 150
 16420       TO DFHEIV11
 16421*    MOVE ',"IL                  $   #00015066' TO DFHEIV0
 16422     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16423     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16424     MOVE X'2020233030303135303636' TO DFHEIV0(25:11)
 16425     CALL 'kxdfhei1' USING DFHEIV0,
 16426           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 322
* EL156.cbl
 16427           DFHEIV11,
 16428           GETMAIN-SPACE
 16429     SET ADDRESS OF CERT-NOTE-FILE TO
 16430         DFHEIV20
 16431     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16432
 16433
 16434     ADD +1                      TO WRK-NOTE-SEQ.
 16435     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 16436     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 16437     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 16438     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 16439     MOVE CL-CERT-STATE          TO CZ-STATE.
 16440     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 16441     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 16442     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 16443     MOVE '2'                    TO CZ-RECORD-TYPE.
 16444     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 16445     MOVE 'CZ'                   TO CZ-RECORD-ID.
 16446     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 16447     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 16448     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 16449     MOVE SC-NP6-ORIG-NOTE       TO CZ-NOTE.
 16450
 16451 7191-WRITE.
 16452
 16453
 16454* EXEC CICS WRITE
 16455*         DATASET     ('ERCNOT')
 16456*         FROM        (CERT-NOTE-FILE)
 16457*         RIDFLD      (CZ-CONTROL-PRIMARY)
 16458*         RESP        (WS-RESPONSE)
 16459*    END-EXEC.
 16460     MOVE LENGTH OF
 16461      CERT-NOTE-FILE
 16462       TO DFHEIV11
 16463     MOVE 'ERCNOT' TO DFHEIV1
 16464*    MOVE '&$ L                  ''  N#00015091' TO DFHEIV0
 16465     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16466     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16467     MOVE X'204E233030303135303931' TO DFHEIV0(25:11)
 16468     CALL 'kxdfhei1' USING DFHEIV0,
 16469           DFHEIV1,
 16470           CERT-NOTE-FILE,
 16471           DFHEIV11,
 16472           CZ-CONTROL-PRIMARY,
 16473           DFHEIV99,
 16474           DFHEIV99
 16475     MOVE EIBRESP  TO WS-RESPONSE
 16476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16477
 16478
 16479     IF WS-RESP-DUPREC
 16480         GO TO 7192-DUPREC
 16481     END-IF.
 16482
 16483     GO TO 7199-EXIT.
 16484
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 323
* EL156.cbl
 16485 7192-DUPREC.
 16486
 16487     ADD +1                      TO  WRK-NOTE-SEQ.
 16488     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 16489     GO TO 7191-WRITE.
 16490
 16491 7199-EXIT.
 16492      EXIT.
 16493 7200-FIND-BENEFIT.
 16494     MOVE 'N' TO WS-BEN-SEARCH-SW.
 16495
 16496
 16497* EXEC CICS HANDLE CONDITION
 16498*        ENDFILE(7200-EXIT)
 16499*        NOTFND(7200-EXIT)
 16500*    END-EXEC.
 16501*    MOVE '"$''I                  ! 9 #00015115' TO DFHEIV0
 16502     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 16503     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16504     MOVE X'3920233030303135313135' TO DFHEIV0(25:11)
 16505     CALL 'kxdfhei1' USING DFHEIV0
 16506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16507
 16508
 16509
 16510* EXEC CICS READ
 16511*        DATASET('ELCNTL')
 16512*        SET(ADDRESS OF CONTROL-FILE)
 16513*        RIDFLD(ELCNTL-KEY)
 16514*        GTEQ
 16515*    END-EXEC.
 16516     MOVE 'ELCNTL' TO DFHEIV1
 16517*    MOVE '&"S        G          (   #00015120' TO DFHEIV0
 16518     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 16519     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16520     MOVE X'2020233030303135313230' TO DFHEIV0(25:11)
 16521     CALL 'kxdfhei1' USING DFHEIV0,
 16522           DFHEIV1,
 16523           DFHEIV20,
 16524           DFHEIV99,
 16525           ELCNTL-KEY,
 16526           DFHEIV99,
 16527           DFHEIV99,
 16528           DFHEIV99
 16529     SET ADDRESS OF CONTROL-FILE TO
 16530         DFHEIV20
 16531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16532
 16533
 16534     IF CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 16535        CNTL-REC-TYPE NOT = CF-RECORD-TYPE
 16536           GO TO 7200-EXIT.
 16537
 16538     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 16539         VARYING SUB-1 FROM 1 BY 1 UNTIL
 16540            ((SUB-1 > 8) OR
 16541            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
 16542
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 324
* EL156.cbl
 16543     IF SUB-1 NOT = 9
 16544         MOVE 'Y' TO WS-BEN-SEARCH-SW.
 16545
 16546     GO TO 7200-EXIT.
 16547
 16548 7200-BENEFIT-DUMMY.
 16549
 16550 7200-DUMMY-EXIT.
 16551     EXIT.
 16552
 16553 7200-EXIT.
 16554     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 325
* EL156.cbl
 16556*052506
 16557*052506 7250-FIND-LETTER-TRLR.
 16558*052506     EXEC CICS HANDLE CONDITION
 16559*052506         ENDFILE  (7250-END)
 16560*052506         NOTFND   (7250-END)
 16561*052506     END-EXEC.
 16562*052506
 16563*052506     EXEC CICS STARTBR
 16564*052506         DATASET   ('ELTRLR')
 16565*052506         RIDFLD    (ELTRLR-KEY)
 16566*052506         GTEQ
 16567*052506     END-EXEC.
 16568*052506
 16569*052506     MOVE LOW-VALUES TO WS-MAX-LETTER-ANSWER-DT.
 16570*052506
 16571*052506 7250-FIND-LOOP.
 16572*052506     EXEC CICS READNEXT
 16573*052506         DATASET   ('ELTRLR')
 16574*052506         RIDFLD    (ELTRLR-KEY)
 16575*052506         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16576*052506     END-EXEC.
 16577*052506
 16578*052506     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 16579*052506        PI-CARRIER    NOT = TRLR-CARRIER  OR
 16580*052506        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 16581*052506        PI-CERT-NO    NOT = TRLR-CERT-NO
 16582*052506        GO TO 7250-END
 16583*052506     END-IF.
 16584*052506
 16585*052506     IF AT-TRAILER-TYPE NOT = '4'
 16586*052506         GO TO 7250-FIND-LOOP
 16587*052506     END-IF.
 16588*052506
 16589*052506     IF AT-LETTER-ANSWERED-DT GREATER THAN WS-MAX-LETTER-AN
 16590*052506         MOVE AT-LETTER-ANSWERED-DT TO WS-MAX-LETTER-ANSWER
 16591*052506     END-IF.
 16592*052506
 16593*052506     GO TO 7250-FIND-LOOP.
 16594*052506
 16595*052506 7250-END.
 16596*052506
 16597*052506     IF WS-MAX-LETTER-ANSWER-DT NOT = LOW-VALUES AND SPACES
 16598*051506         MOVE SPACES             TO  DC-OPTION-CODE
 16599*052506         MOVE WS-MAX-LETTER-ANSWER-DT TO  DC-BIN-DATE-1
 16600*052506         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16601*052506         MOVE DC-GREG-DATE-1-MDY  TO  PI-PROOF-DATE
 16602*052506         MOVE PI-PROOF-DATE  TO  PROOFDTO
 16603*052506         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 16604*052506     END-IF.
 16605*052506
 16606*052506     EXEC CICS ENDBR
 16607*052506          DATASET    ('ELTRLR')
 16608*052506     END-EXEC.
 16609*052506
 16610*052506 7250-EXIT.
 16611*052506     EXIT.
 16612*052506     EJECT
 16613*052506
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 326
* EL156.cbl
 16614 7300-CHECK-AUTO-ACTIVITY.
 16615
 16616     IF PI-PMTTYPE = '1' OR '2' OR '3' OR '4'
 16617         NEXT SENTENCE
 16618     ELSE
 16619         GO TO 7399-EXIT.
 16620
 16621     PERFORM 7400-CHECK-AUTO-ACTIVITY THRU 7400-EXIT.
 16622
 16623     IF WS-ACT-REC-FOUND-SW = 'N'
 16624         GO TO 7399-EXIT.
 16625
 16626     IF PI-ACTIVITY-CODE = 09
 16627         GO TO 7300-CONT-AUTO-ACTIVITY.
 16628
 16629     IF (PI-COMPANY-ID = 'AIG' OR 'AUK') AND
 16630        (PI-ACTIVITY-CODE = 11)
 16631         GO TO 7300-CONT-AUTO-ACTIVITY.
 16632
 16633     IF PI-PROVISIONAL-IND = 'P'
 16634         IF PI-PMTTYPE = '1'
 16635             IF CF-SYS-ACTIVE-SW (9) = ' ' OR 'N'
 16636                 MOVE 'N'    TO  PI-RESET-SW
 16637                 GO TO 7399-EXIT.
 16638
 16639     IF PI-PMTTYPE = '1'
 16640         IF CF-SYS-ACTIVE-SW (2) = ' ' OR 'N'
 16641             MOVE 'N'        TO  PI-RESET-SW
 16642             GO TO 7399-EXIT.
 16643
 16644     IF PI-PMTTYPE = '2' OR '3'
 16645         IF CF-SYS-ACTIVE-SW (3) = ' ' OR 'N'
 16646             MOVE 'N'        TO  PI-RESET-SW
 16647             GO TO 7399-EXIT.
 16648
 16649     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16650         IF PI-PROVISIONAL-IND = 'P'
 16651             NEXT SENTENCE
 16652         ELSE
 16653             PERFORM 7500-RESET-AUTO-ACTIVITY THRU 7599-EXIT.
 16654
 16655 7300-CONT-AUTO-ACTIVITY.
 16656
 16657     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 16658         MOVE PI-EPYTHRU     TO DC-GREG-DATE-1-MDY
 16659         MOVE '4'            TO DC-OPTION-CODE
 16660         MOVE +0             TO DC-ELAPSED-DAYS
 16661                                DC-ELAPSED-MONTHS
 16662         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16663         MOVE DC-BIN-DATE-1  TO WS-CHK-THRU-DT
 16664         IF PI-USES-PAID-TO
 16665             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16666             IF NO-CONVERSION-ERROR
 16667                 MOVE +1     TO DC-ELAPSED-DAYS
 16668                 MOVE +0     TO DC-ELAPSED-MONTHS
 16669                 MOVE '6'    TO DC-OPTION-CODE
 16670                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16671                 IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 327
* EL156.cbl
 16672                     MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 16673
 16674     IF PI-PFKEY-USED = DFHPF5
 16675         MOVE PI-CPYTHRU TO WS-CHK-THRU-DT
 16676         IF PI-USES-PAID-TO
 16677             MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 16678             MOVE +1                  TO DC-ELAPSED-DAYS
 16679             MOVE +0                  TO DC-ELAPSED-MONTHS
 16680             MOVE '6'                 TO DC-OPTION-CODE
 16681             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16682             IF NO-CONVERSION-ERROR
 16683                 MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 16684
 16685     IF WS-CHK-THRU-DT < PI-EXP-DT
 16686         NEXT SENTENCE
 16687     ELSE
 16688         MOVE 03                     TO  WS-ACTIVITY-CODE
 16689         GO TO 7390-PROCESS-ACTIVITY.
 16690
 16691     IF PI-PROV-PMT
 16692         MOVE 09                     TO  WS-ACTIVITY-CODE
 16693     ELSE
 16694        IF PI-PMTTYPE = '1'
 16695            MOVE 02                  TO  WS-ACTIVITY-CODE
 16696        ELSE
 16697        IF PI-PMTTYPE = '2' OR '3'
 16698            MOVE 07                  TO  WS-ACTIVITY-CODE
 16699        ELSE
 16700        IF PI-PMTTYPE = '4'
 16701            MOVE 00                  TO  WS-ACTIVITY-CODE
 16702        ELSE
 16703            MOVE 'N'                 TO  PI-RESET-SW
 16704            GO TO 7399-EXIT.
 16705
 16706 7390-PROCESS-ACTIVITY.
 16707
 16708     PERFORM 7450-FORMAT-AUTO-LETTER THRU 7499-EXIT.
 16709
 16710 7399-EXIT.
 16711     EXIT.
 16712
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 328
* EL156.cbl
 16714 7400-CHECK-AUTO-ACTIVITY.
 16715
 16716
 16717* EXEC CICS HANDLE CONDITION
 16718*        NOTFND   (7400-NOT-FOUND)
 16719*    END-EXEC.
 16720*    MOVE '"$I                   ! : #00015309' TO DFHEIV0
 16721     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16722     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16723     MOVE X'3A20233030303135333039' TO DFHEIV0(25:11)
 16724     CALL 'kxdfhei1' USING DFHEIV0
 16725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16726
 16727
 16728     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 16729     MOVE 'T'                    TO  CNTL-REC-TYPE.
 16730     MOVE SPACES                 TO  CNTL-ACCESS.
 16731     MOVE +0                     TO  CNTL-SEQ-NO.
 16732
 16733
 16734* EXEC CICS READ
 16735*        DATASET   ('ELCNTL')
 16736*        RIDFLD    (ELCNTL-KEY)
 16737*        SET       (ADDRESS OF CONTROL-FILE)
 16738*    END-EXEC.
 16739     MOVE 'ELCNTL' TO DFHEIV1
 16740*    MOVE '&"S        E          (   #00015318' TO DFHEIV0
 16741     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16742     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16743     MOVE X'2020233030303135333138' TO DFHEIV0(25:11)
 16744     CALL 'kxdfhei1' USING DFHEIV0,
 16745           DFHEIV1,
 16746           DFHEIV20,
 16747           DFHEIV99,
 16748           ELCNTL-KEY,
 16749           DFHEIV99,
 16750           DFHEIV99,
 16751           DFHEIV99
 16752     SET ADDRESS OF CONTROL-FILE TO
 16753         DFHEIV20
 16754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16755
 16756
 16757     MOVE 'Y'                        TO  WS-ACT-REC-FOUND-SW.
 16758     GO TO 7400-EXIT.
 16759
 16760 7400-NOT-FOUND.
 16761     MOVE 'N'                        TO  PI-RESET-SW
 16762                                         WS-LETTER-SW
 16763                                         WS-ACT-REC-FOUND-SW.
 16764
 16765     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16766
 16767 7400-EXIT.
 16768     EXIT.
 16769
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 329
* EL156.cbl
 16771 7450-FORMAT-AUTO-LETTER.
 16772
 16773     IF PI-ACTIVITY-CODE = ZEROS OR LOW-VALUES OR SPACES
 16774         MOVE 'Y'                    TO PI-RESET-SW
 16775         GO TO 7450-CONTINUE-PROCESS.
 16776
 16777     MOVE PI-ACTIVITY-CODE           TO  SUB.
 16778
 16779     IF SUB > 9
 16780         SUBTRACT 9 FROM SUB
 16781         MOVE CF-USER-RESET-SW (SUB)  TO PI-RESET-SW
 16782     ELSE
 16783         MOVE CF-SYS-RESET-SW (SUB)   TO PI-RESET-SW.
 16784
 16785 7450-CONTINUE-PROCESS.
 16786
 16787     IF WS-ACTIVITY-CODE = ZEROS
 16788         MOVE 'N'                    TO  WS-LETTER-SW
 16789         GO TO 7499-EXIT.
 16790
 16791     MOVE WS-ACTIVITY-CODE           TO  SUB.
 16792
 16793     IF CF-SYS-ACTIVE-SW (SUB) = ' ' OR 'N'
 16794         MOVE 'N'                    TO  PI-RESET-SW
 16795                                         WS-LETTER-SW
 16796         GO TO 7499-EXIT.
 16797
 16798     IF CF-SYS-LETTER-ID (SUB) = SPACES OR LOW-VALUES
 16799         MOVE 'N'                    TO  WS-LETTER-SW
 16800         GO TO 7499-EXIT.
 16801
 16802     MOVE 'Y'                        TO  WS-LETTER-SW.
 16803     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 16804     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 16805
 16806     MOVE CF-SYS-LETTER-ID  (SUB)    TO W-1523-FORM-NUMBER.
 16807
 16808     IF CF-SYS-RESEND-DAYS (SUB) NOT = ZEROS
 16809         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 16810         MOVE '6'                    TO  DC-OPTION-CODE
 16811         MOVE CF-SYS-RESEND-DAYS (SUB)   TO  DC-ELAPSED-DAYS
 16812         MOVE +0                     TO  DC-ELAPSED-MONTHS
 16813         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16814         IF NO-CONVERSION-ERROR
 16815             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
 16816         ELSE
 16817              MOVE LOW-VALUES        TO  W-1523-RESEND-DATE.
 16818
 16819     IF CF-SYS-FOLLOW-UP-DAYS (SUB) NOT = ZEROS
 16820         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 16821         MOVE '6'                    TO  DC-OPTION-CODE
 16822         MOVE CF-SYS-FOLLOW-UP-DAYS (SUB) TO DC-ELAPSED-DAYS
 16823         MOVE +0                     TO  DC-ELAPSED-MONTHS
 16824         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16825         IF NO-CONVERSION-ERROR
 16826             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
 16827         ELSE
 16828             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 330
* EL156.cbl
 16829
 16830 7499-EXIT.
 16831     EXIT.
 16832
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 331
* EL156.cbl
 16834 7500-RESET-AUTO-ACTIVITY.
 16835
 16836     MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.
 16837     MOVE PI-CARRIER             TO  TRLR-CARRIER.
 16838     MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.
 16839     MOVE PI-CERT-NO             TO  TRLR-CERT-NO.
 16840     MOVE +100                   TO  TRLR-SEQ-NO.
 16841
 16842 7500-STARTBR-TRLR.
 16843
 16844
 16845* EXEC CICS HANDLE CONDITION
 16846*        ENDFILE  (7590-END)
 16847*        NOTFND   (7590-END)
 16848*    END-EXEC.
 16849*    MOVE '"$''I                  ! ; #00015411' TO DFHEIV0
 16850     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 16851     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16852     MOVE X'3B20233030303135343131' TO DFHEIV0(25:11)
 16853     CALL 'kxdfhei1' USING DFHEIV0
 16854     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16855
 16856
 16857
 16858* EXEC CICS STARTBR
 16859*        DATASET   ('ELTRLR')
 16860*        RIDFLD    (ELTRLR-KEY)
 16861*        GTEQ
 16862*    END-EXEC.
 16863     MOVE 'ELTRLR' TO DFHEIV1
 16864     MOVE 0
 16865       TO DFHEIV11
 16866*    MOVE '&,         G          &   #00015416' TO DFHEIV0
 16867     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 16868     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16869     MOVE X'2020233030303135343136' TO DFHEIV0(25:11)
 16870     CALL 'kxdfhei1' USING DFHEIV0,
 16871           DFHEIV1,
 16872           ELTRLR-KEY,
 16873           DFHEIV99,
 16874           DFHEIV11,
 16875           DFHEIV99
 16876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16877
 16878
 16879     MOVE 'Y'                        TO  WS-BROWSE-SW.
 16880
 16881 7500-READ-NEXT.
 16882
 16883
 16884* EXEC CICS READNEXT
 16885*        DATASET   ('ELTRLR')
 16886*        RIDFLD    (ELTRLR-KEY)
 16887*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16888*    END-EXEC.
 16889     MOVE 'ELTRLR' TO DFHEIV1
 16890     MOVE 0
 16891       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 332
* EL156.cbl
 16892*    MOVE '&.S                   )   #00015426' TO DFHEIV0
 16893     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 16894     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 16895     MOVE X'2020233030303135343236' TO DFHEIV0(25:11)
 16896     CALL 'kxdfhei1' USING DFHEIV0,
 16897           DFHEIV1,
 16898           DFHEIV20,
 16899           DFHEIV99,
 16900           ELTRLR-KEY,
 16901           DFHEIV99,
 16902           DFHEIV11,
 16903           DFHEIV99,
 16904           DFHEIV99
 16905     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16906         DFHEIV20
 16907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16908
 16909
 16910     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 16911        PI-CARRIER    NOT = TRLR-CARRIER  OR
 16912        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 16913        PI-CERT-NO    NOT = TRLR-CERT-NO
 16914         GO TO 7590-END.
 16915
 16916     IF ELTRLR-KEY = PI-PREV-TRLR-KEY
 16917         GO TO 7500-READ-NEXT.
 16918
 16919     IF AT-TRAILER-TYPE NOT = '4'
 16920         GO TO 7500-READ-NEXT.
 16921
 16922     IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND SPACES
 16923         GO TO 7500-READ-NEXT.
 16924
 16925     IF (AT-AUTO-RE-SEND-DT   = LOW-VALUES OR SPACES) AND
 16926        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES OR SPACES)
 16927         GO TO 7500-READ-NEXT.
 16928
 16929     IF AT-RECEIPT-FOLLOW-UP < SAVE-BIN-DATE AND
 16930        AT-AUTO-RE-SEND-DT   < SAVE-BIN-DATE AND
 16931        AT-RESEND-PRINT-DATE < SAVE-BIN-DATE
 16932         GO TO 7500-READ-NEXT.
 16933
 16934     IF (AT-AUTO-RE-SEND-DT NOT = LOW-VALUES AND SPACES)
 16935                         AND
 16936        (AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND SPACES)
 16937                         AND
 16938        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES)
 16939            GO TO 7500-READ-NEXT.
 16940
 16941     MOVE ELTRLR-KEY                 TO  PI-PREV-TRLR-KEY.
 16942
 16943
 16944* EXEC CICS ENDBR
 16945*        DATASET   ('ELTRLR')
 16946*    END-EXEC.
 16947     MOVE 'ELTRLR' TO DFHEIV1
 16948     MOVE 0
 16949       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 333
* EL156.cbl
 16950*    MOVE '&2                    $   #00015465' TO DFHEIV0
 16951     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 16952     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16953     MOVE X'2020233030303135343635' TO DFHEIV0(25:11)
 16954     CALL 'kxdfhei1' USING DFHEIV0,
 16955           DFHEIV1,
 16956           DFHEIV11,
 16957           DFHEIV99
 16958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16959
 16960
 16961     MOVE 'N'                        TO  WS-BROWSE-SW.
 16962
 16963
 16964* EXEC CICS READ
 16965*        DATASET   ('ELTRLR')
 16966*        RIDFLD    (ELTRLR-KEY)
 16967*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16968*        UPDATE
 16969*    END-EXEC.
 16970     MOVE 'ELTRLR' TO DFHEIV1
 16971*    MOVE '&"S        EU         (   #00015471' TO DFHEIV0
 16972     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16973     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16974     MOVE X'2020233030303135343731' TO DFHEIV0(25:11)
 16975     CALL 'kxdfhei1' USING DFHEIV0,
 16976           DFHEIV1,
 16977           DFHEIV20,
 16978           DFHEIV99,
 16979           ELTRLR-KEY,
 16980           DFHEIV99,
 16981           DFHEIV99,
 16982           DFHEIV99
 16983     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16984         DFHEIV20
 16985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16986
 16987
 16988     MOVE 'Y'                        TO  WS-UPDATE-SW.
 16989
 16990     IF AT-AUTO-RE-SEND-DT NOT < SAVE-BIN-DATE
 16991         MOVE LOW-VALUES             TO  AT-AUTO-RE-SEND-DT
 16992     ELSE
 16993         IF AT-RECEIPT-FOLLOW-UP NOT < SAVE-BIN-DATE
 16994             NEXT SENTENCE
 16995         ELSE
 16996             GO TO 7500-REWRITE-TRLR.
 16997
 16998     MOVE LOW-VALUES                 TO  AT-RECEIPT-FOLLOW-UP.
 16999
 17000     MOVE PI-COMPANY-CD              TO  ARCH-CO.
 17001     MOVE AT-LETTER-ARCHIVE-NO       TO  ARCH-NUMBER.
 17002     MOVE '1'                        TO  ARCH-REC-TYPE.
 17003     MOVE +0                         TO  ARCH-SEQ.
 17004
 17005     PERFORM 7600-READ-ARCH-UPDATE THRU 7699-EXIT.
 17006
 17007 7500-REWRITE-TRLR.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 334
* EL156.cbl
 17008
 17009
 17010* EXEC CICS REWRITE
 17011*        DATASET   ('ELTRLR')
 17012*        FROM      (ACTIVITY-TRAILERS)
 17013*    END-EXEC.
 17014     MOVE LENGTH OF
 17015      ACTIVITY-TRAILERS
 17016       TO DFHEIV11
 17017     MOVE 'ELTRLR' TO DFHEIV1
 17018*    MOVE '&& L                  %   #00015499' TO DFHEIV0
 17019     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17020     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17021     MOVE X'2020233030303135343939' TO DFHEIV0(25:11)
 17022     CALL 'kxdfhei1' USING DFHEIV0,
 17023           DFHEIV1,
 17024           ACTIVITY-TRAILERS,
 17025           DFHEIV11,
 17026           DFHEIV99
 17027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17028
 17029
 17030     GO TO 7500-STARTBR-TRLR.
 17031
 17032 7590-END.
 17033
 17034     IF WS-BROWSE-SW = 'Y'
 17035         MOVE 'N'                    TO  WS-BROWSE-SW
 17036
 17037* EXEC CICS ENDBR
 17038*            DATASET   ('ELTRLR')
 17039*        END-EXEC.
 17040     MOVE 'ELTRLR' TO DFHEIV1
 17041     MOVE 0
 17042       TO DFHEIV11
 17043*    MOVE '&2                    $   #00015510' TO DFHEIV0
 17044     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17045     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17046     MOVE X'2020233030303135353130' TO DFHEIV0(25:11)
 17047     CALL 'kxdfhei1' USING DFHEIV0,
 17048           DFHEIV1,
 17049           DFHEIV11,
 17050           DFHEIV99
 17051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17052
 17053
 17054 7599-EXIT.
 17055     EXIT.
 17056
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 335
* EL156.cbl
 17058 7600-READ-ARCH-UPDATE.
 17059
 17060
 17061* EXEC CICS HANDLE CONDITION
 17062*        NOTFND   (7699-EXIT)
 17063*    END-EXEC.
 17064*    MOVE '"$I                   ! < #00015520' TO DFHEIV0
 17065     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17066     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17067     MOVE X'3C20233030303135353230' TO DFHEIV0(25:11)
 17068     CALL 'kxdfhei1' USING DFHEIV0
 17069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17070
 17071
 17072
 17073* EXEC CICS READ
 17074*        DATASET   ('ELARCH')
 17075*        RIDFLD    (ELARCH-KEY)
 17076*        SET       (ADDRESS OF LETTER-ARCHIVE)
 17077*        UPDATE
 17078*    END-EXEC.
 17079     MOVE 'ELARCH' TO DFHEIV1
 17080*    MOVE '&"S        EU         (   #00015524' TO DFHEIV0
 17081     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17082     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17083     MOVE X'2020233030303135353234' TO DFHEIV0(25:11)
 17084     CALL 'kxdfhei1' USING DFHEIV0,
 17085           DFHEIV1,
 17086           DFHEIV20,
 17087           DFHEIV99,
 17088           ELARCH-KEY,
 17089           DFHEIV99,
 17090           DFHEIV99,
 17091           DFHEIV99
 17092     SET ADDRESS OF LETTER-ARCHIVE TO
 17093         DFHEIV20
 17094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17095
 17096
 17097     MOVE LOW-VALUES                 TO  LA-RESEND-DATE.
 17098
 17099
 17100* EXEC CICS REWRITE
 17101*        DATASET   ('ELARCH')
 17102*        FROM      (LETTER-ARCHIVE)
 17103*    END-EXEC.
 17104     MOVE LENGTH OF
 17105      LETTER-ARCHIVE
 17106       TO DFHEIV11
 17107     MOVE 'ELARCH' TO DFHEIV1
 17108*    MOVE '&& L                  %   #00015533' TO DFHEIV0
 17109     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17110     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17111     MOVE X'2020233030303135353333' TO DFHEIV0(25:11)
 17112     CALL 'kxdfhei1' USING DFHEIV0,
 17113           DFHEIV1,
 17114           LETTER-ARCHIVE,
 17115           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 336
* EL156.cbl
 17116           DFHEIV99
 17117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17118
 17119
 17120 7699-EXIT.
 17121     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 337
* EL156.cbl
 17123 7700-GET-DCT.
 17124
 17125     MOVE PI-SV-CERT-KEY         TO W-NOTE-CERT-KEY.
 17126     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 17127     MOVE PI-SV-CERT-NO          TO W-NOTE-CERT-NO.
 17128     MOVE ZEROS                  TO PI-INTEREST-PAID-IND
 17129                                    PI-MAX-BENEFIT-AMT
 17130                                    PI-MAX-BENEFIT-PYMT
 17131                                    PI-MIN-PAYMENT-AMT
 17132                                    PI-TIME-OF-LOSS-BAL.
 17133
 17134
 17135* EXEC CICS HANDLE CONDITION
 17136*         NOTFND (5300-NOTE-NOT-FOUND)
 17137*     END-EXEC.
 17138*    MOVE '"$I                   ! = #00015552' TO DFHEIV0
 17139     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17140     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17141     MOVE X'3D20233030303135353532' TO DFHEIV0(25:11)
 17142     CALL 'kxdfhei1' USING DFHEIV0
 17143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17144
 17145
 17146
 17147* EXEC CICS READ
 17148*         DATASET('ERNOTE')
 17149*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 17150*         RIDFLD (W-NOTE-KEY)
 17151*     END-EXEC.
 17152     MOVE 'ERNOTE' TO DFHEIV1
 17153*    MOVE '&"S        E          (   #00015556' TO DFHEIV0
 17154     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17155     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17156     MOVE X'2020233030303135353536' TO DFHEIV0(25:11)
 17157     CALL 'kxdfhei1' USING DFHEIV0,
 17158           DFHEIV1,
 17159           DFHEIV20,
 17160           DFHEIV99,
 17161           W-NOTE-KEY,
 17162           DFHEIV99,
 17163           DFHEIV99,
 17164           DFHEIV99
 17165     SET ADDRESS OF CERTIFICATE-NOTE TO
 17166         DFHEIV20
 17167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17168
 17169
 17170     MOVE CN-CSI-CC-INTEREST-PAID TO PI-INTEREST-PAID-IND.
 17171     MOVE CN-CSI-CC-MAX-BEN-LIMIT TO PI-MAX-BENEFIT-AMT.
 17172     MOVE CN-CSI-CC-MAX-BENEFITS  TO PI-MAX-BENEFIT-PYMT.
 17173     MOVE CN-CSI-CC-MIN-PAY-AMT   TO PI-MIN-PAYMENT-AMT.
 17174     MOVE CN-CSI-CC-TOL-BALANCE   TO PI-TIME-OF-LOSS-BAL.
 17175
 17176     IF PI-PAYEE-TYPE NOT = 'B'
 17177         GO TO 7700-EXIT.
 17178
 17179     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 17180     MOVE PI-SV-BEN              TO DCT-LOGIC-BENEFICIARY-ID.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 338
* EL156.cbl
 17181     MOVE PI-SV-CCN              TO DCT-CREDIT-CARD-NUMBER.
 17182
 17183     IF PI-SV-CERT-KEY (6:2) = ZERO OR SPACES
 17184         MOVE 'CC'                 TO DCT-PRODUCT-CODE
 17185     ELSE
 17186         MOVE PI-SV-CERT-KEY (6:2) TO DCT-PRODUCT-CODE.
 17187
 17188     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 17189     MOVE '01'                   TO DCT-COLUMN-ID-REQUESTED.
 17190     MOVE 'DLO006'               TO PGM-NAME.
 17191
 17192
 17193* EXEC CICS LINK
 17194*        PROGRAM    (PGM-NAME)
 17195*        COMMAREA   (DCT-COMMUNICATION-AREA)
 17196*        LENGTH     (DCT-RCRD-LENGTH)
 17197*    END-EXEC.
 17198*    MOVE '."C                   ''   #00015584' TO DFHEIV0
 17199     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17200     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17201     MOVE X'2020233030303135353834' TO DFHEIV0(25:11)
 17202     CALL 'kxdfhei1' USING DFHEIV0,
 17203           PGM-NAME,
 17204           DCT-COMMUNICATION-AREA,
 17205           DCT-RCRD-LENGTH,
 17206           DFHEIV99,
 17207           DFHEIV99,
 17208           DFHEIV99
 17209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17210
 17211
 17212     IF DCT-RETURN-CODE = 'OK'
 17213         GO TO 7700-CONT.
 17214
 17215     IF DCT-RETURN-CODE = '01' OR '02'
 17216         GO TO 7700-SET-TO-YES.
 17217
 17218     IF DCT-RETURN-CODE = '03'
 17219
 17220* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17221*    MOVE '6"R                   !   #00015597' TO DFHEIV0
 17222     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17223     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17224     MOVE X'2020233030303135353937' TO DFHEIV0(25:11)
 17225     CALL 'kxdfhei1' USING DFHEIV0
 17226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17227         MOVE ER-0951            TO EMI-ERROR
 17228         MOVE -1                 TO PMTTYPEL
 17229         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17230         GO TO 8200-SEND-DATAONLY.
 17231
 17232     IF DCT-RETURN-CODE = '04'
 17233
 17234* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17235*    MOVE '6"R                   !   #00015604' TO DFHEIV0
 17236     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17237     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17238     MOVE X'2020233030303135363034' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 339
* EL156.cbl
 17239     CALL 'kxdfhei1' USING DFHEIV0
 17240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17241         MOVE ER-0946            TO EMI-ERROR
 17242         MOVE -1                 TO PMTTYPEL
 17243         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17244         GO TO 8200-SEND-DATAONLY.
 17245
 17246     IF DCT-RETURN-CODE = '05'
 17247
 17248* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17249*    MOVE '6"R                   !   #00015611' TO DFHEIV0
 17250     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17251     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17252     MOVE X'2020233030303135363131' TO DFHEIV0(25:11)
 17253     CALL 'kxdfhei1' USING DFHEIV0
 17254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17255         MOVE ER-0947            TO EMI-ERROR
 17256         MOVE -1                 TO PMTTYPEL
 17257         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17258         GO TO 8200-SEND-DATAONLY.
 17259
 17260     IF DCT-RETURN-CODE = '06'
 17261
 17262* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17263*    MOVE '6"R                   !   #00015618' TO DFHEIV0
 17264     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17265     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17266     MOVE X'2020233030303135363138' TO DFHEIV0(25:11)
 17267     CALL 'kxdfhei1' USING DFHEIV0
 17268     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17269         MOVE ER-0921            TO EMI-ERROR
 17270         MOVE -1                 TO PMTTYPEL
 17271         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17272         GO TO 8200-SEND-DATAONLY.
 17273
 17274     IF DCT-RETURN-CODE = '07'
 17275
 17276* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17277*    MOVE '6"R                   !   #00015625' TO DFHEIV0
 17278     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17279     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17280     MOVE X'2020233030303135363235' TO DFHEIV0(25:11)
 17281     CALL 'kxdfhei1' USING DFHEIV0
 17282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17283         MOVE ER-0919            TO EMI-ERROR
 17284         MOVE -1                 TO PMTTYPEL
 17285         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17286         GO TO 8200-SEND-DATAONLY.
 17287
 17288     IF DCT-RETURN-CODE = '08'
 17289
 17290* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17291*    MOVE '6"R                   !   #00015632' TO DFHEIV0
 17292     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17293     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17294     MOVE X'2020233030303135363332' TO DFHEIV0(25:11)
 17295     CALL 'kxdfhei1' USING DFHEIV0
 17296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 340
* EL156.cbl
 17297         MOVE ER-0948            TO EMI-ERROR
 17298         MOVE -1                 TO PMTTYPEL
 17299         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17300         GO TO 8200-SEND-DATAONLY.
 17301
 17302     IF DCT-RETURN-CODE = 'N1'
 17303
 17304* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17305*    MOVE '6"R                   !   #00015639' TO DFHEIV0
 17306     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17307     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17308     MOVE X'2020233030303135363339' TO DFHEIV0(25:11)
 17309     CALL 'kxdfhei1' USING DFHEIV0
 17310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17311         MOVE ER-0950            TO EMI-ERROR
 17312         MOVE -1                 TO PMTTYPEL
 17313         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17314         GO TO 8200-SEND-DATAONLY.
 17315
 17316     IF DCT-RETURN-CODE = 'E1'
 17317
 17318* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17319*    MOVE '6"R                   !   #00015646' TO DFHEIV0
 17320     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17321     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17322     MOVE X'2020233030303135363436' TO DFHEIV0(25:11)
 17323     CALL 'kxdfhei1' USING DFHEIV0
 17324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17325         MOVE ER-0974            TO EMI-ERROR
 17326         MOVE -1                 TO PMTTYPEL
 17327         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17328         GO TO 8200-SEND-DATAONLY.
 17329
 17330     IF DCT-RETURN-CODE = 'E2'
 17331
 17332* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17333*    MOVE '6"R                   !   #00015653' TO DFHEIV0
 17334     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17335     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17336     MOVE X'2020233030303135363533' TO DFHEIV0(25:11)
 17337     CALL 'kxdfhei1' USING DFHEIV0
 17338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17339         MOVE ER-0975            TO EMI-ERROR
 17340         MOVE -1                 TO PMTTYPEL
 17341         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17342         GO TO 8200-SEND-DATAONLY.
 17343
 17344     IF DCT-RETURN-CODE NOT = 'OK'
 17345
 17346* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17347*    MOVE '6"R                   !   #00015660' TO DFHEIV0
 17348     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17349     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17350     MOVE X'2020233030303135363630' TO DFHEIV0(25:11)
 17351     CALL 'kxdfhei1' USING DFHEIV0
 17352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17353         MOVE ER-0949            TO EMI-ERROR
 17354         MOVE -1                 TO PMTTYPEL
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 341
* EL156.cbl
 17355         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17356         GO TO 8200-SEND-DATAONLY.
 17357
 17358 7700-CONT.
 17359
 17360     MOVE 'N'                    TO CASHO.
 17361     MOVE +1                     TO CASHL.
 17362     MOVE AL-UANON               TO CASHA.
 17363
 17364     IF PI-OFFLINE = 'Y'
 17365         GO TO 7700-EXIT.
 17366
 17367     MOVE DCT-DISTRIBUTION-CODE  TO W-DMD-CHECK-NO-1.
 17368     MOVE CL-CERT-NO (4:1)       TO W-DMD-CHECK-NO-2.
 17369     MOVE 'TP'                   TO W-DMD-CHECK-NO-3.
 17370     MOVE W-DMD-CHECK-NO         TO CHECKNOO.
 17371     MOVE +7                     TO CHECKNOL.
 17372     MOVE AL-UANON               TO CHECKNOA.
 17373     GO TO 7700-EXIT.
 17374
 17375 7700-SET-TO-YES.
 17376
 17377     MOVE 'Y'                    TO CASHO.
 17378     MOVE +1                     TO CASHL.
 17379     MOVE AL-UANON               TO CASHA.
 17380
 17381 7700-EXIT.
 17382     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 342
* EL156.cbl
 17384 7800-READ-COMP-MSTR.
 17385
 17386
 17387* EXEC CICS HANDLE CONDITION
 17388*        NOTFND   (7800-COMP-NOTFND)
 17389*    END-EXEC.
 17390*    MOVE '"$I                   ! > #00015694' TO DFHEIV0
 17391     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17392     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17393     MOVE X'3E20233030303135363934' TO DFHEIV0(25:11)
 17394     CALL 'kxdfhei1' USING DFHEIV0
 17395     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17396
 17397
 17398
 17399* EXEC CICS READ
 17400*        DATASET   ('ERCOMP')
 17401*        RIDFLD    (ERCOMP-KEY)
 17402*        SET       (ADDRESS OF COMPENSATION-MASTER)
 17403*    END-EXEC.
 17404     MOVE 'ERCOMP' TO DFHEIV1
 17405*    MOVE '&"S        E          (   #00015698' TO DFHEIV0
 17406     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17407     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17408     MOVE X'2020233030303135363938' TO DFHEIV0(25:11)
 17409     CALL 'kxdfhei1' USING DFHEIV0,
 17410           DFHEIV1,
 17411           DFHEIV20,
 17412           DFHEIV99,
 17413           ERCOMP-KEY,
 17414           DFHEIV99,
 17415           DFHEIV99,
 17416           DFHEIV99
 17417     SET ADDRESS OF COMPENSATION-MASTER TO
 17418         DFHEIV20
 17419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17420
 17421
 17422     MOVE 'Y'                    TO  WS-COMP-MSTR-SW.
 17423     GO TO 7800-COMP-EXIT.
 17424
 17425 7800-COMP-NOTFND.
 17426     MOVE 'N'                    TO  WS-COMP-MSTR-SW.
 17427
 17428 7800-COMP-EXIT.
 17429     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 343
* EL156.cbl
 17431 7900-READ-CLAIM.
 17432
 17433* EXEC CICS READ
 17434*        DATASET  ('ELMSTR')
 17435*        SET      (ADDRESS OF CLAIM-MASTER)
 17436*        RIDFLD   (ELMSTR-KEY)
 17437*    END-EXEC.
 17438     MOVE 'ELMSTR' TO DFHEIV1
 17439*    MOVE '&"S        E          (   #00015714' TO DFHEIV0
 17440     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17441     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17442     MOVE X'2020233030303135373134' TO DFHEIV0(25:11)
 17443     CALL 'kxdfhei1' USING DFHEIV0,
 17444           DFHEIV1,
 17445           DFHEIV20,
 17446           DFHEIV99,
 17447           ELMSTR-KEY,
 17448           DFHEIV99,
 17449           DFHEIV99,
 17450           DFHEIV99
 17451     SET ADDRESS OF CLAIM-MASTER TO
 17452         DFHEIV20
 17453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17454
 17455
 17456 7900-EXIT.
 17457      EXIT.
 17458
 17459 7910-READ-CLAIM-UPDATE.
 17460
 17461* EXEC CICS READ
 17462*        DATASET  ('ELMSTR')
 17463*        SET      (ADDRESS OF CLAIM-MASTER)
 17464*        RIDFLD   (ELMSTR-KEY)
 17465*        UPDATE
 17466*    END-EXEC.
 17467     MOVE 'ELMSTR' TO DFHEIV1
 17468*    MOVE '&"S        EU         (   #00015724' TO DFHEIV0
 17469     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17470     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17471     MOVE X'2020233030303135373234' TO DFHEIV0(25:11)
 17472     CALL 'kxdfhei1' USING DFHEIV0,
 17473           DFHEIV1,
 17474           DFHEIV20,
 17475           DFHEIV99,
 17476           ELMSTR-KEY,
 17477           DFHEIV99,
 17478           DFHEIV99,
 17479           DFHEIV99
 17480     SET ADDRESS OF CLAIM-MASTER TO
 17481         DFHEIV20
 17482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17483
 17484
 17485 7910-EXIT.
 17486      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 344
* EL156.cbl
 17488 7920-READ-BENE.
 17489     MOVE PI-COMPANY-CD      TO BENE-COMP-CD.
 17490     MOVE 'B'                TO BENE-RECORD-TYPE.
 17491     MOVE CL-BENEFICIARY     TO BENE-NUMBER.
 17492
 17493     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17494        IF PI-PAYEE-TYPE    = 'B' AND
 17495           PI-PAYEE-SEQ-NUM = 9
 17496             MOVE CL-CURRENT-GROUPING TO WS-AIG-GROUPING
 17497             MOVE WS-A-BENE           TO BENE-NUMBER.
 17498
 17499
 17500* EXEC CICS HANDLE CONDITION
 17501*        NOTFND   (7920-NOT-FOUND)
 17502*    END-EXEC.
 17503*    MOVE '"$I                   ! ? #00015745' TO DFHEIV0
 17504     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17505     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17506     MOVE X'3F20233030303135373435' TO DFHEIV0(25:11)
 17507     CALL 'kxdfhei1' USING DFHEIV0
 17508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17509
 17510
 17511
 17512* EXEC CICS READ
 17513*        DATASET  ('ELBENE')
 17514*        SET      (ADDRESS OF BENEFICIARY-MASTER)
 17515*        RIDFLD   (ELBENE-KEY)
 17516*    END-EXEC.
 17517     MOVE 'ELBENE' TO DFHEIV1
 17518*    MOVE '&"S        E          (   #00015749' TO DFHEIV0
 17519     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17520     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17521     MOVE X'2020233030303135373439' TO DFHEIV0(25:11)
 17522     CALL 'kxdfhei1' USING DFHEIV0,
 17523           DFHEIV1,
 17524           DFHEIV20,
 17525           DFHEIV99,
 17526           ELBENE-KEY,
 17527           DFHEIV99,
 17528           DFHEIV99,
 17529           DFHEIV99
 17530     SET ADDRESS OF BENEFICIARY-MASTER TO
 17531         DFHEIV20
 17532     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17533
 17534
 17535     MOVE 'Y' TO BENE-FOUND-SW.
 17536     GO TO 7920-EXIT.
 17537
 17538 7920-NOT-FOUND.
 17539     MOVE 'N'                    TO BENE-FOUND-SW.
 17540
 17541 7920-EXIT.
 17542      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 345
* EL156.cbl
 17544 7930-READ-CONTROL.
 17545
 17546* EXEC CICS READ
 17547*        DATASET  ('ELCNTL')
 17548*        SET      (ADDRESS OF CONTROL-FILE)
 17549*        RIDFLD   (ELCNTL-KEY)
 17550*    END-EXEC.
 17551     MOVE 'ELCNTL' TO DFHEIV1
 17552*    MOVE '&"S        E          (   #00015765' TO DFHEIV0
 17553     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17554     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17555     MOVE X'2020233030303135373635' TO DFHEIV0(25:11)
 17556     CALL 'kxdfhei1' USING DFHEIV0,
 17557           DFHEIV1,
 17558           DFHEIV20,
 17559           DFHEIV99,
 17560           ELCNTL-KEY,
 17561           DFHEIV99,
 17562           DFHEIV99,
 17563           DFHEIV99
 17564     SET ADDRESS OF CONTROL-FILE TO
 17565         DFHEIV20
 17566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17567
 17568
 17569 7930-EXIT.
 17570      EXIT.
 17571
 17572 7940-READ-CONTROL-UPDATE.
 17573
 17574* EXEC CICS READ
 17575*        DATASET  ('ELCNTL')
 17576*        SET      (ADDRESS OF CONTROL-FILE)
 17577*        RIDFLD   (ELCNTL-KEY)
 17578*        UPDATE
 17579*    END-EXEC.
 17580     MOVE 'ELCNTL' TO DFHEIV1
 17581*    MOVE '&"S        EU         (   #00015775' TO DFHEIV0
 17582     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17583     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17584     MOVE X'2020233030303135373735' TO DFHEIV0(25:11)
 17585     CALL 'kxdfhei1' USING DFHEIV0,
 17586           DFHEIV1,
 17587           DFHEIV20,
 17588           DFHEIV99,
 17589           ELCNTL-KEY,
 17590           DFHEIV99,
 17591           DFHEIV99,
 17592           DFHEIV99
 17593     SET ADDRESS OF CONTROL-FILE TO
 17594         DFHEIV20
 17595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17596
 17597
 17598 7940-EXIT.
 17599      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 346
* EL156.cbl
 17601 7950-READ-TRAILER.
 17602
 17603* EXEC CICS READ
 17604*        DATASET  ('ELTRLR')
 17605*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17606*        RIDFLD   (ELTRLR-KEY)
 17607*    END-EXEC.
 17608     MOVE 'ELTRLR' TO DFHEIV1
 17609*    MOVE '&"S        E          (   #00015786' TO DFHEIV0
 17610     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17611     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17612     MOVE X'2020233030303135373836' TO DFHEIV0(25:11)
 17613     CALL 'kxdfhei1' USING DFHEIV0,
 17614           DFHEIV1,
 17615           DFHEIV20,
 17616           DFHEIV99,
 17617           ELTRLR-KEY,
 17618           DFHEIV99,
 17619           DFHEIV99,
 17620           DFHEIV99
 17621     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17622         DFHEIV20
 17623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17624
 17625
 17626 7950-EXIT.
 17627      EXIT.
 17628
 17629 7960-READ-TRAILER-UPDATE.
 17630
 17631* EXEC CICS READ
 17632*        DATASET  ('ELTRLR')
 17633*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17634*        RIDFLD   (ELTRLR-KEY)
 17635*        UPDATE
 17636*    END-EXEC.
 17637     MOVE 'ELTRLR' TO DFHEIV1
 17638*    MOVE '&"S        EU         (   #00015796' TO DFHEIV0
 17639     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17640     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17641     MOVE X'2020233030303135373936' TO DFHEIV0(25:11)
 17642     CALL 'kxdfhei1' USING DFHEIV0,
 17643           DFHEIV1,
 17644           DFHEIV20,
 17645           DFHEIV99,
 17646           ELTRLR-KEY,
 17647           DFHEIV99,
 17648           DFHEIV99,
 17649           DFHEIV99
 17650     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17651         DFHEIV20
 17652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17653
 17654
 17655 7960-EXIT.
 17656      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 347
* EL156.cbl
 17658 7970-READ-CERT.
 17659
 17660* EXEC CICS READ
 17661*        DATASET  ('ELCERT')
 17662*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 17663*        RIDFLD   (ELCERT-KEY)
 17664*    END-EXEC.
 17665     MOVE 'ELCERT' TO DFHEIV1
 17666*    MOVE '&"S        E          (   #00015807' TO DFHEIV0
 17667     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17668     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17669     MOVE X'2020233030303135383037' TO DFHEIV0(25:11)
 17670     CALL 'kxdfhei1' USING DFHEIV0,
 17671           DFHEIV1,
 17672           DFHEIV20,
 17673           DFHEIV99,
 17674           ELCERT-KEY,
 17675           DFHEIV99,
 17676           DFHEIV99,
 17677           DFHEIV99
 17678     SET ADDRESS OF CERTIFICATE-MASTER TO
 17679         DFHEIV20
 17680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17681
 17682
 17683 7970-EXIT.
 17684      EXIT.
 17685
 17686 7980-READ-CERT-UPDATE.
 17687
 17688* EXEC CICS READ
 17689*        DATASET  ('ELCERT')
 17690*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 17691*        RIDFLD   (ELCERT-KEY)
 17692*        UPDATE
 17693*    END-EXEC.
 17694     MOVE 'ELCERT' TO DFHEIV1
 17695*    MOVE '&"S        EU         (   #00015817' TO DFHEIV0
 17696     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17697     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17698     MOVE X'2020233030303135383137' TO DFHEIV0(25:11)
 17699     CALL 'kxdfhei1' USING DFHEIV0,
 17700           DFHEIV1,
 17701           DFHEIV20,
 17702           DFHEIV99,
 17703           ELCERT-KEY,
 17704           DFHEIV99,
 17705           DFHEIV99,
 17706           DFHEIV99
 17707     SET ADDRESS OF CERTIFICATE-MASTER TO
 17708         DFHEIV20
 17709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17710
 17711
 17712 7980-EXIT.
 17713      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 348
* EL156.cbl
 17715 8000-LOAD-ERROR-MESSAGES.
 17716     IF PI-PASS-SW = 'C'
 17717        MOVE EMI-LINE1           TO ERMSG1BO
 17718     ELSE
 17719        MOVE EMI-LINE1           TO ERRMSG1O
 17720        MOVE EMI-LINE2           TO ERRMSG2O.
 17721
 17722 8000-EXIT.
 17723     EXIT.
 17724
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 349
* EL156.cbl
 17726
 17727 8010-DMD-ERROR-CHECKS.
 17728     PERFORM 7700-GET-DCT THRU 7700-EXIT.
 17729
 17730     IF CN-CSI-CC-ISSUE-DT = SPACES OR LOW-VALUES OR ZEROS
 17731         GO TO 8051-ISSUE-ERROR.
 17732
 17733     MOVE CN-CSI-CC-ISSUE-DT     TO SAVE-DATE-CCYYMMDD.
 17734     MOVE SAVE-DATE-YMD          TO DC-GREG-DATE-1-YMD.
 17735     MOVE '3'                    TO DC-OPTION-CODE.
 17736     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17737     IF DC-BIN-DATE-1 > CL-INCURRED-DT
 17738         GO TO 8051-ISSUE-ERROR.
 17739
 17740     IF CL-CERT-NO (4:1) = 'U' OR 'F'
 17741       IF (CL-SOC-SEC-NO = SPACES OR LOW-VALUES OR ZEROS)
 17742                           OR
 17743          (CL-SSN-STATE   = CL-CERT-STATE  AND
 17744           CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME)
 17745             MOVE ER-0851         TO EMI-ERROR
 17746             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17747       END-IF
 17748       IF CN-CSI-CC-PREMIUM-AMT = ZERO
 17749             MOVE ER-8147         TO EMI-ERROR
 17750             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17751
 17752     GO TO 8090-EXIT.
 17753
 17754 8051-ISSUE-ERROR.
 17755     MOVE ER-8146            TO EMI-ERROR.
 17756     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17757     GO TO 8090-EXIT.
 17758
 17759 8090-EXIT.
 17760      EXIT.
 17761
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 350
* EL156.cbl
 17763 8100-SEND-INITIAL-MAP.
 17764
 17765     MOVE SAVE-DATE              TO RUNDTEAO.
 17766     MOVE EIBTIME                TO TIME-IN.
 17767     MOVE TIME-OUT               TO RUNTIMAO.
 17768     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 17769
 17770     IF MAP-NAME = 'EL156A'
 17771        IF PI-COMPANY-ID = 'CID'
 17772           MOVE 'PF6=EOB CODES'  TO PF6TITO
 17773        END-IF
 17774     END-IF
 17775     IF MAP-NAME = 'EL156A'
 17776        IF PI-COMPANY-ID = 'CRI'
 17777           NEXT SENTENCE
 17778        ELSE
 17779           MOVE AL-SADOF TO  GROUPHA  GROUPEDA.
 17780
 17781     IF MAP-NAME = 'EL156A'
 17782        IF PI-COMPANY-ID = 'BOA' OR 'CID'
 17783           NEXT SENTENCE
 17784        ELSE
 17785           MOVE AL-SADOF TO  PINTA    PINTHA.
 17786
 17787     IF MAP-NAME = 'EL156A'
 17788        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17789            NEXT SENTENCE
 17790        ELSE
 17791           MOVE AL-SADOF TO    DUEDAYHA DUEDAYA.
 17792
 17793     IF MAP-NAME = 'EL156A'
 17794        IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 17795           NEXT SENTENCE
 17796        ELSE
 17797           MOVE AL-SADOF TO CASHHA CASHA.
 17798
 17799     IF MAP-NAME = 'EL156A'
 17800        IF PI-COMPANY-ID = 'CVL' OR 'CID' OR 'DCC'
 17801           NEXT SENTENCE
 17802        ELSE
 17803           MOVE AL-SADOF        TO  LOANHA
 17804                                    LOANNOA.
 17805
 17806     IF MAP-NAME = 'EL156A'
 17807        MOVE -1                 TO  ENTERPFL
 17808        IF PI-USES-PAID-TO
 17809           MOVE 'PAID TO DATE :' TO PTHRHDGO
 17810           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 17811           MOVE PMT-HEAD-A      TO  PMTHDGAO
 17812        ELSE
 17813           NEXT SENTENCE
 17814     ELSE
 17815        IF MAP-NAME = 'EL156B'
 17816           IF PI-USES-PAID-TO
 17817              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 17818              MOVE PMT-HEAD-B     TO PMTHDGBO.
 17819
 17820
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 351
* EL156.cbl
 17821* EXEC CICS SEND
 17822*        MAP   (MAP-NAME)
 17823*        MAPSET(MAPSET-NAME)
 17824*        FROM  (EL156AI)
 17825*        ERASE
 17826*        CURSOR
 17827*    END-EXEC.
 17828     MOVE LENGTH OF
 17829      EL156AI
 17830       TO DFHEIV12
 17831     MOVE -1
 17832       TO DFHEIV11
 17833*    MOVE '8$     CT  E    H L F ,   #00015932' TO DFHEIV0
 17834     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 17835     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 17836     MOVE X'2020233030303135393332' TO DFHEIV0(25:11)
 17837     CALL 'kxdfhei1' USING DFHEIV0,
 17838           MAP-NAME,
 17839           EL156AI,
 17840           DFHEIV12,
 17841           MAPSET-NAME,
 17842           DFHEIV99,
 17843           DFHEIV99,
 17844           DFHEIV99,
 17845           DFHEIV11,
 17846           DFHEIV99,
 17847           DFHEIV99,
 17848           DFHEIV99
 17849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17850
 17851
 17852     GO TO 9100-RETURN-TRAN.
 17853
 17854 8200-SEND-DATAONLY.
 17855
 17856     IF FIRST-ENTRY = 'Y'
 17857         GO TO 8100-SEND-INITIAL-MAP.
 17858
 17859     IF RETURNED-FROM-B = 'Y'
 17860         GO TO 8100-SEND-INITIAL-MAP.
 17861
 17862     MOVE SAVE-DATE              TO RUNDTEAO.
 17863     MOVE EIBTIME                TO TIME-IN.
 17864     MOVE TIME-OUT               TO RUNTIMAO.
 17865
 17866     IF EIBAID = DFHPF11
 17867        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 17868        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17869        MOVE 'EL001   '          TO RETURNED-FROM
 17870        PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
 17871        PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
 17872        GO TO 8100-SEND-INITIAL-MAP.
 17873
 17874     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 17875
 17876     IF MAP-NAME =  'EL156A'
 17877        MOVE -1                 TO  ENTERPFL
 17878        IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 352
* EL156.cbl
 17879           MOVE 'PAID TO DATE :' TO PTHRHDGO
 17880           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 17881           MOVE PMT-HEAD-A      TO  PMTHDGAO
 17882        ELSE
 17883           NEXT SENTENCE
 17884     ELSE
 17885        IF MAP-NAME = 'EL156B'
 17886           IF PI-USES-PAID-TO
 17887              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 17888              MOVE PMT-HEAD-B     TO PMTHDGBO.
 17889
 17890     IF MAP-NAME =  'EL156A'
 17891        IF PI-COMPANY-ID = 'BOA'
 17892            IF PI-INT-RATE NUMERIC
 17893                MOVE PI-INT-RATE TO PINTO.
 17894     IF MAP-NAME = 'EL156A'
 17895        IF PI-COMPANY-ID = 'CID'
 17896           MOVE 'PF6=EOB CODES'  TO PF6TITO
 17897*          MOVE 'Y'              TO EOBYNO
 17898        END-IF
 17899     END-IF
 17900
 17901
 17902* EXEC CICS SEND
 17903*        MAP   (MAP-NAME)
 17904*        MAPSET(MAPSET-NAME)
 17905*        FROM  (EL156AI)
 17906*        DATAONLY
 17907*        CURSOR
 17908*    END-EXEC.
 17909     MOVE LENGTH OF
 17910      EL156AI
 17911       TO DFHEIV12
 17912     MOVE -1
 17913       TO DFHEIV11
 17914*    MOVE '8$D    CT       H L F ,   #00015989' TO DFHEIV0
 17915     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 17916     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 17917     MOVE X'2020233030303135393839' TO DFHEIV0(25:11)
 17918     CALL 'kxdfhei1' USING DFHEIV0,
 17919           MAP-NAME,
 17920           EL156AI,
 17921           DFHEIV12,
 17922           MAPSET-NAME,
 17923           DFHEIV99,
 17924           DFHEIV99,
 17925           DFHEIV99,
 17926           DFHEIV11,
 17927           DFHEIV99,
 17928           DFHEIV99,
 17929           DFHEIV99
 17930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17931
 17932
 17933     GO TO 9100-RETURN-TRAN.
 17934
 17935 8300-SEND-TEXT.
 17936
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 353
* EL156.cbl
 17937* EXEC CICS SEND TEXT
 17938*        FROM(LOGOFF-TEXT)
 17939*        LENGTH(LOGOFF-LENGTH)
 17940*        ERASE
 17941*        FREEKB
 17942*    END-EXEC.
 17943*    MOVE '8&      T  E F  H   F -   #00016000' TO DFHEIV0
 17944     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 17945     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 17946     MOVE X'2020233030303136303030' TO DFHEIV0(25:11)
 17947     CALL 'kxdfhei1' USING DFHEIV0,
 17948           LOGOFF-TEXT,
 17949           LOGOFF-LENGTH,
 17950           DFHEIV99,
 17951           DFHEIV99,
 17952           DFHEIV99,
 17953           DFHEIV99,
 17954           DFHEIV99,
 17955           DFHEIV99,
 17956           DFHEIV99,
 17957           DFHEIV99,
 17958           DFHEIV99,
 17959           DFHEIV99
 17960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17961
 17962
 17963
 17964* EXEC CICS RETURN
 17965*    END-EXEC.
 17966*    MOVE '.(                    &   #00016007' TO DFHEIV0
 17967     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 17968     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17969     MOVE X'2020233030303136303037' TO DFHEIV0(25:11)
 17970     CALL 'kxdfhei1' USING DFHEIV0,
 17971           DFHEIV99,
 17972           DFHEIV99,
 17973           DFHEIV99,
 17974           DFHEIV99,
 17975           DFHEIV99
 17976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17977
 17978
 17979 8500-FILE-NOTOPEN.
 17980     IF FILE-SWITCH = 'MSTR'
 17981         MOVE ER-0154            TO EMI-ERROR.
 17982     IF FILE-SWITCH = 'TRLR'
 17983         MOVE ER-0172            TO EMI-ERROR.
 17984     IF FILE-SWITCH = 'CERT'
 17985         MOVE ER-0169            TO EMI-ERROR.
 17986     IF FILE-SWITCH = 'CNTL' OR 'CARR' OR 'BENE' OR
 17987                      'PROC' OR 'STAT'
 17988         MOVE ER-0042            TO EMI-ERROR.
 17989     IF FILE-SWITCH = 'ACTQ'
 17990         MOVE ER-0338            TO EMI-ERROR.
 17991     IF FILE-SWITCH = 'ACCT'
 17992         MOVE ER-0168            TO EMI-ERROR.
 17993
 17994     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 354
* EL156.cbl
 17995     MOVE -1                     TO PMTTYPEL.
 17996
 17997     IF FIRST-ENTRY = 'Y'
 17998         GO TO 8100-SEND-INITIAL-MAP.
 17999
 18000     GO TO 8200-SEND-DATAONLY.
 18001
 18002 8600-PGRM-NOT-FOUND.
 18003
 18004     MOVE ER-0923                TO EMI-ERROR.
 18005     MOVE -1                     TO ENTPFBL.
 18006     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18007
 18008     IF FIRST-ENTRY = 'Y'
 18009         GO TO 8100-SEND-INITIAL-MAP
 18010     ELSE
 18011         GO TO 8200-SEND-DATAONLY.
 18012
 18013 8800-UNAUTHORIZED-ACCESS.
 18014     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 18015     GO TO 8300-SEND-TEXT.
 18016
 18017 8810-PF23.
 18018     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 18019     MOVE XCTL-005               TO PGM-NAME.
 18020     GO TO 9300-XCTL.
 18021
 18022 8820-PF7-8.
 18023     MOVE XCTL-126               TO PI-CALLING-PROGRAM.
 18024     MOVE SPACES                 TO PI-SAVED-PROGRAM-1
 18025                                    PI-SAVED-PROGRAM-2
 18026                                    PI-SAVED-PROGRAM-3
 18027                                    PI-SAVED-PROGRAM-4
 18028                                    PI-SAVED-PROGRAM-5
 18029                                    PI-SAVED-PROGRAM-6
 18030                                    PI-RETURN-TO-PROGRAM.
 18031     IF EIBAID = DFHPF8
 18032        MOVE XCTL-132            TO PGM-NAME
 18033     ELSE
 18034        MOVE XCTL-130            TO PGM-NAME.
 18035
 18036     GO TO 9300-XCTL.
 18037
 18038 9100-RETURN-TRAN.
 18039     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 18040     MOVE '156A'                 TO PI-CURRENT-SCREEN-NO.
 18041
 18042
 18043* EXEC CICS RETURN
 18044*        TRANSID(TRANS-ID)
 18045*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 18046*        LENGTH(PI-COMM-LENGTH)
 18047*    END-EXEC.
 18048*    MOVE '.(CT                  &   #00016073' TO DFHEIV0
 18049     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 18050     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18051     MOVE X'2020233030303136303733' TO DFHEIV0(25:11)
 18052     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 355
* EL156.cbl
 18053           TRANS-ID,
 18054           PROGRAM-INTERFACE-BLOCK,
 18055           PI-COMM-LENGTH,
 18056           DFHEIV99,
 18057           DFHEIV99
 18058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18059
 18060
 18061 9200-RETURN-MAIN-MENU.
 18062     MOVE XCTL-126               TO PGM-NAME.
 18063     GO TO 9300-XCTL.
 18064
 18065 9300-XCTL.
 18066
 18067* EXEC CICS XCTL
 18068*        PROGRAM(PGM-NAME)
 18069*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 18070*        LENGTH(PI-COMM-LENGTH)
 18071*    END-EXEC.
 18072*    MOVE '.$C                   $   #00016084' TO DFHEIV0
 18073     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 18074     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18075     MOVE X'2020233030303136303834' TO DFHEIV0(25:11)
 18076     CALL 'kxdfhei1' USING DFHEIV0,
 18077           PGM-NAME,
 18078           PROGRAM-INTERFACE-BLOCK,
 18079           PI-COMM-LENGTH
 18080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18081
 18082
 18083 9400-CLEAR.
 18084     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 18085     GO TO 9300-XCTL.
 18086
 18087 9500-PF12.
 18088     MOVE XCTL-010               TO PGM-NAME.
 18089     GO TO 9300-XCTL.
 18090
 18091 9700-LINK-DATE-CONVERT.
 18092     MOVE LINK-ELDATCV           TO PGM-NAME.
 18093
 18094* EXEC CICS LINK
 18095*        PROGRAM   (PGM-NAME)
 18096*        COMMAREA  (DATE-CONVERSION-DATA)
 18097*        LENGTH    (DC-COMM-LENGTH)
 18098*    END-EXEC.
 18099*    MOVE '."C                   ''   #00016100' TO DFHEIV0
 18100     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18101     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18102     MOVE X'2020233030303136313030' TO DFHEIV0(25:11)
 18103     CALL 'kxdfhei1' USING DFHEIV0,
 18104           PGM-NAME,
 18105           DATE-CONVERSION-DATA,
 18106           DC-COMM-LENGTH,
 18107           DFHEIV99,
 18108           DFHEIV99,
 18109           DFHEIV99
 18110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 356
* EL156.cbl
 18111
 18112
 18113 9700-EXIT.
 18114     EXIT.
 18115
 18116 9800-LINK-REM-TERM.
 18117     MOVE LINK-REMTERM TO PGM-NAME.
 18118
 18119
 18120* EXEC CICS LINK
 18121*        PROGRAM   (PGM-NAME)
 18122*        COMMAREA  (CALCULATION-PASS-AREA)
 18123*        LENGTH    (CP-COMM-LENGTH)
 18124*    END-EXEC.
 18125*    MOVE '."C                   ''   #00016112' TO DFHEIV0
 18126     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18127     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18128     MOVE X'2020233030303136313132' TO DFHEIV0(25:11)
 18129     CALL 'kxdfhei1' USING DFHEIV0,
 18130           PGM-NAME,
 18131           CALCULATION-PASS-AREA,
 18132           CP-COMM-LENGTH,
 18133           DFHEIV99,
 18134           DFHEIV99,
 18135           DFHEIV99
 18136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18137
 18138
 18139 9800-EXIT.
 18140     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 357
* EL156.cbl
 18142 9830-DMD-REMAINING-TERM.
 18143
 18144     DIVIDE CL-NO-OF-DAYS-PAID BY +30
 18145         GIVING W-PAID-MONTHS REMAINDER W-PAID-DAYS.
 18146
 18147     COMPUTE W-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 18148                              CM-PMT-EXTENSION-DAYS.
 18149
 18150     COMPUTE W-REM-TERM-IN-DAYS = W-TERM-IN-DAYS -
 18151                                  CL-NO-OF-DAYS-PAID.
 18152
 18153     DIVIDE W-REM-TERM-IN-DAYS BY +30
 18154         GIVING W-REM REMAINDER W-REM-DAYS.
 18155
 18156     MOVE W-REM                  TO WST-REM.
 18157
 18158     IF W-REM-DAYS > ZEROS
 18159         MOVE '/'                TO WST-SLASH
 18160         MOVE W-REM-DAYS         TO WST-REM-DAYS
 18161     ELSE
 18162         MOVE SPACES             TO WST-REM-DAYS-GRP.
 18163
 18164 9830-EXIT.
 18165     EXIT.
 18166
 18167 9870-OUTPUT-ACTIVITY-RECORD.
 18168
 18169
 18170* EXEC CICS GETMAIN
 18171*         SET(ADDRESS OF DAILY-ACTIVITY-RECORD)
 18172*         LENGTH(25)
 18173*         INITIMG(WS-BLANK)
 18174*    END-EXEC.
 18175     MOVE 25
 18176       TO DFHEIV11
 18177*    MOVE ',"IL                  $   #00016148' TO DFHEIV0
 18178     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18179     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18180     MOVE X'2020233030303136313438' TO DFHEIV0(25:11)
 18181     CALL 'kxdfhei1' USING DFHEIV0,
 18182           DFHEIV20,
 18183           DFHEIV11,
 18184           WS-BLANK
 18185     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 18186         DFHEIV20
 18187     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18188
 18189
 18190     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 18191     MOVE ELMSTR-KEY             TO DA-KEY.
 18192     MOVE CL-TRAILER-SEQ-CNT     TO DA-TRAILER-SEQ-NO.
 18193
 18194     IF PI-PMTTYPE EQUAL '7'
 18195         MOVE 'V'                TO DA-RECORD-TYPE
 18196     ELSE
 18197         MOVE 'P'                TO DA-RECORD-TYPE.
 18198
 18199
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 358
* EL156.cbl
 18200* EXEC CICS HANDLE CONDITION
 18201*         NOTOPEN(9870-NOTOPEN)
 18202*         DUPREC(9870-EXIT)
 18203*    END-EXEC.
 18204*    MOVE '"$J%                  ! @ #00016163' TO DFHEIV0
 18205     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 18206     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18207     MOVE X'4020233030303136313633' TO DFHEIV0(25:11)
 18208     CALL 'kxdfhei1' USING DFHEIV0
 18209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18210
 18211
 18212
 18213* EXEC CICS WRITE
 18214*         DATASET('DLYACTV')
 18215*         RIDFLD(DA-KEY)
 18216*         FROM(DAILY-ACTIVITY-RECORD)
 18217*         LENGTH(25)
 18218*    END-EXEC.
 18219     MOVE 'DLYACTV' TO DFHEIV1
 18220     MOVE 25
 18221       TO DFHEIV11
 18222*    MOVE '&$ L                  ''   #00016168' TO DFHEIV0
 18223     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18224     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18225     MOVE X'2020233030303136313638' TO DFHEIV0(25:11)
 18226     CALL 'kxdfhei1' USING DFHEIV0,
 18227           DFHEIV1,
 18228           DAILY-ACTIVITY-RECORD,
 18229           DFHEIV11,
 18230           DA-KEY,
 18231           DFHEIV99,
 18232           DFHEIV99
 18233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18234
 18235     MOVE 'N'                    TO ERROR-ON-OUTPUT-SW.
 18236     GO TO 9870-EXIT.
 18237
 18238 9870-NOTOPEN.
 18239
 18240     MOVE '2955'                 TO EMI-ERROR.
 18241     MOVE 'Y'                    TO ERROR-ON-OUTPUT-SW.
 18242
 18243 9870-EXIT.
 18244     EXIT.
 18245
 18246 9900-ERROR-FORMAT.
 18247
 18248     IF EMI-ERROR = ER-0923
 18249         MOVE PGM-NAME           TO W-CALLED-NAME.
 18250
 18251     MOVE LINK-001      TO PGM-NAME.
 18252     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 18253
 18254
 18255* EXEC CICS LINK
 18256*        PROGRAM (PGM-NAME)
 18257*        COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 359
* EL156.cbl
 18258*        LENGTH  (EMI-COMM-LENGTH)
 18259*    END-EXEC.
 18260*    MOVE '."C                   ''   #00016193' TO DFHEIV0
 18261     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18262     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18263     MOVE X'2020233030303136313933' TO DFHEIV0(25:11)
 18264     CALL 'kxdfhei1' USING DFHEIV0,
 18265           PGM-NAME,
 18266           ERROR-MESSAGE-INTERFACE-BLOCK,
 18267           EMI-COMM-LENGTH,
 18268           DFHEIV99,
 18269           DFHEIV99,
 18270           DFHEIV99
 18271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18272
 18273
 18274     IF EMI-ERROR = ER-0923
 18275         MOVE W-CALLED-NAME      TO EMI-TEXT-VARIABLE (1).
 18276
 18277 9900-EXIT.
 18278     EXIT.
 18279
 18280 9990-ABEND.
 18281     MOVE LINK-004               TO PGM-NAME.
 18282     MOVE DFHEIBLK               TO EMI-LINE1.
 18283
 18284* EXEC CICS LINK
 18285*        PROGRAM   (PGM-NAME)
 18286*        COMMAREA  (EMI-LINE1)
 18287*        LENGTH    (64)
 18288*    END-EXEC.
 18289     MOVE 64
 18290       TO DFHEIV11
 18291*    MOVE '."C                   ''   #00016208' TO DFHEIV0
 18292     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18293     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18294     MOVE X'2020233030303136323038' TO DFHEIV0(25:11)
 18295     CALL 'kxdfhei1' USING DFHEIV0,
 18296           PGM-NAME,
 18297           EMI-LINE1,
 18298           DFHEIV11,
 18299           DFHEIV99,
 18300           DFHEIV99,
 18301           DFHEIV99
 18302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18303
 18304
 18305     MOVE 'EL156A'               TO  MAP-NAME.
 18306     MOVE LOW-VALUES             TO  EL156AO.
 18307     GO TO 8100-SEND-INITIAL-MAP.
 18308
 18309 9995-SECURITY-VIOLATION.
 18310*    COPY ELCSCTP.
 18311******************************************************************
 18312*                                                                *
 18313*                            ELCSCTP                             *
 18314*                            VMOD=2.001                          *
 18315*                                                                *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 360
* EL156.cbl
 18316*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 18317******************************************************************
 18318
 18319
 18320     MOVE EIBDATE          TO SM-JUL-DATE.
 18321     MOVE EIBTRMID         TO SM-TERMID.
 18322     MOVE THIS-PGM         TO SM-PGM.
 18323     MOVE EIBTIME          TO TIME-IN.
 18324     MOVE TIME-OUT         TO SM-TIME.
 18325     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 18326
 18327
 18328* EXEC CICS LINK
 18329*         PROGRAM  ('EL003')
 18330*         COMMAREA (SECURITY-MESSAGE)
 18331*         LENGTH   (80)
 18332*    END-EXEC.
 18333     MOVE 'EL003' TO DFHEIV1
 18334     MOVE 80
 18335       TO DFHEIV11
 18336*    MOVE '."C                   ''   #00016236' TO DFHEIV0
 18337     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18338     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18339     MOVE X'2020233030303136323336' TO DFHEIV0(25:11)
 18340     CALL 'kxdfhei1' USING DFHEIV0,
 18341           DFHEIV1,
 18342           SECURITY-MESSAGE,
 18343           DFHEIV11,
 18344           DFHEIV99,
 18345           DFHEIV99,
 18346           DFHEIV99
 18347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18348
 18349
 18350******************************************************************
 18351
 18352
 18353
 18354 9999-DFHBACK SECTION.
 18355     MOVE '9%                    "   ' TO DFHEIV0
 18356     MOVE 'EL156' TO DFHEIV1
 18357     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 18358     GOBACK.
 18359 9999-DFHEXIT.
 18360     IF DFHEIGDJ EQUAL 0001
 18361         NEXT SENTENCE
 18362     ELSE IF DFHEIGDJ EQUAL 2
 18363         GO TO 9990-ABEND,
 18364               8600-PGRM-NOT-FOUND,
 18365               0400-FIRST-TIME,
 18366               6180-DUPREC,
 18367               9990-ABEND
 18368         DEPENDING ON DFHEIGDI
 18369     ELSE IF DFHEIGDJ EQUAL 3
 18370         GO TO 0380-CLAIM-END-FILE,
 18371               0380-CLAIM-END-FILE
 18372         DEPENDING ON DFHEIGDI
 18373     ELSE IF DFHEIGDJ EQUAL 4
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 361
* EL156.cbl
 18374         GO TO 0380-CLAIM-END-FILE,
 18375               0380-CLAIM-END-FILE
 18376         DEPENDING ON DFHEIGDI
 18377     ELSE IF DFHEIGDJ EQUAL 5
 18378         GO TO 0800-EXIT
 18379         DEPENDING ON DFHEIGDI
 18380     ELSE IF DFHEIGDJ EQUAL 6
 18381         GO TO 1950-NOT-FOUND,
 18382               1950-NOT-FOUND
 18383         DEPENDING ON DFHEIGDI
 18384     ELSE IF DFHEIGDJ EQUAL 7
 18385         GO TO 1950-NOT-FOUND
 18386         DEPENDING ON DFHEIGDI
 18387     ELSE IF DFHEIGDJ EQUAL 8
 18388         GO TO 1950-NOT-FOUND,
 18389               1950-NOT-FOUND
 18390         DEPENDING ON DFHEIGDI
 18391     ELSE IF DFHEIGDJ EQUAL 9
 18392         GO TO 1166-END-CHECK,
 18393               1166-END-CHECK
 18394         DEPENDING ON DFHEIGDI
 18395     ELSE IF DFHEIGDJ EQUAL 10
 18396         GO TO 1950-NOT-FOUND,
 18397               1950-NOT-FOUND
 18398         DEPENDING ON DFHEIGDI
 18399     ELSE IF DFHEIGDJ EQUAL 11
 18400         GO TO 1950-NOT-FOUND,
 18401               1950-NOT-FOUND
 18402         DEPENDING ON DFHEIGDI
 18403     ELSE IF DFHEIGDJ EQUAL 12
 18404         GO TO 1950-NOT-FOUND
 18405         DEPENDING ON DFHEIGDI
 18406     ELSE IF DFHEIGDJ EQUAL 13
 18407         GO TO 5300-NOTE-NOT-FOUND
 18408         DEPENDING ON DFHEIGDI
 18409     ELSE IF DFHEIGDJ EQUAL 14
 18410         GO TO 6065-NOT-FOUND
 18411         DEPENDING ON DFHEIGDI
 18412     ELSE IF DFHEIGDJ EQUAL 15
 18413         GO TO 6068-ACCT-NOT-FND
 18414         DEPENDING ON DFHEIGDI
 18415     ELSE IF DFHEIGDJ EQUAL 16
 18416         GO TO 6074-GET-COMP-DATA
 18417         DEPENDING ON DFHEIGDI
 18418     ELSE IF DFHEIGDJ EQUAL 17
 18419         GO TO 6170-WRITE
 18420         DEPENDING ON DFHEIGDI
 18421     ELSE IF DFHEIGDJ EQUAL 18
 18422         GO TO 6180-DUPREC
 18423         DEPENDING ON DFHEIGDI
 18424     ELSE IF DFHEIGDJ EQUAL 19
 18425         GO TO 6190-DUPREC
 18426         DEPENDING ON DFHEIGDI
 18427     ELSE IF DFHEIGDJ EQUAL 20
 18428         GO TO 6185-DUPREC
 18429         DEPENDING ON DFHEIGDI
 18430     ELSE IF DFHEIGDJ EQUAL 21
 18431         GO TO 6720-BUILD-NEW-RECORD
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 362
* EL156.cbl
 18432         DEPENDING ON DFHEIGDI
 18433     ELSE IF DFHEIGDJ EQUAL 22
 18434         GO TO 6900-BUILD-ARCHIVE-HEADER,
 18435               6900-BUILD-ARCHIVE-HEADER
 18436         DEPENDING ON DFHEIGDI
 18437     ELSE IF DFHEIGDJ EQUAL 23
 18438         GO TO 7100-SHOW-RECORD-NOT-FOUND
 18439         DEPENDING ON DFHEIGDI
 18440     ELSE IF DFHEIGDJ EQUAL 24
 18441         GO TO 7160-DUPREC
 18442         DEPENDING ON DFHEIGDI
 18443     ELSE IF DFHEIGDJ EQUAL 25
 18444         GO TO 7200-EXIT,
 18445               7200-EXIT
 18446         DEPENDING ON DFHEIGDI
 18447     ELSE IF DFHEIGDJ EQUAL 26
 18448         GO TO 7400-NOT-FOUND
 18449         DEPENDING ON DFHEIGDI
 18450     ELSE IF DFHEIGDJ EQUAL 27
 18451         GO TO 7590-END,
 18452               7590-END
 18453         DEPENDING ON DFHEIGDI
 18454     ELSE IF DFHEIGDJ EQUAL 28
 18455         GO TO 7699-EXIT
 18456         DEPENDING ON DFHEIGDI
 18457     ELSE IF DFHEIGDJ EQUAL 29
 18458         GO TO 5300-NOTE-NOT-FOUND
 18459         DEPENDING ON DFHEIGDI
 18460     ELSE IF DFHEIGDJ EQUAL 30
 18461         GO TO 7800-COMP-NOTFND
 18462         DEPENDING ON DFHEIGDI
 18463     ELSE IF DFHEIGDJ EQUAL 31
 18464         GO TO 7920-NOT-FOUND
 18465         DEPENDING ON DFHEIGDI
 18466     ELSE IF DFHEIGDJ EQUAL 32
 18467         GO TO 9870-NOTOPEN,
 18468               9870-EXIT
 18469         DEPENDING ON DFHEIGDI.
 18470     MOVE '9%                    "   ' TO DFHEIV0
 18471     MOVE 'EL156' TO DFHEIV1
 18472     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 18473     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:       11620     Code:       68426
