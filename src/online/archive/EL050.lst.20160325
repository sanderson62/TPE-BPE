* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    48* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    49* 051914  CR2014043000002  TANA  CHANGE EDIT FOR CANCEL DATE
    50* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    51* 091114  IR2014091000001  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
    52*                                CERT #, ADD 2898 FORCIBLE ERROR
    53* 072215  IR2015031000002  PEMA  CHG EDIT FOR ERROR 2889
    54* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    55******************************************************************
    56 ENVIRONMENT DIVISION.
    57
    58 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page   3
* EL050.cbl
    60 WORKING-STORAGE SECTION.
    61 01  DFH-START PIC X(04).
    62
    63 77  FILLER   PIC X(32) VALUE '********************************'.
    64 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    65 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    66
    67 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    68 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    69                                   USAGE POINTER.
    70 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    71 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    72 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    73                                   USAGE IS POINTER.
    74 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    75 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    76                                   USAGE IS POINTER.
    77 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    78 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    79                                   USAGE IS POINTER.
    80
    81 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    82 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    83                                   USAGE IS POINTER.
    84
    85*    COPY ELC50WS.
    86*****************************************************************
    87*                                                               *
    88*                            ELC50WS.                           *
    89*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    90*                            VMOD=2.061.                        *
    91*                                                               *
    92*   THIS IS THE WORKING STORAGE FOR EL050                       *
    93*                                   EL517                       *
    94*****************************************************************
    95******************************************************************
    96*                   C H A N G E   L O G
    97*
    98* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    99*-----------------------------------------------------------------
   100*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   101* EFFECTIVE    NUMBER
   102*-----------------------------------------------------------------
   103* 123102                   PEMA  ADD DCC PROCESSING
   104* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
   105* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
   106* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
   107* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   108* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   109* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   110* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   111* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   112* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   113* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   114* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   115* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   116* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   117* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page   4
* EL050.cbl
   118* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   119* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   120* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   121* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   122* 030309  CR2009021700001  PEMA  ADD ER-2883
   123* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   124* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   125* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   126* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   127* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   128* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   129* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   130* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   131* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   132* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   133* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   134* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   135* 061412  CR2011022800001  AJRA  NAPERSOFT
   136* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   137* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   138* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   139* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   140* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   141* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   142* 040914  IR2014040900001  AJRA  ADD ERROR 2896
   143* 051914  CR2014043000002  TANA  ADD CAUSAL STATE AND ERROR 2897
   144* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   145* 091114  IR2014091000001  TANA  ADD ERROR 2898
   146* 121815  CR2015121700006  PEMA  ADD ERROR 3827
   147* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
   148*-----------------------------------------------------------------
   149
   150 01  WORK-AREAS.
   151
   152*****************************************************************
   153*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   154*****************************************************************
   155
   156     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   157     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   158     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   159     12  WS-NAME-EDIT-WORK-AREA.
   160         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   161         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   162             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   163         16  WS-WORK-NAME.
   164             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   165             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   166             20  FILLER           PIC X(10)     VALUE SPACES.
   167         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   168             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   169
   170*****************************************************************
   171*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   172*****************************************************************
   173
   174     12  WS-ERRESC-KEY.
   175         16 WS-ERRESC-SEARCH-KEY.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page   5
* EL050.cbl
   176             20  WS-ERRESC-COMPANY-CD PIC  X.
   177             20  WS-ERRESC-CARRIER    PIC  X.
   178             20  WS-ERRESC-GROUP      PIC X(6).
   179             20  WS-ERRESC-STATE      PIC XX.
   180             20  WS-ERRESC-ACCOUNT    PIC X(10).
   181         16 WS-ERRESC-RESIDUAL-KEY.
   182             20  WS-ERRESC-AGENT      PIC X(10).
   183             20  WS-ERRESC-RES-STATE  PIC XX.
   184             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   185*                                          YYYYMMDD
   186     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   187     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   188
   189*RESIDENT STATE TAX MASTER(ERRESS)
   190*
   191     12  WS-ERRESS-KEY.
   192         16  WS-ERRESS-COMPANY-CD      PIC  X.
   193         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   194         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   195         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   196*                                          YYYYMMDD
   197
   198     12  WS-CONTRACT-DATE              PIC 9(8).
   199*                                          YYYYMMDD
   200     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   201     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   202         16 WS-YEAR-YY                 PIC   9999.
   203         16 FILLER                     PIC 9(4).
   204*                                          YYYYMMDD
   205     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   206     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   207     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   208     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   209
   210     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   211         88  DPRB-1ST-TIME                      VALUE ' '.
   212
   213*****************************************************************
   214*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   215*****************************************************************
   216
   217     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   218     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   219     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   220     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   221     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   222     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   223     12  WS-ST-CAUSAL-STATE      PIC X          VALUE SPACES.
   224     12  ws-st-agent-sig-edit    pic x          value spaces.
   225     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   226     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   227     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   228     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   229         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   230         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   231     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   232         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   233         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page   6
* EL050.cbl
   234     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   235
   236     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   237     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   238
   239     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   240     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   241     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   242     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   243     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   244     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   245     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   246     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   247     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   248     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   249     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   250     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   251     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   252     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   253     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   254     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   255     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   256     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   257     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   258     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   259     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   260     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   261     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   262     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   263     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   264     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   265     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   266     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   267     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   268     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   269     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   270     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   271     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   272     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   273     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   274     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   275     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   276     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   277     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   278     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   279     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   280     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   281     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   282     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   283     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   284     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   285     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   286     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   287     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   288     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   289     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   290     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   291     12  WS-2671-SW               PIC X         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page   7
* EL050.cbl
   292     12  WS-2672-SW               PIC X         VALUE SPACE.
   293     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   294         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   295     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   296         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   297     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   298
   299     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   300         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   301         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   302         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   303         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   304
   305     12  WS-CREDIT-EDIT-CONTROLS.
   306         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   307         16  WS-MIN-AGE           PIC 99                VALUE  0.
   308         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   309         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   310         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   311         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   312
   313     12  ws-vehicle-odometer     pic s9(7) comp-3 value +0.
   314     12  WS-AGE-FIELDS.
   315         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   316         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   317         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   318         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   319
   320     12  WS-SAVE-ALLOWABLE-BENEFIT.
   321         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   322         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   323         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   324         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   325         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   326         16  FILLER                      PIC XX.
   327
   328     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   329     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   330     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   331     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   332     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   333     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   334     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   335     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   336     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   337     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   338
   339     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   340     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   341     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   342     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   343     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   344     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   345     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   346     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   347         88  WS-REDUCING              VALUE 'R'.
   348         88  WS-LEVEL                 VALUE 'L' 'P'.
   349     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page   8
* EL050.cbl
   350
   351     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   352     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   353     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   354     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   355     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   356     12  ws-ah-max-bens           pic 99        value zeros.
   357     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   358     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   359     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   360     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   361
   362     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   363     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   364     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   365     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   366     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   367     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   368     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   369     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   370     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   371     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   372     12  WS-ACCT-SIG-SW.
   373         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   374         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   375     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   376     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   377     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   378     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   379     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   380     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   381     12  ws-cred-union-fees       pic s9(5)v99  comp-3 value +0.
   382     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   383     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   384     12  WS-INITIALS.
   385         16  WS-INIT-1            PIC X         VALUE SPACES.
   386         16  WS-INIT-2            PIC X         VALUE SPACES.
   387
   388     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   389     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   390     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   391     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   392     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   393*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   394     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   395     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   396     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   397     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   398     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   399     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   400     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   401     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   402     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   403     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   404     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   405     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   406     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   407     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page   9
* EL050.cbl
   408     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   409     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   410     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   411     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   412     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   413     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   414     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   415     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   416******** FLA
   417     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   418     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   419     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   420     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   421     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   422********
   423     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   424     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   425     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   426     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   427     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   428     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   429     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   430     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   431     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   432     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   433
   434     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   435         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   436                                         '0' THRU '9'.
   437
   438     12  NUMBER-OF-MONTHS.
   439         16  SK-MO OCCURS 12 TIMES PIC X.
   440
   441     12  WS-WORK-DATE.
   442         16  WS-YEAR            PIC 99    VALUE 00.
   443         16  WS-MONTH           PIC 99    VALUE 00.
   444         16  WS-DAY             PIC 99    VALUE 00.
   445
   446     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   447     12  WS-WORK-CRIT-DEV       REDEFINES
   448         WS-WORK-LF-CRIT-PER    PIC X(03).
   449
   450     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   451     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   452
   453     12  WS-WORK-DATE-FROM.
   454         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   455         16  FILLER             PIC X  VALUE SPACE.
   456         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   457         16  FILLER             PIC X         VALUE SPACE.
   458         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   459
   460     12  WS-WORK-DATE-THRU.
   461         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   462         16  FILLER             PIC X         VALUE SPACE.
   463         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   464         16  FILLER             PIC X         VALUE SPACE.
   465         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  10
* EL050.cbl
   466
   467     12  WS-LF-INPUT-CD.
   468         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   469         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   470
   471     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   472     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   473         16  WS-AH-INPUT-CD-1   PIC X.
   474         16  WS-AH-INPUT-CD-2-3 PIC XX.
   475
   476     12  WS-SWITCHES.
   477         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   478         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   479             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   480         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   481             88  BANK-ACCT-FOUND          VALUE 'Y'.
   482         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   483             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   484         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   485             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   486         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   487             88  COMP-MASTER-FOUND        VALUE 'Y'.
   488         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   489             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   490         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   491             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   492         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   493             88  STAT-MASTER-FOUND        VALUE 'Y'.
   494         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   495             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   496         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   497             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   498         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   499             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   500         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   501             88  FORM-MASTER-FOUND        VALUE 'Y'.
   502         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   503             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   504         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   505             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   506         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   507             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   508         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   509             88  NO-BENEFIT-FOUND         VALUE 'N'.
   510         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   511             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   512         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   513             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   514         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   515             88  AH-BENEFIT-FOUND         VALUE ' '.
   516             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   517         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   518             88  LF-BENEFIT-FOUND         VALUE ' '.
   519             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   520         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   521             88  NO-STATE-RECORD          VALUE '1'.
   522         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   523             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  11
* EL050.cbl
   524         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   525             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   526         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   527             88  CERT-WAS-FOUND           VALUE ' '.
   528             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   529         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   530             88  BROWSE-STARTED           VALUE 'Y'.
   531         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   532             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   533         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   534             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   535         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   536             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   537         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   538             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   539         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   540             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   541         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   542             88  APP-CERT-USED            VALUE 'Y' 'A'.
   543         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   544             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   545             88  FIRST-TIME-THROUGH       VALUE '1'.
   546             88  CTBL-NOT-FOUND           VALUE '2'.
   547
   548         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   549             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   550
   551         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   552             88  DLO-ERROR-FOUND          VALUE 'Y'.
   553
   554********FLA
   555     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   556     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   557********
   558     12  RC-SW-1                  PIC X           VALUE '0'.
   559     12  RC-SW-2                  PIC X           VALUE '0'.
   560     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   561     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   562     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   563     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   564     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   565     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   566     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   567     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   568     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   569     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   570     12  LIT-SPACES               PIC X           VALUE SPACES.
   571     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   572     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   573     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   574     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   575     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   576     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   577     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   578         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   579         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   580     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   581         88  SKIP-ADDR-EDIT         VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  12
* EL050.cbl
   582
   583 01  WS-EXTRA-PERIODS-BY-STATE.
   584     12  WS-INT-PERIODS          PIC 9.
   585     12  WS-EXTRA-PMTS           PIC 9.
   586 01  ws-net-only-state           pic x value 'N'.
   587 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   588     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   589     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   590 01  WS-CRI-SSN-WORK-AREA.
   591     05  WS-CRI-SOC-SEC-NO.
   592         10  WS-SS-REPT-CD       PIC X(5).
   593         10  WS-SS-LAST-NAME     PIC X(5).
   594         10  WS-SS-INITIAL       PIC X.
   595
   596     05  WS-CRI-REPORT-CODE.
   597         10  FILLER              PIC X(5).
   598         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   599
   600     05  WS-CRI-LAST-NAME.
   601         10  WS-CRI-NAME-MOVE    PIC X(5).
   602         10  FILLER              PIC X(10).
   603
   604 01  WS-NUM-TABLE                PIC X(26)  VALUE
   605     '12345678012345070923456789'.
   606 01  FILLER REDEFINES WS-NUM-TABLE.
   607     05  WS-NUM OCCURS 26        PIC 9.
   608 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   609 01  V1                          PIC S999 COMP-3.
   610 01  V2                          PIC S999 COMP-3.
   611 01  V3                          PIC S999 COMP-3.
   612 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   613 01  FILLER REDEFINES WS-WORK-VIN.
   614     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   615 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   616 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   617 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   618 01  WS-HEX-WORK.
   619     05  FILLER                  PIC X  VALUE LOW-VALUES.
   620     05  WS-HEX-BYTE             PIC X.
   621 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   622 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   623 01  WS-WORK-HIN-ROW-B.
   624     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   625
   626 01  ws-benefit-cd-chg-sw      pic x value spaces.
   627     88  benefit-code-chg           value 'Y'.
   628 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   629 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   630     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   631 01  WS-ROW-D-TABLE.
   632     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   633
   634 01  WS-HIN-TABLE-B.
   635     05  F                       PIC XX VALUE 'A2'.
   636     05  F                       PIC XX VALUE 'B3'.
   637     05  F                       PIC XX VALUE 'C4'.
   638     05  F                       PIC XX VALUE 'D5'.
   639     05  F                       PIC XX VALUE 'E6'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  13
* EL050.cbl
   640     05  F                       PIC XX VALUE 'F7'.
   641     05  F                       PIC XX VALUE 'G8'.
   642     05  F                       PIC XX VALUE 'H9'.
   643     05  F                       PIC XX VALUE 'I1'.
   644     05  F                       PIC XX VALUE 'J2'.
   645     05  F                       PIC XX VALUE 'K3'.
   646     05  F                       PIC XX VALUE 'L4'.
   647     05  F                       PIC XX VALUE 'M5'.
   648     05  F                       PIC XX VALUE 'N6'.
   649     05  F                       PIC XX VALUE 'O0'.
   650     05  F                       PIC XX VALUE 'P7'.
   651     05  F                       PIC XX VALUE 'Q0'.
   652     05  F                       PIC XX VALUE 'R8'.
   653     05  F                       PIC XX VALUE 'S9'.
   654     05  F                       PIC XX VALUE 'T2'.
   655     05  F                       PIC XX VALUE 'U3'.
   656     05  F                       PIC XX VALUE 'V4'.
   657     05  F                       PIC XX VALUE 'W5'.
   658     05  F                       PIC XX VALUE 'X6'.
   659     05  F                       PIC XX VALUE 'Y7'.
   660     05  F                       PIC XX VALUE 'Z8'.
   661 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   662     05  WS-VAL-IN               PIC X.
   663     05  WS-VAL-OUT              PIC 9.
   664 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   665 01  WS-COMPARE-BINARY-DATES.
   666     05  WS-971231                PIC XX VALUE X'92FF'.
   667     05  WS-931231                PIC XX VALUE X'8CFF'.
   668     05  WS-791231                PIC XX VALUE X'77FF'.
   669     05  WS-771001                PIC XX VALUE X'74A1'.
   670     05  WS-820301                PIC XX VALUE X'7B41'.
   671     05  WS-831031                PIC XX VALUE X'7DBF'.
   672     05  WS-831231                PIC XX VALUE X'7DFF'.
   673     05  WS-810831                PIC XX VALUE X'7A7F'.
   674     05  WS-830901                PIC XX VALUE X'7D81'.
   675
   676 01  FILE-ACCESS-IDS.
   677     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   678     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   679     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   680     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   681     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   682     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   683     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   684     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   685     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   686     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   687     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   688     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   689     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   690     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   691     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   692     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   693     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   694 01  DD-IU-SW                    PIC X   VALUE ' '.
   695     88  DD-IU-PRESENT                 VALUE 'Y'.
   696
   697 01  ACCESS-KEYS.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  14
* EL050.cbl
   698     12  ELMSTR-KEY.
   699         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   700         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   701     12  W-CLAIM-KEY.
   702         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   703         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   704
   705     12  ELCNTL-KEY.
   706         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   707         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   708         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   709         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   710
   711     12  ELCERT-KEY.
   712         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   713         16  CERT-CARRIER         PIC X       VALUE SPACE.
   714         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   715         16  CERT-STATE           PIC XX      VALUE SPACES.
   716         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   717         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   718         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   719
   720     12  ELCERT2-KEY.
   721         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   722         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   723
   724     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   725
   726     12  ELCERT-SAVE.
   727         16  FILLER                      PIC XX    VALUE SPACES.
   728
   729         16  WCS-CONTROL-PRIMARY.
   730             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   731             20  WCS-CARRIER             PIC X     VALUE SPACE.
   732             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   733             20  WCS-STATE               PIC XX    VALUE SPACES.
   734             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   735             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   736             20  WCS-CERT-NO.
   737                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   738                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   739
   740         16  CS-CONTROL-BY-NAME.
   741             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   742             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   743             20  CS-INSURED-INITIALS.
   744                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   745                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   746
   747         16  CS-CONTROL-BY-SSN.
   748             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   749             20  CS-SOC-SEC-NO.
   750                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   751                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   752                 24  CS-SSN-LN3.
   753                     28 CS-INSURED-INITIALS-A2   PIC XX
   754                                     VALUE SPACES.
   755                     28 CS-PART-LAST-NAME-A2     PIC X
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  15
* EL050.cbl
   756                                     VALUE SPACE.
   757
   758         16  CS-CONTROL-BY-CERT-NO.
   759             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   760             20  CS-CERT-NO-A4           PIC X(11)
   761                                     VALUE SPACES.
   762
   763         16  CS-CONTROL-BY-MEMB.
   764             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   765             20  CS-MEMBER-NO.
   766                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   767                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   768                 24  CS-MEMB-LN4.
   769                     28 CS-INSURED-INITIALS-A5   PIC XX
   770                                      VALUE SPACES.
   771                     28 CS-PART-LAST-NAME-A5     PIC XX
   772                                      VALUE SPACES.
   773
   774         16  FILLER              PIC X(360) VALUE SPACES.
   775
   776     12  ERACCT-KEY.
   777         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   778         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   779         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   780         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   781         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   782         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   783
   784     12  ERCOMP-KEY.
   785         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   786         16  COMP-CARRIER         PIC X     VALUE SPACES.
   787         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   788         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   789         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   790         16  COMP-TYPE            PIC X     VALUE SPACES.
   791
   792     12  ERLOFC-KEY.
   793         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   794         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   795         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   796         16  LOFC-STATE           PIC XX    VALUE SPACES.
   797         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   798         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   799
   800     12  WS-ELCRTT-KEY.
   801         16  WS-ELCRTT-PRIMARY       PIC X(33).
   802         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   803
   804     12  ERBXRF-KEY.
   805         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   806         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   807         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   808         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   809
   810     12  ERAGTC-KEY.
   811         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   812         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   813         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  16
* EL050.cbl
   814         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   815         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   816         16  AGTC-TYPE            PIC X     VALUE SPACES.
   817
   818     12  ERPLAN-KEY.
   819         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   820         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   821         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   822         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   823         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   824         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   825         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   826         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   827
   828     12  ERFORM-KEY.
   829         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   830         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   831         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   832         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   833
   834     12  ERREIN-KEY.
   835         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   836         16  REIN-TYPE            PIC X     VALUE SPACES.
   837         16  REIN-TABLE-CO.
   838             20  REIN-CODE-1      PIC X     VALUE SPACE.
   839             20  REIN-CODE-2      PIC X     VALUE SPACE.
   840             20  REIN-CODE-3      PIC X     VALUE SPACE.
   841         16  FILLER               PIC X(3)  VALUE SPACES.
   842
   843     12  ERCTBL-KEY.
   844         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   845         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   846         16  CTBL-CNTRL-2.
   847             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   848             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   849
   850     12  ELCRTO-KEY.
   851         16  ELCRTO-COMPANY-CD       PIC X.
   852         16  ELCRTO-CARRIER          PIC X.
   853         16  ELCRTO-GROUPING         PIC X(6).
   854         16  ELCRTO-STATE            PIC XX.
   855         16  ELCRTO-ACCOUNT          PIC X(10).
   856         16  ELCRTO-CERT-EFF-DT      PIC XX.
   857         16  ELCRTO-CERT-NO.
   858             20  ELCRTO-CERT-PRIME   PIC X(10).
   859             20  ELCRTO-CERT-SFX     PIC X.
   860         16  ELCRTO-RECORD-TYPE      PIC X.
   861         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   862
   863
   864     12  WS-ACCESS.
   865         16  FILLER               PIC XX    VALUE SPACES.
   866         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   867
   868     12  WS-CARR-ACCESS.
   869         16  FILLER               PIC X(3)  VALUE SPACES.
   870         16  WS-CARR              PIC X     VALUE SPACE.
   871*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  17
* EL050.cbl
   872*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   873     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   874         88  WS-DMD-LF-RATING   VALUE 'Y'.
   875         88  WS-DMD-AH-RATING   VALUE 'Y'.
   876         88  WS-DMD-NO-RATING   VALUE 'N'.
   877
   878     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   879         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   880                                         'NJ' 'NL'
   881                                         'PJ' 'PL'
   882                                         'SJ' 'SL'.
   883     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   884         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   885                                         'NI' 'NJ' 'NL' 'NU'
   886                                         'PJ' 'PL' 'PI' 'PU'
   887                                         'SI' 'SJ' 'SL' 'SU'
   888                                         'MX' 'MY' 'MZ'.
   889 01  ERPDEF-KEY-SAVE             PIC X(18).
   890 01  ERPDEF-KEY.
   891     12  ERPDEF-COMPANY-CD       PIC X.
   892     12  ERPDEF-STATE            PIC XX.
   893     12  ERPDEF-PROD-CD          PIC XXX.
   894     12  F                       PIC X(7).
   895     12  ERPDEF-BEN-TYPE         PIC X.
   896     12  ERPDEF-BEN-CODE         PIC XX.
   897     12  ERPDEF-EXP-DT           PIC XX.
   898
   899 01  ELSTAT-KEY-SAVE             PIC X(20).
   900 01  ELSTAT-KEY.
   901     12  ELSTAT-COMPANY-ID       PIC XXX.
   902     12  ELSTAT-CARRIER          PIC X.
   903     12  ELSTAT-GROUP            PIC X(6).
   904     12  ELSTAT-STATE            PIC XX.
   905     12  ELSTAT-EXP-DT           PIC 9(8).
   906 01  WS-ERROR-VALUES.
   907     12  ER-1570                     PIC S9(4)   VALUE +1570.
   908     12  ER-1571                     PIC S9(4)   VALUE +1571.
   909     12  er-1572                     pic s9(4)   value +1572.
   910     12  er-1573                     pic s9(4)   value +1573.
   911     12  er-1574                     pic s9(4)   value +1574.
   912     12  ER-1575                     PIC S9(4)   VALUE +1575.
   913     12  er-1576                     pic s9(4)   value +1576.
   914     12  er-1583                     pic s9(4)   value +1583.
   915     12  er-1743                     pic s9(4)   value +1743.
   916     12  er-1744                     pic s9(4)   value +1744.
   917     12  er-1745                     pic s9(4)   value +1745.
   918     12  er-1746                     pic s9(4)   value +1746.
   919     12  er-1747                     pic s9(4)   value +1747.
   920     12  er-1748                     pic s9(4)   value +1748.
   921     12  ER-1891                     PIC S9(4)   VALUE +1891.
   922     12  ER-1892                     PIC S9(4)   VALUE +1892.
   923     12  ER-1893                     PIC S9(4)   VALUE +1893.
   924     12  ER-1894                     PIC S9(4)   VALUE +1894.
   925     12  ER-1895                     PIC S9(4)   VALUE +1895.
   926     12  ER-1896                     PIC S9(4)   VALUE +1896.
   927     12  ER-1897                     PIC S9(4)   VALUE +1897.
   928     12  ER-1898                     PIC S9(4)   VALUE +1898.
   929     12  ER-1899                     PIC S9(4)   VALUE +1899.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  18
* EL050.cbl
   930     12  ER-1900                     PIC S9(4)   VALUE +1900.
   931     12  ER-1901                     PIC S9(4)   VALUE +1901.
   932     12  ER-1902                     PIC S9(4)   VALUE +1902.
   933     12  ER-1903                     PIC S9(4)   VALUE +1903.
   934     12  ER-1904                     PIC S9(4)   VALUE +1904.
   935     12  ER-1905                     PIC S9(4)   VALUE +1905.
   936     12  ER-1906                     PIC S9(4)   VALUE +1906.
   937     12  ER-1907                     PIC S9(4)   VALUE +1907.
   938     12  ER-1909                     PIC S9(4)   VALUE +1909.
   939     12  ER-1910                     PIC S9(4)   VALUE +1910.
   940     12  ER-1911                     PIC S9(4)   VALUE +1911.
   941     12  ER-1912                     PIC S9(4)   VALUE +1912.
   942     12  ER-1913                     PIC S9(4)   VALUE +1913.
   943     12  ER-1914                     PIC S9(4)   VALUE +1914.
   944     12  ER-1915                     PIC S9(4)   VALUE +1915.
   945     12  ER-1916                     PIC S9(4)   VALUE +1916.
   946     12  ER-1917                     PIC S9(4)   VALUE +1917.
   947     12  ER-1918                     PIC S9(4)   VALUE +1918.
   948     12  ER-1919                     PIC S9(4)   VALUE +1919.
   949     12  ER-1920                     PIC S9(4)   VALUE +1920.
   950     12  ER-1921                     PIC S9(4)   VALUE +1921.
   951     12  ER-1922                     PIC S9(4)   VALUE +1922.
   952     12  ER-1923                     PIC S9(4)   VALUE +1923.
   953     12  ER-1924                     PIC S9(4)   VALUE +1924.
   954     12  ER-1925                     PIC S9(4)   VALUE +1925.
   955     12  ER-1926                     PIC S9(4)   VALUE +1926.
   956     12  ER-1927                     PIC S9(4)   VALUE +1927.
   957     12  ER-2393                     PIC S9(4)   VALUE +2393.
   958     12  ER-2600                     PIC S9(4)   VALUE +2600.
   959     12  ER-2601                     PIC S9(4)   VALUE +2601.
   960     12  ER-2602                     PIC S9(4)   VALUE +2602.
   961     12  ER-2603                     PIC S9(4)   VALUE +2603.
   962     12  ER-2604                     PIC S9(4)   VALUE +2604.
   963     12  ER-2605                     PIC S9(4)   VALUE +2605.
   964     12  ER-2606                     PIC S9(4)   VALUE +2606.
   965     12  ER-2607                     PIC S9(4)   VALUE +2607.
   966     12  ER-2608                     PIC S9(4)   VALUE +2608.
   967     12  ER-2609                     PIC S9(4)   VALUE +2609.
   968     12  ER-2610                     PIC S9(4)   VALUE +2610.
   969     12  ER-2611                     PIC S9(4)   VALUE +2611.
   970     12  ER-2612                     PIC S9(4)   VALUE +2612.
   971     12  ER-2613                     PIC S9(4)   VALUE +2613.
   972     12  ER-2614                     PIC S9(4)   VALUE +2614.
   973     12  ER-2615                     PIC S9(4)   VALUE +2615.
   974     12  ER-2616                     PIC S9(4)   VALUE +2616.
   975     12  ER-2617                     PIC S9(4)   VALUE +2617.
   976     12  ER-2618                     PIC S9(4)   VALUE +2618.
   977     12  ER-2619                     PIC S9(4)   VALUE +2619.
   978     12  ER-2620                     PIC S9(4)   VALUE +2620.
   979     12  ER-2621                     PIC S9(4)   VALUE +2621.
   980     12  ER-2622                     PIC S9(4)   VALUE +2622.
   981     12  ER-2623                     PIC S9(4)   VALUE +2623.
   982     12  ER-2624                     PIC S9(4)   VALUE +2624.
   983     12  ER-2625                     PIC S9(4)   VALUE +2625.
   984     12  ER-2626                     PIC S9(4)   VALUE +2626.
   985     12  ER-2627                     PIC S9(4)   VALUE +2627.
   986     12  ER-2628                     PIC S9(4)   VALUE +2628.
   987     12  ER-2629                     PIC S9(4)   VALUE +2629.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  19
* EL050.cbl
   988     12  ER-2630                     PIC S9(4)   VALUE +2630.
   989     12  ER-2631                     PIC S9(4)   VALUE +2631.
   990     12  ER-2632                     PIC S9(4)   VALUE +2632.
   991     12  ER-2633                     PIC S9(4)   VALUE +2633.
   992     12  ER-2634                     PIC S9(4)   VALUE +2634.
   993     12  ER-2635                     PIC S9(4)   VALUE +2635.
   994     12  ER-2636                     PIC S9(4)   VALUE +2636.
   995     12  ER-2637                     PIC S9(4)   VALUE +2637.
   996     12  ER-2638                     PIC S9(4)   VALUE +2638.
   997     12  ER-2639                     PIC S9(4)   VALUE +2639.
   998     12  ER-2640                     PIC S9(4)   VALUE +2640.
   999     12  ER-2641                     PIC S9(4)   VALUE +2641.
  1000     12  ER-2642                     PIC S9(4)   VALUE +2642.
  1001     12  ER-2643                     PIC S9(4)   VALUE +2643.
  1002     12  ER-2644                     PIC S9(4)   VALUE +2644.
  1003     12  ER-2645                     PIC S9(4)   VALUE +2645.
  1004     12  ER-2646                     PIC S9(4)   VALUE +2646.
  1005     12  ER-2647                     PIC S9(4)   VALUE +2647.
  1006     12  ER-2648                     PIC S9(4)   VALUE +2648.
  1007     12  ER-2649                     PIC S9(4)   VALUE +2649.
  1008     12  ER-2650                     PIC S9(4)   VALUE +2650.
  1009     12  ER-2651                     PIC S9(4)   VALUE +2651.
  1010     12  ER-2652                     PIC S9(4)   VALUE +2652.
  1011     12  ER-2653                     PIC S9(4)   VALUE +2653.
  1012     12  ER-2654                     PIC S9(4)   VALUE +2654.
  1013     12  ER-2655                     PIC S9(4)   VALUE +2655.
  1014     12  ER-2656                     PIC S9(4)   VALUE +2656.
  1015     12  ER-2657                     PIC S9(4)   VALUE +2657.
  1016     12  ER-2658                     PIC S9(4)   VALUE +2658.
  1017     12  ER-2659                     PIC S9(4)   VALUE +2659.
  1018     12  ER-2660                     PIC S9(4)   VALUE +2660.
  1019     12  ER-2661                     PIC S9(4)   VALUE +2661.
  1020     12  ER-2662                     PIC S9(4)   VALUE +2662.
  1021     12  ER-2663                     PIC S9(4)   VALUE +2663.
  1022     12  ER-2664                     PIC S9(4)   VALUE +2664.
  1023     12  ER-2665                     PIC S9(4)   VALUE +2665.
  1024     12  ER-2666                     PIC S9(4)   VALUE +2666.
  1025     12  ER-2667                     PIC S9(4)   VALUE +2667.
  1026     12  ER-2668                     PIC S9(4)   VALUE +2668.
  1027     12  ER-2669                     PIC S9(4)   VALUE +2669.
  1028     12  ER-2670                     PIC S9(4)   VALUE +2670.
  1029     12  ER-2671                     PIC S9(4)   VALUE +2671.
  1030     12  ER-2672                     PIC S9(4)   VALUE +2672.
  1031     12  ER-2673                     PIC S9(4)   VALUE +2673.
  1032     12  ER-2674                     PIC S9(4)   VALUE +2674.
  1033     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1034     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1035     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1036     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1037     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1038     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1039     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1040     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1041     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1042     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1043     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1044     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1045     12  ER-2687                     PIC S9(4)   VALUE +2687.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  20
* EL050.cbl
  1046     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1047     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1048     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1049     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1050     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1051     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1052     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1053     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1054     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1055     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1056     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1057     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1058     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1059     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1060     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1061     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1062     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1063     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1064     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1065     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1066     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1067     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1068     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1069     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1070     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1071     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1072     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1073     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1074     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1075     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1076     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1077     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1078     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1079     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1080     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1081     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1082     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1083     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1084     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1085     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1086     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1087     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1088     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1089     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1090     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1091     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1092     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1093     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1094     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1095     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1096     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1097     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1098     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1099     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1100     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1101     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1102     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1103     12  ER-2755                     PIC S9(4)   VALUE +2755.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  21
* EL050.cbl
  1104     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1105     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1106     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1107     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1108     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1109     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1110     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1111     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1112     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1113     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1114     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1115     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1116     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1117     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1118     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1119     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1120     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1121     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1122     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1123     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1124     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1125     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1126     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1127     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1128     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1129     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1130     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1131     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1132     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1133     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1134     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1135     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1136     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1137     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1138     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1139     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1140     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1141     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1142     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1143     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1144     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1145     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1146     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1147     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1148     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1149     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1150     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1151     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1152     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1153     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1154     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1155     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1156     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1157     12  ER-2896                     PIC S9(4)   VALUE +2896.
  1158     12  ER-2897                     PIC S9(4)   VALUE +2897.
  1159     12  ER-2898                     PIC S9(4)   VALUE +2898.
  1160     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1161     12  ER-2964                     PIC S9(4)   VALUE +2964.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  22
* EL050.cbl
  1162     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1163     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1164     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1165     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1166     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1167     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1168     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1169     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1170     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1171     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1172     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1173     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1174     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1175     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1176     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1177     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1178     12  ER-3827                     PIC S9(4)   VALUE +3827.
  1179     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1180     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1181     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1182     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1183     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1184     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1185     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1186     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1187     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1188     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1189     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1190     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1191     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1192     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1193     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1194     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1195     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1196     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1197     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1198     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1199     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1200     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1201     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1202     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1203     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1204     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1205     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1206     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1207     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1208     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1209     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1210     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1211     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1212     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1213     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1214     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1215     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1216     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1217     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1218     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1219     12  ER-8082                     PIC S9(4)   VALUE +8082.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  23
* EL050.cbl
  1220     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1221     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1222     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1223     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1224     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1225     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1226     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1227     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1228     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1229     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1230     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1231     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1232     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1233     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1234     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1235     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1236     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1237     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1238     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1239     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1240     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1241     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1242     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1243     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1244     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1245     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1246     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1247     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1248     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1249     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1250     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1251     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1252     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1253     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1254     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1255     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1256     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1257     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1258     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1259     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1260     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1261     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1262     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1263     12  ER-9813                     PIC S9(4)   VALUE +9813.
  1264     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1265******************************************************************
  1266***************   END OF ELC50WS     ****************************
  1267******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  24
* EL050.cbl
  1270 01  WORKING-STORAGE-WORK-AREAS.
  1271     12  WS-RESPONSE             PIC S9(8)  COMP.
  1272         88  WS-RESP-NORMAL           VALUE +00.
  1273         88  WS-RESP-ERROR            VALUE +01.
  1274         88  WS-RESP-NOTFND           VALUE +13.
  1275         88  WS-RESP-DUPREC           VALUE +14.
  1276         88  WS-RESP-ENDFILE          VALUE +20.
  1277     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1278     12  WORK-AREAS.
  1279         16  WK-CONV-GREG.
  1280             24  WCG-CENT             PIC XX.
  1281             24  WCG-REST             PIC X(4).
  1282         16  WORK-GREGORIAN-DATE.
  1283             24  WK-GREG-CENT         PIC XX.
  1284             24  WK-GREG-DATE-YYMMDD.
  1285                 28  WK-GREG-YYMM     PIC X(4).
  1286                 28  WK-GREG-DD       PIC XX.
  1287
  1288         16  WORK-SELECT-DATE.
  1289             24  WK-SELECT-CENT            PIC XX.
  1290             24  WK-SELECT-DATE-YYMMDD.
  1291                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1292                 28  FILLER                PIC XX.
  1293
  1294         16  WK-FORM-NO.
  1295             24  WK-FORM-BANK-ID       PIC X(5).
  1296             24  WK-FORM-UNDRWRTR      PIC X(1).
  1297             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1298
  1299         16  WK-MEMBER-NO.
  1300             24  WK-MEMBER-1-6        PIC X(6).
  1301             24  WK-MEMBER-7-12       PIC X(6).
  1302
  1303         16  WK-FULL-CERT-NO.
  1304             24  WK-CERT-POS-1-2      PIC X(2).
  1305             24  WK-CERT-POS-3        PIC X(1).
  1306             24  WK-CERT-POS-4        PIC X(1).
  1307             24  WK-CERT-POS-5-6      PIC X(2).
  1308             24  WK-CERT-POS-7        PIC X(1).
  1309             24  WK-CERT-POS-8-11     PIC X(4).
  1310
  1311         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1312             88  VALID-RATE-CODE        VALUE 'Y'.
  1313             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1314
  1315         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1316         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1317         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1318         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1319         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1320         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1321         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1322         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1323         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1324         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1325
  1326* DLO001
  1327 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  25
* EL050.cbl
  1328     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1329     12  DMPF-RETURN-CODE          PIC XX.
  1330         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1331         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1332         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1333         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1334         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1335         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1336
  1337* DLO002
  1338 01  WS-DLO-INTERNAL-POLICY-FORM.
  1339     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1340     12  DIPF-RETURN-CODE          PIC XX.
  1341         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1342         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1343         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1344         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1345         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1346         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1347
  1348* DLO003
  1349 01  WS-DLO-VALID-BANK-ID.
  1350     12  DVBI-BANK-ID              PIC X(5).
  1351     12  DVBI-BANK-ID-TYPE         PIC X.
  1352         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1353         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1354         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1355         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1356         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1357     12  DVBI-RETURN-CODE          PIC XX.
  1358         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1359         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1360         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1361         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1362         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1363         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1364         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1365         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1366         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1367
  1368* DLO007
  1369 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1370     12  DCUA-RES-STATE            PIC XX.
  1371     12  DCUA-BEN-TYPE             PIC XX.
  1372     12  DCUA-SYS-IDENT            PIC X.
  1373         88  DCUA-CLAIM                        VALUE 'C'.
  1374         88  DCUA-PREMIUM                      VALUE 'P'.
  1375     12  DCUA-COVERAGE-RULE        PIC X.
  1376     12  DCUA-CLIENT-ID            PIC X(10).
  1377     12  DCUA-EFF-DATE             PIC X(8).
  1378     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1379     12  DCUA-RETURN-CODE          PIC XX.
  1380         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1381     12  DCUA-CERT-NUMBER          PIC X(11).
  1382     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1383     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1384
  1385* DLO011
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  26
* EL050.cbl
  1386 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1387     12  DPRB-RATE-CODE            PIC X(4).
  1388     12  DPRB-COVERAGE-CATEG       PIC X.
  1389     12  DPRB-RETURN-CODE          PIC XX.
  1390         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1391         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1392         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1393         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1394         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1395         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1396         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1397         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1398         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1399     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1400     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1401     12  DPRB-BEN-TYPE             PIC XX.
  1402
  1403* DLO017
  1404 01  WS-DLO-VALID-RATE-CODE.
  1405     12  DVRC-RATE-CODE            PIC X(4).
  1406     12  DVRC-RETURN-CODE          PIC XX.
  1407         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1408         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1409         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1410         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1411         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1412         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1413
  1414* DLO019
  1415 01  WS-DLO-ORIG-COV-CAT.
  1416     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1417     12  DOCC-RETURN-CODE          PIC XX.
  1418     12  DOCC-ORIG-COV-CAT         PIC X.
  1419     12  DOCC-UNDERWITER           PIC XX.
  1420     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1421     12  DOCC-FILLER               PIC X(6).
  1422
  1423* DLO021
  1424 01  WS-DLO-VALID-LOAN-OFFICER.
  1425     12  DVLO-LOAN-OFFICER.
  1426         16  DVLO-BILL-TYPE        PIC X.
  1427         16  DVLO-BILL-SOURCE      PIC X.
  1428         16  DVLO-BATCH-TYPE       PIC X.
  1429     12  DVLO-RETURN-CODE          PIC XX.
  1430         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1431         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1432         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1433         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1434         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1435         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1436
  1437* DLO022
  1438 01  WS-DLO-VALID-STATE-CODE.
  1439     12  DVSC-STATE-CODE           PIC XX.
  1440     12  DVSC-RETURN-CODE          PIC XX.
  1441         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1442
  1443* DLO023
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  27
* EL050.cbl
  1444 01  WS-DLO-VALID-CODE-VALUES.
  1445     12  DVCV-SYSTEM-ID            PIC XX.
  1446         88  DVCV-CLAIMS                       VALUE 'CL'.
  1447         88  DVCV-CREDIT                       VALUE 'CR'.
  1448     12  DVCV-RECORD-TYPE          PIC XX.
  1449         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1450         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1451         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1452         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1453         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1454         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1455         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1456         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1457     12  DVCV-RECORD-KEY           PIC X(6).
  1458     12  DVCV-RETURN-CODE          PIC XX.
  1459         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1460         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1461         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1462         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1463         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1464         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1465         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1466     12  DVCV-CODE-DESC            PIC X(60).
  1467     12  DVCV-GEN-DESC-1           PIC X(20).
  1468     12  DVCV-GEN-DESC-2           PIC X(20).
  1469     12  DVCV-GEN-DESC-3           PIC X(20).
  1470
  1471****  this is for aggregate report.
  1472****  Length is erpndb + 100 of passed-key-area
  1473 01  ws-passed-key-length        pic s9(4) comp value +587.
  1474 01  ws-pass-to-pemaggo.
  1475     05  ws-passed-erpndb        pic x(585).
  1476     05  ws-exceed-limit-yn      pic x.
  1477     05  ws-has-claim-yn         pic x.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  28
* EL050.cbl
  1479*    COPY ERCBXRF.
  1480******************************************************************
  1481*                                                                *
  1482*                                                                *
  1483*                            ERCBXRF                             *
  1484*                                                                *
  1485*   ONLINE CREDIT SYSTEM                                         *
  1486*                                                                *
  1487*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1488*                                                                *
  1489*   FILE TYPE = VSAM,KSDS                                        *
  1490*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1491*                                                                *
  1492*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1493*       ALTERNATE PATH = NONE                                    *
  1494*                                                                *
  1495*   LOG = NO                                                     *
  1496*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1497*                                                                *
  1498******************************************************************
  1499
  1500 01  BANK-CROSS-REFERENCE.
  1501     12  BK-RECORD-ID                PIC XX.
  1502         88  VALID-BK-ID             VALUE 'BK'.
  1503
  1504     12  BK-CONTROL-PRIMARY.
  1505         16  BK-COMPANY-CD           PIC X.
  1506         16  BK-CARRIER              PIC X.
  1507         16  BK-GROUPING             PIC X(6).
  1508         16  BK-BANK-NO              PIC X(10).
  1509
  1510     12  BK-MAINT-INFORMATION.
  1511         16  BK-LAST-MAINT-DT        PIC XX.
  1512         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1513         16  BK-LAST-MAINT-USER      PIC X(4).
  1514         16  FILLER                  PIC X(9).
  1515
  1516     12  FILLER                      PIC X(37).
  1517
  1518     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1519
  1520     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1521                            DEPENDING ON BK-BANK-POINTER-CNT.
  1522         16  BK-AM-ACCOUNT           PIC X(10).
  1523         16  BK-AM-EXP-DT            PIC XX.
  1524         16  BK-AM-EFF-DT            PIC XX.
  1525         16  BK-AM-STATE             PIC XX.
  1526         16  FILLER                  PIC X(20).
  1527
  1528******************************************************************
  1529
  1530*    COPY ERCCOMP.
  1531******************************************************************
  1532*                                                                *
  1533*                                                                *
  1534*                            ERCCOMP                             *
  1535*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1536*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  29
* EL050.cbl
  1537*                                                                *
  1538*   ONLINE CREDIT SYSTEM                                         *
  1539*                                                                *
  1540*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1541*                                                                *
  1542*   FILE TYPE = VSAM,KSDS                                        *
  1543*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1544*                                                                *
  1545*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1546*       ALTERNATE PATH = NONE                                    *
  1547*                                                                *
  1548*   LOG = NO                                                     *
  1549*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1550*                                                                *
  1551******************************************************************
  1552*                   C H A N G E   L O G
  1553*
  1554* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1555*-----------------------------------------------------------------
  1556*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1557* EFFECTIVE    NUMBER
  1558*-----------------------------------------------------------------
  1559* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1560* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1561* 092205    2005050300006  PEMA  ADD LEASE FEE
  1562* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1563* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1564* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1565* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1566* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1567* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1568******************************************************************
  1569
  1570 01  COMPENSATION-MASTER.
  1571     12  CO-RECORD-ID                          PIC XX.
  1572         88  VALID-CO-ID                          VALUE 'CO'.
  1573
  1574     12  CO-CONTROL-PRIMARY.
  1575         16  CO-COMPANY-CD                     PIC X.
  1576         16  CO-CONTROL.
  1577             20  CO-CTL-1.
  1578                 24  CO-CARR-GROUP.
  1579                     28  CO-CARRIER            PIC X.
  1580                     28  CO-GROUPING.
  1581                         32  CO-GROUP-PREFIX   PIC XXX.
  1582                         32  CO-GROUP-PRIME    PIC XXX.
  1583                 24  CO-RESP-NO.
  1584                     28  CO-RESP-PREFIX        PIC X(4).
  1585                     28  CO-RESP-PRIME         PIC X(6).
  1586             20  CO-CTL-2.
  1587                 24  CO-ACCOUNT.
  1588                     28  CO-ACCT-PREFIX        PIC X(4).
  1589                     28  CO-ACCT-PRIME         PIC X(6).
  1590         16  CO-TYPE                           PIC X.
  1591             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1592             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1593             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1594
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  30
* EL050.cbl
  1595     12  CO-MAINT-INFORMATION.
  1596         16  CO-LAST-MAINT-DT                  PIC XX.
  1597         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1598         16  CO-LAST-MAINT-USER                PIC X(4).
  1599     12  FILLER                                PIC XX.
  1600     12  CO-STMT-TYPE                          PIC XXX.
  1601     12  CO-COMP-TYPE                          PIC X.
  1602         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1603     12  CO-STMT-OWNER                         PIC X(4).
  1604     12  CO-BALANCE-CONTROL                    PIC X.
  1605         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1606         88  CO-NO-BALANCE                        VALUE 'N'.
  1607
  1608     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1609         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1610         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1611         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1612
  1613     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1614         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1615         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1616
  1617     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1618     12  CO-GA-DIRECT-DEP                      PIC X.
  1619     12  CO-FUTURE-SPACE                       PIC X.
  1620         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1621
  1622     12  CO-ACCT-NAME                          PIC X(30).
  1623     12  CO-MAIL-NAME                          PIC X(30).
  1624     12  CO-ADDR-1                             PIC X(30).
  1625     12  CO-ADDR-2                             PIC X(30).
  1626     12  CO-ADDR-3.
  1627         16  CO-ADDR-CITY                      PIC X(27).
  1628         16  CO-ADDR-STATE                     PIC XX.
  1629     12  CO-CSO-1099                           PIC X.
  1630     12  CO-ZIP.
  1631         16  CO-ZIP-PRIME.
  1632             20  CO-ZIP-PRI-1ST                PIC X.
  1633                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1634             20  FILLER                        PIC X(4).
  1635         16  CO-ZIP-PLUS4                      PIC X(4).
  1636     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1637         16  CO-CAN-POSTAL-1                   PIC XXX.
  1638         16  CO-CAN-POSTAL-2                   PIC XXX.
  1639         16  FILLER                            PIC XXX.
  1640     12  CO-SOC-SEC                            PIC X(13).
  1641     12  CO-TELEPHONE.
  1642         16  CO-AREA-CODE                      PIC XXX.
  1643         16  CO-PREFIX                         PIC XXX.
  1644         16  CO-PHONE                          PIC X(4).
  1645
  1646     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1647
  1648     12  CO-AR-BAL-LEVEL                       PIC X.
  1649         88  CO-AR-REF-LVL                        VALUE '1'.
  1650         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1651         88  CO-AR-BILL-LVL                       VALUE '2'.
  1652         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  31
* EL050.cbl
  1653         88  CO-AR-FR-LVL                         VALUE '4'.
  1654
  1655     12  CO-AR-NORMAL-PRINT                    PIC X.
  1656         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1657         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1658
  1659     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1660
  1661     12  CO-AR-REPORTING                       PIC X.
  1662         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1663         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1664
  1665     12  CO-AR-PULL-CHECK                      PIC X.
  1666         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1667         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1668
  1669     12  CO-AR-BALANCE-PRINT                   PIC X.
  1670         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1671
  1672     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1673         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1674         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1675         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1676
  1677     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1678
  1679     12  CO-USER-CODE                          PIC X.
  1680     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1681
  1682******************************************************************
  1683*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1684*    THE LAST MONTH END RUN.
  1685******************************************************************
  1686
  1687     12  CO-LAST-ACTIVITY-DATE.
  1688         16  CO-ACT-YEAR                       PIC 99.
  1689         16  CO-ACT-MONTH                      PIC 99.
  1690         16  CO-ACT-DAY                        PIC 99.
  1691
  1692     12  CO-LAST-STMT-DT.
  1693         16  CO-LAST-STMT-YEAR                 PIC 99.
  1694         16  CO-LAST-STMT-MONTH                PIC 99.
  1695         16  CO-LAST-STMT-DAY                  PIC 99.
  1696
  1697     12  CO-MO-END-TOTALS.
  1698         16  CO-MONTHLY-TOTALS.
  1699             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1700             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1701             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1702             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1703             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1704
  1705         16  CO-AGING-TOTALS.
  1706             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1707             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1708             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1709             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1710
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  32
* EL050.cbl
  1711         16  CO-YTD-TOTALS.
  1712             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1713             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1714
  1715         16  CO-OVER-UNDER-TOTALS.
  1716             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1717             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1718
  1719     12  CO-MISCELLANEOUS-TOTALS.
  1720         16  CO-FICA-TOTALS.
  1721             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1722             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1723
  1724         16  CO-CLAIM-TOTALS.
  1725             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1726             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1727
  1728******************************************************************
  1729*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1730*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1731******************************************************************
  1732
  1733     12  CO-CURRENT-TOTALS.
  1734         16  CO-CURRENT-LAST-STMT-DT.
  1735             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1736             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1737             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1738
  1739         16  CO-CURRENT-MONTHLY-TOTALS.
  1740             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1741             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1742             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1743             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1744             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1745
  1746         16  CO-CURRENT-AGING-TOTALS.
  1747             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1748             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1749             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1750             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1751
  1752         16  CO-CURRENT-YTD-TOTALS.
  1753             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1754             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1755
  1756     12  CO-PAID-COMM-TOTALS.
  1757         16  CO-YTD-PAID-COMMS.
  1758             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1759             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1760
  1761     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1762         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1763         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1764
  1765     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1766         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1767         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1768         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  33
* EL050.cbl
  1769         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1770         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1771         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1772         88  CO-FINAL-LETTER                  VALUE 'F'.
  1773         88  CO-RECONCILING                   VALUE 'R'.
  1774         88  CO-PHONE-CALL                    VALUE 'P'.
  1775         88  CO-LEGAL                         VALUE 'L'.
  1776         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1777         88  CO-WRITE-OFF                     VALUE 'W'.
  1778         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1779
  1780     12  CO-CSR-CODE                       PIC X(4).
  1781
  1782     12  CO-GA-STATUS-INFO.
  1783         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1784         16  CO-GA-TERMINATION-DT          PIC XX.
  1785         16  CO-GA-STATUS-CODE             PIC X.
  1786             88  CO-GA-ACTIVE                 VALUE 'A'.
  1787             88  CO-GA-INACTIVE               VALUE 'I'.
  1788             88  CO-GA-PENDING                VALUE 'P'.
  1789         16  CO-GA-COMMENTS.
  1790             20  CO-GA-COMMENT-1           PIC X(40).
  1791             20  CO-GA-COMMENT-2           PIC X(40).
  1792             20  CO-GA-COMMENT-3           PIC X(40).
  1793             20  CO-GA-COMMENT-4           PIC X(40).
  1794
  1795     12  CO-RPTCD2                         PIC X(10).
  1796     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1797         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1798         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1799
  1800     12  CO-TYPE-AGENT                     PIC X(01).
  1801         88  CO-CORPORATION                   VALUE 'C'.
  1802         88  CO-PARTNERSHIP                   VALUE 'P'.
  1803         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1804         88  CO-TRUST                         VALUE 'T'.
  1805         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1806
  1807     12  CO-FAXNO.
  1808         16  CO-FAX-AREA-CODE                  PIC XXX.
  1809         16  CO-FAX-PREFIX                     PIC XXX.
  1810         16  CO-FAX-PHONE                      PIC X(4).
  1811
  1812     12  CO-BANK-INFORMATION.
  1813         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1814         16  CO-BANK-TRANSIT-NON REDEFINES
  1815             CO-BANK-TRANSIT-NO                PIC 9(8).
  1816
  1817         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1818     12  CO-MISC-DEDUCT-INFO REDEFINES
  1819                  CO-BANK-INFORMATION.
  1820         16  CO-MD-GL-ACCT                     PIC X(10).
  1821         16  CO-MD-DIV                         PIC XX.
  1822         16  CO-MD-CENTER                      PIC X(4).
  1823         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1824         16  CO-CREATE-AP-CHECK                PIC X.
  1825         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1826         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  34
* EL050.cbl
  1827     12  CO-ACH-STATUS                         PIC X.
  1828         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1829         88  CO-ACH-PENDING                        VALUE 'P'.
  1830
  1831     12  CO-BILL-SW                            PIC X.
  1832     12  CO-CONTROL-NAME                       PIC X(30).
  1833     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1834     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1835     12  CO-CLP-STATE                          PIC XX.
  1836     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1837     12  CO-SPP-REFUND-EDIT                    PIC X.
  1838
  1839******************************************************************
  1840
  1841*    COPY ERCAGTC.
  1842******************************************************************
  1843*                                                                *
  1844*                                                                *
  1845*                            ERCAGTC                             *
  1846*                            VMOD=2.001                          *
  1847*                                                                *
  1848*   ONLINE CREDIT SYSTEM                                         *
  1849*                                                                *
  1850*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1851*                                                                *
  1852*   FILE TYPE = VSAM,KSDS                                        *
  1853*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1854*                                                                *
  1855*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1856*       ALTERNATE PATH = NONE                                    *
  1857*                                                                *
  1858*   LOG = NO                                                     *
  1859*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1860*                                                                *
  1861******************************************************************
  1862*                   C H A N G E   L O G
  1863*
  1864* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1865*-----------------------------------------------------------------
  1866*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1867* EFFECTIVE    NUMBER
  1868*-----------------------------------------------------------------
  1869* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1870* 111004                         NEW FILE AND COPYBOOK
  1871* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1872******************************************************************
  1873 01  AGENT-COMMISSIONS.
  1874     12  AG-RECORD-ID                          PIC XX.
  1875         88  VALID-CO-ID                          VALUE 'AG'.
  1876     12  AG-CONTROL-PRIMARY.
  1877         16  AG-COMPANY-CD                     PIC X.
  1878         16  AG-CONTROL.
  1879             20  AG-CTL-1.
  1880                 24  AG-CARR-GROUP.
  1881                     28  AG-CARRIER            PIC X.
  1882                     28  AG-GROUPING           PIC X(6).
  1883                 24  AG-BANK                   PIC X(10).
  1884             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  35
* EL050.cbl
  1885                 24  AG-EXP-DT                 PIC XX.
  1886         16  AG-TYPE                           PIC X.
  1887             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1888             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1889     12  AG-MAINT-INFORMATION.
  1890         16  AG-LAST-MAINT-DT                  PIC XX.
  1891         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1892         16  AG-LAST-MAINT-USER                PIC X(4).
  1893         16  FILLER                            PIC X(10).
  1894     12  AG-EFF-DT                             PIC XX.
  1895     12  AG-COMM-STRUCTURE.
  1896         16  AG-AGT-COMMS OCCURS 10.
  1897             20  AG-AGT                PIC X(10).
  1898             20  AG-COM-TYP            PIC X.
  1899             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1900             20  AG-RECALC-LV-INDIC    PIC X.
  1901             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1902             20  AG-LRCALC-LV-INDIC    PIC X.
  1903             20  FILLER                PIC X(05).
  1904     12  FILLER                  PIC X(145).
  1905******************************************************************
  1906*    COPY ERCRESS.
  1907******************************************************************
  1908*                                                                *
  1909*                            ERCRESS                             *
  1910*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1911*                            VMOD=2.002                          *
  1912*                                                                *
  1913*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1914*                                                                *
  1915*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1916*   VSAM RESIDENT STATE TAX MASTER                              *
  1917*                                                                *
  1918*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1919*                                                                *
  1920*   FILE TYPE = VSAM,KSDS                                        *
  1921*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1922*                                                                *
  1923*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1924*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1925*                                                                *
  1926*   LOG = NO                                                     *
  1927*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1928*                                                                *
  1929*                                                                *
  1930******************************************************************
  1931
  1932 01  RESIDENT-STATE-TAX-MASTER.
  1933
  1934     10  ERRESS-PRIMARY-KEY.
  1935         15  RES-COMPANY-CD        PIC X.
  1936         15  RES-RESIDENT-STATE    PIC XX.
  1937         15  RES-COVERAGE-CATEGORY PIC X.
  1938         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1939*                                      YYYYMMDD
  1940*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1941
  1942     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  36
* EL050.cbl
  1943
  1944         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1945         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1946         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  1947         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1948
  1949     10 RES-RECALC-SW              PIC   X.
  1950         88 RECALC                VALUE 'Y'.
  1951         88 NO-RECALC             VALUE 'N'.
  1952     10  RES-MAINT-BY              PIC X(4).
  1953     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1954     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1955*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  37
* EL050.cbl
  1957*    COPY ERCRESC.
  1958******************************************************************
  1959*                                                                *
  1960*                            ERCRESC                             *
  1961*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1962*                            VMOD=2.003                          *
  1963*                                                                *
  1964*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1965*                                                                *
  1966*   FILE TYPE = VSAM,KSDS                                        *
  1967*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1968*                                                                *
  1969*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1970*       ALTERNATE PATH1 = NONE                                   *
  1971*                                                                *
  1972*   LOG = NO                                                     *
  1973*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1974*                                                                *
  1975******************************************************************
  1976
  1977 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1978
  1979     10  ERRESC-RECORD-KEY.
  1980         15  RESC-COMPANY-CD           PIC   X.
  1981         15  RESC-CARRIER              PIC   X.
  1982         15  RESC-GROUP                PIC   X(6).
  1983         15  RESC-STATE                PIC   XX.
  1984         15  RESC-ACCOUNT              PIC   X(10).
  1985         15  RESC-AGENT                PIC   X(10).
  1986         15  RESC-RESIDENT-STATE       PIC   XX.
  1987         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1988*                                           YYYYMMDD
  1989     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1990
  1991     10  RESC-COMM-RECORD-DATA.
  1992         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1993             20 RESC-COVERAGE-CAT      PIC    X.
  1994             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1995             20 RESC-COMMISSION-TAB REDEFINES
  1996                RESC-COMMISSION-PER    PIC  XXX.
  1997
  1998     10  RESC-MAINT-BY                 PIC X(4).
  1999     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  2000     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  2001*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  38
* EL050.cbl
  2003*    COPY ERCPLAN.
  2004******************************************************************
  2005*                                                                *
  2006*                                                                *
  2007*                            ERCPLAN                             *
  2008*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2009*                            VMOD=2.003                          *
  2010*                                                                *
  2011*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  2012*                                                                *
  2013*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  2014*   PLAN MASTER                                                  *
  2015*                                                                *
  2016*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  2017*                                                                *
  2018*   FILE TYPE = VSAM,KSDS                                        *
  2019*   RECORD SIZE = 420   RECFORM = FIX                            *
  2020*                                                                *
  2021*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  2022*       ALTERNATE PATH1 = N/A                                    *
  2023*                                                                *
  2024*   LOG = NO                                                     *
  2025*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2026*                                                                *
  2027*                                                                *
  2028******************************************************************
  2029
  2030 01  PLAN-MASTER.
  2031     12  PL-RECORD-ID                      PIC XX.
  2032         88  VALID-PL-ID                      VALUE 'PL'.
  2033
  2034     12  PL-CONTROL-PRIMARY.
  2035         16  PL-COMPANY-CD                 PIC X.
  2036         16  PL-MSTR-CNTRL.
  2037             20  PL-CONTROL-A.
  2038                 24  PL-CARRIER            PIC X.
  2039                 24  PL-GROUPING           PIC X(6).
  2040                 24  PL-STATE              PIC XX.
  2041                 24  PL-ACCOUNT            PIC X(10).
  2042             20  PL-BENEFIT-TYPE           PIC X.
  2043             20  PL-BENEFIT-CODE           PIC XX.
  2044             20  PL-REVISION-NO            PIC X(3).
  2045
  2046     12  PL-CONTROL-BY-VAR-GRP.
  2047         16  PL-COMPANY-CD-A1              PIC X.
  2048         16  PL-VG-CARRIER                 PIC X.
  2049         16  PL-VG-GROUPING                PIC X(6).
  2050         16  PL-VG-STATE                   PIC XX.
  2051         16  PL-VG-ACCOUNT                 PIC X(10).
  2052         16  PL-BENEFIT-TYPE-A1            PIC X.
  2053         16  PL-BENEFIT-CODE-A1            PIC XX.
  2054         16  PL-REVISION-NO-A1             PIC 999.
  2055
  2056     12  PL-MAINT-INFORMATION.
  2057         16  PL-LAST-MAINT-DT              PIC XX.
  2058         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2059         16  PL-LAST-MAINT-USER            PIC X(4).
  2060         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  39
* EL050.cbl
  2061
  2062     12  PL-LIABILITY-LIMITS.
  2063         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2064         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2065             20  PL-LM-AGE                 PIC S99        COMP-3.
  2066             20  PL-LM-DUR                 PIC S999       COMP-3.
  2067             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2068             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2069
  2070     12  FILLER                            PIC X(30).
  2071
  2072     12  PL-GL-ACCOUNT-NOS.
  2073         16  PL-PREMIUM-GL                 PIC X(8).
  2074         16  PL-COMM-GL                    PIC X(8).
  2075         16  PL-CLAIM-GL                   PIC X(8).
  2076     12  FILLER                            PIC X(24).
  2077     12  PL-TOLERANCES.
  2078         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2079         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2080         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2081         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2082         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2083         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2084     12  PL-OVER-SHORT.
  2085         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2086         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2087     12  FILLER                            PIC X(24).
  2088     12  PLAN-MISC.
  2089         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2090         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2091         16  PL-IG                         PIC X.
  2092         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2093         16  PL-POLICY-FORM                PIC X(12).
  2094         16  PL-EDIT-FOR-FORM              PIC X(01).
  2095         16  PL-DEV-CODE                   PIC XXX.
  2096         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2097         16  PL-CALC-METHOD                PIC X.
  2098         16  PL-BENEFIT-GROUP              PIC X(05).
  2099         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2100
  2101         16  FILLER                        PIC X(99).
  2102******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  40
* EL050.cbl
  2104*    COPY ELCCERT.
  2105******************************************************************
  2106*                                                                *
  2107*                            ELCCERT.                            *
  2108*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2109*                            VMOD=2.013                          *
  2110*                                                                *
  2111*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2112*                                                                *
  2113*   FILE TYPE = VSAM,KSDS                                        *
  2114*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2115*                                                                *
  2116*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2117*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2118*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2119*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2120*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2121*                                                                *
  2122*   LOG = YES                                                    *
  2123*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2124******************************************************************
  2125*                   C H A N G E   L O G
  2126*
  2127* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2128*-----------------------------------------------------------------
  2129*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2130* EFFECTIVE    NUMBER
  2131*-----------------------------------------------------------------
  2132* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2133* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2134* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2135* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2136* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2137* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2138* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2139* 032612  CR2011110200001  PEMA  AHL CHANGES
  2140* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2141* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2142******************************************************************
  2143
  2144 01  CERTIFICATE-MASTER.
  2145     12  CM-RECORD-ID                      PIC XX.
  2146         88  VALID-CM-ID                      VALUE 'CM'.
  2147
  2148     12  CM-CONTROL-PRIMARY.
  2149         16  CM-COMPANY-CD                 PIC X.
  2150         16  CM-CARRIER                    PIC X.
  2151         16  CM-GROUPING.
  2152             20  CM-GROUPING-PREFIX        PIC X(3).
  2153             20  CM-GROUPING-PRIME         PIC X(3).
  2154         16  CM-STATE                      PIC XX.
  2155         16  CM-ACCOUNT.
  2156             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2157             20  CM-ACCOUNT-PRIME          PIC X(6).
  2158         16  CM-CERT-EFF-DT                PIC XX.
  2159         16  CM-CERT-NO.
  2160             20  CM-CERT-PRIME             PIC X(10).
  2161             20  CM-CERT-SFX               PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  41
* EL050.cbl
  2162
  2163     12  CM-CONTROL-BY-NAME.
  2164         16  CM-COMPANY-CD-A1              PIC X.
  2165         16  CM-INSURED-LAST-NAME          PIC X(15).
  2166         16  CM-INSURED-INITIALS.
  2167             20  CM-INSURED-INITIAL1       PIC X.
  2168             20  CM-INSURED-INITIAL2       PIC X.
  2169
  2170     12  CM-CONTROL-BY-SSN.
  2171         16  CM-COMPANY-CD-A2              PIC X.
  2172         16  CM-SOC-SEC-NO.
  2173             20  CM-SSN-STATE              PIC XX.
  2174             20  CM-SSN-ACCOUNT            PIC X(6).
  2175             20  CM-SSN-LN3.
  2176                 25  CM-INSURED-INITIALS-A2.
  2177                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2178                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2179                 25 CM-PART-LAST-NAME-A2         PIC X.
  2180
  2181     12  CM-CONTROL-BY-CERT-NO.
  2182         16  CM-COMPANY-CD-A4              PIC X.
  2183         16  CM-CERT-NO-A4                 PIC X(11).
  2184
  2185     12  CM-CONTROL-BY-MEMB.
  2186         16  CM-COMPANY-CD-A5              PIC X.
  2187         16  CM-MEMBER-NO.
  2188             20  CM-MEMB-STATE             PIC XX.
  2189             20  CM-MEMB-ACCOUNT           PIC X(6).
  2190             20  CM-MEMB-LN4.
  2191                 25  CM-INSURED-INITIALS-A5.
  2192                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2193                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2194                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2195
  2196     12  CM-INSURED-PROFILE-DATA.
  2197         16  CM-INSURED-FIRST-NAME.
  2198             20  CM-INSURED-1ST-INIT       PIC X.
  2199             20  FILLER                    PIC X(9).
  2200         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2201         16  CM-INSURED-SEX                PIC X.
  2202             88  CM-SEX-MALE                  VALUE 'M'.
  2203             88  CM-SEX-FEMAL                 VALUE 'F'.
  2204         16  CM-INSURED-JOINT-AGE          PIC 99.
  2205         16  CM-JOINT-INSURED-NAME.
  2206             20  CM-JT-LAST-NAME           PIC X(15).
  2207             20  CM-JT-FIRST-NAME.
  2208                 24  CM-JT-1ST-INIT        PIC X.
  2209                 24  FILLER                PIC X(9).
  2210             20  CM-JT-INITIAL             PIC X.
  2211
  2212     12  CM-LIFE-DATA.
  2213         16  CM-LF-BENEFIT-CD              PIC XX.
  2214         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2215         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2216         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2217         16  CM-LF-DEV-CODE                PIC XXX.
  2218         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2219         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  42
* EL050.cbl
  2220         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2221         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2222         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2223         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2224         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2225         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2226         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2227         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2228         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2229         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2230         16  cm-temp-epiq                  pic xx.
  2231             88  EPIQ-CLASS                  value 'EQ'.
  2232*        16  FILLER                        PIC XX.
  2233
  2234     12  CM-AH-DATA.
  2235         16  CM-AH-BENEFIT-CD              PIC XX.
  2236         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2237         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2238         16  CM-AH-DEV-CODE                PIC XXX.
  2239         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2240         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2241         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2242         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2243         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2244         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2245         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2246         16  CM-AH-PAID-THRU-DT            PIC XX.
  2247             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2248         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2249         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  2250         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2251         16  FILLER                        PIC X.
  2252
  2253     12  CM-LOAN-INFORMATION.
  2254         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2255         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2256                                           PIC S9(5)V99  COMP-3.
  2257         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2258         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2259         16  CM-PAY-FREQUENCY              PIC S99.
  2260         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2261         16  CM-RATE-CLASS                 PIC XX.
  2262         16  CM-BENEFICIARY                PIC X(25).
  2263         16  CM-POLICY-FORM-NO             PIC X(12).
  2264         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2265         16  CM-LAST-ADD-ON-DT             PIC XX.
  2266         16  CM-DEDUCTIBLE-AMOUNTS.
  2267             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2268             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2269         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2270             20  CM-RESIDENT-STATE         PIC XX.
  2271             20  CM-RATE-CODE              PIC X(4).
  2272             20  FILLER                    PIC XX.
  2273         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2274             20  CM-LOAN-OFFICER           PIC X(5).
  2275             20  FILLER                    PIC XXX.
  2276         16  CM-CSR-CODE                   PIC XXX.
  2277         16  CM-UNDERWRITING-CODE          PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  43
* EL050.cbl
  2278             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2279         16  CM-POST-CARD-IND              PIC X.
  2280         16  CM-NH-INTERFACE-SW            PIC X.
  2281         16  CM-PREMIUM-TYPE               PIC X.
  2282             88  CM-SING-PRM                  VALUE '1'.
  2283             88  CM-O-B-COVERAGE              VALUE '2'.
  2284             88  CM-OPEN-END                  VALUE '3'.
  2285         16  CM-IND-GRP-TYPE               PIC X.
  2286             88  CM-INDIVIDUAL                VALUE 'I'.
  2287             88  CM-GROUP                     VALUE 'G'.
  2288         16  CM-SKIP-CODE                  PIC X.
  2289             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2290             88  SKIP-JULY                    VALUE '1'.
  2291             88  SKIP-AUGUST                  VALUE '2'.
  2292             88  SKIP-SEPTEMBER               VALUE '3'.
  2293             88  SKIP-JULY-AUG                VALUE '4'.
  2294             88  SKIP-AUG-SEPT                VALUE '5'.
  2295             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2296             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2297             88  SKIP-JUNE                    VALUE '8'.
  2298             88  SKIP-JUNE-JULY               VALUE '9'.
  2299             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2300             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2301         16  CM-PAYMENT-MODE               PIC X.
  2302             88  PAY-MONTHLY                  VALUE SPACE.
  2303             88  PAY-WEEKLY                   VALUE '1'.
  2304             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2305             88  PAY-BI-WEEKLY                VALUE '3'.
  2306             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2307         16  CM-LOAN-NUMBER                PIC X(8).
  2308         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2309         16  CM-OLD-LOF                    PIC XXX.
  2310*        16  CM-LOAN-OFFICER               PIC XXX.
  2311         16  CM-REIN-TABLE                 PIC XXX.
  2312         16  CM-SPECIAL-REIN-CODE          PIC X.
  2313         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2314         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2315         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2316
  2317     12  CM-STATUS-DATA.
  2318         16  CM-ENTRY-STATUS               PIC X.
  2319         16  CM-ENTRY-DT                   PIC XX.
  2320
  2321         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2322         16  CM-LF-CANCEL-DT               PIC XX.
  2323         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2324
  2325         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2326         16  CM-LF-DEATH-DT                PIC XX.
  2327         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2328
  2329         16  CM-LF-CURRENT-STATUS          PIC X.
  2330             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2331                                                'M' '4' '5' '9'.
  2332             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2333             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2334             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2335             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  44
* EL050.cbl
  2336             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2337             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2338             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2339             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2340             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2341             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2342             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2343             88  CM-LF-DECLINED               VALUE 'D'.
  2344             88  CM-LF-VOIDED                 VALUE 'V'.
  2345
  2346         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2347         16  CM-AH-CANCEL-DT               PIC XX.
  2348         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2349
  2350         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2351         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2352         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2353
  2354         16  CM-AH-CURRENT-STATUS          PIC X.
  2355             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2356                                                'M' '4' '5' '9'.
  2357             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2358             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2359             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2360             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2361             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2362             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2363             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2364             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2365             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2366             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2367             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2368             88  CM-AH-DECLINED               VALUE 'D'.
  2369             88  CM-AH-VOIDED                 VALUE 'V'.
  2370
  2371         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2372             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2373             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2374             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2375         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2376
  2377         16  CM-ENTRY-BATCH                PIC X(6).
  2378         16  CM-LF-EXIT-BATCH              PIC X(6).
  2379         16  CM-AH-EXIT-BATCH              PIC X(6).
  2380         16  CM-LAST-MONTH-END             PIC XX.
  2381
  2382     12  CM-NOTE-SW                        PIC X.
  2383         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2384         88  CERT-NOTES-PRESENT               VALUE '1'.
  2385         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2386         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2387         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2388         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2389         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2390         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2391     12  CM-COMP-EXCP-SW                   PIC X.
  2392         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2393         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  45
* EL050.cbl
  2394     12  CM-INSURED-ADDRESS-SW             PIC X.
  2395         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2396         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2397
  2398*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2399     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2400     12  FILLER                            PIC X.
  2401
  2402*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2403     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2404     12  FILLER                            PIC X.
  2405*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2406     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2407
  2408     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2409         88  CERT-ADDED-BATCH                 VALUE ' '.
  2410         88  CERT-ADDED-ONLINE                VALUE '1'.
  2411         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2412         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2413         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2414     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2415         88  CERT-AS-LOADED                   VALUE ' '.
  2416         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2417         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2418         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2419         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2420         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2421         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2422         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2423
  2424     12  CM-ACCOUNT-COMM-PCTS.
  2425         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2426         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2427
  2428     12  CM-USER-FIELD                     PIC X.
  2429     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2430     12  CM-CLP-STATE                      PIC XX.
  2431     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2432     12  CM-USER-RESERVED                  PIC XXX.
  2433     12  FILLER REDEFINES CM-USER-RESERVED.
  2434         16  CM-AH-CLASS-CD                PIC XX.
  2435         16  F                             PIC X.
  2436******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  46
* EL050.cbl
  2438*    COPY ERCMAIL.
  2439******************************************************************
  2440*                                                                *
  2441*                                                                *
  2442*                            ERCMAIL                             *
  2443*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2444*                            VMOD=2.003                          *
  2445*                                                                *
  2446*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2447*                                                                *
  2448*   FILE TYPE = VSAM,KSDS                                        *
  2449*   RECORD SIZE = 374   RECFORM = FIX                            *
  2450*                                                                *
  2451*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2452*   ALTERNATE PATH    = NOT USED                                 *
  2453*                                                                *
  2454*   LOG = YES                                                    *
  2455*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2456******************************************************************
  2457*                   C H A N G E   L O G
  2458*
  2459* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2460*-----------------------------------------------------------------
  2461*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2462* EFFECTIVE    NUMBER
  2463*-----------------------------------------------------------------
  2464* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2465* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2466* 111108                   PEMA  ADD CRED BENE ADDR2
  2467******************************************************************
  2468
  2469 01  MAILING-DATA.
  2470     12  MA-RECORD-ID                      PIC XX.
  2471         88  VALID-MA-ID                       VALUE 'MA'.
  2472
  2473     12  MA-CONTROL-PRIMARY.
  2474         16  MA-COMPANY-CD                 PIC X.
  2475         16  MA-CARRIER                    PIC X.
  2476         16  MA-GROUPING.
  2477             20  MA-GROUPING-PREFIX        PIC XXX.
  2478             20  MA-GROUPING-PRIME         PIC XXX.
  2479         16  MA-STATE                      PIC XX.
  2480         16  MA-ACCOUNT.
  2481             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2482             20  MA-ACCOUNT-PRIME          PIC X(6).
  2483         16  MA-CERT-EFF-DT                PIC XX.
  2484         16  MA-CERT-NO.
  2485             20  MA-CERT-PRIME             PIC X(10).
  2486             20  MA-CERT-SFX               PIC X.
  2487
  2488     12  FILLER                            PIC XX.
  2489
  2490     12  MA-ACCESS-CONTROL.
  2491         16  MA-SOURCE-SYSTEM              PIC XX.
  2492             88  MA-FROM-CREDIT                VALUE 'CR'.
  2493             88  MA-FROM-VSI                   VALUE 'VS'.
  2494             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2495             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  47
* EL050.cbl
  2496         16  MA-RECORD-ADD-DT              PIC XX.
  2497         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2498         16  MA-LAST-MAINT-DT              PIC XX.
  2499         16  MA-LAST-MAINT-BY              PIC XXXX.
  2500         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2501
  2502     12  MA-PROFILE-INFO.
  2503         16  MA-QUALIFY-CODE-1             PIC XX.
  2504         16  MA-QUALIFY-CODE-2             PIC XX.
  2505         16  MA-QUALIFY-CODE-3             PIC XX.
  2506         16  MA-QUALIFY-CODE-4             PIC XX.
  2507         16  MA-QUALIFY-CODE-5             PIC XX.
  2508
  2509         16  MA-INSURED-LAST-NAME          PIC X(15).
  2510         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2511         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2512         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2513         16  MA-INSURED-BIRTH-DT           PIC XX.
  2514         16  MA-INSURED-SEX                PIC X.
  2515             88  MA-SEX-MALE                   VALUE 'M'.
  2516             88  MA-SEX-FEMALE                 VALUE 'F'.
  2517         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2518
  2519         16  MA-ADDRESS-CORRECTED          PIC X.
  2520         16  MA-JOINT-BIRTH-DT             PIC XX.
  2521*        16  FILLER                        PIC X(12).
  2522
  2523         16  MA-ADDRESS-LINE-1             PIC X(30).
  2524         16  MA-ADDRESS-LINE-2             PIC X(30).
  2525         16  MA-CITY-STATE.
  2526             20  MA-CITY                   PIC X(28).
  2527             20  MA-ADDR-STATE             PIC XX.
  2528         16  MA-ZIP.
  2529             20  MA-ZIP-CODE.
  2530                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2531                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2532                 24  FILLER                PIC X(4).
  2533             20  MA-ZIP-PLUS4              PIC X(4).
  2534         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2535             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2536             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2537             20  FILLER                    PIC X(3).
  2538
  2539         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2540
  2541         16  FILLER                        PIC XXX.
  2542*        16  FILLER                        PIC X(10).
  2543
  2544     12  MA-CRED-BENE-INFO.
  2545         16  MA-CRED-BENE-NAME                 PIC X(25).
  2546         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2547         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2548         16  MA-CRED-BENE-CTYST.
  2549             20  MA-CRED-BENE-CITY             PIC X(28).
  2550             20  MA-CRED-BENE-STATE            PIC XX.
  2551         16  MA-CRED-BENE-ZIP.
  2552             20  MA-CB-ZIP-CODE.
  2553                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  48
* EL050.cbl
  2554                     88  MA-CB-CANADIAN-POST-CODE
  2555                                           VALUE 'A' THRU 'Z'.
  2556                 24  FILLER                    PIC X(4).
  2557             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2558         16  MA-CB-CANADIAN-POSTAL-CODE
  2559                            REDEFINES MA-CRED-BENE-ZIP.
  2560             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2561             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2562             20  FILLER                        PIC X(3).
  2563     12  MA-POST-CARD-MAIL-DATA.
  2564         16  MA-MAIL-DATA OCCURS 7.
  2565             20  MA-MAIL-TYPE              PIC X.
  2566                 88  MA-12MO-MAILING           VALUE '1'.
  2567                 88  MA-EXP-MAILING            VALUE '2'.
  2568             20  MA-MAIL-STATUS            PIC X.
  2569                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2570                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2571                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2572             20  MA-MAIL-DATE              PIC XX.
  2573     12  FILLER                            PIC XX.
  2574     12  FILLER                            PIC XX.
  2575*    12  FILLER                            PIC X(30).
  2576******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  49
* EL050.cbl
  2578*    COPY ERCPNDM.
  2579******************************************************************
  2580*                                                                *
  2581*                                                                *
  2582*                            ERCPNDM                             *
  2583*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2584*                            VMOD=2.003                          *
  2585*                                                                *
  2586*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2587*                                                                *
  2588*   FILE TYPE = VSAM,KSDS                                        *
  2589*   RECORD SIZE = 374   RECFORM = FIX                            *
  2590*                                                                *
  2591*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2592*   ALTERNATE PATH    = NOT USED                                 *
  2593*                                                                *
  2594*   LOG = YES                                                    *
  2595*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2596******************************************************************
  2597*                   C H A N G E   L O G
  2598*
  2599* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2600*-----------------------------------------------------------------
  2601*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2602* EFFECTIVE    NUMBER
  2603*-----------------------------------------------------------------
  2604* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2605* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2606* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2607******************************************************************
  2608
  2609 01  PENDING-MAILING-DATA.
  2610     12  PM-RECORD-ID                      PIC XX.
  2611         88  VALID-MA-ID                       VALUE 'PM'.
  2612
  2613     12  PM-CONTROL-PRIMARY.
  2614         16  PM-COMPANY-CD                 PIC X.
  2615         16  PM-ENTRY-BATCH                PIC X(6).
  2616         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2617         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2618
  2619     12  FILLER                            PIC X(14).
  2620
  2621     12  PM-ACCESS-CONTROL.
  2622         16  PM-SOURCE-SYSTEM              PIC XX.
  2623             88  PM-FROM-CREDIT                VALUE 'CR'.
  2624             88  PM-FROM-VSI                   VALUE 'VS'.
  2625             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2626             88  PM-FROM-OTHER                 VALUE 'OT'.
  2627         16  PM-RECORD-ADD-DT              PIC XX.
  2628         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2629         16  PM-LAST-MAINT-DT              PIC XX.
  2630         16  PM-LAST-MAINT-BY              PIC XXXX.
  2631         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2632
  2633     12  PM-PROFILE-INFO.
  2634         16  PM-QUALIFY-CODE-1             PIC XX.
  2635         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  50
* EL050.cbl
  2636         16  PM-QUALIFY-CODE-3             PIC XX.
  2637         16  PM-QUALIFY-CODE-4             PIC XX.
  2638         16  PM-QUALIFY-CODE-5             PIC XX.
  2639
  2640         16  PM-INSURED-LAST-NAME          PIC X(15).
  2641         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2642         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2643         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2644         16  PM-INSURED-BIRTH-DT           PIC XX.
  2645         16  PM-INSURED-SEX                PIC X.
  2646             88  PM-SEX-MALE                   VALUE 'M'.
  2647             88  PM-SEX-FEMALE                 VALUE 'F'.
  2648         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2649
  2650         16  PM-ADDRESS-CORRECTED          PIC X.
  2651         16  PM-JOINT-BIRTH-DT             PIC XX.
  2652*        16  FILLER                        PIC X(12).
  2653
  2654         16  PM-ADDRESS-LINE-1             PIC X(30).
  2655         16  PM-ADDRESS-LINE-2             PIC X(30).
  2656         16  PM-CITY-STATE.
  2657             20  PM-CITY                   PIC X(28).
  2658             20  PM-STATE                  PIC XX.
  2659         16  PM-ZIP.
  2660             20  PM-ZIP-CODE.
  2661                 24  PM-ZIP-1              PIC X.
  2662                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2663                 24  FILLER                PIC X(4).
  2664             20  PM-ZIP-PLUS4              PIC X(4).
  2665         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2666             20  PM-CAN-POST1              PIC XXX.
  2667             20  PM-CAN-POST2              PIC XXX.
  2668             20  FILLER                    PIC XXX.
  2669
  2670         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2671
  2672         16  FILLER                        PIC X(03).
  2673
  2674     12  PM-CRED-BENE-INFO.
  2675         16  PM-CRED-BENE-NAME             PIC X(25).
  2676         16  PM-CRED-BENE-ADDR             PIC X(30).
  2677         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2678         16  PM-CRED-BENE-CTYST.
  2679             20  PM-CRED-BENE-CITY         PIC X(28).
  2680             20  PM-CRED-BENE-STATE        PIC XX.
  2681         16  PM-CRED-BENE-ZIP.
  2682             20  PM-CB-ZIP-CODE.
  2683                 24  PM-CB-ZIP-1           PIC X.
  2684                     88  PM-CB-CANADIAN-POST-CODE
  2685                                  VALUE 'A' THRU 'Z'.
  2686                 24  FILLER                PIC X(4).
  2687             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2688         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2689             20  PM-CB-CAN-POST1           PIC XXX.
  2690             20  PM-CB-CAN-POST2           PIC XXX.
  2691             20  FILLER                    PIC XXX.
  2692     12  PM-POST-CARD-MAIL-DATA.
  2693         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  51
* EL050.cbl
  2694             20  PM-MAIL-TYPE              PIC X.
  2695                 88  PM-12MO-MAILING           VALUE '1'.
  2696                 88  PM-EXP-MAILING            VALUE '2'.
  2697             20  PM-MAIL-STATUS            PIC X.
  2698                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2699                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2700                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2701             20  PM-MAIL-DATE              PIC XX.
  2702     12  FILLER                            PIC XX.
  2703     12  FILLER                            PIC X(12).
  2704*    12  FILLER                            PIC X(30).
  2705
  2706******************************************************************
  2707*                                COPY ERCLOFC.
  2708******************************************************************
  2709*                                                                *
  2710*                                                                *
  2711*                            ERCLOFC                             *
  2712*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2713*                            VMOD=2.003                          *
  2714*                                                                *
  2715*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2716*                                                                *
  2717*   FILE TYPE = VSAM,KSDS                                        *
  2718*   RECORD SIZE = 670   RECFORM = FIX                            *
  2719*                                                                *
  2720*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2721*                                                                *
  2722*   LOG = YES                                                    *
  2723*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2724*                                                                *
  2725******************************************************************
  2726
  2727 01  LOAN-OFFICER-MASTER.
  2728     12  LO-RECORD-ID                PIC XX.
  2729         88  VALID-LO-ID                VALUE 'LO'.
  2730
  2731     12  LO-CONTROL-PRIMARY.
  2732         16  LO-COMPANY-CD           PIC X.
  2733         16  LO-CARRIER              PIC X.
  2734         16  LO-GROUPING.
  2735             20  LO-GROUPING-PREFIX  PIC XXX.
  2736             20  LO-GROUPING-PRIME   PIC XXX.
  2737         16  LO-STATE                PIC XX.
  2738         16  LO-ACCOUNT.
  2739             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2740             20  LO-ACCOUNT-PRIME    PIC X(6).
  2741         16  LO-OFFICER-CODE         PIC X(5).
  2742
  2743     12  LO-OFFICER-NAME             PIC X(30).
  2744
  2745     12  LO-LAST-MAINT-DT            PIC XX.
  2746     12  LO-LAST-USER                PIC X(4).
  2747     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2748
  2749     12  LO-COMP-CONTROL             PIC X.
  2750             88  LO-SHOW-COMP           VALUE 'Y'.
  2751             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  52
* EL050.cbl
  2752     12  LO-DETAIL-CONTROL           PIC X.
  2753             88  LO-PRINT-DETAIL        VALUE 'D'.
  2754             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2755
  2756     12  LO-SV-CARRIER               PIC X.
  2757     12  LO-SV-GROUPING              PIC X(6).
  2758     12  LO-SV-STATE                 PIC XX.
  2759
  2760     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2761     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2762
  2763     12  LO-OFFICER-INFO.
  2764         16  FILLER OCCURS 12 TIMES.
  2765             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2766             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2767             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2768             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2769             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2770             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2771             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2772             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2773     12  FILLER                      PIC X(198).
  2774******************************************************************
  2775*                                COPY ERCPDEF.
  2776******************************************************************
  2777*                                                                *
  2778*                                                                *
  2779*                            ERCPDEF.                            *
  2780*                                                                *
  2781*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2782*                                                                *
  2783*    FILE TYPE = VSAM,KSDS                                       *
  2784*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2785*                                                                *
  2786*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2787*                                                                *
  2788*    LOG = YES                                                   *
  2789*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2790******************************************************************
  2791*                   C H A N G E   L O G
  2792*
  2793* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2794*-----------------------------------------------------------------
  2795*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2796* EFFECTIVE    NUMBER
  2797*-----------------------------------------------------------------
  2798* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2799* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2800* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  2801******************************************************************
  2802 01  PRODUCT-MASTER.
  2803    12  PD-RECORD-ID                 PIC X(02).
  2804        88  VALID-PD-ID                  VALUE 'PD'.
  2805    12  PD-CONTROL-PRIMARY.
  2806        16  PD-COMPANY-CD            PIC X.
  2807        16  PD-STATE                 PIC XX.
  2808        16  PD-PRODUCT-CD            PIC XXX.
  2809        16  PD-FILLER                PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  53
* EL050.cbl
  2810        16  PD-BEN-TYPE              PIC X.
  2811        16  PD-BEN-CODE              PIC XX.
  2812        16  PD-PROD-EXP-DT           PIC XX.
  2813    12  FILLER                       PIC X(50).
  2814    12  PD-PRODUCT-DATA OCCURS 8.
  2815        16  PD-PROD-CODE             PIC X.
  2816            88  PD-PROD-LIFE           VALUE 'L'.
  2817            88  PD-PROD-PROP           VALUE 'P'.
  2818            88  PD-PROD-AH             VALUE 'A'.
  2819            88  PD-PROD-IU             VALUE 'I'.
  2820            88  PD-PROD-GAP            VALUE 'G'.
  2821            88  PD-PROD-FAML           VALUE 'F'.
  2822        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2823        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2824        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2825        16  PD-MAX-TERM              PIC S999        COMP-3.
  2826        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2827        16  FILLER                   PIC X.
  2828        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2829        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2830        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2831        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2832        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2833        16  PD-REC-CRIT-PERIOD       PIC 99.
  2834        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2835            20  PD-RECURRING-YN      PIC X.
  2836            20  FILLER               PIC X.
  2837        16  PD-RTW-MOS               PIC 99.
  2838        16  PD-MAX-EXTENSION         PIC 99.
  2839        16  pd-ben-pct               pic sv999 comp-3.
  2840*       16  FILLER                   PIC XX.
  2841    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2842    12  PD-TERM-LIMITS OCCURS 15.
  2843        16  PD-LOW-TERM              PIC S999        COMP-3.
  2844        16  PD-HI-TERM               PIC S999        COMP-3.
  2845*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2846    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2847        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2848        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2849    12  PD-EARN-FACTORS.
  2850        16  FILLER OCCURS 15.
  2851            20  FILLER OCCURS 15.
  2852                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2853    12  PD-PRODUCT-DESC              PIC X(80).
  2854    12  PD-TRUNCATED                 PIC X.
  2855    12  FILLER                       PIC X(59).
  2856    12  PD-MAINT-INFORMATION.
  2857        16  PD-LAST-MAINT-DT         PIC X(02).
  2858        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2859        16  PD-LAST-MAINT-BY         PIC X(04).
  2860*                                COPY ELCSTATE.
  2861******************************************************************
  2862*                                                                *
  2863*                                                                *
  2864*                            ELCSTATE.                           *
  2865*                                                                *
  2866*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2867*                                                                *
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  54
* EL050.cbl
  2868*   FILE TYPE = VSAM,KSDS                                        *
  2869*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2870*                                                                *
  2871*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2872*       ALTERNATE INDEX = NONE                                   *
  2873*                                                                *
  2874*   LOG = YES                                                    *
  2875*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2876******************************************************************
  2877*                   C H A N G E   L O G
  2878*
  2879* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2880*-----------------------------------------------------------------
  2881*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2882* EFFECTIVE    NUMBER
  2883*-----------------------------------------------------------------
  2884* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  2885******************************************************************
  2886*
  2887 01  STATE-FILE.
  2888     12  SF-RECORD-ID                       PIC XX.
  2889         88  VALID-CF-ID                        VALUE 'SF'.
  2890     12  SF-CONTROL-PRIMARY.
  2891         16  SF-COMPANY-ID                  PIC XXX.
  2892         16  SF-CARRIER-CODE                PIC X.
  2893         16  SF-GROUPING                    PIC X(6).
  2894         16  SF-STATE-CODE                  PIC XX.
  2895         16  SF-EXPIRE-DATE                 PIC 9(8).
  2896****************************************************************
  2897*             STATE CONTROLS
  2898****************************************************************
  2899     12  SF-LAST-MAINT-DT                   PIC XX.
  2900     12  SF-LAST-MAINT-BY                   PIC X(4).
  2901     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2902     12  SF-STATE-RT-CONTROLS.
  2903         16  SF-ST-RT-CALC                  PIC X.
  2904     12  SF-ST-TAX-CONTROLS.
  2905         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2906         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2907         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2908     12  SF-ST-REFUND-OPTIONS.
  2909         16  SF-ST-RF-LR-CALC               PIC X.
  2910         16  SF-ST-RF-LL-CALC               PIC X.
  2911         16  SF-ST-RF-LN-CALC               PIC X.
  2912         16  SF-ST-RF-AH-CALC               PIC X.
  2913         16  SF-ST-RF-CP-CALC               PIC X.
  2914     12  SF-ST-UNEARN-PREM-OPTIONS.
  2915         16  SF-ST-LUEP-R78                 PIC X.
  2916         16  SF-ST-LUEP-PRO                 PIC X.
  2917         16  SF-ST-LUEP-ST                  PIC X.
  2918         16  SF-ST-LUEP-DOM                 PIC X.
  2919         16  SF-ST-AUEP-R78                 PIC X.
  2920         16  SF-ST-AUEP-PRO                 PIC X.
  2921         16  SF-ST-AUEP-ST                  PIC X.
  2922         16  SF-ST-AUEP-DOM                 PIC X.
  2923         16  SF-ST-CUEP-R78                 PIC X.
  2924         16  SF-ST-CUEP-PRO                 PIC X.
  2925         16  SF-ST-CUEP-ST                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  55
* EL050.cbl
  2926         16  SF-ST-CUEP-DOM                 PIC X.
  2927     12  SF-ST-EARN-PREM-OPTIONS.
  2928         16  SF-ST-LEP-R78                  PIC X.
  2929         16  SF-ST-LEP-PRO                  PIC X.
  2930         16  SF-ST-LEP-ST                   PIC X.
  2931         16  SF-ST-LEP-DOM                  PIC X.
  2932         16  SF-ST-AEP-R78                  PIC X.
  2933         16  SF-ST-AEP-PRO                  PIC X.
  2934         16  SF-ST-AEP-ST                   PIC X.
  2935         16  SF-ST-AEP-DOM                  PIC X.
  2936         16  SF-ST-CEP-R78                  PIC X.
  2937         16  SF-ST-CEP-PRO                  PIC X.
  2938         16  SF-ST-CEP-ST                   PIC X.
  2939         16  SF-ST-CEP-DOM                  PIC X.
  2940     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  56
* EL050.cbl
  2942*    COPY ELCCRTT.
  2943******************************************************************
  2944*                                                                *
  2945*                            ELCCRTT.                            *
  2946*                                                                *
  2947*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2948*                                                                *
  2949*   FILE TYPE = VSAM,KSDS                                        *
  2950*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2951*                                                                *
  2952*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2953*                                                                *
  2954*   LOG = YES                                                    *
  2955*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2956******************************************************************
  2957*                   C H A N G E   L O G
  2958*
  2959* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2960*-----------------------------------------------------------------
  2961*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2962* EFFECTIVE    NUMBER
  2963*-----------------------------------------------------------------
  2964* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2965* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2966* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2967* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2968* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2969* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2970* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2971* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  2972* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  2973******************************************************************
  2974
  2975 01  CERTIFICATE-TRAILERS.
  2976     12  CS-RECORD-ID                      PIC XX.
  2977         88  VALID-CS-ID                      VALUE 'CS'.
  2978
  2979     12  CS-CONTROL-PRIMARY.
  2980         16  CS-COMPANY-CD                 PIC X.
  2981         16  CS-CARRIER                    PIC X.
  2982         16  CS-GROUPING                   PIC X(6).
  2983         16  CS-STATE                      PIC XX.
  2984         16  CS-ACCOUNT                    PIC X(10).
  2985         16  CS-CERT-EFF-DT                PIC XX.
  2986         16  CS-CERT-NO.
  2987             20  CS-CERT-PRIME             PIC X(10).
  2988             20  CS-CERT-SFX               PIC X.
  2989         16  CS-TRAILER-TYPE               PIC X.
  2990             88  COMM-TRLR           VALUE 'A'.
  2991             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  2992             88  CERT-DATA-TRLR      VALUE 'C'.
  2993
  2994     12  CS-DATA-AREA                      PIC X(516).
  2995
  2996     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2997         16  CS-BANK-COMMISSION-AREA.
  2998             20  CS-BANK-COMMS       OCCURS 10.
  2999                 24  CS-AGT                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  57
* EL050.cbl
  3000                 24  CS-COM-TYP            PIC X.
  3001                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3002                 24  CS-RECALC-LV-INDIC    PIC X.
  3003                 24  FILLER                PIC X(10).
  3004         16  FILLER                        PIC X(256).
  3005
  3006     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3007****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3008         16  CS-MB-CLAIM-DATA OCCURS 24.
  3009             20  CS-CLAIM-NO               PIC X(7).
  3010             20  CS-CLAIM-TYPE             PIC X.
  3011                 88  CS-AH-CLM               VALUE 'A'.
  3012                 88  CS-IU-CLM               VALUE 'I'.
  3013                 88  CS-GP-CLM               VALUE 'G'.
  3014                 88  CS-LF-CLM               VALUE 'L'.
  3015                 88  CS-PR-CLM               VALUE 'P'.
  3016                 88  CS-FL-CLM               VALUE 'F'.
  3017             20  CS-INSURED-TYPE           PIC X.
  3018                 88  CS-PRIM-INSURED          VALUE 'P'.
  3019                 88  CS-CO-BORROWER           VALUE 'C'.
  3020             20  CS-BENEFIT-PERIOD         PIC 99.
  3021             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3022             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3023             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3024         16  FILLER                        PIC X(12).
  3025     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3026         16  CS-VIN-NUMBER                 PIC X(17).
  3027         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3028         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3029         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3030         16  cs-agent-name.
  3031             20  cs-agent-fname            pic x(20).
  3032             20  cs-agent-mi               pic x.
  3033             20  cs-agent-lname            pic x(25).
  3034         16  cs-license-no                 pic x(15).
  3035         16  cs-npn-number                 pic x(10).
  3036         16  cs-agent-edit-status          pic x.
  3037             88  cs-ae-refer-to-manager      value 'M'.
  3038             88  cs-ae-cover-sheet           value 'C'.
  3039             88  cs-ae-sig-form              value 'S'.
  3040             88  cs-ae-verified              value 'V'.
  3041             88  cs-unidentified-signature   value 'U'.
  3042             88  cs-cert-returned            value 'R'.
  3043             88  cs-accept-no-commission     value 'N'.
  3044         16  cs-year                       pic 9999.
  3045         16  cs-make                       pic x(20).
  3046         16  cs-model                      pic x(20).
  3047         16  cs-future                     pic x(20).
  3048         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3049         16  FILLER                        PIC X(356). *> was 420
  3050*        16  FILLER                        PIC X(496).
  3051*    COPY ELCCRTO.
  3052******************************************************************
  3053*                                                                *
  3054*                            ELCCRTO.                            *
  3055*                                                                *
  3056*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  3057*                                                                *
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  58
* EL050.cbl
  3058*   FILE TYPE = VSAM,KSDS                                        *
  3059*   RECORD SIZE = 524  RECFORM = FIXED                           *
  3060*                                                                *
  3061*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  3062*                                                                *
  3063*   LOG = YES                                                    *
  3064*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3065******************************************************************
  3066*                   C H A N G E   L O G
  3067*
  3068* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3069*-----------------------------------------------------------------
  3070*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3071* EFFECTIVE    NUMBER
  3072*-----------------------------------------------------------------
  3073* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  3074* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  3075* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  3076* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3077* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  3078******************************************************************
  3079 01  ORIGINAL-CERTIFICATE.
  3080     12  OC-RECORD-ID                      PIC XX.
  3081         88  VALID-OC-ID                      VALUE 'OC'.
  3082     12  OC-CONTROL-PRIMARY.
  3083         16  OC-COMPANY-CD                 PIC X.
  3084         16  OC-CARRIER                    PIC X.
  3085         16  OC-GROUPING                   PIC X(6).
  3086         16  OC-STATE                      PIC XX.
  3087         16  OC-ACCOUNT                    PIC X(10).
  3088         16  OC-CERT-EFF-DT                PIC XX.
  3089         16  OC-CERT-NO.
  3090             20  OC-CERT-PRIME             PIC X(10).
  3091             20  OC-CERT-SFX               PIC X.
  3092         16  OC-RECORD-TYPE                PIC X.
  3093         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3094     12  OC-LAST-MAINT-DT                  PIC XX.
  3095     12  OC-LAST-MAINT-BY                  PIC X(4).
  3096     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3097     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3098     12  FILLER                            PIC X(49).
  3099     12  OC-ORIG-REC.
  3100         16  OC-INS-LAST-NAME              PIC X(15).
  3101         16  OC-INS-FIRST-NAME             PIC X(10).
  3102         16  OC-INS-MIDDLE-INIT            PIC X.
  3103         16  OC-INS-AGE                    PIC S999     COMP-3.
  3104         16  OC-JNT-LAST-NAME              PIC X(15).
  3105         16  OC-JNT-FIRST-NAME             PIC X(10).
  3106         16  OC-JNT-MIDDLE-INIT            PIC X.
  3107         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3108         16  OC-LF-BENCD                   PIC XX.
  3109         16  OC-LF-TERM                    PIC S999      COMP-3.
  3110         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3111         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3112         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3113         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3114         16  OC-LF-EXP-DT                  PIC XX.
  3115         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  59
* EL050.cbl
  3116         16  OC-LF-CANCEL-DT               PIC XX.
  3117         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3118         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3119         16  OC-AH-BENCD                   PIC XX.
  3120         16  OC-AH-TERM                    PIC S999      COMP-3.
  3121         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3122         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3123         16  OC-AH-EXP-DT                  PIC XX.
  3124         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3125         16  OC-AH-CP                      PIC 99.
  3126         16  OC-AH-CANCEL-DT               PIC XX.
  3127         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3128         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3129         16  OC-CRED-BENE-NAME             PIC X(25).
  3130         16  OC-1ST-PMT-DT                 PIC XX.
  3131         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3132         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3133         16  OC-ISSUE-TRAN-IND             PIC X.
  3134         16  OC-CANCEL-TRAN-IND            PIC X.
  3135         16  FILLER                        PIC X(211).
  3136
  3137     12  FILLER                            PIC X(50).
  3138******************************************************************
  3139
  3140*    COPY ELCDATE.
  3141******************************************************************
  3142*                                                                *
  3143*                                                                *
  3144*                            ELCDATE.                            *
  3145*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3146*                            VMOD=2.003
  3147*                                                                *
  3148*                                                                *
  3149*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3150*                 LENGTH = 200                                   *
  3151******************************************************************
  3152
  3153 01  DATE-CONVERSION-DATA.
  3154     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3155     12  DC-OPTION-CODE                PIC X.
  3156         88  BIN-TO-GREG                VALUE ' '.
  3157         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3158         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3159         88  YMD-GREG-TO-BIN            VALUE '3'.
  3160         88  MDY-GREG-TO-BIN            VALUE '4'.
  3161         88  JULIAN-TO-BIN              VALUE '5'.
  3162         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3163         88  FIND-CENTURY               VALUE '7'.
  3164         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3165         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3166         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3167         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3168         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3169         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3170         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3171         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3172         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3173         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  60
* EL050.cbl
  3174         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3175         88  BIN-3-TO-GREG              VALUE 'I'.
  3176         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3177         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3178         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3179         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3180         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3181         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3182         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3183         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3184         88  THREE-CHARACTER-BIN
  3185                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3186         88  GREGORIAN-TO-BIN
  3187                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3188         88  BIN-TO-GREGORIAN
  3189                  VALUES ' ' '1' 'I' '8' 'G'.
  3190         88  JULIAN-TO-BINARY
  3191                  VALUES '5' 'C' 'E' 'F'.
  3192     12  DC-ERROR-CODE                 PIC X.
  3193         88  NO-CONVERSION-ERROR        VALUE ' '.
  3194         88  DATE-CONVERSION-ERROR
  3195                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3196         88  DATE-IS-ZERO               VALUE '1'.
  3197         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3198         88  DATE-IS-INVALID            VALUE '3'.
  3199         88  DATE1-GREATER-DATE2        VALUE '4'.
  3200         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3201         88  DATE-INVALID-OPTION        VALUE '9'.
  3202         88  INVALID-CENTURY            VALUE 'A'.
  3203         88  ONLY-CENTURY               VALUE 'B'.
  3204         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3205         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3206     12  DC-END-OF-MONTH               PIC X.
  3207         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3208     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3209         88  USE-NORMAL-PROCESS         VALUE ' '.
  3210         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3211         88  ADJUST-UP-100-YRS          VALUE '2'.
  3212     12  FILLER                        PIC X.
  3213     12  DC-CONVERSION-DATES.
  3214         16  DC-BIN-DATE-1             PIC XX.
  3215         16  DC-BIN-DATE-2             PIC XX.
  3216         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3217         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3218                       DC-GREG-DATE-1-EDIT.
  3219             20  DC-EDIT1-MONTH        PIC 99.
  3220             20  SLASH1-1              PIC X.
  3221             20  DC-EDIT1-DAY          PIC 99.
  3222             20  SLASH1-2              PIC X.
  3223             20  DC-EDIT1-YEAR         PIC 99.
  3224         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3225         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3226                     DC-GREG-DATE-2-EDIT.
  3227             20  DC-EDIT2-MONTH        PIC 99.
  3228             20  SLASH2-1              PIC X.
  3229             20  DC-EDIT2-DAY          PIC 99.
  3230             20  SLASH2-2              PIC X.
  3231             20  DC-EDIT2-YEAR         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  61
* EL050.cbl
  3232         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3233         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3234                     DC-GREG-DATE-1-YMD.
  3235             20  DC-YMD-YEAR           PIC 99.
  3236             20  DC-YMD-MONTH          PIC 99.
  3237             20  DC-YMD-DAY            PIC 99.
  3238         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3239         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3240                      DC-GREG-DATE-1-MDY.
  3241             20  DC-MDY-MONTH          PIC 99.
  3242             20  DC-MDY-DAY            PIC 99.
  3243             20  DC-MDY-YEAR           PIC 99.
  3244         16  DC-GREG-DATE-1-ALPHA.
  3245             20  DC-ALPHA-MONTH        PIC X(10).
  3246             20  DC-ALPHA-DAY          PIC 99.
  3247             20  FILLER                PIC XX.
  3248             20  DC-ALPHA-CENTURY.
  3249                 24 DC-ALPHA-CEN-N     PIC 99.
  3250             20  DC-ALPHA-YEAR         PIC 99.
  3251         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3252         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3253         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3254         16  DC-JULIAN-DATE            PIC 9(05).
  3255         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3256                                       PIC 9(05).
  3257         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3258             20  DC-JULIAN-YEAR        PIC 99.
  3259             20  DC-JULIAN-DAYS        PIC 999.
  3260         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3261         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3262         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3263     12  DATE-CONVERSION-VARIBLES.
  3264         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3265         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3266             20  FILLER                PIC 9(3).
  3267             20  HOLD-CEN-1-CCYY.
  3268                 24  HOLD-CEN-1-CC     PIC 99.
  3269                 24  HOLD-CEN-1-YY     PIC 99.
  3270             20  HOLD-CEN-1-MO         PIC 99.
  3271             20  HOLD-CEN-1-DA         PIC 99.
  3272         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3273             20  HOLD-CEN-1-R-MO       PIC 99.
  3274             20  HOLD-CEN-1-R-DA       PIC 99.
  3275             20  HOLD-CEN-1-R-CCYY.
  3276                 24  HOLD-CEN-1-R-CC   PIC 99.
  3277                 24  HOLD-CEN-1-R-YY   PIC 99.
  3278             20  FILLER                PIC 9(3).
  3279         16  HOLD-CENTURY-1-X.
  3280             20  FILLER                PIC X(3)  VALUE SPACES.
  3281             20  HOLD-CEN-1-X-CCYY.
  3282                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3283                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3284             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3285             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3286         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3287             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3288             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3289             20  HOLD-CEN-1-R-X-CCYY.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  62
* EL050.cbl
  3290                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3291                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3292             20  FILLER                PIC XXX.
  3293         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3294         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3295         16  DC-JULIAN-DATE-1          PIC 9(07).
  3296         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3297             20  DC-JULIAN-1-CCYY.
  3298                 24  DC-JULIAN-1-CC    PIC 99.
  3299                 24  DC-JULIAN-1-YR    PIC 99.
  3300             20  DC-JULIAN-DA-1        PIC 999.
  3301         16  DC-JULIAN-DATE-2          PIC 9(07).
  3302         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3303             20  DC-JULIAN-2-CCYY.
  3304                 24  DC-JULIAN-2-CC    PIC 99.
  3305                 24  DC-JULIAN-2-YR    PIC 99.
  3306             20  DC-JULIAN-DA-2        PIC 999.
  3307         16  DC-GREG-DATE-A-EDIT.
  3308             20  DC-EDITA-MONTH        PIC 99.
  3309             20  SLASHA-1              PIC X VALUE '/'.
  3310             20  DC-EDITA-DAY          PIC 99.
  3311             20  SLASHA-2              PIC X VALUE '/'.
  3312             20  DC-EDITA-CCYY.
  3313                 24  DC-EDITA-CENT     PIC 99.
  3314                 24  DC-EDITA-YEAR     PIC 99.
  3315         16  DC-GREG-DATE-B-EDIT.
  3316             20  DC-EDITB-MONTH        PIC 99.
  3317             20  SLASHB-1              PIC X VALUE '/'.
  3318             20  DC-EDITB-DAY          PIC 99.
  3319             20  SLASHB-2              PIC X VALUE '/'.
  3320             20  DC-EDITB-CCYY.
  3321                 24  DC-EDITB-CENT     PIC 99.
  3322                 24  DC-EDITB-YEAR     PIC 99.
  3323         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3324         16  DC-GREG-DATE-CYMD-R REDEFINES
  3325                              DC-GREG-DATE-CYMD.
  3326             20  DC-CYMD-CEN           PIC 99.
  3327             20  DC-CYMD-YEAR          PIC 99.
  3328             20  DC-CYMD-MONTH         PIC 99.
  3329             20  DC-CYMD-DAY           PIC 99.
  3330         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3331         16  DC-GREG-DATE-MDCY-R REDEFINES
  3332                              DC-GREG-DATE-MDCY.
  3333             20  DC-MDCY-MONTH         PIC 99.
  3334             20  DC-MDCY-DAY           PIC 99.
  3335             20  DC-MDCY-CEN           PIC 99.
  3336             20  DC-MDCY-YEAR          PIC 99.
  3337    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3338        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3339    12  DC-EL310-DATE                  PIC X(21).
  3340    12  FILLER                         PIC X(28).
  3341
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  63
* EL050.cbl
  3343*    COPY ELCCALC.
  3344******************************************************************
  3345*                                                                *
  3346*                           ELCCALC.                            *
  3347*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3348*                            VMOD=2.025                          *
  3349*                                                                *
  3350*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3351*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3352*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3353*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3354*                                                                *
  3355*  PASSED TO ELRTRM                                              *
  3356*  -----------------                                             *
  3357*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3358*  ORIGINAL TERM                                                 *
  3359*  BEGINNING DATE                                                *
  3360*  ENDING DATE                                                   *
  3361*  COMPANY I.D.                                                  *
  3362*  ACCOUNT MASTER USER FIELD                                     *
  3363*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3364*  FREE LOOK DAYS                                                *
  3365*                                                                *
  3366*  RETURNED FROM ELRTRM                                          *
  3367*  ---------------------                                         *
  3368*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3369*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3370*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3371*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3372*----------------------------------------------------------------*
  3373*  PASSED TO ELRAMT                                              *
  3374*  ----------------                                              *
  3375*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3376*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3377*  ORIGINAL AMOUNT                                               *
  3378*  ALTERNATE BENEFIT (BALLON)                                    *
  3379*  A.P.R. - NET PAY ONLY                                         *
  3380*  METHOD
  3381*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3382*  COMPANY I.D.                                                  *
  3383*  BENEFIT TYPE                                                  *
  3384*                                                                *
  3385*  RETURNED FROM ELRAMT                                          *
  3386*  --------------------                                          *
  3387*  REMAINING AMOUNT 1 - CURRENT                                  *
  3388*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3389*  REMAINING AMOUNT FACTOR
  3390*----------------------------------------------------------------*
  3391*  PASSED TO ELRESV                                              *
  3392*  -----------------                                             *
  3393*  CERTIFICATE EFFECTIVE DATE                                    *
  3394*  VALUATION DATE                                                *
  3395*  PAID THRU DATE                                                *
  3396*  BENEFIT                                                       *
  3397*  INCURRED DATE                                                 *
  3398*  REPORTED DATE                                                 *
  3399*  ISSUE AGE                                                     *
  3400*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  64
* EL050.cbl
  3401*  CDT PERCENT                                                   *
  3402*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3403* *CLAIM TYPE (LIFE, A/H)                                        *
  3404* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3405* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3406*                                                                *
  3407*  RETURNED FROM ELRESV                                          *
  3408*  --------------------                                          *
  3409*  CDT TABLE USED                                                *
  3410*  CDT FACTOR USED                                               *
  3411*  PAY TO CURRENT RESERVE                                        *
  3412*  I.B.N.R. - A/H ONLY                                           *
  3413*  FUTURE (ACCRUED) AH ONLY                                      *
  3414*----------------------------------------------------------------*
  3415*  PASSED TO ELRATE                                              *
  3416*  ----------------                                              *
  3417*  CERT ISSUE DATE                                               *
  3418*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3419*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3420*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3421*  STATE CODE (CLIENT DEFINED)                                   *
  3422*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3423*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3424*  DEVIATION CODE                                                *
  3425*  ISSUE AGE                                                     *
  3426*  ORIGINAL BENEFIT AMOUNT                                       *
  3427*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3428*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3429*  BENEFIT KIND (LIFE OR A/H)                                    *
  3430*  A.P.R.                                                        *
  3431*  METHOD
  3432*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3433*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3434*  COMPANY I.D. (3 CHARACTER)                                    *
  3435*  BENEFIT CODE                                                  *
  3436*  BENEFIT OVERRIDE CODE                                         *
  3437*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3438*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3439*  JOINT INDICATOR (CSL ONLY)                                    *
  3440*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3441*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3442*                                                                *
  3443*  RETURNED FROM ELRATE                                          *
  3444*  --------------------                                          *
  3445*  CALCULATED PREMIUM                                            *
  3446*  PREMIUM RATE                                                  *
  3447*  MORTALITY CODE                                                *
  3448*  MAX ATTAINED AGE                                              *
  3449*  MAX AGE                                                       *
  3450*  MAX TERM                                                      *
  3451*  MAX MONTHLY BENEFIT                                           *
  3452*  MAX TOTAL BENIFIT                                             *
  3453*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3454*----------------------------------------------------------------*
  3455*  PASSED TO ELRFND                                              *
  3456*  ----------------                                              *
  3457*  CERT ISSUE DATE                                               *
  3458*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  65
* EL050.cbl
  3459*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3460*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3461*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3462*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3463*  STATE CODE (CLIENT DEFINED)                                   *
  3464*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3465*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3466*  DEVIATION CODE                                                *
  3467*  ISSUE AGE                                                     *
  3468*  ORIGINAL BENEFIT AMOUNT                                       *
  3469*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3470*  PROCESS TYPE (CANCEL)                                         *
  3471*  BENEFIT KIND (LIFE OR A/H)                                    *
  3472*  A.P.R.                                                        *
  3473*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3474*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3475*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3476*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3477*  COMPANY I.D. (3 CHARACTER)                                    *
  3478*  BENEFIT CODE                                                  *
  3479*  BENEFIT OVERRIDE CODE                                         *
  3480*                                                                *
  3481*  RETURNED FROM ELRFND                                          *
  3482*  --------------------                                          *
  3483*  CALCULATED REFUND                                             *
  3484*----------------------------------------------------------------*
  3485*  PASSED TO ELEARN                                              *
  3486*  ----------------                                              *
  3487*  CERT ISSUE DATE                                               *
  3488*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3489*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3490*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3491*  STATE CODE (CLIENT DEFINED)                                   *
  3492*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3493*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3494*  DEVIATION CODE                                                *
  3495*  ISSUE AGE                                                     *
  3496*  ORIGINAL BENEFIT AMOUNT                                       *
  3497*  BENEFIT KIND (LIFE OR A/H)                                    *
  3498*  A.P.R.                                                        *
  3499*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3500*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3501*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3502*  COMPANY I.D. (3 CHARACTER)                                    *
  3503*  BENEFIT CODE                                                  *
  3504*  BENEFIT OVERRIDE CODE                                         *
  3505*                                                                *
  3506*  RETURNED FROM ELEARN                                          *
  3507*  --------------------                                          *
  3508*  INDICATED  EARNINGS                                           *
  3509*----------------------------------------------------------------*
  3510*                 LENGTH = 450                                   *
  3511*                                                                *
  3512******************************************************************
  3513******************************************************************
  3514*                   C H A N G E   L O G
  3515*
  3516* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  66
* EL050.cbl
  3517*-----------------------------------------------------------------
  3518*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3519* EFFECTIVE    NUMBER
  3520*-----------------------------------------------------------------
  3521* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3522* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3523* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3524* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3525* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3526* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3527* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3528* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3529* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3530* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3531* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3532******************************************************************
  3533
  3534 01  CALCULATION-PASS-AREA.
  3535     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3536                                     COMP.
  3537
  3538     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3539       88  NO-CP-ERROR                             VALUE ZERO.
  3540       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3541                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3542       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3543       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3544       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3545       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3546       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3547       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3548       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3549       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3550       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3551       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3552       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3553       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3554       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3555       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3556       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3557       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3558       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3559
  3560     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3561       88  NO-CP-ERROR-2                           VALUE ZERO.
  3562***********************  INPUT AREAS ****************************
  3563
  3564     12  CP-CALCULATION-AREA.
  3565         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3566         16  CP-CERT-EFF-DT        PIC XX.
  3567         16  CP-VALUATION-DT       PIC XX.
  3568         16  CP-PAID-THRU-DT       PIC XX.
  3569         16  CP-BENEFIT-TYPE       PIC X.
  3570           88  CP-AH                               VALUE 'A' 'D'
  3571                                                   'I' 'U'.
  3572           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3573           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3574         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  67
* EL050.cbl
  3575         16  CP-REPORTED-DT        PIC XX.
  3576         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3577         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3578         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3579                                     COMP-3.
  3580         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3581                                     COMP-3.
  3582         16  CP-CDT-METHOD         PIC X.
  3583           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3584           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3585           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3586         16  CP-CLAIM-TYPE         PIC X.
  3587           88  CP-AH-CLAIM                         VALUE 'A'.
  3588           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3589         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3590                                     COMP-3.
  3591         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3592                                     COMP-3.
  3593         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3594                                     COMP-3.
  3595         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3596                                     COMP-3.
  3597         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3598                                     COMP-3.
  3599         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3600                                     COMP-3.
  3601         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3602                                     COMP-3.
  3603         16  CP-REM-TERM-METHOD    PIC X.
  3604           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3605           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3606           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3607           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3608           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3609           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3610           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3611         16  CP-EARNING-METHOD     PIC X.
  3612           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3613           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3614           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3615           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3616           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3617           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3618           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3619           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3620           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3621           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3622           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3623           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3624           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3625           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3626         16  CP-PROCESS-TYPE       PIC X.
  3627           88  CP-CLAIM                            VALUE '1'.
  3628           88  CP-CANCEL                           VALUE '2'.
  3629           88  CP-ISSUE                            VALUE '3'.
  3630         16  CP-SPECIAL-CALC-CD    PIC X.
  3631           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3632           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  68
* EL050.cbl
  3633           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3634           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3635           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3636           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3637           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3638           88  CP-FARM-PLAN                    VALUE 'F'.
  3639           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3640           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3641           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3642           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3643           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3644           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3645           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3646           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3647           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3648           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3649                                                     'W' 'X'.
  3650           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3651           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3652           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3653           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3654           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3655           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3656           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3657           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3658           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3659           88  CP-CSL-METH-1                   VALUE '5'.
  3660           88  CP-CSL-METH-2                   VALUE '6'.
  3661           88  CP-CSL-METH-3                   VALUE '7'.
  3662           88  CP-CSL-METH-4                   VALUE '8'.
  3663
  3664         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3665                                     COMP-3.
  3666         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3667         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3668         16  CP-STATE              PIC XX          VALUE SPACE.
  3669         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3670         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3671           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3672               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3673         16  CP-R78-OPTION         PIC X.
  3674           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3675           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3676
  3677         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3678         16  CP-IBNR-RESERVE-SW    PIC X.
  3679         16  CP-CLAIM-STATUS       PIC X.
  3680         16  CP-RATE-FILE          PIC X.
  3681         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3682                                     COMP-3.
  3683
  3684         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3685         16  CP-AH-OVERRIDE-CODE   PIC X.
  3686
  3687         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3688                                     COMP-3.
  3689         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3690                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  69
* EL050.cbl
  3691         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3692                                     COMP-3.
  3693         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3694                                     COMP-3.
  3695         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3696                                     COMP-3.
  3697         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3698                                  PIC S9(7)V99 COMP-3.
  3699
  3700         16  CP-PAID-FROM-DATE     PIC X(02).
  3701         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3702         16  CP-EXT-DAYS-CALC      PIC X.
  3703           88  CP-EXT-NO-CHG                   VALUE ' '.
  3704           88  CP-EXT-CHG-LF                   VALUE '1'.
  3705           88  CP-EXT-CHG-AH                   VALUE '2'.
  3706           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3707         16  CP-DOMICILE-STATE     PIC XX.
  3708         16  CP-CARRIER            PIC X.
  3709         16  CP-REIN-FLAG          PIC X.
  3710         16  CP-REM-TRM-CALC-OPTION PIC X.
  3711           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3712                      '2' '3' '4' '5'.
  3713           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3714           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3715           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3716           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3717           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3718           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3719           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3720           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3721         16  CP-SIG-SWITCH         PIC X.
  3722         16  CP-RATING-METHOD      PIC X.
  3723           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3724           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3725           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3726           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3727           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3728           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3729           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3730           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3731           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3732         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3733                                     COMP-3.
  3734         16  CP-BEN-CATEGORY       PIC X.
  3735         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3736         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3737                                   PIC S99V9(5) COMP-3.
  3738         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3739         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3740                                   PIC S99V9(5) COMP-3.
  3741         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3742         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3743         16  CP-EXPIRE-DT          PIC XX.
  3744         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3745         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3746         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3747         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3748         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  70
* EL050.cbl
  3749             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3750             88  CP-CALC-CLP              VALUE 'C'.
  3751         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3752         16  CP-CANCEL-REASON      PIC X.
  3753         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3754         16  CP-PMT-MODE           PIC X.
  3755         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3756         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3757         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3758         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3759         16  FILLER                PIC X.
  3760
  3761***************    OUTPUT FROM ELRESV   ************************
  3762
  3763         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3764
  3765         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3766                                     COMP-3.
  3767         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3768                                     COMP-3.
  3769         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3770                                     COMP-3.
  3771         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3772                                     COMP-3.
  3773         16  FILLER                PIC X(09).
  3774***************    OUTPUT FROM ELRTRM   *************************
  3775
  3776         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3777                                     COMP-3.
  3778         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3779                                     COMP-3.
  3780         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3781                                     COMP-3.
  3782         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3783                                     COMP-3.
  3784         16  FILLER                PIC X(12).
  3785
  3786***************    OUTPUT FROM ELRAMT   *************************
  3787
  3788         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3789                                     COMP-3.
  3790         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3791                                     COMP-3.
  3792         16  FILLER                PIC X(12).
  3793
  3794***************    OUTPUT FROM ELRATE   *************************
  3795
  3796         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3797                                     COMP-3.
  3798         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3799                                     COMP-3.
  3800         16  CP-MORTALITY-CODE     PIC X(4).
  3801         16  CP-RATE-EDIT-FLAG     PIC X.
  3802             88  CP-RATES-NEED-APR                  VALUE '1'.
  3803         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3804                                     COMP-3.
  3805         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3806         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  71
* EL050.cbl
  3807         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3808                                   PIC S9(7)V99 COMP-3.
  3809         16  FILLER                PIC X(07).
  3810
  3811***************    OUTPUT FROM ELRFND   *************************
  3812
  3813         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3814                                     COMP-3.
  3815         16  CP-REFUND-TYPE-USED   PIC X.
  3816           88  CP-R-AS-R78                         VALUE '1'.
  3817           88  CP-R-AS-PRORATA                     VALUE '2'.
  3818           88  CP-R-AS-CALIF                       VALUE '3'.
  3819           88  CP-R-AS-TEXAS                       VALUE '4'.
  3820           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3821           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3822           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3823           88  CP-R-AS-MEAN                        VALUE '8'.
  3824           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3825           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3826           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3827           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3828           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3829           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3830         16  FILLER                PIC X(12).
  3831
  3832***************    OUTPUT FROM ELEARN   *************************
  3833
  3834         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3835                                     COMP-3.
  3836         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3837                                     COMP-3.
  3838         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3839                                     COMP-3.
  3840         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3841                                     COMP-3.
  3842         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3843                                     COMP-3.
  3844         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3845                                     COMP-3.
  3846         16  CP-EARNING-TYPE-USED  PIC X.
  3847           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3848           88  CP-E-AS-R78                         VALUE '1'.
  3849           88  CP-E-AS-PRORATA                     VALUE '2'.
  3850           88  CP-E-AS-TEXAS                       VALUE '4'.
  3851           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3852           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3853           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3854           88  CP-E-AS-MEAN                        VALUE '8'.
  3855           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3856         16  FILLER                PIC X(12).
  3857
  3858***************    OUTPUT FROM ELPMNT   *************************
  3859
  3860         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3861                                     COMP-3.
  3862         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3863                                     COMP-3.
  3864         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  72
* EL050.cbl
  3865
  3866***************   MISC WORK AREAS    *****************************
  3867         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3868                                     COMP-3.
  3869         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3870                                     COMP-3.
  3871         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3872                                     COMP-3.
  3873         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3874                                     COMP-3.
  3875         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3876                                     COMP-3.
  3877         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3878                                     COMP-3.
  3879         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3880             88  OPEN-RATE-FILE                   VALUE 'O'.
  3881             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3882             88  IO-ERROR                         VALUE 'E'.
  3883
  3884         16  CP-FIRST-PAY-DATE     PIC XX.
  3885
  3886         16  CP-JOINT-INDICATOR    PIC X.
  3887
  3888         16  CP-RESERVE-REMAINING-TERM
  3889                                   PIC S9(4)V9    VALUE ZERO
  3890                                     COMP-3.
  3891
  3892         16  CP-INSURED-BIRTH-DT   PIC XX.
  3893
  3894         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3895                                     COMP-3.
  3896
  3897         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3898                                     COMP-3.
  3899
  3900         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3901                                     COMP-3.
  3902
  3903         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3904                                     COMP-3.
  3905
  3906         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3907                                     COMP-3.
  3908
  3909         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3910                                     COMP-3.
  3911
  3912         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3913                                     COMP-3.
  3914
  3915         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3916             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3917
  3918         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3919                                     COMP-3.
  3920         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3921                                     COMP-3.
  3922         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  73
* EL050.cbl
  3923         16  cp-extra-periods      pic 9 value zeros.
  3924         16  cp-net-only-state     pic x value spaces.
  3925         16  FILLER                PIC X(13).
  3926******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  74
* EL050.cbl
  3928******************************************************************
  3929*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3930*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3931*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3932*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3933*** MODIFICATION.                                              ***
  3934*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3935*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3936******************************************************************
  3937*    COPY ERCPNDB.
  3938******************************************************************
  3939*                                                                *
  3940*                                                                *
  3941*                            ERCPNDB.                            *
  3942*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3943*                            VMOD=2.025                          *
  3944*                                                                *
  3945*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3946*                                                                *
  3947******************************************************************
  3948*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3949*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3950******************************************************************
  3951*                                                                *
  3952*                                                                *
  3953*   FILE TYPE = VSAM,KSDS                                        *
  3954*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3955*                                                                *
  3956*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3957*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3958*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3959*                                                 RKP=13,LEN=36  *
  3960*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3961*                                      AND CHG-SEQ.)             *
  3962*                                                RKP=49,LEN=11   *
  3963*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3964*                                      AND CHG-SEQ.)             *
  3965*                                                RKP=60,LEN=15   *
  3966*                                                                *
  3967*   LOG = NO                                                     *
  3968*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3969******************************************************************
  3970******************************************************************
  3971*                   C H A N G E   L O G
  3972*
  3973* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3974*-----------------------------------------------------------------
  3975*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3976* EFFECTIVE    NUMBER
  3977*-----------------------------------------------------------------
  3978* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3979* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3980* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3981* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3982* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3983* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3984* 032306                   PEMA  ADD BOW LOAN NUMBER
  3985* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  75
* EL050.cbl
  3986* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3987* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3988* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3989* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3990* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3991* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3992* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3993* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  3994* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3995******************************************************************
  3996
  3997 01  PENDING-BUSINESS.
  3998     12  PB-RECORD-ID                     PIC XX.
  3999         88  VALID-PB-ID                        VALUE 'PB'.
  4000
  4001     12  PB-CONTROL-PRIMARY.
  4002         16  PB-COMPANY-CD                PIC X.
  4003         16  PB-ENTRY-BATCH               PIC X(6).
  4004         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4005         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4006
  4007     12  PB-CONTROL-BY-ACCOUNT.
  4008         16  PB-COMPANY-CD-A1             PIC X.
  4009         16  PB-CARRIER                   PIC X.
  4010         16  PB-GROUPING.
  4011             20  PB-GROUPING-PREFIX       PIC XXX.
  4012             20  PB-GROUPING-PRIME        PIC XXX.
  4013         16  PB-STATE                     PIC XX.
  4014         16  PB-ACCOUNT.
  4015             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4016             20  PB-ACCOUNT-PRIME         PIC X(6).
  4017         16  PB-CERT-EFF-DT               PIC XX.
  4018         16  PB-CERT-NO.
  4019             20  PB-CERT-PRIME            PIC X(10).
  4020             20  PB-CERT-SFX              PIC X.
  4021         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4022
  4023         16  PB-RECORD-TYPE               PIC X.
  4024             88  PB-MAILING-DATA                VALUE '0'.
  4025             88  PB-ISSUE                       VALUE '1'.
  4026             88  PB-CANCELLATION                VALUE '2'.
  4027             88  PB-BATCH-TRAILER               VALUE '9'.
  4028
  4029     12  PB-CONTROL-BY-ORIG-BATCH.
  4030         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4031         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4032         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4033         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4034
  4035     12  PB-CONTROL-BY-CSR.
  4036         16  PB-CSR-COMPANY-CD            PIC X.
  4037         16  PB-CSR-ID                    PIC X(4).
  4038         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4039         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4040         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4041******************************************************************
  4042*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4043******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  76
* EL050.cbl
  4044
  4045     12  PB-LAST-MAINT-DT                 PIC XX.
  4046     12  PB-LAST-MAINT-BY                 PIC X(4).
  4047     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4048
  4049     12  PB-RECORD-BODY                   PIC X(375).
  4050
  4051     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4052         16  PB-CERT-ORIGIN               PIC X.
  4053             88  CLASIC-CREATED-CERT         VALUE '1'.
  4054         16  PB-I-NAME.
  4055             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4056             20  PB-I-INSURED-FIRST-NAME.
  4057                 24  PB-I-INSURED-1ST-INIT PIC X.
  4058                 24  FILLER                PIC X(9).
  4059             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4060         16  PB-I-AGE                     PIC S99   COMP-3.
  4061         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4062         16  PB-I-BIRTHDAY                PIC XX.
  4063         16  PB-I-INSURED-SEX             PIC X.
  4064             88  PB-SEX-MALE     VALUE 'M'.
  4065             88  PB-SEX-FEMALE   VALUE 'F'.
  4066
  4067         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4068         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4069         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4070         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4071         16  PB-I-SKIP-CODE               PIC X.
  4072             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4073             88  PB-SKIP-JULY              VALUE '1'.
  4074             88  PB-SKIP-AUGUST            VALUE '2'.
  4075             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4076             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4077             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4078             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4079             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4080             88  PB-SKIP-JUNE              VALUE '8'.
  4081             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4082             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4083             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4084         16  PB-I-TERM-TYPE               PIC X.
  4085             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4086             88  PB-PAID-WEEKLY            VALUE 'W'.
  4087             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4088             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4089             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4090         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4091         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4092         16  PB-I-DATA-ENTRY-SW           PIC X.
  4093             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4094             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4095             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4096             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4097         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4098         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4099*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4100         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4101         16  FILLER                       PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  77
* EL050.cbl
  4102
  4103         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4104             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4105             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4106                                                   '90' THRU '99'.
  4107         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4108                                          PIC XX.
  4109         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4110         16  PB-I-AMOUNT-FINANCED REDEFINES
  4111                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4112         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4113         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4114                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4115         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4116         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4117         16  PB-I-CLP-AMOUNT REDEFINES
  4118                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4119         16  PB-I-LF-CALC-FLAG            PIC X.
  4120             88 PB-COMP-LF-PREM               VALUE '?'.
  4121         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4122         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4123         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4124         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4125         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4126         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4127         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4128         16  PB-I-LF-ABBR                 PIC XXX.
  4129         16  PB-I-LF-INPUT-CD             PIC XX.
  4130
  4131         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4132             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4133             88  PB-INVALID-AH               VALUE '  ' '00'
  4134                                                   '90' THRU '99'.
  4135         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4136         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4137         16  PB-I-AH-CALC-FLAG            PIC X.
  4138             88 PB-COMP-AH-PREM                  VALUE '?'.
  4139         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4140         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4141         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  4142         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4143         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4144         16  PB-I-AH-ABBR                 PIC XXX.
  4145         16  PB-I-AH-INPUT-CD             PIC XXX.
  4146
  4147         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4148         16  PB-I-REIN-TABLE              PIC XXX.
  4149         16  PB-I-BUSINESS-TYPE           PIC 99.
  4150         16  PB-I-INDV-GRP-CD             PIC X.
  4151         16  PB-I-MORT-CODE.
  4152             20  PB-I-TABLE               PIC X.
  4153             20  PB-I-INTEREST            PIC XX.
  4154             20  PB-I-MORT-TYP            PIC X.
  4155         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4156         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4157         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4158         16  PB-I-INDV-GRP-OVRD           PIC X.
  4159         16  PB-I-RATE-CLASS-OVRD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  78
* EL050.cbl
  4160         16  PB-I-SIG-SW                  PIC X.
  4161             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4162         16  PB-I-RATE-CLASS              PIC XX.
  4163         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4164         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4165         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4166         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4167         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4168         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4169         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4170         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4171         16  PB-I-OB-FLAG                 PIC X.
  4172             88  PB-I-OB                      VALUE 'B'.
  4173             88  PB-I-SUMMARY                 VALUE 'Z'.
  4174         16  PB-I-ENTRY-STATUS            PIC X.
  4175             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4176                                              'M' '5' '9' '2'.
  4177             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4178             88  PB-I-POLICY-PENDING          VALUE '2'.
  4179             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4180             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4181             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4182             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4183             88  PB-I-REIN-ONLY               VALUE '9'.
  4184             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4185             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4186             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4187             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4188         16  PB-I-INT-CODE                PIC X.
  4189             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4190             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4191         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4192         16  PB-I-SOC-SEC-NO              PIC X(11).
  4193         16  PB-I-MEMBER-NO               PIC X(12).
  4194         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4195*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4196         16  PB-I-OLD-LOF                 PIC XXX.
  4197         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4198         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4199         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4200         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4201         16  PB-I-LIFE-INDICATOR          PIC X.
  4202             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4203         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4204         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4205                                          PIC S9(5)V99    COMP-3.
  4206         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4207             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4208             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4209         16  PB-I-1ST-PMT-DT              PIC XX.
  4210         16  PB-I-JOINT-INSURED.
  4211             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4212             20 PB-I-JOINT-FIRST-NAME.
  4213                24  PB-I-JOINT-FIRST-INIT PIC X.
  4214                24  FILLER                PIC X(9).
  4215             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4216*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4217         16  PB-I-BENEFICIARY-NAME.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  79
* EL050.cbl
  4218             20  PB-I-BANK-NUMBER         PIC X(10).
  4219             20  FILLER                   PIC X(15).
  4220         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4221         16  PB-I-REFERENCE               PIC X(12).
  4222         16  FILLER REDEFINES PB-I-REFERENCE.
  4223             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4224             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4225             20  PB-I-CLP-STATE           PIC XX.
  4226         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4227             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4228             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4229             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4230         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4231         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4232         16  PB-I-RESIDENT-STATE          PIC XX.
  4233         16  PB-I-RATE-CODE               PIC X(4).
  4234         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4235         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4236         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4237         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4238         16  PB-I-BANK-NOCHRGB            PIC 99.
  4239         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4240         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4241
  4242     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4243         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4244             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4245         16  PB-C-CANCEL-ORIGIN           PIC X.
  4246             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4247         16  PB-C-LF-CANCEL-DT            PIC XX.
  4248         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4249         16  PB-C-LF-CALC-REQ             PIC X.
  4250             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4251         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4252         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4253         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4254             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4255         16  PB-C-AH-CANCEL-DT            PIC XX.
  4256         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4257         16  PB-C-AH-CALC-REQ             PIC X.
  4258             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4259         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4260         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4261         16  PB-C-LAST-NAME               PIC X(15).
  4262         16  PB-C-REFUND-SW               PIC X.
  4263             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4264             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4265         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4266         16  PB-C-PAYEE-CODE              PIC X(6).
  4267         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4268         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4269         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4270         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4271         16  PB-C-REFERENCE               PIC X(12).
  4272         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4273         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4274         16  PB-C-POST-CARD-IND           PIC X.
  4275         16  PB-C-CANCEL-REASON           PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  80
* EL050.cbl
  4276         16  PB-C-REF-INTERFACE-SW        PIC X.
  4277         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4278         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4279         16  FILLER                       PIC X(01).
  4280*        16  FILLER                       PIC X(18).
  4281         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4282*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4283         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4284         16  PB-CANCELED-CERT-DATA.
  4285             20  PB-CI-INSURED-NAME.
  4286                 24  PB-CI-LAST-NAME      PIC X(15).
  4287                 24  PB-CI-INITIALS       PIC XX.
  4288             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4289             20  PB-CI-INSURED-SEX        PIC X.
  4290             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4291             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4292             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4293             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4294             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4295             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4296             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4297             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4298             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4299             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4300             20  PB-CI-RATE-CLASS         PIC XX.
  4301             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4302             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4303             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4304             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4305             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4306             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4307             20  PB-CI-LF-ABBR            PIC X(3).
  4308             20  PB-CI-AH-ABBR            PIC X(3).
  4309             20  PB-CI-OB-FLAG            PIC X.
  4310                 88  PB-CI-OB                VALUE 'B'.
  4311             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4312                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4313                                           'M' '4' '5' '9' '2'.
  4314                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4315                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4316                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4317                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4318                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4319                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4320                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4321                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4322                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4323                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4324                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4325                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4326                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4327             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4328                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4329                                           'M' '4' '5' '9' '2'.
  4330                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4331                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4332                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4333                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  81
* EL050.cbl
  4334                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4335                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4336                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4337                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4338                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4339                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4340                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4341                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4342                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4343             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4344             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4345             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4346             20  PB-CI-MEMBER-NO          PIC X(12).
  4347             20  PB-CI-INT-CODE           PIC X.
  4348                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4349                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4350             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4351             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4352             20  PB-CI-COMP-EXCP-SW       PIC X.
  4353                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4354                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4355             20  PB-CI-ENTRY-STATUS       PIC X.
  4356             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4357             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4358             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4359             20  PB-CI-DEATH-DT           PIC XX.
  4360             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4361             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4362             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4363             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4364             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4365             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4366             20  PB-CI-ENTRY-DT              PIC XX.
  4367             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4368             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4369             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4370             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4371             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4372             20  PB-CI-OLD-LOF               PIC XXX.
  4373*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4374             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4375             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4376             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4377             20  PB-CI-INDV-GRP-CD           PIC X.
  4378             20  PB-CI-BENEFICIARY-NAME.
  4379                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4380                 24  FILLER                  PIC X(15).
  4381             20  PB-CI-NOTE-SW               PIC X.
  4382             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4383             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4384             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4385             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4386             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4387             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4388             20  PB-CI-FIRST-NAME            PIC X(10).
  4389             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4390
  4391         16  FILLER                       PIC X(13).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  82
* EL050.cbl
  4392*032306  16  FILLER                       PIC X(27).
  4393*        16  FILLER                       PIC X(46).
  4394
  4395     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4396         16  FILLER                       PIC X(10).
  4397         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4398         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4399         16  PB-M-INSURED-MID-INIT        PIC X.
  4400         16  PB-M-INSURED-AGE             PIC 99.
  4401         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4402         16  PB-M-INSURED-SEX             PIC X.
  4403         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4404         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4405         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4406         16  PB-M-INSURED-CITY-STATE.
  4407             20  PB-M-INSURED-CITY        PIC X(28).
  4408             20  PB-M-INSURED-STATE       PIC XX.
  4409         16  PB-M-INSURED-ZIP-CODE.
  4410             20  PB-M-INSURED-ZIP-PRIME.
  4411                 24  PB-M-INSURED-ZIP-1   PIC X.
  4412                     88  PB-M-CANADIAN-POST-CODE
  4413                                             VALUE 'A' THRU 'Z'.
  4414                 24  FILLER               PIC X(4).
  4415             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4416         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4417                                        PB-M-INSURED-ZIP-CODE.
  4418             20  PM-M-INS-CAN-POST1       PIC XXX.
  4419             20  PM-M-INS-CAN-POST2       PIC XXX.
  4420             20  FILLER                   PIC XXX.
  4421         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4422         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4423         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4424         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4425         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4426         16  PB-M-CRED-BENE-CITYST.
  4427             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4428             20  PB-M-CRED-BENE-STATE     PIC XX.
  4429         16  FILLER                       PIC X(92).
  4430
  4431     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4432         16  FILLER                       PIC X(10).
  4433         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4434         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4435         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4436         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4437         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4438         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4439         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4440         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4441         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4442         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4443         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4444         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4445         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4446         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4447         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4448         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4449         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  83
* EL050.cbl
  4450         16  PB-ACCOUNT-NAME              PIC X(30).
  4451         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4452         16  PB-REFERENCE                 PIC X(12).
  4453         16  PB-B-RECEIVED-DT             PIC XX.
  4454         16  FILLER                       PIC X(234).
  4455
  4456     12  PB-RECORD-STATUS.
  4457         16  PB-CREDIT-SELECT-DT          PIC XX.
  4458         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4459         16  PB-BILLED-DT                 PIC XX.
  4460         16  PB-BILLING-STATUS            PIC X.
  4461             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4462             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4463             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4464         16  PB-RECORD-BILL               PIC X.
  4465             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4466             88  PB-RECORD-RETURNED           VALUE 'R'.
  4467             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4468             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4469             88  PB-OVERRIDE-AH               VALUE 'A'.
  4470             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4471         16  PB-BATCH-ENTRY               PIC X.
  4472             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4473             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4474             88  PB-REISSUED-CERT             VALUE 'E'.
  4475             88  PB-CASH-CERT                 VALUE 'C'.
  4476             88  PB-MONTHLY-CERT              VALUE 'M'.
  4477             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4478             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4479             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4480         16  PB-FORCE-CODE                PIC X.
  4481             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4482             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4483             88  PB-CANCEL-FORCE              VALUE '8'.
  4484             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4485             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4486             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4487             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4488             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4489             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4490             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4491         16  PB-FATAL-FLAG                PIC X.
  4492             88  PB-FATAL-ERRORS              VALUE 'X'.
  4493         16  PB-FORCE-ER-CD               PIC X.
  4494             88  PB-FORCE-ERRORS              VALUE 'F'.
  4495             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4496         16  PB-WARN-ER-CD                PIC X.
  4497             88  PB-WARNING-ERRORS            VALUE 'W'.
  4498         16  FILLER                       PIC X.
  4499         16  PB-OUT-BAL-CD                PIC X.
  4500             88  PB-OUT-OF-BAL                VALUE 'O'.
  4501         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4502         16  PB-AH-OVERRIDE-L1            PIC X.
  4503         16  PB-INPUT-DT                  PIC XX.
  4504         16  PB-INPUT-BY                  PIC X(4).
  4505         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4506         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4507         16  PB-TOLERANCE-REJECT-SW       PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  84
* EL050.cbl
  4508         16  PB-LF-EARNING-METHOD         PIC X.
  4509         16  PB-AH-EARNING-METHOD         PIC X.
  4510         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4511         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4512         16  PB-REIN-CD                   PIC XXX.
  4513         16  PB-LF-REFUND-TYPE            PIC X.
  4514         16  PB-AH-REFUND-TYPE            PIC X.
  4515         16  PB-ACCT-EFF-DT               PIC XX.
  4516         16  PB-ACCT-EXP-DT               PIC XX.
  4517         16  PB-COMPANY-ID                PIC X(3).
  4518         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4519         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4520         16  PB-SV-CARRIER                PIC X.
  4521         16  PB-SV-GROUPING               PIC X(6).
  4522         16  PB-SV-STATE                  PIC XX.
  4523         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4524         16  PB-GA-BILLING-INFO.
  4525             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4526                                          PIC XX.
  4527         16  PB-SV-REMIT-TO  REDEFINES
  4528             PB-GA-BILLING-INFO           PIC X(10).
  4529         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4530         16  PB-I-LOAN-OFFICER            PIC X(5).
  4531         16  PB-I-VIN                     PIC X(17).
  4532
  4533         16  FILLER                       PIC X(04).
  4534         16  IMNET-BYPASS-SW              PIC X.
  4535
  4536******************************************************************
  4537*                COMMON EDIT ERRORS                              *
  4538******************************************************************
  4539
  4540     12  PB-COMMON-ERRORS.
  4541         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4542                                           PIC S9(4)     COMP.
  4543
  4544******************************************************************
  4545
  4546* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4547*    COPY ELC50W1.
  4548******************************************************************
  4549*                                                                *
  4550*                                                                *
  4551*                             ELC50W1                            *
  4552*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4553*                            VMOD=2.004                          *
  4554*                                                                *
  4555*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4556*                                                                *
  4557*                                                                *
  4558******************************************************************
  4559
  4560     12  WK-WORK-AREA.
  4561         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4562         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4563         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4564         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4565         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  85
* EL050.cbl
  4566         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4567         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4568         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4569         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4570         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4571         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  4572         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4573         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4574         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4575         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4576         16  WK-CREDIT-EDIT-CONTROLS.
  4577             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4578             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4579             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4580             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4581             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4582             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4583         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4584         16  WK-SAVE-REIN-DATA.
  4585             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4586             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4587             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4588         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4589             88  ENTRY-FROM-EL6311       VALUE '6'.
  4590         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4591         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4592     12  WK-RECORD-ADDRESSES.
  4593         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4594         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4595         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4596         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4597         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4598         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4599         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4600         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4601     12  WK-OVER-SHORT-AREA.
  4602         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4603         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4604         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4605             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4606         16  FILLER                   PIC X(5) VALUE SPACES.
  4607
  4608*    COPY ELCEDITC.
  4609******************************************************************
  4610*                                                                *
  4611*                                                                *
  4612*                            ELCEDITC                            *
  4613*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4614*                            VMOD=2.012                          *
  4615*                                                                *
  4616*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4617*                     EL6313, EL050 AND EL517.                   *
  4618*                                                                *
  4619******************************************************************
  4620******************************************************************
  4621*                   C H A N G E   L O G
  4622*
  4623* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  86
* EL050.cbl
  4624*-----------------------------------------------------------------
  4625*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4626* EFFECTIVE    NUMBER
  4627*-----------------------------------------------------------------
  4628* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4629******************************************************************
  4630
  4631     12  EDIT-CRITERIA-DATA.
  4632         16  EC-CO-MONTH-END-DT       PIC XX.
  4633         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4634         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4635         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4636         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4637         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4638         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4639         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4640         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4641         16  EC-CO-REM-TERM-CALC      PIC X.
  4642               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4643               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4644               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4645               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4646
  4647         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4648               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4649               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4650               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4651               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4652               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4653               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4654               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4655               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4656               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4657               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4658
  4659         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4660               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4661               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4662               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4663               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4664               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4665               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4666               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4667               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4668
  4669         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4670                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4671                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4672
  4673         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4674                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4675                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4676                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4677                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4678                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4679                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4680                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4681                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  87
* EL050.cbl
  4682
  4683         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4684               88  EC-BR-REDUCING                   VALUE 'R'.
  4685               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4686
  4687         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  4688         16  EC-BR-LF-DESC             PIC X(10).
  4689         16  EC-BR-AH-DESC             PIC X(10).
  4690         16  EC-BR-LF-COMMENT          PIC X(10).
  4691         16  EC-BR-AH-COMMENT          PIC X(10).
  4692
  4693         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4694               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4695               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4696               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4697               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4698
  4699         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4700               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4701               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4702               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4703               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4704
  4705         16  EC-BR-LF-REFUND-CALC      PIC X.
  4706                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4707                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4708                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4709                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4710                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4711                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4712                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4713
  4714         16  EC-BR-AH-REFUND-CALC      PIC X.
  4715                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4716                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4717                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4718                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4719                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4720                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4721                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4722                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4723
  4724         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4725                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4726                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4727                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4728
  4729         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4730                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4731                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4732                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4733
  4734         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4735         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4736         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4737         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4738
  4739         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  88
* EL050.cbl
  4740         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4741                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4742                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4743                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4744                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4745
  4746         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4747               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4748               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4749               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4750               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4751               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4752
  4753         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4754               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4755               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4756               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4757               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4758               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4759
  4760         16  EC-ST-LF-REFUND-CALC      PIC X.
  4761                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4762                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4763                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4764                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4765                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4766                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4767                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4768                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4769
  4770         16  EC-ST-AH-REFUND-CALC      PIC X.
  4771                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4772                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4773                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4774                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4775                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4776                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4777                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4778                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4779
  4780         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4781         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4782         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4783         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4784         16  EC-AM-EXPIRATION-DT       PIC XX.
  4785         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4786         16  EC-AM-CLASS-CD            PIC XX.
  4787         16  EC-AM-LF-DEVIATION        PIC XXX.
  4788         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4789         16  EC-AM-AH-DEVIATION        PIC XXX.
  4790         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4791         16  EC-AM-PHONE-NO            PIC X(10).
  4792
  4793         16  EC-AM-LF-REFUND-CALC      PIC X.
  4794                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4795                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4796                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4797                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  89
* EL050.cbl
  4798                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4799                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4800                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4801
  4802         16  EC-AM-AH-REFUND-CALC      PIC X.
  4803                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  4804                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4805                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4806                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4807                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4808                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4809                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4810
  4811         16  EC-AM-BEN-I-G-CD          PIC X.
  4812                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4813                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4814                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4815
  4816         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4817         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4818         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4819         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4820         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4821         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4822         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4823         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4824         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4825
  4826         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4827         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4828         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4829         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4830         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4831         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4832         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4833         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4834         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4835         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4836         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4837         16  EC-RT-LF-NSP-ST           PIC XX.
  4838         16  EC-RT-AH-NSP-ST           PIC XX.
  4839         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4840         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4841
  4842         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4843             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4844                                             'M' '5' '9' '2'.
  4845             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4846             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4847             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4848             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4849             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4850             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4851             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4852             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4853             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4854             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4855
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  90
* EL050.cbl
  4856         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4857             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4858                                             'M' '5' '9' '2'.
  4859             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4860             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4861             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  4862             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4863             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4864             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4865             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4866             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4867             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4868             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4869
  4870         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4871         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4872         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4873         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4874         16  EC-CM-DEATH-DT            PIC XX.
  4875
  4876*DMD CUSTOM CODING FIELDS BELOW
  4877*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4878         16  EC-BR-DMD-RATING-SW       PIC X.
  4879                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4880                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4881                 88  NO-DMD-RATING               VALUE 'N'.
  4882
  4883         16  EC-NEW-CERT               PIC X(11).
  4884         16  EC-NEW-STATE              PIC XX.
  4885         16  FILLER                    PIC X.
  4886*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4887         16  OVER-SHORT-EDIT-FIELDS.
  4888             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4889             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4890             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4891             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4892             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4893             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4894             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4895             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4896             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4897         16  FILLER                    PIC X(71).
  4898******************************************************************
  4899
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  91
* EL050.cbl
  4901*    COPY ELCDIFRD.
  4902******************************************************************
  4903*                                                                *
  4904*                                                                *
  4905*                            ELCDIFRD.                           *
  4906*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4907*                            VMOD=2.004                          *
  4908*                                                                *
  4909*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4910*                                                                *
  4911******************************************************************
  4912*
  4913  01  WS-DIFFERENCE-CALCULATION.
  4914        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4915        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4916        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4917        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4918        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4919        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4920        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4921        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4922        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4923        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4924        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4925
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  92
* EL050.cbl
  4927****************************************************************
  4928*
  4929* Copyright (c) 2007 by Clerity Solutions, Inc.
  4930* All rights reserved.
  4931*
  4932****************************************************************
  4933 01  DFHEIV.
  4934   02  DFHEIV0               PIC X(35).
  4935   02  DFHEIV1               PIC X(08).
  4936   02  DFHEIV2               PIC X(08).
  4937   02  DFHEIV3               PIC X(08).
  4938   02  DFHEIV4               PIC X(06).
  4939   02  DFHEIV5               PIC X(04).
  4940   02  DFHEIV6               PIC X(04).
  4941   02  DFHEIV7               PIC X(02).
  4942   02  DFHEIV8               PIC X(02).
  4943   02  DFHEIV9               PIC X(01).
  4944   02  DFHEIV10              PIC S9(7) COMP-3.
  4945   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4946   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4947   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4948   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4949   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4950   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4951   02  DFHEIV17              PIC X(04).
  4952   02  DFHEIV18              PIC X(04).
  4953   02  DFHEIV19              PIC X(04).
  4954   02  DFHEIV20              USAGE IS POINTER.
  4955   02  DFHEIV21              USAGE IS POINTER.
  4956   02  DFHEIV22              USAGE IS POINTER.
  4957   02  DFHEIV23              USAGE IS POINTER.
  4958   02  DFHEIV24              USAGE IS POINTER.
  4959   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4960   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4961   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4962   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4963   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4964   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4965   02  FILLER                PIC X(02).
  4966   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4967   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4968   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4969   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4970   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4971 LINKAGE  SECTION.
  4972*****************************************************************
  4973*                                                               *
  4974* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4975* All rights reserved.                                          *
  4976*                                                               *
  4977*****************************************************************
  4978 01  dfheiblk.
  4979     02  eibtime          pic s9(7) comp-3.
  4980     02  eibdate          pic s9(7) comp-3.
  4981     02  eibtrnid         pic x(4).
  4982     02  eibtaskn         pic s9(7) comp-3.
  4983     02  eibtrmid         pic x(4).
  4984     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  93
* EL050.cbl
  4985     02  eibcposn         pic s9(4) comp.
  4986     02  eibcalen         pic s9(4) comp.
  4987     02  eibaid           pic x(1).
  4988     02  eibfiller1       pic x(1).
  4989     02  eibfn            pic x(2).
  4990     02  eibfiller2       pic x(2).
  4991     02  eibrcode         pic x(6).
  4992     02  eibfiller3       pic x(2).
  4993     02  eibds            pic x(8).
  4994     02  eibreqid         pic x(8).
  4995     02  eibrsrce         pic x(8).
  4996     02  eibsync          pic x(1).
  4997     02  eibfree          pic x(1).
  4998     02  eibrecv          pic x(1).
  4999     02  eibsend          pic x(1).
  5000     02  eibatt           pic x(1).
  5001     02  eibeoc           pic x(1).
  5002     02  eibfmh           pic x(1).
  5003     02  eibcompl         pic x(1).
  5004     02  eibsig           pic x(1).
  5005     02  eibconf          pic x(1).
  5006     02  eiberr           pic x(1).
  5007     02  eibrldbk         pic x(1).
  5008     02  eiberrcd         pic x(4).
  5009     02  eibsynrb         pic x(1).
  5010     02  eibnodat         pic x(1).
  5011     02  eibfiller5       pic x(2).
  5012     02  eibresp          pic 9(09) comp.
  5013     02  eibresp2         pic 9(09) comp.
  5014     02  dfheigdj         pic s9(4) comp.
  5015     02  dfheigdk         pic s9(4) comp.
  5016
  5017 01  DFHCOMMAREA                   PIC X(1036).
  5018
  5019*01 PARMLIST .
  5020*    02  FILLER                    PIC S9(8)   COMP.
  5021*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  5022*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  5023*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  5024*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  5025*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  5026*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  5027*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  5028
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  94
* EL050.cbl
  5030*    COPY ELCCNTL.
  5031******************************************************************
  5032*                                                                *
  5033*                                                                *
  5034*                            ELCCNTL.                            *
  5035*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5036*                            VMOD=2.059                          *
  5037*                                                                *
  5038*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  5039*                                                                *
  5040*   FILE TYPE = VSAM,KSDS                                        *
  5041*   RECORD SIZE = 750  RECFORM = FIXED                           *
  5042*                                                                *
  5043*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  5044*       ALTERNATE INDEX = NONE                                   *
  5045*                                                                *
  5046*   LOG = YES                                                    *
  5047*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5048******************************************************************
  5049*                   C H A N G E   L O G
  5050*
  5051* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5052*-----------------------------------------------------------------
  5053*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5054* EFFECTIVE    NUMBER
  5055*-----------------------------------------------------------------
  5056* 082503                   PEMA  ADD BENEFIT GROUP
  5057* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5058* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5059* 092705    2005050300006  PEMA  ADD SPP LEASES
  5060* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5061* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5062* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5063* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5064* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5065* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5066* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  5067* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  5068* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  5069* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5070******************************************************************
  5071*
  5072 01  CONTROL-FILE.
  5073     12  CF-RECORD-ID                       PIC XX.
  5074         88  VALID-CF-ID                        VALUE 'CF'.
  5075
  5076     12  CF-CONTROL-PRIMARY.
  5077         16  CF-COMPANY-ID                  PIC XXX.
  5078         16  CF-RECORD-TYPE                 PIC X.
  5079             88  CF-COMPANY-MASTER              VALUE '1'.
  5080             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5081             88  CF-STATE-MASTER                VALUE '3'.
  5082             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5083             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5084             88  CF-CARRIER-MASTER              VALUE '6'.
  5085             88  CF-MORTALITY-MASTER            VALUE '7'.
  5086             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  5087             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  95
* EL050.cbl
  5088             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5089             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5090             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5091             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5092             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5093             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5094             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5095             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5096             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5097         16  CF-ACCESS-CD-GENL              PIC X(4).
  5098         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5099             20  CF-PROCESSOR               PIC X(4).
  5100         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5101             20  CF-STATE-CODE              PIC XX.
  5102             20  FILLER                     PIC XX.
  5103         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5104             20  FILLER                     PIC XX.
  5105             20  CF-HI-BEN-IN-REC           PIC XX.
  5106         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5107             20  FILLER                     PIC XXX.
  5108             20  CF-CARRIER-CNTL            PIC X.
  5109         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5110             20  FILLER                     PIC XX.
  5111             20  CF-HI-TYPE-IN-REC          PIC 99.
  5112         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5113             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5114                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5115             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5116             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5117         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5118             20  FILLER                     PIC X.
  5119             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5120         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5121             20  FILLER                     PIC XX.
  5122             20  CF-MORTGAGE-PLAN           PIC XX.
  5123         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5124
  5125     12  CF-LAST-MAINT-DT                   PIC XX.
  5126     12  CF-LAST-MAINT-BY                   PIC X(4).
  5127     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5128
  5129     12  CF-RECORD-BODY                     PIC X(728).
  5130
  5131
  5132****************************************************************
  5133*             COMPANY MASTER RECORD                            *
  5134****************************************************************
  5135
  5136     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5137         16  CF-COMPANY-ADDRESS.
  5138             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5139             20  CF-CL-IN-CARE-OF           PIC X(30).
  5140             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5141             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5142             20  CF-CL-CITY-STATE           PIC X(30).
  5143             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5144             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5145         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  96
* EL050.cbl
  5146         16  CF-COMPANY-PASSWORD            PIC X(8).
  5147         16  CF-SECURITY-OPTION             PIC X.
  5148             88  ALL-SECURITY                   VALUE '1'.
  5149             88  COMPANY-VERIFY                 VALUE '2'.
  5150             88  PROCESSOR-VERIFY               VALUE '3'.
  5151             88  NO-SECURITY                    VALUE '4'.
  5152             88  ALL-BUT-TERM                   VALUE '5'.
  5153         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5154             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5155         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5156             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5157         16  CF-INFORCE-LOCATION            PIC X.
  5158             88  CERTS-ARE-ONLINE               VALUE '1'.
  5159             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5160             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5161         16  CF-LOWER-CASE-LETTERS          PIC X.
  5162         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5163             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5164             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5165             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5166             88  CF-ACCNT-CNTL                  VALUE '3'.
  5167             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5168
  5169         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5170         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5171
  5172         16  CF-LGX-CREDIT-USER             PIC X.
  5173             88  CO-IS-NOT-USER                 VALUE 'N'.
  5174             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5175
  5176         16 CF-CREDIT-CALC-CODES.
  5177             20  CF-CR-REM-TERM-CALC PIC X.
  5178               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5179               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5180               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5181               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5182               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5183               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5184               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5185             20  CF-CR-R78-METHOD           PIC X.
  5186               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5187               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5188
  5189         16  CF-CLAIM-CONTROL-COUNTS.
  5190             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5191                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5192
  5193             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5194                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5195
  5196             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5197                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5198
  5199             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5200                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5201
  5202         16  CF-CURRENT-MONTH-END           PIC XX.
  5203
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  97
* EL050.cbl
  5204         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5205             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5206             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5207             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5208             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5209                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5210                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5211             20  CF-CO-PREM-REJECT-SW       PIC X.
  5212                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5213                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5214             20  CF-CO-REF-REJECT-SW        PIC X.
  5215                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5216                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5217
  5218         16  CF-CO-REPORTING-DT             PIC XX.
  5219         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5220         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5221           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5222           88  CF-CO-MONTH-END                  VALUE '1'.
  5223
  5224         16  CF-LGX-CLAIM-USER              PIC X.
  5225             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5226             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5227
  5228         16  CF-CREDIT-EDIT-CONTROLS.
  5229             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5230             20  CF-MIN-AGE                 PIC 99.
  5231             20  CF-DEFAULT-AGE             PIC 99.
  5232             20  CF-MIN-TERM                PIC S999      COMP-3.
  5233             20  CF-MAX-TERM                PIC S999      COMP-3.
  5234             20  CF-DEFAULT-SEX             PIC X.
  5235             20  CF-JOINT-AGE-INPUT         PIC X.
  5236                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5237             20  CF-BIRTH-DATE-INPUT        PIC X.
  5238                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5239             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5240                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5241                 88  CF-ZERO-CARRIER            VALUE '1'.
  5242                 88  CF-ZERO-GROUPING           VALUE '2'.
  5243                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5244             20  CF-EDIT-SW                 PIC X.
  5245                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5246             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5247             20  CF-CR-PR-METHOD            PIC X.
  5248               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5249               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5250             20  FILLER                     PIC X.
  5251
  5252         16  CF-CREDIT-MISC-CONTROLS.
  5253             20  CF-REIN-TABLE-SW           PIC X.
  5254                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5255             20  CF-COMP-TABLE-SW           PIC X.
  5256                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5257             20  CF-EXPERIENCE-RETENTION-AGE
  5258                                            PIC S9        COMP-3.
  5259             20  CF-CONVERSION-DT           PIC XX.
  5260             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5261             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  98
* EL050.cbl
  5262                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5263                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5264
  5265             20  CF-CR-CHECK-NO-CONTROL.
  5266                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5267                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5268                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5269                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5270                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5271                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5272
  5273                 24  CF-CR-CHECK-COUNT       REDEFINES
  5274                     CF-CR-CHECK-COUNTER      PIC X(4).
  5275
  5276                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5277                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5278
  5279                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5280                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5281                 24  CF-MAIL-PROCESSING       PIC X.
  5282                     88  MAIL-PROCESSING          VALUE 'Y'.
  5283
  5284         16  CF-MISC-SYSTEM-CONTROL.
  5285             20  CF-SYSTEM-C                 PIC X.
  5286                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5287             20  CF-SYSTEM-D                 PIC X.
  5288                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5289             20  CF-SOC-SEC-NO-SW            PIC X.
  5290                 88  SOC-SEC-NO-USED             VALUE '1'.
  5291             20  CF-MEMBER-NO-SW             PIC X.
  5292                 88  MEMBER-NO-USED              VALUE '1'.
  5293             20  CF-TAX-ID-NUMBER            PIC X(11).
  5294             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5295             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5296                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5297                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5298                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5299                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5300             20  CF-SYSTEM-E                 PIC X.
  5301                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5302
  5303         16  CF-LGX-LIFE-USER               PIC X.
  5304             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5305             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5306
  5307         16  CF-CR-MONTH-END-DT             PIC XX.
  5308
  5309         16  CF-FILE-MAINT-DATES.
  5310             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5311                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5312             20  CF-LAST-BATCH       REDEFINES
  5313                 CF-LAST-BATCH-NO               PIC X(4).
  5314             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5315             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5316             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5317             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5318             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5319             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page  99
* EL050.cbl
  5320             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5321             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5322             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5323             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5324
  5325         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5326         16  FILLER                         PIC X.
  5327
  5328         16  CF-ALT-MORT-CODE               PIC X(4).
  5329         16  CF-MEMBER-CAPTION              PIC X(10).
  5330
  5331         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5332             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5333             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5334             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5335             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5336             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5337
  5338         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5339
  5340         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5341         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5342         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5343         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5344
  5345         16  CF-AH-OVERRIDE-L1              PIC X.
  5346         16  CF-AH-OVERRIDE-L2              PIC XX.
  5347         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5348         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5349
  5350         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5351         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5352
  5353         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5354         16  CF-AR-LAST-EL860-DT            PIC XX.
  5355         16  CF-MP-MONTH-END-DT             PIC XX.
  5356
  5357         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5358         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5359             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5360
  5361         16  CF-AR-MONTH-END-DT             PIC XX.
  5362
  5363         16  CF-CRDTCRD-USER                PIC X.
  5364             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5365             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5366
  5367         16  CF-CC-MONTH-END-DT             PIC XX.
  5368
  5369         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5370
  5371         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5372             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5373             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5374             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5375         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5376         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5377         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 100
* EL050.cbl
  5378         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5379             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5380             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5381         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5382         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5383         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5384             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5385         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5386
  5387         16  CF-CL-ZIP-CODE.
  5388             20  CF-CL-ZIP-PRIME.
  5389                 24  CF-CL-ZIP-1ST          PIC X.
  5390                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5391                 24  FILLER                 PIC X(4).
  5392             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5393         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5394             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5395             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5396             20  FILLER                     PIC XXX.
  5397
  5398         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5399         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5400         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5401         16  CF-CO-OPTION-START-DATE        PIC XX.
  5402         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5403           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5404                                                      '3' '4'.
  5405           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5406           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5407           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5408           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5409           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5410           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5411
  5412         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5413
  5414         16  CF-PAYMENT-APPROVAL-LEVELS.
  5415             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5416             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5417             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5418             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5419             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5420             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5421
  5422         16  CF-END-USER-REPORTING-USER     PIC X.
  5423             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5424             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5425
  5426         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5427             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5428             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5429
  5430         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5431
  5432         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5433         16  FILLER                         PIC X.
  5434
  5435         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 101
* EL050.cbl
  5436             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5437             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5438             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5439
  5440         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5441
  5442         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5443             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5444             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5445
  5446         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5447             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5448             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5449
  5450         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5451
  5452         16  CF-CO-ACH-ID-CODE              PIC  X.
  5453             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5454             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5455             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5456         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5457         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5458         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5459         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5460         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5461         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5462         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5463         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5464         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5465                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5466         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5467                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5468
  5469         16  CF-CO-OVER-SHORT.
  5470             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5471             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5472
  5473*         16  FILLER                         PIC X(102).
  5474         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5475             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5476             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5477
  5478         16  CF-AH-APPROVAL-DAYS.
  5479             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5480             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5481             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5482             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5483
  5484         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5485
  5486         16  CF-APPROV-LEV-5.
  5487             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5488             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5489             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5490
  5491         16  FILLER                         PIC X(68).
  5492****************************************************************
  5493*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 102
* EL050.cbl
  5494****************************************************************
  5495
  5496     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5497         16  CF-PROCESSOR-NAME              PIC X(30).
  5498         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5499         16  CF-PROCESSOR-TITLE             PIC X(26).
  5500         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5501                 88  MESSAGE-YES                VALUE 'Y'.
  5502                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5503
  5504*****************************************************
  5505****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5506****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5507****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5508****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5509*****************************************************
  5510
  5511         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5512             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5513             20  CF-APPLICATION-FORCE       PIC X.
  5514             20  CF-INDIVIDUAL-APP.
  5515                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5516                     28  CF-BROWSE-APP      PIC X.
  5517                     28  CF-UPDATE-APP      PIC X.
  5518
  5519         16  CF-CURRENT-TERM-ON             PIC X(4).
  5520         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5521             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5522             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5523             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5524             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5525             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5526             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5527             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5528         16  CF-PROCESSOR-CARRIER           PIC X.
  5529             88  NO-CARRIER-SECURITY            VALUE ' '.
  5530         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5531             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5532         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5533             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5534         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5535             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5536
  5537         16  CF-PROC-SYS-ACCESS-SW.
  5538             20  CF-PROC-CREDIT-CLAIMS-SW.
  5539                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5540                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5541                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5542                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5543             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5544                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5545                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5546             20  CF-PROC-LIFE-GNRLDGR-SW.
  5547                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5548                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5549                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5550                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5551             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 103
* EL050.cbl
  5552                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5553                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5554         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5555             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5556             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5557         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5558
  5559         16  CF-APPROVAL-LEVEL                  PIC X.
  5560             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5561             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5562             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5563             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5564             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5565
  5566         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5567
  5568         16  CF-LANGUAGE-TYPE                   PIC X.
  5569             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5570             88  CF-LANG-IS-FR                      VALUE 'F'.
  5571
  5572         16  CF-CSR-IND                         PIC X.
  5573         16  FILLER                             PIC X(239).
  5574
  5575****************************************************************
  5576*             PROCESSOR/REMINDERS RECORD                       *
  5577****************************************************************
  5578
  5579     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5580         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5581             20  CF-START-REMIND-DT         PIC XX.
  5582             20  CF-END-REMIND-DT           PIC XX.
  5583             20  CF-REMINDER-TEXT           PIC X(50).
  5584         16  FILLER                         PIC X(296).
  5585
  5586
  5587****************************************************************
  5588*             STATE MASTER RECORD                              *
  5589****************************************************************
  5590
  5591     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5592         16  CF-STATE-ABBREVIATION          PIC XX.
  5593         16  CF-STATE-NAME                  PIC X(25).
  5594         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5595         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5596             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5597             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5598             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5599             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5600                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5601                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5602             20  CF-ST-PREM-REJECT-SW       PIC X.
  5603                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5604                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5605             20  CF-ST-REF-REJECT-SW        PIC X.
  5606                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5607                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5608         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5609         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 104
* EL050.cbl
  5610         16  CF-ST-REFUND-RULES.
  5611             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5612             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5613             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5614         16  CF-ST-FST-PMT-EXTENSION.
  5615             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5616             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5617                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5618                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5619                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5620                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5621         16  CF-ST-STATE-CALL.
  5622             20  CF-ST-CALL-UNEARNED        PIC X.
  5623             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5624             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5625         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5626             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5627             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5628         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5629         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5630         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5631         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5632         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5633         16  FILLER                         PIC X.
  5634         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5635             20  CF-ST-BENEFIT-CD           PIC XX.
  5636             20  CF-ST-BENEFIT-KIND         PIC X.
  5637                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5638                 88  CF-ST-AH-KIND              VALUE 'A'.
  5639             20  CF-ST-REM-TERM-CALC        PIC X.
  5640                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5641                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5642                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5643                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5644                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5645                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5646                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5647                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5648
  5649             20  CF-ST-REFUND-CALC          PIC X.
  5650                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5651                 88  ST-REFD-BY-R78             VALUE '1'.
  5652                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5653                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5654                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5655                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5656                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5657                 88  ST-REFD-UTAH               VALUE '7'.
  5658                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5659                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5660                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5661
  5662             20  CF-ST-EARNING-CALC         PIC X.
  5663                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5664                 88  ST-EARN-BY-R78             VALUE '1'.
  5665                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5666                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5667                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 105
* EL050.cbl
  5668                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5669                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5670                 88  ST-EARN-MEAN               VALUE '8'.
  5671                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5672
  5673             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5674                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5675                 88  ST-OVRD-BY-R78             VALUE '1'.
  5676                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5677                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5678                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5679                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5680                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5681                 88  ST-OVRD-MEAN               VALUE '8'.
  5682                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5683             20  cf-st-extra-periods        pic 9.
  5684*            20  FILLER                     PIC X.
  5685
  5686         16  CF-ST-COMMISSION-CAPS.
  5687             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5688             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5689             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5690             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5691         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5692                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5693
  5694         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5695
  5696         16  CF-ST-STATUTORY-INTEREST.
  5697             20  CF-ST-STAT-DATE-FROM       PIC X.
  5698                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5699                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5700             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5701             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5702             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5703             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5704             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5705
  5706         16  CF-ST-OVER-SHORT.
  5707             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5708             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5709
  5710         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5711
  5712         16  CF-ST-RT-CALC                  PIC X.
  5713
  5714         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5715         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5716         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5717         16  CF-ST-RF-LR-CALC               PIC X.
  5718         16  CF-ST-RF-LL-CALC               PIC X.
  5719         16  CF-ST-RF-LN-CALC               PIC X.
  5720         16  CF-ST-RF-AH-CALC               PIC X.
  5721         16  CF-ST-RF-CP-CALC               PIC X.
  5722*        16  FILLER                         PIC X(206).
  5723*CIDMOD         16  FILLER                         PIC X(192).
  5724         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5725             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 106
* EL050.cbl
  5726         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5727         16  CF-ST-VFY-2ND-BENE             PIC X.
  5728         16  CF-ST-CAUSAL-STATE             PIC X.
  5729         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5730         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  5731         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5732             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5733         16  CF-ST-NET-ONLY-STATE           PIC X.
  5734             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5735         16  FILLER                         PIC X(181).
  5736
  5737****************************************************************
  5738*             BENEFIT MASTER RECORD                            *
  5739****************************************************************
  5740
  5741     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5742         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5743             20  CF-BENEFIT-CODE            PIC XX.
  5744             20  CF-BENEFIT-NUMERIC  REDEFINES
  5745                 CF-BENEFIT-CODE            PIC XX.
  5746             20  CF-BENEFIT-ALPHA           PIC XXX.
  5747             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5748             20  CF-BENEFIT-COMMENT         PIC X(10).
  5749
  5750             20  CF-LF-COVERAGE-TYPE        PIC X.
  5751                 88  CF-REDUCING                VALUE 'R'.
  5752                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5753
  5754             20  CF-SPECIAL-CALC-CD         PIC X.
  5755                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5756                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5757                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5758                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5759                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5760                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5761                 88  CF-FARM-PLAN               VALUE 'F'.
  5762                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5763                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5764                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5765                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5766                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5767                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5768                 88  CF-PRUDENTIAL              VALUE 'P'.
  5769                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5770                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5771                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5772                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5773                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5774                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5775
  5776             20  CF-JOINT-INDICATOR         PIC X.
  5777                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5778
  5779*            20  FILLER                     PIC X(12).
  5780             20  cf-maximum-benefits        pic s999 comp-3.
  5781             20  FILLER                     PIC X(09).
  5782             20  CF-BENEFIT-CATEGORY        PIC X.
  5783             20  CF-LOAN-TYPE               PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 107
* EL050.cbl
  5784
  5785             20  CF-CO-REM-TERM-CALC        PIC X.
  5786                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5787                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5788                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5789                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5790                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5791
  5792             20  CF-CO-EARNINGS-CALC        PIC X.
  5793                 88  CO-EARN-BY-R78             VALUE '1'.
  5794                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5795                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5796                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5797                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5798                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5799                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5800                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5801
  5802             20  CF-CO-REFUND-CALC          PIC X.
  5803                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5804                 88  CO-REFD-BY-R78             VALUE '1'.
  5805                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5806                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5807                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5808                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5809                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5810                 88  CO-REFD-MEAN               VALUE '8'.
  5811                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5812                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5813                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5814
  5815             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5816                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5817                 88  CO-OVRD-BY-R78             VALUE '1'.
  5818                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5819                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5820                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5821                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5822                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5823                 88  CO-OVRD-MEAN               VALUE '8'.
  5824                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5825
  5826             20  CF-CO-BEN-I-G-CD           PIC X.
  5827                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5828                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5829                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5830
  5831         16  FILLER                         PIC X(304).
  5832
  5833
  5834****************************************************************
  5835*             CARRIER MASTER RECORD                            *
  5836****************************************************************
  5837
  5838     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5839         16  CF-ADDRESS-DATA.
  5840             20  CF-MAIL-TO-NAME            PIC X(30).
  5841             20  CF-IN-CARE-OF              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 108
* EL050.cbl
  5842             20  CF-ADDRESS-LINE-1          PIC X(30).
  5843             20  CF-ADDRESS-LINE-2          PIC X(30).
  5844             20  CF-CITY-STATE              PIC X(30).
  5845             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5846             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5847
  5848         16  CF-CLAIM-NO-CONTROL.
  5849             20  CF-CLAIM-NO-METHOD         PIC X.
  5850                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5851                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5852                 88  CLAIM-NO-SEQ               VALUE '3'.
  5853                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5854             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5855                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5856                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5857                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5858
  5859         16  CF-CHECK-NO-CONTROL.
  5860             20  CF-CHECK-NO-METHOD         PIC X.
  5861                 88  CHECK-NO-MANUAL            VALUE '1'.
  5862                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5863                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5864                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5865             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5866                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5867
  5868         16  CF-DOMICILE-STATE              PIC XX.
  5869
  5870         16  CF-EXPENSE-CONTROLS.
  5871             20  CF-EXPENSE-METHOD          PIC X.
  5872                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5873                 88  DOLLARS-PER-PMT            VALUE '2'.
  5874                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5875                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5876             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5877             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5878
  5879         16  CF-CORRESPONDENCE-CONTROL.
  5880             20  CF-LETTER-RESEND-OPT       PIC X.
  5881                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5882                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5883             20  FILLER                     PIC X(4).
  5884
  5885         16  CF-RESERVE-CONTROLS.
  5886             20  CF-MANUAL-SW               PIC X.
  5887                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5888             20  CF-FUTURE-SW               PIC X.
  5889                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5890             20  CF-PTC-SW                  PIC X.
  5891                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5892             20  CF-IBNR-SW                 PIC X.
  5893                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5894             20  CF-PTC-LF-SW               PIC X.
  5895                 88  CF-LF-PTC-USED             VALUE '1'.
  5896             20  CF-CDT-ACCESS-METHOD       PIC X.
  5897                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5898                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5899                 88  CF-CDT-INTERPOLATED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 109
* EL050.cbl
  5900             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5901
  5902         16  CF-CLAIM-CALC-METHOD           PIC X.
  5903             88  360-PLUS-MONTHS                VALUE '1'.
  5904             88  365-PLUS-MONTHS                VALUE '2'.
  5905             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5906             88  360-DAILY                      VALUE '4'.
  5907             88  365-DAILY                      VALUE '5'.
  5908
  5909         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5910         16  FILLER                         PIC X(11).
  5911
  5912         16  CF-LIMIT-AMOUNTS.
  5913             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5914             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5915             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5916             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5917             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5918             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5919             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5920             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5921             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5922             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5923
  5924         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5925         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5926         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5927
  5928         16  CF-ZIP-CODE.
  5929             20  CF-ZIP-PRIME.
  5930                 24  CF-ZIP-1ST             PIC X.
  5931                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5932                 24  FILLER                 PIC X(4).
  5933             20  CF-ZIP-PLUS4               PIC X(4).
  5934         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5935             20  CF-CAN-POSTAL-1            PIC XXX.
  5936             20  CF-CAN-POSTAL-2            PIC XXX.
  5937             20  FILLER                     PIC XXX.
  5938
  5939         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5940         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5941         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5942
  5943         16  CF-RATING-SWITCH               PIC X.
  5944             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5945             88  CF-NO-RATING                   VALUE 'N'.
  5946
  5947         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5948
  5949         16  CF-CARRIER-OVER-SHORT.
  5950             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5951             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5952
  5953         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5954         16  CF-SECPAY-SWITCH               PIC X.
  5955             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5956             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5957         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 110
* EL050.cbl
  5958         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5959         16  FILLER                         PIC X(444).
  5960*        16  FILLER                         PIC X(452).
  5961
  5962
  5963****************************************************************
  5964*             MORTALITY MASTER RECORD                          *
  5965****************************************************************
  5966
  5967     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5968         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5969                                INDEXED BY CF-MORT-NDX.
  5970             20  CF-MORT-TABLE              PIC X(5).
  5971             20  CF-MORT-TABLE-TYPE         PIC X.
  5972                 88  CF-MORT-JOINT              VALUE 'J'.
  5973                 88  CF-MORT-SINGLE             VALUE 'S'.
  5974                 88  CF-MORT-COMBINED           VALUE 'C'.
  5975                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5976                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5977             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5978             20  CF-MORT-AGE-METHOD         PIC XX.
  5979                 88  CF-AGE-LAST                VALUE 'AL'.
  5980                 88  CF-AGE-NEAR                VALUE 'AN'.
  5981             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5982             20  CF-MORT-ADJUSTMENT-DIRECTION
  5983                                            PIC X.
  5984                 88  CF-MINUS                   VALUE '-'.
  5985                 88  CF-PLUS                    VALUE '+'.
  5986             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5987             20  CF-MORT-JOINT-CODE         PIC X.
  5988                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5989             20  CF-MORT-PC-Q               PIC X.
  5990                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5991             20  CF-MORT-TABLE-CODE         PIC X(4).
  5992             20  CF-MORT-COMMENTS           PIC X(15).
  5993             20  FILLER                     PIC X(14).
  5994
  5995         16  FILLER                         PIC X(251).
  5996
  5997
  5998****************************************************************
  5999*             BUSSINESS TYPE MASTER RECORD                     *
  6000****************************************************************
  6001
  6002     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6003* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  6004* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  6005* AND RECORD 05 IS TYPES 81-99
  6006         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  6007             20  CF-BUSINESS-TITLE          PIC  X(19).
  6008             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  6009                                            PIC S9V9(4) COMP-3.
  6010             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  6011             20  FILLER                     PIC  X.
  6012         16  FILLER                         PIC  X(248).
  6013
  6014
  6015****************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 111
* EL050.cbl
  6016*             TERMINAL MASTER RECORD                           *
  6017****************************************************************
  6018
  6019     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6020
  6021         16  CF-COMPANY-TERMINALS.
  6022             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  6023                                  PIC X(4).
  6024         16  FILLER               PIC X(248).
  6025
  6026
  6027****************************************************************
  6028*             LIFE EDIT MASTER RECORD                          *
  6029****************************************************************
  6030
  6031     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6032         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  6033             20  CF-LIFE-CODE-IN            PIC XX.
  6034             20  CF-LIFE-CODE-OUT           PIC XX.
  6035         16  FILLER                         PIC X(248).
  6036
  6037
  6038****************************************************************
  6039*             AH EDIT MASTER RECORD                            *
  6040****************************************************************
  6041
  6042     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6043         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  6044             20  CF-AH-CODE-IN              PIC XXX.
  6045             20  CF-AH-CODE-OUT             PIC XX.
  6046         16  FILLER                         PIC X(248).
  6047
  6048
  6049****************************************************************
  6050*             CREDIBILITY TABLES                               *
  6051****************************************************************
  6052
  6053     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6054         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  6055                             INDEXED BY CF-CRDB-NDX.
  6056             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  6057             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  6058             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  6059         16  FILLER                         PIC  X(332).
  6060
  6061
  6062****************************************************************
  6063*             REPORT CUSTOMIZATION RECORD                      *
  6064****************************************************************
  6065
  6066     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6067         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6068             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6069             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6070             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6071**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6072****       A T-TRANSFER.                                   ****
  6073             88  CF-ALL-ACCOUNTS                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 112
* EL050.cbl
  6074
  6075         16  FILLER                         PIC XX.
  6076
  6077         16  CF-CARRIER-CNTL-OPT.
  6078             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6079                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6080                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  6081             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6082                                            PIC X.
  6083         16  CF-GROUP-CNTL-OPT.
  6084             20  CF-GROUP-OPT-SEQ           PIC 9.
  6085                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6086                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6087             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6088                                            PIC X(6).
  6089         16  CF-STATE-CNTL-OPT.
  6090             20  CF-STATE-OPT-SEQ           PIC 9.
  6091                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6092                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6093             20  CF-STATE-SELECT OCCURS 3 TIMES
  6094                                            PIC XX.
  6095         16  CF-ACCOUNT-CNTL-OPT.
  6096             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6097                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6098                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6099             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6100                                            PIC X(10).
  6101         16  CF-BUS-TYP-CNTL-OPT.
  6102             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6103                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6104                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6105             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6106                                            PIC XX.
  6107         16  CF-LF-TYP-CNTL-OPT.
  6108             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6109                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6110                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6111             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6112                                            PIC XX.
  6113         16  CF-AH-TYP-CNTL-OPT.
  6114             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6115                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6116                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6117             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  6118                                            PIC XX.
  6119         16  CF-REPTCD1-CNTL-OPT.
  6120             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6121                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6122                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6123             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6124                                            PIC X(10).
  6125         16  CF-REPTCD2-CNTL-OPT.
  6126             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6127                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6128                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6129             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6130                                            PIC X(10).
  6131         16  CF-USER1-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 113
* EL050.cbl
  6132             20  CF-USER1-OPT-SEQ           PIC 9.
  6133                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6134                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6135             20  CF-USER1-SELECT OCCURS 3 TIMES
  6136                                            PIC X(10).
  6137         16  CF-USER2-CNTL-OPT.
  6138             20  CF-USER2-OPT-SEQ           PIC 9.
  6139                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6140                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6141             20  CF-USER2-SELECT OCCURS 3 TIMES
  6142                                            PIC X(10).
  6143         16  CF-USER3-CNTL-OPT.
  6144             20  CF-USER3-OPT-SEQ           PIC 9.
  6145                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6146                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6147             20  CF-USER3-SELECT OCCURS 3 TIMES
  6148                                            PIC X(10).
  6149         16  CF-USER4-CNTL-OPT.
  6150             20  CF-USER4-OPT-SEQ           PIC 9.
  6151                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6152                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6153             20  CF-USER4-SELECT OCCURS 3 TIMES
  6154                                            PIC X(10).
  6155         16  CF-USER5-CNTL-OPT.
  6156             20  CF-USER5-OPT-SEQ           PIC 9.
  6157                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6158                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6159             20  CF-USER5-SELECT OCCURS 3 TIMES
  6160                                            PIC X(10).
  6161         16  CF-REINS-CNTL-OPT.
  6162             20  CF-REINS-OPT-SEQ           PIC 9.
  6163                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6164                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6165             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6166                 24  CF-REINS-PRIME         PIC XXX.
  6167                 24  CF-REINS-SUB           PIC XXX.
  6168
  6169         16  CF-AGENT-CNTL-OPT.
  6170             20  CF-AGENT-OPT-SEQ           PIC 9.
  6171                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6172                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6173             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6174                                            PIC X(10).
  6175
  6176         16  FILLER                         PIC X(43).
  6177
  6178         16  CF-LOSS-RATIO-SELECT.
  6179             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6180             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6181         16  CF-ENTRY-DATE-SELECT.
  6182             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6183             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6184         16  CF-EFFECTIVE-DATE-SELECT.
  6185             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6186             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6187
  6188         16  CF-EXCEPTION-LIST-IND          PIC X.
  6189             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 114
* EL050.cbl
  6190
  6191         16  FILLER                         PIC X(318).
  6192
  6193****************************************************************
  6194*                  EXCEPTION REPORTING RECORD                  *
  6195****************************************************************
  6196
  6197     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6198         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6199             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6200
  6201         16  CF-COMBINED-LIFE-AH-OPT.
  6202             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6203             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6204             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6205             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6206
  6207         16  CF-LIFE-OPT.
  6208             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6209             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6210             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6211             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6212             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6213             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6214             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6215             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6216             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6217             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6218
  6219         16  CF-AH-OPT.
  6220             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6221             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6222             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6223             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6224             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6225             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6226             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6227             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6228             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6229             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6230
  6231         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6232             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6233             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6234             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6235
  6236         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6237
  6238         16  FILLER                         PIC X(673).
  6239
  6240
  6241****************************************************************
  6242*             MORTGAGE SYSTEM PLAN RECORD                      *
  6243****************************************************************
  6244
  6245     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6246         16  CF-PLAN-TYPE                   PIC X.
  6247             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 115
* EL050.cbl
  6248             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6249             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6250         16  CF-PLAN-ABBREV                 PIC XXX.
  6251         16  CF-PLAN-DESCRIPT               PIC X(10).
  6252         16  CF-PLAN-NOTES                  PIC X(20).
  6253         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6254         16  CF-PLAN-UNDERWRITING.
  6255             20  CF-PLAN-TERM-DATA.
  6256                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6257                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6258             20  CF-PLAN-AGE-DATA.
  6259                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6260                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6261                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6262             20  CF-PLAN-BENEFIT-DATA.
  6263                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6264                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6265                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6266                                            PIC S9(7)V99  COMP-3.
  6267         16  CF-PLAN-POLICY-FORMS.
  6268             20  CF-POLICY-FORM             PIC X(12).
  6269             20  CF-MASTER-APPLICATION      PIC X(12).
  6270             20  CF-MASTER-POLICY           PIC X(12).
  6271         16  CF-PLAN-RATING.
  6272             20  CF-RATE-CODE               PIC X(5).
  6273             20  CF-SEX-RATING              PIC X.
  6274                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6275                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6276             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6277             20  CF-SUB-STD-TYPE            PIC X.
  6278                 88  CF-PCT-OF-PREM            VALUE '1'.
  6279                 88  CF-PCT-OF-BENE            VALUE '2'.
  6280         16  CF-PLAN-PREM-TOLERANCES.
  6281             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6282             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6283         16  CF-PLAN-PYMT-TOLERANCES.
  6284             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6285             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6286         16  CF-PLAN-MISC-DATA.
  6287             20  FILLER                     PIC X.
  6288             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6289             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6290         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6291         16  CF-PLAN-IND-GRP                PIC X.
  6292             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6293                                                     '1'.
  6294             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6295                                                     '2'.
  6296         16  CF-MIB-SEARCH-SW               PIC X.
  6297             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6298             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6299             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6300             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6301         16  CF-ALPHA-SEARCH-SW             PIC X.
  6302             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6303             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6304             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6305             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 116
* EL050.cbl
  6306             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6307             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6308             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6309             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6310             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6311             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6312                                                     'A' 'B' 'C'
  6313                                                     'X' 'Y' 'Z'.
  6314         16  CF-EFF-DT-RULE-SW              PIC X.
  6315             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6316             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6317             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6318             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6319             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6320         16  FILLER                         PIC X(4).
  6321         16  CF-HEALTH-QUESTIONS            PIC X.
  6322             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6323         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6324         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6325         16  CF-PLAN-SNGL-JNT               PIC X.
  6326             88  CF-COMBINED-PLAN              VALUE 'C'.
  6327             88  CF-JNT-PLAN                   VALUE 'J'.
  6328             88  CF-SNGL-PLAN                  VALUE 'S'.
  6329         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6330         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6331         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6332         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6333         16  CF-RERATE-CNTL                 PIC  X.
  6334             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6335             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6336             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6337             88  CF-AUTO-RECALC                 VALUE '4'.
  6338         16  CF-BENEFIT-TYPE                PIC  X.
  6339             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6340             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6341         16  CF-POLICY-FEE                  PIC S999V99
  6342                                                    COMP-3.
  6343         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6344         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6345         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6346         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6347         16  FILLER                         PIC  X(32).
  6348         16  CF-TERMINATION-FORM            PIC  X(04).
  6349         16  FILLER                         PIC  X(08).
  6350         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6351                                                       COMP-3.
  6352         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6353         16  CF-ISSUE-LETTER                PIC  X(4).
  6354         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6355         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6356             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6357             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6358         16  CF-MP-REFUND-CALC              PIC X.
  6359             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6360             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6361             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6362             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6363             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 117
* EL050.cbl
  6364             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6365             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6366             88  CF-MP-REFD-MEAN                VALUE '8'.
  6367         16  CF-ALT-RATE-CODE               PIC  X(5).
  6368
  6369
  6370         16  FILLER                         PIC X(498).
  6371****************************************************************
  6372*             MORTGAGE COMPANY MASTER RECORD                   *
  6373****************************************************************
  6374
  6375     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6376         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6377         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6378             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6379             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6380             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6381             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6382             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6383
  6384         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6385         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6386         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6387         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6388         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6389
  6390         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6391             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6392         16  CF-MP-RECON-USE-IND            PIC X(1).
  6393             88  CF-MP-USE-RECON             VALUE 'Y'.
  6394         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6395             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6396         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6397             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6398             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6399         16  FILLER                         PIC X(1).
  6400         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6401             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6402         16  CF-MORTG-MIB-VERSION           PIC X.
  6403             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6404             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6405             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6406         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6407             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6408                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6409             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6410                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6411             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6412                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6413             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6414                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6415             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6416                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6417             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6418                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6419         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6420         16  FILLER                         PIC X(7).
  6421         16  CF-MORTG-DESTINATION-SYMBOL.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 118
* EL050.cbl
  6422             20  CF-MORTG-MIB-COMM          PIC X(5).
  6423             20  CF-MORTG-MIB-TERM          PIC X(5).
  6424         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6425             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6426         16  FILLER                         PIC X(03).
  6427         16  CF-MP-CHECK-NO-CONTROL.
  6428             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6429                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6430                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6431                                                ' ' LOW-VALUES.
  6432                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6433                                               VALUE '3'.
  6434         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6435         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6436         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6437             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6438                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6439             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6440                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6441             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6442                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6443             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6444                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6445             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6446                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6447             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6448                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6449         16  CF-MORTG-BILLING-AREA.
  6450             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6451                                            PIC X.
  6452         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6453         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6454         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6455         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6456             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6457             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6458         16  FILLER                         PIC X.
  6459         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6460             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6461             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6462         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6463         16  FILLER                         PIC X(8).
  6464         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6465         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6466         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6467         16  CF-ACH-COMPANY-ID.
  6468             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6469                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6470                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6471                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6472             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6473         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6474             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6475         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6476             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6477             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6478         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6479         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 119
* EL050.cbl
  6480         16  FILLER                         PIC X(536).
  6481
  6482****************************************************************
  6483*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6484****************************************************************
  6485
  6486     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6487         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6488             20  CF-FEMALE-HEIGHT.
  6489                 24  CF-FEMALE-FT           PIC 99.
  6490                 24  CF-FEMALE-IN           PIC 99.
  6491             20  CF-FEMALE-MIN-WT           PIC 999.
  6492             20  CF-FEMALE-MAX-WT           PIC 999.
  6493         16  FILLER                         PIC X(428).
  6494
  6495     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6496         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6497             20  CF-MALE-HEIGHT.
  6498                 24  CF-MALE-FT             PIC 99.
  6499                 24  CF-MALE-IN             PIC 99.
  6500             20  CF-MALE-MIN-WT             PIC 999.
  6501             20  CF-MALE-MAX-WT             PIC 999.
  6502         16  FILLER                         PIC X(428).
  6503******************************************************************
  6504*             AUTOMATIC ACTIVITY RECORD                          *
  6505******************************************************************
  6506     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6507         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6508             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6509             20  CF-SYS-LETTER-ID           PIC X(04).
  6510             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6511             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6512             20  CF-SYS-RESET-SW            PIC X(01).
  6513             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6514             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6515
  6516         16  FILLER                         PIC X(50).
  6517
  6518         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6519             20  CF-USER-ACTIVE-SW          PIC X(01).
  6520             20  CF-USER-LETTER-ID          PIC X(04).
  6521             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6522             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6523             20  CF-USER-RESET-SW           PIC X(01).
  6524             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6525             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6526             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6527
  6528         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 120
* EL050.cbl
  6530*    COPY ERCACCT.
  6531******************************************************************
  6532*                                                                *
  6533*                                                                *
  6534*                            ERCACCT                             *
  6535*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6536*                            VMOD=2.031                          *
  6537*                                                                *
  6538*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6539*                                                                *
  6540*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6541*   VSAM ACCOUNT MASTER FILES.                                   *
  6542*                                                                *
  6543*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6544*                                                                *
  6545*   FILE TYPE = VSAM,KSDS                                        *
  6546*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6547*                                                                *
  6548*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6549*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6550*                                                                *
  6551*   LOG = NO                                                     *
  6552*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6553*                                                                *
  6554*                                                                *
  6555******************************************************************
  6556*                   C H A N G E   L O G
  6557*
  6558* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6559*-----------------------------------------------------------------
  6560*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6561* EFFECTIVE    NUMBER
  6562*-----------------------------------------------------------------
  6563* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6564* 092705    2005050300006  PEMA  ADD SPP LEASES
  6565* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6566* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6567* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6568* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6569* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6570* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6571******************************************************************
  6572
  6573 01  ACCOUNT-MASTER.
  6574     12  AM-RECORD-ID                      PIC XX.
  6575         88  VALID-AM-ID                      VALUE 'AM'.
  6576
  6577     12  AM-CONTROL-PRIMARY.
  6578         16  AM-COMPANY-CD                 PIC X.
  6579         16  AM-MSTR-CNTRL.
  6580             20  AM-CONTROL-A.
  6581                 24  AM-CARRIER            PIC X.
  6582                 24  AM-GROUPING.
  6583                     28 AM-GROUPING-PREFIX PIC XXX.
  6584                     28 AM-GROUPING-PRIME  PIC XXX.
  6585                 24  AM-STATE              PIC XX.
  6586                 24  AM-ACCOUNT.
  6587                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 121
* EL050.cbl
  6588                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6589             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6590                                           PIC X(19).
  6591             20  AM-CNTRL-B.
  6592                 24  AM-EXPIRATION-DT      PIC XX.
  6593                 24  FILLER                PIC X(4).
  6594             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6595                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6596
  6597     12  AM-CONTROL-BY-VAR-GRP.
  6598         16  AM-COMPANY-CD-A1              PIC X.
  6599         16  AM-VG-CARRIER                 PIC X.
  6600         16  AM-VG-GROUPING                PIC X(6).
  6601         16  AM-VG-STATE                   PIC XX.
  6602         16  AM-VG-ACCOUNT                 PIC X(10).
  6603         16  AM-VG-DATE.
  6604             20  AM-VG-EXPIRATION-DT       PIC XX.
  6605             20  FILLER                    PIC X(4).
  6606         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6607                                           PIC 9(11)      COMP-3.
  6608     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6609         16  FILLER                        PIC X(10).
  6610         16  AM-VG-KEY3.
  6611             20  AM-VG3-ACCOUNT            PIC X(10).
  6612             20  AM-VG3-EXP-DT             PIC XX.
  6613         16  FILLER                        PIC X(4).
  6614     12  AM-MAINT-INFORMATION.
  6615         16  AM-LAST-MAINT-DT              PIC XX.
  6616         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6617         16  AM-LAST-MAINT-USER            PIC X(4).
  6618         16  FILLER                        PIC XX.
  6619
  6620     12  AM-EFFECTIVE-DT                   PIC XX.
  6621     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6622
  6623     12  AM-PREV-DATES  COMP-3.
  6624         16  AM-PREV-EXP-DT                PIC 9(11).
  6625         16  AM-PREV-EFF-DT                PIC 9(11).
  6626
  6627     12  AM-REPORT-CODE-1                  PIC X(10).
  6628     12  AM-REPORT-CODE-2                  PIC X(10).
  6629
  6630     12  AM-CITY-CODE                      PIC X(4).
  6631     12  AM-COUNTY-PARISH                  PIC X(6).
  6632
  6633     12  AM-NAME                           PIC X(30).
  6634     12  AM-PERSON                         PIC X(30).
  6635     12  AM-ADDRS                          PIC X(30).
  6636     12  AM-CITY.
  6637         16  AM-ADDR-CITY                  PIC X(28).
  6638         16  AM-ADDR-STATE                 PIC XX.
  6639     12  AM-ZIP.
  6640         16  AM-ZIP-PRIME.
  6641             20  AM-ZIP-PRI-1ST            PIC X.
  6642                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6643             20  FILLER                    PIC X(4).
  6644         16  AM-ZIP-PLUS4                  PIC X(4).
  6645     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 122
* EL050.cbl
  6646         16  AM-CAN-POSTAL-1               PIC XXX.
  6647         16  AM-CAN-POSTAL-2               PIC XXX.
  6648         16  FILLER                        PIC XXX.
  6649     12  AM-TEL-NO.
  6650         16  AM-AREA-CODE                  PIC 999.
  6651         16  AM-TEL-PRE                    PIC 999.
  6652         16  AM-TEL-NBR                    PIC 9(4).
  6653     12  AM-TEL-LOC                        PIC X.
  6654         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6655         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6656
  6657     12  AM-COMM-STRUCTURE.
  6658         16  AM-DEFN-1.
  6659             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6660                 24  AM-AGT.
  6661                     28  AM-AGT-PREFIX     PIC X(4).
  6662                     28  AM-AGT-PRIME      PIC X(6).
  6663                 24  AM-COM-TYP            PIC X.
  6664                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6665                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6666                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6667                 24  AM-RECALC-LV-INDIC    PIC X.
  6668                 24  AM-RETRO-LV-INDIC     PIC X.
  6669                 24  AM-GL-CODES           PIC X.
  6670                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6671                 24  FILLER                PIC X(01).
  6672         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6673             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6674                 24  FILLER                PIC X(11).
  6675                 24  AM-L-COMA             PIC XXX.
  6676                 24  AM-J-COMA             PIC XXX.
  6677                 24  AM-A-COMA             PIC XXX.
  6678                 24  FILLER                PIC X(6).
  6679
  6680     12  AM-COMM-CHANGE-STATUS             PIC X.
  6681         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6682
  6683     12  AM-CSR-CODE                       PIC X(4).
  6684
  6685     12  AM-BILLING-STATUS                 PIC X.
  6686         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6687         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6688     12  AM-AUTO-REFUND-SW                 PIC X.
  6689         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6690         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6691     12  AM-GPCD                           PIC 99.
  6692     12  AM-IG                             PIC X.
  6693         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6694         88  AM-HAS-GROUP                     VALUE '2'.
  6695     12  AM-STATUS                         PIC X.
  6696         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6697         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6698         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6699         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6700         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6701         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6702         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6703         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 123
* EL050.cbl
  6704         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6705         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6706     12  AM-REMIT-TO                       PIC 99.
  6707     12  AM-ID-NO                          PIC X(11).
  6708
  6709     12  AM-CAL-TABLE                      PIC XX.
  6710     12  AM-LF-DEVIATION                   PIC XXX.
  6711     12  AM-AH-DEVIATION                   PIC XXX.
  6712     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6713     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6714     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6715     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6716     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6717     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6718
  6719     12  AM-USER-FIELDS.
  6720         16  AM-FLD-1                      PIC XX.
  6721         16  AM-FLD-2                      PIC XX.
  6722         16  AM-FLD-3                      PIC XX.
  6723         16  AM-FLD-4                      PIC XX.
  6724         16  AM-FLD-5                      PIC XX.
  6725
  6726     12  AM-1ST-PROD-DATE.
  6727         16  AM-1ST-PROD-YR                PIC XX.
  6728         16  AM-1ST-PROD-MO                PIC XX.
  6729         16  AM-1ST-PROD-DA                PIC XX.
  6730     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6731     12  AM-CERTS-PURGED-DATE.
  6732         16  AM-PUR-YR                     PIC XX.
  6733         16  AM-PUR-MO                     PIC XX.
  6734         16  AM-PUR-DA                     PIC XX.
  6735     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6736     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6737     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6738     12  AM-INACTIVE-DATE.
  6739         16  AM-INA-MO                     PIC 99.
  6740         16  AM-INA-DA                     PIC 99.
  6741         16  AM-INA-YR                     PIC 99.
  6742     12  AM-AR-HI-CERT-DATE                PIC XX.
  6743
  6744     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6745     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6746
  6747     12  AM-OB-PAYMENT-MODE                PIC X.
  6748         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6749         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6750         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6751         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6752
  6753     12  AM-AH-ONLY-INDICATOR              PIC X.
  6754         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6755         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6756
  6757     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6758
  6759     12  AM-OVER-SHORT.
  6760         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6761         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 124
* EL050.cbl
  6762
  6763     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6764     12  AM-DCC-CLP-STATE                  PIC XX.
  6765
  6766     12  AM-RECALC-COMM                    PIC X.
  6767     12  AM-RECALC-REIN                    PIC X.
  6768
  6769     12  AM-REI-TABLE                      PIC XXX.
  6770     12  AM-REI-ET-LF                      PIC X.
  6771     12  AM-REI-ET-AH                      PIC X.
  6772     12  AM-REI-PE-LF                      PIC X.
  6773     12  AM-REI-PE-AH                      PIC X.
  6774     12  AM-REI-PRT-ST                     PIC X.
  6775     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6776     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6777     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6778     12  AM-REI-GROUP-A                    PIC X(6).
  6779     12  AM-REI-MORT                       PIC X(4).
  6780     12  AM-REI-PRT-OW                     PIC X.
  6781     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6782     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6783     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6784     12  AM-REI-GROUP-B                    PIC X(6).
  6785
  6786     12  AM-TRUST-TYPE                     PIC X(2).
  6787
  6788     12  AM-EMPLOYER-STMT-USED             PIC X.
  6789     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6790
  6791     12  AM-STD-AH-TYPE                    PIC XX.
  6792     12  AM-EARN-METHODS.
  6793         16  AM-EARN-METHOD-R              PIC X.
  6794             88 AM-REF-RL-R78                 VALUE 'R'.
  6795             88 AM-REF-RL-PR                  VALUE 'P'.
  6796             88 AM-REF-RL-MEAN                VALUE 'M'.
  6797             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6798         16  AM-EARN-METHOD-L              PIC X.
  6799             88 AM-REF-LL-R78                 VALUE 'R'.
  6800             88 AM-REF-LL-PR                  VALUE 'P'.
  6801             88 AM-REF-LL-MEAN                VALUE 'M'.
  6802             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6803         16  AM-EARN-METHOD-A              PIC X.
  6804             88 AM-REF-AH-R78                 VALUE 'R'.
  6805             88 AM-REF-AH-PR                  VALUE 'P'.
  6806             88 AM-REF-AH-MEAN                VALUE 'M'.
  6807             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6808             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6809             88 AM-REF-AH-NET                 VALUE 'N'.
  6810
  6811     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6812     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6813     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6814
  6815     12  AM-RET-Y-N                        PIC X.
  6816     12  AM-RET-P-E                        PIC X.
  6817     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6818     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6819     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 125
* EL050.cbl
  6820     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6821         16  AM-POOL-PRIME                 PIC XXX.
  6822         16  AM-POOL-SUB                   PIC XXX.
  6823     12  AM-RETRO-EARNINGS.
  6824         16  AM-RET-EARN-R                 PIC X.
  6825         16  AM-RET-EARN-L                 PIC X.
  6826         16  AM-RET-EARN-A                 PIC X.
  6827     12  AM-RET-ST-TAX-USE                 PIC X.
  6828         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6829         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6830     12  AM-RETRO-BEG-EARNINGS.
  6831         16  AM-RET-BEG-EARN-R             PIC X.
  6832         16  AM-RET-BEG-EARN-L             PIC X.
  6833         16  AM-RET-BEG-EARN-A             PIC X.
  6834     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6835     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6836
  6837     12  AM-USER-SELECT-OPTIONS.
  6838         16  AM-USER-SELECT-1              PIC X(10).
  6839         16  AM-USER-SELECT-2              PIC X(10).
  6840         16  AM-USER-SELECT-3              PIC X(10).
  6841         16  AM-USER-SELECT-4              PIC X(10).
  6842         16  AM-USER-SELECT-5              PIC X(10).
  6843
  6844     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6845
  6846     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6847
  6848     12  AM-RPT045A-SWITCH                 PIC X.
  6849         88  RPT045A-OFF                   VALUE 'N'.
  6850
  6851     12  AM-INSURANCE-LIMITS.
  6852         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6853         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6854
  6855     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6856         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6857
  6858     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6859         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6860         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6861
  6862     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6863
  6864     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6865     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6866     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6867     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6868     12  AM-DCC-UEF-STATE                  PIC XX.
  6869     12  FILLER                            PIC XXX.
  6870     12  AM-REPORT-CODE-3                  PIC X(10).
  6871*    12  FILLER                            PIC X(22).
  6872
  6873     12  AM-RESERVE-DATE.
  6874         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6875         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6876         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6877
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 126
* EL050.cbl
  6878     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6879     12  AM-NOTIFICATION-TYPES.
  6880         16  AM-NOTIF-OF-LETTERS           PIC X.
  6881         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6882         16  AM-NOTIF-OF-REPORTS           PIC X.
  6883         16  AM-NOTIF-OF-STATUS            PIC X.
  6884
  6885     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6886         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6887         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6888         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6889         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6890
  6891     12  AM-BENEFIT-CONTROLS.
  6892         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6893             20  AM-BENEFIT-CODE           PIC XX.
  6894             20  AM-BENEFIT-TYPE           PIC X.
  6895             20  AM-BENEFIT-REVISION       PIC XXX.
  6896             20  AM-BENEFIT-REM-TERM       PIC X.
  6897             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6898             20  FILLER                    PIC XX.
  6899         16  FILLER                        PIC X(80).
  6900
  6901     12  AM-TRANSFER-DATA.
  6902         16  AM-TRANSFERRED-FROM.
  6903             20  AM-TRNFROM-CARRIER        PIC X.
  6904             20  AM-TRNFROM-GROUPING.
  6905                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6906                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6907             20  AM-TRNFROM-STATE          PIC XX.
  6908             20  AM-TRNFROM-ACCOUNT.
  6909                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6910                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6911             20  AM-TRNFROM-DTE            PIC XX.
  6912         16  AM-TRANSFERRED-TO.
  6913             20  AM-TRNTO-CARRIER          PIC X.
  6914             20  AM-TRNTO-GROUPING.
  6915                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6916                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6917             20  AM-TRNTO-STATE            PIC XX.
  6918             20  AM-TRNTO-ACCOUNT.
  6919                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6920                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6921             20  AM-TRNTO-DTE              PIC XX.
  6922         16  FILLER                        PIC X(10).
  6923
  6924     12  AM-SAVED-REMIT-TO                 PIC 99.
  6925
  6926     12  AM-COMM-STRUCTURE-SAVED.
  6927         16  AM-DEFN-1-SAVED.
  6928             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6929                 24  AM-AGT-SV             PIC X(10).
  6930                 24  AM-COM-TYP-SV         PIC X.
  6931                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6932                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6933                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6934                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6935                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 127
* EL050.cbl
  6936                 24  AM-GL-CODES-SV        PIC X.
  6937                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6938                 24  FILLER                PIC X.
  6939         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6940             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6941                 24  FILLER                PIC X(11).
  6942                 24  AM-L-COMA-SV          PIC XXX.
  6943                 24  AM-J-COMA-SV          PIC XXX.
  6944                 24  AM-A-COMA-SV          PIC XXX.
  6945                 24  FILLER                PIC X(6).
  6946
  6947     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6948         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6949            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6950            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6951            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6952
  6953     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6954     12  FILLER                            PIC X(120).
  6955
  6956     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6957         16  AM-CONTROL-NAME               PIC X(30).
  6958         16  AM-EXECUTIVE-ONE.
  6959             20  AM-EXEC1-NAME             PIC X(15).
  6960             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6961                                                          COMP-3.
  6962             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6963                                                          COMP-3.
  6964         16  AM-EXECUTIVE-TWO.
  6965             20  AM-EXEC2-NAME             PIC X(15).
  6966             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6967                                                          COMP-3.
  6968             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6969                                                          COMP-3.
  6970
  6971     12  AM-RETRO-ADDITIONAL-DATA.
  6972         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6973         16  AM-RETRO-PREM-P-E             PIC X.
  6974         16  AM-RETRO-CLMS-P-I             PIC X.
  6975         16  AM-RETRO-RET-BRACKET-LF.
  6976             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6977                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6978                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6979             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6980                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6981                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6982             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6983                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6984                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6985         16  AM-RETRO-RET-BRACKET-AH.
  6986             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6987                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6988                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6989                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6990             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6991                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6992                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6993             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 128
* EL050.cbl
  6994                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6995                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6996
  6997     12  AM-COMMENTS.
  6998         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  6999
  7000     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  7001         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  7002         16  AM-FLI-BILLING-CODE           PIC X.
  7003         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  7004         16  AM-FLI-UNITED-IDENT           PIC X.
  7005         16  AM-FLI-INTEREST-LOST-DATA.
  7006             20  AM-FLI-BANK-NO            PIC X(5).
  7007             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  7008             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  7009             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  7010         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  7011             20  AM-FLI-AGT                PIC X(9).
  7012             20  AM-FLI-AGT-COMM-ACC       PIC X.
  7013             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  7014         16  FILLER                        PIC X(102).
  7015
  7016     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  7017         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  7018             20  AM-BENEFIT-DMD-CODE         PIC XX.
  7019             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7020             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7021             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7022             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7023         16  FILLER                          PIC X(10).
  7024******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 129
* EL050.cbl
  7026*    COPY ERCREIN.
  7027******************************************************************
  7028*                                                                *
  7029*                            ERCREIN                             *
  7030*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7031*                            VMOD=2.010                          *
  7032*                                                                *
  7033*   ONLINE CREDIT SYSTEM                                         *
  7034*                                                                *
  7035*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  7036*                                                                *
  7037*   FILE TYPE = VSAM,KSDS                                        *
  7038*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  7039*                                                                *
  7040*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  7041*       ALTERNATE PATH = NONE                                    *
  7042*                                                                *
  7043*   LOG = NO                                                     *
  7044*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7045*                                                                *
  7046******************************************************************
  7047*                   C H A N G E   L O G
  7048*
  7049* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7050*-----------------------------------------------------------------
  7051*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7052* EFFECTIVE    NUMBER
  7053*-----------------------------------------------------------------
  7054* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  7055* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  7056******************************************************************
  7057 01  REINSURANCE-RECORD.
  7058     12  RE-RECORD-ID                      PIC XX.
  7059         88  VALID-RE-ID                      VALUE 'RE'.
  7060
  7061     12  RE-CONTROL-PRIMARY.
  7062         16  RE-COMPANY-CD                 PIC X.
  7063         16  RE-KEY.
  7064             20  RE-CODE                   PIC X.
  7065                 88  RE-TABLE-RECORD          VALUE 'A'.
  7066                 88  RE-COMPANY-RECORD        VALUE 'B'.
  7067             20  RE-TABLE                  PIC XXX.
  7068             20  FILLER                    PIC XXX.
  7069         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  7070             20  FILLER                    PIC X.
  7071             20  RE-COMPANY.
  7072                 24  RE-COMP-PRIME         PIC XXX.
  7073                 24  RE-COMP-SUB           PIC XXX.
  7074
  7075     12  RE-MAINT-INFORMATION.
  7076         16  RE-LAST-MAINT-DT              PIC XX.
  7077         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7078         16  RE-LAST-MAINT-USER            PIC X(4).
  7079         16  FILLER                        PIC X(10).
  7080
  7081     12  RE-TABLE-DATA.
  7082         16  RE-100-COMP                   PIC 99.
  7083
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 130
* EL050.cbl
  7084         16  RE-COMP-INFO    OCCURS 30 TIMES.
  7085             20  RE-REI-COMP-NO.
  7086                 24  RE-REI-COMP           PIC XXX.
  7087                 24  RE-REI-COMP-SUB       PIC XXX.
  7088             20  RE-LF-QC                  PIC X.
  7089             20  RE-AH-QC                  PIC X.
  7090             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  7091             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  7092             20  RE-LFAGE-LO               PIC 99.
  7093             20  RE-LFAGE-HI               PIC 99.
  7094             20  RE-AHAGE-LO               PIC 99.
  7095             20  RE-AHAGE-HI               PIC 99.
  7096             20  RE-LFTRM-LO               PIC S999       COMP-3.
  7097             20  RE-LFTRM-HI               PIC S999       COMP-3.
  7098             20  RE-AHTRM-LO               PIC S999       COMP-3.
  7099             20  RE-AHTRM-HI               PIC S999       COMP-3.
  7100             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  7101             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  7102             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  7103             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  7104             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  7105             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  7106             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  7107             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  7108             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  7109             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  7110             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  7111             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  7112             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  7113             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  7114             20  RE-LF-BEN-CODE            PIC X.
  7115             20  RE-AH-BEN-CODE            PIC X.
  7116             20  RE-INTERACTIVE            PIC X.
  7117             20  RE-REMAINING              PIC X.
  7118             20  RE-LF-RUNOFF-SW           PIC X.
  7119             20  RE-AH-RUNOFF-SW           PIC X.
  7120             20  FILLER                    PIC X(19).
  7121
  7122         16  RE-COMP-INFO-END              PIC X(6).
  7123         16  RE-NSP-ST-CD-LF               PIC XX.
  7124         16  RE-NSP-ST-CD-AH               PIC XX.
  7125         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7126             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7127
  7128         16  FILLER                        PIC X(27).
  7129
  7130     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7131         16  RE-NAME                       PIC X(30).
  7132         16  RE-LF-PE                      PIC X.
  7133         16  RE-AH-PE                      PIC X.
  7134         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7135         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7136         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7137         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7138         16  RE-PRT-ST                     PIC X.
  7139         16  RE-PRT-OW                     PIC X.
  7140         16  RE-MORT-CODE                  PIC X(4).
  7141         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 131
* EL050.cbl
  7142         16  RE-ZERO-LF-FEE                PIC X.
  7143         16  RE-ZERO-AH-FEE                PIC X.
  7144         16  RE-CEDE-NAME                  PIC X(30).
  7145         16  RE-LF-COMM                    PIC X.
  7146         16  RE-AH-COMM                    PIC X.
  7147         16  RE-LF-TAX                     PIC X.
  7148         16  RE-AH-TAX                     PIC X.
  7149         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7150         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7151         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7152
  7153         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7154             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7155
  7156         16  RE-LF-CEDING-FEE-BRACKETS.
  7157             20  RE-LF-FEE-METHOD          PIC X.
  7158                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7159                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7160                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7161                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7162             20  RE-LF-FEE-BASIS           PIC X.
  7163                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7164                 88  RE-LF-NET-CEDED               VALUE '2'.
  7165                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7166                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7167                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7168                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7169                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7170                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7171             20  FILLER                    PIC XXX.
  7172             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7173                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7174                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7175
  7176         16  RE-AH-CEDING-FEE-BRACKETS.
  7177             20  RE-AH-FEE-METHOD          PIC X.
  7178                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7179                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7180                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7181                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7182             20  RE-AH-FEE-BASIS           PIC X.
  7183                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7184                 88  RE-AH-NET-CEDED               VALUE '2'.
  7185                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7186                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7187                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7188                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7189                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7190                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7191             20  FILLER                    PIC XXX.
  7192             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7193                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7194                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7195
  7196         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7197
  7198         16  RE-OLD-CEDING-STMT            PIC X.
  7199
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 132
* EL050.cbl
  7200         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7201         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7202         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7203         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7204         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7205         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7206         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7207         16  RE-MORT-SW                    PIC X.
  7208         16  RE-CEDING-TYPE-FLAG           PIC X.
  7209             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7210             88  RE-CEDED                          VALUE 'C'.
  7211             88  RE-ASSUMED                        VALUE 'A'.
  7212             88  RE-PHANTOM                        VALUE 'P'.
  7213
  7214         16  RE-CEDING-STMT-OPT-A          PIC X.
  7215             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7216         16  RE-CEDING-STMT-OPT-B          PIC X.
  7217             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7218         16  RE-CEDING-STMT-OPT-C          PIC X.
  7219             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7220         16  RE-CEDING-STMT-OPT-D          PIC X.
  7221             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7222         16  RE-CEDING-STMT-OPT-E          PIC X.
  7223             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7224
  7225         16  RE-PRT-CRSV                   PIC X.
  7226
  7227         16  RE-GL-CENTER                  PIC X(4).
  7228
  7229         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7230
  7231         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7232
  7233         16  RE-EARN-STOP-CODE             PIC X.
  7234             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7235             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7236
  7237         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7238             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7239
  7240         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7241         16  FILLER                        PIC X(2281).
  7242
  7243         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7244
  7245******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 133
* EL050.cbl
  7247*    COPY ERCCTBL.
  7248******************************************************************
  7249*                                                                *
  7250*                                                                *
  7251*                            ERCCTBL                             *
  7252*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7253*                            VMOD=2.003
  7254*                                                                *
  7255*   ONLINE CREDIT SYSTEM                                         *
  7256*                                                                *
  7257*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7258*                                                                *
  7259*   FILE TYPE = VSAM,KSDS                                        *
  7260*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7261*                                                                *
  7262*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7263*       ALTERNATE PATH = NONE                                    *
  7264*                                                                *
  7265*   LOG = NO                                                     *
  7266*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7267*                                                                *
  7268*                                                                *
  7269******************************************************************
  7270
  7271 01  COMM-TABLE-RECORD.
  7272     12  CT-RECORD-ID                      PIC XX.
  7273         88  VALID-CT-ID                      VALUE 'CT'.
  7274
  7275     12  CT-CONTROL-PRIMARY.
  7276         16  CT-COMPANY-CD                 PIC X.
  7277         16  CT-TABLE                      PIC XXX.
  7278         16  CT-CNTRL-2.
  7279             20  CT-BEN-TYPE               PIC X.
  7280             20  CT-BEN-CODE               PIC XX.
  7281
  7282     12  CT-MAINT-INFORMATION.
  7283         16  CT-LAST-MAINT-DT              PIC XX.
  7284         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7285         16  CT-LAST-MAINT-USER            PIC X(4).
  7286         16  FILLER                        PIC X(31).
  7287
  7288     12  CT-LIMITS.
  7289         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7290
  7291         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7292
  7293         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7294
  7295     12  CT-RATES.
  7296         16  CT-RTX          OCCURS 27 TIMES.
  7297             20  CT-RT                     PIC SV9(5)     COMP-3.
  7298             20  CT-RT-R   REDEFINES
  7299                 CT-RT                     PIC XXX.
  7300
  7301     12  FILLER                            PIC  X(42).
  7302
  7303******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 134
* EL050.cbl
  7305*    COPY ERCFORM.
  7306******************************************************************
  7307*                                                                *
  7308*                                                                *
  7309*                            ERCFORM.                            *
  7310*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7311*                            VMOD=2.003                          *
  7312*                                                                *
  7313*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7314*                                                                *
  7315*    FILE TYPE = VSAM,KSDS                                       *
  7316*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7317*                                                                *
  7318*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7319*                                                                *
  7320*    LOG = YES                                                   *
  7321*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7322******************************************************************
  7323 01  FORM-MASTER.
  7324    12  FO-RECORD-ID                 PIC X(02).
  7325        88  VALID-FO-ID                  VALUE 'FO'.
  7326
  7327    12  FO-CONTROL-PRIMARY.
  7328        16  FO-COMPANY-CD            PIC X(01).
  7329        16  FO-STATE                 PIC X(02).
  7330        16  FO-FORM-ID               PIC X(12).
  7331        16  FO-FORM-EXP-DT           PIC X(02).
  7332
  7333    12  FO-POLICY-FORM-DATA.
  7334        16  FO-IND-GRP-CD            PIC X(01).
  7335        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7336        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7337        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7338        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7339        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7340        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7341        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7342        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7343        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7344        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7345        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7346        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7347        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7348        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7349        16  FO-APP-CERT-USE-CD       PIC X(01).
  7350
  7351    12  FILLER                       PIC X(29).
  7352
  7353    12  FO-FORM-PLAN-TABLE.
  7354        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7355            20  FO-PLAN-TYPE         PIC X(01).
  7356            20  FO-PLAN-ID           PIC X(02).
  7357            20  FO-PLAN-TERM         PIC 9(03).
  7358            20  FO-PLAN-REFUND-METHOD
  7359                                     PIC X.
  7360
  7361    12  FILLER                       PIC X(30).
  7362
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 135
* EL050.cbl
  7363    12  FO-COMMENTS-AREA.
  7364        16  FO-COMMENT-LINE-1        PIC X(78).
  7365
  7366    12  FILLER                       PIC X(20).
  7367
  7368    12  FO-MAINT-INFORMATION.
  7369        16  FO-LAST-MAINT-DT         PIC X(02).
  7370        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7371        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 136
* EL050.cbl
  7373*    COPY ELCMSTR.
  7374******************************************************************
  7375*                                                                *
  7376*                            ELCMSTR.                            *
  7377*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7378*                            VMOD=2.012                          *
  7379*                                                                *
  7380*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7381*                                                                *
  7382*   FILE TYPE = VSAM,KSDS                                        *
  7383*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7384*                                                                *
  7385*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7386*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7387*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7388*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7389*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7390*                                                 RKP=75,LEN=21  *
  7391*                                                                *
  7392*   **** NOTE ****                                               *
  7393*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7394*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7395*                                                                *
  7396*   LOG = YES                                                    *
  7397*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7398******************************************************************
  7399*                   C H A N G E   L O G
  7400*
  7401* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7402*-----------------------------------------------------------------
  7403*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7404* EFFECTIVE    NUMBER
  7405*-----------------------------------------------------------------
  7406* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7407* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7408* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7409* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7410* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7411******************************************************************
  7412 01  CLAIM-MASTER.
  7413     12  CL-RECORD-ID                PIC XX.
  7414         88  VALID-CL-ID         VALUE 'CL'.
  7415
  7416     12  CL-CONTROL-PRIMARY.
  7417         16  CL-COMPANY-CD           PIC X.
  7418         16  CL-CARRIER              PIC X.
  7419         16  CL-CLAIM-NO             PIC X(7).
  7420         16  CL-CERT-NO.
  7421             20  CL-CERT-PRIME       PIC X(10).
  7422             20  CL-CERT-SFX         PIC X.
  7423
  7424     12  CL-CONTROL-BY-NAME.
  7425         16  CL-COMPANY-CD-A1        PIC X.
  7426         16  CL-INSURED-LAST-NAME    PIC X(15).
  7427         16  CL-INSURED-NAME.
  7428             20  CL-INSURED-1ST-NAME PIC X(12).
  7429             20  CL-INSURED-MID-INIT PIC X.
  7430
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 137
* EL050.cbl
  7431     12  CL-CONTROL-BY-SSN.
  7432         16  CL-COMPANY-CD-A2        PIC X.
  7433         16  CL-SOC-SEC-NO.
  7434             20  CL-SSN-STATE        PIC XX.
  7435             20  CL-SSN-ACCOUNT      PIC X(6).
  7436             20  CL-SSN-LN3          PIC X(3).
  7437
  7438     12  CL-CONTROL-BY-CERT-NO.
  7439         16  CL-COMPANY-CD-A4        PIC X.
  7440         16  CL-CERT-NO-A4.
  7441             20  CL-CERT-A4-PRIME    PIC X(10).
  7442             20  CL-CERT-A4-SFX      PIC X.
  7443
  7444     12  CL-CONTROL-BY-CCN.
  7445         16  CL-COMPANY-CD-A5        PIC X.
  7446         16  CL-CCN-A5.
  7447             20  CL-CCN.
  7448                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7449                 24  CL-CCN-PRIME-A5 PIC X(12).
  7450             20  CL-CCN-FILLER-A5    PIC X(4).
  7451
  7452     12  CL-INSURED-PROFILE-DATA.
  7453         16  CL-INSURED-BIRTH-DT     PIC XX.
  7454         16  CL-INSURED-SEX-CD       PIC X.
  7455             88  INSURED-IS-MALE        VALUE 'M'.
  7456             88  INSURED-IS-FEMALE      VALUE 'F'.
  7457             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7458         16  CL-INSURED-OCC-CD       PIC X(6).
  7459         16  FILLER                  PIC X(5).
  7460
  7461     12  CL-PROCESSING-INFO.
  7462         16  CL-PROCESSOR-ID         PIC X(4).
  7463         16  CL-CLAIM-STATUS         PIC X.
  7464             88  CLAIM-IS-OPEN          VALUE 'O'.
  7465             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7466         16  CL-CLAIM-TYPE           PIC X.
  7467*            88  AH-CLAIM               VALUE 'A'.
  7468*            88  LIFE-CLAIM             VALUE 'L'.
  7469*            88  PROPERTY-CLAIM         VALUE 'P'.
  7470*            88  IUI-CLAIM              VALUE 'I'.
  7471*            88  GAP-CLAIM              VALUE 'G'.
  7472*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7473         16  CL-CLAIM-PREM-TYPE      PIC X.
  7474             88  SINGLE-PREMIUM         VALUE '1'.
  7475             88  O-B-COVERAGE           VALUE '2'.
  7476             88  OPEN-END-COVERAGE      VALUE '3'.
  7477         16  CL-INCURRED-DT          PIC XX.
  7478         16  CL-REPORTED-DT          PIC XX.
  7479         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7480         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7481         16  CL-LAST-PMT-DT          PIC XX.
  7482         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7483         16  CL-PAID-THRU-DT         PIC XX.
  7484         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7485         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7486         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7487         16  CL-PMT-CALC-METHOD      PIC X.
  7488             88  CL-360-DAY-YR          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 138
* EL050.cbl
  7489             88  CL-365-DAY-YR          VALUE '2'.
  7490             88  CL-FULL-MONTHS         VALUE '3'.
  7491         16  CL-CAUSE-CD             PIC X(6).
  7492
  7493         16  CL-PRIME-CERT-NO.
  7494             20  CL-PRIME-CERT-PRIME PIC X(10).
  7495             20  CL-PRIME-CERT-SFX   PIC X.
  7496
  7497         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7498             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7499             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7500
  7501         16  CL-MICROFILM-NO         PIC X(10).
  7502         16  FILLER REDEFINES CL-MICROFILM-NO.
  7503             20  CL-BENEFIT-PERIOD   PIC 99.
  7504             20  FILLER              PIC X(8).
  7505         16  CL-PROG-FORM-TYPE       PIC X.
  7506         16  CL-LAST-ADD-ON-DT       PIC XX.
  7507
  7508         16  CL-LAST-REOPEN-DT       PIC XX.
  7509         16  CL-LAST-CLOSE-DT        PIC XX.
  7510         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7511             88  FINAL-PAID             VALUE '1'.
  7512             88  CLAIM-DENIED           VALUE '2'.
  7513             88  AUTO-CLOSE             VALUE '3'.
  7514             88  MANUAL-CLOSE           VALUE '4'.
  7515             88  BENEFITS-CHANGED       VALUE 'C'.
  7516             88  SETUP-ERRORS           VALUE 'E'.
  7517         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7518         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7519         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7520             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7521         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7522         16  FILLER                  PIC X.
  7523
  7524     12  CL-CERTIFICATE-DATA.
  7525         16  CL-CERT-ORIGIN          PIC X.
  7526             88  CERT-WAS-ONLINE        VALUE '1'.
  7527             88  CERT-WAS-CREATED       VALUE '2'.
  7528             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7529         16  CL-CERT-KEY-DATA.
  7530             20  CL-CERT-CARRIER     PIC X.
  7531             20  CL-CERT-GROUPING    PIC X(6).
  7532             20  CL-CERT-STATE       PIC XX.
  7533             20  CL-CERT-ACCOUNT.
  7534                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7535                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7536             20  CL-CERT-EFF-DT      PIC XX.
  7537
  7538     12  CL-STATUS-CONTROLS.
  7539         16  CL-PRIORITY-CD          PIC X.
  7540             88  CONFIDENTIAL-DATA      VALUE '8'.
  7541             88  HIGHEST-PRIORITY       VALUE '9'.
  7542         16  CL-SUPV-ATTN-CD         PIC X.
  7543             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7544             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7545         16  CL-PURGED-DT            PIC XX.
  7546         16  CL-RESTORED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 139
* EL050.cbl
  7547         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7548         16  CL-NEXT-RESEND-DT       PIC XX.
  7549         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7550         16  CL-CRITICAL-PERIOD      PIC 99.
  7551*        16  FILLER                  PIC XX.
  7552         16  CL-LAST-MAINT-DT        PIC XX.
  7553         16  CL-LAST-MAINT-USER      PIC X(4).
  7554         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7555         16  CL-LAST-MAINT-TYPE      PIC X.
  7556             88  CLAIM-SET-UP           VALUE ' '.
  7557             88  PAYMENT-MADE           VALUE '1'.
  7558             88  LETTER-SENT            VALUE '2'.
  7559             88  MASTER-WAS-ALTERED     VALUE '3'.
  7560             88  MASTER-WAS-RESTORED    VALUE '4'.
  7561             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7562             88  FILE-CONVERTED         VALUE '6'.
  7563             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7564             88  ERROR-CORRECTION       VALUE 'E'.
  7565         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7566         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7567         16  CL-BENEFICIARY          PIC X(10).
  7568         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7569         16  CL-DENIAL-TYPE          PIC X.
  7570             88  CL-TYPE-DENIAL          VALUE '1'.
  7571             88  CL-TYPE-RESCISSION      VALUE '2'.
  7572             88  CL-TYPE-REFORMATION     VALUE '3'.
  7573             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7574             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7575         16  filler                  pic x(5).
  7576*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7577*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7578*        16  CL-RTW-DT               PIC XX.
  7579
  7580     12  CL-TRAILER-CONTROLS.
  7581         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7582             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7583             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7584             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7585         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7586         16  FILLER                  PIC XX.
  7587         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7588         16  CL-ADDRESS-TRAILER-CNT.
  7589             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7590                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7591             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7592                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7593             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7594                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7595             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7596                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7597             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7598                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7599             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7600                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7601             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7602                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7603
  7604     12  CL-CV-REFERENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 140
* EL050.cbl
  7605         16  CL-CV-REFNO-PRIME       PIC X(18).
  7606         16  CL-CV-REFNO-SFX         PIC XX.
  7607
  7608     12  CL-FILE-LOCATION            PIC X(4).
  7609
  7610     12  CL-PROCESS-ERRORS.
  7611         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7612             88  NO-FATAL-ERRORS        VALUE ZERO.
  7613         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7614             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7615
  7616     12  CL-PRODUCT-CD               PIC X.
  7617
  7618     12  CL-CURRENT-KEY-DATA.
  7619         16  CL-CURRENT-CARRIER      PIC X.
  7620         16  CL-CURRENT-GROUPING     PIC X(6).
  7621         16  CL-CURRENT-STATE        PIC XX.
  7622         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7623
  7624     12  CL-ASSOCIATES               PIC X.
  7625         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7626         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7627         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7628         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7629
  7630     12  CL-ACTIVITY-CODE            PIC 99.
  7631     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7632     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7633
  7634     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7635     12  CL-LAG-REPORT-CODE          PIC 9.
  7636     12  CL-LOAN-TYPE                PIC XX.
  7637     12  CL-LEGAL-STATE              PIC XX.
  7638
  7639     12  CL-YESNOSW                  PIC X.
  7640     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7641         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7642         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7643         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7644     12  cl-insured-type             pic x.
  7645         88  cl-claim-on-primary         value 'P'.
  7646         88  cl-claim-on-co-borrower     value 'C'.
  7647     12  cl-benefit-expiration-dt    PIC XX.
  7648
  7649 01  PLAN-RECORDS.
  7650     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7651     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7652
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 141
* EL050.cbl
  7654 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7655                          ACCOUNT-MASTER REINSURANCE-RECORD
  7656                          COMM-TABLE-RECORD FORM-MASTER
  7657                          CLAIM-MASTER PLAN-RECORDS.
  7658 0000-DFHEXIT SECTION.
  7659     MOVE '9#                    $   ' TO DFHEIV0.
  7660     MOVE 'EL050' TO DFHEIV1.
  7661     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7662
  7663     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7664
  7665
  7666* EXEC CICS  HANDLE CONDITION
  7667*           ERROR    (9300-ABEND)
  7668*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7669*    END-EXEC.
  7670*    MOVE '"$.J                  ! " #00007661' TO DFHEIV0
  7671     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7672     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7673     MOVE X'2220233030303037363631' TO DFHEIV0(25:11)
  7674     CALL 'kxdfhei1' USING DFHEIV0
  7675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7676
  7677
  7678 0000-COPY-PROCEDURE-DIV.
  7679*                          COPY ELC50PD.
  7680******************************************************************
  7681*                                                                *
  7682*                            ELC50PD                             *
  7683*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7684*                            VMOD=2.188                          *
  7685*                                                                *
  7686******************************************************************
  7687*                   C H A N G E   L O G
  7688*
  7689* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7690*-----------------------------------------------------------------
  7691*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7692* EFFECTIVE    NUMBER
  7693*-----------------------------------------------------------------
  7694* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7695* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7696* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7697*                             2709 AND 2718
  7698* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7699* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7700* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7701* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7702* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7703*                                IS OPEN OR CNC DT < PD THRU
  7704* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7705* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7706* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7707* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7708* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7709* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7710* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7711* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 142
* EL050.cbl
  7712* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7713* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7714* 020906                   PEMA  EXPAND LOAN OFFICER
  7715* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7716* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7717* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7718* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7719* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7720* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7721* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7722* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7723* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7724* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7725* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7726* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7727* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7728* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7729* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7730* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7731* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7732* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7733* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7734* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7735* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7736* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7737* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7738* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7739* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7740*                                UPDATE VIN ON CERT TRAILER
  7741* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7742* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7743* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7744* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7745* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7746* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7747* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7748* 040610  IR2010030800001  PEMA  INIT Alternate BENEFIT
  7749* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7750* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7751* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7752* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7753* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7754* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7755* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7756* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7757* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7758* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7759* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7760* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7761* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7762* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7763* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7764* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7765* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7766* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7767* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7768* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7769* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 143
* EL050.cbl
  7770* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7771* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7772* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7773* 032912  CR2011110200001  PEMA  AHL CHANGES
  7774* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7775* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7776* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7777* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7778* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7779* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7780* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7781* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7782* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7783* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7784* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7785* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7786* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7787* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7788* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7789* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7790* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7791* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7792* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7793* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7794* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
  7795* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7796* 052114  IR2014042900002  PEMA  CORRECT CANCEL EDIT ON VOIDS
  7797* 051914  CR2014043000002  TANA  ADD CAUSAL STATE
  7798* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  7799* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  7800* 100114  IR2014100100003  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
  7801*                                CERT #, ADD 2898 FORCIBLE ERROR
  7802* 100214  IR2014100100002  PEMA  CHG WAY CAR7 CLP IS CALCED
  7803* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  7804* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
  7805* 121815  CR2015121700006  PEMA  ADD HANDLING FOR FOREIGN VINS
  7806* 010416  CR2015082600001  PEMA  ADD CID and DCC TO MON CODE
  7807* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  7808* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
  7809* 021916  CR2014010900001  TANA  ADD ACCT STATUS D,L,R,P
  7810******************************************************************
  7811************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7812******************************************************************
  7813
  7814     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7815
  7816     MOVE SPACES                 TO PB-FATAL-FLAG
  7817                                    PB-FORCE-ER-CD
  7818                                    PB-WARN-ER-CD
  7819                                    PB-OUT-BAL-CD.
  7820
  7821     MOVE SPACE                  TO WS-IG-OVRD-AH
  7822                                    WS-IG-OVRD-LF
  7823                                    WS-IG-OVRD-AM
  7824                                    WS-IG-OVRD
  7825                                    WS-IG-OVRD-AH-PL
  7826                                    WS-IG-OVRD-LF-PL
  7827                                    WS-IG-OVRD-AH-BEN
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 144
* EL050.cbl
  7828                                    WS-IG-OVRD-LF-BEN.
  7829
  7830******************************************************************
  7831*************       INITIALIZE COMMON ERRORS       ***************
  7832******************************************************************
  7833
  7834     MOVE +0                     TO PB-NO-OF-ERRORS.
  7835     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7836
  7837******************************************************************
  7838
  7839     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7840     SET JULIAN-TO-BIN           TO TRUE.
  7841*    MOVE 5                      TO DC-OPTION-CODE.
  7842     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7843     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7844
  7845     MOVE ZERO                   TO  SUB4.
  7846
  7847 0040-INITIALIZE-GA-BILL-DT.
  7848
  7849     ADD +1                      TO  SUB4.
  7850
  7851     IF  SUB4 GREATER THAN +5
  7852         GO TO 0050-CHECK-CNTL-FOUND.
  7853
  7854     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7855         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7856
  7857     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7858
  7859 0050-CHECK-CNTL-FOUND.
  7860
  7861     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7862        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7863                                         WS-AH-REM-TERM-CALC
  7864                                         EC-CO-REM-TERM-CALC
  7865        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7866        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7867        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7868                                         WS-TOL-AH-CLAIM
  7869        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7870                                         WS-TOL-AH-PREM
  7871                                         EC-CO-TOL-PREM
  7872        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7873                                         WS-TOL-AH-REFUND
  7874                                         EC-CO-TOL-REFUND
  7875        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7876                                         WS-AH-REFUND-OVS-AMT
  7877                                         EC-CO-OVR-SHT-AMT
  7878        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7879                                         WS-TOL-AH-PREM-PCT
  7880                                         EC-CO-TOL-PREM-PCT
  7881        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7882                                         WS-TOL-AH-REFUND-PCT
  7883                                         EC-CO-TOL-REFUND-PCT
  7884        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7885                                         WS-AH-REFUND-OVS-PCT
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 145
* EL050.cbl
  7886                                         EC-CO-OVR-SHT-PCT
  7887        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7888        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7889        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7890        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7891        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7892        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7893        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7894        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7895        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7896        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7897        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7898        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7899                                         EC-CO-MONTH-END-DT
  7900        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7901          GO TO 0100-READ-ACCT.
  7902
  7903     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7904     MOVE SPACES                 TO CNTL-ACCESS.
  7905     MOVE '1'                    TO CNTL-REC-TYPE.
  7906     MOVE +0                     TO CNTL-SEQ-NO.
  7907
  7908     MOVE '1' TO RC-SW-1.
  7909     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7910     IF NOT CF-COMPANY-MASTER
  7911         MOVE ZEROS             TO WK-CO-TOL-PREM
  7912                                   WK-CO-TOL-CLAIM
  7913                                   WK-CO-TOL-REFUND
  7914                                   WK-REFUND-OVS-AMT
  7915                                   WK-REFUND-OVS-PCT
  7916                                   WK-CO-TOL-PREM-PCT
  7917                                   WK-CO-TOL-REFUND-PCT
  7918                                   WK-DEFAULT-APR
  7919                                   WK-CO-MAX-CAP
  7920        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7921                                   WK-CR-R78-METHOD
  7922                                   WK-CO-REF-REJECT-SW
  7923                                   WK-CO-PREM-REJECT-SW
  7924                                   WK-REM-TRM-CALC-OPTION
  7925                                   WK-BIRTH-DATE-INPUT
  7926                                   WK-JOINT-AGE-INPUT
  7927        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7928        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7929        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7930        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7931          GO TO 0099-COMPANY-NOT-FOUND.
  7932
  7933     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7934        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7935     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7936        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7937     IF CF-CO-TOL-CAP NOT NUMERIC
  7938        MOVE +0                    TO CF-CO-TOL-CAP.
  7939     IF CF-DEFAULT-APR NOT NUMERIC
  7940        MOVE +0                    TO CF-DEFAULT-APR.
  7941
  7942     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7943     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 146
* EL050.cbl
  7944     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7945     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7946     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7947     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7948     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7949     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7950     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7951     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7952     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7953     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7954
  7955     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7956          CF-CO-OVR-SHT-AMT > +0
  7957        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7958
  7959     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7960          CF-CO-OVR-SHT-PCT > +0
  7961        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7962
  7963     IF CF-VALID-REM-TRM-OPTION
  7964         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7965     ELSE
  7966         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7967
  7968     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7969     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7970     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7971     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7972
  7973     GO TO 0050-CHECK-CNTL-FOUND.
  7974
  7975 0099-COMPANY-NOT-FOUND.
  7976
  7977     MOVE ER-2616                TO WS-ERROR.
  7978     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7979
  7980 0100-READ-ACCT.
  7981
  7982     MOVE SPACES                 TO DATE-RANGE-SW.
  7983
  7984     IF WK-ACCT-ADDR = ZEROS
  7985        GO TO 0102-ACCT-GETMAIN.
  7986
  7987     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7988     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7989     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7990
  7991     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7992        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7993        GO TO 0105-READ-ACCT
  7994     END-IF
  7995
  7996     IF PB-CARRIER NOT = SPACES
  7997        IF PB-CARRIER NOT = AM-VG-CARRIER
  7998           GO TO 0105-READ-ACCT.
  7999
  8000     IF PB-STATE NOT = SPACES
  8001        IF PB-STATE NOT = AM-VG-STATE
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 147
* EL050.cbl
  8002           GO TO 0105-READ-ACCT.
  8003
  8004     IF PB-GROUPING NOT = SPACES
  8005        IF PB-GROUPING NOT = AM-VG-GROUPING
  8006           GO TO 0105-READ-ACCT.
  8007
  8008     MOVE 'X'                 TO DATE-RANGE-SW.
  8009
  8010     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8011        MOVE 'X'                 TO DATE-RANGE-SW
  8012        GO TO 0105-READ-ACCT.
  8013
  8014     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8015        GO TO 0105-READ-ACCT.
  8016
  8017     GO TO 0180-ACCOUNT-FOUND.
  8018
  8019 0102-ACCT-GETMAIN.
  8020     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  8021     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  8022
  8023 0105-READ-ACCT.
  8024     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  8025     MOVE PB-CARRIER             TO ACCT-CARRIER.
  8026     MOVE PB-GROUPING            TO ACCT-GROUPING.
  8027     MOVE PB-STATE               TO ACCT-STATE.
  8028     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  8029     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  8030
  8031     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  8032
  8033     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  8034
  8035 0110-FIND-ACCT-TOLERANCES-LOOP.
  8036     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  8037
  8038     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8039        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8040        GO TO 0199-ACCT-NOT-FOUND
  8041     END-IF
  8042     IF PB-CARRIER NOT = SPACES
  8043        IF PB-CARRIER NOT = AM-VG-CARRIER
  8044           GO TO 0199-ACCT-NOT-FOUND.
  8045
  8046     IF PB-STATE NOT = SPACES
  8047        IF PB-STATE NOT = AM-VG-STATE
  8048           GO TO 0199-ACCT-NOT-FOUND.
  8049
  8050     IF PB-GROUPING NOT = SPACES
  8051        IF PB-GROUPING NOT = AM-VG-GROUPING
  8052           GO TO 0199-ACCT-NOT-FOUND.
  8053
  8054     MOVE 'X'                    TO DATE-RANGE-SW.
  8055
  8056     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8057        MOVE 'X'                 TO DATE-RANGE-SW
  8058        GO TO 0199-ACCT-NOT-FOUND.
  8059
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 148
* EL050.cbl
  8060     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8061        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  8062
  8063 0180-ACCOUNT-FOUND.
  8064     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  8065     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  8066     MOVE AM-STATE               TO PB-SV-STATE.
  8067     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  8068
  8069     IF AM-CANCEL-FEE  NOT NUMERIC
  8070        MOVE ZEROS TO AM-CANCEL-FEE.
  8071
  8072     IF AM-MAX-MON-BEN NOT NUMERIC
  8073        MOVE ZEROS TO AM-MAX-MON-BEN.
  8074
  8075     IF AM-MAX-TOT-BEN NOT NUMERIC
  8076        MOVE ZEROS TO AM-MAX-TOT-BEN.
  8077
  8078     IF AM-CLP-TOL-PCT NOT NUMERIC
  8079        MOVE +0                  TO AM-CLP-TOL-PCT
  8080     END-IF
  8081     IF AM-SPP-LEASE-COMM NOT NUMERIC
  8082        MOVE +0                  TO AM-SPP-LEASE-COMM
  8083     END-IF
  8084     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8085        MOVE ER-2611             TO   WS-ERROR
  8086        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8087
  8088     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8089        MOVE ER-2621             TO   WS-ERROR
  8090        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8091
  8092     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  8093        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  8094        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  8095        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  8096         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  8097
  8098     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  8099     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  8100     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  8101     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  8102     IF AM-CLP-TOL-PCT NOT = ZEROS
  8103        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  8104     END-IF
  8105     IF AM-SPP-LEASE-COMM NOT = ZEROS
  8106        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  8107     END-IF
  8108*    IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8109*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  8110*                                   WS-ADMIN-FEES
  8111*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  8112*          (SUB5 > +10)
  8113*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8114*             AND (AM-A-COM (SUB5) NUMERIC)
  8115*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8116*                + (AM-A-COM (SUB5) * 1000)
  8117*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 149
* EL050.cbl
  8118*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8119*                + (AM-A-COM (SUB5) * 1000)
  8120*             END-IF
  8121*             IF AM-COM-TYP (SUB5) = 'N'
  8122*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8123*                + (AM-A-COM (SUB5) * 1000)
  8124*             END-IF
  8125*          END-IF
  8126*       END-PERFORM
  8127*    END-IF
  8128     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  8129        AND (PB-ISSUE)
  8130        MOVE +0                  TO WS-ACCT-ADDL-CLP
  8131                                    ws-cred-union-fees
  8132        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8133           (SUB5 > +10)
  8134           MOVE +0 TO WS-WK-RATE
  8135           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N' OR
  8136                                   'O' OR 'S')
  8137              IF (AM-A-COM (SUB5) NUMERIC)
  8138                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8139                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8140              ELSE
  8141                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8142                 IF PB-ISSUE
  8143                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8144                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8145                 ELSE
  8146                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8147                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8148                 END-IF
  8149                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8150                 MOVE ZEROS             TO WS-SUB1
  8151                                           WS-COMMISSION
  8152                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8153                 MOVE '0530'               TO CTBL-SW
  8154                 MOVE ' '                  TO WS-CTBL-READ-SW
  8155                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8156                 IF FIRST-TIME-THROUGH
  8157                    MOVE 'AA'              TO CTBL-BEN-CODE
  8158                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8159                 END-IF
  8160                 IF CTBL-TABLE-FOUND
  8161                    IF PB-ISSUE
  8162                       COMPUTE WS-COMM-CK-AMT =
  8163                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8164                    ELSE
  8165                       COMPUTE WS-COMM-CK-AMT =
  8166                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8167                    END-IF
  8168                    PERFORM 8800-GET-COMP-RATE
  8169                              THRU 8800-EXIT
  8170                 END-IF
  8171              END-IF
  8172              if am-com-typ (sub5) = 'O' or 'S'
  8173                 compute ws-cred-union-fees rounded =
  8174                    ws-cred-union-fees +
  8175                    (pb-i-ah-premium-amt * ws-wk-rate)
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 150
* EL050.cbl
  8176              else
  8177                 COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8178                + (WS-WK-RATE * 1000)
  8179              end-if
  8180           END-IF
  8181        END-PERFORM
  8182     END-IF
  8183     IF PB-COMPANY-ID EQUAL 'CRI'
  8184         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8185
  8186     IF PB-COMPANY-ID EQUAL 'NCL'
  8187         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8188     END-IF
  8189
  8190     GO TO 0200-READ-CERT.
  8191
  8192 0199-ACCT-NOT-FOUND.
  8193
  8194     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8195
  8196     IF DATE-RANGE-SW NOT = SPACES
  8197        MOVE ER-2601             TO WS-ERROR
  8198        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8199     ELSE
  8200        MOVE ER-2619             TO WS-ERROR
  8201        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8202
  8203     GO TO 9990-RETURN.
  8204
  8205 0200-READ-CERT.
  8206
  8207     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8208     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8209     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8210     MOVE PB-SV-STATE            TO CERT-STATE.
  8211     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8212     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8213     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8214
  8215     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8216
  8217     IF CERT-WAS-NOT-FOUND
  8218        GO TO 0299-CERT-NOT-FOUND.
  8219
  8220     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8221        MOVE ER-2759             TO WS-ERROR
  8222        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8223        GO TO 0298-UNLOCK-RETURN.
  8224
  8225     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8226         MOVE ER-2758            TO WS-ERROR
  8227         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8228         GO TO 0298-UNLOCK-RETURN.
  8229
  8230     IF PB-ISSUE
  8231        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8232           IF CERT-WAS-CREATED-FOR-CLAIM
  8233              NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 151
* EL050.cbl
  8234            ELSE
  8235              MOVE ER-2626       TO WS-ERROR
  8236              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8237              GO TO 0298-UNLOCK-RETURN.
  8238
  8239     IF NOT PB-CANCELLATION
  8240        GO TO 0300-CONTINUE-EDIT.
  8241
  8242     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8243     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8244     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8245     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8246     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8247     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8248
  8249     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8250     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8251     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8252     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8253     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8254     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8255     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8256     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8257     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8258
  8259     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8260     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8261     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8262     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8263     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8264     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8265     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8266
  8267     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8268     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8269
  8270     MOVE CM-CREDIT-INTERFACE-SW-1
  8271                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8272     MOVE CM-CREDIT-INTERFACE-SW-2
  8273                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8274
  8275     IF CM-O-B-COVERAGE
  8276         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8277
  8278     IF CM-LIVES NOT NUMERIC
  8279         MOVE ZERO                TO CM-LIVES.
  8280
  8281     IF CM-BILLED NOT NUMERIC
  8282         MOVE ZERO                TO CM-BILLED.
  8283
  8284     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8285         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8286         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8287         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8288         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8289         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8290         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8291         MOVE CM-LIVES             TO PB-CI-LIVES
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 152
* EL050.cbl
  8292*The next line causes a problem with my change  I dont think it is
  8293*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8294
  8295     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8296     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8297     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8298     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8299     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8300     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8301
  8302     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8303     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8304     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8305     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8306
  8307     IF CM-LIFE-COMM-PCT NUMERIC
  8308         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8309     ELSE
  8310         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8311
  8312     IF CM-AH-COMM-PCT NUMERIC
  8313         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8314     ELSE
  8315         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8316
  8317     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8318
  8319     IF CM-LOAN-APR       NOT NUMERIC
  8320           MOVE ZERO               TO CM-LOAN-APR.
  8321
  8322     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8323           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8324
  8325     IF CM-LOAN-TERM      NOT NUMERIC
  8326           MOVE ZERO               TO CM-LOAN-TERM.
  8327
  8328     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8329           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8330
  8331     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8332           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8333
  8334     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8335     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8336     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8337     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8338     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8339     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8340     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8341     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8342     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8343     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8344     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8345     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8346
  8347     IF CM-STATE = CM-SSN-STATE
  8348         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8349
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 153
* EL050.cbl
  8350     IF CM-STATE NOT = CM-MEMB-STATE
  8351         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8352
  8353     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8354
  8355     IF PB-COMPANY-ID = 'CVL' OR 'DCC' or 'VPP'
  8356        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8357        IF CM-ADDL-CLP NOT NUMERIC
  8358           MOVE +0               TO CM-ADDL-CLP
  8359        END-IF
  8360        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8361        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8362           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8363        END-IF
  8364     END-IF
  8365     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8366        MOVE +0                  TO WS-ADMIN-FEES
  8367                                    WS-CSO-ADMIN-FEE
  8368                                    WS-COMM-AND-MFEE
  8369                                    WS-1ST-YR-ALLOW
  8370        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8371           (SUB5 > +10)
  8372           MOVE +0 TO WS-WK-RATE
  8373           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8374              IF (AM-A-COM (SUB5) NUMERIC)
  8375                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8376                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8377              ELSE
  8378                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8379                 IF PB-ISSUE
  8380                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8381                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8382                 ELSE
  8383                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8384                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8385                 END-IF
  8386                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8387                 MOVE ZEROS             TO WS-SUB1
  8388                                           WS-COMMISSION
  8389                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8390                 MOVE '0530'               TO CTBL-SW
  8391                 MOVE ' '                  TO WS-CTBL-READ-SW
  8392                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8393                 IF FIRST-TIME-THROUGH
  8394                    MOVE 'AA'              TO CTBL-BEN-CODE
  8395                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8396                 END-IF
  8397                 IF CTBL-TABLE-FOUND
  8398                    IF PB-ISSUE
  8399                       COMPUTE WS-COMM-CK-AMT =
  8400                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8401                    ELSE
  8402                       COMPUTE WS-COMM-CK-AMT =
  8403                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8404                    END-IF
  8405                    PERFORM 8800-GET-COMP-RATE
  8406                              THRU 8800-EXIT
  8407                 END-IF
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 154
* EL050.cbl
  8408              END-IF
  8409              IF AM-COM-TYP (SUB5) = 'I'
  8410                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8411                   + (WS-WK-RATE * 1000)
  8412              END-IF
  8413              IF AM-COM-TYP (SUB5) = 'N'
  8414                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8415                   + (WS-WK-RATE * 1000)
  8416              END-IF
  8417              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8418                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8419                   + (WS-WK-RATE * 1000)
  8420              END-IF
  8421              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8422                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8423                   + (WS-WK-RATE * 1000)
  8424              END-IF
  8425           END-IF
  8426        END-PERFORM
  8427     END-IF
  8428     GO TO 0300-CONTINUE-EDIT.
  8429
  8430 0298-UNLOCK-RETURN.
  8431      PERFORM 9250-UNLOCK-RETURN
  8432      GO TO 9990-RETURN.
  8433
  8434 0299-CERT-NOT-FOUND.
  8435
  8436     MOVE '1'                     TO CERT-STATUS-SW.
  8437
  8438     IF PB-COMPANY-ID = 'UCL'
  8439         IF WS-ERROR = ER-2799
  8440             GO TO 3000-CONTINUE-EDIT.
  8441
  8442     IF NOT PB-CANCELLATION
  8443         GO TO 0300-CONTINUE-EDIT.
  8444
  8445     MOVE ER-2726                  TO  WS-ERROR.
  8446     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8447     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8448     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8449                                    PB-CI-LF-TERM
  8450                                    PB-C-LF-REM-TERM
  8451                                    PB-CI-AH-TERM
  8452                                    PB-C-AH-REM-TERM
  8453                                    PB-CI-LF-BENEFIT-CD
  8454                                    PB-CI-LF-BENEFIT-AMT
  8455                                    PB-CI-LF-ALT-BENEFIT-AMT
  8456                                    PB-CI-LF-PREMIUM-AMT
  8457                                    PB-CI-LF-ALT-PREMIUM-AMT
  8458                                    PB-CI-AH-BENEFIT-CD
  8459                                    PB-CI-AH-BENEFIT-AMT
  8460                                    PB-CI-AH-PREMIUM-AMT
  8461                                    PB-CI-PAY-FREQUENCY
  8462                                    PB-CI-LOAN-APR
  8463                                    PB-CI-LOAN-TERM
  8464                                    PB-CI-LIFE-COMMISSION
  8465                                    PB-CI-AH-COMMISSION
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 155
* EL050.cbl
  8466                                    PB-CI-CURR-SEQ
  8467                                    PB-CI-AH-CANCEL-AMT
  8468                                    PB-CI-LF-CANCEL-AMT
  8469                                    PB-CI-RATE-DEV-PCT-LF
  8470                                    PB-CI-RATE-DEV-PCT-AH
  8471                                    PB-CI-EXTENTION-DAYS
  8472                                    PB-CI-TERM-IN-DAYS
  8473                                    PB-CI-LIVES
  8474                                    PB-CI-LF-CRIT-PER
  8475                                    PB-CI-AH-CRIT-PER
  8476                                    PB-CI-ADDL-CLP
  8477                                    PB-CI-DDF-IU-RATE-UP.
  8478
  8479     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8480                                    PB-CI-AH-SETTLEMENT-DT
  8481                                    PB-CI-DEATH-DT
  8482                                    PB-CI-LF-PRIOR-CANCEL-DT
  8483                                    PB-CI-AH-PRIOR-CANCEL-DT
  8484                                    PB-CI-ENTRY-DT
  8485                                    PB-CI-LF-EXPIRE-DT
  8486                                    PB-CI-AH-EXPIRE-DT
  8487                                    PB-CI-LOAN-1ST-PMT-DT.
  8488
  8489     IF ACCOUNT-MAST-FOUND
  8490        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8491        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8492
  8493
  8494 0300-CONTINUE-EDIT.
  8495
  8496     IF PB-ISSUE
  8497        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8498            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8499
  8500     IF PB-ISSUE
  8501        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8502            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8503
  8504     IF PB-ISSUE
  8505       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8506          (AM-NO-AH-ONLY)
  8507           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8508               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8509                   MOVE ER-2679 TO WS-ERROR
  8510                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8511
  8512     IF PB-ISSUE
  8513        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8514        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8515        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8516     ELSE
  8517        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8518        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8519        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8520
  8521     MOVE 'N'                    TO PLAN-MASTER-SW
  8522                                    PLAN-MASTER-LIFE-SW
  8523                                    FORM-MASTER-SW
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 156
* EL050.cbl
  8524                                    WS-APP-CERT-SW.
  8525
  8526     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8527                                    WS-PL-TOL-LF-REFUND
  8528                                    WS-PL-REF-OVS-AMT
  8529                                    WS-PL-TOL-LF-PREM-PCT
  8530                                    WS-PL-TOL-LF-REFUND-PCT
  8531                                    WS-PL-REF-OVS-PCT
  8532                                    WS-PL-TOL-LF-CLAIM.
  8533
  8534     IF PB-COMPANY-ID = 'NCL'
  8535       IF PB-ISSUE
  8536         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8537             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8538             IF FORM-MASTER-FOUND
  8539                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8540
  8541     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8542        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8543
  8544********************** MON CODE **********************
  8545     IF PB-COMPANY-ID = 'MON'
  8546     IF PB-ISSUE
  8547     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8548        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8549             PB-I-LOAN-APR = ZERO)
  8550               MOVE 14.0         TO PB-I-LOAN-APR.
  8551******************************************************
  8552
  8553     IF PB-COMPANY-ID = 'NCL'
  8554       IF PB-ISSUE
  8555           IF FORM-MASTER-FOUND
  8556             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8557                AM-DISMBR-COVERAGE
  8558                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8559                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8560                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8561                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8562                                           PB-I-LIFE-BENEFIT-CD.
  8563
  8564     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8565
  8566     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8567         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8568         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8569         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8570         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8571         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8572           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8573             GO TO 0301-LIFE-BENEFIT-SEARCH
  8574         ELSE
  8575             NEXT SENTENCE
  8576     ELSE
  8577         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8578
  8579     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8580     MOVE '4'                    TO CNTL-REC-TYPE.
  8581     MOVE +0                     TO CNTL-SEQ-NO.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 157
* EL050.cbl
  8582     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8583
  8584     MOVE '1' TO RC-SW-2.
  8585     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8586
  8587     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8588        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8589         GO TO 0305-BENEFIT-NOT-FOUND.
  8590
  8591     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8592
  8593 0301-LIFE-BENEFIT-SEARCH.
  8594
  8595     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8596
  8597     IF NO-BENEFIT-FOUND
  8598        GO TO 0305-BENEFIT-NOT-FOUND.
  8599
  8600     IF WS-BEN-CD = '99'
  8601        GO TO 0305-BENEFIT-NOT-FOUND.
  8602
  8603     IF PB-COMPANY-ID = 'NCL'
  8604         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8605             GO TO 0304-LIFE-BENEFIT-FOUND.
  8606
  8607     MOVE +1                     TO SUB5.
  8608     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8609
  8610* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8611* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8612     IF PB-COMPANY-ID = 'DMD'
  8613         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8614
  8615 0302-EDIT-ACCT-LF-BENEFITS.
  8616
  8617     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8618        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8619           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8620                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8621           GO TO 03XX-GET-LIFE-ERPLAN.
  8622
  8623     IF SUB5 LESS THAN +20
  8624        ADD +1                   TO SUB5
  8625        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8626
  8627     MOVE +1                     TO SUB5.
  8628
  8629     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8630        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8631
  8632 0303-EDIT-DMD-EXTRA-BENEFITS.
  8633
  8634     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8635        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8636           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8637                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8638           GO TO 03XX-GET-LIFE-ERPLAN.
  8639
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 158
* EL050.cbl
  8640     IF SUB5 LESS THAN +30
  8641        ADD +1                   TO SUB5
  8642        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8643
  8644     MOVE +1                     TO SUB5.
  8645
  8646 03XX-EDIT-FOR-NINETY-LF.
  8647
  8648***************************************************************
  8649*                                                             *
  8650*    NINETY BENEFIT PLAN TYPES:                               *
  8651*                                                             *
  8652*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8653*      92 = ALL GROUP REDUCING BENEFITS                       *
  8654*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8655*      94 = ALL GROUP LEVEL BENEFITS                          *
  8656*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8657*           BENEFIT CONTROLS.                                 *
  8658*      99 = ALL BENEFITS                                      *
  8659*                                                             *
  8660***************************************************************
  8661
  8662     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8663                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8664
  8665     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8666       AND
  8667        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8668        GO TO 03XX-GET-LIFE-ERPLAN.
  8669
  8670     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8671       AND
  8672        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8673        IF CF-REDUCING (SUB3)
  8674           IF (PB-I-INDV-GRP-OVRD = 'I')
  8675              OR
  8676           ((AM-IG = '1') AND
  8677           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8678              OR
  8679           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8680           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8681           (AM-IG NOT = '2'))
  8682              GO TO 03XX-GET-LIFE-ERPLAN.
  8683
  8684     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8685       AND
  8686        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8687        IF CF-REDUCING (SUB3)
  8688           IF (PB-I-INDV-GRP-OVRD = 'G')
  8689              OR
  8690           ((AM-IG = '2') AND
  8691           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8692              OR
  8693           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8694           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8695           (AM-IG NOT = '1'))
  8696              GO TO 03XX-GET-LIFE-ERPLAN.
  8697
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 159
* EL050.cbl
  8698     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8699       AND
  8700        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8701        IF CF-LEVEL    (SUB3)
  8702           IF (PB-I-INDV-GRP-OVRD = 'I')
  8703              OR
  8704           ((AM-IG = '1') AND
  8705           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8706              OR
  8707           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8708           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8709            (AM-IG NOT = '2'))
  8710              GO TO 03XX-GET-LIFE-ERPLAN.
  8711
  8712     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8713       AND
  8714        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8715        IF CF-LEVEL    (SUB3)
  8716           IF (PB-I-INDV-GRP-OVRD = 'G')
  8717              OR
  8718           ((AM-IG = '2') AND
  8719           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8720              OR
  8721           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8722           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8723           (AM-IG NOT = '1'))
  8724              GO TO 03XX-GET-LIFE-ERPLAN.
  8725
  8726     IF SUB5 LESS THAN +20
  8727        ADD +1                   TO SUB5
  8728        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8729
  8730     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8731
  8732     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8733        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8734
  8735     MOVE +1                     TO SUB5.
  8736
  8737 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8738
  8739     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8740                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8741
  8742     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8743       AND
  8744        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8745        GO TO 03XX-GET-LIFE-ERPLAN.
  8746
  8747     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8748       AND
  8749        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8750        IF CF-REDUCING (SUB3)
  8751           IF (PB-I-INDV-GRP-OVRD = 'I')
  8752              OR
  8753           ((AM-IG = '1') AND
  8754           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8755              OR
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 160
* EL050.cbl
  8756           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8757           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8758           (AM-IG NOT = '2'))
  8759              GO TO 03XX-GET-LIFE-ERPLAN.
  8760
  8761     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8762       AND
  8763        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8764        IF CF-REDUCING (SUB3)
  8765           IF (PB-I-INDV-GRP-OVRD = 'G')
  8766              OR
  8767           ((AM-IG = '2') AND
  8768           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8769              OR
  8770           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8771           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8772           (AM-IG NOT = '1'))
  8773              GO TO 03XX-GET-LIFE-ERPLAN.
  8774
  8775     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8776       AND
  8777        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8778        IF CF-LEVEL    (SUB3)
  8779           IF (PB-I-INDV-GRP-OVRD = 'I')
  8780              OR
  8781           ((AM-IG = '1') AND
  8782           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8783              OR
  8784           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8785           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8786            (AM-IG NOT = '2'))
  8787              GO TO 03XX-GET-LIFE-ERPLAN.
  8788
  8789     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8790       AND
  8791        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8792        IF CF-LEVEL    (SUB3)
  8793           IF (PB-I-INDV-GRP-OVRD = 'G')
  8794              OR
  8795           ((AM-IG = '2') AND
  8796           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8797              OR
  8798           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8799           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8800           (AM-IG NOT = '1'))
  8801              GO TO 03XX-GET-LIFE-ERPLAN.
  8802
  8803     IF SUB5 LESS THAN +30
  8804        ADD +1                   TO SUB5
  8805        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8806
  8807     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8808
  8809 03XX-EDIT-FOR-NINETY-LF-CONT.
  8810
  8811     MOVE +99                    TO SUB5.
  8812
  8813     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 161
* EL050.cbl
  8814        IF PB-ISSUE
  8815           MOVE ER-1924          TO  WS-ERROR
  8816           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8817
  8818     GO TO 0304-LIFE-BENEFIT-FOUND.
  8819
  8820 03XX-GET-LIFE-ERPLAN.
  8821
  8822     IF WK-PLAN-ADDR EQUAL +0
  8823        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8824
  8825     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8826     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8827     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8828     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8829     MOVE 'Y'                    TO PLAN-MASTER-SW
  8830                                    PLAN-MASTER-LIFE-SW.
  8831     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8832
  8833 03XX-ERPLAN-LIFE-GETMAIN.
  8834
  8835     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8836     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8837
  8838 03XX-ERPLAN-LIFE-READ.
  8839
  8840     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8841     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8842     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8843     MOVE PB-SV-STATE            TO PLAN-STATE.
  8844     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8845     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8846     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8847     MOVE WS-SAVE-BENEFIT-REVISION
  8848                                 TO PLAN-REVISION-NO.
  8849
  8850     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8851     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8852
  8853     IF PB-COMPANY-ID = 'NCL'
  8854       IF NOT LF-PLAN-MASTER-FOUND
  8855         IF NOT PB-POLICY-IS-DECLINED  AND
  8856            NOT PB-POLICY-IS-VOIDED
  8857             MOVE  ER-1921         TO  WS-ERROR
  8858             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8859             GO TO 0304-LIFE-BENEFIT-FOUND.
  8860
  8861     IF NOT LF-PLAN-MASTER-FOUND
  8862        GO TO 0304-LIFE-BENEFIT-FOUND.
  8863
  8864 XXXX-CHECK-LF-PLAN-KEY.
  8865
  8866     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8867        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8868        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8869        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8870        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8871        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 162
* EL050.cbl
  8872        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8873        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8874        MOVE 'N'                 TO PLAN-MASTER-SW
  8875          GO TO 03XX-ERPLAN-LIFE-READ.
  8876
  8877     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8878
  8879     IF  PB-CANCELLATION
  8880         GO TO  0303-LF-ACCT-BEN-FOUND.
  8881
  8882     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8883        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8884           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8885           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8886              MOVE ER-2644             TO WS-ERROR
  8887              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8888           ELSE
  8889              NEXT SENTENCE
  8890        ELSE
  8891           IF PB-COMPANY-ID NOT = 'NCL'
  8892              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8893                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8894
  8895 0303-LF-ACCT-BEN-FOUND.
  8896
  8897     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8898
  8899     IF PL-DEV-CODE NOT = SPACES
  8900        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8901
  8902     IF PL-DEV-PCT NUMERIC AND
  8903        PL-DEV-PCT NOT = ZEROS
  8904        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8905
  8906     IF PL-TOL-PREM-AMT GREATER THAN +0
  8907        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8908
  8909     IF PL-TOL-REF-AMT GREATER THAN +0
  8910        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8911
  8912     IF PL-TOL-PREM-PCT GREATER THAN +0
  8913        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8914
  8915     IF PL-TOL-REF-PCT GREATER THAN +0
  8916        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8917
  8918     IF PL-TOL-CLM-AMT GREATER THAN +0
  8919        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8920
  8921     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8922                          PL-OVER-SHORT-AMT > +0
  8923        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8924
  8925     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8926                          PL-OVER-SHORT-PCT > +0
  8927        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8928
  8929     IF PL-SALES-TAX NUMERIC AND
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 163
* EL050.cbl
  8930                          PL-SALES-TAX > +0
  8931         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8932
  8933     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8934        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8935                                    WS-IG-OVRD-AM.
  8936
  8937 0304-LIFE-BENEFIT-FOUND.
  8938
  8939     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8940
  8941     IF PB-ISSUE
  8942        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8943     ELSE
  8944        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8945
  8946     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8947     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8948     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8949     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8950     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8951                                         WS-LF-REFUND-CALC.
  8952     if (ws-lf-earnings-calc = '5')
  8953        and (pb-i-loan-apr = zeros)
  8954        and (benefit-code-chg)
  8955        move +99.9999 to pb-i-loan-apr
  8956     end-if
  8957
  8958     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8959        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8960
  8961     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  8962        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8963     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8964
  8965     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8966     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8967     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8968     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8969     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8970     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8971
  8972     IF PB-COMPANY-ID = 'NCL'  AND
  8973        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8974         NEXT SENTENCE
  8975     ELSE
  8976         IF SUB5 NOT GREATER THAN +20
  8977            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8978               MOVE WS-SAVE-BENEFIT-REM-TERM
  8979                                      TO WS-AM-LF-BENE-REM-TERM
  8980                                         EC-BR-LF-REM-TERM-CALC.
  8981
  8982     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8983     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8984
  8985     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8986
  8987 0305-BENEFIT-NOT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 164
* EL050.cbl
  8988
  8989     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8990     MOVE ER-2604                TO WS-ERROR.
  8991     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8992
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 165
* EL050.cbl
  8994
  8995 0310-FIND-AH-BENEFIT-RECORD.
  8996
  8997     MOVE 'N'                    TO PLAN-MASTER-SW
  8998                                    PLAN-MASTER-AH-SW.
  8999
  9000     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  9001                                    WS-PL-TOL-AH-REFUND
  9002                                    WS-AH-PL-REF-OVS-AMT
  9003                                    WS-PL-TOL-AH-PREM-PCT
  9004                                    WS-PL-TOL-AH-REFUND-PCT
  9005                                    WS-AH-PL-REF-OVS-PCT
  9006                                    WS-PL-TOL-AH-CLAIM.
  9007     MOVE ' '                    TO WS-AH-DCC-TRUNC
  9008
  9009
  9010     if pb-issue
  9011        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  9012           MOVE SPACES              TO PB-I-AH-INPUT-CD
  9013        end-if
  9014        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  9015           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  9016           GO TO 0399-BENEFIT-NOT-FOUND
  9017        end-if
  9018     end-if
  9019
  9020     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  9021        GO TO 0400-FIND-CARRIER.
  9022
  9023     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9024
  9025     IF WK-AH-BEN-ADDR NOT = ZEROS
  9026         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  9027         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9028         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9029         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  9030           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  9031             GO TO 0311-AH-BENEFIT-SEARCH
  9032         ELSE
  9033             NEXT SENTENCE
  9034     ELSE
  9035         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9036
  9037     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9038     MOVE '5'                    TO CNTL-REC-TYPE.
  9039     MOVE +0                     TO CNTL-SEQ-NO.
  9040     MOVE WS-ACCESS              TO CNTL-ACCESS.
  9041
  9042     MOVE '2' TO RC-SW-2.
  9043     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9044
  9045     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  9046        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  9047          GO TO 0399-BENEFIT-NOT-FOUND.
  9048
  9049     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  9050
  9051 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 166
* EL050.cbl
  9052
  9053     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9054
  9055     IF NO-BENEFIT-FOUND
  9056         GO TO 0399-BENEFIT-NOT-FOUND.
  9057
  9058     IF WS-BEN-CD = '99'
  9059        GO TO 0399-BENEFIT-NOT-FOUND.
  9060
  9061     IF PB-COMPANY-ID  =  'NCL'
  9062         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9063             GO TO 0314-A-H-BENEFIT-FOUND.
  9064
  9065     MOVE +1                     TO SUB5.
  9066     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9067
  9068* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  9069* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  9070     IF PB-COMPANY-ID = 'DMD'
  9071         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  9072
  9073 0312-EDIT-ACCT-AH-BENEFITS.
  9074
  9075     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9076        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  9077           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9078                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9079           GO TO 03XX-GET-AH-ERPLAN.
  9080
  9081     IF SUB5 LESS THAN +20
  9082        ADD +1                   TO SUB5
  9083        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  9084
  9085     MOVE +1                     TO SUB5.
  9086
  9087     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9088        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9089
  9090 0313-EDIT-DMD-EXTRA-BENEFITS.
  9091
  9092     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9093        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  9094           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9095                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9096           GO TO 03XX-GET-AH-ERPLAN.
  9097
  9098     IF SUB5 LESS THAN +30
  9099        ADD +1                   TO SUB5
  9100        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  9101
  9102     MOVE +1                     TO SUB5.
  9103
  9104 03XX-EDIT-FOR-NINETY-AH.
  9105
  9106***************************************************************
  9107*                                                             *
  9108*    NINETY BENEFIT PLAN TYPES:                               *
  9109*                                                             *
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 167
* EL050.cbl
  9110*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9111*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9112*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9113*           BENEFIT CONTROLS.                                 *
  9114*      99 = ALL BENEFITS.                                     *
  9115*                                                             *
  9116***************************************************************
  9117
  9118     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9119                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9120
  9121     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  9122       AND
  9123        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9124        GO TO 03XX-GET-AH-ERPLAN.
  9125
  9126     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  9127       AND
  9128        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9129           IF (PB-I-INDV-GRP-OVRD = 'I')
  9130              OR
  9131           ((AM-IG = '1') AND
  9132           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9133              OR
  9134           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9135           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9136           (AM-IG NOT = '2'))
  9137              GO TO 03XX-GET-AH-ERPLAN.
  9138
  9139     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  9140       AND
  9141        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9142           IF (PB-I-INDV-GRP-OVRD = 'G')
  9143              OR
  9144           ((AM-IG = '2') AND
  9145           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9146              OR
  9147           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9148           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9149           (AM-IG NOT = '1'))
  9150              GO TO 03XX-GET-AH-ERPLAN.
  9151
  9152     IF SUB5 LESS THAN +20
  9153        ADD +1                   TO SUB5
  9154        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9155
  9156     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9157        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9158
  9159     MOVE +1                    TO SUB5.
  9160
  9161 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9162
  9163     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9164                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9165
  9166     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9167       AND
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 168
* EL050.cbl
  9168        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9169        GO TO 03XX-GET-AH-ERPLAN.
  9170
  9171     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9172       AND
  9173        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9174           IF (PB-I-INDV-GRP-OVRD = 'I')
  9175              OR
  9176           ((AM-IG = '1') AND
  9177           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9178              OR
  9179           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9180           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9181           (AM-IG NOT = '2'))
  9182              GO TO 03XX-GET-AH-ERPLAN.
  9183
  9184     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9185       AND
  9186        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9187           IF (PB-I-INDV-GRP-OVRD = 'G')
  9188              OR
  9189           ((AM-IG = '2') AND
  9190           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9191              OR
  9192           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9193           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9194           (AM-IG NOT = '1'))
  9195              GO TO 03XX-GET-AH-ERPLAN.
  9196
  9197     IF SUB5 LESS THAN +30
  9198        ADD +1                   TO SUB5
  9199        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9200
  9201 03XX-EDIT-FOR-NINETY-AH-CONT.
  9202
  9203     MOVE +99                    TO SUB5.
  9204
  9205     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9206
  9207     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9208        IF PB-ISSUE
  9209           MOVE ER-1925          TO  WS-ERROR
  9210           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9211
  9212     GO TO 0314-A-H-BENEFIT-FOUND.
  9213
  9214 03XX-GET-AH-ERPLAN.
  9215
  9216     IF WK-PLAN-ADDR EQUAL +0
  9217         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9218
  9219     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9220     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9221     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9222     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9223     MOVE 'Y'                    TO PLAN-MASTER-SW
  9224                                    PLAN-MASTER-AH-SW.
  9225*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 169
* EL050.cbl
  9226     GO TO 03XX-ERPLAN-AH-READ.
  9227
  9228 03XX-ERPLAN-AH-GETMAIN.
  9229
  9230     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9231     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9232
  9233 03XX-ERPLAN-AH-READ.
  9234
  9235     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9236     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9237     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9238     MOVE PB-SV-STATE            TO PLAN-STATE.
  9239     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9240     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9241     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9242     MOVE WS-SAVE-BENEFIT-REVISION
  9243                                 TO PLAN-REVISION-NO.
  9244
  9245     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9246     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9247
  9248     IF PB-COMPANY-ID = 'NCL'
  9249       IF NOT AH-PLAN-MASTER-FOUND
  9250         IF NOT PB-POLICY-IS-DECLINED  AND
  9251            NOT PB-POLICY-IS-VOIDED
  9252             MOVE  ER-1922         TO  WS-ERROR
  9253             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9254             GO TO 0314-A-H-BENEFIT-FOUND.
  9255
  9256     IF NOT AH-PLAN-MASTER-FOUND
  9257        GO TO 0314-A-H-BENEFIT-FOUND.
  9258
  9259 XXXX-CHECK-AH-PLAN-KEY.
  9260
  9261     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9262        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9263        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9264        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9265        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9266        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9267        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9268        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9269        MOVE 'N'                 TO PLAN-MASTER-SW
  9270          GO TO 03XX-ERPLAN-AH-READ.
  9271
  9272     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9273
  9274     IF  PB-CANCELLATION
  9275         GO TO  0313-AH-ACCT-BEN-FOUND.
  9276
  9277     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9278       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9279          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9280          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9281             MOVE ER-2644             TO WS-ERROR
  9282             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9283          ELSE
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 170
* EL050.cbl
  9284             NEXT SENTENCE
  9285       ELSE
  9286          IF PB-COMPANY-ID NOT = 'NCL'
  9287             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9288                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9289
  9290 0313-AH-ACCT-BEN-FOUND.
  9291
  9292     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9293
  9294     IF PL-DEV-CODE NOT = SPACES
  9295        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9296
  9297     IF PL-DEV-PCT NUMERIC AND
  9298        PL-DEV-PCT NOT = ZEROS
  9299        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9300
  9301     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9302        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9303
  9304     IF PL-TOL-REF-AMT NOT EQUAL +0
  9305        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9306
  9307     IF PL-TOL-PREM-PCT GREATER THAN +0
  9308        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9309
  9310     IF PL-TOL-REF-PCT GREATER THAN +0
  9311        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9312
  9313     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9314        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9315
  9316     IF PL-OVER-SHORT-AMT NUMERIC AND
  9317                          PL-OVER-SHORT-AMT > +0
  9318        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9319
  9320     IF PL-OVER-SHORT-PCT NUMERIC AND
  9321                          PL-OVER-SHORT-PCT > +0
  9322        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9323
  9324     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9325        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9326        IF WS-IG-OVRD-AM EQUAL SPACES
  9327            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9328
  9329 0314-A-H-BENEFIT-FOUND.
  9330
  9331     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9332
  9333     IF PB-ISSUE
  9334        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9335       ELSE
  9336        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9337
  9338     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD
  9339     if cf-maximum-benefits (sub3) numeric
  9340        move cf-maximum-benefits (sub3)
  9341                                 to ws-ah-max-bens
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 171
* EL050.cbl
  9342     else
  9343        move zeros               to ws-ah-max-bens
  9344     end-if
  9345     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9346     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9347     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
  9348                                         WS-AH-REFUND-CALC.
  9349
  9350     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9351        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9352
  9353     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9354        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9355     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9356
  9357     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9358     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9359     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9360     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9361     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9362     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9363
  9364     IF PB-COMPANY-ID = 'NCL'  AND
  9365        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9366         NEXT SENTENCE
  9367     ELSE
  9368         IF SUB5 NOT GREATER THAN +20
  9369            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9370                MOVE WS-SAVE-BENEFIT-REM-TERM
  9371                                      TO WS-AM-AH-BENE-REM-TERM
  9372                                         EC-BR-AH-REM-TERM-CALC.
  9373
  9374     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9375     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9376
  9377     GO TO 0400-FIND-CARRIER.
  9378
  9379 0399-BENEFIT-NOT-FOUND.
  9380
  9381     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9382     MOVE ER-2605                TO WS-ERROR.
  9383     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9384
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 172
* EL050.cbl
  9386
  9387 0400-FIND-CARRIER.
  9388
  9389     MOVE PB-SV-CARRIER          TO WS-CARR.
  9390
  9391     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9392     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9393     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9394     MOVE '6'                    TO CNTL-REC-TYPE.
  9395
  9396*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9397     MOVE SPACE                  TO WS-DMD-RATING-SW
  9398                                    EC-BR-DMD-RATING-SW.
  9399
  9400     MOVE '2'                    TO RC-SW-1.
  9401     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9402
  9403     IF NOT CF-CARRIER-MASTER
  9404        GO TO 0400-CARRIER-NOT-FOUND.
  9405
  9406 0400-BUILD-CARR-TOL.
  9407
  9408     IF CF-CR-TOL-PREM NUMERIC AND
  9409        CF-CR-TOL-PREM GREATER THAN +0
  9410        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9411                                    WS-TOL-AH-PREM.
  9412
  9413     IF CF-CR-TOL-REFUND NUMERIC AND
  9414        CF-CR-TOL-REFUND GREATER THAN +0
  9415        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9416                                    WS-TOL-AH-REFUND.
  9417
  9418     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9419        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9420        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9421                                    WS-AH-REFUND-OVS-AMT.
  9422
  9423     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9424        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9425        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9426                                    WS-AH-REFUND-OVS-PCT.
  9427
  9428     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9429        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9430        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9431                                    WS-TOL-AH-PREM-PCT.
  9432
  9433     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9434        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9435        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9436                                     WS-TOL-AH-REFUND-PCT.
  9437
  9438     IF CF-COMPANY-ID EQUAL 'DMD'
  9439         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9440                                    EC-BR-DMD-RATING-SW.
  9441
  9442     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9443     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 173
* EL050.cbl
  9444        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9445     END-IF
  9446     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9447        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9448     END-IF
  9449     IF WS-TOL-CLP-PCT = ZEROS
  9450        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9451     END-IF
  9452
  9453     IF WS-SPP-LEASE-COMM = ZEROS
  9454        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9455     END-IF
  9456     GO TO 0400-FIND-ERPDEF.
  9457
  9458 0400-CARRIER-NOT-FOUND.
  9459
  9460     MOVE ER-2602                TO WS-ERROR.
  9461     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9462
  9463 0400-FIND-ERPDEF.
  9464*    IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  9465     IF (PB-COMPANY-ID = 'DCC')
  9466        AND (AM-DCC-PRODUCT-CODE <> spaces)
  9467        CONTINUE
  9468     ELSE
  9469        GO TO 0400-FIND-ERCOMP
  9470     END-IF
  9471     MOVE ' '                    TO PDEF-MASTER-SW
  9472     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9473     MOVE PB-STATE               TO ERPDEF-STATE
  9474     IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
  9475        MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
  9476     END-IF
  9477     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9478     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9479     IF PB-ISSUE
  9480        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9481     ELSE
  9482        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9483     END-IF
  9484     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9485     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9486     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9487     IF PDEF-MASTER-FOUND
  9488        MOVE 'N'                 TO PDEF-MASTER-SW
  9489        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9490        IF PDEF-MASTER-FOUND
  9491           IF (ERPDEF-KEY-SAVE (1:16) =
  9492                        PD-CONTROL-PRIMARY (1:16))
  9493              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9494              CONTINUE
  9495           ELSE
  9496              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9497              IF (ERPDEF-KEY-SAVE (1:16) =
  9498                        PD-CONTROL-PRIMARY (1:16))
  9499                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9500                 CONTINUE
  9501              ELSE
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 174
* EL050.cbl
  9502                 MOVE 'N'        TO PDEF-MASTER-SW
  9503              END-IF
  9504           END-IF
  9505        END-IF
  9506        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9507     END-IF
  9508     IF PDEF-MASTER-FOUND
  9509        IF PD-TRUNCATED = 'Y'
  9510           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9511        END-IF
  9512     END-IF
  9513     .
  9514 0400-FIND-ERCOMP.
  9515     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9516        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9517           (WS-SUB1 > +10)
  9518           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9519                 OR 'A' OR 'N'
  9520              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9521              MOVE PB-CARRIER    TO COMP-CARRIER
  9522              MOVE PB-GROUPING   TO COMP-GROUPING
  9523              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9524              MOVE AM-AGT (WS-SUB1)
  9525                                 TO COMP-FIN-RESP
  9526              MOVE 'G'           TO COMP-TYPE
  9527              PERFORM 8582-READ-COMPENSATION-MASTER
  9528                                 THRU 8582-EXIT
  9529              IF COMP-MASTER-FOUND
  9530                 IF CO-GA-INACTIVE
  9531                    MOVE ER-2763 TO WS-ERROR
  9532                    PERFORM 9900-ERROR-FORMAT
  9533                                 THRU 9900-EXIT
  9534                    MOVE +11     TO WS-SUB1
  9535                 END-IF
  9536                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9537                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9538                    MOVE ER-2788 TO WS-ERROR
  9539                    PERFORM 9900-ERROR-FORMAT
  9540                                 THRU 9900-EXIT
  9541                    MOVE +11     TO WS-SUB1
  9542                 END-IF
  9543              END-IF
  9544           END-IF
  9545        END-PERFORM
  9546     END-IF
  9547     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9548        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9549           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9550                                    WS-CLP-STATE
  9551        ELSE
  9552           MOVE SPACES           TO PB-I-CLP-STATE
  9553                                    WS-CLP-STATE
  9554        END-IF
  9555     END-IF
  9556
  9557     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  9558        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9559        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 175
* EL050.cbl
  9560        CONTINUE
  9561     ELSE
  9562        GO TO 0400-FIND-STATE-RECORD
  9563     END-IF
  9564     MOVE SPACES                 TO WS-CLP-STATE
  9565     MOVE +0                     TO WS-BANK-FEE
  9566                                    WS-BANK-LFEE
  9567                                    WS-BANK-NOCHRGB
  9568
  9569     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9570     IF (PB-ISSUE)
  9571        AND (PB-I-BANK-NUMBER NOT =
  9572            SPACES AND ZEROS AND LOW-VALUES)
  9573        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9574     ELSE
  9575        IF (PB-CANCELLATION)
  9576           AND (PB-CI-BANK-NUMBER NOT =
  9577                SPACES AND ZEROS AND LOW-VALUES)
  9578           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9579        END-IF
  9580     END-IF
  9581     IF COMP-FIN-RESP NOT = LOW-VALUES
  9582        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9583        MOVE PB-CARRIER          TO COMP-CARRIER
  9584        MOVE PB-GROUPING         TO COMP-GROUPING
  9585        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9586        MOVE 'B'                 TO COMP-TYPE
  9587        PERFORM 8582-READ-COMPENSATION-MASTER
  9588                                 THRU 8582-EXIT
  9589        IF COMP-MASTER-FOUND
  9590           IF CO-MAX-BANK-FEE NOT NUMERIC
  9591              MOVE +0            TO CO-MAX-BANK-FEE
  9592           END-IF
  9593           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9594              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9595           END-IF
  9596           IF CO-GA-INACTIVE
  9597              MOVE ER-2763       TO WS-ERROR
  9598              PERFORM 9900-ERROR-FORMAT
  9599                                 THRU 9900-EXIT
  9600           END-IF
  9601           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9602              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9603              MOVE ER-2788 TO WS-ERROR
  9604              PERFORM 9900-ERROR-FORMAT
  9605                                 THRU 9900-EXIT
  9606              MOVE +11     TO WS-SUB1
  9607           END-IF
  9608           IF WS-AH-BEN-CATEGORY = 'G'
  9609              MOVE CO-MAX-BANK-FEE
  9610                                 TO WS-BANK-FEE
  9611                                    PB-I-BANK-FEE
  9612           ELSE
  9613              MOVE CO-MAX-BANK-FEE-LEASE
  9614                                 TO WS-BANK-LFEE
  9615                                    PB-I-BANK-FEE
  9616           END-IF
  9617           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 176
* EL050.cbl
  9618              AND (WS-AH-REFUND-CALC = 'G'))
  9619                        OR
  9620              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9621              AND (WS-AH-REFUND-CALC NOT = 'G'))
  9622              CONTINUE
  9623           ELSE
  9624              MOVE ER-2789 TO WS-ERROR
  9625              PERFORM 9900-ERROR-FORMAT
  9626                                 THRU 9900-EXIT
  9627           END-IF
  9628           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9629                                    PB-I-CLP-STATE
  9630           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9631           MOVE CO-CARRIER       TO BXRF-CARRIER
  9632           MOVE CO-GROUPING      TO BXRF-GROUPING
  9633           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9634           MOVE BXRF-MAX-REC-LENGTH
  9635                                 TO BXRF-REC-LENGTH
  9636           PERFORM 8584-READ-BANK-CROSS-REF
  9637                                 THRU 8584-EXIT
  9638           IF BXRF-MASTER-FOUND
  9639              MOVE ' '           TO BANK-ACCT-SW
  9640              MOVE BK-BANK-POINTER-CNT
  9641                                 TO BK-BANK-POINTER-CNT
  9642              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9643                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9644                 OR (BANK-ACCT-FOUND)
  9645                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9646                    AND (BK-AM-EXP-DT (WS-SUB1)
  9647                                 > PB-CERT-EFF-DT)
  9648                    AND (BK-AM-EFF-DT (WS-SUB1)
  9649                                 NOT > PB-CERT-EFF-DT)
  9650                    SET BANK-ACCT-FOUND TO TRUE
  9651                 END-IF
  9652              END-PERFORM
  9653              IF NOT BANK-ACCT-FOUND
  9654                 MOVE ZEROS      TO WS-BANK-FEE
  9655                                    WS-BANK-LFEE
  9656                 MOVE ER-2869    TO WS-ERROR
  9657                 PERFORM 9900-ERROR-FORMAT
  9658                                 THRU 9900-EXIT
  9659              ELSE
  9660                 PERFORM 5000-PROCESS-REPS
  9661                                 THRU 5000-EXIT
  9662                 IF AGENT-MASTER-FOUND
  9663                    MOVE +0      TO WS-BANK-FEE
  9664                                    WS-BANK-LFEE
  9665*                   MOVE AG-SPP-FEES (1)
  9666*                                TO PB-I-BANK-FEE
  9667*                                   WS-BANK-FEE
  9668                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9669                       (WS-SUB1 > +10)
  9670                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9671                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9672                       END-IF
  9673                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9674                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9675                       END-IF
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 177
* EL050.cbl
  9676                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9677                          AG-SPP-FEES (WS-SUB1)
  9678                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9679                          AG-SPP-LFEES (WS-SUB1)
  9680                    END-PERFORM
  9681                    IF WS-AH-BEN-CATEGORY = 'G'
  9682                       MOVE WS-BANK-FEE
  9683                                 TO PB-I-BANK-FEE
  9684                    ELSE
  9685                       MOVE WS-BANK-LFEE
  9686                                 TO PB-I-BANK-FEE
  9687                    END-IF
  9688                 END-IF
  9689              END-IF
  9690           END-IF
  9691        ELSE
  9692           MOVE ER-2879          TO WS-ERROR
  9693           PERFORM 9900-ERROR-FORMAT
  9694                                 THRU 9900-EXIT
  9695        END-IF
  9696     ELSE
  9697        MOVE ER-2879             TO WS-ERROR
  9698        PERFORM 9900-ERROR-FORMAT
  9699                                 THRU 9900-EXIT
  9700     END-IF
  9701     IF WS-AH-BEN-CATEGORY = 'G'
  9702        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9703        + WS-BANK-FEE
  9704     ELSE
  9705        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9706        + WS-BANK-LFEE
  9707     END-IF
  9708     .
  9709 0400-FIND-STATE-RECORD.
  9710
  9711     IF WK-STATE-ADDR NOT = ZEROS
  9712         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9713         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9714         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9715         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9716         IF PB-SV-STATE = CF-STATE-CODE
  9717             GO TO 0405-CONTINUE-EDIT
  9718         ELSE
  9719             NEXT SENTENCE
  9720     ELSE
  9721         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9722
  9723     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9724     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9725     MOVE '3'                    TO CNTL-REC-TYPE.
  9726     MOVE +0                     TO CNTL-SEQ-NO.
  9727
  9728     MOVE '3'                    TO RC-SW-2.
  9729     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9730
  9731     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9732        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9733        PB-SV-STATE   NOT = CF-STATE-CODE)
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 178
* EL050.cbl
  9734        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9735                                    WS-TOL-AH-CLAIM
  9736                                    WS-MINIMUM-REFUND
  9737                                    WS-TOL-LF-PREM
  9738                                    WS-TOL-AH-PREM
  9739                                    WS-TOL-LF-REFUND
  9740                                    WS-TOL-AH-REFUND
  9741                                    EC-ST-TOL-PREM-PCT
  9742                                    WS-TOL-LF-PREM-PCT
  9743                                    WS-TOL-AH-PREM-PCT
  9744                                    EC-ST-TOL-REFUND-PCT
  9745                                    WS-TOL-LF-REFUND-PCT
  9746                                    WS-TOL-AH-REFUND-PCT
  9747                                    EC-ST-TOL-PREM
  9748                                    EC-ST-TOL-REFUND
  9749                                    EC-ST-FST-PMT-DAYS-MAX
  9750                                    WS-FREE-LOOK-PERIOD
  9751                                    WS-ST-LF-PREM-TAX
  9752                                    WS-ST-AH-PREM-TAX-I
  9753                                    WS-ST-AH-PREM-TAX-G
  9754                                    WS-BANK-FEE
  9755                                    WS-BANK-LFEE
  9756                                    WS-TOL-CLP-PCT
  9757                                    WS-SPP-LEASE-COMM
  9758                                    WS-INT-PERIODS
  9759                                    WS-EXTRA-PMTS
  9760        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9761                                    EC-ST-FST-PMT-DAYS-CHG
  9762                                    WS-LF-REM-TERM-CALC
  9763                                    WS-LF-REFUND-CALC
  9764                                    EC-ST-LF-REM-TERM-CALC
  9765                                    EC-ST-LF-REFUND-CALC
  9766                                    WS-AH-REM-TERM-CALC
  9767                                    WS-AH-REFUND-CALC
  9768                                    WS-LF-BEN-CATEGORY
  9769                                    WS-AH-BEN-CATEGORY
  9770                                    WS-CLP-STATE
  9771                                    WS-ST-REFUND-CLAIM-FLAG
  9772                                    WS-ST-CAUSAL-STATE
  9773                                    ws-st-agent-sig-edit
  9774                                    EC-ST-AH-REM-TERM-CALC
  9775                                    EC-ST-AH-REFUND-CALC
  9776          GO TO 0499-STATE-NOT-FOUND.
  9777
  9778     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9779
  9780 0405-CONTINUE-EDIT.
  9781
  9782     if pb-company-id = 'AHL'
  9783        continue
  9784     else
  9785        IF PB-CERT-PRIME NOT NUMERIC
  9786           MOVE ER-2722          TO WS-ERROR
  9787           PERFORM 9900-ERROR-FORMAT
  9788                                 THRU 9900-EXIT
  9789        end-if
  9790     END-IF
  9791*    IF PB-COMPANY-ID = 'CID' OR 'DCC' or 'VPP'
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 179
* EL050.cbl
  9792*       MOVE +0                  TO SUB3
  9793*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9794*       IF SUB3 > +0
  9795*          MOVE ER-2722          TO WS-ERROR
  9796*          PERFORM 9900-ERROR-FORMAT
  9797*                                THRU 9900-EXIT
  9798*       END-IF
  9799*    END-IF
  9800*    IF PB-COMPANY-ID = 'CID' OR 'DCC' or 'VPP'
  9801*       IF PB-CERT-PRIME NOT NUMERIC
  9802*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9803*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9804*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9805*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9806*
  9807*          MOVE ER-2722          TO WS-ERROR
  9808*          PERFORM 9900-ERROR-FORMAT
  9809*                                THRU 9900-EXIT
  9810*       END-IF
  9811*    END-IF
  9812
  9813     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9814
  9815     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9816        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9817                                    WS-TOL-AH-CLAIM.
  9818
  9819     IF CF-ST-REFUND-MIN NOT NUMERIC
  9820        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9821
  9822     IF CF-ST-REFUND-MIN NOT = ZEROS
  9823        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9824
  9825     IF CF-ST-TOL-PREM  NOT = ZEROS
  9826        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9827                                    WS-TOL-AH-PREM
  9828        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9829
  9830     IF CF-ST-TOL-REFUND NOT = ZEROS
  9831        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9832                                    WS-TOL-AH-REFUND
  9833        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9834
  9835     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9836        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9837        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9838                                    WS-AH-REFUND-OVS-AMT
  9839                                    EC-ST-OVR-SHT-AMT.
  9840
  9841     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9842        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9843        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9844                                    WS-TOL-LF-PREM-PCT
  9845                                    WS-TOL-AH-PREM-PCT.
  9846
  9847     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9848        CF-ST-TOL-REF-PCT GREATER THAN +0
  9849        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 180
* EL050.cbl
  9850                                    WS-TOL-LF-REFUND-PCT
  9851                                    WS-TOL-AH-REFUND-PCT.
  9852
  9853     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9854        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9855        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9856                                    WS-AH-REFUND-OVS-PCT
  9857                                    EC-ST-OVR-SHT-PCT.
  9858
  9859     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9860     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9861
  9862     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9863          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9864
  9865     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9866     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9867     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9868
  9869     IF CF-ST-LF-PREM-TAX NUMERIC
  9870        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9871     END-IF
  9872     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9873        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9874     END-IF
  9875     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9876        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9877     END-IF
  9878
  9879     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9880         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9881     END-IF.
  9882
  9883     IF CF-ST-CAUSAL-STATE > SPACES
  9884         MOVE CF-ST-CAUSAL-STATE TO WS-ST-CAUSAL-STATE
  9885     END-IF.
  9886     if cf-st-extra-interest-periods not numeric
  9887        move zeros               to cf-st-extra-interest-periods
  9888     end-if
  9889     if cf-st-extra-payments not numeric
  9890        move zeros               to cf-st-extra-payments
  9891     end-if
  9892
  9893     move cf-st-extra-interest-periods
  9894                                 to ws-int-periods
  9895     move cf-st-extra-payments   to ws-extra-pmts
  9896     move cf-st-agent-sig-edit   to ws-st-agent-sig-edit
  9897     move cf-st-net-only-state   to ws-net-only-state
  9898     IF WS-LF-BENEFIT-CD = ZEROS
  9899        GO TO 0410-CHECK-AH.
  9900
  9901     IF CF-ST-RT-CALC NOT = SPACES
  9902        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9903                                    EC-ST-LF-REM-TERM-CALC
  9904     END-IF
  9905
  9906     IF WS-LF-COVERAGE-TYPE = 'R'
  9907        IF WS-LF-EARNINGS-CALC = '5'
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 181
* EL050.cbl
  9908           IF CF-ST-RF-LN-CALC > '0'
  9909              MOVE CF-ST-RF-LN-CALC
  9910                                 TO WS-LF-REFUND-CALC
  9911                                    EC-ST-LF-REFUND-CALC
  9912           END-IF
  9913        ELSE
  9914           IF CF-ST-RF-LR-CALC > '0'
  9915              MOVE CF-ST-RF-LR-CALC
  9916                                 TO WS-LF-REFUND-CALC
  9917                                    EC-ST-LF-REFUND-CALC
  9918           END-IF
  9919        END-IF
  9920     ELSE
  9921        IF CF-ST-RF-LL-CALC > '0'
  9922           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9923                                    EC-ST-LF-REFUND-CALC
  9924        END-IF
  9925     END-IF
  9926
  9927     IF CF-ST-RT-CALC NOT = SPACES
  9928        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9929                                    EC-ST-LF-REM-TERM-CALC
  9930     END-IF
  9931
  9932     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9933     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9934
  9935     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9936
  9937     IF NO-BENEFIT-FOUND
  9938        GO TO 0410-CHECK-AH.
  9939
  9940     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9941        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9942                                 TO EC-ST-LF-REM-TERM-CALC
  9943                                    WS-LF-REM-TERM-CALC
  9944     END-IF
  9945
  9946     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9947        MOVE CF-ST-REFUND-CALC (SUB3)
  9948                                 TO WS-LF-REFUND-CALC
  9949                                    EC-ST-LF-REFUND-CALC
  9950     END-IF
  9951*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9952     if cf-st-extra-periods (sub3) not numeric
  9953        move zeros               to cf-st-extra-periods (sub3)
  9954     end-if
  9955     if cf-st-extra-periods (sub3) > zeros
  9956        if ws-lf-ben-category = 'P'
  9957           move cf-st-extra-periods (sub3)
  9958                                 to ws-extra-pmts
  9959        else
  9960           if ws-lf-ben-category = 'I'
  9961              move cf-st-extra-periods (sub3)
  9962                                 to ws-int-periods
  9963           end-if
  9964        end-if
  9965     end-if
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 182
* EL050.cbl
  9966     .
  9967 0410-CHECK-AH.
  9968
  9969     IF WS-AH-BENEFIT-CD = ZEROS
  9970        GO TO 0500-SET-ACCOUNT.
  9971
  9972     IF CF-ST-RT-CALC NOT = SPACES
  9973        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9974                                    EC-ST-AH-REM-TERM-CALC
  9975     END-IF
  9976
  9977     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9978        IF CF-ST-RF-CP-CALC > '0'
  9979           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9980                                    EC-ST-AH-REFUND-CALC
  9981        END-IF
  9982     ELSE
  9983        IF CF-ST-RF-AH-CALC > '0'
  9984           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9985                                    EC-ST-AH-REFUND-CALC
  9986        END-IF
  9987     END-IF
  9988     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9989     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9990
  9991     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9992
  9993     IF NO-BENEFIT-FOUND
  9994        GO TO 0500-SET-ACCOUNT.
  9995
  9996     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9997        MOVE CF-ST-REM-TERM-CALC (SUB3)
  9998                                 TO WS-AH-REM-TERM-CALC
  9999                                    EC-ST-AH-REM-TERM-CALC
 10000     END-IF
 10001
 10002     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
 10003        MOVE CF-ST-REFUND-CALC (SUB3)
 10004                                 TO WS-AH-REFUND-CALC
 10005                                    EC-ST-AH-REFUND-CALC
 10006     END-IF
 10007
 10008*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
 10009
 10010     GO TO 0500-SET-ACCOUNT.
 10011
 10012 0499-STATE-NOT-FOUND.
 10013
 10014     MOVE ER-2603                TO WS-ERROR.
 10015     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10016
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 183
* EL050.cbl
 10018
 10019 0500-SET-ACCOUNT.
 10020*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
 10021     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10022        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
 10023        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 10024        MOVE WS-CLP-STATE        TO CNTL-ACCESS
 10025        MOVE '3'                 TO CNTL-REC-TYPE
 10026        MOVE +0                  TO CNTL-SEQ-NO
 10027
 10028        MOVE '3'                 TO RC-SW-2
 10029        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 10030
 10031        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 10032           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
 10033           WS-CLP-STATE  NOT = CF-STATE-CODE)
 10034           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
 10035                                    WS-ST-AH-PREM-TAX-I
 10036                                    WS-ST-AH-PREM-TAX-G
 10037        ELSE
 10038           IF CF-ST-LF-PREM-TAX NUMERIC
 10039              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10040           END-IF
 10041           IF CF-ST-AH-PREM-TAX-I NUMERIC
 10042              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10043           END-IF
 10044           IF CF-ST-AH-PREM-TAX-G NUMERIC
 10045              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10046           END-IF
 10047        END-IF
 10048        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
 10049     END-IF
 10050*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
 10051*  FOR DCC ONLY
 10052     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 10053
 10054     MOVE ' '                    TO STAT-MASTER-SW
 10055     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
 10056     MOVE PB-CARRIER             TO ELSTAT-CARRIER
 10057     MOVE PB-GROUPING            TO ELSTAT-GROUP
 10058     MOVE PB-STATE               TO ELSTAT-STATE
 10059     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10060        MOVE WS-CLP-STATE        TO ELSTAT-STATE
 10061     END-IF
 10062
 10063     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 10064     SET BIN-TO-GREG             TO TRUE
 10065     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 10066     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
 10067     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
 10068
 10069     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
 10070     IF STAT-MASTER-FOUND
 10071        MOVE 'N'                 TO STAT-MASTER-SW
 10072        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10073        IF STAT-MASTER-FOUND
 10074           IF (ELSTAT-KEY-SAVE (1:12) =
 10075                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 184
* EL050.cbl
 10076              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10077                 MOVE 'F'        TO STAT-MASTER-SW
 10078              ELSE
 10079                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10080                 IF (STAT-MASTER-FOUND)
 10081                    AND (ELSTAT-KEY-SAVE (1:12) =
 10082                        SF-CONTROL-PRIMARY (1:12))
 10083                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10084                    MOVE 'F'     TO STAT-MASTER-SW
 10085                 END-IF
 10086              END-IF
 10087           END-IF
 10088        END-IF
 10089     END-IF
 10090
 10091     IF STAT-MASTER-SW = 'F'
 10092        IF SF-ST-LF-PREM-TAX NUMERIC
 10093           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10094        END-IF
 10095        IF SF-ST-AH-PREM-TAX-I NUMERIC
 10096           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10097        END-IF
 10098        IF SF-ST-AH-PREM-TAX-G NUMERIC
 10099           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10100        END-IF
 10101     END-IF
 10102
 10103     END-IF
 10104     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10105        AND (PB-ISSUE)
 10106        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10107        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 10108        AND (AM-GPCD = 06)
 10109        MOVE 'Y'                 TO WS-GOOD-HIN
 10110        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10111           MOVE PB-I-VIN         TO WS-WORK-VIN
 10112           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10113              (V1 > 16)
 10114              IF WS-WORK-VIN (V1:1) NUMERIC
 10115                 MOVE WS-WORK-VIN-N (V1)
 10116                                 TO WS-ROW-B-VAL (V1)
 10117              ELSE
 10118                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 10119                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 10120                    OR (V2 > 26)
 10121                 END-PERFORM
 10122                 IF V2 < 27
 10123                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 10124                 ELSE
 10125                    MOVE 'N'     TO WS-GOOD-HIN
 10126                 END-IF
 10127              END-IF
 10128              COMPUTE WS-ROW-D-VAL (V1) =
 10129                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 10130              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
 10131                 WS-ROW-D-VAL (V1)
 10132           END-PERFORM
 10133           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 185
* EL050.cbl
 10134           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 10135             REMAINDER WS-VIN-REMAINDER
 10136           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 10137              CONTINUE
 10138           ELSE
 10139              MOVE 'N'           TO WS-GOOD-HIN
 10140           END-IF
 10141        ELSE
 10142           MOVE 'N'              TO WS-GOOD-HIN
 10143        END-IF
 10144        IF WS-GOOD-HIN NOT = 'Y'
 10145           MOVE ER-3826           TO WS-ERROR
 10146           PERFORM 9900-ERROR-FORMAT
 10147                                 THRU 9900-EXIT
 10148        END-IF
 10149     END-IF
 10150     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10151        AND (PB-ISSUE)
 10152        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10153        AND (AM-GPCD NOT = 06)
 10154        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10155           perform 3400-edit-vin thru 3400-exit
 10156        ELSE
 10157          MOVE ER-3826           TO WS-ERROR
 10158          PERFORM 9900-ERROR-FORMAT
 10159                                 THRU 9900-EXIT
 10160        END-IF
 10161     END-IF
 10162     if (pb-company-id = 'CID')
 10163        and (pb-issue)
 10164        and (pb-i-vin not = spaces and low-values and zeros)
 10165        perform 3400-edit-vin    thru 3400-exit
 10166     end-if
 10167******************************************************************
 10168******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10169******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10170******* METHODS.
 10171******************************************************************
 10172     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10173        IF PB-CANCELLATION
 10174           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10175              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10176                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10177                IF FORM-MASTER-FOUND
 10178                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10179******************************************************************
 10180
 10181     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10182     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10183
 10184     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10185     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10186     MOVE AM-STATUS              TO WS-ACCT-STATUS.
 10187     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10188
 10189
 10190     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10191     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 186
* EL050.cbl
 10192     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10193
 10194     IF AM-LF-OB-RATE NOT NUMERIC
 10195         MOVE ZERO               TO AM-LF-OB-RATE.
 10196
 10197     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10198         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10199
 10200     IF AM-AH-OB-RATE NOT NUMERIC
 10201         MOVE ZERO               TO AM-AH-OB-RATE.
 10202
 10203     IF WS-LF-JOINT-INDICATOR = 'J'
 10204         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10205     ELSE
 10206         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10207
 10208     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10209
 10210     IF WS-IG-OVRD-AM  EQUAL SPACE
 10211         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10212
 10213     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10214         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10215                                       WS-IG-OVRD
 10216     ELSE
 10217         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10218             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10219                                       WS-IG-OVRD
 10220         ELSE
 10221             MOVE AM-IG             TO WS-IG-OVRD-AH
 10222                                       WS-IG-OVRD.
 10223
 10224     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10225         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10226                                       WS-IG-OVRD
 10227     ELSE
 10228         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10229             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10230                                       WS-IG-OVRD
 10231         ELSE
 10232             MOVE AM-IG             TO WS-IG-OVRD-LF
 10233                                       WS-IG-OVRD.
 10234
 10235     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10236     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10237     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10238     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10239*     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10240     INSPECT WS-ACCT-STATUS CONVERTING '9876543210'
 10241                                              TO 'PRLDSFCTIA'.
 10242
 10243     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10244     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
 10245     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10246     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10247
 10248     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10249     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 187
* EL050.cbl
 10250     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10251     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10252     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10253     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10254     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10255
 10256     IF WS-ACCT-AH-DEV-PCT > +0
 10257        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10258     ELSE
 10259        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10260
 10261     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10262        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10263     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10264        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10265
 10266        IF AM-EARN-METHOD-L = 'S'
 10267            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10268                                        WS-LF-REFUND-CALC.
 10269
 10270        IF AM-EARN-METHOD-R = 'S'
 10271            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10272                                        WS-LF-REFUND-CALC.
 10273
 10274     IF WS-LF-COVERAGE-TYPE = 'R'
 10275         IF AM-EARN-METHOD-R = 'R'
 10276            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10277                                    WS-LF-REFUND-CALC.
 10278     IF WS-LF-COVERAGE-TYPE = 'R'
 10279         IF AM-EARN-METHOD-R = 'P'
 10280            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10281                                    WS-LF-REFUND-CALC.
 10282     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10283         IF AM-EARN-METHOD-L = 'R'
 10284            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10285                                    WS-LF-REFUND-CALC.
 10286     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10287         IF AM-EARN-METHOD-L = 'P'
 10288            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10289                                    WS-LF-REFUND-CALC.
 10290     IF WS-LF-COVERAGE-TYPE = 'R'
 10291         IF AM-EARN-METHOD-R = 'A'
 10292            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10293                                    WS-LF-REFUND-CALC.
 10294     IF WS-LF-COVERAGE-TYPE = 'R'
 10295         IF AM-EARN-METHOD-R = 'M'
 10296            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10297                                    WS-LF-REFUND-CALC.
 10298     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10299         IF AM-EARN-METHOD-L = 'A'
 10300            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10301                                    WS-LF-REFUND-CALC.
 10302     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10303         IF AM-EARN-METHOD-L = 'M'
 10304            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10305                                    WS-LF-REFUND-CALC.
 10306
 10307     IF AM-EARN-METHOD-A = 'R'
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 188
* EL050.cbl
 10308        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10309                                    WS-AH-REFUND-CALC.
 10310     IF AM-EARN-METHOD-A = 'P'
 10311        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10312                                    WS-AH-REFUND-CALC.
 10313     IF AM-EARN-METHOD-A = 'C'
 10314        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10315                                    WS-AH-REFUND-CALC.
 10316     IF AM-EARN-METHOD-A = 'A'
 10317        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10318                                    WS-AH-REFUND-CALC.
 10319     IF AM-EARN-METHOD-A = 'M'
 10320        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10321                                    WS-AH-REFUND-CALC.
 10322     IF AM-EARN-METHOD-A = 'N'
 10323        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10324                                    WS-AH-REFUND-CALC.
 10325     IF AM-EARN-METHOD-A = 'S'
 10326        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10327                                    WS-AH-REFUND-CALC.
 10328
 10329     IF AM-TOL-PREM NOT = ZEROS
 10330        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10331                                    WS-TOL-AH-PREM.
 10332
 10333     IF AM-OVR-SHT-AMT NUMERIC AND
 10334                  AM-OVR-SHT-AMT > 0
 10335        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10336                                    EC-AM-LF-OVR-SHT-AMT
 10337                                    WS-AH-REFUND-OVS-AMT
 10338                                    EC-AM-AH-OVR-SHT-AMT.
 10339
 10340     IF AM-OVR-SHT-PCT NUMERIC AND
 10341                    AM-OVR-SHT-PCT > 0
 10342        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10343                                    EC-AM-LF-OVR-SHT-PCT
 10344                                    WS-AH-REFUND-OVS-PCT
 10345                                    EC-AM-AH-OVR-SHT-PCT.
 10346
 10347     IF AM-TOL-REF-PCT NUMERIC AND
 10348                  AM-TOL-REF-PCT > 0
 10349        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10350                                    WS-TOL-AH-REFUND-PCT.
 10351
 10352     IF AM-TOL-REF  NOT = ZEROS  AND
 10353                  AM-TOL-REF NUMERIC
 10354        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10355                                    EC-AM-LF-TOL-REFUND
 10356                                    WS-TOL-AH-REFUND
 10357                                    EC-AM-AH-TOL-REFUND.
 10358
 10359     IF AM-TOL-CLM  NOT = ZEROS
 10360        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
 10361                                    WS-TOL-AH-CLAIM.
 10362
 10363     IF AM-CLP-TOL-PCT NOT NUMERIC
 10364        MOVE +0                  TO AM-CLP-TOL-PCT
 10365     END-IF
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 189
* EL050.cbl
 10366
 10367     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10368        MOVE +0                  TO AM-SPP-LEASE-COMM
 10369     END-IF
 10370     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10371        MOVE WS-PL-TOL-LF-PREM-PCT
 10372                                 TO WS-TOL-LF-PREM-PCT.
 10373
 10374     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10375        MOVE WS-PL-TOL-AH-PREM-PCT
 10376                                 TO WS-TOL-AH-PREM-PCT.
 10377
 10378     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10379        MOVE WS-PL-TOL-LF-REFUND-PCT
 10380                                 TO WS-TOL-LF-REFUND-PCT.
 10381
 10382     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10383        MOVE WS-PL-TOL-AH-REFUND-PCT
 10384                                 TO WS-TOL-AH-REFUND-PCT.
 10385
 10386     IF WS-PL-REF-OVS-AMT > +0
 10387        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10388
 10389     IF WS-PL-REF-OVS-PCT > +0
 10390        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10391
 10392     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10393        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10394     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10395        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10396     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10397        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10398     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10399        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10400     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10401        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10402     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10403        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10404
 10405     IF WS-AH-PL-REF-OVS-AMT > +0
 10406        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10407
 10408     IF WS-AH-PL-REF-OVS-PCT > +0
 10409        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10410
 10411     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10412     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10413
 10414     IF PB-CANCELLATION
 10415        GO TO 3000-CONTINUE-EDIT.
 10416
 10417     MOVE +1 TO SUB1.
 10418     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10419     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10420
 10421     IF CF-COMPANY-ID = 'DMD'
 10422       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10423         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 190
* EL050.cbl
 10424        ELSE
 10425         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10426
 10427  0525-FIND-ACCT-COMM.
 10428     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10429        NEXT SENTENCE
 10430      ELSE
 10431         ADD +1 TO SUB1
 10432         IF SUB1 LESS +11
 10433            GO TO 0525-FIND-ACCT-COMM
 10434          ELSE
 10435             GO TO 0560-EDIT-CONTINUE.
 10436
 10437     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10438     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10439                                    PB-I-LIFE-COMMISSION.
 10440***  IF PB-COMPANY-ID = 'CRI'
 10441     IF PB-PREM-ACCTNG-ONLY
 10442         GO TO 0560-EDIT-CONTINUE.
 10443
 10444     MOVE '0530' TO CTBL-SW.
 10445     MOVE ' '    TO WS-CTBL-READ-SW.
 10446
 10447
 10448 0530-GET-AH-COMP.
 10449     IF NO-AH-COVERAGE  OR
 10450        NO-AH-BENEFIT-MATCH
 10451           GO TO 0540-NEXT-READ-STEP.
 10452
 10453     IF AM-A-COM (SUB1) NUMERIC
 10454        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10455         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10456         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10457         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10458         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10459     ELSE
 10460          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10461          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10462          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10463          MOVE ZEROS             TO WS-SUB1
 10464                                    WS-COMMISSION
 10465          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10466          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10467          IF WS-COMMISSION > ZEROS
 10468             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10469             GO TO 0540-NEXT-READ-STEP
 10470          END-IF
 10471          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10472          IF CTBL-TABLE-FOUND
 10473             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10474                                        PB-I-AH-TERM
 10475             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10476             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10477             GO TO 0540-NEXT-READ-STEP
 10478          ELSE
 10479             IF FIRST-TIME-THROUGH
 10480                 GO TO 0530-GET-AH-COMP
 10481             ELSE
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 191
* EL050.cbl
 10482                 MOVE ER-2609                TO WS-ERROR
 10483                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10484
 10485 0540-NEXT-READ-STEP.
 10486     MOVE '0540' TO CTBL-SW.
 10487     MOVE ' '    TO WS-CTBL-READ-SW.
 10488
 10489 0540-GET-LF-COMP.
 10490     IF NO-LIFE-COVERAGE  OR
 10491        NO-LF-BENEFIT-MATCH
 10492           GO TO 0560-EDIT-CONTINUE.
 10493
 10494     IF WS-LF-JOINT-INDICATOR = 'J'
 10495        IF AM-J-COM (SUB1) NUMERIC
 10496           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10497           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10498           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10499           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10500           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10501        ELSE
 10502           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10503           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10504           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10505           MOVE ZEROS                TO WS-SUB1
 10506                                        WS-COMMISSION
 10507           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10508           IF WS-COMMISSION > ZEROS
 10509              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10510              GO TO 0560-EDIT-CONTINUE
 10511           END-IF
 10512           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10513           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10514           IF CTBL-TABLE-FOUND
 10515              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10516              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10517              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10518              GO TO 0560-EDIT-CONTINUE
 10519           ELSE
 10520              IF FIRST-TIME-THROUGH
 10521                  GO TO 0540-GET-LF-COMP
 10522              ELSE
 10523                  MOVE ER-2609                TO WS-ERROR
 10524                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10525                  GO TO 0560-EDIT-CONTINUE.
 10526
 10527     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10528        IF AM-L-COM (SUB1) NUMERIC
 10529           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10530           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10531           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10532           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10533           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10534        ELSE
 10535           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10536           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10537           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10538           MOVE ZEROS                TO WS-SUB1
 10539                                        WS-COMMISSION
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 192
* EL050.cbl
 10540           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10541           IF WS-COMMISSION IS GREATER THAN ZEROS
 10542              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10543              GO TO 0560-EDIT-CONTINUE
 10544           END-IF
 10545           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10546           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10547           IF CTBL-TABLE-FOUND
 10548              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10549              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10550              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10551              GO TO 0560-EDIT-CONTINUE
 10552           ELSE
 10553              IF FIRST-TIME-THROUGH
 10554                  GO TO 0540-GET-LF-COMP
 10555              ELSE
 10556                  MOVE ER-2609                TO WS-ERROR
 10557                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10558
 10559*    GO TO 0560-EDIT-CONTINUE.
 10560
 10561 0560-EDIT-CONTINUE.
 10562     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10563                                    WS-AH-PMF-COMM
 10564*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10565*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10566     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10567        (SUB1 > +10)
 10568        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10569           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10570           MOVE '0530'           TO CTBL-SW
 10571           MOVE ' '              TO WS-CTBL-READ-SW
 10572           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10573           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10574           MOVE '0540'           TO CTBL-SW
 10575           MOVE ' '              TO WS-CTBL-READ-SW
 10576           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10577        END-IF
 10578     END-PERFORM
 10579     GO TO 0564-EDIT-CONTINUE
 10580     .
 10581 0561-CHECK-AH.
 10582     IF (NO-AH-COVERAGE)
 10583        OR (NO-AH-BENEFIT-MATCH)
 10584        CONTINUE
 10585     ELSE
 10586        IF (AM-A-COM (SUB1) NUMERIC)
 10587           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10588           IF (AM-COM-TYP (SUB1) = 'A')
 10589              AND (WS-AH-PMF-COMM = ZEROS)
 10590              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10591           END-IF
 10592           CONTINUE
 10593        ELSE
 10594           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10595           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10596           MOVE PB-AH-OVERRIDE-L1
 10597                                 TO CTBL-BEN-TYPE
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 193
* EL050.cbl
 10598           MOVE ZEROS            TO WS-SUB1
 10599                                    WS-COMMISSION
 10600           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10601           PERFORM 8300-READ-CTBL-TABLE
 10602                                 THRU 8300-EXIT
 10603           IF CTBL-TABLE-FOUND
 10604              IF (AM-COM-TYP (SUB1) = 'A')
 10605                 AND (WS-AH-PMF-COMM = ZEROS)
 10606                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10607                                        PB-I-AH-TERM
 10608                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10609                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10610              END-IF
 10611              CONTINUE
 10612           ELSE
 10613              IF FIRST-TIME-THROUGH
 10614                 GO TO 0561-CHECK-AH
 10615              ELSE
 10616                 MOVE ER-2609    TO WS-ERROR
 10617                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10618              END-IF
 10619           END-IF
 10620        END-IF
 10621     END-IF
 10622     .
 10623 0561-EXIT.
 10624     EXIT.
 10625 0563-CHECK-LF.
 10626     IF (NO-LIFE-COVERAGE)
 10627        OR (NO-LF-BENEFIT-MATCH)
 10628        CONTINUE
 10629     ELSE
 10630        IF WS-LF-JOINT-INDICATOR = 'J'
 10631           IF AM-J-COM (SUB1) NUMERIC
 10632              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10633              IF (AM-COM-TYP (SUB1) = 'A')
 10634                 AND (WS-LF-PMF-COMM = ZEROS)
 10635                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10636              END-IF
 10637              CONTINUE
 10638           ELSE
 10639              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10640              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10641              MOVE PB-LIFE-OVERRIDE-L1
 10642                                 TO CTBL-BEN-TYPE
 10643              MOVE ZEROS         TO WS-SUB1
 10644                                    WS-COMMISSION
 10645              MOVE AM-J-COMA (SUB1)
 10646                                 TO CTBL-TABLE
 10647              PERFORM 8300-READ-CTBL-TABLE
 10648                                 THRU 8300-EXIT
 10649              IF CTBL-TABLE-FOUND
 10650                 IF (AM-COM-TYP (SUB1) = 'A')
 10651                    AND (WS-LF-PMF-COMM = ZEROS)
 10652                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10653                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10654                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10655                 END-IF
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 194
* EL050.cbl
 10656                 CONTINUE
 10657              ELSE
 10658                 IF FIRST-TIME-THROUGH
 10659                    GO TO 0563-CHECK-LF
 10660                 ELSE
 10661                    MOVE ER-2609 TO WS-ERROR
 10662                    PERFORM 9900-ERROR-FORMAT
 10663                                 THRU 9900-EXIT
 10664*                   GO TO 0560-EDIT-CONTINUE
 10665                 END-IF
 10666              END-IF
 10667           END-IF
 10668        ELSE
 10669           IF AM-L-COM (SUB1) NUMERIC
 10670              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10671              IF (AM-COM-TYP (SUB1) = 'A')
 10672                 AND (WS-LF-PMF-COMM = ZEROS)
 10673                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10674              END-IF
 10675              CONTINUE
 10676           ELSE
 10677              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10678              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10679              MOVE PB-LIFE-OVERRIDE-L1
 10680                                 TO CTBL-BEN-TYPE
 10681              MOVE ZEROS         TO WS-SUB1
 10682                                    WS-COMMISSION
 10683              MOVE AM-L-COMA (SUB1)
 10684                                 TO CTBL-TABLE
 10685              PERFORM 8300-READ-CTBL-TABLE
 10686                                 THRU 8300-EXIT
 10687              IF CTBL-TABLE-FOUND
 10688                 CONTINUE
 10689              ELSE
 10690                 IF FIRST-TIME-THROUGH
 10691                    GO TO 0563-CHECK-LF
 10692                 ELSE
 10693                    MOVE ER-2609 TO WS-ERROR
 10694                    PERFORM 9900-ERROR-FORMAT
 10695                                 THRU 9900-EXIT
 10696                 END-IF
 10697              END-IF
 10698           END-IF
 10699        END-IF
 10700     END-IF
 10701     .
 10702 0563-EXIT.
 10703     EXIT.
 10704 0564-EDIT-CONTINUE.
 10705
 10706     IF  PB-COMPANY-ID EQUAL 'DMD'
 10707         IF PB-I-NUM-BILLED EQUAL ZEROS
 10708            MOVE ER-8148       TO WS-ERROR
 10709            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10710
 10711*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10712*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10713*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 195
* EL050.cbl
 10714*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10715*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10716*         IF NO-CONVERSION-ERROR
 10717*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10718*         ELSE
 10719*             IF PB-COMPANY-ID EQUAL 'HAN'
 10720*                 MOVE ZEROS     TO PB-I-AGE.
 10721     IF PB-I-BIRTHDAY > LOW-VALUES
 10722        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10723        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10724        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10725        PERFORM 8500-DATE-CONVERT
 10726                                 THRU 8500-EXIT
 10727        IF NO-CONVERSION-ERROR
 10728           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10729           IF PB-I-AGE > ZEROS
 10730              IF WS-WORK-AGE NOT = PB-I-AGE
 10731                 MOVE ER-9501    TO WS-ERROR
 10732                 PERFORM 9900-ERROR-FORMAT
 10733                                 THRU 9900-EXIT
 10734              END-IF
 10735           ELSE
 10736              MOVE WS-WORK-AGE   TO PB-I-AGE
 10737           END-IF
 10738        END-IF
 10739     END-IF
 10740     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 10741                                   WS-INS-AGE-SET
 10742     IF PB-I-AGE = ZEROS
 10743        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10744           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 10745                                   WS-INS-AGE-SET
 10746           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10747
 10748     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10749                                   WS-AH-EDIT-AGE.
 10750
 10751     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10752        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10753        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10754        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10755        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10756        IF NO-CONVERSION-ERROR
 10757           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10758           IF PB-I-JOINT-AGE > 0
 10759              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10760                 MOVE ER-9503    TO WS-ERROR
 10761                 PERFORM 9900-ERROR-FORMAT
 10762                                 THRU 9900-EXIT
 10763              END-IF
 10764           ELSE
 10765              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10766           END-IF
 10767        ELSE
 10768           MOVE ZEROS            TO PB-I-JOINT-AGE
 10769        END-IF
 10770     END-IF
 10771     IF PB-I-JOINT-AGE NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 196
* EL050.cbl
 10772        MOVE ZERO               TO PB-I-JOINT-AGE.
 10773
 10774     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 10775                                   WS-JNT-AGE-SET
 10776     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 10777        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10778           (WS-AH-JOINT-INDICATOR = 'J')
 10779           IF PB-I-JOINT-AGE = ZEROS
 10780               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 10781                                          WS-JNT-AGE-SET
 10782               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10783           END-IF
 10784        END-IF
 10785     END-IF
 10786
 10787     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10788     IF WS-LF-JOINT-INDICATOR = 'J'
 10789        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10790        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10791            IF  PB-I-JOINT-AGE = ZERO
 10792                MOVE ER-2686       TO WS-ERROR
 10793                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10794            ELSE
 10795                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10796                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10797                    IF PB-COMPANY-ID NOT = 'LBL'
 10798                        MOVE ER-2685    TO WS-ERROR
 10799                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10800
 10801     IF WS-AH-JOINT-INDICATOR = 'J'
 10802        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10803            IF  PB-I-JOINT-AGE = ZERO
 10804                MOVE ER-2686       TO WS-ERROR
 10805                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10806            ELSE
 10807                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10808                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10809                                           WS-EDIT-AGE
 10810                    IF PB-COMPANY-ID NOT = 'LBL'
 10811                        MOVE ER-2685    TO WS-ERROR
 10812                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10813
 10814******************************************************************
 10815*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10816******************************************************************
 10817
 10818     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10819        (WS-AH-SPECIAL-CALC-CD = 'O')
 10820        NEXT SENTENCE
 10821     ELSE
 10822        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10823          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10824           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10825            WS-AH-JOINT-INDICATOR = 'J')  AND
 10826           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10827            MOVE ER-2627             TO WS-ERROR
 10828            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10829
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 197
* EL050.cbl
 10830     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10831        (WS-AH-SPECIAL-CALC-CD = 'O')
 10832         NEXT SENTENCE
 10833     ELSE
 10834         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10835            WS-AH-JOINT-INDICATOR = 'J'
 10836             IF PB-I-JOINT-INSURED = SPACES
 10837                 IF PB-COMPANY-ID NOT = 'JAL'
 10838                     MOVE ER-2696    TO WS-ERROR
 10839                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10840
 10841     IF PB-COMPANY-ID NOT = 'BOA'
 10842        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10843           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10844           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10845               PB-I-JOINT-INSURED NOT = SPACES)
 10846                MOVE ER-2691         TO WS-ERROR
 10847                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10848
 10849     IF PB-COMPANY-ID = 'BOA'
 10850        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10851           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10852            IF PB-I-JOINT-AGE NOT = ZEROS
 10853                MOVE ER-2691         TO WS-ERROR
 10854                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10855
 10856     IF PB-COMPANY-ID = 'CRI'
 10857        IF PB-I-SIG-SW = 'J'
 10858           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 10859              WS-AH-JOINT-INDICATOR NOT = 'J'
 10860              MOVE ER-2675       TO WS-ERROR
 10861              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10862
 10863     IF PB-COMPANY-ID = 'CRI'
 10864        IF PB-I-SIG-SW = 'S'
 10865           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10866              WS-AH-JOINT-INDICATOR = 'J'
 10867              MOVE ER-2676       TO WS-ERROR
 10868              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10869
 10870     IF PB-COMPANY-ID = 'CVL'
 10871         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10872            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10873              MOVE ER-2783           TO WS-ERROR
 10874              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10875     IF (WS-LF-JOINT-INDICATOR = 'J')
 10876        AND (WS-AH-JOINT-INDICATOR = 'J')
 10877        AND (PB-I-LF-TERM > 120)
 10878        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10879        MOVE ER-2783             TO WS-ERROR
 10880        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10881     END-IF
 10882     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10883
 10884     IF PB-I-INDV-GRP-OVRD = 'I'
 10885        MOVE ER-2666             TO WS-ERROR
 10886        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10887        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 198
* EL050.cbl
 10888
 10889     IF PB-I-INDV-GRP-OVRD = 'G'
 10890        MOVE ER-2666             TO WS-ERROR
 10891        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10892        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10893
 10894     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10895        NEXT SENTENCE
 10896     ELSE
 10897        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10898
 10899     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10900        IF WS-ERROR = ER-2666
 10901           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10902           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10903
 10904     IF PB-COMPANY-ID = 'CID'
 10905        IF PB-STATE = 'UT' OR 'MO'
 10906           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10907                 OR '76' OR '77')
 10908                      OR
 10909               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10910                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10911                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10912                   OR '2K' OR '2L'))
 10913              AND PB-I-INDV-GRP-CD = 'I'
 10914              MOVE ER-2721             TO WS-ERROR
 10915              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10916           END-IF
 10917        END-IF
 10918     END-IF
 10919
 10920     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10921     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10922        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10923     ELSE
 10924        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10925     END-IF
 10926
 10927*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10928*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10929     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10930                                    ACCOUNT-AH-CK-SW.
 10931
 10932     IF PB-REISSUED-CERT       OR
 10933        PB-REIN-ONLY-CERT      OR
 10934        PB-POLICY-IS-DECLINED  OR
 10935        PB-POLICY-IS-VOIDED
 10936*       OR PB-MONTHLY-CERT
 10937         GO TO 3000-CONTINUE-EDIT.
 10938
 10939     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10940        IF WS-EDIT-AGE           > +65
 10941           MOVE ER-2709          TO WS-ERROR
 10942           PERFORM 9900-ERROR-FORMAT
 10943                                 THRU 9900-EXIT
 10944        ELSE
 10945           IF WS-EDIT-AGE        > +55
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 199
* EL050.cbl
 10946              MOVE ER-2718       TO WS-ERROR
 10947              PERFORM 9900-ERROR-FORMAT
 10948                                 THRU 9900-EXIT
 10949           END-IF
 10950        END-IF
 10951     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 10952        IF WS-EDIT-AGE           > +65
 10953           MOVE ER-2709          TO WS-ERROR
 10954           PERFORM 9900-ERROR-FORMAT
 10955                                 THRU 9900-EXIT
 10956        END-IF
 10957     END-IF
 10958     .
 10959
 10960 0565-LIFE-PLAN-LIMIT-EDITS.
 10961
 10962     IF NOT LF-PLAN-MASTER-FOUND
 10963        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10964                                    EC-AM-LF-MAX-TOT-BEN
 10965        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10966
 10967     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10968
 10969     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10970         IF PL-LM-AGE (1) = ZEROS
 10971             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10972
 10973     IF NO-LF-BENEFIT-MATCH          OR
 10974        WS-LF-BENEFIT-CD = ZEROS     OR
 10975        WS-LF-SPECIAL-CALC-CD = 'M'
 10976        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10977
 10978     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10979     MOVE +1                     TO SUB2.
 10980
 10981     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10982        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10983           MOVE +5   TO SUB2
 10984           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10985              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10986              (PL-LM-AGE (SUB2) EQUAL +0)
 10987              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10988              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10989
 10990     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10991
 10992     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10993                               + PB-I-LF-ALT-BENEFIT-AMT.
 10994
 10995 0568-CHECK-LIFE-ATT-AGE.
 10996
 10997     IF PL-ATT-AGE NUMERIC AND
 10998        PL-ATT-AGE > +0
 10999        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11000     END-IF
 11001*    IF PL-ATT-AGE NUMERIC AND
 11002*       PL-ATT-AGE > +0
 11003*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 200
* EL050.cbl
 11004*       IF PB-I-BIRTHDAY > LOW-VALUES
 11005*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11006*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 11007*          MOVE ZERO             TO DC-ELAPSED-DAYS
 11008*          SET BIN-PLUS-ELAPSED  TO TRUE
 11009*          PERFORM 8500-DATE-CONVERT
 11010*                                THRU 8500-EXIT
 11011*          IF NO-CONVERSION-ERROR
 11012*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 11013*             MOVE ER-2669       TO WS-ERROR
 11014*             PERFORM 9900-ERROR-FORMAT
 11015*                                THRU 9900-EXIT
 11016*          END-IF
 11017*       ELSE
 11018*          IF WS-ATT-AGE >= PL-ATT-AGE
 11019*             MOVE ER-2669       TO WS-ERROR
 11020*             PERFORM 9900-ERROR-FORMAT
 11021*                                THRU 9900-EXIT
 11022*          END-IF
 11023*       END-IF
 11024*    END-IF
 11025     .
 11026 0570-CHECK-LIFE-LIMITS.
 11027
 11028     IF PB-COMPANY-ID EQUAL 'CRI'
 11029        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11030           IF SUB2 GREATER THAN +4
 11031              MOVE ER-2637 TO WS-ERROR
 11032              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11033              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11034
 11035     IF PB-COMPANY-ID  =  'NCL'
 11036        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11037            SUB2 GREATER THAN +8
 11038             MOVE 'U'         TO PB-BATCH-ENTRY
 11039             MOVE ER-2637     TO WS-ERROR
 11040             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11041             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11042
 11043     IF SUB2 > +8
 11044        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11045           AND (PB-I-SIG-SW = 'Y')
 11046           CONTINUE
 11047        ELSE
 11048           MOVE ER-2637          TO WS-ERROR
 11049           PERFORM 9900-ERROR-FORMAT
 11050                                 THRU 9900-EXIT
 11051        END-IF
 11052        GO TO 0580-AH-PLAN-LIMIT-EDITS
 11053     END-IF
 11054     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 11055     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 11056     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 11057
 11058     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11059        ADD +1  TO SUB2
 11060        GO TO 0570-CHECK-LIFE-LIMITS.
 11061
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 201
* EL050.cbl
 11062     IF PB-COMPANY-ID = 'NCL'
 11063         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 11064
 11065     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 11066        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 11067        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11068           AND (PB-I-SIG-SW = 'Y')
 11069           CONTINUE
 11070        ELSE
 11071           MOVE ER-2637          TO WS-ERROR
 11072           PERFORM 9900-ERROR-FORMAT
 11073                                 THRU 9900-EXIT
 11074        END-IF
 11075     END-IF
 11076     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11077
 11078
 11079 0570-CHECK-NCL-LIFE-LIMITS.
 11080
 11081     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 11082        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
 11083         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11084
 11085     IF APP-CERT-USED
 11086         IF SUB2  LESS THAN  +5
 11087             MOVE +5          TO SUB2
 11088             GO TO 0570-CHECK-LIFE-LIMITS.
 11089
 11090     MOVE ER-2637             TO WS-ERROR.
 11091     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11092
 11093     MOVE 'U'                 TO PB-BATCH-ENTRY.
 11094
 11095 0575-CHECK-NCL-SIG-SWITCH.
 11096
 11097     IF NOT APP-CERT-USED
 11098         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11099
 11100     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11101        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11102        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11103        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11104         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11105
 11106     IF SUB2 GREATER THAN +4
 11107         IF PL-LM-AGE (5) = ZEROS  AND
 11108            PL-LM-AGE (6) = ZEROS  AND
 11109            PL-LM-AGE (7) = ZEROS  AND
 11110            PL-LM-AGE (8) = ZEROS
 11111             MOVE  ER-1927        TO WS-ERROR
 11112             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11113             GO TO 0580-AH-PLAN-LIMIT-EDITS
 11114         ELSE
 11115             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11116                 MOVE  ER-1920    TO WS-ERROR
 11117                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11118
 11119     IF PB-I-SIG-SW  = 'Y'
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 202
* EL050.cbl
 11120       IF NOT PB-I-POLICY-ACCEPTED  AND
 11121          NOT PB-I-POLICY-DECLINED
 11122           MOVE 'U'               TO PB-BATCH-ENTRY
 11123           MOVE  ER-1926          TO WS-ERROR
 11124           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11125
 11126
 11127 0580-AH-PLAN-LIMIT-EDITS.
 11128
 11129     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11130        IF PB-I-AH-BENEFIT-AMT > +1250
 11131           MOVE ER-2702          TO WS-ERROR
 11132           PERFORM 9900-ERROR-FORMAT
 11133                                 THRU 9900-EXIT
 11134        END-IF
 11135     END-IF
 11136
 11137     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 11138        AND (PB-MONTHLY-CERT)
 11139        IF PB-I-AH-BENEFIT-AMT > +3000
 11140           MOVE ER-2881          TO WS-ERROR
 11141           PERFORM 9900-ERROR-FORMAT
 11142                                 THRU 9900-EXIT
 11143        END-IF
 11144     END-IF
 11145     IF NOT AH-PLAN-MASTER-FOUND
 11146        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 11147        GO TO 3000-CONTINUE-EDIT.
 11148
 11149     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 11150
 11151     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11152         IF PL-LM-AGE (1) = ZEROS
 11153             GO TO 3000-CONTINUE-EDIT.
 11154
 11155     IF NO-AH-BENEFIT-MATCH          OR
 11156        WS-AH-BENEFIT-CD = ZEROS     OR
 11157        WS-AH-SPECIAL-CALC-CD = 'M'
 11158        GO TO 3000-CONTINUE-EDIT.
 11159
 11160     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11161     MOVE +1                     TO SUB2.
 11162
 11163     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11164        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11165           MOVE +5 TO SUB2
 11166           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11167              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11168              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11169              (PL-LM-AGE (SUB2) EQUAL +0)
 11170              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 11171              GO TO 3000-CONTINUE-EDIT.
 11172
 11173     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11174
 11175 0590-CHECK-AH-ATT-AGE.
 11176
 11177     IF PL-ATT-AGE NUMERIC AND
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 203
* EL050.cbl
 11178        PL-ATT-AGE GREATER THAN +0
 11179        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11180     END-IF
 11181*       IF WS-ATT-AGE >= PL-ATT-AGE
 11182*          MOVE ER-3054          TO WS-ERROR
 11183*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11184     .
 11185 0597-CHECK-AH-LIMITS.
 11186
 11187     IF PB-COMPANY-ID EQUAL 'CRI'
 11188        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11189           IF SUB2 GREATER THAN +4
 11190              MOVE ER-2638       TO WS-ERROR
 11191              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11192              GO TO 3000-CONTINUE-EDIT.
 11193
 11194     IF PB-COMPANY-ID  =  'NCL'
 11195        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11196            SUB2 GREATER THAN +8
 11197             MOVE 'U'            TO PB-BATCH-ENTRY
 11198             MOVE ER-2638        TO WS-ERROR
 11199             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11200             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11201
 11202     IF SUB2 > +8
 11203        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11204           AND (PB-I-SIG-SW = 'Y')
 11205           CONTINUE
 11206        ELSE
 11207           MOVE ER-2638          TO WS-ERROR
 11208           PERFORM 9900-ERROR-FORMAT
 11209                                 THRU 9900-EXIT
 11210        END-IF
 11211        GO TO 3000-CONTINUE-EDIT
 11212     END-IF
 11213
 11214     IF PB-COMPANY-ID = 'CRI'
 11215        IF WS-ERROR = ER-2638
 11216           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11217
 11218     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11219     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11220     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11221     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11222
 11223     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11224        ADD +1                   TO SUB2
 11225        GO TO 0597-CHECK-AH-LIMITS.
 11226
 11227     IF PB-COMPANY-ID = 'NCL'
 11228         GO TO 0597-CHECK-NCL-AH-LIMITS.
 11229
 11230     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11231        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11232        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11233                                 > PL-LM-AMT (SUB2))
 11234        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11235           AND (PB-I-SIG-SW = 'Y')
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 204
* EL050.cbl
 11236           CONTINUE
 11237        ELSE
 11238           MOVE ER-2638          TO WS-ERROR
 11239           PERFORM 9900-ERROR-FORMAT
 11240                                 THRU 9900-EXIT
 11241        END-IF
 11242     END-IF
 11243
 11244     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11245         IF  WS-ERROR    EQUAL    ER-2638
 11246             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11247                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11248                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11249                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11250                MOVE  ER-1910    TO  WS-ERROR
 11251                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11252
 11253     IF PB-COMPANY-ID = 'CRI'
 11254        IF WS-ERROR = ER-2638
 11255            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11256            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11257            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11258
 11259     GO TO 3000-CONTINUE-EDIT.
 11260
 11261 0597-CHECK-NCL-AH-LIMITS.
 11262
 11263     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11264        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11265        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11266                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11267         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11268
 11269     IF APP-CERT-USED
 11270         IF SUB2  LESS THAN  +5
 11271             MOVE +5             TO SUB2
 11272             GO TO 0597-CHECK-AH-LIMITS.
 11273
 11274     MOVE ER-2638                TO WS-ERROR.
 11275     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11276
 11277     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11278
 11279 0599-CHECK-NCL-SIG-SWITCH.
 11280
 11281     IF NOT APP-CERT-USED
 11282         GO TO 3000-CONTINUE-EDIT.
 11283
 11284     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11285        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11286        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11287        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11288         GO TO 3000-CONTINUE-EDIT.
 11289
 11290     IF SUB2 GREATER THAN +4
 11291         IF PL-LM-AGE (5) = ZEROS  AND
 11292            PL-LM-AGE (6) = ZEROS  AND
 11293            PL-LM-AGE (7) = ZEROS  AND
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 205
* EL050.cbl
 11294            PL-LM-AGE (8) = ZEROS
 11295             MOVE  ER-1927        TO WS-ERROR
 11296             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11297             GO TO 3000-CONTINUE-EDIT
 11298         ELSE
 11299             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11300                 MOVE  ER-1920    TO WS-ERROR
 11301                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11302
 11303     IF PB-I-SIG-SW  = 'Y'
 11304       IF NOT PB-I-POLICY-ACCEPTED  AND
 11305          NOT PB-I-POLICY-DECLINED
 11306           MOVE 'U'               TO PB-BATCH-ENTRY
 11307           MOVE  ER-1926          TO WS-ERROR
 11308           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11309
 11310******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 206
* EL050.cbl
 11312
 11313 3000-CONTINUE-EDIT.
 11314
 11315     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11316     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11317     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11318     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11319     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11320
 11321     IF BROWSE-STARTED
 11322        PERFORM 9990-RETURN THRU 9990-EXIT
 11323        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11324
 11325     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11326        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11327        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11328        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11329*       MOVE 1                   TO DC-OPTION-CODE
 11330        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11331        IF DATE-CONVERSION-ERROR
 11332           MOVE ER-2622          TO WS-ERROR
 11333           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11334        ELSE
 11335           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11336              MOVE ER-2623       TO WS-ERROR
 11337              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11338           ELSE
 11339              MOVE ER-2622       TO WS-ERROR
 11340              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11341
 11342     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11343     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11344     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11345*    MOVE 1                      TO DC-OPTION-CODE.
 11346     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11347     IF DATE-CONVERSION-ERROR
 11348        GO TO 3005-EDIT-CONTINUE
 11349     ELSE
 11350        IF DC-ELAPSED-DAYS GREATER +180
 11351           MOVE ER-2613          TO WS-ERROR
 11352           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11353        ELSE
 11354           IF DC-ELAPSED-DAYS GREATER +90
 11355              MOVE ER-2612       TO WS-ERROR
 11356              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11357           ELSE
 11358             IF DC-ELAPSED-DAYS GREATER +60
 11359                MOVE ER-2614     TO WS-ERROR
 11360                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11361
 11362 3005-EDIT-CONTINUE.
 11363
 11364     IF PB-CANCELLATION
 11365         GO TO 3700-EDIT-CANCEL.
 11366
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 207
* EL050.cbl
 11368******************************************************************
 11369*                  E D I T   I S S U E                           *
 11370******************************************************************
 11371
 11372 3020-EDIT-ISSUE.
 11373
 11374      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11375      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11376      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11377      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11378      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11379
 11380     IF PB-ISSUE-FORCE
 11381        OR PB-ISSUE-DATE-FORCED
 11382        OR PB-FORCE-OFF
 11383        OR PB-OVERCHARGE-FORCE
 11384        CONTINUE
 11385     ELSE
 11386        MOVE ER-2670             TO WS-ERROR
 11387        PERFORM 9900-ERROR-FORMAT
 11388                                 THRU 9900-EXIT
 11389     END-IF
 11390     .
 11391 3022-SET-POLICY-STATUS.
 11392
 11393     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11394
 11395     IF (PB-REISSUED-CERT)
 11396             OR
 11397        ((PB-COMPANY-ID NOT = 'DCC' and 'VPP')
 11398         AND (PB-MONTHLY-CERT))
 11399         MOVE '5'                TO PB-I-ENTRY-STATUS
 11400         MOVE 'E'                TO PB-BATCH-ENTRY
 11401     END-IF
 11402
 11403     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 11404        IF PB-MONTHLY-CERT
 11405           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11406        END-IF
 11407        IF PB-CASH-CERT
 11408           MOVE 'C'              TO PB-I-ENTRY-STATUS
 11409        END-IF
 11410     END-IF
 11411     IF PB-POLICY-IS-DECLINED
 11412         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11413     IF PB-POLICY-IS-VOIDED
 11414         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11415     IF PB-NEEDS-UNDERWRITING
 11416         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11417     IF PB-REIN-ONLY-CERT
 11418         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11419     IF PB-PREM-ACCTNG-ONLY
 11420         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11421
 11422     MOVE SPACE                  TO PB-I-OB-FLAG.
 11423
 11424     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 11425         MOVE ER-2665            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 208
* EL050.cbl
 11426         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11427         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11428
 11429     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11430        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11431           MOVE 'Z'             TO PB-I-OB-FLAG.
 11432
 11433     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11434        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11435           MOVE 'Z'             TO PB-I-OB-FLAG.
 11436
 11437     IF ACCOUNT-MAST-FOUND
 11438         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11439         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11440         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11441         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11442         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11443         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11444         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11445     END-IF
 11446
 11447     IF ACCOUNT-MAST-FOUND
 11448        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11449         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11450
 11451     IF (ACCOUNT-MAST-FOUND)
 11452*        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11453        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S' OR 'D' OR 'P')
 11454        IF PB-REISSUED-CERT
 11455           CONTINUE
 11456        ELSE
 11457           MOVE ER-2608          TO WS-ERROR
 11458           PERFORM 9900-ERROR-FORMAT
 11459                                 THRU 9900-EXIT
 11460         END-IF
 11461     END-IF
 11462
 11463     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11464        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11465        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11466
 11467**********   DMD CUSTOM CODE FOLLOWS  **********
 11468 3024-EDIT-DMD-FIELDS.
 11469     IF PB-COMPANY-ID NOT = 'DMD'
 11470        GO TO 3025-EDIT-REINSURANCE.
 11471
 11472*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11473*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11474*** ERROR IF THEY ARE NOT EQUAL.
 11475
 11476     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11477     SET BIN-TO-GREG               TO TRUE.
 11478     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11479     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11480**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11481
 11482     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11483     SET BIN-TO-GREG               TO TRUE.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 209
* EL050.cbl
 11484     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11485     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11486**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11487
 11488     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11489        MOVE ER-8116               TO WS-ERROR
 11490        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11491
 11492     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11493
 11494     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11495                                      WK-FULL-CERT-NO.
 11496     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11497
 11498     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11499
 11500     IF PB-VALID-LIFE
 11501        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11502     ELSE
 11503        IF PB-VALID-AH
 11504          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11505
 11506
 11507     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11508     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11509     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11510                                      DCUA-UNDRWRTR-CODE
 11511                                      DCUA-UNDRWRTR-GROUP-CODE
 11512                                      DCUA-RETURN-CODE.
 11513
 11514****************************************************************
 11515*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11516***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11517***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11518***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11519***   TO THIS RECORD.                                        ***
 11520****************************************************************
 11521     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11522     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11523     IF DCUA-SUCCESSFUL-PROCESS
 11524        GO TO 3024-EDIT-DL7-CONT.
 11525
 11526     IF DCUA-RETURN-CODE EQUAL '01'
 11527        MOVE ER-8110               TO WS-ERROR
 11528        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11529        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11530        GO TO 3024-EDIT-DL7-CONT.
 11531
 11532     IF DCUA-RETURN-CODE EQUAL '02'
 11533        MOVE ER-8111               TO WS-ERROR
 11534        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11535        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11536        GO TO 3024-EDIT-DL7-CONT.
 11537
 11538     IF DCUA-RETURN-CODE EQUAL '03'
 11539        MOVE ER-8074               TO WS-ERROR
 11540        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11541        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 210
* EL050.cbl
 11542        GO TO 3024-EDIT-DL7-CONT.
 11543
 11544     IF DCUA-RETURN-CODE EQUAL '04'
 11545        MOVE ER-8075               TO WS-ERROR
 11546        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11547        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11548        GO TO 3024-EDIT-DL7-CONT.
 11549
 11550     IF DCUA-RETURN-CODE EQUAL '05'
 11551        MOVE ER-8076               TO WS-ERROR
 11552        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11553        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11554        GO TO 3024-EDIT-DL7-CONT.
 11555
 11556     IF DCUA-RETURN-CODE EQUAL '06'
 11557        MOVE ER-8077               TO WS-ERROR
 11558        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11559        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11560        GO TO 3024-EDIT-DL7-CONT.
 11561
 11562     IF DCUA-RETURN-CODE EQUAL '07'
 11563        MOVE ER-8078               TO WS-ERROR
 11564        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11565        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11566        GO TO 3024-EDIT-DL7-CONT.
 11567
 11568     IF DCUA-RETURN-CODE EQUAL 'E1'
 11569        MOVE ER-8079               TO WS-ERROR
 11570        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11571        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11572        GO TO 3024-EDIT-DL7-CONT.
 11573
 11574     IF DCUA-RETURN-CODE EQUAL 'E2'
 11575        MOVE ER-8080               TO WS-ERROR
 11576        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11577        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11578        GO TO 3024-EDIT-DL7-CONT.
 11579
 11580     IF DCUA-RETURN-CODE EQUAL 'E3'
 11581        MOVE ER-8098               TO WS-ERROR
 11582        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11583        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11584        GO TO 3024-EDIT-DL7-CONT.
 11585
 11586     IF DCUA-RETURN-CODE EQUAL 'C1'
 11587        MOVE ER-8099               TO WS-ERROR
 11588        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11589        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11590        GO TO 3024-EDIT-DL7-CONT.
 11591
 11592     IF DCUA-RETURN-CODE EQUAL 'U1'
 11593        MOVE ER-8109               TO WS-ERROR
 11594        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11595        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11596        GO TO 3024-EDIT-DL7-CONT.
 11597
 11598     IF DCUA-RETURN-CODE EQUAL 'N1'
 11599        MOVE ER-8112               TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 211
* EL050.cbl
 11600        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11601        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11602        GO TO 3024-EDIT-DL7-CONT.
 11603
 11604     IF DCUA-RETURN-CODE EQUAL 'N2'
 11605        MOVE ER-8113               TO WS-ERROR
 11606        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11607        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11608        GO TO 3024-EDIT-DL7-CONT.
 11609
 11610     IF DCUA-RETURN-CODE EQUAL 'N3'
 11611        MOVE ER-8114               TO WS-ERROR
 11612        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11613        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11614        GO TO 3024-EDIT-DL7-CONT.
 11615
 11616     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11617     MOVE ER-8097                  TO WS-ERROR.
 11618     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11619     GO TO 3024-EDIT-DL7-CONT.
 11620
 11621 3024-EDIT-DL7-CONT.
 11622
 11623     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11624     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11625     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11626        NEXT SENTENCE
 11627     ELSE
 11628        MOVE ER-9263               TO WS-ERROR
 11629        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11630
 11631******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11632******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11633     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11634        NEXT SENTENCE
 11635     ELSE
 11636        MOVE ER-8039               TO WS-ERROR
 11637        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11638
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 212
* EL050.cbl
 11640****************************************************************
 11641*** VALIDATE STATE  : DLO022                                 ***
 11642****************************************************************
 11643     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11644     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11645
 11646     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11647     IF DVSC-SUCCESSFUL-EDIT
 11648        GO TO 3024-EDIT-DL22-CONT.
 11649
 11650     IF DVSC-RETURN-CODE EQUAL '01'
 11651        MOVE ER-8300               TO WS-ERROR
 11652        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11653        GO TO 3024-EDIT-DL22-CONT.
 11654
 11655     IF DVSC-RETURN-CODE EQUAL '02'
 11656        MOVE ER-8301               TO WS-ERROR
 11657        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11658        GO TO 3024-EDIT-DL22-CONT.
 11659
 11660     IF DVSC-RETURN-CODE EQUAL '03'
 11661        MOVE ER-8302               TO WS-ERROR
 11662        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11663        GO TO 3024-EDIT-DL22-CONT.
 11664
 11665     IF DVSC-RETURN-CODE EQUAL 'N1'
 11666        MOVE ER-8304               TO WS-ERROR
 11667        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11668        GO TO 3024-EDIT-DL22-CONT.
 11669
 11670     MOVE ER-8303                  TO WS-ERROR
 11671     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11672
 11673 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 213
* EL050.cbl
 11675****************************************************************
 11676*** VALIDATE LOAN OFFICER : DLO021                           ***
 11677****************************************************************
 11678
 11679     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11680     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11681     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11682     IF DVLO-SUCCESSFUL-EDIT
 11683        GO TO 3024-EDIT-DL21-CONT.
 11684
 11685     IF DVLO-RETURN-CODE EQUAL '01'
 11686        MOVE ER-8081               TO WS-ERROR
 11687        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11688        GO TO 3024-EDIT-DL21-CONT.
 11689
 11690     IF DVLO-RETURN-CODE EQUAL '02'
 11691        MOVE ER-8082               TO WS-ERROR
 11692        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11693        GO TO 3024-EDIT-DL21-CONT.
 11694
 11695     IF DVLO-RETURN-CODE EQUAL '03'
 11696        MOVE ER-8083               TO WS-ERROR
 11697        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11698        GO TO 3024-EDIT-DL21-CONT.
 11699
 11700     IF DVLO-RETURN-CODE EQUAL '04'
 11701        MOVE ER-8084               TO WS-ERROR
 11702        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11703        GO TO 3024-EDIT-DL21-CONT.
 11704
 11705     IF DVLO-RETURN-CODE EQUAL '05'
 11706        MOVE ER-8085               TO WS-ERROR
 11707        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11708        GO TO 3024-EDIT-DL21-CONT.
 11709
 11710     MOVE ER-7825                  TO WS-ERROR
 11711     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11712     GO TO 3024-EDIT-DL21-CONT.
 11713
 11714 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 214
* EL050.cbl
 11716
 11717****************************************************************
 11718*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11719****************************************************************
 11720
 11721     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11722     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11723     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11724     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11725     IF DIPF-SUCCESSFUL-EDIT
 11726        GO TO 3024-EDIT-DL02-CONT.
 11727
 11728     IF DIPF-RETURN-CODE EQUAL '01'
 11729        MOVE ER-8086               TO WS-ERROR
 11730        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11731        GO TO 3024-EDIT-DL02-CONT.
 11732
 11733     IF DIPF-RETURN-CODE EQUAL '02'
 11734        MOVE ER-8087               TO WS-ERROR
 11735        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11736        GO TO 3024-EDIT-DL02-CONT.
 11737
 11738     IF DIPF-RETURN-CODE EQUAL '03'
 11739        MOVE ER-8088               TO WS-ERROR
 11740        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11741        GO TO 3024-EDIT-DL02-CONT.
 11742
 11743     MOVE ER-8095                  TO WS-ERROR
 11744     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11745     GO TO 3024-EDIT-DL02-CONT.
 11746
 11747 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 215
* EL050.cbl
 11749
 11750****************************************************************
 11751*** VALIDATE BANK ID : DLO003                                ***
 11752****************************************************************
 11753
 11754     MOVE WK-GREG-CENT           TO WCG-CENT.
 11755     MOVE WK-GREG-YYMM           TO WCG-REST.
 11756     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11757        MOVE ER-8040               TO WS-ERROR
 11758        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11759
 11760     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11761     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11762     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11763     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11764     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11765     IF DVBI-SUCCESSFUL-EDIT
 11766        GO TO 3024-EDIT-DL03-CONT.
 11767
 11768     IF DVBI-RETURN-CODE EQUAL '01'
 11769        MOVE ER-8089               TO WS-ERROR
 11770        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11771        GO TO 3024-EDIT-DL03-CONT.
 11772
 11773     IF DVBI-RETURN-CODE EQUAL '02'
 11774        MOVE ER-8090               TO WS-ERROR
 11775        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11776        GO TO 3024-EDIT-DL03-CONT.
 11777
 11778     IF DVBI-RETURN-CODE EQUAL '03'
 11779        MOVE ER-8091               TO WS-ERROR
 11780        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11781        GO TO 3024-EDIT-DL03-CONT.
 11782
 11783     IF DVBI-RETURN-CODE EQUAL '04'
 11784        MOVE ER-8092               TO WS-ERROR
 11785        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11786        GO TO 3024-EDIT-DL03-CONT.
 11787
 11788     IF DVBI-RETURN-CODE EQUAL '05'
 11789        MOVE ER-8093               TO WS-ERROR
 11790        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11791        GO TO 3024-EDIT-DL03-CONT.
 11792
 11793     IF DVBI-RETURN-CODE EQUAL '06'
 11794        MOVE ER-8094               TO WS-ERROR
 11795        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11796        GO TO 3024-EDIT-DL03-CONT.
 11797
 11798     MOVE ER-8096                  TO WS-ERROR
 11799     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11800     GO TO 3024-EDIT-DL03-CONT.
 11801
 11802 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 216
* EL050.cbl
 11804
 11805     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11806        NEXT SENTENCE
 11807     ELSE
 11808        MOVE ER-8042               TO WS-ERROR
 11809        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11810
 11811     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11812     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11813     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11814
 11815     IF DMPF-RETURN-CODE = '01'
 11816        MOVE ER-8067               TO WS-ERROR
 11817        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11818        GO TO 3024-EDIT-DL01-CONT.
 11819
 11820     IF DMPF-RETURN-CODE = '02'
 11821        MOVE ER-8068               TO WS-ERROR
 11822        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11823        GO TO 3024-EDIT-DL01-CONT.
 11824
 11825     IF DMPF-RETURN-CODE = '03'
 11826        MOVE ER-8069               TO WS-ERROR
 11827        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11828        GO TO 3024-EDIT-DL01-CONT.
 11829
 11830     IF DMPF-RETURN-CODE = 'E1'
 11831        MOVE ER-8070               TO WS-ERROR
 11832        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11833        GO TO 3024-EDIT-DL01-CONT.
 11834
 11835     IF DMPF-RETURN-CODE = 'N1'
 11836        MOVE ER-8071               TO WS-ERROR
 11837        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11838        GO TO 3024-EDIT-DL01-CONT.
 11839
 11840     IF DMPF-RETURN-CODE NOT = 'OK'
 11841        MOVE ER-8072               TO WS-ERROR
 11842        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11843
 11844 3024-EDIT-DL01-CONT.
 11845******************************************************************
 11846***  VALIDATES RATE CODES : DLO017                             ***
 11847******************************************************************
 11848
 11849      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11850      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11851      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11852      IF DVRC-SUCCESSFUL-EDIT
 11853        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11854        GO TO 3024-CHECK-VALID-RATE.
 11855
 11856      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11857
 11858      IF DVRC-RETURN-CODE EQUAL '01'
 11859         MOVE ER-7817                   TO WS-ERROR
 11860         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11861         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 217
* EL050.cbl
 11862
 11863      IF DVRC-RETURN-CODE EQUAL '02'
 11864         MOVE ER-7818                   TO WS-ERROR
 11865         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11866         GO TO 3025-EDIT-REINSURANCE.
 11867
 11868      IF DVRC-RETURN-CODE EQUAL '03'
 11869         MOVE ER-7819                   TO WS-ERROR
 11870         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11871         GO TO 3025-EDIT-REINSURANCE.
 11872
 11873       MOVE ER-7820                     TO WS-ERROR.
 11874       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11875       GO TO 3025-EDIT-REINSURANCE.
 11876
 11877******************************************************************
 11878***  GET PREMIUM RATES : DLO011                                ***
 11879******************************************************************
 11880
 11881 3024-CHECK-VALID-RATE.
 11882
 11883     IF VALID-RATE-CODE
 11884        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11885        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11886        MOVE SPACES                TO DPRB-RETURN-CODE
 11887        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11888     ELSE
 11889         GO TO 3025-EDIT-REINSURANCE.
 11890
 11891      IF DPRB-SUCCESSFUL-PROCESS
 11892         IF PB-VALID-LIFE
 11893             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11894             GO TO 3025-EDIT-REINSURANCE
 11895         ELSE
 11896             IF PB-VALID-AH
 11897                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11898                 GO TO 3025-EDIT-REINSURANCE.
 11899
 11900      IF DPRB-RETURN-CODE EQUAL '01'
 11901         MOVE ER-7812                   TO WS-ERROR
 11902         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11903         GO TO 3025-EDIT-REINSURANCE.
 11904
 11905      IF DPRB-RETURN-CODE EQUAL '02'
 11906         MOVE ER-7813                   TO WS-ERROR
 11907         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11908         GO TO 3025-EDIT-REINSURANCE.
 11909
 11910      IF DPRB-RETURN-CODE EQUAL '03'
 11911         MOVE ER-7814                   TO WS-ERROR
 11912         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11913         GO TO 3025-EDIT-REINSURANCE.
 11914
 11915      IF DPRB-RETURN-CODE EQUAL '04'
 11916         IF NOT DPRB-1ST-TIME
 11917            MOVE ER-7815                   TO WS-ERROR
 11918            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11919            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 218
* EL050.cbl
 11920          ELSE
 11921         IF PB-VALID-LIFE
 11922            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11923          ELSE
 11924            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11925         END-IF
 11926         MOVE SPACES                TO DOCC-RETURN-CODE
 11927         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11928         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11929         IF DOCC-RETURN-CODE = 'OK'
 11930             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11931             GO TO 3024-CHECK-VALID-RATE
 11932           ELSE
 11933             MOVE ER-7823               TO WS-ERROR
 11934             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11935             GO TO 3025-EDIT-REINSURANCE.
 11936
 11937       MOVE ER-7816                     TO WS-ERROR.
 11938       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11939       GO TO 3025-EDIT-REINSURANCE.
 11940
 11941**********   DMD CUSTOM CODE ABOVE    **********
 11942
 11943 3025-EDIT-REINSURANCE.
 11944     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11945         GO TO 3027-EDIT-CONTINUE.
 11946
 11947     MOVE LOW-VALUES               TO ERREIN-KEY.
 11948     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11949     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11950                                      REIN-CODE-2
 11951                                      REIN-CODE-3.
 11952     MOVE 'A'                      TO REIN-TYPE.
 11953
 11954     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11955
 11956     MOVE '3026' TO REIN-SW.
 11957     MOVE ' '                   TO WS-REIN-READ-SW.
 11958
 11959     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11960     IF REIN-TABLE-NOT-FOUND
 11961         GO TO 3026-NO-SPEC-TABLE.
 11962
 11963     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11964     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11965                                   WS-NSP-ST-CD-LF.
 11966     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11967                                   WS-NSP-ST-CD-AH.
 11968
 11969     GO TO 3040-EDIT-CONTINUE.
 11970
 11971 3026-NO-SPEC-TABLE.
 11972
 11973     MOVE ER-2664                TO WS-ERROR.
 11974     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11975     GO TO 3040-EDIT-CONTINUE.
 11976
 11977 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 219
* EL050.cbl
 11978
 11979     IF PB-I-REIN-TABLE = SPACES
 11980       GO TO 3040-EDIT-CONTINUE.
 11981
 11982     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11983          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11984          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11985           GO TO 3040-EDIT-CONTINUE.
 11986
 11987     MOVE LOW-VALUES            TO ERREIN-KEY.
 11988     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11989     MOVE 'A'                   TO REIN-TYPE.
 11990     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11991
 11992     MOVE '3028'                TO REIN-SW.
 11993     MOVE ' '                   TO WS-REIN-READ-SW.
 11994
 11995     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11996     IF REIN-TABLE-NOT-FOUND
 11997         GO TO 3028-NO-REIN-TABLE.
 11998
 11999     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 12000     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12001                                   WS-NSP-ST-CD-LF.
 12002     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12003                                   WS-NSP-ST-CD-AH.
 12004
 12005     GO TO 3040-EDIT-CONTINUE.
 12006
 12007 3028-NO-REIN-TABLE.
 12008
 12009     MOVE ER-2615                TO WS-ERROR.
 12010     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12011     GO TO 3040-EDIT-CONTINUE.
 12012
 12013 3040-EDIT-CONTINUE.
 12014
 12015     IF PB-I-LF-PREM-CALC NOT NUMERIC
 12016         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 12017
 12018     IF PB-I-AH-PREM-CALC NOT NUMERIC
 12019         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 12020
 12021     IF (NOT PB-REISSUED-CERT)
 12022        AND (NOT PB-MONTHLY-CERT)
 12023        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 12024            MOVE '001'           TO PB-I-LF-TERM
 12025            MOVE 'M'             TO PB-I-INSURED-SEX.
 12026
 12027     IF (NOT PB-REISSUED-CERT)
 12028        AND (NOT PB-MONTHLY-CERT)
 12029        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 12030            MOVE '001'           TO PB-I-AH-TERM
 12031            MOVE 'M'             TO PB-I-INSURED-SEX.
 12032
 12033 3040-EDIT-1ST-PMT-DT.
 12034     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 12035     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 220
* EL050.cbl
 12036         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 12037
 12038******************************************************************
 12039*                                                                *
 12040*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 12041*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 12042*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 12043*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 12044*                                                                *
 12045******************************************************************
 12046
 12047     IF PB-EFF-DT-PROCESSING
 12048        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12049                                    PB-I-LF-EXPIRE-DT
 12050                                    PB-I-AH-EXPIRE-DT
 12051        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12052        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12053        MOVE ZERO                TO DC-ELAPSED-DAYS
 12054        MOVE +1                  TO DC-ELAPSED-MONTHS
 12055        SET BIN-PLUS-ELAPSED     TO TRUE
 12056*       MOVE 6                   TO DC-OPTION-CODE
 12057        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12058        IF NO-CONVERSION-ERROR
 12059           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12060
 12061******************************************************************
 12062*                                                                *
 12063*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 12064*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 12065*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12066*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 12067*                                                                *
 12068******************************************************************
 12069
 12070     IF PB-EXT-DAYS-PROCESSING
 12071          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 12072                                         PB-I-LF-EXPIRE-DT
 12073                                         PB-I-AH-EXPIRE-DT
 12074          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 12075          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12076          MOVE +1                     TO DC-ELAPSED-MONTHS
 12077          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 12078          SET BIN-PLUS-ELAPSED        TO TRUE
 12079*         MOVE 6                      TO DC-OPTION-CODE
 12080          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12081          IF NO-CONVERSION-ERROR
 12082             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 12083
 12084******************************************************************
 12085*                                                                *
 12086*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 12087*        BASED ON THE OLDEST EXPIRE DATE.                        *
 12088*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12089*        (EXPIRE DATE - (TERM -1))  *  -1.
 12090*                                                                *
 12091******************************************************************
 12092
 12093     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 221
* EL050.cbl
 12094        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 12095           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 12096              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12097              MOVE PB-I-AH-TERM      TO WS-TERM
 12098           ELSE
 12099              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12100              MOVE PB-I-LF-TERM      TO WS-TERM
 12101        ELSE
 12102           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 12103              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12104              MOVE PB-I-LF-TERM      TO WS-TERM
 12105           ELSE
 12106              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12107              MOVE PB-I-AH-TERM      TO WS-TERM.
 12108
 12109     IF PB-EXPIRE-DT-PROCESSING
 12110        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12111        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12112        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 12113        MOVE ZERO                TO DC-ELAPSED-DAYS
 12114                                    DC-ODD-DAYS-OVER
 12115          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 12116          SET BIN-PLUS-ELAPSED    TO TRUE
 12117*         MOVE 6                  TO DC-OPTION-CODE
 12118          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12119          IF NO-CONVERSION-ERROR
 12120             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12121
 12122******************************************************************
 12123*                                                                *
 12124*            1ST PAYMENT DATE PROCESSING                         *
 12125*                                                                *
 12126******************************************************************
 12127
 12128     IF PB-1ST-PMT-DT-PROCESSING
 12129        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 12130                                    PB-I-AH-EXPIRE-DT
 12131        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 12132
 12133     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 12134         NEXT SENTENCE
 12135     ELSE
 12136         MOVE ER-2680                 TO WS-ERROR
 12137         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12138         GO TO 3060-ORIG-TERM-CHECK.
 12139
 12140     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12141     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 12142     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12143*    MOVE 1                      TO DC-OPTION-CODE.
 12144     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 12145                                    DC-ELAPSED-DAYS
 12146                                    DC-ODD-DAYS-OVER.
 12147
 12148     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12149
 12150     IF DATE-CONVERSION-ERROR
 12151        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 222
* EL050.cbl
 12152
 12153     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 12154     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 12155        AND (WS-LF-COVERAGE-TYPE = 'L')
 12156        IF (DC-ELAPSED-MONTHS > 1)
 12157                      OR
 12158           ((DC-ELAPSED-MONTHS = 1)
 12159           AND (DC-ODD-DAYS-OVER > 0))
 12160           MOVE ER-2882          TO WS-ERROR
 12161           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12162        END-IF
 12163     END-IF
 12164     if dc-elapsed-months > 0
 12165        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12166        + dc-odd-days-over
 12167     end-if
 12168     IF PB-EXT-DAYS-PROCESSING
 12169        CONTINUE
 12170     ELSE
 12171        IF DC-ELAPSED-MONTHS = +0
 12172           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12173        ELSE
 12174           IF (WS-LF-EARNINGS-CALC = '4')
 12175              AND (DC-ELAPSED-MONTHS > ZERO)
 12176              AND (DC-ELAPSED-DAYS > ZERO)
 12177              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12178           ELSE
 12179              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12180                                 THRU 6499-EXIT
 12181              MOVE WS-ODD-DAYS-OVER
 12182                                 TO PB-I-EXTENTION-DAYS
 12183           END-IF
 12184        END-IF
 12185     END-IF
 12186******************************************************************
 12187*                                                                *
 12188*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12189*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12190*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12191*            AND ANY ODD DAYS.                                   *
 12192*                                                                *
 12193******************************************************************
 12194
 12195     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12196                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12197     IF WS-LF-EARNINGS-CALC NOT = '4'
 12198        IF DC-ELAPSED-DAYS > ZEROS
 12199           MOVE ER-2681          TO WS-ERROR
 12200           PERFORM 9900-ERROR-FORMAT
 12201                                 THRU 9900-EXIT
 12202        END-IF
 12203     END-IF
 12204
 12205     IF WS-LF-EARNINGS-CALC NOT = '4'
 12206        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12207           MOVE ER-2681          TO WS-ERROR
 12208           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12209
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 223
* EL050.cbl
 12210     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12211        (PB-I-LF-TERM NOT = ZERO) AND
 12212         NOT NO-LIFE-COVERAGE
 12213          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12214          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12215          IF WS-LF-EARNINGS-CALC = '4'
 12216             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12217             PB-I-PAY-FREQUENCY
 12218          END-IF
 12219          MOVE ZERO              TO DC-ELAPSED-DAYS
 12220                                    DC-ODD-DAYS-OVER
 12221          MOVE 1                 TO DC-END-OF-MONTH
 12222          SET BIN-PLUS-ELAPSED        TO TRUE
 12223*         MOVE 6                 TO DC-OPTION-CODE
 12224          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12225          IF NO-CONVERSION-ERROR
 12226             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12227             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12228                (WS-LF-SPECIAL-CALC-CD = 'L')
 12229                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12230                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12231                  MOVE +1             TO DC-ELAPSED-MONTHS
 12232                  SET BIN-PLUS-ELAPSED  TO TRUE
 12233*                 MOVE 6              TO DC-OPTION-CODE
 12234                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12235                  IF NO-CONVERSION-ERROR
 12236                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12237
 12238* okay, i had to move the new att age edit down here because the
 12239* expiration date could get recalculated and i need the exp date
 12240     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12241        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12242        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12243        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12244           AND ZEROS
 12245           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12246           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12247           SET ELAPSED-BETWEEN-BIN TO TRUE
 12248           PERFORM 8500-DATE-CONVERT
 12249                                 THRU 8500-EXIT
 12250           IF NO-CONVERSION-ERROR
 12251              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12252                 MOVE ER-2669       TO WS-ERROR
 12253*                PERFORM 9900-ERROR-FORMAT
 12254*                                THRU 9900-EXIT
 12255              END-IF
 12256           END-IF
 12257        ELSE
 12258           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12259           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12260              MOVE ER-2669       TO WS-ERROR
 12261*             PERFORM 9900-ERROR-FORMAT
 12262*                                THRU 9900-EXIT
 12263           ELSE
 12264              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12265                 MOVE ER-1570    TO WS-ERROR
 12266                 PERFORM 9900-ERROR-FORMAT
 12267                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 224
* EL050.cbl
 12268              END-IF
 12269           END-IF
 12270        END-IF
 12271        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12272           AND ZEROS
 12273           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12274           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12275           SET ELAPSED-BETWEEN-BIN TO TRUE
 12276           PERFORM 8500-DATE-CONVERT
 12277                                 THRU 8500-EXIT
 12278           IF NO-CONVERSION-ERROR
 12279              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12280                 MOVE ER-2669       TO WS-ERROR
 12281*                PERFORM 9900-ERROR-FORMAT
 12282*                                THRU 9900-EXIT
 12283              END-IF
 12284           END-IF
 12285        ELSE
 12286           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12287             (PB-I-LF-TERM / 12)
 12288           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12289              MOVE ER-2669       TO WS-ERROR
 12290*             PERFORM 9900-ERROR-FORMAT
 12291*                                THRU 9900-EXIT
 12292           ELSE
 12293              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12294                 MOVE ER-1571    TO WS-ERROR
 12295                 PERFORM 9900-ERROR-FORMAT
 12296                                 THRU 9900-EXIT
 12297              END-IF
 12298           END-IF
 12299        END-IF
 12300        IF WS-ERROR = ER-2669
 12301           PERFORM 9900-ERROR-FORMAT
 12302                                 THRU 9900-EXIT
 12303        END-IF
 12304     END-IF
 12305     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12306        (PB-I-AH-TERM NOT = ZERO) AND
 12307         NOT NO-AH-COVERAGE
 12308          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12309             AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 12310             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12311             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12312          ELSE
 12313             IF WS-LF-EARNINGS-CALC = '4'
 12314                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12315                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12316                PB-I-PAY-FREQUENCY
 12317             ELSE
 12318                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12319                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12320             END-IF
 12321          END-IF
 12322          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12323                                         DC-ODD-DAYS-OVER
 12324          MOVE 1                      TO DC-END-OF-MONTH
 12325          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 225
* EL050.cbl
 12326*         MOVE 6                      TO DC-OPTION-CODE
 12327          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12328          IF NO-CONVERSION-ERROR
 12329             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12330     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12331        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12332        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12333        IF PB-I-BIRTHDAY > LOW-VALUES
 12334           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12335           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12336           SET ELAPSED-BETWEEN-BIN TO TRUE
 12337           PERFORM 8500-DATE-CONVERT
 12338                                 THRU 8500-EXIT
 12339           IF NO-CONVERSION-ERROR
 12340              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12341                 MOVE ER-3054       TO WS-ERROR
 12342*                PERFORM 9900-ERROR-FORMAT
 12343*                                THRU 9900-EXIT
 12344              END-IF
 12345           END-IF
 12346        ELSE
 12347           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12348           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12349              MOVE ER-3054       TO WS-ERROR
 12350*             PERFORM 9900-ERROR-FORMAT
 12351*                                THRU 9900-EXIT
 12352           END-IF
 12353        END-IF
 12354        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12355           AND ZEROS
 12356           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12357           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12358           SET ELAPSED-BETWEEN-BIN TO TRUE
 12359           PERFORM 8500-DATE-CONVERT
 12360                                 THRU 8500-EXIT
 12361           IF NO-CONVERSION-ERROR
 12362              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12363                 MOVE ER-3054       TO WS-ERROR
 12364*                PERFORM 9900-ERROR-FORMAT
 12365*                                THRU 9900-EXIT
 12366              END-IF
 12367           END-IF
 12368        ELSE
 12369           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12370             (PB-I-AH-TERM / 12)
 12371           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12372              MOVE ER-3054       TO WS-ERROR
 12373*             PERFORM 9900-ERROR-FORMAT
 12374*                                THRU 9900-EXIT
 12375           END-IF
 12376        END-IF
 12377        IF WS-ERROR = ER-3054
 12378           PERFORM 9900-ERROR-FORMAT
 12379                                 THRU 9900-EXIT
 12380        END-IF
 12381     END-IF
 12382     MOVE SPACE                       TO DC-END-OF-MONTH.
 12383
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 226
* EL050.cbl
 12384     IF PB-COMPANY-ID = 'NCB'
 12385        GO TO 3040-EDIT-EXTENSION-DAYS.
 12386
 12387     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12388       AND
 12389        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12390        NEXT SENTENCE
 12391     ELSE
 12392        GO TO 3040-EDIT-EXTENSION-DAYS.
 12393
 12394     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12395        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12396        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12397     ELSE
 12398        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12399        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12400
 12401     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12402*    MOVE '1'      TO DC-OPTION-CODE
 12403     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12404     IF (NO-CONVERSION-ERROR)
 12405        AND (DC-ELAPSED-MONTHS > +1)
 12406        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12407        MOVE ER-2668   TO WS-ERROR
 12408        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12409
 12410 3040-EDIT-EXTENSION-DAYS.
 12411
 12412     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12413        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12414         GO TO 3050-EDIT-TERM-IN-DAYS
 12415     ELSE
 12416         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12417
 12418     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12419         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12420     ELSE
 12421        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12422           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12423           MOVE ER-2681         TO WS-ERROR
 12424           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12425
 12426     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12427        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12428        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12429         GO TO 3060-ORIG-TERM-CHECK.
 12430
 12431     GO TO 3060-ORIG-TERM-CHECK.
 12432
 12433 3050-EDIT-TERM-IN-DAYS.
 12434
 12435     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12436
 12437     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12438         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12439     ELSE
 12440         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12441            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 227
* EL050.cbl
 12442            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12443
 12444     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12445                                       REMAINDER WS-WORK-TERM.
 12446     IF WS-WORK-TERM GREATER THAN ZERO
 12447         ADD +1 TO PB-I-LF-TERM.
 12448
 12449     IF NOT NO-AH-COVERAGE
 12450         MOVE ER-2684            TO WS-ERROR
 12451         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12452
 12453
 12454 3060-ORIG-TERM-CHECK.
 12455
 12456******************************************************************
 12457*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12458******************************************************************
 12459
 12460     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12461        NEXT SENTENCE
 12462     ELSE
 12463        IF NOT NO-LIFE-COVERAGE
 12464           IF PB-I-LF-TERM NUMERIC
 12465              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12466              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12467              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12468                  NEXT SENTENCE
 12469           ELSE
 12470              MOVE ER-2647       TO WS-ERROR
 12471              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12472
 12473     IF NOT NO-AH-COVERAGE
 12474         IF PB-I-AH-TERM NUMERIC
 12475            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12476            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12477            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12478             NEXT SENTENCE
 12479          ELSE
 12480              MOVE ER-2658       TO WS-ERROR
 12481              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12482
 12483     IF PB-COMPANY-ID = 'NCB'
 12484        GO TO 3070-LOAN-TERM-CHECK.
 12485
 12486     IF POLICY-HAS-AH
 12487       AND
 12488        POLICY-HAS-LIFE
 12489       AND
 12490        PB-I-LF-TERM NUMERIC
 12491       AND
 12492        PB-I-AH-TERM NUMERIC
 12493        NEXT SENTENCE
 12494     ELSE
 12495        GO TO 3070-LOAN-TERM-CHECK.
 12496
 12497     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12498     IF WS-TEX-FACT-2 LESS THAN +0
 12499        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 228
* EL050.cbl
 12500
 12501     IF WS-TEX-FACT-2 GREATER THAN +1
 12502        MOVE ER-2668             TO WS-ERROR
 12503        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12504
 12505 3070-LOAN-TERM-CHECK.
 12506
 12507     IF (WS-LF-BENEFIT-CD = ZERO)
 12508         OR (NO-LF-BENEFIT-MATCH)
 12509            GO TO 3125-EDIT-PMT-FREQ.
 12510*    IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 12511*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12512*          AND 'V' AND 'W' AND 'X'
 12513*          GO TO 3125-EDIT-PMT-FREQ
 12514*       END-IF
 12515*    ELSE
 12516*       IF WS-AH-DCC-TRUNC = 'T'
 12517*          CONTINUE
 12518*       ELSE
 12519*          GO TO 3125-EDIT-PMT-FREQ
 12520*       END-IF
 12521*    END-IF
 12522     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12523                    OR
 12524        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 12525        AND (WS-AH-DCC-TRUNC = 'T'))
 12526        CONTINUE
 12527     ELSE
 12528        GO TO 3125-EDIT-PMT-FREQ
 12529     END-IF
 12530     IF PB-I-LOAN-TERM NOT NUMERIC
 12531         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12532
 12533     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12534        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12535*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12536        PB-I-LOAN-TERM NOT GREATER THAN +360
 12537         NEXT SENTENCE
 12538     ELSE
 12539         MOVE ER-2648            TO WS-ERROR
 12540         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12541
 12542     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12543        MOVE ER-3058             TO WS-ERROR
 12544        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12545     end-if
 12546
 12547     IF WS-STATE-ABBREVIATION = 'NC'
 12548        IF PB-I-LOAN-TERM > +59
 12549           CONTINUE
 12550        ELSE
 12551           MOVE ER-2792          TO WS-ERROR
 12552           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12553        END-IF
 12554     END-IF
 12555
 12556     .
 12557 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 229
* EL050.cbl
 12558     IF (WS-LF-BENEFIT-CD = ZERO)
 12559         OR (NO-LF-BENEFIT-MATCH)
 12560            GO TO 3127-EDIT-LOAN-OFFICER.
 12561     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12562                    OR
 12563        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 12564        AND (WS-AH-DCC-TRUNC = 'T'))
 12565                    OR
 12566         (PB-COMPANY-ID = 'AHL')
 12567        CONTINUE
 12568     ELSE
 12569        IF (PB-I-LOAN-TERM > ZEROS)
 12570           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12571           MOVE ER-1575          TO WS-ERROR
 12572           PERFORM 9900-ERROR-FORMAT
 12573                                 THRU 9900-EXIT
 12574        END-IF
 12575     END-IF
 12576     IF WS-LF-EARNINGS-CALC NOT = '4'
 12577         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12578            MOVE ER-2653         TO WS-ERROR
 12579            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12580            GO TO 3127-EDIT-LOAN-OFFICER
 12581         ELSE
 12582            GO TO 3127-EDIT-LOAN-OFFICER.
 12583
 12584     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12585         MOVE ER-2655            TO WS-ERROR
 12586         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12587         GO TO 3127-EDIT-LOAN-OFFICER.
 12588
 12589     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12590         MOVE ER-2654            TO WS-ERROR
 12591         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12592         GO TO 3127-EDIT-LOAN-OFFICER.
 12593
 12594     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12595         GIVING WS-TEX-FACT-2
 12596             REMAINDER WS-TEX-FACT-3.
 12597
 12598*    IF WS-TEX-FACT-3 NOT = ZERO
 12599*       MOVE ER-2654             TO WS-ERROR
 12600*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12601
 12602
 12603 3127-EDIT-LOAN-OFFICER.
 12604
 12605     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12606        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12607           MOVE ER-2690          TO WS-ERROR
 12608           PERFORM 9900-ERROR-FORMAT
 12609                                 THRU 9900-EXIT
 12610        ELSE
 12611           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12612           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12613           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12614           MOVE PB-SV-STATE      TO LOFC-STATE
 12615           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 230
* EL050.cbl
 12616           MOVE PB-I-LOAN-OFFICER
 12617                                 TO LOFC-CODE
 12618           PERFORM 8586-READ-LOAN-OFFICER
 12619                                 THRU 8586-EXIT
 12620           IF (NOT LOFC-MASTER-FOUND)
 12621              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12622              MOVE ER-3006       TO WS-ERROR
 12623              PERFORM 9900-ERROR-FORMAT
 12624                                 THRU 9900-EXIT
 12625           END-IF
 12626        END-IF
 12627     END-IF
 12628     .
 12629 3129-EDIT-APR.
 12630
 12631     IF (WS-LF-BENEFIT-CD = ZERO)
 12632        OR (NO-LF-BENEFIT-MATCH)
 12633        IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 12634           GO TO 3130-EDIT-AGE
 12635*       ELSE
 12636*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12637*             GO TO 3130-EDIT-AGE
 12638*          END-IF
 12639        END-IF
 12640     END-IF
 12641
 12642     IF (WS-STATE-ABBREVIATION = 'OH')
 12643         AND (PB-I-RATE-CLASS NOT = 'L ')
 12644         AND (PB-I-LF-TERM GREATER THAN 60)
 12645         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12646         GO TO 3129-APR-CONT.
 12647
 12648     IF (WS-STATE-ABBREVIATION = 'RI')
 12649         AND (PB-I-LF-TERM GREATER THAN 60)
 12650         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12651         GO TO 3129-APR-CONT.
 12652
 12653     IF (WS-STATE-ABBREVIATION = 'UT')
 12654         AND (PB-I-LF-TERM GREATER THAN 62)
 12655         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12656         AND (PB-CERT-EFF-DT LESS WS-830901)
 12657         GO TO 3129-APR-CONT.
 12658
 12659     IF PB-COMPANY-ID = 'LAP'
 12660        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12661           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12662              MOVE ER-2656         TO WS-ERROR
 12663              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12664              GO TO 3130-EDIT-AGE.
 12665
 12666     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12667        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12668        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12669        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12670        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 12671        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 12672         GO TO 3130-EDIT-AGE.
 12673
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 231
* EL050.cbl
 12674 3129-APR-CONT.
 12675     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12676         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12677         GO TO 3130-EDIT-AGE.
 12678
 12679     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 12680         WS-AH-BENEFIT-CD (1:1) = 'S')
 12681        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 12682        AND (PB-I-LOAN-APR = ZERO)
 12683        MOVE ER-2657             TO WS-ERROR
 12684        PERFORM 9900-ERROR-FORMAT
 12685                                 THRU 9900-EXIT
 12686        GO TO 3130-EDIT-AGE
 12687     END-IF
 12688*    IF PB-I-LOAN-APR = ZERO
 12689*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12690*    END-IF
 12691
 12692     if pb-i-loan-apr = +99.9999
 12693        move er-2656             to ws-error
 12694        PERFORM 9900-ERROR-FORMAT
 12695                                 THRU 9900-EXIT
 12696        GO TO 3130-EDIT-AGE
 12697     end-if
 12698*    IF PB-I-LOAN-APR = ZERO
 12699*       MOVE ER-2656             TO WS-ERROR
 12700*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12701*       GO TO 3130-EDIT-AGE.
 12702
 12703*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12704     if pb-i-loan-apr not = +99.9999
 12705        IF PB-I-LOAN-APR > +30.000
 12706           MOVE ER-2657          TO WS-ERROR
 12707           PERFORM 9900-ERROR-FORMAT
 12708                                 THRU 9900-EXIT
 12709        end-if
 12710     end-if
 12711     .
 12712 3130-EDIT-AGE.
 12713
 12714******************************************************************
 12715*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12716******************************************************************
 12717
 12718     IF NOT NO-LIFE-COVERAGE
 12719        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12720           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12721               MOVE ER-2628             TO WS-ERROR
 12722               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12723
 12724     IF NOT NO-AH-COVERAGE
 12725        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12726           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12727               MOVE ER-2628         TO WS-ERROR
 12728               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12729
 12730 3133-SEX-CODE.
 12731     IF PB-I-INSURED-SEX = SPACE OR ZERO
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 232
* EL050.cbl
 12732         IF WS-DEFAULT-SEX = 'M'
 12733             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12734          ELSE
 12735             IF WS-DEFAULT-SEX = 'F'
 12736             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12737
 12738     IF PB-I-INSURED-SEX = '1'
 12739         MOVE 'M' TO PB-I-INSURED-SEX.
 12740
 12741     IF PB-I-INSURED-SEX = '2'
 12742         MOVE 'F' TO PB-I-INSURED-SEX.
 12743
 12744 3134-SIG-SW-EDIT.
 12745     IF PB-I-SIG-SW = SPACE
 12746         MOVE 'N'                TO  PB-I-SIG-SW.
 12747
 12748     IF PB-COMPANY-ID = 'NCL'
 12749         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12750             NEXT SENTENCE
 12751         ELSE
 12752             MOVE ER-1923        TO  WS-ERROR
 12753             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12754     ELSE
 12755     IF PB-COMPANY-ID = 'CRI'
 12756         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12757             NEXT SENTENCE
 12758         ELSE
 12759             MOVE ER-2606        TO  WS-ERROR
 12760             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12761     ELSE
 12762     IF PB-COMPANY-ID = 'TMS'
 12763         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12764             NEXT SENTENCE
 12765         ELSE
 12766             MOVE ER-2689        TO  WS-ERROR
 12767             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12768     ELSE
 12769         IF PB-I-SIG-SW = 'Y' OR 'N'
 12770             NEXT SENTENCE
 12771         ELSE
 12772             MOVE ER-2651        TO  WS-ERROR
 12773             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12774
 12775     IF PB-COMPANY-ID = 'FLA'
 12776         IF (WS-EDIT-AGE GREATER 54  OR
 12777             WS-AH-EDIT-AGE GREATER 54)  AND
 12778            PB-I-SIG-SW = 'N'
 12779            MOVE ER-2651         TO  WS-ERROR
 12780            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12781
 12782 3135-NAME-EDIT.
 12783
 12784     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12785        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12786        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12787           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12788                                 TO PB-I-JOINT-FIRST-NAME
 12789        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 233
* EL050.cbl
 12790     END-IF
 12791     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12792        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12793        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12794           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12795                                 TO PB-I-JOINT-LAST-NAME
 12796        END-PERFORM
 12797     END-IF
 12798     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12799        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12800        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12801           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12802                                 TO PB-I-INSURED-FIRST-NAME
 12803        END-PERFORM
 12804     END-IF
 12805     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12806        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12807        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12808           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12809                                 TO PB-I-INSURED-LAST-NAME
 12810        END-PERFORM
 12811     END-IF
 12812     IF PB-I-INSURED-LAST-NAME = SPACES
 12813       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12814       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12815           MOVE ER-2660    TO WS-ERROR
 12816           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12817
 12818 3136-EDIT-SEX.
 12819
 12820******************************************************************
 12821*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12822******************************************************************
 12823
 12824     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12825        (WS-AH-SPECIAL-CALC-CD = 'O')
 12826        NEXT SENTENCE
 12827     ELSE
 12828        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12829           NEXT SENTENCE
 12830        ELSE
 12831           MOVE ER-2629            TO WS-ERROR
 12832           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12833
 12834 3137-EDIT-EFF-DATE.
 12835
 12836     IF PB-REISSUED-CERT       OR
 12837        PB-POLICY-IS-DECLINED  OR
 12838        PB-POLICY-IS-VOIDED
 12839         GO TO 3139-EDIT-COVERAGE-CODES.
 12840
 12841     MOVE SPACE                  TO WS-2671-SW
 12842                                    WS-2672-SW.
 12843
 12844     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12845         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12846             MOVE ER-2703        TO WS-ERROR
 12847             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 234
* EL050.cbl
 12848             GO TO 3139-EDIT-COVERAGE-CODES.
 12849
 12850     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12851         GO TO 3139-EDIT-COVERAGE-CODES.
 12852
 12853     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12854     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12855*    MOVE '1'                    TO DC-OPTION-CODE.
 12856     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12857     MOVE +0                     TO DC-ELAPSED-MONTHS
 12858                                    DC-ELAPSED-DAYS.
 12859     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12860
 12861     IF DATE-CONVERSION-ERROR
 12862         GO TO 3139-EDIT-COVERAGE-CODES.
 12863
 12864     IF DC-ELAPSED-DAYS GREATER +180
 12865         MOVE ER-2672            TO WS-ERROR
 12866         MOVE 'Y'                TO WS-2672-SW
 12867         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12868     END-IF
 12869
 12870     IF WS-ERROR = ER-2671  AND
 12871        PB-COMPANY-ID  = 'LBL'
 12872        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12873        MOVE SPACE               TO WS-2671-SW
 12874        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12875
 12876     IF PB-ISSUE-DATE-FORCED  AND
 12877      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12878         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12879         MOVE ER-2673            TO WS-ERROR
 12880         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12881         MOVE SPACE              TO WS-2671-SW
 12882                                    WS-2672-SW.
 12883
 12884     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12885         IF PB-ISSUE-DATE-FORCED
 12886             MOVE ER-2600          TO  WS-ERROR
 12887             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12888         ELSE
 12889             MOVE ER-2692          TO  WS-ERROR
 12890             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12891
 12892
 12893 3139-EDIT-COVERAGE-CODES.
 12894
 12895     if pb-company-id not = 'AHL'
 12896        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12897           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12898           MOVE ER-2787          TO WS-ERROR
 12899           PERFORM 9900-ERROR-FORMAT
 12900                                 THRU 9900-EXIT
 12901        END-IF
 12902     end-if
 12903     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12904        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12905                                 > 250000.00
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 235
* EL050.cbl
 12906           MOVE ER-2719          TO WS-ERROR
 12907           PERFORM 9900-ERROR-FORMAT
 12908                                 THRU 9900-EXIT
 12909        END-IF
 12910     END-IF
 12911
 12912     IF PB-POLICY-IS-DECLINED  OR
 12913        PB-POLICY-IS-VOIDED
 12914         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12915
 12916     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12917        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12918         MOVE ER-2630                TO WS-ERROR
 12919         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12920
 12921     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12922        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12923        PB-I-LF-PREMIUM-AMT = ZERO
 12924         GO TO 3140-CHECK-AH-FOR-ZERO.
 12925
 12926     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12927        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12928        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12929         GO TO 3140-CHECK-AH-FOR-ZERO.
 12930
 12931     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12932        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12933        MOVE ER-2631             TO WS-ERROR
 12934        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12935     END-IF
 12936
 12937
 12938******************************************************************
 12939*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12940******************************************************************
 12941
 12942     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12943        NEXT SENTENCE
 12944     ELSE
 12945        IF PB-I-LF-BENEFIT-AMT = ZERO
 12946           MOVE ER-2632             TO WS-ERROR
 12947           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12948
 12949
 12950******************************************************************
 12951*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12952******************************************************************
 12953
 12954     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12955        CONTINUE
 12956     ELSE
 12957        IF PB-I-LF-PREMIUM-AMT = ZERO
 12958           IF (NOT PB-COMP-LF-PREM)
 12959              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12960              and (ws-lf-ben-category not = 'C')
 12961              MOVE ER-2633       TO WS-ERROR
 12962              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12963           END-IF
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 236
* EL050.cbl
 12964        END-IF
 12965     END-IF
 12966     .
 12967 3140-CHECK-AH-FOR-ZERO.
 12968
 12969     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12970        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12971        PB-I-AH-PREMIUM-AMT = ZERO
 12972         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12973
 12974     IF PB-COMPANY-ID = 'CSL'  AND
 12975        PB-I-AH-BENEFIT-CD = ZERO  AND
 12976        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12977        PB-I-AH-PREMIUM-AMT = ZERO
 12978         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12979
 12980     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12981        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12982        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12983         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12984
 12985     IF PB-I-AH-BENEFIT-CD = ZERO
 12986         MOVE ER-2634            TO WS-ERROR
 12987         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12988
 12989******************************************************************
 12990*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12991******************************************************************
 12992
 12993     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12994        NEXT SENTENCE
 12995     ELSE
 12996        IF PB-I-AH-BENEFIT-AMT = ZERO
 12997           MOVE ER-2635             TO WS-ERROR
 12998           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12999
 13000******************************************************************
 13001*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13002******************************************************************
 13003
 13004     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13005        NEXT SENTENCE
 13006     ELSE
 13007        IF PB-I-AH-PREMIUM-AMT = ZERO
 13008            IF NOT PB-COMP-AH-PREM
 13009                MOVE ER-2636    TO WS-ERROR
 13010                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13011
 13012
 13013 3140-EDIT-MAX-AMT-SIZES.
 13014* CUSTOM CODE FOR CLIENT    'DMD'
 13015     MOVE ZEROS                   TO WS-RES-STATE-TAX
 13016                                     WS-RES-MUNI-TAX
 13017                                     PB-I-STATE-TAX
 13018                                     PB-I-MUNI-TAX.
 13019
 13020     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 13021
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 237
* EL050.cbl
 13022     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 13023        GO TO 3150-RATE-OUTSTAND-BAL.
 13024
 13025     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 13026        GO TO 3150-RATE-OUTSTAND-BAL.
 13027
 13028     IF WS-LF-EARNINGS-CALC EQUAL '5'
 13029        GO TO 3150-RATE-OUTSTAND-BAL.
 13030
 13031     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 13032                             OR 'RIC')
 13033        GO TO 3150-RATE-OUTSTAND-BAL.
 13034
 13035     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 13036        IF PB-I-LOAN-APR GREATER THAN ZEROS
 13037            GO TO 3150-RATE-OUTSTAND-BAL
 13038        ELSE
 13039           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 13040               GO TO 3150-RATE-OUTSTAND-BAL.
 13041
 13042     IF NOT PB-NO-MONTHS-SKIPPED
 13043        GO TO 3150-RATE-OUTSTAND-BAL.
 13044
 13045     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 13046        GO TO 3150-RATE-OUTSTAND-BAL.
 13047
 13048     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 13049        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 13050           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 13051             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 13052           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 13053           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 13054              MOVE ER-2693     TO WS-ERROR
 13055              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13056              GO TO 3150-RATE-OUTSTAND-BAL
 13057           ELSE
 13058              GO TO 3150-RATE-OUTSTAND-BAL.
 13059
 13060 3150-RATE-OUTSTAND-BAL.
 13061
 13062* DMD RATING TEST
 13063     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13064         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13065         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13066         MOVE ER-2687                 TO WS-ERROR
 13067         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13068         MOVE 'B'                     TO PB-I-OB-FLAG
 13069         GO TO 3260-EDIT-CONTINUE.
 13070
 13071     IF  PB-COMPANY-ID   EQUAL    'CRI'
 13072         IF  WS-ERROR    EQUAL    ER-2693
 13073             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 13074                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13075                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13076                 MOVE  +0            TO  WS-ERROR.
 13077
 13078     IF  PB-COMPANY-ID   EQUAL    'CDL'
 13079         IF  WS-ERROR    EQUAL    ER-2693
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 238
* EL050.cbl
 13080             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 13081                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13082                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13083                 MOVE  +0            TO  WS-ERROR.
 13084
 13085     IF PLAN-MASTER-AH-SW = 'Y'
 13086        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13087            IF  WS-ERROR    EQUAL    ER-2693
 13088              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13089                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13090                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13091                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13092                 MOVE  ER-1910           TO  WS-ERROR
 13093                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13094
 13095     IF PLAN-MASTER-AH-SW = 'Y'
 13096        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13097            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13098               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13099               MOVE  ER-1910           TO  WS-ERROR
 13100               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13101
 13102     IF PLAN-MASTER-AH-SW = 'Y'
 13103        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13104            IF  WS-ERROR    EQUAL    ER-2693
 13105                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 13106                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13107                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13108                 MOVE  +0       TO  WS-ERROR.
 13109
 13110     IF WS-ERROR = ER-2693
 13111        IF PB-COMPANY-ID = 'JAL' AND
 13112           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 13113           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13114           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13115
 13116     IF WS-ERROR = ER-2693
 13117        IF PB-COMPANY-ID = 'NCL'  AND
 13118           PB-I-AH-BENEFIT-CD = 'OA'
 13119           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13120           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13121
 13122     IF WS-ERROR = ER-2693
 13123        IF PB-COMPANY-ID = 'CNL' AND
 13124           PB-I-LF-BENEFIT-CD = '71' OR '72'
 13125           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13126           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13127
 13128     IF WS-ERROR = ER-2693
 13129        IF PB-COMPANY-ID = 'HER'
 13130           IF WS-LEVEL
 13131              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13132              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13133
 13134     IF ((LF-BENEFIT-FOUND) AND
 13135         (NOT NO-LIFE-COVERAGE)  AND
 13136         (WS-LF-SPECIAL-CALC-CD = 'O'))
 13137       OR   ((AH-BENEFIT-FOUND) AND
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 239
* EL050.cbl
 13138             (NOT NO-AH-COVERAGE)    AND
 13139             (WS-AH-SPECIAL-CALC-CD = 'O'))
 13140         NEXT SENTENCE
 13141     ELSE
 13142         GO TO 3215-EDIT-RATES.
 13143
 13144     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13145        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13146           MOVE ER-2674          TO WS-ERROR
 13147           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13148           GO TO 3215-EDIT-RATES.
 13149
 13150     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13151        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13152           MOVE ER-2674          TO WS-ERROR
 13153           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13154           GO TO 3215-EDIT-RATES.
 13155
 13156     MOVE 'B'                    TO PB-I-OB-FLAG.
 13157
 13158     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13159         NEXT SENTENCE
 13160     ELSE
 13161         IF NOT NO-LIFE-COVERAGE
 13162             IF WS-ACCT-LF-OB-RT = ZERO
 13163                MOVE ER-2641    TO WS-ERROR
 13164                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13165
 13166     IF PB-COMPANY-ID = 'CRI'
 13167       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13168         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13169         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13170         IF WS-ERROR = ER-2675
 13171            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13172            MOVE ER-2687              TO WS-ERROR
 13173            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13174         ELSE
 13175            MOVE ER-2687              TO WS-ERROR
 13176            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13177
 13178
 13179     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13180         NEXT SENTENCE
 13181     ELSE
 13182       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13183            NEXT SENTENCE
 13184       ELSE
 13185         IF NOT NO-AH-COVERAGE
 13186             IF WS-ACCT-AH-OB-RT = ZERO
 13187                MOVE ER-2642    TO WS-ERROR
 13188                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13189
 13190     IF PB-COMPANY-ID = 'CRI'
 13191       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13192         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13193         IF WS-ERROR = ER-2676
 13194            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13195            MOVE ER-2687              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 240
* EL050.cbl
 13196            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13197         ELSE
 13198            MOVE ER-2687              TO WS-ERROR
 13199            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13200
 13201     IF PB-COMPANY-ID NOT = 'GIC'
 13202         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13203            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13204     ELSE
 13205         IF PB-I-LF-PREM-CALC = ZEROS
 13206             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13207                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13208
 13209     IF PB-COMPANY-ID NOT = 'GIC'
 13210         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13211            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13212     ELSE
 13213         IF PB-I-AH-PREM-CALC = ZEROS
 13214             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13215                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13216
 13217     MOVE ZEROS TO PB-I-MORT-CODE.
 13218
 13219     GO TO 3260-EDIT-CONTINUE.
 13220
 13221
 13222 3215-EDIT-RATES.
 13223     IF ACCOUNT-MAST-FOUND
 13224         NEXT SENTENCE
 13225     ELSE
 13226         GO TO 3999-END-EDIT.
 13227
 13228 3220-CHECK-LF-RATES.
 13229
 13230     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13231        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13232        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13233        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13234           AND (NOT WS-LF-CASH))
 13235                           OR
 13236           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13237           AND (NOT WS-AH-CASH)))
 13238                       AND
 13239           (PB-I-ENTRY-STATUS NOT = '5')
 13240           MOVE 'M'              TO PB-BATCH-ENTRY
 13241                                    PB-I-ENTRY-STATUS
 13242        END-IF
 13243     END-IF
 13244     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13245                                    PB-I-AH-PREM-CALC
 13246                                    PB-I-LF-ALT-PREM-CALC
 13247                                    PB-I-LF-ALT-RATE
 13248                                    PB-I-LF-REI-RATE
 13249                                    PB-I-LF-ALT-REI-RATE
 13250                                    PB-I-AH-REI-RATE
 13251                                    PB-I-TOT-FEES-CALC.
 13252
 13253     IF PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 241
* EL050.cbl
 13254        NEXT SENTENCE
 13255     ELSE
 13256        MOVE ZEROS               TO PB-I-LF-RATE
 13257                                    PB-I-AH-RATE.
 13258
 13259     IF PB-I-TOT-FEES NOT NUMERIC
 13260        MOVE ZEROS               TO PB-I-TOT-FEES
 13261     END-IF
 13262     IF PB-I-LIVES NOT NUMERIC
 13263         MOVE ZERO               TO PB-I-LIVES.
 13264
 13265     IF PB-I-NUM-BILLED NOT NUMERIC
 13266         MOVE ZERO               TO PB-I-NUM-BILLED.
 13267
 13268     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13269        MOVE +0                  TO PB-I-LF-PREM-TAX
 13270     END-IF
 13271
 13272     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13273        MOVE +0                  TO PB-I-AH-PREM-TAX
 13274     END-IF
 13275
 13276     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13277        PB-I-PAY-FREQUENCY = ZEROS
 13278            MOVE 12 TO CP-PAY-FREQUENCY
 13279     ELSE
 13280            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13281
 13282     IF PB-I-STATE-TAX NOT NUMERIC
 13283         MOVE ZEROS               TO PB-I-STATE-TAX.
 13284
 13285     IF PB-I-MUNI-TAX NOT NUMERIC
 13286         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13287
 13288     MOVE SPACES                 TO CP-BEN-CATEGORY
 13289     IF PB-COMPANY-ID  = 'CSL'  AND
 13290        PB-I-LF-TERM NOT = ZERO
 13291        COMPUTE WS-PAYMENT-AMT =
 13292             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13293        COMPUTE WS-CSL-AMT1 =
 13294             PB-I-LF-TERM * AM-MAX-MON-BEN
 13295        COMPUTE WS-CSL-AMT2 =
 13296             WS-PAYMENT-AMT * PB-I-LF-TERM
 13297        IF CP-PAY-FREQUENCY NOT = 12
 13298           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13299           MOVE '8' TO WS-CSL-CALC-CD
 13300        ELSE
 13301           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13302              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13303               AM-MAX-TOT-BEN
 13304               MOVE '6' TO WS-CSL-CALC-CD
 13305           ELSE
 13306              IF (WS-CSL-AMT1  GREATER THAN
 13307                 AM-MAX-TOT-BEN) AND
 13308                 (WS-CSL-AMT2  GREATER THAN
 13309                 AM-MAX-TOT-BEN)
 13310                 MOVE '7' TO WS-CSL-CALC-CD
 13311              ELSE
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 242
* EL050.cbl
 13312                 MOVE '5' TO WS-CSL-CALC-CD.
 13313
 13314     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13315         NEXT SENTENCE
 13316     ELSE
 13317         GO TO 3300-CHECK-AH-RATES.
 13318
 13319*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13320
 13321     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13322        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13323              OR
 13324           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13325           MOVE ER-2618          TO WS-ERROR
 13326           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13327           GO TO 3300-CHECK-AH-RATES.
 13328
 13329     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13330           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13331                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13332
 13333     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13334         MOVE ER-2687             TO WS-ERROR
 13335         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13336         MOVE 'Z000'              TO PB-I-MORT-CODE
 13337         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13338         GO TO 3300-CHECK-AH-RATES.
 13339
 13340     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13341        IF PB-I-LIVES = ZERO
 13342           MOVE ER-2688          TO WS-ERROR
 13343           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13344
 13345     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13346
 13347     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13348     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13349     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13350     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13351     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13352     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13353     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13354     MOVE '3'                    TO CP-PROCESS-TYPE.
 13355     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13356     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13357
 13358******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13359     IF PB-COMPANY-ID EQUAL 'CDL'
 13360         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13361            CP-EARN-AS-NET-PAY)
 13362             IF PB-CERT-EFF-DT GREATER  WS-931231
 13363                 MOVE '1'        TO CP-EARNING-METHOD.
 13364*******
 13365
 13366     MOVE PB-SV-STATE            TO CP-STATE.
 13367     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13368     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13369     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 243
* EL050.cbl
 13370     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13371     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13372                                    CP-RATING-BENEFIT-AMT.
 13373     IF CP-STATE-STD-ABBRV = 'OR'
 13374         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13375                                         PB-I-LF-ALT-BENEFIT-AMT.
 13376     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13377     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13378     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13379     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13380     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13381     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13382     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13383     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13384     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13385                                    CP-REMAINING-TERM
 13386                                    CP-LOAN-TERM.
 13387
 13388     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13389         NEXT SENTENCE
 13390     ELSE
 13391         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13392             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13393                                           PB-I-LF-PREMIUM-AMT.
 13394
 13395     IF PB-COMPANY-ID EQUAL 'CSL'
 13396        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13397           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13398                                         PB-I-LF-PREMIUM-AMT.
 13399
 13400     IF PB-COMPANY-ID EQUAL 'NCB'
 13401         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13402            CP-EARN-AS-NET-PAY
 13403             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13404                 PB-I-LF-PREMIUM-AMT.
 13405
 13406     IF (CP-TRUNCATED-LIFE)
 13407        or ((pb-company-id = 'AHL')
 13408           and (pb-i-loan-term > pb-i-lf-term))
 13409        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13410
 13411     IF PB-COMPANY-ID EQUAL 'CRI'
 13412        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13413
 13414     IF CP-TERM-IS-DAYS
 13415         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13416     ELSE
 13417         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13418     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13419        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13420        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13421        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13422        IF WS-LF-BEN-CATEGORY = 'D'
 13423           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13424           MOVE PB-I-LIFE-COMMISSION
 13425                                 TO CP-DCC-ACT-COMM
 13426           MOVE WS-LF-BEN-CATEGORY
 13427                                 TO CP-BEN-CATEGORY
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 244
* EL050.cbl
 13428        END-IF
 13429        IF (CP-BENEFIT-CD (1:1) = 'P')
 13430           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13431           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13432           add pb-i-ah-premium-amt to cp-original-premium
 13433        END-IF
 13434     END-IF
 13435     IF PB-COMPANY-ID = 'CSL'
 13436         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13437         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13438         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13439
 13440     IF PB-COMPANY-ID = 'CSL'
 13441        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13442
 13443     IF (CP-SPECIAL-CALC-CD = 'H')
 13444        OR (PB-COMPANY-ID = 'DCC' or 'VPP')
 13445         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13446                                    TO CP-ALTERNATE-BENEFIT
 13447         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13448     if (pb-company-id = 'CID')
 13449        and (ws-lf-earnings-calc = '4')
 13450        and (cp-state-std-abbrv = 'MN' OR 'WA')
 13451        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13452        move pb-i-term-type      to cp-pmt-mode
 13453        move pb-i-no-of-payments to cp-no-of-pmts
 13454     end-if
 13455     move ws-net-only-state      to cp-net-only-state
 13456     IF (PB-COMPANY-ID = 'CID')
 13457        AND (WS-LF-EARNINGS-CALC = 'B')
 13458        AND (CP-STATE-STD-ABBRV = 'MN')
 13459        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13460                                 TO CP-ALTERNATE-BENEFIT
 13461        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13462     END-IF
 13463     IF (PB-COMPANY-ID = 'CID')
 13464        AND (WS-LF-EARNINGS-CALC = 'B')
 13465        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13466                                 TO CP-ALTERNATE-BENEFIT
 13467        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13468        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13469*       compute cp-original-benefit = pb-i-lf-benefit-amt -
 13470*         pb-i-lf-alt-premium-amt
 13471        MOVE WS-LF-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13472        IF WS-LF-BEN-CATEGORY = 'P'
 13473           MOVE WS-EXTRA-PMTS    TO CP-EXTRA-PERIODS
 13474        ELSE
 13475           IF WS-LF-BEN-CATEGORY = 'I'
 13476              MOVE WS-INT-PERIODS TO CP-EXTRA-PERIODS
 13477           END-IF
 13478        END-IF
 13479     END-IF
 13480     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13481     MOVE 'R'                   TO CP-RATE-FILE.
 13482     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13483
 13484     IF CP-ERROR-RATE-NOT-FOUND
 13485        MOVE ER-2641            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 245
* EL050.cbl
 13486        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13487        GO TO 3300-CHECK-AH-RATES.
 13488
 13489     IF PB-COMPANY-ID EQUAL 'CRI'
 13490        IF CP-ERROR-NO-LIMITS-CRI
 13491           IF NOT ACCOUNT-LIFE-CHECKED
 13492              MOVE ER-2607      TO WS-ERROR
 13493              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13494
 13495******************************************************************
 13496*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13497*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13498******************************************************************
 13499
 13500* CALC LIFE AGE AT EXPIRATION.
 13501
 13502     COMPUTE WS-AGE-AT-EXPIRE =
 13503          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13504
 13505*    IF PB-STATE = 'CO' OR 'UT'
 13506*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13507*        MOVE 'F'            TO PB-FATAL-FLAG
 13508*        MOVE ER-2709        TO WS-ERROR
 13509*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13510*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13511
 13512*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13513*        MOVE 'X'            TO PB-FATAL-FLAG
 13514*        MOVE ER-2718        TO WS-ERROR
 13515*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13516*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13517
 13518* CALC A & H AGE AT EXPIRATION.
 13519
 13520     COMPUTE WS-AGE-AT-EXPIRE =
 13521          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13522
 13523*    IF PB-STATE = 'CO' OR 'UT'
 13524*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13525*        MOVE 'F'            TO PB-FATAL-FLAG
 13526*        MOVE ER-2709        TO WS-ERROR
 13527*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13528*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13529
 13530*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13531*        MOVE 'X'            TO PB-FATAL-FLAG
 13532*        MOVE ER-2718        TO WS-ERROR
 13533*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13534*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13535
 13536     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13537        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13538
 13539     IF (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13540        and (not pb-monthly-cert)
 13541        GO TO 3221-CHECK-ERROR-RATE-OPEN
 13542     end-if
 13543
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 246
* EL050.cbl
 13544     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13545        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13546
 13547     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13548         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13549         MOVE ER-2639        TO WS-ERROR
 13550         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13551
 13552
 13553******************************************************************
 13554*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13555******************************************************************
 13556
 13557 PREMIUM-EDITING-IS-BYPASSED.
 13558     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13559        AND (CP-R-MAX-ATT-AGE > +0)
 13560        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13561        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13562           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13563           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13564           MOVE '1'              TO DC-OPTION-CODE
 13565           PERFORM 8500-DATE-CONVERT
 13566                                 THRU 8500-EXIT
 13567           IF NO-CONVERSION-ERROR
 13568              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13569                 MOVE ER-2661       TO WS-ERROR
 13570*                PERFORM 9900-ERROR-FORMAT
 13571*                                THRU 9900-EXIT
 13572              END-IF
 13573           END-IF
 13574        ELSE
 13575           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13576           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13577              MOVE ER-2661       TO WS-ERROR
 13578*             PERFORM 9900-ERROR-FORMAT
 13579*                                THRU 9900-EXIT
 13580           ELSE
 13581              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13582                 MOVE ER-1570    TO WS-ERROR
 13583                 PERFORM 9900-ERROR-FORMAT
 13584                                 THRU 9900-EXIT
 13585              END-IF
 13586           END-IF
 13587        END-IF
 13588        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13589           MOVE PB-I-JOINT-BIRTHDAY
 13590                                 TO DC-BIN-DATE-1
 13591           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13592           MOVE '1'              TO DC-OPTION-CODE
 13593           PERFORM 8500-DATE-CONVERT
 13594                                 THRU 8500-EXIT
 13595           IF NO-CONVERSION-ERROR
 13596              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13597                 MOVE ER-2661       TO WS-ERROR
 13598*                PERFORM 9900-ERROR-FORMAT
 13599*                                THRU 9900-EXIT
 13600              END-IF
 13601           ELSE
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 247
* EL050.cbl
 13602              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13603           END-IF
 13604        ELSE
 13605           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13606             (PB-I-LF-TERM / 12)
 13607           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13608              MOVE ER-2661       TO WS-ERROR
 13609*             PERFORM 9900-ERROR-FORMAT
 13610*                                THRU 9900-EXIT
 13611           ELSE
 13612              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13613                 MOVE ER-1571    TO WS-ERROR
 13614                 PERFORM 9900-ERROR-FORMAT
 13615                                 THRU 9900-EXIT
 13616              END-IF
 13617           END-IF
 13618        END-IF
 13619        IF WS-ERROR = ER-2661
 13620           PERFORM 9900-ERROR-FORMAT
 13621                                 THRU 9900-EXIT
 13622        END-IF
 13623     END-IF
 13624*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13625*       MOVE ER-2661             TO WS-ERROR
 13626*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13627
 13628     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13629        MOVE ER-2662             TO WS-ERROR
 13630        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13631
 13632     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13633        MOVE ER-2677             TO WS-ERROR
 13634        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13635
 13636     IF CP-ERROR-LOAN-TERM
 13637        MOVE ER-2648             TO WS-ERROR
 13638        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13639
 13640 3221-CHECK-ERROR-RATE-OPEN.
 13641
 13642     IF CP-ERROR-RATE-FILE-NOTOPEN
 13643         GO TO 3990-FILES-NOT-OPEN.
 13644
 13645     IF PB-COMPANY-ID NOT = 'DMD'
 13646        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13647     END-IF
 13648     .
 13649 3221-CONTINUE.
 13650     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13651                                    WS-DCC-AH-RATE
 13652     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13653        IF WS-LF-BEN-CATEGORY = 'D'
 13654           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13655              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13656        END-IF
 13657     END-IF
 13658     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13659*   X'A4FF' = 12/31/2009
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 248
* EL050.cbl
 13660     IF (PB-COMPANY-ID = 'CID')
 13661        AND (WS-LF-EARNINGS-CALC = 'B')
 13662        AND (CP-STATE-STD-ABBRV = 'MN')
 13663        AND (PB-CERT-EFF-DT > X'A4FF')
 13664        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13665     END-IF
 13666     MOVE ZEROS                  TO PB-I-LF-POLICY-FEE.
 13667
 13668     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13669     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 13670        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13671        AND (PB-I-POLICY-IS-MONTHLY)
 13672        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13673        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13674     END-IF
 13675     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13676     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13677     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13678     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13679     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 13680        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13681        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13682        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13683        MOVE ER-2786             TO WS-ERROR
 13684        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13685     END-IF
 13686
 13687     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13688
 13689******************************************************************
 13690*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13691******************************************************************
 13692     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 13693        and ((not pb-monthly-cert)
 13694        or (ws-lf-ben-category = 'C'))
 13695        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13696
 13697     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13698        GO TO 3225-CHECK-ALT-LIFE-RATE
 13699     ELSE
 13700       IF PB-I-LF-RATE = ZERO
 13701          MOVE ER-2641          TO WS-ERROR
 13702          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13703
 13704 3225-CHECK-ALT-LIFE-RATE.
 13705
 13706     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13707        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13708        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13709         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13710
 13711     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13712         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13713             AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
 13714                   OR
 13715              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13716              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13717              AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 249
* EL050.cbl
 13718             MOVE ER-2720        TO  WS-ERROR
 13719             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13720             GO TO 3225-RATING-CONT
 13721         ELSE
 13722             GO TO 3225-RATING-CONT.
 13723     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13724        AND (AM-GPCD = 01 OR 06 OR 15)
 13725        MOVE ER-2798             TO WS-ERROR
 13726        PERFORM 9900-ERROR-FORMAT
 13727                                 THRU 9900-EXIT
 13728*       GO TO 3225-RATING-CONT
 13729     END-IF
 13730     if (pb-company-id = 'CID')
 13731        and (ws-lf-earnings-calc = 'B')
 13732        and (ws-lf-ben-category = 'P' or 'I')
 13733        and (ws-net-only-state = 'Y')
 13734        move cp-lf-balloon-prem  to pb-i-lf-alt-prem-calc
 13735        display ' balloon prem ' pb-i-lf-alt-prem-calc
 13736        go to 3225-rating-cont
 13737     end-if
 13738     IF (PB-COMPANY-ID = 'CID')
 13739        AND (WS-LF-EARNINGS-CALC = 'B')
 13740        AND (CP-STATE-STD-ABBRV = 'MN')
 13741        AND (PB-CERT-EFF-DT > X'A4FF')
 13742        GO TO 3225-RATING-CONT
 13743     END-IF
 13744     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13745        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13746           AND (PB-I-POLICY-IS-MONTHLY)
 13747           GO TO 3225-RATING-CONT
 13748        END-IF
 13749     END-IF
 13750
 13751     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13752        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13753        CP-EARN-AS-REG-BALLOON
 13754        NEXT SENTENCE
 13755     ELSE
 13756        MOVE '2'                 TO CP-EARNING-METHOD.
 13757
 13758 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13759
 13760     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13761
 13762     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13763        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13764        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13765         NEXT SENTENCE
 13766     ELSE
 13767         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13768
 13769     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13770     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13771     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13772                                     CP-RATING-BENEFIT-AMT.
 13773     IF CP-STATE-STD-ABBRV = 'OR'
 13774         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13775                                         PB-I-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 250
* EL050.cbl
 13776     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13777        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13778     END-IF
 13779     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13780     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13781     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13782                                    CP-REMAINING-TERM
 13783                                    CP-LOAN-TERM.
 13784     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13785        ADD +1                   TO CP-ORIGINAL-TERM
 13786                                    CP-REMAINING-TERM
 13787                                    CP-LOAN-TERM.
 13788
 13789     MOVE 'R'                   TO CP-RATE-FILE.
 13790     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13791
 13792     IF CP-ERROR-RATE-NOT-FOUND
 13793         MOVE ER-2641            TO WS-ERROR
 13794         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13795         GO TO 3300-CHECK-AH-RATES.
 13796
 13797     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13798     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13799
 13800     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13801         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13802
 13803     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13804                               + PB-I-LF-ALT-BENEFIT-AMT.
 13805
 13806     IF ACCOUNT-LIFE-CHECKED  OR
 13807        PB-POLICY-IS-VOIDED   OR
 13808        ((WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13809        and (not pb-monthly-cert))
 13810        GO TO 3225-CONTINUE.
 13811
 13812     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13813        GO TO 3225-CONTINUE.
 13814
 13815     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13816                             EC-RT-LF-MAX-TOT-BEN
 13817        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13818        MOVE ER-2639       TO WS-ERROR
 13819        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13820
 13821 3225-CONTINUE.
 13822     IF PB-I-LF-ALT-RATE = ZERO
 13823         MOVE ER-2659            TO WS-ERROR
 13824         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13825
 13826     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13827        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13828        MOVE ER-2698             TO WS-ERROR
 13829        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13830
 13831 3225-RATING-CONT.
 13832
 13833     IF (WS-LF-SPECIAL-CALC-CD = 'E')
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 251
* EL050.cbl
 13834        and (not pb-monthly-cert)
 13835         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13836         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13837         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 13838            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13839            CONTINUE
 13840         ELSE
 13841            MOVE ER-2687         TO WS-ERROR
 13842            PERFORM 9900-ERROR-FORMAT
 13843                                 THRU 9900-EXIT
 13844         END-IF
 13845         GO TO 3290-EDIT-LF-REIN-RATE
 13846     END-IF
 13847
 13848* DMD RATING TEST
 13849     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13850         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13851         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13852         MOVE ER-2687                 TO WS-ERROR
 13853         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13854         GO TO 3290-EDIT-LF-REIN-RATE.
 13855
 13856 3230-CLIENT-MORT-CD-SPECIALS.
 13857
 13858     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13859     SET BIN-TO-GREG          TO TRUE.
 13860*    MOVE ' '                 TO DC-OPTION-CODE.
 13861     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13862     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13863
 13864 C-POS-3230-MORT-CD.
 13865     IF PB-COMPANY-ID = 'POS' AND
 13866        PB-SV-CARRIER = '2'
 13867         NEXT SENTENCE
 13868     ELSE
 13869         GO TO C-POS-3240-MORT-CD.
 13870
 13871     IF PB-SV-GROUPING = '030'
 13872        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13873         MOVE '2350' TO PB-I-MORT-CODE
 13874      ELSE
 13875         MOVE '3300' TO PB-I-MORT-CODE.
 13876
 13877
 13878 C-POS-3240-MORT-CD.
 13879     IF PB-COMPANY-ID = 'POS' AND
 13880        PB-SV-CARRIER = '1'
 13881         NEXT SENTENCE
 13882     ELSE
 13883         GO TO 3230-CONTINUE.
 13884
 13885     IF PB-SV-STATE = '45' OR '47'
 13886        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13887         MOVE '5200' TO PB-I-MORT-CODE
 13888     ELSE
 13889         MOVE '8300' TO PB-I-MORT-CODE.
 13890
 13891 3230-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 252
* EL050.cbl
 13892
 13893     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13894        GO TO 3240-CONTINUE
 13895     END-IF
 13896
 13897     IF PB-CERT-EFF-DT > WS-971231
 13898        GO TO 3240-CONTINUE
 13899     END-IF
 13900
 13901     IF LF-BENEFIT-FOUND AND
 13902        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13903         MOVE 'F250'       TO PB-I-MORT-CODE
 13904     ELSE
 13905         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13906             MOVE '7250'   TO PB-I-MORT-CODE
 13907         ELSE
 13908             MOVE '4251'   TO PB-I-MORT-CODE
 13909         END-IF
 13910     END-IF
 13911
 13912     .
 13913 3240-CONTINUE.
 13914
 13915     IF PB-COMPANY-ID NOT = 'GNL'
 13916         GO TO 3256-CONTINUE.
 13917
 13918     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13919         MOVE 'A300' TO PB-I-MORT-CODE
 13920     ELSE
 13921         MOVE '8350' TO PB-I-MORT-CODE.
 13922
 13923 3256-CONTINUE.
 13924     IF PB-COMPANY-ID NOT = 'ABL'
 13925         GO TO 3260-EDIT-CONTINUE.
 13926
 13927     IF PB-I-LF-TERM GREATER THAN 59
 13928         MOVE 'F550' TO PB-I-MORT-CODE
 13929     ELSE
 13930         MOVE 'E550' TO PB-I-MORT-CODE.
 13931
 13932 3260-EDIT-CONTINUE.
 13933     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13934
 13935 3290-EDIT-LF-REIN-RATE.
 13936     IF LF-REIN-NSP-NOT-USED
 13937         GO TO 3290-RATING-CONT.
 13938
 13939     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13940        GO TO 3290-RATING-CONT.
 13941     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13942     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13943     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13944     MOVE '3'                   TO CP-PROCESS-TYPE.
 13945     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13946
 13947******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13948     IF PB-COMPANY-ID EQUAL 'CDL'
 13949         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 253
* EL050.cbl
 13950            CP-EARN-AS-NET-PAY)
 13951             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13952*            MOVE SPACE          TO DC-OPTION-CODE
 13953             SET BIN-TO-GREG     TO TRUE
 13954             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13955***  Y2K PROJ 7744
 13956             IF DC-GREG-DATE-CYMD GREATER 19931231
 13957                 MOVE '1'        TO CP-EARNING-METHOD.
 13958***  Y2K PROJ 7744
 13959*******
 13960
 13961     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13962     MOVE PB-SV-STATE           TO CP-STATE.
 13963     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13964     MOVE ZERO                  TO CP-DEVIATION-CODE
 13965                                   CP-RATE-DEV-PCT.
 13966     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13967     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13968                                   CP-RATING-BENEFIT-AMT.
 13969
 13970************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13971     IF PB-COMPANY-ID EQUAL 'NCB'
 13972         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13973            CP-EARN-AS-NET-PAY
 13974             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13975                 PB-I-LF-PREMIUM-AMT.
 13976************
 13977
 13978     IF CP-STATE-STD-ABBRV = 'OR'
 13979         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13980                                         PB-I-LF-ALT-BENEFIT-AMT.
 13981     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13982     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13983     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13984     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13985     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13986     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13987     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 13988     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13989                                   CP-REMAINING-TERM
 13990                                   CP-LOAN-TERM.
 13991     IF CP-TRUNCATED-LIFE
 13992        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13993
 13994     IF CP-TERM-IS-DAYS
 13995         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13996     ELSE
 13997         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13998
 13999     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14000        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14001     END-IF
 14002     IF PB-COMPANY-ID NOT = 'TIC'
 14003          MOVE ZERO          TO CP-CLASS-CODE.
 14004
 14005     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 14006
 14007     MOVE 'R'                   TO CP-RATE-FILE.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 254
* EL050.cbl
 14008     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14009
 14010     IF CP-ERROR-RATE-NOT-FOUND
 14011        IF PB-I-OB
 14012           MOVE ER-2625      TO WS-ERROR
 14013           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14014           GO TO 3299-EDIT-CONTINUE
 14015        ELSE
 14016           MOVE ER-2643      TO WS-ERROR
 14017           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14018           GO TO 3299-EDIT-CONTINUE.
 14019
 14020     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 14021
 14022     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 14023     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 14024
 14025     IF PB-I-LF-REI-RATE = ZERO
 14026         MOVE ER-2643        TO WS-ERROR
 14027         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14028
 14029 3290-CHECK-ALT-REIN-RATE.
 14030
 14031     IF WS-LF-EARNINGS-CALC NOT = 'B'
 14032        GO TO 3290-RATING-CONT.
 14033
 14034     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14035     MOVE '2'                    TO CP-EARNING-METHOD.
 14036     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 14037     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14038     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14039     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14040                                     CP-RATING-BENEFIT-AMT.
 14041     IF CP-STATE-STD-ABBRV = 'OR'
 14042         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14043                                         PB-I-LF-ALT-BENEFIT-AMT.
 14044     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14045        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14046     END-IF
 14047     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14048     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14049     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14050                                    CP-REMAINING-TERM
 14051                                    CP-LOAN-TERM.
 14052     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14053        ADD +1                   TO CP-ORIGINAL-TERM
 14054                                    CP-REMAINING-TERM
 14055                                    CP-LOAN-TERM.
 14056
 14057     MOVE 'R'                   TO CP-RATE-FILE.
 14058     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14059
 14060     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 14061
 14062     IF PB-I-LF-ALT-REI-RATE = ZERO
 14063         MOVE ER-2643            TO WS-ERROR
 14064         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14065
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 255
* EL050.cbl
 14066 3290-RATING-CONT.
 14067
 14068     IF PB-I-OB
 14069*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14070        GO TO 3300-CHECK-AH-RATES.
 14071
 14072 3299-EDIT-CONTINUE.
 14073
 14074     IF  PB-I-MORT-CODE GREATER THAN SPACES
 14075         NEXT SENTENCE
 14076     ELSE
 14077         MOVE ER-2620           TO WS-ERROR
 14078         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14079
 14080 3300-CHECK-AH-RATES.
 14081     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 14082         NEXT SENTENCE
 14083     ELSE
 14084         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14085
 14086     IF ((WS-AH-SPECIAL-CALC-CD = 'E')
 14087        and (not pb-monthly-cert))
 14088                  or
 14089        ((CF-COMPANY-ID = 'DMD') AND
 14090                (NO-DMD-RATING))
 14091         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14092            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14093            CONTINUE
 14094         ELSE
 14095            MOVE ER-2687         TO WS-ERROR
 14096            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14097         END-IF
 14098         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14099         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 14100     END-IF
 14101
 14102     IF PB-I-OB
 14103        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14104
 14105     IF WS-AH-SPECIAL-CALC-CD = 'M'
 14106         MOVE ER-2687             TO WS-ERROR
 14107         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14108         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14109         GO TO 3999-END-EDIT.
 14110
 14111*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 14112     if pb-company-id = 'AHL'
 14113        go to 3300-skip-crit-per
 14114     end-if
 14115     if (pb-i-ah-crit-per not = zeros)
 14116        and (ws-ah-special-calc-cd not = 'C')
 14117        MOVE ER-1572             TO WS-ERROR
 14118        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14119        go to 3300-skip-crit-per
 14120     END-IF
 14121     if (pb-company-id = 'DCC' or 'VPP')
 14122        and (am-dcc-product-code not = spaces)
 14123        go to 3300-skip-crit-per
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 256
* EL050.cbl
 14124     end-if
 14125     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 14126        IF PB-I-AH-CRIT-PER = ZERO
 14127           move ws-ah-max-bens   to pb-i-ah-crit-per
 14128*          MOVE ER-2618       TO WS-ERROR
 14129*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14130*          GO TO 3999-END-EDIT
 14131        END-IF
 14132     END-IF
 14133     if (ws-ah-special-calc-cd = 'C')
 14134        and (pb-i-ah-crit-per <> ws-ah-max-bens)
 14135        MOVE ER-1576             TO WS-ERROR
 14136        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14137     end-if
 14138
 14139     .
 14140 3300-skip-crit-per.
 14141     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14142     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14143     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14144     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14145     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14146     MOVE PB-SV-STATE            TO CP-STATE.
 14147     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14148     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 14149     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 14150*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14151     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14152     MOVE '3'                    TO CP-PROCESS-TYPE.
 14153     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14154     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14155                                    CP-RATING-BENEFIT-AMT.
 14156     IF PB-COMPANY-ID = 'CID'
 14157               OR
 14158        CP-STATE-STD-ABBRV = 'OR'
 14159         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14160                                         PB-I-AH-TERM.
 14161     IF PB-COMPANY-ID = 'DCC' or 'VPP' OR 'CID'
 14162        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 14163           AND (PB-I-POLICY-IS-MONTHLY)
 14164           MOVE PB-I-LF-BENEFIT-AMT
 14165                                 TO CP-NET-BENEFIT-AMT
 14166           move pb-i-ah-premium-amt to cp-original-premium
 14167           add pb-i-lf-premium-amt to cp-original-premium
 14168        END-IF
 14169     END-IF
 14170     MOVE SPACES                 TO CP-BEN-CATEGORY
 14171     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14172        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 14173        EVALUATE TRUE
 14174           WHEN (WS-AH-BEN-CATEGORY = 'G')
 14175              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14176              MOVE PB-I-LF-BENEFIT-AMT
 14177                                 TO CP-RATING-BENEFIT-AMT
 14178              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 14179           WHEN WS-AH-BEN-CATEGORY = 'G'
 14180              MOVE PB-I-UNPAID-CASH-PRICE
 14181                                 TO CP-RATING-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 257
* EL050.cbl
 14182           WHEN WS-AH-BEN-CATEGORY = 'D'
 14183              MOVE WS-AH-PMF-COMM
 14184                                 TO CP-DCC-PMF-COMM
 14185              MOVE PB-I-AH-COMMISSION
 14186                                 TO CP-DCC-ACT-COMM
 14187        END-EVALUATE
 14188     END-IF
 14189     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14190     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14191     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14192     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14193     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14194     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 14195     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14196                                    CP-REMAINING-TERM
 14197                                    WS-WORK-TERM.
 14198     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 14199
 14200     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14201     SET BIN-TO-GREG             TO TRUE.
 14202*    MOVE ' '                    TO DC-OPTION-CODE.
 14203     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14204     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 14205
 14206     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 14207     IF NOT VALID-SKIP-CODE
 14208         MOVE ER-2683            TO WS-ERROR
 14209         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14210         GO TO 3320-RATE-CONTINUE.
 14211
 14212     IF PB-NO-MONTHS-SKIPPED
 14213         GO TO 3320-RATE-CONTINUE.
 14214
 14215     MOVE SPACE TO NUMBER-OF-MONTHS.
 14216
 14217     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14218         MOVE 'S'                TO SK-MO (6).
 14219     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14220         MOVE 'S'                TO SK-MO (7).
 14221     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14222         MOVE 'S'                TO SK-MO (8).
 14223     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14224         MOVE 'S'                TO SK-MO (9).
 14225     IF PB-I-SKIP-CODE = 'A'
 14226         MOVE 'S'                TO SK-MO (10).
 14227
 14228     MOVE 1                      TO SUB2.
 14229     MOVE PB-I-AH-TERM           TO SUB3.
 14230     MOVE WS-MONTH               TO SUB1.
 14231     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14232     GO TO 3320-RATE-CONTINUE.
 14233
 14234 3310-GET-SKIP-MO.
 14235     IF SUB1 = 13
 14236         MOVE 1                  TO SUB1.
 14237
 14238     IF SK-MO (SUB1) = 'S'
 14239         SUBTRACT 1 FROM WS-WORK-TERM.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 258
* EL050.cbl
 14240
 14241     ADD 1 TO SUB2
 14242              SUB1.
 14243
 14244 3320-RATE-CONTINUE.
 14245
 14246     IF WS-WORK-TERM = ZERO
 14247         MOVE 1                  TO WS-WORK-TERM.
 14248
 14249     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14250                                    CP-LOAN-TERM.
 14251
 14252     IF PB-COMPANY-ID EQUAL 'DMD'
 14253         NEXT SENTENCE
 14254     ELSE
 14255         MOVE ZERO               TO PB-I-AH-RATE
 14256                                    PB-I-AH-REI-RATE.
 14257
 14258
 14259     IF PB-COMPANY-ID EQUAL 'CRI'
 14260        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14261
 14262     IF PB-COMPANY-ID = 'CSL'
 14263         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14264         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14265         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14266         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14267
 14268     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14269        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14270           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14271              PB-I-RATE-DEV-PCT-LF
 14272        END-IF
 14273        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14274                                 TO CP-ALTERNATE-BENEFIT
 14275        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14276        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14277        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14278     END-IF
 14279     IF (PB-COMPANY-ID = 'CID')
 14280        AND (WS-LF-EARNINGS-CALC = 'B')
 14281        AND (CP-STATE-STD-ABBRV = 'MN')
 14282        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14283     ELSE
 14284        MOVE ' '                 TO CP-AH-BALLOON-SW
 14285     END-IF
 14286     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14287     MOVE 'R'                   TO CP-RATE-FILE.
 14288     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14289
 14290     IF (CP-ERROR-RATE-NOT-FOUND)
 14291        and (not pb-monthly-cert)
 14292        IF PB-I-OB
 14293           MOVE ER-2624          TO WS-ERROR
 14294           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14295           GO TO 3340-CALCULATE-PREMIUM-AMT
 14296        ELSE
 14297          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 259
* EL050.cbl
 14298              NEXT SENTENCE
 14299          ELSE
 14300           MOVE ER-2642          TO WS-ERROR
 14301           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14302           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14303
 14304     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14305        CP-ERROR-DIV-BY-ZERO
 14306           MOVE ER-3782          TO WS-ERROR
 14307           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14308
 14309     IF PB-COMPANY-ID EQUAL 'CRI'
 14310        IF CP-ERROR-NO-LIMITS-CRI
 14311           IF NOT ACCOUNT-AH-CHECKED
 14312              MOVE ER-2607          TO WS-ERROR
 14313              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14314
 14315     IF ACCOUNT-AH-CHECKED
 14316        NEXT SENTENCE
 14317     ELSE
 14318       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14319          MOVE ER-2640           TO WS-ERROR
 14320          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14321
 14322     IF PB-COMPANY-ID = 'CRI'
 14323         IF WS-ERROR = ER-2640
 14324             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14325     IF ACCOUNT-AH-CHECKED
 14326        CONTINUE
 14327     ELSE
 14328        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14329           AND (CP-R-MAX-ATT-AGE > +0)
 14330           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14331           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14332              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14333              MOVE PB-I-AH-EXPIRE-DT
 14334                                 TO DC-BIN-DATE-2
 14335              MOVE '1'           TO DC-OPTION-CODE
 14336              PERFORM 8500-DATE-CONVERT
 14337                                 THRU 8500-EXIT
 14338              IF NO-CONVERSION-ERROR
 14339                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14340                    MOVE ER-2661       TO WS-ERROR
 14341*                   PERFORM 9900-ERROR-FORMAT
 14342*                                THRU 9900-EXIT
 14343                 END-IF
 14344              END-IF
 14345           ELSE
 14346              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14347              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14348                 MOVE ER-2661    TO WS-ERROR
 14349*                PERFORM 9900-ERROR-FORMAT
 14350*                                THRU 9900-EXIT
 14351              ELSE
 14352                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14353                    MOVE ER-1570 TO WS-ERROR
 14354                    PERFORM 9900-ERROR-FORMAT
 14355                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 260
* EL050.cbl
 14356                 END-IF
 14357              END-IF
 14358           END-IF
 14359           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14360              MOVE PB-I-JOINT-BIRTHDAY
 14361                                    TO DC-BIN-DATE-1
 14362              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14363              MOVE '1'              TO DC-OPTION-CODE
 14364              PERFORM 8500-DATE-CONVERT
 14365                                    THRU 8500-EXIT
 14366              IF NO-CONVERSION-ERROR
 14367                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14368                    MOVE ER-2661       TO WS-ERROR
 14369*                   PERFORM 9900-ERROR-FORMAT
 14370*                                   THRU 9900-EXIT
 14371                 END-IF
 14372              END-IF
 14373           ELSE
 14374              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14375                (PB-I-AH-TERM / 12)
 14376              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14377                 MOVE ER-2661       TO WS-ERROR
 14378*                PERFORM 9900-ERROR-FORMAT
 14379*                                   THRU 9900-EXIT
 14380              ELSE
 14381                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14382                    MOVE ER-1571 TO WS-ERROR
 14383                    PERFORM 9900-ERROR-FORMAT
 14384                                 THRU 9900-EXIT
 14385                 END-IF
 14386              END-IF
 14387           END-IF
 14388           IF WS-ERROR = ER-2661
 14389              PERFORM 9900-ERROR-FORMAT
 14390                                    THRU 9900-EXIT
 14391           END-IF
 14392        END-IF
 14393     END-IF
 14394*    IF ACCOUNT-AH-CHECKED
 14395*       NEXT SENTENCE
 14396*    ELSE
 14397*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14398*          MOVE ER-2661          TO WS-ERROR
 14399*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14400
 14401     IF ACCOUNT-AH-CHECKED
 14402        NEXT SENTENCE
 14403     ELSE
 14404        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14405           MOVE ER-2663          TO WS-ERROR
 14406           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14407
 14408     IF ACCOUNT-AH-CHECKED OR
 14409        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14410         PB-POLICY-IS-VOIDED
 14411        NEXT SENTENCE
 14412     ELSE
 14413        IF CP-ERROR-TOT-OUTSIDE-LIMIT
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 261
* EL050.cbl
 14414           MOVE ER-2667            TO WS-ERROR
 14415           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14416
 14417     IF PB-COMPANY-ID = 'CRI'
 14418         IF WS-ERROR = ER-2667
 14419             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14420
 14421     IF ACCOUNT-AH-CHECKED
 14422        NEXT SENTENCE
 14423     ELSE
 14424        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14425           MOVE ER-2678            TO WS-ERROR
 14426           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14427
 14428     IF CP-ERROR-RATE-FILE-NOTOPEN
 14429         GO TO 3990-FILES-NOT-OPEN.
 14430
 14431 3321-CONTINUE.
 14432     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14433     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14434     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14435        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14436        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14437                                    PB-I-LF-ALT-PREM-CALC
 14438        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14439     END-IF
 14440     IF PB-COMPANY-ID = 'DCC'
 14441        IF WS-AH-BEN-CATEGORY = 'G'
 14442           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14443           + PB-I-ADDL-CLP)
 14444           * (1 + WS-TOL-CLP-PCT)
 14445*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14446        ELSE
 14447           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14448           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14449*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14450        END-IF
 14451        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14452                                 TO PB-I-AH-PREM-CALC
 14453        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14454           MOVE ER-8152          TO WS-ERROR
 14455           PERFORM 9900-ERROR-FORMAT
 14456                                 THRU 9900-EXIT
 14457        ELSE
 14458           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14459                 PB-I-ADDL-CLP)
 14460              MOVE ER-8148       TO WS-ERROR
 14461              PERFORM 9900-ERROR-FORMAT
 14462                                 THRU 9900-EXIT
 14463           END-IF
 14464        END-IF
 14465     END-IF
 14466     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14467        AND (PB-I-POLICY-IS-MONTHLY)
 14468        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14469        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14470        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14471           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 262
* EL050.cbl
 14472        END-IF
 14473     END-IF
 14474     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14475        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14476        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14477        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14478        MOVE ER-2786             TO WS-ERROR
 14479        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14480     END-IF
 14481     MOVE +0                     TO PB-I-AH-CLP
 14482     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14483        evaluate true
 14484           when WS-AH-BEN-CATEGORY = 'D'
 14485              COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT
 14486                * (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14487           when WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14488              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14489           when WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14490              compute ws-cred-union-fees rounded =
 14491                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14492                    pb-i-ah-commission)
 14493              COMPUTE PB-I-AH-CLP =
 14494                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14495        end-evaluate
 14496     END-IF
 14497     MOVE CP-CANCEL-FEE          TO PB-I-CANCEL-FEE
 14498
 14499     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14500         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14501
 14502     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14503         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14504
 14505     if (ws-ah-special-calc-cd = 'E')
 14506        and (pb-monthly-cert)
 14507        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14508     end-if
 14509     IF PB-COMPANY-ID = 'CRI'
 14510         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14511            PB-I-PAYMENT-AMOUNT = ZERO
 14512             NEXT SENTENCE
 14513         ELSE
 14514             COMPUTE PB-I-AH-PREM-CALC =
 14515                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14516                 (CP-PREMIUM-RATE / 100)
 14517             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14518                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14519                                             PB-I-RATE-DEV-PCT-AH.
 14520
 14521     IF (PB-I-AH-RATE  = ZERO)
 14522        and (not pb-monthly-cert)
 14523       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14524           NEXT SENTENCE
 14525       ELSE
 14526         MOVE ER-2642            TO WS-ERROR
 14527         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14528
 14529     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 263
* EL050.cbl
 14530     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14531     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14532     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14533     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14534     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14535
 14536     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14537        AND (WS-AH-BEN-CATEGORY = 'G')
 14538        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14539        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14540        IF CP-DEVIATION-CODE NOT = '000'
 14541           MOVE '000'            TO CP-DEVIATION-CODE
 14542           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14543           IF NO-CP-ERROR
 14544              COMPUTE PB-I-DDF-IU-RATE-UP =
 14545              PB-I-AH-CLP - CP-CALC-PREMIUM
 14546           ELSE
 14547              MOVE ER-3057        TO WS-ERROR
 14548              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14549           END-IF
 14550        END-IF
 14551     END-IF
 14552     .
 14553 3335-EDIT-AH-REIN-NSP-RATE.
 14554     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14555        if WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14556              compute ws-cred-union-fees rounded =
 14557                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14558                    pb-i-ah-commission)
 14559              COMPUTE PB-I-AH-CLP =
 14560                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14561        end-if
 14562     END-IF
 14563     IF AH-REIN-NSP-NOT-USED
 14564         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14565
 14566     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14567     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14568         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14569     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14570     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14571     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14572     MOVE PB-SV-STATE            TO CP-STATE.
 14573     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14574     MOVE ZERO                   TO CP-DEVIATION-CODE
 14575                                    CP-RATE-DEV-PCT.
 14576*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14577     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14578     MOVE '3'                    TO CP-PROCESS-TYPE.
 14579     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14580     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14581                                    CP-RATING-BENEFIT-AMT.
 14582     IF CP-STATE-STD-ABBRV = 'OR'
 14583         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14584                                         PB-I-AH-TERM.
 14585     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14586     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14587     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 264
* EL050.cbl
 14588     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14589     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14590     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14591                                    CP-REMAINING-TERM
 14592                                    WS-WORK-TERM.
 14593     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14594     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14595        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14596     END-IF
 14597     IF  PB-COMPANY-ID = 'TIC'
 14598         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14599            MOVE ZERO TO CP-CLASS-CODE.
 14600
 14601     IF PB-COMPANY-ID NOT = 'TIC'
 14602          MOVE ZERO          TO CP-CLASS-CODE.
 14603
 14604     MOVE ZERO               TO CP-DEVIATION-CODE.
 14605
 14606     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14607
 14608     MOVE ZERO               TO PB-I-AH-REI-RATE.
 14609
 14610     MOVE 'R'                   TO CP-RATE-FILE.
 14611     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14612
 14613     IF CP-ERROR-RATE-NOT-FOUND
 14614         MOVE ER-2645        TO WS-ERROR
 14615         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14616         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14617
 14618     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14619
 14620     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14621     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14622
 14623     IF PB-I-AH-REI-RATE = ZERO
 14624         MOVE ER-2645        TO WS-ERROR
 14625         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14626
 14627
 14628 3340-CALCULATE-PREMIUM-AMT.
 14629
 14630     IF PB-COMPANY-ID = 'NCL'
 14631         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14632             WS-AH-SPECIAL-CALC-CD = 'O')
 14633             GO TO 3999-END-EDIT.
 14634
 14635     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14636                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14637                        'TMS' OR 'GTL' OR 'CID' OR 'DCC' or 'VPP'
 14638                         OR 'AHL'
 14639         NEXT SENTENCE
 14640     ELSE
 14641         IF WS-STATE-ABBREVIATION = 'CT'
 14642             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14643                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14644                 COMPUTE PB-I-LF-PREM-CALC =
 14645                                     PB-I-LF-PREM-CALC * .90
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 265
* EL050.cbl
 14646                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14647                                     PB-I-LF-ALT-PREM-CALC * .90
 14648                 COMPUTE PB-I-AH-PREM-CALC =
 14649                                     PB-I-AH-PREM-CALC * .90.
 14650
 14651     IF PB-COMP-LF-PREM
 14652        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14653        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14654
 14655     IF PB-COMP-AH-PREM
 14656        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14657
 14658 3340-CHECK-DCC-TOT-FEES.
 14659     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14660        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14661        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14662        AND (PB-I-POLICY-IS-MONTHLY)
 14663        CONTINUE
 14664     ELSE
 14665        GO TO 3340-EDIT-LF-AH-TOL
 14666     END-IF
 14667     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14668     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14669     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14670        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14671           PB-I-RATE-DEV-PCT-LF
 14672     END-IF
 14673     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14674        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14675           PB-I-RATE-DEV-PCT-AH
 14676     END-IF
 14677     MOVE 'N'                    TO CP-BEN-CATEGORY
 14678     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14679
 14680     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14681     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14682     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14683     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14684     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14685     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14686     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14687     MOVE '3'                    TO CP-PROCESS-TYPE.
 14688     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14689     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14690
 14691     MOVE PB-SV-STATE            TO CP-STATE.
 14692     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14693     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14694     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14695     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14696     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14697                                    CP-RATING-BENEFIT-AMT.
 14698     IF CP-STATE-STD-ABBRV = 'OR'
 14699         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14700                                         PB-I-LF-ALT-BENEFIT-AMT.
 14701     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14702     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14703     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 266
* EL050.cbl
 14704     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14705     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14706     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14707     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14708     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14709     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14710                                    CP-REMAINING-TERM
 14711                                    CP-LOAN-TERM.
 14712     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14713        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14714           PB-I-LF-PREMIUM-AMT
 14715     end-if
 14716
 14717     IF CP-TRUNCATED-LIFE
 14718        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14719
 14720     IF CP-TERM-IS-DAYS
 14721         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14722     ELSE
 14723         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14724
 14725     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14726     IF CP-SPECIAL-CALC-CD = 'H'
 14727         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14728                                    TO CP-ALTERNATE-BENEFIT
 14729         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14730     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14731     MOVE 'R'                    TO CP-RATE-FILE
 14732     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14733     IF NOT CP-ERROR-RATE-NOT-FOUND
 14734        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14735        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14736           AND (CP-BENEFIT-CD (1:1) = 'S')
 14737           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14738                                    PB-I-LF-PREMIUM-AMT
 14739        END-IF
 14740     ELSE
 14741        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14742     END-IF
 14743     .
 14744 3340-EDIT-LF-AH-TOL.
 14745
 14746***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14747***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14748***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14749***
 14750     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14751         PB-I-AH-PREMIUM-AMT
 14752          GIVING WS-CALC-WORK.
 14753
 14754     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14755        AND WS-CALC-WORK NOT = ZERO
 14756         MOVE ER-2649            TO WS-ERROR
 14757         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14758
 14759     SUBTRACT PB-I-LF-PREM-CALC
 14760             FROM PB-I-LF-PREMIUM-AMT
 14761                 GIVING WS-UNSIGN-WRK1.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 267
* EL050.cbl
 14762
 14763     SUBTRACT PB-I-LF-ALT-PREM-CALC
 14764             FROM PB-I-LF-ALT-PREMIUM-AMT
 14765                 GIVING WS-UNSIGN-WRK4.
 14766
 14767     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14768                                + WS-UNSIGN-WRK4.
 14769
 14770     SUBTRACT PB-I-AH-PREM-CALC
 14771             FROM PB-I-AH-PREMIUM-AMT
 14772                 GIVING WS-UNSIGN-WRK2.
 14773
 14774******************************************************************
 14775*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14776******************************************************************
 14777
 14778     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14779         MOVE ZERO TO WS-UNSIGN-WRK1.
 14780
 14781     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14782         MOVE ZERO TO WS-UNSIGN-WRK2.
 14783
 14784     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14785             GIVING WS-UNSIGN-WRK3.
 14786
 14787 3342-CONTINUE.
 14788
 14789     IF (PB-I-LF-RATE = ZERO  AND
 14790         PB-I-AH-RATE = ZERO)
 14791         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14792            WS-AH-SPECIAL-CALC-CD = 'O'
 14793              NEXT SENTENCE
 14794         ELSE
 14795             GO TO 3345-EDIT-CONTINUE.
 14796
 14797     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14798         NEXT SENTENCE
 14799     ELSE
 14800     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14801        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14802           IF (PB-REISSUED-CERT         OR
 14803               PB-POLICY-IS-DECLINED    OR
 14804               PB-POLICY-IS-VOIDED)
 14805              NEXT SENTENCE
 14806           ELSE
 14807              IF WS-PREM-REJECT-SW = SPACE
 14808                 MOVE ER-2652    TO WS-ERROR
 14809                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14810                 GO TO 3344-CHECK-AH
 14811              ELSE
 14812                 MOVE ER-2650    TO WS-ERROR
 14813                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14814                 GO TO 3344-CHECK-AH.
 14815
 14816***
 14817***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14818***
 14819
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 268
* EL050.cbl
 14820     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14821         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 14822            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14823             (1 + WS-TOL-LF-PREM-PCT)
 14824         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14825            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14826             (1 - WS-TOL-LF-PREM-PCT)
 14827     ELSE
 14828         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 14829         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 14830
 14831***
 14832***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14833***
 14834
 14835     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14836         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14837          WS-TOL-LF-PREM.
 14838
 14839     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14840         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 14841          WS-TOL-LF-PREM.
 14842
 14843     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14844        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14845
 14846     IF PB-REISSUED-CERT
 14847        or PB-POLICY-IS-DECLINED
 14848        or PB-POLICY-IS-VOIDED
 14849        continue
 14850     ELSE
 14851        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14852              > WS-TOL-LF-HIGH-PREM-AMT)
 14853           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14854              < WS-TOL-LF-LOW-PREM-AMT))
 14855                      or
 14856           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14857              > WS-TOL-LF-HIGH-PREM-PCT)
 14858           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14859              < WS-TOL-LF-LOW-PREM-PCT))
 14860           IF WS-PREM-REJECT-SW = SPACE
 14861              MOVE ER-2652       TO WS-ERROR
 14862              PERFORM 9900-ERROR-FORMAT
 14863                                 THRU 9900-EXIT
 14864           ELSE
 14865              MOVE ER-2650       TO WS-ERROR
 14866              PERFORM 9900-ERROR-FORMAT
 14867                                 THRU 9900-EXIT
 14868           end-if
 14869        end-if
 14870     end-if
 14871
 14872*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14873*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14874*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14875*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14876
 14877     IF WS-ERROR  =  ER-2650  OR  ER-2652
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 269
* EL050.cbl
 14878        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14879                      OR
 14880           ((PB-COMPANY-ID = 'DCC' or 'VPP')
 14881           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 14882           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14883           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14884        END-IF
 14885     END-IF
 14886
 14887     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14888        IF WS-COMP-MAX-CAP GREATER THAN +0
 14889           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14890              IF (PB-REISSUED-CERT         OR
 14891                  PB-POLICY-IS-DECLINED    OR
 14892                  PB-POLICY-IS-VOIDED)
 14893                 NEXT SENTENCE
 14894              ELSE
 14895                  MOVE ER-2646   TO  WS-ERROR
 14896                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14897
 14898 3344-CVL-TOLERANCE-CHECK.
 14899
 14900      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14901          GO TO 3344-CHECK-AH.
 14902
 14903      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14904          GO TO 3344-CHECK-AH.
 14905
 14906      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14907                                     WS-UNSIGN-WRK6.
 14908
 14909      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14910          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14911                                 + PB-I-LF-PREMIUM-AMT
 14912                                 - PB-I-LF-PREM-CALC.
 14913
 14914      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14915          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14916                                 + PB-I-LF-ALT-PREMIUM-AMT
 14917                                 - PB-I-LF-ALT-PREM-CALC.
 14918
 14919      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14920          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14921              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14922                 MOVE ER-2652    TO  WS-ERROR
 14923                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14924              ELSE
 14925                 MOVE ER-2650    TO  WS-ERROR
 14926                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14927
 14928      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14929          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14930              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14931                 MOVE ER-2652    TO  WS-ERROR
 14932                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14933              ELSE
 14934                 MOVE ER-2650    TO  WS-ERROR
 14935                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 270
* EL050.cbl
 14936
 14937 3344-CHECK-AH.
 14938
 14939****************************************************************
 14940***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14941***
 14942
 14943     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14944         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14945             (1 + WS-TOL-AH-PREM-PCT)
 14946         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14947             (1 - WS-TOL-AH-PREM-PCT)
 14948     ELSE
 14949         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 14950         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 14951
 14952***
 14953***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14954***
 14955
 14956     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 14957         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14958
 14959     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14960         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14961
 14962     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14963        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14964
 14965     IF (PB-REISSUED-CERT)
 14966        OR (PB-POLICY-IS-DECLINED)
 14967        OR (PB-POLICY-IS-VOIDED)
 14968        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14969        CONTINUE
 14970     ELSE
 14971        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14972              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14973                          or
 14974           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 14975              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14976           IF WS-PREM-REJECT-SW = SPACE
 14977              MOVE ER-3052       TO WS-ERROR
 14978              PERFORM 9900-ERROR-FORMAT
 14979                                 THRU 9900-EXIT
 14980           ELSE
 14981              MOVE ER-3050       TO WS-ERROR
 14982              PERFORM 9900-ERROR-FORMAT
 14983                                 THRU 9900-EXIT
 14984           END-IF
 14985        END-IF
 14986     END-IF
 14987     if (pb-company-id = 'DCC' or 'VPP')
 14988        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 14989        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 14990        and (pb-i-policy-is-monthly)
 14991        compute ws-tol-ah-high-prem-amt =
 14992           pb-i-tot-fees-calc + ws-tol-ah-prem
 14993        compute ws-tol-ah-low-prem-amt =
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 271
* EL050.cbl
 14994           pb-i-tot-fees-calc - ws-tol-ah-prem
 14995        if ws-tol-ah-prem-pct > zeros
 14996           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 14997              (1 + ws-tol-ah-prem-pct)
 14998           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 14999              (1 - ws-tol-ah-prem-pct)
 15000        else
 15001           move +9999999.99      to ws-tol-ah-high-prem-pct
 15002           move +0               to ws-tol-ah-low-prem-pct
 15003        end-if
 15004        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 15005            or
 15006           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 15007                          or
 15008           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 15009           or
 15010           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 15011            move er-3049         to ws-error
 15012           perform 9900-error-format
 15013                                 thru 9900-exit
 15014
 15015        end-if
 15016     end-if
 15017     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 15018         IF  PB-RECORD-BILL   =  'B' OR 'A'
 15019             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15020             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 15021
 15022     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15023        IF WS-COMP-MAX-CAP GREATER THAN +0
 15024           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 15025              IF (PB-REISSUED-CERT         OR
 15026                  PB-POLICY-IS-DECLINED    OR
 15027                  PB-POLICY-IS-VOIDED)
 15028                 NEXT SENTENCE
 15029              ELSE
 15030                  MOVE ER-2646   TO  WS-ERROR
 15031                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15032
 15033     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 15034        (WS-COMP-MAX-CAP EQUAL +0)
 15035           GO TO 3345-EDIT-CONTINUE.
 15036
 15037     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 15038        GREATER THAN WS-COMP-MAX-CAP
 15039           MOVE ER-2646          TO  WS-ERROR
 15040           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15041
 15042 3345-EDIT-CONTINUE.
 15043
 15044*    IF PB-COMPANY-ID    EQUAL    'NCL'
 15045*       IF PB-ENTRY-BATCH   NUMERIC
 15046*          IF PB-ISSUE
 15047*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 15048*          ELSE
 15049*              IF PB-CANCELLATION
 15050*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 15051
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 272
* EL050.cbl
 15052*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15053*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 15054*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 15055*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 15056*        ELSE
 15057*            MOVE  ER-1909            TO  WS-ERROR
 15058*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15059
 15060     IF PB-I-POLICY-ACCEPTED
 15061        IF PB-POLICY-IS-DECLINED  OR
 15062           PB-REISSUED-CERT  OR
 15063           PB-REIN-ONLY-CERT  OR
 15064           PB-POLICY-IS-VOIDED
 15065            MOVE  ER-1891         TO  WS-ERROR
 15066            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15067        ELSE
 15068            MOVE SPACE            TO  PB-BATCH-ENTRY
 15069            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 15070
 15071     IF PB-I-POLICY-DECLINED
 15072        IF PB-REISSUED-CERT  OR
 15073           PB-REIN-ONLY-CERT  OR
 15074           PB-POLICY-IS-VOIDED
 15075            MOVE  ER-1906         TO  WS-ERROR
 15076            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15077        ELSE
 15078            MOVE  'D'             TO  PB-BATCH-ENTRY
 15079                                      PB-I-ENTRY-STATUS.
 15080
 15081     IF PB-I-NEEDS-UNDERWRITING
 15082        IF PB-POLICY-IS-DECLINED OR
 15083           PB-REISSUED-CERT  OR
 15084           PB-REIN-ONLY-CERT  OR
 15085           PB-POLICY-IS-VOIDED
 15086            MOVE  ER-1907         TO  WS-ERROR
 15087            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15088        ELSE
 15089            MOVE 'U'              TO  PB-BATCH-ENTRY
 15090                                      PB-I-ENTRY-STATUS.
 15091
 15092     IF PB-NEEDS-UNDERWRITING
 15093        MOVE  ER-1901             TO  WS-ERROR
 15094        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15095     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15096        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 15097        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 15098        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15099           AND (NOT WS-LF-CASH))
 15100                           OR
 15101           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15102           AND (NOT WS-AH-CASH)))
 15103                       AND
 15104           (PB-I-ENTRY-STATUS NOT = '5')
 15105           MOVE 'M'              TO PB-BATCH-ENTRY
 15106                                    PB-I-ENTRY-STATUS
 15107        END-IF
 15108     END-IF
 15109     move pending-business       to ws-passed-erpndb
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 273
* EL050.cbl
 15110     move ' '                    to ws-exceed-limit-yn
 15111     perform 7780-call-agg       thru 7780-exit
 15112     display ' el050 exceed ' ws-exceed-limit-yn
 15113     if ws-exceed-limit-yn = 'Y'
 15114        MOVE  ER-9813            TO WS-ERROR
 15115        PERFORM  9900-ERROR-FORMAT
 15116                                 THRU 9900-EXIT
 15117     end-if
 15118     IF  PB-COMPANY-ID NOT = 'NCL'
 15119         GO TO 3999-END-EDIT.
 15120
 15121     IF PB-REISSUED-CERT  OR
 15122        PB-POLICY-IS-DECLINED  OR
 15123        PB-POLICY-IS-VOIDED  OR
 15124        PB-I-OB
 15125         GO TO 3999-END-EDIT.
 15126
 15127     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 15128         MOVE  ER-2644            TO  WS-ERROR
 15129         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15130         GO TO 3999-END-EDIT.
 15131
 15132     MOVE 'N'                     TO  FORM-MASTER-SW.
 15133     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 15134
 15135     IF NOT FORM-MASTER-FOUND
 15136         GO TO 3999-END-EDIT.
 15137
 15138     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 15139                                      FORM-MASTER-AH-SW.
 15140
 15141     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15142         MOVE  +1                 TO SUB6
 15143         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 15144
 15145     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15146         MOVE  +1                 TO SUB6
 15147         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 15148
 15149     IF LF-FORM-MASTER-FOUND  OR
 15150        AH-FORM-MASTER-FOUND
 15151         GO TO 3360-CHECK-FORM-LIMITS
 15152     ELSE
 15153         GO TO 3999-END-EDIT.
 15154
 15155******************************************************************
 15156*                  3350-GET-ERFORM                               *
 15157*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 15158*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 15159******************************************************************
 15160
 15161 3350-GET-ERFORM.
 15162
 15163     IF  WK-FORM-ADDR      EQUAL    ZEROS
 15164         GO TO  3350-ERFORM-GETMAIN.
 15165
 15166     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 15167     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 274
* EL050.cbl
 15168     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 15169     MOVE 'Y'                     TO FORM-MASTER-SW.
 15170
 15171     IF PB-CANCELLATION
 15172         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15173            PB-SV-STATE          EQUAL   FO-STATE       AND
 15174            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15175              GO TO 3350-EXIT
 15176         ELSE
 15177             NEXT SENTENCE
 15178     ELSE
 15179         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15180            PB-SV-STATE          EQUAL   FO-STATE       AND
 15181            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15182              GO TO 3350-EXIT.
 15183
 15184 3350-ERFORM-GETMAIN.
 15185
 15186     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 15187     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 15188
 15189 3350-ERFORM-READ.
 15190
 15191     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 15192     MOVE  PB-SV-STATE            TO  FORM-STATE.
 15193     IF PB-CANCELLATION
 15194         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 15195     ELSE
 15196         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 15197     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 15198
 15199     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 15200
 15201     IF FORM-MASTER-FOUND
 15202       IF PB-CANCELLATION
 15203          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15204             PB-SV-STATE          EQUAL   FO-STATE       AND
 15205             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15206              GO  TO 3350-EXIT
 15207          ELSE
 15208              NEXT SENTENCE
 15209       ELSE
 15210          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15211             PB-SV-STATE          EQUAL   FO-STATE       AND
 15212             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15213              GO  TO 3350-EXIT.
 15214
 15215     MOVE  'N'                    TO  FORM-MASTER-SW.
 15216     MOVE  ER-1895                TO  WS-ERROR.
 15217     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15218
 15219 3350-EXIT.
 15220      EXIT.
 15221
 15222******************************************************************
 15223*                  3355-EDIT-FORM-LF-BENEFITS                    *
 15224*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 15225*   VALID FOR THE POLICY FORM USED.                              *
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 275
* EL050.cbl
 15226******************************************************************
 15227
 15228 3355-EDIT-FORM-LF-BENEFITS.
 15229
 15230     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15231        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15232         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 15233         GO TO   3355-EXIT.
 15234
 15235     IF  SUB6    LESS THAN   +40
 15236         ADD  +1      TO  SUB6
 15237         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 15238
 15239     MOVE  ER-1896         TO  WS-ERROR.
 15240     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15241
 15242 3355-EXIT.
 15243      EXIT.
 15244
 15245******************************************************************
 15246*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15247*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15248*   VALID FOR THE POLICY FORM USED.                              *
 15249******************************************************************
 15250
 15251 3356-EDIT-FORM-AH-BENEFITS.
 15252
 15253     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15254        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15255         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 15256         GO TO  3356-EXIT.
 15257
 15258      IF  SUB6    LESS THAN     +40
 15259          ADD  +1      TO  SUB6
 15260          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15261
 15262     MOVE  ER-1897         TO  WS-ERROR.
 15263     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15264
 15265 3356-EXIT.
 15266      EXIT.
 15267
 15268******************************************************************
 15269*                  3357-BENEFIT-SEARCH                           *
 15270*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15271*   CANCELLATIONS ONLY.                                          *
 15272******************************************************************
 15273 3357-BENEFIT-SEARCH.
 15274     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15275         MOVE +1                          TO SUB6
 15276         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15277
 15278     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15279         MOVE +1                          TO SUB6
 15280         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15281
 15282 3357-EXIT.
 15283     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 276
* EL050.cbl
 15284
 15285******************************************************************
 15286*                  3358-BENEFIT-LIFE-SEARCH                      *
 15287*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15288*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15289*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15290******************************************************************
 15291 3358-BENEFIT-LIFE-SEARCH.
 15292     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15293       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15294         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15295           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15296              IF FO-PLAN-REFUND-METHOD (SUB6)
 15297                     IS GREATER THAN SPACES
 15298                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15299                                          WS-LF-REFUND-CALC
 15300                 GO TO 3358-EXIT.
 15301
 15302     IF SUB6 LESS THAN +40
 15303         ADD +1                 TO SUB6
 15304         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15305
 15306 3358-EXIT.
 15307     EXIT.
 15308******************************************************************
 15309*                  3359-BENEFIT-AH-SEARCH                        *
 15310*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15311*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15312*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15313******************************************************************
 15314 3359-BENEFIT-AH-SEARCH.
 15315     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15316       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15317         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15318           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15319              IF FO-PLAN-REFUND-METHOD (SUB6)
 15320                      IS GREATER THAN SPACES
 15321                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15322                                          WS-AH-REFUND-CALC
 15323                 GO TO 3359-EXIT.
 15324
 15325     IF SUB6 LESS THAN +40
 15326         ADD +1                 TO SUB6
 15327         GO TO 3359-BENEFIT-AH-SEARCH.
 15328
 15329 3359-EXIT.
 15330     EXIT.
 15331
 15332******************************************************************
 15333*                  3360-CHECK-FORM-LIMITS                        *
 15334*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15335*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15336******************************************************************
 15337
 15338 3360-CHECK-FORM-LIMITS.
 15339
 15340     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15341         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 277
* EL050.cbl
 15342
 15343     IF NOT LF-FORM-MASTER-FOUND
 15344         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15345
 15346 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15347
 15348     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15349       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15350        WS-LF-JOINT-INDICATOR = 'J'  AND
 15351        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15352         IF PB-COMPANY-ID = 'NCL'
 15353            MOVE  ER-1911          TO  WS-ERROR
 15354            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15355         ELSE
 15356            MOVE  ER-1892          TO  WS-ERROR
 15357            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15358
 15359 3360-CHECK-FORM-LF-ATT-AGE.
 15360
 15361     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15362
 15363     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15364         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15365         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15366            IF PB-COMPANY-ID = 'NCL'
 15367                MOVE  ER-1913      TO  WS-ERROR
 15368                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15369            ELSE
 15370                MOVE  ER-1894      TO  WS-ERROR
 15371                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15372
 15373 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15374
 15375     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15376         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15377         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15378            IF PB-COMPANY-ID = 'NCL'
 15379                MOVE  ER-1914      TO  WS-ERROR
 15380                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15381            ELSE
 15382                MOVE  ER-1899      TO  WS-ERROR
 15383                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15384
 15385 3360-CHECK-FORM-LF-TERM-BAMT.
 15386
 15387     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15388         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15389         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15390           IF  PB-COMPANY-ID = 'NCL'
 15391               MOVE  ER-1916       TO  WS-ERROR
 15392               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15393           ELSE
 15394               MOVE  ER-1902       TO  WS-ERROR
 15395               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15396
 15397     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15398                                    PB-I-LF-ALT-BENEFIT-AMT.
 15399
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 278
* EL050.cbl
 15400     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15401         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15402         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15403             IF  PB-COMPANY-ID = 'NCL'
 15404                 MOVE  ER-1918     TO  WS-ERROR
 15405                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15406             ELSE
 15407                 MOVE  ER-1904     TO  WS-ERROR
 15408                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15409
 15410******************************************************************
 15411*                  3360-CHECK-FORM-AH-LIMITS                     *
 15412*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15413*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15414******************************************************************
 15415
 15416 3360-CHECK-FORM-AH-LIMITS.
 15417
 15418     IF NOT AH-FORM-MASTER-FOUND
 15419         GO TO 3999-END-EDIT.
 15420
 15421 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15422
 15423     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15424       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15425        WS-AH-JOINT-INDICATOR = 'J'  AND
 15426        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15427         IF PB-COMPANY-ID = 'NCL'
 15428            MOVE  ER-1912          TO  WS-ERROR
 15429            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15430         ELSE
 15431            MOVE  ER-1893          TO  WS-ERROR
 15432            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15433
 15434 3360-CHECK-FORM-AH-ATT-AGE.
 15435
 15436     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15437
 15438     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15439         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15440         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15441            IF PB-COMPANY-ID = 'NCL'
 15442                MOVE  ER-1913      TO  WS-ERROR
 15443                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15444            ELSE
 15445                MOVE  ER-1894      TO  WS-ERROR
 15446                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15447
 15448 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15449
 15450     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15451         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15452         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15453            IF PB-COMPANY-ID = 'NCL'
 15454                MOVE  ER-1915      TO  WS-ERROR
 15455                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15456            ELSE
 15457                MOVE  ER-1900      TO  WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 279
* EL050.cbl
 15458                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15459
 15460 3360-CHECK-FORM-AH-TERM-BAMT.
 15461
 15462     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15463         FO-AH-MAX-TERM    GREATER THAN  +0
 15464         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15465             IF  PB-COMPANY-ID = 'NCL'
 15466                 MOVE  ER-1917     TO  WS-ERROR
 15467                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15468             ELSE
 15469                  MOVE  ER-1903    TO  WS-ERROR
 15470                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15471
 15472     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15473         FO-MAX-AH-AMT    GREATER THAN  +0
 15474         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15475             IF  PB-COMPANY-ID = 'NCL'
 15476                 MOVE  ER-1919     TO  WS-ERROR
 15477                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15478             ELSE
 15479                 MOVE  ER-1905     TO  WS-ERROR
 15480                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15481
 15482     GO TO 3999-END-EDIT.
 15483
 15484******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 280
* EL050.cbl
 15486 3400-edit-vin.
 15487
 15488     MOVE PB-I-VIN               TO WS-WORK-VIN
 15489     MOVE +8                     TO V2
 15490     MOVE ZEROS                  TO WS-VIN-TOTAL
 15491     PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15492      (V1 > 17)
 15493        IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 15494           MOVE ER-3825          TO WS-ERROR
 15495           PERFORM 9900-ERROR-FORMAT
 15496                                 THRU 9900-EXIT
 15497        ELSE
 15498           IF V1 = 8
 15499              MOVE 10            TO V2
 15500           END-IF
 15501           IF V1 = 9
 15502              MOVE 0             TO V2
 15503           END-IF
 15504           IF V1 = 10
 15505              MOVE 9             TO V2
 15506           END-IF
 15507           IF WS-WORK-VIN (V1:1) NUMERIC
 15508              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15509               + (WS-WORK-VIN-N (V1) * V2)
 15510           ELSE
 15511              MOVE WS-WORK-VIN (V1:1)
 15512                            TO WS-HEX-BYTE
 15513              COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 15514              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15515               + (WS-NUM (V3) * V2)
 15516           END-IF
 15517           COMPUTE V2 = V2 - 1
 15518        END-IF
 15519     END-PERFORM
 15520     MOVE ZEROS                  TO WS-VIN-REMAINDER
 15521     DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 15522        REMAINDER WS-VIN-REMAINDER
 15523     IF ((WS-WORK-VIN (9:1) = 'X')
 15524        AND (WS-VIN-REMAINDER = 10))
 15525                OR
 15526        (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 15527        CONTINUE
 15528     ELSE
 15529        IF WS-WORK-VIN (1:1) > 0 AND < 6
 15530           MOVE ER-3826          TO WS-ERROR
 15531           PERFORM 9900-ERROR-FORMAT
 15532                                 THRU 9900-EXIT
 15533        ELSE
 15534           MOVE ER-3827          TO WS-ERROR
 15535           PERFORM 9900-ERROR-FORMAT
 15536                                 THRU 9900-EXIT
 15537        END-IF
 15538     END-IF
 15539
 15540     .
 15541 3400-exit.
 15542     exit.
 15543******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 281
* EL050.cbl
 15544*                  E D I T   C A N C E L                         *
 15545******************************************************************
 15546
 15547 3700-EDIT-CANCEL.
 15548     IF PB-COMPANY-ID = 'DMD'
 15549         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15550                                         WS-RES-MUNI-TAX
 15551                                         PB-CI-STATE-TAX
 15552                                         PB-CI-MUNI-TAX
 15553         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15554
 15555*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15556*       IF PB-ENTRY-BATCH  NUMERIC
 15557*          IF PB-CANCELLATION
 15558*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15559*          ELSE
 15560*             IF PB-ISSUE
 15561*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15562
 15563     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15564        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15565     END-IF
 15566*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15567*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15568
 15569     IF CM-ENTRY-STATUS = 'V'
 15570        MOVE ER-2780             TO WS-ERROR
 15571        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15572        GO TO 3999-END-EDIT.
 15573
 15574     IF CM-ENTRY-STATUS = 'D'
 15575        MOVE ER-2781             TO WS-ERROR
 15576        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15577        GO TO 3999-END-EDIT.
 15578
 15579     IF CM-ENTRY-STATUS = 'U'
 15580        MOVE ER-2782             TO WS-ERROR
 15581        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15582
 15583***************************************************************
 15584*                                                             *
 15585*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15586*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15587*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15588*   OF ANOTHER COVERAGE.                                      *
 15589*                                                             *
 15590***************************************************************
 15591
 15592     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15593                                    PB-C-AH-CANCEL-VOID-SW.
 15594
 15595     IF PB-C-LF-CANCEL-AMT = ZERO
 15596        NEXT SENTENCE
 15597     ELSE
 15598        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15599           AND
 15600           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 15601               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 282
* EL050.cbl
 15602               MOVE ER-2745           TO WS-ERROR
 15603               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15604
 15605     IF PB-C-AH-CANCEL-AMT = ZERO
 15606        NEXT SENTENCE
 15607     ELSE
 15608        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15609           AND
 15610           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15611               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15612               MOVE ER-2745           TO WS-ERROR
 15613               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15614
 15615     IF WS-LF-EARNINGS-CALC = '4'
 15616        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15617
 15618     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15619     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15620     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15621     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15622     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15623     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15624
 15625     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15626                                      PB-C-AH-REF-CALC.
 15627     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15628
 15629******************************************************************
 15630*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15631*             TO VALIDATE COVERAGE.                              *
 15632******************************************************************
 15633
 15634     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15635        PB-C-LF-CANCEL-AMT = ZEROS
 15636          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15637      ELSE
 15638          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15639
 15640     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15641        PB-C-AH-CANCEL-AMT = ZEROS
 15642          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15643      ELSE
 15644          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15645
 15646     EVALUATE TRUE
 15647         WHEN PB-CANCEL-FORCE             OR
 15648              PB-CANCEL-DATE-FORCED       OR
 15649              PB-FORCE-OFF
 15650                  IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 15651                     MOVE CM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15652                  END-IF
 15653         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15654               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15655              (PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP')
 15656                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15657         WHEN OTHER
 15658              IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 15659                 MOVE ER-2794              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 283
* EL050.cbl
 15660              ELSE
 15661                 MOVE ER-2749              TO WS-ERROR
 15662              END-IF
 15663              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15664     END-EVALUATE.
 15665
 15666
 15667*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15668*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15669*            MOVE  ER-1909            TO  WS-ERROR
 15670*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15671*        ELSE
 15672*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15673
 15674     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15675     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15676        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15677     ELSE
 15678        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15679     END-IF
 15680     .
 15681 3705-EDIT-CANCEL-DT.
 15682
 15683     IF LF-COVERAGE-CANCELLED
 15684        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15685         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15686         MOVE WS-CURRENT-MONTH-END
 15687                                 TO DC-BIN-DATE-2
 15688         SET ELAPSED-BETWEEN-BIN TO TRUE
 15689*        MOVE 1                  TO DC-OPTION-CODE
 15690         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15691         IF DATE-CONVERSION-ERROR
 15692            NEXT SENTENCE
 15693          ELSE
 15694             IF DC-ELAPSED-DAYS GREATER +180
 15695                IF PB-CANCEL-DATE-FORCED  OR
 15696                   PB-CANCEL-DATE-FORCED-NO-FEE
 15697                      MOVE ER-2751  TO WS-ERROR
 15698                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15699                 ELSE
 15700                   MOVE ER-2752  TO WS-ERROR
 15701                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15702
 15703     IF AH-COVERAGE-CANCELLED
 15704        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15705         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15706         MOVE WS-CURRENT-MONTH-END
 15707                                 TO DC-BIN-DATE-2
 15708         SET ELAPSED-BETWEEN-BIN TO TRUE
 15709*        MOVE 1                  TO DC-OPTION-CODE
 15710         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15711         IF DATE-CONVERSION-ERROR
 15712            NEXT SENTENCE
 15713          ELSE
 15714             IF DC-ELAPSED-DAYS GREATER +180
 15715                IF PB-CANCEL-DATE-FORCED OR
 15716                   PB-CANCEL-DATE-FORCED-NO-FEE
 15717                      MOVE ER-2751  TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 284
* EL050.cbl
 15718                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15719                 ELSE
 15720                   MOVE ER-2752  TO WS-ERROR
 15721                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15722
 15723     IF WS-ERROR = ER-2752
 15724        AND (PB-COMPANY-ID = 'ABL'
 15725         OR  PB-COMPANY-ID = 'FGL'
 15726         OR  PB-COMPANY-ID = 'IST'
 15727         OR  PB-COMPANY-ID = 'JHL'
 15728         OR  PB-COMPANY-ID = 'LAP'
 15729         OR  PB-COMPANY-ID = 'LBL'
 15730         OR  PB-COMPANY-ID = 'NCB'
 15731         OR  PB-COMPANY-ID = 'NLI'
 15732         OR  PB-COMPANY-ID = 'OFI'
 15733         OR  PB-COMPANY-ID = 'PLI'
 15734         OR  PB-COMPANY-ID = 'TAO'
 15735         OR  PB-COMPANY-ID = 'TIC'
 15736         OR  PB-COMPANY-ID = 'HER'
 15737         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15738         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15739            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15740            MOVE ER-2762     TO WS-ERROR
 15741            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15742
 15743     IF LF-COVERAGE-CANCELLED
 15744        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15745        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15746             MOVE ER-2733         TO WS-ERROR
 15747             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15748
 15749     IF AH-COVERAGE-CANCELLED
 15750        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15751        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15752              MOVE ER-2733        TO WS-ERROR
 15753              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15754
 15755     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15756        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15757        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15758           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15759            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15760              IF PB-COMPANY-ID NOT = 'LAP'
 15761               MOVE ER-2704            TO WS-ERROR
 15762               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15763
 15764     IF CERT-WAS-NOT-FOUND
 15765         GO TO 3999-END-EDIT.
 15766
 15767     IF PB-COMPANY-ID EQUAL 'CDC'
 15768        IF LF-COVERAGE-CANCELLED
 15769           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15770            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15771            MOVE PB-C-LF-CANCEL-DT
 15772                                 TO DC-BIN-DATE-2
 15773            SET ELAPSED-BETWEEN-BIN TO TRUE
 15774*           MOVE 1               TO DC-OPTION-CODE
 15775            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 285
* EL050.cbl
 15776            IF DATE-CONVERSION-ERROR
 15777               NEXT SENTENCE
 15778             ELSE
 15779                IF DC-ELAPSED-DAYS GREATER +60
 15780                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15781
 15782     IF PB-COMPANY-ID EQUAL 'CDC'
 15783        IF AH-COVERAGE-CANCELLED
 15784           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15785            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15786            MOVE PB-C-AH-CANCEL-DT
 15787                                 TO DC-BIN-DATE-2
 15788            MOVE +0              TO DC-ELAPSED-DAYS
 15789                                    DC-ELAPSED-MONTHS
 15790            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15791*           MOVE 1               TO DC-OPTION-CODE
 15792            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15793            IF DATE-CONVERSION-ERROR
 15794               NEXT SENTENCE
 15795             ELSE
 15796                IF DC-ELAPSED-DAYS GREATER +60
 15797                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15798
 15799     MOVE +0                     TO DC-ELAPSED-DAYS
 15800                                    DC-ELAPSED-MONTHS.
 15801
 15802     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15803        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15804          MOVE 'Z'                TO PB-CI-OB-FLAG
 15805          MOVE ER-2767            TO WS-ERROR
 15806          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15807          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15808          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15809          GO TO 3775-OVER-REF-CHK
 15810        ELSE
 15811          MOVE ZEROS              TO PB-CI-LIVES
 15812                                     PB-C-LIVES
 15813          IF PB-CI-OB-FLAG NOT = 'B'
 15814             MOVE SPACE           TO PB-CI-OB-FLAG.
 15815
 15816     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15817         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15818     ELSE
 15819         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15820
 15821     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15822        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15823            MOVE ER-2760         TO WS-ERROR
 15824            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15825
 15826     IF LF-COVERAGE-CANCELLED
 15827        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15828         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15829            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15830               MOVE ER-2774       TO WS-ERROR
 15831               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15832
 15833     IF AH-COVERAGE-CANCELLED
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 286
* EL050.cbl
 15834        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15835         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15836            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15837               MOVE ER-2775       TO WS-ERROR
 15838               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15839
 15840     IF LF-COVERAGE-CANCELLED
 15841        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15842         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15843            MOVE ER-2776         TO WS-ERROR
 15844            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15845
 15846     IF AH-COVERAGE-CANCELLED
 15847        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15848         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15849            MOVE ER-2777         TO WS-ERROR
 15850            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15851
 15852     IF LF-COVERAGE-CANCELLED
 15853        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15854        if pb-ci-lf-expire-dt = low-values or spaces
 15855           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15856           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 15857           MOVE PB-CI-EXTENTION-DAYS
 15858                                 TO DC-ELAPSED-DAYS
 15859           SET BIN-PLUS-ELAPSED  TO TRUE
 15860           PERFORM 8500-DATE-CONVERT
 15861                                 THRU 8500-EXIT
 15862           IF DATE-CONVERSION-ERROR
 15863              move low-values    to dc-bin-date-2
 15864           end-if
 15865        else
 15866           move pb-ci-lf-expire-dt
 15867                                 to dc-bin-date-2
 15868        end-if
 15869        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15870           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15871                             OR  'FIA'
 15872              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 15873           ELSE
 15874              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15875              MOVE ER-2731       TO WS-ERROR
 15876              PERFORM 9900-ERROR-FORMAT
 15877                                 THRU 9900-EXIT
 15878           end-if
 15879        end-if
 15880     end-if
 15881*    IF LF-COVERAGE-CANCELLED
 15882*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15883*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15884*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15885*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15886*        SET BIN-PLUS-ELAPSED      TO TRUE
 15887*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15888*        IF DATE-CONVERSION-ERROR
 15889*           NEXT SENTENCE
 15890*         ELSE
 15891*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 287
* EL050.cbl
 15892*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15893*                            OR  'FIA'
 15894*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15895*              ELSE
 15896*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15897*               MOVE ER-2731       TO WS-ERROR
 15898*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15899     .
 15900 3705-EDIT-AH-CANCEL-DT.
 15901     IF AH-COVERAGE-CANCELLED
 15902        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15903        if pb-ci-AH-expire-dt = low-values or spaces
 15904           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15905           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 15906           MOVE PB-CI-EXTENTION-DAYS
 15907                                 TO DC-ELAPSED-DAYS
 15908           SET BIN-PLUS-ELAPSED  TO TRUE
 15909           PERFORM 8500-DATE-CONVERT
 15910                                 THRU 8500-EXIT
 15911           IF DATE-CONVERSION-ERROR
 15912              move low-values    to dc-bin-date-2
 15913           end-if
 15914        else
 15915           move pb-ci-ah-expire-dt
 15916                                 to dc-bin-date-2
 15917        end-if
 15918        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15919           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15920                             OR  'FIA'
 15921              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 15922           ELSE
 15923              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15924              MOVE ER-2771       TO WS-ERROR
 15925              PERFORM 9900-ERROR-FORMAT
 15926                                 THRU 9900-EXIT
 15927           end-if
 15928        end-if
 15929     end-if
 15930*    IF AH-COVERAGE-CANCELLED
 15931*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15932*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15933*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15934*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15935**       MOVE 6                    TO DC-OPTION-CODE
 15936*        SET BIN-PLUS-ELAPSED      TO TRUE
 15937*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15938*        IF DATE-CONVERSION-ERROR
 15939*           NEXT SENTENCE
 15940*         ELSE
 15941*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15942*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15943*                             OR 'FIA'
 15944*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15945*             ELSE
 15946*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15947*              MOVE ER-2771       TO WS-ERROR
 15948*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15949     .
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 288
* EL050.cbl
 15950 3705-EDIT-CONTINUED.
 15951
 15952*    IF LF-COVERAGE-CANCELLED
 15953*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15954*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15955*            MOVE ER-2727         TO WS-ERROR
 15956*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15957*
 15958*    IF AH-COVERAGE-CANCELLED
 15959*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15960*        IF PB-COMPANY-ID = 'ACE'
 15961*           MOVE ER-2727        TO WS-ERROR
 15962*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15963*        ELSE
 15964*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15965*              MOVE ER-2727     TO WS-ERROR
 15966*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15967
 15968     IF PB-COMPANY-ID = 'ACE'
 15969       IF AH-COVERAGE-CANCELLED
 15970         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15971           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15972              MOVE ER-2732      TO WS-ERROR
 15973              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15974
 15975     IF PB-COMPANY-ID      EQUAL   'HER'
 15976        IF WS-ERROR        EQUAL   ER-2727
 15977            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15978            MOVE  ER-2725          TO  WS-ERROR
 15979            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15980
 15981     IF PB-C-CLAIM-CREATED-CANCEL
 15982            MOVE ER-2748         TO WS-ERROR
 15983            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15984
 15985     IF PB-C-LAST-NAME NOT = SPACES
 15986         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15987            MOVE ER-2747         TO WS-ERROR
 15988            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15989
 15990 3710-EDIT-LUMP-SUM-PRIOR.
 15991
 15992     IF AH-COVERAGE-CANCELLED
 15993         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15994             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15995                MOVE ER-2735    TO WS-ERROR
 15996                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15997
 15998     IF LF-COVERAGE-CANCELLED
 15999         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16000             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 16001                MOVE ER-2735    TO WS-ERROR
 16002                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16003
 16004 3710-EDIT-PRIOR-DEATH.
 16005
 16006*    IF LF-COVERAGE-CANCELLED
 16007*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 289
* EL050.cbl
 16008*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16009*           (NOT PB-CI-OB)
 16010*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 16011*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 16012*                   MOVE ER-2732  TO WS-ERROR
 16013*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16014*
 16015*    IF AH-COVERAGE-CANCELLED
 16016*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16017*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16018*           (NOT PB-CI-OB)
 16019*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 16020*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 16021*                   MOVE ER-2732  TO WS-ERROR
 16022*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16023
 16024     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 16025         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 16026            (NOT PB-COMP-LF-CANCEL)
 16027             NEXT SENTENCE
 16028         ELSE
 16029           IF PB-C-LF-CANCEL-VOIDED
 16030              NEXT SENTENCE
 16031           ELSE
 16032              MOVE ER-2753      TO WS-ERROR
 16033              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16034
 16035     IF CANCEL-FUTURE-DT
 16036         GO TO 3999-END-EDIT.
 16037
 16038 3715-GET-REMAIN-TERM-LF.
 16039
 16040     IF NO-LF-BENEFIT-MATCH  OR
 16041        WS-LF-BENEFIT-CD = ZEROS
 16042        GO TO 3730-GET-AH-REMAIN-TERM.
 16043
 16044     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 16045     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16046     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16047     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 16048     MOVE PB-SV-STATE            TO CP-STATE.
 16049     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16050     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 16051     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16052     MOVE '2'                    TO CP-PROCESS-TYPE.
 16053     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16054     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16055     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16056     IF (PB-COMPANY-ID = 'CID')
 16057        AND (CP-STATE-STD-ABBRV = 'WI')
 16058        MOVE '7'                 TO CP-REM-TERM-METHOD
 16059        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16060     ELSE
 16061        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16062        MOVE WS-REM-TRM-CALC-OPTION
 16063                                 TO CP-REM-TRM-CALC-OPTION
 16064     END-IF
 16065**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 290
* EL050.cbl
 16066     IF (PB-COMPANY-ID = 'CID')
 16067        AND (CP-STATE-STD-ABBRV = 'MO')
 16068        AND (PB-CERT-EFF-DT >= X'9B41')
 16069        AND (PB-CERT-EFF-DT <= X'A2FB')
 16070        MOVE '7'                 TO CP-REM-TERM-METHOD
 16071        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16072     END-IF
 16073     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 16074                                    CP-LOAN-TERM.
 16075     IF CP-TRUNCATED-LIFE
 16076        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 16077
 16078     IF CP-TERM-IS-DAYS
 16079         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 16080     ELSE
 16081         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16082
 16083     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 16084
 16085     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16086
 16087     IF LF-COVERAGE-CANCELLED
 16088        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 16089        NEXT SENTENCE
 16090      ELSE
 16091          GO TO 3730-GET-AH-REMAIN-TERM.
 16092
 16093 3720-GET-LF-REFUND.
 16094
 16095     IF PB-C-LF-CANCEL-VOIDED
 16096        GO TO 3730-GET-AH-REMAIN-TERM
 16097     end-if
 16098
 16099     IF PB-COMPANY-ID EQUAL 'BOA'
 16100         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16101         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16102         GO TO 3730-GET-AH-REMAIN-TERM.
 16103
 16104     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 16105        (WS-AH-SPECIAL-CALC-CD = 'M')
 16106         MOVE ER-2767            TO WS-ERROR
 16107         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16108         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16109         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16110         GO TO 3780-UPDATE-CANCEL-CERT.
 16111
 16112*    if (ws-lf-earnings-calc = '6')
 16113*       or (pb-c-lf-refund-override = '6')
 16114*       move cp-remaining-term-1 to cp-remaining-term-2
 16115*    end-if
 16116     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 16117
 16118     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 16119     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 16120     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16121     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 16122     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 16123     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 291
* EL050.cbl
 16124     IF PB-COMPANY-ID = 'DCC'
 16125        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16126        IF PDEF-MASTER-FOUND
 16127           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16128              (V1 > +8)
 16129              OR (PD-PROD-CODE (V1) = 'L')
 16130           END-PERFORM
 16131           IF V1 < +9
 16132              MOVE PD-MAX-AMT (V1)
 16133                           TO CP-R-MAX-TOT-BEN
 16134                              EC-AM-LF-MAX-TOT-BEN
 16135           END-IF
 16136        ELSE
 16137        MOVE ' '                 TO PDEF-MASTER-SW
 16138        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16139        MOVE PB-STATE            TO ERPDEF-STATE
 16140        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
 16141           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16142        END-IF
 16143        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16144        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16145        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16146        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16147        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16148        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16149        IF PDEF-MASTER-FOUND
 16150           MOVE 'N'              TO PDEF-MASTER-SW
 16151           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16152           IF PDEF-MASTER-FOUND
 16153              IF (ERPDEF-KEY-SAVE (1:16) =
 16154                           PD-CONTROL-PRIMARY (1:16))
 16155                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16156                 CONTINUE
 16157              ELSE
 16158                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16159                 IF (ERPDEF-KEY-SAVE (1:16) =
 16160                           PD-CONTROL-PRIMARY (1:16))
 16161                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16162                    CONTINUE
 16163                 ELSE
 16164                    MOVE 'N'     TO PDEF-MASTER-SW
 16165                 END-IF
 16166              END-IF
 16167
 16168              IF PDEF-MASTER-FOUND
 16169                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16170                    (V1 > +8)
 16171                    OR (PD-PROD-CODE (V1) = 'L')
 16172                 END-PERFORM
 16173                 IF V1 < +9
 16174                    MOVE PD-MAX-AMT (V1)
 16175                                 TO CP-R-MAX-TOT-BEN
 16176                                    EC-AM-LF-MAX-TOT-BEN
 16177                 END-IF
 16178              END-IF
 16179           END-IF
 16180           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16181        END-IF
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 292
* EL050.cbl
 16182        END-IF
 16183     END-IF
 16184     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 16185
 16186     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 16187
 16188     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16189                                    PB-C-LF-REM-TERM.
 16190
 16191     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 16192     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 16193
 16194     IF PB-COMPANY-ID EQUAL 'FLC'
 16195        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 16196           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 16197           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 16198                    + PB-CI-LF-ALT-PREMIUM-AMT)
 16199                    - CM-LF-ITD-DEATH-AMT
 16200           IF PB-C-LF-REF-CALC LESS THAN +0
 16201              MOVE +0            TO PB-C-LF-REF-CALC
 16202              GO TO 3730-GET-AH-REMAIN-TERM
 16203           ELSE
 16204              GO TO 3730-GET-AH-REMAIN-TERM.
 16205
 16206     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16207                            OR '4' OR '5' OR '6' OR '8'
 16208                            OR '9' OR 'G'
 16209        MOVE PB-C-LF-REFUND-OVERRIDE
 16210                                 TO CP-EARNING-METHOD.
 16211
 16212     if pb-company-id = 'AHL'
 16213        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 16214        if cp-class-code = spaces
 16215           move zeros            to cp-class-code
 16216        end-if
 16217     ELSE
 16218        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16219     END-IF
 16220*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16221     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 16222     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16223                                    CP-RATING-BENEFIT-AMT.
 16224     IF CP-STATE-STD-ABBRV = 'OR'
 16225         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16226                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16227     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16228     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16229     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16230     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 16231     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 16232     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16233     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16234     IF WS-DEFAULT-APR NOT NUMERIC
 16235         MOVE ZEROS TO WS-DEFAULT-APR.
 16236****   N O T E   ****
 16237*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 16238*      THE OH HARD CODING IN ELCRFNDP
 16239
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 293
* EL050.cbl
 16240     IF PB-COMPANY-ID = 'CID'
 16241        IF CP-STATE-STD-ABBRV = 'OH'
 16242           MOVE WS-LF-EARNINGS-CALC
 16243                                 TO CP-EARNING-METHOD
 16244        END-IF
 16245     END-IF
 16246
 16247****   N O T E   ****
 16248
 16249     IF CP-EARN-AS-NET-PAY
 16250         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16251            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16252                MOVE WS-DEFAULT-APR
 16253                                 TO  CP-LOAN-APR
 16254                MOVE ER-3780     TO  WS-ERROR
 16255                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16256            ELSE
 16257                MOVE ER-3781     TO  WS-ERROR
 16258                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16259*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 16260     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16261
 16262     IF CP-REFUND-TYPE-USED NOT = SPACE
 16263         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 16264
 16265     IF CP-ERROR-RATE-IS-ZERO OR
 16266        CP-ERROR-RATE-NOT-FOUND
 16267        MOVE ER-2740             TO WS-ERROR
 16268        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16269
 16270     IF CP-ERROR-RATE-FILE-NOTOPEN
 16271        MOVE ER-2617             TO WS-ERROR
 16272        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16273
 16274     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 16275        AND PB-CI-ENTRY-STATUS = 'M'
 16276        MOVE +0                  TO PB-C-LF-REF-CALC
 16277     ELSE
 16278        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 16279     END-IF
 16280
 16281     IF WS-LF-EARNINGS-CALC NOT = 'B'
 16282         GO TO 3730-GET-AH-REMAIN-TERM.
 16283
 16284*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 16285*       ADD +1                   TO PB-C-LF-REM-TERM
 16286*                                   CP-REMAINING-TERM
 16287*                                   CP-ORIGINAL-TERM.
 16288
 16289     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 16290     MOVE '2'                    TO CP-EARNING-METHOD
 16291                                    CP-RATING-METHOD.
 16292     IF PB-COMPANY-ID = 'CID'
 16293        IF (CP-STATE-STD-ABBRV = 'MN')
 16294           AND (PB-CERT-EFF-DT > X'A4FF')
 16295           AND (WS-LF-EARNINGS-CALC = 'B')
 16296           MOVE '5'              TO CP-EARNING-METHOD
 16297           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 294
* EL050.cbl
 16298        END-IF
 16299     END-IF
 16300     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16301                                        CP-REMAINING-BENEFIT
 16302                                        CP-RATING-BENEFIT-AMT.
 16303     IF CP-STATE-STD-ABBRV = 'OR'
 16304         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16305                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16306     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16307     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16308
 16309     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16310
 16311     IF CP-ERROR-RATE-IS-ZERO OR
 16312        CP-ERROR-RATE-NOT-FOUND
 16313        MOVE ER-2740             TO WS-ERROR
 16314        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16315
 16316     IF CP-ERROR-RATE-FILE-NOTOPEN
 16317        MOVE ER-2617             TO WS-ERROR
 16318        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16319
 16320     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16321
 16322******************************************************************
 16323
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 295
* EL050.cbl
 16325 3730-GET-AH-REMAIN-TERM.
 16326     IF NO-AH-BENEFIT-MATCH  OR
 16327        WS-AH-BENEFIT-CD = ZEROS
 16328         GO TO 3770-CHECK-REFUNDS.
 16329
 16330     IF PB-CI-AH-LUMP-SUM-DISAB
 16331         IF  PB-C-AH-CANCEL-AMT = ZERO
 16332            IF NOT PB-COMP-AH-CANCEL
 16333             GO TO 3770-CHECK-REFUNDS.
 16334
 16335     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16336     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16337     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16338     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16339     MOVE PB-SV-STATE            TO CP-STATE.
 16340     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16341     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16342     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16343     MOVE '2'                    TO CP-PROCESS-TYPE.
 16344     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16345     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16346     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16347     IF (PB-COMPANY-ID = 'CID')
 16348        AND (CP-STATE-STD-ABBRV = 'WI')
 16349        MOVE '7'                 TO CP-REM-TERM-METHOD
 16350        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16351     ELSE
 16352        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16353        MOVE WS-REM-TRM-CALC-OPTION
 16354                                 TO CP-REM-TRM-CALC-OPTION
 16355     END-IF
 16356     IF (PB-COMPANY-ID = 'CID')
 16357        AND (CP-STATE-STD-ABBRV = 'MO')
 16358        AND (PB-CERT-EFF-DT >= X'9B41')
 16359        AND (PB-CERT-EFF-DT <= X'A2FB')
 16360        MOVE '7'                 TO CP-REM-TERM-METHOD
 16361        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16362     END-IF
 16363     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16364                                    CP-LOAN-TERM.
 16365     IF NOT CP-TERM-IS-DAYS
 16366         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16367
 16368     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16369
 16370     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16371
 16372     IF AH-COVERAGE-CANCELLED
 16373        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16374        NEXT SENTENCE
 16375      ELSE
 16376         GO TO 3770-CHECK-REFUNDS.
 16377
 16378 3740-GET-AH-REFUND.
 16379
 16380     IF PB-C-AH-CANCEL-VOIDED
 16381        GO TO 3780-UPDATE-CANCEL-CERT
 16382     END-IF
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 296
* EL050.cbl
 16383
 16384     IF PB-COMPANY-ID = 'BOA'
 16385         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16386         GO TO 3770-CHECK-REFUNDS.
 16387
 16388     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16389*    MOVE ' '                    TO DC-OPTION-CODE
 16390     SET BIN-TO-GREG             TO TRUE
 16391     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16392     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16393                                    PB-C-AH-REM-TERM.
 16394     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16395     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16396
 16397     IF PB-COMPANY-ID EQUAL 'FLC'
 16398        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16399           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16400           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16401                    - CM-AH-ITD-AH-PMT)
 16402           IF PB-C-AH-REF-CALC LESS THAN +0
 16403              MOVE +0            TO PB-C-AH-REF-CALC
 16404              GO TO 3770-CHECK-REFUNDS
 16405           ELSE
 16406              GO TO 3770-CHECK-REFUNDS.
 16407
 16408     IF PB-COMPANY-ID = 'DCC'
 16409        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16410            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16411           MOVE 'S'              TO CP-EARNING-METHOD
 16412        END-IF
 16413     END-IF
 16414     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16415                            OR '4' OR '5' OR '6' OR '8'
 16416                            OR '9' OR 'G' OR 'S'
 16417        MOVE PB-C-AH-REFUND-OVERRIDE
 16418                                 TO CP-EARNING-METHOD.
 16419
 16420     if pb-company-id = 'AHL'
 16421        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16422        if cp-class-code = spaces
 16423           move zeros            to cp-class-code
 16424        end-if
 16425     ELSE
 16426        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16427     END-IF
 16428*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16429     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16430     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16431                                    CP-RATING-BENEFIT-AMT.
 16432     IF CP-STATE-STD-ABBRV = 'OR'
 16433         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16434                                         PB-CI-AH-TERM.
 16435     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16436     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16437     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16438     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16439     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16440     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 297
* EL050.cbl
 16441
 16442     IF CP-STATE-STD-ABBRV = 'OH'
 16443        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16444                                AND 'CID' AND 'DCC' and 'VPP'
 16445                                AND 'AHL')
 16446           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16447              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16448              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16449              MOVE '6' TO CP-EARNING-METHOD
 16450           END-IF
 16451        END-IF
 16452        IF PB-COMPANY-ID = 'CID'
 16453           IF NO-LIFE-COVERAGE
 16454              IF CP-CRITICAL-PERIOD
 16455                 MOVE '2'       TO CP-EARNING-METHOD
 16456              ELSE
 16457                 MOVE '6'       TO CP-EARNING-METHOD
 16458              END-IF
 16459           ELSE
 16460              IF WS-LF-COVERAGE-TYPE = 'L'
 16461                 MOVE '2'       TO CP-EARNING-METHOD
 16462              ELSE
 16463                 IF (PB-CI-LF-TERM > +60) OR
 16464                    (WS-LF-EARNINGS-CALC = '5')
 16465                    IF CP-CRITICAL-PERIOD
 16466                       MOVE '2'  TO CP-EARNING-METHOD
 16467                    ELSE
 16468                       MOVE '6'  TO CP-EARNING-METHOD
 16469                    END-IF
 16470                 ELSE
 16471                    MOVE '1'     TO CP-EARNING-METHOD
 16472                 END-IF
 16473              END-IF
 16474           END-IF
 16475        END-IF
 16476     END-IF
 16477
 16478*    IF CP-STATE-STD-ABBRV = 'VA'
 16479*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16480*          IF CP-ORIGINAL-TERM GREATER 61
 16481*             MOVE '6' TO CP-EARNING-METHOD
 16482*          ELSE
 16483*             MOVE '1' TO CP-EARNING-METHOD.
 16484
 16485     IF WS-DEFAULT-APR NOT NUMERIC
 16486         MOVE ZEROS TO WS-DEFAULT-APR.
 16487     IF CP-EARN-AS-NET-PAY
 16488         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16489            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16490                MOVE WS-DEFAULT-APR
 16491                                 TO  CP-LOAN-APR
 16492                MOVE ER-3780     TO  WS-ERROR
 16493                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16494            ELSE
 16495                MOVE ER-3781     TO  WS-ERROR
 16496                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16497     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16498     IF PB-COMPANY-ID = 'DCC'
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 298
* EL050.cbl
 16499        AND CP-CANCEL-REASON = 'R'
 16500        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16501        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16502     END-IF
 16503     IF PB-COMPANY-ID = 'DCC'
 16504        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16505        AND (CP-EARNING-METHOD = 'D')
 16506        AND (CP-CANCEL-REASON NOT = 'R')
 16507        CONTINUE
 16508     ELSE
 16509        GO TO 3750-CONTINUE
 16510     END-IF
 16511     MOVE ' '                    TO DD-IU-SW
 16512     IF NOT PDEF-MASTER-FOUND
 16513        MOVE ' '                 TO PDEF-MASTER-SW
 16514        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16515        MOVE PB-STATE            TO ERPDEF-STATE
 16516        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
 16517           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16518        END-IF
 16519        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16520        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16521        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16522        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16523        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16524        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16525        IF PDEF-MASTER-FOUND
 16526           MOVE 'N'              TO PDEF-MASTER-SW
 16527           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16528           IF PDEF-MASTER-FOUND
 16529              IF (ERPDEF-KEY-SAVE (1:16) =
 16530                           PD-CONTROL-PRIMARY (1:16))
 16531                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16532                 CONTINUE
 16533              ELSE
 16534                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16535                 IF (ERPDEF-KEY-SAVE (1:16) =
 16536                           PD-CONTROL-PRIMARY (1:16))
 16537                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16538                    CONTINUE
 16539                 ELSE
 16540                    MOVE ER-2740 TO WS-ERROR
 16541                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16542                    GO TO 3770-CHECK-REFUNDS
 16543                 END-IF
 16544              END-IF
 16545           END-IF
 16546           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16547        END-IF
 16548     END-IF
 16549     IF PDEF-MASTER-FOUND
 16550        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16551           (V1 > +8)
 16552           OR (PD-PROD-CODE (V1) = 'I')
 16553        END-PERFORM
 16554        IF V1 < +9
 16555           SET DD-IU-PRESENT        TO TRUE
 16556        END-IF
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 299
* EL050.cbl
 16557        IF WS-AH-DCC-TRUNC = 'T'
 16558           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16559        ELSE
 16560           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 16561        END-IF
 16562        EVALUATE TRUE
 16563           WHEN WS-TERM > +168
 16564              MOVE 15               TO V1
 16565           WHEN WS-TERM > +156
 16566              MOVE 14               TO V1
 16567           WHEN WS-TERM > +144
 16568              MOVE 13               TO V1
 16569           WHEN WS-TERM > +132
 16570              MOVE 12               TO V1
 16571           WHEN WS-TERM > +120
 16572              MOVE 11               TO V1
 16573           WHEN WS-TERM > +108
 16574              MOVE 10               TO V1
 16575           WHEN WS-TERM > +96
 16576              MOVE 9                TO V1
 16577           WHEN WS-TERM > +84
 16578              MOVE 8                TO V1
 16579           WHEN WS-TERM > +72
 16580              MOVE 7                TO V1
 16581           WHEN WS-TERM > +60
 16582              MOVE 6                TO V1
 16583           WHEN WS-TERM > +48
 16584              MOVE 5                TO V1
 16585           WHEN WS-TERM > +36
 16586              MOVE 4                TO V1
 16587           WHEN WS-TERM > +24
 16588              MOVE 3                TO V1
 16589           WHEN WS-TERM > +12
 16590              MOVE 2                TO V1
 16591           WHEN OTHER
 16592              MOVE 1                TO V1
 16593        END-EVALUATE
 16594
 16595        EVALUATE TRUE
 16596*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 16597*             < +13)
 16598*             AND (DD-IU-PRESENT)
 16599*             MOVE 2                TO V2
 16600*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 16601*             MOVE 1                TO V2
 16602           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 16603              MOVE 2                TO V2
 16604           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 16605              MOVE 3                TO V2
 16606           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 16607              MOVE 4                TO V2
 16608           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 16609              MOVE 5                TO V2
 16610           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 16611              MOVE 6                TO V2
 16612           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 16613              MOVE 7                TO V2
 16614           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 300
* EL050.cbl
 16615              MOVE 8                TO V2
 16616           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 16617              MOVE 9                TO V2
 16618           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 16619              MOVE 10               TO V2
 16620           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 16621              MOVE 11               TO V2
 16622           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 16623              MOVE 12               TO V2
 16624           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 16625              MOVE 13               TO V2
 16626           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 16627              MOVE 14               TO V2
 16628           WHEN OTHER
 16629              MOVE 15               TO V2
 16630        END-EVALUATE
 16631
 16632        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 16633                                 TO CP-DDF-LO-FACT
 16634        MOVE PD-UEP-FACTOR (V1 V2)
 16635                                 TO CP-DDF-HI-FACT
 16636
 16637        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 16638        MOVE CM-AH-CLP     TO CP-DDF-CLP
 16639        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 16640           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 16641        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 16642        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 16643        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 16644           + PD-1ST-YR-ADMIN-ALLOW
 16645
 16646        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16647*       IF PI-CLP-YN = 'Y'
 16648*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 16649*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 16650*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 16651*       END-IF
 16652
 16653        IF DD-IU-PRESENT
 16654           MOVE 'I'              TO CP-EARNING-METHOD
 16655        END-IF
 16656        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16657                                     CP-CLP-RATE-UP
 16658        IF CP-IU-RATE-UP NOT = ZEROS
 16659           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 16660              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 16661           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 16662              / (1 - WS-WORK-FACT)
 16663        END-IF
 16664     END-IF
 16665     .
 16666 3750-CONTINUE.
 16667     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16668
 16669     IF CP-REFUND-TYPE-USED NOT = SPACE
 16670         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16671
 16672     IF CP-ERROR-RATE-IS-ZERO OR
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 301
* EL050.cbl
 16673        CP-ERROR-RATE-NOT-FOUND
 16674        MOVE ER-2740             TO WS-ERROR
 16675        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16676
 16677     IF CP-ERROR-RATE-FILE-NOTOPEN
 16678        MOVE ER-2617             TO WS-ERROR
 16679        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16680     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 16681        AND PB-CI-ENTRY-STATUS = 'M'
 16682        MOVE +0                  TO PB-C-AH-REF-CALC
 16683     ELSE
 16684        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 16685     END-IF
 16686     if pb-company-id = 'VPP'
 16687        MOVE cm-ah-clp           to cp-original-premium
 16688        move zeros               to cp-calc-refund
 16689        perform 7600-get-refund  thru 7600-exit
 16690        if pb-c-ah-cancel-amt > pb-ci-cancel-fee
 16691           move cp-calc-refund   to pb-c-ah-rfnd-clp
 16692        else
 16693           move zeros            to pb-c-ah-rfnd-clp
 16694        end-if
 16695        display ' vpp ref clp ' cm-cert-no ' ' cm-ah-clp ' '
 16696           pb-c-ah-rfnd-clp ' ' pb-c-ah-cancel-amt ' '
 16697           pb-ci-cancel-fee
 16698     end-if
 16699     IF PB-COMPANY-ID = 'DCC'
 16700        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16701        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16702        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16703        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16704        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16705        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16706        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16707        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16708*       DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16709     END-IF
 16710     .
 16711 3770-CHECK-REFUNDS.
 16712
 16713     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16714        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16715           MOVE ER-2766          TO WS-ERROR
 16716           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16717           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16718           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16719              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16720
 16721     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16722        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16723           MOVE ER-2766          TO WS-ERROR
 16724           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16725           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16726           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16727              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16728
 16729     IF PB-COMP-LF-CANCEL
 16730        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 302
* EL050.cbl
 16731        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16732           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16733              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16734
 16735     IF PB-COMP-AH-CANCEL
 16736        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16737        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16738           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16739              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16740
 16741     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16742             GIVING WS-UNSIGN-WRK1
 16743     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16744             GIVING WS-UNSIGN-WRK2.
 16745
 16746     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16747         MOVE ZERO TO WS-UNSIGN-WRK1.
 16748
 16749     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16750         MOVE ZERO TO WS-UNSIGN-WRK2.
 16751
 16752     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16753
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 303
* EL050.cbl
 16755
 16756 3772-CONTINUE.
 16757
 16758**********************************
 16759*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16760*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16761*** DOUBLES THE TOLERANCE AMOUNT.
 16762***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16763**********************************
 16764     IF PB-COMPANY-ID = 'MON' or 'CID' or 'DCC' or 'VPP'
 16765     IF WS-UNSIGN-WRK3 >= WS-TOL-LF-REFUND
 16766         IF WS-REF-REJECT-SW = SPACE
 16767             MOVE ER-2754        TO WS-ERROR
 16768             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16769           ELSE
 16770             MOVE ER-2736        TO WS-ERROR
 16771             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16772**********************************
 16773
 16774 3773-CONTINUE.
 16775
 16776     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16777        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16778           MOVE ER-2723          TO WS-ERROR
 16779           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16780
 16781     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16782        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16783           MOVE ER-2724          TO WS-ERROR
 16784           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16785
 16786     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16787         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16788             (1 + WS-LF-REFUND-OVS-PCT)
 16789     ELSE
 16790         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16791
 16792     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16793         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16794             (1 - WS-TOL-LF-REFUND-PCT)
 16795     ELSE
 16796         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16797
 16798     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 16799        AND (PB-CI-ENTRY-STATUS = 'M')
 16800        AND (PB-C-LF-CANCEL-AMT > +0)
 16801        MOVE ER-3843             TO WS-ERROR
 16802        PERFORM 9900-ERROR-FORMAT
 16803                                 THRU 9900-EXIT
 16804     END-IF
 16805     EVALUATE TRUE
 16806        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16807           CONTINUE
 16808        WHEN PB-C-LF-CANCEL-AMT = +0
 16809                 AND PB-C-LF-REF-CALC > +0
 16810           CONTINUE
 16811        WHEN WS-LF-REFUND-OVS-AMT = 0
 16812                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 304
* EL050.cbl
 16813           CONTINUE
 16814        WHEN OTHER
 16815           IF WS-TOL-LF-REFUND  = +0
 16816              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16817           END-IF
 16818           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16819                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16820                          (PB-C-LF-CANCEL-AMT))
 16821              CONTINUE
 16822           ELSE
 16823              IF WS-LF-REFUND-OVS-AMT = +0
 16824                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16825              END-IF
 16826              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16827                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16828                                       PB-C-LF-CANCEL-AMT)
 16829                 CONTINUE
 16830              ELSE
 16831                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16832                   MOVE ER-2754   TO  WS-ERROR
 16833                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16834                 ELSE
 16835                    MOVE ER-2736   TO  WS-ERROR
 16836                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16837                 END-IF
 16838              END-IF
 16839           END-IF
 16840     END-EVALUATE.
 16841
 16842     EVALUATE TRUE
 16843        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16844           CONTINUE
 16845        WHEN PB-C-LF-CANCEL-AMT = +0
 16846                 AND PB-C-LF-REF-CALC > +0
 16847           CONTINUE
 16848        WHEN OTHER
 16849           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16850               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16851              CONTINUE
 16852           ELSE
 16853              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16854               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16855                CONTINUE
 16856              ELSE
 16857                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16858                     MOVE ER-2754   TO  WS-ERROR
 16859                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16860                 ELSE
 16861                     MOVE ER-2736   TO  WS-ERROR
 16862                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16863                 END-IF
 16864              END-IF
 16865           END-IF
 16866     END-EVALUATE.
 16867
 16868     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16869         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16870             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 305
* EL050.cbl
 16871     ELSE
 16872         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16873
 16874     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16875         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16876             (1 - WS-TOL-AH-REFUND-PCT)
 16877     ELSE
 16878         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16879
 16880     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 16881        AND (PB-CI-ENTRY-STATUS = 'M')
 16882        AND (PB-C-AH-CANCEL-AMT > +0)
 16883        MOVE ER-3843             TO WS-ERROR
 16884        PERFORM 9900-ERROR-FORMAT
 16885                                 THRU 9900-EXIT
 16886     END-IF
 16887     EVALUATE TRUE
 16888        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16889           CONTINUE
 16890*       WHEN PB-C-AH-REF-CALC = +0 AND
 16891*                  PB-C-AH-CANCEL-AMT > +0
 16892        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16893                   PB-C-AH-REF-CALC > +0
 16894           CONTINUE
 16895        WHEN WS-AH-REFUND-OVS-AMT = +0
 16896                AND WS-TOL-AH-REFUND = +0
 16897           CONTINUE
 16898        WHEN OTHER
 16899           IF WS-TOL-AH-REFUND = +0
 16900              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16901           END-IF
 16902           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16903               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16904                                         PB-C-AH-CANCEL-AMT)
 16905              CONTINUE
 16906           ELSE
 16907              IF WS-AH-REFUND-OVS-AMT = +0
 16908                 MOVE +9999999.99 TO
 16909                         WS-AH-REFUND-OVS-AMT
 16910              END-IF
 16911              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16912                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16913                                         PB-C-AH-CANCEL-AMT)
 16914                 CONTINUE
 16915              ELSE
 16916                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16917                    MOVE ER-2754   TO  WS-ERROR
 16918                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16919                 ELSE
 16920                    MOVE ER-2736   TO  WS-ERROR
 16921                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16922                 END-IF
 16923              END-IF
 16924           END-IF
 16925     END-EVALUATE.
 16926
 16927     EVALUATE TRUE
 16928        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 306
* EL050.cbl
 16929           CONTINUE
 16930*       WHEN PB-C-AH-REF-CALC > +0 AND
 16931*                  PB-C-AH-CANCEL-AMT = +0
 16932        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16933                   PB-C-AH-REF-CALC = +0
 16934           CONTINUE
 16935        WHEN OTHER
 16936           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16937               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16938              CONTINUE
 16939           ELSE
 16940              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16941                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16942                 CONTINUE
 16943              ELSE
 16944                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16945                     MOVE ER-2754   TO  WS-ERROR
 16946                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16947                 ELSE
 16948                     MOVE ER-2736   TO  WS-ERROR
 16949                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16950                 END-IF
 16951              END-IF
 16952           END-IF
 16953     END-EVALUATE.
 16954
 16955     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16956        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16957        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16958           AND  PB-C-LF-REF-CALC < +1.00
 16959           AND  PB-C-AH-REF-CALC < +1.00
 16960           CONTINUE
 16961        ELSE
 16962           IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 16963              AND (PB-CI-ENTRY-STATUS = 'M')
 16964              CONTINUE
 16965           ELSE
 16966              MOVE ER-2741       TO WS-ERROR
 16967              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16968           END-IF
 16969        END-IF
 16970     END-IF
 16971
 16972     IF (PB-C-LF-CANCEL-AMT = ZERO
 16973        AND WS-LF-BENEFIT-CD NOT = ZERO
 16974        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16975        AND PB-C-LF-REF-CALC NOT = ZERO)
 16976        OR
 16977        (PB-C-LF-CANCEL-AMT = ZERO
 16978        AND WS-LF-BENEFIT-CD NOT = ZERO
 16979        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16980             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16981                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16982                NEXT SENTENCE
 16983             ELSE
 16984                MOVE ER-2739        TO WS-ERROR
 16985                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16986
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 307
* EL050.cbl
 16987     IF (PB-C-AH-CANCEL-AMT = ZERO
 16988        AND WS-AH-BENEFIT-CD NOT = ZERO
 16989        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16990        AND PB-C-AH-REF-CALC NOT = ZERO)
 16991        OR
 16992        (PB-C-AH-CANCEL-AMT = ZERO
 16993        AND WS-AH-BENEFIT-CD NOT = ZERO
 16994        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16995             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16996                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16997                NEXT SENTENCE
 16998             ELSE
 16999                MOVE ER-2738        TO WS-ERROR
 17000                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17001
 17002 3775-OVER-REF-CHK.
 17003
 17004     IF PB-CI-ENTRY-STATUS = '5'
 17005        GO TO 3780-UPDATE-CANCEL-CERT.
 17006
 17007     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 17008                              PB-CI-LF-ALT-PREMIUM-AMT.
 17009
 17010     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17011        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17012                                 PB-C-LF-REF-CALC
 17013      ELSE
 17014        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17015                                 PB-C-LF-CANCEL-AMT.
 17016
 17017     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 17018        MOVE ER-2755             TO WS-ERROR
 17019        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17020
 17021     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 17022
 17023     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17024        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17025                                 PB-C-AH-REF-CALC
 17026      ELSE
 17027        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17028                                 PB-C-AH-CANCEL-AMT.
 17029
 17030     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 17031        MOVE ER-2778             TO WS-ERROR
 17032        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17033
 17034     IF PB-CI-OB-FLAG NOT = 'Z'
 17035        NEXT SENTENCE
 17036       ELSE
 17037         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17038            MOVE ER-2757           TO WS-ERROR
 17039            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17040
 17041 3780-UPDATE-CANCEL-CERT.
 17042
 17043     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 17044        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 308
* EL050.cbl
 17045        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17046
 17047     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 17048         MOVE ER-2729              TO WS-ERROR
 17049         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17050
 17051     IF PB-CI-LF-BENEFIT-CD = ZERO
 17052         GO TO 3780-UPDATE-CONT-1.
 17053
 17054     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 17055         GO TO 3780-UPDATE-CONT-1.
 17056
 17057     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17058       AND
 17059        (PB-C-LF-CANCEL-AMT NEGATIVE)
 17060       AND
 17061        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 17062       AND
 17063        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 17064            NEXT SENTENCE
 17065       ELSE
 17066        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17067          AND
 17068***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17069***       AND
 17070           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 17071            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17072               MOVE ER-2730      TO WS-ERROR
 17073               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17074               GO TO 3999-END-EDIT
 17075            ELSE
 17076               GO TO 3999-END-EDIT
 17077        ELSE
 17078            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 17079               MOVE ER-2765           TO WS-ERROR
 17080               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17081               GO TO 3785-CHECK-NH.
 17082*              GO TO 3999-END-EDIT.
 17083
 17084 3780-UPDATE-CONT-1.
 17085     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 17086
 17087     IF PB-CI-AH-BENEFIT-CD = ZERO
 17088         GO TO 3780-UPDATE-CONT-2.
 17089
 17090     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 17091         GO TO 3780-UPDATE-CONT-2.
 17092
 17093     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 17094
 17095     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17096       AND
 17097        (PB-C-AH-CANCEL-AMT NEGATIVE)
 17098       AND
 17099        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 17100       AND
 17101        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 17102            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 309
* EL050.cbl
 17103       ELSE
 17104        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17105          AND
 17106***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17107***       AND
 17108           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 17109           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 17110            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17111               MOVE ER-2773      TO WS-ERROR
 17112               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17113               GO TO 3999-END-EDIT
 17114            ELSE
 17115               GO TO 3999-END-EDIT
 17116            END-IF
 17117           ELSE
 17118             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17119                IF MSTR-CERT-NO = W-CL-CERT-NO
 17120                   MOVE ER-2890 TO WS-ERROR
 17121                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17122                   GO TO 3999-END-EDIT
 17123                ELSE
 17124                   MOVE ER-2898 TO WS-ERROR
 17125                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17126                   GO TO 3999-END-EDIT
 17127                END-IF
 17128             ELSE
 17129                GO TO 3785-CHECK-NH
 17130             END-IF
 17131           END-IF
 17132          ELSE
 17133            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 17134              IF WS-AH-CLAIM-RESCINDED = 'Y'
 17135                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17136                   IF MSTR-CERT-NO = W-CL-CERT-NO
 17137                      MOVE ER-2890 TO WS-ERROR
 17138                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17139                      GO TO 3999-END-EDIT
 17140                   ELSE
 17141                      MOVE ER-2898 TO WS-ERROR
 17142                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17143                      GO TO 3999-END-EDIT
 17144                   END-IF
 17145                ELSE
 17146                   MOVE ER-2765 TO WS-ERROR
 17147                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17148                   GO TO 3785-CHECK-NH
 17149                END-IF
 17150              ELSE
 17151               MOVE ER-2765      TO WS-ERROR
 17152               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17153               GO TO 3785-CHECK-NH.
 17154*              GO TO 3999-END-EDIT.
 17155
 17156 3780-UPDATE-CONT-2.
 17157
 17158     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 17159        AND WS-LF-BENEFIT-CD = ZERO
 17160           MOVE ER-2743           TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 310
* EL050.cbl
 17161           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17162
 17163     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 17164        AND WS-AH-BENEFIT-CD = ZERO
 17165           MOVE ER-2744           TO WS-ERROR
 17166           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17167
 17168     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 17169        (PB-C-AH-CANCEL-AMT NEGATIVE))
 17170        AND
 17171        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 17172         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
 17173           MOVE ER-2746           TO WS-ERROR
 17174           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17175
 17176     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 17177       AND
 17178        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 17179             MOVE ER-2737        TO WS-ERROR
 17180             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17181
 17182     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 17183       AND
 17184        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 17185             MOVE ER-2737        TO WS-ERROR
 17186             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17187
 17188     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 17189         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 17190             OR 'CID' OR 'DCC' or 'VPP' OR 'AHL'
 17191             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 17192         ELSE
 17193             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 17194                 MOVE ER-2768    TO WS-ERROR
 17195                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17196             ELSE
 17197                 MOVE ER-2756    TO WS-ERROR
 17198                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17199
 17200     IF CERT-PEND-ISSUE-RETURNED
 17201        MOVE ER-2772             TO WS-ERROR
 17202        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17203 3785-CHECK-NH.
 17204*    IF PB-STATE NOT = 'NH' and 'TN'
 17205     IF PB-STATE NOT = 'NH'
 17206        GO TO 3999-END-EDIT
 17207     END-IF
 17208
 17209     MOVE ER-2796                TO WS-ERROR
 17210     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 17211     IF (PB-C-REF-INTERFACE-SW = 'Y')
 17212        OR (CM-NH-INTERFACE-SW = 'Y')
 17213        MOVE ER-2793             TO WS-ERROR
 17214        PERFORM 9900-ERROR-FORMAT
 17215                                 THRU 9900-EXIT
 17216     END-IF
 17217     MOVE +0                     TO WS-PAYMENT-AMT
 17218     if pb-state = 'NH'
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 311
* EL050.cbl
 17219        IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR
 17220               PB-C-AH-CANCEL-DT
 17221           GO TO 3999-END-EDIT
 17222        END-IF
 17223     end-if
 17224***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17225***-_-
 17226***-_-   For TN it's only flat cancels
 17227***-_-
 17228***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17229     if pb-state = 'TN'
 17230        if ((pb-c-lf-cancel-dt <> low-values)
 17231           and (pb-c-lf-cancel-dt <> pb-cert-eff-dt))
 17232                      or
 17233           ((pb-c-ah-cancel-dt <> low-values)
 17234           and (pb-c-ah-cancel-dt <> pb-cert-eff-dt))
 17235           GO TO 3999-END-EDIT
 17236        END-IF
 17237     end-if
 17238     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 17239        GO TO 3999-END-EDIT
 17240     END-IF
 17241***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17242***-_-
 17243***-_-   if cancel date within 15 days of effective date, bypass
 17244***-_-
 17245***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17246     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 17247     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 17248     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 17249        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 17250     END-IF
 17251     MOVE '1'                    TO DC-OPTION-CODE
 17252     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17253     IF NO-CONVERSION-ERROR
 17254        and pb-state = 'NH'
 17255        IF DC-ELAPSED-DAYS < +16
 17256           GO TO 3999-END-EDIT
 17257        END-IF
 17258     END-IF
 17259***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17260***-_-
 17261***-_-   if cancel date within 30 days of current date then
 17262***-_-   bypass else subtract 15 days from period
 17263***-_-
 17264***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17265     MOVE +0                     TO DC-ELAPSED-DAYS
 17266     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 17267     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 17268     MOVE '1'                    TO DC-OPTION-CODE
 17269     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17270     IF NO-CONVERSION-ERROR
 17271        IF DC-ELAPSED-DAYS > +30
 17272           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 17273        ELSE
 17274           GO TO 3999-END-EDIT
 17275        END-IF
 17276     ELSE
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 312
* EL050.cbl
 17277        GO TO 3999-END-EDIT
 17278     END-IF
 17279***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17280***-_-
 17281***-_-   'NH' is 10%, TN is 3.5%
 17282***-_-
 17283***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17284     if pb-state = 'NH'
 17285        move +1.10               to ws-work-rate
 17286     else
 17287        move +1.035              to ws-work-rate
 17288     end-if
 17289     COMPUTE WS-PAYMENT-AMT ROUNDED =
 17290        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 17291           (ws-work-rate ** (DC-ELAPSED-DAYS / 365) - 1))
 17292     IF WS-PAYMENT-AMT < 600.00
 17293        GO TO 3999-END-EDIT
 17294     END-IF
 17295     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17296
 17297     IF (ERMAIL-FOUND = ' ')
 17298         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 17299         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 17300        GO TO 3999-END-EDIT
 17301     END-IF
 17302     MOVE ER-2795                TO WS-ERROR
 17303     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 17304
 17305     GO TO 3999-END-EDIT.
 17306******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 313
* EL050.cbl
 17308 3990-FILES-NOT-OPEN.
 17309
 17310     MOVE ER-2617                TO WS-ERROR.
 17311     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17312     GO TO 9990-RETURN.
 17313
 17314 3999-END-EDIT.
 17315
 17316     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 17317
 17318     IF PB-CANCELLATION AND CERT-WAS-FOUND
 17319         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 17320         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17321             PERFORM 9250-UNLOCK-RETURN
 17322             GO TO 9990-RETURN
 17323          ELSE
 17324             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17325             GO TO 9990-RETURN.
 17326
 17327     IF PB-CANCELLATION
 17328          GO TO 9990-RETURN.
 17329
 17330     IF CERT-WAS-NOT-FOUND
 17331        MOVE SPACES              TO CERTIFICATE-MASTER.
 17332
 17333     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 17334
 17335     IF CERT-WAS-FOUND
 17336         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17337             PERFORM 9250-UNLOCK-RETURN
 17338          ELSE
 17339            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17340      ELSE
 17341         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 17342
 17343     if pb-company-id = 'VPP'
 17344        perform 8150-read-elcrtt thru 8150-exit
 17345        if ws-vehicle-odometer numeric
 17346           if ws-vehicle-odometer > 6000
 17347              move er-1583       to ws-error
 17348              PERFORM 9900-ERROR-FORMAT
 17349                                 THRU 9900-EXIT
 17350           end-if
 17351        end-if
 17352     end-if
 17353     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 17354        IF ((PB-COMPANY-ID = 'DCC')
 17355           AND (PB-CARRIER = '2' OR '4' OR '6'))
 17356                         or
 17357            (pb-company-id = 'CID' or 'VPP')
 17358            PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 17359        END-IF
 17360     END-IF.
 17361
 17362     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 17363         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 17364     END-IF.
 17365     move ' '                    to ws-ins-age-defaulted
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 314
* EL050.cbl
 17366     perform 8150-read-elcrtt    thru 8150-exit
 17367     if ws-ins-age-defaulted = 'Y'
 17368        move er-1573             to ws-error
 17369        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17370     end-if
 17371
 17372     if ws-jnt-age-defaulted = 'Y'
 17373        move er-1574             to ws-error
 17374        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17375     end-if
 17376***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17377***                                                           ****
 17378***  Set an error if the state requires verification of agent ****
 17379***  and agent hasn't verified yet and the status is not =    ****
 17380***  9,5,d and V and the term for lf or ah > 1 (not OB)       ****
 17381***  and the entry date > 09/01/2015.                         ****
 17382***                                                           ****
 17383***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17384     if (pb-input-dt >= X'AD81')    *> 09/01/2015
 17385        and (pb-i-entry-status not = '5' and 'D' and 'V')
 17386        and (pb-account (9:2) not = 'OB')
 17387        if (ws-st-agent-sig-edit = 'Y')
 17388           and (am-report-code-1 not = 'CONLEY')
 17389           evaluate true
 17390              when cs-agent-edit-status = 'C'
 17391                 move er-1743    to ws-error
 17392                 perform 9900-error-format
 17393                                 thru 9900-exit
 17394              when cs-agent-edit-status = 'S'
 17395                 move er-1744    to ws-error
 17396                 perform 9900-error-format
 17397                                 thru 9900-exit
 17398              when cs-agent-edit-status = 'M'
 17399                 move er-1745    to ws-error
 17400                 perform 9900-error-format
 17401                                 thru 9900-exit
 17402              when cs-agent-edit-status = 'R'
 17403                 move er-1747    to ws-error
 17404                 perform 9900-error-format
 17405                                 thru 9900-exit
 17406              when cs-agent-edit-status = 'N'
 17407                 move er-1748    to ws-error
 17408                 perform 9900-error-format
 17409                                 thru 9900-exit
 17410              when cs-agent-edit-status <> 'V' and 'U' and
 17411                                           'R' and 'N'
 17412                 move er-1746    to ws-error
 17413                 perform 9900-error-format
 17414                                 thru 9900-exit
 17415           end-evaluate
 17416        end-if
 17417     end-if
 17418     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 17419     IF ((PB-COMPANY-ID = 'DCC' or 'VPP')
 17420        AND (WS-NO-SECURE-PAY))
 17421                  OR
 17422        (WS-LF-SPECIAL-CALC-CD = 'O'
 17423        OR WS-AH-SPECIAL-CALC-CD = 'O')
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 315
* EL050.cbl
 17424        SET SKIP-ADDR-EDIT       TO TRUE
 17425     END-IF
 17426     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 17427        AND (NOT SKIP-ADDR-EDIT)
 17428        MOVE ER-2963             TO WS-ERROR
 17429        PERFORM 9900-ERROR-FORMAT
 17430                                 THRU 9900-EXIT
 17431        GO TO 9990-RETURN
 17432     END-IF
 17433     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 17434     IF ERPNDM-FOUND NOT = 'X'
 17435        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17436           OR (PM-CITY        = SPACES OR LOW-VALUES)
 17437           OR (PM-STATE       = SPACES OR LOW-VALUES)
 17438           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 17439           AND (NOT SKIP-ADDR-EDIT)
 17440           MOVE ER-2694          TO WS-ERROR
 17441           PERFORM 9900-ERROR-FORMAT
 17442                                 THRU 9900-EXIT
 17443        END-IF
 17444        MOVE ' '                 TO STATE-RECORD-ERROR
 17445        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17446        MOVE PM-STATE            TO CNTL-ACCESS
 17447        MOVE '3'                 TO CNTL-REC-TYPE
 17448        MOVE +0                  TO CNTL-SEQ-NO
 17449        MOVE '0'                 TO RC-SW-2
 17450        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17451        IF (NO-STATE-RECORD)
 17452           OR (CF-RECORD-TYPE NOT = '3')
 17453           OR (PM-STATE NOT = CF-STATE-CODE)
 17454           IF (PM-STATE = SPACES)
 17455              AND (SKIP-ADDR-EDIT)
 17456              CONTINUE
 17457           ELSE
 17458              MOVE ER-2963       TO WS-ERROR
 17459              PERFORM 9900-ERROR-FORMAT
 17460                                 THRU 9900-EXIT
 17461           END-IF
 17462        END-IF
 17463        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 17464           MOVE ER-2883          TO WS-ERROR
 17465           PERFORM 9900-ERROR-FORMAT
 17466                                 THRU 9900-EXIT
 17467        END-IF
 17468        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 17469           MOVE ' '                 TO STATE-RECORD-ERROR
 17470           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17471           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 17472           MOVE '3'                 TO CNTL-REC-TYPE
 17473           MOVE +0                  TO CNTL-SEQ-NO
 17474           MOVE '0'                 TO RC-SW-2
 17475           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17476           IF NO-STATE-RECORD
 17477              OR (CF-RECORD-TYPE NOT = '3')
 17478              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 17479              MOVE ER-2964          TO WS-ERROR
 17480              PERFORM 9900-ERROR-FORMAT
 17481                                    THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 316
* EL050.cbl
 17482           END-IF
 17483        END-IF
 17484     ELSE
 17485        IF NOT SKIP-ADDR-EDIT
 17486           MOVE ER-2393          TO WS-ERROR
 17487           PERFORM 9900-ERROR-FORMAT
 17488                                 THRU 9900-EXIT
 17489        END-IF
 17490     END-IF
 17491
 17492     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17493
 17494     IF (ERMAIL-FOUND = ' ' AND
 17495        ERPNDM-FOUND = ' ')
 17496        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 17497           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 17498           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 17499          OR
 17500           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 17501          OR
 17502           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 17503           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 17504           GO TO 3999-UNLOCK-ERMAIL.
 17505
 17506     IF ERPNDM-FOUND = 'X'
 17507        GO TO 3999-UNLOCK-ERMAIL.
 17508
 17509     IF PM-INSURED-LAST-NAME      = SPACES
 17510        AND PM-INSURED-FIRST-NAME = SPACES
 17511        AND PM-ADDRESS-LINE-1     = SPACES
 17512        AND PM-ADDRESS-LINE-2     = SPACES
 17513        AND PM-CITY-STATE         = SPACES
 17514        AND PM-CRED-BENE-NAME     = SPACES
 17515        AND PM-CRED-BENE-ADDR     = SPACES
 17516        AND PM-CRED-BENE-CTYST    = SPACES
 17517        GO TO 3999-UNLOCK-ERMAIL
 17518     END-IF
 17519
 17520     MOVE SPACES                 TO MAILING-DATA.
 17521
 17522     MOVE 'MA'                   TO MA-RECORD-ID.
 17523     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 17524     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 17525     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 17526     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 17527     MOVE PB-SV-STATE            TO MA-STATE.
 17528     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 17529     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 17530
 17531     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 17532     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 17533
 17534     IF ERMAIL-FOUND = ' '
 17535        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 17536     ELSE
 17537        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 17538        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 17539        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 317
* EL050.cbl
 17540
 17541     GO TO 9990-RETURN.
 17542
 17543 3999-UNLOCK-ERMAIL.
 17544     IF ERMAIL-FOUND = ' '
 17545        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 17546
 17547     GO TO 9990-RETURN.
 17548******************************************************************
 17549
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 318
* EL050.cbl
 17551 4000-UPDATE-CANCELLED-CERT.
 17552     IF CERT-WAS-NOT-FOUND
 17553        GO TO 4299-EXIT.
 17554
 17555*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 17556     IF PB-C-NH-INT-ON-REFS > ZEROS
 17557        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 17558     END-IF
 17559     IF PB-C-REF-INTERFACE-SW = 'Y'
 17560        MOVE PB-C-REF-INTERFACE-SW
 17561                                 TO CM-NH-INTERFACE-SW
 17562     END-IF
 17563     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17564     IF ERMAIL-FOUND = 'X'
 17565        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17566        OR (MA-CITY        = SPACES OR LOW-VALUES)
 17567        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 17568        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 17569           MOVE ER-2694          TO WS-ERROR
 17570           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17571     END-IF
 17572
 17573     IF PB-C-POST-CARD-IND = 'Y'
 17574        MOVE +8                  TO SUB
 17575*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17576        IF ERMAIL-FOUND = ' '
 17577           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 17578              (SUB > +7)
 17579              OR (MA-MAIL-STATUS (SUB) = '1')
 17580           END-PERFORM
 17581        END-IF
 17582        IF (SUB > +7)
 17583           OR (ERMAIL-FOUND = 'X')
 17584           MOVE ER-3789          TO WS-ERROR
 17585           PERFORM 9900-ERROR-FORMAT
 17586                                 THRU 9900-EXIT
 17587        END-IF
 17588     ELSE
 17589        MOVE 'N'                 TO PB-C-POST-CARD-IND
 17590     END-IF
 17591
 17592     IF ERMAIL-FOUND = ' '
 17593        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 17594     END-IF.
 17595
 17596     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 17597
 17598     IF PB-CI-OB-FLAG = 'Z'
 17599        GO TO 4150-SUMMARY-CERT-CANCEL.
 17600
 17601     IF PB-C-LF-CANCEL-VOIDED
 17602         PERFORM 4200-REVERSE-LF-CANCEL.
 17603     IF PB-C-AH-CANCEL-VOIDED
 17604         PERFORM 4200-REVERSE-AH-CANCEL.
 17605
 17606 4100-APPLY-LF-CANCEL.
 17607
 17608     MOVE +0                     TO WS-SUB.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 319
* EL050.cbl
 17609
 17610 4100-CHECK-LF-ERRORS.
 17611
 17612     ADD +1                       TO WS-SUB.
 17613
 17614     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17615        IF LF-COVERAGE-CANCELLED
 17616           GO TO 4100-LF-CANCEL-CONT
 17617        ELSE
 17618           GO TO 4100-UPDATE-LF-COVERAGE.
 17619
 17620     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17621                                   ER-2729 OR
 17622                                   ER-2730 OR
 17623                                   ER-2731 OR
 17624                                   ER-2732 OR
 17625                                   ER-2737 OR
 17626                                   ER-2740 OR
 17627                                   ER-2743 OR
 17628                                   ER-2749 OR
 17629                                   ER-2750 OR
 17630                                   ER-2755 OR
 17631                                   ER-2757 OR
 17632                                   ER-2760 OR
 17633                                   ER-2772 OR
 17634                                   ER-2774 OR
 17635                                   ER-2776 OR
 17636                                   ER-2794
 17637        GO TO 4100-UPDATE-LF-COVERAGE.
 17638
 17639     GO TO 4100-CHECK-LF-ERRORS.
 17640
 17641 4100-UPDATE-LF-COVERAGE.
 17642
 17643     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 17644     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 17645     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 17646        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 17647     END-IF
 17648     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17649                                      TO CM-CREDIT-INTERFACE-SW-2.
 17650     IF CM-LF-CANCEL-DT = LOW-VALUE
 17651         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 17652
 17653     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 17654         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 17655                                         CM-LF-STATUS-AT-CANCEL.
 17656
 17657     GO TO 4100-APPLY-AH-CANCEL.
 17658
 17659 4100-LF-CANCEL-CONT.
 17660     IF PB-C-LF-CANCEL-VOIDED
 17661         GO TO 4100-APPLY-AH-CANCEL.
 17662
 17663     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17664         GO TO 4100-APPLY-AH-CANCEL.
 17665
 17666     IF PB-C-LF-CANCEL-AMT GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 320
* EL050.cbl
 17667        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17668           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 17669        ELSE
 17670           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 17671
 17672     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 17673     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 17674
 17675     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 17676         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 17677
 17678     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 17679        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 17680         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 17681         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 17682
 17683     IF PB-RECORD-RETURNED
 17684        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17685      ELSE
 17686        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 17687
 17688 4100-APPLY-AH-CANCEL.
 17689
 17690     MOVE +0                      TO WS-SUB.
 17691
 17692 4100-CHECK-AH-ERRORS.
 17693
 17694     ADD +1                       TO WS-SUB.
 17695
 17696     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17697        IF AH-COVERAGE-CANCELLED
 17698           GO TO 4100-AH-CANCEL-CONT
 17699        ELSE
 17700           GO TO 4100-UPDATE-AH-COVERAGE.
 17701
 17702     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17703                                   ER-2729 OR
 17704                                   ER-2732 OR
 17705                                   ER-2737 OR
 17706                                   ER-2740 OR
 17707                                   ER-2744 OR
 17708                                   ER-2749 OR
 17709                                   ER-2750 OR
 17710                                   ER-2755 OR
 17711                                   ER-2757 OR
 17712                                   ER-2760 OR
 17713                                   ER-2771 OR
 17714                                   ER-2772 OR
 17715                                   ER-2773 OR
 17716                                   ER-2775 OR
 17717                                   ER-2777 OR
 17718                                   ER-2778 OR
 17719                                   ER-2794
 17720        GO TO 4100-UPDATE-AH-COVERAGE.
 17721
 17722     GO TO 4100-CHECK-AH-ERRORS.
 17723
 17724 4100-UPDATE-AH-COVERAGE.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 321
* EL050.cbl
 17725
 17726     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 17727     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 17728     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 17729     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17730                                      TO CM-CREDIT-INTERFACE-SW-2.
 17731     IF CM-AH-CANCEL-DT = LOW-VALUE
 17732         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 17733
 17734     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 17735         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 17736                                         CM-AH-STATUS-AT-CANCEL.
 17737
 17738     IF LF-COVERAGE-CANCELLED
 17739         IF PB-RECORD-RETURNED
 17740              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 17741          ELSE
 17742              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 17743
 17744     GO TO 4299-EXIT.
 17745
 17746 4100-AH-CANCEL-CONT.
 17747     IF PB-C-AH-CANCEL-VOIDED
 17748         GO TO 4299-EXIT.
 17749
 17750     if cm-credit-interface-sw-2 = ' '
 17751        if pb-fatal-errors or pb-unforced-errors
 17752           move '4'              to cm-credit-interface-sw-2
 17753        else
 17754           move '1'              to cm-credit-interface-sw-2
 17755        end-if
 17756     end-if
 17757     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17758         GO TO 4299-EXIT.
 17759
 17760     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 17761        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17762           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 17763        ELSE
 17764           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 17765
 17766     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 17767     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 17768
 17769     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 17770         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 17771
 17772     IF CM-AH-STATUS-AT-CANCEL = SPACE
 17773         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 17774         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 17775
 17776     IF PB-RECORD-RETURNED
 17777        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 17778      ELSE
 17779        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 17780
 17781     GO TO 4299-EXIT.
 17782
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 322
* EL050.cbl
 17783 4150-SUMMARY-CERT-CANCEL.
 17784     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 17785
 17786     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17787        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17788                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 17789     ELSE
 17790        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17791                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 17792
 17793     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17794        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17795                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 17796     ELSE
 17797        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17798                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 17799
 17800     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17801        NEXT SENTENCE
 17802     ELSE
 17803        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 17804
 17805     GO TO 4299-EXIT.
 17806
 17807 4200-REVERSE-LF-CANCEL.
 17808     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 17809
 17810     IF CM-LF-CANCEL-APPLIED
 17811        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 17812        MOVE SPACES                TO CM-LF-EXIT-BATCH
 17813        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 17814
 17815     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 17816
 17817     IF PB-RECORD-RETURNED
 17818        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17819       ELSE
 17820        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17821
 17822 4200-REVERSE-LF-EXIT.
 17823       EXIT.
 17824
 17825 4200-REVERSE-AH-CANCEL.
 17826     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17827
 17828     IF CM-AH-CANCEL-APPLIED
 17829        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17830        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17831        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17832
 17833     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17834
 17835     IF PB-RECORD-RETURNED
 17836        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17837       ELSE
 17838        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17839
 17840 4200-REVERSE-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 323
* EL050.cbl
 17841       EXIT.
 17842
 17843 4299-EXIT.
 17844       EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 324
* EL050.cbl
 17846
 17847 4500-UPDATE-NEW-CERT.
 17848     IF CERT-WAS-FOUND
 17849         NEXT SENTENCE
 17850       ELSE
 17851         GO TO 4520-BUILD-NEW-KEY.
 17852
 17853     IF  CLASIC-CREATED-CERT
 17854         GO TO 4999-EXIT.
 17855
 17856     IF  CERT-WAS-CREATED-FOR-CLAIM
 17857         GO TO 4520-BUILD-NEW-KEY.
 17858
 17859     IF CERT-ADDED-BATCH
 17860        IF CM-RECORD-ID = 'CM'
 17861            GO TO 4999-EXIT.
 17862
 17863 4520-BUILD-NEW-KEY.
 17864* BUILD CONTROL PRIMARY
 17865
 17866     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17867                                       CM-COMPANY-CD-A1
 17868                                       CM-COMPANY-CD-A2
 17869                                       CM-COMPANY-CD-A4
 17870                                       CM-COMPANY-CD-A5.
 17871
 17872     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17873     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17874     MOVE PB-SV-STATE               TO CM-STATE.
 17875     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17876     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17877     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17878     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17879
 17880     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17881
 17882     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17883     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17884     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17885     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17886
 17887     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17888        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17889
 17890     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17891         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17892         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17893         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17894         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17895     ELSE
 17896         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17897
 17898     IF PB-COMPANY-ID   EQUAL  'CRI'
 17899         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17900         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17901         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17902         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17903         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 325
* EL050.cbl
 17904
 17905     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17906        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17907         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17908
 17909     IF PB-COMPANY-ID  = 'LBL'
 17910        IF PB-I-JOINT-COVERAGE
 17911            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17912                                           PB-I-MEMBER-NO
 17913            GO TO 4550-CONT-CERT-PROCESS.
 17914
 17915     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17916        NEXT SENTENCE
 17917     ELSE
 17918        GO TO 4540-BUILD-MEMBER-NO.
 17919
 17920******************************************************************
 17921*                                                                *
 17922*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17923*    FOR 'MON'.                                                  *
 17924*                                                                *
 17925******************************************************************
 17926
 17927     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17928     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17929     MOVE +1                     TO WS-SUB1
 17930                                    WS-SUB2.
 17931
 17932 4530-EDIT-MEMB-NAME.
 17933
 17934     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17935        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17936        ADD +1                       TO WS-SUB2.
 17937
 17938     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17939        ADD +1                       TO WS-SUB1
 17940        GO TO 4530-EDIT-MEMB-NAME.
 17941
 17942     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17943     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17944     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17945*    MOVE SPACE                      TO DC-OPTION-CODE.
 17946     SET  BIN-TO-GREG                TO TRUE.
 17947     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17948     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17949
 17950     GO TO 4550-CONT-CERT-PROCESS.
 17951
 17952******************************************************************
 17953*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17954******************************************************************
 17955
 17956 4540-BUILD-MEMBER-NO.
 17957
 17958     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17959         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17960         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17961         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 326
* EL050.cbl
 17962         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17963     ELSE
 17964         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17965
 17966     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17967        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17968         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17969
 17970 4550-CONT-CERT-PROCESS.
 17971
 17972*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17973*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17974*    ELSE
 17975*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17976
 17977     IF CERT-WAS-CREATED-FOR-CLAIM
 17978        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17979        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17980
 17981     IF CERT-AND-CLAIM-ONLINE
 17982        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17983        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17984
 17985     MOVE 'CM'                     TO CM-RECORD-ID.
 17986     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17987
 17988     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17989        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17990        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17991     ELSE
 17992        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17993        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17994
 17995     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17996     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17997     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17998     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17999     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 18000     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 18001     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 18002                                      CM-LF-ITD-CANCEL-AMT
 18003                                      CM-LF-ITD-DEATH-AMT
 18004                                      CM-AH-ITD-AH-PMT
 18005                                      CM-AH-ITD-LUMP-PMT
 18006                                      CM-AH-ITD-CANCEL-AMT
 18007                                      CM-LF-NSP-PREMIUM-AMT
 18008                                      CM-AH-NSP-PREMIUM-AMT.
 18009*                                     CM-CLAIM-DEDUCT-WITHHELD
 18010*                                     CM-CANCEL-DEDUCT-WITHHELD.
 18011     if pb-i-loan-apr = +99.9999
 18012        move zeros                 to cm-loan-apr
 18013     else
 18014        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 18015     end-if
 18016     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 18017     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 18018     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 18019     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 327
* EL050.cbl
 18020     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 18021     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 18022     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 18023     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 18024     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 18025     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 18026     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 18027
 18028     IF PB-I-LIVES NOT NUMERIC
 18029         MOVE ZERO                 TO PB-I-LIVES.
 18030
 18031     IF PB-I-NUM-BILLED NOT NUMERIC
 18032         MOVE ZERO                 TO PB-I-NUM-BILLED.
 18033
 18034     MOVE PB-I-LIVES               TO CM-LIVES.
 18035     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 18036
 18037     IF PB-COMPANY-ID EQUAL  'DMD'
 18038         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 18039         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 18040
 18041     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 18042     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 18043     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 18044     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 18045     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 18046     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 18047
 18048     IF PB-I-LF-POLICY-FEE NUMERIC
 18049        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 18050     ELSE
 18051        MOVE +0                    TO CM-LF-POLICY-FEE.
 18052
 18053     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18054        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 18055        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 18056     ELSE
 18057        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 18058
 18059     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 18060     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 18061     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 18062     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 18063     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 18064     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 18065     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 18066     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 18067     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 18068
 18069     IF PB-I-CANCEL-FEE NUMERIC
 18070        MOVE PB-I-CANCEL-FEE     TO CM-CANCEL-FEE
 18071     ELSE
 18072        MOVE +0                  TO CM-CANCEL-FEE
 18073     END-IF
 18074
 18075     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 18076        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 18077     ELSE
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 328
* EL050.cbl
 18078        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 18079
 18080     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 18081     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 18082
 18083     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 18084                                      CM-LF-DEATH-EXIT-DT
 18085                                      CM-AH-SETTLEMENT-EXIT-DT.
 18086
 18087*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 18088*                       'TIH' OR 'OFL' OR 'FLA' OR
 18089*                       'TII' OR 'TMS' OR 'CRI' OR
 18090*                       'NCL'
 18091     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 18092
 18093     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 18094         IF WS-LF-SPECIAL-CALC-CD = 'O'
 18095            MOVE '2'                TO CM-PREMIUM-TYPE.
 18096
 18097     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 18098         IF WS-AH-SPECIAL-CALC-CD = 'O'
 18099            MOVE '2'                TO CM-PREMIUM-TYPE.
 18100
 18101     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 18102         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 18103     ELSE
 18104         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 18105         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 18106
 18107     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 18108     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 18109     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 18110     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 18111     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 18112     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 18113     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 18114     MOVE SPACE                     TO CM-PAYMENT-MODE.
 18115
 18116     IF PB-NO-MONTHS-SKIPPED
 18117         MOVE SPACE                 TO CM-SKIP-CODE
 18118     ELSE
 18119         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 18120
 18121     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 18122     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 18123                                       CM-LF-STATUS-AT-CANCEL.
 18124
 18125     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 18126     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 18127                                       CM-AH-STATUS-AT-CANCEL.
 18128
 18129     MOVE '1'                       TO CM-ENTRY-STATUS.
 18130
 18131     IF PB-REISSUED-CERT
 18132        MOVE '5'                    TO CM-ENTRY-STATUS.
 18133
 18134     IF PB-MONTHLY-CERT
 18135        MOVE 'M'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 329
* EL050.cbl
 18136
 18137     IF PB-CASH-CERT
 18138        MOVE 'C'                    TO CM-ENTRY-STATUS.
 18139
 18140     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 18141     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 18142     IF PB-POLICY-IS-DECLINED
 18143        MOVE 'D'                    TO CM-ENTRY-STATUS.
 18144
 18145     IF PB-POLICY-IS-VOIDED
 18146        MOVE 'V'                    TO CM-ENTRY-STATUS.
 18147
 18148     IF PB-NEEDS-UNDERWRITING
 18149        MOVE 'U'                    TO CM-ENTRY-STATUS.
 18150
 18151     IF PB-REIN-ONLY-CERT
 18152        MOVE '9'                    TO CM-ENTRY-STATUS.
 18153
 18154     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 18155         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 18156     ELSE
 18157         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 18158
 18159     IF PB-RECORD-RETURNED
 18160        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 18161      ELSE
 18162        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 18163
 18164     IF PB-I-MAIL-ADDRS-PRESENT
 18165        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 18166
 18167     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 18168                                       CM-ENTRY-DT.
 18169
 18170 4999-EXIT.
 18171     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 330
* EL050.cbl
 18173
 18174 5000-PROCESS-REPS.
 18175     MOVE ' '                    TO AGTC-MASTER-SW
 18176     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 18177     MOVE CO-TYPE                TO AGTC-TYPE
 18178     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 18179     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 18180     IF (AGTC-MASTER-SW NOT = 'N')
 18181        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 18182        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 18183        PERFORM 8583-READ-ERAGTC-NEXT
 18184                                 THRU 8583-EXIT
 18185     END-IF
 18186     IF AGTC-MASTER-SW = 'N'
 18187        CONTINUE
 18188     ELSE
 18189        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 18190           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 18191              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 18192              MOVE 'Y'           TO AGTC-MASTER-SW
 18193           END-IF
 18194        END-IF
 18195     END-IF
 18196     .
 18197 5000-EXIT.
 18198     EXIT.
 18199 6370-EDIT-INPUT-LF-CODE.
 18200     move ' ' to ws-benefit-cd-chg-sw
 18201     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 18202        MOVE +1                  TO SUB
 18203        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 18204        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18205        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18206        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18207        GO TO 6370-SEARCH-LOOP.
 18208
 18209     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18210
 18211     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18212     MOVE SPACES                 TO CNTL-ACCESS.
 18213*    MOVE 'L'                    TO CNTL-REC-TYPE.
 18214     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 18215     MOVE +0                     TO CNTL-SEQ-NO.
 18216     MOVE '4' TO RC-SW-2.
 18217     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18218
 18219     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18220        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18221        GO TO 6370-NO-LF-FOUND.
 18222
 18223     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 18224     MOVE +1                     TO SUB.
 18225
 18226 6370-SEARCH-LOOP.
 18227     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 18228         GO TO 6370-NO-LF-FOUND.
 18229
 18230     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 331
* EL050.cbl
 18231        if (pb-i-lf-benefit-cd not = zeros and spaces)
 18232           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 18233           set benefit-code-chg to true
 18234        end-if
 18235        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 18236        GO TO 6370-HER-NET-PAY-CHECK.
 18237
 18238     ADD 1   TO SUB.
 18239*    IF SUB GREATER 120
 18240     IF SUB GREATER 200
 18241         GO TO 6370-NO-LF-FOUND.
 18242
 18243     GO TO 6370-SEARCH-LOOP.
 18244
 18245 6370-NO-LF-FOUND.
 18246
 18247     if (pb-i-lf-benefit-cd not = zeros and spaces)
 18248        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 18249        set benefit-code-chg to true
 18250     end-if
 18251     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 18252
 18253 6370-HER-NET-PAY-CHECK.
 18254
 18255     IF PB-COMPANY-ID = 'CID'
 18256        IF PB-SV-STATE = 'CA' OR 'MN'
 18257           IF PB-I-LF-BENEFIT-CD = '02'
 18258              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 18259           ELSE
 18260              IF PB-I-LF-BENEFIT-CD = '04'
 18261                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 18262              END-IF
 18263           END-IF
 18264        END-IF
 18265     END-IF
 18266
 18267     IF PB-COMPANY-ID NOT = 'HER'
 18268         GO TO 6370-EXIT.
 18269
 18270     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 18271         GO TO 6370-EXIT.
 18272
 18273     IF PB-I-LF-TERM NOT NUMERIC
 18274         MOVE ZEROS              TO PB-I-LF-TERM.
 18275
 18276     IF PB-I-LOAN-TERM NOT NUMERIC
 18277         MOVE ZEROS              TO PB-I-LOAN-TERM.
 18278
 18279     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 18280         GO TO 6370-EXIT.
 18281
 18282     IF PB-I-LF-BENEFIT-CD = '33'
 18283         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 18284
 18285     IF PB-I-LF-BENEFIT-CD = '34'
 18286         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 18287
 18288 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 332
* EL050.cbl
 18289     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 333
* EL050.cbl
 18291
 18292 6380-EDIT-INPUT-AH-CODE.
 18293     IF WK-AH-EDIT-ADDR NOT = ZEROS
 18294        MOVE +1                  TO SUB
 18295        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 18296        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18297        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18298        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18299        GO TO 6380-SEARCH-LOOP.
 18300
 18301     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18302
 18303     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18304     MOVE SPACES                 TO CNTL-ACCESS.
 18305     MOVE 'A'                    TO CNTL-REC-TYPE.
 18306*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 18307     MOVE +0                     TO CNTL-SEQ-NO.
 18308     MOVE '5' TO RC-SW-2.
 18309     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18310
 18311     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18312        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18313        GO TO 6380-NO-AH-FOUND.
 18314
 18315     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 18316     MOVE +1 TO SUB.
 18317
 18318 6380-SEARCH-LOOP.
 18319     IF CF-AH-CODE-OUT (SUB) = ZEROS
 18320         GO TO 6380-NO-AH-FOUND.
 18321
 18322     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 18323         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 18324         GO TO 6380-CSO-AH-ONLY-CHECKS.
 18325
 18326     ADD 1   TO SUB.
 18327     IF SUB GREATER THAN 96
 18328*    IF SUB GREATER THAN 300
 18329         GO TO 6380-NO-AH-FOUND.
 18330
 18331     GO TO 6380-SEARCH-LOOP.
 18332
 18333 6380-NO-AH-FOUND.
 18334
 18335     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 18336
 18337     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 18338         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 18339     ELSE
 18340         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 18341
 18342 6380-CSO-AH-ONLY-CHECKS.
 18343
 18344     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 18345        NEXT SENTENCE
 18346      ELSE
 18347        GO TO 6380-EXIT.
 18348
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 334
* EL050.cbl
 18349     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 18350         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 18351
 18352
 18353     GO TO 6380-EXIT
 18354     .
 18355 6380-CSO-LIFE-WITH-AH-CHECKS.
 18356
 18357
 18358     .
 18359 6380-EXIT.
 18360     EXIT.
 18361
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 335
* EL050.cbl
 18363
 18364 6400-COMPUTE-EXTENSION-DAYS.
 18365
 18366******************************************************************
 18367*                                                                *
 18368*                   COMPUTE EXTENSION DAYS                       *
 18369*                                                                *
 18370*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 18371*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 18372*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 18373*    THE EXTENSION DAYS.                                         *
 18374*                                                                *
 18375******************************************************************
 18376
 18377     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 18378     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 18379
 18380******************************************************************
 18381*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 18382*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 18383******************************************************************
 18384
 18385     IF DC-ELAPSED-MONTHS GREATER THAN +0
 18386        COMPUTE WS-ODD-DAYS-OVER =
 18387               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 18388     ELSE
 18389        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 18390
 18391     IF WS-ODD-DAYS-OVER = ZEROS
 18392           GO TO 6499-EXIT
 18393     ELSE
 18394        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 18395           IF WS-WDF-MONTH = 02
 18396              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 18397              ADD 2       TO  WS-ODD-DAYS-OVER
 18398              GO TO 6499-EXIT
 18399           ELSE
 18400              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 18401                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 18402                 GO TO 6499-EXIT
 18403               ELSE
 18404                 GO TO 6499-EXIT
 18405        ELSE
 18406           GO TO 6499-EXIT.
 18407
 18408 6412-CHECK-TO-DAY.
 18409
 18410        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 18411           IF WS-WDT-DAY = 28
 18412              ADD 2              TO WS-ODD-DAYS-OVER
 18413           ELSE
 18414              IF WS-WDT-DAY = 29
 18415                 ADD 1           TO WS-ODD-DAYS-OVER
 18416              ELSE
 18417                 NEXT SENTENCE
 18418        ELSE
 18419           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 18420              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 336
* EL050.cbl
 18421
 18422     GO TO 6499-EXIT.
 18423
 18424
 18425 6415-CHECK-LEAP-YEAR.
 18426
 18427     IF DC-DAYS-IN-MONTH = 29
 18428        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 18429
 18430 6415-EXIT.
 18431     EXIT.
 18432
 18433 6499-EXIT.
 18434      EXIT.
 18435
 18436 6500-END.
 18437     EXIT.
 18438
 18439
 18440******************************************************************
 18441************* PROCEDURE DIVISION FOR EL050 ***********************
 18442********************** ELC50PD END *******************************
 18443
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 337
* EL050.cbl
 18445
 18446**START***********************************************************
 18447*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 18448*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 18449******************************************************************
 18450*
 18451 6600-GET-STATE-MUNICIPAL-TAX.
 18452
 18453     IF PB-COMPANY-ID NOT = 'DMD'
 18454         GO TO 6640-EXIT.
 18455
 18456     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 18457     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 18458     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 18459*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 18460*
 18461***  Y2K PROJ 7744
 18462     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18463     SET BIN-TO-GREG          TO TRUE.
 18464     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18465
 18466     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18467
 18468     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 18469     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 18470
 18471
 18472* EXEC CICS HANDLE CONDITION
 18473*        INVREQ    (6610-START-BROWSE)
 18474*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18475*        NOTFND    (6630-END-OF-FILE)
 18476*    END-EXEC.
 18477*    MOVE '"$8JI                 ! # #00018459' TO DFHEIV0
 18478     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 18479     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18480     MOVE X'2320233030303138343539' TO DFHEIV0(25:11)
 18481     CALL 'kxdfhei1' USING DFHEIV0
 18482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18483
 18484
 18485 6610-START-BROWSE.
 18486
 18487
 18488* EXEC CICS HANDLE CONDITION
 18489*        NOTFND    (6630-END-OF-FILE)
 18490*        DISABLED  (6630-ERRESS-PROBLEM)
 18491*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18492*        ENDFILE   (6630-END-OF-FILE)
 18493*    END-EXEC.
 18494*    MOVE '"$IcJ''                ! $ #00018467' TO DFHEIV0
 18495     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18496     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18497     MOVE X'2420233030303138343637' TO DFHEIV0(25:11)
 18498     CALL 'kxdfhei1' USING DFHEIV0
 18499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18500
 18501
 18502
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 338
* EL050.cbl
 18503* EXEC CICS STARTBR
 18504*        DATASET (FILE-ID-ERRESS)
 18505*        RIDFLD  (WS-ERRESS-KEY)
 18506*        GTEQ
 18507*    END-EXEC.
 18508     MOVE 0
 18509       TO DFHEIV11
 18510*    MOVE '&,         G          &   #00018474' TO DFHEIV0
 18511     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18512     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18513     MOVE X'2020233030303138343734' TO DFHEIV0(25:11)
 18514     CALL 'kxdfhei1' USING DFHEIV0,
 18515           FILE-ID-ERRESS,
 18516           WS-ERRESS-KEY,
 18517           DFHEIV99,
 18518           DFHEIV11,
 18519           DFHEIV99
 18520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18521
 18522
 18523 6620-READ-NEXT-ERRESS-MASTER.
 18524
 18525
 18526* EXEC CICS HANDLE CONDITION
 18527*        NOTFND    (6630-END-OF-FILE)
 18528*        ENDFILE   (6630-END-OF-FILE)
 18529*        DISABLED  (6630-ERRESS-PROBLEM)
 18530*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18531*    END-EXEC.
 18532*    MOVE '"$I''cJ                ! % #00018482' TO DFHEIV0
 18533     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 18534     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18535     MOVE X'2520233030303138343832' TO DFHEIV0(25:11)
 18536     CALL 'kxdfhei1' USING DFHEIV0
 18537     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18538
 18539
 18540
 18541* EXEC CICS READNEXT
 18542*        DATASET (FILE-ID-ERRESS)
 18543*        INTO    (RESIDENT-STATE-TAX-MASTER)
 18544*        RIDFLD  (WS-ERRESS-KEY)
 18545*    END-EXEC.
 18546     MOVE LENGTH OF
 18547      RESIDENT-STATE-TAX-MASTER
 18548       TO DFHEIV12
 18549     MOVE 0
 18550       TO DFHEIV11
 18551*    MOVE '&.IL                  )   #00018489' TO DFHEIV0
 18552     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18553     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18554     MOVE X'2020233030303138343839' TO DFHEIV0(25:11)
 18555     CALL 'kxdfhei1' USING DFHEIV0,
 18556           FILE-ID-ERRESS,
 18557           RESIDENT-STATE-TAX-MASTER,
 18558           DFHEIV12,
 18559           WS-ERRESS-KEY,
 18560           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 339
* EL050.cbl
 18561           DFHEIV11,
 18562           DFHEIV99,
 18563           DFHEIV99
 18564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18565
 18566
 18567     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 18568
 18569* EXEC CICS ENDBR
 18570*            DATASET (FILE-ID-ERRESS)
 18571*       END-EXEC
 18572     MOVE 0
 18573       TO DFHEIV11
 18574*    MOVE '&2                    $   #00018496' TO DFHEIV0
 18575     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18576     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18577     MOVE X'2020233030303138343936' TO DFHEIV0(25:11)
 18578     CALL 'kxdfhei1' USING DFHEIV0,
 18579           FILE-ID-ERRESS,
 18580           DFHEIV11,
 18581           DFHEIV99
 18582     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18583        GO TO 6630-END-OF-FILE.
 18584
 18585     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 18586        NEXT SENTENCE
 18587      ELSE
 18588        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 18589
 18590*IS IT LIFE(1) OR IS IT P&C(2) ?????
 18591*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 18592*
 18593     MOVE +2                     TO WS-SUB1.
 18594
 18595     IF PB-ISSUE
 18596     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 18597        MOVE +1                  TO WS-SUB1.
 18598
 18599     IF PB-CANCELLATION
 18600     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 18601        MOVE +1                  TO WS-SUB1.
 18602*
 18603*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 18604*
 18605***  Y2K PROJ 7744
 18606     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 18607***  Y2K PROJ 7744
 18608
 18609*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 18610* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 18611* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 18612
 18613     ADD 1                    TO WS-YEAR-YY.
 18614
 18615     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 18616         MOVE RES-REN-STATE-TAX (WS-SUB1)
 18617                              TO WS-RES-STATE-TAX
 18618         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 340
* EL050.cbl
 18619                              TO WS-RES-MUNI-TAX
 18620     ELSE
 18621         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 18622                              TO WS-RES-STATE-TAX
 18623         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 18624                              TO WS-RES-MUNI-TAX.
 18625
 18626*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 18627
 18628     IF PB-CANCELLATION
 18629         GO TO 6640-CANCEL-TAX.
 18630
 18631     IF PB-I-LF-PREMIUM-AMT > ZEROS
 18632         COMPUTE PB-I-STATE-TAX ROUNDED =
 18633                                   PB-I-LF-PREMIUM-AMT
 18634                                 * WS-RES-STATE-TAX
 18635         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18636                                   PB-I-LF-PREMIUM-AMT
 18637                                 * WS-RES-MUNI-TAX
 18638     ELSE
 18639     IF PB-I-AH-PREMIUM-AMT > ZEROS
 18640         COMPUTE PB-I-STATE-TAX ROUNDED =
 18641                                   PB-I-AH-PREMIUM-AMT
 18642                                 * WS-RES-STATE-TAX
 18643         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18644                                   PB-I-AH-PREMIUM-AMT
 18645                                 * WS-RES-MUNI-TAX.
 18646
 18647
 18648* EXEC CICS ENDBR
 18649*         DATASET (FILE-ID-ERRESS)
 18650*    END-EXEC.
 18651     MOVE 0
 18652       TO DFHEIV11
 18653*    MOVE '&2                    $   #00018563' TO DFHEIV0
 18654     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18655     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18656     MOVE X'2020233030303138353633' TO DFHEIV0(25:11)
 18657     CALL 'kxdfhei1' USING DFHEIV0,
 18658           FILE-ID-ERRESS,
 18659           DFHEIV11,
 18660           DFHEIV99
 18661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18662
 18663
 18664     GO TO 6640-EXIT.
 18665
 18666 6640-CANCEL-TAX.
 18667     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 18668
 18669     IF PB-C-LF-CANCEL-AMT > ZEROS
 18670         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18671                                   PB-C-LF-CANCEL-AMT
 18672                                 * WS-RES-STATE-TAX
 18673         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18674                                   PB-C-LF-CANCEL-AMT
 18675                                *  WS-RES-MUNI-TAX
 18676     ELSE
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 341
* EL050.cbl
 18677     IF PB-C-AH-CANCEL-AMT > ZEROS
 18678         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18679                                   PB-C-AH-CANCEL-AMT
 18680                                 * WS-RES-STATE-TAX
 18681         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18682                                   PB-C-AH-CANCEL-AMT
 18683                                *  WS-RES-MUNI-TAX.
 18684
 18685
 18686* EXEC CICS ENDBR
 18687*         DATASET (FILE-ID-ERRESS)
 18688*    END-EXEC.
 18689     MOVE 0
 18690       TO DFHEIV11
 18691*    MOVE '&2                    $   #00018588' TO DFHEIV0
 18692     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18693     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18694     MOVE X'2020233030303138353838' TO DFHEIV0(25:11)
 18695     CALL 'kxdfhei1' USING DFHEIV0,
 18696           FILE-ID-ERRESS,
 18697           DFHEIV11,
 18698           DFHEIV99
 18699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18700
 18701
 18702     GO TO 6640-EXIT.
 18703
 18704 6630-END-OF-FILE.
 18705     MOVE ER-8002              TO WS-ERROR.
 18706     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18707
 18708     GO TO 6640-EXIT.
 18709
 18710 6630-ERRESS-PROBLEM.
 18711     MOVE ER-8044              TO WS-ERROR.
 18712     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18713
 18714 6640-EXIT.
 18715     EXIT.
 18716
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 342
* EL050.cbl
 18718 6650-GET-RES-STATE-COMM.
 18719
 18720     IF PB-COMPANY-ID NOT = 'DMD'
 18721         GO TO 6700-COMM-EXIT.
 18722
 18723     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 18724     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 18725     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 18726     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 18727     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 18728     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 18729     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 18730
 18731*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 18732*
 18733***  Y2K PROJ 7744
 18734     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18735     SET BIN-TO-GREG          TO TRUE.
 18736     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18737
 18738     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18739***  Y2K PROJ 7744
 18740
 18741     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 18742
 18743
 18744* EXEC CICS HANDLE CONDITION
 18745*        INVREQ    (6660-START-BROWSE)
 18746*        DISABLED  (6690-ERRESC-PROBLEM)
 18747*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18748*        NOTFND    (6690-END-OF-FILE)
 18749*    END-EXEC.
 18750*    MOVE '"$8cJI                ! & #00018633' TO DFHEIV0
 18751     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 18752     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18753     MOVE X'2620233030303138363333' TO DFHEIV0(25:11)
 18754     CALL 'kxdfhei1' USING DFHEIV0
 18755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18756
 18757
 18758
 18759* EXEC CICS RESETBR
 18760*        DATASET (FILE-ID-ERRESC)
 18761*        RIDFLD  (WS-ERRESC-KEY)
 18762*    END-EXEC.
 18763     MOVE 0
 18764       TO DFHEIV11
 18765*    MOVE '&4         G          &   #00018640' TO DFHEIV0
 18766     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18767     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18768     MOVE X'2020233030303138363430' TO DFHEIV0(25:11)
 18769     CALL 'kxdfhei1' USING DFHEIV0,
 18770           FILE-ID-ERRESC,
 18771           WS-ERRESC-KEY,
 18772           DFHEIV99,
 18773           DFHEIV11,
 18774           DFHEIV99
 18775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 343
* EL050.cbl
 18776
 18777
 18778 6660-START-BROWSE.
 18779
 18780
 18781* EXEC CICS HANDLE CONDITION
 18782*        NOTFND    (6690-END-OF-FILE)
 18783*        DISABLED  (6690-ERRESC-PROBLEM)
 18784*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18785*        ENDFILE   (6690-END-OF-FILE)
 18786*    END-EXEC.
 18787*    MOVE '"$IcJ''                ! '' #00018647' TO DFHEIV0
 18788     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18789     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18790     MOVE X'2720233030303138363437' TO DFHEIV0(25:11)
 18791     CALL 'kxdfhei1' USING DFHEIV0
 18792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18793
 18794
 18795
 18796* EXEC CICS STARTBR
 18797*        DATASET (FILE-ID-ERRESC)
 18798*        RIDFLD  (WS-ERRESC-KEY)
 18799*        GTEQ
 18800*    END-EXEC.
 18801     MOVE 0
 18802       TO DFHEIV11
 18803*    MOVE '&,         G          &   #00018654' TO DFHEIV0
 18804     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18805     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18806     MOVE X'2020233030303138363534' TO DFHEIV0(25:11)
 18807     CALL 'kxdfhei1' USING DFHEIV0,
 18808           FILE-ID-ERRESC,
 18809           WS-ERRESC-KEY,
 18810           DFHEIV99,
 18811           DFHEIV11,
 18812           DFHEIV99
 18813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18814
 18815
 18816     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 18817
 18818 6670-READ-NEXT-ERRESC-MASTER.
 18819
 18820
 18821* EXEC CICS HANDLE CONDITION
 18822*        NOTFND    (6690-END-OF-FILE)
 18823*        DISABLED  (6690-ERRESC-PROBLEM)
 18824*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18825*        ENDFILE   (6690-END-OF-FILE)
 18826*    END-EXEC.
 18827*    MOVE '"$IcJ''                ! ( #00018664' TO DFHEIV0
 18828     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18829     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18830     MOVE X'2820233030303138363634' TO DFHEIV0(25:11)
 18831     CALL 'kxdfhei1' USING DFHEIV0
 18832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18833
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 344
* EL050.cbl
 18834
 18835
 18836* EXEC CICS READNEXT
 18837*        DATASET (FILE-ID-ERRESC)
 18838*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18839*        RIDFLD  (ERRESC-RECORD-KEY)
 18840*    END-EXEC.
 18841     MOVE LENGTH OF
 18842      ACCOUNT-RESIDENT-ST-COMMISSION
 18843       TO DFHEIV12
 18844     MOVE 0
 18845       TO DFHEIV11
 18846*    MOVE '&.IL                  )   #00018671' TO DFHEIV0
 18847     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18848     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18849     MOVE X'2020233030303138363731' TO DFHEIV0(25:11)
 18850     CALL 'kxdfhei1' USING DFHEIV0,
 18851           FILE-ID-ERRESC,
 18852           ACCOUNT-RESIDENT-ST-COMMISSION,
 18853           DFHEIV12,
 18854           ERRESC-RECORD-KEY,
 18855           DFHEIV99,
 18856           DFHEIV11,
 18857           DFHEIV99,
 18858           DFHEIV99
 18859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18860
 18861
 18862     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18863        NEXT SENTENCE
 18864     ELSE
 18865
 18866* EXEC CICS ENDBR
 18867*            DATASET (FILE-ID-ERRESC)
 18868*       END-EXEC
 18869     MOVE 0
 18870       TO DFHEIV11
 18871*    MOVE '&2                    $   #00018680' TO DFHEIV0
 18872     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18873     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18874     MOVE X'2020233030303138363830' TO DFHEIV0(25:11)
 18875     CALL 'kxdfhei1' USING DFHEIV0,
 18876           FILE-ID-ERRESC,
 18877           DFHEIV11,
 18878           DFHEIV99
 18879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18880        GO TO 6690-END-OF-FILE.
 18881
 18882     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18883
 18884* EXEC CICS ENDBR
 18885*            DATASET (FILE-ID-ERRESC)
 18886*       END-EXEC
 18887     MOVE 0
 18888       TO DFHEIV11
 18889*    MOVE '&2                    $   #00018686' TO DFHEIV0
 18890     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18891     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 345
* EL050.cbl
 18892     MOVE X'2020233030303138363836' TO DFHEIV0(25:11)
 18893     CALL 'kxdfhei1' USING DFHEIV0,
 18894           FILE-ID-ERRESC,
 18895           DFHEIV11,
 18896           DFHEIV99
 18897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18898        GO TO 6690-END-OF-FILE.
 18899
 18900     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18901        NEXT SENTENCE
 18902      ELSE
 18903        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18904
 18905* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18906*
 18907     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18908
 18909     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18910
 18911     IF WS-SUB1 > ZERO
 18912         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18913             PERFORM 6680-SET-COMMISSION
 18914         ELSE
 18915             PERFORM 6680-SET-TABLE-CODE.
 18916
 18917
 18918* EXEC CICS ENDBR
 18919*         DATASET (FILE-ID-ERRESC)
 18920*    END-EXEC.
 18921     MOVE 0
 18922       TO DFHEIV11
 18923*    MOVE '&2                    $   #00018708' TO DFHEIV0
 18924     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18925     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18926     MOVE X'2020233030303138373038' TO DFHEIV0(25:11)
 18927     CALL 'kxdfhei1' USING DFHEIV0,
 18928           FILE-ID-ERRESC,
 18929           DFHEIV11,
 18930           DFHEIV99
 18931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18932
 18933
 18934     GO TO 6700-COMM-EXIT.
 18935
 18936 6680-SET-TABLE-CODE.
 18937     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18938        MOVE ZEROS             TO WS-SUB1
 18939     ELSE
 18940* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18941* TO COMPUTE AH COMMISSION.
 18942        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18943        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18944        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18945        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18946        PERFORM 6680-READ-CTBL-TABLE
 18947        IF WS-CTBL-READ-SW NOT = 'Y'
 18948           MOVE ZEROS          TO WS-SUB1.
 18949
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 346
* EL050.cbl
 18950 6680-READ-CTBL-TABLE.
 18951*
 18952* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18953* TO COMPUTE LIFE COMMISSION
 18954
 18955     IF CTBL-SW = '0540'
 18956        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18957        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18958        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18959
 18960     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18961
 18962     IF CTBL-TABLE-FOUND
 18963        IF CTBL-SW = '0530'
 18964             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18965                                    * PB-I-AH-TERM
 18966             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18967             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18968        ELSE
 18969             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18970             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18971             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18972     ELSE
 18973        IF FIRST-TIME-THROUGH
 18974            GO TO 6680-READ-CTBL-TABLE
 18975        ELSE
 18976            MOVE ZEROS         TO WS-SUB1.
 18977
 18978 6680-SET-COMMISSION.
 18979     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18980           MOVE ZEROS          TO WS-SUB1
 18981       ELSE
 18982           MOVE RESC-COMMISSION-PER (WS-SUB)
 18983                               TO WS-COMMISSION
 18984           IF CTBL-SW = '0530'
 18985               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18986           ELSE
 18987               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18988
 18989 6680-SEARCH-CATEGORY.
 18990     ADD +1                   TO WS-SUB.
 18991     IF WS-SUB > +12
 18992         GO TO 6680-EXIT.
 18993
 18994     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18995          MOVE WS-SUB         TO WS-SUB1
 18996          GO TO 6680-EXIT.
 18997
 18998     GO TO 6680-SEARCH-CATEGORY.
 18999
 19000 6680-EXIT.
 19001     EXIT.
 19002
 19003 6690-END-OF-FILE.
 19004     GO TO 6700-COMM-EXIT.
 19005
 19006 6690-ERRESC-PROBLEM.
 19007      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 347
* EL050.cbl
 19008      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19009
 19010      GO TO 6700-COMM-EXIT.
 19011
 19012 6700-COMM-EXIT.
 19013     EXIT.
 19014
 19015 7000-GET-RATE.
 19016
 19017* EXEC CICS LINK
 19018*        PROGRAM    ('ELRATE')
 19019*        COMMAREA   (CALCULATION-PASS-AREA)
 19020*        LENGTH     (CP-COMM-LENGTH)
 19021*    END-EXEC.
 19022     MOVE 'ELRATE' TO DFHEIV1
 19023*    MOVE '."C                   (   #00018794' TO DFHEIV0
 19024     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19025     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19026     MOVE X'2020233030303138373934' TO DFHEIV0(25:11)
 19027     CALL 'kxdfhei1' USING DFHEIV0,
 19028           DFHEIV1,
 19029           CALCULATION-PASS-AREA,
 19030           CP-COMM-LENGTH,
 19031           DFHEIV99,
 19032           DFHEIV99,
 19033           DFHEIV99,
 19034           DFHEIV99
 19035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19036
 19037
 19038 7000-EXIT.
 19039     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 348
* EL050.cbl
 19041 7100-FIND-BENEFIT-IN-STATE.
 19042     MOVE 'N'                    TO BEN-SEARCH-SW.
 19043
 19044     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 19045         VARYING SUB3 FROM 1 BY 1 UNTIL
 19046            ((SUB3 GREATER 50) OR
 19047              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 19048               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 19049
 19050     IF SUB3 NOT = 51
 19051         MOVE 'Y'                TO BEN-SEARCH-SW.
 19052
 19053     GO TO 7199-EXIT.
 19054
 19055 7100-BENEFIT-DUMMY.
 19056
 19057 7100-DUMMY-EXIT.
 19058     EXIT.
 19059
 19060 7199-EXIT.
 19061     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 349
* EL050.cbl
 19063 7200-FIND-BENEFIT.
 19064     MOVE 'N'                    TO BEN-SEARCH-SW.
 19065
 19066     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 19067         VARYING SUB3 FROM 1 BY 1 UNTIL
 19068            ((SUB3 GREATER 8) OR
 19069            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 19070
 19071     IF SUB3 NOT = 9
 19072         MOVE 'Y'                TO BEN-SEARCH-SW.
 19073
 19074     GO TO 7200-EXIT.
 19075
 19076 7200-BENEFIT-DUMMY.
 19077
 19078 7200-DUMMY-EXIT.
 19079     EXIT.
 19080
 19081 7200-EXIT.
 19082     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 350
* EL050.cbl
 19084 7250-LOOK-FOR-RESCINDED-CLAIM.
 19085     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19086                                    W-CL-COMP-CD.
 19087     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19088                                    W-CL-CERT-NO.
 19089
 19090
 19091* EXEC CICS HANDLE CONDITION
 19092*        NOTFND  (7250-CONTINUE)
 19093*        ENDFILE (7250-CONTINUE)
 19094*    END-EXEC.
 19095*    MOVE '"$I''                  ! ) #00018852' TO DFHEIV0
 19096     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19097     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19098     MOVE X'2920233030303138383532' TO DFHEIV0(25:11)
 19099     CALL 'kxdfhei1' USING DFHEIV0
 19100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19101
 19102
 19103
 19104* EXEC CICS IGNORE CONDITION
 19105*        DUPKEY
 19106*    END-EXEC.
 19107*    MOVE '"*$                   !   #00018857' TO DFHEIV0
 19108     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19109     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19110     MOVE X'2020233030303138383537' TO DFHEIV0(25:11)
 19111     CALL 'kxdfhei1' USING DFHEIV0
 19112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19113
 19114
 19115
 19116* EXEC CICS STARTBR
 19117*        DATASET   (CLMS-ID)
 19118*        RIDFLD    (ELMSTR-KEY)
 19119*        GENERIC   EQUAL
 19120*        KEYLENGTH (ELMSTR-LENGTH)
 19121*    END-EXEC.
 19122     MOVE 0
 19123       TO DFHEIV11
 19124*    MOVE '&,   KG    E          &   #00018861' TO DFHEIV0
 19125     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19126     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19127     MOVE X'2020233030303138383631' TO DFHEIV0(25:11)
 19128     CALL 'kxdfhei1' USING DFHEIV0,
 19129           CLMS-ID,
 19130           ELMSTR-KEY,
 19131           ELMSTR-LENGTH,
 19132           DFHEIV11,
 19133           DFHEIV99
 19134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19135
 19136
 19137     MOVE 'Y'                    TO W-BROWSE-SW.
 19138
 19139 7250-NEXT-CLAIM.
 19140
 19141
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 351
* EL050.cbl
 19142* EXEC CICS READNEXT
 19143*        DATASET   (CLMS-ID)
 19144*        RIDFLD    (ELMSTR-KEY)
 19145*        SET       (ADDRESS OF CLAIM-MASTER)
 19146*    END-EXEC.
 19147     MOVE 0
 19148       TO DFHEIV11
 19149*    MOVE '&.S                   )   #00018872' TO DFHEIV0
 19150     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19151     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19152     MOVE X'2020233030303138383732' TO DFHEIV0(25:11)
 19153     CALL 'kxdfhei1' USING DFHEIV0,
 19154           CLMS-ID,
 19155           DFHEIV20,
 19156           DFHEIV99,
 19157           ELMSTR-KEY,
 19158           DFHEIV99,
 19159           DFHEIV11,
 19160           DFHEIV99,
 19161           DFHEIV99
 19162     SET ADDRESS OF CLAIM-MASTER TO
 19163         DFHEIV20
 19164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19165
 19166
 19167     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19168        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19169         GO TO 7250-CONTINUE
 19170     END-IF.
 19171
 19172     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19173        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19174        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19175        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19176        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19177         GO TO 7250-NEXT-CLAIM
 19178     END-IF.
 19179
 19180     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19181        OR (CL-CLAIM-TYPE = 'I')
 19182        OR (CL-CLAIM-TYPE = 'G')
 19183        OR (CL-CLAIM-TYPE = 'F')
 19184          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19185              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 19186              GO TO 7250-CONTINUE
 19187          END-IF
 19188     END-IF.
 19189
 19190     GO TO 7250-NEXT-CLAIM.
 19191
 19192 7250-CONTINUE.
 19193
 19194     IF W-BROWSE-SW = 'Y'
 19195
 19196* EXEC CICS ENDBR
 19197*            DATASET   (CLMS-ID)
 19198*        END-EXEC
 19199     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 352
* EL050.cbl
 19200       TO DFHEIV11
 19201*    MOVE '&2                    $   #00018906' TO DFHEIV0
 19202     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19203     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19204     MOVE X'2020233030303138393036' TO DFHEIV0(25:11)
 19205     CALL 'kxdfhei1' USING DFHEIV0,
 19206           CLMS-ID,
 19207           DFHEIV11,
 19208           DFHEIV99
 19209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19210         MOVE 'N' TO W-BROWSE-SW
 19211     END-IF.
 19212
 19213 7250-EXIT.
 19214     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 353
* EL050.cbl
 19216 7300-CHECK-FOR-OPEN-CLMS.
 19217
 19218*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 19219*    MOVE SPACES                 TO CNTL-ACCESS.
 19220*    MOVE '1'                    TO CNTL-REC-TYPE.
 19221*    MOVE +0                     TO CNTL-SEQ-NO.
 19222
 19223*    MOVE '3'                    TO RC-SW-1.
 19224*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 19225
 19226*    IF NOT CF-COMPANY-MASTER
 19227*         PERFORM 0099-COMPANY-NOT-FOUND
 19228*         GO TO 7300-EXIT.
 19229
 19230     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19231                                    W-CL-COMP-CD.
 19232     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19233                                    W-CL-CERT-NO.
 19234
 19235
 19236* EXEC CICS HANDLE CONDITION
 19237*        NOTFND  (7300-CONTINUE)
 19238*        ENDFILE (7300-CONTINUE)
 19239*    END-EXEC.
 19240*    MOVE '"$I''                  ! * #00018934' TO DFHEIV0
 19241     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19242     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19243     MOVE X'2A20233030303138393334' TO DFHEIV0(25:11)
 19244     CALL 'kxdfhei1' USING DFHEIV0
 19245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19246
 19247
 19248
 19249* EXEC CICS IGNORE CONDITION
 19250*        DUPKEY
 19251*    END-EXEC.
 19252*    MOVE '"*$                   !   #00018939' TO DFHEIV0
 19253     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19254     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19255     MOVE X'2020233030303138393339' TO DFHEIV0(25:11)
 19256     CALL 'kxdfhei1' USING DFHEIV0
 19257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19258
 19259
 19260
 19261* EXEC CICS STARTBR
 19262*        DATASET   (CLMS-ID)
 19263*        RIDFLD    (ELMSTR-KEY)
 19264*        GENERIC   EQUAL
 19265*        KEYLENGTH (ELMSTR-LENGTH)
 19266*    END-EXEC.
 19267     MOVE 0
 19268       TO DFHEIV11
 19269*    MOVE '&,   KG    E          &   #00018943' TO DFHEIV0
 19270     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19271     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19272     MOVE X'2020233030303138393433' TO DFHEIV0(25:11)
 19273     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 354
* EL050.cbl
 19274           CLMS-ID,
 19275           ELMSTR-KEY,
 19276           ELMSTR-LENGTH,
 19277           DFHEIV11,
 19278           DFHEIV99
 19279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19280
 19281
 19282     MOVE 'Y'                    TO W-BROWSE-SW.
 19283
 19284 7300-NEXT-CLAIM.
 19285
 19286
 19287* EXEC CICS READNEXT
 19288*        DATASET   (CLMS-ID)
 19289*        RIDFLD    (ELMSTR-KEY)
 19290*        SET       (ADDRESS OF CLAIM-MASTER)
 19291*    END-EXEC.
 19292     MOVE 0
 19293       TO DFHEIV11
 19294*    MOVE '&.S                   )   #00018954' TO DFHEIV0
 19295     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19296     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19297     MOVE X'2020233030303138393534' TO DFHEIV0(25:11)
 19298     CALL 'kxdfhei1' USING DFHEIV0,
 19299           CLMS-ID,
 19300           DFHEIV20,
 19301           DFHEIV99,
 19302           ELMSTR-KEY,
 19303           DFHEIV99,
 19304           DFHEIV11,
 19305           DFHEIV99,
 19306           DFHEIV99
 19307     SET ADDRESS OF CLAIM-MASTER TO
 19308         DFHEIV20
 19309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19310
 19311
 19312     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19313        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19314         GO TO 7300-CONTINUE.
 19315
 19316     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19317        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19318        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19319        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19320        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19321         GO TO 7300-NEXT-CLAIM.
 19322
 19323*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 19324     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19325        OR (CL-CLAIM-TYPE = 'I')
 19326        OR (CL-CLAIM-TYPE = 'G')
 19327        OR (CL-CLAIM-TYPE = 'F')
 19328        IF CLAIM-IS-OPEN
 19329           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19330             AND PB-C-AH-CANCEL-DT > SPACES
 19331              MOVE ER-2896        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 355
* EL050.cbl
 19332              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19333           END-IF
 19334           EVALUATE TRUE
 19335             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 19336                 MOVE ER-2884      TO WS-ERROR
 19337             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 19338                 MOVE ER-2887      TO WS-ERROR
 19339             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 19340                 MOVE ER-2886      TO WS-ERROR
 19341             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 19342                 MOVE ER-2888      TO WS-ERROR
 19343             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 19344                 MOVE ER-2885      TO WS-ERROR
 19345             WHEN OTHER
 19346                 MOVE ER-2768      TO WS-ERROR
 19347           END-EVALUATE
 19348           IF PB-C-AH-CANCEL-VOIDED OR
 19349              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19350                NOT AH-COVERAGE-CANCELLED)
 19351               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19352               MOVE ER-2768      TO WS-ERROR
 19353           END-IF
 19354           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19355           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19356              PB-FORCE-CODE NOT EQUAL '8'
 19357               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19358           END-IF
 19359           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 19360           GO TO 7300-NEXT-CLAIM
 19361        ELSE
 19362           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19363*****THIS IS A RESCISSION OR REFORMATION
 19364              IF AH-COVERAGE-CANCELLED
 19365                 IF WS-ST-CAUSAL-STATE = ('A' OR 'B')
 19366                    MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 19367                    MOVE 1                   TO DC-ELAPSED-DAYS
 19368                    MOVE ZERO                TO DC-ELAPSED-MONTHS
 19369                    SET BIN-PLUS-ELAPSED     TO TRUE
 19370                    PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 19371                    IF NO-CONVERSION-ERROR
 19372                       IF NOT (DC-BIN-DATE-2 = PB-C-AH-CANCEL-DT
 19373                        OR PB-C-AH-CANCEL-DT = CL-CERT-EFF-DT)
 19374                          MOVE ER-2897 TO WS-ERROR
 19375                          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19376                          GO TO 7300-NEXT-CLAIM
 19377                       END-IF
 19378                    END-IF
 19379                 ELSE
 19380                   IF PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT
 19381                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19382                         MOVE ER-2890 TO WS-ERROR
 19383                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19384                         GO TO 7300-NEXT-CLAIM
 19385                      ELSE
 19386                         MOVE ER-2898 TO WS-ERROR
 19387                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19388                         GO TO 7300-NEXT-CLAIM
 19389                      END-IF
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 356
* EL050.cbl
 19390                   END-IF
 19391                 END-IF
 19392              END-IF
 19393           ELSE
 19394              IF CL-DENIAL-TYPE = '1'  AND
 19395                 CL-TOTAL-PAID-AMT = 0
 19396                    GO TO 7300-NEXT-CLAIM
 19397              END-IF
 19398              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19399               AND PB-C-AH-CANCEL-DT > SPACES
 19400                 MOVE ER-2756        TO WS-ERROR
 19401                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19402                 GO TO 7300-NEXT-CLAIM
 19403              END-IF
 19404           END-IF
 19405        END-IF
 19406     ELSE
 19407*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 19408        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 19409           IF (CLAIM-IS-OPEN)
 19410              and ((pb-ci-lf-cancel-amt + pb-c-lf-cancel-amt)
 19411                 <> zeros
 19412              or (pb-ci-ah-cancel-amt + pb-c-ah-cancel-amt)
 19413                 <> zeros)
 19414              MOVE ER-2889      TO WS-ERROR
 19415              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19416              GO TO 7300-NEXT-CLAIM
 19417           ELSE
 19418              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19419*****THIS IS A RESCISSION OR REFORMATION or refor to rescission
 19420                 IF (LF-COVERAGE-CANCELLED AND
 19421                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 19422                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19423                         MOVE ER-2890 TO WS-ERROR
 19424                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19425                         GO TO 7300-NEXT-CLAIM
 19426                      ELSE
 19427                         MOVE ER-2898 TO WS-ERROR
 19428                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19429                         GO TO 7300-NEXT-CLAIM
 19430                      END-IF
 19431                 END-IF
 19432              ELSE
 19433                 IF (CL-DENIAL-TYPE = '1')   *> regular denial
 19434                    and (CL-TOTAL-PAID-AMT = 0)
 19435                    GO TO 7300-NEXT-CLAIM
 19436                 END-IF
 19437                 IF (
 19438                      (AH-COVERAGE-CANCELLED)
 19439                      AND (PB-C-AH-CANCEL-DT <> CL-INCURRED-DT)
 19440                      AND (WS-AH-CLAIM-RESCINDED <> 'Y')
 19441                      and (pb-ci-ah-cancel-amt +
 19442                         pb-c-ah-cancel-amt) <> zeros
 19443                    )
 19444                               OR
 19445                    (
 19446                      (LF-COVERAGE-CANCELLED)
 19447                      AND (PB-C-LF-CANCEL-DT <> CL-INCURRED-DT)
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 357
* EL050.cbl
 19448                      AND (WS-ST-REFUND-CLAIM-FLAG = '4')
 19449                      and (pb-ci-lf-cancel-amt +
 19450                         pb-c-lf-cancel-amt) <> zeros
 19451                    )
 19452                       MOVE ER-2965 TO WS-ERROR
 19453                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19454                       GO TO 7300-NEXT-CLAIM
 19455                 END-IF
 19456                 IF LF-COVERAGE-CANCELLED
 19457                  IF CL-TOTAL-PAID-AMT > 0
 19458                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 19459                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 19460                        MOVE ER-2891 TO WS-ERROR
 19461                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19462                        GO TO 7300-NEXT-CLAIM
 19463                      END-IF
 19464                    ELSE
 19465****only show this error if cert num matches exactly
 19466                      IF PB-CERT-NO = CL-CERT-NO
 19467                         MOVE ER-2892 TO WS-ERROR
 19468                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19469                         GO TO 7300-NEXT-CLAIM
 19470                      END-IF
 19471                    END-IF
 19472                  END-IF
 19473                 END-IF
 19474              END-IF
 19475           END-IF
 19476        END-IF
 19477     END-IF
 19478
 19479     GO TO 7300-NEXT-CLAIM.
 19480
 19481 7300-CONTINUE.
 19482
 19483     IF W-BROWSE-SW = 'Y'
 19484
 19485* EXEC CICS ENDBR
 19486*            DATASET   (CLMS-ID)
 19487*        END-EXEC.
 19488     MOVE 0
 19489       TO DFHEIV11
 19490*    MOVE '&2                    $   #00019132' TO DFHEIV0
 19491     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19492     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19493     MOVE X'2020233030303139313332' TO DFHEIV0(25:11)
 19494     CALL 'kxdfhei1' USING DFHEIV0,
 19495           CLMS-ID,
 19496           DFHEIV11,
 19497           DFHEIV99
 19498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19499
 19500
 19501 7300-EXIT.
 19502     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 358
* EL050.cbl
 19504
 19505 7400-GET-REMAIN-TERM.
 19506
 19507* EXEC CICS LINK
 19508*        PROGRAM    ('ELRTRM')
 19509*        COMMAREA   (CALCULATION-PASS-AREA)
 19510*        LENGTH     (CP-COMM-LENGTH)
 19511*    END-EXEC.
 19512     MOVE 'ELRTRM' TO DFHEIV1
 19513*    MOVE '."C                   (   #00019141' TO DFHEIV0
 19514     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19515     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19516     MOVE X'2020233030303139313431' TO DFHEIV0(25:11)
 19517     CALL 'kxdfhei1' USING DFHEIV0,
 19518           DFHEIV1,
 19519           CALCULATION-PASS-AREA,
 19520           CP-COMM-LENGTH,
 19521           DFHEIV99,
 19522           DFHEIV99,
 19523           DFHEIV99,
 19524           DFHEIV99
 19525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19526
 19527
 19528 7400-EXIT.
 19529     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 359
* EL050.cbl
 19531
 19532 7500-GET-REMAIN-AMOUNT.
 19533
 19534* EXEC CICS LINK
 19535*        PROGRAM    ('ELRAMT')
 19536*        COMMAREA   (CALCULATION-PASS-AREA)
 19537*        LENGTH     (CP-COMM-LENGTH)
 19538*    END-EXEC.
 19539     MOVE 'ELRAMT' TO DFHEIV1
 19540*    MOVE '."C                   (   #00019152' TO DFHEIV0
 19541     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19542     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19543     MOVE X'2020233030303139313532' TO DFHEIV0(25:11)
 19544     CALL 'kxdfhei1' USING DFHEIV0,
 19545           DFHEIV1,
 19546           CALCULATION-PASS-AREA,
 19547           CP-COMM-LENGTH,
 19548           DFHEIV99,
 19549           DFHEIV99,
 19550           DFHEIV99,
 19551           DFHEIV99
 19552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19553
 19554
 19555 7500-EXIT.
 19556     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 360
* EL050.cbl
 19558
 19559 7600-GET-REFUND.
 19560
 19561* EXEC CICS LINK
 19562*        PROGRAM    ('ELRFND')
 19563*        COMMAREA   (CALCULATION-PASS-AREA)
 19564*        LENGTH     (CP-COMM-LENGTH)
 19565*    END-EXEC.
 19566     MOVE 'ELRFND' TO DFHEIV1
 19567*    MOVE '."C                   (   #00019163' TO DFHEIV0
 19568     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19569     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19570     MOVE X'2020233030303139313633' TO DFHEIV0(25:11)
 19571     CALL 'kxdfhei1' USING DFHEIV0,
 19572           DFHEIV1,
 19573           CALCULATION-PASS-AREA,
 19574           CP-COMM-LENGTH,
 19575           DFHEIV99,
 19576           DFHEIV99,
 19577           DFHEIV99,
 19578           DFHEIV99
 19579     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19580
 19581
 19582 7600-EXIT.
 19583     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 361
* EL050.cbl
 19585 7700-CALL-DL1.
 19586
 19587* EXEC CICS LINK
 19588*        PROGRAM    ('DLO001')
 19589*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 19590*        LENGTH     (DLO001-COMM-LENGTH)
 19591*    END-EXEC.
 19592     MOVE 'DLO001' TO DFHEIV1
 19593*    MOVE '."C                   (   #00019173' TO DFHEIV0
 19594     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19595     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19596     MOVE X'2020233030303139313733' TO DFHEIV0(25:11)
 19597     CALL 'kxdfhei1' USING DFHEIV0,
 19598           DFHEIV1,
 19599           WS-DLO-MASTER-POLICY-FORM,
 19600           DLO001-COMM-LENGTH,
 19601           DFHEIV99,
 19602           DFHEIV99,
 19603           DFHEIV99,
 19604           DFHEIV99
 19605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19606
 19607
 19608 7700-EXIT.
 19609     EXIT.
 19610
 19611 7710-CALL-DL2.
 19612
 19613* EXEC CICS LINK
 19614*        PROGRAM    ('DLO002')
 19615*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 19616*        LENGTH     (DLO002-COMM-LENGTH)
 19617*    END-EXEC.
 19618     MOVE 'DLO002' TO DFHEIV1
 19619*    MOVE '."C                   (   #00019183' TO DFHEIV0
 19620     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19621     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19622     MOVE X'2020233030303139313833' TO DFHEIV0(25:11)
 19623     CALL 'kxdfhei1' USING DFHEIV0,
 19624           DFHEIV1,
 19625           WS-DLO-INTERNAL-POLICY-FORM,
 19626           DLO002-COMM-LENGTH,
 19627           DFHEIV99,
 19628           DFHEIV99,
 19629           DFHEIV99,
 19630           DFHEIV99
 19631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19632
 19633
 19634 7710-EXIT.
 19635     EXIT.
 19636
 19637 7720-CALL-DL3.
 19638
 19639* EXEC CICS LINK
 19640*        PROGRAM    ('DLO003')
 19641*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 19642*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 362
* EL050.cbl
 19643*    END-EXEC.
 19644     MOVE 'DLO003' TO DFHEIV1
 19645*    MOVE '."C                   (   #00019193' TO DFHEIV0
 19646     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19647     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19648     MOVE X'2020233030303139313933' TO DFHEIV0(25:11)
 19649     CALL 'kxdfhei1' USING DFHEIV0,
 19650           DFHEIV1,
 19651           WS-DLO-VALID-BANK-ID,
 19652           DLO003-COMM-LENGTH,
 19653           DFHEIV99,
 19654           DFHEIV99,
 19655           DFHEIV99,
 19656           DFHEIV99
 19657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19658
 19659
 19660 7720-EXIT.
 19661     EXIT.
 19662
 19663 7730-CALL-DL7.
 19664
 19665* EXEC CICS LINK
 19666*        PROGRAM    ('DLO007')
 19667*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 19668*        LENGTH     (DLO007-COMM-LENGTH)
 19669*    END-EXEC.
 19670     MOVE 'DLO007' TO DFHEIV1
 19671*    MOVE '."C                   (   #00019203' TO DFHEIV0
 19672     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19673     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19674     MOVE X'2020233030303139323033' TO DFHEIV0(25:11)
 19675     CALL 'kxdfhei1' USING DFHEIV0,
 19676           DFHEIV1,
 19677           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 19678           DLO007-COMM-LENGTH,
 19679           DFHEIV99,
 19680           DFHEIV99,
 19681           DFHEIV99,
 19682           DFHEIV99
 19683     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19684
 19685
 19686 7730-EXIT.
 19687     EXIT.
 19688
 19689 7740-CALL-DL11.
 19690
 19691* EXEC CICS LINK
 19692*        PROGRAM    ('DLO011')
 19693*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 19694*        LENGTH     (DLO011-COMM-LENGTH)
 19695*    END-EXEC.
 19696     MOVE 'DLO011' TO DFHEIV1
 19697*    MOVE '."C                   (   #00019213' TO DFHEIV0
 19698     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19699     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19700     MOVE X'2020233030303139323133' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 363
* EL050.cbl
 19701     CALL 'kxdfhei1' USING DFHEIV0,
 19702           DFHEIV1,
 19703           WS-DLO-PREM-RATES-BEN-TYPE,
 19704           DLO011-COMM-LENGTH,
 19705           DFHEIV99,
 19706           DFHEIV99,
 19707           DFHEIV99,
 19708           DFHEIV99
 19709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19710
 19711
 19712 7740-EXIT.
 19713     EXIT.
 19714
 19715 7750-CALL-DL17.
 19716
 19717* EXEC CICS LINK
 19718*        PROGRAM    ('DLO017')
 19719*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 19720*        LENGTH     (DLO017-COMM-LENGTH)
 19721*    END-EXEC.
 19722     MOVE 'DLO017' TO DFHEIV1
 19723*    MOVE '."C                   (   #00019223' TO DFHEIV0
 19724     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19725     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19726     MOVE X'2020233030303139323233' TO DFHEIV0(25:11)
 19727     CALL 'kxdfhei1' USING DFHEIV0,
 19728           DFHEIV1,
 19729           WS-DLO-VALID-RATE-CODE,
 19730           DLO017-COMM-LENGTH,
 19731           DFHEIV99,
 19732           DFHEIV99,
 19733           DFHEIV99,
 19734           DFHEIV99
 19735     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19736
 19737
 19738 7750-EXIT.
 19739     EXIT.
 19740
 19741 7755-CALL-DL19.
 19742
 19743* EXEC CICS LINK
 19744*        PROGRAM    ('DLO019')
 19745*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 19746*        LENGTH     (DLO019-COMM-LENGTH)
 19747*    END-EXEC.
 19748     MOVE 'DLO019' TO DFHEIV1
 19749*    MOVE '."C                   (   #00019233' TO DFHEIV0
 19750     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19751     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19752     MOVE X'2020233030303139323333' TO DFHEIV0(25:11)
 19753     CALL 'kxdfhei1' USING DFHEIV0,
 19754           DFHEIV1,
 19755           WS-DLO-ORIG-COV-CAT,
 19756           DLO019-COMM-LENGTH,
 19757           DFHEIV99,
 19758           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 364
* EL050.cbl
 19759           DFHEIV99,
 19760           DFHEIV99
 19761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19762
 19763
 19764 7755-EXIT.
 19765     EXIT.
 19766
 19767 7760-CALL-DL21.
 19768
 19769* EXEC CICS LINK
 19770*        PROGRAM    ('DLO021')
 19771*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 19772*        LENGTH     (DLO021-COMM-LENGTH)
 19773*    END-EXEC.
 19774     MOVE 'DLO021' TO DFHEIV1
 19775*    MOVE '."C                   (   #00019243' TO DFHEIV0
 19776     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19777     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19778     MOVE X'2020233030303139323433' TO DFHEIV0(25:11)
 19779     CALL 'kxdfhei1' USING DFHEIV0,
 19780           DFHEIV1,
 19781           WS-DLO-VALID-LOAN-OFFICER,
 19782           DLO021-COMM-LENGTH,
 19783           DFHEIV99,
 19784           DFHEIV99,
 19785           DFHEIV99,
 19786           DFHEIV99
 19787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19788
 19789
 19790 7760-EXIT.
 19791     EXIT.
 19792
 19793 7770-CALL-DL22.
 19794
 19795* EXEC CICS LINK
 19796*        PROGRAM    ('DLO022')
 19797*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 19798*        LENGTH     (DLO022-COMM-LENGTH)
 19799*    END-EXEC.
 19800     MOVE 'DLO022' TO DFHEIV1
 19801*    MOVE '."C                   (   #00019253' TO DFHEIV0
 19802     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19803     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19804     MOVE X'2020233030303139323533' TO DFHEIV0(25:11)
 19805     CALL 'kxdfhei1' USING DFHEIV0,
 19806           DFHEIV1,
 19807           WS-DLO-VALID-STATE-CODE,
 19808           DLO022-COMM-LENGTH,
 19809           DFHEIV99,
 19810           DFHEIV99,
 19811           DFHEIV99,
 19812           DFHEIV99
 19813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19814
 19815
 19816 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 365
* EL050.cbl
 19817     EXIT.
 19818
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 366
* EL050.cbl
 19820
 19821 7780-CALL-AGG.
 19822
 19823* EXEC CICS LINK
 19824*        PROGRAM    ('ELAGGO')
 19825*        COMMAREA   (WS-PASS-to-pemaggo)
 19826*        LENGTH     (ws-passed-key-LENGTH)
 19827*    END-EXEC.
 19828     MOVE 'ELAGGO' TO DFHEIV1
 19829*    MOVE '."C                   (   #00019265' TO DFHEIV0
 19830     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19831     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19832     MOVE X'2020233030303139323635' TO DFHEIV0(25:11)
 19833     CALL 'kxdfhei1' USING DFHEIV0,
 19834           DFHEIV1,
 19835           WS-PASS-to-pemaggo,
 19836           ws-passed-key-LENGTH,
 19837           DFHEIV99,
 19838           DFHEIV99,
 19839           DFHEIV99,
 19840           DFHEIV99
 19841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19842
 19843 7780-EXIT.
 19844     EXIT.
 19845 7800-REWRITE-CERT.
 19846******************************************************************
 19847*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 19848*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 19849******************************************************************
 19850
 19851     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 19852        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 19853        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 19854        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 19855
 19856* EXEC CICS REWRITE
 19857*                  DATASET (CERT-ID)
 19858*                  FROM    (CERTIFICATE-MASTER)
 19859*              END-EXEC
 19860     MOVE LENGTH OF
 19861      CERTIFICATE-MASTER
 19862       TO DFHEIV11
 19863*    MOVE '&& L                  %   #00019282' TO DFHEIV0
 19864     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19865     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19866     MOVE X'2020233030303139323832' TO DFHEIV0(25:11)
 19867     CALL 'kxdfhei1' USING DFHEIV0,
 19868           CERT-ID,
 19869           CERTIFICATE-MASTER,
 19870           DFHEIV11,
 19871           DFHEIV99
 19872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19873        GO TO 7800-EXIT.
 19874
 19875       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 19876       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 19877
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 367
* EL050.cbl
 19878 7800-EXIT.
 19879      EXIT.
 19880
 19881 7900-DELETE-CERT.
 19882
 19883* EXEC CICS DELETE
 19884*        DATASET (CERT-ID)
 19885*    END-EXEC.
 19886*    MOVE '&(                    &   #00019295' TO DFHEIV0
 19887     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 19888     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19889     MOVE X'2020233030303139323935' TO DFHEIV0(25:11)
 19890     CALL 'kxdfhei1' USING DFHEIV0,
 19891           CERT-ID,
 19892           DFHEIV99,
 19893           DFHEIV99,
 19894           DFHEIV99,
 19895           DFHEIV99
 19896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19897
 19898
 19899 7900-EXIT.
 19900     EXIT.
 19901
 19902 8000-WRITE-CERT.
 19903
 19904* EXEC CICS HANDLE CONDITION
 19905*        DUPKEY    (8000-FREE-MAIN)
 19906*    END-EXEC.
 19907*    MOVE '"$$                   ! + #00019303' TO DFHEIV0
 19908     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19909     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19910     MOVE X'2B20233030303139333033' TO DFHEIV0(25:11)
 19911     CALL 'kxdfhei1' USING DFHEIV0
 19912     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19913
 19914
 19915
 19916* EXEC CICS WRITE
 19917*        DATASET     (CERT-ID)
 19918*        FROM        (CERTIFICATE-MASTER)
 19919*        RIDFLD      (ELCERT-KEY)
 19920*    END-EXEC.
 19921     MOVE LENGTH OF
 19922      CERTIFICATE-MASTER
 19923       TO DFHEIV11
 19924*    MOVE '&$ L                  ''   #00019307' TO DFHEIV0
 19925     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19926     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19927     MOVE X'2020233030303139333037' TO DFHEIV0(25:11)
 19928     CALL 'kxdfhei1' USING DFHEIV0,
 19929           CERT-ID,
 19930           CERTIFICATE-MASTER,
 19931           DFHEIV11,
 19932           ELCERT-KEY,
 19933           DFHEIV99,
 19934           DFHEIV99
 19935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 368
* EL050.cbl
 19936
 19937
 19938 8000-FREE-MAIN.
 19939
 19940 8000-EXIT.
 19941      EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 369
* EL050.cbl
 19943
 19944 8100-READ-ERPNDM.
 19945
 19946* EXEC CICS HANDLE CONDITION
 19947*         NOTFND     (8100-NOTFND)
 19948*         ENDFILE    (8100-NOTFND)
 19949*    END-EXEC.
 19950*    MOVE '"$I''                  ! , #00019320' TO DFHEIV0
 19951     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19952     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19953     MOVE X'2C20233030303139333230' TO DFHEIV0(25:11)
 19954     CALL 'kxdfhei1' USING DFHEIV0
 19955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19956
 19957
 19958     MOVE SPACES                 TO ERPNDM-FOUND.
 19959     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19960
 19961
 19962* EXEC CICS READ
 19963*         DATASET   (FILE-ERPNDM)
 19964*         RIDFLD    (PM-CONTROL-PRIMARY)
 19965*         INTO      (PENDING-MAILING-DATA)
 19966*    END-EXEC.
 19967     MOVE LENGTH OF
 19968      PENDING-MAILING-DATA
 19969       TO DFHEIV11
 19970*    MOVE '&"IL       E          (   #00019328' TO DFHEIV0
 19971     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19972     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19973     MOVE X'2020233030303139333238' TO DFHEIV0(25:11)
 19974     CALL 'kxdfhei1' USING DFHEIV0,
 19975           FILE-ERPNDM,
 19976           PENDING-MAILING-DATA,
 19977           DFHEIV11,
 19978           PM-CONTROL-PRIMARY,
 19979           DFHEIV99,
 19980           DFHEIV99,
 19981           DFHEIV99
 19982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19983
 19984
 19985     GO TO 8100-EXIT.
 19986
 19987 8100-NOTFND.
 19988
 19989     MOVE 'X'                    TO ERPNDM-FOUND.
 19990     MOVE ER-2694                TO WS-ERROR.
 19991     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19992     MOVE ER-2883                TO WS-ERROR
 19993     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 19994     .
 19995 8100-EXIT.
 19996     EXIT.
 19997
 19998 8110-READ-ERMAIL.
 19999
 20000* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 370
* EL050.cbl
 20001*         NOTFND     (8110-NOTFND)
 20002*         ENDFILE    (8110-NOTFND)
 20003*    END-EXEC.
 20004*    MOVE '"$I''                  ! - #00019348' TO DFHEIV0
 20005     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20006     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20007     MOVE X'2D20233030303139333438' TO DFHEIV0(25:11)
 20008     CALL 'kxdfhei1' USING DFHEIV0
 20009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20010
 20011
 20012     MOVE SPACES                 TO ERMAIL-FOUND.
 20013     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 20014     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 20015     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 20016     MOVE PB-SV-STATE            TO MA-STATE.
 20017
 20018
 20019* EXEC CICS READ
 20020*         UPDATE
 20021*         DATASET   (FILE-ERMAIL)
 20022*         RIDFLD    (MA-CONTROL-PRIMARY)
 20023*         INTO      (MAILING-DATA)
 20024*    END-EXEC.
 20025     MOVE LENGTH OF
 20026      MAILING-DATA
 20027       TO DFHEIV11
 20028*    MOVE '&"IL       EU         (   #00019359' TO DFHEIV0
 20029     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20030     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20031     MOVE X'2020233030303139333539' TO DFHEIV0(25:11)
 20032     CALL 'kxdfhei1' USING DFHEIV0,
 20033           FILE-ERMAIL,
 20034           MAILING-DATA,
 20035           DFHEIV11,
 20036           MA-CONTROL-PRIMARY,
 20037           DFHEIV99,
 20038           DFHEIV99,
 20039           DFHEIV99
 20040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20041
 20042
 20043     GO TO 8110-EXIT.
 20044
 20045 8110-NOTFND.
 20046     MOVE 'X'                    TO ERMAIL-FOUND.
 20047
 20048 8110-EXIT.
 20049     EXIT.
 20050
 20051 8120-REWRITE-ERMAIL.
 20052
 20053* EXEC CICS REWRITE
 20054*         DATASET    (FILE-ERMAIL)
 20055*         FROM       (MAILING-DATA)
 20056*    END-EXEC.
 20057     MOVE LENGTH OF
 20058      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 371
* EL050.cbl
 20059       TO DFHEIV11
 20060*    MOVE '&& L                  %   #00019375' TO DFHEIV0
 20061     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20062     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20063     MOVE X'2020233030303139333735' TO DFHEIV0(25:11)
 20064     CALL 'kxdfhei1' USING DFHEIV0,
 20065           FILE-ERMAIL,
 20066           MAILING-DATA,
 20067           DFHEIV11,
 20068           DFHEIV99
 20069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20070
 20071
 20072 8120-EXIT.
 20073     EXIT.
 20074
 20075 8130-WRITE-ERMAIL.
 20076
 20077* EXEC CICS HANDLE CONDITION
 20078*         DUPKEY   (8130-EXIT)
 20079*    END-EXEC.
 20080*    MOVE '"$$                   ! . #00019384' TO DFHEIV0
 20081     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 20082     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20083     MOVE X'2E20233030303139333834' TO DFHEIV0(25:11)
 20084     CALL 'kxdfhei1' USING DFHEIV0
 20085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20086
 20087
 20088
 20089* EXEC CICS WRITE
 20090*         DATASET     (FILE-ERMAIL)
 20091*         RIDFLD      (MA-CONTROL-PRIMARY)
 20092*         FROM        (MAILING-DATA)
 20093*    END-EXEC.
 20094     MOVE LENGTH OF
 20095      MAILING-DATA
 20096       TO DFHEIV11
 20097*    MOVE '&$ L                  ''   #00019388' TO DFHEIV0
 20098     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20099     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20100     MOVE X'2020233030303139333838' TO DFHEIV0(25:11)
 20101     CALL 'kxdfhei1' USING DFHEIV0,
 20102           FILE-ERMAIL,
 20103           MAILING-DATA,
 20104           DFHEIV11,
 20105           MA-CONTROL-PRIMARY,
 20106           DFHEIV99,
 20107           DFHEIV99
 20108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20109
 20110
 20111 8130-EXIT.
 20112     EXIT.
 20113
 20114 8140-UNLOCK-ERMAIL.
 20115
 20116* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 372
* EL050.cbl
 20117*         DATASET   (FILE-ERMAIL)
 20118*    END-EXEC.
 20119*    MOVE '&*                    #   #00019398' TO DFHEIV0
 20120     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20121     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20122     MOVE X'2020233030303139333938' TO DFHEIV0(25:11)
 20123     CALL 'kxdfhei1' USING DFHEIV0,
 20124           FILE-ERMAIL,
 20125           DFHEIV99
 20126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20127
 20128
 20129 8140-EXIT.
 20130     EXIT.
 20131
 20132 8150-read-elcrtt.
 20133
 20134
 20135* EXEC CICS HANDLE CONDITION
 20136*        NOTFND   (8150-exit)
 20137*    END-EXEC
 20138*    MOVE '"$I                   ! / #00019407' TO DFHEIV0
 20139     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20140     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20141     MOVE X'2F20233030303139343037' TO DFHEIV0(25:11)
 20142     CALL 'kxdfhei1' USING DFHEIV0
 20143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20144
 20145     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20146     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20147
 20148
 20149* EXEC CICS READ
 20150*        DATASET  (CRTT-ID)
 20151*        RIDFLD   (WS-ELCRTT-KEY)
 20152*        INTO     (CERTIFICATE-TRAILERS)
 20153*    END-EXEC
 20154     MOVE LENGTH OF
 20155      CERTIFICATE-TRAILERS
 20156       TO DFHEIV11
 20157*    MOVE '&"IL       E          (   #00019414' TO DFHEIV0
 20158     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20159     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20160     MOVE X'2020233030303139343134' TO DFHEIV0(25:11)
 20161     CALL 'kxdfhei1' USING DFHEIV0,
 20162           CRTT-ID,
 20163           CERTIFICATE-TRAILERS,
 20164           DFHEIV11,
 20165           WS-ELCRTT-KEY,
 20166           DFHEIV99,
 20167           DFHEIV99,
 20168           DFHEIV99
 20169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20170
 20171     move cs-ins-age-default-flag to ws-ins-age-defaulted
 20172     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 20173     move cs-vehicle-odometer    to ws-vehicle-odometer
 20174
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 373
* EL050.cbl
 20175     .
 20176 8150-exit.
 20177     exit.
 20178 8180-UPDATE-VIN-NUMBER.
 20179
 20180* EXEC CICS HANDLE CONDITION
 20181*        NOTFND   (8180-NOTFND)
 20182*    END-EXEC.
 20183*    MOVE '"$I                   ! 0 #00019428' TO DFHEIV0
 20184     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20185     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20186     MOVE X'3020233030303139343238' TO DFHEIV0(25:11)
 20187     CALL 'kxdfhei1' USING DFHEIV0
 20188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20189
 20190
 20191     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20192     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20193
 20194
 20195* EXEC CICS READ
 20196*        UPDATE
 20197*        DATASET  (CRTT-ID)
 20198*        RIDFLD   (WS-ELCRTT-KEY)
 20199*        INTO     (CERTIFICATE-TRAILERS)
 20200*    END-EXEC.
 20201     MOVE LENGTH OF
 20202      CERTIFICATE-TRAILERS
 20203       TO DFHEIV11
 20204*    MOVE '&"IL       EU         (   #00019435' TO DFHEIV0
 20205     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20206     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20207     MOVE X'2020233030303139343335' TO DFHEIV0(25:11)
 20208     CALL 'kxdfhei1' USING DFHEIV0,
 20209           CRTT-ID,
 20210           CERTIFICATE-TRAILERS,
 20211           DFHEIV11,
 20212           WS-ELCRTT-KEY,
 20213           DFHEIV99,
 20214           DFHEIV99,
 20215           DFHEIV99
 20216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20217
 20218
 20219     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 20220         MOVE PB-I-VIN TO CS-VIN-NUMBER
 20221
 20222* EXEC CICS REWRITE
 20223*           DATASET  (CRTT-ID)
 20224*           FROM     (CERTIFICATE-TRAILERS)
 20225*        END-EXEC
 20226     MOVE LENGTH OF
 20227      CERTIFICATE-TRAILERS
 20228       TO DFHEIV11
 20229*    MOVE '&& L                  %   #00019444' TO DFHEIV0
 20230     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20231     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20232     MOVE X'2020233030303139343434' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 374
* EL050.cbl
 20233     CALL 'kxdfhei1' USING DFHEIV0,
 20234           CRTT-ID,
 20235           CERTIFICATE-TRAILERS,
 20236           DFHEIV11,
 20237           DFHEIV99
 20238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20239     ELSE
 20240
 20241* EXEC CICS UNLOCK
 20242*          DATASET  (CRTT-ID)
 20243*       END-EXEC
 20244*    MOVE '&*                    #   #00019449' TO DFHEIV0
 20245     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20246     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20247     MOVE X'2020233030303139343439' TO DFHEIV0(25:11)
 20248     CALL 'kxdfhei1' USING DFHEIV0,
 20249           CRTT-ID,
 20250           DFHEIV99
 20251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20252     END-IF.
 20253
 20254     GO TO 8180-EXIT.
 20255
 20256 8180-NOTFND.
 20257
 20258     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20259     MOVE 'CS'         TO CS-RECORD-ID.
 20260     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20261     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20262     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20263     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 20264
 20265* EXEC CICS WRITE
 20266*       DATASET  (CRTT-ID)
 20267*       RIDFLD   (WS-ELCRTT-KEY)
 20268*       FROM     (CERTIFICATE-TRAILERS)
 20269*    END-EXEC.
 20270     MOVE LENGTH OF
 20271      CERTIFICATE-TRAILERS
 20272       TO DFHEIV11
 20273*    MOVE '&$ L                  ''   #00019464' TO DFHEIV0
 20274     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20275     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20276     MOVE X'2020233030303139343634' TO DFHEIV0(25:11)
 20277     CALL 'kxdfhei1' USING DFHEIV0,
 20278           CRTT-ID,
 20279           CERTIFICATE-TRAILERS,
 20280           DFHEIV11,
 20281           WS-ELCRTT-KEY,
 20282           DFHEIV99,
 20283           DFHEIV99
 20284     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20285
 20286
 20287 8180-EXIT.
 20288     EXIT.
 20289
 20290 8190-UPDATE-REFUND-CLAIM-FLAG.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 375
* EL050.cbl
 20291
 20292* EXEC CICS HANDLE CONDITION
 20293*        NOTFND   (8190-NOTFND)
 20294*    END-EXEC.
 20295*    MOVE '"$I                   ! 1 #00019474' TO DFHEIV0
 20296     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20297     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20298     MOVE X'3120233030303139343734' TO DFHEIV0(25:11)
 20299     CALL 'kxdfhei1' USING DFHEIV0
 20300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20301
 20302
 20303     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20304     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20305
 20306
 20307* EXEC CICS READ
 20308*        UPDATE
 20309*        DATASET  (CRTT-ID)
 20310*        RIDFLD   (WS-ELCRTT-KEY)
 20311*        INTO     (CERTIFICATE-TRAILERS)
 20312*    END-EXEC.
 20313     MOVE LENGTH OF
 20314      CERTIFICATE-TRAILERS
 20315       TO DFHEIV11
 20316*    MOVE '&"IL       EU         (   #00019481' TO DFHEIV0
 20317     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20318     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20319     MOVE X'2020233030303139343831' TO DFHEIV0(25:11)
 20320     CALL 'kxdfhei1' USING DFHEIV0,
 20321           CRTT-ID,
 20322           CERTIFICATE-TRAILERS,
 20323           DFHEIV11,
 20324           WS-ELCRTT-KEY,
 20325           DFHEIV99,
 20326           DFHEIV99,
 20327           DFHEIV99
 20328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20329
 20330
 20331     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20332
 20333* EXEC CICS REWRITE
 20334*       DATASET  (CRTT-ID)
 20335*       FROM     (CERTIFICATE-TRAILERS)
 20336*    END-EXEC.
 20337     MOVE LENGTH OF
 20338      CERTIFICATE-TRAILERS
 20339       TO DFHEIV11
 20340*    MOVE '&& L                  %   #00019489' TO DFHEIV0
 20341     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20342     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20343     MOVE X'2020233030303139343839' TO DFHEIV0(25:11)
 20344     CALL 'kxdfhei1' USING DFHEIV0,
 20345           CRTT-ID,
 20346           CERTIFICATE-TRAILERS,
 20347           DFHEIV11,
 20348           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 376
* EL050.cbl
 20349     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20350
 20351
 20352     GO TO 8190-EXIT.
 20353
 20354 8190-NOTFND.
 20355
 20356     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20357     MOVE 'CS'         TO CS-RECORD-ID.
 20358     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20359     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20360     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20361     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20362
 20363* EXEC CICS WRITE
 20364*       DATASET  (CRTT-ID)
 20365*       RIDFLD   (WS-ELCRTT-KEY)
 20366*       FROM     (CERTIFICATE-TRAILERS)
 20367*    END-EXEC.
 20368     MOVE LENGTH OF
 20369      CERTIFICATE-TRAILERS
 20370       TO DFHEIV11
 20371*    MOVE '&$ L                  ''   #00019504' TO DFHEIV0
 20372     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20373     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20374     MOVE X'2020233030303139353034' TO DFHEIV0(25:11)
 20375     CALL 'kxdfhei1' USING DFHEIV0,
 20376           CRTT-ID,
 20377           CERTIFICATE-TRAILERS,
 20378           DFHEIV11,
 20379           WS-ELCRTT-KEY,
 20380           DFHEIV99,
 20381           DFHEIV99
 20382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20383
 20384
 20385 8190-EXIT.
 20386     EXIT.
 20387
 20388 8195-UPDATE-AGE-FLAGS.
 20389
 20390* EXEC CICS HANDLE CONDITION
 20391*        NOTFND   (8195-NOTFND)
 20392*    END-EXEC.
 20393*    MOVE '"$I                   ! 2 #00019514' TO DFHEIV0
 20394     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20395     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20396     MOVE X'3220233030303139353134' TO DFHEIV0(25:11)
 20397     CALL 'kxdfhei1' USING DFHEIV0
 20398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20399
 20400
 20401     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20402     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20403
 20404
 20405* EXEC CICS READ
 20406*        UPDATE
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 377
* EL050.cbl
 20407*        DATASET  (CRTT-ID)
 20408*        RIDFLD   (WS-ELCRTT-KEY)
 20409*        INTO     (CERTIFICATE-TRAILERS)
 20410*    END-EXEC.
 20411     MOVE LENGTH OF
 20412      CERTIFICATE-TRAILERS
 20413       TO DFHEIV11
 20414*    MOVE '&"IL       EU         (   #00019521' TO DFHEIV0
 20415     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20416     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20417     MOVE X'2020233030303139353231' TO DFHEIV0(25:11)
 20418     CALL 'kxdfhei1' USING DFHEIV0,
 20419           CRTT-ID,
 20420           CERTIFICATE-TRAILERS,
 20421           DFHEIV11,
 20422           WS-ELCRTT-KEY,
 20423           DFHEIV99,
 20424           DFHEIV99,
 20425           DFHEIV99
 20426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20427
 20428
 20429     IF WS-INS-AGE-SET = 'Y'
 20430        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 20431     END-IF
 20432     IF WS-JNT-AGE-SET = 'Y'
 20433        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 20434     END-IF
 20435
 20436
 20437* EXEC CICS REWRITE
 20438*       DATASET  (CRTT-ID)
 20439*       FROM     (CERTIFICATE-TRAILERS)
 20440*    END-EXEC.
 20441     MOVE LENGTH OF
 20442      CERTIFICATE-TRAILERS
 20443       TO DFHEIV11
 20444*    MOVE '&& L                  %   #00019535' TO DFHEIV0
 20445     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20446     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20447     MOVE X'2020233030303139353335' TO DFHEIV0(25:11)
 20448     CALL 'kxdfhei1' USING DFHEIV0,
 20449           CRTT-ID,
 20450           CERTIFICATE-TRAILERS,
 20451           DFHEIV11,
 20452           DFHEIV99
 20453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20454
 20455
 20456     GO TO 8195-EXIT.
 20457
 20458 8195-NOTFND.
 20459
 20460     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20461     MOVE 'CS'         TO CS-RECORD-ID.
 20462     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20463     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20464     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 378
* EL050.cbl
 20465     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 20466     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 20467
 20468* EXEC CICS WRITE
 20469*       DATASET  (CRTT-ID)
 20470*       RIDFLD   (WS-ELCRTT-KEY)
 20471*       FROM     (CERTIFICATE-TRAILERS)
 20472*    END-EXEC.
 20473     MOVE LENGTH OF
 20474      CERTIFICATE-TRAILERS
 20475       TO DFHEIV11
 20476*    MOVE '&$ L                  ''   #00019551' TO DFHEIV0
 20477     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20478     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20479     MOVE X'2020233030303139353531' TO DFHEIV0(25:11)
 20480     CALL 'kxdfhei1' USING DFHEIV0,
 20481           CRTT-ID,
 20482           CERTIFICATE-TRAILERS,
 20483           DFHEIV11,
 20484           WS-ELCRTT-KEY,
 20485           DFHEIV99,
 20486           DFHEIV99
 20487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20488
 20489
 20490 8195-EXIT.
 20491     EXIT.
 20492
 20493 8200-READ-REIN-TABLE.
 20494
 20495* EXEC CICS HANDLE CONDITION
 20496*         NOTFND   (8200-NOTFND)
 20497*    END-EXEC.
 20498*    MOVE '"$I                   ! 3 #00019561' TO DFHEIV0
 20499     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20500     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20501     MOVE X'3320233030303139353631' TO DFHEIV0(25:11)
 20502     CALL 'kxdfhei1' USING DFHEIV0
 20503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20504
 20505
 20506
 20507* EXEC CICS READ
 20508*        DATASET     (REIN-ID)
 20509*        SET         (ADDRESS OF REINSURANCE-RECORD)
 20510*        RIDFLD      (ERREIN-KEY)
 20511*    END-EXEC.
 20512*    MOVE '&"S        E          (   #00019565' TO DFHEIV0
 20513     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20514     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20515     MOVE X'2020233030303139353635' TO DFHEIV0(25:11)
 20516     CALL 'kxdfhei1' USING DFHEIV0,
 20517           REIN-ID,
 20518           DFHEIV20,
 20519           DFHEIV99,
 20520           ERREIN-KEY,
 20521           DFHEIV99,
 20522           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 379
* EL050.cbl
 20523           DFHEIV99
 20524     SET ADDRESS OF REINSURANCE-RECORD TO
 20525         DFHEIV20
 20526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20527
 20528
 20529     GO TO 8200-EXIT.
 20530
 20531 8200-NOTFND.
 20532     MOVE 'N'             TO WS-REIN-READ-SW.
 20533
 20534 8200-EXIT.
 20535      EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 380
* EL050.cbl
 20537
 20538 8300-READ-CTBL-TABLE.
 20539
 20540* EXEC CICS HANDLE CONDITION
 20541*        NOTFND    (8300-NOTFND)
 20542*        DISABLED  (8300-ERRESS-PROBLEM)
 20543*        NOTOPEN   (8300-ERRESS-PROBLEM)
 20544*        ENDFILE   (8300-NOTFND)
 20545*    END-EXEC.
 20546*    MOVE '"$IcJ''                ! 4 #00019581' TO DFHEIV0
 20547     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 20548     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20549     MOVE X'3420233030303139353831' TO DFHEIV0(25:11)
 20550     CALL 'kxdfhei1' USING DFHEIV0
 20551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20552
 20553
 20554
 20555* EXEC CICS READ
 20556*        DATASET     (CTBL-ID)
 20557*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 20558*        RIDFLD      (ERCTBL-KEY)
 20559*    END-EXEC.
 20560*    MOVE '&"S        E          (   #00019588' TO DFHEIV0
 20561     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20562     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20563     MOVE X'2020233030303139353838' TO DFHEIV0(25:11)
 20564     CALL 'kxdfhei1' USING DFHEIV0,
 20565           CTBL-ID,
 20566           DFHEIV20,
 20567           DFHEIV99,
 20568           ERCTBL-KEY,
 20569           DFHEIV99,
 20570           DFHEIV99,
 20571           DFHEIV99
 20572     SET ADDRESS OF COMM-TABLE-RECORD TO
 20573         DFHEIV20
 20574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20575
 20576
 20577     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 20578
 20579     GO TO 8300-EXIT.
 20580
 20581 8300-NOTFND.
 20582
 20583     IF CTBL-SW = '0530'
 20584         MOVE 'AA'                     TO WS-AH-COMP-CD
 20585         MOVE '0550'                   TO CTBL-SW
 20586         MOVE '1'                      TO WS-CTBL-READ-SW
 20587         GO TO 8300-EXIT.
 20588
 20589     IF CTBL-SW = '0540'
 20590         MOVE 'AA'                     TO WS-LF-COMP-CD
 20591         MOVE '0550'                   TO CTBL-SW
 20592         MOVE '1'                      TO WS-CTBL-READ-SW
 20593         GO TO 8300-EXIT.
 20594
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 381
* EL050.cbl
 20595     IF CTBL-SW = '0550'
 20596         MOVE '2'                      TO WS-CTBL-READ-SW
 20597         GO TO 8300-EXIT.
 20598
 20599     GO TO 8300-EXIT.
 20600
 20601 8300-ERRESS-PROBLEM.
 20602
 20603      MOVE ER-8050              TO WS-ERROR.
 20604      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20605
 20606     GO TO 8300-EXIT.
 20607
 20608 8300-EXIT.
 20609      EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 382
* EL050.cbl
 20611
 20612
 20613 8400-GETMAIN-ERFORM.
 20614
 20615
 20616* EXEC CICS   GETMAIN
 20617*        LENGTH  (500)
 20618*        SET     (ADDRESS OF FORM-MASTER)
 20619*    END-EXEC.
 20620     MOVE 500
 20621       TO DFHEIV11
 20622*    MOVE '," L                  $   #00019632' TO DFHEIV0
 20623     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20624     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20625     MOVE X'2020233030303139363332' TO DFHEIV0(25:11)
 20626     CALL 'kxdfhei1' USING DFHEIV0,
 20627           DFHEIV20,
 20628           DFHEIV11,
 20629           DFHEIV99
 20630     SET ADDRESS OF FORM-MASTER TO
 20631         DFHEIV20
 20632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20633
 20634
 20635     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 20636
 20637 8400-EXIT.
 20638      EXIT.
 20639
 20640 8450-READ-FORM-MASTER.
 20641
 20642
 20643* EXEC CICS  HANDLE CONDITION
 20644*        NOTFND   (8450-FORM-NOT-FOUND)
 20645*        ENDFILE  (8450-FORM-NOT-FOUND)
 20646*    END-EXEC.
 20647*    MOVE '"$I''                  ! 5 #00019644' TO DFHEIV0
 20648     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20649     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20650     MOVE X'3520233030303139363434' TO DFHEIV0(25:11)
 20651     CALL 'kxdfhei1' USING DFHEIV0
 20652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20653
 20654
 20655
 20656* EXEC CICS   READ
 20657*        DATASET   (FORM-ID)
 20658*        RIDFLD    (ERFORM-KEY)
 20659*        INTO      (FORM-MASTER)
 20660*        GTEQ
 20661*    END-EXEC.
 20662     MOVE LENGTH OF
 20663      FORM-MASTER
 20664       TO DFHEIV11
 20665*    MOVE '&"IL       G          (   #00019649' TO DFHEIV0
 20666     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20667     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20668     MOVE X'2020233030303139363439' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 383
* EL050.cbl
 20669     CALL 'kxdfhei1' USING DFHEIV0,
 20670           FORM-ID,
 20671           FORM-MASTER,
 20672           DFHEIV11,
 20673           ERFORM-KEY,
 20674           DFHEIV99,
 20675           DFHEIV99,
 20676           DFHEIV99
 20677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20678
 20679
 20680     MOVE  'Y'           TO  FORM-MASTER-SW.
 20681
 20682     GO TO  8450-EXIT.
 20683
 20684 8450-FORM-NOT-FOUND.
 20685
 20686     MOVE  'N'           TO  FORM-MASTER-SW.
 20687
 20688 8450-EXIT.
 20689      EXIT.
 20690
 20691 8500-DATE-CONVERT.
 20692
 20693* EXEC CICS LINK
 20694*        PROGRAM    ('ELDATCV')
 20695*        COMMAREA   (DATE-CONVERSION-DATA)
 20696*        LENGTH     (DC-COMM-LENGTH)
 20697*    END-EXEC.
 20698     MOVE 'ELDATCV' TO DFHEIV1
 20699*    MOVE '."C                   (   #00019668' TO DFHEIV0
 20700     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20701     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20702     MOVE X'2020233030303139363638' TO DFHEIV0(25:11)
 20703     CALL 'kxdfhei1' USING DFHEIV0,
 20704           DFHEIV1,
 20705           DATE-CONVERSION-DATA,
 20706           DC-COMM-LENGTH,
 20707           DFHEIV99,
 20708           DFHEIV99,
 20709           DFHEIV99,
 20710           DFHEIV99
 20711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20712
 20713
 20714 8500-EXIT.
 20715     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 384
* EL050.cbl
 20717
 20718 8555-RELOAD-CONTROL-FILE.
 20719     CONTINUE.
 20720
 20721 8555-EXIT.
 20722     EXIT.
 20723
 20724 8557-GETMAIN-ERPLAN.
 20725
 20726
 20727* EXEC CICS GETMAIN
 20728*        LENGTH    (840)
 20729*        SET       (ADDRESS OF PLAN-RECORDS)
 20730*    END-EXEC.
 20731     MOVE 840
 20732       TO DFHEIV11
 20733*    MOVE '," L                  $   #00019686' TO DFHEIV0
 20734     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20735     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20736     MOVE X'2020233030303139363836' TO DFHEIV0(25:11)
 20737     CALL 'kxdfhei1' USING DFHEIV0,
 20738           DFHEIV20,
 20739           DFHEIV11,
 20740           DFHEIV99
 20741     SET ADDRESS OF PLAN-RECORDS TO
 20742         DFHEIV20
 20743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20744
 20745
 20746     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 20747
 20748 8557-EXIT.
 20749     EXIT.
 20750
 20751 8560-GETMAIN.
 20752
 20753* EXEC CICS GETMAIN
 20754*        LENGTH    (2000)
 20755*        SET       (ADDRESS OF ACCOUNT-MASTER)
 20756*    END-EXEC.
 20757     MOVE 2000
 20758       TO DFHEIV11
 20759*    MOVE '," L                  $   #00019697' TO DFHEIV0
 20760     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20761     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20762     MOVE X'2020233030303139363937' TO DFHEIV0(25:11)
 20763     CALL 'kxdfhei1' USING DFHEIV0,
 20764           DFHEIV20,
 20765           DFHEIV11,
 20766           DFHEIV99
 20767     SET ADDRESS OF ACCOUNT-MASTER TO
 20768         DFHEIV20
 20769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20770
 20771
 20772     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 20773
 20774 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 385
* EL050.cbl
 20775     EXIT.
 20776
 20777 8570-START-ACCOUNT-MASTER.
 20778
 20779* EXEC CICS HANDLE CONDITION
 20780*        NOTFND    (0199-ACCT-NOT-FOUND)
 20781*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20782*    END-EXEC.
 20783*    MOVE '"$I''                  ! 6 #00019708' TO DFHEIV0
 20784     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20785     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20786     MOVE X'3620233030303139373038' TO DFHEIV0(25:11)
 20787     CALL 'kxdfhei1' USING DFHEIV0
 20788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20789
 20790
 20791
 20792* EXEC CICS STARTBR
 20793*        DATASET    (ACCT-ID)
 20794*        RIDFLD     (ERACCT-KEY)
 20795*        GTEQ
 20796*    END-EXEC.
 20797     MOVE 0
 20798       TO DFHEIV11
 20799*    MOVE '&,         G          &   #00019713' TO DFHEIV0
 20800     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20801     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20802     MOVE X'2020233030303139373133' TO DFHEIV0(25:11)
 20803     CALL 'kxdfhei1' USING DFHEIV0,
 20804           ACCT-ID,
 20805           ERACCT-KEY,
 20806           DFHEIV99,
 20807           DFHEIV11,
 20808           DFHEIV99
 20809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20810
 20811
 20812 8570-EXIT.
 20813     EXIT.
 20814
 20815 8580-READ-ACCOUNT-MASTER.
 20816
 20817* EXEC CICS HANDLE CONDITION
 20818*        NOTFND    (0199-ACCT-NOT-FOUND)
 20819*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20820*    END-EXEC.
 20821*    MOVE '"$I''                  ! 7 #00019723' TO DFHEIV0
 20822     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20823     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20824     MOVE X'3720233030303139373233' TO DFHEIV0(25:11)
 20825     CALL 'kxdfhei1' USING DFHEIV0
 20826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20827
 20828
 20829
 20830* EXEC CICS READNEXT
 20831*        DATASET     (ACCT-ID)
 20832*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 386
* EL050.cbl
 20833*        RIDFLD      (ERACCT-KEY)
 20834*    END-EXEC.
 20835     MOVE LENGTH OF
 20836      ACCOUNT-MASTER
 20837       TO DFHEIV12
 20838     MOVE 0
 20839       TO DFHEIV11
 20840*    MOVE '&.IL                  )   #00019728' TO DFHEIV0
 20841     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20842     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20843     MOVE X'2020233030303139373238' TO DFHEIV0(25:11)
 20844     CALL 'kxdfhei1' USING DFHEIV0,
 20845           ACCT-ID,
 20846           ACCOUNT-MASTER,
 20847           DFHEIV12,
 20848           ERACCT-KEY,
 20849           DFHEIV99,
 20850           DFHEIV11,
 20851           DFHEIV99,
 20852           DFHEIV99
 20853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20854
 20855
 20856 8580-EXIT.
 20857     EXIT.
 20858
 20859 8582-READ-COMPENSATION-MASTER.
 20860
 20861* EXEC CICS HANDLE CONDITION
 20862*        NOTFND    (8582-COMP-NOT-FOUND)
 20863*        ENDFILE   (8582-COMP-NOT-FOUND)
 20864*    END-EXEC.
 20865*    MOVE '"$I''                  ! 8 #00019738' TO DFHEIV0
 20866     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20867     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20868     MOVE X'3820233030303139373338' TO DFHEIV0(25:11)
 20869     CALL 'kxdfhei1' USING DFHEIV0
 20870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20871
 20872
 20873
 20874* EXEC CICS READ
 20875*        DATASET     (COMP-ID)
 20876*        INTO        (COMPENSATION-MASTER)
 20877*        RIDFLD      (ERCOMP-KEY)
 20878*    END-EXEC.
 20879     MOVE LENGTH OF
 20880      COMPENSATION-MASTER
 20881       TO DFHEIV11
 20882*    MOVE '&"IL       E          (   #00019743' TO DFHEIV0
 20883     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20884     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20885     MOVE X'2020233030303139373433' TO DFHEIV0(25:11)
 20886     CALL 'kxdfhei1' USING DFHEIV0,
 20887           COMP-ID,
 20888           COMPENSATION-MASTER,
 20889           DFHEIV11,
 20890           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 387
* EL050.cbl
 20891           DFHEIV99,
 20892           DFHEIV99,
 20893           DFHEIV99
 20894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20895
 20896
 20897     MOVE 'Y'                    TO COMP-MASTER-SW
 20898
 20899     GO TO 8582-EXIT
 20900     .
 20901 8582-COMP-NOT-FOUND.
 20902
 20903     MOVE 'N'                    TO COMP-MASTER-SW.
 20904
 20905 8582-EXIT.
 20906     EXIT.
 20907
 20908 8583-READ-ERAGTC.
 20909
 20910* EXEC CICS HANDLE CONDITION
 20911*        NOTFND    (8583-AGTC-NOT-FOUND)
 20912*        ENDFILE   (8583-AGTC-NOT-FOUND)
 20913*    END-EXEC.
 20914*    MOVE '"$I''                  ! 9 #00019761' TO DFHEIV0
 20915     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20916     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20917     MOVE X'3920233030303139373631' TO DFHEIV0(25:11)
 20918     CALL 'kxdfhei1' USING DFHEIV0
 20919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20920
 20921
 20922
 20923* EXEC CICS STARTBR
 20924*        DATASET    (AGTC-ID)
 20925*        RIDFLD     (ERAGTC-KEY)
 20926*        GTEQ
 20927*    END-EXEC.
 20928     MOVE 0
 20929       TO DFHEIV11
 20930*    MOVE '&,         G          &   #00019766' TO DFHEIV0
 20931     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20932     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20933     MOVE X'2020233030303139373636' TO DFHEIV0(25:11)
 20934     CALL 'kxdfhei1' USING DFHEIV0,
 20935           AGTC-ID,
 20936           ERAGTC-KEY,
 20937           DFHEIV99,
 20938           DFHEIV11,
 20939           DFHEIV99
 20940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20941
 20942
 20943 8583-READ-ERAGTC-NEXT.
 20944
 20945* EXEC CICS READNEXT
 20946*        DATASET     (AGTC-ID)
 20947*        INTO        (AGENT-COMMISSIONS)
 20948*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 388
* EL050.cbl
 20949*    END-EXEC.
 20950     MOVE LENGTH OF
 20951      AGENT-COMMISSIONS
 20952       TO DFHEIV12
 20953     MOVE 0
 20954       TO DFHEIV11
 20955*    MOVE '&.IL                  )   #00019773' TO DFHEIV0
 20956     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20957     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20958     MOVE X'2020233030303139373733' TO DFHEIV0(25:11)
 20959     CALL 'kxdfhei1' USING DFHEIV0,
 20960           AGTC-ID,
 20961           AGENT-COMMISSIONS,
 20962           DFHEIV12,
 20963           ERAGTC-KEY,
 20964           DFHEIV99,
 20965           DFHEIV11,
 20966           DFHEIV99,
 20967           DFHEIV99
 20968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20969
 20970
 20971*    MOVE 'Y'                    TO AGTC-MASTER-SW
 20972
 20973     GO TO 8583-EXIT
 20974     .
 20975 8583-AGTC-NOT-FOUND.
 20976
 20977     MOVE 'N'                    TO AGTC-MASTER-SW.
 20978
 20979 8583-EXIT.
 20980     EXIT.
 20981
 20982 8584-READ-BANK-CROSS-REF.
 20983
 20984* EXEC CICS HANDLE CONDITION
 20985*        NOTFND    (8584-BXRF-NOT-FOUND)
 20986*        ENDFILE   (8584-BXRF-NOT-FOUND)
 20987*    END-EXEC.
 20988*    MOVE '"$I''                  ! : #00019791' TO DFHEIV0
 20989     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20990     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20991     MOVE X'3A20233030303139373931' TO DFHEIV0(25:11)
 20992     CALL 'kxdfhei1' USING DFHEIV0
 20993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20994
 20995
 20996
 20997* EXEC CICS READ
 20998*        DATASET     (BXRF-ID)
 20999*        INTO        (BANK-CROSS-REFERENCE)
 21000*        RIDFLD      (ERBXRF-KEY)
 21001*        LENGTH      (BXRF-REC-LENGTH)
 21002*    END-EXEC.
 21003*    MOVE '&"IL       E          (   #00019796' TO DFHEIV0
 21004     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21005     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21006     MOVE X'2020233030303139373936' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 389
* EL050.cbl
 21007     CALL 'kxdfhei1' USING DFHEIV0,
 21008           BXRF-ID,
 21009           BANK-CROSS-REFERENCE,
 21010           BXRF-REC-LENGTH,
 21011           ERBXRF-KEY,
 21012           DFHEIV99,
 21013           DFHEIV99,
 21014           DFHEIV99
 21015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21016
 21017
 21018     MOVE 'Y'                    TO BXRF-MASTER-SW
 21019
 21020     GO TO 8584-EXIT
 21021     .
 21022 8584-BXRF-NOT-FOUND.
 21023
 21024     MOVE 'N'                    TO BXRF-MASTER-SW.
 21025
 21026 8584-EXIT.
 21027     EXIT.
 21028
 21029 8585-READ-PLAN-MASTER.
 21030
 21031
 21032* EXEC CICS HANDLE CONDITION
 21033*        NOTFND    (8585-PLAN-NOT-FOUND)
 21034*        ENDFILE   (8585-PLAN-NOT-FOUND)
 21035*    END-EXEC.
 21036*    MOVE '"$I''                  ! ; #00019816' TO DFHEIV0
 21037     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21038     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21039     MOVE X'3B20233030303139383136' TO DFHEIV0(25:11)
 21040     CALL 'kxdfhei1' USING DFHEIV0
 21041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21042
 21043
 21044
 21045* EXEC CICS READ
 21046*        DATASET     (PLAN-ID)
 21047*        INTO        (PLAN-MASTER)
 21048*        RIDFLD      (ERPLAN-KEY)
 21049*    END-EXEC.
 21050     MOVE LENGTH OF
 21051      PLAN-MASTER
 21052       TO DFHEIV11
 21053*    MOVE '&"IL       E          (   #00019821' TO DFHEIV0
 21054     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21055     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21056     MOVE X'2020233030303139383231' TO DFHEIV0(25:11)
 21057     CALL 'kxdfhei1' USING DFHEIV0,
 21058           PLAN-ID,
 21059           PLAN-MASTER,
 21060           DFHEIV11,
 21061           ERPLAN-KEY,
 21062           DFHEIV99,
 21063           DFHEIV99,
 21064           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 390
* EL050.cbl
 21065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21066
 21067
 21068     MOVE 'Y'                    TO PLAN-MASTER-SW.
 21069
 21070     GO TO 8585-EXIT.
 21071
 21072 8585-PLAN-NOT-FOUND.
 21073
 21074     MOVE 'N'                    TO PLAN-MASTER-SW.
 21075
 21076 8585-EXIT.
 21077     EXIT.
 21078
 21079 8586-READ-LOAN-OFFICER.
 21080
 21081* EXEC CICS READ
 21082*        DATASET     (LOFC-ID)
 21083*        INTO        (LOAN-OFFICER-MASTER)
 21084*        RIDFLD      (ERLOFC-KEY)
 21085*        RESP        (WS-RESPONSE)
 21086*    END-EXEC
 21087     MOVE LENGTH OF
 21088      LOAN-OFFICER-MASTER
 21089       TO DFHEIV11
 21090*    MOVE '&"IL       E          (  N#00019839' TO DFHEIV0
 21091     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21092     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21093     MOVE X'204E233030303139383339' TO DFHEIV0(25:11)
 21094     CALL 'kxdfhei1' USING DFHEIV0,
 21095           LOFC-ID,
 21096           LOAN-OFFICER-MASTER,
 21097           DFHEIV11,
 21098           ERLOFC-KEY,
 21099           DFHEIV99,
 21100           DFHEIV99,
 21101           DFHEIV99
 21102     MOVE EIBRESP  TO WS-RESPONSE
 21103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21104
 21105     IF WS-RESP-NORMAL
 21106        MOVE 'Y'                 TO LOFC-MASTER-SW
 21107     ELSE
 21108        MOVE 'N'                 TO LOFC-MASTER-SW
 21109     END-IF
 21110     .
 21111 8586-EXIT.
 21112     EXIT.
 21113 8587-START-ERPDEF.
 21114
 21115* EXEC CICS STARTBR
 21116*       DATASET   (PDEF-ID)
 21117*       RIDFLD    (ERPDEF-KEY)
 21118*       GTEQ
 21119*       RESP      (WS-RESPONSE)
 21120*    END-EXEC
 21121     MOVE 0
 21122       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 391
* EL050.cbl
 21123*    MOVE '&,         G          &  N#00019855' TO DFHEIV0
 21124     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21125     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21126     MOVE X'204E233030303139383535' TO DFHEIV0(25:11)
 21127     CALL 'kxdfhei1' USING DFHEIV0,
 21128           PDEF-ID,
 21129           ERPDEF-KEY,
 21130           DFHEIV99,
 21131           DFHEIV11,
 21132           DFHEIV99
 21133     MOVE EIBRESP  TO WS-RESPONSE
 21134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21135     IF WS-RESP-NORMAL
 21136        MOVE 'Y'                 TO PDEF-MASTER-SW
 21137     ELSE
 21138        MOVE 'N'                 TO PDEF-MASTER-SW
 21139     END-IF
 21140     .
 21141 8587-EXIT.
 21142     EXIT.
 21143 8588-READ-ERPDEF.
 21144
 21145* EXEC CICS READNEXT
 21146*       DATASET   (PDEF-ID)
 21147*       RIDFLD    (ERPDEF-KEY)
 21148*       INTO      (PRODUCT-MASTER)
 21149*       RESP      (WS-RESPONSE)
 21150*    END-EXEC
 21151     MOVE LENGTH OF
 21152      PRODUCT-MASTER
 21153       TO DFHEIV12
 21154     MOVE 0
 21155       TO DFHEIV11
 21156*    MOVE '&.IL                  )  N#00019870' TO DFHEIV0
 21157     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21158     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21159     MOVE X'204E233030303139383730' TO DFHEIV0(25:11)
 21160     CALL 'kxdfhei1' USING DFHEIV0,
 21161           PDEF-ID,
 21162           PRODUCT-MASTER,
 21163           DFHEIV12,
 21164           ERPDEF-KEY,
 21165           DFHEIV99,
 21166           DFHEIV11,
 21167           DFHEIV99,
 21168           DFHEIV99
 21169     MOVE EIBRESP  TO WS-RESPONSE
 21170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21171     IF WS-RESP-NORMAL
 21172        MOVE 'Y'                 TO PDEF-MASTER-SW
 21173     ELSE
 21174        MOVE 'N'                 TO PDEF-MASTER-SW
 21175     END-IF
 21176     .
 21177 8588-EXIT.
 21178     EXIT.
 21179 8589-ENDBR-ERPDEF.
 21180
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 392
* EL050.cbl
 21181* EXEC CICS ENDBR
 21182*       DATASET   (PDEF-ID)
 21183*    END-EXEC
 21184     MOVE 0
 21185       TO DFHEIV11
 21186*    MOVE '&2                    $   #00019885' TO DFHEIV0
 21187     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21188     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21189     MOVE X'2020233030303139383835' TO DFHEIV0(25:11)
 21190     CALL 'kxdfhei1' USING DFHEIV0,
 21191           PDEF-ID,
 21192           DFHEIV11,
 21193           DFHEIV99
 21194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21195     .
 21196 8589-EXIT.
 21197     EXIT.
 21198 8590-READ-CERT-MASTER.
 21199     IF PB-COMPANY-ID = 'UCL'
 21200         GO TO 8690-READ-CERT-MASTER-UCL.
 21201
 21202
 21203* EXEC CICS HANDLE CONDITION
 21204*         NOTFND    (0299-CERT-NOT-FOUND)
 21205*    END-EXEC.
 21206*    MOVE '"$I                   ! < #00019895' TO DFHEIV0
 21207     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21208     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21209     MOVE X'3C20233030303139383935' TO DFHEIV0(25:11)
 21210     CALL 'kxdfhei1' USING DFHEIV0
 21211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21212
 21213
 21214
 21215* EXEC CICS READ
 21216*        DATASET     (CERT-ID)
 21217*        INTO        (CERTIFICATE-MASTER)
 21218*        RIDFLD      (ELCERT-KEY)
 21219*        UPDATE
 21220*    END-EXEC.
 21221     MOVE LENGTH OF
 21222      CERTIFICATE-MASTER
 21223       TO DFHEIV11
 21224*    MOVE '&"IL       EU         (   #00019899' TO DFHEIV0
 21225     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21226     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21227     MOVE X'2020233030303139383939' TO DFHEIV0(25:11)
 21228     CALL 'kxdfhei1' USING DFHEIV0,
 21229           CERT-ID,
 21230           CERTIFICATE-MASTER,
 21231           DFHEIV11,
 21232           ELCERT-KEY,
 21233           DFHEIV99,
 21234           DFHEIV99,
 21235           DFHEIV99
 21236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21237
 21238
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 393
* EL050.cbl
 21239 8590-EXIT.
 21240     EXIT.
 21241
 21242 8690-READ-CERT-MASTER-UCL.
 21243
 21244* EXEC CICS HANDLE CONDITION
 21245*         NOTFND    (8700-READ-CERT-MASTER)
 21246*    END-EXEC.
 21247*    MOVE '"$I                   ! = #00019910' TO DFHEIV0
 21248     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21249     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21250     MOVE X'3D20233030303139393130' TO DFHEIV0(25:11)
 21251     CALL 'kxdfhei1' USING DFHEIV0
 21252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21253
 21254
 21255 8690-READ-CERT-CONT.
 21256
 21257* EXEC CICS READ
 21258*        DATASET     (CERT-ID)
 21259*        INTO        (CERTIFICATE-MASTER)
 21260*        RIDFLD      (ELCERT-KEY)
 21261*        UPDATE
 21262*    END-EXEC.
 21263     MOVE LENGTH OF
 21264      CERTIFICATE-MASTER
 21265       TO DFHEIV11
 21266*    MOVE '&"IL       EU         (   #00019915' TO DFHEIV0
 21267     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21268     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21269     MOVE X'2020233030303139393135' TO DFHEIV0(25:11)
 21270     CALL 'kxdfhei1' USING DFHEIV0,
 21271           CERT-ID,
 21272           CERTIFICATE-MASTER,
 21273           DFHEIV11,
 21274           ELCERT-KEY,
 21275           DFHEIV99,
 21276           DFHEIV99,
 21277           DFHEIV99
 21278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21279
 21280
 21281     GO TO 8590-EXIT.
 21282
 21283 8700-READ-CERT-MASTER.
 21284     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 21285     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 21286
 21287* EXEC CICS HANDLE CONDITION
 21288*         DUPKEY    (8720-COMP-ACCOUNTS)
 21289*         ENDFILE   (8730-END-BROWSE)
 21290*         NOTFND    (8740-NOT-FOUND)
 21291*    END-EXEC.
 21292*    MOVE '"$$''I                 ! > #00019927' TO DFHEIV0
 21293     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 21294     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21295     MOVE X'3E20233030303139393237' TO DFHEIV0(25:11)
 21296     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 394
* EL050.cbl
 21297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21298
 21299
 21300
 21301* EXEC CICS STARTBR
 21302*        DATASET     ('ELCERT5')
 21303*        RIDFLD      (ELCERT2-KEY)
 21304*        EQUAL
 21305*    END-EXEC.
 21306     MOVE 'ELCERT5' TO DFHEIV1
 21307     MOVE 0
 21308       TO DFHEIV11
 21309*    MOVE '&,         E          &   #00019933' TO DFHEIV0
 21310     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 21311     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21312     MOVE X'2020233030303139393333' TO DFHEIV0(25:11)
 21313     CALL 'kxdfhei1' USING DFHEIV0,
 21314           DFHEIV1,
 21315           ELCERT2-KEY,
 21316           DFHEIV99,
 21317           DFHEIV11,
 21318           DFHEIV99
 21319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21320
 21321
 21322 8710-READ-NEXT.
 21323
 21324* EXEC CICS READNEXT
 21325*        DATASET     ('ELCERT5')
 21326*        INTO        (CERTIFICATE-MASTER)
 21327*        RIDFLD      (ELCERT2-KEY)
 21328*    END-EXEC.
 21329     MOVE LENGTH OF
 21330      CERTIFICATE-MASTER
 21331       TO DFHEIV12
 21332     MOVE 'ELCERT5' TO DFHEIV1
 21333     MOVE 0
 21334       TO DFHEIV11
 21335*    MOVE '&.IL                  )   #00019940' TO DFHEIV0
 21336     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21337     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21338     MOVE X'2020233030303139393430' TO DFHEIV0(25:11)
 21339     CALL 'kxdfhei1' USING DFHEIV0,
 21340           DFHEIV1,
 21341           CERTIFICATE-MASTER,
 21342           DFHEIV12,
 21343           ELCERT2-KEY,
 21344           DFHEIV99,
 21345           DFHEIV11,
 21346           DFHEIV99,
 21347           DFHEIV99
 21348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21349
 21350
 21351 8720-COMP-ACCOUNTS.
 21352
 21353* EXEC CICS ENTER
 21354*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 395
* EL050.cbl
 21355*         FROM (PB-C-LAST-NAME)
 21356*    END-EXEC.
 21357     MOVE 001
 21358       TO DFHEIV11
 21359*    MOVE ':$F                   %   #00019947' TO DFHEIV0
 21360     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21361     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21362     MOVE X'2020233030303139393437' TO DFHEIV0(25:11)
 21363     CALL 'kxdfhei1' USING DFHEIV0,
 21364           DFHEIV11,
 21365           PB-C-LAST-NAME,
 21366           DFHEIV99,
 21367           DFHEIV99
 21368     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21369
 21370
 21371
 21372* EXEC CICS ENTER
 21373*         TRACEID (002)
 21374*         FROM (CM-INSURED-LAST-NAME)
 21375*    END-EXEC.
 21376     MOVE 002
 21377       TO DFHEIV11
 21378*    MOVE ':$F                   %   #00019952' TO DFHEIV0
 21379     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21380     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21381     MOVE X'2020233030303139393532' TO DFHEIV0(25:11)
 21382     CALL 'kxdfhei1' USING DFHEIV0,
 21383           DFHEIV11,
 21384           CM-INSURED-LAST-NAME,
 21385           DFHEIV99,
 21386           DFHEIV99
 21387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21388
 21389
 21390     IF PB-CERT-NO NOT = CM-CERT-NO
 21391         GO TO 8730-END-BROWSE.
 21392
 21393     IF PB-ACCOUNT = CM-ACCOUNT
 21394         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 21395             MOVE ER-2799        TO WS-ERROR
 21396             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21397             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 21398             GO TO 8730-END-BROWSE.
 21399
 21400     GO TO 8710-READ-NEXT.
 21401
 21402 8730-END-BROWSE.
 21403
 21404* EXEC CICS ENDBR
 21405*         DATASET    ('ELCERT5')
 21406*    END-EXEC.
 21407     MOVE 'ELCERT5' TO DFHEIV1
 21408     MOVE 0
 21409       TO DFHEIV11
 21410*    MOVE '&2                    $   #00019970' TO DFHEIV0
 21411     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21412     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 396
* EL050.cbl
 21413     MOVE X'2020233030303139393730' TO DFHEIV0(25:11)
 21414     CALL 'kxdfhei1' USING DFHEIV0,
 21415           DFHEIV1,
 21416           DFHEIV11,
 21417           DFHEIV99
 21418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21419
 21420
 21421 8740-NOT-FOUND.
 21422     GO TO 0299-CERT-NOT-FOUND.
 21423
 21424 8750-START-ELSTAT.
 21425
 21426* EXEC CICS STARTBR
 21427*       DATASET   (STAT-ID)
 21428*       RIDFLD    (ELSTAT-KEY)
 21429*       GTEQ
 21430*       RESP      (WS-RESPONSE)
 21431*    END-EXEC
 21432     MOVE 0
 21433       TO DFHEIV11
 21434*    MOVE '&,         G          &  N#00019978' TO DFHEIV0
 21435     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21436     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21437     MOVE X'204E233030303139393738' TO DFHEIV0(25:11)
 21438     CALL 'kxdfhei1' USING DFHEIV0,
 21439           STAT-ID,
 21440           ELSTAT-KEY,
 21441           DFHEIV99,
 21442           DFHEIV11,
 21443           DFHEIV99
 21444     MOVE EIBRESP  TO WS-RESPONSE
 21445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21446     IF WS-RESP-NORMAL
 21447        MOVE 'Y'                 TO STAT-MASTER-SW
 21448     ELSE
 21449        MOVE 'N'                 TO STAT-MASTER-SW
 21450     END-IF
 21451     .
 21452 8750-EXIT.
 21453     EXIT.
 21454 8752-READ-ELSTAT.
 21455
 21456* EXEC CICS READNEXT
 21457*       DATASET   (STAT-ID)
 21458*       RIDFLD    (ELSTAT-KEY)
 21459*       INTO      (STATE-FILE)
 21460*       RESP      (WS-RESPONSE)
 21461*    END-EXEC
 21462     MOVE LENGTH OF
 21463      STATE-FILE
 21464       TO DFHEIV12
 21465     MOVE 0
 21466       TO DFHEIV11
 21467*    MOVE '&.IL                  )  N#00019993' TO DFHEIV0
 21468     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21469     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21470     MOVE X'204E233030303139393933' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 397
* EL050.cbl
 21471     CALL 'kxdfhei1' USING DFHEIV0,
 21472           STAT-ID,
 21473           STATE-FILE,
 21474           DFHEIV12,
 21475           ELSTAT-KEY,
 21476           DFHEIV99,
 21477           DFHEIV11,
 21478           DFHEIV99,
 21479           DFHEIV99
 21480     MOVE EIBRESP  TO WS-RESPONSE
 21481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21482     IF WS-RESP-NORMAL
 21483        MOVE 'Y'                 TO STAT-MASTER-SW
 21484     ELSE
 21485        MOVE 'N'                 TO STAT-MASTER-SW
 21486     END-IF
 21487     .
 21488 8752-EXIT.
 21489     EXIT.
 21490 8800-GET-COMP-RATE.
 21491     MOVE +1 TO IB.
 21492     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 21493         ADD +9 TO IB
 21494         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 21495             ADD +9 TO IB
 21496             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 21497                MOVE ZEROS       TO WS-WK-RATE
 21498                GO TO 8800-EXIT.
 21499
 21500     IF PB-I-AGE GREATER CT-AGE (1)
 21501         ADD +3 TO IB
 21502         IF PB-I-AGE GREATER CT-AGE (2)
 21503             ADD +3 TO IB
 21504             IF PB-I-AGE GREATER CT-AGE (3)
 21505                MOVE ZEROS       TO WS-WK-RATE
 21506                GO TO 8800-EXIT.
 21507
 21508     IF WS-WORK-TERM GREATER CT-TRM (1)
 21509         ADD +1 TO IB
 21510         IF WS-WORK-TERM GREATER CT-TRM (2)
 21511             ADD +1 TO IB
 21512             IF WS-WORK-TERM GREATER CT-TRM (3)
 21513                MOVE ZEROS       TO WS-WK-RATE
 21514                GO TO 8800-EXIT.
 21515
 21516     IF CT-RT (IB) NOT NUMERIC
 21517         MOVE CT-RT-R (IB) TO CTBL-TABLE
 21518         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 21519         GO TO 8800-GET-COMP-RATE.
 21520
 21521     MOVE CT-RT (IB) TO WS-WK-RATE.
 21522
 21523 8800-EXIT.
 21524     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 398
* EL050.cbl
 21526 8900-ADDRESS-FILE.
 21527     IF ERACCT-FILE-ADDRESSED
 21528         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 21529         GO TO 8900-ADDRESS-EXIT.
 21530
 21531     IF ELCNTL-FILE-ADDRESSED
 21532         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 21533         GO TO 8900-ADDRESS-EXIT.
 21534
 21535     IF ERPLAN-FILE-ADDRESSED
 21536         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 21537         GO TO 8900-ADDRESS-EXIT.
 21538
 21539     IF ERFORM-FILE-ADDRESSED
 21540         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 21541         GO TO 8900-ADDRESS-EXIT.
 21542
 21543 8900-ADDRESS-EXIT.
 21544     EXIT.
 21545
 21546 9000-READ-CONTROL.
 21547
 21548* EXEC CICS HANDLE CONDITION
 21549*        NOTFND    (9000-NOTFND)
 21550*    END-EXEC.
 21551*    MOVE '"$I                   ! ? #00020064' TO DFHEIV0
 21552     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21553     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21554     MOVE X'3F20233030303230303634' TO DFHEIV0(25:11)
 21555     CALL 'kxdfhei1' USING DFHEIV0
 21556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21557
 21558
 21559
 21560* EXEC CICS READ
 21561*        DATASET     (CNTL-ID)
 21562*        SET         (ADDRESS OF CONTROL-FILE)
 21563*        RIDFLD      (ELCNTL-KEY)
 21564*        GTEQ
 21565*    END-EXEC.
 21566*    MOVE '&"S        G          (   #00020068' TO DFHEIV0
 21567     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21568     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21569     MOVE X'2020233030303230303638' TO DFHEIV0(25:11)
 21570     CALL 'kxdfhei1' USING DFHEIV0,
 21571           CNTL-ID,
 21572           DFHEIV20,
 21573           DFHEIV99,
 21574           ELCNTL-KEY,
 21575           DFHEIV99,
 21576           DFHEIV99,
 21577           DFHEIV99
 21578     SET ADDRESS OF CONTROL-FILE TO
 21579         DFHEIV20
 21580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21581
 21582
 21583     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 399
* EL050.cbl
 21584
 21585 9000-NOTFND.
 21586     IF RC-SW-1 = '1'
 21587        MOVE ER-2616              TO WS-ERROR
 21588        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21589        GO TO 9000-EXIT.
 21590
 21591     IF RC-SW-1 = '2'
 21592        MOVE ER-2602              TO WS-ERROR
 21593        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21594
 21595 9000-EXIT.
 21596      EXIT.
 21597
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 400
* EL050.cbl
 21599 9100-READ-CONTROL.
 21600
 21601* EXEC CICS HANDLE CONDITION
 21602*        NOTFND  (9100-NOTFND)
 21603*        ENDFILE (9100-NOTFND)
 21604*    END-EXEC.
 21605*    MOVE '"$I''                  ! @ #00020092' TO DFHEIV0
 21606     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21607     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21608     MOVE X'4020233030303230303932' TO DFHEIV0(25:11)
 21609     CALL 'kxdfhei1' USING DFHEIV0
 21610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21611
 21612
 21613
 21614* EXEC CICS READ
 21615*        DATASET     (CNTL-ID)
 21616*        INTO        (CONTROL-FILE)
 21617*        RIDFLD      (ELCNTL-KEY)
 21618*        GTEQ
 21619*    END-EXEC.
 21620     MOVE LENGTH OF
 21621      CONTROL-FILE
 21622       TO DFHEIV11
 21623*    MOVE '&"IL       G          (   #00020097' TO DFHEIV0
 21624     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21625     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21626     MOVE X'2020233030303230303937' TO DFHEIV0(25:11)
 21627     CALL 'kxdfhei1' USING DFHEIV0,
 21628           CNTL-ID,
 21629           CONTROL-FILE,
 21630           DFHEIV11,
 21631           ELCNTL-KEY,
 21632           DFHEIV99,
 21633           DFHEIV99,
 21634           DFHEIV99
 21635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21636
 21637
 21638     GO TO 9100-EXIT.
 21639
 21640 9100-NOTFND.
 21641     IF RC-SW-2 = '0'
 21642        MOVE '1'                  TO STATE-RECORD-ERROR
 21643        GO TO 9100-EXIT
 21644     END-IF
 21645     IF RC-SW-2 = '1'
 21646        MOVE '1'                  TO LF-BENEFIT-ERROR
 21647        MOVE ER-2604              TO WS-ERROR
 21648        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21649        GO TO 9100-EXIT.
 21650
 21651     IF RC-SW-2 = '2'
 21652        MOVE '1'                  TO AH-BENEFIT-ERROR
 21653        MOVE ER-2605              TO WS-ERROR
 21654        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21655        GO TO 9100-EXIT.
 21656
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 401
* EL050.cbl
 21657     IF RC-SW-2 = '3'
 21658         MOVE ER-2603           TO WS-ERROR
 21659         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21660         GO TO 9100-EXIT.
 21661
 21662     IF RC-SW-2 = '4'
 21663         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 21664         GO TO 9100-EXIT.
 21665
 21666     IF RC-SW-2 = '5'
 21667         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 21668         IF WS-AH-INPUT-CD-1 = SPACE
 21669             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 21670         ELSE
 21671             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 21672
 21673 9100-EXIT.
 21674      EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 402
* EL050.cbl
 21676 9200-CONTROL-GETMAIN.
 21677
 21678* EXEC CICS GETMAIN
 21679*         LENGTH   (750)
 21680*         SET      (ADDRESS OF CONTROL-FILE)
 21681*    END-EXEC.
 21682     MOVE 750
 21683       TO DFHEIV11
 21684*    MOVE '," L                  $   #00020143' TO DFHEIV0
 21685     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21686     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21687     MOVE X'2020233030303230313433' TO DFHEIV0(25:11)
 21688     CALL 'kxdfhei1' USING DFHEIV0,
 21689           DFHEIV20,
 21690           DFHEIV11,
 21691           DFHEIV99
 21692     SET ADDRESS OF CONTROL-FILE TO
 21693         DFHEIV20
 21694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21695
 21696
 21697     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 21698
 21699 9200-EXIT.
 21700     EXIT.
 21701
 21702 9250-UNLOCK-RETURN.
 21703
 21704* EXEC CICS UNLOCK
 21705*        DATASET   (CERT-ID)
 21706*    END-EXEC.
 21707*    MOVE '&*                    #   #00020154' TO DFHEIV0
 21708     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21709     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21710     MOVE X'2020233030303230313534' TO DFHEIV0(25:11)
 21711     CALL 'kxdfhei1' USING DFHEIV0,
 21712           CERT-ID,
 21713           DFHEIV99
 21714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21715
 21716
 21717 9300-ABEND.
 21718     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 21719
 21720
 21721* EXEC CICS LINK
 21722*        PROGRAM   ('EL004')
 21723*        COMMAREA  (WS-ERROR-LINE)
 21724*        LENGTH    (72)
 21725*    END-EXEC.
 21726     MOVE 'EL004' TO DFHEIV1
 21727     MOVE 72
 21728       TO DFHEIV11
 21729*    MOVE '."C                   (   #00020161' TO DFHEIV0
 21730     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21731     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21732     MOVE X'2020233030303230313631' TO DFHEIV0(25:11)
 21733     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 403
* EL050.cbl
 21734           DFHEIV1,
 21735           WS-ERROR-LINE,
 21736           DFHEIV11,
 21737           DFHEIV99,
 21738           DFHEIV99,
 21739           DFHEIV99,
 21740           DFHEIV99
 21741     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21742
 21743
 21744     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 21745
 21746
 21747* EXEC CICS ABEND
 21748*        ABCODE ('EL50')
 21749*    END-EXEC.
 21750     MOVE 'EL50' TO DFHEIV5
 21751*    MOVE '.,A                   "   #00020169' TO DFHEIV0
 21752     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 21753     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 21754     MOVE X'2020233030303230313639' TO DFHEIV0(25:11)
 21755     CALL 'kxdfhei1' USING DFHEIV0,
 21756           DFHEIV5
 21757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21758
 21759
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 404
* EL050.cbl
 21761
 21762******************************************************************
 21763*                                                                *
 21764*            E R R O R   F O R M A T   R O U T I N E             *
 21765*                                                                *
 21766******************************************************************
 21767
 21768 9900-ERROR-FORMAT.
 21769
 21770     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 21771                    PB-COMMON-ERROR (2) OR
 21772                    PB-COMMON-ERROR (3) OR
 21773                    PB-COMMON-ERROR (4) OR
 21774                    PB-COMMON-ERROR (5) OR
 21775                    PB-COMMON-ERROR (6) OR
 21776                    PB-COMMON-ERROR (7) OR
 21777                    PB-COMMON-ERROR (8) OR
 21778                    PB-COMMON-ERROR (9) OR
 21779                    PB-COMMON-ERROR (10)
 21780        GO TO 9900-EXIT.
 21781
 21782     IF PB-NO-OF-ERRORS = +10
 21783        GO TO 9900-EXIT.
 21784
 21785     ADD +1  TO PB-NO-OF-ERRORS.
 21786     MOVE WS-ERROR               TO PB-COMMON-ERROR
 21787                                       (PB-NO-OF-ERRORS).
 21788 9900-EXIT.
 21789     EXIT.
 21790
 21791 9990-RETURN.
 21792     IF BROWSE-STARTED
 21793
 21794* EXEC CICS ENDBR
 21795*            DATASET  (ACCT-ID)
 21796*       END-EXEC.
 21797     MOVE 0
 21798       TO DFHEIV11
 21799*    MOVE '&2                    $   #00020206' TO DFHEIV0
 21800     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21801     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21802     MOVE X'2020233030303230323036' TO DFHEIV0(25:11)
 21803     CALL 'kxdfhei1' USING DFHEIV0,
 21804           ACCT-ID,
 21805           DFHEIV11,
 21806           DFHEIV99
 21807     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21808
 21809
 21810 9990-EXIT.
 21811     EXIT.
 21812
 21813
 21814****Check for CRTO record, add one if not found.
 21815 9991-CHECK-FOR-ELCRTO.
 21816
 21817* EXEC CICS HANDLE CONDITION
 21818*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 405
* EL050.cbl
 21819*         ENDFILE (9991-CRTO-NOT-FOUND)
 21820*     END-EXEC.
 21821*    MOVE '"$I''                  ! A #00020216' TO DFHEIV0
 21822     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21823     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21824     MOVE X'4120233030303230323136' TO DFHEIV0(25:11)
 21825     CALL 'kxdfhei1' USING DFHEIV0
 21826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21827
 21828     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21829     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21830     MOVE +0                     TO ELCRTO-SEQ-NO
 21831
 21832
 21833* EXEC CICS READ
 21834*       DATASET   ('ELCRTO')
 21835*       INTO      (ORIGINAL-CERTIFICATE)
 21836*       RIDFLD    (ELCRTO-KEY)
 21837*       GTEQ
 21838*       RESP      (WS-RESPONSE)
 21839*    END-EXEC
 21840     MOVE LENGTH OF
 21841      ORIGINAL-CERTIFICATE
 21842       TO DFHEIV11
 21843     MOVE 'ELCRTO' TO DFHEIV1
 21844*    MOVE '&"IL       G          (  N#00020224' TO DFHEIV0
 21845     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21846     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21847     MOVE X'204E233030303230323234' TO DFHEIV0(25:11)
 21848     CALL 'kxdfhei1' USING DFHEIV0,
 21849           DFHEIV1,
 21850           ORIGINAL-CERTIFICATE,
 21851           DFHEIV11,
 21852           ELCRTO-KEY,
 21853           DFHEIV99,
 21854           DFHEIV99,
 21855           DFHEIV99
 21856     MOVE EIBRESP  TO WS-RESPONSE
 21857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21858
 21859     IF WS-RESP-NORMAL
 21860        AND (OC-CONTROL-PRIMARY (1:33) =
 21861                 PB-CONTROL-BY-ACCOUNT (1:33))
 21862        AND (OC-RECORD-TYPE =  'I')
 21863           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21864               GO TO 9991-CHECK-INDICATORS
 21865           ELSE
 21866               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21867               GO TO 9991-CRTO-ADD-REC
 21868           END-IF
 21869     END-IF.
 21870
 21871 9991-CRTO-NOT-FOUND.
 21872
 21873     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21874     MOVE 'OC'                TO OC-RECORD-ID
 21875     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21876                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 406
* EL050.cbl
 21877     MOVE +4096               TO OC-KEY-SEQ-NO.
 21878
 21879 9991-CRTO-ADD-REC.
 21880
 21881     MOVE 'E050'              TO OC-LAST-MAINT-BY
 21882     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 21883     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21884     MOVE 'I'                 TO OC-RECORD-TYPE
 21885     IF PB-ISSUE
 21886         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21887         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21888         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21889         MOVE PB-I-AGE               TO OC-INS-AGE
 21890         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21891         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21892         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21893         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21894         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21895         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21896         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21897         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21898         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21899         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21900         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21901         IF PB-I-JOINT-COMMISSION > +0
 21902             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21903         ELSE
 21904             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21905         END-IF
 21906         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21907         MOVE +0                     TO OC-LF-CANCEL-AMT
 21908                                        OC-LF-ITD-CANCEL-AMT
 21909         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21910         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21911         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21912         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21913         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21914         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21915         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21916         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21917         MOVE +0                     TO OC-AH-CANCEL-AMT
 21918                                        OC-AH-ITD-CANCEL-AMT
 21919         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21920         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21921         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 21922     ELSE
 21923         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21924         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21925         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21926         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21927         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21928         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21929         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21930         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21931         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21932          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21933             MOVE SPACES             TO OC-LF-BENCD
 21934             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 407
* EL050.cbl
 21935                                        OC-LF-BEN-AMT
 21936                                        OC-LF-PRM-AMT
 21937                                        OC-LF-ALT-BEN-AMT
 21938                                        OC-LF-ALT-PRM-AMT
 21939                                        OC-LF-COMM-PCT
 21940                                        OC-LF-CANCEL-AMT
 21941             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21942             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21943         ELSE
 21944             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21945             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21946             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21947             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21948             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21949             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21950             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21951             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21952             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21953             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21954         END-IF
 21955         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21956         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21957          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21958             MOVE SPACES             TO OC-AH-BENCD
 21959             MOVE ZEROS              TO OC-AH-TERM
 21960                                        OC-AH-BEN-AMT
 21961                                        OC-AH-PRM-AMT
 21962                                        OC-AH-COMM-PCT
 21963                                        OC-AH-CANCEL-AMT
 21964                                        OC-AH-CP
 21965             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21966             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21967         ELSE
 21968             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21969             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21970             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21971             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21972             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21973             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21974             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 21975             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21976             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21977         END-IF
 21978         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21979         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21980         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 21981         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 21982     END-IF
 21983     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21984
 21985     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21986
 21987
 21988* EXEC CICS READ
 21989*         DATASET   (FILE-ERMAIL)
 21990*         RIDFLD    (MA-CONTROL-PRIMARY)
 21991*         INTO      (MAILING-DATA)
 21992*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 408
* EL050.cbl
 21993*    END-EXEC
 21994     MOVE LENGTH OF
 21995      MAILING-DATA
 21996       TO DFHEIV11
 21997*    MOVE '&"IL       E          (  N#00020360' TO DFHEIV0
 21998     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21999     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22000     MOVE X'204E233030303230333630' TO DFHEIV0(25:11)
 22001     CALL 'kxdfhei1' USING DFHEIV0,
 22002           FILE-ERMAIL,
 22003           MAILING-DATA,
 22004           DFHEIV11,
 22005           MA-CONTROL-PRIMARY,
 22006           DFHEIV99,
 22007           DFHEIV99,
 22008           DFHEIV99
 22009     MOVE EIBRESP  TO WS-RESPONSE
 22010     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22011
 22012     IF WS-RESP-NORMAL
 22013         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22014     END-IF.
 22015
 22016     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22017     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22018
 22019
 22020* EXEC CICS READ
 22021*         DATASET  (CRTT-ID)
 22022*         RIDFLD   (WS-ELCRTT-KEY)
 22023*         INTO     (CERTIFICATE-TRAILERS)
 22024*         RESP     (WS-RESPONSE)
 22025*    END-EXEC
 22026     MOVE LENGTH OF
 22027      CERTIFICATE-TRAILERS
 22028       TO DFHEIV11
 22029*    MOVE '&"IL       E          (  N#00020374' TO DFHEIV0
 22030     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22031     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22032     MOVE X'204E233030303230333734' TO DFHEIV0(25:11)
 22033     CALL 'kxdfhei1' USING DFHEIV0,
 22034           CRTT-ID,
 22035           CERTIFICATE-TRAILERS,
 22036           DFHEIV11,
 22037           WS-ELCRTT-KEY,
 22038           DFHEIV99,
 22039           DFHEIV99,
 22040           DFHEIV99
 22041     MOVE EIBRESP  TO WS-RESPONSE
 22042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22043
 22044     IF WS-RESP-NORMAL
 22045         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 22046         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 22047     END-IF.
 22048
 22049
 22050* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 409
* EL050.cbl
 22051*       DATASET   ('ELCRTO')
 22052*       FROM      (ORIGINAL-CERTIFICATE)
 22053*       RIDFLD    (OC-CONTROL-PRIMARY)
 22054*       RESP      (WS-RESPONSE)
 22055*    END-EXEC.
 22056     MOVE LENGTH OF
 22057      ORIGINAL-CERTIFICATE
 22058       TO DFHEIV11
 22059     MOVE 'ELCRTO' TO DFHEIV1
 22060*    MOVE '&$ L                  ''  N#00020386' TO DFHEIV0
 22061     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 22062     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22063     MOVE X'204E233030303230333836' TO DFHEIV0(25:11)
 22064     CALL 'kxdfhei1' USING DFHEIV0,
 22065           DFHEIV1,
 22066           ORIGINAL-CERTIFICATE,
 22067           DFHEIV11,
 22068           OC-CONTROL-PRIMARY,
 22069           DFHEIV99,
 22070           DFHEIV99
 22071     MOVE EIBRESP  TO WS-RESPONSE
 22072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22073
 22074
 22075     GO TO 9991-EXIT.
 22076
 22077 9991-CHECK-INDICATORS.
 22078
 22079     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 22080         GO TO 9991-EXIT
 22081     END-IF.
 22082
 22083     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 22084         GO TO 9991-EXIT
 22085     END-IF.
 22086
 22087
 22088* EXEC CICS READ
 22089*       DATASET   ('ELCRTO')
 22090*       INTO      (ORIGINAL-CERTIFICATE)
 22091*       RIDFLD    (OC-CONTROL-PRIMARY)
 22092*       UPDATE
 22093*       RESP      (WS-RESPONSE)
 22094*    END-EXEC
 22095     MOVE LENGTH OF
 22096      ORIGINAL-CERTIFICATE
 22097       TO DFHEIV11
 22098     MOVE 'ELCRTO' TO DFHEIV1
 22099*    MOVE '&"IL       EU         (  N#00020405' TO DFHEIV0
 22100     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22101     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22102     MOVE X'204E233030303230343035' TO DFHEIV0(25:11)
 22103     CALL 'kxdfhei1' USING DFHEIV0,
 22104           DFHEIV1,
 22105           ORIGINAL-CERTIFICATE,
 22106           DFHEIV11,
 22107           OC-CONTROL-PRIMARY,
 22108           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 410
* EL050.cbl
 22109           DFHEIV99,
 22110           DFHEIV99
 22111     MOVE EIBRESP  TO WS-RESPONSE
 22112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22113     IF WS-RESP-NORMAL
 22114        IF PB-ISSUE
 22115          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 22116          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 22117          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 22118          MOVE PB-I-AGE               TO OC-INS-AGE
 22119          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 22120          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 22121          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 22122          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 22123          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 22124          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 22125          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 22126          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 22127          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22128          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22129          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22130          IF PB-I-JOINT-COMMISSION > +0
 22131              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22132          ELSE
 22133              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22134          END-IF
 22135          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22136          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22137          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22138          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22139          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22140          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22141          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22142          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22143          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22144
 22145          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22146
 22147* EXEC CICS READ
 22148*             DATASET   (FILE-ERMAIL)
 22149*             RIDFLD    (MA-CONTROL-PRIMARY)
 22150*             INTO      (MAILING-DATA)
 22151*             RESP      (WS-RESPONSE)
 22152*         END-EXEC
 22153     MOVE LENGTH OF
 22154      MAILING-DATA
 22155       TO DFHEIV11
 22156*    MOVE '&"IL       E          (  N#00020445' TO DFHEIV0
 22157     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22158     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22159     MOVE X'204E233030303230343435' TO DFHEIV0(25:11)
 22160     CALL 'kxdfhei1' USING DFHEIV0,
 22161           FILE-ERMAIL,
 22162           MAILING-DATA,
 22163           DFHEIV11,
 22164           MA-CONTROL-PRIMARY,
 22165           DFHEIV99,
 22166           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 411
* EL050.cbl
 22167           DFHEIV99
 22168     MOVE EIBRESP  TO WS-RESPONSE
 22169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22170          IF WS-RESP-NORMAL
 22171             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22172          END-IF
 22173
 22174          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22175          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22176
 22177* EXEC CICS READ
 22178*             DATASET  (CRTT-ID)
 22179*             RIDFLD   (WS-ELCRTT-KEY)
 22180*             INTO     (CERTIFICATE-TRAILERS)
 22181*             RESP     (WS-RESPONSE)
 22182*         END-EXEC
 22183     MOVE LENGTH OF
 22184      CERTIFICATE-TRAILERS
 22185       TO DFHEIV11
 22186*    MOVE '&"IL       E          (  N#00020457' TO DFHEIV0
 22187     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22188     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22189     MOVE X'204E233030303230343537' TO DFHEIV0(25:11)
 22190     CALL 'kxdfhei1' USING DFHEIV0,
 22191           CRTT-ID,
 22192           CERTIFICATE-TRAILERS,
 22193           DFHEIV11,
 22194           WS-ELCRTT-KEY,
 22195           DFHEIV99,
 22196           DFHEIV99,
 22197           DFHEIV99
 22198     MOVE EIBRESP  TO WS-RESPONSE
 22199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22200          IF WS-RESP-NORMAL
 22201             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 22202                               OC-INS-AGE-DEFAULT-FLAG
 22203             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 22204                               OC-JNT-AGE-DEFAULT-FLAG
 22205          END-IF
 22206
 22207        ELSE
 22208          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22209             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 22210             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 22211             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 22212          END-IF
 22213          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22214             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 22215             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 22216             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 22217          END-IF
 22218          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 22219        END-IF
 22220
 22221* EXEC CICS REWRITE
 22222*          DATASET   ('ELCRTO')
 22223*          FROM      (ORIGINAL-CERTIFICATE)
 22224*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 412
* EL050.cbl
 22225*       END-EXEC
 22226     MOVE LENGTH OF
 22227      ORIGINAL-CERTIFICATE
 22228       TO DFHEIV11
 22229     MOVE 'ELCRTO' TO DFHEIV1
 22230*    MOVE '&& L                  %  N#00020483' TO DFHEIV0
 22231     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 22232     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22233     MOVE X'204E233030303230343833' TO DFHEIV0(25:11)
 22234     CALL 'kxdfhei1' USING DFHEIV0,
 22235           DFHEIV1,
 22236           ORIGINAL-CERTIFICATE,
 22237           DFHEIV11,
 22238           DFHEIV99
 22239     MOVE EIBRESP  TO WS-RESPONSE
 22240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22241     END-IF.
 22242
 22243 9991-EXIT.
 22244     EXIT.
 22245
 22246
 22247 9999-RETURN.
 22248     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 22249
 22250
 22251* EXEC CICS RETURN
 22252*    END-EXEC.
 22253*    MOVE '.(                    ''   #00020497' TO DFHEIV0
 22254     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 22255     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22256     MOVE X'2020233030303230343937' TO DFHEIV0(25:11)
 22257     CALL 'kxdfhei1' USING DFHEIV0,
 22258           DFHEIV99,
 22259           DFHEIV99,
 22260           DFHEIV99,
 22261           DFHEIV99,
 22262           DFHEIV99,
 22263           DFHEIV99
 22264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22265
 22266
 22267
 22268* GOBACK.
 22269     MOVE '9%                    "   ' TO DFHEIV0
 22270     MOVE 'EL050' TO DFHEIV1
 22271     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22272     GOBACK.
 22273
 22274 9999-DFHBACK SECTION.
 22275     MOVE '9%                    "   ' TO DFHEIV0
 22276     MOVE 'EL050' TO DFHEIV1
 22277     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22278     GOBACK.
 22279 9999-DFHEXIT.
 22280     IF DFHEIGDJ EQUAL 0001
 22281         NEXT SENTENCE
 22282     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 413
* EL050.cbl
 22283         GO TO 9300-ABEND,
 22284               3990-FILES-NOT-OPEN
 22285         DEPENDING ON DFHEIGDI
 22286     ELSE IF DFHEIGDJ EQUAL 3
 22287         GO TO 6610-START-BROWSE,
 22288               6630-ERRESS-PROBLEM,
 22289               6630-END-OF-FILE
 22290         DEPENDING ON DFHEIGDI
 22291     ELSE IF DFHEIGDJ EQUAL 4
 22292         GO TO 6630-END-OF-FILE,
 22293               6630-ERRESS-PROBLEM,
 22294               6630-ERRESS-PROBLEM,
 22295               6630-END-OF-FILE
 22296         DEPENDING ON DFHEIGDI
 22297     ELSE IF DFHEIGDJ EQUAL 5
 22298         GO TO 6630-END-OF-FILE,
 22299               6630-END-OF-FILE,
 22300               6630-ERRESS-PROBLEM,
 22301               6630-ERRESS-PROBLEM
 22302         DEPENDING ON DFHEIGDI
 22303     ELSE IF DFHEIGDJ EQUAL 6
 22304         GO TO 6660-START-BROWSE,
 22305               6690-ERRESC-PROBLEM,
 22306               6690-ERRESC-PROBLEM,
 22307               6690-END-OF-FILE
 22308         DEPENDING ON DFHEIGDI
 22309     ELSE IF DFHEIGDJ EQUAL 7
 22310         GO TO 6690-END-OF-FILE,
 22311               6690-ERRESC-PROBLEM,
 22312               6690-ERRESC-PROBLEM,
 22313               6690-END-OF-FILE
 22314         DEPENDING ON DFHEIGDI
 22315     ELSE IF DFHEIGDJ EQUAL 8
 22316         GO TO 6690-END-OF-FILE,
 22317               6690-ERRESC-PROBLEM,
 22318               6690-ERRESC-PROBLEM,
 22319               6690-END-OF-FILE
 22320         DEPENDING ON DFHEIGDI
 22321     ELSE IF DFHEIGDJ EQUAL 9
 22322         GO TO 7250-CONTINUE,
 22323               7250-CONTINUE
 22324         DEPENDING ON DFHEIGDI
 22325     ELSE IF DFHEIGDJ EQUAL 10
 22326         GO TO 7300-CONTINUE,
 22327               7300-CONTINUE
 22328         DEPENDING ON DFHEIGDI
 22329     ELSE IF DFHEIGDJ EQUAL 11
 22330         GO TO 8000-FREE-MAIN
 22331         DEPENDING ON DFHEIGDI
 22332     ELSE IF DFHEIGDJ EQUAL 12
 22333         GO TO 8100-NOTFND,
 22334               8100-NOTFND
 22335         DEPENDING ON DFHEIGDI
 22336     ELSE IF DFHEIGDJ EQUAL 13
 22337         GO TO 8110-NOTFND,
 22338               8110-NOTFND
 22339         DEPENDING ON DFHEIGDI
 22340     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 414
* EL050.cbl
 22341         GO TO 8130-EXIT
 22342         DEPENDING ON DFHEIGDI
 22343     ELSE IF DFHEIGDJ EQUAL 15
 22344         GO TO 8150-exit
 22345         DEPENDING ON DFHEIGDI
 22346     ELSE IF DFHEIGDJ EQUAL 16
 22347         GO TO 8180-NOTFND
 22348         DEPENDING ON DFHEIGDI
 22349     ELSE IF DFHEIGDJ EQUAL 17
 22350         GO TO 8190-NOTFND
 22351         DEPENDING ON DFHEIGDI
 22352     ELSE IF DFHEIGDJ EQUAL 18
 22353         GO TO 8195-NOTFND
 22354         DEPENDING ON DFHEIGDI
 22355     ELSE IF DFHEIGDJ EQUAL 19
 22356         GO TO 8200-NOTFND
 22357         DEPENDING ON DFHEIGDI
 22358     ELSE IF DFHEIGDJ EQUAL 20
 22359         GO TO 8300-NOTFND,
 22360               8300-ERRESS-PROBLEM,
 22361               8300-ERRESS-PROBLEM,
 22362               8300-NOTFND
 22363         DEPENDING ON DFHEIGDI
 22364     ELSE IF DFHEIGDJ EQUAL 21
 22365         GO TO 8450-FORM-NOT-FOUND,
 22366               8450-FORM-NOT-FOUND
 22367         DEPENDING ON DFHEIGDI
 22368     ELSE IF DFHEIGDJ EQUAL 22
 22369         GO TO 0199-ACCT-NOT-FOUND,
 22370               0199-ACCT-NOT-FOUND
 22371         DEPENDING ON DFHEIGDI
 22372     ELSE IF DFHEIGDJ EQUAL 23
 22373         GO TO 0199-ACCT-NOT-FOUND,
 22374               0199-ACCT-NOT-FOUND
 22375         DEPENDING ON DFHEIGDI
 22376     ELSE IF DFHEIGDJ EQUAL 24
 22377         GO TO 8582-COMP-NOT-FOUND,
 22378               8582-COMP-NOT-FOUND
 22379         DEPENDING ON DFHEIGDI
 22380     ELSE IF DFHEIGDJ EQUAL 25
 22381         GO TO 8583-AGTC-NOT-FOUND,
 22382               8583-AGTC-NOT-FOUND
 22383         DEPENDING ON DFHEIGDI
 22384     ELSE IF DFHEIGDJ EQUAL 26
 22385         GO TO 8584-BXRF-NOT-FOUND,
 22386               8584-BXRF-NOT-FOUND
 22387         DEPENDING ON DFHEIGDI
 22388     ELSE IF DFHEIGDJ EQUAL 27
 22389         GO TO 8585-PLAN-NOT-FOUND,
 22390               8585-PLAN-NOT-FOUND
 22391         DEPENDING ON DFHEIGDI
 22392     ELSE IF DFHEIGDJ EQUAL 28
 22393         GO TO 0299-CERT-NOT-FOUND
 22394         DEPENDING ON DFHEIGDI
 22395     ELSE IF DFHEIGDJ EQUAL 29
 22396         GO TO 8700-READ-CERT-MASTER
 22397         DEPENDING ON DFHEIGDI
 22398     ELSE IF DFHEIGDJ EQUAL 30
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 13:24 Page 415
* EL050.cbl
 22399         GO TO 8720-COMP-ACCOUNTS,
 22400               8730-END-BROWSE,
 22401               8740-NOT-FOUND
 22402         DEPENDING ON DFHEIGDI
 22403     ELSE IF DFHEIGDJ EQUAL 31
 22404         GO TO 9000-NOTFND
 22405         DEPENDING ON DFHEIGDI
 22406     ELSE IF DFHEIGDJ EQUAL 32
 22407         GO TO 9100-NOTFND,
 22408               9100-NOTFND
 22409         DEPENDING ON DFHEIGDI
 22410     ELSE IF DFHEIGDJ EQUAL 33
 22411         GO TO 9991-CRTO-NOT-FOUND,
 22412               9991-CRTO-NOT-FOUND
 22413         DEPENDING ON DFHEIGDI.
 22414     MOVE '9%                    "   ' TO DFHEIV0
 22415     MOVE 'EL050' TO DFHEIV1
 22416     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22417     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       40696     Code:       91538
